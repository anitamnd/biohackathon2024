<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1 20151215//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.1?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">AoB Plants</journal-id>
    <journal-id journal-id-type="iso-abbrev">AoB Plants</journal-id>
    <journal-id journal-id-type="publisher-id">aobpla</journal-id>
    <journal-title-group>
      <journal-title>AoB Plants</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2041-2851</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
      <publisher-loc>US</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">6899345</article-id>
    <article-id pub-id-type="pmid">31844509</article-id>
    <article-id pub-id-type="doi">10.1093/aobpla/plz054</article-id>
    <article-id pub-id-type="publisher-id">plz054</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Tools</subject>
      </subj-group>
      <subj-group subj-group-type="category-oup-series">
        <subject>Editor's Choice</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>tealeaves: an R package for modelling leaf temperature using energy budgets</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">http://orcid.org/0000-0003-2555-3878</contrib-id>
        <name>
          <surname>Muir</surname>
          <given-names>Christopher D</given-names>
        </name>
        <xref ref-type="aff" rid="AF0001"/>
        <xref ref-type="corresp" rid="c1"/>
        <!--<email>cdmuir@hawaii.edu</email>-->
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Crous</surname>
          <given-names>Kristine</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <aff id="AF0001"><institution>Department of Botany, University of Hawai’i</institution>, Honolulu, HI, <country country="US">USA</country></aff>
    <author-notes>
      <corresp id="c1">Corresponding author’s e-mail address: <email>cdmuir@hawaii.edu</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <month>12</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2019-12-08">
      <day>08</day>
      <month>12</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>08</day>
      <month>12</month>
      <year>2019</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the <pub-date pub-type="epub"/>. -->
    <volume>11</volume>
    <issue>6</issue>
    <elocation-id>plz054</elocation-id>
    <history>
      <date date-type="received">
        <day>11</day>
        <month>4</month>
        <year>2019</year>
      </date>
      <date date-type="accepted">
        <day>21</day>
        <month>9</month>
        <year>2019</year>
      </date>
      <date date-type="editorial-decision">
        <day>26</day>
        <month>7</month>
        <year>2019</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2019. Published by Oxford University Press on behalf of the Annals of Botany Company.</copyright-statement>
      <copyright-year>2019</copyright-year>
      <license license-type="cc-by" xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="plz054.pdf"/>
    <abstract>
      <title>Abstract</title>
      <p>Plants must regulate leaf temperature to optimize photosynthesis, control water loss and prevent damage caused by overheating or freezing. Physical models of leaf energy budgets calculate the energy fluxes and leaf temperatures for a given set leaf and environmental parameters. These models can provide deep insight into the variation in leaf form and function, but there are few computational tools available to use these models. Here I introduce a new R package called <bold>tealeaves</bold> to make complex leaf energy budget models accessible to a broader array of plant scientists. This package enables novice users to start modelling leaf energy budgets quickly while allowing experts to customize their parameter settings. The code is open source, freely available and readily integrates with other R tools for scientific computing. This paper describes the current functionality of <bold>tealeaves</bold>, but new features will be added in future releases. This software tool will advance new research on leaf thermal physiology to advance our understanding of basic and applied plant science.</p>
    </abstract>
    <abstract abstract-type="teaser">
      <p><bold>tealeaves</bold> is a new R package to implement complex, customizable leaf energy budget models as part of an open source, transparent workflow.</p>
    </abstract>
    <kwd-group>
      <kwd>Boundary layer</kwd>
      <kwd>energy balance</kwd>
      <kwd>leaf size</kwd>
      <kwd>leaf temperature</kwd>
      <kwd>mathematical model</kwd>
      <kwd>plant leaves</kwd>
      <kwd>plant physiology</kwd>
      <kwd>R</kwd>
    </kwd-group>
    <counts>
      <page-count count="10"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec id="s1">
    <title>Introduction</title>
    <p>Plants grow, survive and reproduce under a wide variety of temperatures because natural selection endows them with adaptations to cope with different thermal regimes. Cushion plants in the alpine grow near the ground to stay warm, desert plants decrease absorptance to stay cool (<xref rid="CIT0011" ref-type="bibr">Ehleringer <italic>et al.</italic> 1976</xref>) and plants keep stomata open, which can protect against extreme heat waves (<xref rid="CIT0008" ref-type="bibr">Drake <italic>et al.</italic> 2018</xref>). Understanding these diverse mechanisms of thermal adaptation and acclimation may provide insight into how plants respond to increasing temperatures and how these responses influence ecosystem function with anthropogenic climate change (<xref rid="CIT0042" ref-type="bibr">Rogers <italic>et al.</italic> 2017</xref>; <xref rid="CIT0006" ref-type="bibr">Crous 2019</xref>). Because leaves are the primary photosynthetic organ in most plants, regulating leaf temperature is critical (<xref rid="CIT0004" ref-type="bibr">Berry and Björkman 1980</xref>). Photosynthesis peaks at intermediate temperatures (<xref rid="CIT0044" ref-type="bibr">Sage and Kubien 2007</xref>). When leaves are too warm, evaporation increases exponentially, photo- and non-photorespiratory losses subtract from carbon gain (<xref rid="CIT0023" ref-type="bibr">Jones 2014</xref>) and critical loss of function occurs about ~50 °C (<xref rid="CIT0037" ref-type="bibr">O’Sullivan <italic>et al.</italic> 2017</xref>). When leaves are too cold, maximum photosynthetic rates decline and can lead to damage from excess solar radiation (<xref rid="CIT0022" ref-type="bibr">Huner <italic>et al.</italic> 1993</xref>) as well as nighttime dew and frost formation (<xref rid="CIT0024" ref-type="bibr">Jordan and Smith 1994</xref>). Natural selection should favor leaf morphologies and physiological responses that optimize leaf temperature in a given environment (<xref rid="CIT0038" ref-type="bibr">Parkhurst and Loucks 1972</xref>; <xref rid="CIT0036" ref-type="bibr">Okajima <italic>et al.</italic> 2012</xref>; <xref rid="CIT0031" ref-type="bibr">Michaletz <italic>et al.</italic> 2016</xref>).</p>
    <p>To understand leaf thermal physiology, plant scientists need mathematical and computational tools to model leaf temperature as a function of leaf traits and the environment. Balancing energy budgets is a powerful mathematical tool for understanding how leaf traits and environmental parameters influnce plant physiology that has been used for over a century (<xref rid="CIT0040" ref-type="bibr">Raschke 1960</xref>). The equilibrium leaf temperature is that in which the energy gained from incoming solar and infrared radiation is balanced by thermal infrared radiation losses, sensible heat loss/gain and latent heat loss through evaporation (<xref rid="CIT0018" ref-type="bibr">Gutschick 2016</xref>). Leaf angle, size and conductance to water vapour alter leaf temperature by changing how much solar radiation they intercept and how much heat they lose through sensible and latent heat flux. Likewise, enrvironmental factors such as sunlight, air temperature, humidity and wind speed influence heat transfer between leaves and the surrounding microclimate (<xref rid="CIT0018" ref-type="bibr">Gutschick 2016</xref>). Under controlled conditions, leaf energy budget models are highly accurate (<xref rid="CIT0046" ref-type="bibr">Schymanski and Or 2017</xref>). Hence, they can offer deep insight on plant thermal physiology by asking how temperature is affected by one factor in isolation or in combination with another.</p>
    <p>Leaf energy budget models have many applications, but perhaps their most widespread use is in modelling optimal leaf size and shape. The boundary layer of still air just above and below the leaf surface determines sensible and latent heat transfer and is proportional to leaf size (<xref rid="CIT0015" ref-type="bibr">Gates 1968</xref>). All else being equal, larger leaves have a thicker boundary layer, slowing heat transfer and decoupling leaf temperature from air temperature. This likely explains why, for example, many warm desert species have small leaves (<xref rid="CIT0016" ref-type="bibr">Gibson 1998</xref>). Using leaf energy budgets, <xref rid="CIT0038" ref-type="bibr">Parkhurst and Loucks (1972)</xref> further predicted that leaves should be small in cold air and large under warm, shaded conditions. More recently, <xref rid="CIT0036" ref-type="bibr">Okajima <italic>et al.</italic> (2012)</xref> extended these models, showing that small leaves maximize photosynthetic rate under high insolation and warm temperatures, but large leaves increase water-use efficiency in shadier habitats. <xref rid="CIT0061" ref-type="bibr">Wright <italic>et al.</italic> (2017)</xref> used energy budget models to show that dew and frost formation may select against large leaves at high latitudes. Energy budget models also help explain variation in leaf shape, such as lobing and dissection, because heat transfer is determined by effective leaf width (aka characteristic leaf dimension; <xref rid="CIT0049" ref-type="bibr">Taylor 1975</xref>) rather than total area. Effective leaf width is ‘the diameter of the largest circle that can be inscribed within the margin’ (<xref rid="CIT0028" ref-type="bibr">Leigh <italic>et al.</italic> 2017</xref>). Lower effective leaf width reduces leaf temperature under natural conditions in the sun (<xref rid="CIT0028" ref-type="bibr">Leigh <italic>et al.</italic> 2017</xref>) and is under selection in sunny, drier habitats (<xref rid="CIT0012" ref-type="bibr">Ferris <italic>et al.</italic> 2015</xref>). Besides leaf size and shape, energy balance models are useful in understanding many plant processes and traits (<xref rid="CIT0014" ref-type="bibr">Gates 1965</xref>), such as transpiration (<xref rid="CIT0015" ref-type="bibr">Gates 1968</xref>), optimal stomatal conductance (<xref rid="CIT0005" ref-type="bibr">Buckley <italic>et al.</italic> 2014</xref>), stomatal arrangements (<xref rid="CIT0013" ref-type="bibr">Foster and Smith 1986</xref>), leaf thickness (<xref rid="CIT0027" ref-type="bibr">Leigh <italic>et al.</italic> 2012</xref>), response to sunflecks (<xref rid="CIT0047" ref-type="bibr">Schymanski <italic>et al.</italic> 2013</xref>), carbon economics (<xref rid="CIT0031" ref-type="bibr">Michaletz <italic>et al.</italic> 2016</xref>) and water-use efficiency (<xref rid="CIT0045" ref-type="bibr">Schymanski and Or 2016</xref>).</p>
    <p>Despite the utility of leaf energy budget models, there are a dearth of open source, customizable, computational tools to implement them. The <bold>plantecophys</bold> package implements a similar energy budget model (<xref rid="CIT0009" ref-type="bibr">Duursma 2015</xref>). However, the model is simplified for faster computation needed in ecosystem and global land surface models (<xref rid="CIT0029" ref-type="bibr">Leuning <italic>et al.</italic> 1995</xref>). Therefore, it does not incorporate features such as different boundary layer conductances on each leaf surface, nor can users easily change default parameters for specialized cases. The Landflux website also has an Excel spreadsheet for leaf energy budgets (<xref rid="CIT0050" ref-type="bibr">Tu 2019</xref>), but it is prohibitively time-consuming and not reproducible to use spreadsheets for large-scale simulations. Because computational tools are limited, potential users must develop models anew and learn the numerical methods necessary to find solutions. Ideally, there should be a platform in which novices can model leaf temperature to solve an interesting problem without having to write their own model and learn complicated numerical algorithms. At the same time, we need a platform that can be easily modified for experts that want to extend existing leaf energy balance models.</p>
    <p>The goal of this paper is therefore to develop software that models leaf temperature as a function of leaf traits and the environment with physical realism. This software should be open source so that the methods are transparent and code can be modified by other researchers. Secondly, it should be readily available to novice modelers yet customizable by those working on more specific problems. Finally, it should easily integrate with other advanced tools for scientific computing. To that end, I developed an R package called <bold>tealeaves</bold> to model leaf temepature in response to a wide variety of leaf and environmental parameters. The source code is open source and available to modify; it is easy to use with default parameters, but also customizable; and because it is written in R, the output from <bold>tealeaves</bold> can be analysed and visualized with the vast array of computational tools availble in the R environment.</p>
  </sec>
  <sec sec-type="materials" id="s2">
    <title>Methods</title>
    <p>Annotated source code to generate this manuscript is available on GitHub (<ext-link ext-link-type="uri" xlink:href="https://github.com/cdmuir/tealeaves-ms">https://github.com/cdmuir/tealeaves-ms</ext-link>).</p>
    <p>Leaf energy budgets consist of incoming and outgoing energy fluxes. Incoming energy includes radiation from solar (aka short-wave) and thermal infrared (aka long-wave) sources. Outgoing energy includes losses of infrared radiation, sensible heat and latent heat flux due to evaporation (<xref ref-type="fig" rid="F1">Fig. 1</xref>). Note that sensible and latent fluxes can be positive when leaves are warmer than the air or condensation (dew) occures, respectively. When leaves reach a thermal equilibrium with their environment—generally within a few minutes—these incoming and outgoing energy sources balance one another. Formally, one solves for the leaf temperature (<inline-formula><mml:math id="m1"><mml:mstyle displaystyle="false"><mml:mrow><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>) that balances the energy budget:</p>
    <fig id="F1" orientation="portrait" position="float">
      <label>Figure 1.</label>
      <caption>
        <p>The leaf energy budget model in <bold>tealeaves</bold> takes environmental and leaf parameters to find the equilibrium leaf temperature (<inline-formula><mml:math id="m2"><mml:mstyle displaystyle="false"><mml:mrow><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>) at which incoming energy exactly matches outgoing energy. Under typical daytime conditions, this means thermal infrared radiation losses, sensible heat loss and latent heat loss must balance absorbed radiation. (A) The components of leaf energy budgets (thin orange lines) vary with leaf temperature (<italic>x</italic>-axis). <inline-formula><mml:math id="m3"><mml:mstyle displaystyle="false"><mml:mrow><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> is where the net energy flux (thick blue line) is 0 (blue point; see Equation 1). (B) 1) Radiation is emitted from sunlight and surrounding objects is absorbed by the leaf. 2) The leaf radiates some energy. 3) Heat is lost through convection when the leaf temperature is greater than air temperature. 4) Latent heat is lost through evaporation, which is driven by the vapor-pressure deficit between the air and leaf interior and the leaf conductance to water vapor. Calculations used the following leaf parameter values in this example: <italic>d</italic> = 0.1 m; <inline-formula><mml:math id="m4"><mml:mstyle displaystyle="false"><mml:mrow><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">s</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mn>0.5</mml:mn></mml:mstyle></mml:math></inline-formula>; <inline-formula><mml:math id="m5"><mml:mstyle displaystyle="false"><mml:mrow><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">l</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mn>0.97</mml:mn></mml:mstyle></mml:math></inline-formula>; <inline-formula><mml:math id="m6"><mml:mstyle displaystyle="false"><mml:mrow><mml:msub><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mi>w</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mn>5</mml:mn><mml:mrow><mml:mtext> </mml:mtext></mml:mrow><mml:mi>μ</mml:mi><mml:mrow><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">l</mml:mi></mml:mrow><mml:mtext> </mml:mtext><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mi mathvariant="normal">m</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mtext> </mml:mtext><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mi mathvariant="normal">s</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">P</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mi mathvariant="normal">a</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula>; <inline-formula><mml:math id="m7"><mml:mstyle displaystyle="false"><mml:mrow><mml:msub><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mi>u</mml:mi><mml:mi>w</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mn>0.1</mml:mn><mml:mrow><mml:mtext> </mml:mtext></mml:mrow><mml:mi>μ</mml:mi><mml:mrow><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">l</mml:mi></mml:mrow><mml:mtext> </mml:mtext><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mi mathvariant="normal">m</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mtext> </mml:mtext><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mi mathvariant="normal">s</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mtext> </mml:mtext><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mi mathvariant="normal">a</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula>; <inline-formula><mml:math id="m8"><mml:mstyle displaystyle="false"><mml:mrow><mml:mi mathvariant="normal">S</mml:mi><mml:mi mathvariant="normal">R</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mn>0.5</mml:mn></mml:mstyle></mml:math></inline-formula>. Calculations used the following environmental parameter values in this example: <italic>P</italic> = 101.3246 kPa; <italic>r</italic> = 0.2; <inline-formula><mml:math id="m9"><mml:mstyle displaystyle="false"><mml:mrow><mml:mi mathvariant="normal">R</mml:mi><mml:mi mathvariant="normal">H</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mn>0.5</mml:mn></mml:mstyle></mml:math></inline-formula>; <inline-formula><mml:math id="m10"><mml:mstyle displaystyle="false"><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">w</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mn>1000</mml:mn></mml:mstyle></mml:math></inline-formula> W m<sup>−2</sup>; <inline-formula><mml:math id="m11"><mml:mstyle displaystyle="false"><mml:mrow><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mn>298.15</mml:mn></mml:mstyle></mml:math></inline-formula> K; <italic>u</italic> = 2 m s<sup>−1</sup>. See <xref rid="T1" ref-type="table">Table 1</xref> for symbol definitions.</p>
      </caption>
      <graphic xlink:href="plz054f0001"/>
    </fig>
    <table-wrap id="T1" orientation="portrait" position="float">
      <label>Table 1.</label>
      <caption>
        <p>Parameter inputs for <bold>tealeaves</bold>. Each parameter has a mathematical symbol used in the text, the R character string used in the <bold>tealeaves</bold> package, a brief description and the units. For physical constants, a value is provided where applicable, though users can modify these if desired.</p>
      </caption>
      <table frame="vsides" rules="groups">
        <thead>
          <tr>
            <th rowspan="1" colspan="1">Symbol</th>
            <th rowspan="1" colspan="1">R character</th>
            <th rowspan="1" colspan="1">Description</th>
            <th rowspan="1" colspan="1">Units</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td rowspan="1" colspan="1">Leaf parameters:</td>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1"/>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">
              <italic>d</italic>
            </td>
            <td rowspan="1" colspan="1">leafsize</td>
            <td rowspan="1" colspan="1">Leaf characteristic dimension</td>
            <td rowspan="1" colspan="1">m</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">
              <inline-formula>
                <mml:math id="m12">
                  <mml:mstyle displaystyle="false">
                    <mml:mrow>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi>α</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mrow>
                            <mml:mi mathvariant="normal">l</mml:mi>
                          </mml:mrow>
                        </mml:mrow>
                      </mml:msub>
                    </mml:mrow>
                  </mml:mstyle>
                </mml:math>
              </inline-formula>
            </td>
            <td rowspan="1" colspan="1">abs_l</td>
            <td rowspan="1" colspan="1">Absorbtivity of long-wave radiation (4–80 µm)</td>
            <td rowspan="1" colspan="1">None</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">
              <inline-formula>
                <mml:math id="m13">
                  <mml:mstyle displaystyle="false">
                    <mml:mrow>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi>α</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mrow>
                            <mml:mi mathvariant="normal">s</mml:mi>
                          </mml:mrow>
                        </mml:mrow>
                      </mml:msub>
                    </mml:mrow>
                  </mml:mstyle>
                </mml:math>
              </inline-formula>
            </td>
            <td rowspan="1" colspan="1">abs_s</td>
            <td rowspan="1" colspan="1">Absorbtivity of short-wave radiation (0.3–4 µm)</td>
            <td rowspan="1" colspan="1">None</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">
              <inline-formula>
                <mml:math id="m14">
                  <mml:mstyle displaystyle="false">
                    <mml:mrow>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi>g</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mrow>
                            <mml:mi mathvariant="normal">s</mml:mi>
                            <mml:mi mathvariant="normal">w</mml:mi>
                          </mml:mrow>
                        </mml:mrow>
                      </mml:msub>
                    </mml:mrow>
                  </mml:mstyle>
                </mml:math>
              </inline-formula>
            </td>
            <td rowspan="1" colspan="1">g_sw</td>
            <td rowspan="1" colspan="1">Stomatal conductance to water vapour</td>
            <td rowspan="1" colspan="1">µmol m<sup>−2</sup> s<sup>−1</sup> Pa<sup>−1†</sup></td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">
              <inline-formula>
                <mml:math id="m15">
                  <mml:mstyle displaystyle="false">
                    <mml:mrow>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi>g</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mrow>
                            <mml:mi mathvariant="normal">u</mml:mi>
                            <mml:mi mathvariant="normal">w</mml:mi>
                          </mml:mrow>
                        </mml:mrow>
                      </mml:msub>
                    </mml:mrow>
                  </mml:mstyle>
                </mml:math>
              </inline-formula>
            </td>
            <td rowspan="1" colspan="1">g_uw</td>
            <td rowspan="1" colspan="1">Cuticular conductance to water vapour</td>
            <td rowspan="1" colspan="1">µmol m<sup>−2</sup> s<sup>−1</sup> Pa<sup>−1†</sup></td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">SR</td>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1">Stomatal ratio (untransformed)</td>
            <td rowspan="1" colspan="1">None</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">
              <inline-formula>
                <mml:math id="m16">
                  <mml:mstyle displaystyle="false">
                    <mml:mrow>
                      <mml:mi mathvariant="normal">s</mml:mi>
                      <mml:mi mathvariant="normal">r</mml:mi>
                    </mml:mrow>
                  </mml:mstyle>
                </mml:math>
              </inline-formula>
            </td>
            <td rowspan="1" colspan="1">logit_sr</td>
            <td rowspan="1" colspan="1">Stomatal ratio (logit transformed)</td>
            <td rowspan="1" colspan="1">None</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Environmental parameters:</td>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1"/>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">
              <italic>P</italic>
            </td>
            <td rowspan="1" colspan="1">P</td>
            <td rowspan="1" colspan="1">Atmospheric pressure</td>
            <td rowspan="1" colspan="1">kPa</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">
              <italic>r</italic>
            </td>
            <td rowspan="1" colspan="1">r</td>
            <td rowspan="1" colspan="1">Reflectance for short-wave irradiance (albedo)</td>
            <td rowspan="1" colspan="1">None</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">RH</td>
            <td rowspan="1" colspan="1">RH</td>
            <td rowspan="1" colspan="1">Relative humidity</td>
            <td rowspan="1" colspan="1">None</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">
              <italic>S</italic>
              <sub>sw</sub>
            </td>
            <td rowspan="1" colspan="1">S_sw</td>
            <td rowspan="1" colspan="1">Incident short-wave (solar) radiation flux density</td>
            <td rowspan="1" colspan="1">W m<sup>−2</sup></td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">
              <italic>T</italic>
              <sub>air</sub>
            </td>
            <td rowspan="1" colspan="1">T_air</td>
            <td rowspan="1" colspan="1">Air temperature</td>
            <td rowspan="1" colspan="1">K</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">
              <italic>u</italic>
            </td>
            <td rowspan="1" colspan="1">wind</td>
            <td rowspan="1" colspan="1">Wind speed</td>
            <td rowspan="1" colspan="1">m s<sup>−1</sup></td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Physical constants:</td>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1"/>
          </tr>
          <tr>
            <td rowspan="1" colspan="1"><italic>a</italic>, <italic>b</italic>, <italic>c</italic>, <italic>d</italic></td>
            <td rowspan="1" colspan="1">a, b, c, d</td>
            <td rowspan="1" colspan="1">Coefficients for calculating Nu and Sh numbers</td>
            <td rowspan="1" colspan="1">None</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">
              <italic>c</italic>
              <sub>
                <italic>p</italic>
              </sub>
            </td>
            <td rowspan="1" colspan="1">c_p</td>
            <td rowspan="1" colspan="1">Heat capacity of air</td>
            <td rowspan="1" colspan="1">1.01 J g<sup>−1</sup> K<sup>−1</sup></td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">
              <italic>D</italic>
              <sub>h,0</sub>
            </td>
            <td rowspan="1" colspan="1">D_h0</td>
            <td rowspan="1" colspan="1">Diffusion coefficient for heat in air at 0 °C</td>
            <td rowspan="1" colspan="1">19.0 × 10<sup>−6</sup> m<sup>2</sup> s<sup>−1</sup></td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">
              <italic>D</italic>
              <sub>m,0</sub>
            </td>
            <td rowspan="1" colspan="1">D_m0</td>
            <td rowspan="1" colspan="1">Diffusion coefficient for momentum in air at 0 °C</td>
            <td rowspan="1" colspan="1">13.3 × 10<sup>−6</sup> m<sup>2</sup> s<sup>−1</sup></td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">
              <italic>D</italic>
              <sub>w,0</sub>
            </td>
            <td rowspan="1" colspan="1">D_w0</td>
            <td rowspan="1" colspan="1">Diffusion coefficient for water vapour in air at 0 °C</td>
            <td rowspan="1" colspan="1">21.2 × 10<sup>−6</sup> m<sup>2</sup> s<sup>−1</sup></td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">
              <inline-formula>
                <mml:math id="m17">
                  <mml:mstyle displaystyle="false">
                    <mml:mi>ε</mml:mi>
                  </mml:mstyle>
                </mml:math>
              </inline-formula>
            </td>
            <td rowspan="1" colspan="1">epsilon</td>
            <td rowspan="1" colspan="1">Ratio of water to air molar masses</td>
            <td rowspan="1" colspan="1">0.622</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">
              <italic>eT</italic>
            </td>
            <td rowspan="1" colspan="1">eT</td>
            <td rowspan="1" colspan="1">Exponent for temperature dependence of diffusion</td>
            <td rowspan="1" colspan="1">1.75</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">
              <italic>G</italic>
            </td>
            <td rowspan="1" colspan="1">G</td>
            <td rowspan="1" colspan="1">Gravitational acceleration</td>
            <td rowspan="1" colspan="1">9.8 m s<sup>−2</sup></td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">
              <inline-formula>
                <mml:math id="m18">
                  <mml:mstyle displaystyle="false">
                    <mml:mrow>
                      <mml:mover accent="true">
                        <mml:mi>R</mml:mi>
                        <mml:mo stretchy="false">¯</mml:mo>
                      </mml:mover>
                    </mml:mrow>
                  </mml:mstyle>
                </mml:math>
              </inline-formula>
            </td>
            <td rowspan="1" colspan="1">R</td>
            <td rowspan="1" colspan="1">Ideal gas constant</td>
            <td rowspan="1" colspan="1">8.3144598 J mol<sup>−1</sup> K<sup>−1</sup></td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">
              <italic>R</italic>
              <sub>air</sub>
            </td>
            <td rowspan="1" colspan="1">R_air</td>
            <td rowspan="1" colspan="1">Specific gas constant for dry air</td>
            <td rowspan="1" colspan="1">287.058 J kg<sup>−1</sup> K<sup>−1</sup></td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">
              <italic>σ</italic>
            </td>
            <td rowspan="1" colspan="1">s</td>
            <td rowspan="1" colspan="1">Stefan–Boltzmann constant</td>
            <td rowspan="1" colspan="1">5.67 × 10<sup>−8</sup> W m<sup>−2</sup> K<sup>−4</sup></td>
          </tr>
        </tbody>
      </table>
      <table-wrap-foot>
        <fn id="fn-0100">
          <p><sup>†</sup>Conductances are presented in molar units for consistency with literature on photosynthesis but are converted to m s<sup>−1</sup> using the ideal gas law (see text for details) to match conductance to heat transfer.</p>
        </fn>
      </table-wrap-foot>
    </table-wrap>
    <disp-formula>
      <mml:math id="m19">
        <mml:mstyle displaystyle="true">
          <mml:mtable columnalign="left" columnspacing="1">
            <mml:mtr>
              <mml:mtd>
                <mml:mstyle displaystyle="true">
                  <mml:mn>0</mml:mn>
                  <mml:mo>=</mml:mo>
                  <mml:mrow>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>R</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mrow>
                          <mml:mi mathvariant="normal">a</mml:mi>
                          <mml:mi mathvariant="normal">b</mml:mi>
                          <mml:mi mathvariant="normal">s</mml:mi>
                        </mml:mrow>
                      </mml:mrow>
                    </mml:msub>
                  </mml:mrow>
                  <mml:mo>−</mml:mo>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:mrow>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>S</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mrow>
                          <mml:mi mathvariant="normal">r</mml:mi>
                        </mml:mrow>
                      </mml:mrow>
                    </mml:msub>
                  </mml:mrow>
                  <mml:mo>+</mml:mo>
                  <mml:mi>H</mml:mi>
                  <mml:mo>+</mml:mo>
                  <mml:mi>L</mml:mi>
                  <mml:mo stretchy="false">)</mml:mo>
                  <mml:mo>.</mml:mo>
                </mml:mstyle>
              </mml:mtd>
            </mml:mtr>
          </mml:mtable>
        </mml:mstyle>
      </mml:math>
      <label>(1)</label>
    </disp-formula>
    <p><inline-formula><mml:math id="m20"><mml:mstyle displaystyle="false"><mml:mrow><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">b</mml:mi><mml:mi mathvariant="normal">s</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> is the absorbed radiation, <inline-formula><mml:math id="m21"><mml:mstyle displaystyle="false"><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">r</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> is thermal infrared radiation loss, <italic>H</italic> is sensible heat flux and <italic>L</italic> is latent heat flux. All of these values have units W m<sup>−2</sup>. Environmental and leaf parameters like irradiance, air temperature and leaf absorbtivity determine how much energy is absorbed and radiated. In the daytime, radiation coming into the leaf generally exceeds that coming out, resulting in a leaf temperature above air temperature. Sensible heat loss (gain) occurs when the leaf is warmer (cooler) than the surrounding air, but the rate is influenced by other parameters like wind speed and leaf size. Latent heat loss occurs when the water vapor pressure of the surrounding air is lower than that in the leaf, driving evaporation. Relative humidity of the air and leaf conductance to water vapour determine how strong the vapor-pressure deficit is and how much resistance to water transport occurs. Leaves gain energy when water condenses as dew. The leaf energy balance model works by taking a set of environmental and leaf parameters, then finding the leaf temperature at which they balance one another. The equilibrium leaf temperature can be well above air temperature under high irradiance, low wind speed and/or low conductance to water vapor; leaf temperature can be near or even below air temperature under low irradiance, in small leaves and/or leaves with high rates of evaporation.</p>
    <p>The primary aim of this paper is not to extend leaf energy budget theory, but to describe the <bold>tealeaves</bold> package which implements existing models. Therefore, the mathematical details behind the model are provided in an Appendix at the end of this paper. <xref rid="T1" ref-type="table">Tables 1</xref> and <xref rid="T2" ref-type="table">2</xref> list all mathematical symbols in parameter inputs and calculated output values. <xref ref-type="supplementary-material" rid="sup1"><bold>Supporting Information—Table S1</bold></xref> lists current default parameter values and realistic ranges with references to the literature. These equations describe the current <bold>tealeaves</bold> implementation. As future releases will alter some assumptions and incorporate new features, I mention future modifications in the Discussion. In this section, I describe how leaf energy budget models are implemented in R and provide worked examples.</p>
    <table-wrap id="T2" orientation="portrait" position="float">
      <label>Table 2.</label>
      <caption>
        <p>Calculated parameters and outputs for <bold>tealeaves</bold>. Some parameters are intermediate calculations (see Methods) but are not included in the <bold>tealeaves</bold> output (see R documentation accompanying package for further detail). Each parameter has a mathematical symbol used in the text, the R character string used in the <bold>tealeaves</bold> package, a brief description and the units.</p>
      </caption>
      <table frame="vsides" rules="groups">
        <thead>
          <tr>
            <th rowspan="1" colspan="1">Symbol</th>
            <th rowspan="1" colspan="1">R character</th>
            <th rowspan="1" colspan="1">Description</th>
            <th rowspan="1" colspan="1">Units</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td rowspan="1" colspan="1">Leaf parameters:</td>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1"/>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">
              <italic>E</italic>
            </td>
            <td rowspan="1" colspan="1">E</td>
            <td rowspan="1" colspan="1">Transpiration rate</td>
            <td rowspan="1" colspan="1">mol m<sup>−2</sup> s<sup>−1</sup></td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">
              <italic>g</italic>
              <sub>h</sub>
            </td>
            <td rowspan="1" colspan="1">g_h</td>
            <td rowspan="1" colspan="1">Boundary layer conductance to heat</td>
            <td rowspan="1" colspan="1">m s<sup>−1</sup></td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">
              <italic>g</italic>
              <sub>bw</sub>
            </td>
            <td rowspan="1" colspan="1">g_bw</td>
            <td rowspan="1" colspan="1">Boundary layer conductance to water vapour</td>
            <td rowspan="1" colspan="1">m s<sup>−1</sup></td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">
              <italic>g</italic>
              <sub>tw</sub>
            </td>
            <td rowspan="1" colspan="1">g_tw</td>
            <td rowspan="1" colspan="1">Total conductance to water vapour</td>
            <td rowspan="1" colspan="1">m s<sup>−1</sup></td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Gr</td>
            <td rowspan="1" colspan="1">Gr</td>
            <td rowspan="1" colspan="1">Grashof number</td>
            <td rowspan="1" colspan="1">None</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">
              <italic>H</italic>
            </td>
            <td rowspan="1" colspan="1">H</td>
            <td rowspan="1" colspan="1">Sensible heat flux</td>
            <td rowspan="1" colspan="1">W m<sup>−2</sup></td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">
              <italic>L</italic>
            </td>
            <td rowspan="1" colspan="1">L</td>
            <td rowspan="1" colspan="1">Latend heat flux</td>
            <td rowspan="1" colspan="1">W m<sup>−2</sup></td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Nu</td>
            <td rowspan="1" colspan="1">Nu</td>
            <td rowspan="1" colspan="1">Nusselt number</td>
            <td rowspan="1" colspan="1">None</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">
              <italic>R</italic>
              <sub>abs</sub>
            </td>
            <td rowspan="1" colspan="1">R_abs</td>
            <td rowspan="1" colspan="1">Absorbed radiation</td>
            <td rowspan="1" colspan="1">W m<sup>−2</sup></td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Re</td>
            <td rowspan="1" colspan="1">Re</td>
            <td rowspan="1" colspan="1">Reynolds number</td>
            <td rowspan="1" colspan="1">None</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">
              <italic>S</italic>
              <sub>r</sub>
            </td>
            <td rowspan="1" colspan="1">S_r</td>
            <td rowspan="1" colspan="1">Thermal infrared radiation losses</td>
            <td rowspan="1" colspan="1">W m<sup>−2</sup></td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Sh</td>
            <td rowspan="1" colspan="1">Sh</td>
            <td rowspan="1" colspan="1">Sherwood number</td>
            <td rowspan="1" colspan="1">None</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">
              <italic>T</italic>
              <sub>leaf</sub>
            </td>
            <td rowspan="1" colspan="1">T_leaf</td>
            <td rowspan="1" colspan="1">Leaf temperature</td>
            <td rowspan="1" colspan="1">K</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Environmental parameters:</td>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1"/>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">
              <italic>d</italic>
              <sub>wv</sub>
            </td>
            <td rowspan="1" colspan="1">d_wv</td>
            <td rowspan="1" colspan="1">Water vapour pressure differential</td>
            <td rowspan="1" colspan="1">mol m<sup>−3</sup></td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">
              <italic>h</italic>
              <sub>vap</sub>
            </td>
            <td rowspan="1" colspan="1">h_vap</td>
            <td rowspan="1" colspan="1">Latent heat of vapourization</td>
            <td rowspan="1" colspan="1">J mol<sup>−1</sup></td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">
              <italic>P</italic>
              <sub>a</sub>
            </td>
            <td rowspan="1" colspan="1">P_a</td>
            <td rowspan="1" colspan="1">Density of dry air</td>
            <td rowspan="1" colspan="1">g m<sup>−3</sup></td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">
              <italic>p</italic>
              <sub>air</sub>
            </td>
            <td rowspan="1" colspan="1">p_air</td>
            <td rowspan="1" colspan="1">Water vapour pressure of the air</td>
            <td rowspan="1" colspan="1">kPa</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">
              <italic>p</italic>
              <sub>sat</sub>
            </td>
            <td rowspan="1" colspan="1">p_sat</td>
            <td rowspan="1" colspan="1">Saturating water vapour pressure</td>
            <td rowspan="1" colspan="1">kPa</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">
              <italic>S</italic>
              <sub>lw</sub>
            </td>
            <td rowspan="1" colspan="1">S_lw</td>
            <td rowspan="1" colspan="1">Incident long-wave (thermal infrared) radiation flux density</td>
            <td rowspan="1" colspan="1">W m<sup>−2</sup></td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">
              <italic>T</italic>
              <sub>sky</sub>
            </td>
            <td rowspan="1" colspan="1">T_sky</td>
            <td rowspan="1" colspan="1">Clear sky temperature</td>
            <td rowspan="1" colspan="1">K</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Physical constants:</td>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1"/>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">
              <italic>D</italic>
              <sub>h</sub>
            </td>
            <td rowspan="1" colspan="1">D_h</td>
            <td rowspan="1" colspan="1">Diffusion coefficient for heat in air at a given temperature</td>
            <td rowspan="1" colspan="1">m<sup>2</sup> s<sup>−1</sup></td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">
              <italic>D</italic>
              <sub>m</sub>
            </td>
            <td rowspan="1" colspan="1">D_m</td>
            <td rowspan="1" colspan="1">Diffusion coefficient for momentum in air at a given temperature</td>
            <td rowspan="1" colspan="1">m<sup>2</sup> s<sup>−1</sup></td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">
              <italic>D</italic>
              <sub>w</sub>
            </td>
            <td rowspan="1" colspan="1">D_w</td>
            <td rowspan="1" colspan="1">Diffusion coefficient for water vapour in air at a given temperature</td>
            <td rowspan="1" colspan="1">m<sup>2</sup> s<sup>−1</sup></td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Convergence diagnostics:</td>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1"/>
          </tr>
          <tr>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1">value</td>
            <td rowspan="1" colspan="1">Energy balance at equilibrium <italic>T</italic><sub>leaf</sub></td>
            <td rowspan="1" colspan="1">W m<sup>−2</sup></td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1">convergence</td>
            <td rowspan="1" colspan="1">0 = converged; 1 = failed</td>
            <td rowspan="1" colspan="1">none</td>
          </tr>
        </tbody>
      </table>
    </table-wrap>
    <sec id="s3">
      <title>Solving in R</title>
      <p>R is a fully open source programming language for statistical computing that allows users to develop their own packages with new functions. <bold>tealeaves</bold> takes three sets of parameter inputs: leaf parameters, environmental parameters and physical constants (see <xref rid="T1" ref-type="table">Table 1</xref>). The package provides reasonable defaults, but users can input new values to address their question, as I demonstrate in the next section. With one or more parameter sets, <bold>tealeaves</bold> uses the uniroot function in R base package <bold>stats</bold> to find the <inline-formula><mml:math id="m22"><mml:mstyle displaystyle="false"><mml:mrow><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> that balances the leaf energy budget (Equation 1). It outputs the equilibrium <inline-formula><mml:math id="m23"><mml:mstyle displaystyle="false"><mml:mrow><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> and energy fluxes in a table for analysis and visualization.</p>
      <p>Unlike previous leaf energy models, <bold>tealeaves</bold> ensures that calculations are technically correct by assigning stadard SI units with the R package <bold>units</bold><xref rid="CIT0039" ref-type="bibr">Pebesma <italic>et al.</italic> (2016)</xref>. Every parameter and calculated value must have correctly assigned units. If units are not properly defined, <bold>tealeaves</bold> will produce an error because it is unable to convert values. For speed, calculations can optionally be made without units and will yield correct results if provided values have correct units. To ensure accuracy, these unitless functions are tested against their counterparts with units using the <bold>testthat</bold> package (<xref rid="CIT0056" ref-type="bibr">Wickham 2011</xref>). Other R packages that contributed to <bold>tealeaves</bold> are <bold>crayon</bold> (<xref rid="CIT0007" ref-type="bibr">Csárdi 2017</xref>), <bold>dplyr</bold> (<xref rid="CIT0060" ref-type="bibr">Wickham <italic>et al.</italic> 2019</xref>), <bold>glue</bold> (<xref rid="CIT0021" ref-type="bibr">Hester 2019</xref>), <bold>furrr</bold> (<xref rid="CIT0051" ref-type="bibr">Vaughan and Dancho 2018</xref>), <bold>future</bold> (<xref rid="CIT0003" ref-type="bibr">Bengtsson 2019</xref>), <bold>ggplot2</bold> (<xref rid="CIT0057" ref-type="bibr">Wickham 2016</xref>), <bold>magrittr</bold> (<xref rid="CIT0001" ref-type="bibr">Bache and Wickham 2014</xref>), <bold>purrr</bold> (<xref rid="CIT0019" ref-type="bibr">Henry and Wickham 2019a</xref>), <bold>rlang</bold> (<xref rid="CIT0020" ref-type="bibr">Henry and Wickham 2019b</xref>), <bold>stringr</bold> (<xref rid="CIT0060" ref-type="bibr">Wickham 2019</xref>), <bold>tidyr</bold> (<xref rid="CIT0060" ref-type="bibr">Wickham and Henry 2019</xref>).</p>
    </sec>
    <sec id="s4">
      <title>Worked examples</title>
      <p>In this section, I provide two worked examples; more complex worked examples are found in the <xref ref-type="supplementary-material" rid="sup1"><bold>Supporting Information</bold></xref>. The first illustrates that it is straightforward to use <bold>tealeaves</bold> with a few lines of code with default settings. The second shows that it is also possible to model <inline-formula><mml:math id="m24"><mml:mstyle displaystyle="false"><mml:mrow><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> across multiple leaf trait and environmental gradients for more advanced applications.</p>
      <sec id="s5">
        <title>Example 1: a minimum worked example.</title>
        <p>The box below provides R code implementing the minimum worked example with default settings.</p>
        <p>
          <inline-graphic xlink:href="plz054if0001.jpg" mimetype="image"/>
        </p>
      </sec>
      <sec id="s6">
        <title>Example 2: leaf temperature along environmental gradients.</title>
        <p>The box below provides R code to calculate leaf temperature along an air temperature gradient for leaves of different sizes.</p>
        <p>
          <inline-graphic xlink:href="plz054if0002.jpg" mimetype="image"/>
        </p>
      </sec>
    </sec>
    <sec id="s7">
      <title>Extended examples</title>
      <p>To see the range of possible applications for <bold>tealeaves</bold>, I ran four additional sets of simulations. The first models the leaf-to-air temperature differential for different leaves sizes across a gradient of air tempuratures; the second models the leaf-to-air temperature differential across a gradient of incident solar radiation for different stomatal conductances; the third models the leaf-to-air temperature differential for different-sized leaves under free, mixed and forced convection; and the fourth models the effect of stomatal ratio on evaporation under free and forced convection. These extended examples are documented more fully in the <xref ref-type="supplementary-material" rid="sup1"><bold>Supporting Information</bold></xref> with accompanying R code.</p>
      <p>To provide a sense of which leaf and environmental parameters affect <inline-formula><mml:math id="m25"><mml:mstyle displaystyle="false"><mml:mrow><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> the most under ‘typical’ conditions, I varied stomatal conductance (<inline-formula><mml:math id="m26"><mml:mstyle displaystyle="false"><mml:mrow><mml:msub><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">w</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>), leaf size (<italic>d</italic>), stomatal ratio (<inline-formula><mml:math id="m27"><mml:mstyle displaystyle="false"><mml:mrow><mml:mi mathvariant="normal">S</mml:mi><mml:mi mathvariant="normal">R</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>), relative humidity (<inline-formula><mml:math id="m28"><mml:mstyle displaystyle="false"><mml:mrow><mml:mi mathvariant="normal">R</mml:mi><mml:mi mathvariant="normal">H</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>), solar radiation (<inline-formula><mml:math id="m29"><mml:mstyle displaystyle="false"><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">w</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>) and wind speed (<italic>u</italic>) over a wide range of realistic values while holding all other values constant at their default setting <bold>[see</bold><xref ref-type="supplementary-material" rid="sup1"><bold>Supporting Information—Table S1</bold></xref><bold>]</bold>.</p>
    </sec>
  </sec>
  <sec id="s8">
    <title>Results</title>
    <sec id="s9">
      <title>tealeaves’s source code is open to all</title>
      <p>A development version of <bold>tealeaves</bold> is currently available on GitHub (<ext-link ext-link-type="uri" xlink:href="https://github.com/cdmuir/tealeaves">https://github.com/cdmuir/tealeaves</ext-link>). A stable version of <bold>tealeaves</bold> will be released on the Comprehensive R Archive Network (CRAN, <ext-link ext-link-type="uri" xlink:href="https://CRAN.R-project.org/package=tealeaves">https://CRAN.R-project.org/package=tealeaves</ext-link>). I will continue developing the package and depositing revised source code on GitHub between stable release versions. Other plant scientists can contribute code to improve <bold>tealeaves</bold> or modify the source code on their own installations for a more fully customized implementation.</p>
    </sec>
    <sec id="s10">
      <title>tealeaves is straightforward to use and modify</title>
      <p><bold>tealeaves</bold> lowers the activation energy to start using leaf energy budgets in a transparent and reproducible workflow. Default settings provide a reasonable starting point (see Worked Example 1 and <xref ref-type="supplementary-material" rid="sup1"><bold>Supporting Information—Table S1</bold></xref>), but they should be carefully inspected to ensure that are appropriate for particular questions. At default settings, low stomatal conductance, high humidity and/or low wind speed cause leaf temperatures to heat substantially above air temperature <bold>[see</bold><xref ref-type="supplementary-material" rid="sup1"><bold>Supporting Information—Fig. S1A, D and F</bold></xref><bold>]</bold>. Small leaves are closely coupled to air temperature, whereas large leaves are not <bold>[see</bold><xref ref-type="supplementary-material" rid="sup1"><bold>Supporting Information—Fig. S1B</bold></xref><bold>]</bold>. Leaves can operate below air temperature at low light, but above it at higher light <bold>[see</bold><xref ref-type="supplementary-material" rid="sup1"><bold>Supporting Information—Fig. S1E</bold></xref><bold>]</bold>. Stomatal ratio has only a modest effect on leaf temperature <bold>[see</bold><xref ref-type="supplementary-material" rid="sup1"><bold>Supporting Information—Fig. S1C</bold></xref><bold>]</bold>. Most users will want to modify these default settings and simulate leaf temperature over a range of leaf and environmental parameters, so these results are not generalizable to all cases. By design, <bold>tealeaves</bold> easily allows users to define multiple simultaneous trait and environmental gradients (see Worked Example 2 and <xref ref-type="fig" rid="F2">Fig. 2</xref>).</p>
      <fig id="F2" orientation="portrait" position="float">
        <label>Figure 2.</label>
        <caption>
          <p>Extended examples of <bold>tealeaves</bold>. Code to generate these examples is provided in the <xref ref-type="supplementary-material" rid="sup1"><bold>Supporting Information</bold></xref>. (A) The temperature of smaller leaves is more closely coupled to air temperature. Each line represents a different leaf size (small, dashed line; medium, dotted line; large, solid line) and the leaf-to-air temperature differential (<italic>y</italic>-axis) over an air temperature gradient (<italic>x</italic>-axis). (B) Greater stomatal conductance cools leaves. Each line represents a different stomatal conductance (low, dashed line, 1 µmol m<sup>−2</sup> s<sup>−1</sup> Pa<sup>−1</sup>; medium, dotted line, 3 µmol m<sup>−2</sup> s<sup>−1</sup> Pa<sup>−1</sup>; high, solid line, 5 µmol m<sup>−2</sup> s<sup>−1</sup> Pa<sup>−1</sup>) and the leaf-to-air temperature differential (<italic>y</italic>-axis) over a gradient of incident solar radiation (<italic>x</italic>-axis). (C) Forced convection dominates in small leaves; free convection dominates in very large leaves. Leaf size is indicated by line type as in Panel (A). Vertical lines indicate approximate shifts from forced convection (<inline-formula><mml:math id="m30"><mml:mstyle displaystyle="false"><mml:mrow><mml:mi mathvariant="normal">A</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:mrow><mml:mo>&lt;</mml:mo><mml:mn>0.1</mml:mn></mml:mstyle></mml:math></inline-formula>), mixed convection (<inline-formula><mml:math id="m31"><mml:mstyle displaystyle="false"><mml:mn>0.1</mml:mn><mml:mo>&lt;</mml:mo><mml:mrow><mml:mi mathvariant="normal">A</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:mrow><mml:mo>&lt;</mml:mo><mml:mn>10</mml:mn></mml:mstyle></mml:math></inline-formula>) and free convection (<inline-formula><mml:math id="m32"><mml:mstyle displaystyle="false"><mml:mrow><mml:mi mathvariant="normal">A</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:mrow><mml:mo>&gt;</mml:mo><mml:mn>10</mml:mn></mml:mstyle></mml:math></inline-formula>). Small leaves always experience forced convection, leading to lower leaf temperature compared to large leaves experiencing free convection. (D) Amphistomatous leaves (stomatal ratio ~ 0.5) evaporate more than hypo- or hyperstomatous leaves (stomatal ratio ~ 0 or 1, respectively), especially under free convection (low wind speed, <italic>u</italic>).</p>
        </caption>
        <graphic xlink:href="plz054f0002"/>
      </fig>
    </sec>
  </sec>
  <sec id="s11">
    <title>Discussion</title>
    <p>Scientists have used energy budgets to model leaf temperature for over a century (see <xref rid="CIT0040" ref-type="bibr">Raschke (1960)</xref> for historical references). Despite many advances in our understanding of the environmental and leaf parameters that affect heat exchange (<xref rid="CIT0018" ref-type="bibr">Gutschick 2016</xref>), there exist few computational tools to implement complex energy budget models. The <bold>tealeaves</bold> package fills this gap by providing a platform for modelling energy budgets in a transparent and reproducible way with R (<xref rid="CIT0041" ref-type="bibr">R Core Team 2019</xref>), a freely available and widely used programming language for scientific computing. Unlike previous software, <bold>tealeaves</bold> removes ambiguity by forcing users to specify proper SI units through the R package <bold>units</bold> (<xref rid="CIT0039" ref-type="bibr">Pebesma <italic>et al.</italic> 2016</xref>). Neophytes with little experience modelling leaf temperature may get started quickly without having to develop their model <italic>de novo</italic>, while specialists can modify the code to customize <bold>tealeaves</bold> to their specificiations. <bold>tealeaves</bold> also readily integrates with the vast array of data analysis and visualization tools in R. These features will enable wider adoption of leaf energy budgets models to understand plant biology. However, as I discuss below, the current version of <bold>tealeaves</bold> has several important limitiations that can be addressed in future releases.</p>
    <p>Previously, researchers wanting to implement sophisticated leaf energy budget models that required numerical solutions had to write their model and learn a numerical algorithm to solve it. Most often, these solutions are not published and/or are not open source. This slows down research for non-specialists by introducing unnecessary barriers and can be error-prone. For example, the current <bold>tealeaves</bold> model relies on previous work by <xref rid="CIT0013" ref-type="bibr">Foster and Smith (1986)</xref>. Without a platform like <bold>tealeaves</bold>, extending their work required developing the mathematical and computational tools <italic>de novo</italic> every time. Also, the published version of <xref rid="CIT0013" ref-type="bibr">Foster and Smith (1986)</xref> contains several small errors and typographical inconsistencies in the equations. While these are most likely mistakes made during typesetting and publication, without open source code, it is very challenging to determine if these mistakes also occurred in their computer simulations. Transparent, open source code does not prevent mistakes, but makes it easier for the community to discover mistakes and fix them faster.</p>
    <p>The <bold>tealeaves</bold> model is more complex than most other leaf energy balance models in the literature, which makes it more flexible and realistic but more computationally intensive. For example, the R package <bold>plantecophys</bold> (<xref rid="CIT0009" ref-type="bibr">Duursma 2015</xref>) uses the isothermal net radiation approximation of <xref rid="CIT0029" ref-type="bibr">Leuning <italic>et al.</italic> (1995)</xref>. This reduces the number of iterations and speeds up computation by assuming that long-wave radiative flux from the leaf is proportional to air rather than leaf temperature. Other recent models (e.g. <xref rid="CIT0005" ref-type="bibr">Buckley <italic>et al.</italic> 2014</xref>; <xref rid="CIT0046" ref-type="bibr">Schymanski and Or 2017</xref>) assume free convection or do not account for virtual temperature differences in moist air (Equation 14) (<xref rid="CIT0036" ref-type="bibr">Okajima <italic>et al.</italic> 2012</xref>; <xref rid="CIT0009" ref-type="bibr">Duursma 2015</xref>). Other models, except <xref rid="CIT0036" ref-type="bibr">Okajima <italic>et al.</italic> 2012</xref>, also do not account for different surrounding temperatures above and below the leaf surface (<inline-formula><mml:math id="m33"><mml:mstyle displaystyle="false"><mml:mrow><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">k</mml:mi><mml:mi mathvariant="normal">y</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="m34"><mml:mstyle displaystyle="false"><mml:mrow><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>, respectively) when calculating thermal infrared radiation (see Equation 3). These simplifications may be adequate for many applications and the benefit in speed may be necessary for scaling up. However, recent comparisons of simple and complex energy balance models in the field found that the complex models, like that implemented in <bold>tealeaves</bold>, fit the observed distribution of wheat leaf canopy temperatures better (<xref rid="CIT0055" ref-type="bibr">Webber <italic>et al.</italic> 2017</xref>). Future development of <bold>tealeaves</bold> will make it easier to implement simpler models. A full range of models, from simple to complex, will serve the broadest range of applications and allow users to test when simplifying assumptions are justified. To facilitate this, future versions of <bold>tealeaves</bold> will allow users to provide functions rather than values for some parameters. For example, a less computationally intensive model could be contructed by using a function for calculating boundary layer conductances that assume free convection is negligible. Or users could substitute a more appropriate function for their application, such as cloudy rather than clear skies in the case of Equation 3.</p>
    <p>Ultimately, the goal of <bold>tealeaves</bold> is to provide a platform for implementing realistic and fully customizable energy budget models. Such models may take too much computational time to be useful for large-scale ecosystem models, but they can help understand a wider range of fascinating and poorly understood leaf anatomical and morphological features. The Introduction lists several possible uses, but most of these problems cannot currently be solved with <bold>tealeaves</bold> alone. For example, many photosynthetic processes are temperature-sensitive, but it would require simultaneous modelling of leaf temperature, stomatal conductance and photosynthesis to predict optimal trait values. <bold>tealeaves</bold> intentionally does not specify these other models because the concept is that it should stand alone and be able to interact with many other models. For example, <bold>tealeaves</bold> could be combined with a stomatal response function such as the Ball–Berry model (<xref rid="CIT0002" ref-type="bibr">Ball <italic>et al.</italic> 1987</xref>) or found through optimization (<xref rid="CIT0005" ref-type="bibr">Buckley <italic>et al.</italic> 2014</xref>; <xref rid="CIT0009" ref-type="bibr">Duursma 2015</xref>; <xref rid="CIT0034" ref-type="bibr">Muir 2019</xref>). Similarly, the leaf temperature throughout a canopy could be modeled by running <bold>tealeaves</bold> over a gradient of light, wind, temperature and so forth. <bold>tealeaves</bold> should therefore be thought of as one component in an expanding ecosystem of interrelated tools for modelling plant physiology.</p>
    <p>Currently, <bold>tealeaves</bold> has several limitations that I plan to address in future releases. It uses rather simple models of infrared radiation and direct versus diffuse radiation. Ideally, it would be better if users could supply their own functions to calculate these parameters from the total irradiance. The model also assumes leaves are horizontal, whereas leaf orientation varies widely. Following previous authors, I modeled heat transfer as a mixed convection (Equations 9 and 27), but this may not adequately describe real leaf heat exchange (<xref rid="CIT0043" ref-type="bibr">Roth-Nebelsick 2001</xref>). <bold>tealeaves</bold> calculates equilibrium as opposed to transient behavior (<xref rid="CIT0052" ref-type="bibr">Vialet-Chabrand and Lawson 2019</xref>), which may takes several minutes to reach. Finally, the model assumes a single homogenous leaf temperature rather than using finite element modelling to calculate leaf temperature gradients across leaves of different shapes. These are important limitations of the current software which can be addressed in future work.</p>
    <p>In conclusion, <bold>tealeaves</bold> provides new software for leaf energy balance models in R. Leaf energy balance models are highly useful tools for understanding plant form and function and new computational tools will make these models more broadly accessible, advancing basic and applied plant science.</p>
  </sec>
  <sec id="s12">
    <title>Data</title>
    <p>Annotated source code to generate this manuscript is available on GitHub (<ext-link ext-link-type="uri" xlink:href="https://github.com/cdmuir/tealeaves-ms">https://github.com/cdmuir/tealeaves-ms</ext-link>) and archived on Zenodo (<ext-link ext-link-type="doi" xlink:href="10.5281/zenodo.167281492">https://doi.org/10.5281/zenodo.167281492</ext-link>). A development version of <bold>tealeaves</bold> is currently available on GitHub (<ext-link ext-link-type="uri" xlink:href="https://github.com/cdmuir/tealeaves">https://github.com/cdmuir/tealeaves</ext-link>) and the version used for this manuscript is archived on Zenodo (<ext-link ext-link-type="doi" xlink:href="10.5281/zenodo.2808079">https://doi.org/10.5281/zenodo.2808079</ext-link>).</p>
  </sec>
  <sec sec-type="supplementary-material" id="s23">
    <title>Supporting Information</title>
    <p>The following additional information is available in the online version of this article—</p>
    <p><xref ref-type="supplementary-material" rid="sup1"><bold>Table S1.</bold></xref> Reasonable values for <bold>tealeaves</bold> parameter inputs with references to the primary literature. The current version of <bold>tealeaves</bold> uses a default value within the range of reasonable values. See <xref rid="T1" ref-type="table">Table 1</xref> for a key to symbols.</p>
    <p><xref ref-type="supplementary-material" rid="sup1"><bold>Figure S1.</bold></xref> The effect of key leaf (A–C) and environmental (D–F) parameters on leaf temperature, holding other parameters constant. (A) Greater stomatal conductance (<inline-formula><mml:math id="m35"><mml:mstyle displaystyle="false"><mml:mrow><mml:msub><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">w</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> , <italic>x</italic>-axis) reduces leaf temperature through latent heat loss. (B) Larger leaves (<italic>d</italic>, <italic>x</italic>-axis) have thicker boundary layers, causing them to heat up more in the sun. (C) Amphistomatous leaves (SR = 0.5, <italic>x</italic>-axis) lose more water through transpiration than leaves with all stomata on one surface, leading to a lower leaf temperature. (D) Greater humidity (RH, <italic>x</italic>-axis) increases leaf temperature by limiting latent heat loss. (E) With low solar radiation (<inline-formula><mml:math id="m36"><mml:mstyle displaystyle="false"><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">w</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>, <italic>x</italic>-axis), leaf temperature is below air temperature; with high solar radiation, leaf temperature is greater than air temperature. (F) At greater wind speeds (<italic>u</italic>, <italic>x</italic>-axis), leaf temperature is more closely coupled to air temperature. The discontinuity represents the shift from laminar to turbulent flow. For reference, the dashed line is the air temperature in all simulations. All calculations used the following leaf parameter values unless they varied: <italic>d</italic> = 0.1 m; <inline-formula><mml:math id="m37"><mml:mstyle displaystyle="false"><mml:mrow><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">s</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mn>0.5</mml:mn></mml:mstyle></mml:math></inline-formula>; <inline-formula><mml:math id="m38"><mml:mstyle displaystyle="false"><mml:mrow><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">l</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mn>0.97</mml:mn></mml:mstyle></mml:math></inline-formula>; <inline-formula><mml:math id="m39"><mml:mstyle displaystyle="false"><mml:mrow><mml:msub><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">w</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mn>5</mml:mn><mml:mrow><mml:mtext> </mml:mtext></mml:mrow><mml:mi>μ</mml:mi><mml:mrow><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">l</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mi mathvariant="normal">m</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mi mathvariant="normal">s</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mi mathvariant="normal">a</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula>; <inline-formula><mml:math id="m40"><mml:mstyle displaystyle="false"><mml:mrow><mml:msub><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">u</mml:mi><mml:mi mathvariant="normal">w</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mn>0.1</mml:mn><mml:mrow><mml:mtext> </mml:mtext></mml:mrow><mml:mi>μ</mml:mi><mml:mrow><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">l</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mi mathvariant="normal">m</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mi mathvariant="normal">s</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mi mathvariant="normal">a</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula>; <inline-formula><mml:math id="m41"><mml:mstyle displaystyle="false"><mml:mrow><mml:mi mathvariant="normal">S</mml:mi><mml:mi mathvariant="normal">R</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mn>0.5</mml:mn></mml:mstyle></mml:math></inline-formula>. All calculations used the following environmental parameter values unless they varied: <italic>P</italic> = 101.3246 kPa; <italic>r</italic> = 0.2; <inline-formula><mml:math id="m42"><mml:mstyle displaystyle="false"><mml:mrow><mml:mi mathvariant="normal">R</mml:mi><mml:mi mathvariant="normal">H</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mn>0.5</mml:mn></mml:mstyle></mml:math></inline-formula>; <inline-formula><mml:math id="m43"><mml:mstyle displaystyle="false"><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">w</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mn>1000</mml:mn></mml:mstyle></mml:math></inline-formula> W m<sup>−2</sup>; <inline-formula><mml:math id="m44"><mml:mstyle displaystyle="false"><mml:mrow><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mn>298.15</mml:mn></mml:mstyle></mml:math></inline-formula> K; <italic>u</italic> = 2 m s<sup>−1</sup>. See <xref rid="T1" ref-type="table">Table 1</xref> for symbol definitions.</p>
    <supplementary-material content-type="local-data" id="sup1">
      <label>plz054_suppl_Supplementary_Material</label>
      <media xlink:href="plz054_suppl_supplementary_material.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
  <sec id="s24">
    <title>Sources of Funding</title>
    <p>This study received startup funds from the University of Hawai’i.</p>
  </sec>
  <sec id="s25">
    <title>Conflict of Interest</title>
    <p>None declared.</p>
  </sec>
</body>
<back>
  <ack id="a1">
    <title>Acknowledgements</title>
    <p>Daniel Falster and four anonymous reviewers helped improve earlier versions of this manuscript. Tom Buckley kindly explained how to convert conductance from molar to ‘engineering’ units.</p>
  </ack>
  <ref-list id="r1">
    <title>Literature Cited</title>
    <ref id="CIT0001">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name name-style="western"><surname>Bache</surname><given-names>SM</given-names></name>, <name name-style="western"><surname>Wickham</surname><given-names>H</given-names></name></person-group><year>2014</year><source>magrittr: a forward-pipe operator for R. R package version 1.5</source>. <uri xlink:type="simple" xlink:href="http://CRAN.R-project.org/package=magrittr">http://CRAN.R-project.org/package=magrittr</uri>.</mixed-citation>
    </ref>
    <ref id="CIT0002">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name name-style="western"><surname>Ball</surname><given-names>JT</given-names></name>, <name name-style="western"><surname>Woodrow</surname><given-names>IE</given-names></name>, <name name-style="western"><surname>Berry</surname><given-names>JA</given-names></name></person-group><year>1987</year><article-title>A model predicting stomatal conductance and its contribution to the control of photosynthesis under different environmental conditions.</article-title> In: <source>Progress in photosynthesis research</source>. <publisher-name>Dordrecht, Netherlands: Springer</publisher-name>, <fpage>221</fpage>–<lpage>224</lpage>.</mixed-citation>
    </ref>
    <ref id="CIT0003">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name name-style="western"><surname>Bengtsson</surname><given-names>H</given-names></name></person-group><year>2019</year><source>future: unified parallel and distributed processing in R for everyone. R package version 1.13.0</source>. <uri xlink:type="simple" xlink:href="http://CRAN.R-project.org/package=future">http://CRAN.R-project.org/package=future</uri>.</mixed-citation>
    </ref>
    <ref id="CIT0004">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Berry</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Björkman</surname><given-names>O</given-names></name></person-group><year>1980</year><article-title>Photosynthetic response and adaptation to temperature in higher plants</article-title>. <source>Annual Review of Plant Physiology</source><volume>31</volume>:<fpage>491</fpage>–<lpage>543</lpage>.</mixed-citation>
    </ref>
    <ref id="CIT0005">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Buckley</surname><given-names>TN</given-names></name>, <name name-style="western"><surname>Martorell</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Diaz-Espejo</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Tomás</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Medrano</surname><given-names>H</given-names></name></person-group><year>2014</year><article-title>Is stomatal conductance optimized over both time and space in plant crowns? A field test in grapevine (<italic>Vitis vinifera</italic>)</article-title>. <source>Plant, Cell &amp; Environment</source><volume>37</volume>:<fpage>2707</fpage>–<lpage>2721</lpage>.</mixed-citation>
    </ref>
    <ref id="CIT0006">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Crous</surname><given-names>KY</given-names></name></person-group><year>2019</year><article-title>Plant responses to climate warming: physiological adjustments and implications for plant functioning in a future, warmer world</article-title>. <source>American Journal of Botany</source><volume>106</volume>:<fpage>1049</fpage>–<lpage>1051</lpage>.<pub-id pub-id-type="pmid">31429920</pub-id></mixed-citation>
    </ref>
    <ref id="CIT0007">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name name-style="western"><surname>Csárdi</surname><given-names>G</given-names></name></person-group><year>2017</year><source>crayon: colored terminal output. R package version 1.3.4</source>. <uri xlink:type="simple" xlink:href="http://CRAN.R-project.org/package=crayon">http://CRAN.R-project.org/package=crayon</uri>.</mixed-citation>
    </ref>
    <ref id="CIT0008">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Drake</surname><given-names>JE</given-names></name>, <name name-style="western"><surname>Tjoelker</surname><given-names>MG</given-names></name>, <name name-style="western"><surname>Vårhammar</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Medlyn</surname><given-names>B</given-names></name>, <name name-style="western"><surname>Reich</surname><given-names>PB</given-names></name>, <name name-style="western"><surname>Leigh</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Pfautsch</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Blackman</surname><given-names>CJ</given-names></name>, <name name-style="western"><surname>López</surname><given-names>R</given-names></name>, <name name-style="western"><surname>Aspinwall</surname><given-names>MJ</given-names></name>, <name name-style="western"><surname>Crous</surname><given-names>KY</given-names></name>, <name name-style="western"><surname>Duursma</surname><given-names>RA</given-names></name>, <name name-style="western"><surname>Kumarathunge</surname><given-names>D</given-names></name>, <name name-style="western"><surname>De Kauwe</surname><given-names>MG</given-names></name>, <name name-style="western"><surname>Jiang</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Nicotra</surname><given-names>AB</given-names></name>, <name name-style="western"><surname>Tissue</surname><given-names>DT</given-names></name>, <name name-style="western"><surname>Choat</surname><given-names>B</given-names></name>, <name name-style="western"><surname>Atkin</surname><given-names>OK</given-names></name>, <name name-style="western"><surname>Barton</surname><given-names>CVM</given-names></name></person-group><year>2018</year><article-title>Trees tolerate an extreme heatwave via sustained transpirational cooling and increased leaf thermal tolerance</article-title>. <source>Global Change Biology</source><volume>24</volume>:<fpage>2390</fpage>–<lpage>2402</lpage>.<pub-id pub-id-type="pmid">29316093</pub-id></mixed-citation>
    </ref>
    <ref id="CIT0009">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Duursma</surname><given-names>RA</given-names></name></person-group><year>2015</year><article-title>Plantecophys - an R package for analysing and modelling leaf gas exchange data</article-title>. <source>PLoS One</source><volume>10</volume>:<fpage>e0143346</fpage>.<pub-id pub-id-type="pmid">26581080</pub-id></mixed-citation>
    </ref>
    <ref id="CIT0010">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Duursma</surname><given-names>RA</given-names></name>, <name name-style="western"><surname>Blackman</surname><given-names>CJ</given-names></name>, <name name-style="western"><surname>Lopéz</surname><given-names>R</given-names></name>, <name name-style="western"><surname>Martin-StPaul</surname><given-names>NK</given-names></name>, <name name-style="western"><surname>Cochard</surname><given-names>H</given-names></name>, <name name-style="western"><surname>Medlyn</surname><given-names>BE</given-names></name></person-group><year>2019</year><article-title>On the minimum leaf conductance: its role in models of plant water use, and ecological and environmental controls</article-title>. <source>New Phytologist</source><volume>221</volume>:<fpage>693</fpage>–<lpage>705</lpage>.<pub-id pub-id-type="pmid">30144393</pub-id></mixed-citation>
    </ref>
    <ref id="CIT0011">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Ehleringer</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Björkman</surname><given-names>O</given-names></name>, <name name-style="western"><surname>Mooney</surname><given-names>HA</given-names></name></person-group><year>1976</year><article-title>Leaf pubescence: effects on absorptance and photosynthesis in a desert shrub</article-title>. <source>Science</source><volume>192</volume>:<fpage>376</fpage>–<lpage>377</lpage>.<pub-id pub-id-type="pmid">17758964</pub-id></mixed-citation>
    </ref>
    <ref id="CIT0012">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Ferris</surname><given-names>KG</given-names></name>, <name name-style="western"><surname>Rushton</surname><given-names>T</given-names></name>, <name name-style="western"><surname>Greenlee</surname><given-names>AB</given-names></name>, <name name-style="western"><surname>Toll</surname><given-names>K</given-names></name>, <name name-style="western"><surname>Blackman</surname><given-names>BK</given-names></name>, <name name-style="western"><surname>Willis</surname><given-names>JH</given-names></name></person-group><year>2015</year><article-title>Leaf shape evolution has a similar genetic architecture in three edaphic specialists within the <italic>Mimulus guttatus</italic> species complex</article-title>. <source>Annals of Botany</source><volume>116</volume>:<fpage>213</fpage>–<lpage>223</lpage>.<pub-id pub-id-type="pmid">26070644</pub-id></mixed-citation>
    </ref>
    <ref id="CIT0013">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Foster</surname><given-names>JR</given-names></name>, <name name-style="western"><surname>Smith</surname><given-names>WK</given-names></name></person-group><year>1986</year><article-title>Influence of stomatal distribution on transpiration in low-wind environments</article-title>. <source>Plant, Cell &amp; Environment</source><volume>9</volume>:<fpage>751</fpage>–<lpage>759</lpage>.</mixed-citation>
    </ref>
    <ref id="CIT0014">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Gates</surname><given-names>DM</given-names></name></person-group><year>1965</year><article-title>Energy, plants, and ecology</article-title>. <source>Ecology</source><volume>46</volume>:<fpage>1</fpage>–<lpage>13</lpage>.</mixed-citation>
    </ref>
    <ref id="CIT0015">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Gates</surname><given-names>DM</given-names></name></person-group><year>1968</year><article-title>Transpiration and leaf temperature</article-title>. <source>Annual Review of Plant Physiology</source><volume>19</volume>:<fpage>211</fpage>–<lpage>238</lpage>.</mixed-citation>
    </ref>
    <ref id="CIT0016">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Gibson</surname><given-names>AC</given-names></name></person-group><year>1998</year><article-title>Photosynthetic organs of desert plants</article-title>. <source>Bioscience</source><volume>48</volume>:<fpage>911</fpage>–<lpage>920</lpage>.</mixed-citation>
    </ref>
    <ref id="CIT0017">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Grace</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Wilson</surname><given-names>J</given-names></name></person-group><year>1976</year><article-title>The boundary layer over a <italic>Populus</italic> leaf</article-title>. <source>Journal of Experimental Botany</source><volume>27</volume>:<fpage>231</fpage>–<lpage>241</lpage>.</mixed-citation>
    </ref>
    <ref id="CIT0018">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name name-style="western"><surname>Gutschick</surname><given-names>VP</given-names></name></person-group><year>2016</year><source>Leaf energy balance: basics and modeling from leaves to canopies</source>. <publisher-loc>Dordrecht</publisher-loc>: <publisher-name>Springer Netherlands</publisher-name>, <fpage>23</fpage>–<lpage>58</lpage>.</mixed-citation>
    </ref>
    <ref id="CIT0019">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name name-style="western"><surname>Henry</surname><given-names>L</given-names></name>, <name name-style="western"><surname>Wickham</surname><given-names>H</given-names></name></person-group><year>2019a</year><source>purrr: functional programming tools. R package version 0.3.2</source>. <uri xlink:type="simple" xlink:href="http://CRAN.R-project.org/package=purrr">http://CRAN.R-project.org/package=purrr</uri>.</mixed-citation>
    </ref>
    <ref id="CIT0020">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name name-style="western"><surname>Henry</surname><given-names>L</given-names></name>, <name name-style="western"><surname>Wickham</surname><given-names>H</given-names></name></person-group><year>2019b</year><source>rlang: functions for base types and core R and ‘Tidyverse’ features. R package version 0.3.4</source>. <uri xlink:type="simple" xlink:href="http://CRAN.R-project.org/package=rlang">http://CRAN.R-project.org/package=rlang</uri>.</mixed-citation>
    </ref>
    <ref id="CIT0021">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name name-style="western"><surname>Hester</surname><given-names>J</given-names></name></person-group><year>2019</year><source>glue: interpreted string literals. R package version 1.3.1</source>. <uri xlink:type="simple" xlink:href="http://CRAN.R-project.org/package=glue">http://CRAN.R-project.org/package=glue</uri>.</mixed-citation>
    </ref>
    <ref id="CIT0022">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Huner</surname><given-names>NP</given-names></name>, <name name-style="western"><surname>Öquist</surname><given-names>G</given-names></name>, <name name-style="western"><surname>Hurry</surname><given-names>VM</given-names></name>, <name name-style="western"><surname>Krol</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Falk</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Griffith</surname><given-names>M</given-names></name></person-group><year>1993</year><article-title>Photosynthesis, photoinhibition and low temperature acclimation in cold tolerant plants</article-title>. <source>Photosynthesis Research</source><volume>37</volume>:<fpage>19</fpage>–<lpage>39</lpage>.<pub-id pub-id-type="pmid">24317651</pub-id></mixed-citation>
    </ref>
    <ref id="CIT0023">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name name-style="western"><surname>Jones</surname><given-names>HG</given-names></name></person-group><year>2014</year><article-title>Plants and microclimate</article-title>. <source>Cambridge, UK: Cambridge University Press.</source></mixed-citation>
    </ref>
    <ref id="CIT0024">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Jordan</surname><given-names>DN</given-names></name>, <name name-style="western"><surname>Smith</surname><given-names>WK</given-names></name></person-group><year>1994</year><article-title>Energy balance analysis of nighttime leaf temperatures and frost formation in a subalpine environment</article-title>. <source>Agricultural and Forest Meteorology</source><volume>71</volume>:<fpage>359</fpage>–<lpage>372</lpage>.</mixed-citation>
    </ref>
    <ref id="CIT0025">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Karbulková</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Schreiber</surname><given-names>L</given-names></name>, <name name-style="western"><surname>Macek</surname><given-names>P</given-names></name>, <name name-style="western"><surname>Šantruček</surname><given-names>J</given-names></name></person-group><year>2008</year><article-title>Differences between water permeability of astomatous and stomatous cuticular membranes: effects of air humidity in two species of contrasting drought-resistance strategy</article-title>. <source>Journal of Experimental Botany</source><volume>59</volume>:<fpage>3987</fpage>–<lpage>3995</lpage>.<pub-id pub-id-type="pmid">18836141</pub-id></mixed-citation>
    </ref>
    <ref id="CIT0026">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Körner</surname><given-names>C</given-names></name></person-group><year>2007</year><article-title>The use of ‘altitude‘ in ecological research</article-title>. <source>Trends in Ecology and Evolution</source><volume>22</volume>:<fpage>569</fpage>–<lpage>574</lpage>.<pub-id pub-id-type="pmid">17988759</pub-id></mixed-citation>
    </ref>
    <ref id="CIT0027">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Leigh</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Sevanto</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Ball</surname><given-names>MC</given-names></name>, <name name-style="western"><surname>Close</surname><given-names>JD</given-names></name>, <name name-style="western"><surname>Ellsworth</surname><given-names>DS</given-names></name>, <name name-style="western"><surname>Knight</surname><given-names>CA</given-names></name>, <name name-style="western"><surname>Nicotra</surname><given-names>AB</given-names></name>, <name name-style="western"><surname>Vogel</surname><given-names>S</given-names></name></person-group><year>2012</year><article-title>Do thick leaves avoid thermal damage in critically low wind speeds?</article-title><source>New Phytologist</source><volume>194</volume>:<fpage>477</fpage>–<lpage>487</lpage>.<pub-id pub-id-type="pmid">22296328</pub-id></mixed-citation>
    </ref>
    <ref id="CIT0028">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Leigh</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Sevanto</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Close</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Nicotra</surname><given-names>A</given-names></name></person-group><year>2017</year><article-title>The influence of leaf size and shape on leaf thermal dynamics: does theory hold up under natural conditions?</article-title><source>Plant, Cell &amp; Environment</source><volume>40</volume>:<fpage>237</fpage>–<lpage>248</lpage>.</mixed-citation>
    </ref>
    <ref id="CIT0029">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Leuning</surname><given-names>R</given-names></name>, <name name-style="western"><surname>Kelliher</surname><given-names>FM</given-names></name>, <name name-style="western"><surname>de Pury</surname><given-names>DGG</given-names></name>, <name name-style="western"><surname>Schulze</surname><given-names>ED</given-names></name></person-group><year>1995</year><article-title>Leaf nitrogen, photosynthesis, conductance and transpiration: scaling from leaves to canopies</article-title>. <source>Plant, Cell &amp; Environment</source><volume>18</volume>:<fpage>1183</fpage>–<lpage>1200</lpage>.</mixed-citation>
    </ref>
    <ref id="CIT0030">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Lin</surname><given-names>YS</given-names></name>, <name name-style="western"><surname>Medlyn</surname><given-names>BE</given-names></name>, <name name-style="western"><surname>Duursma</surname><given-names>RA</given-names></name>, <name name-style="western"><surname>Prentice</surname><given-names>IC</given-names></name>, <name name-style="western"><surname>Wang</surname><given-names>H</given-names></name>, <name name-style="western"><surname>Baig</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Eamus</surname><given-names>D</given-names></name>, <name name-style="western"><surname>de Dios</surname><given-names>VR</given-names></name>, <name name-style="western"><surname>Mitchell</surname><given-names>P</given-names></name>, <name name-style="western"><surname>Ellsworth</surname><given-names>DS</given-names></name>, <name name-style="western"><surname>de Beeck</surname><given-names>MO</given-names></name>, <name name-style="western"><surname>Wallin</surname><given-names>G</given-names></name>, <name name-style="western"><surname>Uddling</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Tarvainen</surname><given-names>L</given-names></name>, <name name-style="western"><surname>Linderson</surname><given-names>ML</given-names></name>, <name name-style="western"><surname>Cernusak</surname><given-names>LA</given-names></name>, <name name-style="western"><surname>Nippert</surname><given-names>JB</given-names></name>, <name name-style="western"><surname>Ocheltree</surname><given-names>TW</given-names></name>, <name name-style="western"><surname>Tissue</surname><given-names>DT</given-names></name>, <name name-style="western"><surname>Martin-StPaul</surname><given-names>NK</given-names></name>, <name name-style="western"><surname>Rogers</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Warren</surname><given-names>JM</given-names></name>, <name name-style="western"><surname>Angelis</surname><given-names>PD</given-names></name>, <name name-style="western"><surname>Hikosaka</surname><given-names>K</given-names></name>, <name name-style="western"><surname>Han</surname><given-names>Q</given-names></name>, <name name-style="western"><surname>Onoda</surname><given-names>Y</given-names></name>, <name name-style="western"><surname>Gimeno</surname><given-names>TE</given-names></name>, <name name-style="western"><surname>Barton</surname><given-names>CVM</given-names></name>, <name name-style="western"><surname>Bennie</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Bonal</surname><given-names>D</given-names></name>, <name name-style="western"><surname>Bosc</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Low</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Macinins-Ng</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Rey</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Rowland</surname><given-names>L</given-names></name>, <name name-style="western"><surname>Setterfield</surname><given-names>SA</given-names></name>, <name name-style="western"><surname>Tausz-Posch</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Zaragoza-Castells</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Broadmeadow</surname><given-names>MSJ</given-names></name>, <name name-style="western"><surname>Drake</surname><given-names>JE</given-names></name>, <name name-style="western"><surname>Freeman</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Ghannoum</surname><given-names>O</given-names></name>, <name name-style="western"><surname>Hutley</surname><given-names>LB</given-names></name>, <name name-style="western"><surname>Kelly</surname><given-names>JW</given-names></name>, <name name-style="western"><surname>Kikuzawa</surname><given-names>K</given-names></name>, <name name-style="western"><surname>Kolari</surname><given-names>P</given-names></name>, <name name-style="western"><surname>Koyama</surname><given-names>K</given-names></name>, <name name-style="western"><surname>Limousin</surname><given-names>JM</given-names></name>, <name name-style="western"><surname>Meir</surname><given-names>P</given-names></name>, <name name-style="western"><surname>da Costa</surname><given-names>ACL</given-names></name>, <name name-style="western"><surname>Mikkelsen</surname><given-names>TN</given-names></name>, <name name-style="western"><surname>Salinas</surname><given-names>N</given-names></name>, <name name-style="western"><surname>Sun</surname><given-names>W</given-names></name>, <name name-style="western"><surname>Wingate</surname><given-names>L</given-names></name></person-group><year>2015</year><article-title>Optimal stomatal behaviour around the world</article-title>. <source>Nature Climate Change</source><volume>5</volume>:<fpage>459</fpage>.</mixed-citation>
    </ref>
    <ref id="CIT0031">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Michaletz</surname><given-names>ST</given-names></name>, <name name-style="western"><surname>Weiser</surname><given-names>MD</given-names></name>, <name name-style="western"><surname>McDowell</surname><given-names>NG</given-names></name>, <name name-style="western"><surname>Zhou</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Kaspari</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Helliker</surname><given-names>BR</given-names></name>, <name name-style="western"><surname>Enquist</surname><given-names>BJ</given-names></name></person-group><year>2016</year><article-title>The energetic and carbon economic origins of leaf thermoregulation</article-title>. <source>Nature Plants</source><volume>2</volume>:<fpage>16129</fpage>.<pub-id pub-id-type="pmid">27548589</pub-id></mixed-citation>
    </ref>
    <ref id="CIT0032">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name name-style="western"><surname>Monteith</surname><given-names>JL</given-names></name>, <name name-style="western"><surname>Unsworth</surname><given-names>MH</given-names></name></person-group><year>2013</year><source>Principles of environmental physics</source>, <edition>4</edition>th edn. <publisher-name>Oxford, UK: Academic Press</publisher-name>.</mixed-citation>
    </ref>
    <ref id="CIT0033">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Muir</surname><given-names>CD</given-names></name></person-group><year>2015</year><article-title>Making pore choices: repeated regime shifts in stomatal ratio</article-title>. <source>Proceedings of the Royal Society B: Biological Sciences</source><volume>282</volume>:<fpage>20151498</fpage>.</mixed-citation>
    </ref>
    <ref id="CIT0034">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Muir</surname><given-names>CD</given-names></name></person-group><year>2019</year><article-title>Is amphistomy an adaptation to high light? Optimality models of stomatal traits along light gradients</article-title>. <source>Integrative and Comparative Biology </source><volume>59</volume>:<fpage>571</fpage>–<lpage>584</lpage>.<pub-id pub-id-type="pmid">31141118</pub-id></mixed-citation>
    </ref>
    <ref id="CIT0035">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name name-style="western"><surname>Nobel</surname><given-names>PS</given-names></name></person-group><year>2009</year><source>Physicochemical and environmental plant physiology</source>, <edition>4</edition>th edn. <publisher-loc>Oxford</publisher-loc>: <publisher-name>Academic Press</publisher-name>.</mixed-citation>
    </ref>
    <ref id="CIT0036">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Okajima</surname><given-names>Y</given-names></name>, <name name-style="western"><surname>Taneda</surname><given-names>H</given-names></name>, <name name-style="western"><surname>Noguchi</surname><given-names>K</given-names></name>, <name name-style="western"><surname>Terashima</surname><given-names>I</given-names></name></person-group><year>2012</year><article-title>Optimum leaf size predicted by a novel leaf energy balance model incorporating dependencies of photosynthesis on light and temperature</article-title>. <source>Ecological Research</source><volume>27</volume>:<fpage>333</fpage>–<lpage>346</lpage>.</mixed-citation>
    </ref>
    <ref id="CIT0037">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>O’Sullivan</surname><given-names>OS</given-names></name>, <name name-style="western"><surname>Heskel</surname><given-names>MA</given-names></name>, <name name-style="western"><surname>Reich</surname><given-names>PB</given-names></name>, <name name-style="western"><surname>Tjoelker</surname><given-names>MG</given-names></name>, <name name-style="western"><surname>Weerasinghe</surname><given-names>LK</given-names></name>, <name name-style="western"><surname>Penillard</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Zhu</surname><given-names>L</given-names></name>, <name name-style="western"><surname>Egerton</surname><given-names>JJG</given-names></name>, <name name-style="western"><surname>Bloomfield</surname><given-names>KJ</given-names></name>, <name name-style="western"><surname>Creek</surname><given-names>D</given-names></name>, <name name-style="western"><surname>Bahar</surname><given-names>NHA</given-names></name>, <name name-style="western"><surname>Griffin</surname><given-names>KL</given-names></name>, <name name-style="western"><surname>Hurry</surname><given-names>V</given-names></name>, <name name-style="western"><surname>Meir</surname><given-names>P</given-names></name>, <name name-style="western"><surname>Turnbull</surname><given-names>MH</given-names></name>, <name name-style="western"><surname>Atkin</surname><given-names>OK</given-names></name></person-group><year>2017</year><article-title>Thermal limits of leaf metabolism across biomes</article-title>. <source>Global Change Biology</source><volume>23</volume>:<fpage>209</fpage>–<lpage>223</lpage>.<pub-id pub-id-type="pmid">27562605</pub-id></mixed-citation>
    </ref>
    <ref id="CIT0038">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Parkhurst</surname><given-names>DF</given-names></name>, <name name-style="western"><surname>Loucks</surname><given-names>O</given-names></name></person-group><year>1972</year><article-title>Optimal leaf size in relation to environment</article-title>. <source>The Journal of Ecology</source><volume>60</volume>:<fpage>505</fpage>–<lpage>537</lpage>.</mixed-citation>
    </ref>
    <ref id="CIT0039">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Pebesma</surname><given-names>E</given-names></name>, <name name-style="western"><surname>Mailund</surname><given-names>T</given-names></name>, <name name-style="western"><surname>Hiebert</surname><given-names>J</given-names></name></person-group><year>2016</year><article-title>Measurement units in R</article-title>. <source>The R Journal</source><volume>8</volume>:<fpage>486</fpage>–<lpage>494</lpage>.</mixed-citation>
    </ref>
    <ref id="CIT0040">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Raschke</surname><given-names>K</given-names></name></person-group><year>1960</year><article-title>Heat transfer between the plant and the environment</article-title>. <source>Annual Review of Plant Physiology</source><volume>11</volume>:<fpage>111</fpage>–<lpage>126</lpage>.</mixed-citation>
    </ref>
    <ref id="CIT0041">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><collab>R Core Team.</collab></person-group><year>2019</year><source>R: a language and environment for statistical computing</source>. <publisher-loc>Vienna, Austria</publisher-loc>: <publisher-name>R Foundation for Statistical Computing</publisher-name>.</mixed-citation>
    </ref>
    <ref id="CIT0042">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Rogers</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Medlyn</surname><given-names>BE</given-names></name>, <name name-style="western"><surname>Dukes</surname><given-names>JS</given-names></name>, <name name-style="western"><surname>Bonan</surname><given-names>G</given-names></name>, <name name-style="western"><surname>von Caemmerer</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Dietze</surname><given-names>MC</given-names></name>, <name name-style="western"><surname>Kattge</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Leakey</surname><given-names>ADB</given-names></name>, <name name-style="western"><surname>Mercado</surname><given-names>LM</given-names></name>, <name name-style="western"><surname>Niinemets</surname><given-names>Ü</given-names></name>, <name name-style="western"><surname>Prentice</surname><given-names>IC</given-names></name>, <name name-style="western"><surname>Serbin</surname><given-names>SP</given-names></name>, <name name-style="western"><surname>Sitch</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Way</surname><given-names>DA</given-names></name>, <name name-style="western"><surname>Zaehle</surname><given-names>S</given-names></name></person-group><year>2017</year><article-title>A roadmap for improving the representation of photosynthesis in earth system models</article-title>. <source>New Phytologist</source><volume>213</volume>:<fpage>22</fpage>–<lpage>42</lpage>.<pub-id pub-id-type="pmid">27891647</pub-id></mixed-citation>
    </ref>
    <ref id="CIT0043">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Roth-Nebelsick</surname><given-names>A</given-names></name></person-group><year>2001</year><article-title>Computer-based analysis of steady-state and transient heat transfer of small-sized leaves by free and mixed convection</article-title>. <source>Plant, Cell &amp; Environment</source><volume>24</volume>:<fpage>631</fpage>–<lpage>640</lpage>.</mixed-citation>
    </ref>
    <ref id="CIT0044">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Sage</surname><given-names>RF</given-names></name>, <name name-style="western"><surname>Kubien</surname><given-names>DS</given-names></name></person-group><year>2007</year><article-title>The temperature response of C<sub>3</sub> and C<sub>4</sub> photosynthesis</article-title>. <source>Plant, Cell &amp; Environment</source><volume>30</volume>:<fpage>1086</fpage>–<lpage>1106</lpage>.</mixed-citation>
    </ref>
    <ref id="CIT0045">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Schymanski</surname><given-names>SJ</given-names></name>, <name name-style="western"><surname>Or</surname><given-names>D</given-names></name></person-group><year>2016</year><article-title>Wind increases leaf water use efficiency</article-title>. <source>Plant, Cell &amp; Environment</source><volume>39</volume>:<fpage>1448</fpage>–<lpage>1459</lpage>.</mixed-citation>
    </ref>
    <ref id="CIT0046">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Schymanski</surname><given-names>SJ</given-names></name>, <name name-style="western"><surname>Or</surname><given-names>D</given-names></name></person-group><year>2017</year><article-title>Leaf-scale experiments reveal an important omission in the Penman-Monteith equation</article-title>. <source>Hydrology &amp; Earth System Sciences</source><volume>21</volume>:<fpage>685</fpage>–<lpage>706</lpage>.</mixed-citation>
    </ref>
    <ref id="CIT0047">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Schymanski</surname><given-names>SJ</given-names></name>, <name name-style="western"><surname>Or</surname><given-names>D</given-names></name>, <name name-style="western"><surname>Zwieniecki</surname><given-names>M</given-names></name></person-group><year>2013</year><article-title>Stomatal control and leaf thermal and hydraulic capacitances under rapid environmental fluctuations</article-title>. <source>PLoS One</source><volume>8</volume>:<fpage>1</fpage>–<lpage>16</lpage>.</mixed-citation>
    </ref>
    <ref id="CIT0048">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name name-style="western"><surname>Stull</surname><given-names>RB</given-names></name></person-group><year>2011</year><source>Meteorology for scientists and engineers</source>, <edition>3</edition>rd edn. <publisher-loc>Vancouver, Canada</publisher-loc>: <publisher-name>University of British Columbia</publisher-name>.</mixed-citation>
    </ref>
    <ref id="CIT0049">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name name-style="western"><surname>Taylor</surname><given-names>SE</given-names></name></person-group><year>1975</year><source>Optimal leaf form</source>. <publisher-loc>New York</publisher-loc>: <publisher-name>Springer-Verlag</publisher-name>, <fpage>73</fpage>–<lpage>86</lpage>.</mixed-citation>
    </ref>
    <ref id="CIT0050">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><name name-style="western"><surname>Tu</surname><given-names>KP</given-names></name></person-group><year>2019</year><article-title>Leaf Energy Balance</article-title>. <ext-link ext-link-type="uri" xlink:href="http://Landflux.org">http://Landflux.org</ext-link>.</mixed-citation>
    </ref>
    <ref id="CIT0051">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name name-style="western"><surname>Vaughan</surname><given-names>D</given-names></name>, <name name-style="western"><surname>Dancho</surname><given-names>M</given-names></name></person-group><year>2018</year><source>furrr: apply mapping functions in parallel using futures. R package version 0.1.0</source>.</mixed-citation>
    </ref>
    <ref id="CIT0052">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Vialet-Chabrand</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Lawson</surname><given-names>T</given-names></name></person-group><year>2019</year><article-title>Dynamic leaf energy balance: deriving stomatal conductance from thermal imaging in a dynamic environment</article-title>. <source>Journal of Experimental Botany</source><volume>70</volume>:<fpage>2839</fpage>–<lpage>2855</lpage>.<pub-id pub-id-type="pmid">30793211</pub-id></mixed-citation>
    </ref>
    <ref id="CIT0053">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Vogel</surname><given-names>S</given-names></name></person-group><year>2009</year><article-title>Leaves in the lowest and highest winds: temperature, force and shape</article-title>. <source>New Phytologist</source><volume>183</volume>:<fpage>13</fpage>–<lpage>26</lpage>.<pub-id pub-id-type="pmid">19413689</pub-id></mixed-citation>
    </ref>
    <ref id="CIT0054">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name name-style="western"><surname>Vömel</surname><given-names>H</given-names></name></person-group><year>2016</year><source>Saturation vapor pressure formulations</source>. <uri xlink:type="simple" xlink:href="https://www.eas.ualberta.ca/jdwilson/EAS372_13/Vomel_CIRES_satvpformulae.html">https://www.eas.ualberta.ca/jdwilson/EAS372_13/Vomel_CIRES_satvpformulae.html</uri>.</mixed-citation>
    </ref>
    <ref id="CIT0055">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Webber</surname><given-names>H</given-names></name>, <name name-style="western"><surname>Martre</surname><given-names>P</given-names></name>, <name name-style="western"><surname>Asseng</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Kimball</surname><given-names>B</given-names></name>, <name name-style="western"><surname>White</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Ottman</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Wall</surname><given-names>GW</given-names></name>, <name name-style="western"><surname>Sanctis</surname><given-names>GD</given-names></name>, <name name-style="western"><surname>Doltra</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Grant</surname><given-names>R</given-names></name>, <name name-style="western"><surname>Kassie</surname><given-names>B</given-names></name>, <name name-style="western"><surname>Maiorano</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Olesen</surname><given-names>JE</given-names></name>, <name name-style="western"><surname>Ripoche</surname><given-names>D</given-names></name>, <name name-style="western"><surname>Rezaei</surname><given-names>EE</given-names></name>, <name name-style="western"><surname>Semenov</surname><given-names>MA</given-names></name>, <name name-style="western"><surname>Stratonovitch</surname><given-names>P</given-names></name>, <name name-style="western"><surname>Ewert</surname><given-names>F</given-names></name></person-group><year>2017</year><article-title>Canopy temperature for simulation of heat stress in irrigated wheat in a semi-arid environment: a multi-model comparison</article-title>. <source>Field Crops Research</source><volume>202</volume>:<fpage>21</fpage>–<lpage>35</lpage>. Modeling crops from genotype to phenotype in a changing climate.</mixed-citation>
    </ref>
    <ref id="CIT0056">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Wickham</surname><given-names>H</given-names></name></person-group><year>2011</year><article-title>testthat: get started with testing</article-title>. <source>The R Journal</source><volume>3</volume>:<fpage>5</fpage>–<lpage>10</lpage>.</mixed-citation>
    </ref>
    <ref id="CIT0057">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name name-style="western"><surname>Wickham</surname><given-names>H</given-names></name></person-group><year>2016</year><source>ggplot2: elegant graphics for data analysis</source>. <publisher-loc>New York</publisher-loc>: <publisher-name>Springer-Verlag</publisher-name>.</mixed-citation>
    </ref>
    <ref id="CIT0058">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name name-style="western"><surname>Wickham</surname><given-names>H</given-names></name></person-group><year>2019</year><source>stringr: simple, consistent wrappers for common string operations. R package version 1.4.0</source>. <uri xlink:type="simple" xlink:href="http://CRAN.R-project.org/package=stringr">http://CRAN.R-project.org/package=stringr</uri>.</mixed-citation>
    </ref>
    <ref id="CIT0059">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name name-style="western"><surname>Wickham</surname><given-names>H</given-names></name>, <name name-style="western"><surname>Francois</surname><given-names>R</given-names></name>, <name name-style="western"><surname>Henry</surname><given-names>L</given-names></name>, <name name-style="western"><surname>Muller</surname><given-names>K</given-names></name></person-group><year>2019</year><source>dplyr: a grammar of data manipulation. R package version 0.8.0.1</source>. <uri xlink:type="simple" xlink:href="http://CRAN.R-project.org/package=dplyr">http://CRAN.R-project.org/package=dplyr</uri>.</mixed-citation>
    </ref>
    <ref id="CIT0060">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name name-style="western"><surname>Wickham</surname><given-names>H</given-names></name>, <name name-style="western"><surname>Henry</surname><given-names>L</given-names></name></person-group><year>2019</year><source>tidyr: easily tidy data with ‘spread()’ and ‘gather()’ functions. R package version 0.8.3</source>. <uri xlink:type="simple" xlink:href="http://CRAN.R-project.org/package=tidyr">http://CRAN.R-project.org/package=tidyr</uri>.</mixed-citation>
    </ref>
    <ref id="CIT0061">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Wright</surname><given-names>IJ</given-names></name>, <name name-style="western"><surname>Dong</surname><given-names>N</given-names></name>, <name name-style="western"><surname>Maire</surname><given-names>V</given-names></name>, <name name-style="western"><surname>Prentice</surname><given-names>IC</given-names></name>, <name name-style="western"><surname>Westoby</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Diaz</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Gallagher</surname><given-names>RV</given-names></name>, <name name-style="western"><surname>Jacobs</surname><given-names>BF</given-names></name>, <name name-style="western"><surname>Kooyman</surname><given-names>R</given-names></name>, <name name-style="western"><surname>Law</surname><given-names>EA</given-names></name>, <name name-style="western"><surname>Leishman</surname><given-names>MR</given-names></name>, <name name-style="western"><surname>Niinemets</surname><given-names>Ü</given-names></name>, <name name-style="western"><surname>Reich</surname><given-names>PB</given-names></name>, <name name-style="western"><surname>Sack</surname><given-names>L</given-names></name>, <name name-style="western"><surname>Villar</surname><given-names>R</given-names></name>, <name name-style="western"><surname>Wang</surname><given-names>H</given-names></name>, <name name-style="western"><surname>Wilf</surname><given-names>P</given-names></name></person-group><year>2017</year><article-title>Global climatic drivers of leaf size</article-title>. <source>Science</source><volume>357</volume>:<fpage>917</fpage>–<lpage>921</lpage>.<pub-id pub-id-type="pmid">28860384</pub-id></mixed-citation>
    </ref>
  </ref-list>
  <app-group>
    <app id="AP1">
      <title>Appendix: Theory</title>
      <p>This appendix describes how the components of leaf energy budgets (absorbed radiation, thermal infrared radiation loss, sensible heat flux and latent heat flux) are modelled in <bold>tealeaves</bold>. The model largely follows that previously developed by <xref rid="CIT0013" ref-type="bibr">Foster and Smith (1986)</xref>, so for brevity I have not explained every equation. I refer interested readers to <xref rid="CIT0035" ref-type="bibr">Nobel (2009)</xref>, <xref rid="CIT0032" ref-type="bibr">Monteith and Unsworth (2013)</xref> and <xref rid="CIT0023" ref-type="bibr">Jones (2014)</xref> for more background on the biophysics.</p>
      <sec id="s18">
        <title/>
        <sec id="s19">
          <title>Absorbed radiation</title>
          <p>The <bold>tealeaves</bold> model for absorbed radiation follows <xref rid="CIT0036" ref-type="bibr">Okajima <italic>et al</italic>. (2012)</xref>:</p>
          <disp-formula>
            <mml:math id="m45">
              <mml:mstyle displaystyle="true">
                <mml:mtable columnalign="left" columnspacing="1">
                  <mml:mtr>
                    <mml:mtd>
                      <mml:mstyle displaystyle="true">
                        <mml:mrow>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mi>R</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mrow>
                                <mml:mi mathvariant="normal">a</mml:mi>
                                <mml:mi mathvariant="normal">b</mml:mi>
                                <mml:mi mathvariant="normal">s</mml:mi>
                              </mml:mrow>
                            </mml:mrow>
                          </mml:msub>
                        </mml:mrow>
                        <mml:mo>=</mml:mo>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mi>α</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mrow>
                                <mml:mi mathvariant="normal">s</mml:mi>
                              </mml:mrow>
                            </mml:mrow>
                          </mml:msub>
                        </mml:mrow>
                        <mml:mo stretchy="false">(</mml:mo>
                        <mml:mn>1</mml:mn>
                        <mml:mo>+</mml:mo>
                        <mml:mi>r</mml:mi>
                        <mml:mo stretchy="false">)</mml:mo>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mi>S</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mrow>
                                <mml:mi mathvariant="normal">s</mml:mi>
                                <mml:mi mathvariant="normal">w</mml:mi>
                              </mml:mrow>
                            </mml:mrow>
                          </mml:msub>
                        </mml:mrow>
                        <mml:mo>+</mml:mo>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mi>α</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mrow>
                                <mml:mi mathvariant="normal">l</mml:mi>
                              </mml:mrow>
                            </mml:mrow>
                          </mml:msub>
                        </mml:mrow>
                        <mml:mi>σ</mml:mi>
                        <mml:mrow>
                          <mml:mo>(</mml:mo>
                          <mml:msubsup>
                            <mml:mi>T</mml:mi>
                            <mml:mrow>
                              <mml:mrow>
                                <mml:mi mathvariant="normal">s</mml:mi>
                                <mml:mi mathvariant="normal">k</mml:mi>
                                <mml:mi mathvariant="normal">y</mml:mi>
                              </mml:mrow>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mn>4</mml:mn>
                            </mml:mrow>
                          </mml:msubsup>
                          <mml:mo>+</mml:mo>
                          <mml:msubsup>
                            <mml:mi>T</mml:mi>
                            <mml:mrow>
                              <mml:mrow>
                                <mml:mi mathvariant="normal">a</mml:mi>
                                <mml:mi mathvariant="normal">i</mml:mi>
                                <mml:mi mathvariant="normal">r</mml:mi>
                              </mml:mrow>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mn>4</mml:mn>
                            </mml:mrow>
                          </mml:msubsup>
                          <mml:mo>)</mml:mo>
                        </mml:mrow>
                        <mml:mo>.</mml:mo>
                      </mml:mstyle>
                    </mml:mtd>
                  </mml:mtr>
                </mml:mtable>
              </mml:mstyle>
            </mml:math>
            <label>(2)</label>
          </disp-formula>
          <p>The left half of the equation calculates absorbed solar radiation. <inline-formula><mml:math id="m46"><mml:mstyle displaystyle="false"><mml:mrow><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">s</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> is the fraction of solar radiation absorbed. <inline-formula><mml:math id="m47"><mml:mstyle displaystyle="false"><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">w</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> is the total incident radiation. This is multiplied by 1 + <italic>r</italic>, where <italic>r</italic> is the albedo of soil, to account for direct and reflected sunlight. The right half includes thermal infrared radiation. <inline-formula><mml:math id="m48"><mml:mstyle displaystyle="false"><mml:mrow><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">l</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> is the fraction of thermal infrared radiation absorbed. <italic>σ</italic> is the Stefan–Boltzmann constant. As in <xref rid="CIT0036" ref-type="bibr">Okajima <italic>et al</italic>. (2012)</xref>, the clear sky temperature (<inline-formula><mml:math id="m49"><mml:mstyle displaystyle="false"><mml:mrow><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">k</mml:mi><mml:mi mathvariant="normal">y</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>) is calculated as a function of air temperature (<inline-formula><mml:math id="m50"><mml:mstyle displaystyle="false"><mml:mrow><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>):</p>
          <disp-formula>
            <mml:math id="m51">
              <mml:mstyle displaystyle="true">
                <mml:mtable columnalign="left" columnspacing="1">
                  <mml:mtr>
                    <mml:mtd>
                      <mml:mstyle displaystyle="true">
                        <mml:mrow>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mi>T</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mrow>
                                <mml:mi mathvariant="normal">s</mml:mi>
                                <mml:mi mathvariant="normal">k</mml:mi>
                                <mml:mi mathvariant="normal">y</mml:mi>
                              </mml:mrow>
                            </mml:mrow>
                          </mml:msub>
                        </mml:mrow>
                        <mml:mo>=</mml:mo>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mi>T</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mrow>
                                <mml:mi mathvariant="normal">a</mml:mi>
                                <mml:mi mathvariant="normal">i</mml:mi>
                                <mml:mi mathvariant="normal">r</mml:mi>
                              </mml:mrow>
                            </mml:mrow>
                          </mml:msub>
                        </mml:mrow>
                        <mml:mo>−</mml:mo>
                        <mml:mfrac>
                          <mml:mrow>
                            <mml:mn>20</mml:mn>
                            <mml:mrow>
                              <mml:msub>
                                <mml:mrow>
                                  <mml:mi>S</mml:mi>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mrow>
                                    <mml:mi mathvariant="normal">s</mml:mi>
                                    <mml:mi mathvariant="normal">w</mml:mi>
                                  </mml:mrow>
                                </mml:mrow>
                              </mml:msub>
                            </mml:mrow>
                          </mml:mrow>
                          <mml:mn>1000</mml:mn>
                        </mml:mfrac>
                        <mml:mo>.</mml:mo>
                      </mml:mstyle>
                    </mml:mtd>
                  </mml:mtr>
                </mml:mtable>
              </mml:mstyle>
            </mml:math>
            <label>(3)</label>
          </disp-formula>
          <p><xref rid="CIT0036" ref-type="bibr">Okajima <italic>et al</italic>. (2012)</xref> define <inline-formula><mml:math id="m52"><mml:mstyle displaystyle="false"><mml:mrow><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">k</mml:mi><mml:mi mathvariant="normal">y</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> as the ‘effective sky radiation temperature’ of ‘cloudless sky’.</p>
        </sec>
        <sec id="s20">
          <title>Thermal infrared radiation loss</title>
          <p>Both leaf surfaces lose thermal infrared radiation as a function of leaf emissivity (equal to the infrared absorption, <inline-formula><mml:math id="m53"><mml:mstyle displaystyle="false"><mml:mrow><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">l</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>) and air temperature (<xref rid="CIT0013" ref-type="bibr">Foster and Smith 1986</xref>; <xref rid="CIT0036" ref-type="bibr">Okajima <italic>et al</italic>. 2012</xref>):</p>
          <disp-formula>
            <mml:math id="m54">
              <mml:mstyle displaystyle="true">
                <mml:mtable columnalign="left" columnspacing="1">
                  <mml:mtr>
                    <mml:mtd>
                      <mml:mstyle displaystyle="true">
                        <mml:mrow>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mi>S</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mi>r</mml:mi>
                            </mml:mrow>
                          </mml:msub>
                        </mml:mrow>
                        <mml:mo>=</mml:mo>
                        <mml:mn>2</mml:mn>
                        <mml:mi>σ</mml:mi>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mi>α</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mrow>
                                <mml:mi mathvariant="normal">l</mml:mi>
                              </mml:mrow>
                            </mml:mrow>
                          </mml:msub>
                        </mml:mrow>
                        <mml:msubsup>
                          <mml:mi>T</mml:mi>
                          <mml:mrow>
                            <mml:mrow>
                              <mml:mi mathvariant="normal">l</mml:mi>
                              <mml:mi mathvariant="normal">e</mml:mi>
                              <mml:mi mathvariant="normal">a</mml:mi>
                              <mml:mi mathvariant="normal">f</mml:mi>
                            </mml:mrow>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mn>4</mml:mn>
                          </mml:mrow>
                        </mml:msubsup>
                        <mml:mo>.</mml:mo>
                      </mml:mstyle>
                    </mml:mtd>
                  </mml:mtr>
                </mml:mtable>
              </mml:mstyle>
            </mml:math>
            <label>(4)</label>
          </disp-formula>
        </sec>
        <sec id="s21">
          <title>Sensible heat flux</title>
          <p>Sensible heat flux (<italic>H</italic>) is calculated as:</p>
          <disp-formula>
            <mml:math id="m55">
              <mml:mstyle displaystyle="true">
                <mml:mtable columnalign="left" columnspacing="1">
                  <mml:mtr>
                    <mml:mtd>
                      <mml:mstyle displaystyle="true">
                        <mml:mi>H</mml:mi>
                        <mml:mo>=</mml:mo>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mi>P</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mrow>
                                <mml:mi mathvariant="normal">a</mml:mi>
                              </mml:mrow>
                            </mml:mrow>
                          </mml:msub>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mi>c</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mi>p</mml:mi>
                            </mml:mrow>
                          </mml:msub>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mi>g</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mrow>
                                <mml:mi mathvariant="normal">h</mml:mi>
                              </mml:mrow>
                            </mml:mrow>
                          </mml:msub>
                        </mml:mrow>
                        <mml:mo stretchy="false">(</mml:mo>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mi>T</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mrow>
                                <mml:mi mathvariant="normal">l</mml:mi>
                                <mml:mi mathvariant="normal">e</mml:mi>
                                <mml:mi mathvariant="normal">a</mml:mi>
                                <mml:mi mathvariant="normal">f</mml:mi>
                              </mml:mrow>
                            </mml:mrow>
                          </mml:msub>
                        </mml:mrow>
                        <mml:mo>−</mml:mo>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mi>T</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mrow>
                                <mml:mi mathvariant="normal">a</mml:mi>
                                <mml:mi mathvariant="normal">i</mml:mi>
                                <mml:mi mathvariant="normal">r</mml:mi>
                              </mml:mrow>
                            </mml:mrow>
                          </mml:msub>
                        </mml:mrow>
                        <mml:mo stretchy="false">)</mml:mo>
                        <mml:mo>.</mml:mo>
                      </mml:mstyle>
                    </mml:mtd>
                  </mml:mtr>
                </mml:mtable>
              </mml:mstyle>
            </mml:math>
            <label>(5)</label>
          </disp-formula>
          <p><italic>c</italic><sub><italic>p</italic></sub> is the heat capacity of air. The density of dry air (<inline-formula><mml:math id="m56"><mml:mstyle displaystyle="false"><mml:mrow><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">a</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>) is calculated as in <xref rid="CIT0013" ref-type="bibr">Foster and Smith (1986)</xref>:</p>
          <disp-formula>
            <mml:math id="m57">
              <mml:mstyle displaystyle="true">
                <mml:mtable columnalign="left" columnspacing="1">
                  <mml:mtr>
                    <mml:mtd>
                      <mml:mstyle displaystyle="true">
                        <mml:mrow>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mi>P</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mrow>
                                <mml:mi mathvariant="normal">a</mml:mi>
                              </mml:mrow>
                            </mml:mrow>
                          </mml:msub>
                        </mml:mrow>
                        <mml:mo>=</mml:mo>
                        <mml:mfrac>
                          <mml:mrow>
                            <mml:mn>2</mml:mn>
                            <mml:mi>P</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mrow>
                              <mml:msub>
                                <mml:mrow>
                                  <mml:mi>R</mml:mi>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mrow>
                                    <mml:mi mathvariant="normal">a</mml:mi>
                                    <mml:mi mathvariant="normal">i</mml:mi>
                                    <mml:mi mathvariant="normal">r</mml:mi>
                                  </mml:mrow>
                                </mml:mrow>
                              </mml:msub>
                            </mml:mrow>
                            <mml:mo stretchy="false">(</mml:mo>
                            <mml:mrow>
                              <mml:msub>
                                <mml:mrow>
                                  <mml:mi>T</mml:mi>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mrow>
                                    <mml:mi mathvariant="normal">l</mml:mi>
                                    <mml:mi mathvariant="normal">e</mml:mi>
                                    <mml:mi mathvariant="normal">a</mml:mi>
                                    <mml:mi mathvariant="normal">f</mml:mi>
                                  </mml:mrow>
                                </mml:mrow>
                              </mml:msub>
                            </mml:mrow>
                            <mml:mo>−</mml:mo>
                            <mml:mrow>
                              <mml:msub>
                                <mml:mrow>
                                  <mml:mi>T</mml:mi>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mrow>
                                    <mml:mi mathvariant="normal">a</mml:mi>
                                    <mml:mi mathvariant="normal">i</mml:mi>
                                    <mml:mi mathvariant="normal">r</mml:mi>
                                  </mml:mrow>
                                </mml:mrow>
                              </mml:msub>
                            </mml:mrow>
                            <mml:mo stretchy="false">)</mml:mo>
                          </mml:mrow>
                        </mml:mfrac>
                        <mml:mo>.</mml:mo>
                      </mml:mstyle>
                    </mml:mtd>
                  </mml:mtr>
                </mml:mtable>
              </mml:mstyle>
            </mml:math>
            <label>(6)</label>
          </disp-formula>
          <p><italic>P</italic> is the atmospheric pressure and <inline-formula><mml:math id="m58"><mml:mstyle displaystyle="false"><mml:mrow><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> is the specific gas constant for dry air. <bold>tealeaves</bold> sums the boundary layer conductance to heat for both the upper and lower surface following <xref rid="CIT0013" ref-type="bibr">Foster and Smith (1986)</xref>, assuming a horizontal leaf orientation:</p>
          <disp-formula>
            <mml:math id="m59">
              <mml:mstyle displaystyle="true">
                <mml:mtable columnalign="left" columnspacing="1">
                  <mml:mtr>
                    <mml:mtd>
                      <mml:mstyle displaystyle="true">
                        <mml:mrow>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mi>g</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mi>h</mml:mi>
                            </mml:mrow>
                          </mml:msub>
                        </mml:mrow>
                        <mml:mo>=</mml:mo>
                        <mml:mfrac>
                          <mml:mrow>
                            <mml:mrow>
                              <mml:msub>
                                <mml:mrow>
                                  <mml:mi>D</mml:mi>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mi>h</mml:mi>
                                </mml:mrow>
                              </mml:msub>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mi mathvariant="normal">N</mml:mi>
                              <mml:mi mathvariant="normal">u</mml:mi>
                            </mml:mrow>
                          </mml:mrow>
                          <mml:mi>d</mml:mi>
                        </mml:mfrac>
                        <mml:mo>.</mml:mo>
                      </mml:mstyle>
                    </mml:mtd>
                  </mml:mtr>
                </mml:mtable>
              </mml:mstyle>
            </mml:math>
            <label>(7)</label>
          </disp-formula>
          <p><inline-formula><mml:math id="m60"><mml:mstyle displaystyle="false"><mml:mrow><mml:mi mathvariant="normal">N</mml:mi><mml:mi mathvariant="normal">u</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> is the unitless Nusselt number (defined below) and <italic>d</italic> is the characteristic leaf dimension, a thermally relevant measure of leaf size. The diffusion coefficient of heat in air (<italic>D</italic><sub>h</sub>) is a function of temperature and pressure:</p>
          <disp-formula>
            <mml:math id="m61">
              <mml:mstyle displaystyle="true">
                <mml:mtable columnalign="left" columnspacing="1">
                  <mml:mtr>
                    <mml:mtd>
                      <mml:mstyle displaystyle="true">
                        <mml:mrow>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mi>D</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mrow>
                                <mml:mi mathvariant="normal">h</mml:mi>
                              </mml:mrow>
                            </mml:mrow>
                          </mml:msub>
                        </mml:mrow>
                        <mml:mo>=</mml:mo>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mi>D</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mrow>
                                <mml:mi mathvariant="normal">h</mml:mi>
                              </mml:mrow>
                              <mml:mo>,</mml:mo>
                              <mml:mn>0</mml:mn>
                            </mml:mrow>
                          </mml:msub>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:msup>
                            <mml:mrow>
                              <mml:mrow>
                                <mml:mo>(</mml:mo>
                                <mml:mfrac>
                                  <mml:mi>T</mml:mi>
                                  <mml:mn>273.15</mml:mn>
                                </mml:mfrac>
                                <mml:mo>)</mml:mo>
                              </mml:mrow>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mi>e</mml:mi>
                              <mml:mi>T</mml:mi>
                            </mml:mrow>
                          </mml:msup>
                        </mml:mrow>
                        <mml:mfrac>
                          <mml:mn>101.3246</mml:mn>
                          <mml:mi>P</mml:mi>
                        </mml:mfrac>
                        <mml:mo>.</mml:mo>
                      </mml:mstyle>
                    </mml:mtd>
                  </mml:mtr>
                </mml:mtable>
              </mml:mstyle>
            </mml:math>
            <label>(8)</label>
          </disp-formula>
          <p>The temperature dependence of diffusion (<inline-formula><mml:math id="m62"><mml:mstyle displaystyle="false"><mml:mi>e</mml:mi><mml:mi>T</mml:mi></mml:mstyle></mml:math></inline-formula>) is generally between 1.5 and 2 for heat and water vapour (<xref rid="CIT0032" ref-type="bibr">Monteith and Unsworth 2013</xref>). To calculate diffusion coefficients, <bold>tealeaves</bold> uses the average of the leaf and air temperature: <inline-formula><mml:math id="m63"><mml:mstyle displaystyle="false"><mml:mi>T</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:mstyle></mml:math></inline-formula>. The Nusselt number <inline-formula><mml:math id="m64"><mml:mstyle displaystyle="false"><mml:mrow><mml:mi mathvariant="normal">N</mml:mi><mml:mi mathvariant="normal">u</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> is modeled as a mixed convection:</p>
          <disp-formula>
            <mml:math id="m65">
              <mml:mstyle displaystyle="true">
                <mml:mtable columnalign="left" columnspacing="1">
                  <mml:mtr>
                    <mml:mtd>
                      <mml:mstyle displaystyle="true">
                        <mml:mrow>
                          <mml:mi mathvariant="normal">N</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:msup>
                            <mml:mrow>
                              <mml:mrow>
                                <mml:mi mathvariant="normal">u</mml:mi>
                              </mml:mrow>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mn>3.5</mml:mn>
                            </mml:mrow>
                          </mml:msup>
                        </mml:mrow>
                        <mml:mo>=</mml:mo>
                        <mml:msubsup>
                          <mml:mrow>
                            <mml:mi mathvariant="normal">N</mml:mi>
                            <mml:mi mathvariant="normal">u</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mrow>
                              <mml:mi mathvariant="normal">f</mml:mi>
                              <mml:mi mathvariant="normal">o</mml:mi>
                              <mml:mi mathvariant="normal">r</mml:mi>
                              <mml:mi mathvariant="normal">c</mml:mi>
                              <mml:mi mathvariant="normal">e</mml:mi>
                              <mml:mi mathvariant="normal">d</mml:mi>
                            </mml:mrow>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mn>3.5</mml:mn>
                          </mml:mrow>
                        </mml:msubsup>
                        <mml:mo>+</mml:mo>
                        <mml:msubsup>
                          <mml:mrow>
                            <mml:mi mathvariant="normal">N</mml:mi>
                            <mml:mi mathvariant="normal">u</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mrow>
                              <mml:mi mathvariant="normal">f</mml:mi>
                              <mml:mi mathvariant="normal">r</mml:mi>
                              <mml:mi mathvariant="normal">e</mml:mi>
                              <mml:mi mathvariant="normal">e</mml:mi>
                            </mml:mrow>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mn>3.5</mml:mn>
                          </mml:mrow>
                        </mml:msubsup>
                      </mml:mstyle>
                    </mml:mtd>
                  </mml:mtr>
                </mml:mtable>
              </mml:mstyle>
            </mml:math>
            <label>(9)</label>
          </disp-formula>
          <p>where</p>
          <disp-formula>
            <mml:math id="m66">
              <mml:mstyle displaystyle="true">
                <mml:mtable columnalign="left" columnspacing="1">
                  <mml:mtr>
                    <mml:mtd>
                      <mml:mstyle displaystyle="true">
                        <mml:mrow>
                          <mml:mi mathvariant="normal">N</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mrow>
                                <mml:mi mathvariant="normal">u</mml:mi>
                              </mml:mrow>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mrow>
                                <mml:mi mathvariant="normal">f</mml:mi>
                                <mml:mi mathvariant="normal">o</mml:mi>
                                <mml:mi mathvariant="normal">r</mml:mi>
                                <mml:mi mathvariant="normal">c</mml:mi>
                                <mml:mi mathvariant="normal">e</mml:mi>
                                <mml:mi mathvariant="normal">d</mml:mi>
                              </mml:mrow>
                            </mml:mrow>
                          </mml:msub>
                        </mml:mrow>
                        <mml:mo>=</mml:mo>
                        <mml:mi>a</mml:mi>
                        <mml:mrow>
                          <mml:mi mathvariant="normal">R</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:msup>
                            <mml:mrow>
                              <mml:mrow>
                                <mml:mi mathvariant="normal">e</mml:mi>
                              </mml:mrow>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mi>b</mml:mi>
                            </mml:mrow>
                          </mml:msup>
                        </mml:mrow>
                      </mml:mstyle>
                    </mml:mtd>
                  </mml:mtr>
                </mml:mtable>
              </mml:mstyle>
            </mml:math>
            <label>(10)</label>
          </disp-formula>
          <disp-formula>
            <mml:math id="m67">
              <mml:mstyle displaystyle="true">
                <mml:mtable columnalign="left" columnspacing="1">
                  <mml:mtr>
                    <mml:mtd>
                      <mml:mstyle displaystyle="true">
                        <mml:mrow>
                          <mml:mi mathvariant="normal">N</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mrow>
                                <mml:mi mathvariant="normal">u</mml:mi>
                              </mml:mrow>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mrow>
                                <mml:mi mathvariant="normal">f</mml:mi>
                                <mml:mi mathvariant="normal">r</mml:mi>
                                <mml:mi mathvariant="normal">e</mml:mi>
                                <mml:mi mathvariant="normal">e</mml:mi>
                              </mml:mrow>
                            </mml:mrow>
                          </mml:msub>
                        </mml:mrow>
                        <mml:mo>=</mml:mo>
                        <mml:mi>c</mml:mi>
                        <mml:mrow>
                          <mml:mi mathvariant="normal">G</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:msup>
                            <mml:mrow>
                              <mml:mrow>
                                <mml:mi mathvariant="normal">r</mml:mi>
                              </mml:mrow>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mi>d</mml:mi>
                            </mml:mrow>
                          </mml:msup>
                        </mml:mrow>
                        <mml:mo>.</mml:mo>
                      </mml:mstyle>
                    </mml:mtd>
                  </mml:mtr>
                </mml:mtable>
              </mml:mstyle>
            </mml:math>
            <label>(11)</label>
          </disp-formula>
          <p><inline-formula><mml:math id="m68"><mml:mstyle displaystyle="false"><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>b</mml:mi><mml:mo>,</mml:mo><mml:mi>c</mml:mi><mml:mo>,</mml:mo><mml:mi>d</mml:mi></mml:mstyle></mml:math></inline-formula> are constants that depend on whether flow is laminar or turbulent and the direction of flow in the case of free convection (see below). In general, when the Archimedes number (also called the Richardson number) <inline-formula><mml:math id="m69"><mml:mstyle displaystyle="false"><mml:mrow><mml:mi mathvariant="normal">A</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mi mathvariant="normal">G</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:mrow><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="normal">R</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mi mathvariant="normal">e</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mo>≪</mml:mo><mml:mn>0.1</mml:mn></mml:mstyle></mml:math></inline-formula>, free convection dominates; when <inline-formula><mml:math id="m70"><mml:mstyle displaystyle="false"><mml:mrow><mml:mi mathvariant="normal">A</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mi mathvariant="normal">G</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:mrow><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="normal">R</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mi mathvariant="normal">e</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mo>≫</mml:mo><mml:mn>10</mml:mn></mml:mstyle></mml:math></inline-formula>, forced convection dominates (<xref rid="CIT0035" ref-type="bibr">Nobel 2009</xref>). The Nusselt number coefficients can be found in <xref rid="CIT0032" ref-type="bibr">Monteith and Unsworth (2013)</xref>. For forced convection, flow is laminar if <inline-formula><mml:math id="m71"><mml:mstyle displaystyle="false"><mml:mrow><mml:mi mathvariant="normal">R</mml:mi><mml:mi mathvariant="normal">e</mml:mi></mml:mrow><mml:mo>&lt;</mml:mo><mml:mn>4000</mml:mn></mml:mstyle></mml:math></inline-formula>, <inline-formula><mml:math id="m72"><mml:mstyle displaystyle="false"><mml:mi>a</mml:mi><mml:mo>=</mml:mo><mml:mn>0.6</mml:mn><mml:mo>,</mml:mo><mml:mi>b</mml:mi><mml:mo>=</mml:mo><mml:mn>0.5</mml:mn></mml:mstyle></mml:math></inline-formula>; flow is turbulent if <inline-formula><mml:math id="m73"><mml:mstyle displaystyle="false"><mml:mrow><mml:mi mathvariant="normal">R</mml:mi><mml:mi mathvariant="normal">e</mml:mi></mml:mrow><mml:mo>&gt;</mml:mo><mml:mn>4000</mml:mn></mml:mstyle></mml:math></inline-formula>, <inline-formula><mml:math id="m74"><mml:mstyle displaystyle="false"><mml:mi>a</mml:mi><mml:mo>=</mml:mo><mml:mn>0.032</mml:mn><mml:mo>,</mml:mo><mml:mi>b</mml:mi><mml:mo>=</mml:mo><mml:mn>0.8</mml:mn></mml:mstyle></mml:math></inline-formula>. These cut-offs for leaves are lower than for artificial surfaces because trichomes and other anatomical features of leaf surfaces induce turbulence more readily (<xref rid="CIT0017" ref-type="bibr">Grace and Wilson 1976</xref>). For free convection, flow is laminar. For the upper surface when <inline-formula><mml:math id="m75"><mml:mstyle displaystyle="false"><mml:mrow><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow><mml:mo>&gt;</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> or the lower surface when <inline-formula><mml:math id="m76"><mml:mstyle displaystyle="false"><mml:mrow><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow><mml:mo>&lt;</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>, <inline-formula><mml:math id="m77"><mml:mstyle displaystyle="false"><mml:mi>c</mml:mi><mml:mo>=</mml:mo><mml:mn>0.5</mml:mn><mml:mo>,</mml:mo><mml:mi>d</mml:mi><mml:mo>=</mml:mo><mml:mn>0.25</mml:mn></mml:mstyle></mml:math></inline-formula> . Conversely, for the lower surface when <inline-formula><mml:math id="m78"><mml:mstyle displaystyle="false"><mml:mrow><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow><mml:mo>&gt;</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> or the upper surface when <inline-formula><mml:math id="m79"><mml:mstyle displaystyle="false"><mml:mrow><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow><mml:mo>&lt;</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>, <inline-formula><mml:math id="m80"><mml:mstyle displaystyle="false"><mml:mi>c</mml:mi><mml:mo>=</mml:mo><mml:mn>0.23</mml:mn><mml:mo>,</mml:mo><mml:mi>d</mml:mi><mml:mo>=</mml:mo><mml:mn>0.25</mml:mn></mml:mstyle></mml:math></inline-formula>.</p>
          <p>Grashof and Reynolds numbers approximate the ratio of bouyant or inertial (numerator in equations below), respectively, to viscous forces (denominator in equations below). They are calculated as:</p>
          <disp-formula>
            <mml:math id="m81">
              <mml:mstyle displaystyle="true">
                <mml:mtable columnalign="left" columnspacing="1">
                  <mml:mtr>
                    <mml:mtd>
                      <mml:mstyle displaystyle="true">
                        <mml:mrow>
                          <mml:mi mathvariant="normal">G</mml:mi>
                          <mml:mi mathvariant="normal">r</mml:mi>
                        </mml:mrow>
                        <mml:mo>=</mml:mo>
                        <mml:mfrac>
                          <mml:mrow>
                            <mml:mi>G</mml:mi>
                            <mml:mrow>
                              <mml:msup>
                                <mml:mrow>
                                  <mml:mi>d</mml:mi>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mn>3</mml:mn>
                                </mml:mrow>
                              </mml:msup>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mo stretchy="false">|</mml:mo>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:msub>
                                <mml:mrow>
                                  <mml:mi>T</mml:mi>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mi>v</mml:mi>
                                  <mml:mo>,</mml:mo>
                                  <mml:mrow>
                                    <mml:mi mathvariant="normal">l</mml:mi>
                                    <mml:mi mathvariant="normal">e</mml:mi>
                                    <mml:mi mathvariant="normal">a</mml:mi>
                                    <mml:mi mathvariant="normal">f</mml:mi>
                                  </mml:mrow>
                                </mml:mrow>
                              </mml:msub>
                            </mml:mrow>
                            <mml:mo>−</mml:mo>
                            <mml:mrow>
                              <mml:msub>
                                <mml:mrow>
                                  <mml:mi>T</mml:mi>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mi>v</mml:mi>
                                  <mml:mo>,</mml:mo>
                                  <mml:mrow>
                                    <mml:mi mathvariant="normal">a</mml:mi>
                                    <mml:mi mathvariant="normal">i</mml:mi>
                                    <mml:mi mathvariant="normal">r</mml:mi>
                                  </mml:mrow>
                                </mml:mrow>
                              </mml:msub>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mo stretchy="false">|</mml:mo>
                            </mml:mrow>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mrow>
                              <mml:msub>
                                <mml:mrow>
                                  <mml:mi>T</mml:mi>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mrow>
                                    <mml:mi mathvariant="normal">a</mml:mi>
                                    <mml:mi mathvariant="normal">i</mml:mi>
                                    <mml:mi mathvariant="normal">r</mml:mi>
                                  </mml:mrow>
                                </mml:mrow>
                              </mml:msub>
                            </mml:mrow>
                            <mml:msubsup>
                              <mml:mi>D</mml:mi>
                              <mml:mrow>
                                <mml:mi>m</mml:mi>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mn>2</mml:mn>
                              </mml:mrow>
                            </mml:msubsup>
                          </mml:mrow>
                        </mml:mfrac>
                      </mml:mstyle>
                    </mml:mtd>
                  </mml:mtr>
                </mml:mtable>
              </mml:mstyle>
            </mml:math>
            <label>(12)</label>
          </disp-formula>
          <disp-formula>
            <mml:math id="m82">
              <mml:mstyle displaystyle="true">
                <mml:mtable columnalign="left" columnspacing="1">
                  <mml:mtr>
                    <mml:mtd>
                      <mml:mstyle displaystyle="true">
                        <mml:mrow>
                          <mml:mi mathvariant="normal">R</mml:mi>
                          <mml:mi mathvariant="normal">e</mml:mi>
                        </mml:mrow>
                        <mml:mo>=</mml:mo>
                        <mml:mfrac>
                          <mml:mrow>
                            <mml:mi>u</mml:mi>
                            <mml:mi>d</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:msub>
                              <mml:mrow>
                                <mml:mi>D</mml:mi>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mi>m</mml:mi>
                              </mml:mrow>
                            </mml:msub>
                          </mml:mrow>
                        </mml:mfrac>
                        <mml:mo>.</mml:mo>
                      </mml:mstyle>
                    </mml:mtd>
                  </mml:mtr>
                </mml:mtable>
              </mml:mstyle>
            </mml:math>
            <label>(13)</label>
          </disp-formula>
          <p><italic>G</italic> is the gravitational constant and <italic>u</italic> is wind speed. The diffusion coefficient for momentum in air (<italic>D</italic><sub>m</sub>) is calculated for a given temperature following the same procedure above for heat diffusion (<italic>D</italic><sub>h</sub>; see Equation 8). The virtual temperature is calculated according to <xref rid="CIT0032" ref-type="bibr">Monteith and Unsworth (2013)</xref> assuming that the leaf airspace is fully saturated while the air is has a vapour-pressure deficit of <inline-formula><mml:math id="m83"><mml:mstyle displaystyle="false"><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>:</p>
          <disp-formula>
            <mml:math id="m84">
              <mml:mstyle displaystyle="true">
                <mml:mtable columnalign="left" columnspacing="1">
                  <mml:mtr>
                    <mml:mtd>
                      <mml:mstyle displaystyle="true">
                        <mml:mrow>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mi>T</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mi>v</mml:mi>
                              <mml:mo>,</mml:mo>
                              <mml:mrow>
                                <mml:mi mathvariant="normal">a</mml:mi>
                                <mml:mi mathvariant="normal">i</mml:mi>
                                <mml:mi mathvariant="normal">r</mml:mi>
                              </mml:mrow>
                            </mml:mrow>
                          </mml:msub>
                        </mml:mrow>
                        <mml:mo>=</mml:mo>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mi>T</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mrow>
                                <mml:mi mathvariant="normal">a</mml:mi>
                                <mml:mi mathvariant="normal">i</mml:mi>
                                <mml:mi mathvariant="normal">r</mml:mi>
                              </mml:mrow>
                            </mml:mrow>
                          </mml:msub>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mo>/</mml:mo>
                        </mml:mrow>
                        <mml:mo stretchy="false">(</mml:mo>
                        <mml:mn>1</mml:mn>
                        <mml:mo>−</mml:mo>
                        <mml:mo stretchy="false">(</mml:mo>
                        <mml:mn>1</mml:mn>
                        <mml:mo>−</mml:mo>
                        <mml:mi>ε</mml:mi>
                        <mml:mo stretchy="false">)</mml:mo>
                        <mml:mo stretchy="false">(</mml:mo>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mi>p</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mrow>
                                <mml:mi mathvariant="normal">a</mml:mi>
                                <mml:mi mathvariant="normal">i</mml:mi>
                                <mml:mi mathvariant="normal">r</mml:mi>
                              </mml:mrow>
                            </mml:mrow>
                          </mml:msub>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mo>/</mml:mo>
                        </mml:mrow>
                        <mml:mi>P</mml:mi>
                        <mml:mo stretchy="false">)</mml:mo>
                        <mml:mo stretchy="false">)</mml:mo>
                      </mml:mstyle>
                    </mml:mtd>
                  </mml:mtr>
                </mml:mtable>
              </mml:mstyle>
            </mml:math>
            <label>(14)</label>
          </disp-formula>
          <disp-formula>
            <mml:math id="m85">
              <mml:mstyle displaystyle="true">
                <mml:mtable columnalign="left" columnspacing="1">
                  <mml:mtr>
                    <mml:mtd>
                      <mml:mstyle displaystyle="true">
                        <mml:mrow>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mi>T</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mi>v</mml:mi>
                              <mml:mo>,</mml:mo>
                              <mml:mrow>
                                <mml:mi mathvariant="normal">l</mml:mi>
                                <mml:mi mathvariant="normal">e</mml:mi>
                                <mml:mi mathvariant="normal">a</mml:mi>
                                <mml:mi mathvariant="normal">f</mml:mi>
                              </mml:mrow>
                            </mml:mrow>
                          </mml:msub>
                        </mml:mrow>
                        <mml:mo>=</mml:mo>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mi>T</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mrow>
                                <mml:mi mathvariant="normal">l</mml:mi>
                                <mml:mi mathvariant="normal">e</mml:mi>
                                <mml:mi mathvariant="normal">a</mml:mi>
                                <mml:mi mathvariant="normal">f</mml:mi>
                              </mml:mrow>
                            </mml:mrow>
                          </mml:msub>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mo>/</mml:mo>
                        </mml:mrow>
                        <mml:mo stretchy="false">(</mml:mo>
                        <mml:mn>1</mml:mn>
                        <mml:mo>−</mml:mo>
                        <mml:mo stretchy="false">(</mml:mo>
                        <mml:mn>1</mml:mn>
                        <mml:mo>−</mml:mo>
                        <mml:mi>ε</mml:mi>
                        <mml:mo stretchy="false">)</mml:mo>
                        <mml:mo stretchy="false">(</mml:mo>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mi>p</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mrow>
                                <mml:mi mathvariant="normal">s</mml:mi>
                                <mml:mi mathvariant="normal">a</mml:mi>
                                <mml:mi mathvariant="normal">t</mml:mi>
                              </mml:mrow>
                            </mml:mrow>
                          </mml:msub>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mo>/</mml:mo>
                        </mml:mrow>
                        <mml:mi>P</mml:mi>
                        <mml:mo stretchy="false">)</mml:mo>
                        <mml:mo stretchy="false">)</mml:mo>
                        <mml:mo>.</mml:mo>
                      </mml:mstyle>
                    </mml:mtd>
                  </mml:mtr>
                </mml:mtable>
              </mml:mstyle>
            </mml:math>
            <label>(15)</label>
          </disp-formula>
          <p><inline-formula><mml:math id="m86"><mml:mstyle displaystyle="false"><mml:mi>ε</mml:mi></mml:mstyle></mml:math></inline-formula> is the ratio of water to air molar masses. The saturation water vapour pressure <inline-formula><mml:math id="m87"><mml:mstyle displaystyle="false"><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">t</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> as a function of temperature is calculated using the Goff–Gratch equation (<xref rid="CIT0054" ref-type="bibr">Vömel 2016</xref>). The vapour pressure of air is calculated from the relative humidity (<inline-formula><mml:math id="m88"><mml:mstyle displaystyle="false"><mml:mrow><mml:mi mathvariant="normal">R</mml:mi><mml:mi mathvariant="normal">H</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>) as <inline-formula><mml:math id="m89"><mml:mstyle displaystyle="false"><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mi mathvariant="normal">R</mml:mi><mml:mi mathvariant="normal">H</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">t</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>.</p>
        </sec>
        <sec id="s22">
          <title>Latent heat flux and evaporation</title>
          <p>Latent heat flux is the product of the latent heat of vaporization, the total leaf conductance to water vapour and the water vapour gradient:</p>
          <disp-formula>
            <mml:math id="m90">
              <mml:mstyle displaystyle="true">
                <mml:mtable columnalign="left" columnspacing="1">
                  <mml:mtr>
                    <mml:mtd>
                      <mml:mstyle displaystyle="true">
                        <mml:mi>L</mml:mi>
                        <mml:mo>=</mml:mo>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mi>h</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mrow>
                                <mml:mi mathvariant="normal">v</mml:mi>
                                <mml:mi mathvariant="normal">a</mml:mi>
                                <mml:mi mathvariant="normal">p</mml:mi>
                              </mml:mrow>
                            </mml:mrow>
                          </mml:msub>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mi>g</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mrow>
                                <mml:mi mathvariant="normal">t</mml:mi>
                                <mml:mi mathvariant="normal">w</mml:mi>
                              </mml:mrow>
                            </mml:mrow>
                          </mml:msub>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mi>d</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mrow>
                                <mml:mi mathvariant="normal">w</mml:mi>
                                <mml:mi mathvariant="normal">v</mml:mi>
                              </mml:mrow>
                            </mml:mrow>
                          </mml:msub>
                        </mml:mrow>
                        <mml:mo>.</mml:mo>
                      </mml:mstyle>
                    </mml:mtd>
                  </mml:mtr>
                </mml:mtable>
              </mml:mstyle>
            </mml:math>
            <label>(16)</label>
          </disp-formula>
          <p>The latent heat of vapourization (<inline-formula><mml:math id="m91"><mml:mstyle displaystyle="false"><mml:mrow><mml:msub><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">v</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">p</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>) is a linear function of temperature. <bold>tealeaves</bold> calculates <inline-formula><mml:math id="m92"><mml:mstyle displaystyle="false"><mml:mrow><mml:msub><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">v</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">p</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> using parameters estimated from linear regression on data from <xref rid="CIT0035" ref-type="bibr">Nobel (2009)</xref>:</p>
          <disp-formula>
            <mml:math id="m93">
              <mml:mstyle displaystyle="true">
                <mml:mtable columnalign="left" columnspacing="1">
                  <mml:mtr>
                    <mml:mtd>
                      <mml:mstyle displaystyle="true">
                        <mml:mrow>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mi>h</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mrow>
                                <mml:mi mathvariant="normal">v</mml:mi>
                                <mml:mi mathvariant="normal">a</mml:mi>
                                <mml:mi mathvariant="normal">p</mml:mi>
                              </mml:mrow>
                            </mml:mrow>
                          </mml:msub>
                        </mml:mrow>
                        <mml:mo>=</mml:mo>
                        <mml:mn>56847.68250</mml:mn>
                        <mml:mrow>
                          <mml:mtext> </mml:mtext>
                        </mml:mrow>
                        <mml:mo stretchy="false">[</mml:mo>
                        <mml:mrow>
                          <mml:mi mathvariant="normal">J</mml:mi>
                          <mml:mtext> </mml:mtext>
                          <mml:mi mathvariant="normal">m</mml:mi>
                          <mml:mi mathvariant="normal">o</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:msup>
                            <mml:mrow>
                              <mml:mrow>
                                <mml:mi mathvariant="normal">l</mml:mi>
                              </mml:mrow>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mo>−</mml:mo>
                              <mml:mn>1</mml:mn>
                            </mml:mrow>
                          </mml:msup>
                        </mml:mrow>
                        <mml:mo stretchy="false">]</mml:mo>
                        <mml:mo>−</mml:mo>
                        <mml:mn>43.12514</mml:mn>
                        <mml:mrow>
                          <mml:mtext> </mml:mtext>
                        </mml:mrow>
                        <mml:mo stretchy="false">[</mml:mo>
                        <mml:mrow>
                          <mml:mi mathvariant="normal">J</mml:mi>
                          <mml:mtext> </mml:mtext>
                          <mml:mi mathvariant="normal">m</mml:mi>
                          <mml:mi mathvariant="normal">o</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:msup>
                            <mml:mrow>
                              <mml:mrow>
                                <mml:mi mathvariant="normal">l</mml:mi>
                              </mml:mrow>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mo>−</mml:mo>
                              <mml:mn>1</mml:mn>
                            </mml:mrow>
                          </mml:msup>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mtext> </mml:mtext>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:msup>
                            <mml:mrow>
                              <mml:mrow>
                                <mml:mi mathvariant="normal">K</mml:mi>
                              </mml:mrow>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mo>−</mml:mo>
                              <mml:mn>1</mml:mn>
                            </mml:mrow>
                          </mml:msup>
                        </mml:mrow>
                        <mml:mo stretchy="false">]</mml:mo>
                        <mml:mi>T</mml:mi>
                        <mml:mo stretchy="false">[</mml:mo>
                        <mml:mi>K</mml:mi>
                        <mml:mo stretchy="false">]</mml:mo>
                        <mml:mo>.</mml:mo>
                      </mml:mstyle>
                    </mml:mtd>
                  </mml:mtr>
                </mml:mtable>
              </mml:mstyle>
            </mml:math>
            <label>(17)</label>
          </disp-formula>
          <p>The water vapour pressure differential (<inline-formula><mml:math id="m94"><mml:mstyle displaystyle="false"><mml:mrow><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">w</mml:mi><mml:mi mathvariant="normal">v</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>) from the inside to the outside of the leaf is the water vapor pressure inside the leaf, which is assumed to be saturated (<inline-formula><mml:math id="m95"><mml:mstyle displaystyle="false"><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">t</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>), minus the water vapor pressure of the air (<inline-formula><mml:math id="m96"><mml:mstyle displaystyle="false"><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>), calculated as described above. This value is converted from kPa to mol m<sup>−3</sup> using the ideal gas law:</p>
          <disp-formula>
            <mml:math id="m97">
              <mml:mstyle displaystyle="true">
                <mml:mtable columnalign="left" columnspacing="1">
                  <mml:mtr>
                    <mml:mtd>
                      <mml:mstyle displaystyle="true">
                        <mml:mrow>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mi>d</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mrow>
                                <mml:mi mathvariant="normal">w</mml:mi>
                                <mml:mi mathvariant="normal">v</mml:mi>
                              </mml:mrow>
                            </mml:mrow>
                          </mml:msub>
                        </mml:mrow>
                        <mml:mo>=</mml:mo>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mi>p</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mrow>
                                <mml:mi mathvariant="normal">l</mml:mi>
                                <mml:mi mathvariant="normal">e</mml:mi>
                                <mml:mi mathvariant="normal">a</mml:mi>
                                <mml:mi mathvariant="normal">f</mml:mi>
                              </mml:mrow>
                            </mml:mrow>
                          </mml:msub>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mo>/</mml:mo>
                        </mml:mrow>
                        <mml:mo stretchy="false">(</mml:mo>
                        <mml:mrow>
                          <mml:mstyle displaystyle="true">
                            <mml:mover accent="true">
                              <mml:mi>R</mml:mi>
                              <mml:mo stretchy="false">¯</mml:mo>
                            </mml:mover>
                          </mml:mstyle>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mi>T</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mrow>
                                <mml:mi mathvariant="normal">l</mml:mi>
                                <mml:mi mathvariant="normal">e</mml:mi>
                                <mml:mi mathvariant="normal">a</mml:mi>
                                <mml:mi mathvariant="normal">f</mml:mi>
                              </mml:mrow>
                            </mml:mrow>
                          </mml:msub>
                        </mml:mrow>
                        <mml:mo stretchy="false">)</mml:mo>
                        <mml:mo>−</mml:mo>
                        <mml:mrow>
                          <mml:mi mathvariant="normal">R</mml:mi>
                          <mml:mi mathvariant="normal">H</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mi>p</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mrow>
                                <mml:mi mathvariant="normal">a</mml:mi>
                                <mml:mi mathvariant="normal">i</mml:mi>
                                <mml:mi mathvariant="normal">r</mml:mi>
                              </mml:mrow>
                            </mml:mrow>
                          </mml:msub>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mo>/</mml:mo>
                        </mml:mrow>
                        <mml:mo stretchy="false">(</mml:mo>
                        <mml:mrow>
                          <mml:mstyle displaystyle="true">
                            <mml:mover accent="true">
                              <mml:mi>R</mml:mi>
                              <mml:mo stretchy="false">¯</mml:mo>
                            </mml:mover>
                          </mml:mstyle>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mi>T</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mrow>
                                <mml:mi mathvariant="normal">a</mml:mi>
                                <mml:mi mathvariant="normal">i</mml:mi>
                                <mml:mi mathvariant="normal">r</mml:mi>
                              </mml:mrow>
                            </mml:mrow>
                          </mml:msub>
                        </mml:mrow>
                        <mml:mo stretchy="false">)</mml:mo>
                        <mml:mo>.</mml:mo>
                      </mml:mstyle>
                    </mml:mtd>
                  </mml:mtr>
                </mml:mtable>
              </mml:mstyle>
            </mml:math>
            <label>(18)</label>
          </disp-formula>
          <p><inline-formula><mml:math id="m98"><mml:mstyle displaystyle="false"><mml:mrow><mml:mover accent="true"><mml:mi>R</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow></mml:mstyle></mml:math></inline-formula> is the ideal gas constant. The total conductance to water vapor (<inline-formula><mml:math id="m99"><mml:mstyle displaystyle="false"><mml:mrow><mml:msub><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">w</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>) is the sum of the parallel lower (usually abaxial) and upper (usually adaxial) conductances</p>
          <disp-formula>
            <mml:math id="m100">
              <mml:mstyle displaystyle="true">
                <mml:mtable columnalign="left" columnspacing="1">
                  <mml:mtr>
                    <mml:mtd>
                      <mml:mstyle displaystyle="true">
                        <mml:mrow>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mi>g</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mrow>
                                <mml:mi mathvariant="normal">t</mml:mi>
                                <mml:mi mathvariant="normal">w</mml:mi>
                              </mml:mrow>
                            </mml:mrow>
                          </mml:msub>
                        </mml:mrow>
                        <mml:mo>=</mml:mo>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mi>g</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mrow>
                                <mml:mi mathvariant="normal">w</mml:mi>
                                <mml:mo>,</mml:mo>
                                <mml:mi mathvariant="normal">l</mml:mi>
                                <mml:mi mathvariant="normal">o</mml:mi>
                                <mml:mi mathvariant="normal">w</mml:mi>
                                <mml:mi mathvariant="normal">e</mml:mi>
                                <mml:mi mathvariant="normal">r</mml:mi>
                              </mml:mrow>
                            </mml:mrow>
                          </mml:msub>
                        </mml:mrow>
                        <mml:mo>+</mml:mo>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mi>g</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mrow>
                                <mml:mi mathvariant="normal">w</mml:mi>
                                <mml:mo>,</mml:mo>
                                <mml:mi mathvariant="normal">u</mml:mi>
                                <mml:mi mathvariant="normal">p</mml:mi>
                                <mml:mi mathvariant="normal">p</mml:mi>
                                <mml:mi mathvariant="normal">e</mml:mi>
                                <mml:mi mathvariant="normal">r</mml:mi>
                              </mml:mrow>
                            </mml:mrow>
                          </mml:msub>
                        </mml:mrow>
                        <mml:mo>.</mml:mo>
                      </mml:mstyle>
                    </mml:mtd>
                  </mml:mtr>
                </mml:mtable>
              </mml:mstyle>
            </mml:math>
            <label>(19)</label>
          </disp-formula>
          <p>The conductance to water vapor on each surface is a function of parallel stomatal (<inline-formula><mml:math id="m101"><mml:mstyle displaystyle="false"><mml:mrow><mml:msub><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">w</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>) and cuticular (<inline-formula><mml:math id="m102"><mml:mstyle displaystyle="false"><mml:mrow><mml:msub><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">u</mml:mi><mml:mi mathvariant="normal">w</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>) conductances in series with the boundary layer conductance (<inline-formula><mml:math id="m103"><mml:mstyle displaystyle="false"><mml:mrow><mml:msub><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">b</mml:mi><mml:mi mathvariant="normal">w</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>). The stomatal, cuticular and boundary layer conductance on the lower surface are:</p>
          <disp-formula>
            <mml:math id="m104">
              <mml:mstyle displaystyle="true">
                <mml:mtable columnalign="left" columnspacing="1">
                  <mml:mtr>
                    <mml:mtd>
                      <mml:mstyle displaystyle="true">
                        <mml:mrow>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mi>g</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mrow>
                                <mml:mi mathvariant="normal">s</mml:mi>
                                <mml:mi mathvariant="normal">w</mml:mi>
                              </mml:mrow>
                              <mml:mo>,</mml:mo>
                              <mml:mrow>
                                <mml:mi mathvariant="normal">l</mml:mi>
                                <mml:mi mathvariant="normal">o</mml:mi>
                                <mml:mi mathvariant="normal">w</mml:mi>
                                <mml:mi mathvariant="normal">e</mml:mi>
                                <mml:mi mathvariant="normal">r</mml:mi>
                              </mml:mrow>
                            </mml:mrow>
                          </mml:msub>
                        </mml:mrow>
                        <mml:mo>=</mml:mo>
                        <mml:mo stretchy="false">[</mml:mo>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mi>g</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mrow>
                                <mml:mi mathvariant="normal">s</mml:mi>
                                <mml:mi mathvariant="normal">w</mml:mi>
                              </mml:mrow>
                            </mml:mrow>
                          </mml:msub>
                        </mml:mrow>
                        <mml:mo stretchy="false">(</mml:mo>
                        <mml:mn>1</mml:mn>
                        <mml:mo>−</mml:mo>
                        <mml:mrow>
                          <mml:mi mathvariant="normal">S</mml:mi>
                          <mml:mi mathvariant="normal">R</mml:mi>
                        </mml:mrow>
                        <mml:mo stretchy="false">)</mml:mo>
                        <mml:mo stretchy="false">]</mml:mo>
                        <mml:mo stretchy="false">[</mml:mo>
                        <mml:mi>R</mml:mi>
                        <mml:mo stretchy="false">(</mml:mo>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mi>T</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mrow>
                                <mml:mi mathvariant="normal">l</mml:mi>
                                <mml:mi mathvariant="normal">e</mml:mi>
                                <mml:mi mathvariant="normal">a</mml:mi>
                                <mml:mi mathvariant="normal">f</mml:mi>
                              </mml:mrow>
                            </mml:mrow>
                          </mml:msub>
                        </mml:mrow>
                        <mml:mo>+</mml:mo>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mi>T</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mrow>
                                <mml:mi mathvariant="normal">a</mml:mi>
                                <mml:mi mathvariant="normal">i</mml:mi>
                                <mml:mi mathvariant="normal">r</mml:mi>
                              </mml:mrow>
                            </mml:mrow>
                          </mml:msub>
                        </mml:mrow>
                        <mml:mo stretchy="false">)</mml:mo>
                        <mml:mrow>
                          <mml:mo>/</mml:mo>
                        </mml:mrow>
                        <mml:mn>2</mml:mn>
                        <mml:mo stretchy="false">]</mml:mo>
                      </mml:mstyle>
                    </mml:mtd>
                  </mml:mtr>
                </mml:mtable>
              </mml:mstyle>
            </mml:math>
            <label>(20)</label>
          </disp-formula>
          <disp-formula>
            <mml:math id="m105">
              <mml:mstyle displaystyle="true">
                <mml:mtable columnalign="left" columnspacing="1">
                  <mml:mtr>
                    <mml:mtd>
                      <mml:mstyle displaystyle="true">
                        <mml:mrow>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mi>g</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mrow>
                                <mml:mi mathvariant="normal">u</mml:mi>
                                <mml:mi mathvariant="normal">w</mml:mi>
                                <mml:mo>,</mml:mo>
                                <mml:mi mathvariant="normal">l</mml:mi>
                                <mml:mi mathvariant="normal">o</mml:mi>
                                <mml:mi mathvariant="normal">w</mml:mi>
                                <mml:mi mathvariant="normal">e</mml:mi>
                                <mml:mi mathvariant="normal">r</mml:mi>
                              </mml:mrow>
                            </mml:mrow>
                          </mml:msub>
                        </mml:mrow>
                        <mml:mo>=</mml:mo>
                        <mml:mo stretchy="false">(</mml:mo>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mi>g</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mrow>
                                <mml:mi mathvariant="normal">u</mml:mi>
                                <mml:mi mathvariant="normal">w</mml:mi>
                              </mml:mrow>
                            </mml:mrow>
                          </mml:msub>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mo>/</mml:mo>
                        </mml:mrow>
                        <mml:mn>2</mml:mn>
                        <mml:mo stretchy="false">)</mml:mo>
                        <mml:mo stretchy="false">[</mml:mo>
                        <mml:mi>R</mml:mi>
                        <mml:mo stretchy="false">(</mml:mo>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mi>T</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mrow>
                                <mml:mi mathvariant="normal">l</mml:mi>
                                <mml:mi mathvariant="normal">e</mml:mi>
                                <mml:mi mathvariant="normal">a</mml:mi>
                                <mml:mi mathvariant="normal">f</mml:mi>
                              </mml:mrow>
                            </mml:mrow>
                          </mml:msub>
                        </mml:mrow>
                        <mml:mo>+</mml:mo>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mi>T</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mrow>
                                <mml:mi mathvariant="normal">a</mml:mi>
                                <mml:mi mathvariant="normal">i</mml:mi>
                                <mml:mi mathvariant="normal">r</mml:mi>
                              </mml:mrow>
                            </mml:mrow>
                          </mml:msub>
                        </mml:mrow>
                        <mml:mo stretchy="false">)</mml:mo>
                        <mml:mrow>
                          <mml:mo>/</mml:mo>
                        </mml:mrow>
                        <mml:mn>2</mml:mn>
                        <mml:mo stretchy="false">]</mml:mo>
                        <mml:mo>.</mml:mo>
                      </mml:mstyle>
                    </mml:mtd>
                  </mml:mtr>
                </mml:mtable>
              </mml:mstyle>
            </mml:math>
            <label>(21)</label>
          </disp-formula>
          <p>Note that the user provides the total leaf stomatal and cuticular conductance to water vapur in units of µmol m<sup>−2</sup> s<sup>−1</sup> Pa<sup>−1</sup>, which are then converted to units of m s<sup>−1</sup> using the ideal gas law. Stomatal conductance is partitioned among leaf surfaces depending on stomatal ratio (<inline-formula><mml:math id="m106"><mml:mstyle displaystyle="false"><mml:mrow><mml:mi mathvariant="normal">S</mml:mi><mml:mi mathvariant="normal">R</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>); cuticular conductance is assumed equal on each leaf surface. The corresponding expressions for the upper surface are:</p>
          <disp-formula>
            <mml:math id="m107">
              <mml:mstyle displaystyle="true">
                <mml:mtable columnalign="left" columnspacing="1">
                  <mml:mtr>
                    <mml:mtd>
                      <mml:mstyle displaystyle="true">
                        <mml:mrow>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mi>g</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mrow>
                                <mml:mi mathvariant="normal">s</mml:mi>
                                <mml:mi mathvariant="normal">w</mml:mi>
                                <mml:mo>,</mml:mo>
                                <mml:mi mathvariant="normal">u</mml:mi>
                                <mml:mi mathvariant="normal">p</mml:mi>
                                <mml:mi mathvariant="normal">p</mml:mi>
                                <mml:mi mathvariant="normal">e</mml:mi>
                                <mml:mi mathvariant="normal">r</mml:mi>
                              </mml:mrow>
                            </mml:mrow>
                          </mml:msub>
                        </mml:mrow>
                        <mml:mo>=</mml:mo>
                        <mml:mo stretchy="false">(</mml:mo>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mi>g</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mrow>
                                <mml:mi mathvariant="normal">s</mml:mi>
                                <mml:mi mathvariant="normal">w</mml:mi>
                              </mml:mrow>
                            </mml:mrow>
                          </mml:msub>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi mathvariant="normal">S</mml:mi>
                          <mml:mi mathvariant="normal">R</mml:mi>
                        </mml:mrow>
                        <mml:mo stretchy="false">)</mml:mo>
                        <mml:mo stretchy="false">[</mml:mo>
                        <mml:mi>R</mml:mi>
                        <mml:mo stretchy="false">(</mml:mo>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mi>T</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mrow>
                                <mml:mi mathvariant="normal">l</mml:mi>
                                <mml:mi mathvariant="normal">e</mml:mi>
                                <mml:mi mathvariant="normal">a</mml:mi>
                                <mml:mi mathvariant="normal">f</mml:mi>
                              </mml:mrow>
                            </mml:mrow>
                          </mml:msub>
                        </mml:mrow>
                        <mml:mo>+</mml:mo>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mi>T</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mrow>
                                <mml:mi mathvariant="normal">a</mml:mi>
                                <mml:mi mathvariant="normal">i</mml:mi>
                                <mml:mi mathvariant="normal">r</mml:mi>
                              </mml:mrow>
                            </mml:mrow>
                          </mml:msub>
                        </mml:mrow>
                        <mml:mo stretchy="false">)</mml:mo>
                        <mml:mrow>
                          <mml:mo>/</mml:mo>
                        </mml:mrow>
                        <mml:mn>2</mml:mn>
                        <mml:mo stretchy="false">]</mml:mo>
                      </mml:mstyle>
                    </mml:mtd>
                  </mml:mtr>
                </mml:mtable>
              </mml:mstyle>
            </mml:math>
            <label>(22)</label>
          </disp-formula>
          <disp-formula>
            <mml:math id="m108">
              <mml:mstyle displaystyle="true">
                <mml:mtable columnalign="left" columnspacing="1">
                  <mml:mtr>
                    <mml:mtd>
                      <mml:mstyle displaystyle="true">
                        <mml:mrow>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mi>g</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mrow>
                                <mml:mi mathvariant="normal">u</mml:mi>
                                <mml:mi mathvariant="normal">w</mml:mi>
                                <mml:mo>,</mml:mo>
                                <mml:mi mathvariant="normal">u</mml:mi>
                                <mml:mi mathvariant="normal">p</mml:mi>
                                <mml:mi mathvariant="normal">p</mml:mi>
                                <mml:mi mathvariant="normal">e</mml:mi>
                                <mml:mi mathvariant="normal">r</mml:mi>
                              </mml:mrow>
                            </mml:mrow>
                          </mml:msub>
                        </mml:mrow>
                        <mml:mo>=</mml:mo>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mi>g</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mrow>
                                <mml:mi mathvariant="normal">u</mml:mi>
                                <mml:mi mathvariant="normal">w</mml:mi>
                                <mml:mo>,</mml:mo>
                                <mml:mi mathvariant="normal">l</mml:mi>
                                <mml:mi mathvariant="normal">o</mml:mi>
                                <mml:mi mathvariant="normal">w</mml:mi>
                                <mml:mi mathvariant="normal">e</mml:mi>
                                <mml:mi mathvariant="normal">r</mml:mi>
                              </mml:mrow>
                            </mml:mrow>
                          </mml:msub>
                        </mml:mrow>
                        <mml:mo>.</mml:mo>
                      </mml:mstyle>
                    </mml:mtd>
                  </mml:mtr>
                </mml:mtable>
              </mml:mstyle>
            </mml:math>
            <label>(23)</label>
          </disp-formula>
          <p>Partitioning total stomatal and cuticular conductance to water vapor across surfaces is not typically part of leaf energy budget models. However, stomatal (<xref rid="CIT0033" ref-type="bibr">Muir 2015</xref>) and cuticular (<xref rid="CIT0025" ref-type="bibr">Karbulková <italic>et al</italic>. 2008</xref>) conductance can differ dramatically on each surface, so it could be useful modify these parameters, especially if leaf temperature models are integrated with photosynthetic models (<xref rid="CIT0034" ref-type="bibr">Muir 2019</xref>).</p>
          <p>The boundary layer conductances for each surface differ because of free convection (<xref rid="CIT0013" ref-type="bibr">Foster and Smith 1986</xref>) and are calculated similarly to that for heat (Equation 7):</p>
          <disp-formula>
            <mml:math id="m109">
              <mml:mstyle displaystyle="true">
                <mml:mtable columnalign="left" columnspacing="1">
                  <mml:mtr>
                    <mml:mtd>
                      <mml:mstyle displaystyle="true">
                        <mml:mrow>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mi>g</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mrow>
                                <mml:mi mathvariant="normal">b</mml:mi>
                                <mml:mi mathvariant="normal">w</mml:mi>
                              </mml:mrow>
                            </mml:mrow>
                          </mml:msub>
                        </mml:mrow>
                        <mml:mo>=</mml:mo>
                        <mml:mfrac>
                          <mml:mrow>
                            <mml:mrow>
                              <mml:msub>
                                <mml:mrow>
                                  <mml:mi>D</mml:mi>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mi>w</mml:mi>
                                </mml:mrow>
                              </mml:msub>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mi mathvariant="normal">S</mml:mi>
                              <mml:mi mathvariant="normal">h</mml:mi>
                            </mml:mrow>
                          </mml:mrow>
                          <mml:mi>d</mml:mi>
                        </mml:mfrac>
                        <mml:mo>.</mml:mo>
                      </mml:mstyle>
                    </mml:mtd>
                  </mml:mtr>
                </mml:mtable>
              </mml:mstyle>
            </mml:math>
            <label>(24)</label>
          </disp-formula>
          <p>The diffusion coefficient for water vapor in air at a given temperature (<italic>D</italic><sub>w</sub>) is calculated using the Equation 8, except that is <italic>D</italic><sub>w,0</sub> is substituted for <italic>D</italic><sub>h,0</sub>. Each surface has its own Sherwood number (<inline-formula><mml:math id="m110"><mml:mstyle displaystyle="false"><mml:mrow><mml:mi mathvariant="normal">S</mml:mi><mml:mi mathvariant="normal">h</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>):</p>
          <disp-formula>
            <mml:math id="m111">
              <mml:mrow>
                <mml:mtable columnalign="left">
                  <mml:mtr columnalign="left">
                    <mml:mtd columnalign="left">
                      <mml:mrow>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mtext>Sh</mml:mtext>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mtext>forced</mml:mtext>
                          </mml:mrow>
                        </mml:msub>
                        <mml:mo>=</mml:mo>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mtext>Nu</mml:mtext>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mtext>forced</mml:mtext>
                          </mml:mrow>
                        </mml:msub>
                        <mml:msup>
                          <mml:mrow>
                            <mml:mo stretchy="false">(</mml:mo>
                            <mml:msub>
                              <mml:mi>D</mml:mi>
                              <mml:mi>h</mml:mi>
                            </mml:msub>
                            <mml:mo>/</mml:mo>
                            <mml:msub>
                              <mml:mi>D</mml:mi>
                              <mml:mi>w</mml:mi>
                            </mml:msub>
                            <mml:mo stretchy="false">)</mml:mo>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mfrac>
                              <mml:mn>1</mml:mn>
                              <mml:mi>3</mml:mi>
                            </mml:mfrac>
                          </mml:mrow>
                        </mml:msup>
                      </mml:mrow>
                    </mml:mtd>
                  </mml:mtr>
                </mml:mtable>
              </mml:mrow>
            </mml:math>
            <label>(25)</label>
          </disp-formula>
          <disp-formula>
            <mml:math id="m112">
              <mml:mrow>
                <mml:mtable columnalign="left">
                  <mml:mtr columnalign="left">
                    <mml:mtd columnalign="left">
                      <mml:mrow>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mtext>Sh</mml:mtext>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mtext>free</mml:mtext>
                          </mml:mrow>
                        </mml:msub>
                        <mml:mo>=</mml:mo>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mtext>Nu</mml:mtext>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mtext>free</mml:mtext>
                          </mml:mrow>
                        </mml:msub>
                        <mml:msup>
                          <mml:mrow>
                            <mml:mo stretchy="false">(</mml:mo>
                            <mml:msub>
                              <mml:mi>D</mml:mi>
                              <mml:mi>h</mml:mi>
                            </mml:msub>
                            <mml:mo>/</mml:mo>
                            <mml:msub>
                              <mml:mi>D</mml:mi>
                              <mml:mi>w</mml:mi>
                            </mml:msub>
                            <mml:mo stretchy="false">)</mml:mo>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mfrac>
                              <mml:mn>1</mml:mn>
                              <mml:mi>4</mml:mi>
                            </mml:mfrac>
                          </mml:mrow>
                        </mml:msup>
                        <mml:mo>.</mml:mo>
                      </mml:mrow>
                    </mml:mtd>
                  </mml:mtr>
                </mml:mtable>
              </mml:mrow>
            </mml:math>
            <label>(26)</label>
          </disp-formula>
          <p>As with <inline-formula><mml:math id="m113"><mml:mstyle displaystyle="false"><mml:mrow><mml:mi mathvariant="normal">N</mml:mi><mml:mi mathvariant="normal">u</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>, <inline-formula><mml:math id="m114"><mml:mstyle displaystyle="false"><mml:mrow><mml:mi mathvariant="normal">S</mml:mi><mml:mi mathvariant="normal">h</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> is calculated assuming mixed convection:</p>
          <disp-formula>
            <mml:math id="m115">
              <mml:mstyle displaystyle="true">
                <mml:mtable columnalign="left" columnspacing="1">
                  <mml:mtr>
                    <mml:mtd>
                      <mml:mstyle displaystyle="true">
                        <mml:mrow>
                          <mml:mi mathvariant="normal">S</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:msup>
                            <mml:mrow>
                              <mml:mrow>
                                <mml:mi mathvariant="normal">h</mml:mi>
                              </mml:mrow>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mn>3.5</mml:mn>
                            </mml:mrow>
                          </mml:msup>
                        </mml:mrow>
                        <mml:mo>=</mml:mo>
                        <mml:msubsup>
                          <mml:mrow>
                            <mml:mi mathvariant="normal">S</mml:mi>
                            <mml:mi mathvariant="normal">h</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mrow>
                              <mml:mi mathvariant="normal">f</mml:mi>
                              <mml:mi mathvariant="normal">o</mml:mi>
                              <mml:mi mathvariant="normal">r</mml:mi>
                              <mml:mi mathvariant="normal">c</mml:mi>
                              <mml:mi mathvariant="normal">e</mml:mi>
                              <mml:mi mathvariant="normal">d</mml:mi>
                            </mml:mrow>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mn>3.5</mml:mn>
                          </mml:mrow>
                        </mml:msubsup>
                        <mml:mo>+</mml:mo>
                        <mml:msubsup>
                          <mml:mrow>
                            <mml:mi mathvariant="normal">S</mml:mi>
                            <mml:mi mathvariant="normal">h</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mrow>
                              <mml:mi mathvariant="normal">f</mml:mi>
                              <mml:mi mathvariant="normal">r</mml:mi>
                              <mml:mi mathvariant="normal">e</mml:mi>
                              <mml:mi mathvariant="normal">e</mml:mi>
                            </mml:mrow>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mn>3.5</mml:mn>
                          </mml:mrow>
                        </mml:msubsup>
                        <mml:mo>.</mml:mo>
                      </mml:mstyle>
                    </mml:mtd>
                  </mml:mtr>
                </mml:mtable>
              </mml:mstyle>
            </mml:math>
            <label>(27)</label>
          </disp-formula>
          <p>Evaporation rate (mol H<sub>2</sub>O m<sup>−2</sup> s<sup>−1</sup>) is the product of the total conductance to water vapour (Equation 19) and the water vapour gradient (Equation 18):</p>
          <disp-formula>
            <mml:math id="m116">
              <mml:mstyle displaystyle="true">
                <mml:mtable columnalign="left" columnspacing="1">
                  <mml:mtr>
                    <mml:mtd>
                      <mml:mstyle displaystyle="true">
                        <mml:mi>E</mml:mi>
                        <mml:mo>=</mml:mo>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mi>g</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mrow>
                                <mml:mi mathvariant="normal">t</mml:mi>
                                <mml:mi mathvariant="normal">w</mml:mi>
                              </mml:mrow>
                            </mml:mrow>
                          </mml:msub>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mi>d</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mrow>
                                <mml:mi mathvariant="normal">w</mml:mi>
                                <mml:mi mathvariant="normal">v</mml:mi>
                              </mml:mrow>
                            </mml:mrow>
                          </mml:msub>
                        </mml:mrow>
                        <mml:mo>.</mml:mo>
                      </mml:mstyle>
                    </mml:mtd>
                  </mml:mtr>
                </mml:mtable>
              </mml:mstyle>
            </mml:math>
            <label>(28)</label>
          </disp-formula>
        </sec>
      </sec>
    </app>
  </app-group>
</back>
