<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d3 20150301//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 39.96?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
    <journal-id journal-id-type="iso-abbrev">PLoS Comput Biol</journal-id>
    <journal-id journal-id-type="publisher-id">plos</journal-id>
    <journal-id journal-id-type="pmc">ploscomp</journal-id>
    <journal-title-group>
      <journal-title>PLoS Computational Biology</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1553-734X</issn>
    <issn pub-type="epub">1553-7358</issn>
    <publisher>
      <publisher-name>Public Library of Science</publisher-name>
      <publisher-loc>San Francisco, CA USA</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">7963045</article-id>
    <article-id pub-id-type="doi">10.1371/journal.pcbi.1008804</article-id>
    <article-id pub-id-type="publisher-id">PCOMPBIOL-D-20-00749</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research Article</subject>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and Analysis Methods</subject>
        <subj-group>
          <subject>Spectrum Analysis Techniques</subject>
          <subj-group>
            <subject>Spectrophotometry</subject>
            <subj-group>
              <subject>Cytophotometry</subject>
              <subj-group>
                <subject>Flow Cytometry</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Computer and Information Sciences</subject>
        <subj-group>
          <subject>Data Management</subject>
          <subj-group>
            <subject>Data Visualization</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Cell Biology</subject>
          <subj-group>
            <subject>Cytometry</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Computer and Information Sciences</subject>
        <subj-group>
          <subject>Data Acquisition</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and Analysis Methods</subject>
        <subj-group>
          <subject>Database and Informatics Methods</subject>
          <subj-group>
            <subject>Bioinformatics</subject>
            <subj-group>
              <subject>Sequence Analysis</subject>
              <subj-group>
                <subject>Sequence Alignment</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and Analysis Methods</subject>
        <subj-group>
          <subject>Mathematical and Statistical Techniques</subject>
          <subj-group>
            <subject>Cluster Analysis</subject>
            <subj-group>
              <subject>Hierarchical Clustering</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Cell Biology</subject>
          <subj-group>
            <subject>Cellular Types</subject>
            <subj-group>
              <subject>Animal Cells</subject>
              <subj-group>
                <subject>Blood Cells</subject>
                <subj-group>
                  <subject>White Blood Cells</subject>
                  <subj-group>
                    <subject>Monocytes</subject>
                  </subj-group>
                </subj-group>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Cell Biology</subject>
          <subj-group>
            <subject>Cellular Types</subject>
            <subj-group>
              <subject>Animal Cells</subject>
              <subj-group>
                <subject>Immune Cells</subject>
                <subj-group>
                  <subject>White Blood Cells</subject>
                  <subj-group>
                    <subject>Monocytes</subject>
                  </subj-group>
                </subj-group>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Immunology</subject>
          <subj-group>
            <subject>Immune Cells</subject>
            <subj-group>
              <subject>White Blood Cells</subject>
              <subj-group>
                <subject>Monocytes</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Medicine and Health Sciences</subject>
        <subj-group>
          <subject>Immunology</subject>
          <subj-group>
            <subject>Immune Cells</subject>
            <subj-group>
              <subject>White Blood Cells</subject>
              <subj-group>
                <subject>Monocytes</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and life sciences</subject>
        <subj-group>
          <subject>Cell biology</subject>
          <subj-group>
            <subject>Cellular types</subject>
            <subj-group>
              <subject>Animal cells</subject>
              <subj-group>
                <subject>Blood cells</subject>
                <subj-group>
                  <subject>White blood cells</subject>
                  <subj-group>
                    <subject>NK cells</subject>
                  </subj-group>
                </subj-group>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and life sciences</subject>
        <subj-group>
          <subject>Cell biology</subject>
          <subj-group>
            <subject>Cellular types</subject>
            <subj-group>
              <subject>Animal cells</subject>
              <subj-group>
                <subject>Immune cells</subject>
                <subj-group>
                  <subject>White blood cells</subject>
                  <subj-group>
                    <subject>NK cells</subject>
                  </subj-group>
                </subj-group>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and life sciences</subject>
        <subj-group>
          <subject>Immunology</subject>
          <subj-group>
            <subject>Immune cells</subject>
            <subj-group>
              <subject>White blood cells</subject>
              <subj-group>
                <subject>NK cells</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Medicine and health sciences</subject>
        <subj-group>
          <subject>Immunology</subject>
          <subj-group>
            <subject>Immune cells</subject>
            <subj-group>
              <subject>White blood cells</subject>
              <subj-group>
                <subject>NK cells</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>JSOM: Jointly-evolving self-organizing maps for alignment of biological datasets and identification of related clusters</article-title>
      <alt-title alt-title-type="running-head">JSOM: Jointly-evolving self-organizing maps</alt-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-3641-231X</contrib-id>
        <name>
          <surname>Lim</surname>
          <given-names>Hong Seo</given-names>
        </name>
        <role content-type="https://casrai.org/credit/">Conceptualization</role>
        <role content-type="https://casrai.org/credit/">Data curation</role>
        <role content-type="https://casrai.org/credit/">Formal analysis</role>
        <role content-type="https://casrai.org/credit/">Investigation</role>
        <role content-type="https://casrai.org/credit/">Methodology</role>
        <role content-type="https://casrai.org/credit/">Resources</role>
        <role content-type="https://casrai.org/credit/">Software</role>
        <role content-type="https://casrai.org/credit/">Validation</role>
        <role content-type="https://casrai.org/credit/">Visualization</role>
        <role content-type="https://casrai.org/credit/">Writing – original draft</role>
        <role content-type="https://casrai.org/credit/">Writing – review &amp; editing</role>
        <xref ref-type="aff" rid="aff001"/>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0003-3256-0734</contrib-id>
        <name>
          <surname>Qiu</surname>
          <given-names>Peng</given-names>
        </name>
        <role content-type="https://casrai.org/credit/">Conceptualization</role>
        <role content-type="https://casrai.org/credit/">Data curation</role>
        <role content-type="https://casrai.org/credit/">Formal analysis</role>
        <role content-type="https://casrai.org/credit/">Funding acquisition</role>
        <role content-type="https://casrai.org/credit/">Investigation</role>
        <role content-type="https://casrai.org/credit/">Methodology</role>
        <role content-type="https://casrai.org/credit/">Project administration</role>
        <role content-type="https://casrai.org/credit/">Resources</role>
        <role content-type="https://casrai.org/credit/">Supervision</role>
        <role content-type="https://casrai.org/credit/">Validation</role>
        <role content-type="https://casrai.org/credit/">Visualization</role>
        <role content-type="https://casrai.org/credit/">Writing – original draft</role>
        <role content-type="https://casrai.org/credit/">Writing – review &amp; editing</role>
        <xref ref-type="corresp" rid="cor001">*</xref>
        <xref ref-type="aff" rid="aff001"/>
      </contrib>
    </contrib-group>
    <aff id="aff001">
      <addr-line>Department of Biomedical Engineering, Georgia Institute of Technology and Emory University, Atlanta, Georgia, United States of America</addr-line>
    </aff>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Cai</surname>
          <given-names>GuoShuai</given-names>
        </name>
        <role>Editor</role>
        <xref ref-type="aff" rid="edit1"/>
      </contrib>
    </contrib-group>
    <aff id="edit1">
      <addr-line>University of South Carolina, UNITED STATES</addr-line>
    </aff>
    <author-notes>
      <fn fn-type="COI-statement" id="coi001">
        <p>The authors have declared that no competing interests exist.</p>
      </fn>
      <corresp id="cor001">* E-mail: <email>peng.qiu@bme.gatech.edu</email></corresp>
    </author-notes>
    <pub-date pub-type="epub">
      <day>16</day>
      <month>3</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="collection">
      <month>3</month>
      <year>2021</year>
    </pub-date>
    <volume>17</volume>
    <issue>3</issue>
    <elocation-id>e1008804</elocation-id>
    <history>
      <date date-type="received">
        <day>3</day>
        <month>5</month>
        <year>2020</year>
      </date>
      <date date-type="accepted">
        <day>15</day>
        <month>2</month>
        <year>2021</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© 2021 Lim, Qiu</copyright-statement>
      <copyright-year>2021</copyright-year>
      <copyright-holder>Lim, Qiu</copyright-holder>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <self-uri content-type="pdf" xlink:href="pcbi.1008804.pdf"/>
    <abstract>
      <p>With the rapid advances of various single-cell technologies, an increasing number of single-cell datasets are being generated, and the computational tools for aligning the datasets which make subsequent integration or meta-analysis possible have become critical. Typically, single-cell datasets from different technologies cannot be directly combined or concatenated, due to the innate difference in the data, such as the number of measured parameters and the distributions. Even datasets generated by the same technology are often affected by the batch effect. A computational approach for aligning different datasets and hence identifying related clusters will be useful for data integration and interpretation in large scale single-cell experiments. Our proposed algorithm called JSOM, a variation of the Self-organizing map, aligns two related datasets that contain similar clusters, by constructing two maps—low-dimensional discretized representation of datasets–that jointly evolve according to both datasets. Here we applied the JSOM algorithm to flow cytometry, mass cytometry, and single-cell RNA sequencing datasets. The resulting JSOM maps not only align the related clusters in the two datasets but also preserve the topology of the datasets so that the maps could be used for further analysis, such as clustering.</p>
    </abstract>
    <abstract abstract-type="summary">
      <title>Author summary</title>
      <p>Biological datasets are now generated more than ever as many data acquisition technologies have been developed over the years, especially single-cell technologies. With increasing amounts of datasets available for larger scale studies, robust computational tools that could align datasets are needed for data integration and interpretation. We present a new algorithm that can align two biological datasets and demonstrated that the algorithm can work with data generated from different data acquisition technologies. Our proposed algorithm produces low dimensional representations of two datasets to align them in a way that preserves the topology of the respective datasets. Such aligned maps facilitate further analysis, such as clustering. The proposed algorithm showed promising results when applied to different combinations of datasets, i.e., flow cytometry to flow cytometry, flow cytometry to mass cytometry, and two different single-cell RNA sequencing technologies. Therefore, our newly developed algorithm could potentially lead to new discoveries that were once difficult to obtain.</p>
    </abstract>
    <funding-group>
      <award-group id="award001">
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/100007028</institution-id>
            <institution>Leona M. and Harry B. Helmsley Charitable Trust</institution>
          </institution-wrap>
        </funding-source>
        <award-id>G-2007-04028</award-id>
        <principal-award-recipient>
          <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0003-3256-0734</contrib-id>
          <name>
            <surname>Qiu</surname>
            <given-names>Peng</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group id="award002">
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/100000001</institution-id>
            <institution>National Science Foundation</institution>
          </institution-wrap>
        </funding-source>
        <award-id>CCF1552784</award-id>
        <principal-award-recipient>
          <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0003-3256-0734</contrib-id>
          <name>
            <surname>Qiu</surname>
            <given-names>Peng</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group id="award003">
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/501100008982</institution-id>
            <institution>National Science Foundation</institution>
          </institution-wrap>
        </funding-source>
        <award-id>CCF2007029</award-id>
        <principal-award-recipient>
          <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0003-3256-0734</contrib-id>
          <name>
            <surname>Qiu</surname>
            <given-names>Peng</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group id="award004">
        <funding-source>
          <institution>ISAC Marylou Ingram Scholars Program</institution>
        </funding-source>
        <principal-award-recipient>
          <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0003-3256-0734</contrib-id>
          <name>
            <surname>Qiu</surname>
            <given-names>Peng</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group id="award005">
        <funding-source>
          <institution>Carol Ann and David D. Flanagan</institution>
        </funding-source>
        <award-id>Faculty fellowship</award-id>
        <principal-award-recipient>
          <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0003-3256-0734</contrib-id>
          <name>
            <surname>Qiu</surname>
            <given-names>Peng</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <funding-statement>This work has been supported by The Leona M. and Harry B. Helmsley Charitable Trust (G-2007-04028 to P.Q.) and the National Science Foundation (CCF1552784 and CCF2007029 to P.Q.). P.Q. is an ISAC Marylou Ingram Scholar and a Carol Ann and David D. Flanagan Faculty Fellow. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
    </funding-group>
    <counts>
      <fig-count count="5"/>
      <table-count count="0"/>
      <page-count count="16"/>
    </counts>
    <custom-meta-group>
      <custom-meta id="data-availability">
        <meta-name>Data Availability</meta-name>
        <meta-value>All source code files are available from the Github database (<ext-link ext-link-type="uri" xlink:href="https://github.com/hlim2033/JSOM">https://github.com/hlim2033/JSOM</ext-link>).</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
  <notes>
    <title>Data Availability</title>
    <p>All source code files are available from the Github database (<ext-link ext-link-type="uri" xlink:href="https://github.com/hlim2033/JSOM">https://github.com/hlim2033/JSOM</ext-link>).</p>
  </notes>
</front>
<body>
  <disp-quote>
    <p>This is a <italic>PLOS Computational Biology</italic> Methods paper.</p>
  </disp-quote>
  <sec sec-type="intro" id="sec001">
    <title>Introduction</title>
    <p>Rapid advances in technology have led to the generation of a myriad of digital data in various types and formats. Specifically, the biology and medicine field experience the noticeable progress in measurement technology, and biological data can now be generated through many different techniques in a higher resolution than ever [<xref rid="pcbi.1008804.ref001" ref-type="bibr">1</xref>]. For instance, multiple parameters of individual cells could now be measured not only through the conventional flow cytometry but also through the mass cytometry [<xref rid="pcbi.1008804.ref002" ref-type="bibr">2</xref>], and the number of parameters measured for both technologies has steadily increased as well. Besides, with the development of next-generation genomic sequencing technologies in recent years, single-cell RNA sequencing (scRNA-seq) is capable of measuring transcriptome at single-cell resolution through various techniques such as Drop-seq, Smart-seq, MARS-seq, CEL-seq, and Seq-Well [<xref rid="pcbi.1008804.ref003" ref-type="bibr">3</xref>–<xref rid="pcbi.1008804.ref008" ref-type="bibr">8</xref>].</p>
    <p>With the growing amount of available data, extensive studies now require comparisons of multiple datasets that are acquired by potentially different technologies. One of the practical utilities of comparing different datasets is the identification of related data points across different datasets. Related data points could reflect they are of the same cell types, or they are related to the same biological function, such as an expression of a gene and its methylation site, for example. Nevertheless, a challenge arises when comparing datasets generated by different technologies, because the data and features may not be readily compatible. Even for the datasets acquired by the same technology, biological datasets are often inherently affected by variations due to non-biological factors, which is called a batch effect. To address these challenges, there have been many studies to facilitate comparison and integration of different datasets. For instance, various methods were developed to facilitate data comparisons and/or to correct batch effect for flow and mass cytometry data [<xref rid="pcbi.1008804.ref009" ref-type="bibr">9</xref>–<xref rid="pcbi.1008804.ref011" ref-type="bibr">11</xref>], and also for microarray and single-cell RNA-seq data [<xref rid="pcbi.1008804.ref012" ref-type="bibr">12</xref>–<xref rid="pcbi.1008804.ref016" ref-type="bibr">16</xref>]. Even though they utilized different approaches from one another, many methods share a common objective of enabling a more robust data integration and comparison of the datasets.</p>
    <p>Here we present a new method called JSOM, which can align two datasets and identify related clusters from the two datasets. JSOM’s strength is highlighted when it is used to match single-cell datasets generated across different platforms, e.g. between flow cytometry and mass cytometry, or between two different single-cell RNA-Seq technologies. JSOM takes two datasets as inputs. The outputs of JSOM are two aligned maps that capture a low-dimensional representation of the organization of cell clusters shared by the input datasets, and can be used to identify related clusters of the two datasets. The utility of JSOM encompasses both clustering the datasets and finding similar clusters across the two datasets. In addition, when cells in one of the input datasets is annotated with cell type labels, JSOM can be used to perform label transfer, predicting cell type labels for cells in the other input dataset. The proposed JSOM is based on the self-organizing map(SOM) [<xref rid="pcbi.1008804.ref017" ref-type="bibr">17</xref>], which is an unsupervised technique producing a low-dimensional discretized representation, called a map, of the training samples. SOM is often used for clustering and dimensionality reduction, and its successful usages in biological data have been shown in various studies [<xref rid="pcbi.1008804.ref018" ref-type="bibr">18</xref>–<xref rid="pcbi.1008804.ref020" ref-type="bibr">20</xref>]. In the original SOM algorithm, the low-dimensional map is iteratively evolved (updated) to resemble the input space of a single dataset. Our proposed algorithm allows two maps to evolve with respect to two datasets simultaneously so that the resulting maps could be used to interpret how the two different datasets are related through the alignment of the maps. In addition to providing the aligned maps, JSOM also effectively cluster the datasets while preserving the topology of the datasets, the features that the original SOM is known for. Here we will describe in detail how JSOM operates and how the jointly-evolved maps could be used to find related clusters of data across different combinations of datasets.</p>
  </sec>
  <sec sec-type="results" id="sec002">
    <title>Results</title>
    <sec id="sec003">
      <title>Outline of JSOM using mouse bone marrow flow cytometry data</title>
      <p>To demonstrate how JSOM works, we applied it to a mouse bone-marrow flow cytometry dataset from Qiu et al. [<xref rid="pcbi.1008804.ref021" ref-type="bibr">21</xref>]. Previous manual gating analysis of this dataset used protein markers such as CD11b, c-kit, B220, TCR-B, CD4, and CD8, to identify five distinct cell types: Myeloids, CD4 T Cells, CD8 T Cells, B Cells, and HSPC. We randomly sampled 20,000 cells from the mouse bone marrow dataset and divided the 20,000 cells into two datasets containing 10,000 cells each. We call the two datasets as dataset1 and dataset2. In addition to the datasets, JSOM also requires information about which features in each dataset are shared (or related) between the two datasets. Given the information of the shared features, JSOM evaluate a datapoint-to-datapoint matching function that maps each data point from one dataset to the data point from the other dataset, that is most related. The matching is by default determined based on the Pearson’s correlation coefficient. Now with the two datasets and the mapping function, all necessary inputs for JSOM are ready. A schematic of the JSOM procedure is described in <xref ref-type="fig" rid="pcbi.1008804.g001">Fig 1</xref>.</p>
      <fig id="pcbi.1008804.g001" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1008804.g001</object-id>
        <label>Fig 1</label>
        <caption>
          <title>Overview of JSOM.</title>
          <p>Overview of JSOM. Dataset1 and Dataset2 are two datasets that measured similar type of cells where different color represents different cell types. Among the features measured for the datasets, feature a, b, c from dataset1 are known to correlate with feature a’, b’, c’ from dataset2. Using the related features, matching functions are figured based on Pearson’s correlation using the related features only. JSOM generates two maps where data points in the two datasets are assigned to nodes in the two maps respectively, and two nodes at the same location of the two maps will represent the same cell types in the two datasets.</p>
        </caption>
        <graphic xlink:href="pcbi.1008804.g001"/>
      </fig>
      <p>The operation of JSOM can be divided into three parts. First, JSOM initializes low-dimensional maps using a rectangular grid of nodes. A user could define the number of nodes, and here we use 100 nodes (10 by 10 in a grid) which is the default setting for JSOM. The location of the nodes is equally spread out in the two-dimensional space, which we call a map. Two maps are initialized one for the dataset1 and the other for the dataset2. For each map, nodes are set to have a vector length corresponding to the number of features of respective datasets. For the mouse bone marrow datasets, both datasets have 14 features, and we will call the collection of vectors of length 14 of the first map as the first set of vectors of nodes, and the collections of vectors of the second map as the second set of vectors of nodes.</p>
      <p>Second, JSOM iteratively updates the set of vectors of the maps. For each iteration, one data point from dataset1 and one data point from dataset2 are randomly chosen. For the data point drawn from dataset1, its Euclidean distance to the first set of vectors of nodes are calculated. A node with smallest distance is determined. The node that contains the closest vector and all the nodes in the neighborhood are updated so that their corresponding first set of vectors resemble the chosen data point from dataset1. Similarly, the second set of vectors of nodes are updated based on the data point drawn from dataset2. We call the above steps independent updating, because they are identical to the original SOM algorithm.</p>
      <p>Joint updating occurs after the independent updating. For the data point drawn from dataset1, its most related data point in dataset2 is determined according to the matching function (e.g., correlation based on the shared features). Then, the node closest to the data point drawn from dataset1 is determined based on Euclidean distances to the first set of vectors, and both the first and second vector sets of nodes of the same location and nearby nodes are updated using the data point drawn from dataset1 and its matched data point from dataset2. The amount of update is proportional to how close, in terms of their correlation, the data point drawn from dataset1 and matched data point from dataset2 are. The same procedure is applied to the data point drawn from dataset2. The above independent and joint updating steps iterate until convergence.</p>
      <p>Lastly, once the maps are fully trained, for every data point in dataset1 and dataset2, JSOM find its nearest node among the updated nodes of the two maps and assign the data point to the closest node (i.e., data points in dataset1 are assigned to nodes the first map, and data points in dataset2 are assigned to the second map). The collection of assignments of data points to nodes is the final result of JSOM, and we claim that data points assigned to the same node are related clusters between the two datasets as illustrated in <xref ref-type="fig" rid="pcbi.1008804.g001">Fig 1</xref>. As an optional step, JSOM could superpose two maps and concatenate two vectors of the same location node and perform the hierarchical clustering of nodes using the concatenated vectors.</p>
      <p><xref ref-type="fig" rid="pcbi.1008804.g002">Fig 2A</xref> visualizes each feature on the two resulting maps after JSOM was applied to the bone marrow datasets. Visually, the maps were aligned as intended. We further quantified the alignment of the maps through root mean square error of each feature for each grid, which turned out to be 0.0346, suggesting the two maps are quantifiably well aligned as shown in the scatter plot in <xref ref-type="fig" rid="pcbi.1008804.g002">Fig 2B</xref>. We were able to confirm that such well aligned maps led to correct matching of cell types in the two datasets, as shown in <xref ref-type="fig" rid="pcbi.1008804.g002">Fig 2C</xref>, which visualizes where data points of each cell type from the two datasets were assigned to. Cells of the same type occupied similar nodes in both maps, suggesting JSOM’s strong performance in aligning datasets and identification of related clusters. Detailed descriptions of the JSOM algorithm are provided in Methods.</p>
      <fig id="pcbi.1008804.g002" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1008804.g002</object-id>
        <label>Fig 2</label>
        <caption>
          <title>JSOM Results on Mouse Bone Marrow Dataset.</title>
          <p>(A) Visualizations of each feature of two maps after JSOM training. Alignment is robust for all features. (B) Scatter plot of pairs of same location grid values is shown on the right. Strong linear relationship suggests the maps are well aligned across all features. (C) Visualizations of distributions of various cell types in the two datasets on the JSOM maps. After JSOM training, data points in the two datasets are assigned to the nodes. For cell type, the percentages of its cells assigned to each node are used to generate the heatmaps. Here, the distributions of B, CD4 T, CD8 T, HSPC and Myeloid cells are shown. Notice that each cell type occupies similar region in the grids.</p>
        </caption>
        <graphic xlink:href="pcbi.1008804.g002"/>
      </fig>
      <p>To quantify the effectiveness of JSOM, we devised two metrics called the node purity score and the matching score (see <xref ref-type="sec" rid="sec009">Methods</xref>). The node purity score is defined as the average proportion of cells from the same dataset assigned to the same nodes of the JSOM maps that shared the same cell type label, hence quantifying the clustering power but independent of the alignment of the two maps. The matching score is defined as the average proportion of cells from the two datasets belonging to the same nodes that shared the same cell type label, which quantifies the alignment of the two maps. The matching score for the above analysis was 0.926, and the clustering score was 0.950. These scores suggest that JSOM successfully clustered each dataset into distinct cell types, and correctly matched the cell types in the two datasets.</p>
    </sec>
    <sec id="sec004">
      <title>Flow cytometry and mass cytometry datasets of human PBMC</title>
      <p>To provide a challenging yet relevant scenario, we applied JSOM to human peripheral blood mononuclear cell (PBMC) datasets acquired by two different technologies, i.e. flow cytometry and mass cytometry. Both technologies aim to measure physical and chemical characteristics of cells and have research applications in medical field including immunology and hematology. Even with the shared objective of measuring similar characteristics of cells, these two technologies generate noticeably different data manifested by different number of features and different distribution of values measured. Hence, comparing datasets acquired by these two technologies could not be easily done even when the datasets represent measurements of the same biology. JSOM could prove useful in the case like this, where datasets are known to be related (i.e. similar biology) and also where there are ways to identify similar/related features between the datasets. From FlowRepository, we downloaded a flow cytometry dataset (<ext-link ext-link-type="uri" xlink:href="https://flowrepository.org/id/FR-FCM-Z2KP">https://flowrepository.org/id/FR-FCM-Z2KP</ext-link>) and a mass cytometry dataset (<ext-link ext-link-type="uri" xlink:href="https://flowrepository.org/id/FR-FCM-ZZWC">https://flowrepository.org/id/FR-FCM-ZZWC</ext-link>), and internally identified cell types through manual gating. The flow cytometry dataset contained measurements of 35 protein markers, and five different cell types were identified. Due to the panel of markers not specialized to identify monocytes, dendritic cells, and natural killer cells, the five cell-type groups that could be identified were (1) B cells, (2) CD4 T cells, (3) CD8 T cells, (4) monocytes and dendritic cells grouped together, and (5) the rest of cells that are conjectured to be natural killer cells. The mass cytometry dataset contained measurements of 48 protein markers, and six different cell types were identified. The identified cell types were (1) B cells, (2) CD4 T cells, (3) CD8 T cells, (4) monocytes, (5) dendritic cells, and (6) NK cells. Between the two datasets there were 7 overlapping protein markers. We used these 7 overlapping markers to define the matching function that connects data points in the two datasets. In this specific example, we demonstrate another option for defining a matching function, called ‘binary’. The ‘binary’ option is motivated by how manual gating is used to identify specific cell types in flow and mass cytometry; cell types are identified through series of binarization of marker expression, such as CD3 positive and CD4 positive resulting in identification of CD4 T cells. In the ‘binary’ mode, we first binarize the data using the StepMiner [<xref rid="pcbi.1008804.ref022" ref-type="bibr">22</xref>] and then the distance between two data points across the two datasets are defined by counting the number of markers that are both positive (or negative) in the two datasets.</p>
      <p>The two datasets were used to align 15-by-15 JSOM maps. Upon training with JSOM, all data points/cells in the two datasets were assigned to nodes in their respective maps by finding the nearest nodes. To confirm how well the maps are aligned, we provided visualizations of the 7 shared features of the two datasets in <xref ref-type="fig" rid="pcbi.1008804.g003">Fig 3A</xref>. Maps on the first row are visualizations of the features for the map corresponding to the flow cytometry data, and the bottom row corresponds to the mass cytometry data. This figure clearly shows that the shared features were aligned across the maps. It is worth noting that here, although we only showed the 7 features that were shared between the two datasets, each map actually contained each dataset’s original number of features, which was 35 and 48 respectively. Such preservation of the original features promoted robust clustering while the shared features promoted robust matching between the two datasets. After data points from each dataset were assigned to their closest nodes, we identified the majority cell type assigned to each node, and displayed the results using what we call the ‘mode maps’ in <xref ref-type="fig" rid="pcbi.1008804.g003">Fig 3B</xref>. Here different color represented distinct cell types. The same colors occupied similar regions in the two mode maps, suggesting that the maps were well aligned, and that at each node level, the cells belonging to the same-location node are indeed of the same/similar cell types. As quantitative measures of JSOM’s performance in aligning these two datasets, the matching score for this analysis was 0.882, and the clustering score is 0.988.</p>
      <fig id="pcbi.1008804.g003" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1008804.g003</object-id>
        <label>Fig 3</label>
        <caption>
          <title>Visualizations of Features and Majority Cell Types of JSOM Maps.</title>
          <p>(A) Visualizations of the 7 features shared by the two datasets. The top row visualized the JSOM map based on the flow cytometry dataset, and the bottom row was based on the mass cytometry dataset. JSOM successfully aligned the two dataset, as manifested by similar color patterns in the two rows. (B) After data points were assigned to nodes, every node’s majority cell type was visualized through the ‘mode maps’. Different colors represented distinct cell types. Two mode maps shared similar color landscapes suggesting the two datasets were correctly matched via JSOM.</p>
        </caption>
        <graphic xlink:href="pcbi.1008804.g003"/>
      </fig>
      <p>As briefly introduced in the overview of JSOM section, JSOM could provide another insight for biological interpretation of the cellular heterogeneity in the data through superposition of two maps—concatenating two vectors of the same location node—and performing the hierarchical clustering of nodes using the concatenated vectors. Users could choose the granularity of the clustering by defining number of clusters they want to see. Applying this, we further clustered the nodes into 7 clusters. Superimposed nodes were clustered by hierarchical clustering with Euclidian distance and Ward’s linkage. We then provided a list of clusters and data assigned for nodes belonging to each cluster from the both datasets. <xref ref-type="fig" rid="pcbi.1008804.g004">Fig 4</xref> summarizes the proportions of various cell types for each of the 7 clusters. For both datasets, clusters 1~2 covered vast majority of B cells, and cluster 3 were assigned with majority of ‘possibly NK cells’ from flow cytometry and NK cells from mass cytometry. Clusters 4 was assigned with monocytes and dendritic cells from both datasets, and cluster 5 ~7 covered the CD4 and CD8 T cells. It is worth noting that each cluster was primarily dominated by one cell type reflected by each row having only one element that had a significant percentage, showing that JSOM effectively separated the cell types while matching/aligning the datasets. Furthermore, it is important to point out that the ‘possibly NK cells’ group in the flow cytometry dataset was matched with NK cells from the mass cytometry dataset, suggesting that the conjecture we made about NK cells in our gating analysis of the flow cytometry dataset was true.</p>
      <fig id="pcbi.1008804.g004" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1008804.g004</object-id>
        <label>Fig 4</label>
        <caption>
          <title>Superposition and Hierarchical Clustering of JSOM Aligned Flow and Mass Cytometry Datasets.</title>
          <p>The tables summarized the compositions of the 7 cell clusters derived by hierarchical clustering of superposition (concatenation) of the two sets of vectors of the JSOM nodes. Each column showed the distribution of one manually gated cell type across the 7 clusters.</p>
        </caption>
        <graphic xlink:href="pcbi.1008804.g004"/>
      </fig>
    </sec>
    <sec id="sec005">
      <title>scRNA-seq datasets from different technologies</title>
      <p>Lastly, we applied JSOM to two scRNA-seq datasets acquired by two distinct technologies. As mentioned previously, recent advances in scRNA-seq have generated multiple experimental technologies and protocols that are used by biologists to investigate cellular heterogeneity of gene expression, and JSOM could facilitate comparisons of datasets generated by different technologies and protocols. Here, the two datasets examined by JSOM were one Peripheral Blood Mononuclear Cells (PBMC) dataset generated by 10X Genomics sequenced on the Illumina NextSeq500, and another PBMC dataset acquired by a technology called Seq-Well introduced by Gierhan et al [<xref rid="pcbi.1008804.ref004" ref-type="bibr">4</xref>].</p>
      <p>The 10X Genomics dataset contained scRNA-seq counts for 32,738 genes in 2,700 single cells, and we identified 6 distinct cell types using Seurat, which is a well-established scRNA-seq analysis tool [<xref rid="pcbi.1008804.ref003" ref-type="bibr">3</xref>]. The Seq-Well data contained gene expression counts for 6,713 genes in 4296 single cells with 7 distinct cell types, of which 6 were overlapped with the 10X Genomics dataset. The cell types were identified using the same computational analysis pipelines used in the original paper [<xref rid="pcbi.1008804.ref004" ref-type="bibr">4</xref>]. To handle the high-dimensionality of the scRNA-seq data, we used the standard preprocessing workflow similar to Seurat. For each dataset, we excluded cells that have unique gene counts over 2,500 or less than 200, and cells that have greater than 5% mitochondrial gene counts. Separately for each dataset, we identified highly variable genes using the variance-to-mean metric, followed by dimension reduction using PCA to keep the top significant principle components defined by permutation analysis [<xref rid="pcbi.1008804.ref003" ref-type="bibr">3</xref>]. After the preprocessing pipeline, the 10X Genomics dataset reduced to 2638 cells with 20 PCA features, and the Seq-Well data reduced to 4214 cells with 30 PCA features. Since the PCA-based dimension reduction was performed separately to the two datasets where the lists of highly variable genes were different, the 20 and 30 PCA features in the preprocessed datasets were not directly comparable.</p>
      <p>To generate the datapoint-to-datapoint matching functions needed for JSOM, we decided to use simple correlation based on the overlap between the lists of highly variable genes in the two datasets. There were a total of 301 common highly variable genes between the two datasets. We used the Pearson’s correlation to construct the datapoint-to-datapoint matching function, which matched each cell in one dataset to the most correlated cell in the other dataset, and vice versa, similar to the matching function in the previous subsection on flow cytometry analysis.</p>
      <p>With the preprocessed datasets and the datapoint-to-datapoint matching function generated by the common highly variable genes, JSOM was applied to align the datasets and identify common cell types. JSOM maps were trained with 20 and 30 PCA features, because the smaller number of features could prevent problems caused by the curse of dimensionality. <xref ref-type="fig" rid="pcbi.1008804.g005">Fig 5</xref> summarizes the results of the JSOM analysis. Upon training with JSOM, all data points/cells in the two datasets were assigned to nodes in their respective maps. We then provided visualizations of the mode maps (<xref ref-type="fig" rid="pcbi.1008804.g005">Fig 5A</xref>). It can be observed that the same cell types in the two datasets occupied the similar regions of their respective maps, which are manifested by similar color pattern across the maps. The matching score for this analysis was 0.887, and the clustering score is 0.964. Once again, the two maps were superimposed, and the hierarchal clustering was applied to the concatenated vectors for clustering the nodes. Here, the hierarchal clustering led to 10 clusters, which were summarized in <xref ref-type="fig" rid="pcbi.1008804.g005">Fig 5B</xref>. Monocytes from both datasets were clustered into the first 4 clusters, and NK, CD4 T, CD8 T, B and dendritic cells were almost exclusively assigned to one or two clusters. Notice that the Seq-Well dataset contains megakaryocytes that were not present in the 10X Genomics dataset. All megakaryocytes were captured by a single cluster, cluster 3. Also, both monocytes and megakaryocytes are derived from the common myeloid progenitor, and the mode map shows that megakaryocytes are located within monocytes. Despite the difficulties stemming from different technologies used for the generation of datasets, JSOM showed it could robustly align maps and identify related clusters.</p>
      <fig id="pcbi.1008804.g005" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1008804.g005</object-id>
        <label>Fig 5</label>
        <caption>
          <title>JSOM Results on Aligning Two scRNA-seq Datasets.</title>
          <p>(A) After JSOM training and assigning data points to nodes, we visualized the JSOM mode maps for the two datasets, showing the regions each cell type occupied in the JSOM map. The similar color landscape of the two visualizations suggested that JSOM successfully aligned the two datasets. (B) The tables summarized the composition of the 10 cell clusters derived by hierarchical clustering of the JSOM superposition of the two datasets. Each column showed the distribution of cells in one cell type across the 10 clusters. The red box indicated cell types shared by both datasets. Megakaryocytes which was only present in the second dataset exclusively occupied one cluster, and only a small proportion of monocytes from the first dataset is assigned to the same cluster. The datasets were correctly aligned as seen by the same cell types assigned to the same clusters.</p>
        </caption>
        <graphic xlink:href="pcbi.1008804.g005"/>
      </fig>
    </sec>
    <sec id="sec006">
      <title>Application as label transfer</title>
      <p>Label transfer refers to the projection of annotated cell labels of a reference dataset to a query dataset. Label transfer is especially useful in single-cell data analysis where labeling of cells require non-trivial amount of efforts and background knowledge. Label transfer comes in conjunction with data integration because transferring of label is infeasible if datasets are not integrated or aligned correctly. Recent developments of the Seurat package included data integration pipelines for integrating various modalities of single-cell sequencing data using ‘anchors’ that identify pairwise correspondence between cells across datasets [<xref rid="pcbi.1008804.ref023" ref-type="bibr">23</xref>], and can be applied to perform label transfer.</p>
      <p>The aligned maps of JSOM could also be used for label transfer. Once the JSOM maps are trained to align two datasets, and data points from the two datasets are assigned to nodes, we have information of how cells are assigned from the first dataset, and how are from the second dataset. If we assume cells from the first dataset as the reference dataset for which we know their labels, the mode defined by the reference dataset could be ‘transferred’ to label cells from the second dataset that we do not know the cell labels. In fact, this is how matching score is evaluated throughout the series of analyses above. To quantify JSOM’s label transfer capacity, we compared our results from aligning the two scRNA-seq datasets from different technologies by applying the same datasets to label-transfer function from SeuratV3 [<xref rid="pcbi.1008804.ref023" ref-type="bibr">23</xref>]. The label transfer accuracy of Seurat was 82.03%, whereas the accuracy of JSOM’s 88.7%. The comparison indicates that JSOM’s label transfer capacity is comparable with the current state-of-the-art tool.</p>
    </sec>
    <sec id="sec007">
      <title>Comparisons with other single-cell batch-effect correction methods</title>
      <p>Combining multiple single-cell RNA sequencing datasets is becoming more prevalent in single-cell data analysis pipelines, and many methods have been developed to facilitate batch-effect removal and data integration [<xref rid="pcbi.1008804.ref024" ref-type="bibr">24</xref>]. Although the main purpose of JSOM is not for correcting batch-effect between different datasets, JSOM produces maps that are able to align related cell clusters in different datasets, and such alignment can be considered as batch-effect correction to some extent. Therefore, we compared JSOM with popular batch-effect correction methods: Seurat3, MNN Correct, and MMD ResNet [<xref rid="pcbi.1008804.ref012" ref-type="bibr">12</xref>,<xref rid="pcbi.1008804.ref023" ref-type="bibr">23</xref>,<xref rid="pcbi.1008804.ref025" ref-type="bibr">25</xref>]. These three methods were selected from a previous benchmarking study for batch-effect correction, where they showed varying levels of performance in two different datasets [<xref rid="pcbi.1008804.ref024" ref-type="bibr">24</xref>]. The first dataset consists of two batches of human blood dendritic cell scRNA-seq data [<xref rid="pcbi.1008804.ref026" ref-type="bibr">26</xref>]. The second dataset consist of data from two independent mouse cell atlas studies. Similar to the previous benchmarking study, 7 major cell types—bladder, kidney, liver, lung, pancreas, spleen, and thymus—from the mouse cell data were chosen in our comparison [<xref rid="pcbi.1008804.ref027" ref-type="bibr">27</xref>,<xref rid="pcbi.1008804.ref028" ref-type="bibr">28</xref>]. We applied JSOM and the three batch-effect correction methods, Seurat3, MNN Correct, and MMD ResNet, to these two datasets. The resulting batch corrected data were pooled together and further clustered using SOM with the same parameters used in JSOM, and the matching score was computed based on the SOM clusters generated from batch corrected data. Therefore, the batch-effect correction methods and JSOM can be directly compared using the matching score which evaluates their ability to align related cell clusters in different datasets. Higher matching score indicated better alignment of related clusters, and thus, better performance in terms of batch-effect correction. We also examined another metric inspired by kBET [<xref rid="pcbi.1008804.ref029" ref-type="bibr">29</xref>], which was used in the previous benchmarking study and aimed to evaluate batch correction performance by measuring the divergence between the local batch label distributions against the global batch label distribution. For each node of JSOM or each SOM cluster from the batch corrected data, we computed the distribution of batch labels for the cells belonging to the node or cluster, which formed a local batch label distribution, local to an individual JSOM node or an individual SOM cluster. For each method compared, we computed the Kullback–Leibler (KL) divergence between the local batch label distributions and the global batch label distribution, and the average KL divergence was used as a metric to evaluate performance. The average KL divergence score to quantifies how well batches are mixed. Lower average KL divergence indicated better mixing of the batches, and thus, better performance.</p>
      <p>When applied to the two batches of human blood dendritic cell scRNA-seq data, JSOM’s matching score was 0.89, compared to 0.88, 0.83, and 0.04 for Seurat3, MNN Correct and MMD ResNet respectively. JSOM’s average KL divergence score was 0.9, compared to 1.47, 1.87, and 4.5 for Seurat3, MNN Correct and MMD ResNet respectively. When applied to align the two mouse cell datasets, JSOM’s matching score was 0.72, compared to 0.76, 0.79, and 0.03 for Seurat3, MNN Correct and MMD ResNet respectively. JSOM’s average KL divergence score was 0.77, compared to 0.77, 0.63, and 3.71 for Seurat3, MNN Correct and MMD ResNet respectively. The comparison among the three batch-effect correction algorithms was consistent with the previous benchmarking study [<xref rid="pcbi.1008804.ref024" ref-type="bibr">24</xref>]. The results from the comparison suggested that JSOM’s performance is comparable to the existing top-performing batch-effect correction methods developed for scRNA-seq data.</p>
    </sec>
  </sec>
  <sec sec-type="conclusions" id="sec008">
    <title>Discussion</title>
    <p>We propose a new algorithm, JSOM, to align two datasets through jointly evolved self-organizing maps. Once the JSOM maps are constructed, the two maps could be used to identify related clusters between the two datasets. The proposed algorithm, which is based on the popular SOM algorithm, induces the joint evolution of the low-dimensional discretized maps, and such a joint-evolving scheme enables the map to not only capture the topology of individual datasets but also align two datasets. As long as there exist features that are shared or related between the two datasets, JSOM could be used to match the two datasets, even if they are generated by different technologies. As shown in the example of aligning flow cytometry and mass cytometry datasets, JSOM could provide robust matching when there were only 7 shared features between the two datasets. Furthermore, the datapoint-to-datapoint matching function could be tailored to reflect the user’s knowledge on the relationship of the two datasets. Note that the features used to define the datapoint-to-datapoint matching function and the features used to update the JSOM vectors do not have to be the same. In the example of aligning two scRNA-seq datasets, the datapoint-to-datapoint matching function was defined by correlation based on 301 overlapping highly variable genes in the two datasets, whereas the JSOM vectors lived in a 20-dimensional PCA space and a 30-dimensional PCA space derived from the two datasets separately. This flexibility decouples (1) the datapoint-to-datapoint matching function which is intended to reflect similarity across the two datasets, and (2) the cluster and similarity structure within each dataset, which are two important aspects for data integration, but are not always captured by the same set of features in the two datasets. We also demonstrated the application of JSOM as label-transfer tool. Although we performed comparison tests for JSOM with other batch-effect correcting methods for the scRNA-seq, we believe JSOM’s strength is its versatility. We demonstrated alignment between flow cytometry and mass cytometry datasets and between two different scRNA-seq technologies, and the combinations could be extended to many different scenarios such as between flow cytometry to scRNA-seq or between scRNA-seq to scATAC-seq. There exist limitations of JSOM to be mentioned. The matching power of JSOM is to some extent subjected to the robustness of datapoint-to-datapoint matching functions that are evaluated from the shared features. JSOM will fail to provide correct matching if the quality of the initial matching function is poor or spurious. For all experiments above, the shared features along with the right modes (‘correlation’ or ‘binary’) resulted in good-quality matching functions. Therefore, special attention is needed to derive the matching functions—through choice of modes and choice of what related features to use—which would benefit from a user’s prior knowledge regarding the relation of the two datasets. It should also be noted that both datasets should be comprised of similar number of distinct types (labels). The number of existing cell-types was the same for the flow cytometry example, and it only differed by one for the flow-mass cytometry example and the scRNA-seq example. JSOM does put more weights on data points that have strong matching in the other dataset yet having non-overlapping types that has spuriously strong matching in the other dataset could potentially generate wrong results. Currently, the number of input datasets to JSOM was limited to two datasets at a time, yet this could be extended to three or more with modification of the algorithm and matching functions. Future studies extending from this paper would focus on improving on the limitations mentioned above for better generalizability.</p>
  </sec>
  <sec sec-type="materials|methods" id="sec009">
    <title>Methods</title>
    <sec id="sec010">
      <title>Data preprocessing</title>
      <p>Although JSOM could be used to align any pair of datasets, we recommend users go through proper data preprocessing that is tailored to the datasets. First, when the datasets contain a wide range of numerical values, a log-like transformation should be used to make all values in a similar scale. Such transformation is commonly recommended as a preprocessing step for many computational algorithms designed for single-cell data generated by flow cytometry, mass cytometry, scRNA-seq, etc. For all flow cytometry datasets examined in this paper, inverse-hyperbolic-sine (arcsinh) transformation with cofactor 150 was applied; for all mass cytometry datasets, inverse-hyperbolic-sine transformation with cofactor 5 was applied; for the scRNA-seq datasets, log transformation was applied. Second, if the number of features is large, the number of features in each dataset should be separately reduced through dimensionality reduction–PCA, or tSNE, etc. Such reduction enables a proper training of JSOM while preventing spurious results caused by the curse of dimensionality. Although giving a perfect threshold of the maximum number of allowable features in JSOM is impossible, the typical dimensionality in scRNA-seq datasets (i.e., around ~30,000) is too large for JSOM to handle. In the example of aligning two scRNA-seq datasets, we reduced the two datasets to 20 and 30 PCA dimensions respectively.</p>
    </sec>
    <sec id="sec011">
      <title>Overview of JSOM</title>
      <p>Procedures of running JSOM could be divided into three different parts: (i) Initialization part where datasets and their datapoint-to-datapoint matching are evaluated, and parameters used for JSOM are determined, (ii) training of JSOM and (iii) post-training part where data are assigned to nodes, and concatenated nodes are further clustered.</p>
      <p>(i) Initialization. JSOM requires the following inputs from the user: two datasets to be compared (dataset1, dataset2), and two derivative datasets that contain the same/related features in the same order as seen from <xref ref-type="fig" rid="pcbi.1008804.g001">Fig 1</xref>. The matching function will be evaluated using the derivative datasets. Along with the matching function, each data point’s matching weight, <italic>δ</italic>, is measured. For correlation method, <italic>δ</italic> is the actual value of the correlation between a datapoint in one dataset and its matched datapoint in the other dataset. For the binary method, <italic>δ</italic> is the number of the co-occurring (both positive or both negative) features out of total number of features. Additionally, users could choose the number of nodes for each axis of the map, <italic>m</italic> and <italic>n</italic> respectively, and the total number of epochs for the training. A matching function contains a series of indices of each datapoint’s most related datapoint from the other dataset. Two grids of <italic>m</italic> by <italic>n</italic> nodes are generated, and each node is assigned with a vector: a vector with a length corresponding to the number of features of either dataset1 or dataset2. The values of all vectors are randomly initialized at the beginning. There are two additional parameters that are optional: <italic>α</italic>, and <italic>ε</italic>. The <italic>α</italic> parameter is a learning rate, which is initially set to 0.9 as a default, and it steadily (linearly) decreases as iteration continues. The <italic>ε</italic> parameter, which determines a radius used to determine the neighboring nodes to be updated, and also reduces as iteration continues until only one node is updated. Please refer to the original SOM for more details about these parameters. The suggested number of epochs is three, which is the default setting of JSOM, and this allows each datapoint to be used at least three times in the training process of the JSOM maps.</p>
      <p>(ii) Training of JSOM. If size of dataset1 or dataset2 is greater than 10,000, JSOM randomly samples 10,000 data points from each dataset. The down-sampleing is performed using the density-dependent down-sampling algorithm introduced in Qiu et al. [<xref rid="pcbi.1008804.ref021" ref-type="bibr">21</xref>], and the down-sampling method aim to equalize the density of data points among various populations in the data, so that equal representation of rare and abundant populations is achieved. Users could choose to skip the density-dependent downsampling. The training of JSOM alternates between independent updating and joint updating. Below are detailed descriptions of the operation of JSOM.</p>
      <p>For the independent updating, a datapoint (<inline-formula id="pcbi.1008804.e001"><alternatives><graphic xlink:href="pcbi.1008804.e001.jpg" id="pcbi.1008804.e001g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M1"><mml:msubsup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula>) from the first dataset (<italic>X</italic><sup>(1)</sup>) is chosen. For the chosen datapoint, its Euclidean distance to all the nodes of the first map (<inline-formula id="pcbi.1008804.e002"><alternatives><graphic xlink:href="pcbi.1008804.e002.jpg" id="pcbi.1008804.e002g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M2"><mml:msubsup><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula>), where <italic>j</italic> = 1⋯<italic>m</italic>*<italic>n</italic>, is measured. Among the nodes, the nearest node with the smallest distance from the datapoint is found. Based on the nearest node, find all neighboring nodes that are within <italic>σ</italic> distance from the nearest node. For iteration <italic>t</italic>, the neighboring nodes that meet the condition along with the nearest node are updated according to the following formula: <inline-formula id="pcbi.1008804.e003"><alternatives><graphic xlink:href="pcbi.1008804.e003.jpg" id="pcbi.1008804.e003g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M3"><mml:msubsup><mml:mrow><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>δ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>*</mml:mo><mml:mi>α</mml:mi><mml:mo>*</mml:mo><mml:mo>(</mml:mo><mml:msubsup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:msubsup><mml:mrow><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msubsup><mml:mo>)</mml:mo></mml:math></alternatives></inline-formula>. Similarly, the same procedures are done for a datapoint (<inline-formula id="pcbi.1008804.e004"><alternatives><graphic xlink:href="pcbi.1008804.e004.jpg" id="pcbi.1008804.e004g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M4"><mml:msubsup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mn>2</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula>) randomly chosen from the second dataset (<italic>X</italic><sup>(2)</sup>), and the nodes of the second map (<inline-formula id="pcbi.1008804.e005"><alternatives><graphic xlink:href="pcbi.1008804.e005.jpg" id="pcbi.1008804.e005g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M5"><mml:msubsup><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mn>2</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula>) are updated according to the following formula: <inline-formula id="pcbi.1008804.e006"><alternatives><graphic xlink:href="pcbi.1008804.e006.jpg" id="pcbi.1008804.e006g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M6"><mml:msubsup><mml:mrow><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mn>2</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mn>2</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>δ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>*</mml:mo><mml:mi>α</mml:mi><mml:mo>*</mml:mo><mml:mo>(</mml:mo><mml:msubsup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:msubsup><mml:mrow><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:msubsup><mml:mo>)</mml:mo></mml:math></alternatives></inline-formula>.</p>
      <p>To perform the joint updating, for the datapoint (<inline-formula id="pcbi.1008804.e007"><alternatives><graphic xlink:href="pcbi.1008804.e007.jpg" id="pcbi.1008804.e007g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M7"><mml:msubsup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula>), find its matched datapoint (<inline-formula id="pcbi.1008804.e008"><alternatives><graphic xlink:href="pcbi.1008804.e008.jpg" id="pcbi.1008804.e008g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M8"><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mo>˜</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula>) from the second dataset (<italic>X</italic><sup>(2)</sup>) according to the evaluated <italic>matching_function1</italic>. For the nodes that were updated via <inline-formula id="pcbi.1008804.e009"><alternatives><graphic xlink:href="pcbi.1008804.e009.jpg" id="pcbi.1008804.e009g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M9"><mml:msubsup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula>, their same corresponding nodes in the second map (<inline-formula id="pcbi.1008804.e010"><alternatives><graphic xlink:href="pcbi.1008804.e010.jpg" id="pcbi.1008804.e010g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M10"><mml:msubsup><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mn>2</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula>) are updated according to the following formula: <inline-formula id="pcbi.1008804.e011"><alternatives><graphic xlink:href="pcbi.1008804.e011.jpg" id="pcbi.1008804.e011g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M11"><mml:msubsup><mml:mrow><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mn>2</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mn>2</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>δ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>*</mml:mo><mml:mi>α</mml:mi><mml:mo>*</mml:mo><mml:mo>(</mml:mo><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mo>˜</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:msubsup><mml:mrow><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:msubsup><mml:mo>)</mml:mo></mml:math></alternatives></inline-formula>. Similarly, For the datapoint (<inline-formula id="pcbi.1008804.e012"><alternatives><graphic xlink:href="pcbi.1008804.e012.jpg" id="pcbi.1008804.e012g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M12"><mml:msubsup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mn>2</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula>), find its matched datapoint (<inline-formula id="pcbi.1008804.e013"><alternatives><graphic xlink:href="pcbi.1008804.e013.jpg" id="pcbi.1008804.e013g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M13"><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mo>˜</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula>) from the first dataset (<italic>X</italic><sup>(1)</sup>) according to the evaluated <italic>matching_function2</italic>. For the nodes that were updated via <inline-formula id="pcbi.1008804.e014"><alternatives><graphic xlink:href="pcbi.1008804.e014.jpg" id="pcbi.1008804.e014g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M14"><mml:msubsup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mn>2</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula>, their same corresponding nodes in the first map (<inline-formula id="pcbi.1008804.e015"><alternatives><graphic xlink:href="pcbi.1008804.e015.jpg" id="pcbi.1008804.e015g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M15"><mml:msubsup><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula>) are updated according to the following formula: <inline-formula id="pcbi.1008804.e016"><alternatives><graphic xlink:href="pcbi.1008804.e016.jpg" id="pcbi.1008804.e016g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M16"><mml:msubsup><mml:mrow><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>δ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>*</mml:mo><mml:mi>α</mml:mi><mml:mo>*</mml:mo><mml:mo>(</mml:mo><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mo>˜</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:msubsup><mml:mrow><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:msubsup><mml:mo>)</mml:mo></mml:math></alternatives></inline-formula>. <italic>α and ε</italic> decrease after one iteration of the update. Initial values for <italic>α</italic> is 0.9 and <italic>ε</italic> is <inline-formula id="pcbi.1008804.e017"><alternatives><graphic xlink:href="pcbi.1008804.e017.jpg" id="pcbi.1008804.e017g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M17"><mml:msqrt><mml:mn>2</mml:mn></mml:msqrt><mml:mo>*</mml:mo><mml:mfrac><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">max</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:mfrac></mml:math></alternatives></inline-formula>, where <italic>m</italic> and <italic>n</italic> represent the grid size of the JSOM map.</p>
      <p>(iii) Post-training data assignment. Upon the training of the map is finalized, JSOM finds each datapoint’s nearest neighboring node using either <inline-formula id="pcbi.1008804.e018"><alternatives><graphic xlink:href="pcbi.1008804.e018.jpg" id="pcbi.1008804.e018g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M18"><mml:msubsup><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> or <inline-formula id="pcbi.1008804.e019"><alternatives><graphic xlink:href="pcbi.1008804.e019.jpg" id="pcbi.1008804.e019g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M19"><mml:msubsup><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mn>2</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula>, and assign the datapoint to the nearest node. Optionally, JSOM could concatenate the two vectors (<inline-formula id="pcbi.1008804.e020"><alternatives><graphic xlink:href="pcbi.1008804.e020.jpg" id="pcbi.1008804.e020g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M20"><mml:msubsup><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1008804.e021"><alternatives><graphic xlink:href="pcbi.1008804.e021.jpg" id="pcbi.1008804.e021g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M21"><mml:msubsup><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mn>2</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula>) for each node and perform hierarchical clustering of the nodes using Ward’s linkage based on Euclidean distance. Users could decide the number of clusters based on their knowledge of the datasets; otherwise, the number of clusters is set to be max (<italic>m</italic>, <italic>n</italic>). Finally, JSOM provides a list of nodes and clusters, as well as lists of indices for assignments of datapoints to nodes and lists of indices for assignments of nodes to clusters.</p>
      <p>The source code of JSOM, along with examples, are available at <ext-link ext-link-type="uri" xlink:href="https://github.com/hlim95/JSOM">https://github.com/hlim95/JSOM</ext-link></p>
    </sec>
    <sec id="sec012">
      <title>Node purity score</title>
      <p>Node purity score quantifies how well JSOM clusters the data. Upon all datapoints are assigned to the nodes of the map, for subset of datapoints assigned to the same node, a mode of the labels is evaluated and the number of datapoints with labels equal to the mode is counted. Finally, node purity score quantifies the proportion of datapoints whose labels are equal to the mode of the nodes. The score ranges from 0–1, with 1 means a perfect clustering of datapoints of the same label into nodes in JSOM. The pseudocode for calculation of the node purity score is described below.</p>
      <p><italic>For each node</italic>,</p>
      <p><italic>Labels1</italic>: = <italic>labels of data assigned from Data1</italic></p>
      <p><italic>Labels2</italic>: = <italic>labels of data assigned from Data2</italic></p>
      <p><italic>Mode1</italic>: = <italic>mode(Labels1)</italic></p>
      <p><italic>Mode2</italic>: = <italic>mode(Labels2)</italic></p>
      <p><italic>Purity_score</italic> = <italic>count(Labels1 = = Mode1) + count(Labels2 = = Mode2)</italic></p>
      <p><italic>Purity_score</italic> + = <italic>Purity_score</italic></p>
      <p><italic>Final_Purity_score</italic> = <inline-formula id="pcbi.1008804.e022"><alternatives><graphic xlink:href="pcbi.1008804.e022.jpg" id="pcbi.1008804.e022g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M22"><mml:mfrac><mml:mrow><mml:mi>P</mml:mi><mml:mi>u</mml:mi><mml:mi>r</mml:mi><mml:mi>t</mml:mi><mml:mi>i</mml:mi><mml:mi>y</mml:mi><mml:mspace width="0.25em"/><mml:mi>S</mml:mi><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi><mml:mo>(</mml:mo><mml:mi>D</mml:mi><mml:mi>a</mml:mi><mml:mi>t</mml:mi><mml:mi>a</mml:mi><mml:mn>1</mml:mn><mml:mo>)</mml:mo><mml:mo>+</mml:mo><mml:mi>l</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi><mml:mo>(</mml:mo><mml:mi>D</mml:mi><mml:mi>a</mml:mi><mml:mi>t</mml:mi><mml:mi>a</mml:mi><mml:mn>2</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:mfrac></mml:math></alternatives></inline-formula></p>
    </sec>
    <sec id="sec013">
      <title>Matching score</title>
      <p>Matching score quantifies how well JSOM aligns two datasets. Upon all datapoints are assigned to the nodes of the map, for the two subset of datapoints assigned to the same nodes in both maps, a mode of the labels from one dataset is evaluated, and the number of datapoints with labels equal to the mode from the other dataset is counted. Matching score quantifies the proportion of datapoints whose labels are equal to the mode of the nodes determined from the first dataset. The score ranges from 0–1, with 1 means a perfect matching result. The pseudocode for calculation of the matchings score is described below.</p>
      <p><italic>For each node</italic>,</p>
      <p><italic>Labels1</italic>: = <italic>labels of data assigned from Data1</italic></p>
      <p><italic>Labels2</italic>: = <italic>labels of data assigned from Data2</italic></p>
      <p><italic>Mode1</italic>: = <italic>mode(Labels1)</italic></p>
      <p><italic>Mode2</italic>: = <italic>mode(Labels2)</italic></p>
      <p><italic>Matching_score</italic> = <italic>count(Labels1 = = Mode2) + count(Labels2 = = Mode1)</italic></p>
      <p><italic>Matching_score</italic> + = <italic>Matching_score</italic></p>
      <p><italic>Final_Matching_score</italic> = <inline-formula id="pcbi.1008804.e023"><alternatives><graphic xlink:href="pcbi.1008804.e023.jpg" id="pcbi.1008804.e023g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M23"><mml:mfrac><mml:mrow><mml:mi>M</mml:mi><mml:mi>a</mml:mi><mml:mi>t</mml:mi><mml:mi>c</mml:mi><mml:mi>h</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mi>g</mml:mi><mml:mo>_</mml:mo><mml:mi>s</mml:mi><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi><mml:mo>(</mml:mo><mml:mi>D</mml:mi><mml:mi>a</mml:mi><mml:mi>t</mml:mi><mml:mi>a</mml:mi><mml:mn>1</mml:mn><mml:mo>)</mml:mo><mml:mo>+</mml:mo><mml:mi>l</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi><mml:mo>(</mml:mo><mml:mi>D</mml:mi><mml:mi>a</mml:mi><mml:mi>t</mml:mi><mml:mi>a</mml:mi><mml:mn>2</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:mfrac></mml:math></alternatives></inline-formula></p>
    </sec>
  </sec>
</body>
<back>
  <ref-list>
    <title>References</title>
    <ref id="pcbi.1008804.ref001">
      <label>1</label>
      <mixed-citation publication-type="journal"><name><surname>Li</surname><given-names>Y</given-names></name>, <name><surname>Chen</surname><given-names>L</given-names></name>. <article-title>Big Biological Data: Challenges and Opportunities</article-title>. <source>Genomics, Proteomics &amp; Bioinformatics</source>. <year>2014</year>;<volume>12</volume>(<issue>5</issue>):<fpage>187</fpage>–<lpage>9</lpage>. <pub-id pub-id-type="doi">10.1016/j.gpb.2014.10.001</pub-id><?supplied-pmid 25462151?><pub-id pub-id-type="pmid">25462151</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008804.ref002">
      <label>2</label>
      <mixed-citation publication-type="journal"><name><surname>Bendall</surname><given-names>SC</given-names></name>, <name><surname>Simonds</surname><given-names>EF</given-names></name>, <name><surname>Qiu</surname><given-names>P</given-names></name>, <name><surname>Amir</surname><given-names>EAD</given-names></name>, <name><surname>Krutzik</surname><given-names>PO</given-names></name>, <name><surname>Finck</surname><given-names>R</given-names></name>, <etal>et al</etal>. <article-title>Single-Cell Mass Cytometry of Differential Immune and Drug Responses Across a Human Hematopoietic Continuum</article-title>. <source>Science</source>. <year>2011</year>;<volume>332</volume>(<issue>6030</issue>):<fpage>687</fpage>–<lpage>96</lpage>. <pub-id pub-id-type="doi">10.1126/science.1198704</pub-id><?supplied-pmid 21551058?><pub-id pub-id-type="pmid">21551058</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008804.ref003">
      <label>3</label>
      <mixed-citation publication-type="journal"><name><surname>Evan</surname></name>, <name><surname>Basu</surname><given-names>A</given-names></name>, <name><surname>Satija</surname><given-names>R</given-names></name>, <name><surname>Nemesh</surname><given-names>J</given-names></name>, <name><surname>Shekhar</surname><given-names>K</given-names></name>, <name><surname>Goldman</surname><given-names>M</given-names></name>, <etal>et al</etal>. <article-title>Highly Parallel Genome-wide Expression Profiling of Individual Cells Using Nanoliter Droplets</article-title>. <source>Cell</source>. <year>2015</year>;<volume>161</volume>(<issue>5</issue>):<fpage>1202</fpage>–<lpage>14</lpage>. <pub-id pub-id-type="doi">10.1016/j.cell.2015.05.002</pub-id><?supplied-pmid 26000488?><pub-id pub-id-type="pmid">26000488</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008804.ref004">
      <label>4</label>
      <mixed-citation publication-type="journal"><name><surname>Gierahn</surname><given-names>TM</given-names></name>, <name><surname>Wadsworth</surname><given-names>MH</given-names></name>, <name><surname>Hughes</surname><given-names>TK</given-names></name>, <name><surname>Bryson</surname><given-names>BD</given-names></name>, <name><surname>Butler</surname><given-names>A</given-names></name>, <name><surname>Satija</surname><given-names>R</given-names></name>, <etal>et al</etal>. <article-title>Seq-Well: portable, low-cost RNA sequencing of single cells at high throughput</article-title>. <source>Nature Methods</source>. <year>2017</year>;<volume>14</volume>(<issue>4</issue>):<fpage>395</fpage>–<lpage>8</lpage>. <pub-id pub-id-type="doi">10.1038/nmeth.4179</pub-id><?supplied-pmid 28192419?><pub-id pub-id-type="pmid">28192419</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008804.ref005">
      <label>5</label>
      <mixed-citation publication-type="journal"><name><surname>Goetz</surname><given-names>JJ</given-names></name>, <name><surname>Trimarchi</surname><given-names>JM</given-names></name>. <article-title>Transcriptome sequencing of single cells with Smart-Seq</article-title>. <source>Nature Biotechnology</source>. <year>2012</year>;<volume>30</volume>(<issue>8</issue>):<fpage>763</fpage>–<lpage>5</lpage>. <pub-id pub-id-type="doi">10.1038/nbt.2325</pub-id><?supplied-pmid 22871714?><pub-id pub-id-type="pmid">22871714</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008804.ref006">
      <label>6</label>
      <mixed-citation publication-type="journal"><name><surname>Hashimshony</surname><given-names>T</given-names></name>, <name><surname>Wagner</surname><given-names>F</given-names></name>, <name><surname>Sher</surname><given-names>N</given-names></name>, <name><surname>Yanai</surname><given-names>I</given-names></name>. <article-title>CEL-Seq: Single-Cell RNA-Seq by Multiplexed Linear Amplification</article-title>. <source>Cell Reports</source>. <year>2012</year>;<volume>2</volume>(<issue>3</issue>):<fpage>666</fpage>–<lpage>73</lpage>. <pub-id pub-id-type="doi">10.1016/j.celrep.2012.08.003</pub-id><?supplied-pmid 22939981?><pub-id pub-id-type="pmid">22939981</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008804.ref007">
      <label>7</label>
      <mixed-citation publication-type="journal"><name><surname>Jaitin</surname><given-names>DA</given-names></name>, <name><surname>Kenigsberg</surname><given-names>E</given-names></name>, <name><surname>Keren-Shaul</surname><given-names>H</given-names></name>, <name><surname>Elefant</surname><given-names>N</given-names></name>, <name><surname>Paul</surname><given-names>F</given-names></name>, <name><surname>Zaretsky</surname><given-names>I</given-names></name>, <etal>et al</etal>. <article-title>Massively Parallel Single-Cell RNA-Seq for Marker-Free Decomposition of Tissues into Cell Types</article-title>. <source>Science</source>. <year>2014</year>;<volume>343</volume>(<issue>6172</issue>):<fpage>776</fpage>–<lpage>9</lpage>. <pub-id pub-id-type="doi">10.1126/science.1247651</pub-id><?supplied-pmid 24531970?><pub-id pub-id-type="pmid">24531970</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008804.ref008">
      <label>8</label>
      <mixed-citation publication-type="journal"><name><surname>Ziegenhain</surname><given-names>C</given-names></name>, <name><surname>Vieth</surname><given-names>B</given-names></name>, <name><surname>Parekh</surname><given-names>S</given-names></name>, <name><surname>Reinius</surname><given-names>B</given-names></name>, <name><surname>Guillaumet-Adkins</surname><given-names>A</given-names></name>, <name><surname>Smets</surname><given-names>M</given-names></name>, <etal>et al</etal>. <article-title>Comparative Analysis of Single-Cell RNA Sequencing Methods</article-title>. <source>Molecular Cell</source>. <year>2017</year>;<volume>65</volume>(<issue>4</issue>):<fpage>631</fpage>–<lpage>43.e4</lpage>. <pub-id pub-id-type="doi">10.1016/j.molcel.2017.01.023</pub-id><?supplied-pmid 28212749?><pub-id pub-id-type="pmid">28212749</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008804.ref009">
      <label>9</label>
      <mixed-citation publication-type="journal"><name><surname>Orlova</surname><given-names>DY</given-names></name>, <name><surname>Meehan</surname><given-names>S</given-names></name>, <name><surname>Parks</surname><given-names>D</given-names></name>, <name><surname>Moore</surname><given-names>WA</given-names></name>, <name><surname>Meehan</surname><given-names>C</given-names></name>, <name><surname>Zhao</surname><given-names>Q</given-names></name>, <etal>et al</etal>. <article-title>QFMatch: multidimensional flow and mass cytometry samples alignment</article-title>. <source>Scientific Reports.</source><year>2018</year>;<volume>8</volume>(<issue>1</issue>). <pub-id pub-id-type="doi">10.1038/s41598-018-21444-4</pub-id><?supplied-pmid 29459702?><pub-id pub-id-type="pmid">29459702</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008804.ref010">
      <label>10</label>
      <mixed-citation publication-type="journal"><name><surname>Lee</surname><given-names>SX</given-names></name>, <name><surname>McLachlan</surname><given-names>GJ</given-names></name>, <name><surname>Pyne</surname><given-names>S</given-names></name>. <article-title>Modeling of inter-sample variation in flow cytometric data with the joint clustering and matching procedure</article-title>. <source>Cytometry Part A</source>. <year>2016</year>;<volume>89</volume>(<issue>1</issue>):<fpage>30</fpage>–<lpage>43</lpage>. <pub-id pub-id-type="doi">10.1002/cyto.a.22789</pub-id><?supplied-pmid 26492316?><pub-id pub-id-type="pmid">26492316</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008804.ref011">
      <label>11</label>
      <mixed-citation publication-type="journal"><name><surname>Hsiao</surname><given-names>C</given-names></name>, <name><surname>Liu</surname><given-names>M</given-names></name>, <name><surname>Stanton</surname><given-names>R</given-names></name>, <name><surname>McGee</surname><given-names>M</given-names></name>, <name><surname>Qian</surname><given-names>Y</given-names></name>, <name><surname>Scheuermann</surname><given-names>RH</given-names></name>. <source>Mapping cell populations in flow cytometry data for cross-sample comparison using the Friedman-Rafsky test statistic as a distance measure</source>. <year>2016</year>;<volume>89</volume>(<issue>1</issue>):<fpage>71</fpage>–<lpage>88</lpage>.</mixed-citation>
    </ref>
    <ref id="pcbi.1008804.ref012">
      <label>12</label>
      <mixed-citation publication-type="journal"><name><surname>Haghverdi</surname><given-names>L</given-names></name>, <name><surname>Lun</surname><given-names>ATL</given-names></name>, <name><surname>Morgan</surname><given-names>MD</given-names></name>, <name><surname>Marioni</surname><given-names>JC</given-names></name>. <article-title>Batch effects in single-cell RNA-sequencing data are corrected by matching mutual nearest neighbors</article-title>. <source>Nature Biotechnology</source>. <year>2018</year>;<volume>36</volume>(<issue>5</issue>):<fpage>421</fpage>–<lpage>7</lpage>. <pub-id pub-id-type="doi">10.1038/nbt.4091</pub-id><?supplied-pmid 29608177?><pub-id pub-id-type="pmid">29608177</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008804.ref013">
      <label>13</label>
      <mixed-citation publication-type="journal"><name><surname>Ritchie</surname><given-names>ME</given-names></name>, <name><surname>Phipson</surname><given-names>B</given-names></name>, <name><surname>Wu</surname><given-names>D</given-names></name>, <name><surname>Hu</surname><given-names>Y</given-names></name>, <name><surname>Law</surname><given-names>CW</given-names></name>, <name><surname>Shi</surname><given-names>W</given-names></name>, <etal>et al</etal>. <article-title>limma powers differential expression analyses for RNA-sequencing and microarray studies</article-title>. <source>Nucleic Acids Research</source>. <year>2015</year>;<volume>43</volume>(<issue>7</issue>):<fpage>e47</fpage>–<lpage>e</lpage>. <pub-id pub-id-type="doi">10.1093/nar/gkv007</pub-id><?supplied-pmid 25605792?><pub-id pub-id-type="pmid">25605792</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008804.ref014">
      <label>14</label>
      <mixed-citation publication-type="journal"><name><surname>Risso</surname><given-names>D</given-names></name>, <name><surname>Ngai</surname><given-names>J</given-names></name>, <name><surname>Speed</surname><given-names>TP</given-names></name>, <name><surname>Dudoit</surname><given-names>S</given-names></name>. <article-title>Normalization of RNA-seq data using factor analysis of control genes or samples</article-title>. <source>Nature Biotechnology</source>. <year>2014</year>;<volume>32</volume>(<issue>9</issue>):<fpage>896</fpage>–<lpage>902</lpage>. <pub-id pub-id-type="doi">10.1038/nbt.2931</pub-id><?supplied-pmid 25150836?><pub-id pub-id-type="pmid">25150836</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008804.ref015">
      <label>15</label>
      <mixed-citation publication-type="journal"><name><surname>Leek</surname><given-names>JT</given-names></name>. <article-title>svaseq: removing batch effects and other unwanted noise from sequencing data</article-title>. <source>Nucleic Acids Research</source>. <year>2014</year>;<volume>42</volume>(<issue>21</issue>):<fpage>e161</fpage>–<lpage>e</lpage>. <pub-id pub-id-type="doi">10.1093/nar/gku864</pub-id><?supplied-pmid 25294822?><pub-id pub-id-type="pmid">25294822</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008804.ref016">
      <label>16</label>
      <mixed-citation publication-type="journal"><name><surname>Johnson</surname><given-names>WE</given-names></name>, <name><surname>Li</surname><given-names>C</given-names></name>, <name><surname>Rabinovic</surname><given-names>A</given-names></name>. <article-title>Adjusting batch effects in microarray expression data using empirical Bayes methods</article-title>. <source>Biostatistics</source>. <year>2007</year>;<volume>8</volume>(<issue>1</issue>):<fpage>118</fpage>–<lpage>27</lpage>. <pub-id pub-id-type="doi">10.1093/biostatistics/kxj037</pub-id><?supplied-pmid 16632515?><pub-id pub-id-type="pmid">16632515</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008804.ref017">
      <label>17</label>
      <mixed-citation publication-type="other">Kohonen T, editor Exploration of very large databases by self-organizing maps: IEEE.</mixed-citation>
    </ref>
    <ref id="pcbi.1008804.ref018">
      <label>18</label>
      <mixed-citation publication-type="journal"><name><surname>Van Gassen</surname><given-names>S</given-names></name>, <name><surname>Callebaut</surname><given-names>B</given-names></name>, <name><surname>Van Helden</surname><given-names>MJ</given-names></name>, <name><surname>Lambrecht</surname><given-names>BN</given-names></name>, <name><surname>Demeester</surname><given-names>P</given-names></name>, <name><surname>Dhaene</surname><given-names>T</given-names></name>, <etal>et al</etal>. <article-title>FlowSOM: Using self-organizing maps for visualization and interpretation of cytometry data</article-title>. <source>Cytometry Part A</source>. <year>2015</year>;<volume>87</volume>(<issue>7</issue>):<fpage>636</fpage>–<lpage>45</lpage>. <pub-id pub-id-type="doi">10.1002/cyto.a.22625</pub-id><?supplied-pmid 25573116?><pub-id pub-id-type="pmid">25573116</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008804.ref019">
      <label>19</label>
      <mixed-citation publication-type="journal"><name><surname>Daniel</surname></name>, <name><surname>Georgi</surname></name>, <name><surname>Pepke</surname><given-names>S</given-names></name>, <name><surname>Zakary</surname></name>, <name><surname>He</surname><given-names>P</given-names></name>, <name><surname>Williams</surname><given-names>B</given-names></name>, <etal>et al</etal>. <article-title>Single-Cell Transcriptome Analysis Reveals Dynamic Changes in lncRNA Expression during Reprogramming</article-title>. <source>Cell Stem Cell</source>. <year>2015</year>;<volume>16</volume>(<issue>1</issue>):<fpage>88</fpage>–<lpage>101</lpage>. <pub-id pub-id-type="doi">10.1016/j.stem.2014.11.005</pub-id><?supplied-pmid 25575081?><pub-id pub-id-type="pmid">25575081</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008804.ref020">
      <label>20</label>
      <mixed-citation publication-type="journal"><name><surname>Zhang</surname><given-names>L</given-names></name>, <name><surname>Zheng</surname><given-names>Y</given-names></name>, <name><surname>Li</surname><given-names>D</given-names></name>, <name><surname>Zhong</surname><given-names>Y</given-names></name>. <article-title>Self-organizing map of gene regulatory networks for cell phenotypes during reprogramming</article-title>. <source>Computational Biology and Chemistry</source>. <year>2011</year>;<volume>35</volume>(<issue>4</issue>):<fpage>211</fpage>–<lpage>7</lpage>. <pub-id pub-id-type="doi">10.1016/j.compbiolchem.2011.05.002</pub-id><?supplied-pmid 21864790?><pub-id pub-id-type="pmid">21864790</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008804.ref021">
      <label>21</label>
      <mixed-citation publication-type="journal"><name><surname>Qiu</surname><given-names>P</given-names></name>, <name><surname>Simonds</surname><given-names>EF</given-names></name>, <name><surname>Bendall</surname><given-names>SC</given-names></name>, <name><surname>Gibbs</surname><given-names>KD</given-names></name>, <name><surname>Bruggner</surname><given-names>RV</given-names></name>, <name><surname>Linderman</surname><given-names>MD</given-names></name>, <etal>et al</etal>. <article-title>Extracting a cellular hierarchy from high-dimensional cytometry data with SPADE</article-title>. <source>Nature Biotechnology</source>. <year>2011</year>;<volume>29</volume>(<issue>10</issue>):<fpage>886</fpage>–<lpage>91</lpage>. <pub-id pub-id-type="doi">10.1038/nbt.1991</pub-id><?supplied-pmid 21964415?><pub-id pub-id-type="pmid">21964415</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008804.ref022">
      <label>22</label>
      <mixed-citation publication-type="journal"><name><surname>Sahoo</surname><given-names>D</given-names></name>, <name><surname>Dill</surname><given-names>DL</given-names></name>, <name><surname>Tibshirani</surname><given-names>R</given-names></name>, <name><surname>Plevritis</surname><given-names>SK</given-names></name>. <article-title>Extracting binary signals from microarray time-course data</article-title>. <source>Nucleic Acids Research</source>. <year>2007</year>;<volume>35</volume>(<issue>11</issue>):<fpage>3705</fpage>–<lpage>12</lpage>. <pub-id pub-id-type="doi">10.1093/nar/gkm284</pub-id><?supplied-pmid 17517782?><pub-id pub-id-type="pmid">17517782</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008804.ref023">
      <label>23</label>
      <mixed-citation publication-type="journal"><name><surname>Stuart</surname><given-names>T</given-names></name>, <name><surname>Butler</surname><given-names>A</given-names></name>, <name><surname>Hoffman</surname><given-names>P</given-names></name>, <name><surname>Hafemeister</surname><given-names>C</given-names></name>, <name><surname>Papalexi</surname><given-names>E</given-names></name>, <name><surname>Mauck</surname><given-names>WM</given-names></name>, <etal>et al</etal>. <article-title>Comprehensive Integration of Single-Cell Data</article-title>. <source>Cell</source>. <year>2019</year>;<volume>177</volume>(<issue>7</issue>):<fpage>1888</fpage>–<lpage>902.e21</lpage>. <pub-id pub-id-type="doi">10.1016/j.cell.2019.05.031</pub-id><?supplied-pmid 31178118?><pub-id pub-id-type="pmid">31178118</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008804.ref024">
      <label>24</label>
      <mixed-citation publication-type="journal"><name><surname>Tran</surname><given-names>HTN</given-names></name>, <name><surname>Ang</surname><given-names>KS</given-names></name>, <name><surname>Chevrier</surname><given-names>M</given-names></name>, <name><surname>Zhang</surname><given-names>X</given-names></name>, <name><surname>Lee</surname><given-names>NYS</given-names></name>, <name><surname>Goh</surname><given-names>M</given-names></name>, <etal>et al</etal>. <article-title>A benchmark of batch-effect correction methods for single-cell RNA sequencing data</article-title>. <source>Genome Biology</source>. <year>2020</year>;<volume>21</volume>(<issue>1</issue>). <pub-id pub-id-type="doi">10.1186/s13059-019-1850-9</pub-id><?supplied-pmid 31948481?><pub-id pub-id-type="pmid">31948481</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008804.ref025">
      <label>25</label>
      <mixed-citation publication-type="journal"><name><surname>Shaham</surname><given-names>U</given-names></name>, <name><surname>Stanton</surname><given-names>KP</given-names></name>, <name><surname>Zhao</surname><given-names>J</given-names></name>, <name><surname>Li</surname><given-names>H</given-names></name>, <name><surname>Raddassi</surname><given-names>K</given-names></name>, <name><surname>Montgomery</surname><given-names>R</given-names></name>, <etal>et al</etal>. <article-title>Removal of batch effects using distribution-matching residual networks</article-title>. <source>Bioinformatics</source>. <year>2017</year>;<volume>33</volume>(<issue>16</issue>):<fpage>2539</fpage>–<lpage>46</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/btx196</pub-id><?supplied-pmid 28419223?><pub-id pub-id-type="pmid">28419223</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008804.ref026">
      <label>26</label>
      <mixed-citation publication-type="journal"><name><surname>Villani</surname><given-names>A-C</given-names></name>, <name><surname>Satija</surname><given-names>R</given-names></name>, <name><surname>Reynolds</surname><given-names>G</given-names></name>, <name><surname>Sarkizova</surname><given-names>S</given-names></name>, <name><surname>Shekhar</surname><given-names>K</given-names></name>, <name><surname>Fletcher</surname><given-names>J</given-names></name>, <etal>et al</etal>. <article-title>Single-cell RNA-seq reveals new types of human blood dendritic cells, monocytes, and progenitors</article-title>. <source>Science</source>. <year>2017</year>;<volume>356</volume>(<issue>6335</issue>):<fpage>eaah4573</fpage>. <pub-id pub-id-type="doi">10.1126/science.aah4573</pub-id><?supplied-pmid 28428369?><pub-id pub-id-type="pmid">28428369</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008804.ref027">
      <label>27</label>
      <mixed-citation publication-type="journal"><name><surname>Han</surname><given-names>X</given-names></name>, <name><surname>Wang</surname><given-names>R</given-names></name>, <name><surname>Zhou</surname><given-names>Y</given-names></name>, <name><surname>Fei</surname><given-names>L</given-names></name>, <name><surname>Sun</surname><given-names>H</given-names></name>, <name><surname>Lai</surname><given-names>S</given-names></name>, <etal>et al</etal>. <article-title>Mapping the Mouse Cell Atlas by Microwell-Seq</article-title>. <source>Cell</source>. <year>2018</year>;<volume>172</volume>(<issue>5</issue>):<fpage>1091</fpage>–<lpage>107.e17</lpage>. <pub-id pub-id-type="doi">10.1016/j.cell.2018.02.001</pub-id><?supplied-pmid 29474909?><pub-id pub-id-type="pmid">29474909</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008804.ref028">
      <label>28</label>
      <mixed-citation publication-type="journal"><article-title>Single-cell transcriptomics of 20 mouse organs creates a Tabula Muris</article-title>. <source>Nature</source>. <year>2018</year>;<volume>562</volume>(<issue>7727</issue>):<fpage>367</fpage>–<lpage>72</lpage>. <pub-id pub-id-type="doi">10.1038/s41586-018-0590-4</pub-id><?supplied-pmid 30283141?><pub-id pub-id-type="pmid">30283141</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008804.ref029">
      <label>29</label>
      <mixed-citation publication-type="journal"><name><surname>Büttner</surname><given-names>M</given-names></name>, <name><surname>Miao</surname><given-names>Z</given-names></name>, <name><surname>Wolf</surname><given-names>FA</given-names></name>, <name><surname>Teichmann</surname><given-names>SA</given-names></name>, <name><surname>Theis</surname><given-names>FJ</given-names></name>. <article-title>A test metric for assessing single-cell RNA-seq batch correction</article-title>. <source>Nature Methods</source>. <year>2019</year>;<volume>16</volume>(<issue>1</issue>):<fpage>43</fpage>–<lpage>9</lpage>. <pub-id pub-id-type="doi">10.1038/s41592-018-0254-1</pub-id><?supplied-pmid 30573817?><pub-id pub-id-type="pmid">30573817</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
