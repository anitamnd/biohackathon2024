<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>BMC Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">7496207</article-id>
    <article-id pub-id-type="publisher-id">3679</article-id>
    <article-id pub-id-type="doi">10.1186/s12859-020-03679-z</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>EnClaSC: a novel ensemble approach for accurate and robust cell-type classification of single-cell transcriptomes</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Chen</surname>
          <given-names>Xiaoyang</given-names>
        </name>
        <address>
          <email>xy-chen16@mails.tsinghua.edu.cn</email>
        </address>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Chen</surname>
          <given-names>Shengquan</given-names>
        </name>
        <address>
          <email>ccq17@mails.tsinghua.edu.cn</email>
        </address>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Jiang</surname>
          <given-names>Rui</given-names>
        </name>
        <address>
          <email>ruijiang@tsinghua.edu.cn</email>
        </address>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <aff id="Aff1"><institution-wrap><institution-id institution-id-type="GRID">grid.12527.33</institution-id><institution-id institution-id-type="ISNI">0000 0001 0662 3178</institution-id><institution>MOE Key Laboratory of Bioinformatics, Bioinformatics Division and Center for Synthetic and Systems Biology, Beijing National Research Center for Information Science and Technology, Department of Automation, </institution><institution>Tsinghua University, </institution></institution-wrap>Beijing, 100084 China </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>17</day>
      <month>9</month>
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>17</day>
      <month>9</month>
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2020</year>
    </pub-date>
    <volume>21</volume>
    <issue>Suppl 13</issue>
    <issue-sponsor>Publication of this supplement has not been supported by sponsorship. Information about the source of funding for publication charges can be found in the individual articles. The articles have undergone the journal's standard peer review process for supplements. The Supplement Editors declare that they have no competing interests.</issue-sponsor>
    <elocation-id>392</elocation-id>
    <permissions>
      <copyright-statement>© The Author(s) 2020</copyright-statement>
      <license license-type="OpenAccess">
        <license-p><bold>Open Access</bold>This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article's Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article's Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated in a credit line to the data.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p id="Par1">In recent years, the rapid development of single-cell RNA-sequencing (scRNA-seq) techniques enables the quantitative characterization of cell types at a single-cell resolution. With the explosive growth of the number of cells profiled in individual scRNA-seq experiments, there is a demand for novel computational methods for classifying newly-generated scRNA-seq data onto annotated labels. Although several methods have recently been proposed for the cell-type classification of single-cell transcriptomic data, such limitations as inadequate accuracy, inferior robustness, and low stability greatly limit their wide applications.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p id="Par2">We propose a novel <bold>en</bold>semble approach, named EnClaSC, for accurate and robust cell-type <bold>cla</bold>ssification of <bold>s</bold>ingle-<bold>c</bold>ell transcriptomic data. Through comprehensive validation experiments, we demonstrate that EnClaSC can not only be applied to the self-projection within a specific dataset and the cell-type classification across different datasets, but also scale up well to various data dimensionality and different data sparsity. We further illustrate the ability of EnClaSC to effectively make cross-species classification, which may shed light on the studies in correlation of different species. EnClaSC is freely available at <ext-link ext-link-type="uri" xlink:href="https://github.com/xy-chen16/EnClaSC">https://github.com/xy-chen16/EnClaSC</ext-link>.</p>
      </sec>
      <sec>
        <title>Conclusions</title>
        <p id="Par3">EnClaSC enables highly accurate and robust cell-type classification of single-cell transcriptomic data via an ensemble learning method. We expect to see wide applications of our method to not only transcriptome studies, but also the classification of more general data.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Single-cell</kwd>
      <kwd>scRNA-seq</kwd>
      <kwd>Cell types</kwd>
      <kwd>Classification</kwd>
      <kwd>Feature selection</kwd>
      <kwd>Few-sample classes</kwd>
      <kwd>Neural networks</kwd>
    </kwd-group>
    <conference xlink:href="http://epigenomics.snu.ac.kr/APBC2020/">
      <conf-name>The 18th Asia Pacific Bioinformatics Conference</conf-name>
      <conf-acronym>APBC 2020</conf-acronym>
      <conf-loc>Seoul, Korea</conf-loc>
      <conf-date>18-20 August 2020</conf-date>
    </conference>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2020</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p id="Par7">Recent advances in single-cell RNA-sequencing (scRNA-seq) techniques make it possible to reveal previously unknown heterogeneity and functional diversity at a microscopic resolution [<xref ref-type="bibr" rid="CR1">1</xref>–<xref ref-type="bibr" rid="CR3">3</xref>]. The exponential growth of the number of cells profiled in individual scRNA-seq experiments has shed light on the studies aiming to identify new cell types [<xref ref-type="bibr" rid="CR4">4</xref>, <xref ref-type="bibr" rid="CR5">5</xref>], reveal regulatory mechanisms [<xref ref-type="bibr" rid="CR6">6</xref>, <xref ref-type="bibr" rid="CR7">7</xref>], assess tissue composition [<xref ref-type="bibr" rid="CR1">1</xref>, <xref ref-type="bibr" rid="CR8">8</xref>, <xref ref-type="bibr" rid="CR9">9</xref>], investigate cell development and lineage processes [<xref ref-type="bibr" rid="CR10">10</xref>–<xref ref-type="bibr" rid="CR12">12</xref>], and many others. Currently, most of the analysis methods for scRNA-seq data are commenced with unsupervised clustering, which highly relies on the investigator’s background knowledge about the signature molecules, and is not efficient and accurate enough for the cell-type assignment of clusters [<xref ref-type="bibr" rid="CR13">13</xref>]. Therefore, there is a demand for novel computational methods for classifying newly-generated scRNA-seq data onto annotated labels.</p>
    <p id="Par8">A variety of methods have recently been proposed for the cell-type classification of single-cell transcriptomes. For example, an unsupervised approach, named scmap [<xref ref-type="bibr" rid="CR14">14</xref>], projects cells to the identified cell-types based on the similarity between query and reference cells. Conventional supervised learning-based methods, such as Random Forest and Support Vector Machine, though can be used for the cell-type classification, have been proven that their performance is not comparable to scmap. SuperCT, a supervised neural network framework, characterizes cell types of single-cell transcriptomic profiles with transformed binary features [<xref ref-type="bibr" rid="CR13">13</xref>]. Nevertheless, there are still several limitations to be addressed in the proposed methods for the cell-type classification of single-cell transcriptomes. First, even the state-of-the-art methods have achieved encouraging performance, the classification performance and stability can still be further improved for various datasets and tasks as shown in the Results Section. Second, to select informative features of the query and reference datasets, there is a demand for a tailored feature selection approach for the cell-type classification. Third, both the query and reference datasets may contain cell types that have only a small number of samples. A superior classification method should be able to effectively characterize the cell types with only a small number of samples. Last but equally important, a method that can be generally applied to data of various dimensions or dropout rates is desirable for the broader application scenarios.</p>
    <p id="Par9">Motivated by the above understanding, we propose in this paper EnClaSC, a novel <bold>en</bold>semble approach for accurate and robust cell-type <bold>cla</bold>ssification of <bold>s</bold>ingle-<bold>c</bold>ell transcriptomes. Through comprehensive experiments, we illustrate that our method is superior to existing methods in not only the self-projection within a specific dataset, but also the cell-type classification across datasets. With a few-sample learning strategy, EnClaSC can effectively characterize the cell types that have only a small number of samples. We further show the robustness of our method for various data dimensionality and different data sparsity. Through joint analysis of classification results with scRNA-seq datasets of different species, we demonstrate the ability of our method to make the cross-species cell-type classification.</p>
  </sec>
  <sec id="Sec2">
    <title>Methods</title>
    <sec id="Sec3">
      <title>Design of EnClaSC</title>
      <p id="Par10">As illustrated in Fig. <xref rid="Fig1" ref-type="fig">1</xref>, EnClaSC consists of four modules. First, a feature selection module finds informative genes which benefit the cell-type classification from the common genes of the query and reference sets. Second, a few-sample learning module is adopted to sufficiently learn the characteristics of classes with few samples, and thus improve the performance in identifying the few-sample classes. Third, a neural network module uses artificial neural networks with an ensemble learning strategy to stabilize the performance of the cell-type classification. Finally, a joint prediction module integrates outputs of the few-sample learning and neural network modules to predict the class that a query cell belongs to. In general, EnClaSC draws on the idea of ensemble learning in the feature selection, few-sample learning, neural network and joint prediction modules, respectively, and thus constitutes a novel ensemble approach for cell-type classification of single-cell transcriptomes.
<fig id="Fig1"><label>Fig. 1</label><caption><p>The graphical illustration of EnClaSC. EnClaSC consists of four modules, including feature selection, few-sample learning, neural network and joint prediction modules</p></caption><graphic xlink:href="12859_2020_3679_Fig1_HTML" id="MO1"/></fig></p>
    </sec>
    <sec id="Sec4">
      <title>Feature selection</title>
      <p id="Par11">Let <italic>E</italic> be the value of gene expression in scRNA-seq, <italic>n</italic> the number of the cells in the dataset. The dropout rate of the <italic>j th</italic> feature is abbreviated as <italic>D</italic><sub><italic>j</italic></sub>. For the <italic>i th</italic> cell (sample), the expression of the <italic>j th</italic> feature (gene) of is abbreviated as <italic>E</italic><sub><italic>ij</italic></sub>. For the <italic>j th</italic> feature, the level of gene expression <italic>F</italic>(<italic>j</italic>) is calculated by the logarithm-plus-one of its arithmetic mean value as
<disp-formula id="Equa"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ F(j)=\log \left(\frac{\sum_{i=1}^n{E}_{ij}}{n}+1\right) $$\end{document}</tex-math><mml:math id="M2" display="block"><mml:mi>F</mml:mi><mml:mfenced close=")" open="("><mml:mi>j</mml:mi></mml:mfenced><mml:mo>=</mml:mo><mml:mo>log</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:mfrac><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:msub><mml:mi>E</mml:mi><mml:mi mathvariant="italic">ij</mml:mi></mml:msub></mml:mrow><mml:mi>n</mml:mi></mml:mfrac><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced></mml:math><graphic xlink:href="12859_2020_3679_Article_Equa.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par12">For the estimation of gene expression, we first use the dropout rate to fit a linear model using the least square method
<disp-formula id="Equb"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\overset{\sim }{F}}_1(j)=a{D}_j+b $$\end{document}</tex-math><mml:math id="M4" display="block"><mml:msub><mml:mover accent="true"><mml:mi>F</mml:mi><mml:mo stretchy="true">~</mml:mo></mml:mover><mml:mn>1</mml:mn></mml:msub><mml:mfenced close=")" open="("><mml:mi>j</mml:mi></mml:mfenced><mml:mo>=</mml:mo><mml:mi>a</mml:mi><mml:msub><mml:mi>D</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mi>b</mml:mi></mml:math><graphic xlink:href="12859_2020_3679_Article_Equb.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par13">We then estimate <italic>F</italic>(<italic>j</italic>) by the mean of the logarithm-plus-one of each feature, namely,
<disp-formula id="Equc"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\overset{\sim }{F}}_2(j)=\frac{\sum_{i=1}^n\mathit{\log}\left({E}_{ij}+1\right)}{n} $$\end{document}</tex-math><mml:math id="M6" display="block"><mml:msub><mml:mover accent="true"><mml:mi>F</mml:mi><mml:mo stretchy="true">~</mml:mo></mml:mover><mml:mn>2</mml:mn></mml:msub><mml:mfenced close=")" open="("><mml:mi>j</mml:mi></mml:mfenced><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:mo mathvariant="italic">log</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>E</mml:mi><mml:mi mathvariant="italic">ij</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced></mml:mrow><mml:mi>n</mml:mi></mml:mfrac></mml:math><graphic xlink:href="12859_2020_3679_Article_Equc.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par14">The residuals of these two approaches between the true gene expression level are recorded as <italic>∆F</italic><sub>1</sub>(<italic>j</italic>) and <italic>∆F</italic><sub>2</sub>(<italic>j</italic>), respectively. Briefly, <inline-formula id="IEq1"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \Delta  {F}_1(j)=F(j)-{\overset{\sim }{F}}_1(j) $$\end{document}</tex-math><mml:math id="M8" display="inline"><mml:mi>∆</mml:mi><mml:msub><mml:mi>F</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mfenced close=")" open="("><mml:mi>j</mml:mi></mml:mfenced><mml:mo>=</mml:mo><mml:mi>F</mml:mi><mml:mfenced close=")" open="("><mml:mi>j</mml:mi></mml:mfenced><mml:mo>−</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>F</mml:mi><mml:mo stretchy="true">~</mml:mo></mml:mover><mml:mn>1</mml:mn></mml:msub><mml:mfenced close=")" open="("><mml:mi>j</mml:mi></mml:mfenced></mml:math><inline-graphic xlink:href="12859_2020_3679_Article_IEq1.gif"/></alternatives></inline-formula>, and <inline-formula id="IEq2"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \Delta  {F}_2(j)=F(j)-{\overset{\sim }{F}}_2(j) $$\end{document}</tex-math><mml:math id="M10" display="inline"><mml:mi>∆</mml:mi><mml:msub><mml:mi>F</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mfenced close=")" open="("><mml:mi>j</mml:mi></mml:mfenced><mml:mo>=</mml:mo><mml:mi>F</mml:mi><mml:mfenced close=")" open="("><mml:mi>j</mml:mi></mml:mfenced><mml:mo>−</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>F</mml:mi><mml:mo stretchy="true">~</mml:mo></mml:mover><mml:mn>2</mml:mn></mml:msub><mml:mfenced close=")" open="("><mml:mi>j</mml:mi></mml:mfenced></mml:math><inline-graphic xlink:href="12859_2020_3679_Article_IEq2.gif"/></alternatives></inline-formula>. <italic>∆F</italic><sub>1</sub>(<italic>j</italic>) reflects the rate of gene expression, that is, whether the gene can be expressed or not. <italic>∆F</italic><sub>2</sub>(<italic>j</italic>) is the information entropy of each gene, which reflects the residual degree of each gene expression. We can use the integrated score <italic>G</italic>(<italic>j</italic>) = <italic>α∆F</italic><sub>1</sub>(<italic>j</italic>) + (1 − <italic>α</italic>)<italic>∆F</italic><sub>2</sub>(<italic>j</italic>) to consider the above two factors synthetically. Here, <italic>α</italic> is the control coefficient, which is responsible for regulating the influence of the two calculated factors. We set <italic>α</italic> to 0.5 in all the experiments of this work.</p>
      <p id="Par15">For a specific scRNA-seq dataset, we compute <italic>G</italic>(<italic>j</italic>) as the scores of features, and then sort the features according to the scores in descending order. We extract <italic>K</italic> sorted high-score features shared among the training and test sets. This feature selection approach can effectively maximize the common high-score features of different scRNA-seq datasets, and thus contribute to the cell-type classification across datasets.</p>
    </sec>
    <sec id="Sec5">
      <title>Few-sample learning strategy</title>
      <p id="Par16">We define few-sample classes as the cell types whose number of samples does not exceed 0.5% of the total number of training samples. In order to fully extract features of the few-sample classes, we perform data augmentation and pre-train a few-sample classification model using samples of the few-sample classes in the training set. In more detailed, let <italic>N</italic> be the number of samples in the training set, n the number of samples of the few-sample classes in the training set, <italic>M</italic> the number of samples in the test set, and <italic>D</italic> the number of features after feature selection. We pair the samples of these few-sample classes one by one to form a few-sample training set with <italic>n</italic> × <italic>n</italic> samples and 2 × <italic>D</italic> features. If the two cells of a paired sample belong to the same cell type, we mark the label of the paired sample as 1; otherwise, we mark it as 0. We then pair the samples of the few-sample classes in the original training set with each sample in the original test set to form a few-sample test set with <italic>n</italic> × <italic>M</italic> samples and 2 × <italic>D</italic> features.</p>
      <p id="Par17">We adopt LightGBM, a gradient boosting framework that uses tree-based learning algorithms, to perform the few-sample training [<xref ref-type="bibr" rid="CR15">15</xref>]. We use the default setting of parameters except for the parameters listed in Table <xref rid="Tab1" ref-type="table">1</xref>. To obtain the probability scores that an original test sample belongs to the few-sample classes, we weight the prediction results of the few-sample test set by the <italic>Pearson</italic> correlation coefficients between the expression values of the two cells in corresponding few-sample test samples drawing on the idea of ensemble learning, namely,
<disp-formula id="Equd"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ score\left(x,i\right)=\frac{\sum_{j=1}^{N_x}{r}_{ij}{c}_{ij}}{\sum_{j=1}^{N_x}{r}_{ij}} $$\end{document}</tex-math><mml:math id="M12" display="block"><mml:mtext mathvariant="italic">score</mml:mtext><mml:mfenced close=")" open="(" separators=","><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:mfenced><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>x</mml:mi></mml:msub></mml:msubsup><mml:msub><mml:mi>r</mml:mi><mml:mi mathvariant="italic">ij</mml:mi></mml:msub><mml:msub><mml:mi>c</mml:mi><mml:mi mathvariant="italic">ij</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>x</mml:mi></mml:msub></mml:msubsup><mml:msub><mml:mi>r</mml:mi><mml:mi mathvariant="italic">ij</mml:mi></mml:msub></mml:mrow></mml:mfrac></mml:math><graphic xlink:href="12859_2020_3679_Article_Equd.gif" position="anchor"/></alternatives></disp-formula>where <italic>x</italic> is one of the classes in the original training set, <italic>N</italic><sub><italic>x</italic></sub> the number of samples of class <italic>x</italic> in the original training set, <italic>j</italic> the <italic>j th</italic> sample of class <italic>x</italic> in the original training set, <italic>i</italic> the <italic>i th</italic> sample in the original test set, and <italic>r</italic><sub><italic>ij</italic></sub> the <italic>Pearson</italic> correlation coefficients between <italic>i</italic> and <italic>j</italic>, <italic>c</italic><sub><italic>ij</italic></sub> the prediction result of LightGBM for the paired sample of <italic>i</italic> and <italic>j</italic>.
<table-wrap id="Tab1"><label>Table 1</label><caption><p>Parameters of the LightGBM model</p></caption><table frame="hsides" rules="groups"><thead><tr><th>Parameters</th><th>Setting</th></tr></thead><tbody><tr><td>boosting_type</td><td>‘gbdt’</td></tr><tr><td>objective</td><td>‘regression’</td></tr><tr><td>metric</td><td>{‘l2’, ‘auc’}</td></tr><tr><td>learning_rate</td><td>0.05</td></tr><tr><td>verbose</td><td>1</td></tr></tbody></table></table-wrap></p>
      <p id="Par18">If the predicted maximum score of an original test sample is greater than <italic>γ</italic>, then we assign the sample as the class that has the maximum score, otherwise, the sample is predicted as “unassigned” and should be further classified using the subsequent artificial neural networks.</p>
    </sec>
    <sec id="Sec6">
      <title>Artificial neural networks for the cell-type classification</title>
      <p id="Par19">The neural network module uses artificial neural networks with ensemble learning strategy to classify the test samples which are predicted as “unassigned” by the few-sample learning module. We first design an artificial neural network framework with parameters as shown in Table <xref rid="Tab2" ref-type="table">2</xref>, and implement it using Keras with Tensorflow as the backend. In order to improve the stability of the classification performance, drawing on the Bootstrap strategy, we generate 10 new training sets by selecting 30% of the original training set at random with replacement, and then use them to train 10 neural networks, respectively. For each trained neural network, if the predicted maximum score of a test sample exceeds <italic>γ</italic>, the sample is assigned as the class that has the maximum score, otherwise, it is classified as “unassigned”. We set <italic>γ</italic> to 0.7 in all the experiments of this work. For each test sample, we classify it as “unassigned” unless there are more than half of the 10 neural networks predict the test sample as a specific same class, and we thus classify the sample based on the voting result of the 10 neural networks.
<table-wrap id="Tab2"><label>Table 2</label><caption><p>The architecture of the neural network</p></caption><table frame="hsides" rules="groups"><thead><tr><th>Layers</th><th>Setting</th></tr></thead><tbody><tr><td>Dense_1</td><td>{(feature numbers,128), ‘relu’}</td></tr><tr><td>Dropout_1</td><td>0.25</td></tr><tr><td>Dense_2</td><td>{(128,64), ‘relu’}</td></tr><tr><td>Dropout_2</td><td>0.5</td></tr><tr><td>Dense_3</td><td>{(64,32), ‘relu’}</td></tr><tr><td>Dense_4</td><td>{(32, number of classes in training sets), ‘softmax’}</td></tr></tbody></table></table-wrap></p>
    </sec>
    <sec id="Sec7">
      <title>Assessment of performance</title>
      <p id="Par20">We adopt the widely used <italic>kappa</italic> value and <italic>assigned rate</italic> value to assess the classification performance of the models. Briefly, we calculate the <italic>kappa</italic> values of the classification results of assigned samples and the real classes of corresponding samples using the following formula
<disp-formula id="Eque"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ kappa=\frac{p_o-{p}_e}{1-{p}_e} $$\end{document}</tex-math><mml:math id="M14" display="block"><mml:mtext mathvariant="italic">kappa</mml:mtext><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mi>o</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi>e</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi>e</mml:mi></mml:msub></mml:mrow></mml:mfrac></mml:math><graphic xlink:href="12859_2020_3679_Article_Eque.gif" position="anchor"/></alternatives></disp-formula>where <italic>p</italic><sub>0</sub> is the sum of the number of samples correctly classified divided by the number of assigned samples in the test set, that is, the overall classification accuracy of assigned samples in the test set. Assuming that the number of real samples which are assigned by the model in each class of test set is <italic>a</italic><sub>1</sub>, <italic>a</italic><sub>2</sub>…<italic>a</italic><sub><italic>c</italic></sub> respectively, the number of predicted samples in each class of the test set is <italic>b</italic><sub>1</sub>, <italic>b</italic><sub>2</sub>…<italic>b</italic><sub><italic>C</italic></sub> respectively, and the number of assigned samples in the test set is <italic>n</italic>. We have
<disp-formula id="Equf"><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {p}_e=\frac{a_1\times {b}_1+{a}_2\times {b}_2+\dots +{a}_C\times {b}_C}{n\times n} $$\end{document}</tex-math><mml:math id="M16" display="block"><mml:msub><mml:mi>p</mml:mi><mml:mi>e</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>×</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>×</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mo>…</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mi>C</mml:mi></mml:msub><mml:mo>×</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mi>C</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>×</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:mfrac></mml:math><graphic xlink:href="12859_2020_3679_Article_Equf.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par21">For the assessment of the ability of a model to recognize the cells in the test set, we assume that the number of samples in the test set is <italic>N</italic> and use <italic>assigned rate</italic> to represent the proportion of the number of samples that can be assigned to a cell type by the classifier, namely,
<disp-formula id="Equg"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ assigned\ rate=\frac{b_1+{b}_2+\dots +{b}_C}{N} $$\end{document}</tex-math><mml:math id="M18" display="block"><mml:mtext mathvariant="italic">assigned rate</mml:mtext><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>b</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mo>…</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mi>C</mml:mi></mml:msub></mml:mrow><mml:mi>N</mml:mi></mml:mfrac></mml:math><graphic xlink:href="12859_2020_3679_Article_Equg.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par22">Because the classes of test sets and training sets may not be completely consistent, the <italic>assigned rate</italic> should be maintained at a relatively high level, but not the higher the better, and thus the classification performance is primarily related to <italic>kappa</italic> values.</p>
    </sec>
    <sec id="Sec8">
      <title>Data collection</title>
      <p id="Par23">We downloaded three humans pancreatic scRNA-seq dataset provided by Baron, M. et al., Muraro, MJ et al., and Xin, Y. et al. (hereinafter are abbreviated as Baron Dataset, Muraro Dataset, and Xin Dataset, respectively) from NCBI Gene Expression Omnibus via accession GSE84133, GSE85241, and GSE81608, respectively [<xref ref-type="bibr" rid="CR16">16</xref>–<xref ref-type="bibr" rid="CR18">18</xref>]. The human pancreatic scRNA-seq dataset provided by Segerstolpe, Å. et al. (hereinafter is abbreviated as Segerstolpe Dataset) was downloaded from EMBL-EBI ArrayExpress via accession E-MTAB-5061 [<xref ref-type="bibr" rid="CR5">5</xref>]. For the subsequent usability of the dataset, we removed the cells of the “unclear” class in Muraro Dataset, the cells of the “not applicable”, “unclassified endocrine” and “unclassified” classes in Segerstolpe Dataset and the cells of the “alpha.contaminated”, “beta.contaminated”, “delta.contaminated”, and “gamma.contaminated” classes in Xin Dataset. After preprocessing, Baron Dataset contains 8569 samples with 20, 125 features, Muraro Dataset contains 2122 samples with 19, 127 features, Xin Dataset contains 1492 samples with 39, 851 features, and Segerstolpe Dataset contains 2166 samples with 25, 525 features.</p>
      <p id="Par24">We also downloaded two mouse retina scRNA-seq datasets provided by Macosko, EZ et al. and Shekhar, K. et al., (hereinafter are abbreviated as Macosko Dataset and Shekhar Dataset, respectively) from NCBI Gene Expression Omnibus via accession GSE63473 and GSE81904 [<xref ref-type="bibr" rid="CR2">2</xref>, <xref ref-type="bibr" rid="CR19">19</xref>]. Macosko Dataset measures the expression of 23, 288 genes in 44, 808 cells, while Shekhar Dataset measures the expression of 13, 166 genes in 27, 499 cells.</p>
      <p id="Par25">Two mouse brain cell scRNA-seq datasets provided by Romanov, RA et al. and Zeisel, A. et al. (hereinafter are abbreviated as Romanov Dataset and Zeisel Dataset, respectively) and one human brain cell scRNA-seq dataset collected by Darmanis, S. et al. (hereinafter is abbreviated as Darmanis Dataset) were downloaded from the NCBI Gene Expression Omnibus via accession GSE74672, GSE60361 and GSE67835, respectively [<xref ref-type="bibr" rid="CR9">9</xref>, <xref ref-type="bibr" rid="CR20">20</xref>, <xref ref-type="bibr" rid="CR21">21</xref>]. To unify the label information, we replaced the cell type label ‘oligos’ in the Remanov Dataset with ‘oligodendrocytes’, and the cell type labels ‘ca1pyramidal’, ‘s1pyramidal’ and ‘interneurons’ in the Zeisel Dataset with ‘neurons’. After preprocessing, Romanov Dataset contains 2881 samples with 24, 341 features, Zeisel Dataset contains 3005 samples with 19, 972 features, and Darmanis Dataset contains 466 samples with 22, 088 features.</p>
    </sec>
  </sec>
  <sec id="Sec9">
    <title>Results</title>
    <sec id="Sec10">
      <title>EnClaSC achieves high performance for self-projection within a dataset</title>
      <p id="Par26">In order to illustrate that our method can effectively perform self-projection within a scRNA-seq dataset, we conducted a series of self-projection experiments using 6 datasets, including Baron Dataset, Muraro Dataset, Xin Dataset, Segerstolpe Dataset, Macosko Dataset and Shekhar Dataset. We compared the performance of our method with scmap, a similarity-based method, and SuperCT, an ANN-based method (we self-implemented the method according to the paper because SuperCT is not open source) [<xref ref-type="bibr" rid="CR13">13</xref>, <xref ref-type="bibr" rid="CR14">14</xref>]. Using the same training (reference) and test (query) sets with EnClaSC, we run the two baseline methods with parameters or structures proposed by the respective authors.</p>
      <p id="Par27">Both EnClaSC and scmap provide a feature selection method, while SuperCT uses all features. When running EnClaSC and scmap, we selected 100 features, which is considered to be able to better demonstrate the advantages of scmap in their paper. We performed 5-fold cross-validation within each of the six datasets. As shown in Fig. <xref rid="Fig2" ref-type="fig">2</xref>, EnClaSC model has better self-projection performance than SuperCT and scmap. At the same time, in terms of self-projection stability, EnClaSC is significantly superior to SuperCT. The variance of the <italic>kappa</italic> value of EnClaSC is 71.09% lower than SuperCT, and the variance of the <italic>assigned rate</italic> of EnClaSC is 68.03% lower than SuperCT.
<fig id="Fig2"><label>Fig. 2</label><caption><p>Performance comparison of the self-projection within a specific dataset</p></caption><graphic xlink:href="12859_2020_3679_Fig2_HTML" id="MO2"/></fig></p>
    </sec>
    <sec id="Sec11">
      <title>EnClaSC outperforms other methods in the cell-type classification across datasets</title>
      <p id="Par28">We use six scRNA-seq datasets to demonstrate the superior cell-type classification performance of EnClaSC. Using Baron Dataset, Muraro Dataset, Xin Dataset, and Segerstolpe Dataset these four human pancreatic datasets, we selected each one of them as the test set, while the integration of remaining three datasets serves as the training set, respectively. In addition, we used two mouse retina datasets, namely, Macosko Dataset and Shekhar Dataset, to form two symmetric training-test sets. We used 100 selected features in EnClaSC and scmap, while all features in SuperCT, and repeated each experiment five times.</p>
      <p id="Par29">As shown in Fig. <xref rid="Fig3" ref-type="fig">3</xref>, the <italic>kappa</italic> value of EnClaSC is higher than that of scmap given comparable <italic>assigned rates</italic>, except for the group where Macosko Dataset serve as the test set and scmap achieves much lower <italic>assigned rates</italic>. Compared with SuperCT, which also uses a neural network architecture, <italic>assigned rates</italic> of EnClaSC has little difference except for Baron Dataset as the test set, while most <italic>kappa</italic> values of EnClaSC outperform SuperCT. When Baron Dataset serves as the test set, the <italic>assigned rates</italic> of SuperCT is much lower than that of scmap and EnClaSC. In addition, it can be seen from the figure that the classification performance of EnClaSC is much more stable than that of SuperCT. Therefore, even though EnClaSC only uses 100 features, the classification performance of EnClaSC is still far better than that of SuperCT. In general, EnClaSC has a more outstanding performance in cell-type classification compared with other two base-line methods.
<fig id="Fig3"><label>Fig. 3</label><caption><p>Performance comparison of the cell-type classification across different datasets</p></caption><graphic xlink:href="12859_2020_3679_Fig3_HTML" id="MO3"/></fig></p>
    </sec>
    <sec id="Sec12">
      <title>Contribution of each module</title>
      <sec id="Sec13">
        <title>Feature selection module</title>
        <p id="Par30">We validated the contribution of the feature selection module using the four human pancreatic datasets including Baron Dataset, Muraro Dataset, Xin Dataset and Segerstolpe Dataset, and two mouse retina datasets including Macosko Dataset and Shekhar Dataset. We performed six experiments as the above section. We first took each one of the four human pancreas datasets as a test set and integrated the remaining three datasets as a training set. Then we took each one of the two mouse retina datasets as a test set, and the remaining one was served as a training set. We replaced the feature selection method of our feature selection module with PCA, which is commonly used for scRNA-seq dimensionality reduction, feature selection methods of Seurat v3.0 and that of scmap, and compared them with our original method [<xref ref-type="bibr" rid="CR22">22</xref>].</p>
        <p id="Par31">The results are shown in Fig. <xref rid="Fig4" ref-type="fig">4</xref>. Compared to PCA, our feature selection method is more stable. The <italic>kappa</italic> and the <italic>assigned rate</italic> of EnClaSC is much better than the EnClaSC framework using the feature selection method of Seurat v3.0 (the average of <italic>kappa</italic> values of EnClaSC is 69.65% higher than Seurat v3.0, and the average of <italic>assigned rates</italic> is 3.95% higher than Seurat v3.0). EnClaSC has slightly higher <italic>kappa</italic> values with comparable <italic>assigned rates</italic> compared with the EnClaSC framework using the feature selection method of scmap. In summary, the feature selection module of EnClaSC is superior to other widely used feature selection approaches in the EnClaSC framework, and thus serves as the effective feature selection approach for the cell-type classification.
<fig id="Fig4"><label>Fig. 4</label><caption><p>Performance of EnClaSC using different feature selection strategy</p></caption><graphic xlink:href="12859_2020_3679_Fig4_HTML" id="MO4"/></fig></p>
      </sec>
      <sec id="Sec14">
        <title>Neural network module</title>
        <p id="Par32">We validated the contribution of the neural network module using the four human pancreatic datasets and the two mouse retina datasets, and we again performed six experiments as the “<italic>Feature selection module</italic>” section. We replaced the neural networks in EnClaSC with a single neural network that does not use the ensemble learning strategy. We compared the performance of the above approach with that of our complete model, and show the results in Fig. <xref rid="Fig5" ref-type="fig">5</xref>. With 64.14% reduced variance of <italic>kappa</italic> and 71.97% reduced variance of <italic>assigned rate</italic> on average, the main contribution of ensemble learning strategy with several neural networks is significantly improving the stability of classification performance. Besides, on most datasets, the ensemble learning strategy slightly improves the classification performance.
<fig id="Fig5"><label>Fig. 5</label><caption><p>Performance of EnClaSC with or without ensemble learning in the neural network module</p></caption><graphic xlink:href="12859_2020_3679_Fig5_HTML" id="MO5"/></fig></p>
      </sec>
      <sec id="Sec15">
        <title>Few-sample learning module</title>
        <p id="Par33">To demonstrate the contribution of the few-sample learning module, we compare the performance of EnClaSC with or without the few-sample learning module. We first used Shekhar Dataset as the training set, Macosko Dataset as the test set to evaluate the contribution of the few-sample learning module. This training-test set has a very distinct characteristic compared to other sets we have used, because there are massive samples of few-sample classes of the training set in the test set, which makes the classification task much more challenging. According to the definition in the Methods Section, we consider “rods” and “cones” as the few-sample classes in the training set. These two cell types account for 0.34 and 0.18% respectively in the training set, and account for 65.61 and 4.17% respectively in the test set.</p>
        <p id="Par34">As shown in Fig. <xref rid="Fig6" ref-type="fig">6</xref>a and b, EnClaSC with the few-sample learning module can identify 66.34% samples in the test set with the classification accuracy rate of 95.92%. However, the classification accuracy rate of EnClaSC without the few-sample learning module is only 87.33%. As shown in Fig. <xref rid="Fig6" ref-type="fig">6</xref>a and b, the number of incorrectly classified samples of the “rods” class is less than without the few-sample classification model, and the samples of the “cones” class in the test set are all classified incorrectly.
<fig id="Fig6"><label>Fig. 6</label><caption><p>Performance of EnClaSC with or without the few-sample learning module. <bold>a</bold> The results of EnClaSC with few-sample learning module on Macosko Dataset. <bold>b</bold> The results of EnClaSC without few-sample learning module on Macosko Dataset. <bold>c</bold> The results of EnClaSC with few-sample learning module on Segerstolpe Dataset. <bold>d</bold> The results of EnClaSC without few-sample learning module on Segerstolpe Dataset. <bold>e</bold> The results of EnClaSC with few-sample learning module on Baron Dataset. <bold>f</bold> The results of EnClaSC without few-sample learning module on Baron Dataset</p></caption><graphic xlink:href="12859_2020_3679_Fig6_HTML" id="MO6"/></fig></p>
        <p id="Par35">We also evaluated the contribution of the few-sample learning module using training and test sets whose cell types have similar sample distributions. We integrated Baron Dataset, Muraro Dataset, and Xin Dataset as the training set, and used Segerstolpe Dataset as the test set, and Segerstolpe Dataset, Muraro Dataset and Xin Dataset as training sets, Baron Dataset as the test set to form two training-test sets for the experiment.</p>
        <p id="Par36">As shown in Fig. <xref rid="Fig6" ref-type="fig">6</xref>c-f, the training of few-sample classes in the neural network is insufficient with limited samples, resulting in the worse classification performance, while the few-sample learning module can effectively characterize the few-sample classes, and thus improve the classification performance.</p>
        <p id="Par37">In addition, we found that in the Segerstolpe Dataset, which contains “MHC class II” cell type but not ‘macrophage’ cell type. In the case that Baron Dataset or Segerstolpe Dataset serves as the test set, the few-sample learning module can associate the ‘macrophage’ class with the “MHC class II” class as shown in Fig. <xref rid="Fig6" ref-type="fig">6</xref>c-f. The data showed that “MHC class II” is a protein that is mainly secreted by the macrophage cell, indicating that the few-sample learning module possesses the potential ability to recognize new cell types and assign them to relative cell types. In summary, the few-sample learning module endows EnClaSC the ability to effectively resolve few-sample classes of the training set, while providing the potential ability to correlate new cell types with known relative cell types.</p>
      </sec>
    </sec>
    <sec id="Sec16">
      <title>EnClaSC scales up well with various data dimensionality</title>
      <p id="Par38">To illustrate the robustness of our method for various data dimensionality, we selected different numbers of features among the four human pancreatic datasets including Muraro Dataset, Baron Dataset, Segerstolpe Dataset, and Xin Dataset. We took each one of the four human pancreas datasets as a test set and integrated the remaining three datasets as a training set, and repeated each experiment five times. In order to illustrate the superior data-dimension adaptability of our method, we selected 100, 300, 500, 700 and 900 as the feature numbers of our method and scmap. It is worth noting that instead of designing a feature selection module, SuperCT directly binarizes all features, and thus uses all features in these experiments.</p>
      <p id="Par39">As shown in Fig. <xref rid="Fig7" ref-type="fig">7</xref>, the performance of EnClaSC slightly improves with the increase of data dimensionality. When the data dimensionality is 300, the <italic>kappa</italic> value of scmap rises to the peak and remains basically unchanged, while the <italic>assigned rates</italic> of scmap drops dramatically with the increase of data dimensionality. At the same time, we can see that when the data dimensionality reaches 500 or becomes higher, the <italic>kappa</italic> values and the <italic>assigned rate</italic> of EnClaSC are consistently higher than that of scmap and SuperCT. In summary, EnClaSC scales up well with various data dimensionality, and the higher the data dimensionality, the better the performance of EnClaSC.
<fig id="Fig7"><label>Fig. 7</label><caption><p>Performance comparison on datasets of various dimensionality. <bold>a-d</bold> The performance on Muraro Dataset, Baron Dataset, Segerstolpe Dataset and Xin Dataset, respectively</p></caption><graphic xlink:href="12859_2020_3679_Fig7_HTML" id="MO7"/></fig></p>
    </sec>
    <sec id="Sec17">
      <title>EnClaSC scales up well with different data sparsity</title>
      <p id="Par40">Considering that scRNA-seq data suffer from the dropout phenomenon, we further demonstrated that our method can scale up well with different data sparsity using the four human pancreatic datasets to perform four experiments. We randomly set 0, 10, 20, 30, 40, and 50% of the non-zero elements in the raw expression matrix, and repeated each experiment five times. As illustrated in Fig. <xref rid="Fig8" ref-type="fig">8</xref>, EnClaSC is much more robust to the dropout rate compared with other two methods. The <italic>kappa</italic> values hardly change with the increasing of the dropout rate, even though the <italic>assigned rate</italic> decrease slightly. Nevertheless, the performance of scmap becomes worse because the randomly zeroing of the feature matrix could cause significant changes in cell-to-cell similarity. The performance of SuperCT fluctuates irregularly with the increasing dropout rate. In some cases, the <italic>kappa</italic> value may decrease, which indicating that the increasing dropout rate could cause further deterioration of the stability of SuperCT. The results demonstrate that EnClaSC can account for the sparsity of single-cell gene expression data, and thus benefits the cell-type classification tasks with the exponential growth of the Drop-seq based scRNA-seq data.
<fig id="Fig8"><label>Fig. 8</label><caption><p>Performance comparison on datasets of different sparsity. <bold>a-d</bold> The performance on Muraro Dataset, Baron Dataset, Segerstolpe Dataset and Xin Dataset, respectively</p></caption><graphic xlink:href="12859_2020_3679_Fig8_HTML" id="MO8"/></fig></p>
    </sec>
    <sec id="Sec18">
      <title>EnClaSC enables cross-species classification</title>
      <p id="Par41">To illustrate that EnClaSC can effectively make <bold>cross-species</bold> classification, we used datasets of mouse brain cells provided by Romanov, R. A. et al. (Romanov Dataset for short) and Zeisel, A. et al. (Zeisel Dataset for short) as the training set, and a dataset of human brain cells provided by Darmanis, S. et al. (Darmanis Dataset for short) as the test set for the cross-species classification. Because there are only 466 samples on Darmanis Dataset, we did not use the Darmanis Dataset as the training set. As shown in Fig. <xref rid="Fig9" ref-type="fig">9</xref>, our method not only achieves the highest <italic>assigned rate</italic> (37.83% higher than scmap, and 2.54% higher than SuperCT), but also has the highest <italic>kappa</italic> (79.13% higher than scmap and 80.06% higher than SuperCT) in this cross-species classification task. Similarly, using our feature selection module in EnClaSC also provides the highest <italic>kappa</italic> value (211.60% higher than PCA, 11.89% higher than Seurat v3.0, and 4.94% higher than scmap), and <italic>assigned rates</italic> (0.51% higher than PCA, 2.84% higher than Seurat v3.0, and 2.46% higher than scmap). The results demonstrate that EnClaSC has superior classification performance both in the classification of homologous cells of the same species and in the classification of homologous cells of different species.
<fig id="Fig9"><label>Fig. 9</label><caption><p>Performance comparison of cross-species classification</p></caption><graphic xlink:href="12859_2020_3679_Fig9_HTML" id="MO9"/></fig></p>
    </sec>
  </sec>
  <sec id="Sec19">
    <title>Discussion</title>
    <p id="Par42">scRNA-Seq techniques have advanced rapidly in recent years and enable the quantitative characterization of cell types at a single-cell resolution. EnClaSC is proposed to classify cell types using supervised learning. With the contribution of the tailored feature selection, neural network and few-sample learning modules, our method is superior to other baseline methods, such as scmap and SuperCT, with regard to not only accuracy and robustness, but also the performance of classifying few-sample classes.</p>
    <p id="Par43">Our method can certainly be improved in some aspects. First, a more well-crafted module, such as modules considering dropout evens, can be introduced to better characterize the scRNA-seq data, and thus further improves the performance of our method. Second, our method can be extended to incorporate other types of functional genomics data such as chromatin accessibility [<xref ref-type="bibr" rid="CR23">23</xref>, <xref ref-type="bibr" rid="CR24">24</xref>]. Finally, drawing on the idea of VPAC, we can integrate the feature selection module with other modules to endow the method with the ability to balance the feature selection and prediction steps, and thus extract features that are more conducive to the cell type classification [<xref ref-type="bibr" rid="CR25">25</xref>].</p>
  </sec>
  <sec id="Sec20">
    <title>Conclusions</title>
    <p id="Par44">We have proposed a supervised learning method, named EnClaSC, for accurate and robust cell-type classification of single-cell transcriptomes. Each of the well-crafted feature selection, neural network and few-sample learning modules draws on the idea of ensemble learning, which makes EnClaSC superior to existing methods in the self-projection within a specific scRNA-seq dataset, the cell-type classification across different scRNA-seq datasets, various data dimensionality, and different data sparsity. We have further demonstrated the ability of EnClaSC to effectively make cross-species classification, which may shed light on the studies in the correlation of different species. Eventually, we expect that such a supervised learning approach will be widely applicable for the cell-type classification with the explosive growth of scRNA-seq data.</p>
  </sec>
</body>
<back>
  <glossary>
    <title>Abbreviations</title>
    <def-list>
      <def-item>
        <term>scRNA-seq</term>
        <def>
          <p id="Par4">single-cell RNA-sequencing</p>
        </def>
      </def-item>
      <def-item>
        <term>ANN</term>
        <def>
          <p id="Par5">Artificial neural network</p>
        </def>
      </def-item>
      <def-item>
        <term>PCA</term>
        <def>
          <p id="Par6">Principal component analysis</p>
        </def>
      </def-item>
    </def-list>
  </glossary>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher’s Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <ack>
    <title>Acknowledgements</title>
    <p>Rui Jiang is a RONG professor at the Institute for Data Science, Tsinghua University.</p>
    <sec id="FPar1">
      <title>About this supplement</title>
      <p id="Par45">This article has been published as part of <italic>BMC Bioinformatics Volume 21 Supplement 13, 2020: Selected articles from the 18th Asia Pacific Bioinformatics Conference (APBC 2020): bioinformatics.</italic> The full contents of the supplement are available online at <ext-link ext-link-type="uri" xlink:href="https://bmcbioinformatics.biomedcentral.com/articles/supplements/volume-21-supplement-13">https://bmcbioinformatics.biomedcentral.com/articles/supplements/volume-21-supplement-13</ext-link> .</p>
    </sec>
  </ack>
  <notes notes-type="author-contribution">
    <title>Authors’ contributions</title>
    <p>RJ designed the research. XC and SC designed and implemented the models. XC collected data and analyzed the results. XC, SC and RJ wrote the manuscript. All authors read and confirmed the manuscript.</p>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>Publication costs are funded by the National Key Research and Development Program of China (No. 2018YFC0910404), the National Natural Science Foundation of China (Nos. 61873141, 61721003, 61573207), Shanghai Municipal Science and Technology Major Project (No. 2017SHZDZX01), and the Tsinghua-Fuzhou Institute for Data Technology.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and materials</title>
    <p>The datasets supporting the conclusions of this article are publicly available from the NCBI Gene Expression Omnibus (<ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/geo/">https://www.ncbi.nlm.nih.gov/geo/</ext-link>), the NCBI Sequence Read Archive (<ext-link ext-link-type="uri" xlink:href="http://www.ncbi.nlm.nih.gov/Traces/sra/">http://www.ncbi.nlm.nih.gov/Traces/sra/</ext-link>), and the EMBL-EBI ArrayExpress (<ext-link ext-link-type="uri" xlink:href="https://www.ebi.ac.uk/arrayexpress/">https://www.ebi.ac.uk/arrayexpress/</ext-link>).</p>
  </notes>
  <notes id="FPar2">
    <title>Ethics approval and consent to participate</title>
    <p id="Par46">Not applicable.</p>
  </notes>
  <notes id="FPar3">
    <title>Consent for publication</title>
    <p id="Par47">Not applicable.</p>
  </notes>
  <notes id="FPar4" notes-type="COI-statement">
    <title>Competing interests</title>
    <p id="Par48">The authors declare that they have no competing interests.</p>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jaitin</surname>
            <given-names>DA</given-names>
          </name>
          <name>
            <surname>Kenigsberg</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Keren-Shaul</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Elefant</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Paul</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Zaretsky</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Mildner</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Cohen</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Jung</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Tanay</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Massively parallel single-cell RNA-Seq for marker-free decomposition of tissues into cell types</article-title>
        <source>Science</source>
        <year>2014</year>
        <volume>343</volume>
        <issue>6172</issue>
        <fpage>776</fpage>
        <lpage>779</lpage>
        <pub-id pub-id-type="doi">10.1126/science.1247651</pub-id>
        <pub-id pub-id-type="pmid">24531970</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Macosko</surname>
            <given-names>EZ</given-names>
          </name>
          <name>
            <surname>Basu</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Satija</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Nemesh</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Shekhar</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Goldman</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Tirosh</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Bialas</surname>
            <given-names>AR</given-names>
          </name>
          <name>
            <surname>Kamitaki</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Martersteck</surname>
            <given-names>EM</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Highly parallel genome-wide expression profiling of individual cells using Nanoliter droplets</article-title>
        <source>Cell</source>
        <year>2015</year>
        <volume>161</volume>
        <issue>5</issue>
        <fpage>1202</fpage>
        <lpage>1214</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2015.05.002</pub-id>
        <pub-id pub-id-type="pmid">26000488</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Picelli</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Bjorklund</surname>
            <given-names>AK</given-names>
          </name>
          <name>
            <surname>Faridani</surname>
            <given-names>OR</given-names>
          </name>
          <name>
            <surname>Sagasser</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Winberg</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Sandberg</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Smart-seq2 for sensitive full-length transcriptome profiling in single cells</article-title>
        <source>Nat Methods</source>
        <year>2013</year>
        <volume>10</volume>
        <issue>11</issue>
        <fpage>1096</fpage>
        <lpage>1098</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.2639</pub-id>
        <pub-id pub-id-type="pmid">24056875</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Grun</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Lyubimova</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Kester</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Wiebrands</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Basak</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Sasaki</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Clevers</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>van Oudenaarden</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Single-cell messenger RNA sequencing reveals rare intestinal cell types</article-title>
        <source>Nature</source>
        <year>2015</year>
        <volume>525</volume>
        <issue>7568</issue>
        <fpage>251</fpage>
        <pub-id pub-id-type="doi">10.1038/nature14966</pub-id>
        <pub-id pub-id-type="pmid">26287467</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Segerstolpe</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Palasantza</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Eliasson</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Andersson</surname>
            <given-names>EM</given-names>
          </name>
          <name>
            <surname>Andreasson</surname>
            <given-names>AC</given-names>
          </name>
          <name>
            <surname>Sun</surname>
            <given-names>XY</given-names>
          </name>
          <name>
            <surname>Picelli</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Sabirsh</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Clausen</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Bjursell</surname>
            <given-names>MK</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Single-cell Transcriptome profiling of human pancreatic islets in health and type 2 diabetes</article-title>
        <source>Cell Metab</source>
        <year>2016</year>
        <volume>24</volume>
        <issue>4</issue>
        <fpage>593</fpage>
        <lpage>607</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cmet.2016.08.020</pub-id>
        <pub-id pub-id-type="pmid">27667667</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jaitin</surname>
            <given-names>DA</given-names>
          </name>
          <name>
            <surname>Weiner</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Yofe</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Lara-Astiaso</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Keren-Shaul</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>David</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Salame</surname>
            <given-names>TM</given-names>
          </name>
          <name>
            <surname>Tanay</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>van Oudenaarden</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Amit</surname>
            <given-names>I</given-names>
          </name>
        </person-group>
        <article-title>Dissecting Immune Circuits by Linking CRISPR-Pooled Screens with Single-Cell RNA-Seq</article-title>
        <source>Cell</source>
        <year>2016</year>
        <volume>167</volume>
        <issue>7</issue>
        <fpage>1883</fpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2016.11.039</pub-id>
        <pub-id pub-id-type="pmid">27984734</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Xue</surname>
            <given-names>ZG</given-names>
          </name>
          <name>
            <surname>Huang</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Cai</surname>
            <given-names>CC</given-names>
          </name>
          <name>
            <surname>Cai</surname>
            <given-names>LB</given-names>
          </name>
          <name>
            <surname>Jiang</surname>
            <given-names>CY</given-names>
          </name>
          <name>
            <surname>Feng</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>ZS</given-names>
          </name>
          <name>
            <surname>Zeng</surname>
            <given-names>Q</given-names>
          </name>
          <name>
            <surname>Cheng</surname>
            <given-names>LM</given-names>
          </name>
          <name>
            <surname>Sun</surname>
            <given-names>YE</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Genetic programs in human and mouse early embryos revealed by single-cell RNA sequencing</article-title>
        <source>Nature</source>
        <year>2013</year>
        <volume>500</volume>
        <issue>7464</issue>
        <fpage>593</fpage>
        <pub-id pub-id-type="doi">10.1038/nature12364</pub-id>
        <pub-id pub-id-type="pmid">23892778</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Scialdone</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Natarajan</surname>
            <given-names>KN</given-names>
          </name>
          <name>
            <surname>Saraiva</surname>
            <given-names>LR</given-names>
          </name>
          <name>
            <surname>Proserpio</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Teichmann</surname>
            <given-names>SA</given-names>
          </name>
          <name>
            <surname>Stegle</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Marioni</surname>
            <given-names>JC</given-names>
          </name>
          <name>
            <surname>Buettner</surname>
            <given-names>F</given-names>
          </name>
        </person-group>
        <article-title>Computational assignment Of cell-cycle stage from single-cell transcriptome data</article-title>
        <source>Methods</source>
        <year>2015</year>
        <volume>85</volume>
        <fpage>54</fpage>
        <lpage>61</lpage>
        <pub-id pub-id-type="doi">10.1016/j.ymeth.2015.06.021</pub-id>
        <pub-id pub-id-type="pmid">26142758</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zeisel</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Munoz-Manchado</surname>
            <given-names>AB</given-names>
          </name>
          <name>
            <surname>Codeluppi</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Lonnerberg</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>La Manno</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Jureus</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Marques</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Munguba</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>He</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Betsholtz</surname>
            <given-names>C</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Cell types in the mouse cortex and hippocampus revealed by single-cell RNA-seq</article-title>
        <source>Science</source>
        <year>2015</year>
        <volume>347</volume>
        <issue>6226</issue>
        <fpage>1138</fpage>
        <lpage>1142</lpage>
        <pub-id pub-id-type="doi">10.1126/science.aaa1934</pub-id>
        <pub-id pub-id-type="pmid">25700174</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Marco</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Karp</surname>
            <given-names>RL</given-names>
          </name>
          <name>
            <surname>Guo</surname>
            <given-names>GJ</given-names>
          </name>
          <name>
            <surname>Robson</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Hart</surname>
            <given-names>AH</given-names>
          </name>
          <name>
            <surname>Trippa</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Yuan</surname>
            <given-names>GC</given-names>
          </name>
        </person-group>
        <article-title>Bifurcation analysis of single-cell gene expression data reveals epigenetic landscape</article-title>
        <source>Proc Natl Acad Sci U S A</source>
        <year>2014</year>
        <volume>111</volume>
        <issue>52</issue>
        <fpage>E5643</fpage>
        <lpage>E5650</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.1408993111</pub-id>
        <pub-id pub-id-type="pmid">25512504</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Satija</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Farrell</surname>
            <given-names>JA</given-names>
          </name>
          <name>
            <surname>Gennert</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Schier</surname>
            <given-names>AF</given-names>
          </name>
          <name>
            <surname>Regev</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Spatial reconstruction of single-cell gene expression data</article-title>
        <source>Nat Biotechnol</source>
        <year>2015</year>
        <volume>33</volume>
        <issue>5</issue>
        <fpage>495</fpage>
        <lpage>U206</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.3192</pub-id>
        <pub-id pub-id-type="pmid">25867923</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Treutlein</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Brownfield</surname>
            <given-names>DG</given-names>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>AR</given-names>
          </name>
          <name>
            <surname>Neff</surname>
            <given-names>NF</given-names>
          </name>
          <name>
            <surname>Mantalas</surname>
            <given-names>GL</given-names>
          </name>
          <name>
            <surname>Espinoza</surname>
            <given-names>FH</given-names>
          </name>
          <name>
            <surname>Desai</surname>
            <given-names>TJ</given-names>
          </name>
          <name>
            <surname>Krasnow</surname>
            <given-names>MA</given-names>
          </name>
          <name>
            <surname>Quake</surname>
            <given-names>SR</given-names>
          </name>
        </person-group>
        <article-title>Reconstructing lineage hierarchies of the distal lung epithelium using single-cell RNA-seq</article-title>
        <source>Nature</source>
        <year>2014</year>
        <volume>509</volume>
        <issue>7500</issue>
        <fpage>371</fpage>
        <pub-id pub-id-type="doi">10.1038/nature13173</pub-id>
        <pub-id pub-id-type="pmid">24739965</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Xie</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Gao</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Noel</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Yang</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Von Hoff</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Han</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>MQ</given-names>
          </name>
          <name>
            <surname>Lin</surname>
            <given-names>W</given-names>
          </name>
        </person-group>
        <article-title>SuperCT: a supervised-learning framework for enhanced characterization of single-cell transcriptomic profiles</article-title>
        <source>Nucleic Acids Res</source>
        <year>2019</year>
        <volume>47</volume>
        <issue>8</issue>
        <fpage>e48</fpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkz116</pub-id>
        <pub-id pub-id-type="pmid">30799483</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kiselev</surname>
            <given-names>VY</given-names>
          </name>
          <name>
            <surname>Yiu</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Hemberg M: scmap: projection of single-cell RNA-seq data across data sets</article-title>
        <source>Nat Methods</source>
        <year>2018</year>
        <volume>15</volume>
        <issue>5</issue>
        <fpage>359</fpage>
        <lpage>362</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.4644</pub-id>
        <pub-id pub-id-type="pmid">29608555</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Ke</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Meng</surname>
            <given-names>Q</given-names>
          </name>
          <name>
            <surname>Finley</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Ma</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Ye</surname>
            <given-names>Q</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>T-Y</given-names>
          </name>
        </person-group>
        <person-group person-group-type="editor">
          <name>
            <surname>Guyon</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Luxburg</surname>
            <given-names>UV</given-names>
          </name>
          <name>
            <surname>Bengio</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Wallach</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Fergus</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Vishwanathan</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Garnett</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>LightGBM: A Highly Efficient Gradient Boosting Decision Tree</article-title>
        <source>
          <italic>Advances in Neural Information Processing Systems 30</italic>
        </source>
        <year>2017</year>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Baron</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Veres</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Wolock</surname>
            <given-names>SL</given-names>
          </name>
          <name>
            <surname>Faust</surname>
            <given-names>AL</given-names>
          </name>
          <name>
            <surname>Gaujoux</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Vetere</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Ryu</surname>
            <given-names>JH</given-names>
          </name>
          <name>
            <surname>Wagner</surname>
            <given-names>BK</given-names>
          </name>
          <name>
            <surname>Shen-Orr</surname>
            <given-names>SS</given-names>
          </name>
          <name>
            <surname>Klein</surname>
            <given-names>AM</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A Single-Cell Transcriptomic Map of the Human and Mouse Pancreas Reveals Inter- and Intra-cell Population Structure</article-title>
        <source>Cell Syst</source>
        <year>2016</year>
        <volume>3</volume>
        <issue>4</issue>
        <fpage>346</fpage>
        <pub-id pub-id-type="doi">10.1016/j.cels.2016.08.011</pub-id>
        <pub-id pub-id-type="pmid">27667365</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Muraro</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>Dharmadhikari</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Gruen</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Groen</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Dielen</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Jansen</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>van Gurp</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Engelse</surname>
            <given-names>MA</given-names>
          </name>
          <name>
            <surname>Carlotti</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>de Koning</surname>
            <given-names>EJP</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A Single-Cell Transcriptome Atlas of the Human Pancreas</article-title>
        <source>Cell Syst</source>
        <year>2016</year>
        <volume>3</volume>
        <issue>4</issue>
        <fpage>385</fpage>
        <pub-id pub-id-type="doi">10.1016/j.cels.2016.09.002</pub-id>
        <pub-id pub-id-type="pmid">27693023</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Xin</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Kim</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Okamoto</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Ni</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Wei</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Adler</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Murphy</surname>
            <given-names>AJ</given-names>
          </name>
          <name>
            <surname>Yancopoulos</surname>
            <given-names>GD</given-names>
          </name>
          <name>
            <surname>Lin</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Gromada</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>RNA sequencing of single human islet cells reveals type 2 diabetes genes</article-title>
        <source>Cell Metab</source>
        <year>2016</year>
        <volume>24</volume>
        <issue>4</issue>
        <fpage>608</fpage>
        <lpage>615</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cmet.2016.08.018</pub-id>
        <pub-id pub-id-type="pmid">27667665</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Shekhar</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Lapan</surname>
            <given-names>SW</given-names>
          </name>
          <name>
            <surname>Whitney</surname>
            <given-names>IE</given-names>
          </name>
          <name>
            <surname>Tran</surname>
            <given-names>NM</given-names>
          </name>
          <name>
            <surname>Macosko</surname>
            <given-names>EZ</given-names>
          </name>
          <name>
            <surname>Kowalczyk</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Adiconis</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Levin</surname>
            <given-names>JZ</given-names>
          </name>
          <name>
            <surname>Nemesh</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Goldman</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Comprehensive Classification of Retinal Bipolar Neurons by Single-Cell Transcriptomics</article-title>
        <source>Cell</source>
        <year>2016</year>
        <volume>166</volume>
        <issue>5</issue>
        <fpage>1308</fpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2016.07.054</pub-id>
        <pub-id pub-id-type="pmid">27565351</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Darmanis</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Sloan</surname>
            <given-names>SA</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Enge</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Caneda</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Shuer</surname>
            <given-names>LM</given-names>
          </name>
          <name>
            <surname>Gephart</surname>
            <given-names>MGH</given-names>
          </name>
          <name>
            <surname>Barres</surname>
            <given-names>BA</given-names>
          </name>
          <name>
            <surname>Quake</surname>
            <given-names>SR</given-names>
          </name>
        </person-group>
        <article-title>A survey of human brain transcriptome diversity at the single cell level</article-title>
        <source>Proc Natl Acad Sci U S A</source>
        <year>2015</year>
        <volume>112</volume>
        <issue>23</issue>
        <fpage>7285</fpage>
        <lpage>7290</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.1507125112</pub-id>
        <pub-id pub-id-type="pmid">26060301</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Romanov</surname>
            <given-names>RA</given-names>
          </name>
          <name>
            <surname>Zeisel</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Bakker</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Girach</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Hellysaz</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Tomer</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Alpar</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Mulder</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Clotman</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Keimpema</surname>
            <given-names>E</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Molecular interrogation of hypothalamic organization reveals distinct dopamine neuronal subtypes</article-title>
        <source>Nat Neurosci</source>
        <year>2017</year>
        <volume>20</volume>
        <issue>2</issue>
        <fpage>176</fpage>
        <lpage>188</lpage>
        <pub-id pub-id-type="doi">10.1038/nn.4462</pub-id>
        <pub-id pub-id-type="pmid">27991900</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Stuart</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Butler</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Hoffman</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Hafemeister</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Papalexi</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Mauck</surname>
            <given-names>WM</given-names>
          </name>
          <name>
            <surname>Stoeckius</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Smibert</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Satija</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Comprehensive integration of single cell data</article-title>
        <source>bioRxiv</source>
        <year>2018</year>
        <volume>177</volume>
        <issue>7</issue>
        <fpage>1888</fpage>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <mixed-citation publication-type="other">Chen S, Wang Y, Jiang R. OPENANNO: annotating genomic regions with chromatin accessibility. bioRxiv. 2019.</mixed-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Duren</surname>
            <given-names>ZN</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Zamanighomi</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Zeng</surname>
            <given-names>WW</given-names>
          </name>
          <name>
            <surname>Satpathy</surname>
            <given-names>AT</given-names>
          </name>
          <name>
            <surname>Chang</surname>
            <given-names>HY</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Wong</surname>
            <given-names>WH</given-names>
          </name>
        </person-group>
        <article-title>Integrative analysis of single-cell genomics data by coupled nonnegative matrix factorizations</article-title>
        <source>Proc Natl Acad Sci U S A</source>
        <year>2018</year>
        <volume>115</volume>
        <issue>30</issue>
        <fpage>7723</fpage>
        <lpage>7728</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.1805681115</pub-id>
        <pub-id pub-id-type="pmid">29987051</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chen</surname>
            <given-names>SQ</given-names>
          </name>
          <name>
            <surname>Hua</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Cui</surname>
            <given-names>HF</given-names>
          </name>
          <name>
            <surname>Jiang</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>VPAC: Variational projection for accurate clustering of single-cell transcriptomic data</article-title>
        <source>Bmc Bioinformatics</source>
        <year>2019</year>
        <volume>20</volume>
        <fpage>0</fpage>
        <pub-id pub-id-type="doi">10.1186/s12859-019-2742-4</pub-id>
        <pub-id pub-id-type="pmid">31074382</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
