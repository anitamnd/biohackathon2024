<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Sci Rep</journal-id>
    <journal-id journal-id-type="iso-abbrev">Sci Rep</journal-id>
    <journal-title-group>
      <journal-title>Scientific Reports</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2045-2322</issn>
    <publisher>
      <publisher-name>Nature Publishing Group UK</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">7442834</article-id>
    <article-id pub-id-type="publisher-id">70832</article-id>
    <article-id pub-id-type="doi">10.1038/s41598-020-70832-2</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Machine learning for RNA sequencing-based intrinsic subtyping of breast cancer</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Cascianelli</surname>
          <given-names>Silvia</given-names>
        </name>
        <address>
          <email>silvia.cascianelli@polimi.it</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Molineris</surname>
          <given-names>Ivan</given-names>
        </name>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Isella</surname>
          <given-names>Claudio</given-names>
        </name>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Masseroli</surname>
          <given-names>Marco</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Medico</surname>
          <given-names>Enzo</given-names>
        </name>
        <xref ref-type="aff" rid="Aff2">2</xref>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="GRID">grid.4643.5</institution-id><institution-id institution-id-type="ISNI">0000 0004 1937 0327</institution-id><institution>Dipartimento di Elettronica, Informazione e Bioingegneria, </institution><institution>Politecnico di Milano, </institution></institution-wrap>Piazza Leonardo da Vinci 32, 20133 Milan, Italy </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="GRID">grid.419555.9</institution-id><institution-id institution-id-type="ISNI">0000 0004 1759 7675</institution-id><institution>Candiolo Cancer Institute, FPO-IRCCS, </institution></institution-wrap>S.P. 142, km 3.95, 10060 Candiolo, TO Italy </aff>
      <aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="GRID">grid.7605.4</institution-id><institution-id institution-id-type="ISNI">0000 0001 2336 6580</institution-id><institution>Department of Oncology, </institution><institution>University of Torino, </institution></institution-wrap>S.P. 142, km 3.95, 10060 Candiolo, TO Italy </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>21</day>
      <month>8</month>
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>21</day>
      <month>8</month>
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2020</year>
    </pub-date>
    <volume>10</volume>
    <elocation-id>14071</elocation-id>
    <history>
      <date date-type="received">
        <day>18</day>
        <month>2</month>
        <year>2020</year>
      </date>
      <date date-type="accepted">
        <day>23</day>
        <month>7</month>
        <year>2020</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2020</copyright-statement>
      <license license-type="OpenAccess">
        <license-p><bold>Open Access</bold> This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The images or other third party material in this article are included in the article's Creative Commons license, unless indicated otherwise in a credit line to the material. If material is not included in the article's Creative Commons license and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this license, visit <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <p id="Par1">Stratification of breast cancer (BC) into molecular subtypes by multigene expression assays is of demonstrated clinical utility. In principle, global RNA-sequencing (RNA-seq) should enable reconstructing existing transcriptional classifications of BC samples. Yet, it is not clear whether adaptation to RNA-seq of classifiers originally developed using PCR or microarrays, or reconstruction through machine learning (ML) is preferable. Hence, we focused on robustness and portability of PAM50, a nearest-centroid classifier developed on microarray data to identify five BC “intrinsic subtypes”. We found that standard PAM50 is profoundly affected by the composition of the sample cohort used for reference construction, and we propose a strategy, named AWCA, to mitigate this issue, improving classification robustness, with over 90% of concordance, and prognostic ability; we also show that AWCA-based PAM50 can even be applied as single-sample method. Furthermore, we explored five supervised learners to build robust, single-sample intrinsic subtype callers via RNA-seq. From our ML-based survey, regularized multiclass logistic regression (mLR) displayed the best performance, further increased by ad-hoc gene selection on the global transcriptome. On external test sets, mLR classifications reached 90% concordance with PAM50-based calls, without need of reference sample; mLR proven robustness and prognostic ability make it an equally valuable single-sample method to strengthen BC subtyping.</p>
    </abstract>
    <kwd-group kwd-group-type="npg-subject">
      <title>Subject terms</title>
      <kwd>Computational biology and bioinformatics</kwd>
      <kwd>Machine learning</kwd>
      <kwd>Cancer</kwd>
    </kwd-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2020</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Introduction</title>
    <p id="Par2">Breast cancer (BC) is the most common cancer in women worldwide, and in about 80% of cases is invasive, i.e. it breaks through the walls of the glands or ducts where it originated and grows into surrounding breast tissue. Although it is generally referred to as a single disease, BC is heterogeneous in terms of histological composition, molecular features, risk factors, response to treatment, aggressiveness and clinical outcomes<sup><xref ref-type="bibr" rid="CR1">1</xref>–<xref ref-type="bibr" rid="CR5">5</xref></sup>. The advent of technological platforms for global gene expression profiling has shown more clearly that BC classification and prognosis is not only determined by the commonly used clinical-pathological variables, but also by intrinsic molecular characteristics, which can be probed using molecular methods and genomic profile investigation. The acquired knowledge has improved BC patient management, providing more accurate prognostic stratification.
</p>
    <p id="Par3">Based on gene expression quantification, various tests have been introduced in BC clinical practice over the last 10 years to provide molecular stratification and estimate the risk of relapse after surgery, as to avoid adjuvant treatment in low-risk cases<sup><xref ref-type="bibr" rid="CR6">6</xref>–<xref ref-type="bibr" rid="CR8">8</xref></sup>. However, currently adopted prognostic tests consider a limited number of classifying genes; consequently, the effort to measure gene expression in a tumour sample does not exploit the wider information potentially available through Next-Generation Sequencing (NGS)-based global profiling of RNA expression (RNA-seq). Indeed, some recent works performed BC classification on RNA-seq data<sup><xref ref-type="bibr" rid="CR9">9</xref>–<xref ref-type="bibr" rid="CR11">11</xref></sup>, but they mostly considered only known marker genes and applied methods developed for previous technologies, like microarrays or PCR, without substantial modifications or adaptations. Conversely, Paquet et al.<sup><xref ref-type="bibr" rid="CR12">12</xref></sup> developed the Absolute Intrinsic Molecular Subtyping (AIMS), a bioinformatics approach to allow a reproducible single-sample classification of BC profiles, while, Raj-Kumar et al.<sup><xref ref-type="bibr" rid="CR13">13</xref></sup> proposed a Principal Component Analysis-based approach to improve consistency of subtyping, facing the issue of the non-complete coherence between IHC (immunohistochemistry) and gene expression defined estrogen receptor status; finally, Chen et al.<sup><xref ref-type="bibr" rid="CR14">14</xref></sup> implemented a deep-learning approach, called DeepType, to learn and cluster a BC gene expression data representation integrating supervised knowledge about subtypes.</p>
    <p id="Par4">Hence, huge dimensionality of exploitable data at reasonable and progressively lower costs, higher accuracy of the expression values, and the chance of multiple surveys on the same data are all crucial reasons of interest for the development of RNA-seq based BC stratification methods for clinical outcome prediction. Combining on a single RNA-seq profile more classifiers, based on different relevant gene signatures and algorithms, could strengthen the results; whereas, existing prognostic tests, examining distinct genes on different platforms, show limited concordance in identifying subgroups and good prognosis patients<sup><xref ref-type="bibr" rid="CR8">8</xref></sup>. To explore in detail the potential of RNA-seq in reconstructing a BC classification system originally developed with a different technology, we considered the so-called <italic>“intrinsic molecular subtypes” (Luminal A, Luminal B, Normal-like, Her2-Enriched and Basal)</italic>, which have become part of the common knowledge on the disease and are recognized as prognostically and therapeutically relevant<sup><xref ref-type="bibr" rid="CR7">7</xref></sup>. Even if these groups firstly emerged by unsupervised hierarchical clustering on global microarray gene expression profiles<sup><xref ref-type="bibr" rid="CR1">1</xref></sup>, BC classification into intrinsic subtypes is primarily achieved by measuring the expression of a set of only 50 genes, the so-called “PAM50 panel”<sup><xref ref-type="bibr" rid="CR15">15</xref></sup>. PAM50 classification is obtained by comparing, for a given BC sample, relative expression of these 50 genes versus a reference sample, and by assigning the subtype based on the highest correlation with the five subtype centroids. Distances from all these centroids can be also used to compute a “Risk of Recurrence” (ROR) score, a prognostic indicator whose low value indicates unlikely relapse after surgery and the possibility to avoid post-operative chemotherapy<sup><xref ref-type="bibr" rid="CR15">15</xref></sup>. The PAM50 assay has been extensively investigated by microarrays and quantitative PCR, and even converted into a Food and Drug Administration (FDA) approved predictive test called Prosigna, working on the Nanostring nCounter platform<sup><xref ref-type="bibr" rid="CR16">16</xref></sup>. The prognostic value of the PAM50 method and its derivatives has been confirmed by independent studies<sup><xref ref-type="bibr" rid="CR17">17</xref>–<xref ref-type="bibr" rid="CR19">19</xref></sup>. Lately, also RNA-seq profiles have been used for PAM50 classification, mainly based on the algorithm<sup><xref ref-type="bibr" rid="CR15">15</xref></sup> developed by Parker et al.<sup><xref ref-type="bibr" rid="CR9">9</xref>–<xref ref-type="bibr" rid="CR11">11</xref>, <xref ref-type="bibr" rid="CR13">13</xref></sup>. However, applying a microarray-based classifier to RNA-seq data may provide suboptimal results.</p>
    <p id="Par5">Therefore, here we analyzed the possible limits of the standard PAM50 algorithm when applied to RNA-seq profiles, and explored alternative robust strategies to assign intrinsic subtypes to BC samples, also based on supervised learners and feature selection methods starting from global RNA-seq expression data (Fig. <xref rid="Fig1" ref-type="fig">1</xref>). Indeed, intrinsic subtypes summarize BC biological and molecular features, which are known to involve many more genes than the PAM50 set<sup><xref ref-type="bibr" rid="CR20">20</xref></sup>.<fig id="Fig1"><label>Figure 1</label><caption><p>Overview. Main steps of our parallel workflows.</p></caption><graphic xlink:href="41598_2020_70832_Fig1_HTML" id="MO1"/></fig></p>
  </sec>
  <sec id="Sec2">
    <title>Results</title>
    <sec id="Sec3">
      <title>Assembly of breast cancer RNA-seq datasets</title>
      <p id="Par6">For the purpose of this work we used RNA-seq profiles from four datasets, for a total of 4,731 breast cancer samples (see "<xref rid="Sec14" ref-type="sec">Methods</xref>" section for details). Notably, data preprocessing was not homogeneous: <italic>TCGA</italic> and <italic>PanCA</italic> expression profiles were subject to RSEM<sup><xref ref-type="bibr" rid="CR21">21</xref></sup> summarization and upper quartile normalization, while for both GEO datasets only FPKM<sup><xref ref-type="bibr" rid="CR22">22</xref></sup> expression values were available. From Principal Component Analysis (PCA), performed independently for RSEM and FPKM data, we noticed that subtype distributions were not overlapping on the two cases (Supplementary Material Figure <xref rid="MOESM1" ref-type="media">S9</xref>). Furthermore, even if some approaches have been proposed to remove specific bias and compare different gene expression data types<sup><xref ref-type="bibr" rid="CR21">21</xref>–<xref ref-type="bibr" rid="CR23">23</xref></sup>, we did not experience good results in transforming and merging the used RSEM and FPKM datasets (see Supplementary Material <xref rid="MOESM1" ref-type="media">Appendix</xref>); in our opinion, limited compatibility of RSEM may lie in its peculiar probabilistic approach to handle read mapping uncertainty<sup><xref ref-type="bibr" rid="CR21">21</xref></sup>. Thus, we conservatively performed all analyses separately on RSEM and FPKM profiles, as to evaluate the suitability and reliability of the studied approaches on differently summarized/normalized RNA-seq data.</p>
    </sec>
    <sec id="Sec4">
      <title>PAM50 classification</title>
      <sec id="Sec5">
        <title>Evaluation of the standard PAM50 method and arisen issues</title>
        <p id="Par7">For all datasets, results of the PAM50 classification performed by the original authors according to the standard method<sup><xref ref-type="bibr" rid="CR15">15</xref></sup> are publicly available. However, it should be noted that a key step in PAM50 classification could give rise to inconsistency: before calculating distances from subtype centroids, gene expression values for each sample must be transformed into Log2ratios against a reference sample, to be defined for each dataset. Typically, to avoid representation bias, such reference is constructed within the dataset by calculating for each gene the median across a subset of samples with a fixed proportion (60/40) of Estrogen Receptor-positive (ER+) and -negative (ER−) cases, as done for the original PAM50 training<sup><xref ref-type="bibr" rid="CR15">15</xref></sup>. Therefore, calculating the reference from different subsets having the same ER+/ER− composition could yield discordant classification for some samples. To verify this hypothesis, we constructed ten alternative references for the <italic>TCGA</italic> dataset, from ten randomly chosen subsets of 400 samples matching the 60/40 ratio of ER+/ER− cases. Each reference was then used to compute Log2ratio values for all <italic>TCGA</italic> dataset samples, resulting in ten Log2ratio data matrices. As a technical control, one additional Log2ratio matrix was generated against a reference constructed from a subset of 262 samples of the <italic>TCGA</italic> dataset that were originally employed for the same task by Ciriello et al.<sup><xref ref-type="bibr" rid="CR9">9</xref></sup>, and that had a 50/50 ratio of ER+/ER− cases. Then, ten other references and Log2ratio matrices were computed using random subsets having same dimensionality (262 samples) and ER+/ER− proportion (50/50) of the technical control subset. Eventually, PAM50 classification was applied to each Log2ratio matrix using the centroids disclosed by Parker et al.<sup><xref ref-type="bibr" rid="CR15">15</xref></sup>, to assess the concordances of our classifications with the subtype calls published by Ciriello et al.<sup><xref ref-type="bibr" rid="CR9">9</xref></sup>.</p>
        <p id="Par8">Concordance of each of the ten random 60/40 ER+/ER− subset reconstructions with the published classification was suboptimal (mean: 85.52% st.dev.: <inline-formula id="IEq1"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$+/-$$\end{document}</tex-math><mml:math id="M2"><mml:mrow><mml:mo>+</mml:mo><mml:mo stretchy="false">/</mml:mo><mml:mo>-</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41598_2020_70832_Article_IEq1.gif"/></alternatives></inline-formula>0.83%). Conversely, the ten classifications using references built with subsets having the same dimensionality and ER+/ER− proportion of the technical control subset were much more concordant with the published classification (mean: 95.45% st.dev.: <inline-formula id="IEq2"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$+/-$$\end{document}</tex-math><mml:math id="M4"><mml:mrow><mml:mo>+</mml:mo><mml:mo stretchy="false">/</mml:mo><mml:mo>-</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41598_2020_70832_Article_IEq2.gif"/></alternatives></inline-formula>1.66%). Eventually, the reconstruction based on the technical control subset of samples employed by Ciriello et al.<sup><xref ref-type="bibr" rid="CR9">9</xref></sup> was almost completely concordant (99.27%). The minimal discordance can be attributed to the fact that 52 samples of the original set were not included within the available 817 sample <italic>TCGA</italic> dataset under study; therefore, our technical control was not completely identical to the reference of Ciriello et al.<sup><xref ref-type="bibr" rid="CR9">9</xref></sup>. These results confirmed that the choice of the samples used to build the reference significantly affects subsequent subtyping, as much as the adopted reference is different from the one used for the disclosed PAM50 classification. Discordant classifications typically involved samples having comparable correlations with more than one subtype (Supplementary Material Figure <xref rid="MOESM1" ref-type="media">S6</xref>); the non-separability among subtypes also emerged from PCA analysis (Supplementary Material Figure <xref rid="MOESM1" ref-type="media">S9</xref>), regardless of data preprocessing. Hence, changes observed in PAM50 classification reflect, to some extent, an internal degree of ambiguity in subtypes; it is plausible that for some samples the boundary between subtypes may be labile due to the possible coexistence of mixed traits.</p>
      </sec>
      <sec id="Sec6">
        <title>Double averaging for robust reference construction</title>
        <p id="Par9">Having proved that the reference building step affects PAM50 subtyping, we explored an alternative strategy for robust construction of the reference, to improve consistency and reproducibility of PAM50-based subtyping. This iterative strategy starts with a preliminary standard PAM50 classification, and then for each gene computes the average expression within each subtype, taking all the samples of the dataset classified as belonging to that subtype class. The so-obtained within-class mean values are then further averaged for each gene, to obtain a final reference expression value named “average of within-class averages” (<italic>AWCA</italic>), which is independent of the numerosity of samples in each subtype. An <italic>AWCA</italic> can be built without the need of matching exactly a given proportion of cases; double averaging, indeed, equates all class contributions avoiding reference estimation to be corrupted by imbalance distribution of subtypes.</p>
        <p id="Par10">For the <italic>TCGA</italic> dataset, we employed the ten PAM50 classifications obtained from the random 60/40 subsets described above to construct ten new <italic>AWCA</italic> references. In this case, due to the limited number of <italic>Normal-like</italic> samples in the <italic>TCGA</italic> dataset (only 25 samples) and their resulting lack within several of the previously computed random subsets, we decided to exclude the within-<italic>Normal-like</italic> class averaging calculation from the reference computation. We obtained effectively 10 subtyping instances significantly more concordant with the already published calls (91.17% <inline-formula id="IEq3"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$+/-$$\end{document}</tex-math><mml:math id="M6"><mml:mrow><mml:mo>+</mml:mo><mml:mo stretchy="false">/</mml:mo><mml:mo>-</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41598_2020_70832_Article_IEq3.gif"/></alternatives></inline-formula>0.87%). Notably, discordances with Ciriello et al.<sup><xref ref-type="bibr" rid="CR9">9</xref></sup> were shared across all, or most of, <italic>AWCA</italic>-based subtyping instances and globally involved only 80 samples, i.e., less than 10% of all samples (Supplementary Material Figure <xref rid="MOESM1" ref-type="media">S7</xref>). Most importantly, the <italic>AWCA</italic>-based subtyping was highly concordant across the 10 instances (99.13% <inline-formula id="IEq4"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$+/-$$\end{document}</tex-math><mml:math id="M8"><mml:mrow><mml:mo>+</mml:mo><mml:mo stretchy="false">/</mml:mo><mml:mo>-</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41598_2020_70832_Article_IEq4.gif"/></alternatives></inline-formula>0.43%; Supplementary Material Figure <xref rid="MOESM1" ref-type="media">S8</xref>) and more stable than the corresponding standard PAM50 one (95.41% <inline-formula id="IEq5"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$+/-$$\end{document}</tex-math><mml:math id="M10"><mml:mrow><mml:mo>+</mml:mo><mml:mo stretchy="false">/</mml:mo><mml:mo>-</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41598_2020_70832_Article_IEq5.gif"/></alternatives></inline-formula>1.04%), clearly demonstrating that the AWCA-based PAM50 classification is much less dependent on the subset of samples used to build the initial reference. Furthermore, this occurs even when the size of the sample subset selected for reference construction is progressively reduced. Indeed, to further investigate the robustness of <italic>AWCA</italic>-based PAM50 classifications, we built other random 60/40 subsets, varying their overall size from 400 to 25 samples with progressive halving; for each subset size we took ten random subsets, and from the corresponding standard median-based PAM50 classifications we built ten new <italic>AWCA</italic> references. For any of the assessed subset sizes, performing PAM50 classifications with the newly generated <italic>AWCA</italic> references yielded an improvement of approximately 5% of the concordance with the already published calls, with much lower dispersion compared with the results of the corresponding median-based classifications (Supplementary Material Figure <xref rid="MOESM1" ref-type="media">S4</xref>). Even more importantly, <italic>AWCA</italic>-based PAM50 classifications are much more stable and concordant among them, proving the higher reliability and robustness of the <italic>AWCA</italic>-based approach itself (see Supplementary Material Section <xref rid="MOESM1" ref-type="media">S2</xref>). Even considering only subset sizes less critical for standard PAM50 classifications (from 400 to 100 samples), as reported in Fig. <xref rid="Fig2" ref-type="fig">2</xref>, <italic>AWCA</italic>-based PAM50 classifications show both higher agreement with published calls and better pairwise concordance distribution, with standard deviations always below 1% (98.5% <inline-formula id="IEq6"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$+/-$$\end{document}</tex-math><mml:math id="M12"><mml:mrow><mml:mo>+</mml:mo><mml:mo stretchy="false">/</mml:mo><mml:mo>-</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41598_2020_70832_Article_IEq6.gif"/></alternatives></inline-formula>0.93%); conversely, agreements of the corresponding standard PAM50 classifications are lower and dispersions almost double at each subset size halving (94.6% <inline-formula id="IEq7"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$+/-$$\end{document}</tex-math><mml:math id="M14"><mml:mrow><mml:mo>+</mml:mo><mml:mo stretchy="false">/</mml:mo><mml:mo>-</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41598_2020_70832_Article_IEq7.gif"/></alternatives></inline-formula>2.2%).<fig id="Fig2"><label>Figure 2</label><caption><p>Subtyping of <italic>TCGA</italic> dataset varying the sample subset size of interest for multiple runs of standard PAM50 and AWCA-based PAM50: concordances with Ciriello et al.<sup><xref ref-type="bibr" rid="CR9">9</xref></sup> subtype calls (left); pairwise concordance distributions (right).</p></caption><graphic xlink:href="41598_2020_70832_Fig2_HTML" id="MO2"/></fig></p>
        <p id="Par11">Such results drove us towards a wider analysis to assess the suitability and possibly the gain of using an inner <italic>AWCA</italic> reference to reproduce PAM50 classification. We used entirely the wide <italic>TCGA</italic> dataset together with the published subtype calls of Ciriello et al.<sup><xref ref-type="bibr" rid="CR9">9</xref></sup> to calculate the inner <italic>AWCA</italic> reference. Furthermore, since <italic>Normal-like</italic> cases are undersized within the <italic>TCGA</italic> dataset, we built also an <italic>AWCA</italic> reference excluding the <italic>Normal-like</italic> class. Then, we computed corresponding Log2ratio matrices, used for two additional AWCA-PAM50 classifications. As expected, they brought non-complete concordance with Ciriello et al.<sup><xref ref-type="bibr" rid="CR9">9</xref></sup> calls (Supplementary Material Figure <xref rid="MOESM1" ref-type="media">S5</xref>), but were significantly accurate (91%, 93%, respectively), although they considered neither the exactly used reference, nor the medians of a subset with a fixed ER+/ER− proportion. In view of the emerged results, we assessed if the use of an inner <italic>AWCA</italic> reference could generally guarantee more than 90% of concordance with respect to already available subtype calls. To this end, we used the <italic>GSE96058</italic> dataset to investigate if this peculiarity could be also found on an independent dataset of differently normalized mRNA-seq profiles. According to the published subtype calls, we computed the <italic>AWCA</italic> reference within <italic>GSE96058</italic>; the subsequent PAM50 classification was again highly concordant (95%) with the published one (see Supplementary Material Section <xref rid="MOESM1" ref-type="media">S4</xref>). Obtained results confirmed that, in absence of the exactly used reference, inner <italic>AWCA</italic> is a good reference to reproduce subtyping, and to identify stable calls from ambiguous ones.</p>
        <p id="Par12">However, to improve the adoption of a PAM50-based intrinsic subtyping on RNA-seq samples and assure future reproducibility it would be crucial to standardize the approach by defining well-known robust references. In this perspective, we investigated the portability of the already computed <italic>AWCA</italic> references for the subtyping of independent datasets. Since different summarization/normalization strategies, namely RSEM and FPKM, may yield non-comparable results, we took advantage of the <italic>AWCA</italic> reference built using the RSEM values of the <italic>TCGA</italic> dataset for the subtyping of the RSEM <italic>PanCA</italic> dataset, and the <italic>AWCA</italic> reference obtained from the FPKM values of the <italic>GSE96058</italic> dataset for the subtyping of the FPKM <italic>GSE81538</italic> profiles. Taking the published subtype calls as targets, the concordance was beyond 96% both in the <italic>PanCA</italic> dataset using the best <italic>TCGA</italic>
<italic>AWCA</italic>, and in the <italic>GSE81538</italic> dataset using the best <italic>GSE96058</italic>
<italic>AWCA</italic> (Supplementary Material Figure <xref rid="MOESM1" ref-type="media">S15</xref>). Notably, when instead an internal <italic>AWCA</italic> was used for subtyping, the concordance with published calls reached almost 95% for both the <italic>PanCA</italic> and <italic>GSE81538</italic> datasets. Furthermore, internal and external AWCA-based classifications appeared highly concordant, with approximately 95% of agreement. These results show that it is possible to use an external reference to center RNA-seq data for robust, single-sample PAM50 classification. However, when RSEM-based <italic>AWCA</italic> was applied to FPKM data, and vice versa, the concordances dropped to 80–87% (see Supplementary Material <xref rid="MOESM1" ref-type="media">Appendix</xref>). This highlighted to what extent RNA-seq data processing affects data, and indicated that differently normalized profiles should not be merged in a single experimental dataset. Moreover, in some cases, a low number of <italic>Normal-like</italic> samples may justify excluding this class from the <italic>AWCA</italic> calculation, as experienced for the <italic>TCGA</italic> dataset (Supplementary Material Figure <xref rid="MOESM1" ref-type="media">S15</xref>).</p>
        <p id="Par13">These results confirmed the limits of the standard PAM50 subtyping approach, due to its strict dependence on the reference values and building procedure. Yet, they also opened the perspective of constructing and validating general AWCA references to standardize PAM50-based subtyping, facing the reproducibility and ambiguity issues in subtype calling (Supplementary Material Table <xref rid="MOESM1" ref-type="media">S3</xref>). At <ext-link ext-link-type="uri" xlink:href="https://github.com/DEIB-GECO/BC_Intrinsic_subtyping">https://github.com/DEIB-GECO/BC_Intrinsic_subtyping</ext-link> we make publicly available the R codes to perform single-sample PAM50 classifications using precomputed AWCA references (for RSEM or FPKM RNA-seq data), and to build AWCA references on any expression data, even from other platforms, as we successfully experienced with microarray data from Affymetrix (see Supplementary Material <xref rid="MOESM1" ref-type="media">Appendix</xref>). Notably, to obtain valuable AWCA references for single-sample classification of independent expression profiles, we suggest to select a wide dataset subjected to the same normalization of the data of interest, and to compute AWCA references from a subset size of at least 50–100 samples. Hormonal and HER2 status distributions should be also carefully evaluated to check whether they are representative of the typical BC heterogeneity, as we did for <italic>TCGA</italic> and <italic>GSE96058</italic> datasets using ER/PR/HER2 proportions found in the literature as benchmark<sup><xref ref-type="bibr" rid="CR24">24</xref></sup>.</p>
      </sec>
      <sec id="Sec7">
        <title>Risk of recurrence and prognostic assessment</title>
        <p id="Par14">Here, we report a comparative analysis of the Risk of Recurrence (ROR) scores computed for the <italic>TCGA</italic> dataset downstream of the AWCA-based PAM50 classification and of the PAM50 technical replica, which strictly emulates the Ciriello et al.<sup><xref ref-type="bibr" rid="CR9">9</xref></sup> PAM50 classification by means of the technical control reference. ROR scores were obtained accordingly to the predictive ROR-C model presented by Parker et al.<sup><xref ref-type="bibr" rid="CR15">15</xref></sup>, and they were tested against 10-year overall survival annotations, to compare the ability of the two PAM50-based approaches in correctly predicting cases with good or poor long-term prognosis. Additionally, we evaluated also another PAM50-based assay, i.e., the Food and Drug Administration approved Prosigna clinical test, which was developed on NanoString expression profiles to provide both the BC subtype and the estimated ROR of a patient. Yet, it requires the proprietary NanoString platform to process each expression profile under exam with an in-vitro reference, included in the Prosigna kit. Hence, in applying in-silico the Prosigna subtyping approach the reference choice issue becomes even harder to face than for the PAM50 subtyping. Furthermore, we did not find public datasets annotated with BC subtypes from the Prosigna test, which prevents a deeper comparative analysis beyond what we discuss. Nonetheless, we performed all the required Prosigna normalization steps, including reference normalization, making use of our precomputed AWCA reference. Then, we implemented the specific Prosigna subtyping procedure and also calculated the ROR scores according to the Prosigna specific ROR model. Eventually, not only the obtained subtype calls were compared with the standard and AWCA-based PAM50 ones (Supplementary Material Figure <xref rid="MOESM1" ref-type="media">S11</xref>), but also the computed ROR scores. Such comparisons denote a slightly more pessimistic prediction trend for Prosigna, also when tested against effective survival data (Fig. <xref rid="Fig3" ref-type="fig">3</xref>). Conversely, ROR scores from standard and AWCA-based PAM50 appeared highly correlated to each other; furthermore, AWCA-based ones improved the prognostic ability (reaching the most statistically significant <italic>p</italic> value) in discriminating good and poor prognosis cases emerged from 10-year overall survival analysis. For further details, please refer to Supplementary Material Section <xref rid="MOESM1" ref-type="media">S3</xref>.<fig id="Fig3"><label>Figure 3</label><caption><p>Risk of recurrence. AWCA-PAM50 calls and ROR-C scores compared with Prosigna ROR scores (up) and with PAM50 technical replica scores (center); statistical significance in discriminating 10-year overall survival (OS) status (down).</p></caption><graphic xlink:href="41598_2020_70832_Fig3_HTML" id="MO3"/></fig></p>
      </sec>
    </sec>
    <sec id="Sec8">
      <title>Machine learning-based intrinsic subtyping</title>
      <p id="Par15">Machine learning (ML) supervised approaches were separately applied to the wide <italic>TCGA</italic> and <italic>GSE96058</italic> datasets, well representative of BC heterogeneity, to provide valuable classifiers while handling independently RSEM and FPKM mRNA-seq data (further details on Supplementary Materials <xref rid="MOESM1" ref-type="media">Appendix</xref>). A 220-sample training set was extracted randomly from the <italic>TCGA</italic> dataset, respecting the same 60/40 ER+/ER− proportion of the PAM50 training set. All the remaining 597 cases were instead included in the <italic>TCGA</italic> test set. Both sets were used to train or test the classifiers under study using the Ciriello et al.<sup><xref ref-type="bibr" rid="CR9">9</xref></sup> subtype calls as target labels. Considering the number of samples in <italic>Her2-Enriched</italic> (65) and <italic>Normal-like</italic> (25) classes, we built the training set including 50 samples for each <italic>Luminal A</italic>, <italic>Luminal B</italic>, <italic>Basal</italic> and <italic>Her2-Enriched</italic> class, plus 20 <italic>Normal-like</italic> samples, as to ensure a good balance of BC subtypes in the learning phase, while keeping out a reasonable number of samples for testing. <italic>Normal-like</italic> class should incorporate only samples from grossly uninvolved tissue and is not widely recognized as prognostically relevant<sup><xref ref-type="bibr" rid="CR6">6</xref></sup> nor used in ROR models<sup><xref ref-type="bibr" rid="CR15">15</xref>, <xref ref-type="bibr" rid="CR16">16</xref></sup>; thus, adding 20 of 25 samples in the training set was not aimed at recognizing this class, but rather at trying to strengthen the ability of the trained classifiers to distinguish other BC intrinsic subtypes from it. Moreover, comparing our classifiers based on whether and which and how many samples were classified as <italic>Normal-like</italic>, allowed us to better assess their subtyping capabilities after proper training. The <italic>GSE96058</italic> dataset was split in a training set of 1,639 samples and a test set with the 1,634 remaining samples. The training set in this case respected the same subtype proportion of the entire dataset (Supplementary Material Figure <xref rid="MOESM1" ref-type="media">S13</xref>), considering its large size and realistic balance.</p>
      <sec id="Sec9">
        <title>Survey and selection of the most suitable machine learning algorithm</title>
        <p id="Par16">The following multiclass classifiers were assessed: (1) <italic>Decision Forest</italic>; (2) <italic>Decision Jungle</italic>; (3) <italic>Logistic Regression</italic> (LR); (4) <italic>Feed-Forward Neural Network</italic> (FFNN); (5) <italic>Support Vector Machines</italic> (SVMs). All the mentioned learners were trained in Azure Machine Learning Studio with known <inline-formula id="IEq8"><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${&lt;}{\hbox {sample, subtype}}{&gt;}$$\end{document}</tex-math><mml:math id="M16"><mml:mrow><mml:mo>&lt;</mml:mo><mml:mrow><mml:mtext>sample, subtype</mml:mtext></mml:mrow><mml:mo>&gt;</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41598_2020_70832_Article_IEq8.gif"/></alternatives></inline-formula> pairs coming from the training set and had as feature space the entire set of 19,737 genes profiled for the <italic>TCGA</italic> dataset. Indeed, estimating their performances with this huge and noisy feature space offered useful insights about the suitability of each learner in achieving the subtyping task, provided that too strong incidences of overfitting and curse of dimensionality were mitigated by the embedded feature selection approaches, already owned by, or added to, each classifier under evaluation.</p>
        <p id="Par17">Training was done with the adoption of tenfold stratified cross-validation and hyperparameter grid search to perform model selection, i.e., to set properly, with respect to the final task, all the tunable hyperparameters of each supervised model. Thus, for all ML methods under study, we found best-trained models, i.e., models whose hyperparameter setting and learned parameters led to the best generalization accuracy, estimated through cross-validation. As we can see in Fig. <xref rid="Fig4" ref-type="fig">4</xref>, on the left, the results of the ML survey on <italic>TCGA</italic> data indicated a simple regularized multiclass Logistic Regression (mLR) as the most promising method to distinguish intrinsic subtypes. It can set differentially the parameters that directly weigh each gene in each subtype class, while providing at the same time parameter shrinkage to deal with the high dimensionality of RNA-seq data and prevent overfitting. Hence, it has also some points of contact with the nearest shrunken centroid technique, already successfully adopted for the intrinsic subtyping task. Its generalization accuracy of 88%, estimated with cross-validation, was the highest one among all the best-trained learners, even if also the Decision Jungle behaved well, with cross-validation accuracies of 86%.</p>
        <p id="Par18">However, the strength of cross-validation and hyperparameter sweeping was not simply improving the chance of finding the most accurate model for our specific task, but also giving insights of how representative the overall dataset is and how sensitive each model could be to variations in training data or hyperparameter settings. In this context, cross-validation accuracies on different folds were all quite near for the mLR, despite training subset changes and even for several hyperparameter settings, showing the highest robustness among all the assessed classifiers (Supplementary Material Table <xref rid="MOESM1" ref-type="media">S4</xref>). Moreover, best-trained mLR (with unitary Lasso L1, Ridge L2 hyperparameters) confirmed its primacy also on the unseen samples of the <italic>TCGA</italic> test set, where its accuracy (85%) overcame the ones of all the other best-trained models (Supplementary Material Figures <xref rid="MOESM1" ref-type="media">S17</xref>–<xref rid="MOESM1" ref-type="media">S21</xref>). Please refer to Section S5 of the Supplementary Material for further details.</p>
        <p id="Par19">The performances of the regularized mLR were assessed also on the FPKM profiles of the <italic>GSE96058</italic> dataset. We carried out training and test phases as done for the RSEM profiles. The best-trained mLR (L1 = 1; L2 = 0.1) reached even higher accuracies both on cross-validation and on the unseen samples of the <italic>GSE96058</italic> test set (around 89%), confirming the suitability of this regularized classifier also for the BC subtyping of FPKM expression data (see Supplementary Material Figure <xref rid="MOESM1" ref-type="media">S32</xref> and Table <xref rid="MOESM1" ref-type="media">S6</xref>).<fig id="Fig4"><label>Figure 4</label><caption><p>Machine learning survey: classifiers tuned and trained on the <italic>TCGA</italic> training set with tenfold cross-validation and tested on the unseen samples of the test set (left). Feature selection (right): comparison of each class recall on the <italic>TCGA</italic> test set for the mLRs trained on the complete gene set, on the four filter-based spaces and on the limma50 and limma50_BWE gene signatures. <italic>Normal-like</italic> class is excluded from the graph due to the trifling number of samples (only 5) in the <italic>TCGA</italic> test set.</p></caption><graphic xlink:href="41598_2020_70832_Fig4_HTML" id="MO4"/></fig></p>
      </sec>
      <sec id="Sec10">
        <title>Feature selection study to improve breast cancer classifier performances</title>
        <p id="Par20">First, as obvious choice, we used the PAM50 gene panel to train mLR models respectively on <italic>TCGA</italic> and <italic>GSE96058</italic> data, as to be able to compare both in cross-validation and testing all the results of our feature selection study with the benchmark performances of the same learner when considering only the genes involved in the original PAM50 method. Such benchmarks are reported in Table <xref rid="Tab1" ref-type="table">1</xref>, together with the results collected with our <italic>AWCA</italic>-based version of the real PAM50 classification, to be compared with the performances reached by the mLRs, when considering several feature spaces of interest.</p>
        <p id="Par21">Regularized mLRs trained on the whole gene sets assigned non-null weights to nearly 1,000 genes, both in <italic>TCGA</italic> and <italic>GSE96058</italic> datasets. Since their accuracies, respectively of 85–89% could be potentially increased tackling the curse of dimensionality, we evaluated if independent feature selection strategies combined with the embedded regularizers could improve mLR results. Particularly, all the adopted feature selection methods simply reduced the original whole feature space to wide relevant gene signatures, and were assessed primarily on <italic>TCGA</italic> data, as RSEM measures are easily comparable across cohorts<sup><xref ref-type="bibr" rid="CR21">21</xref></sup>, while FPKM are not suitable for differentially expressed genes (DEG) analysis.</p>
        <p id="Par22">Initially, we considered external strategies, not involving the learner in the feature selection. We used four filter methods to remove genes supposed not to be meaningful for our subtyping task, based on the next scoring metrics: (1) Fisher scores; (2) Mutual Information; (3) Chi-squared scores; (4) Spearman Correlations. Implementation details are in Supplementary Material Section <xref rid="MOESM1" ref-type="media">S5.4.2</xref>. We obtained four rankings, each one scoring all the 19,737 genes according to a given metric. For analogy with the previous embedded feature selection, we considered the top 1,000 genes of a scoring metric as a feature space, and we tuned and trained four regularized mLRs, as formerly described. The so-obtained four best-trained models had 89–90% of cross-validation accuracies; tested on <italic>TCGA</italic> test set they reached slightly increased accuracies (86–87%) with respect to those of the mLR (85%) having a 19,737-gene space (Supplementary Material Table <xref rid="MOESM1" ref-type="media">S5</xref>). We also carefully evaluated confusion matrices, precisions, recalls and switch cases among classes, to consider not only the quantity of discordantly classified cases (all quite comparable), but rather the balanced accuracies (or macro-average recalls) and the type of switches. Chi-square based filter appeared the most valuable since the mLR trained on its top 1,000 genes improved mainly the accuracy of the <italic>Her2-Enrichded</italic> class (93%), compared to mLRs using the other filters (84.5% <inline-formula id="IEq9"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$+/-$$\end{document}</tex-math><mml:math id="M18"><mml:mrow><mml:mo>+</mml:mo><mml:mo stretchy="false">/</mml:mo><mml:mo>-</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41598_2020_70832_Article_IEq9.gif"/></alternatives></inline-formula>3.16) (see Fig. <xref rid="Fig4" ref-type="fig">4</xref> and Supplementary Material Figures <xref rid="MOESM1" ref-type="media">S22-23</xref> and Table <xref rid="MOESM1" ref-type="media">S5</xref>).</p>
        <p id="Par23">As alternative external feature selection strategy, we used a DEG-based approach. We analyzed the original feature space of 19,737 genes using limma<sup><xref ref-type="bibr" rid="CR25">25</xref></sup>, an R package for the analysis of gene expression data whose core capability is the use of linear models to assess differential expression in multifactor designed experiments. We made differential analyses on the 10 pairwise contrasts between the 5 subtypes; we obtained 10 gene lists, each one including all the genes differentially expressed in a pairwise contrast. Then, given an integer value N, through the union of the top N genes (or of all genes if less than N) from each of the 10 lists, we obtained a set called limmaN, whose genes are all relevant to distinguish at least a couple of subtypes. We tuned and trained again regularized mLRs on limmaN feature spaces obtained for 11 different N values, ranging from 10 to 1,000. The so-trained models reached cross-validation accuracies within 89–95% and accuracies within 84–88% on the <italic>TCGA</italic> test set; best ones are more accurate in cross-validation, and in line in testing, compared to the models trained on the filter-based feature spaces and on the PAM50 panel (Supplementary Material Table <xref rid="MOESM1" ref-type="media">S5</xref>). Particularly, limma50 was worthy of further investigations, because the mLR considering its 277 genes as feature space reached the best overall accuracy (88%) on the <italic>TCGA</italic> test set and also the highest values for macro-averaged recall (m-aR, 0.94) and precision (m-aP, 0.70) (Supplementary Material Figures <xref rid="MOESM1" ref-type="media">S25-S26</xref>).</p>
        <p id="Par24">Aiming at further improving prediction performances of the regularized multiclass logistic regression with a combined strategy, we used limma50, top 200 and top 500 Chi-squared-based genes as starting feature spaces for running a wrapper method with sequential backward elimination (BWE). For each starting feature space, we carried out in parallel ten independent runs of backward elimination, performing each run with randomized feature order as to mitigate the bias introduced by the sequential gene scrolling, solvable only through an unfeasible exhaustive search. The algorithm iteratively discards one gene at a time until no more feature elimination improves the accuracy of the regularized mLR model beyond a fixed threshold of gain. Since kept genes in each run were not robust, also due to the needed feature shuffling, ultimately we combined all the genes kept in at least one run, with a downstream preservation strategy. The three gene signatures (210, 165, and 276 genes, respectively) preserved from the three corresponding starting feature spaces were then used as feature spaces for training and testing other regularized mLRs on the <italic>TCGA</italic> dataset (Supplementary Material Table <xref rid="MOESM1" ref-type="media">S5</xref>). High cross-validation accuracies of 93% and 94%, even higher than using PAM50 genes as features, were respectively obtained using as feature space limma50_BWE and top 500 Chi-squared_BWE. Yet, on testing, each of these models obtained with backward eliminations behaved similarly to the model trained on the corresponding starting feature space. The case of limma50 compared with limma50_BWE clearly appears in Fig. <xref rid="Fig4" ref-type="fig">4</xref>, where the accuracy (or recall) of each class due to these two DEG-based signatures are compared with the ones obtained with filter-based approaches.</p>
        <p id="Par25">Hence, limma50 and its further-reduced version limma50_BWE brougth on the <italic>TCGA</italic> cross-validation and testing results in line with our benchmark, i.e., the mLR trained on PAM50 genes (see Table <xref rid="Tab1" ref-type="table">1</xref> and Supplementary Material Table <xref rid="MOESM1" ref-type="media">S5</xref>); consequently, they were used to evaluate the suitability and possible improvements in the subtyping task also for FPKM gene expression values. Two regularized mLRs were trained on the <italic>GSE96058</italic> training set and then tested on the test samples of the same <italic>GSE96058</italic> dataset considering each of these two signatures as feature spaces of interest (excluding only the DRAIC gene, since it was unavailable within the <italic>GSE96058</italic> and <italic>GSE81538</italic> profiled genes). Both best-trained models overcame the performances of the model having all the 30865 sequenced genes as feature space, reaching 90% of cross-validation accuracies and 91% of accuracy over the <italic>GSE96058</italic> test set (Supplementary Material Table <xref rid="MOESM1" ref-type="media">S6</xref>) although their performances were slightly less than the corresponding benchmark, as shown in Table <xref rid="Tab1" ref-type="table">1</xref>.<table-wrap id="Tab1"><label>Table 1</label><caption><p>Accuracies reached with several intrinsic subtyping methods.</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Subtyping method</th><th align="left">Feature space of interest</th><th align="left">TCGA <italic>cross-validation</italic> (%)</th><th align="left">TCGA <italic>test set</italic> (%)</th><th align="left">GSE96058 <italic>cross-validation</italic> (%)</th><th align="left">GSE96058 <italic>test set</italic> (%)</th></tr></thead><tbody><tr><td align="left">PAM50*</td><td align="left">PAM50 panel</td><td align="left">–</td><td align="left">92</td><td align="left">–</td><td align="left">95</td></tr><tr><td align="left">mLR</td><td align="left">PAM50 panel</td><td align="left">92</td><td align="left">89</td><td align="left">93</td><td align="left">93</td></tr><tr><td align="left">mLR</td><td align="left">All profiled genes</td><td align="left">88</td><td align="left">85</td><td align="left">88</td><td align="left">89</td></tr><tr><td align="left">mLR</td><td align="left">limma50</td><td align="left">92</td><td align="left">88</td><td align="left">90</td><td align="left">91</td></tr><tr><td align="left">mLR</td><td align="left">limma50_BWE</td><td align="left">93</td><td align="left">87</td><td align="left">90</td><td align="left">91</td></tr></tbody></table><table-wrap-foot><p>* PAM50 applied on test sets only, using precomputed AWCA references.</p></table-wrap-foot></table-wrap></p>
      </sec>
      <sec id="Sec11">
        <title>External testing of the logistic regression models</title>
        <p id="Par26">To assess performances on wholly unseen different RNA-seq data subject to the same summarization/normalization, the most accurate mLRs developed for RSEM and FPKM profiles were used to classify respectively <italic>PanCA</italic> and <italic>GSE81538</italic> datasets; all subtyping results are available in Supplementary Material Figures <xref rid="MOESM1" ref-type="media">S29</xref>–<xref rid="MOESM1" ref-type="media">S31</xref>, <xref rid="MOESM1" ref-type="media">S34</xref>–<xref rid="MOESM1" ref-type="media">S36</xref>, and here summarized in Table <xref rid="Tab2" ref-type="table">2</xref>, where we reported also the concordances with the corresponding AWCA-PAM50 subtypings, based on precomputed references.</p>
        <p id="Par27">Specifically, the models trained on the <italic>TCGA</italic> training set using PAM50, limma50 and limma50_BWE as feature spaces were applied on <italic>PanCA</italic> samples. The found accuracies were nearly the same as the ones obtained on the <italic>TCGA</italic> test set (90%, 88%, 87%, respectively), while the macro-averaged recalls (m-aR) were 0.90 for both limma-based models and 0.88 for the PAM50-based mLR, which showed a lower balanced accuracy on <italic>PanCA</italic> (Supplementary Material Figures <xref rid="MOESM1" ref-type="media">S29</xref>–<xref rid="MOESM1" ref-type="media">S31</xref>). Precisions of the <italic>Her2-Enriched</italic> class (the weaker class in testing for all trained models—see Supplementary Material Section <xref rid="MOESM1" ref-type="media">S6</xref>, Figure <xref rid="MOESM1" ref-type="media">S28</xref>) eventually increased on <italic>PanCA</italic>, and macro-averaged precisions significantly improved in their turn (m-aP: 0.84, 0.84, 0.83). The same analysis was performed for the models trained on the <italic>GSE96058</italic> training set with PAM50, limma50 and limma50_BWE as feature spaces, and then applied to the <italic>GSE81538</italic> dataset (excluding unavailable genes). For both latter cases, accuracies were just below 90% and all performance metrics (m-aR: both 0.85, m-aP: 0.88 and 0.87) reached slightly lower values than the ones found with corresponding intra-dataset testing on the <italic>GSE96058</italic> test set.</p>
        <p id="Par28">Although the mLR using PAM50 genes reached again higher accuracy, the two limma50-based results, collected for FPKM values, are noteworthy considering that both intra-dataset and external testing dealt with gene expression data different from the RSEM ones employed in the feature selection phase. Furthermore, all the four mLRs computed using limma50 and limma50_BWE genes, and distinctly thought for RSEM and FPKM expression data, reached on testing high concordances with the corresponding AWCA-PAM50 subtypings, even higher than the accuracy with respect to the published labels in the case of the <italic>PanCA</italic> dataset (Table <xref rid="Tab2" ref-type="table">2</xref>). Therefore, these mLRs are provided to classify external BC samples through the R code we make available at <ext-link ext-link-type="uri" xlink:href="https://github.com/DEIB-GECO/BC_Intrinsic_subtyping">https://github.com/DEIB-GECO/BC_Intrinsic_subtyping</ext-link>.<table-wrap id="Tab2"><label>Table 2</label><caption><p>Concordances with published calls (accuracies) or AWCA-based PAM50 calls for the main mLR classifiers.</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Training set</th><th align="left">Feature space of interest</th><th align="left">Intended for</th><th align="left">Accuracy on test set (%)</th><th align="left">AWCA-PAM50 concordance on test set (%)</th><th align="left">External test set</th><th align="left">Accuracy on external test set (%)</th><th align="left">AWCA-PAM50 concordance on external set (%)</th></tr></thead><tbody><tr><td align="left"><inline-formula id="IEq12"><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${TCGA}_{\textit{training}}$$\end{document}</tex-math><mml:math id="M20"><mml:msub><mml:mrow><mml:mi mathvariant="italic">TCGA</mml:mi></mml:mrow><mml:mi mathvariant="italic">training</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="41598_2020_70832_Article_IEq12.gif"/></alternatives></inline-formula></td><td align="left">PAM50</td><td align="left">RSEM</td><td align="left">89</td><td align="left">89</td><td align="left">PanCA</td><td align="left">90</td><td align="left">90</td></tr><tr><td align="left"><inline-formula id="IEq13"><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${TCGA}_{\textit{training}}$$\end{document}</tex-math><mml:math id="M22"><mml:msub><mml:mrow><mml:mi mathvariant="italic">TCGA</mml:mi></mml:mrow><mml:mi mathvariant="italic">training</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="41598_2020_70832_Article_IEq13.gif"/></alternatives></inline-formula></td><td align="left">limma50</td><td align="left">RSEM</td><td align="left">88</td><td align="left">87</td><td align="left">PanCA</td><td align="left">88</td><td align="left">90</td></tr><tr><td align="left"><inline-formula id="IEq14"><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${TCGA}_{\textit{training}}$$\end{document}</tex-math><mml:math id="M24"><mml:msub><mml:mrow><mml:mi mathvariant="italic">TCGA</mml:mi></mml:mrow><mml:mi mathvariant="italic">training</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="41598_2020_70832_Article_IEq14.gif"/></alternatives></inline-formula></td><td align="left">limma50_BWE</td><td align="left">RSEM</td><td align="left">87</td><td align="left">87</td><td align="left">PanCA</td><td align="left">87</td><td align="left">91</td></tr><tr><td align="left"><inline-formula id="IEq15"><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${GSE81538}_{\textit{training}}$$\end{document}</tex-math><mml:math id="M26"><mml:msub><mml:mrow><mml:mi>G</mml:mi><mml:mi>S</mml:mi><mml:mi>E</mml:mi><mml:mn>81538</mml:mn></mml:mrow><mml:mi mathvariant="italic">training</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="41598_2020_70832_Article_IEq15.gif"/></alternatives></inline-formula></td><td align="left">PAM50</td><td align="left">FPKM</td><td align="left">93</td><td align="left">92</td><td align="left">GSE81538</td><td align="left">92</td><td align="left">93</td></tr><tr><td align="left"><inline-formula id="IEq16"><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${GSE81538}_{\textit{training}}$$\end{document}</tex-math><mml:math id="M28"><mml:msub><mml:mrow><mml:mi>G</mml:mi><mml:mi>S</mml:mi><mml:mi>E</mml:mi><mml:mn>81538</mml:mn></mml:mrow><mml:mi mathvariant="italic">training</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="41598_2020_70832_Article_IEq16.gif"/></alternatives></inline-formula></td><td align="left">limma50</td><td align="left">FPKM</td><td align="left">91</td><td align="left">91</td><td align="left">GSE81538</td><td align="left">89</td><td align="left">89</td></tr><tr><td align="left"><inline-formula id="IEq17"><alternatives><tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${GSE81538}_{\textit{training}}$$\end{document}</tex-math><mml:math id="M30"><mml:msub><mml:mrow><mml:mi>G</mml:mi><mml:mi>S</mml:mi><mml:mi>E</mml:mi><mml:mn>81538</mml:mn></mml:mrow><mml:mi mathvariant="italic">training</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="41598_2020_70832_Article_IEq17.gif"/></alternatives></inline-formula></td><td align="left">limma50_BWE</td><td align="left">FPKM</td><td align="left">91</td><td align="left">91</td><td align="left">GSE81538</td><td align="left">89</td><td align="left">89</td></tr></tbody></table></table-wrap></p>
      </sec>
    </sec>
    <sec id="Sec12">
      <title>Robustness and prognostic ability of single-sample classifiers</title>
      <p id="Par29">The mLRs trained on different relevant feature spaces reached progressively increasing values for recalls and precisions of all classes (Supplementary Material Figures <xref rid="MOESM1" ref-type="media">S27</xref> and <xref rid="MOESM1" ref-type="media">S28</xref>), though accuracies experienced on internal/external testing did not improve beyond 90% on average, due to the saturation of concordances between mLRs and published calls, occurring also when using PAM50 genes as feature space. However, concordances with target labels can only partially evaluate mLR classifications, since published subtypes are not a gold standard but rather a touchstone to compare performances of the mLR approaches both among them and with the other robust single-sample classifier here proposed, i.e., the AWCA-based PAM50 method with predefined references. Indeed, while in comparing mLR results to the target PAM50 calls Cohen’s kappa agreements were slightly lower than 0.8, the main mLR-based classifications reached valuable pairwise statistic agreements between them, showing Cohen’s kappa values beyond 0.9 for most of the cases (up to 0.925<inline-formula id="IEq18"><alternatives><tex-math id="M31">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$+/-$$\end{document}</tex-math><mml:math id="M32"><mml:mrow><mml:mo>+</mml:mo><mml:mo stretchy="false">/</mml:mo><mml:mo>-</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41598_2020_70832_Article_IEq18.gif"/></alternatives></inline-formula>0.03 for top1000 Chi-squared and DEG-based feature spaces). Additionally, the mean concordance observed among our three best mLR models (mLR-PAM50, mLR-limma50 and mLR-limma50_BWE) was high (94%<inline-formula id="IEq19"><alternatives><tex-math id="M33">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$+/-$$\end{document}</tex-math><mml:math id="M34"><mml:mrow><mml:mo>+</mml:mo><mml:mo stretchy="false">/</mml:mo><mml:mo>-</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41598_2020_70832_Article_IEq19.gif"/></alternatives></inline-formula>4%), with limma-based approaches reaching almost perfect agreement and average concordance over 92% with mLR-PAM50. This demonstrates stability of the mLR classifications regardless of the used feature space, provided that it is meaningful with respect to the purpose of BC subtyping. Intriguingly, when we directly compared our best mLR-based classifications with the single-sample AWCA-based PAM50 subtyping, we found the same mean concordance (90% <inline-formula id="IEq20"><alternatives><tex-math id="M35">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$+/-$$\end{document}</tex-math><mml:math id="M36"><mml:mrow><mml:mo>+</mml:mo><mml:mo stretchy="false">/</mml:mo><mml:mo>-</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41598_2020_70832_Article_IEq20.gif"/></alternatives></inline-formula>2%) experienced with the published PAM50 calls. Furthermore and most importantly, focusing on the disagreements with published subtypes, we found several cases of full concordance among the mLR and AWCA-based PAM50 methods (mainly involving published Normal-like versus Luminal A, or published Luminal A versus Luminal B subtypes); these suggest robustness of the mLR classifiers in calling ambiguous cases, despite their training with published labels.</p>
      <p id="Par30">Additionally, we carefully examined subtype calls assigned with all the single-sample approaches under investigation, including also further classifications obtained with the AIMS method by Paquet et al.<sup><xref ref-type="bibr" rid="CR12">12</xref></sup>. Both on internal and external test sets, we noticed ambiguous samples for all the approaches, confirming the already mentioned degree of ambiguity of intrinsic subtyping. This affects also supervised subtype labels and, in fact, it is partially inherited by mLR classifiers. However, all here proposed methods overcome the AIMS classifications (Supplementary Material Table <xref rid="MOESM1" ref-type="media">S11</xref>), since its mean concordances with the others single-sample approaches (77%<inline-formula id="IEq21"><alternatives><tex-math id="M37">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$+/-$$\end{document}</tex-math><mml:math id="M38"><mml:mrow><mml:mo>+</mml:mo><mml:mo stretchy="false">/</mml:mo><mml:mo>-</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41598_2020_70832_Article_IEq21.gif"/></alternatives></inline-formula>4% with AWCA-based one, 79%<inline-formula id="IEq22"><alternatives><tex-math id="M39">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$+/-$$\end{document}</tex-math><mml:math id="M40"><mml:mrow><mml:mo>+</mml:mo><mml:mo stretchy="false">/</mml:mo><mml:mo>-</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41598_2020_70832_Article_IEq22.gif"/></alternatives></inline-formula>4% with mLR ones) and with the published classifications (77%<inline-formula id="IEq23"><alternatives><tex-math id="M41">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$+/-$$\end{document}</tex-math><mml:math id="M42"><mml:mrow><mml:mo>+</mml:mo><mml:mo stretchy="false">/</mml:mo><mml:mo>-</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41598_2020_70832_Article_IEq23.gif"/></alternatives></inline-formula>1%) appeared sub-optimal, also beyond the common criticism of ambiguity.</p>
      <p id="Par31">Eventually, we focused on capturing the prognostic potential of our single-sample approaches by comparing 10-year overall survival annotations with the expected clinical outcomes based on the subtype calls. We performed this analysis on <italic>TCGA</italic> and <italic>PanCA</italic> test sets, where sufficient amounts of cases with different 10-year overall survival status were available. Specifically, we considered that each discordance between Luminal A and another subtype implies a different expected prognosis, since Luminal A is well recognized to have the lowest rate of recurrence and the best long-term prognosis<sup><xref ref-type="bibr" rid="CR26">26</xref></sup>. Consequently, in such cases we evaluated whether the discordance improves or worsens the prognostic prediction. First, we focused on the subtype calls discordant with the published ones, and we noticed that both AWCA-based and mLR-based subtypings appeared more reliable in recognizing subtypes with good/poor overall survival prognosis within 10 years, showing an increased prognostic value over standard PAM50 classifications (Supplementary Material Figure <xref rid="MOESM1" ref-type="media">S37</xref>). Furthermore, we evaluated pairwise discordances between the AWCA-based PAM50 method and each mLR approach; despite only very few cases were available, mLR subtypings seem to slightly improve the prognostic prediction (Supplementary Material Figure <xref rid="MOESM1" ref-type="media">S38</xref>).</p>
    </sec>
  </sec>
  <sec id="Sec13">
    <title>Discussion</title>
    <p id="Par32">Identification of BC intrinsic subtypes by the PAM50 classifier<sup><xref ref-type="bibr" rid="CR15">15</xref></sup> has set a cornerstone in cancer genomics and transcriptomics, allowing to link unsupervised, clustering-based class discovery to biological insight and clinically relevant stratification. However, the PAM50 classifier is typically based on centering gene expression values against a reference sample arbitrarily built from the dataset under study; thus, dataset composition and choices for reference construction affect subsequent subtype calling, as we here clearly proved. This limits robustness and reproducibility of the classification, as shown in the present work for RNA-seq data. Hence, as first major achievement of our work, we propose an innovative procedure for reference construction, named <italic>AWCA</italic>, robust to the initial sample selection and improving PAM50 reproducibility, reaching high concordance and stability in classification. The concordance achieved by <italic>AWCA</italic>-based classifications among them is beyond 98%, remarkably improving the stability of some ambiguous samples, i.e., poorly or comparably correlated to more than one class centroid. Moreover, the <italic>AWCA</italic> strategy allows constructing predefined external references (Supplementary Material Table <xref rid="MOESM1" ref-type="media">S3</xref>) that can be used to classify independent RNA-seq profiles. PAM50 classification of independent sets with external references reached again over 90% of concordance with the published subtypes and over 94% with inner AWCA-based classifications, suggesting the chance of building and setting universal references to increase portability and reliability of the PAM50 subtyping, thus solving its reproducibility issue. However, for single-sample AWCA-based PAM50 subtyping we strongly encourage to employ an AWCA reference subjected to the same normalization procedure of the used expression data, as not to undermine the gain of robustness provided by the approach. Conversely, internal AWCA references can be built on any expression data, even from other technical platforms, as we successfully experienced with microarray data from Affymetrix. Indeed, AWCA-based classifications on Affymetrix log2-transformed data from the GEO dataset GSE4922 improved subtyping stability, with over 96% of mean concordance compared with 88% for corresponding standard PAM50 evaluations. Additionally, we used a so-obtained AWCA reference also as external reference for singe-sample AWCA-PAM50 classification of another Affymetrix dataset (GSE1456), for which PAM50 labels were provided, but no information about the ER status was available to repeat classification or allow internal AWCA-based PAM50 classification; we found subtype calls remarkably more reliable in recognizing samples with good or poor prognoses at medium-long term (see Supplementary Material <xref rid="MOESM1" ref-type="media">Appendix</xref>). This confirms the subtyping robustness and the key prognostic ability of the here proposed AWCA-PAM50 approach, regardless of the technology used to provide gene expression data.</p>
    <p id="Par33">However, intrinsic subtypes are intrinsically linked both to the molecular traits and to the expression levels of other genes than just the PAM50 panel and are recognized for their prognostic value, also regardless of the PAM50 approach, though it is the most widely method used to recognize them. Thus, exploiting iteratively and also in parallel several classifiers should strengthen the reliability of the subtyping, as in the case of boosting strategies combining weak learners. In this view, we performed also a ML survey considering other classifiers and gene signatures than PAM50, trained supervisely to recognize BC subtypes. A multiclass Logistic Regression appeared the most effective and robust in performing this task, particularly when a feature selection able to provide a feature space of relevant genes is combined with embedded Lasso and Ridge regularizers. Moving beyond PAM50 genes, from our feature selection study we traced two additional promising DEG-based gene signatures, limma50 and limma50_BWE (this latter one from a further backward elimination strategy), including genes meaningfully involved in discriminative patterns between classes and only to a limited extent overlapping with the PAM50 panel (Supplementary Material Table <xref rid="MOESM1" ref-type="media">S7</xref>).</p>
    <p id="Par34">Our best mLR classifiers reached high accuracy in cross-validation, and valuable performances on internal and external testing, both considering concordances with target labels and with AWCA-based calls (Table <xref rid="Tab2" ref-type="table">2</xref>). Furthermore, on the limma50_BWE feature space both the RSEM and FPKM-based mLRs got almost the same results as on the limma50 feature space, showing classification robustness also in case of a more compact gene set (210 vs. 277 genes). Although limma-derived signatures brought less convincing performances on testing than using mLR on PAM50 genes, or the <italic>AWCA</italic>-based PAM50 method (see PAM50<inline-formula id="IEq24"><alternatives><tex-math id="M43">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$^{\mathrm{a}}$$\end{document}</tex-math><mml:math id="M44"><mml:msup><mml:mrow/><mml:mi mathvariant="normal">a</mml:mi></mml:msup></mml:math><inline-graphic xlink:href="41598_2020_70832_Article_IEq24.gif"/></alternatives></inline-formula> in Table <xref rid="Tab1" ref-type="table">1</xref>), it would be overly simplistic to underestimate their interesting results (Table <xref rid="Tab1" ref-type="table">1</xref>) and Supplementary Material Table <xref rid="MOESM1" ref-type="media">S8</xref>). Indeed: (1) the higher accuracies reached with mLRs using PAM50 genes or with the <italic>AWCA</italic>-PAM50 method are biased by the nature of the published subtype calls, obtained in their turn from the PAM50 assay, using the same gene panel; (2) overall performances of any approach are also influenced by the mentioned ambiguity in subtype calling that possibly affects samples with mixed traits; (3) degradation is caused also by the <italic>Normal-like</italic> class, whose clinical significance remains undetermined<sup><xref ref-type="bibr" rid="CR6">6</xref></sup>, and that could be excluded from a refined version of the intrinsic subtyping approach, as in PAM50-based Prosigna test<sup><xref ref-type="bibr" rid="CR16">16</xref></sup>; (4) the few amounts of training samples and the vast number of features influence subtyping capabilities, mainly for the cases most difficult to recognize. Nonetheless, mLR classifications resulted robust also when varying the feature space under consideration, showing high agreement of the classifications compared both with each others (94%<inline-formula id="IEq25"><alternatives><tex-math id="M45">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$+/-$$\end{document}</tex-math><mml:math id="M46"><mml:mrow><mml:mo>+</mml:mo><mml:mo stretchy="false">/</mml:mo><mml:mo>-</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41598_2020_70832_Article_IEq25.gif"/></alternatives></inline-formula>4%) and with the AWCA-based PAM50 calls (90%+/2%), especially in cases of discordances with the published calls used for training. Particularly, such agreement found with AWCA-based PAM50 subtyping suggests that mLR approaches, being provided with regularizations to better generalize on independent samples, can in part overcome the flaws of a still limited training set that includes also some incorrect labels for ambiguous samples; thus, the more samples with robust subtype calls will be available, as the ones from AWCA-based PAM50 classifications, the more mLR approaches will certainly improve. Furthermore, mLR approaches can also provide a sample with membership values to each subtype, which could be used in predictive models for clinical outcome or risk of recurrence, as in the case of correlations to each subtype centroid for the already existing ROR models of PAM50 and Prosigna assay. Yet, wide cohorts, well-annotated in terms of relapse events and robust subtype labels, are needed to enhance a preliminary study that gave us encouraging outcomes.</p>
    <p id="Par35">Eventually, all the collected results confirm the suitability and the room for improvement of the mLR as transcriptional classifier to recognize BC subtypes. As experienced for limma50 and limma50_BWE feature spaces, mLR can indeed improve its performances in intrinsic subtyping by exploiting relevantly discriminative parts of the genome-wide information brought by RNA-sequencing, other than the PAM50 panel and despite the inherent bias introduced by the PAM50-based labels, here used to training supervisely and testing. Furthermore, all mLR approaches showed an improved prognostic ability with respect to standard PAM50 calls and further studies could effectively convert their predictive value in reliable clinical outcome estimators.</p>
    <p id="Par36">Thus, in conclusion, the main contribution of this paper is twofold: <list list-type="order"><list-item><p id="Par37">Propose the <italic>AWCA</italic> reference construction approach to face the proved issues of the standard PAM50 algorithm;</p></list-item><list-item><p id="Par38">Define RNA-seq-based classification approaches to perform single-sample BC intrinsic subtyping with external-AWCA-based PAM50 or regularized mLR methods.</p></list-item></list>These strategies appeared valuable to favor the use of RNA-seq in BC clinical practice and are worthy of other studies on heterogeneous RNA-seq data, to evaluate and strengthen the reliability of their intrinsic subtyping methods.</p>
  </sec>
  <sec id="Sec14">
    <title>Methods</title>
    <sec id="Sec15">
      <title>Samples and clinical data</title>
      <p id="Par39">Despite BC is one of the cancers with more genomic data available, only a small fraction of public BC RNA-seq data are annotated with PAM50 labels; we used the four of such RNA-seq datasets we could find. The first dataset is part of the Breast Invasive Carcinoma project of The Cancer Genome Atlas (<italic>TCGA</italic>), used within the work of Ciriello et al.<sup><xref ref-type="bibr" rid="CR9">9</xref></sup> and includes 817 mRNA-seq Version2 RSEM<sup><xref ref-type="bibr" rid="CR21">21</xref></sup> profiles (<ext-link ext-link-type="uri" xlink:href="http://cbio.mskcc.org/cancergenomics/TCGA/brca_TCGA/">http://cbio.mskcc.org/cancergenomics/TCGA/brca_TCGA/</ext-link>). The second dataset, collected under GEO dataset accession number <italic>GSE96058</italic>, includes 3,273 BC RNA-seq FPKM<sup><xref ref-type="bibr" rid="CR22">22</xref></sup>profiles from the Multicenter Sweden Cancerome Analysis Network-Breast Initiative<sup><xref ref-type="bibr" rid="CR10">10</xref></sup> (<ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE96058">https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE96058</ext-link>). Eventually, we used two additional public datasets to yield a final evaluation of the studied approaches on external data. The first one, called <italic>PanCA</italic> dataset, includes 236 BC samples selected from Pan Cancer Atlas and treated with RSEM pipeline (<ext-link ext-link-type="uri" xlink:href="https://www.cbioportal.org/study/summary?id=brca_TCGA_pan_can_atlas_2018">https://www.cbioportal.org/study/summary?id=brca_TCGA_pan_can_atlas_2018</ext-link>). The second one is a GEO dataset, indicated as <italic>GSE81538</italic> dataset (<ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE81538">https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE81538</ext-link>), and contains 405 BC samples, subject to FPKM normalization. All used expression data were log2-transformed. Further details are in Supplementary Section <xref rid="MOESM1" ref-type="media">S1</xref>.</p>
    </sec>
    <sec id="Sec16">
      <title>Original PAM50 method and Prosigna test</title>
      <p id="Par40">The original PAM50 method<sup><xref ref-type="bibr" rid="CR15">15</xref></sup> was developed as a shrunken centroid-based algorithm<sup><xref ref-type="bibr" rid="CR27">27</xref></sup> for Prediction Analysis of Microarrays (<ext-link ext-link-type="uri" xlink:href="http://statweb.stanford.edu/%7etibs/PAM/">http://statweb.stanford.edu/~tibs/PAM/</ext-link>), focused on 50 genes, known as PAM50 panel. During its training, class centroids were differentially shrunken, identifying subsets of genes that best characterize and contribute to recognizing each intrinsic subtype. We used these centroids, built by Parker et al.<sup><xref ref-type="bibr" rid="CR15">15</xref></sup> (Supplementary Material Table <xref rid="MOESM1" ref-type="media">S2</xref>), to replicate the PAM50 algorithm. As required by the PAM50 assay, for each BC sample under exam, the 50-gene expression values were normalized against a calculated reference sample; we compared multiple choices of cohorts and strategies for reference construction. Each time, the nearest centroid rule, with Spearman correlation as similarity metric, was used to assign one of the five mentioned subtypes to each sample. Furthermore, the Cox regression model developed by Parker et al.<sup><xref ref-type="bibr" rid="CR15">15</xref></sup> was used to estimate the patient’s risk of recurrence score, as a weighted sum of Spearman correlations with subtype centroids and tumor size parameter (ROR-C).</p>
      <p id="Par41">The Prosigna test is a PAM50-based genetic assay used to define a category of metastatic risk at 10 years in hormone receptor-positive women undergoing surgery for invasive BRCA<sup><xref ref-type="bibr" rid="CR16">16</xref></sup>. It focuses on a gene subset of the PAM50 panel called NANO46, and provides both the BC intrinsic subtype and the category of risk of a patient, derived from the estimated risk of recurrence (ROR) score and differentiated also based on lymph node involvement. Both classification and ROR models were independently trained and tested over NanoString profiles, obtained from the proprietary NanoString nCounter platform. Hence, the prognostic assay uses: (1) a normalization pipeline specifically designed for its proprietary technology and a reference included in the Prosigna kit, and consisting of in-vitro transcribed RNA-targets, to be processed together with the sample under study; (2) a Pearson correlation-based Nearest Shrunken Centroid classifier, which excludes the Normal-like class; (3) a proprietary model for ROR score estimation. Here, we used Prosigna centroids and algorithms to assign each sample under study with a corresponding subtype call and ROR score, after normalization against a calculated reference sample.</p>
    </sec>
    <sec id="Sec17">
      <title>Machine learning techniques for breast cancer classification</title>
      <p id="Par42">We performed a machine learning survey, tracing some previous studies<sup><xref ref-type="bibr" rid="CR28">28</xref>–<xref ref-type="bibr" rid="CR32">32</xref></sup> for cancer prediction and BC stratification. Accordingly, we assessed several classifiers and embedded regularizations, up to find the most promising approach for the BC intrinsic subtyping task. Specifically, we considered the following techniques, briefly described in Supplementary Material Section <xref rid="MOESM1" ref-type="media">S5.2</xref>: (1) Multiclass <italic>Decision Forest</italic> as ensemble method with bagging; (2) Multiclass <italic>Decision Jungle</italic> as alternative ensemble method, using directed acyclic graphs (DAGs) instead of trees; (3) Multiclass <italic>Logistic Regression</italic> with both Lasso and Ridge regularizations; (4) Fully connected <italic>Feed-Forward Neural Network</italic> with Ridge regularization, min-max input scaling and sigmoidal outputs; and (5) <italic>Support Vector Machines</italic> with Lasso regularization and One-versus-All approach.</p>
      <p id="Par43">In addition to the mentioned regularizers, we explored further feature selection techniques to handle the high-dimensionality of RNA-seq profiles, facing the curse of dimensionality and the overfitting risk without losing the gene expression interpretation of the maintained features. We evaluated alternatively some filter methods, a differentially expressed genes (DEG)-based approach, and a combined strategy involving a wrapper method. The aim of all these feature selection techniques was distinguishing the informative genes from the non-relevant ones, which behave as noise affecting data and whose removal usually increases or strengthens the predictive power of a classifier. In supervised tasks, filter methods are effective in computation time and robust to overfitting. They score and rank features with respect to the target to be predicted using a statistical measure; accordingly, each feature is either removed or kept in the feature space. The implemented DEG-based approach considers the statistical significance of gene expression variances within or between classes to trace relevant features according to discriminative patterns. Eventually, the applied combined strategy is focused on a wrapper method with sequential backward elimination as heuristic approach. Wrapper methods consider feature selection as a search problem: during the learning phase, different combinations of features are compared based on the cross-validation performances of the chosen model, up to finding a reduced set of relevant features. However, due to the prohibitive computational cost for high-dimensional spaces, we applied this strategy on some promising already reduced gene sets, rather than on all the profiled genes.</p>
      <p id="Par44">To asses alternative classifiers and feature selection techniques, we worked jointly on RStudio (<ext-link ext-link-type="uri" xlink:href="http://www.rstudio.com/">http://www.rstudio.com/</ext-link>) and Azure Machine Learning Studio (<ext-link ext-link-type="uri" xlink:href="https://studio.azureml.net/">https://studio.azureml.net/</ext-link>), an integrated development environment working on the Azure cloud service platform. For further implementation details, please refer to Section <xref rid="MOESM1" ref-type="media">S5</xref> of the Supplementary Material.</p>
    </sec>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary information</title>
    <sec id="Sec18">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="41598_2020_70832_MOESM1_ESM.pdf">
            <caption>
              <p>Supplementary Information.</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher's note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
    <fn>
      <p>These authors jointly supervised this work: Marco Masseroli and Enzo Medico.</p>
    </fn>
  </fn-group>
  <sec>
    <title>Supplementary information</title>
    <p>is available for this paper at 10.1038/s41598-020-70832-2.</p>
  </sec>
  <ack>
    <title>Acknowledgements</title>
    <p>This work was supported by the ERC Advanced Grant 693174 “Data-Driven Genomic Computing (GeCo)”, by “Associazione Italiana per la Ricerca sul Cancro”, MFAG n. 19047 and Ministero della Salute, GR-2016-02362726 to C.I, and by “Progetto di Rete ACC 2018”—RC 2019 from the Italian Ministry of Health and FPRC 5x1000, 2015 “Cancer-ImGen” from Fondazione Piemontese per la ricerca sul Cancro to E.M. Authors thank Dr. Ciriello, Dr. Gatza and Dr. Hoadley for their kind explanations.</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Author contributions</title>
    <p>E.M., M.M. and S.C. conceived and carried out the study. I.M. and C.I. contributed to the design of the study. S.C. performed the analysis and drafted the original manuscript. I.M. participated in the differential gene expression analysis. E.M. and M.M. supervised the study. S.C., M.M. and E.M. reviewed the manuscript. All Authors approved the manuscript.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Data availability</title>
    <p>The R code to generate AWCA references, to use AWCA-based PAM50 with precomputed external references and to use the mLR-based BC classifiers is available at <ext-link ext-link-type="uri" xlink:href="https://github.com/DEIB-GECO/BC_Intrinsic_subtyping">https://github.com/DEIB-GECO/BC_Intrinsic_subtyping</ext-link>.</p>
  </notes>
  <notes id="FPar2" notes-type="COI-statement">
    <title>Competing interests</title>
    <p id="Par48">The authors declare no competing interests.</p>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Perou</surname>
            <given-names>CM</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Molecular portraits of human breast tumours</article-title>
        <source>Nature</source>
        <year>2000</year>
        <volume>406</volume>
        <fpage>747</fpage>
        <lpage>752</lpage>
        <pub-id pub-id-type="doi">10.1038/35021093</pub-id>
        <?supplied-pmid 10963602?>
        <pub-id pub-id-type="pmid">10963602</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sørlie</surname>
            <given-names>T</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Repeated observation of breast tumor subtypes in independent gene expression data sets</article-title>
        <source>Proc. Natl. Acad. Sci. U.S.A.</source>
        <year>2003</year>
        <volume>100</volume>
        <fpage>8418</fpage>
        <lpage>8423</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.0932692100</pub-id>
        <?supplied-pmid 12829800?>
        <pub-id pub-id-type="pmid">12829800</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sørlie</surname>
            <given-names>T</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Gene expression patterns of breast carcinomas distinguish tumor subclasses with clinical implications</article-title>
        <source>Proc. Natl. Acad. Sci. U.S.A.</source>
        <year>2001</year>
        <volume>98</volume>
        <fpage>10869</fpage>
        <lpage>10874</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.191367098</pub-id>
        <?supplied-pmid 11553815?>
        <pub-id pub-id-type="pmid">11553815</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <collab>The-Cancer-Genome-Atlas-Network</collab>
          <etal/>
        </person-group>
        <article-title>Comprehensive molecular portraits of human breast tumours</article-title>
        <source>Nature</source>
        <year>2012</year>
        <volume>490</volume>
        <fpage>61</fpage>
        <pub-id pub-id-type="doi">10.1038/nature11412</pub-id>
        <pub-id pub-id-type="pmid">23000897</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Holm</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Assessment of breast cancer risk factors reveals subtype heterogeneity</article-title>
        <source>Cancer Res.</source>
        <year>2017</year>
        <volume>77</volume>
        <fpage>3708</fpage>
        <lpage>3717</lpage>
        <pub-id pub-id-type="doi">10.1158/0008-5472.CAN-16-2574</pub-id>
        <?supplied-pmid 28512241?>
        <pub-id pub-id-type="pmid">28512241</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yersal</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Barutca</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Biological subtypes of breast cancer: prognostic and therapeutic implications</article-title>
        <source>World J. Clin. Oncol.</source>
        <year>2014</year>
        <volume>5</volume>
        <fpage>412</fpage>
        <pub-id pub-id-type="doi">10.5306/wjco.v5.i3.412</pub-id>
        <?supplied-pmid 25114856?>
        <pub-id pub-id-type="pmid">25114856</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dai</surname>
            <given-names>X</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Breast cancer intrinsic subtype classification, clinical use and future trends</article-title>
        <source>Am. J. Cancer Res.</source>
        <year>2015</year>
        <volume>5</volume>
        <fpage>2929</fpage>
        <?supplied-pmid 26693050?>
        <pub-id pub-id-type="pmid">26693050</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Vieira</surname>
            <given-names>AF</given-names>
          </name>
          <name>
            <surname>Schmitt</surname>
            <given-names>F</given-names>
          </name>
        </person-group>
        <article-title>An update on breast cancer multigene prognostic tests - emergent Clinical biomarkers</article-title>
        <source>Front. Med.</source>
        <year>2018</year>
        <volume>5</volume>
        <fpage>248</fpage>
        <pub-id pub-id-type="doi">10.3389/fmed.2018.00248</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ciriello</surname>
            <given-names>G</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Comprehensive molecular portraits of invasive lobular breast cancer</article-title>
        <source>Cell</source>
        <year>2015</year>
        <volume>163</volume>
        <fpage>506</fpage>
        <lpage>519</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2015.09.033</pub-id>
        <?supplied-pmid 26451490?>
        <pub-id pub-id-type="pmid">26451490</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Brueffer</surname>
            <given-names>C</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Clinical value of RNA sequencing-based classifiers for prediction of the five conventional breast cancer biomarkers: a report from the population-based multicenter Sweden Cancerome analysis network—breast initiative</article-title>
        <source>JCO Precis. Oncol.</source>
        <year>2018</year>
        <volume>2</volume>
        <fpage>1</fpage>
        <lpage>18</lpage>
        <pub-id pub-id-type="pmid">30949620</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Vallon-Christersson</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Cross comparison and prognostic assessment of breast cancer multigene signatures in a large population-based contemporary clinical series</article-title>
        <source>Sci. Rep.</source>
        <year>2019</year>
        <volume>9</volume>
        <fpage>1</fpage>
        <lpage>16</lpage>
        <pub-id pub-id-type="doi">10.1038/s41598-019-48570-x</pub-id>
        <pub-id pub-id-type="pmid">30626917</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Paquet</surname>
            <given-names>ER</given-names>
          </name>
          <name>
            <surname>Hallett</surname>
            <given-names>MT</given-names>
          </name>
        </person-group>
        <article-title>Absolute assignment of breast cancer intrinsic molecular subtype</article-title>
        <source>J. Natl. Cancer Inst.</source>
        <year>2014</year>
        <volume>107</volume>
        <fpage>357</fpage>
        <?supplied-pmid 25479802?>
        <pub-id pub-id-type="pmid">25479802</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Raj-Kumar</surname>
            <given-names>P-K</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>PCA-PAM50 improves consistency between breast cancer intrinsic and clinical subtyping reclassifying a subset of luminal A tumors as luminal B</article-title>
        <source>Sci. Rep.</source>
        <year>2019</year>
        <volume>9</volume>
        <fpage>1</fpage>
        <lpage>13</lpage>
        <pub-id pub-id-type="doi">10.1038/s41598-019-44339-4</pub-id>
        <pub-id pub-id-type="pmid">30626917</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chen</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Yang</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Goodison</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Sun</surname>
            <given-names>Y</given-names>
          </name>
        </person-group>
        <article-title>Deep-learning approach to identifying cancer subtypes using high-dimensional genomic data</article-title>
        <source>Bioinformatics</source>
        <year>2020</year>
        <volume>36</volume>
        <fpage>1476</fpage>
        <lpage>1483</lpage>
        <?supplied-pmid 31603461?>
        <pub-id pub-id-type="pmid">31603461</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Parker</surname>
            <given-names>JS</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Supervised risk predictor of breast cancer based on intrinsic subtypes</article-title>
        <source>J. Clin. Oncol.</source>
        <year>2009</year>
        <volume>27</volume>
        <fpage>1160</fpage>
        <pub-id pub-id-type="doi">10.1200/JCO.2008.18.1370</pub-id>
        <?supplied-pmid 19204204?>
        <pub-id pub-id-type="pmid">19204204</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wallden</surname>
            <given-names>B</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Development and verification of the PAM50-based Prosigna breast cancer gene signature assay</article-title>
        <source>BMC Med. Genomics</source>
        <year>2015</year>
        <volume>8</volume>
        <fpage>54</fpage>
        <pub-id pub-id-type="doi">10.1186/s12920-015-0129-6</pub-id>
        <?supplied-pmid 26297356?>
        <pub-id pub-id-type="pmid">26297356</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bastien</surname>
            <given-names>RL</given-names>
          </name>
          <name>
            <surname>Vaughn</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Elsberry</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Stijleman</surname>
            <given-names>IJ</given-names>
          </name>
          <name>
            <surname>Bernard</surname>
            <given-names>PS</given-names>
          </name>
        </person-group>
        <article-title>Clinical validation of the Prosigna breast cancer prognostic gene signature assay on formalin-fixed paraffin embedded breast cancer tumors with comparison to standard molecular markers</article-title>
        <source>J. Clin. Oncl.</source>
        <year>2014</year>
        <volume>32</volume>
        <fpage>e11518</fpage>
        <pub-id pub-id-type="doi">10.1200/jco.2014.32.15_suppl.e11518</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nielsen</surname>
            <given-names>T</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Analytical validation of the PAM50-based Prosigna breast cancer prognostic gene signature assay and nCounter analysis system using formalin-fixed paraffin-embedded breast tumor specimens</article-title>
        <source>BMC Cancer</source>
        <year>2014</year>
        <volume>14</volume>
        <fpage>177</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2407-14-177</pub-id>
        <?supplied-pmid 24625003?>
        <pub-id pub-id-type="pmid">24625003</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ohnstad</surname>
            <given-names>HO</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Prognostic value of PAM50 and risk of recurrence score in patients with early-stage breast cancer with long-term follow-up</article-title>
        <source>Breast Cancer Res.</source>
        <year>2017</year>
        <volume>19</volume>
        <fpage>120</fpage>
        <pub-id pub-id-type="doi">10.1186/s13058-017-0911-9</pub-id>
        <?supplied-pmid 29137653?>
        <pub-id pub-id-type="pmid">29137653</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ein-Dor</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Kela</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Getz</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Givol</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Domany</surname>
            <given-names>E</given-names>
          </name>
        </person-group>
        <article-title>Outcome signature genes in breast cancer: is there a unique set?</article-title>
        <source>Bioinformatics</source>
        <year>2005</year>
        <volume>21</volume>
        <fpage>171</fpage>
        <lpage>178</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bth469</pub-id>
        <?supplied-pmid 15308542?>
        <pub-id pub-id-type="pmid">15308542</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Dewey</surname>
            <given-names>CN</given-names>
          </name>
        </person-group>
        <article-title>RSEM: accurate transcript quantification from RNA-Seq data with or without a reference genome</article-title>
        <source>BMC Bioinform.</source>
        <year>2011</year>
        <volume>12</volume>
        <fpage>323</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-12-323</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Trapnell</surname>
            <given-names>C</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Transcript assembly and quantification by RNA-Seq reveals unannotated transcripts and isoform switching during cell differentiation</article-title>
        <source>Nat. Biotechnol.</source>
        <year>2010</year>
        <volume>28</volume>
        <fpage>511</fpage>
        <pub-id pub-id-type="doi">10.1038/nbt.1621</pub-id>
        <?supplied-pmid 20436464?>
        <pub-id pub-id-type="pmid">20436464</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <mixed-citation publication-type="other">Pachter, L. Models for transcript quantification from RNA-Seq. 2011. arXiv preprint <ext-link ext-link-type="uri" xlink:href="http://arxiv.org/abs/1104.3889">arXiv:1104.3889</ext-link> 1–28 (2017).</mixed-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <mixed-citation publication-type="other">Howlader, N. <italic>et al.</italic> US incidence of breast cancer subtypes defined by joint hormone receptor and HER2 status. <italic>J. Natl. Cancer Inst.</italic><bold>106</bold>, dju055 (2014).</mixed-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ritchie</surname>
            <given-names>ME</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Limma powers differential expression analyses for RNA-sequencing and microarray studies</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2015</year>
        <volume>43</volume>
        <fpage>e47</fpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkv007</pub-id>
        <?supplied-pmid 25605792?>
        <pub-id pub-id-type="pmid">25605792</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ellingjord-Dale</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Parity, hormones and breast cancer subtypes-results from a large nested case-control study in a national screening program</article-title>
        <source>Breast Cancer Res.</source>
        <year>2017</year>
        <volume>19</volume>
        <fpage>10</fpage>
        <pub-id pub-id-type="doi">10.1186/s13058-016-0798-x</pub-id>
        <?supplied-pmid 28114999?>
        <pub-id pub-id-type="pmid">28114999</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tibshirani</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Hastie</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Narasimhan</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Chu</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>Diagnosis of multiple cancer types by shrunken centroids of gene expression</article-title>
        <source>Proc. Natl. Acad. Sci. U.S.A.</source>
        <year>2002</year>
        <volume>99</volume>
        <fpage>6567</fpage>
        <lpage>6572</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.082099299</pub-id>
        <?supplied-pmid 12011421?>
        <pub-id pub-id-type="pmid">12011421</pub-id>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gao</surname>
            <given-names>F</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>DeepCC: a novel deep learning-based framework for cancer molecular subtype classification</article-title>
        <source>Oncogenesis</source>
        <year>2019</year>
        <volume>8</volume>
        <fpage>1</fpage>
        <lpage>12</lpage>
        <pub-id pub-id-type="doi">10.1038/s41389-019-0157-8</pub-id>
        <pub-id pub-id-type="pmid">30631034</pub-id>
      </element-citation>
    </ref>
    <ref id="CR29">
      <label>29.</label>
      <mixed-citation publication-type="other">Giarratana, G., Pizzera, M., Masseroli, M., Medico, E. &amp; Lanzi, P. L. Data mining techniques for the identification of genes with expression levels related to breast cancer prognosis. In <italic>2009 Ninth IEEE International Conference on Bioinformatics and BioEngineering</italic>, 295–300 (IEEE, 2009).</mixed-citation>
    </ref>
    <ref id="CR30">
      <label>30.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kourou</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Exarchos</surname>
            <given-names>TP</given-names>
          </name>
          <name>
            <surname>Exarchos</surname>
            <given-names>KP</given-names>
          </name>
          <name>
            <surname>Karamouzis</surname>
            <given-names>MV</given-names>
          </name>
          <name>
            <surname>Fotiadis</surname>
            <given-names>DI</given-names>
          </name>
        </person-group>
        <article-title>Machine learning applications in cancer prognosis and prediction</article-title>
        <source>Comput. Struct. Biotechnol. J.</source>
        <year>2015</year>
        <volume>13</volume>
        <fpage>8</fpage>
        <lpage>17</lpage>
        <pub-id pub-id-type="doi">10.1016/j.csbj.2014.11.005</pub-id>
        <?supplied-pmid 25750696?>
        <pub-id pub-id-type="pmid">25750696</pub-id>
      </element-citation>
    </ref>
    <ref id="CR31">
      <label>31.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sumbaly</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Vishnusri</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Jeyalatha</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Diagnosis of breast cancer using decision tree data mining technique</article-title>
        <source>Int. J. Comput. Appl.</source>
        <year>2014</year>
        <volume>98</volume>
        <fpage>16</fpage>
        <lpage>24</lpage>
      </element-citation>
    </ref>
    <ref id="CR32">
      <label>32.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Waldemarson</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Proteomic analysis of breast tumors confirms the mRNA intrinsic molecular subtypes using different classifiers: a large-scale analysis of fresh frozen tissue samples</article-title>
        <source>Breast Cancer Res.</source>
        <year>2016</year>
        <volume>18</volume>
        <fpage>69</fpage>
        <pub-id pub-id-type="doi">10.1186/s13058-016-0732-2</pub-id>
        <?supplied-pmid 27357824?>
        <pub-id pub-id-type="pmid">27357824</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
