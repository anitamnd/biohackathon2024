<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Nat Commun</journal-id>
    <journal-id journal-id-type="iso-abbrev">Nat Commun</journal-id>
    <journal-title-group>
      <journal-title>Nature Communications</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2041-1723</issn>
    <publisher>
      <publisher-name>Nature Publishing Group UK</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">6882880</article-id>
    <article-id pub-id-type="publisher-id">13055</article-id>
    <article-id pub-id-type="doi">10.1038/s41467-019-13055-y</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Automated optimized parameters for T-distributed stochastic neighbor embedding improve visualization and analysis of large datasets</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0001-7967-6254</contrib-id>
        <name>
          <surname>Belkina</surname>
          <given-names>Anna C.</given-names>
        </name>
        <address>
          <email>BELKINA@BU.EDU</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Ciccolella</surname>
          <given-names>Christopher O.</given-names>
        </name>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Anno</surname>
          <given-names>Rina</given-names>
        </name>
        <xref ref-type="aff" rid="Aff4">4</xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0003-2457-9507</contrib-id>
        <name>
          <surname>Halpert</surname>
          <given-names>Richard</given-names>
        </name>
        <xref ref-type="aff" rid="Aff5">5</xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-9710-1910</contrib-id>
        <name>
          <surname>Spidlen</surname>
          <given-names>Josef</given-names>
        </name>
        <xref ref-type="aff" rid="Aff5">5</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Snyder-Cappione</surname>
          <given-names>Jennifer E.</given-names>
        </name>
        <xref ref-type="aff" rid="Aff2">2</xref>
        <xref ref-type="aff" rid="Aff6">6</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0004 0367 5222</institution-id><institution-id institution-id-type="GRID">grid.475010.7</institution-id><institution>Department of Pathology and Laboratory Medicine, Boston University School of Medicine, </institution></institution-wrap>Boston, MA 02118 USA </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0004 0367 5222</institution-id><institution-id institution-id-type="GRID">grid.475010.7</institution-id><institution>Flow Cytometry Core Facility, </institution><institution>Boston University School of Medicine, </institution></institution-wrap>Boston, MA 02118 USA </aff>
      <aff id="Aff3"><label>3</label>Omiq, Inc, Santa Clara, CA 95050 USA </aff>
      <aff id="Aff4"><label>4</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 0737 1259</institution-id><institution-id institution-id-type="GRID">grid.36567.31</institution-id><institution>Department of Mathematics, </institution><institution>Kansas State University, </institution></institution-wrap>Manhattan, KS 66506 USA </aff>
      <aff id="Aff5"><label>5</label>BD Life Sciences–FlowJo, Ashland, OR 97520 USA </aff>
      <aff id="Aff6"><label>6</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0004 0367 5222</institution-id><institution-id institution-id-type="GRID">grid.475010.7</institution-id><institution>Department of Microbiology, </institution><institution>Boston University School of Medicine, </institution></institution-wrap>Boston, MA 02118 USA </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>28</day>
      <month>11</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>28</day>
      <month>11</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2019</year>
    </pub-date>
    <volume>10</volume>
    <elocation-id>5415</elocation-id>
    <history>
      <date date-type="received">
        <day>13</day>
        <month>11</month>
        <year>2018</year>
      </date>
      <date date-type="accepted">
        <day>7</day>
        <month>10</month>
        <year>2019</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2019</copyright-statement>
      <license license-type="OpenAccess">
        <license-p><bold>Open Access</bold> This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The images or other third party material in this article are included in the article’s Creative Commons license, unless indicated otherwise in a credit line to the material. If material is not included in the article’s Creative Commons license and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this license, visit <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <p id="Par1">Accurate and comprehensive extraction of information from high-dimensional single cell datasets necessitates faithful visualizations to assess biological populations. A state-of-the-art algorithm for non-linear dimension reduction, t-SNE, requires multiple heuristics and fails to produce clear representations of datasets when millions of cells are projected. We develop opt-SNE, an automated toolkit for t-SNE parameter selection that utilizes Kullback-Leibler divergence evaluation in real time to tailor the early exaggeration and overall number of gradient descent iterations in a dataset-specific manner. The precise calibration of early exaggeration together with opt-SNE adjustment of gradient descent learning rate dramatically improves computation time and enables high-quality visualization of large cytometry and transcriptomics datasets, overcoming limitations of analysis tools with hard-coded parameters that often produce poorly resolved or misleading maps of fluorescent and mass cytometry data. In summary, opt-SNE enables superior data resolution in t-SNE space and thereby more accurate data interpretation.</p>
    </abstract>
    <abstract id="Abs2" abstract-type="web-summary">
      <p id="Par2">Visualisation tools that use dimensionality reduction, such as t-SNE, provide poor visualisation on large data sets of millions of observations. Here the authors present opt-SNE, that automatically finds data set-tailored parameters for t-SNE to optimise visualisation and improve analysis.</p>
    </abstract>
    <kwd-group kwd-group-type="npg-subject">
      <title>Subject terms</title>
      <kwd>Flow cytometry</kwd>
      <kwd>Computational biology and bioinformatics</kwd>
      <kwd>Machine learning</kwd>
      <kwd>Immunology</kwd>
    </kwd-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2019</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1" sec-type="introduction">
    <title>Introduction</title>
    <p id="Par3">Visual exploration of high-dimensional data is imperative for the comprehensive analysis of single cell datasets. Fluorescence, mass and sequencing-based cytometric data analysis requires tools that are able to reveal the combinations of proteomic and/or transcriptomic markers that define complex and diverse cell phenotypes in a mixed population. While traditional biaxial data presentation via expert-driven gating is still the standard analysis method for cytometry data, with the advent of the modern multi-parameter era an analysis tool that can accurately and comprehensively visualize multi-dimensional data is direly needed to relieve the current cytometry data-processing bottleneck.</p>
    <p id="Par4">To date, multiple dimensionality reduction techniques have been applied to cytometry data with variable success. Linear methods, such as PCA, are mostly unsuitable for cytometry data visualization as such techniques cannot faithfully present the non-linear relationships. t-Distributed Stochastic Neighbor Embedding (t-SNE) is a state-of-the-art dimensionality reduction algorithm for non-linear data representation that creates a low-dimensional distribution, or a ‘map’, of high-dimensional data<sup><xref ref-type="bibr" rid="CR1">1</xref>,<xref ref-type="bibr" rid="CR2">2</xref></sup>. Conspicuous groupings of datapoints, or ‘islands’, correspond to observations that are similar in the original high-dimensional space and help to visualize the general structure and heterogeneity of a dataset. When t-SNE embeds single cell data, the islands represent cells with similar phenotypes, as defined by a cytometric or genomic signature, thereby allowing to reveal biological data structure and to surface important differences between samples and/or subject groups<sup><xref ref-type="bibr" rid="CR3">3</xref></sup>. In addition, t-SNE maps are used to categorize single cell data into relevant biological populations for downstream quantification, achievable through expert-guided filtering (gating)<sup><xref ref-type="bibr" rid="CR4">4</xref></sup> or unsupervised clustering of the map<sup><xref ref-type="bibr" rid="CR5">5</xref>–<xref ref-type="bibr" rid="CR7">7</xref></sup>. Visualizations of cytometry data produced with other non-linear embedding algorithms, such as LargeVis<sup><xref ref-type="bibr" rid="CR8">8</xref></sup>, UMAP<sup><xref ref-type="bibr" rid="CR9">9</xref></sup>, and EmbedSOM<sup><xref ref-type="bibr" rid="CR10">10</xref></sup>, can be interpreted and interrogated in a similar manner. Clustering algorithms that directly interrogate high-dimensional data, such as FlowSOM<sup><xref ref-type="bibr" rid="CR11">11</xref></sup> and PhenoGraph<sup><xref ref-type="bibr" rid="CR12">12</xref></sup>, are often used in conjunction with 2D maps to present annotated cell clusters to the viewer.</p>
    <p id="Par5">A limitation of t-SNE in its current form is its inability to scale to datasets with large numbers of observations<sup><xref ref-type="bibr" rid="CR7">7</xref>,<xref ref-type="bibr" rid="CR8">8</xref></sup>. This restrains t-SNE’s utility for cytometry datasets that often include millions of observations (events) routinely collected for phenotypic analysis. Unlike PCA, t-SNE learns the embedding non-parametrically, and hence new pieces of data cannot validly be added to an existing analysis, necessitating the whole dataset to be analyzed within one computation. When the full dataset is comprised of multiple samples, each representing a subject in a large cohort or an independent experimental condition, retaining statistically significant representation of small subpopulations in each sample requires inflating the dataset size<sup><xref ref-type="bibr" rid="CR13">13</xref></sup>. However, even within a single measurement, subsampling the data risks preventing rare subsets from being identified. These limitations cannot be overcome via application of the currently understood best practices for t-SNE use. Not only are large datasets computationally expensive to analyze, but also the resulting t-SNE maps provide poor visualization and incomprehensive representation of high-dimensional data. Consequently, researchers often resort to either subsampling their data to the very limit of detection of rare populations<sup><xref ref-type="bibr" rid="CR14">14</xref></sup> or to exporting specific populations from their dataset, thus compromising the unbiased data analysis approach<sup><xref ref-type="bibr" rid="CR15">15</xref>,<xref ref-type="bibr" rid="CR16">16</xref></sup>.</p>
    <p id="Par6">Although t-SNE has been widely adopted by the scientific community, to our knowledge no rigorous theoretical or empirical testing of t-SNE for cytometry applications has been performed. In 2013, Amir et al. first reported the use of Barnes-Hut (BH) implementation of t-SNE (or viSNE, as it was renamed<sup><xref ref-type="bibr" rid="CR3">3</xref></sup>) on mass cytometry data; since then, BH-tSNE has been integrated into the majority of commercial and open-source platforms for cytometry analysis. In most implementations, few or no adjustments were made to the Barnes-Hut t-SNE algorithm for the requirements of cytometry datasets; the default and hard-coded parameter settings that were originally tested and optimized with non-cytometry datasets like CIFAR (image dataset) or MNIST (handwritten digits) are retained in these cytometry programs and hence are still widely used. Recently published modifications of t-SNE, such as HSNE<sup><xref ref-type="bibr" rid="CR17">17</xref></sup> and FIt-SNE<sup><xref ref-type="bibr" rid="CR18">18</xref></sup>, do not fully address these limitations. Therefore, development of rigorous methodology to release the full potential of t-SNE for single cell data comprehension and provide clues for optimization of second generation t-SNE-like algorithms is the primary motivation for this work.</p>
    <p id="Par7">In this study, we first assess the behavior of t-SNE computation with routinely used settings that match commonly prescribed best practices, and then iteratively modify parameters of embedding to identify conditions that ensure improved visualization. As a result, we propose a new method to automatically find dataset-tailored t-SNE parameters via fine-tuning of the early exaggeration phase of t-SNE embedding in real time. We call our approach opt-SNE, for optimized t-SNE. opt-SNE adjustments can greatly shorten the number of iterations required to obtain visualizations of large cytometry datasets with superior quality. Our approach also eliminates the need for trial-and-error runs intended to empirically find the most favorable selection of t-SNE parameters, potentially saving many hours of computation time per research project. Finally, we implemented opt-SNE as an open source fast multicore t-SNE C++ package which allows much faster computation of t-SNE embeddings than original single-core Barnes-Hut t-SNE implementation.</p>
  </sec>
  <sec id="Sec2" sec-type="results">
    <title>Results</title>
    <sec id="Sec3">
      <title>The standard t-SNE fails to visualize large datasets</title>
      <p id="Par8">The t-SNE algorithm can be guided by a set of parameters that finely adjust multiple aspects of the t-SNE run<sup><xref ref-type="bibr" rid="CR19">19</xref></sup>. However, cytometry data analysis software often locks or severely restrains the tunability of those parameters, likely to provide a simplified, ‘one-size-fits-all’ solution for t-SNE use in the software packages. Although each software platform has a unique combination of possible adjustments, most allow changes to both the number of iterations and to the perplexity (a soft measure for the number of nearest neighbors considered for each data point).</p>
      <p id="Par9">The datasets used throughout this study include at least 1 million datapoints of fluorescent or mass cytometry data and are therefore considerably larger than the typical (&lt;5 × 10<sup>5</sup>) datasets previously reported in benchmark studies of cytometry algorithmic tools<sup><xref ref-type="bibr" rid="CR20">20</xref></sup>. Cytometry datasets larger than approximately 5 × 10<sup>5</sup> events are generally observed to produce poor quality t-SNE maps and are therefore usually subsampled prior to analysis.</p>
      <p id="Par10">Empirically, analysts have observed that increasing the number of iterations of t-SNE computation results in better quality maps<sup><xref ref-type="bibr" rid="CR9">9</xref>,<xref ref-type="bibr" rid="CR21">21</xref></sup>. We hypothesized that the resolution of t-SNE maps created from higher event counts could be dramatically improved via fine-tuning of t-SNE parameters. We first directly tested the relationship between iteration number and map quality by running two datasets (mass41parameter and flow18parameter, as described in Table <xref rid="Tab1" ref-type="table">1</xref>) at the standard 1000 iterations per run and with an extended 3000 iteration computation (Fig. <xref rid="Fig1" ref-type="fig">1</xref>). As expected, 1000-iteration runs produced maps with poor visualization compared to 3000-iteration runs. Specifically, massive overlaps and random fragmentation of populations were observed. In contrast, the 3000-iteration runs resulted in maps with defined islands comprised of clearly isolated populations and no random fragmentations (Fig. <xref rid="Fig1" ref-type="fig">1a, b</xref>) The 1NN accuracy of embedding was also higher in 3000-iteration embeddings for both datasets compared to the standard 1000-iteration t-SNE (Suppl. Fig. <xref rid="MOESM1" ref-type="media">1</xref>). Therefore, these findings are in agreement with the concept of a higher number of iterations resulting in higher quality t-SNE maps.<table-wrap id="Tab1"><label>Table 1</label><caption><p>Datasets used in this paper</p></caption><table frame="hsides" rules="groups"><thead><tr><th>Dataset</th><th>Data type</th><th>Details</th><th>References</th></tr></thead><tbody><tr><td>Mass41parameter</td><td>Mass cytometry</td><td>41 parameter dataset (14 lineage parameters used for embedding) of 1 million datapoints concatenated from 5 samples of human bone marrow cells</td><td><sup><xref ref-type="bibr" rid="CR46">46</xref></sup></td></tr><tr><td>Flow18parameter</td><td>Flow cytometry</td><td>18 parameter dataset (11 lineage parameters used for embedding) of 1 million datapoints concatenated from 2 samples of human PBMC</td><td><sup><xref ref-type="bibr" rid="CR25">25</xref>,<xref ref-type="bibr" rid="CR47">47</xref></sup></td></tr><tr><td>Flow20M</td><td>Flow cytometry</td><td>18 parameter dataset (15 lineage parameters used for embedding) of 20 million datapoints concatenated from 27 samples of human PBMC</td><td><sup><xref ref-type="bibr" rid="CR25">25</xref>,<xref ref-type="bibr" rid="CR47">47</xref></sup></td></tr><tr><td>10X Genomics</td><td>scRNA-seq</td><td>Single cell gene expression data of E18 mouse brain pre-processed into 20 PCA projections used for t-SNE embedding</td><td><ext-link ext-link-type="uri" xlink:href="https://support.10xgenomics.com/single-cell-gene-expression/datasets">https://support.10xgenomics.com/single-cell-gene-expression/datasets</ext-link> and ref. <sup><xref ref-type="bibr" rid="CR26">26</xref></sup></td></tr><tr><td>van Unen et al.</td><td>Mass cytometry</td><td>32 parameter dataset (26 lineage parameters used for embedding) of 5.22 million datapoints concatenated from 104 samples of PBMC and gut biopsy cells</td><td><sup><xref ref-type="bibr" rid="CR7">7</xref></sup></td></tr></tbody></table></table-wrap><fig id="Fig1"><label>Fig. 1</label><caption><p>Performance of Barnes-Hut t-SNE implementation for cytometry data visualization. Standard (1000 iterations) and extended (3000 iterations) embeddings of mass cytometry (<bold>a</bold>) or flow cytometry (<bold>b</bold>) data are presented as heatmap density plots (left) or color-coded population overlays based on ground-truth classification of single cell in the datasets (right). <bold>c</bold> KLD change over iteration time of gradient descent for standard 1000 iterations (red line) or extended 3000 iterations (black line) embeddings of mass41parmeter dataset. Representative examples of multiple runs with varying seed values are shown</p></caption><graphic xlink:href="41467_2019_13055_Fig1_HTML" id="d29e579"/></fig></p>
    </sec>
    <sec id="Sec4">
      <title>KLD plateau phase resolves cluster structure in t-SNE</title>
      <p id="Par11">In order to determine the cause of the difference in cluster resolution between the “standard” and “extended” t-SNE runs, we examined the behavior of KLD (Kullback-Leibler divergence, see Methods) over the duration of t-SNE embeddings (Fig. <xref rid="Fig1" ref-type="fig">1c</xref>). As expected, the KLD value was inflated during the EE since EEF is factored into gradient and KLD value calculation in BH-tSNE<sup><xref ref-type="bibr" rid="CR1">1</xref></sup>. We applied EE over 250 iterations in the standard t-SNE configuration and over 750 iterations in the extended run with 3000 iterations since most platforms have EE scaled to 25% of total iteration number. Notably, the KLD did not immediately start to minimize at the beginning of the EE; instead, the graph of KLD over time is a plateau that is followed by a curve that captures the incremental decrease of KLD, indicating the gradient descent. In the standard t-SNE run, the plateau was interrupted when the EE was stopped, then continued with a non-exaggerated value of KLD.</p>
      <p id="Par12">Van der Maaten and Hinton called EE a “trick” that improved resolution of the global structure of the data visualization that would not otherwise converge to separated clusters<sup><xref ref-type="bibr" rid="CR1">1</xref></sup>. As the suboptimal quality of the 1000-iteration t-SNE maps shown in Fig. <xref rid="Fig1" ref-type="fig">1a, b</xref> demonstrated poor global structure resolution, we hypothesized that increasing the total iteration number in conventional cytometry analysis platforms would inadvertently increase the number of EE iterations resulting in improvement in map visualization. To test this hypothesis, we compared runs that differed in timing of the EE stop by plotting the embedding at the iteration when the EE stops and also at later iterations, thus assessing the effects of EE and our perturbations on both flow cytometry (Fig. <xref rid="Fig2" ref-type="fig">2a</xref>) and mass cytometry (Fig. <xref rid="Fig2" ref-type="fig">2b</xref>) data visualization.<fig id="Fig2"><label>Fig. 2</label><caption><p>Effect of EE plateau phase on t-SNE visualization. EE was stopped after varying number of iterations and embedding visualization was examined at several intermediate timepoints and in the end of embedding for flow cytometry (total of 2000 iterations), (<bold>a</bold>) and mass cytometry (total of 3000 iterations). <bold>b</bold> Graphs showing KLD change over iteration time are color-labeled to distinguish curves corresponding to experiment perturbations, with black line indicating the run with the shortest EE but uninterrupted plateau. t-SNE maps are annotated with color-coded population overlays based on ground-truth classification of single cell in the datasets. <bold>c</bold> KLD and KLD relative change plotted against iteration time for the mass41parameter embedding. All embeddings were generated with standard BH-tSNE implementation and representative examples of multiple runs with varying seed values are shown</p></caption><graphic xlink:href="41467_2019_13055_Fig2_HTML" id="d29e624"/></fig></p>
      <p id="Par13">We found notable differences in map quality between the runs with shorter and longer EE. Although the map after EE200/total3000 iterations may appear visually more appealing than previously shown EE250/total1000 map, ground-truth labeling indicated that phenotype-defined clusters are fragmented in both flow and mass cytometry maps. When cluster fragments were plotted on a biaxial plot against parameters that were used in the t-SNE dimension reduction, we were not able to identify protein marker expression patterns that immediately contributed to their fragmentation (Suppl. Fig. <xref rid="MOESM1" ref-type="media">2</xref>). Conversely, tight clusters that form at the end of the plateau remain mostly unchanged as long as the EE is being applied to the computation (Fig. <xref rid="Fig2" ref-type="fig">2a, b</xref>). The KLD minimization in that case could be explained by the gradual shrinking of the 2D space. Once EE is removed, the attractive forces within each cluster are weakened and the local structure of the data is fully resolved within each cluster.</p>
      <p id="Par14">Overall, our observations suggest that the EE phase of the gradient descent is essential for data clustering while the non-exaggerated descent results in the resolution of local structures. When the EE is too short, the cell clusters continue to be resolved simultaneously with the local structure of each cluster being unfolded, leading to fragmented, overlapped or deformed islands in the resulting map (Fig. <xref rid="Fig2" ref-type="fig">2</xref>, Suppl. Fig. <xref rid="MOESM1" ref-type="media">2</xref>). To locate the timepoint when to end EE once the plateau phase is completed, we tracked the relative rate of KLD change (KLDRC<sub><italic>N</italic></sub> = 100% × ((KLD<sub><italic>N</italic>−1</sub>−KLD<sub><italic>N</italic></sub>)/ KLD<sub><italic>N</italic>−1</sub>) where <italic>N</italic> is the iteration number) and then identified the local maximum of KLDRC (maxKLDRC) (Fig. <xref rid="Fig2" ref-type="fig">2c</xref>). Since KLD is computed at each iteration, the maxKLDRC sensor can be added to the algorithm programmatically and would stop EE at the next iteration past maxKLDRC. For both datasets the maxKLDRC was detected at about 700–720 iterations (Fig. <xref rid="Fig2" ref-type="fig">2c</xref>), and, when the EE phase was followed by 300–1300 iterations without EE, the resulting visualization was similar to the EE750/3000 map at Fig. <xref rid="Fig1" ref-type="fig">1a</xref> and no cluster fragmentations were observed (Suppl. Fig. <xref rid="MOESM1" ref-type="media">3</xref>), demonstrating more relevant visualization of cytometry data compared to standard t-SNE settings.</p>
    </sec>
    <sec id="Sec5">
      <title>EE factor, perplexity tuning does not impact visualization</title>
      <p id="Par15">Once we found EE to be crucial for map optimization, we next examined if the value of the EE factor <italic>α</italic> (EEF) can also be tuned to improve the results of t-SNE. We made <italic>α</italic> user-accessible in our C++ t-SNE code since it is hard-coded in the original Barnes-Hut C++ t-SNE implementation and all aforementioned results were obtained with default value of <italic>α</italic> = 12. First, we tested how the optimization would proceed without EE (<italic>α</italic> = 1). We expected the run to fail or produce extremely crowded results as explained in the original t-SNE report;<sup><xref ref-type="bibr" rid="CR1">1</xref></sup> however, we did not see much overlap in cluster positioning, likely due to the substantial number of map iterations run (Fig. <xref rid="Fig3" ref-type="fig">3a</xref>). Nevertheless, the resulting map showed considerable fragmentation, reflecting an extreme case of an interrupted plateau phase. Even when run for as many as 3000 iterations, the fragmentation could not be remedied, again demonstrating the necessity of EE. As expected, higher values of <italic>α</italic> lead to much higher KLD during EE, however, the KLD values were similar at 2000 iterations when <italic>α</italic> varied between 4 and 60 (Fig. <xref rid="Fig3" ref-type="fig">3b</xref>) and EE was stopped at the max KLDRC iteration. Larger <italic>α</italic> prolonged the plateau phase and became detrimental for KLD values when over 100. Visually <italic>α</italic> = 200 resulted in a distorted map with smaller populations lost. Therefore, we suggest that for cytometry applications the <italic>α</italic> parameter may remain unchanged and set to 12, as hard-coded in BH-tSNE<sup><xref ref-type="bibr" rid="CR2">2</xref></sup>, or reverted to <italic>α</italic> <italic>=</italic> 4, as originally proposed by van der Maaten and Hinton<sup><xref ref-type="bibr" rid="CR1">1</xref></sup> since per our results any value between 4 and 20 leads to similar outcomes.<fig id="Fig3"><label>Fig. 3</label><caption><p>Effects of perplexity and EE factor adjustments on t-SNE visualization of cytometry data. <bold>a</bold>, <bold>b</bold> KLD, KLDRC, and t-SNE biaxial plots generated with varying EE factor values. <bold>c</bold>, <bold>d</bold> KLD, KLDRC, and t-SNE biaxial plots generated with varying perplexity. Graphs showing KLD and KLDRC change over iteration time are color-labeled to distinguish curves corresponding to experiment perturbations. Color overlays on t-SNE plots correspond to cell type classes labeled as in Figs. <xref rid="Fig1" ref-type="fig">1</xref>, <xref rid="Fig2" ref-type="fig">2</xref>. Representative examples of multiple runs with varying seed values are shown</p></caption><graphic xlink:href="41467_2019_13055_Fig3_HTML" id="d29e760"/></fig></p>
      <p id="Par16">Increased perplexity has been proposed to be an intuitively beneficial method for visualization improvement since it translates to a larger number of considered nearest neighbors and hence a more accurate approximation of attractive forces, while decreased perplexity can completely fail the visualization<sup><xref ref-type="bibr" rid="CR19">19</xref></sup>. KLD values for runs with varying perplexity cannot be directly compared since the KLD value is related to perplexity; however, KLD records over time do not show that increased perplexity results in visibly improved data visualization (Fig. <xref rid="Fig3" ref-type="fig">3c</xref>) or faster resolution of clusters (Fig. <xref rid="Fig3" ref-type="fig">3d</xref>). However, while changing <italic>α</italic> does not affect t-SNE computation time, perplexity is linearly related to the time required to create the embedding in both implementations of BH-tSNE that we tested. Although we and others have found some benefits of perplexity increases to map quality in otherwise suboptimal t-SNE runs, optimizing the EE step as described above and further in this work does not leave much space for improvement with perplexity tuning.</p>
    </sec>
    <sec id="Sec6">
      <title>T-SNE learning step size must scale to dataset size</title>
      <p id="Par17">The step size in t-SNE gradient descent is updated at each iteration per Jacobs adaptive learning rate scheme<sup><xref ref-type="bibr" rid="CR22">22</xref></sup>. This method increases the learning rate in directions in which the gradient is stable. A conservative initial value of 200 is hard-coded into most platforms. We hypothesized that larger datasets may stay longer on KLD plateau due to the number of iterations it takes to build up a sufficient learning rate step size. To evaluate this possibility, we titrated the step size <italic>η</italic> while observing the KLD with fixed EE = 1000 iterations in the mass41parameter dataset. In agreement with our hypothesis, <italic>η</italic> <italic>=</italic> 25 and <italic>η</italic> = 50 runs failed to resolve from KLD plateau within 1000 iterations of EE (Fig. <xref rid="Fig4" ref-type="fig">4a</xref>) and <italic>η</italic> <italic>=</italic> 200 finished the plateau in ~700 iterations as previously shown. With further increases in <italic>η</italic>, we found that not only were progressively fewer iterations required to complete the plateau, but also that the final KLD of the maps scored at lower values. KLD is directly related to the quality of visualization since it reflects the faithfulness of representation of high-dimensional data in t-SNE space; therefore, lower KLD values indicate superior visualization quality.<fig id="Fig4"><label>Fig. 4</label><caption><p>Learning step size optimization for t-SNE visualization of large datasets. <bold>a</bold>–<bold>c</bold> KLD change over iterations for embeddings with varying values of initial learning rate step size, color coded as indicated. <bold>a</bold> EE = 1000 iterations, learning rate step = 25–4000; <bold>b</bold> EE = 1000 iterations, learning rate step = 8000–2,048,000; <bold>c</bold> EE = 100–1000 iterations, learning rate step = 2000–512,000. <bold>d</bold> Representative t-SNE plots of embeddings graphed on <bold>a</bold>. <bold>e</bold> t-SNE plot of an optimized embedding. All color overlays on t-SNE plots correspond to cell type classes labeled as in Figs. <xref rid="Fig1" ref-type="fig">1</xref>, <xref rid="Fig2" ref-type="fig">2</xref>. Representative examples of multiple runs with varying seed values are shown</p></caption><graphic xlink:href="41467_2019_13055_Fig4_HTML" id="d29e849"/></fig></p>
      <p id="Par18">We continued to see improvement in plateau duration and KLD values with higher <italic>η</italic> values up to <italic>η</italic> ~ 64,000, a value that is drastically far from the default <italic>η</italic> <italic>=</italic> 200 setting (in most platforms, <italic>η</italic> is restricted to ranges below 3000) (Fig. <xref rid="Fig4" ref-type="fig">4b</xref>). At <italic>η</italic> ~ 256,000 we observed irregular peaks in the KLD graph indicating that the prescribed step size rendered gradient descent ineffective. However, using lower values of <italic>η</italic> we were able to create the map with the lowest KLD values at a fraction of time when limiting the EE step to 200 and even 100 iterations despite the 10<sup>6</sup> size of the dataset (Fig. <xref rid="Fig4" ref-type="fig">4c</xref>). Visual inspection of the embedded maps over the range of <italic>η</italic> values agrees with the KLD values (Fig. <xref rid="Fig4" ref-type="fig">4d</xref>).</p>
      <p id="Par19">In a recent publication, Linderman and Steinerberger<sup><xref ref-type="bibr" rid="CR23">23</xref></sup> prove that in general t-SNE embedding will not converge if a product of EE factor <italic>α</italic> and of fixed learning rate step size <italic>η</italic> is larger than the number of datapoints <italic>n</italic> (i.e., if <italic>αη</italic> <italic>&gt;</italic> <italic>n</italic>). Since we employ an adaptive learning rate, our selection of initial <italic>η</italic> value is more forgiving; however, we found the most efficient settings of <italic>η</italic> to be close to <italic>η</italic> = <italic>n</italic>/12 for computations where <italic>α</italic> = 12. Therefore, we propose to initiate the gradient descent with <italic>η</italic> <italic>=</italic> <italic>n</italic>/<italic>α</italic> to create t-SNE visualization (Fig. <xref rid="Fig4" ref-type="fig">4e</xref>).</p>
    </sec>
    <sec id="Sec7">
      <title>opt-SNE creates fast high quality embedding of cytometry data</title>
      <p id="Par20">The standard C++ BH-tSNE implementation that we used to optimize t-SNE parameters only utilizes a single processor core and requires considerable computation time. We thus adopted a recently developed multicore modification of Barnes-Hut t-SNE<sup><xref ref-type="bibr" rid="CR24">24</xref></sup> to implement our proposed optimization techniques into a single workflow labeled ‘opt-SNE’ that includes KLD plateau monitoring and dataset size-specific learning rate step scaling (Table <xref rid="Tab2" ref-type="table">2</xref>). To compare opt-SNE to standard t-SNE and individual t-SNE parameter tuning results, we generated embeddings that were automatically finalized when (KLD<sub><italic>N</italic>−1</sub>–KLD<sub><italic>N</italic></sub>) &lt; KLD<sub><italic>N</italic></sub>/5000 (i.e., when each new iteration only improved KLD by less than 0.05%). When we moved from original C++ BH-tSNE to multi-core BH-tSNE<sup><xref ref-type="bibr" rid="CR24">24</xref></sup>, we observed a 2–3× boost in computation speed with no penalty in embedding quality, endpoint KLD values, or total number of iterations to reach endpoint KLD (Suppl. Fig. <xref rid="MOESM1" ref-type="media">4A</xref>). When compared with standard a t-SNE run in multicore enviroment, opt-SNE visualizations of both flow and mass cytometry data exhibited an additional 2× or greater speedup due to the smaller number of iterations needed to complete the data embedding (Fig. <xref rid="Fig5" ref-type="fig">5b</xref>, Suppl. Fig. <xref rid="MOESM1" ref-type="media">4B</xref>). This improvement in computation time scaled with dataset size, and almost no variation was observed when runs initiated from various random seeds were compared (Suppl. Fig. <xref rid="MOESM1" ref-type="media">4B-E</xref>). As discussed above, opt-SNE maps demonstrated superior quality compared to standard t-SNE embeddings when visually inspected. We also assessed the quality and accuracy of the embeddings quantitatively by comparing their endpoint KLD values and 1NN accuracy scores. opt-SNE embeddings achieved values of endpoint KLD that were significantly lower than in standard t-SNE (Fig. <xref rid="Fig5" ref-type="fig">5a, b</xref>) and such values were not reached by the standard t-SNE calculation even after 20,000 iterations, indicating better retention of multidimensional data structure. When compared on 1NN classifier accuracy, opt-SNE embeddings achieved better scores than embeddings produced with standard t-SNE methodology (Fig. <xref rid="Fig5" ref-type="fig">5c</xref>). Also, by the same metric, the KLD<sub><italic>N</italic></sub>/5000 endpoint criterion has proven to mark sufficiently long opt-SNE runs since no improvement of accuracy was observed when the embedding calculation continued beyond that point (Suppl. Fig. <xref rid="MOESM1" ref-type="media">4E</xref>). For further algorithm tuning at the discretion of the user, we incorporated automated opt-SNE termination as a tunable parameter that sets a fraction of KLD minimization per iteration.<table-wrap id="Tab2"><label>Table 2</label><caption><p>Summary of t-SNE optimizations proposed in opt-SNE workflow</p></caption><table frame="hsides" rules="groups"><thead><tr><th>Parameter</th><th>opt-SNE setup</th><th>Suggested use with cytometry data</th></tr></thead><tbody><tr><td>Gradient descent learning rate</td><td>Adaptive learning rate with initial value <italic>η</italic> <italic>=</italic> <italic>n</italic>/<italic>α</italic>, where <italic>n</italic> is the number of datapoints and <italic>α</italic> is the early exaggeration factor</td><td>Automated per dataset</td></tr><tr><td>Early exaggeration factor</td><td>Standard t-SNE setup considerations apply</td><td>4–12</td></tr><tr><td>Perplexity</td><td>Standard t-SNE setup considerations apply</td><td>30–50</td></tr><tr><td>Early exaggeration termination</td><td>KLD value (cost function) is monitored in real time, and early exaggeration is removed at maxKLDRC</td><td>Automated per dataset</td></tr><tr><td>t-SNE termination</td><td>KLD value (cost function) is monitored in real time and the embedding is finalized when (KLD<sub><italic>N</italic>−1</sub>−KLD<sub><italic>N</italic></sub>) &lt; KLD<sub><italic>N</italic></sub>/<italic>X</italic></td><td><italic>X</italic> = 5000</td></tr></tbody></table></table-wrap><fig id="Fig5"><label>Fig. 5</label><caption><p>Evaluation of opt-SNE embeddings. <bold>a</bold> Endpoint KLD values for standard t-SNE (initial learning rate step = 200, EE stop = 250 iterations) and opt-SNE (initial learning rate = n/<italic>α</italic>, EE stop at maxKLDRC iteration). <italic>N</italic> = 5 seeds used for random initialization; error bars denote SEM. <bold>b</bold> Post-EE graph of KLD minimization over physical time for standard t-SNE, adjusted parameter (as indicated) t-SNE and opt-SNE (representative examples of mass cytometry data embeddings are shown). <bold>c</bold> 1NN accuracy scores for standard t-SNE and opt-SNE embeddings of of mass cytometry (left) and flow cytometry (right) data per assigned class values (cell subsets, open circles; overal scores, filled circles). Representative examples of multiple runs initiated with varying seed values are shown</p></caption><graphic xlink:href="41467_2019_13055_Fig5_HTML" id="d29e1134"/></fig></p>
    </sec>
    <sec id="Sec8">
      <title>opt-SNE allows visualization of mega-scale single cell data</title>
      <p id="Par21">To test the performance of opt-SNE on even larger datasets, we used a 20.1 × 10<sup>6</sup> event fluorescent cytometry dataset concatenated from two independent batches of peripheral blood mononuclear cells (PBMC) samples (<italic>N</italic> = 27) stained with a variation of the OMIP-037 fluorescent cytometry panel<sup><xref ref-type="bibr" rid="CR25">25</xref></sup> that allows detailed assessment of multiple immune subsets including naïve and memory CD4<sup>+</sup>and CD8<sup>+</sup> T cells, NK cells, and γδ T cells (Fig. <xref rid="Fig6" ref-type="fig">6a, b</xref>). The embedding completed in 770 iterations with only 73 iterations required to pass the EE step (Suppl. Fig. <xref rid="MOESM1" ref-type="media">5A</xref>) and resulted in clear separation of cell clusters as evaluated by cell type annotation (Fig. <xref rid="Fig6" ref-type="fig">6c</xref>). The majority of clusters appear to be populated by cells from all subjects with the exceptions of several populations that contained sample-unique debris features (Fig. <xref rid="Fig6" ref-type="fig">6b</xref>, dashed arrows), confirming an absence of batch effects. A detailed breakdown of identified populations is presented in Fig. <xref rid="Fig6" ref-type="fig">6c</xref> that shows subsets of CD4<sup>+</sup> and CD8<sup>+</sup> T cells, NK cells, γδ T cells, B cells, and monocytes. Importantly, B cell and monocyte lineage markers were detected together with a viability dye in a dump channel in this panel and therefore could not be gated accurately via traditional biaxial plot analysis. However, opt-SNE helped to visualize these populations as clear cell groupings in the embedding analogously to their presence in the original high-dimensional space defined by the combination of several surface labels and light scatter characteristics, and the resulting opt-SNE islands were minimally mixed with dead cells. Use of the standard t-SNE algorithm on this dataset completely failed to reveal its structure, even with several thousands of iterations (Fig. <xref rid="Fig6" ref-type="fig">6d</xref>).<fig id="Fig6"><label>Fig. 6</label><caption><p>opt-SNE allows high-quality visualization of large cytometry and transcriptomics datasets. <bold>a</bold>–<bold>d</bold> 20 million datapoints from fluorescent cytometry dataset concatenated from 27 subjects vizualized in 2D space. <bold>a</bold>, <bold>c</bold> Cell type classes and density overlaid on 2D opt-SNE embedding. <bold>b</bold> Subject identifier overlaid on 2D opt-SNE embedding. Dashed arrows indicate clusters represented by datapoints from a single subject. <bold>d</bold> Standard t-SNE visualization (4000 iterations). <bold>e</bold>, <bold>f</bold> 10x Genomics mouse brain scRNA-seq dataset (1.3 million datapoints) visualized in 2D space with opt-SNE (<bold>e</bold>) or standard t-SNE (<bold>f</bold>). From left to right: density features, single gene classes, and Louvain clusters (0–38) overlays. <bold>g</bold> 5.22 million datapoints from mass cytometry dataset used in van Unen et al (2017) visualized in 2D space with opt-SNE. From left to right: CD4 expression overlaid on opt-SNE embedding; CCR7 and CD28 expression overlaid on CD4<sup>+</sup> opt-SNE cluster; CD45RA and CD56 expression intensity overlaid on CD4<sup>+</sup>CD28<sup>−</sup>CCR7<sup>−</sup> cluster. <bold>h</bold> CD4<sup>+</sup>CD28<sup>−</sup>CCR7<sup>−</sup> cells from control, celiac disease (CeD), refractory celiac disease (RCeD) and Crohn’s disease (CrohnD) subjects presented on density plots. Dashed encirclements indicate CD45RA<sup>+</sup> and CD56<sup>+</sup> areas of the cluster as defined in <bold>g</bold>. <bold>i</bold> Hierarchical t-SNE (HSNE) embedding of the CD4 (left) and CD4<sup>+</sup>CD28<sup>−</sup> cluster (right) reproduced from van Unen et al.<sup><xref ref-type="bibr" rid="CR7">7</xref></sup> (licensed under a Creative Commons Attribution 4.0; <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>). Color indicates marker expression intensity</p></caption><graphic xlink:href="41467_2019_13055_Fig6_HTML" id="d29e1278"/></fig></p>
      <p id="Par22">To test the suitability of opt-SNE for applications beyond flow and mass cytometry, we analyzed a 1.3 × 10<sup>6</sup> cell single cell RNA-seq dataset of mouse embryonic brain cells published by 10x Genomics. We used pre-calculated PCA projections included in the dataset to generate opt-SNE maps that we compared with 10x Genomics standard t-SNE embedding (Fig. <xref rid="Fig6" ref-type="fig">6e</xref>). 10x Genomics used EE = 1000/total 4000 iterations of standard t-SNE while we used opt-SNE settings with <italic>η</italic> = 97,959, EE = 66/total 885 iterations (Suppl. Fig. <xref rid="MOESM1" ref-type="media">5B</xref>). Non-immune single cell transcriptomics data are more difficult to interpret with ground-truth classes since much fewer scRNA-seq markers can be easily interpreted for population identification. Therefore, we utilized both single gene classification and classification through the Louvain clustering algorithm using the Scanpy Python package<sup><xref ref-type="bibr" rid="CR26">26</xref></sup> to annotate the data. While opt-SNE and t-SNE both capture the macro-structure illustrated by gene overlays, several Louvain clusters (3, 18, 19, 25, 28) appear partially or completely overlapped by other clusters in standard t-SNE but not in the opt-SNE embedding. Therefore, opt-SNE allowed equivalent or superior resolution of single cell transcriptomics data as with standard t-SNE but with ~5× smaller iteration time (885 iterations of opt-SNE vs. 4000 iterations of standard t-SNE).</p>
      <p id="Par23">HSNE (hierarchical SNE) is a t-SNE adaptation that was recently reported to facilitate analysis of large datasets by constructing a hierarchy of embeddings that can be explored from the overview of landmark populations up to a single cell level or resolution<sup><xref ref-type="bibr" rid="CR7">7</xref>,<xref ref-type="bibr" rid="CR17">17</xref></sup>. To directly compare HSNE and opt-SNE, we applied opt-SNE to the 5.2 million point dataset that was reported in HSNE analysis of mass cytometry data<sup><xref ref-type="bibr" rid="CR7">7</xref></sup>, and compared opt-SNE visualization to the full resolution level of HSNE embedding (Fig. <xref rid="Fig6" ref-type="fig">6g</xref>, Suppl. Fig. <xref rid="MOESM1" ref-type="media">6</xref>). In the CD4<sup>+</sup> subset, opt-SNE visualization revealed two groups of CD4<sup>+</sup>CD28<sup>−</sup> cells likely representing terminally differentiated memory CD4<sup>+</sup> T cells<sup><xref ref-type="bibr" rid="CR27">27</xref></sup> with different levels of CCR7 expression that may reflect distinct differentiation states of the two populations. While HSNE allowed identification of CD4<sup>+</sup>CD28<sup>−</sup>CCR7<sup>−</sup> cells, it was unable to visualize the CD4<sup>+</sup>CD28<sup>−</sup>CCR7<sup>+</sup> cells as a single cluster and projected these cells sparsely in the CD4<sup>+</sup> island (Fig. <xref rid="Fig6" ref-type="fig">6i</xref>, left). Also, both algorithms projected heterogenous expression of CD56 in CD4<sup>+</sup>CD28<sup>−</sup>CCR7<sup>−</sup> cells, but HSNE embedding did not resolve separate CD56<sup>+</sup> and CD56<sup>−</sup> clusters within CD4<sup>+</sup>CD28<sup>−</sup>CCR7<sup>− </sup> cells, loosely mapping them to the poles of the single round cluster (Fig. <xref rid="Fig6" ref-type="fig">6i</xref>, right). However, opt-SNE embedding visualized both the CD56+ and CD56− clusters and the disparate CD45RA expression within each cluster, revealing distinct phenotypes for the control and diseased subject groups (Fig. <xref rid="Fig6" ref-type="fig">6h</xref>). Also, the opt-SNE maps revealed that the CD56<sup>+</sup>CD45RA<sup>−</sup> cells in the cluster originate from several subjects with Crohn’s disease (Fig. <xref rid="Fig6" ref-type="fig">6h</xref>). In summary, these results confirm that opt-SNE embedding provides superior visualization quality for complex cytometry data.</p>
    </sec>
  </sec>
  <sec id="Sec9" sec-type="discussion">
    <title>Discussion</title>
    <p id="Par24">Visual exploration of data drives hypothesis formation and/or serendipitous discoveries; therefore, t-SNE is an extremely valuable tool for data comprehension. It is often used to facilitate data perception when hypothesis generation is automated by robust computational methods<sup><xref ref-type="bibr" rid="CR11">11</xref>,<xref ref-type="bibr" rid="CR28">28</xref></sup>. Comparison of t-SNE embeddings from multiple experimental conditions, timepoints, or subjects is invaluable to visualize sample-to-sample differences including disease hallmarks and longitudinal observations<sup><xref ref-type="bibr" rid="CR29">29</xref></sup>. t-SNE is also valuable for quality assessment of data, when abnormal clustering can be traced back to sample preparation, data acquisition, and preprocessing artifacts<sup><xref ref-type="bibr" rid="CR30">30</xref></sup>. Therefore, batch embedding of multiple experimental points is essential for sample comparison and can only be enabled when t-SNE accommodates large datasets.</p>
    <p id="Par25">t-SNE was first introduced in cytometry research as a tool to visualize CyTOF data, since fluorescence-based high-parameter datasets were less common at that time. With recent advances in instrumentation and reagent availability, flow cytometry datasets with &gt;20 parameters are quickly becoming prevalent and even standard in the field<sup><xref ref-type="bibr" rid="CR31">31</xref>–<xref ref-type="bibr" rid="CR33">33</xref></sup>, yet the proper data assessment tools are lacking for general use. DNA-barcoded antibodies have been recently utilized to allow simultaneous protein-epitope and transcriptome measurements in single cells<sup><xref ref-type="bibr" rid="CR34">34</xref></sup> thus expanding the repertoire of traditional cytometry methods that could employ t-SNE as a staple method of data visualization and presentation.</p>
    <p id="Par26">One approach to large dataset t-SNE embedding is to model visualization with a subset of datapoints curated<sup><xref ref-type="bibr" rid="CR7">7</xref>,<xref ref-type="bibr" rid="CR17">17</xref></sup> or randomly selected (as implemented in cytometry data analysis platforms such as FCS Express and Gemstone) from the nearest neighbor graph. Such techniques may fail to project extremely rare datapoints, as demonstrated by the CD4<sup>+</sup>CD28<sup>−</sup>CCR7<sup>+</sup>cells that were identified via use of opt-SNE, but not HSNE, in the van Unen et al dataset<sup><xref ref-type="bibr" rid="CR7">7</xref></sup> (Fig. <xref rid="Fig6" ref-type="fig">6g</xref>). This T cell subset was significantly less abundant in subjects with severe inflammatory conditions including Crohn’s disease as compared to controls (Suppl. Fig. <xref rid="MOESM1" ref-type="media">6</xref>). However, the cells expressing the CD4<sup>+</sup>CD28<sup>−</sup>CCR7<sup>−</sup> phenotype, while also low in frequency in most PBMC samples (&lt;1% of all CD4<sup>+</sup> cells), was likely successfully clustered by HSNE because two of the 11 Crohn disease subjects in the dataset showed an unusually high frequency of this population (40.7% and 31.0% of all CD4<sup>+</sup> cells), allowing it to be well represented in the kNN graph of the full dataset.</p>
    <p id="Par27">Several attempts to successfully apply t-SNE-like methods to massive datasets have been recently reported including aforenoted HSNE<sup><xref ref-type="bibr" rid="CR7">7</xref>,<xref ref-type="bibr" rid="CR17">17</xref>,<xref ref-type="bibr" rid="CR35">35</xref></sup>, LargeVis<sup><xref ref-type="bibr" rid="CR8">8</xref></sup>, and net-SNE<sup><xref ref-type="bibr" rid="CR36">36</xref></sup>. When applied to large datasets, these methods often require and/or benefit from considerable computational resources; for instance, the LargeVis study was performed on a 512 GB RAM, 32 core station. However, it is ideal for such data analysis to be performed successfully with the computational resources found in most laboratories. We benchmarked our opt-SNE modification of multicore t-SNE C++ implementation on a quad-core, 16GB RAM workstation although even further improvement in computation speed would occur if more cores were available. FIt-SNE, a recently published alternative to Barnes-Hut t-SNE that uses fast Fourier transform for much faster computation of repulsive forces approximation<sup><xref ref-type="bibr" rid="CR18">18</xref></sup>, renders opt-SNE even more feasible on personal computers. Notably, we have not observed differences in quality between embeddings generated with fast Fourier transform vs. Barnes-Hut approximations when opt-SNE parameter adjustments were used to compute the visualization (Suppl. Fig. <xref rid="MOESM1" ref-type="media">7</xref>). Therefore, we expect opt-SNE to be applicable for existing or future adaptations of t-SNE even if alternative methods of computation are utilized<sup><xref ref-type="bibr" rid="CR37">37</xref>,<xref ref-type="bibr" rid="CR38">38</xref></sup> provided that they retain the core principles of t-SNE embedding. A promising approach that may be integrated with opt-SNE is the smart EE adjustment implemented in A-tSNE (approximated t-SNE)<sup><xref ref-type="bibr" rid="CR35">35</xref></sup> algorithm where EE is removed gradually and on a per-point basis. Cytosplore, a novel software platform that includes HSNE and A-tSNE, allows the analyst to interactively initiate the local refinement of the map, resulting in a significant improvement in computation time<sup><xref ref-type="bibr" rid="CR7">7</xref></sup>.</p>
    <p id="Par28">Often compared to t-SNE, Uniform Manifold Approximation and Projection (UMAP) is a recently developed novel technique for dimension reduction that can be successfully applied to cytometry datasets<sup><xref ref-type="bibr" rid="CR9">9</xref></sup>. As has been the case for other groups<sup><xref ref-type="bibr" rid="CR9">9</xref>,<xref ref-type="bibr" rid="CR21">21</xref></sup>, our comparison of t-SNE and opt-SNE to UMAP generated mixed results. Specifically, we found that UMAP parameter selection had dramatic effects on UMAP computation performance and embedding quality assessed by both human perception and 1NN classifier accuracy (Supp. Fig. <xref rid="MOESM1" ref-type="media">8A-E</xref>). When benchmarked for resource use in the Omiq cloud, UMAP consumed up to 128 GB of RAM when embedding 5.2 million cell van Unen dataset, while opt-SNE and FIt-SNE peaked at 16 GB RAM consumption; the UMAP embedding took a comparable amount of time to complete as opt-SNE. With careful parameter selection, UMAP accuracy was approaching, but not surpassing, opt-SNE accuracy (Supp. Fig. <xref rid="MOESM1" ref-type="media">8A, B</xref>).</p>
    <p id="Par29">Similar to other types of biological data, the structure of cytometry data is difficult to project due to its mixed nature, often comprised of cluster-like, manifold-like and/or hierarchical components<sup><xref ref-type="bibr" rid="CR30">30</xref>,<xref ref-type="bibr" rid="CR39">39</xref></sup>. In this paper we propose multiple techniques that are essential for superior quality t-SNE data projection and are all germane to the fine-tuning of the early exaggeration phase of t-SNE embedding. EE facilitates cluster formation on a 2D plane<sup><xref ref-type="bibr" rid="CR1">1</xref>,<xref ref-type="bibr" rid="CR40">40</xref></sup> and serves as a necessary compromise that allows clusters to escape the crowding effect. We designed an efficient measure to ensure that the cluster-like global structure of the data is fully revealed during the EE phase by monitoring the KLD output of the embedding in real time. As indicated by the lower KLD values of opt-SNE embedding where EE was limited to fewer iterations (Fig. <xref rid="Fig4" ref-type="fig">4e</xref>), prolonged amplification of the attractive forces that drive tight cluster formation in EE may be detrimental for the manifold-like local data structure represented by signal distributions that are continuous with background signal. These ‘continuum expression’ molecules include proteins used to define classic immune cell subsets as well as markers indicating disease phenotypes, cell activation, and/or exhaustion state<sup><xref ref-type="bibr" rid="CR41">41</xref></sup>. Conversely, the non-exaggerated phase of t-SNE allows local data structures to be revealed<sup><xref ref-type="bibr" rid="CR1">1</xref></sup>. Therefore, cytometry data analysis would be missing valuable information if we reduced t-SNE applicability to finding only well separated clusters, especially since other techniques would perform this task better and faster. However, some workflows call for t-SNE pre-processing to facilitate extraction of cluster features from multidimensional data<sup><xref ref-type="bibr" rid="CR5">5</xref>,<xref ref-type="bibr" rid="CR42">42</xref></sup>. In those cases, it may be helpful to adapt the opt-SNE toolkit to terminate the embedding calculation immediately at the EE stop iteration and re-assess the high-dimensional structure within each cluster. Alternatively, a ‘late exaggeration’ approach<sup><xref ref-type="bibr" rid="CR21">21</xref>,<xref ref-type="bibr" rid="CR38">38</xref></sup> can be cautiously applied to create very tight clusters, although in our experience this approach was only marginally beneficial for global structure representation while detrimental for local structure (Suppl. Fig. <xref rid="MOESM1" ref-type="media">9</xref>). Interestingly, UMAP embeddings also presented a challenge to perceive both cluster data structure and continuum marker expression data structure within the same embedding, as increasing the number of neighbors and decreasing the minimum distance parameters seemed to benefit the former but penalize the latter task (Suppl. Fig. <xref rid="MOESM1" ref-type="media">8C-E</xref> and<sup><xref ref-type="bibr" rid="CR21">21</xref></sup>). These results suggest that UMAP is highly promising but not yet readily available to replace t-SNE as the state-of-the-art method for cytometry data visualization.</p>
    <p id="Par30">It is advisable to note that certain data structures, such as cluster hierarchy, cannot be revealed with t-SNE<sup><xref ref-type="bibr" rid="CR43">43</xref>,<xref ref-type="bibr" rid="CR44">44</xref></sup>. t-SNE accessibility in cytometry analysis software lead to its not infrequent misuse with cytometry data, evident when the cluster-like structure is not prominent in the map. Therefore, the features identified from t-SNE embedding in its current form should be verified with alternative methods when possible for confirmational purposes. Im et al also suggest that if a continuous manifold structure exists in the data, large perplexity values may cause artificial breaks (overclustering)<sup><xref ref-type="bibr" rid="CR44">44</xref></sup>. The perplexity values commonly used in cytometry analysis are on the lower end of the suggested range for efficient clustering, as it is often advised to scale the number of nearest neighbors to the average cluster size<sup><xref ref-type="bibr" rid="CR45">45</xref>;</sup> however, if computationally feasible, higher perplexity values might facilitate feature preservation for markers whose expression is not bimodally distributed. To preserve global geometry, Kobak et al<sup><xref ref-type="bibr" rid="CR21">21</xref></sup> propose to perform the embedding in two steps and use the kNN-based extrapolation of a high-perplexity t-SNE of a subset of the large dataset as initialization to run the t-SNE of the whole dataset.</p>
    <p id="Par31">In summary, opt-SNE is a powerful optimization toolkit that subverts major limitations of t-SNE for use with cytometric datasets and thus enables novel data-driven findings in single cell research.</p>
  </sec>
  <sec id="Sec10">
    <title>Methods</title>
    <sec id="Sec11">
      <title>Datasets</title>
      <p id="Par32">All datasets used in the study are summarized in Table <xref rid="Tab1" ref-type="table">1</xref>.</p>
    </sec>
    <sec id="Sec12">
      <title>Data pre-processing</title>
      <p id="Par33">Singlet events from several data recordings were digitally concatenated and a randomly subsampled file of 1,000,000 mass<sup><xref ref-type="bibr" rid="CR46">46</xref></sup> or flow cytometry<sup><xref ref-type="bibr" rid="CR47">47</xref></sup> events was created and used for analyses of the mass41parameter and flow18parameter datasets. All observations from 27 recordings of flow cytometry data were concatenated to generate the flow20M dataset. All observations from 104 recordings of mass cytometry data<sup><xref ref-type="bibr" rid="CR7">7</xref></sup> were concatenated to generate the van Unen et al dataset.</p>
      <p id="Par34">All flow cytometry data were compensated with acquisition-defined compensation matrices. Prior to t-SNE analysis, all cytometry data were transformed using asinh (with cofactor 5 for mass cytometry data and with cofactor 150 for flow14parameter data) or biexponential (flow20M) transformation. Light scatter parameters were log-transformed.</p>
    </sec>
    <sec id="Sec13">
      <title>The standard t-SNE configuration for cytometry applications</title>
      <p id="Par35">t-SNE computes low-dimensional coordinates of high-dimensional data resulting in similar and dissimilar data points in the raw data space placed proximally and at a distance, respectively, in the dimensionally reduced map<sup><xref ref-type="bibr" rid="CR2">2</xref></sup>. This map placement is achieved via t-SNE modeling the probabilities as a Gaussian distribution around each data point in the high-dimensional space and modeling the target distribution of pairwise similarities in the lower-dimensional space using Cauchy distribution (Student t-distribution with 1 degree of freedom). Then, the Kullback-Leibler Divergence (KLD) between the distributions is iteratively minimized via gradient descent. The gradient computation is essentially an N-body simulation problem with attractive forces (approximated to nearest neighbors using vantage-point trees) pulling similar points together and repulsive forces (approximated at each iteration using the Barnes-Hut algorithm) pushing dissimilar points apart.</p>
      <p id="Par36">An important part of t-SNE gradient descent computation is the early exaggeration (EE) that was proposed by van der Maaten and Hinton<sup><xref ref-type="bibr" rid="CR1">1</xref></sup> to battle the so called overcrowding artifact of embedding. With EE, all probabilities modeling distances in high-dimensional space are multiplied by a factor (early exaggeration factor, EEF, or <italic>α</italic>) for the duration of the EE phase (typically 250, or 25% of the total number of iterations). EE coerces data to form tight and widely separated clusters in the map and is considered to enable the map to find a better global structure.</p>
      <p id="Par37">Multiple software platforms incorporate the BH-tSNE algorithm specifically for analysis of cytometry data, including commonly used cytometry analysis desktop packages (FlowJo, FCS Express), and the cloud-based analysis platform Cytobank. Also, implementations of t-SNE are available as open-source packages in popular programming languages such as R (rtsne) and Python (sci-kit learn). Most of implementations wrap or re-write original C++ code of Barnes-Hut t-SNE<sup><xref ref-type="bibr" rid="CR2">2</xref></sup> and produce comparable analysis results upon direct comparison. Here, we customized the standard t-SNE C++ code to implement the parameter adjustments described in this work and published this customization as an open source solution to enable the research community to use this optimized t-SNE algorithm. Also, the equivalent adjustments of t-SNE have been made available as a cloud application in Omiq and integrated into FlowJo and SeqGeq programs.</p>
    </sec>
    <sec id="Sec14">
      <title>Data analysis</title>
      <p id="Par38">A desktop C++ Barnes-Hut implementation of t-SNE for Mac OS was used for t-SNE analyses<sup><xref ref-type="bibr" rid="CR2">2</xref></sup> with original implementation adapted to allow user input for the early exaggeration stop iteration, perplexity, total number of iterations, early exaggeration factor value, and learning rate value. A multicore modification of Barnes-Hut t-SNE<sup><xref ref-type="bibr" rid="CR24">24</xref></sup> was used as a source for building the opt-SNE package with user-accessible parameters similar to listed above. The Kullback-Leibler Divergence (KLD) value and t-SNE coordinates were reported during each iteration or as frequently as requested. All datasets were embedded in 2D space. Visually comparable t-SNE maps were generated with the same random seed values used when permutations for specific parameters were tested and compared; all experiments were repeated with several values of random seed. Benchmarking data were generated on an iMac personal station with Intel Core i7 quad-core i7 processor and 16 GB of RAM. For cross-validation, we utilized cloud-based Cytobank<sup><xref ref-type="bibr" rid="CR48">48</xref></sup>, cloud-based Omiq, FlowJo V10.3–10.5 and FlowJo V9.9.6. R flowcore package, Cytobank and FlowJo were used to generate FCS files and graphical outputs from tabular data. Omiq platform was used for FlowSOM<sup><xref ref-type="bibr" rid="CR11">11</xref></sup>, FIt-SNE (Fast Fourier Transform-accelerated Interpolation-based t-SNE<sup><xref ref-type="bibr" rid="CR18">18</xref></sup>) and UMAP (Uniform Manifold Approximation and Projection)<sup><xref ref-type="bibr" rid="CR9">9</xref></sup> analyses. Also, the FIt-SNE plugin for FlowJo and FIt-SNE prototype in FlowJo were used to ensure FIt-SNE compatibility with opt-SNE. Logs of t-SNE runs were batch-processed with VBA scripts and analyzed with GraphPad Prism. Expert-guided (manual) analysis of cell populations was performed in FlowJo 10.3–10.5 as described previously for specific datasets<sup><xref ref-type="bibr" rid="CR25">25</xref>,<xref ref-type="bibr" rid="CR46">46</xref></sup> (Suppl. Figs. <xref rid="MOESM1" ref-type="media">10</xref>–<xref rid="MOESM1" ref-type="media">11</xref>) and used for map annotations as cluster classes.</p>
      <p id="Par39">We used SeqGeq 1.3 for scRNAseq analysis and leveraged PCA projections provided in the 10x Genomics dataset to calculate the t-SNE embedding and annotated it using marker genes for major cell types. Louvain cluster classification was adopted from the SCANPY data analysis study<sup><xref ref-type="bibr" rid="CR26">26</xref></sup>.</p>
      <p id="Par40">The quality of embedding was assessed by a 1-nearest neighbor (1NN) classifier based on previous reports on t-SNE accuracy evaluation<sup><xref ref-type="bibr" rid="CR1">1</xref>,<xref ref-type="bibr" rid="CR2">2</xref>,<xref ref-type="bibr" rid="CR8">8</xref></sup>. The classifier was written in R (version 3.5.0). For each invocation, the classifier was provided a complete embedding and an accompanying array of assigned class values for each observation in the embedding. Ten thousand cells were sampled from the embedding as a training set using uniform pseudorandom sampling with the “sample” function from base R. Next, a set of 50,000 cells disjoint to the training set was sampled from the embedding as the test set. Each cell in the test set was then mapped to its single nearest neighbor within the test set and assigned the class of that neighbor using the “knn” function of the “FNN” R package (version 1.1.3, available on CRAN). The number of correct class assignments in the test set was calculated on a total basis and also on a per-class basis using the supplied class values. This process was repeated five times for the provided embedding using different seeds for the sampling step. Replacement was allowed for pseudorandom sampling between the five internal repeat runs. The results were then presented as the average of these five repetitions. The seeds used for the five repetitions were kept consistent such that classification results between different embeddings of the same dataset tested the same cells.</p>
    </sec>
    <sec id="Sec15">
      <title>Reporting summary</title>
      <p id="Par41">Further information on research design is available in the <xref rid="MOESM3" ref-type="media">Nature Research Reporting Summary</xref> linked to this article.</p>
    </sec>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary information</title>
    <sec id="Sec16">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="41467_2019_13055_MOESM1_ESM.pdf">
            <caption>
              <p>Supplementary Information</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM2">
          <media xlink:href="41467_2019_13055_MOESM2_ESM.pdf">
            <caption>
              <p>Peer Review File</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM3">
          <media xlink:href="41467_2019_13055_MOESM3_ESM.pdf">
            <caption>
              <p>Reporting Summary</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <fn-group>
    <fn>
      <p><bold>Peer review information</bold><italic>Nature Communications</italic> thanks El-ad David Amir and the other, anonymous, reviewer(s) for their contribution to the peer review of this work. Peer reviewer reports are available</p>
    </fn>
    <fn>
      <p><bold>Publisher’s note</bold> Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <sec>
    <title>Supplementary information</title>
    <p><bold>Supplementary information</bold> is available for this paper at 10.1038/s41467-019-13055-y.</p>
  </sec>
  <ack>
    <title>Acknowledgements</title>
    <p>The authors would like to thank Yvan Saeys, Gary Kazantsev, Jonathan Irish, Dmitry Kobak, Allison Irvine and Katherine Drake for helpful discussions, and Geoff Kraker for technical assistance. We thank Sean Bendall from Stanford University and Vincent van Unen from Leiden University Medical Center for sharing their data, and Brian Tilton and Riley Pihl from BUSM Flow Cytometry Core Facility for assistance with data collection at BUSM. Anna C. Belkina is an ISAC (International Society for Advancement of Cytometry) SRL Emerging Leader and thanks the ISAC organization and members for continuous support and encouragement. Josef Spidlen is an ISAC Marylou Ingram Scholar.</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Author contributions</title>
    <p>A.C.B. has conceived the study. A.C.B. and C.O.C. developed the opt-SNE method. C.O.C. developed implementation in C++; and R.H. and J.S. developed implementation in FlowJo and SeqGeq. A.C.B. has analyzed flow and mass cytometry datasets. R.H. and J.S. have analyzed the scRNA-seq dataset. R.A. and J.S.C. provided conceptual input. A.C.B. wrote the paper. All authors discussed the results and commented on the paper.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Code availability</title>
    <p>Open source multicore t-SNE C++ implementation and usage instructions are available at <ext-link ext-link-type="uri" xlink:href="https://github.com/omiq-ai/Multicore-opt-SNE">https://github.com/omiq-ai/Multicore-opt-SNE.</ext-link> Cloud version of opt-SNE is available at <ext-link ext-link-type="uri" xlink:href="http://www.omiq.ai/opt-SNE">http://www.omiq.ai/opt-SNE</ext-link>. opt-SNE is natively supported within the FlowJo data analysis software version 10.6 and later, and the SeqGeq version 1.5 or later, both downloadable from <ext-link ext-link-type="uri" xlink:href="http://www.flowjo.com">http://www.flowjo.com</ext-link>. The code of modified van der Maaten BH-tSNE C++ implementation with user-accessible parameters is available upon request.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Data availability</title>
    <p>Flow18parameters and mass41parameters datasets are available via FigShare at 10.6084/m9.figshare.9927986.v1. Van Unen et al. dataset<sup><xref ref-type="bibr" rid="CR7">7</xref></sup> is available at <ext-link ext-link-type="uri" xlink:href="http://flowrepository.org/id/FR-FCM-ZYRM">http://flowrepository.org/id/FR-FCM-ZYRM</ext-link>. 10XGenomics 1.3M scRNA-seq dataset is available at <ext-link ext-link-type="uri" xlink:href="https://support.10xgenomics.com/single-cell-gene-expression/datasets">https://support.10xgenomics.com/single-cell-gene-expression/datasets</ext-link>.</p>
  </notes>
  <notes notes-type="COI-statement">
    <title>Competing interests</title>
    <p id="Par42">C.O.C. is a founder of Omiq, Inc. R.H. and J.S. are employees of Beckton Dickinson (BD); FlowJo is a subsidiary of BD. The remaining authors declare no competing interests.</p>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>van der Maaten</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Hinton</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>Visualizing data using t-SNE</article-title>
        <source>J. Mach. Learn. Res.</source>
        <year>2008</year>
        <volume>9</volume>
        <fpage>85</fpage>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>van der Maaten</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <article-title>Accelerating t-SNE using tree-based algorithms</article-title>
        <source>J. Mach. Learn. Res.</source>
        <year>2014</year>
        <volume>15</volume>
        <fpage>3221</fpage>
        <lpage>3245</lpage>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Amir el</surname>
            <given-names>AD</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>viSNE enables visualization of high dimensional single-cell data and reveals phenotypic heterogeneity of leukemia</article-title>
        <source>Nat. Biotechnol.</source>
        <year>2013</year>
        <volume>31</volume>
        <fpage>545</fpage>
        <lpage>552</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.2594</pub-id>
        <pub-id pub-id-type="pmid">23685480</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wong</surname>
            <given-names>MT</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Mapping the diversity of follicular helper t cells in human blood and tonsils using high-dimensional mass cytometry analysis</article-title>
        <source>Cell Rep.</source>
        <year>2015</year>
        <volume>11</volume>
        <fpage>1822</fpage>
        <lpage>1833</lpage>
        <pub-id pub-id-type="doi">10.1016/j.celrep.2015.05.022</pub-id>
        <pub-id pub-id-type="pmid">26074076</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Becher</surname>
            <given-names>B</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>High-dimensional analysis of the murine myeloid cell system</article-title>
        <source>Nat. Immunol.</source>
        <year>2014</year>
        <volume>15</volume>
        <fpage>1181</fpage>
        <lpage>1189</lpage>
        <pub-id pub-id-type="doi">10.1038/ni.3006</pub-id>
        <pub-id pub-id-type="pmid">25306126</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chen</surname>
            <given-names>H</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Cytofkit: a bioconductor package for an integrated mass cytometry data analysis pipeline</article-title>
        <source>PLoS Comput. Biol.</source>
        <year>2016</year>
        <volume>12</volume>
        <fpage>e1005112</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pcbi.1005112</pub-id>
        <pub-id pub-id-type="pmid">27662185</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>van Unen</surname>
            <given-names>V</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Visual analysis of mass cytometry data by hierarchical stochastic neighbour embedding reveals rare cell types</article-title>
        <source>Nat. Commun.</source>
        <year>2017</year>
        <volume>8</volume>
        <fpage>1740</fpage>
        <pub-id pub-id-type="doi">10.1038/s41467-017-01689-9</pub-id>
        <pub-id pub-id-type="pmid">29170529</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <mixed-citation publication-type="other">Tang, J., Liu, J., Zhang, M. &amp; Mei, Q. <italic>Proceedings of the 25th International Conference on World Wide Web</italic> 287–297 (International World Wide Web Conferences Steering Committee, Montreal, Quebec, Canada, 2016).</mixed-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <mixed-citation publication-type="other">McInnes, L., Healy, J. &amp; Melville, J. UMAP: Uniform Manifold Approximation and Projection for Dimension Reduction. Preprint at arXiv:1802.03426 (2018).</mixed-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <mixed-citation publication-type="other">Kratochvíl, M. et al. SOM-based embedding improves efficiency of high-dimensional cytometry data analysis. Preprint at bioRxiv <ext-link ext-link-type="uri" xlink:href="https://www.biorxiv.org/node/542341">https://www.biorxiv.org/node/542341</ext-link> (2019).</mixed-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Van Gassen</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>FlowSOM: using self-organizing maps for visualization and interpretation of cytometry data</article-title>
        <source>Cytom. A</source>
        <year>2015</year>
        <volume>87</volume>
        <fpage>636</fpage>
        <lpage>645</lpage>
        <pub-id pub-id-type="doi">10.1002/cyto.a.22625</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Levine</surname>
            <given-names>JH</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Data-driven phenotypic dissection of AML reveals progenitor-like cells that correlate with prognosis</article-title>
        <source>Cell</source>
        <year>2015</year>
        <volume>162</volume>
        <fpage>184</fpage>
        <lpage>197</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2015.05.047</pub-id>
        <pub-id pub-id-type="pmid">26095251</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Donnenberg</surname>
            <given-names>AD</given-names>
          </name>
          <name>
            <surname>Donnenberg</surname>
            <given-names>VS</given-names>
          </name>
        </person-group>
        <article-title>Rare-event analysis in flow cytometry</article-title>
        <source>Clin. Lab. Med.</source>
        <year>2007</year>
        <volume>27</volume>
        <fpage>627</fpage>
        <lpage>652</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cll.2007.05.013</pub-id>
        <pub-id pub-id-type="pmid">17658410</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>DiGiuseppe</surname>
            <given-names>JA</given-names>
          </name>
          <name>
            <surname>Tadmor</surname>
            <given-names>MD</given-names>
          </name>
          <name>
            <surname>Pe’er</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>Detection of minimal residual disease in B lymphoblastic leukemia using viSNE</article-title>
        <source>Cytom. Part B Clin. Cytom.</source>
        <year>2015</year>
        <volume>88</volume>
        <fpage>294</fpage>
        <lpage>304</lpage>
        <pub-id pub-id-type="doi">10.1002/cyto.b.21252</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lin</surname>
            <given-names>L</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Identification and visualization of multidimensional antigen-specific T-cell populations in polychromatic cytometry data</article-title>
        <source>Cytom. A</source>
        <year>2015</year>
        <volume>87</volume>
        <fpage>675</fpage>
        <lpage>682</lpage>
        <pub-id pub-id-type="doi">10.1002/cyto.a.22623</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hirakawa</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Low-dose IL-2 selectively activates subsets of CD4(+) Tregs and NK cells</article-title>
        <source>JCI Insight</source>
        <year>2016</year>
        <volume>1</volume>
        <fpage>e89278</fpage>
        <pub-id pub-id-type="doi">10.1172/jci.insight.89278</pub-id>
        <pub-id pub-id-type="pmid">27812545</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pezzotti</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Höllt</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Lelieveldt</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Eisemann</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Vilanova</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Hierarchical Stochastic Neighbor Embedding</article-title>
        <source>Computer Graph. Forum</source>
        <year>2016</year>
        <volume>35</volume>
        <fpage>21</fpage>
        <lpage>30</lpage>
        <pub-id pub-id-type="doi">10.1111/cgf.12878</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Linderman</surname>
            <given-names>GC</given-names>
          </name>
          <name>
            <surname>Rachh</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Hoskins</surname>
            <given-names>JG</given-names>
          </name>
          <name>
            <surname>Steinerberger</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Kluger</surname>
            <given-names>Y</given-names>
          </name>
        </person-group>
        <article-title>Fast interpolation-based t-SNE for improved visualization of single-cell RNA-seq data</article-title>
        <source>Nat. Methods</source>
        <year>2019</year>
        <volume>16</volume>
        <fpage>243</fpage>
        <lpage>245</lpage>
        <pub-id pub-id-type="doi">10.1038/s41592-018-0308-4</pub-id>
        <pub-id pub-id-type="pmid">30742040</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <mixed-citation publication-type="other">Wattenberg, M. Viégas, F., Johnson, I. How to use t-SNE effectively. <italic>Distill</italic> <bold>1</bold>, e2 (2016).</mixed-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Weber</surname>
            <given-names>LM</given-names>
          </name>
          <name>
            <surname>Robinson</surname>
            <given-names>MD</given-names>
          </name>
        </person-group>
        <article-title>Comparison of clustering methods for high-dimensional single-cell flow and mass cytometry data</article-title>
        <source>Cytom. Part A</source>
        <year>2016</year>
        <volume>89</volume>
        <fpage>1084</fpage>
        <lpage>1096</lpage>
        <pub-id pub-id-type="doi">10.1002/cyto.a.23030</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <mixed-citation publication-type="other">Kobak, D. &amp; Berens, P. The art of using t-SNE for single-cell transcriptomics. <italic>Nat. Commun</italic><bold>10</bold>10.1038/s41467-019-13056-x (2019).</mixed-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jacobs</surname>
            <given-names>RA</given-names>
          </name>
        </person-group>
        <article-title>Increased rates of convergence through learning rate adaptation</article-title>
        <source>Neural Netw.</source>
        <year>1988</year>
        <volume>1</volume>
        <fpage>295</fpage>
        <lpage>307</lpage>
        <pub-id pub-id-type="doi">10.1016/0893-6080(88)90003-2</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <mixed-citation publication-type="other">Linderman, G. C. &amp; Steinerberger, S. Clustering with t-SNE, provably. Preprint at arXiv: 1706.02582 (2017).</mixed-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <mixed-citation publication-type="other">Ulyanov, D. Github. https://github.com/DmitryUlyanov/ (2016).</mixed-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Belkina</surname>
            <given-names>AC</given-names>
          </name>
          <name>
            <surname>Snyder-Cappione</surname>
            <given-names>JE</given-names>
          </name>
        </person-group>
        <article-title>OMIP-037: 16-color panel to measure inhibitory receptor signatures from multiple human immune cell subsets</article-title>
        <source>Cytom. A</source>
        <year>2017</year>
        <volume>91</volume>
        <fpage>175</fpage>
        <lpage>179</lpage>
        <pub-id pub-id-type="doi">10.1002/cyto.a.22983</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wolf</surname>
            <given-names>FA</given-names>
          </name>
          <name>
            <surname>Angerer</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Theis</surname>
            <given-names>FJ</given-names>
          </name>
        </person-group>
        <article-title>SCANPY: large-scale single-cell gene expression data analysis</article-title>
        <source>Genome Biol.</source>
        <year>2018</year>
        <volume>19</volume>
        <fpage>15</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-017-1382-0</pub-id>
        <pub-id pub-id-type="pmid">29409532</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mou</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Espinosa</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Lo</surname>
            <given-names>DJ</given-names>
          </name>
          <name>
            <surname>Kirk</surname>
            <given-names>AD</given-names>
          </name>
        </person-group>
        <article-title>CD28 negative T cells: is their loss our gain?</article-title>
        <source>Am. J. Transplant.</source>
        <year>2014</year>
        <volume>14</volume>
        <fpage>2460</fpage>
        <lpage>2466</lpage>
        <pub-id pub-id-type="doi">10.1111/ajt.12937</pub-id>
        <pub-id pub-id-type="pmid">25323029</pub-id>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Butler</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Hoffman</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Smibert</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Papalexi</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Satija</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Integrating single-cell transcriptomic data across different conditions, technologies, and species</article-title>
        <source>Nat. Biotechnol.</source>
        <year>2018</year>
        <volume>36</volume>
        <fpage>411</fpage>
        <pub-id pub-id-type="doi">10.1038/nbt.4096</pub-id>
        <pub-id pub-id-type="pmid">29608179</pub-id>
      </element-citation>
    </ref>
    <ref id="CR29">
      <label>29.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wogsland</surname>
            <given-names>CE</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Mass cytometry of follicular lymphoma tumors reveals intrinsic heterogeneity in proteins including HLA-DR and a deficit in nonmalignant plasmablast and germinal center B-Cell populations</article-title>
        <source>Cytom. Part B Clin. Cytom.</source>
        <year>2017</year>
        <volume>92</volume>
        <fpage>79</fpage>
        <lpage>87</lpage>
        <pub-id pub-id-type="doi">10.1002/cyto.b.21498</pub-id>
      </element-citation>
    </ref>
    <ref id="CR30">
      <label>30.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mazza</surname>
            <given-names>EMC</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Background fluorescence and spreading error are major contributors of variability in high-dimensional flow cytometry data visualization by t-distributed stochastic neighboring embedding</article-title>
        <source>Cytom. Part A</source>
        <year>2018</year>
        <volume>93</volume>
        <fpage>785</fpage>
        <lpage>792</lpage>
        <pub-id pub-id-type="doi">10.1002/cyto.a.23566</pub-id>
      </element-citation>
    </ref>
    <ref id="CR31">
      <label>31.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Staser</surname>
            <given-names>KW</given-names>
          </name>
          <name>
            <surname>Eades</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Choi</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Karpova</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>DiPersio</surname>
            <given-names>JF</given-names>
          </name>
        </person-group>
        <article-title>OMIP-042: 21-color flow cytometry to comprehensively immunophenotype major lymphocyte and myeloid subsets in human peripheral blood</article-title>
        <source>Cytom. A</source>
        <year>2018</year>
        <volume>93</volume>
        <fpage>186</fpage>
        <lpage>189</lpage>
        <pub-id pub-id-type="doi">10.1002/cyto.a.23303</pub-id>
      </element-citation>
    </ref>
    <ref id="CR32">
      <label>32.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mair</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Prlic</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>OMIP-044: 28-color immunophenotyping of the human dendritic cell compartment</article-title>
        <source>Cytom. A</source>
        <year>2018</year>
        <volume>93</volume>
        <fpage>402</fpage>
        <lpage>405</lpage>
        <pub-id pub-id-type="doi">10.1002/cyto.a.23331</pub-id>
      </element-citation>
    </ref>
    <ref id="CR33">
      <label>33.</label>
      <mixed-citation publication-type="other">Nettey, L., Giles, A. J. &amp; Chattopadhyay, P. K. OMIP-050: A 28-color/30-parameter fluorescence flow cytometry panel to enumerate and characterize cells expressing a wide array of immune checkpoint molecules. <italic>Cytometry A</italic><bold>93</bold>, 1094–1096 (2018).</mixed-citation>
    </ref>
    <ref id="CR34">
      <label>34.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Stoeckius</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Simultaneous epitope and transcriptome measurement in single cells</article-title>
        <source>Nat. Methods</source>
        <year>2017</year>
        <volume>14</volume>
        <fpage>865</fpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.4380</pub-id>
        <pub-id pub-id-type="pmid">28759029</pub-id>
      </element-citation>
    </ref>
    <ref id="CR35">
      <label>35.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pezzotti</surname>
            <given-names>N</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Approximated and user steerable tSNE for progressive visual analytics</article-title>
        <source>IEEE Trans. Vis. Comput. Graph</source>
        <year>2017</year>
        <volume>23</volume>
        <fpage>1739</fpage>
        <lpage>1752</lpage>
        <pub-id pub-id-type="doi">10.1109/TVCG.2016.2570755</pub-id>
        <pub-id pub-id-type="pmid">28113434</pub-id>
      </element-citation>
    </ref>
    <ref id="CR36">
      <label>36.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cho</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Berger</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Peng</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Generalizable and scalable visualization of single-cell data using neural networks</article-title>
        <source>Cell Syst.</source>
        <year>2018</year>
        <volume>7</volume>
        <fpage>185</fpage>
        <lpage>191 e184</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cels.2018.05.017</pub-id>
        <pub-id pub-id-type="pmid">29936184</pub-id>
      </element-citation>
    </ref>
    <ref id="CR37">
      <label>37.</label>
      <mixed-citation publication-type="other">Chan, D. M., Rao, R., Huang, F. &amp; Canny, J. F. GPU accelerated t-distributed stochastic neighbor embedding. <italic>Journal of Parallel and Distributed Computing</italic>, <bold>131</bold>, 1–13 (2019).</mixed-citation>
    </ref>
    <ref id="CR38">
      <label>38.</label>
      <mixed-citation publication-type="other">Linderman, G. C., Rachh, M., Hoskins, J. G., Steinerberger, S. &amp; Kluger, Y. Efficient algorithms for t-distributed stochastic neighborhood embedding. Preprint at <ext-link ext-link-type="uri" xlink:href="https://arxiv.org/abs/1712.09005">https://arxiv.org/abs/1712.09005</ext-link> (2017).</mixed-citation>
    </ref>
    <ref id="CR39">
      <label>39.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Finn</surname>
            <given-names>WG</given-names>
          </name>
          <name>
            <surname>Carter</surname>
            <given-names>KM</given-names>
          </name>
          <name>
            <surname>Raich</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Stoolman</surname>
            <given-names>LM</given-names>
          </name>
          <name>
            <surname>Hero</surname>
            <given-names>AO</given-names>
          </name>
        </person-group>
        <article-title>Analysis of clinical flow cytometric immunophenotyping data by clustering on statistical manifolds: Treating flow cytometry data as high-dimensional objects</article-title>
        <source>Cytom. Part B Clin. Cytom.</source>
        <year>2008</year>
        <volume>76B</volume>
        <fpage>1</fpage>
        <lpage>7</lpage>
      </element-citation>
    </ref>
    <ref id="CR40">
      <label>40.</label>
      <mixed-citation publication-type="other">Arora, S., Hu, W. &amp; Kothari, P. K. in Proceedings of the 31st Conference On Learning Theory, Vol. 75. (eds. Sébastien, B., Vianney, P. &amp; Philippe, R.) 1455–1462 (PMLR, Proceedings of Machine Learning Research, 2018).</mixed-citation>
    </ref>
    <ref id="CR41">
      <label>41.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chattopadhyay</surname>
            <given-names>PK</given-names>
          </name>
          <name>
            <surname>Roederer</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Cytometry: today’s technology and tomorrow’s horizons</article-title>
        <source>Methods</source>
        <year>2012</year>
        <volume>57</volume>
        <fpage>251</fpage>
        <lpage>258</lpage>
        <pub-id pub-id-type="doi">10.1016/j.ymeth.2012.02.009</pub-id>
        <pub-id pub-id-type="pmid">22391486</pub-id>
      </element-citation>
    </ref>
    <ref id="CR42">
      <label>42.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Shekhar</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Brodin</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Davis</surname>
            <given-names>MM</given-names>
          </name>
          <name>
            <surname>Chakraborty</surname>
            <given-names>AK</given-names>
          </name>
        </person-group>
        <article-title>Automatic classification of cellular expression by nonlinear stochastic embedding (ACCENSE)</article-title>
        <source>Proc. Natl Acad. Sci.</source>
        <year>2014</year>
        <volume>111</volume>
        <fpage>202</fpage>
        <pub-id pub-id-type="doi">10.1073/pnas.1321405111</pub-id>
        <pub-id pub-id-type="pmid">24344260</pub-id>
      </element-citation>
    </ref>
    <ref id="CR43">
      <label>43.</label>
      <mixed-citation publication-type="other">Amid, E. &amp; Warmuth, M. K. A more globally accurate dimensionality reduction method using triplets. Preprint at <ext-link ext-link-type="uri" xlink:href="https://arxiv.org/abs/1803.00854">https://arxiv.org/abs/1803.00854</ext-link> (2018).</mixed-citation>
    </ref>
    <ref id="CR44">
      <label>44.</label>
      <mixed-citation publication-type="other">Im, D. J., Verma, N. &amp; Branson, K. Stochastic neighbor embedding under f-divergences. Preprint at <ext-link ext-link-type="uri" xlink:href="https://arxiv.org/abs/1811.01247">https://arxiv.org/abs/1811.01247</ext-link> (2018).</mixed-citation>
    </ref>
    <ref id="CR45">
      <label>45.</label>
      <mixed-citation publication-type="other">Cao, Y. &amp; Wang, L. Automatic Selection of t-SNE Perplexity. Preprint at <ext-link ext-link-type="uri" xlink:href="https://arxiv.org/abs/1708.03229">https://arxiv.org/abs/1708.03229</ext-link> (2017).</mixed-citation>
    </ref>
    <ref id="CR46">
      <label>46.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bendall</surname>
            <given-names>SC</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Single-cell mass cytometry of differential immune and drug responses across a human hematopoietic continuum</article-title>
        <source>Science</source>
        <year>2011</year>
        <volume>332</volume>
        <fpage>687</fpage>
        <lpage>696</lpage>
        <pub-id pub-id-type="doi">10.1126/science.1198704</pub-id>
        <pub-id pub-id-type="pmid">21551058</pub-id>
      </element-citation>
    </ref>
    <ref id="CR47">
      <label>47.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Belkina</surname>
            <given-names>AC</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Multivariate computational analysis of gamma delta t cell inhibitory receptor signatures reveals the divergence of healthy and ART-suppressed HIV+ aging</article-title>
        <source>Front. Immunol.</source>
        <year>2018</year>
        <volume>9</volume>
        <fpage>2783</fpage>
        <pub-id pub-id-type="doi">10.3389/fimmu.2018.02783</pub-id>
        <pub-id pub-id-type="pmid">30568654</pub-id>
      </element-citation>
    </ref>
    <ref id="CR48">
      <label>48.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chen</surname>
            <given-names>TJ</given-names>
          </name>
          <name>
            <surname>Kotecha</surname>
            <given-names>N</given-names>
          </name>
        </person-group>
        <article-title>Cytobank: providing an analytics platform for community cytometry data analysis and collaboration</article-title>
        <source>Curr. Top. Microbiol. Immunol.</source>
        <year>2014</year>
        <volume>377</volume>
        <fpage>127</fpage>
        <lpage>157</lpage>
        <?supplied-pmid 24590675?>
        <pub-id pub-id-type="pmid">24590675</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
