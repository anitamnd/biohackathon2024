<?properties open_access?>
<?properties manuscript?>
<?origin nihpa?>
<?iso-abbr Nat. Methods?>
<?submitter-system nihms?>
<?submitter-canonical-name Nature Publishing Group?>
<?submitter-canonical-id NATURE-STRUCTUR?>
<?submitter-userid 1045?>
<?submitter-authority publisher?>
<?submitter-login nature-structure?>
<?submitter-name Nature Publishing Group (obsolete)?>
<?domain nihpa?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-journal-id">101215604</journal-id>
    <journal-id journal-id-type="pubmed-jr-id">32338</journal-id>
    <journal-id journal-id-type="nlm-ta">Nat Methods</journal-id>
    <journal-id journal-id-type="iso-abbrev">Nat. Methods</journal-id>
    <journal-title-group>
      <journal-title>Nature methods</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1548-7091</issn>
    <issn pub-type="epub">1548-7105</issn>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">2762791</article-id>
    <article-id pub-id-type="pmid">19648916</article-id>
    <article-id pub-id-type="doi">10.1038/nmeth.1358</article-id>
    <article-id pub-id-type="manuscript">nihpa128792</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Phymm and PhymmBL: Metagenomic Phylogenetic Classification with Interpolated Markov Models</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Brady</surname>
          <given-names>Arthur</given-names>
        </name>
        <xref ref-type="aff" rid="A1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Salzberg</surname>
          <given-names>Steven L.</given-names>
        </name>
        <xref ref-type="aff" rid="A1">1</xref>
      </contrib>
    </contrib-group>
    <aff id="A1"><label>1</label> Center for Bioinformatics and Computational Biology, University of Maryland, College Park, MD 20742</aff>
    <author-notes>
      <corresp id="FN1">Email: <email>abrady@umiacs.umd.edu</email>, <email>salzberg@umiacs.umd.edu</email></corresp>
    </author-notes>
    <pub-date pub-type="nihms-submitted">
      <day>14</day>
      <month>7</month>
      <year>2009</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>02</day>
      <month>8</month>
      <year>2009</year>
    </pub-date>
    <pub-date pub-type="ppub">
      <month>9</month>
      <year>2009</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>01</day>
      <month>3</month>
      <year>2010</year>
    </pub-date>
    <volume>6</volume>
    <issue>9</issue>
    <fpage>673</fpage>
    <lpage>676</lpage>
    <!--elocation-id from pubmed: 10.1038/nmeth.1358-->
    <permissions>
      <license xlink:href="http://www.nature.com/authors/editorial_policies/license.html#terms">
        <license-p>Users may view, print, copy, and download text and data-mine the content in such documents, for the purposes of academic research, subject always to the full Conditions of use:<ext-link ext-link-type="uri" xlink:href="http://www.nature.com/authors/editorial_policies/license.html#terms">http://www.nature.com/authors/editorial_policies/license.html#terms</ext-link></license-p>
      </license>
    </permissions>
    <abstract>
      <p id="P1">Metagenomics projects collect DNA from uncharacterized environments that may contain thousands of species per sample. One main challenge facing metagenomic analysis is phylogenetic classification of raw sequence reads into groups representing the same or similar taxa, a prerequisite for genome assembly and for analyzing the biological diversity of a sample. New sequencing technologies have made metagenomics easier, by making sequencing faster, and more difficult, by producing shorter reads than previous technologies. Classifying sequences from reads as short as 100 base pairs has until now been relatively inaccurate, requiring researchers to use older, long-read technologies. We present Phymm, a classifier for metagenomic data, that has been trained on 539 complete, curated genomes and can accurately classify reads as short as 100 bp, representing a substantial leap forward over previous composition-based classification methods. We also describe how combining Phymm with sequence alignment algorithms, further improves accuracy.</p>
    </abstract>
  </article-meta>
</front>
<body>
  <sec sec-type="intro" id="S1">
    <title>Introduction</title>
    <p id="P2">Dramatic improvements in the speed and efficiency of DNA sequencing have encouraged the rapid growth of metagenomics, the study of DNA collected directly from environmental samples. This new field, which promises to uncover thousands of previously unknown species, has been compared to “a reinvention of the microscope in the expanse of research questions it opens to investigation.”<xref rid="R1" ref-type="bibr">1</xref> Only a small fraction of microbial organisms can be cultured in a laboratory, a prerequisite for traditional genome sequencing and analysis. Single-organism genome sequencing projects have yielded a wealth of new scientific knowledge, which we are only beginning to exploit. Metagenomics promises to take these discoveries even further, by enabling scientists to study the full diversity of the microbial world. By sequencing collections of organisms from environments ranging from the human body to soil to the ocean floor, metagenomics projects are vastly increasing the range of organisms that can be analyzed, allowing for systems-level study of microbial environments, and revealing a heretofore hidden world of biological complexity<xref rid="R2" ref-type="bibr">2</xref>.</p>
    <p id="P3">Although sequencing technology allows us to collect and sequence vast samples of uncultured DNA, many technical challenges must be overcome in order to make sense of these data. In order to identify the species and genes in a sample, DNA fragments (“reads”) from common species need to be grouped together and assembled, if possible.</p>
    <p id="P4">The newest sequencing technologies (increasingly preferred by metagenomics researchers due to reduced cost) produce relatively short reads, ranging from 25–400 bp, making the taxonomic classification problem considerably more difficult than with longer reads, which contain more identifying information. One algorithm, CARMA<xref rid="R3" ref-type="bibr">3</xref>, attempts to match short reads to known Pfam domains (structural components conserved across multiple proteins) and protein families. However, only ~15% of random 100-bp shotgun reads could be matched to extant Pfam groups; even among this reduced set of reads (excluding 85% of the input data due to the absence of a match), the average sensitivity of this approach at the genus level was 40%, meaning only 6% of the input reads were correctly classified. PhyloPythia<xref rid="R4" ref-type="bibr">4</xref>, a classification method based on support vector machines (SVMs), examines oligonucleotide frequencies to characterize taxonomic groups. This method is effective for DNA fragments of 3,000 bp and longer, but for 1,000-bp sequences, sensitivity drops drastically (to just 7.1% at the genus level). It has been observed<xref rid="R5" ref-type="bibr">5</xref> that 1,000 bp represents a critical barrier that classification methods need to break.</p>
    <p id="P5">Another approach is to use sequence homology, aligning reads to known sequences using BLAST<xref rid="R6" ref-type="bibr">6</xref> and assigning taxonomy based on the best match<xref rid="R7" ref-type="bibr">7</xref>,<xref rid="R8" ref-type="bibr">8</xref>. BLAST is highly accurate if the source organism; however, if the source species is missing from the database, accuracy drops dramatically, as we show below. The MEGAN software system<xref rid="R9" ref-type="bibr">9</xref> classifies reads based on multiple high-scoring BLAST hits, assigning reads to a common ancestor of those BLAST matches that exceed a bit-score threshold. It is worth noting that in a recent coral reef study<xref rid="R10" ref-type="bibr">10</xref>, only 12% of reads had matches in a comprehensive microbial BLAST database.</p>
    <p id="P6">Here we present Phymm, a new method for phylogenetically classifying short sequence fragments such as those generated by metagenomics sequencing projects. Throughout this paper, we use “classification” to mean the assignment of a specific label (in our case, a phylogenetic group) to members of a data set (in this case, DNA reads). We want to draw a clear distinction to ‘binning’ which, though often used interchangeably with classifying, refers to the grouping of a data set into subgroups which are distinct from one another; these subgroups may remain unlabeled.</p>
    <p id="P7">Phymm uses interpolated Markov models (IMMs) to characterize variable-length oligonucleotides typical of a phylogenetic grouping. IMMs have been employed with great success for bacterial gene finding in the GLIMMER system<xref rid="R11" ref-type="bibr">11</xref>, but this is the first use of IMMs for the general phylogenetic classification problem. Our results demonstrate that for short reads, Phymm represents a dramatic improvement over previous methods such as PhyloPythia<xref rid="R4" ref-type="bibr">4</xref>, accurately classifying unknown fragments as short as 100 bp. We also present a hybrid method that incorporates information from both Phymm and BLAST, and show that this hybrid method outperforms either of the two single methods.</p>
  </sec>
  <sec sec-type="results" id="S2">
    <title>Results</title>
    <p id="P8">In an earlier study describing the program GLIMMER<xref rid="R12" ref-type="bibr">12</xref>, IMMs were shown to be highly accurate at distinguishing reads derived from a bacterial symbiont <italic>P. didemni</italic> from those of its eukaryotic sea squirt host <italic>L. patella</italic>. GLIMMER discriminated with 99% accuracy between reads from two evolutionarily distant species. Our goal in the present study was to see how well this discrimination generalizes to the problem of fully classifying much larger metagenomics samples that included many closely-related organisms. We tested our method on both synthetic and real metagenome data.</p>
    <sec id="S3" sec-type="methods">
      <title>Synthetic metagenome data</title>
      <p id="P9">We conducted three groups of classification experiments, in which test sets of synthetic metagenomic reads were assigned taxonomic labels using Phymm, BLAST and PhymmBL. Phymm contains a large suite of IMMs trained on chromosomes and plasmids from organisms collected from the NCBI RefSeq database<xref rid="R13" ref-type="bibr">13</xref> (Phymm’s “reference library”). When used to score a DNA sequence, an IMM computes a score corresponding to the probability that the IMM generated that sequence, which can be used to estimate the probability that the sequence belongs to the class of sequences on which the IMM was trained. In the Phymm experiment, each read was scored with each IMM in the reference library, and the read was then classified using the clade labels belonging to the organism whose IMM generated the best score for that read. In the BLAST experiment, each read was submitted as a BLASTN query, searching against a background database built from the same genomes used to generate the IMMs, and clade labels were assigned using the known labels of the best BLAST hit. Finally, we used PhymmBL to score reads using both stand-alone methods in parallel, assigning a “best hit” using a weighted combination of scores from both methods. (See Online Methods for reference sequence data, test set construction, experimental configuration, and the PhymmBL scoring algorithm.)</p>
    </sec>
    <sec id="S4">
      <title>Clade-level exclusions</title>
      <p id="P10">Our central goal was to model the problem of classifying a sequence from a species that has never before been observed; we expect that metagenomic data will lead to the discovery of thousands of new species, and that this problem will be a common one. By definition, given a read from an organism which has not been sequenced, no classification method can predict the correct species label (because that label does not exist). For higher-level phylogenetic classifications, on the other hand, we may have previously seen the genus, family, or other higher-level clade. We therefore repeated all three groups of experiments multiple times, with each iteration configured to explicitly exclude comparisons of each query read to related species at increasingly general clade levels.</p>
    </sec>
    <sec id="S5">
      <title>Classification accuracy</title>
      <p id="P11">We focus first on the experiment in which Phymm was used to classify reads for which species-level matches were masked. This experiment was repeated for reads of lengths 100, 200, 400, 800 and 1,000 bp (<bold>Online Methods</bold>). Accuracy results for this experiment on all five read lengths are given in <xref rid="F1" ref-type="fig">Fig. 1</xref> and in <xref rid="SD1" ref-type="supplementary-material">Supplementary Table 1</xref>. As expected, classification at the genus level was the most difficult task, with 53 possible genera available as labels. Moving up the phylogenetic tree, the data sets contained 48 distinct bacterial and archaeal families, 34 orders, 21 classes, and 14 phyla. Phymm’s accuracy improves with greater read length, as expected, ranging from 32.8% for the problem of assigning the correct genus to 100-bp reads, up to 89.8% for assigning the correct phylum to 1,000-bp reads. At 400 bp the read length provided by current-generation Roche 454 pyrosequencers accuracy at the genus level is 60.3%. These results represent very substantial improvements over previous methods such as the SVM-based PhyloPythia, which reported 7.1% accuracy at the genus level for 1,000-bp sequences<xref rid="R4" ref-type="bibr">4</xref> and C ARMA, which labeled 6% of 100-bp reads correctly at the genus level.<xref rid="R3" ref-type="bibr">3</xref></p>
      <p id="P12">In most cases, BLAST by itself is superior to Phymm by itself, but for the 800-bp and 1,000-bp reads, Phymm outperforms BLAST at the class and phylum levels (<xref rid="SD1" ref-type="supplementary-material">Supplementary Table 2</xref>).</p>
      <p id="P13">The hybrid PhymmBL classifier produces further improvements ( <xref rid="T1" ref-type="table">Table 1</xref>, <xref rid="SD1" ref-type="supplementary-material">Supplementary Table 3</xref>). For all read lengths and clade levels, PhymmBL outperforms both Phymm and BLAST, showing approximately 6% improvement over BLAST by itself at all taxonomic levels for the 1,000-bp query set. These results indicate that the two approaches are somewhat complementary and that PhymmBL is able to utilize information from both. <xref rid="T1" ref-type="table">Table 1</xref> shows a comparison of all three methods, along with results for PhyloPythia, at the 1,000-bp read length.</p>
      <p id="P14">Both Phymm and PhymmBL give highly robust, reproducible results: in all cases, the observed standard deviation in accuracy was less than 1%.</p>
      <p id="P15">Finally, because more than 1,100 IMM scores are assigned to each read, we considered whether looking beyond the single top-scoring IMM might improve accuracy. We therefore examined the top five scores assigned by PhymmBL to each read in the 1,000-bp test set, and counted how often the correct clade appeared in at least one of the top five predictions. This produced an increase of 5–9% at all levels, as follows (with the accuracy of the top-scoring prediction alone shown in parentheses): phylum, 97.9% (93.8%); class, 96.6% (90.6%); order, 94.5% (86.9%); family, 92.6% (84.8%); genus, 89.3% (78.4%). This suggests that Phymm and PhymmBL might be improved even further if they can make use of additional complementary signals.</p>
    </sec>
    <sec id="S6">
      <title>Metagenome data from an acid mine</title>
      <p id="P16">Evaluating classification methods on real metagenomes can be problematic: ordinarily, the true taxonomic composition of the data cannot be established with certainty. The composition of an acid mine drainage (AMD) metagenome first introduced in a 2004 study<xref rid="R14" ref-type="bibr">14</xref>, however, has been substantially characterized. It contains three dominant populations, namely the archaeon <italic>Ferroplasma acidarmanus</italic> and two groups of bacteria, <italic>Leptospirillum</italic> groups II and III.</p>
      <p id="P17">We ran two experiments classifying the AMD data: one in which we used the unaltered RefSeq library as a reference, and one in which we added the draft genomes for all three groups to the RefSeq data to create an augmented reference library. This allowed us to compare – as we did for the synthetic data set – performance in the presence of more and less specific reference data.</p>
      <p id="P18">We present three different characterizations of the AMD data in terms of population distribution: <xref rid="F2" ref-type="fig">Fig. 2</xref> compares population breakdown at the phylum level as predicted by PhymmBL across two runs: one using the augmented reference library (including the three new draft genomes), the other using only the RefSeq data. <xref rid="F3" ref-type="fig">Fig. 3</xref> gives the population breakdown by species given by PhymmBL using the augmented reference library.</p>
      <p id="P19">In addition to these high-level characterizations, we examined how well Phymm, BLAST and PhymmBL – using only the RefSeq library <italic>without</italic> the added draft genomes – could characterize the three dominant species groups themselves. We aligned all the AMD reads to the three draft genomes, in order to establish a “correct” read set for each species group, and then examined the classification performance for each of the three methods on each of the three positively-identified groups of reads. Phylum-level predictions for these groups are given in <xref rid="SD1" ref-type="supplementary-material">Supplementary Figs. 1–9</xref>. PhymmBL correctly predicted the phylum (<italic>Euryarchaeota</italic>) for <italic>F. acidarmanus</italic> 61.0% of the time; it assigned approximately 80% of <italic>Leptospirillum</italic> reads to <italic>Proteobacteria.</italic> (Note that members of the phylum (<italic>Nitrospira</italic>) assigned to the <italic>Leptospirillum</italic> genus were originally provisionally assigned to <italic>Deltaproteobacteria</italic><xref rid="R15" ref-type="bibr">15</xref>, and indeed a majority of reads from both groups were labeled with this class: 59.9% for group II, and 51.7% for group III.)</p>
      <p id="P20">When the three positively-identified sets of reads were analyzed using the reference library augmented <italic>with</italic> the draft genomes for the three groups, PhymmBL’s species-level prediction accuracy was 98% or higher for each group (data not shown). (We believe these accuracy measurements to be more anecdotal than evidentiary, though, due to the fact that the draft genomes, which were used to train IMMs, were presumably assembled from the same raw reads which we used as test data for this particular run, although these results do give an indication of PhymmBL’s robustness in the presence of sequencing errors and natural mutations, which were certainly present in the raw read data.)</p>
    </sec>
  </sec>
  <sec sec-type="discussion" id="S7">
    <title>Discussion</title>
    <p id="P21">The new <italic>ab initio</italic> classification method presented here, Phymm, is substantially more accurate than previous approaches, particularly for short read lengths. One advantage of interpolated Markov models over other methods, particularly those that use oligonucleotide counts<xref rid="R16" ref-type="bibr">16</xref>, is that IMMs utilize information from multiple oligonucleotides of different lengths and integrate the results. Thus instead of having to choose between 5-mers and 6-mers for classification at the class or phylum levels (as is done in PhyloPythia<xref rid="R4" ref-type="bibr">4</xref>), Phymm can use both. For our experiments we considered oligomers ranging from 1–12 in length, and Phymm automatically selected those oligomers that best characterized each species. Note also that these are comparable to “spaced seeds” in that the positions from which information is extracted are not necessarily adjacent. The program GLIMMER<xref rid="R12" ref-type="bibr">12</xref> showed the effectiveness of IMMs for a binary classification problem; here, we classified reads from hundreds of species, all of which are more closely related to one another than the bacterium-sea squirt pair analyzed by GLIMMER, and found that IMMs are also effective at this much more difficult task.</p>
    <p id="P22">In contrast to other approaches, Phymm classifies all reads, and its accuracy at the genus level is 32.8% for 100-bp reads (compared to 6% for CARMA); for 1,000-bp reads, genus-level accuracy rises to 71.1% (compared to 7.1% for PhyloPythia).</p>
    <p id="P23">However, as our experiments demonstrate, the best standalone method for classifying reads from metagenomics projects – at least when other species from the same genus are known – is BLAST. Although BLAST has been the standard classification method for long reads<xref rid="R7" ref-type="bibr">7</xref>,<xref rid="R14" ref-type="bibr">14</xref>, some previous studies excluded it, which may have made their results appear more positive. BLAST has shortcomings when a sequence is truly different from anything in the database – as is often the case with actual environmental samples – but this is a universal problem. As has been previously observed<xref rid="R17" ref-type="bibr">17</xref>, marker gene approaches based on 16S rDNA do not appear to improve classification accuracy over that of BLAST alone. In contrast, our IMM-based method provides a clear boost to BLAST: our hybrid method, PhymmBL, outperformed each of its two component methods alone, and we note that both Phymm and BLAST contributed substantial numbers of correct assignments that were missed by the other method.</p>
    <p id="P24">One of the main advantages of our phylogenetic classification method is that preprocessing reads is unnecessary: no gene finding, protein-domain matching, or conserved-sequence identification steps were needed, allowing predictions to be made for all reads in a query set without sacrificing accuracy as compared to existing methods. The 1Kb “barrier”<xref rid="R5" ref-type="bibr">5</xref> does not seem to be a problem for Phymm, although as with all methods, accuracy improves with longer reads. As read lengths for new sequencing technologies increase, the ability to accurately classify short reads, directly as they emerge from the sequencers, will continue to improve. Current metagenomics analysis pipelines<xref rid="R5" ref-type="bibr">5</xref> postpone classification until after assembly has been attempted, due to the unreliability of existing composition-based methods at accurately generating phylogenetic classifications for sequences less than 1,000 bp. As shown in the sea squirt/symbiont study<xref rid="R12" ref-type="bibr">12</xref>, accurate binning can improve assembly: methods like Phymm and PhymmBL (when used as binning tools) should thus be able to improve all downstream analysis of metagenomes, including assembly and gene finding.</p>
  </sec>
  <sec id="S8">
    <title>Online Methods</title>
    <sec id="S9">
      <title>Synthetic metagenome data</title>
      <p id="P25">At present there are no benchmark metagenomics datasets based on real environmental sequences for which the correct taxonomy has been fully and confidently characterized. Indeed, all existing metagenomic samples from natural environments contain multiple unknown species. Following the work of others<xref rid="R18" ref-type="bibr">18</xref>, therefore, we worked with simulated metagenomic samples drawn from existing sequences. For our main data source, we built a core library of all complete bacterial and archaeal genomes available in RefSeq as of October, 2008<xref rid="R13" ref-type="bibr">13</xref>, comprising 539 distinct species containing 1,146 chromosomes and plasmids. (The full taxonomic composition of this data set can be found in <xref rid="SD1" ref-type="supplementary-material">Supplementary Tables 7–11</xref>, along with the amount of sequence data present for each clade.) All reads used in our experiments with synthetic data were drawn randomly from their source genomes, with no alteration. For the first set of experiments in – which no matches were masked, and comparisons were allowed between reads and their source species – query reads were extracted from each genome, then masked out <italic>before</italic> training IMMs or building our BLAST database, so that our training set (genomes with extracted reads masked) and our test set (extracted reads) did not overlap. For all other experiments, IMMs and BLAST databases were constructed using whole genomes, and separation of training and test data was automatic: the entire genome of the species from which each query read was drawn was masked, by design, during the classification process.</p>
    </sec>
    <sec id="S10">
      <title>Synthetic test set construction and filtering</title>
      <p id="P26">In order to control against under-representation of some clades in the available data, query sets were filtered so that all species under consideration had at least two sister species within the clade under consideration. For example, in the experiment which masked exact species matches but allowed intra-genus comparisons, without this filtering step, if a given species was the only sequenced representative of its genus, then it would have been impossible to assign a correct genus label to reads from that species (because the species itself was excluded from the scoring process by design), which in turn would artificially depress the results. Analogous filters were used at higher levels; e.g., phylum-level predictions were made only for reads which had at least two other species in their home phylum.</p>
      <p id="P27">Each synthetic test set initially contained 5 randomly-selected “reads” from each of the 1,146 chromosomes and plasmids in the RefSeq reference data, totaling 5,730 reads representing 539 bacterial and archaeal species. After filtering out species that did not meet the criteria above, test set sizes for the species-masked, genus-masked, family-masked, order-masked and class-masked experiments contained 2,870, 3,255, 3,335, 4,575 and 4,390 reads, respectively.</p>
      <p id="P28">The most sparse of these the – experiment in which exact species matches were masked and the lowest-level predictions were at the genus level – represented 573 chromosomes and plasmids from 254 species across 48 genera. This is still a very broad group of genera compared to previous studies; e.g., McHardy <italic>et al</italic>. used 31 genera<xref rid="R4" ref-type="bibr">4</xref>.</p>
    </sec>
    <sec id="S11">
      <title>Acid mine drainage test set</title>
      <p id="P29">We downloaded the entire set of raw sequence reads for the AMD metagenome data set presented in Tyson <italic>et al.</italic><xref rid="R14" ref-type="bibr">14</xref> from the NCBI trace archive. Vector sequences were removed from reads using Figaro<xref rid="R19" ref-type="bibr">19</xref>. Each read was then truncated to include only the longest contiguous stretch of bases for which base-calling quality scores were at least 17. Finally, reads less than 100 bp were discarded. Of the original 180,713 raw reads in the data set, 166,345 remained after all quality filtering was complete.</p>
      <p id="P30">We established “true positives” for reads belonging to <italic>F. acidarmanus</italic> and the two <italic>Leptospirillum</italic> groups by using MUMmer<xref rid="R20" ref-type="bibr">20</xref> to align all reads in the data set to the draft genomes for the three species groups. Three sets of positive matches, one for each species group, were identified by selecting reads which aligned to exactly one of the three draft genomes. When complete, the <italic>F. acidarmanus</italic> set contained 15,628 reads; the <italic>Leptospirillum</italic> group II set contained 48,589 reads; and the <italic>Leptospirillum</italic> group III set contained 10,104 reads. These sets were used to generate the per-group predictive accuracy results presented in <xref rid="SD1" ref-type="supplementary-material">Supplementary Figures 1–9</xref>.</p>
    </sec>
    <sec id="S12">
      <title>Classification infrastructure</title>
      <p id="P31">We built one IMM per molecule (chromosome or plasmid), with each IMM trained on the entire molecular input sequence, yielding a total of 1,146 IMMs. To compare our method to BLAST on the same data, we also constructed a BLAST database containing all 1,146 molecular sequences.</p>
      <p id="P32">In designing PhymmBL, we attempted to boost accuracy by adding several common composition-based measures including GC content and dinucleotide frequencies<xref rid="R21" ref-type="bibr">21</xref>, but none was found to improve accuracy, likely because the statistics captured by these measures closely overlap those already captured by the Phymm IMMs.</p>
      <p id="P33">For more details on experimental methods, including a study examining the relationship between the amount of training data available per clade and predictive accuracy; construction and configuration of the synthetic data sets; details on our use of IMMs; a description of all preprocessing performed on the raw AMD read set before classification; parameter estimation for PhymmBL’s weighted voting scheme; and the direct estimation of confidence levels for Phymm predictions, please refer to the <xref rid="SD1" ref-type="supplementary-material">supplementary material</xref> accompanying this article.</p>
    </sec>
    <sec id="S13" sec-type="methods|discussion">
      <title>Impact of training data size on classification accuracy</title>
      <p id="P34">Taxonomic groups are represented in sequence databases to vastly different degrees; among the RefSeq genera we used for this study, for example, the amount of sequence data differed by up to two orders of magnitude. To explore potential biases in classification accuracy resulting from such a wide range in the volume of available training data for each clade, we plotted clade-specific classification accuracy as a function of training set size. Results at the phylum level for 100-bp queries, classified by Phymm (with exact species matches excluded) are given in <xref rid="SD1" ref-type="supplementary-material">Supplementary Figure 10</xref>. This analysis was conducted 10 times to establish variance in accuracy; a tabular version of <xref rid="SD1" ref-type="supplementary-material">Supplementary Figure 10</xref>, including standard deviations in accuracy for each phylum, along with analogous results at the class, order, family and genus levels are given in <xref rid="SD1" ref-type="supplementary-material">Supplementary Tables 7–11</xref>.</p>
      <p id="P35">Somewhat unexpectedly, little if any correlation was observed between the amount of sequence data available for IMM training and predictive power. Also unexpectedly, the standard deviations for predictive accuracy – which one might expect to vary widely and exhibit correlations with amount of training data – exhibited neither of these trends, with deviations ranging from less than 1% to approximately 17%, with no apparent correspondence between variance and amount of training data. We hypothesize that accuracy is far more dependent on evolutionary diversity (i.e., mutational diversity) within each clade: a phylogenetic group containing species that are more evolutionarily distant from one another will be inherently harder to classify, using methods based on sequence composition, than one containing more closely-related species.</p>
    </sec>
    <sec id="S14">
      <title>IMMs and phylogenetic classification</title>
      <p id="P36">Interpolated Markov models are a form of Markov chain that uses a variable number of states to compute the probability of the next state. IMMs, which are also called variable-order Markov models, were described in detail in the original GLIMMER papers<xref rid="R11" ref-type="bibr">11</xref>,<xref rid="R22" ref-type="bibr">22</xref>. For our purposes, the main idea is that IMMs can be used to classify sequences based on patterns of DNA distinct to a clade, whether the clade is a species, genus, or higher-level phylogenetic group. During training, the IMM algorithm constructs probability distributions representing observed patterns of nucleotides that characterize each species. The model used by GLIMMER and Phymm captures non-adjacent patterns when necessary; e.g., it can use 8 positions spaced across a window of 12 bases. During classification, we use each IMM as a scoring method: it examines the nucleotides in a given query sequence and outputs a score corresponding to the probability that the query was generated from the same distribution as that used to train the IMM.</p>
    </sec>
    <sec id="S15">
      <title>Parameter settings for weighted voting in PhymmBL</title>
      <p id="P37">For PhymmBL, we empirically we determined the combined score using the function</p>
      <p id="P38"><disp-formula id="FD1"><mml:math id="M1" display="block" overflow="scroll"><mml:mrow><mml:mi mathvariant="italic">Score</mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="italic">IMM</mml:mi><mml:mo>+</mml:mo><mml:mn>1.2</mml:mn><mml:mo stretchy="false">(</mml:mo><mml:mn>4</mml:mn><mml:mo>−</mml:mo><mml:mo>log</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>E</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></disp-formula> where <italic>IMM</italic> is the score from the best-matching IMM and <italic>E</italic> is the smallest (best) E-value returned by BLAST. Our IMMs return log-likelihood scores as integers, generally in the range between -500 and -100, with higher scores representing better matches; the log-transformation brought the BLAST scores into this scale. The constant 4 was determined experimentally to be optimal via binary search on small positive integers, and the weight of 1.2 was subsequently determined to be optimal via binary search on values between 1 and 3. The ranges for both searches (integers between 0 and 5 to find the additive constant 4, and values between 1 and 3, in increments of 0.1, to determine the multiplicative weight of 1.2) were established by identifying values at which the predictions of one method completely dominated those of the other. For example: multiplicative weights less than 1 generated combined scores essentially identical to those produced by the IMMs alone, while those greater than 3 generated combined scores which were the same as those produced by BLAST by itself. These settings may only represent a local optimum, but different values of the weights had only a marginal effect on overall accuracy.</p>
    </sec>
    <sec id="S16">
      <title>Confidence scores</title>
      <p id="P39">We conducted some preliminary experiments with the goal of correlating raw Phymm and PhymmBL scores with predictive accuracy, in order to establish a function mapping these scores to the probability of generating a correct taxonomic prediction. A smooth, monotonic function mapping score to accuracy was indeed observed for reads 100 bp in length, but reads of different lengths exhibited different score ranges, and maps between score and predictive power across various lengths were not scaled, one to another, in any obvious (constant or linear) way. While we believe such a relationship can be established, more complex investigation will be required in order to properly determine a closed-form relationship between raw scores and predictive accuracy.</p>
    </sec>
    <sec id="S17">
      <title>Availability</title>
      <p id="P40">A one-stop installer for the Phymm/PhymmBL system is available for download at <ext-link ext-link-type="uri" xlink:href="http://www.cbcb.umd.edu/software/phymm/">http://www.cbcb.umd.edu/software/phymm/</ext-link>, along with a README describing system requirements and configuration.</p>
      <p id="P41">Copies of all synthetic metagenomic data described in this paper are available for download and are linked off the Phymm/PhymmBL download page.</p>
    </sec>
  </sec>
  <sec sec-type="supplementary-material" id="S18">
    <title>Supplementary Material</title>
    <supplementary-material content-type="local-data" id="SD1">
      <label>1</label>
      <media xlink:href="NIHMS128792-supplement-1.pdf" mimetype="application" mime-subtype="pdf" xlink:type="simple" id="d37e492" position="anchor"/>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack id="S20">
    <p>Thanks to Art Delcher for helpful discussions regarding IMM configuration. Thanks also to our anonymous reviewers, whose comments without doubt helped make this manuscript substantially stronger. This work was supported in part by NIH grants R01-LM006845 and R01-GM083873.</p>
  </ack>
  <ref-list>
    <ref id="R1">
      <label>1</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Handelsman</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Tiedje</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Alvarez-Cohen</surname>
            <given-names>L</given-names>
          </name>
          <etal/>
        </person-group>
        <source>The New Science of Metagenomics: Revealing the Secrets of Our Microbial Planet</source>
        <publisher-name>The National Academies Press</publisher-name>
        <publisher-loc>Washington, DC</publisher-loc>
        <year>2007</year>
      </element-citation>
    </ref>
    <ref id="R2">
      <label>2</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rondon</surname>
            <given-names>MR</given-names>
          </name>
          <name>
            <surname>August</surname>
            <given-names>PR</given-names>
          </name>
          <name>
            <surname>Bettermann</surname>
            <given-names>AD</given-names>
          </name>
          <etal/>
        </person-group>
        <source>Appl Environ Microbiol</source>
        <volume>66</volume>
        <issue>6</issue>
        <fpage>2541</fpage>
        <year>2000</year>
        <pub-id pub-id-type="pmid">10831436</pub-id>
      </element-citation>
    </ref>
    <ref id="R3">
      <label>3</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Krause</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Diaz</surname>
            <given-names>NN</given-names>
          </name>
          <name>
            <surname>Goesmann</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <source>Nucleic Acids Res</source>
        <volume>36</volume>
        <issue>7</issue>
        <fpage>2230</fpage>
        <year>2008</year>
        <pub-id pub-id-type="pmid">18285365</pub-id>
      </element-citation>
    </ref>
    <ref id="R4">
      <label>4</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>McHardy</surname>
            <given-names>AC</given-names>
          </name>
          <name>
            <surname>Martin</surname>
            <given-names>HG</given-names>
          </name>
          <name>
            <surname>Tsirigos</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <source>Nat Methods</source>
        <volume>4</volume>
        <issue>1</issue>
        <fpage>63</fpage>
        <year>2007</year>
        <pub-id pub-id-type="pmid">17179938</pub-id>
      </element-citation>
    </ref>
    <ref id="R5">
      <label>5</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kunin</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Copeland</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Lapidus</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <source>Microbiol Mol Biol Rev</source>
        <volume>72</volume>
        <issue>4</issue>
        <fpage>557</fpage>
        <year>2008</year>
        <pub-id pub-id-type="pmid">19052320</pub-id>
      </element-citation>
    </ref>
    <ref id="R6">
      <label>6</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Altschul</surname>
            <given-names>SF</given-names>
          </name>
          <name>
            <surname>Madden</surname>
            <given-names>TL</given-names>
          </name>
          <name>
            <surname>Schaffer</surname>
            <given-names>AA</given-names>
          </name>
          <etal/>
        </person-group>
        <source>Nucleic Acids Res</source>
        <volume>25</volume>
        <issue>17</issue>
        <fpage>3389</fpage>
        <year>1997</year>
        <pub-id pub-id-type="pmid">9254694</pub-id>
      </element-citation>
    </ref>
    <ref id="R7">
      <label>7</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tringe</surname>
            <given-names>SG</given-names>
          </name>
          <name>
            <surname>von Mering</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Kobayashi</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <source>Science</source>
        <volume>308</volume>
        <issue>5721</issue>
        <fpage>554</fpage>
        <year>2005</year>
        <pub-id pub-id-type="pmid">15845853</pub-id>
      </element-citation>
    </ref>
    <ref id="R8">
      <label>8</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tito</surname>
            <given-names>RY</given-names>
          </name>
          <name>
            <surname>Macmil</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Wiley</surname>
            <given-names>G</given-names>
          </name>
          <etal/>
        </person-group>
        <source>PLoS ONE</source>
        <volume>3</volume>
        <issue>11</issue>
        <fpage>e3703</fpage>
        <year>2008</year>
        <pub-id pub-id-type="pmid">19002248</pub-id>
      </element-citation>
    </ref>
    <ref id="R9">
      <label>9</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Huson</surname>
            <given-names>DH</given-names>
          </name>
          <name>
            <surname>Auch</surname>
            <given-names>AF</given-names>
          </name>
          <name>
            <surname>Qi</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <source>Genome Res</source>
        <volume>17</volume>
        <issue>3</issue>
        <fpage>377</fpage>
        <year>2007</year>
        <pub-id pub-id-type="pmid">17255551</pub-id>
      </element-citation>
    </ref>
    <ref id="R10">
      <label>10</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dinsdale</surname>
            <given-names>EA</given-names>
          </name>
          <name>
            <surname>Pantos</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Smriga</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <source>PLoS ONE</source>
        <volume>3</volume>
        <issue>2</issue>
        <fpage>e1584</fpage>
        <year>2008</year>
        <pub-id pub-id-type="pmid">18301735</pub-id>
      </element-citation>
    </ref>
    <ref id="R11">
      <label>11</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Salzberg</surname>
            <given-names>SL</given-names>
          </name>
          <name>
            <surname>Delcher</surname>
            <given-names>AL</given-names>
          </name>
          <name>
            <surname>Kasif</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <source>Nucleic Acids Res</source>
        <volume>26</volume>
        <issue>2</issue>
        <fpage>544</fpage>
        <year>1998</year>
        <pub-id pub-id-type="pmid">9421513</pub-id>
      </element-citation>
    </ref>
    <ref id="R12">
      <label>12</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Delcher</surname>
            <given-names>AL</given-names>
          </name>
          <name>
            <surname>Bratke</surname>
            <given-names>KA</given-names>
          </name>
          <name>
            <surname>Powers</surname>
            <given-names>EC</given-names>
          </name>
          <etal/>
        </person-group>
        <source>Bioinformatics</source>
        <volume>23</volume>
        <issue>6</issue>
        <fpage>673</fpage>
        <year>2007</year>
        <pub-id pub-id-type="pmid">17237039</pub-id>
      </element-citation>
    </ref>
    <ref id="R13">
      <label>13</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pruitt</surname>
            <given-names>KD</given-names>
          </name>
          <name>
            <surname>Tatusova</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Maglott</surname>
            <given-names>DR</given-names>
          </name>
        </person-group>
        <source>Nucleic Acids Res</source>
        <volume>35</volume>
        <issue>Database issue</issue>
        <fpage>D61</fpage>
        <year>2007</year>
        <pub-id pub-id-type="pmid">17130148</pub-id>
      </element-citation>
    </ref>
    <ref id="R14">
      <label>14</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tyson</surname>
            <given-names>GW</given-names>
          </name>
          <name>
            <surname>Chapman</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Hugenholtz</surname>
            <given-names>P</given-names>
          </name>
          <etal/>
        </person-group>
        <source>Nature</source>
        <volume>428</volume>
        <issue>6978</issue>
        <fpage>37</fpage>
        <year>2004</year>
        <pub-id pub-id-type="pmid">14961025</pub-id>
      </element-citation>
    </ref>
    <ref id="R15">
      <label>15</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Bock</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Wagner</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <person-group person-group-type="editor">
          <name>
            <surname>Dworkin</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Falkow</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <source>The Prokaryotes</source>
        <year>2006</year>
        <volume>3</volume>
      </element-citation>
    </ref>
    <ref id="R16">
      <label>16</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chapus</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Dufraigne</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Edwards</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <source>BMC Evol Biol</source>
        <volume>5</volume>
        <fpage>63</fpage>
        <year>2005</year>
        <pub-id pub-id-type="pmid">16280081</pub-id>
      </element-citation>
    </ref>
    <ref id="R17">
      <label>17</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Manichanh</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Chapple</surname>
            <given-names>CE</given-names>
          </name>
          <name>
            <surname>Frangeul</surname>
            <given-names>L</given-names>
          </name>
          <etal/>
        </person-group>
        <source>Nucleic Acids Res</source>
        <volume>36</volume>
        <issue>16</issue>
        <fpage>5180</fpage>
        <year>2008</year>
        <pub-id pub-id-type="pmid">18682527</pub-id>
      </element-citation>
    </ref>
    <ref id="R18">
      <label>18</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mavromatis</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Ivanova</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Barry</surname>
            <given-names>K</given-names>
          </name>
          <etal/>
        </person-group>
        <source>Nat Methods</source>
        <volume>4</volume>
        <issue>6</issue>
        <fpage>495</fpage>
        <year>2007</year>
        <pub-id pub-id-type="pmid">17468765</pub-id>
      </element-citation>
    </ref>
    <ref id="R19">
      <label>19</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>White</surname>
            <given-names>JR</given-names>
          </name>
          <name>
            <surname>Roberts</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Yorke</surname>
            <given-names>JA</given-names>
          </name>
          <etal/>
        </person-group>
        <source>Bioinformatics</source>
        <volume>24</volume>
        <issue>4</issue>
        <fpage>462</fpage>
        <year>2008</year>
        <pub-id pub-id-type="pmid">18202027</pub-id>
      </element-citation>
    </ref>
    <ref id="R20">
      <label>20</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Delcher</surname>
            <given-names>AL</given-names>
          </name>
          <name>
            <surname>Salzberg</surname>
            <given-names>SL</given-names>
          </name>
          <name>
            <surname>Phillippy</surname>
            <given-names>AM</given-names>
          </name>
        </person-group>
        <source>Curr Protoc Bioinformatics</source>
        <volume>10</volume>
        <issue>10</issue>
        <fpage>3</fpage>
        <year>2003</year>
        <pub-id pub-id-type="pmid">18428693</pub-id>
      </element-citation>
    </ref>
    <ref id="R21">
      <label>21</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Karlin</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Burge</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <source>Trends Genet</source>
        <volume>11</volume>
        <issue>7</issue>
        <fpage>283</fpage>
        <year>1995</year>
        <pub-id pub-id-type="pmid">7482779</pub-id>
      </element-citation>
    </ref>
    <ref id="R22">
      <label>22</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Delcher</surname>
            <given-names>AL</given-names>
          </name>
          <name>
            <surname>Harmon</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Kasif</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <source>Nucleic Acids Res</source>
        <volume>27</volume>
        <issue>23</issue>
        <fpage>4636</fpage>
        <year>1999</year>
        <pub-id pub-id-type="pmid">10556321</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
<floats-group>
  <fig id="F1" position="float">
    <label>Figure 1</label>
    <caption>
      <title>Percent accuracy of Phymm, with species-level matches masked, for read lengths from 100–1000 bp</title>
      <p>Colored dots show classification accuracy reported for PhyloPythia at 1000 bp for genus-through phylum-level predictions, and for CARMA at 100 bp (as apercentage of the entire input data set) for genus-and phylum-level predictions.</p>
    </caption>
    <graphic xlink:href="nihms128792f1"/>
  </fig>
  <fig id="F2" position="float">
    <label>Figure 2</label>
    <caption>
      <title>PhymmBL’s phylum-level population characterization of the AMD data</title>
      <p>using (<bold>A</bold>) the RefSeq-generated IMMs plus IMMs generated from the draft genomes of the three dominant species in the AMD set, and (<bold>B</bold>) the RefSeq-generated IMMs on their own.</p>
    </caption>
    <graphic xlink:href="nihms128792f2"/>
  </fig>
  <fig id="F3" position="float">
    <label>Figure 3</label>
    <caption>
      <title>PhymmBL’s species-level population characterization of the AMD data</title>
      <p>using the RefSeq-generated IMMs plus IMMs generated from the draft genomes of the three dominant species in the AMD set.</p>
    </caption>
    <graphic xlink:href="nihms128792f3"/>
  </fig>
  <table-wrap id="T1" position="float">
    <label>Table 1</label>
    <caption>
      <p>Comparison of performance accuracy, with same-species matches masked, for 1,000-bp reads, showing all three methods described in this study alongside PhyloPythia.</p>
    </caption>
    <table frame="box" rules="all">
      <thead>
        <tr>
          <th valign="bottom" align="center" rowspan="1" colspan="1">Query Length</th>
          <th valign="bottom" align="center" rowspan="1" colspan="1">Phymm</th>
          <th valign="bottom" align="center" rowspan="1" colspan="1">BLAST</th>
          <th valign="bottom" align="center" rowspan="1" colspan="1">PhymmBL</th>
          <th valign="bottom" align="center" rowspan="1" colspan="1">PhyloPythia</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td align="center" valign="top" rowspan="1" colspan="1">Genus</td>
          <td align="center" valign="top" rowspan="1" colspan="1">71.1</td>
          <td align="center" valign="top" rowspan="1" colspan="1">73.8</td>
          <td align="center" valign="top" rowspan="1" colspan="1">78.4</td>
          <td align="center" valign="top" rowspan="1" colspan="1">7.1</td>
        </tr>
        <tr>
          <td align="center" valign="top" rowspan="1" colspan="1">Family</td>
          <td align="center" valign="top" rowspan="1" colspan="1">77.5</td>
          <td align="center" valign="top" rowspan="1" colspan="1">79.2</td>
          <td align="center" valign="top" rowspan="1" colspan="1">84.8</td>
          <td align="center" valign="top" rowspan="1" colspan="1">–</td>
        </tr>
        <tr>
          <td align="center" valign="top" rowspan="1" colspan="1">Order</td>
          <td align="center" valign="top" rowspan="1" colspan="1">80.6</td>
          <td align="center" valign="top" rowspan="1" colspan="1">80.8</td>
          <td align="center" valign="top" rowspan="1" colspan="1">86.9</td>
          <td align="center" valign="top" rowspan="1" colspan="1">25.1</td>
        </tr>
        <tr>
          <td align="center" valign="top" rowspan="1" colspan="1">Class</td>
          <td align="center" valign="top" rowspan="1" colspan="1">85.4</td>
          <td align="center" valign="top" rowspan="1" colspan="1">84.1</td>
          <td align="center" valign="top" rowspan="1" colspan="1">90.6</td>
          <td align="center" valign="top" rowspan="1" colspan="1">30.8</td>
        </tr>
        <tr>
          <td align="center" valign="top" rowspan="1" colspan="1">Phylum</td>
          <td align="center" valign="top" rowspan="1" colspan="1">89.8</td>
          <td align="center" valign="top" rowspan="1" colspan="1">88.0</td>
          <td align="center" valign="top" rowspan="1" colspan="1">93.8</td>
          <td align="center" valign="top" rowspan="1" colspan="1">50.3</td>
        </tr>
      </tbody>
    </table>
    <table-wrap-foot>
      <fn id="TFN1">
        <p>Accuracy is measured as the percentage of all reads for which each method produced the correct phylogenetic label. We performed this set of experiments once for each read length. All other experiments with our synthetic metagenome data set were performed only for 100-bp reads; each of these experiments was repeated 10 times. Results for experiments at all levels of the phylogeny, along with standard deviations for each result, are provided in <xref rid="SD1" ref-type="supplementary-material">Supplementary Tables 4–6</xref>.</p>
      </fn>
    </table-wrap-foot>
  </table-wrap>
</floats-group>
