<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">8723137</article-id>
    <article-id pub-id-type="pmid">34546288</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btab660</article-id>
    <article-id pub-id-type="publisher-id">btab660</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Original Paper</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Structural Bioinformatics</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01060</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>DLAB: deep learning methods for structure-based virtual screening of antibodies</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-2579-0307</contrib-id>
        <name>
          <surname>Schneider</surname>
          <given-names>Constantin</given-names>
        </name>
        <aff><institution>Department of Statistics, University of Oxford</institution>, Oxford, OX1 3LB, <country country="GB">UK</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Buchanan</surname>
          <given-names>Andrew</given-names>
        </name>
        <aff><institution>Antibody Discovery &amp; Protein Engineering, R&amp;D, AstraZeneca</institution>, Cambridge, CB2 0AA, <country country="GB">UK</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Taddese</surname>
          <given-names>Bruck</given-names>
        </name>
        <aff><institution>Discovery Sciences, R&amp;D, AstraZeneca</institution>, Cambridge, CB2 0AA, <country country="GB">UK</country></aff>
        <xref rid="btab660-FM1" ref-type="author-notes"/>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0003-1388-2252</contrib-id>
        <name>
          <surname>Deane</surname>
          <given-names>Charlotte M</given-names>
        </name>
        <xref rid="btab660-cor1" ref-type="corresp"/>
        <aff><institution>Department of Statistics, University of Oxford</institution>, Oxford, OX1 3LB, <country country="GB">UK</country></aff>
        <!--deane@stats.ox.ac.uk-->
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Valencia</surname>
          <given-names>Alfonso</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <author-notes>
      <fn id="btab660-FM1">
        <label>†</label>
        <p>Bruck Taddese has left AstraZeneca since the completion of the work detailed in this manuscript.</p>
      </fn>
      <corresp id="btab660-cor1">To whom correspondence should be addressed. <email>deane@stats.ox.ac.uk</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <day>15</day>
      <month>1</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2021-09-21">
      <day>21</day>
      <month>9</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>21</day>
      <month>9</month>
      <year>2021</year>
    </pub-date>
    <volume>38</volume>
    <issue>2</issue>
    <fpage>377</fpage>
    <lpage>383</lpage>
    <history>
      <date date-type="received">
        <day>24</day>
        <month>2</month>
        <year>2021</year>
      </date>
      <date date-type="rev-recd">
        <day>03</day>
        <month>8</month>
        <year>2021</year>
      </date>
      <date date-type="editorial-decision">
        <day>01</day>
        <month>9</month>
        <year>2021</year>
      </date>
      <date date-type="accepted">
        <day>01</day>
        <month>9</month>
        <year>2021</year>
      </date>
      <date date-type="corrected-typeset">
        <day>14</day>
        <month>10</month>
        <year>2021</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2021. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2021</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btab660.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Motivation</title>
        <p>Antibodies are one of the most important classes of pharmaceuticals, with over 80 approved molecules currently in use against a wide variety of diseases. The drug discovery process for antibody therapeutic candidates however is time- and cost-intensive and heavily reliant on <italic toggle="yes">in vivo and in vitro</italic> high throughput screens. Here, we introduce a framework for structure-based deep learning for antibodies (DLAB) which can virtually screen putative binding antibodies against antigen targets of interest. DLAB is built to be able to predict antibody–antigen binding for antigens with no known antibody binders.</p>
      </sec>
      <sec id="s2">
        <title>Results</title>
        <p>We demonstrate that DLAB can be used both to improve antibody–antigen docking and structure-based virtual screening of antibody drug candidates. DLAB enables improved pose ranking for antibody docking experiments as well as selection of antibody–antigen pairings for which accurate poses are generated and correctly ranked. We also show that DLAB can identify binding antibodies against specific antigens in a case study. Our results demonstrate the promise of deep learning methods for structure-based virtual screening of antibodies. </p>
      </sec>
      <sec id="s3">
        <title>Availability and implementation</title>
        <p>The DLAB source code and pre-trained models are available at <ext-link xlink:href="https://github.com/oxpig/dlab-public" ext-link-type="uri">https://github.com/oxpig/dlab-public</ext-link>.</p>
      </sec>
      <sec id="s5">
        <title>Supplementary information</title>
        <p><xref rid="sup1" ref-type="supplementary-material">Supplementary data</xref> are available at <italic toggle="yes">Bioinformatics</italic> online.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Engineering and Physical Sciences Research Council (EPSRC)</institution>
          </institution-wrap>
        </funding-source>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Medical Research Council (MRC)</institution>
          </institution-wrap>
        </funding-source>
        <award-id>EP/L016044/1</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>AstraZeneca</institution>
            <institution-id institution-id-type="DOI">10.13039/100004325</institution-id>
          </institution-wrap>
        </funding-source>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="7"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>Antibodies are the most successful class of biotherapeutics, with 85 monoclonal antibody drugs on the US market at the time of writing. Global sales in monoclonal antibody therapeutics reached an estimated $98 billion in 2018 (<xref rid="btab660-B10" ref-type="bibr">Grilo and Mantalaris, 2019</xref>), making them one of the fastest growing and largest segments of the pharmaceutical industry. The potential and use of antibodies as therapeutics for a wide range of diseases is due to the high specificity and affinity of their binding, facilitated through the variability in their complementarity determining regions (CDRs) (<xref rid="btab660-B19" ref-type="bibr">Liu, 2014</xref>).</p>
    <p>The development process for novel antibody therapeutics already benefits from computational tools predicting properties of the antibody and the antibody–antigen complex (<xref rid="btab660-B27" ref-type="bibr">Raybould <italic toggle="yes">et al.</italic>, 2019a</xref>). Here, we demonstrate that machine learning approaches using structural antibody data can enable large-scale computational screening in the antibody development pipeline.</p>
    <p>To develop a successful therapeutic antibody, several features have to be optimized. Antibodies need to bind with high efficacy, specificity and affinity to the target of interest, while at the same time avoiding an immune reaction in the patient (<xref rid="btab660-B35" ref-type="bibr">Suscovich and Alter, 2015</xref>) as well as avoiding properties that lead to poor developability, such as self-association, viscosity or immunogenicity (<xref rid="btab660-B28" ref-type="bibr">Raybould <italic toggle="yes">et al.</italic>, 2019b</xref>). To achieve these goals, large-scale experimental screens are usually used in the pre-clinical stages of antibody–drug development (<xref rid="btab660-B4" ref-type="bibr">Almagro <italic toggle="yes">et al.</italic>, 2017</xref>; <xref rid="btab660-B35" ref-type="bibr">Suscovich and Alter, 2015</xref>).</p>
    <p>Typically, initial leads for therapeutic human antibodies are generated using either <italic toggle="yes">in vitro</italic> display platforms or <italic toggle="yes">in vivo</italic> transgenic animals. Further improvement of these initial hits is then achieved through affinity maturation, either via generation and screening of further, hit-based mutagenesis libraries or via rational engineering. High-affinity antibodies generated in this way can be further engineered to achieve desirable properties for antibody therapeutics, for example changes to the constant region to modulate the effector functions as well as <italic toggle="yes">in</italic> <italic toggle="yes">vivo</italic> half-life and the improvement of developability (<xref rid="btab660-B7" ref-type="bibr">Chiu and Gilliland, 2016</xref>).</p>
    <p>These experimental methods are often effective at generating high-affinity antibodies for downstream development, but are cost- and time-intensive. Furthermore, they do not as standard generate insights into the binding mode of the generated antibodies, or if they are binding to the target epitope on the antigen.</p>
    <p>The development pipeline detailed above can be supplemented using <italic toggle="yes">in</italic> <italic toggle="yes">silico</italic> methods, particularly once initial binding candidates have been identified. Computational tools have been used to rationally engineer the binding site in several different ways. For a recent comprehensive review of computational tools used in antibody engineering, see <xref rid="btab660-B22" ref-type="bibr">Norman <italic toggle="yes">et al.</italic> (2020)</xref>. As antibody binding affinity is defined by the three-dimensional structure of the antigen-binding region on the antibody (the paratope, which is mainly composed of the CDRs), antibody modelling tools can aid the design process by rapidly generating models of antibodies [e.g. ABodyBuilder (<xref rid="btab660-B15" ref-type="bibr">Leem <italic toggle="yes">et al.</italic>, 2016</xref>), Rosetta (<xref rid="btab660-B39" ref-type="bibr">Weitzner <italic toggle="yes">et al.</italic>, 2017</xref>) and Kotai Antibody Builder (<xref rid="btab660-B42" ref-type="bibr">Yamashita <italic toggle="yes">et al.</italic>, 2014</xref>)]. Some methods combine antibody model generation with docking against target antigens and engineering of the antibody [e.g. the Rosetta antibody design tool (<xref rid="btab660-B1" ref-type="bibr">Adolf-Bryfogle <italic toggle="yes">et al.</italic>, 2018</xref>)].</p>
    <p>The antibody models generated by those methods, though commonly high quality, are often not accurate across the CDRs, particularly the CDR H3 (<xref rid="btab660-B3" ref-type="bibr">Almagro <italic toggle="yes">et al.</italic>, 2014</xref>; <xref rid="btab660-B15" ref-type="bibr">Leem <italic toggle="yes">et al.</italic>, 2016</xref>). This presents a challenge for rigid-body docking methods, which do not allow flexibility of the binding partners, to be able to recapitulate the true antibody–antigen interface. More accurate interface models can be generated using computationally intensive docking approaches (<xref rid="btab660-B39" ref-type="bibr">Weitzner <italic toggle="yes">et al.</italic>, 2017</xref>), however, those are too slow to be used on high-throughput screens, where thousands of interface models need to be generated (<xref rid="btab660-B27" ref-type="bibr">Raybould <italic toggle="yes">et al.</italic>, 2019a</xref>).</p>
    <p>The caveats described above (CDR model inaccuracy and the speed/accuracy trade-off for interface prediction) mean that currently, no effective structure-driven computational tools are available for the early high-throughput screening stages of the antibody development pipeline.</p>
    <p>Machine learning approaches in the field of antibody therapeutics discovery have so far mainly focused on sequence rather than on structure as input (<xref rid="btab660-B6" ref-type="bibr">Bujotzek <italic toggle="yes">et al.</italic>, 2015</xref>; <xref rid="btab660-B18" ref-type="bibr">Liberis <italic toggle="yes">et al.</italic>, 2018</xref>; <xref rid="btab660-B20" ref-type="bibr">Mason <italic toggle="yes">et al.</italic>, 2021</xref>; <xref rid="btab660-B23" ref-type="bibr">Olimpieri <italic toggle="yes">et al.</italic>, 2013</xref>). These machine learning approaches have been shown to be highly efficient for prediction tasks which depend only on the antibody (rather than on the antibody–antigen interface) or are specific to one antigen: random forests have been used both for paratope prediction (<xref rid="btab660-B23" ref-type="bibr">Olimpieri <italic toggle="yes">et al.</italic>, 2013</xref>) and for the prediction of VH-VL interface angles in antibody modelling (<xref rid="btab660-B6" ref-type="bibr">Bujotzek <italic toggle="yes">et al.</italic>, 2015</xref>). A current state-of-the art paratope prediction tool, Parapred, is based upon a recurrent neural network approach using the variable region amino acid sequence of the antibody as input data (<xref rid="btab660-B18" ref-type="bibr">Liberis <italic toggle="yes">et al.</italic>, 2018</xref>). Another recent study has highlighted the potential of large scale, high throughput machine learning approaches for early stage antibody therapeutics development (<xref rid="btab660-B20" ref-type="bibr">Mason <italic toggle="yes">et al.</italic>, 2021</xref>). A large-scale (50k samples) mutagenesis study on one antibody target was used to train a recurrent neural network, which was then used to retrieve new antibody sequences from a sub-sample of antibody sequence space, all of which showed binding affinity <italic toggle="yes">in vitro</italic>. For a review of deep learning approaches in antibody research see <xref rid="btab660-B9" ref-type="bibr">Graves <italic toggle="yes">et al.</italic> (2020)</xref>.</p>
    <p>Sequence-based machine learning approaches have yet to provide generalizable predictions across different antigens in one model. An approach in this direction has recently been explored in a study by <xref rid="btab660-B2" ref-type="bibr">Akbar <italic toggle="yes">et al.</italic> (2021)</xref>, in which machine learning accessible descriptions of the binding interface were generated using structure-derived interaction motifs. Further, graph convolutional neural networks have recently been used to encode structural information for the prediction of antibody and antigen interface residues (<xref rid="btab660-B25" ref-type="bibr">Pittala and Bailey-Kellogg, 2020</xref>), demonstrating the ability of machine learning approaches to successfully utilize structural information derived from both the antibody and the antigen.</p>
  </sec>
  <sec>
    <title>2 Approach</title>
    <p>Here, we describe a structure-based deep learning approach for early-stage virtual screening of antibody therapeutics, when an epitope target of interest is known but no viable hit antibodies have yet been identified. Our approach is able to make generalizable predictions across different antigens. Adopting a three-dimensional gridding method which has been used successfully alongside convolutional neural network methods to predict small molecule/protein binding (<xref rid="btab660-B12" ref-type="bibr">Imrie <italic toggle="yes">et al.</italic>, 2018</xref>; <xref rid="btab660-B26" ref-type="bibr">Ragoza <italic toggle="yes">et al.</italic>, 2017</xref>), we implement a similar convolutional neural network trained on rapidly generated rigid-body docking poses of modelled antibody structures in complex with antigen epitopes. We use this <bold>D</bold>eep <bold>L</bold>earning approach for <bold>A</bold>nti<bold>B</bold>ody screening (<bold>DLAB</bold>) to both improve the ranking of docks from the ZDock docking algorithm (<xref rid="btab660-B24" ref-type="bibr">Pierce <italic toggle="yes">et al.</italic>, 2011</xref>) and, in combination with docking scores generated by ZDock, for the prediction of antibody–antigen binding.</p>
  </sec>
  <sec>
    <title>3 Materials and methods</title>
    <sec>
      <title>3.1 Crystal structure dataset </title>
      <p>The structural antibody database (SAbDab) (<xref rid="btab660-B8" ref-type="bibr">Dunbar <italic toggle="yes">et al.</italic>, 2014</xref>) contains an up-to-date collection of all antibody structures deposited in the PDB (<xref rid="btab660-B5" ref-type="bibr">Berman <italic toggle="yes">et al.</italic>, 2000</xref>). We selected a dataset of structures of VH-VL paired antibodies in complex with protein or peptide antigens with a resolution of less than 3 Å from a snapshot of the SAbDab, downloaded on December 19, 2018. The dataset consisted of 1216 pdb files of antibody–antigen complexes, of which 759 were non-redundant. Here, we considered an antibody to be non-redundant if its CDR sequence (the concatenated sequence across all CDR regions according to IMGT definition) was only present once in the dataset. In the following, this dataset of 759 complexes is called the crystal structure dataset. The PDB accession codes for the crystal structure dataset can be found in Supplementary File S1.</p>
    </sec>
    <sec>
      <title>3.2 Model dataset</title>
      <p>All antibody structures in the crystal structure dataset were modelled using ABodyBuilder (<xref rid="btab660-B15" ref-type="bibr">Leem <italic toggle="yes">et al.</italic>, 2016</xref>). Only non-identical template structures were used for modelling. All sidechains were modelled using PEARS (<xref rid="btab660-B16" ref-type="bibr">Leem <italic toggle="yes">et al.</italic>, 2018</xref>). This set of modelled antibodies is referred to as the model dataset. Model quality was assessed by calculating the Cα root mean square deviation (RMSD) of each modelled antibody to the crystal structure of the antibody, either across the entire Fv region or across the antibody CDRs by aligning the modelled and the crystal structure antibody by their framework regions and calculating RMSD across the CDR Cα atoms. The antibody models generated using this workflow were of comparable quality to previously published studies (<xref rid="btab660-B15" ref-type="bibr">Leem <italic toggle="yes">et al.</italic>, 2016</xref>) (see <xref rid="sup1" ref-type="supplementary-material">Supplementary Figs S1A and S2</xref>).</p>
    </sec>
    <sec>
      <title>3.3 Binding and non-binding antibody/antigen examples</title>
      <p>We considered every antibody–antigen pair in the crystal structure dataset as a binding pair. Since antibodies bind with high specificity, we generated non-binding antibody–antigen pairs by randomly sampling 50 non-cognate antibodies per antigen from the crystal structure/model antibody dataset. Our definition of non-cognate required the sampled antibodies to share less than 90% of their CDR sequence with the binding antibody.</p>
    </sec>
    <sec>
      <title>3.4 Docking pose generation</title>
      <p>For both the crystal structure and model dataset, docked antibody–antigen pairs were generated using ZDOCK (<xref rid="btab660-B24" ref-type="bibr">Pierce <italic toggle="yes">et al.</italic>, 2011</xref>). For each pair, 500 poses (distinct structures of the antibody–antigen complex) were generated. To aid the docking process, the paratope and epitope were identified and residues not belonging to either the paratope or the epitope were excluded from the interaction site using the standard ZDOCK pipeline as described in the ZDOCK documentation.</p>
      <p>The antigen epitope was defined by separating the antibody and antigen in the crystal structure and calculating surface exposed residues for each binding partner separately using the PSA algorithm (<xref rid="btab660-B14" ref-type="bibr">Lee and Richards, 1971</xref>). All atoms belonging to surface residues on the antigen less than 4 Å from a surface exposed residue on the antibody were considered part of the epitope. Further, all atoms belonging to a surface exposed residue on the antigen within 4 Å of the defined epitope were included in the allowed docking interface to model a realistic level of access to the epitope.</p>
      <p>The paratope of crystal structure antibodies was defined in the same way, using the interacting residues from the crystal structure.</p>
      <p>For modelled antibody structures, the paratope was defined using the IMGT CDR definition, marking the IMGT defined CDRs and two residues to either side of each CDR as the paratope.</p>
    </sec>
    <sec>
      <title>3.5 Clustering for train-test splits</title>
      <p>To avoid similarity between binding modes in the train and test sets, CD-Hit (<xref rid="btab660-B17" ref-type="bibr">Li and Godzik, 2006</xref>) was used to cluster antibodies by CDR sequence identity as defined above, using a clustering cutoff of 90% sequence identity. For all learning tasks set out below, train-test splits were performed using clustered cross-validation, assigning all members of a cluster to either the train or the test set.</p>
    </sec>
    <sec>
      <title>3.6 Data input for convolutional neural networks</title>
      <p>Following the method of <xref rid="btab660-B26" ref-type="bibr">Ragoza <italic toggle="yes">et al.</italic> (2017)</xref>, the docking poses were prepared for input into convolutional neural networks (CNNs) by discretising the atom information into four-dimensional grids, where three dimensions describe the spatial arrangement of the interaction site and the fourth dimension is used to indicate atom types (see <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S3</xref>).</p>
      <p>The centre of the interaction site of docking poses was calculated using the PSA algorithm by averaging the coordinates of all surface-exposed atoms within 4 Å of the interaction partner on both the antibody and the antigen and taking the mean of the two centre points. Poses which after docking had no interactions under 4 Å were discarded.</p>
      <p>The grid contained only atoms that were within 24 Å of the interaction centre. These interaction site specifications were found to cover on average 96% of all interacting atoms on both antibody and antigen (see <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S4</xref>). The grid resolution was set to 0.5 Å, leading to a total grid size of 96<sup>3</sup> voxels.</p>
    </sec>
    <sec>
      <title>3.7 Reranking ZDOCK docking poses with DLAB-Re</title>
      <p>To improve ZDOCK docking pose ranking, we created a machine learning method to identify and correctly rank good docking poses. This method, termed DLAB-Re(scoring), is a CNN (architecture shown in <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S5</xref>) which predicts the <italic toggle="yes">fnat</italic> score The <italic toggle="yes">fnat</italic> score is the fraction of contacts between the interaction partners in the crystal structure that are recapitulated in the docked pose. The network generates a probability distribution over 11 <italic toggle="yes">fnat</italic> intervals (10 steps of size 0.1 over [0, 1] and one bin for <italic toggle="yes">fnat</italic> 0.0 poses), which are used to generate a <italic toggle="yes">fnat</italic> prediction via weighted averaging. For model training and testing, the top 500 poses as ranked by ZDOCK for each pairing in the binder set were annotated with their respective <italic toggle="yes">fnat</italic> score interval. For any given antibody–antigen pairing, there are considerably more poses with low <italic toggle="yes">fnat</italic> scores in the top 500 ZDOCK poses than high <italic toggle="yes">fnat</italic> poses. To avoid biasing the network towards predicting all poses into low <italic toggle="yes">fnat</italic> intervals, we used a stratified sampling scheme, sampling poses from each interval at the same rate during training (but not during testing).</p>
      <p>During training, the input data were augmented by random rotation around the interaction centre, followed by random translations along the <italic toggle="yes">x</italic>, <italic toggle="yes">y and z</italic> axis between –2 and 2 Å. Models were trained for 200 000 parameter update steps using categorical cross-entropy and the rectified Adam optimizer. Since we wanted to use the improved ranking performance of DLAB-Re on the downstream virtual screening task, it was used to rerank the top 500 poses for all antibody–antigen pairings used during training and evaluation of DLAB-VS. For this experiment, we used the model weights derived during cross-validated training. In the case of cognate and non-cognate antibody–antigen pairings, the DLAB-Re model used was not trained on either the pairings or on the antigen.</p>
      <p>To identify antibody–antigen pairings with low-quality docking poses, we determined the highest DLAB-Re score given to any of the top 500 poses generated by ZDOCK for each antibody–antigen pairing. This score (DLAB-Re-max) was used to discard particular pairings by ranking all pairings by their DLAB-Re-max score and discarding the bottom 40%, 60% or 80%. To contrast the performance of ZDOCK on the same task, this score thresholding was also applied to the ZDOCK output score of the top pose as ranked by ZDOCK.</p>
    </sec>
    <sec>
      <title>3.8 Virtual screening with DLAB-VS and ZDOCK</title>
      <p>The goal of virtual antibody screening is to discern binding antibodies against a given epitope from a pool of candidate antibodies. To generate a classification model able to accomplish this task, we trained an ensemble of CNN models (architectures depicted in <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S5</xref>), which we termed DLAB-VS (virtual screening), a binder/non-binder classifier for individual docking poses of antibody–antigen complexes.</p>
      <p>The input poses for training were selected as follows. For non-binding pairs, the highest ranked pose after DLAB-Re rescoring was selected as a non-binding pose. For binding pairs, we selected up to 50 poses with <italic toggle="yes">fnat</italic> &gt; 0.7 where those were available. Further, following the approach taken by <xref rid="btab660-B30" ref-type="bibr">Scantlebury <italic toggle="yes">et al.</italic> (2020)</xref>, five poses of the same binding pair with <italic toggle="yes">fnat</italic> &lt; 0.1 were selected as non-binding poses to force the networks to learn from the interaction between antibody and antigen by providing for the same antibody–antigen pairing both good and bad binding poses.</p>
      <p>Data augmentation was performed in the same manner as for DLAB-Re. Models were trained for 50 000 parameter update steps using the rectified Adam optimizer (as the smaller input dataset resulted in earlier convergence). A validation set comprising 10% of the total dataset was created using the same CD-Hit clustering as for the training set creation. The validation set was used to select a snapshot of the model during training by choosing the model snapshot with the highest average precision on the validation set. To counteract class imbalance, binder and non-binder poses were sampled so that each batch contained equal numbers of both classes.</p>
      <p>For each train/test split and network architecture, two different validation sets were used to train an ensemble of four models per fold.</p>
      <p>At test time, the DLAB-VS scores of the top 10 poses were averaged. As described above, we used DLAB-Re reranked poses for this purpose. Where an ensemble of models was used, the output scores by the ensemble members were averaged to arrive at the DLAB-VS score. For each antigen target, the antibodies docked against that target (correct and decoys) were ranked by their respective DLAB-VS score.</p>
      <p>For the ZDOCK-based classifier, the ZDOCK score of the top-ranked binding pose was used to rank the antibodies docked against a particular target.</p>
      <p>For the DLAB-VS+ZDOCK model, the DLAB-VS output scores and the ZDOCK output score were normalized per antigen target via minmax scaling and averaged to arrive at the final scores for each target antigen.</p>
      <p>The DLAB-Re-max score, output from the reranking method, of each antibody–antigen pairing was used to discard antigens for which the binding antibody was not predicted to have produced any satisfactory docking poses.</p>
    </sec>
    <sec>
      <title>3.9 DOVE rescoring</title>
      <p>We compared the DLAB-Re results to the DOVE method for CNN-based docking pose ranking (<xref rid="btab660-B38" ref-type="bibr">Wang <italic toggle="yes">et al.</italic>, 2020</xref>). Input file preparation and score generation were performed according to the tutorials on the author’s github page. As detailed on the author’s github page, only the GOAP and ATOM20/ATOM40 scores were used, as the IT-scores were unavailable.</p>
    </sec>
    <sec>
      <title>3.10 Additional test sets</title>
      <p>To create an unseen test set, which was not used at any point during model choice and hyperparameter optimization, we used SAbDab entries deposited after the snapshot used for the training dataset creation to create an unseen test set. This dataset, referred to in the following as the post-snapshot model dataset, contained 222 antibody/protein antigen complexes, which formed 173 CDR clusters after clustering the CDR-sequences using CD-Hit at 90% identity. On this test set, we performed modelling, docking, rescoring and binder classification as described above, using the models trained on the model dataset, with the exception of the ensemble DLAB-VS score calculation, for which we combined all 40 previously trained models into one ensemble from which the DLAB-VS score for each pairing was averaged. The PDB accession codes for this dataset can be found in Supplementary File S2.</p>
      <p>We created a SARS-CoV2 dataset (the SARS-CoV2 variant dataset) by extracting all antibodies from the Coronavirus Antibody Database (CoVAbDab) (<xref rid="btab660-B29" ref-type="bibr">Raybould <italic toggle="yes">et al.</italic>, 2020</xref>) which were confirmed to bind to the SARS-CoV2 wild-type RBD while also being confirmed not to bind to at least one SARS-CoV2 variant and for which an experimentally determined complex structure was available from which the epitope could be determined as described above. We used ABodyBuilder to model the antibodies as described above. We created structural models of the variant antigens using Foldx5 (<xref rid="btab660-B32" ref-type="bibr">Schymkowitz <italic toggle="yes">et al.</italic>, 2005</xref>), using the PDB files listed in <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S1</xref> as templates and copied the epitope definition for docking purposes from the templates onto the variant models. We then docked each antibody model, defining the paratope as described above, against its epitope on both the wild-type RBD and the confirmed non-cognate variant RBDs and performed rescoring and binder classification as described above, using the 40-model ensemble. As for most of the epitopes in this set, only one antibody was docked, score normalization was performed over the entire dataset instead of on a per-epitope basis.</p>
    </sec>
    <sec>
      <title>3.11 Statistical testing</title>
      <p>For statistical significance testing of the difference between means of the best <italic toggle="yes">fnat</italic> in top 10 ranked poses, we used the two-tailed t-test implementation in the scipy python package (<xref rid="btab660-B37" ref-type="bibr">Virtanen <italic toggle="yes">et al.</italic>, 2020</xref>). For statistical significance testing of the ranking performance of DLAB-Re, we considered the ratio of antibody–antigen pairs for which a pose with a specific <italic toggle="yes">fnat</italic> is found in the top 10 poses a Poisson rate and calculated <italic toggle="yes">P</italic>-values using the implementation of the test described in <xref rid="btab660-B11" ref-type="bibr">Gu <italic toggle="yes">et al.</italic> (2008)</xref> in the statsmodels python package (<xref rid="btab660-B33" ref-type="bibr">Seabold and Perktold, 2010</xref>). Correspondingly, we approximated the standard deviation of the ratio as <inline-formula id="IE1"><mml:math id="IM1" display="inline" overflow="scroll"><mml:mrow><mml:mfrac><mml:mrow><mml:msqrt><mml:mi>c</mml:mi></mml:msqrt></mml:mrow><mml:mi>n</mml:mi></mml:mfrac></mml:mrow></mml:math></inline-formula>, where c is the count of antibody–antigen pairings for which a pose with a specific <italic toggle="yes">fnat</italic> is found in the top X poses and n is the total number of pairings assessed.</p>
    </sec>
  </sec>
  <sec>
    <title>4 Results</title>
    <sec>
      <title>4.1 Crystal structure docking yields high-quality poses</title>
      <p>In order to establish a baseline for ZDOCK performance on antibody and antigen crystal structures, we re-docked the complexes in the crystal structure dataset and quantified the docking performance through the <italic toggle="yes">fnat</italic> score of the docking poses (Supplementary Figs S1B, C and S6). ZDOCK yielded high-quality docking poses, ranking at least one pose with <italic toggle="yes">fnat</italic> &gt; 0.5 in the top ten poses for 93% of the pairings.</p>
    </sec>
    <sec>
      <title>4.2 Model docking yields low-quality poses</title>
      <p>Docking the model dataset antibodies against their cognate antigens on the other hand yields lower-quality docking poses. Here, ZDOCK created a pose with <italic toggle="yes">fnat</italic> &gt; 0.5 in the top ten poses for only 44% of antibody–antigen pairings but 70% of pairings had a pose with <italic toggle="yes">fnat</italic> &gt; 0.5 in their 500 highest ranked poses (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figs S1C and S6</xref>).</p>
    </sec>
    <sec>
      <title>4.3 DLAB-Re can improve ZDOCK docking pose ranking</title>
      <p>Given these results, the first stage was to create a method that is able to identify good docking poses and rank these correctly. DLAB-Re is a CNN trained to predict the <italic toggle="yes">fnat</italic> of docking poses of antibody–antigen pairings. To determine the ability of our method, DLAB-Re, to improve docking pose ranking, we ranked the top 500 docking poses generated by ZDOCK for each binder pair by the predicted <italic toggle="yes">fnat</italic> value, using the clustered, cross-validated train-test procedure set out in Section 3 (compare <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S1E</xref>).</p>
      <p>This rescoring procedure improves upon the performance of ZDOCK ranking. On the crystal structure dataset, DLAB-Re recapitulates the ranking performance of native ZDOCK. On the model dataset, DLAB-Re significantly increased the number of antibody–antigen pairings for which a pose with <italic toggle="yes">fnat</italic> &gt; 0.5 is ranked in the top ten poses by 16% (<italic toggle="yes">P</italic> = 0.047) (see <xref rid="btab660-F1" ref-type="fig">Fig. 1C</xref>), significantly increasing both the mean best <italic toggle="yes">fnat</italic> in the top 10 poses from 0.46 to 0.50 (<italic toggle="yes">P</italic> = 0.002). In <xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S7</xref>, we show two antibody–antigen pairings for which DLAB-Re strongly increases the <italic toggle="yes">fnat</italic> of the best pose in the top 10 ranked poses.</p>
      <fig position="float" id="btab660-F1">
        <label>Fig. 1.</label>
        <caption>
          <p>DLAB-Re improves docking performance on the crystal structure dataset (<bold>A, B</bold>) and the model dataset (<bold>C, D</bold>). On crystal structure data, ZDOCK ranking and DLAB-Re ranking perform similarly and well. On models, the ZDOCK baseline performance is considerably worse and DLAB-Re significantly improves ranking performance. (A, C) DLAB-Re ranks the top 500 poses generated by ZDOCK better than ZDOCK, enriching the ratio of pairings with <italic toggle="yes">fnat</italic> &gt; 0.5 poses ranked highly. The dashed line indicates the fraction of docking runs in which a pose with <italic toggle="yes">fnat</italic> &gt; 0.5 is present in the 500 assessed poses.(B, D) Using the DLAB-Re-max score to remove 40%, 60% or 80% of the antibody–antigen pairings, respectively, can remove antibody–antigen pairings which did not yield high-<italic toggle="yes">fnat</italic> poses. This selects for pairings for which <italic toggle="yes">fnat</italic> &gt; 0.5 poses exist in the top 500 poses generated by ZDOCK (dashed line) and for which DLAB-Re ranks the top 500 poses well (solid line). Error bars are ±one standard deviation, approximated, as described in Section 3</p>
        </caption>
        <graphic xlink:href="btab660f1" position="float"/>
      </fig>
    </sec>
    <sec>
      <title>4.4 DLAB-Re enables identification of successfully docked antibody–antigen pairings</title>
      <p>Using the maximum predicted <italic toggle="yes">fnat</italic> score generated by DLAB-Re, we can discard poorly docked antibody–antigen pairings (see Section 3 and <xref rid="btab660-F1" ref-type="fig">Fig. 1B and D</xref>). Choosing thresholds so that 40%, 60% or 80% of pairings, respectively, are discarded, the remaining pairings are increasingly enriched both in pairings for which the docking poses are ranked well by DLAB-Re as well as in pairings which have at least one pose with a high <italic toggle="yes">fnat</italic> score in the top 500 poses. Discarding 80% of the pairings in the model dataset raises the proportion of pairings for which a pose with at least 0.5 <italic toggle="yes">fnat</italic> was ranked by DLAB-Re in the top ten poses from 51% to 84%, meaning that using this thresholding approach eliminated 93.4% of the antibody–antigen pairings for which DLAB-Re did not manage to rank a pose with at least 0.5 <italic toggle="yes">fnat</italic> in the top ten poses while retaining 33% of the pairings for which it did.</p>
      <p>Using this approach with the ZDOCK output scores does not yield the same improvement, only raising the proportion of pairings for which a pose with at least 0.5 <italic toggle="yes">fnat</italic> was ranked by ZDOCK in the top ten poses from 44% to 57% (see <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S8</xref>).</p>
    </sec>
    <sec>
      <title>4.5 A CNN docking rescoring tool trained on crystal structure data does not replicate the DLAB-Re performance</title>
      <p>We compared the performance of DLAB-Re with the DOVE tool developed by <xref rid="btab660-B38" ref-type="bibr">Wang <italic toggle="yes">et al.</italic> (2020)</xref>. DOVE is a CNN-based docking pose evaluation tool, which is designed to predict docking pose quality according to CAPRI criteria on crystal structure-based general protein–protein docking poses. We used the publicly available ATOM40+GOAP model to test whether this training generalizes to the antigen—model antibody docking case. Using the DOVE ATOM40+GOAP score to rerank antibody–antigen docking poses, DOVE performs considerably worse than both ZDOCK and DLAB-Re. This holds for both the crystal structure and the model dataset (see Supplementary Figs S1D, S9A and B).</p>
      <p>DOVE is trained to classify docking poses into one of two classes: CAPRI acceptable and not CAPRI acceptable (<xref rid="btab660-B40" ref-type="bibr">Wodak and Méndez, 2004</xref>; Wong <xref rid="btab660-B41" ref-type="bibr"><italic toggle="yes">et al.</italic>, 2019</xref>), where CAPRI acceptable poses have <italic toggle="yes">fnat</italic> &gt; 0.1 and interface RMSD &lt; 4A or ligand RMSD &lt; 10A. Using this classification to evaluate both DOVE and DLAB-Re results, DOVE still performed worse than ZDOCK and DLAB-Re (see <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S9C</xref>). These results highlight the added value from training DLAB-Re both on a domain specific (antibody–antigen) as well as task specific (modelled antibodies) dataset.</p>
    </sec>
    <sec>
      <title>4.6 ZDock easily retrieves binders from the crystal structure dataset but not from the model dataset</title>
      <p>Virtual screening for antibody discovery aims to find binding antibodies for a given epitope from a large set of potential binders. We attempted to retrieve correct binders from the crystal structure dataset by docking both the cognate antibody crystal structure as well as 50 non-cognate antibody crystal structures against each antigen crystal structure in the dataset. Using ZDock, the cognate binder is found in the top 2% (i.e. top ranked) of antibodies for 49.7% of antigen targets, and in the top 10% in 65.6% of antigen targets, outperforming the random baseline. On the model dataset, using the same procedure, ZDock ranks the binder in the top 2% of antibodies for only 5.5% of antigen targets, and in the top 10% for only 18.8% of antigen targets (see <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S10</xref>).</p>
    </sec>
    <sec>
      <title>4.7 DLAB-VS and ZDock can be combined to improve performance on the model dataset</title>
      <p>To improve our ability to perform virtual screening on modelled antibodies, we trained a new model, termed DLAB-VS (virtual screening) to classify antibody–antigen pairings as binders or non-binders, as detailed in Section 3. For a large proportion of model antibody structures, the docking pipeline does not yield high-quality complex structures (see <xref rid="btab660-F1" ref-type="fig">Fig. 1</xref>). Therefore, at train time, only docking poses with <italic toggle="yes">fnat</italic> &gt; 0.7 were shown to the network as positive binders and poses with <italic toggle="yes">fnat</italic> &lt; 0.1 were shown to the network as non-binders. Furthermore, at test time, we averaged the network output over the ten highest-ranked poses for each antibody–antigen pairing. Finally, rather than training a single model for each train/test fold, we trained four models using two different architectures for each of ten clustered cross-validation folds as detailed in Section 3 and used the averaged output as the DLAB-VS score. Using this training approach, the DLAB-VS model achieved classification performance comparable to ZDock: on the model dataset, the cognate antibody was ranked in the top 2% of antibodies for 4.7% of antigens and in the top 10% for 16.4% of antigens (see Supplementary Fig. S10).</p>
      <p>However, the two approaches, ZDock and DLAB-VS, did not perform equally across antigen targets. It was possible to improve classification performance using the mean of the two scores to rank putative binders (see Section 3 and <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S1E</xref> and F). Using this approach, termed DLAB-VS+ZDock, the binder was ranked in the top 2% of antibodies for 6.4% of antigen targets, and in the top 10% in 19.7% of antigen targets (see <xref rid="btab660-F2" ref-type="fig">Fig. 2</xref>). In the following, we use this DLAB-VS+ZDock approach.</p>
      <fig position="float" id="btab660-F2">
        <label>Fig. 2.</label>
        <caption>
          <p>DLAB-VS and ZDock binder classification performance. For each approach, the ratio of pairings for which the binding antibody was ranked in the top 2%, top 5%, top 10% and top 20% respectively is shown. (<bold>A</bold>) Comparison of the performance of ZDock and DLAB-VS binder classification on the model dataset to the random expectation (‘random’) of finding the binder in the top N%. Using the combination of DLAB-VS and ZDock scores (‘DLAB-VS+ZDock’) detailed in Section 3 and supplementing it with the DLAB-Re-max thresholding (‘DLAB-VS+ZDock + thresholding’), the classification performance on the model dataset can be improved significantly. (<bold>B</bold>) Performance on the post-snapshot model dataset after removing any CDR sequences with overlap to the model dataset (at 90% CDR sequence identity as defined above) both without (‘DLAB-VS+ZDock’) and with (‘DLAB-VS+ZDock + thresholding’) DLAB-Re-max score thresholding. Performance for the CDR sequences clustering with sequences in the model dataset is shown in <xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S12</xref></p>
        </caption>
        <graphic xlink:href="btab660f2" position="float"/>
      </fig>
    </sec>
    <sec>
      <title>4.8 Using DLAB-Re to discard antigen targets enables selection of well-performing models</title>
      <p>The performance of the DLAB-VS+ZDock model is highly dependent on the quality of the docking poses from which the score is derived as well as the quality of the antibody model (see <xref rid="sup1" ref-type="supplementary-material">Supplementary Figs S1G and S11</xref>). As described above, DLAB-Re enables the selection of well-docked antibody–antigen pairings, therefore, to further improve the performance of the DLAB-VS+ZDock classifier, we used the output from DLAB-Re to identify antibody models with high likelihood of being well docked from the model dataset. To test if this would improve results, for each of the training cross-validation folds, we only considered antigen targets for which the DLAB-Re-max score of the cognate antibody was within the top 20% of DLAB-Re-max scores of antibody–antigen pairings within that fold. On these targets, where the cognate antibody was predicted to be well docked by DLAB-Re, the cognate antibody was ranked in the top 2% for 17.6% of antigens and in the top 10% for 40.8% of antigens (see <xref rid="btab660-F2" ref-type="fig">Fig. 2A</xref>). This improvement was reliant on using the combined DLAB-VS+ZDock model, using the same approach while ranking by the ZDock output scores alone only increased the classification performance marginally (see <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S10</xref>).</p>
    </sec>
    <sec>
      <title>4.9 DLAB-VS+ZDock performs well on the post-snapshot model dataset</title>
      <p>To test the performance of the DLAB pipeline on a completely unseen test set (see <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S1H</xref>), we ran the pipeline on the post-snapshot model dataset (see Section 3). On this set, an ensemble of all 40 DLAB-Vs models trained during the clustered cross-validation training on the model dataset and the ZDock output scores were used to rank the cognate antibody model as well as 50 non-cognate antibody models. The ensemble achieved higher performance on this test set than on the previous test cases (both with and without the DLAB-Re selection criterion).</p>
      <p>To calculate how different the post-snapshot model dataset was from the training set and the potential for this to influence model performance, we clustered the antibody CDR sequences in both the model dataset and the post-snaphot model dataset at 90% identity. Of the new CDR sequences, 17.3% clustered with at least one CDR sequence in the snapshot. On the cognate antigen targets for those antibodies, the large ensemble performs exceptionally well both before and after DLAB-Re thresholding (binder in top 2% for 18% and 57% of antigen targets respectively, see <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S12</xref>). On the subset of new additions to SAbDab without overlap to the snapshot, the performance using the 40-model DLAB-VS+ZDock ensemble is similar to the performance on the snapshot using 10 folds of 4-model ensembles (see <xref rid="btab660-F2" ref-type="fig">Fig. 2B</xref>). The generalization performance of DLAB-VS is therefore not based on overlap between the training set and the post-snapshot test set. We further demonstrated this by assessing the performance of the DLAB pipeline on the set of post-snapshot targets with cognate antibodies with at most 85%, 80%, 75% or 70% CDR sequence identity to any antibody in the training set. We observed no significant change in performance between the different thresholds, demonstrating that the predictive performance of DLAB is generalizable (see <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S13</xref>).</p>
    </sec>
    <sec>
      <title>4.10 DLAB-VS can distinguish binding and non-binding antigen variants</title>
      <p>A use case of interest is determining whether mutations in the antigen can disrupt antibody binding (see <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S1I</xref>). To test whether this task is accessible to structure-based deep learning tools, we created a dataset of antibodies confirmed to bind against the SARS-CoV2 wild-type receptor binding domain (RBD) while also being confirmed not to bind against at least one SARS-CoV2 RBD variant. We ran the dataset through the DLAB pipeline as described in Section 3.10 and assessed whether the DLAB-VS+ZDOCK output score consistently scored the antibody–wild-type pair higher than the antibody variant pair. For the 14 antibody-variant pairs in the dataset, the DLAB-VS+ZDOCK score of the antibody–wild-type pair was higher than the score of the antibody-variant pair in 13/14 cases. This result indicates that the variant classification problem is accessible to structure-based deep learning tools.</p>
    </sec>
  </sec>
  <sec>
    <title>5 Discussion</title>
    <p>One of the major shortcomings of current computational antibody drug discovery is the lack of structure-based, early-pipeline screening tools to identify promising candidate antibodies.</p>
    <p>Here, we have shown how DLAB, our structure-based deep learning approach, can be used to improve pose selection in antibody–antigen docking experiments and can enable the identification of antibody–antigen pairings for which accurate poses have been generated and selected. DLAB-Re is able to identify pairings for which a pose with <italic toggle="yes">fnat</italic> &gt; 0.5 is in the top ten poses for 84% of the pairings, which can be used to improve binder classification performance downstream.</p>
    <p>We have furthermore demonstrated that our DLAB tool can identify putative binders to a given epitope in several different settings. The complete DLAB pipeline of docking followed by DLAB-Re and DLAB-VS enriched binders both against the background of non-binding SAbDab-deposited sequences as well as in a more realistic usage scenario against H3 length-matched antibody sequences drawn from antibody repertoire data.</p>
    <p>On the crystal dataset with highly accurate antibody structures and docking poses, both DLAB-VS and ZDOCK are able to strongly enrich binders. In the case of model antibodies docked to antigens, where both model and docking quality have to be considered, ZDOCK and DLAB-VS approaches fail to achieve strong discrimination between binders and non-binders. However combining the two scores improved performance. These results are in line with previously published work on the ability to classify cognate antibodies through cross-docking analysis (<xref rid="btab660-B13" ref-type="bibr">Kilambi and Gray, 2017</xref>).</p>
    <p>On a realistic use case, using the SARS-CoV2 receptor binding domain as the target antigen, we have demonstrated the utility of the DLAB pipeline, correctly scoring antibody escape variants lower than the cognate epitopes for 13 of 14 antibody-variant pairs.</p>
    <p>The DLAB pipeline has been trained specifically on a combination of ABodyBuilder and ZDOCK. The use of a different input pipeline would likely require additional finetuning of the weights of both DLAB-Re and DLAB-VS. One natural extension would be the use of flexible docking approaches, which could improve the input docking poses but would be computationally expensive given the scale of experiments needed in a high-throughput setting.</p>
    <p>We have demonstrated the applicability of structure-based deep learning approaches both to antibody research in general and to the virtual screening task specifically. Methods such as DLAB will improve with increasing availability of structural antibody data as well as improved antibody modelling and improved fast docking methods. DLAB demonstrates the potential of structure-based deep learning approaches to supplement traditional experimental screening approaches and sets a course for structure-based virtual screening methods for antibody drug discovery.</p>
  </sec>
  <sec>
    <title>Funding</title>
    <p>This work was supported by funding from the Engineering and Physical Sciences Research Council (EPSRC) and the Medical Research Council (MRC) [EP/L016044/1]; and AstraZeneca.</p>
    <p><italic toggle="yes">Conflict of Interest</italic>: none declared.</p>
  </sec>
  <sec>
    <title>Data availability </title>
    <p>The DLAB source code and pre-trained models are available at <ext-link xlink:href="https://github.com/oxpig/dlab-public" ext-link-type="uri">https://github.com/oxpig/dlab-public</ext-link>. The data used to create train and test sets are available in the online <xref rid="sup1" ref-type="supplementary-material">supplementary material</xref> or were derived from a source in the public domain: SAbDab (<ext-link xlink:href="http://opig.stats.ox.ac.uk/webapps/newsabdab/sabdab/" ext-link-type="uri">http://opig.stats.ox.ac.uk/webapps/newsabdab/sabdab/</ext-link>).</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="sup1" position="float" content-type="local-data">
      <label>btab660_Supplementary_Data</label>
      <media xlink:href="btab660_supplementary_data.zip">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="btab660-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Adolf-Bryfogle</surname><given-names>J.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2018</year>) <article-title>RosettaAntibodyDesign (RAbD): a general framework for computational antibody design</article-title>. <source>PLoS Comput. Biol</source>., <volume>14</volume>, <fpage>e1006112</fpage>.<pub-id pub-id-type="pmid">29702641</pub-id></mixed-citation>
    </ref>
    <ref id="btab660-B2">
      <mixed-citation publication-type="journal"><person-group><string-name><surname>Akbar</surname>,<given-names>R.</given-names></string-name></person-group><etal>et al</etal> (<year>2021</year>) <article-title>A compact vocabulary of paratope-epitope interactions enables predictability of antibody-antigen binding</article-title>. <source>Cell Reports</source>, <volume>34</volume>, <fpage>108856</fpage>.<pub-id pub-id-type="pmid">33730590</pub-id></mixed-citation>
    </ref>
    <ref id="btab660-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Almagro</surname><given-names>J.C.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2014</year>) <article-title>Second Antibody Modeling Assessment (AMA-II)</article-title>. <source>Proteins Struct. Funct. Bioinf</source>., <volume>82</volume>, <fpage>1553</fpage>–<lpage>1562</lpage>.</mixed-citation>
    </ref>
    <ref id="btab660-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Almagro</surname><given-names>J.C.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2017</year>) <article-title>Progress and challenges in the design and clinical development of antibodies for cancer therapy</article-title>. <source>Front. Immunol</source>., <volume>8</volume>, <fpage>1751</fpage>.<pub-id pub-id-type="pmid">29379493</pub-id></mixed-citation>
    </ref>
    <ref id="btab660-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Berman</surname><given-names>H.M.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2000</year>) <article-title>The Protein Data Bank</article-title>. <source>Nucleic Acids Res</source>., <volume>28</volume>, <fpage>235</fpage>–<lpage>242</lpage>.<pub-id pub-id-type="pmid">10592235</pub-id></mixed-citation>
    </ref>
    <ref id="btab660-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Bujotzek</surname><given-names>A.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2015</year>) <article-title>Prediction of VH-VL domain orientation for antibody variable domain modeling</article-title>. <source>Proteins Struct. Funct. Bioinf</source>., <volume>83</volume>, <fpage>681</fpage>–<lpage>695</lpage>.</mixed-citation>
    </ref>
    <ref id="btab660-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Chiu</surname><given-names>M.L.</given-names></string-name>, <string-name><surname>Gilliland</surname><given-names>G.L.</given-names></string-name></person-group> (<year>2016</year>) <article-title>Engineering antibody therapeutics</article-title>. <source>Curr. Opin. Struct. Biol</source>., <volume>38</volume>, <fpage>163</fpage>–<lpage>173</lpage>.<pub-id pub-id-type="pmid">27525816</pub-id></mixed-citation>
    </ref>
    <ref id="btab660-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Dunbar</surname><given-names>J.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2014</year>) <article-title>SAbDab: the structural antibody database</article-title>. <source>Nucleic Acids Res</source>., <volume>42</volume>, <fpage>D1140</fpage>–<lpage>D1146</lpage>.<pub-id pub-id-type="pmid">24214988</pub-id></mixed-citation>
    </ref>
    <ref id="btab660-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Graves</surname><given-names>J.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2020</year>) <article-title>A review of deep learning methods for antibodies</article-title>. <source>Antibodies</source>, <volume>9</volume>, <fpage>12</fpage>.<pub-id pub-id-type="pmid">32354020</pub-id></mixed-citation>
    </ref>
    <ref id="btab660-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Grilo</surname><given-names>A.L.</given-names></string-name>, <string-name><surname>Mantalaris</surname><given-names>A.</given-names></string-name></person-group> (<year>2019</year>) <article-title>The increasingly human and profitable monoclonal antibody market</article-title>. <source>Trends Biotechnol</source>., <volume>37</volume>, <fpage>9</fpage>–<lpage>16</lpage>.<pub-id pub-id-type="pmid">29945725</pub-id></mixed-citation>
    </ref>
    <ref id="btab660-B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Gu</surname><given-names>K.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2008</year>) <article-title>Testing the ratio of two Poisson rates</article-title>. <source>Biometrical J</source>., <volume>50</volume>, <fpage>283</fpage>–<lpage>298</lpage>.</mixed-citation>
    </ref>
    <ref id="btab660-B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Imrie</surname><given-names>F.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2018</year>) <article-title>Protein family-specific models using deep neural networks and transfer learning improve virtual screening and highlight the need for more data</article-title>. <source>J. Chem. Inf. Model</source>., <volume>58</volume>, <fpage>2319</fpage>–<lpage>2330</lpage>.<pub-id pub-id-type="pmid">30273487</pub-id></mixed-citation>
    </ref>
    <ref id="btab660-B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kilambi</surname><given-names>K.P.</given-names></string-name>, <string-name><surname>Gray</surname><given-names>J.J.</given-names></string-name></person-group> (<year>2017</year>) <article-title>Structure-based cross-docking analysis of antibody–antigen interactions</article-title>. <source>Sci. Rep</source>., <volume>7</volume>, <fpage>8145</fpage>.<pub-id pub-id-type="pmid">28811664</pub-id></mixed-citation>
    </ref>
    <ref id="btab660-B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lee</surname><given-names>B.</given-names></string-name>, <string-name><surname>Richards</surname><given-names>F.M.</given-names></string-name></person-group> (<year>1971</year>) <article-title>The interpretation of protein structures: estimation of static accessibility</article-title>. <source>J. Mol. Biol</source>., <volume>55</volume>, <fpage>379</fpage>–<lpage>400</lpage>.<pub-id pub-id-type="pmid">5551392</pub-id></mixed-citation>
    </ref>
    <ref id="btab660-B15">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Leem</surname><given-names>J.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2016</year>) <article-title>ABodyBuilder: automated antibody structure prediction with data–driven accuracy estimation</article-title>. <source>mAbs</source>, <volume>8</volume>, <fpage>1259</fpage>–<lpage>1268</lpage>.<pub-id pub-id-type="pmid">27392298</pub-id></mixed-citation>
    </ref>
    <ref id="btab660-B16">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Leem</surname><given-names>J.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2018</year>) <article-title>Antibody side chain conformations are position-dependent</article-title>. <source>Proteins Struct. Funct. Bioinf</source>., <volume>86</volume>, <fpage>383</fpage>–<lpage>392</lpage>.</mixed-citation>
    </ref>
    <ref id="btab660-B17">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Li</surname><given-names>W.</given-names></string-name>, <string-name><surname>Godzik</surname><given-names>A.</given-names></string-name></person-group> (<year>2006</year>) <article-title>Cd-hit: a fast program for clustering and comparing large sets of protein or nucleotide sequences</article-title>. <source>Bioinformatics</source>, <volume>22</volume>, <fpage>1658</fpage>–<lpage>1659</lpage>.<pub-id pub-id-type="pmid">16731699</pub-id></mixed-citation>
    </ref>
    <ref id="btab660-B18">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Liberis</surname><given-names>E.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2018</year>) <article-title>Parapred: antibody paratope prediction using convolutional and recurrent neural networks</article-title>. <source>Bioinformatics</source>, <volume>34</volume>, <fpage>2944</fpage>–<lpage>2950</lpage>.<pub-id pub-id-type="pmid">29672675</pub-id></mixed-citation>
    </ref>
    <ref id="btab660-B19">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Liu</surname><given-names>J.K.H.</given-names></string-name></person-group> (<year>2014</year>) <article-title>The history of monoclonal antibody development – progress, remaining challenges and future innovations</article-title>. <source>Ann. Med. Surg</source>., <volume>3</volume>, <fpage>113</fpage>–<lpage>116</lpage>.</mixed-citation>
    </ref>
    <ref id="btab660-B20">
      <mixed-citation publication-type="journal"><person-group><string-name><surname>Mason</surname>,<given-names>D.M.</given-names></string-name></person-group><etal>et al</etal> (<year>2021</year>) <article-title>Optimization of therapeutic antibodies by predicting antigen specificity from antibody sequence via deep learning</article-title>. <source>Nature Biomedical Engineering</source>, <volume>5</volume>, <fpage>600</fpage>–<lpage>612</lpage>.</mixed-citation>
    </ref>
    <ref id="btab660-B22">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Norman</surname><given-names>R.A.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2020</year>) <article-title>Computational approaches to therapeutic antibody design: established methods and emerging trends</article-title>. <source>Brief. Bioinf</source>., <volume>21</volume>, <fpage>1549</fpage>–<lpage>1567</lpage>.</mixed-citation>
    </ref>
    <ref id="btab660-B23">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Olimpieri</surname><given-names>P.P.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2013</year>) <article-title>Prediction of site-specific interactions in antibody–antigen complexes: the proABC method and server</article-title>. <source>Bioinformatics</source>, <volume>29</volume>, <fpage>2285</fpage>–<lpage>2291</lpage>.<pub-id pub-id-type="pmid">23803466</pub-id></mixed-citation>
    </ref>
    <ref id="btab660-B24">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Pierce</surname><given-names>B.G.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2011</year>) <article-title>Accelerating protein docking in ZDOCK using an advanced 3D convolution library</article-title>. <source>PLoS One</source>, <volume>6</volume>, <fpage>e24657</fpage>.<pub-id pub-id-type="pmid">21949741</pub-id></mixed-citation>
    </ref>
    <ref id="btab660-B25">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Pittala</surname><given-names>S.</given-names></string-name>, <string-name><surname>Bailey-Kellogg</surname><given-names>C.</given-names></string-name></person-group> (<year>2020</year>) <article-title>Learning context-aware structural representations to predict antigen and antibody binding interfaces</article-title>. <source>Bioinformatics</source>, <volume>36</volume>, <fpage>3996</fpage>–<lpage>4003</lpage>.<pub-id pub-id-type="pmid">32321157</pub-id></mixed-citation>
    </ref>
    <ref id="btab660-B26">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ragoza</surname><given-names>M.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2017</year>) <article-title>Protein–ligand scoring with convolutional neural networks</article-title>. <source>J. Chem. Inf. Model</source>., <volume>57</volume>, <fpage>942</fpage>–<lpage>957</lpage>.<pub-id pub-id-type="pmid">28368587</pub-id></mixed-citation>
    </ref>
    <ref id="btab660-B27">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Raybould</surname><given-names>M.I.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2019a</year>) <article-title>Antibody–antigen complex modelling in the era of immunoglobulin repertoire sequencing</article-title>. <source>Mol. Syst. Des. Eng</source>., <volume>4</volume>, <fpage>679</fpage>–<lpage>688</lpage>.</mixed-citation>
    </ref>
    <ref id="btab660-B28">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Raybould</surname><given-names>M.I.J.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2019b</year>) <article-title>Five computational developability guidelines for therapeutic antibody profiling</article-title>. <source>Proc. Natl. Acad. Sci. USA</source>, <volume>116</volume>, <fpage>4025</fpage>–<lpage>4030</lpage>.<pub-id pub-id-type="pmid">30765520</pub-id></mixed-citation>
    </ref>
    <ref id="btab660-B29">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Raybould</surname><given-names>M.I.J.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2020</year>) <article-title>CoV-AbDab: the coronavirus antibody database</article-title>. <source>Bioinformatics</source>, <volume>37</volume>, <fpage>734</fpage>–<lpage>735</lpage>.</mixed-citation>
    </ref>
    <ref id="btab660-B30">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Scantlebury</surname><given-names>J.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2020</year>) <article-title>Data set augmentation allows deep learning-based virtual screening to better generalize to unseen target classes and highlight important binding interactions</article-title>. <source>J. Chem. Inf. Model</source>., <volume>60</volume>, <fpage>3722</fpage>–<lpage>3730</lpage>.<pub-id pub-id-type="pmid">32701288</pub-id></mixed-citation>
    </ref>
    <ref id="btab660-B32">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Schymkowitz</surname><given-names>J.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2005</year>) <article-title>The FoldX web server: an online force field</article-title>. <source>Nucleic Acids Res</source>., <volume>33</volume>, <fpage>W382</fpage>–<lpage>W388</lpage>.<pub-id pub-id-type="pmid">15980494</pub-id></mixed-citation>
    </ref>
    <ref id="btab660-B33">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Seabold</surname><given-names>S.</given-names></string-name>, <string-name><surname>Perktold</surname><given-names>J.</given-names></string-name></person-group> (<year>2010</year>) statsmodels: econometric and statistical modeling with python. In: <italic toggle="yes">9th Python in Science Conference.</italic> Austin, Texas, USA.</mixed-citation>
    </ref>
    <ref id="btab660-B35">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Suscovich</surname><given-names>T.J.</given-names></string-name>, <string-name><surname>Alter</surname><given-names>G.</given-names></string-name></person-group> (<year>2015</year>) <article-title>In situ production of therapeutic monoclonal antibodies</article-title>. <source>Exp. Rev. Vaccines</source>, <volume>14</volume>, <fpage>205</fpage>–<lpage>219</lpage>.</mixed-citation>
    </ref>
    <ref id="btab660-B37">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Virtanen</surname><given-names>P.</given-names></string-name></person-group>  <etal>et al</etal>; SciPy 1.0 Contributors. (<year>2020</year>) <article-title>SciPy 1.0: fundamental algorithms for scientific computing in Python</article-title>. <source>Nat. Methods</source>, <volume>17</volume>, <fpage>261</fpage>–<lpage>272</lpage>.<pub-id pub-id-type="pmid">32015543</pub-id></mixed-citation>
    </ref>
    <ref id="btab660-B38">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wang</surname><given-names>X.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2020</year>) <article-title>Protein docking model evaluation by 3D deep convolutional neural networks</article-title>. <source>Bioinformatics</source>, <volume>36</volume>, <fpage>2113</fpage>–<lpage>2118</lpage>.<pub-id pub-id-type="pmid">31746961</pub-id></mixed-citation>
    </ref>
    <ref id="btab660-B39">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Weitzner</surname><given-names>B.D.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2017</year>) <article-title>Modeling and docking of antibody structures with Rosetta</article-title>. <source>Nat. Protoc</source>., <volume>12</volume>, <fpage>401</fpage>–<lpage>416</lpage>.<pub-id pub-id-type="pmid">28125104</pub-id></mixed-citation>
    </ref>
    <ref id="btab660-B40">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wodak</surname><given-names>S.J.</given-names></string-name>, <string-name><surname>Méndez</surname><given-names>R.</given-names></string-name></person-group> (<year>2004</year>) <article-title>Prediction of protein-protein interactions: the CAPRI experiment, its evaluation and implications</article-title>. <source>Curr. Opin. Struct. Biol</source>., <volume>14</volume>, <fpage>242</fpage>–<lpage>249</lpage>.<pub-id pub-id-type="pmid">15093840</pub-id></mixed-citation>
    </ref>
    <ref id="btab660-B41">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wong</surname><given-names>W.K.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2019</year>) <article-title>Comparative analysis of the CDR loops of antigen receptors</article-title>. <source>Front. Immunol</source>., <volume>10</volume>, <fpage>2454</fpage>.<pub-id pub-id-type="pmid">31681328</pub-id></mixed-citation>
    </ref>
    <ref id="btab660-B42">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Yamashita</surname><given-names>K.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2014</year>) <article-title>Kotai antibody builder: automated high-resolution structural modeling of antibodies</article-title>. <source>Bioinformatics</source>, <volume>30</volume>, <fpage>3279</fpage>–<lpage>3280</lpage>.<pub-id pub-id-type="pmid">25064566</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
