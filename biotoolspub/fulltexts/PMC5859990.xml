<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1 20151215//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.1?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">5859990</article-id>
    <article-id pub-id-type="pmid">28057677</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btw761</article-id>
    <article-id pub-id-type="publisher-id">btw761</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Applications Notes</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Genome Analysis</subject>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>PanViz: interactive visualization of the structure of functionally annotated pangenomes</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Pedersen</surname>
          <given-names>Thomas Lin</given-names>
        </name>
        <xref ref-type="aff" rid="btw761-aff1">1</xref>
        <xref ref-type="aff" rid="btw761-aff2">2</xref>
        <xref ref-type="corresp" rid="btw761-cor1"/>
        <!--<email>thomasp85@gmail.com</email>-->
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Nookaew</surname>
          <given-names>Intawat</given-names>
        </name>
        <xref ref-type="aff" rid="btw761-aff3">3</xref>
        <xref ref-type="aff" rid="btw761-aff4">4</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Wayne Ussery</surname>
          <given-names>David</given-names>
        </name>
        <xref ref-type="aff" rid="btw761-aff3">3</xref>
        <xref ref-type="aff" rid="btw761-aff4">4</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Månsson</surname>
          <given-names>Maria</given-names>
        </name>
        <xref ref-type="aff" rid="btw761-aff2">2</xref>
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Hancock</surname>
          <given-names>John</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <aff id="btw761-aff1"><label>1</label>Center for Biological Sequence Analysis, Department of Systems Biology, The Technical University of Denmark, Lyngby, Denmark</aff>
    <aff id="btw761-aff2"><label>2</label>Assays, Culture and Enzymes Division, DK-2970 Hørsholm, Denmark</aff>
    <aff id="btw761-aff3"><label>3</label>Comparative Genomics Group, Biosciences Division, Oak Ridge National Laboratory, Oak Ridge, TN, USA</aff>
    <aff id="btw761-aff4"><label>4</label>Department Biomedical Informatics, College of Medicine, University of Arkansas for Medical Sciences, Little Rock, AR, USA</aff>
    <author-notes>
      <corresp id="btw761-cor1">To whom correspondence should be addressed. Email: <email>thomasp85@gmail.com</email></corresp>
    </author-notes>
    <pub-date pub-type="ppub">
      <day>01</day>
      <month>4</month>
      <year>2017</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2016-12-31">
      <day>31</day>
      <month>12</month>
      <year>2016</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>31</day>
      <month>12</month>
      <year>2016</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the <pub-date pub-type="epub"/>. -->
    <volume>33</volume>
    <issue>7</issue>
    <fpage>1081</fpage>
    <lpage>1082</lpage>
    <history>
      <date date-type="received">
        <day>04</day>
        <month>4</month>
        <year>2016</year>
      </date>
      <date date-type="rev-recd">
        <day>23</day>
        <month>11</month>
        <year>2016</year>
      </date>
      <date date-type="accepted">
        <day>29</day>
        <month>11</month>
        <year>2016</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author 2016. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2016</copyright-year>
      <license license-type="cc-by-nc" xlink:href="http://creativecommons.org/licenses/by-nc/4.0/">
        <license-p>
This is an Open Access article distributed under the terms of the Creative Commons Attribution-NonCommercial-NoDerivs licence (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by-nc/4.0/">http://creativecommons.org/licenses/by-nc/4.0/</ext-link>), which permits non-commercial reproduction and distribution of the work, in any medium, provided the original work is not altered or transformed in any way, and that the work properly cited. For commercial re-use, please contact journals.permissions@oup.com</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btw761.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="SA1">
        <title>Summary</title>
        <p>PanViz is a novel, interactive, visualization tool for pangenome analysis. PanViz allows visualization of changes in gene group (groups of similar genes across genomes) classification as different subsets of pangenomes are selected, as well as comparisons of individual genomes to pangenomes with gene ontology based navigation of gene groups. Furthermore it allows for rich and complex visual querying of gene groups in the pangenome. PanViz visualizations require no external programs and are easily sharable, allowing for rapid pangenome analyses.</p>
      </sec>
      <sec id="SA2">
        <title>Availability and Implementation</title>
        <p>PanViz is written entirely in JavaScript and is available on <ext-link ext-link-type="uri" xlink:href="https://github.com/thomasp85/PanViz">https://github.com/thomasp85/PanViz</ext-link>. A companion R package that facilitates the creation of PanViz visualizations from a range of data formats is released through Bioconductor and is available at <ext-link ext-link-type="uri" xlink:href="https://bioconductor.org/packages/PanVizGenerator">https://bioconductor.org/packages/PanVizGenerator</ext-link>.</p>
      </sec>
      <sec id="SA3">
        <title>Supplementary information</title>
        <p><xref ref-type="supplementary-material" rid="sup1">Supplementary data</xref> are available at <italic>Bioinformatics</italic> online.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <named-content content-type="funder-name">Danish Agency for Science, Technology and Innovation</named-content>
        </funding-source>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="2"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec id="SEC1">
    <title>1 Introduction</title>
    <p>Visualization plays an integral part in modern biology research, as the size and complexity of biological data has increased (<xref rid="btw761-B11" ref-type="bibr">Land <italic>et al.</italic>, 2015</xref>). Many new tools for analysis of pangenomes have recently been published (<xref rid="btw761-B6" ref-type="bibr">Grant <italic>et al.</italic>, 2012</xref>; <xref rid="btw761-B7" ref-type="bibr">Hallin <italic>et al.</italic>, 2008</xref>; <xref rid="btw761-B12" ref-type="bibr">Lechat <italic>et al.</italic>, 2012</xref>; <xref rid="btw761-B13" ref-type="bibr">Rokicki <italic>et al.</italic>, 2014</xref>). However, several of these do not scale well. A general tendency for pangenome visualizations is to use the chromosome of a reference genome as an axis and plot synteny between genomes along that. Visualization based on a reference genome fails to take into account novel pan-genes not in the reference. As more genomes are added, the reference genome becomes less representative of the full dataset. Some attempts have been made to create reference free, scalable pangenome visualization of different types. GenoSets (<xref rid="btw761-B3" ref-type="bibr">Cain <italic>et al.</italic>, 2012</xref>) is a visualization that uses parallel sets to facilitate gene group selections based on presence-absence in pangenome subsets and GenomeRing (<xref rid="btw761-B8" ref-type="bibr">Herbig <italic>et al.</italic>, 2012</xref>) tries to overcome the reference bias by merging all chromosomes into a superchromosome that can be used as a backbone for visualization. Here we present a new interactive visualization, PanViz, aimed at letting users explore the structure of functionally annotated pangenomes and pangenome subsets, while performing visual queries to search for gene groups. PanViz is based purely on GO annotation and the presence/absence pattern of gene groups, and is thus not dependent on a single reference genome</p>
  </sec>
  <sec>
    <title>2 Implementation</title>
    <p>PanViz is written entirely in JavaScript using D3 (<xref rid="btw761-B2" ref-type="bibr">Bostock <italic>et al.</italic>, 2011</xref>). It is completely self-contained, embedded in a single HTML file, and does not require any connection to external sources. A companion R package, PanVizGenerator, has been released on Bioconductor (<xref rid="btw761-B5" ref-type="bibr">Gentleman <italic>et al.</italic>, 2003</xref>; <xref rid="btw761-B9" ref-type="bibr">Huber <italic>et al.</italic>, 2015</xref>) that facilitates the creation of new PanViz visualizations. The input data needed by PanVizGenerator is a pangenome matrix giving the presence/absence pattern of each gene group across the included genomes, as well as a Gene Ontology (GO) (<xref rid="btw761-B1" ref-type="bibr">Ashburner <italic>et al.</italic>, 2000</xref>) based functional annotation of each gene group. The latter can be derived by analyzing a representative sequence for each gene group using e.g. InterProScan (<xref rid="btw761-B10" ref-type="bibr">Jones <italic>et al.</italic>, 2014</xref>; <xref rid="btw761-B14" ref-type="bibr">Zdobnov and Apweiler, 2001</xref>) or Blast2GO (<xref rid="btw761-B4" ref-type="bibr">Conesa <italic>et al.</italic>, 2005</xref>). A gene group in this context is a group of similar genes across genomes. The simple nature of the input data means that PanViz works with any pangenome tool, though the method of achieving a pangenome matrix might vary.</p>
  </sec>
  <sec>
    <title>3 Overview</title>
    <p>PanViz consists of four main areas (see <xref ref-type="supplementary-material" rid="sup1">Supplementary Fig. S1</xref> in <xref ref-type="supplementary-material" rid="sup1">supplementary material</xref>). The left part is reserved for (pan)genome navigation (<xref ref-type="supplementary-material" rid="sup1">Supplementary Fig. S1</xref>A), the center part for pangenome visualization (<xref ref-type="supplementary-material" rid="sup1">Supplementary Fig. S1</xref>B), while the right part is for legends and additional lookup information (<xref ref-type="supplementary-material" rid="sup1">Supplementary Fig. S1</xref>C). In the bottom a list of all the currently selected gene groups is available, as well as tools to modify the selection (<xref ref-type="supplementary-material" rid="sup1">Supplementary Fig. S1</xref>D).</p>
    <sec>
      <title>3.1 Genome navigation</title>
      <p>The genomes in the pangenome are represented by a dual linked view with a principal component analysis/multidimensional scaling based scatterplot on top, and a zoomable hierarchical clustering in the bottom (<xref ref-type="supplementary-material" rid="sup1">Supplementary Fig. S1</xref>A) both based on the pangenome matrix. Both views support selecting single genomes in order to transition into the genome-pangenome comparison state, and the dendrogram allows for selection of subsets of the pangenome by selecting the branch points of the dendrogram. The overview plots are also linked to the gene group table (<xref ref-type="supplementary-material" rid="sup1">Supplementary Fig. S1</xref>D) so that all genomes containing the gene group currently hovered over will be highlighted.</p>
    </sec>
    <sec>
      <title>3.2 Pangenome overview</title>
      <p>The main view of the visualization is a radial representation of the 3 presence-based gene group groupings in the pangenome: Core, Accessory and Singleton gene groups (<xref ref-type="supplementary-material" rid="sup1">Supplementary Fig. S1</xref>B1). Each of these is furthermore divided based on the distribution of top level biological process GO terms. As different sub-pangenomes are selected, the changes in the pangenome are animated by moving sections of each GO term arc around. After the animation ends the dynamics can furthermore be shown as chords when hovering over a specific GO arc.</p>
    </sec>
    <sec>
      <title>3.3 Genome-pangenome comparison</title>
      <p>When one or two genomes are selected the main view transitions into a stacked bar chart showing the pangenome in the middle (<xref ref-type="supplementary-material" rid="sup1">Supplementary Fig. S1</xref>B2). The genomes are represented by their GO term composition and weighted bezier curves connectes the genes in the genomes to their location in the pangenome (if present). If two genomes are selected the proportion of each GO term they share with each other and the pangenome is visible as a darker shaded bezier curve.</p>
    </sec>
    <sec>
      <title>3.4 Gene ontology naivgation</title>
      <p>To gain insight into the distribution of lower level GO terms a treemap weighted by the number of gene groups in the current pangenome having a specific term is available upon selecting a top level GO term bar from the pangenome (<xref ref-type="supplementary-material" rid="sup1">Supplementary Fig. S1</xref>B3). The treemap is zoomable and features descriptions of each included GO term.</p>
    </sec>
    <sec>
      <title>3.5 Visual querying</title>
      <p>As each visual element represents of a set of gene groups it makes sense to build a querying mechanism based on set arithmetic (union, intersection, complement, etc.). An icon on top of the gene group table indicates the different set operations available (<xref ref-type="supplementary-material" rid="sup1">Supplementary Fig. S1</xref>D). The operations will be performed between the current content of the table and the gene groups contained in the visual element selected. Based on the six different operations it is possible to intuitively create very complex gene group queries guided by the insights gained from the visualization.</p>
    </sec>
  </sec>
  <sec>
    <title>4 Conclusion</title>
    <p>PanViz offers a novel and unbiased approach to visualizing the structure of pangenome data. Interactions and animations are utilized to invite users to investigate the data, and the reliance of a single self-contained HTML file makes it easy to share with fellow researchers. The main visualization is fully scalable to thousands of gene groups and genomes as it relies on summaries, but larger pangenomes will require faster hardware due to the dynamic nature of the visualization. PanViz helps researchers in understanding how different pangenomes differ on a functional level rather than simply in terms of shared gene groups. Future work will focus on implementing state saving within the URL to facilitate sharing of different states of a PanViz visualization, as well as performance improvement to the implementation.</p>
  </sec>
  <sec>
    <title>Funding</title>
    <p>This work was supported by The Danish Agency for Science, Technology and Innovation.</p>
    <p><italic>Conflict of Interest</italic>: none declared.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material content-type="local-data" id="sup1">
      <label>Supplementary Data</label>
      <media xlink:href="btw761_supp.zip">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ref-list>
    <title>References</title>
    <ref id="btw761-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Ashburner</surname><given-names>M.</given-names></name></person-group><etal>et al</etal> (<year>2000</year>) 
<article-title>Gene ontology: tool for the unification of biology</article-title>. <source>Nat. Genet</source>., <volume>25</volume>, <fpage>25</fpage>–<lpage>29</lpage>.<pub-id pub-id-type="pmid">10802651</pub-id></mixed-citation>
    </ref>
    <ref id="btw761-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Bostock</surname><given-names>M.</given-names></name></person-group><etal>et al</etal> (<year>2011</year>) 
<article-title>D<sup>3</sup>: Data-Driven Documents</article-title>. <source>IEEE Trans. Vis. Comput. Graph</source>., <volume>17</volume>, <fpage>2301</fpage>–<lpage>2309</lpage>.<pub-id pub-id-type="pmid">22034350</pub-id></mixed-citation>
    </ref>
    <ref id="btw761-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Cain</surname><given-names>A.A.</given-names></name></person-group><etal>et al</etal> (<year>2012</year>) 
<article-title>GenoSets: visual analytic methods for comparative genomics</article-title>. <source>PLoS ONE</source>, <volume>7</volume>, <fpage>e46401.</fpage><pub-id pub-id-type="pmid">23056299</pub-id></mixed-citation>
    </ref>
    <ref id="btw761-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Conesa</surname><given-names>A.</given-names></name></person-group><etal>et al</etal> (<year>2005</year>) 
<article-title>Blast2GO: a universal tool for annotation, visualization and analysis in functional genomics research</article-title>. <source>Bioinformatics</source>, <volume>21</volume>, <fpage>3674</fpage>–<lpage>3676</lpage>.<pub-id pub-id-type="pmid">16081474</pub-id></mixed-citation>
    </ref>
    <ref id="btw761-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Gentleman</surname><given-names>R.C.</given-names></name></person-group><etal>et al</etal> (<year>2003</year>) 
<article-title>Bioconductor: open software development for computational biology and bioinformatics</article-title>. <source>Genome Biol</source>., <volume>5</volume>, <fpage>R80</fpage>–<lpage>R80</lpage>.</mixed-citation>
    </ref>
    <ref id="btw761-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Grant</surname><given-names>J.R.</given-names></name></person-group><etal>et al</etal> (<year>2012</year>) 
<article-title>Comparing thousands of circular genomes using the CGView Comparison Tool</article-title>. <source>BMC Genomics</source>, <volume>13</volume>, <fpage>202.</fpage><pub-id pub-id-type="pmid">22621371</pub-id></mixed-citation>
    </ref>
    <ref id="btw761-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Hallin</surname><given-names>P.F.</given-names></name></person-group><etal>et al</etal> (<year>2008</year>) 
<article-title>The genome BLASTatlas-a GeneWiz extension for visualization of whole-genome homology</article-title>. <source>Mol. bioSyst</source>., <volume>4</volume>, <fpage>363</fpage>–<lpage>371</lpage>.<pub-id pub-id-type="pmid">18414733</pub-id></mixed-citation>
    </ref>
    <ref id="btw761-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Herbig</surname><given-names>A.</given-names></name></person-group><etal>et al</etal> (<year>2012</year>) 
<article-title>GenomeRing: alignment visualization based on SuperGenome coordinates</article-title>. <source>Bioinformatics</source>, <volume>28</volume>, <fpage>i7</fpage>–<lpage>15</lpage>.<pub-id pub-id-type="pmid">22689781</pub-id></mixed-citation>
    </ref>
    <ref id="btw761-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Huber</surname><given-names>W.</given-names></name></person-group><etal>et al</etal> (<year>2015</year>) 
<article-title>Orchestrating high-throughput genomic analysis with Bioconductor</article-title>. <source>Nat. Methods</source>, <volume>12</volume>, <fpage>115</fpage>–<lpage>121</lpage>.<pub-id pub-id-type="pmid">25633503</pub-id></mixed-citation>
    </ref>
    <ref id="btw761-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Jones</surname><given-names>P.</given-names></name></person-group><etal>et al</etal> (<year>2014</year>) 
<article-title>InterProScan 5: genome-scale protein function classification</article-title>. <source>Bioinformatics</source>, <volume>30</volume>, <fpage>1236</fpage>–<lpage>1240</lpage>.<pub-id pub-id-type="pmid">24451626</pub-id></mixed-citation>
    </ref>
    <ref id="btw761-B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Land</surname><given-names>M.</given-names></name></person-group><etal>et al</etal> (<year>2015</year>) 
<article-title>Insights from 20 years of bacterial genome sequencing</article-title>. <source>Funct. Integr. Genomics</source>, <volume>15</volume>, <fpage>141</fpage>–<lpage>161</lpage>.<pub-id pub-id-type="pmid">25722247</pub-id></mixed-citation>
    </ref>
    <ref id="btw761-B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Lechat</surname><given-names>P.</given-names></name></person-group><etal>et al</etal> (<year>2012</year>) 
<article-title>SynTView – an interactive multi-view genome browser for next-generation comparative microorganism genomics</article-title>. <source>BMC Bioinformatics</source>, <volume>14</volume>, <fpage>277–277.</fpage></mixed-citation>
    </ref>
    <ref id="btw761-B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Rokicki</surname><given-names>J.</given-names></name></person-group><etal>et al</etal> (<year>2014</year>) 
<article-title>CodaChrome: a tool for the visualization of proteome conservation across all fully sequenced bacterial genomes</article-title>. <source>BMC Genomics</source>, <volume>15</volume>, <fpage>65.</fpage><pub-id pub-id-type="pmid">24460813</pub-id></mixed-citation>
    </ref>
    <ref id="btw761-B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Zdobnov</surname><given-names>E.M.</given-names></name>, <name name-style="western"><surname>Apweiler</surname><given-names>R.</given-names></name></person-group> (<year>2001</year>) 
<article-title>InterProScan – an integration platform for the signature-recognition methods in InterPro</article-title>. <source>Bioinformatics</source>, <volume>17</volume>, <fpage>847</fpage>–<lpage>848</lpage>.<pub-id pub-id-type="pmid">11590104</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
