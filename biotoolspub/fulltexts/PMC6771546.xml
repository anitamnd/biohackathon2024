<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1 20151215//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.1?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Gigascience</journal-id>
    <journal-id journal-id-type="iso-abbrev">Gigascience</journal-id>
    <journal-id journal-id-type="publisher-id">gigascience</journal-id>
    <journal-title-group>
      <journal-title>GigaScience</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2047-217X</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">6771546</article-id>
    <article-id pub-id-type="doi">10.1093/gigascience/giz121</article-id>
    <article-id pub-id-type="publisher-id">giz121</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Technical Note</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>IKAP—Identifying K mAjor cell Population groups in single-cell RNA-sequencing analysis</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Chen</surname>
          <given-names>Yun-Ching</given-names>
        </name>
        <xref ref-type="aff" rid="aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Suresh</surname>
          <given-names>Abhilash</given-names>
        </name>
        <xref ref-type="aff" rid="aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Underbayev</surname>
          <given-names>Chingiz</given-names>
        </name>
        <xref ref-type="aff" rid="aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Sun</surname>
          <given-names>Clare</given-names>
        </name>
        <xref ref-type="aff" rid="aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Singh</surname>
          <given-names>Komudi</given-names>
        </name>
        <xref ref-type="aff" rid="aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Seifuddin</surname>
          <given-names>Fayaz</given-names>
        </name>
        <xref ref-type="aff" rid="aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Wiestner</surname>
          <given-names>Adrian</given-names>
        </name>
        <xref ref-type="aff" rid="aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">http://orcid.org/0000-0002-4210-6458</contrib-id>
        <name>
          <surname>Pirooznia</surname>
          <given-names>Mehdi</given-names>
        </name>
        <!--<email>mehdi.pirooznia@nih.gov</email>-->
        <xref ref-type="aff" rid="aff1">1</xref>
        <xref ref-type="corresp" rid="cor1"/>
      </contrib>
    </contrib-group>
    <aff id="aff1"><label>1</label><institution>Bioinformatics and Computational Biology Laboratory, National Heart, Lung, and Blood Institute, National Institutes of Health</institution>, 12 South Drive, Bethesda, MD 20892, <country country="US">USA</country></aff>
    <aff id="aff2"><label>2</label><institution>Hematology Branch, National Heart, Lung, and Blood Institute, National Institutes of Health</institution>, 10 Center Drive, Bethesda, MD 20814, <country country="US">USA</country></aff>
    <author-notes>
      <corresp id="cor1"><bold>Correspondence address</bold>. Mehdi Pirooznia, Bioinformatics and Computational Biology Laboratory, National Heart, Lung, and Blood Institute, National Institutes of Health, 12 South Drive, Bethesda, MD 20892, USA. E-mail: <email>mehdi.pirooznia@nih.gov</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <month>10</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2019-10-01">
      <day>01</day>
      <month>10</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>01</day>
      <month>10</month>
      <year>2019</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the <pub-date pub-type="epub"/>. -->
    <volume>8</volume>
    <issue>10</issue>
    <elocation-id>giz121</elocation-id>
    <history>
      <date date-type="received">
        <day>23</day>
        <month>4</month>
        <year>2019</year>
      </date>
      <date date-type="rev-recd">
        <day>05</day>
        <month>8</month>
        <year>2019</year>
      </date>
      <date date-type="accepted">
        <day>16</day>
        <month>9</month>
        <year>2019</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2019. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2019</copyright-year>
      <license license-type="cc-by" xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="giz121.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="abs1">
        <title>Background</title>
        <p>In single-cell RNA-sequencing analysis, clustering cells into groups and differentiating cell groups by differentially expressed (DE) genes are 2 separate steps for investigating cell identity. However, the ability to differentiate between cell groups could be affected by clustering. This interdependency often creates a bottleneck in the analysis pipeline, requiring researchers to repeat these 2 steps multiple times by setting different clustering parameters to identify a set of cell groups that are more differentiated and biologically relevant.</p>
      </sec>
      <sec id="abs2">
        <title>Findings</title>
        <p>To accelerate this process, we have developed IKAP—an algorithm to identify major cell groups and improve differentiating cell groups by systematically tuning parameters for clustering. We demonstrate that, with default parameters, IKAP successfully identifies major cell types such as T cells, B cells, natural killer cells, and monocytes in 2 peripheral blood mononuclear cell datasets and recovers major cell types in a previously published mouse cortex dataset. These major cell groups identified by IKAP present more distinguishing DE genes compared with cell groups generated by different combinations of clustering parameters. We further show that cell subtypes can be identified by recursively applying IKAP within identified major cell types, thereby delineating cell identities in a multi-layered ontology.</p>
      </sec>
      <sec id="abs3">
        <title>Conclusions</title>
        <p>By tuning the clustering parameters to identify major cell groups, IKAP greatly improves the automation of single-cell RNA-sequencing analysis to produce distinguishing DE genes and refine cell ontology using single-cell RNA-sequencing data.</p>
      </sec>
    </abstract>
    <kwd-group kwd-group-type="keywords">
      <kwd>single-cell RNA-sequencing</kwd>
      <kwd>clustering</kwd>
      <kwd>cell ontology</kwd>
      <kwd>Seurat</kwd>
    </kwd-group>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <named-content content-type="funder-name">National Heart, Lung, and Blood Institute</named-content>
          <named-content content-type="funder-identifier">10.13039/100000050</named-content>
        </funding-source>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <named-content content-type="funder-name">National Institutes of Health</named-content>
          <named-content content-type="funder-identifier">10.13039/100000002</named-content>
        </funding-source>
        <award-id>1ZICHL006228-02</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="8"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec id="sec1">
    <title>Findings</title>
    <p>Single-cell RNA-sequencing (scRNA-seq) enables inquiry of cell identity based on single-cell transcriptomics. To facilitate cell type characterization and recognition, computational methods have been developed for (i) clustering cells with similar transcriptomic profiles into groups and (ii) identifying a set of differentially expressed (DE) genes to differentiate those cell groups [<xref rid="bib1" ref-type="bibr">1</xref>]. These 2 tasks are frequently treated as independent entities. However, groups identified by clustering greatly determine the DE genes associated with each group. Compared with clustering, computing DE genes is often more resource intensive. We therefore attempted to improve and accelerate biological interpretation of RNA-seq data by developing an algorithm to effectively identify the <italic>k</italic> major groups that produce distinguishing DE genes.</p>
    <p>Despite the existence of well-performing scRNA-seq clustering methods, identifying <italic>k</italic> groups remains a challenge owing to parameter specification [<xref rid="bib2" ref-type="bibr">2</xref>]. Most (if not all) clustering methods require a parameter suggesting <italic>k</italic> and a list of genes or principal components (PCs) for computing cell-to-cell similarity. The proper <italic>k</italic> is generally unknown a priori. Choosing a small <italic>k</italic> may mix &gt;1 cell type in a group whereas choosing a large <italic>k</italic> would result in many subgroups of unclear biological significance. Both can complicate cell type recognition by producing uninformative DE genes. In addition, feature selection can affect grouping quality, which, in turn affects its distinguishing power. Therefore, <italic>k</italic> and feature selection often become a bottleneck in the scRNA-seq analysis pipeline.</p>
    <p>To address this issue, we propose an unbiased approach—called IKAP (Identifying K mAjor cell Population groups)—which identifies well-separated <italic>k</italic> major groups poised to produce distinguishing DE genes in an scRNA-seq dataset by systematically exploring the parameter space (Fig. <xref ref-type="fig" rid="fig1">1</xref> and Online Methods). IKAP is implemented on top of Seurat [<xref rid="bib3" ref-type="bibr">3</xref>]—one of the most widely used scRNA-seq analysis packages—in which clustering requires 2 parameters that need to be specified by users: resolution <italic>r</italic> that determines <italic>k</italic> (the higher <italic>r</italic>, the larger <italic>k</italic>) and the number of top principal components (nPC). Briefly, for a given nPC, IKAP initializes a set of <italic>k</italic><sub>max</sub> groups by setting a high <italic>r</italic>. To simulate the fine-to-coarse grouping process, 2 nearest groups are merged iteratively, generating <italic>k</italic><sub>max</sub> sets of groups with <italic>k</italic> = 1 to <italic>k</italic><sub>max</sub>. For each set, the gap statistic is computed to measure the gap between the grouping with observed data and that with random data [<xref rid="bib4" ref-type="bibr">4</xref>]. The gap often monotonically increases (at variable amount) as <italic>k</italic> increases from 1 to <italic>k</italic><sub>max</sub>, indicating that splitting out each group somewhat contributes to the grouping moving away from randomness (<xref ref-type="supplementary-material" rid="sup9">Supplementary Fig. 1</xref>). We reason that those <italic>k</italic>’s that contribute more (i.e., yield large gap increase) might correspond to the set of <italic>k</italic> well-separated major groups. IKAP repeats this procedure for a range of nPCs. Finally, a few candidate sets of cell groups with large gap increases are picked. Among all candidate sets, the one with the lowest classification error is marked as the best, using decision trees built from DE genes. IKAP can be run default without specifying any parameter as we did for experimentation in this study and can potentially be tailored for scRNA-seq clustering methods other than Seurat.</p>
    <fig id="fig1" orientation="portrait" position="float">
      <label>Figure 1:</label>
      <caption>
        <p>IKAP workflow. See Online Methods for details. SNN: shared nearest neighbor.</p>
      </caption>
      <graphic xlink:href="giz121fig1"/>
    </fig>
    <p>We tested IKAP on a peripheral blood mononuclear cell (PBMC) dataset of ∼8,000 cells (denoted as PBMC_8K) from a healthy donor [<xref rid="bib5" ref-type="bibr">5</xref>]. The best set (with <italic>k</italic> = 7 and nPC = 9; thus, abbreviated as PC9K7) and 2 alternative sets (PC16K8 and PC18K9, respectively) were reported. The major groups reported in PC9K7 were effectively aligned with known major cell types such as B cells, T cells, and natural killer (NK) cells as evidenced by expression of marker genes (Fig. <xref ref-type="fig" rid="fig2">2A</xref>). Note that in this paper, cell types are defined as types of cells that have been manually (or conventionally) annotated and defined by a set of marker genes. Those marker genes of different cell types (such as <italic>CD3E, TRAC</italic>, and <italic>IL32</italic> for T cells) were also prioritized to the top of the DE gene list for every group (Fig. <xref ref-type="fig" rid="fig2">2B</xref>), facilitating cell type determination. To compare with the trial-and-error strategy, we varied nPC (=5, 10, 15, and 20) and <italic>r</italic> (=0.1, 0.2, 0.4, 0.6, and 1.0) to generate 20 trial sets of groups using Seurat clustering. Most trial sets did not divide cells into major cell types (<xref ref-type="supplementary-material" rid="sup9">Supplementary Fig. 2</xref>) and cell type marker genes were not ranked at the top or were unspecific to particular cell groups, complicating cell type recognition (<xref ref-type="supplementary-material" rid="sup9">Supplementary Fig. 3</xref>). To quantitatively evaluate whether a set of cell groups can produce distinguishing DE genes, we designed 3 metrics: (i) the number of DE genes with high AUROC (area under the receiver operating curve), (ii) in-group versus out-of-group expression fold change among high-AUROC DE genes, and (iii) classification error when classifying cells using decision trees built from multiple DE genes. Compared with the 20 trial sets, we found PC9K7 yielded more DE genes with high AUROC, higher expression fold change, and lower classification error (Fig. <xref ref-type="fig" rid="fig2">2C</xref>). Two alternative sets (PC16K8 and PC18K9) also agreed with major cell types and produced distinguishing DE genes with more rare types or subtypes reported (Fig. <xref ref-type="fig" rid="fig2">2C</xref>; <xref ref-type="supplementary-material" rid="sup9">Supplementary Fig. 4</xref>). Finally, IKAP consumed less time (1 hr 10 m) than computing the 20 trial sets (5 hr 13 m) (Fig. <xref ref-type="fig" rid="fig2">2C</xref>). Although IKAP required an extra step to explore parameter space (19 m), much time was saved because of fewer runs (3 candidate sets versus 20 trial sets) of time-consuming DE gene identification. The result shows that IKAP could help biological interpretation by picking appropriate parameters and reporting major cell groups that produce distinguishing DE genes within a reasonable time frame.</p>
    <fig id="fig2" orientation="portrait" position="float">
      <label>Figure 2:</label>
      <caption>
        <p>Major cell groups identified for PBMC_8K (A, B, and C) and the mouse cortex dataset (D, E, and F). (A) Shown are tSNE plots for the 7 major groups identified by IKAP with cell types labeled (top) and expression of known marker genes (bottom): <italic>CD3E</italic> for T cells, <italic>CD79A</italic> for B cells, <italic>GNLY</italic> for NK cells, and <italic>LYZ</italic> for monocytes. (B) The heat map for expression of the top 5 DE genes (by expression fold change) from each group in (A). Rows are genes and columns are cells. (C) Performance summary of 3 candidate sets proposed by IKAP (left) and the 20 trial sets (right). Note that the number of candidate sets can vary for different datasets. Running time is shown at the bottom. The dashed blue lines indicate the number of cell groups (top) and the median log<sub>2</sub> fold change (bottom) of the best set (PC9K7). (D) The tSNE plot for 8 major groups identified by IKAP in the mouse cortex dataset consistent with previously annotated cell types. (E) The heat map for expression of marker genes annotated for major cell types in Zeisel et al. 2015 [<xref rid="bib6" ref-type="bibr">6</xref>] (blue) and DE genes identified by IKAP for groups 3 and 7 in (D) (red). (F) The heat map indicates the proportion of overlapping cells between IKAP-identified major groups and major cell types annotated in Zeisel et al. 2015 [<xref rid="bib6" ref-type="bibr">6</xref>].</p>
      </caption>
      <graphic xlink:href="giz121fig2"/>
    </fig>
    <p>To test robustness, we repeated the same analysis for another dataset, PBMC_4K (∼4,000 cells), from the same donor [<xref rid="bib5" ref-type="bibr">5</xref>]. This time 2 candidate sets (PC8K7 and PC20K8) were picked with PC20K8 marked as the best. Compared with the 20 trial sets, IKAP candidate sets were in better agreement with known cell types, cell type marker genes being prioritized at the top, producing more distinguishing DE genes, and consuming shorter running time (<xref ref-type="supplementary-material" rid="sup9">Supplementary Figs 5–7</xref>).</p>
    <p>Next, we applied IKAP on a mouse cortex dataset (∼3,000 cells) in which 9 major cell types were previously annotated in Zeisel et al. 2015 [<xref rid="bib6" ref-type="bibr">6</xref>] (<xref ref-type="supplementary-material" rid="sup9">Supplementary Fig. 8A</xref>). IKAP identified 1 candidate set with 8 major groups (PC13K8) (Fig. <xref ref-type="fig" rid="fig2">2D</xref>). Six groups were consistent with the annotated cell types as evidenced by expressing marker genes annotated specific to those cell types (Fig. <xref ref-type="fig" rid="fig2">2E</xref>) and high proportion of overlapping cells (Fig. <xref ref-type="fig" rid="fig2">2F</xref>). For the 2 remaining groups, one was a subtype of microglia cells (group 3 in Fig. <xref ref-type="fig" rid="fig2">2D</xref>) characterized by <italic>Hexb</italic> (AUROC = 1.0), <italic>Cst3</italic> (0.98), and <italic>P2ry12</italic> (0.98) and the other was the union of 3 annotated cell types, interneurons, pyramidal S1, and pyramidal CA1 (group 7 in Fig. <xref ref-type="fig" rid="fig2">2D</xref>), characterized by many DE genes including <italic>Atp1a3</italic> (0.93), <italic>Ndrg4</italic> (0.94), and <italic>Stmn3</italic> (0.93) (Fig. <xref ref-type="fig" rid="fig2">2E</xref>; <xref ref-type="supplementary-material" rid="sup9">Supplementary Fig. 9</xref>). Those genes were significantly upregulated in interneurons, pyramidal S1, and pyramidal CA1 compared with every other cell type annotated in Zeisel et al. 2015 [<xref rid="bib6" ref-type="bibr">6</xref>] (<xref ref-type="supplementary-material" rid="sup9">Supplementary Table 1</xref>). The common gene expression profile suggested a high-level cell identity shared across the 3 cell types, which was consistent with the clustering result showing their similarity compared to other cell types in Zeisel et al. 2015 (see Fig. <xref ref-type="fig" rid="fig1">1C</xref> in [<xref rid="bib6" ref-type="bibr">6</xref>]). Compared with the 20 trial sets (generated in the same way described above), DE genes in PC13K8 yielded higher expression fold change and lower classification error (<xref ref-type="supplementary-material" rid="sup9">Supplementary Fig. 8B</xref>). Interestingly, the number of DE genes with high AUROC remained high as more subgroups were identified (which was not true for PBMC datasets), suggesting that transcriptomic differentiation in the mouse cortex cells was very fine-grained. Overall, IKAP successfully recovered major cell types (rather than many subtypes) that were consistent with previous annotations and produced distinguishing DE genes.</p>
    <p>Finally, IKAP can be used to recover finer types (or subtypes) by running it recursively within each major cell group. To demonstrate this approach, we expanded 2 layers deeper for all 3 datasets by applying IKAP on their biggest major groups and the biggest resulting subgroups. For the mouse cortex dataset, IKAP successfully recovered interneurons, pyramidal S1, and pyramidal CA1 by subdividing their union group (group 7 in Fig. <xref ref-type="fig" rid="fig2">2D</xref>) (Fig. <xref ref-type="fig" rid="fig3">3A</xref>–<xref ref-type="fig" rid="fig3">C</xref>). The 3-layer ontology (Fig. <xref ref-type="fig" rid="fig3">3A</xref>) delineated a more complete view of cell identities in the mouse cortex dataset. It not only reported all previously annotated cell types but also potential high-level cell identities such as the union of interneurons, pyramidal S1, and pyramidal CA1 (Fig. <xref ref-type="fig" rid="fig2">2E</xref>) and the union of 2 pyramidal cell types (Fig. <xref ref-type="fig" rid="fig3">3C</xref>). For PBMC datasets, T cells (the biggest group) were subdivided into 2 layers of subgroups in which subgroups in the same layers were consistent between PBMC_4K and PBMC_8K, suggesting that the ontology built by IKAP could be reproduced in replicates (Fig. <xref ref-type="fig" rid="fig3">3D</xref>–<xref ref-type="fig" rid="fig3">F</xref>; <xref ref-type="supplementary-material" rid="sup9">Supplementary Figs 10 and 11</xref>). Based on identified DE genes, subgroups in the first layer were LDHB<sup>+</sup>, CCL5<sup>+</sup>, and LYZ<sup>+</sup> T cells. The LDHB<sup>+</sup> T cells were further divided into CCR7<sup>+</sup>, CD8-/IL7R<sup>+</sup>, and CD8<sup>−</sup>/IL7R<sup>−</sup> T cells in the second layer. Results shown above were the best sets selected among candidate sets proposed by IKAP. The reported ontology can be modified by manual inspection of different candidate sets. For example, within T cells, a more flattened ontology was achieved by using the candidate set with 7 subgroups (among 4 candidate sets) for PBMC_4K and the set with 10 subgroups (among 5 sets) for PBMC_8K (<xref ref-type="supplementary-material" rid="sup9">Supplementary Figs 12–14</xref>).</p>
    <fig id="fig3" orientation="portrait" position="float">
      <label>Figure 3:</label>
      <caption>
        <p>Examples of cell ontology proposed by IKAP. Three cell ontology examples were built by recursively running IKAP on the biggest groups (circled in red) for the mouse cortex dataset (A), PBMC_4K (D), and PBMC_8K (E). Putative cell types were labeled. Unknown types were left as blanks. (B) Shown is the tSNE plot for major groups and subgroups of group 7 presented in the mouse cortex ontology in (A). (C) The heat map shows expression of DE genes identified by IKAP (red) and annotated in Zeisel et al. 2015 [<xref rid="bib6" ref-type="bibr">6</xref>] (blue) for subgroups of group 7 in (A) (labeled at bottom). (F) Heat maps show expression of selected DE genes that differentiate T-cell subtypes in PBMC_4K (top; subgroups labeled according to the ontology in [D]) and in PBMC_8K (bottom; subgroups labeled according to the ontology in [E]). Subgroups with similar expression profiles are linked by lines between PBMC_4K and PBMC_8K.</p>
      </caption>
      <graphic xlink:href="giz121fig3"/>
    </fig>
    <p>In summary, IKAP can identify major cell groups that produce distinguishing DE genes without the need for specifying clustering parameters, facilitating the automation of the scRNA-seq analysis pipeline. In addition, by recursively applying IKAP within reported cell groups, subtypes can be identified at a finer resolution, delineating cell identities in a multi-layered ontology. As more and more scRNA-seq datasets are generated, it is worth noting that using single-cell transcriptomic data to refine existing cell ontology [<xref rid="bib7" ref-type="bibr">7</xref>, <xref rid="bib8" ref-type="bibr">8</xref>] and to curate reference cell identities [<xref rid="bib9" ref-type="bibr">9</xref>] is a necessary step forward. Because cell identities are often hierarchical in nature (such as T-cell subtypes within T cells), identifying the hierarchy of cell identities would be informative [<xref rid="bib10" ref-type="bibr">10</xref>]. For example, rather than classifying PBMCs into subtypes (such as T-cell subtypes and B-cell subtypes) at once, it would be more biologically meaningful to recognize high-level identities such as T cells in the first layer and then subtypes in the next layer. However, not much effort has been made for this task yet. Computationally, it is essentially a task that recursively identifies major groups as parent identities in the upper layer and finer groups within each major group as child identities in the next layer. Conventional methods of estimating <italic>k</italic> by comparing with random data such as the rule of selecting the best <italic>k</italic> in the gap statistic paper [<xref rid="bib4" ref-type="bibr">4</xref>] and the function sc3_estimate_k implemented in the scRNA-seq clustering package SC3 [<xref rid="bib11" ref-type="bibr">11</xref>] tend to report many finer groups but miss major groups that represent high-level cell identities. In the present study, we developed IKAP aiming to identify major cell groups in an scRNA-seq dataset and we demonstrate that recursively running IKAP can be used to recover the hierarchy of cell identities for a subset of cells in the mouse cortex and PBMC datasets. We believe that IKAP will greatly assist with refining cell ontology and curation of reference cell identities in the future.</p>
    <p>In spite of the advantages mentioned above, several concerns should be noted when using IKAP. First, the performance of IKAP would be affected by upstream data processing such as normalization, covariate removal, feature selection (e.g., selecting variable genes to compute PCs), and dimensional reduction. In addition, human intervention may still be needed to obtain optimal cell type classification (even though “optimal classification” could be subjective). For example, users may need to either apply IKAP within major cell groups to identify finer subgroups as we did to recover interneurons, pyramidal S1, and pyramidal CA1 in the mouse cortex dataset or to manually pick an alternative grouping rather than the best reported by IKAP. Finally, we have shown that IKAP can perform well on the 3 datasets that contain a limited number of discrete cell types with distinct gene expression profiles. However, IKAP may not work as well for more heterogenous datasets such as tumor samples or datasets where expression changes among cells are expected to be gradients such as samples in developmental studies.</p>
    <p>In conclusion, IKAP enriches the scRNA-seq analysis toolbox by offering an unbiased solution for picking <italic>k</italic> major cell groups. It not only improves the automation of the scRNA-seq analysis pipeline but also has the ability to refine cell type ontology using single-cell transcriptomes in the future.</p>
  </sec>
  <sec sec-type="methods" id="sec2">
    <title>Methods</title>
    <sec id="sec2-1">
      <title>IKAP details</title>
      <p>IKAP was implemented on top of Seurat (version 2.3.4) [<xref rid="bib3" ref-type="bibr">3</xref>] in R (version 3.4). When running IKAP by default, it takes only a Seurat object that contains a normalized expression matrix and precomputed covariates that need to be regressed out. The expression matrix will be scaled with covariates regressed out (if provided) using the ScaleData function in Seurat. Then, IKAP finds variable genes using the FindVariableGenes function in Seurat. All Seurat functions are run by default unless a particular setting is specified. Default parameters for IKAP can be easily adjusted by users. Details are discussed in the following.
<list list-type="order"><list-item><p>Determine nPC<sub>min</sub>, nPC<sub>max</sub>,and <italic>k</italic><sub>max</sub>. IKAP avoids specifying a particular number of top principal components (nPC) and <italic>k</italic> by exploring combinations of nPC and <italic>k</italic> (nPC, <italic>k</italic>). nPC<sub>min</sub>, nPC<sub>max</sub>, and <italic>k</italic><sub>max</sub> are used to define the search space of (nPC, <italic>k</italic>) such that the combinations (nPC*, <italic>k*</italic>) that can generate major groups are enclosed (i.e., nPC<sub>min</sub> ≤ nPC* ≤ nPC<sub>max</sub> and <italic>k*</italic> ≤<italic>k</italic><sub>max</sub>). Setting large nPC<sub>max</sub> and <italic>k</italic><sub>max</sub> increases the search space and the computation time. By following the concept of the elbow method, nPC<sub>min</sub> is computed as the first principal component (PC) such that a decrease in explained standard deviation relative to the next PCs is &lt;10% for all following PCs. By doing so, the top nPC<sub>min</sub> PCs should contain informative features to define ≥1 set of major groups. Setting an nPC<sub>max</sub> &gt; nPC<sub>min</sub> is for exploring more possible (nPC*, <italic>k*</italic>) but would not affect the main result much. By default, nPC<sub>max</sub> is set to nPC<sub>min</sub> + 20. To set a <italic>k</italic><sub>max</sub> ≥<italic>k*</italic>, we found that setting <italic>r</italic> &gt; 1 in Seurat clustering usually produced many fine groups. So, by default, <italic>k</italic><sub>max</sub> is set to the average of the number of resulting groups using the top nPC<sub>min</sub> PCs and using the top nPC<sub>max</sub> PCs by setting <italic>r</italic><sub>ini</sub> = 1.5. We varied the difference between nPC<sub>max</sub> and nPC<sub>min</sub> (nPC<sub>max</sub> − nPC<sub>min</sub> = 10, 15, 20, and 25) and <italic>r</italic><sub>ini</sub> (=0.9, 1.2, 1.5, and 1.8) to generate 16 test sets for PBMC_4K, PBMC_8K, and the mouse cortex datasets and found that grouping in the reported best sets did not change much (<xref ref-type="supplementary-material" rid="sup9">Supplementary Figs 15–17</xref>). This shows that our results were not sensitive to the default values of nPC<sub>max</sub> and <italic>r</italic><sub>i</sub><sub>ni</sub>.</p></list-item><list-item><p>Generate<italic>k</italic><sub>max</sub> sets of groups for each nPC. IKAP initializes the set of <italic>k</italic><sub>ini</sub> groups by setting <italic>r</italic> = 1.0 using Seurat clustering. If <italic>k</italic><sub>ini</sub><italic>&lt; k</italic><sub>max</sub>, increment <italic>r</italic> by 0.2 until <italic>k</italic><sub>ini</sub> ≥<italic>k</italic><sub>max</sub>. Two nearest groups measured by their centers in the PC space are merged iteratively, generating <italic>k</italic><sub>ini</sub> sets of groups but only the first <italic>k</italic><sub>max</sub> sets (with <italic>k</italic> = 1 to <italic>k</italic><sub>max</sub>) are used further.</p></list-item><list-item><p>Compute gap statistic. The gap statistic for a set of <italic>k</italic> groups is the difference between the log of sum of within-group pairwise distances over all <italic>k</italic> groups using the actual data and the log of expected sum of within-group pairwise distances over all <italic>k</italic> groups assuming data points (cells) are uniformly distributed in a bounded PC space where boundaries in each dimension are the minimum and the maximum of the actual data in that dimension. Details about gap statistic are described in Tibshirani et al. [<xref rid="bib4" ref-type="bibr">4</xref>]. Note that the rule of selecting the best <italic>k</italic> proposed in the original gap statistic paper is not used in IKAP.</p></list-item><list-item><p>Select the candidate sets. The workflow of selecting candidate sets (PC9K7, PC16K8, and PC18K9) for PBMC_8K is shown in <xref ref-type="supplementary-material" rid="sup9">Supplementary Fig. 18</xref>. The formal procedure is briefly described as follows. By computing gap increase from a set of <italic>k</italic> − 1 groups to <italic>k</italic> groups (see Step 3 in Fig. <xref ref-type="fig" rid="fig1">1</xref>) for every tested nPC, IKAP generates a gap-increase matrix <italic>M</italic> in which rows correspond to nPC and columns correspond to <italic>k</italic>. Note that each combination of (nPC, <italic>k</italic>) corresponds to a set of cell groups. IKAP first filters out those (nPC, <italic>k</italic>)’s with gap increase ≤ mean + standard deviation. Then, IKAP picks the largest non-zero gap increase for every <italic>k</italic> (every column of <italic>M</italic>), generating a list of gap increases and a list of corresponding (nPC, <italic>k</italic>)’s where <italic>k</italic>’s are different. The list of (nPC, <italic>k</italic>)’s is sorted by corresponding gap increases in descending order. The first (nPC, <italic>k</italic>) (which corresponds to the largest gap increase) is picked as a candidate set. Then, IKAP goes down to the list one by one and adds the (nPC, <italic>k</italic>) to the candidate list if the nPC and <italic>k</italic> are greater than all nPCs and <italic>k</italic>’s already in the candidate list. This requirement is to look for cases where additional cell groups (larger <italic>k</italic>) are identified because of incorporating additional PCs (larger nPC).</p></list-item><list-item><p>Compute DE genes. IKAP utilizes the FindAllMarker function in Seurat to compute DE genes for each candidate set. Only upregulated genes are reported. Other parameters are set by default.</p></list-item><list-item><p>Build decision trees. The idea of building the decision tree is to evaluate whether a group of cells can be differentiated by considering multiple genes jointly. For each candidate set of cell groups proposed by IKAP, a binary classifier (a decision tree) is built for each group using DE genes from all groups. The decision tree is built by the R package rpart [<xref rid="bib12" ref-type="bibr">12</xref>] using default parameters.</p></list-item><list-item><p>Compute classification error and select the best and alternative candidate sets. The R package rpart builds the decision tree for each group in a candidate set (see "Build decision trees" above) and also reports relative errors (i.e., training errors) at different number of splits (nsplit) along the decision tree. For each group at a given nsplit, the group-level classification error is computed as the product of the relative error and the fraction of cells in that group. The set-level classification error of a candidate set at a given nsplit is defined as the sum of all group-level classification errors. IKAP computes the final classification error for each candidate set as the average of set-level classification errors for nsplit = 5–15. Note that the tree usually did not grow &gt;15 splits in the experiments shown in this study. Finally, among candidate sets, the one with the lowest classification error is marked as the best and the rest are alternatives. In our experience, the number of candidate sets reported by IKAP usually ranges from 1 to 4.</p></list-item></list></p>
    </sec>
    <sec id="sec2-2">
      <title>Performance summary</title>
      <p>For each DE gene, the AUROC was computed for classifying its associated group versus others using normalized unique molecular identifier (UMI) count and the function roc.curve in the R package PRROC [<xref rid="bib13" ref-type="bibr">13</xref>]. We counted the median of numbers of genes with high AUROC (&gt;0.8, 0.85, and 0.9) across all groups. The classification error was computed as described above ("Compute classification error" in "IKAP details"). Average expression log fold change (AvgLFC) was reported by Seurat for each DE gene in each group. For each group, we sorted genes by AvgLFC and only considered DE genes with AUROC &gt; 0.8. Among those, we computed the mean of AvgLFC across the top 10 (or <italic>n</italic> if <italic>n</italic> &lt; 10) DE genes for each group. Running time was measured on a 4.2-GHz Intel Core i7 iMac desktop with 64 GB memory.</p>
    </sec>
    <sec id="sec2-3">
      <title>PBMC_4K and PBMC_8K datasets</title>
      <p>PBMC_4K and PBMC_8K were downloaded from the 10x Genomics website [<xref rid="bib5" ref-type="bibr">5</xref>]. They were filtered and normalized using the R package Seurat [<xref rid="bib3" ref-type="bibr">3</xref>]. We removed cells with &lt;200 genes expressed or the UMI count of mitochondrial genes &gt;5% of the total UMI count. For each dataset, we regressed out the percentage of mitochondrial gene UMI count and the total UMI count from the normalized expression matrix and scaled the matrix using the ScaleData function in Seurat. Finally, we got the expression matrix with 16,746 genes and 4,077 cells for PBMC_4K and the matrix with 18,408 genes and 8,090 cells for PBMC_8K.</p>
    </sec>
    <sec id="sec2-4">
      <title>Mouse cortex dataset</title>
      <p>The dataset was obtained from Zeisel et al. [<xref rid="bib6" ref-type="bibr">6</xref>]. We normalized and scaled the expression matrix as we did for PBMC_4K and PBMC_8K, but we did not filter out any cells in order to be consistent with the published work. In total, the expression matrix comprised 19,972 genes and 3,005 cells.</p>
    </sec>
    <sec id="sec2-5">
      <title>Cell type recognition</title>
      <p>Major cell groups in PBMC datasets (Figs <xref ref-type="fig" rid="fig2">2A</xref> and <xref ref-type="fig" rid="fig3">3D</xref>–<xref ref-type="fig" rid="fig3">E</xref>) were annotated on the basis of expression of marker genes and the literature. CD14<sup>+</sup> monocytes: expression of <italic>LYZ</italic> and <italic>S100A8</italic> [<xref rid="bib14" ref-type="bibr">14</xref>]. FCGR3A<sup>+</sup> monocytes: expression of <italic>FCGR3A</italic> and <italic>MS4A7</italic>, a monocyte marker [<xref rid="bib15" ref-type="bibr">15</xref>]. B cells: expression of <italic>CD79A</italic> [<xref rid="bib16" ref-type="bibr">16</xref>]. Megakaryocytes: expression of PPBP [<xref rid="bib17" ref-type="bibr">17</xref>]. Plasmacytoid dendritic cells: expression of <italic>LILRA4</italic> [<xref rid="bib18" ref-type="bibr">18</xref>]. T cells: expression of <italic>CD3E</italic> [<xref rid="bib19" ref-type="bibr">19</xref>]. NK cells: expression of <italic>GNLY</italic> but not <italic>CD3E</italic> [<xref rid="bib20" ref-type="bibr">20</xref>].</p>
    </sec>
  </sec>
  <sec id="sec3">
    <title>Availability of supporting source code and requirements</title>
    <p>Project name: IKAP</p>
    <p>Project home page: <ext-link ext-link-type="uri" xlink:href="https://github.com/NHLBI-BCB/IKAP">https://github.com/NHLBI-BCB/IKAP</ext-link></p>
    <p>Operating system(s): Mac OS</p>
    <p>Programming language: R</p>
    <p>License: MIT license</p>
    <p>RRID: IKAP, <ext-link ext-link-type="uri" xlink:href="https://scicrunch.org/browse/resources/SCR_017417">RRID:SCR_017417</ext-link></p>
  </sec>
  <sec sec-type="materials" id="sec4">
    <title>Availability of supporting data and materials</title>
    <p>PBMC_4K and PBMC_8K can be downloaded from the 10x Genomics website [<xref rid="bib5" ref-type="bibr">5</xref>]. The mouse cortex dataset can be acquired from the GEO database with the accession number GSE60361.</p>
    <p>Supporting data are also available via the <italic>GigaScience</italic> repository GigaDB [<xref rid="bib21" ref-type="bibr">21</xref>].</p>
  </sec>
  <sec sec-type="supplementary-material" id="sec5">
    <title>Additional files</title>
    <p><bold>Supplementary Figure 1:</bold> Gap statistics increased as more cell groups were identified in PBMC_8K using different numbers of top principal components (nPCs) with large gap increase seen around the number of groups (<italic>k</italic>) = 7, 8, or 9.</p>
    <p><bold>Supplementary Figure 2:</bold> Major cell types in PBMC were not well aligned with the 20 trial sets of cell groups generated for PBMC_8K by varying resolution (<italic>r</italic>) and the number of top principal components (nPC) using Seurat clustering. (A) The tSNE plots for the 20 trial sets. (B) Expression of PBMC type marker genes: <italic>CD3E</italic> for T cells, <italic>CD79A</italic> for B cells, <italic>GNLY</italic> for NK cells, and <italic>LYZ</italic> for monocytes.</p>
    <p><bold>Supplementary Figure 3:</bold> DE gene expression for 6 trial sets selected from the 20 trial sets for PBMC_8K shown in Supplementary Fig. 2. In the heat maps, rows are genes and columns are cells. Groups of cells (separated by vertical white lines) from left to right correspond to groups of corresponding trial sets in Supplementary Fig. 2 in the order of 0, 1, 2, … etc.</p>
    <p><bold>Supplementary Figure 4:</bold> Two alternative sets (PC16K8 and PC18K9) of major cell groups identified for PBMC_8K by IKAP. Shown are tSNE plots of the major groups (left) and heat maps for expression of top DE genes (by expression fold change) (right) for PC16K8 (top) and PC18K9 (bottom). Rows are genes and columns are cells in the heat maps.</p>
    <p><bold>Supplementary Figure 5:</bold> Two candidate sets (PC8K7 and PC20K8) of major groups identified for PBMC_4K by IKAP were aligned with major cell types in PBMC and well differentiated by cell type marker genes. tSNE plots show major groups of PC8K7 (A) and PC20K8 (B). Heat maps show expression of top DE genes (by expression fold change) of each group for PC8K7 (C) and PC20K8 (D). (E) tSNE plots for expression of cell type marker genes: <italic>CD3E</italic> for T cells, <italic>CD79A</italic> for B cells, <italic>GNLY</italic> for NK cells, and <italic>LYZ</italic> for monocytes. (F) Performance summary of the 2 candidate sets proposed by IKAP and 20 trial sets. Running time is shown at the bottom. The dashed blue lines indicate the number of cell groups (top) and the median log<sub>2</sub> fold change (bottom) of the best set (PC20K8).</p>
    <p><bold>Supplementary Figure 6:</bold> Major cell types in PBMC were not well aligned with the 20 trial sets of cell groups generated for PBMC_4K by varying resolution (<italic>r</italic>) and the number of top principal components (nPC) using Seurat clustering. (A) The tSNE plots for the 20 trial sets. (B) Expression of PBMC cell type marker genes: <italic>CD3E</italic> for T cells, <italic>CD79A</italic> for B cells, <italic>GNLY</italic> for NK cells, and <italic>LYZ</italic> for monocytes.</p>
    <p><bold>Supplementary Figure 7:</bold> Expression of top DE genes for 6 trial sets selected from the 20 trial sets for PBMC_4K shown in Supplementary Fig. 6. In the heat maps, rows are genes and columns are cells. Groups of cells (separated by vertical white lines) from left to right correspond to groups of corresponding trial sets in Supplementary Fig. 6 in the order of 0, 1, 2, … etc.</p>
    <p><bold>Supplementary Figure 8:</bold> Comparison among previously annotated major cell types, major cell groups identified by IKAP, and the 20 trial sets of cell groups for the mouse cortex data. (A) The top tSNE plot shows 9 cell types with original labels in Zeisel et al. 2015 [<xref rid="bib6" ref-type="bibr">6</xref>] where astrocytes were merged with ependymal and endothelial merged with mural. The modified tSNE plot at bottom recovered ependymal and mural types using group 4 and group 1 identified by IKAP in Fig. <xref ref-type="fig" rid="fig2">2D</xref>. (B) Performance summary of the set proposed by IKAP, the 20 trial sets, and the modified version of major cell types in (A). Running time is shown at the bottom. The dashed blue lines indicate the number of cell groups (top) and the median log<sub>2</sub> fold change (bottom) of the best set (PC13K8).</p>
    <p><bold>Supplementary Figure 9:</bold> Genes exclusively upregulated in interneurons, pyramidal S1, and pyramidal CA1 in the mouse cortex dataset. Gene expression is indicated by color for each mouse cortex cell in the tSNE plot shown in Fig. <xref ref-type="fig" rid="fig2">2D</xref>. Dark blue indicates high expression whereas grey indicates low expression.</p>
    <p><bold>Supplementary Figure 10:</bold> An example of 2-layer T-cell ontology proposed by IKAP for PBMC_4K. Shown on the left is the ontology with 2 layers (also shown in Fig. <xref ref-type="fig" rid="fig3">3D</xref>). The heat map shows expression of top DE genes (ranked by expression fold change) of each subgroup. Rows are genes and columns are cells.</p>
    <p><bold>Supplementary Figure 11:</bold> An example of 2-layer T-cell ontology proposed by IKAP for PBMC_8K. Shown on the left is the ontology with 2 layers (also shown in Fig. <xref ref-type="fig" rid="fig3">3E</xref>). The heat map shows expression of top DE genes (ranked by expression fold change) of each subgroup. Rows are genes and columns are cells.</p>
    <p><bold>Supplementary Figure 12:</bold> Alternative sets of T-cell subgroups reported by IKAP for PBMC_4K and PBMC_8K. Two PBMC ontologies with T-cell subgroups are shown on the left for PBMC_4K (top) and PBMC_8K (bottom). Expression of DE genes is plotted in heat maps on the right. Rows are genes and columns are cells. Subgroups with similar expression profiles are linked by lines.</p>
    <p><bold>Supplementary Figure 13:</bold> Expression of top DE genes (ranked by expression fold change) for PBMC_4K T cell subgroups shown in Supplementary Fig. 11. Rows are genes and columns are cells.</p>
    <p><bold>Supplementary Figure 14:</bold> Expression of top DE genes (ranked by expression fold change) for PBMC_8K T cell subgroups shown in Supplementary Fig. 11. Rows are genes and columns are cells.</p>
    <p><bold>Supplementary Figure 15:</bold> Major cell groups identified by IKAP were not sensitive to settings of parameters, <italic>r</italic><sub>ini</sub> and (nPC<sub>max</sub> − nPC<sub>min</sub>), for PBMC_4K (see Online Methods). The tSNE plots for 16 sets of major cell groups generated by varying <italic>r</italic><sub>i</sub><sub>ni</sub> (=0.9, 1.2, 1.5, and 1.8) and (nPC<sub>max</sub> − nPC<sub>min</sub>) (=10, 15, 20, and 25) using PBMC_4K. By default <italic>r</italic><sub>ini</sub> = 1.5 and (nPC<sub>max</sub> − nPC<sub>min</sub>) = 20.</p>
    <p><bold>Supplementary Figure 16:</bold> Major cell groups identified by IKAP were not sensitive to settings of parameters, <italic>r<sub>ini</sub></italic> and (nPC<sub>max</sub> − nPC<sub>min</sub>), for PBMC_8K (see Online Methods). The tSNE plots for 16 sets of major cell groups generated by varying <italic>r</italic><sub>ini</sub> (=0.9, 1.2, 1.5, and 1.8) and (nPC<sub>max</sub> − nPC<sub>min</sub>) (=10, 15, 20, and 25) using PBMC_8K. By default <italic>r</italic><sub>ini</sub> = 1.5 and (nPC<sub>max</sub> − nPC<sub>min</sub>) = 20.</p>
    <p><bold>Supplementary Figure 17:</bold> Major cell groups identified by IKAP were not sensitive to settings of parameters, <italic>r</italic><sub>ini</sub> and (nPC<sub>max</sub> − nPC<sub>min</sub>), for the mouse cortex dataset (see Online Methods). The tSNE plots for 16 sets of major cell groups generated by varying <italic>r</italic><sub>ini</sub> (=0.9, 1.2, 1.5, and 1.8) and (nPC<sub>max</sub> − nPC<sub>min</sub>) (=10, 15, 20, and 25) using the mouse cortex dataset. By default <italic>r</italic><sub>ini</sub> = 1.5 and (nPC<sub>max</sub> − nPC<sub>min</sub>) = 20.</p>
    <p><bold>Supplementary Figure 18:</bold> The workflow of selecting candidate sets (PC9K7, PC16K8, and PC18K9) for PBMC_8K. Given a gap-increase matrix <italic>M</italic> (see Fig. <xref ref-type="fig" rid="fig1">1</xref> for how to compute gap increase), the following steps were taken. Step 0: filter entries by gap increases &gt; mean + standard deviation. Step 1: take the maximum gap increase across rows for each column (<italic>k</italic>) and record the corresponding (nPC, <italic>k</italic>). Step 2: sort recorded (nPC, <italic>k</italic>)’s based on their corresponding gap increases. Step 3: add the first (nPC, <italic>k</italic>), which is PC9K7, into the candidate list. Step 4: remove the second (nPC, <italic>k</italic>), which is PC9K6, because its nPC (=9) is not larger than nPC of the candidate (=9) in the candidate list and neither is its <italic>k</italic> not larger than <italic>k</italic> of the candidate (=7) in the candidate list. Step 5: add the third (nPC, <italic>k</italic>) into the candidate list because its nPC (=16) is larger than nPC of the candidate (=9) in the candidate list and so is its <italic>k</italic>. Step 6: add the fourth (nPC, <italic>k</italic>) into the candidate list because its nPC (=20) is larger than all nPCs of the candidates (=9 and 16) in the candidate list and so is its <italic>k</italic>. Finally, PC9K7, PC16K8, and PC18K9 were selected as candidate sets for PBMC_8K.</p>
    <p><bold>Supplementary Table 1</bold>. Median expression of genes significantly* upregulated in the union of interneurons, pyramidal S1, and pyramidal CA1 for the mouse cortex cell types annotated in Zeisel et al. 2015 [<xref rid="bib6" ref-type="bibr">6</xref>].</p>
    <supplementary-material content-type="local-data" id="sup1">
      <label>giz121_GIGA-D-19-00138_Original_Submission</label>
      <media xlink:href="giz121_giga-d-19-00138_original_submission.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="sup2">
      <label>giz121_GIGA-D-19-00138_Revision_1</label>
      <media xlink:href="giz121_giga-d-19-00138_revision_1.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="sup3">
      <label>giz121_GIGA-D-19-00138_Revision_2</label>
      <media xlink:href="giz121_giga-d-19-00138_revision_2.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="sup4">
      <label>giz121_Response_to_Reviewer_Comments_Original_Submission</label>
      <media xlink:href="giz121_response_to_reviewer_comments_original_submission.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="sup5">
      <label>giz121_Response_to_Reviewer_Comments_Revision_1</label>
      <media xlink:href="giz121_response_to_reviewer_comments_revision_1.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="sup6">
      <label>giz121_Reviewer_1_Report_Original_Submission</label>
      <caption>
        <p>Antoine-Emmanuel Saliba -- 5/31/2019 Reviewed</p>
      </caption>
      <media xlink:href="giz121_reviewer_1_report_original_submission.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="sup7">
      <label>giz121_Reviewer_2_Report_Original_Submission</label>
      <caption>
        <p>Philip Lijnzaad -- 6/13/2019 Reviewed</p>
      </caption>
      <media xlink:href="giz121_reviewer_2_report_original_submission.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="sup8">
      <label>giz121_Reviewer_2_Report_Revision_1</label>
      <caption>
        <p>Philip Lijnzaad -- 8/28/2019 Reviewed</p>
      </caption>
      <media xlink:href="giz121_reviewer_2_report_revision_1.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="sup9">
      <label>giz121_Supplemental_Files</label>
      <media xlink:href="giz121_supplemental_files.zip">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
  <sec id="sec7">
    <title>Abbreviations</title>
    <p>AUROC: area under the receiver operating curve; DE: differentially expressed; GEO: Gene Expression Omnibus; NK: natural killer; nPC: the number of top principal components; PBMC: peripheral blood mononuclear cell; PC: principal component; scRNA-seq: single-cell RNA-sequencing; tSNE: T-distributed stochastic neighbor embedding; UMI: unique molecular identifier.</p>
  </sec>
  <sec id="sec8">
    <title>Competing interests</title>
    <p>The authors declare that they have no competing interests.</p>
  </sec>
  <sec id="sec9">
    <title>Funding</title>
    <p>This work was supported by the Intramural Program of the National Heart, Lung, and Blood Institute, National Institutes of Health. Grant number: 1ZICHL006228-02. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</p>
  </sec>
  <sec id="sec10">
    <title>Authors’ contributions</title>
    <p>M.P. and Y.-C.C. conceived the study. Y.-C.C. developed and implemented the algorithm and drafted the manuscript; A.S. and F.S. helped with implementation; C.U., C.S., K.S., and A.W. helped with cell type annotation. M.P. supervised the research. All authors reviewed and approved the manuscript.</p>
  </sec>
</body>
<back>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="bib1">
      <label>1.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Andrews</surname><given-names>TS</given-names></name>, <name name-style="western"><surname>Hemberg</surname><given-names>M</given-names></name></person-group><article-title>Identifying cell populations with scRNASeq</article-title>. <source>Mol Aspects Med</source>. <year>2018</year>;<volume>59</volume>:<fpage>114</fpage>–<lpage>22</lpage>.<pub-id pub-id-type="pmid">28712804</pub-id></mixed-citation>
    </ref>
    <ref id="bib2">
      <label>2.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Kiselev</surname><given-names>VY</given-names></name>, <name name-style="western"><surname>Andrews</surname><given-names>TS</given-names></name>, <name name-style="western"><surname>Hemberg</surname><given-names>M</given-names></name></person-group><article-title>Challenges in unsupervised clustering of single-cell RNA-seq data</article-title>. <source>Nat Rev Genet</source>. <year>2019</year>;<volume>20</volume>(<issue>5</issue>):<fpage>273</fpage>–<lpage>82</lpage>.<pub-id pub-id-type="pmid">30617341</pub-id></mixed-citation>
    </ref>
    <ref id="bib3">
      <label>3.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Butler</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Hoffman</surname><given-names>P</given-names></name>, <name name-style="western"><surname>Smibert</surname><given-names>P</given-names></name>, <etal>et al</etal>.</person-group><article-title>Integrating single-cell transcriptomic data across different conditions, technologies, and species</article-title>. <source>Nat Biotechnol</source>. <year>2018</year>;<volume>36</volume>(<issue>5</issue>):<fpage>411</fpage>–<lpage>20</lpage>.<pub-id pub-id-type="pmid">29608179</pub-id></mixed-citation>
    </ref>
    <ref id="bib4">
      <label>4.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Tibshirani</surname><given-names>R</given-names></name>, <name name-style="western"><surname>Walther</surname><given-names>G</given-names></name>, <name name-style="western"><surname>Hastie</surname><given-names>T</given-names></name></person-group><article-title>Estimating the number of clusters in a data set via the gap statistic</article-title>. <source>J Roy Stat Soc B</source>. <year>2001</year>;<volume>63</volume>:<fpage>411</fpage>–<lpage>23</lpage>.</mixed-citation>
    </ref>
    <ref id="bib5">
      <label>5.</label>
      <mixed-citation publication-type="journal"><comment>10x Genomics. Support: single cell gene expression datasets 2017. <ext-link ext-link-type="uri" xlink:href="https://www.10xgenomics.com/resources/datasets/">https://www.10xgenomics.com/resources/datasets/</ext-link>. Accessed on 4 March 2019</comment>.</mixed-citation>
    </ref>
    <ref id="bib6">
      <label>6.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Zeisel</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Munoz-Manchado</surname><given-names>AB</given-names></name>, <name name-style="western"><surname>Codeluppi</surname><given-names>S</given-names></name>, <etal>et al</etal>.</person-group><article-title>Brain structure. Cell types in the mouse cortex and hippocampus revealed by single-cell RNA-seq</article-title>. <source>Science</source>. <year>2015</year>;<volume>347</volume>(<issue>6226</issue>):<fpage>1138</fpage>–<lpage>42</lpage>.<pub-id pub-id-type="pmid">25700174</pub-id></mixed-citation>
    </ref>
    <ref id="bib7">
      <label>7.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Aevermann</surname><given-names>BD</given-names></name>, <name name-style="western"><surname>Novotny</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Bakken</surname><given-names>T</given-names></name>, <etal>et al</etal>.</person-group><article-title>Cell type discovery using single-cell transcriptomics: implications for ontological representation</article-title>. <source>Hum Mol Genet</source>. <year>2018</year>;<volume>27</volume>(<issue>R1</issue>):<fpage>R40</fpage>–<lpage>R7</lpage>.<pub-id pub-id-type="pmid">29590361</pub-id></mixed-citation>
    </ref>
    <ref id="bib8">
      <label>8.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Bakken</surname><given-names>T</given-names></name>, <name name-style="western"><surname>Cowell</surname><given-names>L</given-names></name>, <name name-style="western"><surname>Aevermann</surname><given-names>BD</given-names></name>, <etal>et al</etal>.</person-group><article-title>Cell type discovery and representation in the era of high-content single cell phenotyping</article-title>. <source>BMC Bioinformatics</source>. <year>2017</year>;<volume>18</volume>(<issue>Suppl 17</issue>):<fpage>559</fpage>.<pub-id pub-id-type="pmid">29322913</pub-id></mixed-citation>
    </ref>
    <ref id="bib9">
      <label>9.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Regev</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Teichmann</surname><given-names>SA</given-names></name>, <name name-style="western"><surname>Lander</surname><given-names>ES</given-names></name>, <etal>et al</etal>.</person-group><article-title>The Human Cell Atlas</article-title>. <source>Elife</source>. <year>2017</year>;<volume>6</volume>:<fpage>e27041</fpage>.<pub-id pub-id-type="pmid">29206104</pub-id></mixed-citation>
    </ref>
    <ref id="bib10">
      <label>10.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>de Kanter</surname><given-names>JK</given-names></name>, <name name-style="western"><surname>Lijnzaad</surname><given-names>P</given-names></name>, <name name-style="western"><surname>Candelli</surname><given-names>T</given-names></name>, <etal>et al</etal>.</person-group><article-title>CHETAH: a selective, hierarchical cell type identification method for single-cell RNA sequencing</article-title>. <source>Nucleic Acids Res</source>. <year>2019</year>;<volume>47</volume>(<issue>16</issue>):<fpage>e95</fpage>.</mixed-citation>
    </ref>
    <ref id="bib11">
      <label>11.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Kiselev</surname><given-names>VY</given-names></name>, <name name-style="western"><surname>Kirschner</surname><given-names>K</given-names></name>, <name name-style="western"><surname>Schaub</surname><given-names>MT</given-names></name>, <etal>et al</etal>.</person-group><article-title>SC3: consensus clustering of single-cell RNA-seq data</article-title>. <source>Nat Methods</source>. <year>2017</year>;<volume>14</volume>(<issue>5</issue>):<fpage>483</fpage>–<lpage>6</lpage>.<pub-id pub-id-type="pmid">28346451</pub-id></mixed-citation>
    </ref>
    <ref id="bib12">
      <label>12.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Therneau</surname><given-names>T</given-names></name>, <name name-style="western"><surname>Atkinson</surname><given-names>B</given-names></name>, <name name-style="western"><surname>Ripley</surname><given-names>B</given-names></name></person-group><article-title>rpart: Recursive Partitioning and Regression Trees</article-title>. <comment>R package version 4.1-11 2017. <ext-link ext-link-type="uri" xlink:href="https://CRAN.R-project.org/package=rpart">https://CRAN.R-project.org/package=rpart</ext-link></comment>.</mixed-citation>
    </ref>
    <ref id="bib13">
      <label>13.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Grau</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Grosse</surname><given-names>I</given-names></name>, <name name-style="western"><surname>Keilwagen</surname><given-names>J</given-names></name></person-group><article-title>PRROC: computing and visualizing precision-recall and receiver operating characteristic curves in R</article-title>. <source>Bioinformatics</source>. <year>2015</year>;<volume>31</volume>(<issue>15</issue>):<fpage>2595</fpage>–<lpage>7</lpage>.<pub-id pub-id-type="pmid">25810428</pub-id></mixed-citation>
    </ref>
    <ref id="bib14">
      <label>14.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Zawada</surname><given-names>AM</given-names></name>, <name name-style="western"><surname>Rogacev</surname><given-names>KS</given-names></name>, <name name-style="western"><surname>Rotter</surname><given-names>B</given-names></name>, <etal>et al</etal>.</person-group><article-title>SuperSAGE evidence for CD14++CD16+ monocytes as a third monocyte subset</article-title>. <source>Blood</source>. <year>2011</year>;<volume>118</volume>(<issue>12</issue>):<fpage>e50</fpage>–<lpage>61</lpage>.<pub-id pub-id-type="pmid">21803849</pub-id></mixed-citation>
    </ref>
    <ref id="bib15">
      <label>15.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Gingras</surname><given-names>MC</given-names></name>, <name name-style="western"><surname>Lapillonne</surname><given-names>H</given-names></name>, <name name-style="western"><surname>Margolin</surname><given-names>JF</given-names></name></person-group><article-title>CFFM4: a new member of the CD20/FcepsilonRIbeta family</article-title>. <source>Immunogenetics</source>. <year>2001</year>;<volume>53</volume>(<issue>6</issue>):<fpage>468</fpage>–<lpage>76</lpage>.<pub-id pub-id-type="pmid">11685457</pub-id></mixed-citation>
    </ref>
    <ref id="bib16">
      <label>16.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Chu</surname><given-names>PG</given-names></name>, <name name-style="western"><surname>Arber</surname><given-names>DA</given-names></name></person-group><article-title>CD79: a review</article-title>. <source>Appl Immunohistochem Mol Morphol</source>. <year>2001</year>;<volume>9</volume>(<issue>2</issue>):<fpage>97</fpage>–<lpage>106</lpage>.<pub-id pub-id-type="pmid">11396639</pub-id></mixed-citation>
    </ref>
    <ref id="bib17">
      <label>17.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Zhang</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Gadue</surname><given-names>P</given-names></name>, <name name-style="western"><surname>Scott</surname><given-names>E</given-names></name>, <etal>et al</etal>.</person-group><article-title>Activation of the megakaryocyte-specific gene platelet basic protein (PBP) by the Ets family factor PU.1</article-title>. <source>J Biol Chem</source>. <year>1997</year>;<volume>272</volume>(<issue>42</issue>):<fpage>26236</fpage>–<lpage>46</lpage>.<pub-id pub-id-type="pmid">9334192</pub-id></mixed-citation>
    </ref>
    <ref id="bib18">
      <label>18.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Cho</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Ishida</surname><given-names>K</given-names></name>, <name name-style="western"><surname>Chen</surname><given-names>J</given-names></name>, <etal>et al</etal>.</person-group><article-title>SAGE library screening reveals ILT7 as a specific plasmacytoid dendritic cell marker that regulates type I IFN production</article-title>. <source>Int Immunol</source>. <year>2008</year>;<volume>20</volume>(<issue>1</issue>):<fpage>155</fpage>–<lpage>64</lpage>.<pub-id pub-id-type="pmid">18048391</pub-id></mixed-citation>
    </ref>
    <ref id="bib19">
      <label>19.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Chetty</surname><given-names>R</given-names></name>, <name name-style="western"><surname>Gatter</surname><given-names>K</given-names></name></person-group><article-title>CD3: structure, function, and role of immunostaining in clinical practice</article-title>. <source>J Pathol</source>. <year>1994</year>;<volume>173</volume>(<issue>4</issue>):<fpage>303</fpage>–<lpage>7</lpage>.<pub-id pub-id-type="pmid">7525907</pub-id></mixed-citation>
    </ref>
    <ref id="bib20">
      <label>20.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Pena</surname><given-names>SV</given-names></name>, <name name-style="western"><surname>Krensky</surname><given-names>AM</given-names></name></person-group><article-title>Granulysin, a new human cytolytic granule-associated protein with possible involvement in cell-mediated cytotoxicity</article-title>. <source>Semin Immunol</source>. <year>1997</year>;<volume>9</volume>(<issue>2</issue>):<fpage>117</fpage>–<lpage>25</lpage>.<pub-id pub-id-type="pmid">9194222</pub-id></mixed-citation>
    </ref>
    <ref id="bib21">
      <label>21.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Chen</surname><given-names>YC</given-names></name>, <name name-style="western"><surname>Suresh</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Underbayev</surname><given-names>C</given-names></name>, <etal>et al</etal>.</person-group><article-title>Supporting data for “IKAP—Identifying K mAjor cell Population groups in single-cell RNA-seq analysis.”</article-title>. <source>GigaScience Database</source>. <year>2019</year><pub-id pub-id-type="doi">10.5524/100652</pub-id>.</mixed-citation>
    </ref>
  </ref-list>
</back>
