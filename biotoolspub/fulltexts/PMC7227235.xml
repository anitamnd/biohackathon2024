<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>BMC Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">7227235</article-id>
    <article-id pub-id-type="publisher-id">3538</article-id>
    <article-id pub-id-type="doi">10.1186/s12859-020-3538-2</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Software</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>CIPR: a web-based R/shiny app and R package to annotate cell clusters in single cell RNA sequencing experiments</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Ekiz</surname>
          <given-names>H. Atakan</given-names>
        </name>
        <address>
          <email>atakan.ekiz@path.utah.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Conley</surname>
          <given-names>Christopher J.</given-names>
        </name>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Stephens</surname>
          <given-names>W. Zac</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>O’Connell</surname>
          <given-names>Ryan M.</given-names>
        </name>
        <address>
          <email>ryan.oconnell@path.utah.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="GRID">grid.223827.e</institution-id><institution-id institution-id-type="ISNI">0000 0001 2193 0096</institution-id><institution>Division of Microbiology and Immunology, Department of Pathology, </institution><institution>University of Utah, </institution></institution-wrap>15 N. Medical Dr. East, JMRB, Salt Lake City, UT 84112 USA </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="GRID">grid.223827.e</institution-id><institution-id institution-id-type="ISNI">0000 0001 2193 0096</institution-id><institution>Huntsman Cancer Institute, </institution><institution>University of Utah, </institution></institution-wrap>2000 Circle of Hope Dr, Salt Lake City, UT 84112 USA </aff>
      <aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="GRID">grid.223827.e</institution-id><institution-id institution-id-type="ISNI">0000 0001 2193 0096</institution-id><institution>Bioinformatics Shared Resource, Hunstman Cancer Institute, </institution><institution>University of Utah, </institution></institution-wrap>2000 Circle of Hope Dr, Salt Lake City, UT 84112 USA </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>15</day>
      <month>5</month>
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>15</day>
      <month>5</month>
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2020</year>
    </pub-date>
    <volume>21</volume>
    <elocation-id>191</elocation-id>
    <history>
      <date date-type="received">
        <day>10</day>
        <month>8</month>
        <year>2019</year>
      </date>
      <date date-type="accepted">
        <day>6</day>
        <month>5</month>
        <year>2020</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s). 2020</copyright-statement>
      <license license-type="OpenAccess">
        <license-p><bold>Open Access</bold>This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article's Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article's Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated in a credit line to the data.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p id="Par1">Single cell RNA sequencing (scRNAseq) has provided invaluable insights into cellular heterogeneity and functional states in health and disease. During the analysis of scRNAseq data, annotating the biological identity of cell clusters is an important step before downstream analyses and it remains technically challenging. The current solutions for annotating single cell clusters generally lack a graphical user interface, can be computationally intensive or have a limited scope. On the other hand, manually annotating single cell clusters by examining the expression of marker genes can be subjective and labor-intensive. To improve the quality and efficiency of annotating cell clusters in scRNAseq data, we present a web-based R/Shiny app and R package, <italic>Cluster Identity PRedictor (CIPR)</italic>, which provides a graphical user interface to quickly score gene expression profiles of unknown cell clusters against mouse or human references, or a custom dataset provided by the user. CIPR can be easily integrated into the current pipelines to facilitate scRNAseq data analysis.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p id="Par2">CIPR employs multiple approaches for calculating the identity score at the cluster level and can accept inputs generated by popular scRNAseq analysis software. CIPR provides 2 mouse and 5 human reference datasets, and its pipeline allows inter-species comparisons and the ability to upload a custom reference dataset for specialized studies. The option to filter out lowly variable genes and to exclude irrelevant reference cell subsets from the analysis can improve the discriminatory power of CIPR suggesting that it can be tailored to different experimental contexts. Benchmarking CIPR against existing functionally similar software revealed that our algorithm is less computationally demanding, it performs significantly faster and provides accurate predictions for multiple cell clusters in a scRNAseq experiment involving tumor-infiltrating immune cells.</p>
      </sec>
      <sec>
        <title>Conclusions</title>
        <p id="Par3">CIPR facilitates scRNAseq data analysis by annotating unknown cell clusters in an objective and efficient manner. Platform independence owing to Shiny framework and the requirement for a minimal programming experience allows this software to be used by researchers from different backgrounds. CIPR can accurately predict the identity of a variety of cell clusters and can be used in various experimental contexts across a broad spectrum of research areas.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Single cell RNA-sequencing</kwd>
      <kwd>Cluster analysis</kwd>
      <kwd>Identity prediction</kwd>
      <kwd>Similarity</kwd>
      <kwd>Gene expression profiling</kwd>
      <kwd>Immune cells</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000002</institution-id>
            <institution>National Institutes of Health</institution>
          </institution-wrap>
        </funding-source>
        <award-id>R01-AG047956</award-id>
        <award-id>R01-AI123106</award-id>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2020</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p id="Par13">Single cell RNA sequencing (scRNAseq) has enabled researchers to interrogate cellular phenotypes at an unprecedented resolution and led to the discovery of several new biological phenomena [<xref ref-type="bibr" rid="CR1">1</xref>]. This new tool has gained significant traction in numerous research areas including immunology, developmental and cancer biology, and is being continually improved in terms of the technology and analytical pipelines. Data from scRNAseq is typically analyzed via various unsupervised clustering approaches resulting in distinct groups of cells defined by similar gene expression profiles [<xref ref-type="bibr" rid="CR2">2</xref>]. During scRNAseq data analysis, it is advantageous to relate single cell clusters to known cell types before proceeding to downstream steps such as differential expression analyses and data visualization. In the past 2 years, an increasing number of software solutions to automatically classify cell clusters in scRNAseq data have been reported [<xref ref-type="bibr" rid="CR3">3</xref>–<xref ref-type="bibr" rid="CR13">13</xref>]. Recent studies provided a rigorous assessment of these methods in terms of performance and accuracy, and found that no one tool is perfectly suitable for every experimental context [<xref ref-type="bibr" rid="CR14">14</xref>–<xref ref-type="bibr" rid="CR16">16</xref>]. These tools can be computationally intensive, and they generally lack a graphical user interface limiting their use in iterative analyses. Furthermore, these tools may not be easily adaptable to different experimental contexts and, in some cases, the learning curve can be difficult to those with limited coding experience due to specialized data structures. Thus, many researchers still rely on manually examining known marker genes to determine the cluster identity in scRNAseq experiments. However, manual annotation of cell clusters is labor-intensive and requires field-specific expert biological knowledge. Additionally, this approach can be subjective and difficult to reproduce. Therefore, there is a need for a fast and accurate classification algorithm that can be easily integrated into existing analytical pipelines.</p>
    <p id="Par14">To facilitate identifying cell clusters in scRNAseq data, here we present Cluster Identity PRedictor (CIPR) (pronounced cy-per), a web-based R/Shiny application and R package which scores complex multi-gene expression signatures of unknown experimental cell clusters against known reference cell populations. After calculating identity scores between unknown clusters-reference pairs, the pipeline generates informative graphical outputs allowing the users to easily assess predictions. CIPR pipeline can be used with one of the 7 preloaded mouse and human reference datasets, or with a user-provided custom reference dataset for specialized studies. CIPR algorithm performs internal gene name matching in a species-agnostic manner enabling comparisons across species. Users can exclude irrelevant reference cell subsets and lowly variable genes from the analysis and adapt the CIPR pipeline to their experimental needs. Our analyses using scRNAseq data obtained from mouse melanoma tumor-infiltrating immune cells show that CIPR can accurately and efficiently predict the identity of single cell clusters and can be used to annotate immune cell subsets. Benchmarking CIPR against 2 robust software solutions performing a similar task, SingleR [<xref ref-type="bibr" rid="CR12">12</xref>] and scmap [<xref ref-type="bibr" rid="CR13">13</xref>], revealed that CIPR produces comparable results while requiring significantly less compute resources and a shorter runtime. Thus, CIPR can facilitate scRNAseq data analysis by quickly and accurately annotating unknown cell clusters.</p>
  </sec>
  <sec id="Sec2">
    <title>Implementation</title>
    <sec id="Sec3">
      <title>Summary of the pipeline</title>
      <p id="Par15">Software is implemented using R programming language and Shiny framework. CIPR is accessible via online Shinyapps.io server [<xref ref-type="bibr" rid="CR17">17</xref>], or as a stand-alone R package [<xref ref-type="bibr" rid="CR18">18</xref>]. The open source code for the Shiny application and the R package is available on GitHub [<xref ref-type="bibr" rid="CR18">18</xref>, <xref ref-type="bibr" rid="CR19">19</xref>]. CIPR can work with two types of experimental input data commonly generated by popular scRNAseq analysis software: <bold>i)</bold> a data frame containing differentially expressed genes per cluster and their log fold-change (logFC) values, <bold>ii)</bold> a summary data frame that contains average normalized log-counts per gene in each cluster (for all genes in the dataset). As the reference, CIPR allows users to select one of the 7 preloaded reference datasets <bold>(</bold>Table <xref rid="Tab1" ref-type="table">1</xref><bold>)</bold> or upload a custom reference dataset generated by various high throughput analysis approaches including microarray and RNAseq. Depending on the input type, CIPR can either compare the logFC values of differentially expressed genes in clusters against reference comparators (where a logFC value at individual gene level is calculated for each reference cell subset in comparison to the average expression across the entire reference dataset), or calculate correlations using the entire gene set. The algorithm computes a vector of identity scores through pairwise comparisons of clusters and reference samples, generates visualizations and allows downloading the results as a csv file. In the CIPR R package implementation, the pipeline functions as described above with added functionality to control the graphical and numerical output.
<table-wrap id="Tab1"><label>Table 1</label><caption><p>Summary of the reference datasets included in CIPR</p></caption><table frame="hsides" rules="groups"><thead><tr><th>Reference dataset</th><th>Species</th><th>Number of samples/ features</th><th>Number of cell types (main/fine)</th><th>Reference cell types</th><th>Ref</th></tr></thead><tbody><tr><td>Immunological Genome Project (ImmGen)</td><td><italic>M. musculus</italic></td><td>296/24197</td><td>20/296</td><td>B cell, Baso, DC, Eosino, gd-T, Gran, ILC-1, ILC-2, ILC-3, Mac, Mast, Mono, NK, NKT, Pre-B, Pre-T, Stem-Prog, Stromal, T cell, Treg</td><td>[<xref ref-type="bibr" rid="CR20">20</xref>]</td></tr><tr><td>Presorted cell RNAseq (various tissues)</td><td><italic>M. musculus</italic></td><td>358/21214</td><td>18/28</td><td>Adipocyte, Astrocyte, B cell, Cardiomyocyte, DC, Endothelial, Epithelial, Erythrocyte, Fibroblast, Gran, Hepatocyte, Mac, Microglia, Mono, Neuron, NK, Oligodendrocyte, T cell</td><td>[<xref ref-type="bibr" rid="CR21">21</xref>]</td></tr><tr><td>Blueprint/ENCODE</td><td><italic>H. sapiens</italic></td><td>259/19859</td><td>24/43</td><td>Adipocytes, B cell, T cell, Chondrocyte, DC, Endothelial, Eosino, Epithelial, Erythrocyte, Fibroblast, HSC, Keratinocyte, Mac, Melanocyte, Mesangial, Mono, Myocyte, Neuron, Neutro, NK cells, Pericyte, Skeletal muscle, Smooth muscle</td><td>[<xref ref-type="bibr" rid="CR22">22</xref>, <xref ref-type="bibr" rid="CR23">23</xref>]</td></tr><tr><td>Human Primary Cell Atlas</td><td><italic>H. sapiens</italic></td><td>713/19363</td><td>37/157</td><td>Astrocyte, B cell, BM, Prog, Chondrocyte, CMP, DC, ESC, Endothelial, Epithelial, Erythroblast, Fibroblast, Gametocyte, GMP, Hepatocyte, HSC, iPS, Keratinocyte, Mac, MEP, Mono, MSC, Myelocyte, Neuroepithelial, Neuron, Neutro, NK, Osteoblast, Platelet, Pre/Pro-B, Smooth muscle, T cell, Tissue SC</td><td>[<xref ref-type="bibr" rid="CR24">24</xref>]</td></tr><tr><td>Database of Immune Cell Expression (DICE)</td><td><italic>H. sapiens</italic></td><td>15*/57,773</td><td>5/15</td><td>CD4+ T cell, CD8+ T cell, NK cell, B cell, Mono</td><td>[<xref ref-type="bibr" rid="CR25">25</xref>]</td></tr><tr><td>Hematopoietic differentiation</td><td><italic>H. sapiens</italic></td><td>211/13276</td><td>17/38</td><td>B cell, Baso, CD4+ T cell, CD8+ T cell, CMPs, DC, Eosino, Erythroid, GMP, Gran, HSC, Megakaryocyte, MEP, Mono, NK, NKT</td><td>[<xref ref-type="bibr" rid="CR26">26</xref>]</td></tr><tr><td>Presorted cell RNAseq (PBMC)</td><td><italic>H. sapiens</italic></td><td>114/46077</td><td>11/29</td><td>B cells, Baso, CD4+ T cell, CD8+ T cell, DC, Mono, Neutro, NK cells, Prog, T cell</td><td>[<xref ref-type="bibr" rid="CR27">27</xref>]</td></tr></tbody></table></table-wrap></p>
      <p id="Par16">Table <xref rid="Tab1" ref-type="table">1</xref> Multiple reference datasets are available within the CIPR pipeline. These include 2 reference datasets from mouse and 5 reference datasets from human, which contain data from both immune and non-immune cells. ImmGen reference was prepared from raw microarray data (both v1 and v2 ImmGen releases). DICE reference log-transformed transcript-per-million data was downloaded from DICE database directly. Log-normalized counts for other references were obtained from SingleR package. Reference data frames were organized for CIPR pipeline using the code accessible at GitHub repository [<xref ref-type="bibr" rid="CR19">19</xref>]. Abbreviations: Baso, basophil; Eosino, eosinophil; gd-T, gamma-delta T; Gran, granulocyte; ILC, innate lymphoid cells; Mac, macrophages; Mono, monocytes; NK, natural killer; Treg, regulatory T cells; Prog, progenitor; DC, dendritic cells; Neutro, neutrophil; H/M/E/SC, hematopoietic/mesenchymal/embryonic stem cells; MEP, megakaryocyte erythrocyte progenitor; CMP, common myeloid progenitor; GMP, granulocyte-macrophage progenitor; iPS, induced pluripotent stem cell. *Although the DICE reference data is originally composed of 1561 samples, to reduce compute time and generate readable outputs, we utilized mean transcript-per-million data per cell type resulting in 15 averaged samples).</p>
    </sec>
    <sec id="Sec4">
      <title>Use case scenario: melanoma tumor infiltrating lymphocyte scRNAseq data</title>
      <p id="Par17">We have recently described immune cell dynamics during murine melanoma tumor growth in vivo [<xref ref-type="bibr" rid="CR28">28</xref>]. In this study, CD45+ flow cytometry-sorted immune cells were sequenced via the 10X Genomics platform followed by computational analysis using Seurat R package [<xref ref-type="bibr" rid="CR29">29</xref>]. Our analysis revealed 15 distinct single cell clusters within the tumor microenvironment <bold>(</bold>Fig. <xref rid="Fig1" ref-type="fig">1</xref>a<bold>)</bold>. To demonstrate the capabilities of CIPR, here we focus on clusters 05 and 15 which distinctly expressed the marker genes defining natural killer (NK) cell and plasmacytoid dendritic cell (pDC) lineages, respectively <bold>(</bold>Fig. <xref rid="Fig1" ref-type="fig">1</xref>b, c<bold>)</bold> [<xref ref-type="bibr" rid="CR30">30</xref>, <xref ref-type="bibr" rid="CR31">31</xref>]. Using Seurat, we performed differential expression analyses at the cluster level and used this as the input for CIPR’s recommended logFC dot product method (see below for comparisons of different CIPR methods). In this analysis, we used Immunological Genome Project (ImmGen) reference which contains microarray data from sorted mouse immune cells (296 samples from 20 main cell types) [<xref ref-type="bibr" rid="CR20">20</xref>]. CIPR calculates a distinct identity score for each unknown cluster-reference pair resulting in 296 calculations per cluster. The results for individual clusters are shown in scatter plots where data points correspond to the identity score calculated for a specific reference cell subset (plotted in the x-axis) <bold>(</bold>Fig. <xref rid="Fig1" ref-type="fig">1</xref>d, e<bold>)</bold>. The color-coded data points help users distinguish the enrichment of identity scores in particular reference cell types at a glance. To help assessing the quality of CIPR predictions, the algorithm outputs shaded regions in the scatter plots that mark the boundaries of 1 and 2 standard deviations of the identity score across the reference data frame. Furthermore, we implemented a z-score approach where the distance of the identity score for a particular reference cell type is calculated in standard deviation units from the average identity score across the whole reference dataset. As the identity- and z-score calculations are impacted by the composition of the input/reference data and the analysis parameters, it is difficult to define a widely applicable significance threshold for the predictions. In our hands, predictions with z-scores higher than 1 were consistent with expert knowledge-based manual annotations. In CIPR, we chose not to leave the low/intermediate-scoring clusters unlabeled since, even though the cluster in analysis may not have a perfect match in the reference subset, knowing which reference cell subset it resembles the most is informative, especially when performing iterative analyses. Indeed, recent studies show that analytical pipelines which implement an “unassigned” classification do not have an overall improvement in prediction accuracy [<xref ref-type="bibr" rid="CR14">14</xref>, <xref ref-type="bibr" rid="CR16">16</xref>]. Thus, we anticipate that the graphical outputs of CIPR will provide a convenient and visual means to assess the strength of predictions in individual studies. In our experimental data, as expected, cluster 15 was strongly predicted to be a pDC subset as evidenced by the 4 blue-colored data points which were well above the rest of the reference subsets <bold>(</bold>Fig. <xref rid="Fig1" ref-type="fig">1</xref>d<bold>)</bold>. Cluster 05 scored the highest with the NK cell subsets which are depicted by pink-colored data points <bold>(</bold>Fig. <xref rid="Fig1" ref-type="fig">1</xref>e<bold>)</bold>. Although these scatter plots are informative, the user may only want to see the top scoring reference datasets for each cluster. CIPR pipeline also generates a summary output in which only the 5 highest-scoring reference cell types are plotted per cluster <bold>(</bold>Fig. <xref rid="Fig1" ref-type="fig">1</xref>f<bold>)</bold>. In the Shiny implementation of CIPR, users can draw a rectangle around these points which will prompt a table output below the figure providing further details about the reference cell types. The summary and per-cluster graphical outputs are created under distinct tabs in the CIPR-Shiny to speed up the user interaction and to create a minimalist interface. Users can choose to suppress one or both of these plots in the CIPR R package to tailor pipeline for programmatical use.
<fig id="Fig1"><label>Fig. 1</label><caption><p>CIPR provides a R/Shiny-powered graphical user interface to facilitate cluster annotation in scRNAseq experiments. <bold>a</bold> T-distributed stochastic neighbor embedding (t-SNE) plot for the example scRNAseq data derived from murine melanoma tumor infiltrating lymphocytes shows 15 distinct immune cell clusters within the tumor microenvironment (the dataset contains 13,985 features and 11,054 cells) [<xref ref-type="bibr" rid="CR28">28</xref>]. To demonstrate the capabilities of CIPR we focus on clusters 05 and 15 which distinctly expressed (<bold>b</bold>) natural killer cell (NK) and (<bold>c</bold>) plasmacytoid dendritic cell (pDC) markers respectively. <bold>d</bold> We used the CIPR pipeline to score the gene expression profiles of cluster 15 (pDC) against 296 mouse immune cells found in the ImmGen reference. CIPR algorithm calculates a distinct identity score for each reference cell type and generates a graphical summary of the results. In these plots, 4 highest data points (red rectangle) correspond to pDC samples within the ImmGen reference. The shaded regions in the graphs delineate 1 and 2 standard deviations around the mean identity score calculated from the entire reference data frame. Data points are color-coded based on the reference cell type allowing an easy assessment of the results. <bold>e</bold> The CIPR results for cluster 05 (NK cells) is shown. Marked data points depict the NK cells in the ImmGen dataset that had the highest identity scores. Users can visualize graphs for each cluster separately and have the option of further manipulating the plots if the R package implementation of CIPR is used. <bold>f</bold> CIPR can also generate graphical outputs to summarize the 5 top-scoring reference samples for each experimental cluster. The scatter plot shows the pDC and NK cell subsets that had the highest scores for clusters 05 and 15. In Shiny implementation of CIPR, users can draw rectangles around these points to prompt a table output which provides further information about the reference cell types on the graph</p></caption><graphic xlink:href="12859_2020_3538_Fig1_HTML" id="MO1"/></fig></p>
    </sec>
  </sec>
  <sec id="Sec5">
    <title>Results and discussion</title>
    <sec id="Sec6">
      <title>Different computational approaches in CIPR</title>
      <p id="Par18">Selecting the genes or features that have higher discriminatory potential is a critical step in automated cluster classification algorithms. Some computational pipelines perform feature selection automatically, while others allow custom feature selection or proceed to analysis with no pre-filtering. Machine-learning based feature selection can improve algorithmic predictions, but it can also increase the demand for computing resources depending on the number of cells in the analysis, as reported by Zhao et al. [<xref ref-type="bibr" rid="CR16">16</xref>] and Huang et al. [<xref ref-type="bibr" rid="CR15">15</xref>]. In CIPR, we implemented two main computational approaches to calculate identity scores: i) analysis using data only from the differentially expressed genes in clusters, ii) analysis using the entire gene set (no feature selection). Our experience suggests that the genes with the least discriminatory power will be naturally filtered out in the first case, leaving the most informative genes that can better distinguish the cell clusters from one another in the analysis. The CIPR algorithm can compare the logFC values of differentially expressed genes in experimental clusters with the logFC values of the matching genes in the reference dataset (calculated by taking the ratio of gene expression in the reference subset to the average expression value across the entire reference data frame) by using one of three methods: i) dot product, ii) Spearman’s correlation, iii) Pearson’s correlation. We recommend using the logFC dot product method as it factors in both the direction and the amount of differential expression for a given gene. For instance, if a gene is highly upregulated or downregulated in the unknown cluster and in the specific reference sample, the multiplication of such logFC values will contribute to the overall identity score, while the genes showing a strong anti-correlation will proportionately reduce the identity score. CIPR can also test the linear and nonlinear relationships between the logFC values from the unknown cluster and the reference dataset using Spearman’s or Pearson’s respectively. Alternatively, CIPR pipeline can also assess the nonlinear and linear correlations between the input and reference datasets by considering all genes regardless of differential expression status.</p>
      <p id="Par19">We sought to determine how these different analytical approaches compare to the recommended logFC dot product method. As expected, all three logFC comparison methods showed a high degree of concordance for both clusters 05 (NK cells) and 15 (pDCs) <bold>(</bold>Fig. <xref rid="Fig2" ref-type="fig">2</xref>a, b<bold>)</bold>. When we examined the z-score distribution for these methods, we observed a similar trend with slightly higher z-scores for top hits when the logFC dot product method is used <bold>(</bold>Fig. <xref rid="Fig2" ref-type="fig">2</xref>c, d<bold>)</bold>. We then compared the logFC dot product method with the correlation methods that utilize the entire gene set (all-genes Spearman/Pearson methods). Although the CIPR identity scores between these approaches showed an overall positive correlation, this relationship was weaker at the low/intermediate-scoring reference subsets suggesting that logFC dot product method may have a higher discriminatory power compared to the all-genes correlation-based methods <bold>(</bold>Fig. <xref rid="Fig2" ref-type="fig">2</xref>e, f<bold>)</bold>. As expected, since the reference data set and the experimental data originated from different experimental approaches, Pearson’s correlation performed poorer compared to Spearman’s method <bold>(</bold>Fig. <xref rid="Fig2" ref-type="fig">2</xref>g, h<bold>)</bold>. Nevertheless, we anticipate that the all-genes Pearson’s method can be useful in some experimental contexts with custom-provided reference datasets. Similar trends were observed when other clusters in the scRNAseq dataset were examined (data not shown). These findings suggest that different computational approaches implemented in CIPR generates converging results and can be adapted to various experimental contexts.
<fig id="Fig2"><label>Fig. 2</label><caption><p>Different analytical methods implemented in CIPR performs comparably to annotate single cell clusters. Three of the analytical methods in CIPR (logFC dot product, logFC Spearman’s or Pearson’s correlation) utilizes only differentially expressed genes in clusters. The recommended approach in CIPR is logFC dot product method since it takes both the direction and the amount of differential expression into account when calculating identity scores per cluster. The other approaches in CIPR are designed to analyze the expression profiles of all the genes in the experimental data regardless of their differential expression status. This figure compares the predictions of the logFC dot product method to other analytical approaches in CIPR. Data points in the scatter plots indicate the identity score of individual ImmGen reference cell subsets calculated for clusters 05 and 15 by different methods. As expected, there is a strong correlation between the results of logFC dot product method and (<bold>a</bold>) logFC Spearman’s and (<bold>b</bold>) logFC Pearson’s correlation methods for both clusters. <bold>c</bold>, <bold>d</bold> The same strong correlation was observed when the z-scores were compared for these methods, although logFC dot product differentiated the highest scoring reference subsets slightly better as evidenced by a higher z-score. The results of (<bold>e</bold>) all-genes Spearman’s and (<bold>f</bold>) all-genes Pearson’s methods show an overall positive correlation with those from logFC dot product method, although logFC dot product approach was able to better differentiate the top-scoring reference subsets as evidenced by higher z-scores shown in panels <bold>g</bold> and <bold>h</bold>. Similar observations were made for other clusters in the experimental dataset but are not shown due to space constraints</p></caption><graphic xlink:href="12859_2020_3538_Fig2_HTML" id="MO2"/></fig></p>
    </sec>
    <sec id="Sec7">
      <title>CIPR performs faster than other robust cluster annotation methods and produces comparable results</title>
      <p id="Par20">As reported by recent studies, automated cluster annotation algorithms SingleR [<xref ref-type="bibr" rid="CR12">12</xref>] and scmap [<xref ref-type="bibr" rid="CR13">13</xref>] perform robustly in various experimental contexts and simulations [<xref ref-type="bibr" rid="CR14">14</xref>–<xref ref-type="bibr" rid="CR16">16</xref>]. Scmap was initially developed for mapping different scRNAseq runs to one another, while SingleR allows using both bulk RNAseq and scRNAseq data as reference. SingleR calculates a Spearman’s correlation coefficient between single cell clusters and the reference samples after selecting variable features within the data frame [<xref ref-type="bibr" rid="CR12">12</xref>]. Scmap method also performs unsupervised feature selection and scores the similarity of single cells to reference clusters by comparing its gene expression to the median expression within the reference dataset (13). As these solutions are conceptually similar to our approach and were shown to be accurate in their predictions, we next sought to determine how CIPR compares to these pipelines in terms of its predictions and performance. To be able to perform a fair comparison with CIPR, we adapted scmap pipeline to use ImmGen bulk microarray data as reference. The latest versions of CIPR (v0.1.0), SingleR (v.1.0.5) and scmap (v1.8.0) that were available for the most current stable release of R (v3.6.2) were used in benchmarking at the time of this writing. As the CIPR calculations are performed at the cluster level, we employed the same strategy for SingleR and scmap analyses. As expected, CIPR’s all-genes correlation method showed a strong concordance with SingleR method which also employs a correlation-based metric to calculate identity scores <bold>(</bold>Fig. <xref rid="Fig3" ref-type="fig">3</xref>a<bold>)</bold>. LogFC methods showed a significant overall positive correlation between CIPR and SingleR. The highest scoring reference samples were similar between all three methods in general. This was especially clear when analyzing the highly differentiated cell types such as NK cells (cluster 05), pDCs (cluster 15), and activated CD8+ T cells (cluster 02). Scmap did not find a significant association between naïve CD8+ T cell subset (cluster 03) and the reference dataset although naïve T cell subsets are present in the ImmGen reference data. However, the lack of a cell type assignment in this cluster and overall low scores observed using the scmap method, could be due to suboptimal feature selection when scmap is run with a bulk reference data <italic>(personal communication, Dr. Martin Hemberg, the author of scmap package)</italic>. The high concordance between CIPR and other established methods suggest that the CIPR algorithm provides accurate classifications across a variety of cell types.
<fig id="Fig3"><label>Fig. 3</label><caption><p>CIPR performs faster than other cluster analysis approaches and produces comparable results. <bold>a</bold> SingleR and scmap are recently described R packages for automated cluster analysis which can perform analyses at the cluster level similarly to the CIPR approach. These algorithms were shown to perform well in various experimental contexts and can serve as a high benchmark for automated cluster analysis solutions. By performing all the analyses at the cluster level, here we report a comparison of CIPR R package (v.0.1.0), SingleR (v1.0.5) and scmap (v1.8.0) in terms of predictions and performance. For these comparisons, a Surface Pro4 computer equipped with 64-bit Win7, 16 GB memory, 2.2GHz i7-6650U CPU, R (v.3.6.2), and RStudio (v.1.2.5033) was used with no other background processes. <bold>a</bold> Five analytical methods implemented in CIPR were compared to SingleR and scmap across 5 individual clusters. Data points indicate the identity scores calculated for each ImmGen reference cell subset by different methods. Color gradient specifies the identity score calculated by scmap method (gray indicates no significant mappings were found). As expected, CIPR’s all-gene Spearman’s/Pearson’s methods are highly concordant with SingleR pipeline. The results from CIPR logFC methods show an overall positive correlation with SingleR, where the highest scoring reference cell types in CIPR were similar to those calculated by SingleR and scmap. In some cases, scmap failed to find a significant association which may be due to its suboptimal power when a bulk reference data is used as input. <bold>b</bold> CIPR performs significantly faster than SingleR, and comparably to scmap in 5 separate tests. We benchmarked the runtime of SingleR function both with and without fine tuning feature. Scmap (short) measures the runtime of scmapcluster computational engine, whereas scmap (long) measures the runtime starting with the initial object creation. <bold>c</bold> CIPR utilizes less computer memory over time compared to (<bold>d</bold>) SingleR (no fine tuning) and (<bold>e</bold>) scmap</p></caption><graphic xlink:href="12859_2020_3538_Fig3_HTML" id="MO3"/></fig></p>
      <p id="Par21">When we compared the runtimes of these methods, we observed that CIPR was significantly faster compared to SingleR with or without SingleR’s “fine tuning” parameter <bold>(</bold>Fig. <xref rid="Fig3" ref-type="fig">3</xref>b<bold>)</bold>. Scmap had a similar speed with CIPR when only the identity prediction function is measured (labeled “scmap-short”) and had a slightly longer runtime when the time it takes to set up the analysis object is considered (labeled “scmap-long”, which would be a comparable use scenario to CIPR). However, we anticipate longer computing times from scmap pipeline when high dimensional scRNAseq data is used instead of the bulk reference data in current analyses (as per scmap design). We next assessed the memory utilization by these methods. All CIPR methods utilized less than 1000 megabytes (Mb) of memory <bold>(</bold>Fig. <xref rid="Fig3" ref-type="fig">3</xref>c<bold>)</bold>, whereas SingleR required ~ 1500 Mb without fine tuning and over 6000 Mb with fine tuning <bold>(</bold>Fig. <xref rid="Fig3" ref-type="fig">3</xref>d<bold>)</bold>. Scmap used comparable amounts of memory for computations but required 5000–6000 Mb of memory to set up the analysis object <bold>(</bold>Fig. <xref rid="Fig3" ref-type="fig">3</xref>e<bold>)</bold>. These observations suggest that the CIPR algorithm can perform cluster-level identity predictions in an accurate and efficient manner to facilitate scRNAseq data analysis. As the CIPR pipeline works with a simple R data frame structure, we anticipate that it will provide a quick and user-friendly solution for annotating cell clusters during iterative analyses.</p>
    </sec>
    <sec id="Sec8">
      <title>Filtering out genes with low variance can increase the discriminatory power of CIPR</title>
      <p id="Par22">In addition to limiting the CIPR pipeline to differentially expressed genes in the experimental data via logFC methods, users can choose to apply gene filtering based on the expression variance across the reference dataset. By eliminating the lowly variable genes in the reference, hence the noise, we hypothesize that all-genes correlation methods could perform better. We designed a numeric slider input in the Shiny applet (and a numeric input argument in CIPR R package) to allow the user to define a variance cutoff to keep top n<sup>th</sup> percent of highly variable genes in the analysis. To test the effects of reference gene filtering on the CIPR results, we compared CIPR identity scores and z-scores calculated by the all-genes Spearman’s correlation method without variance filtering and with variance cutoff set to top 10% or 1% (leaving 2420 and 242 genes of the ImmGen reference in analysis respectively), and re-analyzed the clusters 05 (NK cells) and 15 (pDCs) introduced in Fig. <xref rid="Fig1" ref-type="fig">1</xref>. With the increasing stringency of variance filtering, the identity scores of the highest-scoring reference cell subsets remained unchanged whereas the identity scores of the intermediate-scoring reference cell subsets were reduced <bold>(</bold>Fig. <xref rid="Fig4" ref-type="fig">4</xref>a, b<bold>)</bold>. The z-scores of the highest scoring reference cell types were also found to generally increase with variance filtering as observed in both clusters 05 and 15 <bold>(</bold>Fig. <xref rid="Fig4" ref-type="fig">4</xref>c, d<bold>)</bold>. These findings suggest that reference feature subsetting based on expression variance can improve the discrimination of some cell clusters in scRNAseq data.
<fig id="Fig4"><label>Fig. 4</label><caption><p>CIPR allows users to limit the analysis to highly variable reference genes to improve cluster annotations. As genes with variable expression profiles contain more information to discriminate cell types, we implemented a variance filtering parameter in CIPR. The user-defined variance threshold parameter instructs the algorithm to utilize the genes with variances above a certain quantile across the reference dataset, thus limiting the analysis to highly variable genes. Plots compare the CIPR results with or without variance thresholding when the all-genes Spearman’s method is used. Identity- and z-scores were calculated for clusters 05 (NK cells) and 15 (pDCs) using ImmGen reference and results for individual reference samples types are plotted as color-coded data points. Applying variance thresholding and increasing its stringency from top 10% to top 1% reduced the identity scores of low/intermediate-scoring reference cell subsets while the highest scoring reference cell subsets remained unaffected as evidenced by data points overlapping with y = x line for (<bold>a</bold>) cluster 05, and (<bold>b</bold>) cluster 15. Similar trends were observed for other clusters in analysis (not shown). The differential impact on identity scores of high- and low-scoring reference cell subsets lead to an increased z-score for the highest-scoring reference subsets for both (<bold>c</bold>) cluster 05 and (<bold>d</bold>) cluster 15. These findings suggest that variance thresholding can improve the discrimination of some reference cell subsets. Although the best thresholding value remains to be determined in individual studies, CIPR pipeline allows a level of flexibility to be adapted to different experimental contexts</p></caption><graphic xlink:href="12859_2020_3538_Fig4_HTML" id="MO4"/></fig></p>
    </sec>
    <sec id="Sec9">
      <title>Excluding irrelevant reference cell subsets may improve the CIPR predictions</title>
      <p id="Par23">One of the challenges in scRNAseq data analysis is finding a suitable reference data frame for experimental data at hand. Having irrelevant cell types in the reference dataset can unnecessarily increase the time and the computational resources necessary for the analysis, and can impact the classification quality [<xref ref-type="bibr" rid="CR15">15</xref>, <xref ref-type="bibr" rid="CR16">16</xref>]. Therefore, focusing the analysis on a smaller subset of the reference dataset can be desirable in certain contexts. We implemented a user-friendly approach to limit the CIPR pipeline to the reference samples of interest via a drop-down menu in the Shiny implementation, and via a dedicated function argument that accepts human-readable strings in the R package implementation. Since the pairwise cluster-vs-reference correlations will be the same regardless of the composition of the reference dataset, CIPR’s all-genes based correlation methods are not expected to change upon reference subsetting. However, when using the logFC comparison methods, CIPR calculates differential gene expression per reference sample by comparing the gene expression values to the average gene expression across the reference dataset in analysis. Therefore, changing the composition of the reference dataset will impact the calculations of the logFC-based methods. We hypothesize that such reference subsetting can better discriminate closely related cell types, especially when analyzing datasets with low heterogeneity.</p>
      <p id="Par24">To test the performance of CIPR with a limited set of reference samples, we subsetted all T cells from the tumor-infiltrating immune cell scRNAseq data described in Fig. <xref rid="Fig1" ref-type="fig">1</xref> [<xref ref-type="bibr" rid="CR28">28</xref>], as identified by the concomitant expression of <italic>Cd3e</italic> and <italic>Cd4</italic> or <italic>Cd8a</italic> marker genes <bold>(</bold>Fig. <xref rid="Fig5" ref-type="fig">5</xref>a<bold>)</bold>. We performed new dimensionality reduction and clustering analyses and examined known marker gene expression which revealed that the dataset contains various <italic>Cd4</italic> and <italic>Cd8a</italic>-expressing T cell subsets including L-selectin-high (<italic>Sell</italic>, Cd62l) naïve T cells (clusters 01 and 03), interferon gamma (<italic>Ifng</italic>)-high activated T cells, and <italic>Foxp3</italic>-high regulatory T cells (clusters 05 and 06) <bold>(</bold>Fig. <xref rid="Fig5" ref-type="fig">5</xref>b<bold>)</bold>. When we performed CIPR analysis using 70 T cell reference samples found in ImmGen reference, we observed that regulatory T cells (Tregs) scored the highest in cluster 06 as expected <bold>(</bold>Fig. <xref rid="Fig5" ref-type="fig">5</xref>c<bold>)</bold>. Using T cell-specific scRNAseq data, we then compared the performance of CIPR, SingleR, and scmap with unfiltered ImmGen reference (296 samples). Although the highest scoring reference cell types were similar among the different methods, the positive correlation between CIPR logFC dot product method and SingleR were weaker compared to the parental experimental dataset with high heterogeneity <bold>(</bold>Fig. <xref rid="Fig5" ref-type="fig">5</xref>d<bold>)</bold>. When we performed the analyses after limiting the reference dataset to T cells for all the methods in comparison, the concordance between CIPR and SingleR increased for both activated T cells (cluster 01) and Tregs (cluster 06) <bold>(</bold>Fig. <xref rid="Fig5" ref-type="fig">5</xref>e<bold>)</bold>. For these analysis we excluded T cell-like subsets that exhibit a transitionary phenotype (such as gamma delta T cells and natural killer T cells), as these cells do not typically express the T cell co-receptor genes (<italic>Cd4</italic> and <italic>Cd8a</italic>) used for subsetting the T cells in our experimental data. Although further characterization is needed to elucidate how well the reference filtering approach can discriminate highly similar cell subsets, these findings suggest that CIPR can be adapted to various experimental contexts by the end user.
<fig id="Fig5"><label>Fig. 5</label><caption><p>Irrelevant reference subsets can be excluded to tailor CIPR pipeline to different user needs. CIPR pipeline allows users to easily exclude the reference subsets that are of no interest for the study at hand. Limiting the analysis only to the relevant reference subsets can increase the readability of the graphical outputs and may better differentiate closely related single cell clusters. To demonstrate this capability, we subsetted the scRNAseq dataset described in Fig. <xref rid="Fig1" ref-type="fig">1</xref> to contain only T cells (as defined by the simultaneous expression of <italic>Cd3e</italic> and <italic>Cd4</italic> or <italic>Cd8a</italic> marker genes). We then performed CIPR analyses with or without limiting the pipeline to T cell references within the ImmGen dataset. <bold>a</bold> Uniform manifold approximation and projection (UMAP) plot with 6 distinct single-cell clusters shows the heterogeneity within the T cell subsets in the tumor microenvironment. <bold>b</bold> Representative feature plots indicate that the clusters are composed of <italic>Cd4</italic>+ helper and <italic>Cd8a</italic>+ cytotoxic T cells some of which exhibited an activated phenotype (<italic>Ifng</italic>+ cells) while others appeared to have naïve-memory phenotype (<italic>Sell</italic>+ cells). Of note, cluster 06 is composed of <italic>Foxp3</italic>+ regulatory T cells (Tregs). <bold>c</bold> CIPR analysis using logFC dot product method shows that highest scoring reference subsets for cluster 06 are regulatory T cell subsets within the ImmGen reference data. <bold>d</bold> Graphs show that identity scores calculated by CIPR, SingleR and scmap are positively correlated for both cluster 01 (activated <italic>Cd8a</italic>+ cells) and cluster 06 (Tregs). For these analyses, the entire ImmGen reference data (296 samples spanning 20 different cell types) were used, and the calculations were performed at the cluster level as described above. <bold>e</bold> The positive correlation between different analytical approaches were stronger when the reference dataset was limited to T cell subsets (70 samples in ImmGen data). In general, the highest scoring reference cell subsets in CIPR also scored the highest in scmap and SingleR methods</p></caption><graphic xlink:href="12859_2020_3538_Fig5_HTML" id="MO5"/></fig></p>
    </sec>
  </sec>
  <sec id="Sec10">
    <title>Conclusions</title>
    <p id="Par25">CIPR is a web-based Shiny applet/R package that can be used to quickly and accurately annotate unknown single cell clusters in scRNAseq experiments without prior knowledge of biological markers for the investigated cell types. CIPR provides a user-friendly graphical interface to score cluster-specific gene expression patterns against known reference cell subsets and generate informative outputs. Quality control metrics and graphical outputs implemented in CIPR help assess the confidence of the predictions in individual studies. User-defined gene/reference subsetting functionality allows adapting the CIPR pipeline to various experimental contexts. Benchmarking CIPR against other robust software solutions that perform a similar task suggests that our pipeline generates comparable results in a significantly shorter timeframe and requires considerably less computational resources. Thus, CIPR is ideal for iterative analyses where the user wants to test different clustering parameters and quickly assess the identity of calculated cell clusters. We provide detailed vignettes to prepare CIPR-ready simple data frames on the Shiny web platform and within the CIPR package which do not require any more programming skills than what is needed to run other tools. Furthermore, the R package implementation of CIPR enables users to easily integrate our algorithm into existing analytical pipelines without leaving the R environment and allows flexible graphing options. In summary, CIPR can facilitate scRNAseq data analysis by quickly and objectively annotating single cell clusters.</p>
  </sec>
  <sec id="Sec11">
    <title>Availability and requirements</title>
    <p id="Par26"><bold>Project Name:</bold> Cluster Identity Predictor (CIPR).</p>
    <p id="Par27">
      <bold>Project Home Page:</bold>
      <ext-link ext-link-type="uri" xlink:href="https://aekiz.shinyapps.io/CIPR/">https://aekiz.shinyapps.io/CIPR/</ext-link>
    </p>
    <p id="Par28">
      <bold>Project Repository (Shiny app):</bold>
      <ext-link ext-link-type="uri" xlink:href="https://github.com/atakanekiz/CIPR-Shiny">https://github.com/atakanekiz/CIPR-Shiny</ext-link>
    </p>
    <p id="Par29">
      <bold>Project Repository (R package):</bold>
      <ext-link ext-link-type="uri" xlink:href="https://github.com/atakanekiz/CIPR-Package">https://github.com/atakanekiz/CIPR-Package</ext-link>
    </p>
    <p id="Par30"><bold>Operating Systems:</bold> Platform independent (web-based).</p>
    <p id="Par31"><bold>Programming Language:</bold> R.</p>
    <p id="Par32"><bold>Other requirements:</bold> Browser, internet access. If running the R code locally though CIPR R package, package dependencies such as dplyr, tibble, ggpubr, and gtools.</p>
    <p id="Par33"><bold>License:</bold> GNU GPL.</p>
    <p id="Par34"><bold>Restrictions for non-academics:</bold> None.</p>
  </sec>
</body>
<back>
  <glossary>
    <title>Abbreviations</title>
    <def-list>
      <def-item>
        <term>ScRNAseq</term>
        <def>
          <p id="Par4">Single cell RNA sequencing</p>
        </def>
      </def-item>
      <def-item>
        <term>CIPR</term>
        <def>
          <p id="Par5">Cluster Identity Predictor</p>
        </def>
      </def-item>
      <def-item>
        <term>ImmGen</term>
        <def>
          <p id="Par6">Immunological Genome Project</p>
        </def>
      </def-item>
      <def-item>
        <term>logFC</term>
        <def>
          <p id="Par7">Log fold-change</p>
        </def>
      </def-item>
      <def-item>
        <term>NK cells</term>
        <def>
          <p id="Par8">Natural killer cells</p>
        </def>
      </def-item>
      <def-item>
        <term>pDC</term>
        <def>
          <p id="Par9">Plasmacytoid dendritic cells</p>
        </def>
      </def-item>
      <def-item>
        <term>DICE</term>
        <def>
          <p id="Par10">Database of Immune Cell Expression</p>
        </def>
      </def-item>
      <def-item>
        <term>PBMC</term>
        <def>
          <p id="Par11">Peripheral blood mononuclear cells</p>
        </def>
      </def-item>
      <def-item>
        <term>ENCODE</term>
        <def>
          <p id="Par12">The Encyclopedia of DNA Elements</p>
        </def>
      </def-item>
    </def-list>
  </glossary>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher’s Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <ack>
    <title>Acknowledgements</title>
    <p>We thank Dr. Thomas B. Huffaker for generating the scRNAseq datasets which were used for generating the CIPR pipeline. CIPR pipeline was tested and improved using various datasets generated by Kaylyn Bauer, Owen Jensen, and Dr. Andrew Ramstead. We thank the University of Utah Flow Cytometry, High-Throughput Genomics, and Bioinformatics Core Facilities for offering single cell transcriptomics services.</p>
    <sec id="FPar1">
      <title>Consent to participate and consent for publication</title>
      <p id="Par35">This is not applicable to this study as the CIPR pipeline was not developed with in-house human data.</p>
    </sec>
  </ack>
  <notes notes-type="author-contribution">
    <title>Authors’ contributions</title>
    <p>HAE conceived and developed the CIPR pipeline and wrote this manuscript. WZS and CJC provided critical feedback during pipeline generation and implementation of statistical approaches and edited the manuscript. ROC oversaw the experimental work and the development of CIPR pipeline and edited the manuscript. All authors made substantial contributions to the development of CIPR and the production of this report. The author(s) read and approved the final manuscript.</p>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>This work was supported in part by NIH grants R01-AG047956 and R01-AI123106. The funding body did not play any roles in the design of the study, collection, analysis, and interpretation of data, and in writing the manuscript.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and materials</title>
    <p>Reference datasets utilized in CIPR are publicly available [<xref ref-type="bibr" rid="CR20">20</xref>–<xref ref-type="bibr" rid="CR27">27</xref>]. ScRNAseq data derived from tumor infiltrating immune cells were recently published [<xref ref-type="bibr" rid="CR28">28</xref>] and accessible at gene expression omnibus (GEO) database (GSE121478) [<xref ref-type="bibr" rid="CR32">32</xref>]. To provide example data for CIPR and to reduce compute times, this experimental dataset was trimmed to contain only 4 single cell clusters in shiny implementation of CIPR, and is available at CIPR GitHub repository [<xref ref-type="bibr" rid="CR19">19</xref>]</p>
  </notes>
  <notes id="FPar2">
    <title>Ethics approval</title>
    <p id="Par36">CIPR was developed using scRNAseq data obtained from mouse studies. All experimental procedures and animal handling were performed in accordance with the University of Utah Institutional Animal Care and Use Committee regulations.</p>
  </notes>
  <notes id="FPar3" notes-type="COI-statement">
    <title>Competing interests</title>
    <p id="Par37">The authors declare that they have no competing interests.</p>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Navin</surname>
            <given-names>NE</given-names>
          </name>
        </person-group>
        <article-title>Advances and applications of single-cell sequencing technologies</article-title>
        <source>Mol Cell</source>
        <year>2015</year>
        <volume>58</volume>
        <issue>4</issue>
        <fpage>598</fpage>
        <lpage>609</lpage>
        <?supplied-pmid 26000845?>
        <pub-id pub-id-type="pmid">26000845</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hwang</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>JH</given-names>
          </name>
          <name>
            <surname>Bang</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>Single-cell RNA sequencing technologies and bioinformatics pipelines</article-title>
        <source>Exp Mol Med</source>
        <year>2018</year>
        <volume>50</volume>
        <issue>8</issue>
        <fpage>96</fpage>
        <?supplied-pmid 30089861?>
        <pub-id pub-id-type="pmid">30089861</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lopez</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Regier</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Cole</surname>
            <given-names>MB</given-names>
          </name>
          <name>
            <surname>Jordan</surname>
            <given-names>MI</given-names>
          </name>
          <name>
            <surname>Yosef</surname>
            <given-names>N</given-names>
          </name>
        </person-group>
        <article-title>Deep generative modeling for single-cell transcriptomics</article-title>
        <source>Nat Methods</source>
        <year>2018</year>
        <volume>15</volume>
        <issue>12</issue>
        <fpage>1053</fpage>
        <lpage>1058</lpage>
        <?supplied-pmid 30504886?>
        <pub-id pub-id-type="pmid">30504886</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <mixed-citation publication-type="other">Zhang Z, Luo D, Zhong X, Choi JH, Ma Y, Wang S, et al. SCINA: A Semi-Supervised Subtyping Algorithm of Single Cells and Bulk Samples. Genes (Basel). 2019;10(7).</mixed-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Domanskyi</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Szedlak</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Hawkins</surname>
            <given-names>NT</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Paternostro</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Piermarocchi</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>Polled digital cell sorter (p-DCS): automatic identification of hematological cell types from single cell RNA-sequencing clusters</article-title>
        <source>BMC Bioinformatics</source>
        <year>2019</year>
        <volume>20</volume>
        <issue>1</issue>
        <fpage>369</fpage>
        <?supplied-pmid 31262249?>
        <pub-id pub-id-type="pmid">31262249</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pliner</surname>
            <given-names>HA</given-names>
          </name>
          <name>
            <surname>Shendure</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Trapnell</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>Supervised classification enables rapid annotation of cell atlases</article-title>
        <source>Nat Methods</source>
        <year>2019</year>
        <volume>16</volume>
        <issue>10</issue>
        <fpage>983</fpage>
        <lpage>986</lpage>
        <?supplied-pmid 31501545?>
        <pub-id pub-id-type="pmid">31501545</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Ma</surname>
            <given-names>F</given-names>
          </name>
        </person-group>
        <source>Pellegrini M</source>
        <year>2019</year>
        <publisher-loc>Automated Identification of Cell Types in Single Cell RNA Sequencing. Bioinformatics</publisher-loc>
        <publisher-name>ACTINN</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <mixed-citation publication-type="other">Alquicira-Hernandez J, Sathe A, Ji HP, Nguyen Q, Powell JE. scPred: accurate supervised method for cell-type classification from single-cell RNA-seq data. Genome Biol. 2019;20(1):264.</mixed-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>de Kanter</surname>
            <given-names>JK</given-names>
          </name>
          <name>
            <surname>Lijnzaad</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Candelli</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Margaritis</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Holstege</surname>
            <given-names>FCP</given-names>
          </name>
        </person-group>
        <article-title>CHETAH: a selective, hierarchical cell type identification method for single-cell RNA sequencing</article-title>
        <source>Nucleic Acids Res</source>
        <year>2019</year>
        <volume>47</volume>
        <issue>16</issue>
        <fpage>e95</fpage>
        <?supplied-pmid 31226206?>
        <pub-id pub-id-type="pmid">31226206</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lieberman</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Rokach</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Shay</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>CaSTLe - classification of single cells by transfer learning: harnessing the power of publicly available single cell RNA sequencing experiments to annotate new experiments</article-title>
        <source>PLoS One</source>
        <year>2018</year>
        <volume>13</volume>
        <issue>10</issue>
        <fpage>e0205499</fpage>
        <?supplied-pmid 30304022?>
        <pub-id pub-id-type="pmid">30304022</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tan</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Cahan</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>SingleCellNet: a computational tool to classify single cell RNA-Seq data across platforms and across species</article-title>
        <source>Cell Syst</source>
        <year>2019</year>
        <volume>9</volume>
        <issue>2</issue>
        <fpage>207</fpage>
        <lpage>213</lpage>
        <?supplied-pmid 31377170?>
        <pub-id pub-id-type="pmid">31377170</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Aran</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Looney</surname>
            <given-names>AP</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Fong</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Hsu</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Reference-based analysis of lung single-cell sequencing reveals a transitional profibrotic macrophage</article-title>
        <source>Nat Immunol</source>
        <year>2019</year>
        <volume>20</volume>
        <issue>2</issue>
        <fpage>163</fpage>
        <lpage>172</lpage>
        <?supplied-pmid 30643263?>
        <pub-id pub-id-type="pmid">30643263</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kiselev</surname>
            <given-names>VY</given-names>
          </name>
          <name>
            <surname>Yiu</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Hemberg</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Scmap: projection of single-cell RNA-seq data across data sets</article-title>
        <source>Nat Methods</source>
        <year>2018</year>
        <volume>15</volume>
        <issue>5</issue>
        <fpage>359</fpage>
        <lpage>362</lpage>
        <?supplied-pmid 29608555?>
        <pub-id pub-id-type="pmid">29608555</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Abdelaal</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Michielsen</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Cats</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Hoogduin</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Mei</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Reinders</surname>
            <given-names>MJT</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A comparison of automatic cell identification methods for single-cell RNA sequencing data</article-title>
        <source>Genome Biol</source>
        <year>2019</year>
        <volume>20</volume>
        <issue>1</issue>
        <fpage>194</fpage>
        <?supplied-pmid 31500660?>
        <pub-id pub-id-type="pmid">31500660</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <mixed-citation publication-type="other">Huang Q, Liu Y, Du Y, Garmire LX. Evaluation of Cell Type Deconvolution R Packages on Single Cell RNA-seq Data. bioRxiv. 2019:827139.</mixed-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Zhao</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Fang</surname>
            <given-names>N</given-names>
          </name>
        </person-group>
        <source>Sun X, Fan J</source>
        <year>2019</year>
        <publisher-loc>Brief Bioinform</publisher-loc>
        <publisher-name>Evaluation of single-cell classifiers for single-cell RNA sequencing data sets</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <mixed-citation publication-type="other">Ekiz HA. Cluster Identity Predictor (CIPR) Shiny App. <ext-link ext-link-type="uri" xlink:href="https://aekiz.shinyapps.io/CIPR/">https://aekiz.shinyapps.io/CIPR/</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <mixed-citation publication-type="other">Ekiz HA. CIPR R package GitHub Repository. <ext-link ext-link-type="uri" xlink:href="https://github.com/atakanekiz/CIPR-Package">https://github.com/atakanekiz/CIPR-Package</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <mixed-citation publication-type="other">Ekiz HA. CIPR-Shiny GitHub Repository. <ext-link ext-link-type="uri" xlink:href="https://github.com/atakanekiz/CIPR-Shiny">https://github.com/atakanekiz/CIPR-Shiny</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Heng</surname>
            <given-names>TS</given-names>
          </name>
          <name>
            <surname>Painter</surname>
            <given-names>MW</given-names>
          </name>
        </person-group>
        <article-title>Immunological genome project C. the immunological genome project: networks of gene expression in immune cells</article-title>
        <source>Nat Immunol</source>
        <year>2008</year>
        <volume>9</volume>
        <issue>10</issue>
        <fpage>1091</fpage>
        <lpage>1094</lpage>
        <?supplied-pmid 18800157?>
        <pub-id pub-id-type="pmid">18800157</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Benayoun</surname>
            <given-names>BA</given-names>
          </name>
          <name>
            <surname>Pollina</surname>
            <given-names>EA</given-names>
          </name>
          <name>
            <surname>Singh</surname>
            <given-names>PP</given-names>
          </name>
          <name>
            <surname>Mahmoudi</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Harel</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Casey</surname>
            <given-names>KM</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Remodeling of epigenome and transcriptome landscapes with aging in mice reveals widespread induction of inflammatory responses</article-title>
        <source>Genome Res</source>
        <year>2019</year>
        <volume>29</volume>
        <issue>4</issue>
        <fpage>697</fpage>
        <lpage>709</lpage>
        <?supplied-pmid 30858345?>
        <pub-id pub-id-type="pmid">30858345</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Consortium</surname>
            <given-names>EP</given-names>
          </name>
        </person-group>
        <article-title>An integrated encyclopedia of DNA elements in the human genome</article-title>
        <source>Nature.</source>
        <year>2012</year>
        <volume>489</volume>
        <issue>7414</issue>
        <fpage>57</fpage>
        <lpage>74</lpage>
        <pub-id pub-id-type="pmid">22955616</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Martens</surname>
            <given-names>JHA</given-names>
          </name>
          <name>
            <surname>Stunnenberg</surname>
            <given-names>HG</given-names>
          </name>
        </person-group>
        <article-title>BLUEPRINT: mapping human blood cell epigenomes</article-title>
        <source>Haematologica.</source>
        <year>2013</year>
        <volume>98</volume>
        <issue>10</issue>
        <fpage>1487</fpage>
        <lpage>1489</lpage>
        <?supplied-pmid 24091925?>
        <pub-id pub-id-type="pmid">24091925</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mabbott</surname>
            <given-names>NA</given-names>
          </name>
          <name>
            <surname>Baillie</surname>
            <given-names>JK</given-names>
          </name>
          <name>
            <surname>Brown</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Freeman</surname>
            <given-names>TC</given-names>
          </name>
          <name>
            <surname>Hume</surname>
            <given-names>DA</given-names>
          </name>
        </person-group>
        <article-title>An expression atlas of human primary cells: inference of gene function from coexpression networks</article-title>
        <source>BMC Genomics</source>
        <year>2013</year>
        <volume>14</volume>
        <fpage>632</fpage>
        <?supplied-pmid 24053356?>
        <pub-id pub-id-type="pmid">24053356</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schmiedel</surname>
            <given-names>BJ</given-names>
          </name>
          <name>
            <surname>Singh</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Madrigal</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Valdovino-Gonzalez</surname>
            <given-names>AG</given-names>
          </name>
          <name>
            <surname>White</surname>
            <given-names>BM</given-names>
          </name>
          <name>
            <surname>Zapardiel-Gonzalo</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Impact of genetic polymorphisms on human immune cell gene expression</article-title>
        <source>Cell.</source>
        <year>2018</year>
        <volume>175</volume>
        <issue>6</issue>
        <fpage>1701</fpage>
        <lpage>1715</lpage>
        <?supplied-pmid 30449622?>
        <pub-id pub-id-type="pmid">30449622</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Novershtern</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Subramanian</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Lawton</surname>
            <given-names>LN</given-names>
          </name>
          <name>
            <surname>Mak</surname>
            <given-names>RH</given-names>
          </name>
          <name>
            <surname>Haining</surname>
            <given-names>WN</given-names>
          </name>
          <name>
            <surname>McConkey</surname>
            <given-names>ME</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Densely interconnected transcriptional circuits control cell states in human hematopoiesis</article-title>
        <source>Cell.</source>
        <year>2011</year>
        <volume>144</volume>
        <issue>2</issue>
        <fpage>296</fpage>
        <lpage>309</lpage>
        <?supplied-pmid 21241896?>
        <pub-id pub-id-type="pmid">21241896</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Monaco</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Xu</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Mustafah</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Hwang</surname>
            <given-names>YY</given-names>
          </name>
          <name>
            <surname>Carre</surname>
            <given-names>C</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>RNA-Seq signatures normalized by mRNA abundance allow absolute Deconvolution of human immune cell types</article-title>
        <source>Cell Rep</source>
        <year>2019</year>
        <volume>26</volume>
        <issue>6</issue>
        <fpage>1627</fpage>
        <lpage>1640</lpage>
        <?supplied-pmid 30726743?>
        <pub-id pub-id-type="pmid">30726743</pub-id>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <mixed-citation publication-type="other">Ekiz HA, Huffaker TB, Grossmann AH, Stephens WZ, Williams MA, Round JL, et al. MicroRNA-155 coordinates the immunological landscape within murine melanoma and correlates with immunity in human cancers. JCI Insight. 2019;4(6).</mixed-citation>
    </ref>
    <ref id="CR29">
      <label>29.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Butler</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Hoffman</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Smibert</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Papalexi</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Satija</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Integrating single-cell transcriptomic data across different conditions, technologies, and species</article-title>
        <source>Nat Biotechnol</source>
        <year>2018</year>
        <volume>36</volume>
        <issue>5</issue>
        <fpage>411</fpage>
        <lpage>420</lpage>
        <?supplied-pmid 29608179?>
        <pub-id pub-id-type="pmid">29608179</pub-id>
      </element-citation>
    </ref>
    <ref id="CR30">
      <label>30.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Musumeci</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Lutz</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Winheim</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Krug</surname>
            <given-names>AB</given-names>
          </name>
        </person-group>
        <article-title>What makes a pDC: recent advances in understanding Plasmacytoid DC development and heterogeneity</article-title>
        <source>Front Immunol</source>
        <year>2019</year>
        <volume>10</volume>
        <fpage>1222</fpage>
        <?supplied-pmid 31191558?>
        <pub-id pub-id-type="pmid">31191558</pub-id>
      </element-citation>
    </ref>
    <ref id="CR31">
      <label>31.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Inngjerdingen</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Kveberg</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Naper</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Vaage</surname>
            <given-names>JT</given-names>
          </name>
        </person-group>
        <article-title>Natural killer cell subsets in man and rodents</article-title>
        <source>Tissue Antigens</source>
        <year>2011</year>
        <volume>78</volume>
        <fpage>81</fpage>
        <lpage>88</lpage>
        <?supplied-pmid 21726202?>
        <pub-id pub-id-type="pmid">21726202</pub-id>
      </element-citation>
    </ref>
    <ref id="CR32">
      <label>32.</label>
      <mixed-citation publication-type="other">Huffaker TB, Ekiz HA, O'Connell R M. Single-cell RNA-sequencing of murine melanoma infiltrating immune cells in wild-type and miR-155 T cell conditional knockout mice. <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE121478">https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE121478</ext-link>.</mixed-citation>
    </ref>
  </ref-list>
</back>
