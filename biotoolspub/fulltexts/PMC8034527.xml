<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">8034527</article-id>
    <article-id pub-id-type="pmid">33416863</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btaa1092</article-id>
    <article-id pub-id-type="publisher-id">btaa1092</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Original Papers</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Structural Bioinformatics</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01060</subject>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01060</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Recognition of small molecule–RNA binding sites using RNA sequence and structure</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Su</surname>
          <given-names>Hong</given-names>
        </name>
        <aff><institution>School of Mathematical Sciences, Nankai University</institution>, Tianjin 300071, <country country="CN">China</country></aff>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Peng</surname>
          <given-names>Zhenling</given-names>
        </name>
        <xref rid="btaa1092-cor1" ref-type="corresp"/>
        <aff><institution>Center for Applied Mathematics, Tianjin University</institution>, Tianjin 300072, <country country="CN">China</country></aff>
        <!--zhenling@tju.edu.cn-->
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0003-2912-7737</contrib-id>
        <name>
          <surname>Yang</surname>
          <given-names>Jianyi</given-names>
        </name>
        <xref rid="btaa1092-cor1" ref-type="corresp"/>
        <aff><institution>School of Mathematical Sciences, Nankai University</institution>, Tianjin 300071, <country country="CN">China</country></aff>
        <!--yangjy@nankai.edu.cn-->
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Ponty</surname>
          <given-names>Yann</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="btaa1092-cor1">To whom correspondence should be addressed. <email>zhenling@tju.edu.cn</email> or <email>yangjy@nankai.edu.cn</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <day>01</day>
      <month>1</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2021-01-08">
      <day>08</day>
      <month>1</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>08</day>
      <month>1</month>
      <year>2021</year>
    </pub-date>
    <volume>37</volume>
    <issue>1</issue>
    <fpage>36</fpage>
    <lpage>42</lpage>
    <history>
      <date date-type="received">
        <day>12</day>
        <month>11</month>
        <year>2019</year>
      </date>
      <date date-type="rev-recd">
        <day>12</day>
        <month>12</month>
        <year>2020</year>
      </date>
      <date date-type="editorial-decision">
        <day>22</day>
        <month>12</month>
        <year>2020</year>
      </date>
      <date date-type="accepted">
        <day>23</day>
        <month>12</month>
        <year>2020</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2021. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2021</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbynclicense">https://creativecommons.org/licenses/by-nc/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by-nc/4.0/">http://creativecommons.org/licenses/by-nc/4.0/</ext-link>), which permits non-commercial re-use, distribution, and reproduction in any medium, provided the original work is properly cited. For commercial re-use, please contact journals.permissions@oup.com</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btaa1092.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Motivation</title>
        <p>RNA molecules become attractive small molecule drug targets to treat disease in recent years. Computer-aided drug design can be facilitated by detecting the RNA sites that bind small molecules. However, very limited progress has been reported for the prediction of small molecule–RNA binding sites.</p>
      </sec>
      <sec id="s2">
        <title>Results</title>
        <p>We developed a novel method RNAsite to predict small molecule–RNA binding sites using sequence profile- and structure-based descriptors. RNAsite was shown to be competitive with the state-of-the-art methods on the experimental structures of two independent test sets. When predicted structure models were used, RNAsite outperforms other methods by a large margin. The possibility of improving RNAsite by geometry-based binding pocket detection was investigated. The influence of RNA structure’s flexibility and the conformational changes caused by ligand binding on RNAsite were also discussed. RNAsite is anticipated to be a useful tool for the design of RNA-targeting small molecule drugs.</p>
      </sec>
      <sec id="s3">
        <title>Availability and implementation</title>
        <p><ext-link xlink:href="http://yanglab.nankai.edu.cn/RNAsite" ext-link-type="uri">http://yanglab.nankai.edu.cn/RNAsite</ext-link>.</p>
      </sec>
      <sec id="s5">
        <title>Supplementary information</title>
        <p><xref rid="sup1" ref-type="supplementary-material">Supplementary data</xref> are available at <italic toggle="yes">Bioinformatics</italic> online.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>National Natural Science Foundation of China</institution>
            <institution-id institution-id-type="DOI">10.13039/501100001809</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>11871290</award-id>
        <award-id>61873185</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Fok Ying-Tong Education Foundation</institution>
          </institution-wrap>
        </funding-source>
        <award-id>161003</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>KLMDASR</institution>
          </institution-wrap>
        </funding-source>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="7"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>In recent years, many experiments suggest that RNA becomes an attractive small molecule drug target to treat disease (<xref rid="btaa1092-B9" ref-type="bibr">Disney, 2019</xref>). A significant amount of efforts were made to study the interactions between RNA and small molecules, such as small molecule design (Ursu <italic toggle="yes">et al.</italic>, 2019) and detection of small molecule–RNA binding motifs (Childs-Disney <italic toggle="yes">et al.</italic>, 2018). In these studies, the preknowledge about the small molecule–RNA binding sites is essential. However, due to the high cost with wet-lab experiments, the structural details for small molecule–RNA interactions are unknown for most targets. This has motivated the development of computational algorithms to predict small molecule–RNA binding sites.</p>
    <p>The existing prediction methods can be classified into two groups: structure-based and sequence-based. Structure-based approaches include MetalionRNA (Philips <italic toggle="yes">et al.</italic>, 2012), LigandRNA (Philips <italic toggle="yes">et al.</italic>, 2013), Rsite (Zeng <italic toggle="yes">et al.</italic>, 2015) and RBind (Wang <italic toggle="yes">et al.</italic>, 2018). MetalionRNA is a statistical potential-based method but can only predict the binding sites for metal ions (magnesium, sodium and potassium). LigandRNA is a knowledge-based potential to score the interactions between RNA and small molecules. Its input includes both the RNA structure and the small molecule’s binding poses, which are ranked according to the returned potential score. Rsite is a distance-based predictor to identify the functional sites of noncoding RNAs. RBind is the latest structure-based approach by constructing a structure-based nucleotide interaction network. As revealed in <xref rid="btaa1092-B24" ref-type="bibr">Wang <italic toggle="yes">et al.</italic> (2018)</xref>, RBind has a high precision at the expense of a low recall. In contrast, there are very few sequence-based methods to predict small molecule–RNA binding sites. To the best of our knowledge, Rsite2 is the only sequence-based algorithm, which works based on predicted secondary structure (SS; <xref rid="btaa1092-B27" ref-type="bibr">Zeng and Cui, 2016</xref>).</p>
    <p>In this work, we proposed a novel algorithm named RNAsite to predict small molecule–RNA binding sites. We first developed a structure-based method (RNAsite_str) by designing a group of novel structure-based features that effectively captured the preference toward small molecule–RNA binding sites. Second, a sequence profile-based predictor (RNAsite_seq) was designed to deal with the cases where no structure is available. These two methods are combined, yielding to the final approach RNAsite. Experiments on two independent test sets show that RNAsite is competitive compared with the state-of-the-art methods.</p>
  </sec>
  <sec>
    <title>2 Materials and methods</title>
    <sec>
      <title>2.1 Benchmark datasets</title>
      <p>Two datasets were used to assess and compare the proposed method with existing methods. The first one contains 19 RNAs from the work of RBind (Wang <italic toggle="yes">et al.</italic>, 2018) (denoted by RB19). This dataset was constructed based on the 251 structures in the work of LigandRNA (Philips <italic toggle="yes">et al.</italic>, 2013) after filtering structures with simple helix topology, remaining 22 structures. In addition, three RNAs with more than one chain or pseudoknot interactions were further removed to enable the structure prediction by the RNAComposer program (Biesiada <italic toggle="yes">et al.</italic>, 2016).</p>
      <p>The second was constructed in this work from the Protein Data Bank (PDB) (Burley <italic toggle="yes">et al.</italic>, 2019) according to the following procedure. First, in order to exclude the effects of other molecules (such as DNA, protein and so on), we downloaded the complex structures containing only RNAs with one or more small molecules (water was not considered). In total, we obtained 1673 RNA chains. Second, the following RNAs were removed: chain length is &lt;20 or &gt;1500; all small molecules in the structure are crystallization additives [a comprehensive list of crystallization additives was obtained from BioliP (Yang <italic toggle="yes">et al.</italic>, 2012)]; no small molecules interact with the RNA structure. A nucleotide is defined as interacting with a small molecule if one of the atomic distances between the nucleotide and the small molecule is smaller than a specified distance cutoff (4 Å), as adopted in the work of RBind. Such nucleotides are defined as positive samples and others are defined as negative samples. 712 RNA chains remained after the above filtering.</p>
      <p>Redundancy was removed for the above 712 RNA chains based on a combination of structure and sequence similarity clustering. First, the pairwise structure similarity TM-score<sub>RNA</sub> was calculated with the program RNA-align (Gong <italic toggle="yes">et al.</italic>, 2019). If the TM-score<sub>RNA</sub> between two RNA structures is higher than 0.3, the one with the higher ratio of positive samples is kept (defined as the total number of positive samples in an RNA divided by the sequence length). For example, 22 structures sharing &gt;0.3 structure similarity belong to the thiamin pyrophosphate riboswitches and only one of them is kept to remove redundancy. A total of 78 RNA chains was retained after this structure-similarity based filtering (denote by RB78). About 3/4 of the 78 RNA chains are used for training and the remaining 1/4 are for test. However, to make sure there is no redundancy between the training and the test set, a sequence-based clustering was performed. The 78 RNA sequences were then clustered into 57 clusters at 30% sequence similarity with cd-hit-est (<xref rid="btaa1092-B15" ref-type="bibr">Li and Godzik, 2006</xref>) and BLASTclust (Altschul <italic toggle="yes">et al.</italic>, 1990) program. The split of these RNAs was based on the cluster information: 42 clusters containing 60 RNAs were used as training set (denoted by TR60) and 15 clusters containing 18 RNAs were used as independent test set (denoted by TE18). Due to the different procedure used above and the PDB update, 65 new structures are included in RB78 compared with RB19. In addition, 9 (resp. 4) structures from TR60 (resp. TE18) are the same as the structures in RB19. The detailed information about the RNA and the ligands in each RNA structure is available in Tables S1, S2 and S3.</p>
    </sec>
    <sec>
      <title>2.2 Overview of our prediction model</title>
      <p>As shown in <xref rid="btaa1092-F1" ref-type="fig">Figure 1</xref>, the proposed method, RNAsite, is composed of two independent components: a sequence-based module RNAsite_seq and a structure-based module RNAsite_str. When no structure is available, only RNAsite_seq is used to predict the binding nucleotides. When structure is available, additional prediction is done by RNAsite_str. In addition, the prediction from RNAsite_seq is added into the structure-based features and then fed into the random forest (RF) algorithm to make a consensus prediction in RNAsite, which shows improved performance over both RNAsite_str and RNAsite_seq.</p>
      <fig position="float" id="btaa1092-F1">
        <label>Fig. 1.</label>
        <caption>
          <p>The flowchart of RNAsite for small molecule–RNA binding sites prediction. RNAsite consists of two components, RNAsite_str and RNAsite_seq, which are structure- and sequence-based predictors, respectively. In RNAsite_str, based on the topological features and the LN of the structure, three groups of descriptors were obtained. In RNAsite_seq, the query sequence is searched against a sequence database (nt) with the BLASTN program to construct an MSA, from which conservation-based features are then designed. The prediction by RNAsite_seq is used as a feature, together with the structure-based features set in RNAsite. The classifiers for small molecule-binding sites prediction are trained with the RF algorithm</p>
        </caption>
        <graphic xlink:href="btaa1092f1" position="float"/>
      </fig>
    </sec>
    <sec>
      <title>2.3 Sequence-based method RNAsite_seq</title>
      <p>The RNA sequence is searched by BLASTN (Altschul <italic toggle="yes">et al.</italic>, 1990) with <italic toggle="yes">E</italic>-value &lt;0.001 against the NCBI’s nonredundant nucleotide sequence database (nt) to construct a multiple sequence alignment (MSA). The evolutionary conservation of each position in the RNA sequence is calculated from the MSA as follows. First, a weight is assigned to each of the sequence in the MSA based on a similar idea of the Henikoff–Henikoff scheme (<xref rid="btaa1092-B12" ref-type="bibr">Henikoff and Henikoff, 1994</xref>). For the <italic toggle="yes">j</italic>th position in the <italic toggle="yes">i</italic>th sequence of the MSA, a score <italic toggle="yes">w<sub>ij</sub></italic> is calculated as follows:</p>
      <p><inline-formula id="IE1"><mml:math id="IM1" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mo>×</mml:mo><mml:mi>f</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo></mml:mrow></mml:math></inline-formula>   (1)</p>
      <p>where <italic toggle="yes">f<sub>j</sub></italic> is an integer indicating the number of occurring types of nucleotides at this position (≤4); <italic toggle="yes">N<sub>ij</sub></italic> represents the type of nucleotide at the <italic toggle="yes">j</italic>th position of the <italic toggle="yes">i</italic>th sequence; <italic toggle="yes">f</italic>(<italic toggle="yes">N<sub>ij</sub></italic>) is the number of the nucleotide <italic toggle="yes">N<sub>ij</sub></italic> in the <italic toggle="yes">j</italic>th column of the MSA; second, the weight <italic toggle="yes">w<sub>i</sub></italic> for each sequence in the MSA is calculated according to Eq. (2) as follows:</p>
      <p><inline-formula id="IE2"><mml:math id="IM2" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mi>j</mml:mi></mml:munder><mml:mrow><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow><mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:mfrac><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo></mml:mrow></mml:math></inline-formula>   (2)</p>
      <p>For each position in the RNA sequence, the weighted count for each nucleotide (gap included) is used as an evolutionary conservation score. As the nucleotides in an RNA are not independent with each other, to encode the <italic toggle="yes">i</italic>th nucleotide, its neighbors inside a window (size <italic toggle="yes">w</italic>) on each side are also considered. Thus, the total number of features for representing a nucleotide in RNAsite_seq is (2 × <italic toggle="yes">w</italic>+1) × 5. These features are fed into the RF algorithm for training and test.</p>
    </sec>
    <sec>
      <title>2.4 Structure-based method RNAsite_str</title>
      <p>When the structure (either experimentally solved or modeled) of an RNA is available, three different sets of structural descriptors are extracted, based on the topological features and the Laplacian norm (LN) of the structure. To our knowledge, the LN is applied to small molecule–RNA binding sites prediction for the first time. The traditional solvent accessibility (SA)-based features are also used here. Let <italic toggle="yes">L</italic> denote the number of nucleotides in an RNA.</p>
      <sec>
        <title>2.4.1 Laplacian norm</title>
        <p>The LN has been applied to protein structure analysis (<xref rid="btaa1092-B5" ref-type="bibr">Bonnel and Marteau, 2012</xref>; Li <italic toggle="yes">et al.</italic>, 2014) and function prediction (Liu and Liu, 2020; Sun <italic toggle="yes">et al.</italic>, 2016). Here, we apply the LN to characterize RNA structures. The LN of each nucleotide is defined as the distance between a target nucleotide and the weighted center of its surrounding nucleotides. For convenience, the ‘C3’ atom is used as the representative of each nucleotide for all standard nucleotides. While for nonstandard nucleotides, an arbitrary heavy atom is used. In order to compute LN, a discrete Laplace operator is calculated using a Gaussian kernel defined as follows:</p>
        <p><inline-formula id="IE3"><mml:math id="IM3" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mo>Ω</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mo>σ</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mtable><mml:mtr><mml:mtd><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mo> </mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mrow><mml:mo>‖</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mrow/></mml:mrow><mml:mo>‖</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mtext>if</mml:mtext><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>−</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:mo>&gt;</mml:mo><mml:mn>1</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mn>0</mml:mn><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mtext>otherwise</mml:mtext></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow></mml:math></inline-formula>  (3)</p>
        <p>where <italic toggle="yes">p<sub>i</sub></italic> and <italic toggle="yes">p<sub>j</sub></italic> are the coordinate vectors for nucleotides <italic toggle="yes">i</italic> and <italic toggle="yes">j</italic>, respectively; ‖ ‖ is the <italic toggle="yes">L</italic><sub>2</sub> norm. The parameter <italic toggle="yes">σ</italic> in the Gaussian kernel is a scale factor. Under a given scale factor <italic toggle="yes">σ</italic>, the closer the two nucleotides are, the higher the Laplace operator is. And the Laplace operator decreases rapidly as the distance increases. Therefore, to highlight the distribution pattern of sequentially distant residues, the adjacent nucleotides are omitted when defining the discrete Laplace operator. By varying <italic toggle="yes">σ</italic>, the topology of a nucleotide can be described at various scales. A low <italic toggle="yes">σ</italic> measures deformation of each nucleotide locally and implies that only spatially close nucleotides will be considered in the computation of the Laplace operator. On the other hand, a high <italic toggle="yes">σ</italic> implies that more nucleotides in the RNA will be included. Here, the Laplace operators can be considered as the weights of surrounding nucleotides. Hence, the LN of each nucleotide at a given <italic toggle="yes">σ</italic> is defined as follows:</p>
        <p><inline-formula id="IE4"><mml:math id="IM4" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mtext>LN</mml:mtext></mml:mrow></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mo>σ</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:mo>‖</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo><mml:mi>j</mml:mi><mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>−</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:mo>&gt;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mo>×</mml:mo><mml:msub><mml:mrow><mml:mo>Ω</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mo>σ</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo><mml:mi>j</mml:mi><mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>−</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:mo>&gt;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mrow><mml:msub><mml:mrow><mml:mo>Ω</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mo>σ</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mrow><mml:mo>‖</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>  (4)</p>
        <p>The value of LN can reflect the geometrical features of surface convexity/concavity. A high value of LN means the nucleotide position is convex in the RNA structure, while a low LN implies a concave position. The distances at 0, 1/4, 1/2, 3/4 and 1 quantile positions of this distribution are chosen as the scale factors. The complete distributions of LN are shown in <xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S1</xref>. Thus, each nucleotide is encoded into a five-dimensional vector.</p>
      </sec>
      <sec>
        <title>2.4.2 Topological features</title>
        <p>For each RNA structure, we transform it into a nucleotide interaction network in which a node denotes a single nucleotide and an edge represents the existence of noncovalent interaction. In our definition, two nonconsecutive nucleotides in a sequence are connected in the network when they contain a pair of heavy atoms, one from each nucleotide, within the distance of 8 Å (Alipanahi <italic toggle="yes">et al.</italic>, 2015; Wang <italic toggle="yes">et al.</italic>, 2018). For each nucleotide, two network parameters are calculated: closeness (CL) assessing its global importance in the network and degree (DG) representing its local connectivity. CL is computed as the inverse of the average of the shortest distance to other nodes, while DG is the number of edges associated with the node. Note that similar features have been used in the work of RBind (Wang <italic toggle="yes">et al.</italic>, 2018) and more information can be found there for the calculation of these two features.</p>
      </sec>
      <sec>
        <title>2.4.3 Solvent accessibility</title>
        <p>The last group of structural features we used is the SA. Each chain structure was submitted to the POPS package (Cavallo <italic toggle="yes">et al.</italic>, 2003) with the probe diameter of 1.5 Å to calculate all nucleotide-specific accessible surface areas (ASAs).</p>
        <p>In addition to the above structural features, we also tested the effect of using SS including base-stacking, base-pairing and bulges computed by Lu <italic toggle="yes">et al.</italic> (2015). However, the prediction performance did not improve by adding the SS feature (seen in <xref rid="btaa1092-F3" ref-type="fig">Figure 3</xref>). Thus, SS was not used in our method. More discussion about this is available in Section 3.2.</p>
        <p>To summarize, a total of eight structural features were obtained. These features were linearly scaled to the range of [−1, 1] to make them comparable between different RNAs. Similar to RNAsite_seq, a sliding widow was used to incorporate the effects of neighboring nucleotides, resulting in a total of (2 × <italic toggle="yes">w</italic> + 1) × 8 features, which were fed into RF for training and test.</p>
      </sec>
    </sec>
    <sec>
      <title>2.5 Statistical analysis of structural features</title>
      <p>We performed a systematic comparison of the positive (the native small molecule–RNA binding sites) and negative samples of all structural features derived from structures on the dataset RB78. <xref rid="btaa1092-F2" ref-type="fig">Figure 2A</xref> shows that the LNs of positive samples are consistently lower than those of negative samples from local to global scales, indicating that small molecule-binding nucleotides prefer relatively concave locations in RNA structures. In <xref rid="btaa1092-F2" ref-type="fig">Figure 2B</xref>, the positive samples possess clearly higher CL values than the negative samples. A similar tendency holds for DG. This result indicates that small molecule-binding nucleotides mostly locate in the center of the distance-based nucleotides interaction networks and they physically interact with more nucleotides. The ASAs of the positive nucleotides are lower than the negative sites, probably because lower ASA values correspond to concave positions. Overall, the proposed features show discriminative characteristics between positive and negative samples.</p>
      <fig position="float" id="btaa1092-F2">
        <label>Fig. 2.</label>
        <caption>
          <p>Comparison of the distributions of the proposed structural features for small molecule-binding (gray bars) and nonbinding (white bars) nucleotides. (<bold>A</bold>) LN, (<bold>B</bold>) other features: CL, DG and SA. Each box plot consists of three parts: center of the data sample (bar), margin values (the ordinate values of the two short horizontal lines) and outliers (discrete points outside the margin values). Each bar contains 50% of the data in the middle of the sample and it consists three key values: median (short line in the middle of the bar), the upper quartile (short line at the top of the bar) and the lower quartile (short line at the bottom of the bar) of the sample data</p>
        </caption>
        <graphic xlink:href="btaa1092f2" position="float"/>
      </fig>
    </sec>
    <sec>
      <title>2.6 Model construction and performance evaluation</title>
      <p>In this work, we conducted five-fold cross validation (CV) on the training set and independent tests to evaluate our method. Due to random effects in RF, the CV was repeated 100 times and the average was reported. The Precision, Recall, Mathews correlation coefficient (MCC) and the area under the receiver operating characteristic curve (AUC) were used to assess the performance.</p>
    </sec>
  </sec>
  <sec>
    <title>3 Results and discussions</title>
    <sec>
      <title>3.1 Parameters optimization</title>
      <p>All parameters including the sliding window size <italic toggle="yes">w</italic> and the number of trees <italic toggle="yes">n</italic> in RF were tuned to maximize the MCC on the training set TR60 based on five-fold CV. For the training set TR60, the samples were randomly divided into five subgroups. Four of them were used for training and the remaining one was used for test. The five-fold CV was repeated 100 times and the average was reported. To speed up the optimization, the number of trees was first fixed to 100 when optimizing the window size <italic toggle="yes">w</italic>. After the optimal window size was determined, a coarse-grid search was performed to optimize <italic toggle="yes">n</italic>.</p>
      <p>The influence of <italic toggle="yes">n</italic> in RF to the performance of RNAsite_str is shown in <xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S2</xref>. From the figure, we can see that the MCC is the lowest (0.2), when <italic toggle="yes">n</italic> is set to the default value 10. When <italic toggle="yes">n</italic> increases to 100, the MCC improves to 0.276 and becomes stable thereafter. Thus, the optimal value for <italic toggle="yes">n</italic> in RF was finally set to 100.</p>
      <p><xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S3</xref> shows the influence of the window size to the performance of RNAsite_str. The lowest MCC of 0.225 is obtained when the window size is zero, i.e. no neighboring nucleotides are used. When the window size is enlarged to 14, the MCC reaches the highest value (0.276). Hence, the optimal window size of RNAsite_str is set to 14. Similarly, the optimal window size of RNAsite_seq is set to 12 (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S4</xref>). When the structure information is available, the final features used in RNAsite include the structural features and the prediction from RNAsite_seq. Therefore, the optimal window size of RNAsite is reoptimized. <xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S5</xref> shows the best window size for RNAsite is 16. For the sake of generality, these values are also used for the two independent test datasets without further optimization.</p>
    </sec>
    <sec>
      <title>3.2 Analysis of feature contribution</title>
      <p>The contribution of structural features to the method RNAsite_str was investigated based on five-fold CV on the training set TR60. The predictive quality measured by the average MCC is summarized in <xref rid="btaa1092-F3" ref-type="fig">Figure 3</xref>. It shows that the novel structural descriptors rank at the top of all individual features. LN feature achieves the best performance, yielding MCC of 0.265. To avoid overtraining and remove redundant descriptors, we adopted the greedy algorithm, i.e. sequential forward selection (SFS), to produce the optimal feature groups. The SFS started with the feature, LN, showing the highest discriminatory capability between the positive and negative samples, as revealed by MCC. We iteratively selected a new feature which has the best performance from the remaining ones. This feature is retained if its combination with the kept ones results in higher MCC. This process is halted when the MCC value does not increase. Finally, the highest MCC (0.276) is achieved when all the features except SS are used together. As shown in <xref rid="btaa1092-F3" ref-type="fig">Figure 3</xref>, the SS feature is reasonable with 0.11 MCC. However, the MCC value (0.276) does not increase when combining it with other features. This may be caused by the redundancy of the structural information between SS and other features. Statistical tests were performed to judge if the MCC improvements by the combined feature groups are significant or not, similar to the procedure used in <xref rid="btaa1092-B18" ref-type="bibr">Meng <italic toggle="yes">et al.</italic> (2018)</xref> and Su <italic toggle="yes">et al.</italic> (2019). The <italic toggle="yes">P</italic>-values for the tests are shown in <xref rid="sup1" ref-type="supplementary-material">Table S7</xref>. It indicates that the improvements by combining more feature groups except SS are significant at <italic toggle="yes">P</italic>-value &lt;0.05. These data support the conclusion that these feature groups are in general complementary to each other. Therefore, the RNAsite_str was modeled with all structural features except SS.</p>
      <fig position="float" id="btaa1092-F3">
        <label>Fig. 3.</label>
        <caption>
          <p>Predictive performance of RNAsite_str on TR60 from different feature groups. The features are divided into nine categories: five individual groups, (1) SS, (2) SA, (3) DG, (4) CL, (5) LN; four combined feature groups: (6) LN + CL, (7) LN + CL + DG, (8) LN + CL + DG + SA and (9) ALL (i.e. LN + CL + DG + SA + SS)</p>
        </caption>
        <graphic xlink:href="btaa1092f3" position="float"/>
      </fig>
    </sec>
    <sec>
      <title>3.3 Comparison with existing methods</title>
      <p>RBind and Rsite are two structure-based methods for small molecule-binding nucleotides prediction (Wang <italic toggle="yes">et al.</italic>, 2018; Zeng <italic toggle="yes">et al.</italic>, 2015). Rsite2 is an SS-based computational prediction to identify the potential functional sites in RNA molecules (<xref rid="btaa1092-B27" ref-type="bibr">Zeng and Cui, 2016</xref>). To demonstrate the effectiveness and robustness of the proposed method, we assessed the performance of our method with existing publicly available methods on two independent datasets, TE18 and RB19. We used the standalone programs RBind (<ext-link xlink:href="http://zhaolab.com.cn/RBind" ext-link-type="uri">http://zhaolab.com.cn/RBind</ext-link>), Rsite and Rsite2 (<ext-link xlink:href="http://www.cuilab.cn/rsite" ext-link-type="uri">http://www.cuilab.cn/rsite</ext-link>) to collect the corresponding predictions of two test sets. RNAsite obtained a very high accuracy when directly applying the model trained on TR60 to make prediction on RB19. This is likely because 12 RNAs in the training set TR60 share &gt;80% sequence identity with the RNAs in RB19. To deal with this issue, the leave-one-out test was applied on RB19 to evaluate the accuracy.</p>
      <p>When experimental structures are used, <xref rid="btaa1092-F4" ref-type="fig">Figure 4</xref> presents the MCC and AUC, the two most objective metrics, on both datasets. The results for other metrics are listed in <xref rid="sup1" ref-type="supplementary-material">Tables S4 and S5</xref>. The figure shows that the sequence-based predictor RNAsite_seq has slightly lower MCC values than structure-based predictor RNAsite_str on both datasets, suggesting the importance of structure-based descriptors. The combination of both methods in RNAsite yields improved MCC to 0.253 and 0.567 on TE18 and RB19, respectively, both higher than other methods. Similar observations can be obtained based on the AUC data in <xref rid="btaa1092-F4" ref-type="fig">Figure 4</xref>. We note that the AUC values for RBind are even lower than our sequence-based predictor RNAsite_seq on both datasets. This is maybe because the prediction by RBind is in binary rather than probability format, which is necessary for AUC calculation. In addition, Tables S4 and S5 show RNAsite has comparable precision with RBind but much higher recall on both datasets.</p>
      <fig position="float" id="btaa1092-F4">
        <label>Fig. 4.</label>
        <caption>
          <p>The MCC and AUC of all compared methods with the input of experimental structure. (<bold>A</bold>) and (<bold>C</bold>) the respective MCC and AUC for the dataset TE18, while (<bold>B</bold>) and (<bold>D</bold>) are for the dataset RB19</p>
        </caption>
        <graphic xlink:href="btaa1092f4" position="float"/>
      </fig>
      <p>As many RNAs do not have experimentally solved structures, we tested our methods on predicted structure models. The RNAComposer server (Biesiada <italic toggle="yes">et al.</italic>, 2016) was used to predict the structure for each RNA in the test datasets TE18 and RB19. First, we calculated the accuracy of the predicted structures, measured by the full-chain root-mean-square deviation (RMSD) (called global RMSD) and RMSD for the small molecule-binding residues (called local RMSD). <xref rid="btaa1092-F5" ref-type="fig">Figure 5</xref> and <xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S6</xref> show that the predicted structure models have reasonable accuracy. For the dataset TE18, the average global and local RMSDs are 11.732 and 7.469 Å, respectively. There are 11 models with local RMSD &lt;7 Å. The predicted models for the RB19 dataset have higher accuracy with global average global and local RMSDs are 9.042 and 7.014 Å, respectively. As shown in <xref rid="btaa1092-T1" ref-type="table">Table 1</xref>, the accuracies for all methods decrease when the modeled structures are used. In spite of this, our methods outperform other methods when the same set of predicted models are used. Statistical tests indicate that the improvement of all our methods over existing methods is significant at the level of 0.05, with detailed data in <xref rid="sup1" ref-type="supplementary-material">Tables S8 and S9</xref>.</p>
      <fig position="float" id="btaa1092-F5">
        <label>Fig. 5.</label>
        <caption>
          <p>RMSD distributions of the predicted structure models on TE18 (<bold>A</bold>) and RB19 (<bold>B</bold>). Each pie chart is divided into two equal parts, to present the global and local RMSD distributions, respectively. The RMSD values are divided into four intervals: 0–2, 2–7, 7–15 and 15–30 Å</p>
        </caption>
        <graphic xlink:href="btaa1092f5" position="float"/>
      </fig>
      <table-wrap position="float" id="btaa1092-T1">
        <label>Table 1.</label>
        <caption>
          <p>MCC and AUC of our methods and other existing methods with input of predicted structures</p>
        </caption>
        <table frame="hsides" rules="groups">
          <colgroup span="1">
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="char" char="." span="1"/>
            <col valign="top" align="char" char="." span="1"/>
            <col valign="top" align="char" char="." span="1"/>
            <col valign="top" align="char" char="." span="1"/>
          </colgroup>
          <thead>
            <tr>
              <th rowspan="2" colspan="1">Methods</th>
              <th colspan="2" rowspan="1">TE18<hr/></th>
              <th colspan="2" rowspan="1">RB19<hr/></th>
            </tr>
            <tr>
              <th rowspan="1" colspan="1">MCC</th>
              <th rowspan="1" colspan="1">AUC</th>
              <th rowspan="1" colspan="1">MCC</th>
              <th rowspan="1" colspan="1">AUC</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td rowspan="1" colspan="1">Rsite2</td>
              <td rowspan="1" colspan="1">0.01</td>
              <td rowspan="1" colspan="1">0.474</td>
              <td rowspan="1" colspan="1">0.099</td>
              <td rowspan="1" colspan="1">0.529</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Rsite</td>
              <td rowspan="1" colspan="1">0.055</td>
              <td rowspan="1" colspan="1">0.496</td>
              <td rowspan="1" colspan="1">0.051</td>
              <td rowspan="1" colspan="1">0.496</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">RBind</td>
              <td rowspan="1" colspan="1">0.141</td>
              <td rowspan="1" colspan="1">0.540</td>
              <td rowspan="1" colspan="1">0.187</td>
              <td rowspan="1" colspan="1">0.558</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">RNAsite_seq</td>
              <td rowspan="1" colspan="1">0.16</td>
              <td rowspan="1" colspan="1">0.641</td>
              <td rowspan="1" colspan="1">0.508</td>
              <td rowspan="1" colspan="1">0.801</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">RNAsite_str</td>
              <td rowspan="1" colspan="1">0.185</td>
              <td rowspan="1" colspan="1">0.695</td>
              <td rowspan="1" colspan="1">0.445</td>
              <td rowspan="1" colspan="1">0.806</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">RNAsite</td>
              <td rowspan="1" colspan="1">0.186</td>
              <td rowspan="1" colspan="1">0.703</td>
              <td rowspan="1" colspan="1">0.526</td>
              <td rowspan="1" colspan="1">0.834</td>
            </tr>
          </tbody>
        </table>
      </table-wrap>
      <p>In addition, we compared our method with two other methods, which are not designed for small molecule-binding site prediction but are related with RNA-small molecule binding. The first one is Weinreb’s method (denoted by DCA) (Weinreb <italic toggle="yes">et al.</italic>, 2016), which predicts the intern-ucleotide interactions based on direct coupling analysis (DCA). This comparison is based on the fact that nucleotides contributing to an interface with other molecules would be under selective pressure. We installed and ran the method DCA locally with MSA input for each RNA in our test set TE18. The top predicted nucleotide pairs are considered as binding sites. However, it only returned predictions for four RNAs. On these four RNAs, DCA has a higher recall at the expense of lower precision, resulting to very low MCC and AUC (<xref rid="sup1" ref-type="supplementary-material">Table S10</xref>).</p>
      <p>The second one is InfoRNA (Disney <italic toggle="yes">et al.</italic>, 2016), which is for RNA motif mining by comparing the target RNA sequence against a database of known RNA motif small molecule-binding partners. The nucleotides in the returned RNA motif are regarded as the small molecule-binding sites. InfoRNA only returned results for seven RNAs. On these RNAs, InfoRNA does not perform well compared with our method (<xref rid="sup1" ref-type="supplementary-material">Table S11</xref>). This is probably because the main purpose of InfoRNA is for the design of small molecule targeting RNA rather than binding site prediction.</p>
    </sec>
    <sec>
      <title>3.4 Why is the accuracy on RB19 higher than that on TE18?</title>
      <p>We note that all metrics on the RB19 dataset are significantly higher than the TE18 dataset for all methods. To explain this data, we visually checked the small molecule–RNA complexes (the experimental structures) on the two test sets. In addition, the prediction by RBind rather than RNAsite was used here to make this analysis unbiased. We find that the location of small molecules in an RNA structure has a significant impact on the predictive accuracy for predicted binding sites, illustrated by two examples in <xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S7</xref>. As shown in <xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S7A</xref> (PDB ID: 1Q8N), when the small molecule is embedded in the RNA structure, the binding nucleotides in this RNA are easier to be identified, as revealed by the relatively high Precision and Recall values (1 and 0.43, respectively). On the contrary, when the small molecule is on the surface of the RNA structure, binding nucleotides are more difficult to be recognized. For example, the Precision and Recall are all 0 for the example shown in <xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S7B</xref> (PDB ID: 5BJO). Based on this observation, we divided the RNAs into two groups. A target is called a hard target when the small molecule appears on the surface of the RNA structure; and an easy target is defined when the small molecule locates in the concave region of the RNA structure. The small molecule–RNA complexes in TE18 were divided into 10 easy and 8 hard targets. For the easy targets, the MCC, Precision, Recall and AUC of RBind are 0.296, 0.867, 0.227 and 0.596, respectively, which are close to the ones on the dataset RB19. This result indicates that most of the RNAs on RB19 dataset are easy targets. In addition, the lower RMSD of the structure models for RB19 is consistent with this conclusion as well.</p>
    </sec>
    <sec>
      <title>3.5 Performance on metal ions and non-metal ion small molecules</title>
      <p>The information about the small molecules is summarized in <xref rid="sup1" ref-type="supplementary-material">Tables S1 and S2</xref>. Because the metal ions may have different properties with other non-metal ion small molecules, we divided the small molecules into two types: metal ions and non-metal ions. Based on such division, the RNA structures in the test set TE18 are divided into three subsets: metal ions only (4 structures), no metal ions (12 structures) and mixed (2 structures). RNAsite_str’s performance on these subsets is presented in <xref rid="sup1" ref-type="supplementary-material">Table S12</xref>. It suggests that the metal ions-only structures have lower accuracy than other structures. This is probably because many metal ions are often on the surface of the RNA structure and do not form well-shaped binding pockets, making it more difficult to predict. It may be also because the placement for metal ions in the RNA structure was made through computational predictions and thus could contain noises. We tried to calculate the average B-factor for the metal ions in the RNA structure but this B-factor did not seem to correlate the prediction accuracy of binding site prediction. Another possible reason is because the training structures are dominated by non-metal ion small molecules. In future, it should be worth of developing ion-specific methods, such as MetalionRNA for metal ions-binding site prediction (Philips <italic toggle="yes">et al.</italic>, 2012).</p>
    </sec>
    <sec>
      <title>3.6 Potential improvement by combining with binding pocket detection</title>
      <p>When structure information is available, it is evident to detect the binding pocket, which usually maps to the concave region in the structure. There are many binding pocket detection programs for protein structure but very few for RNA structure. To the best of our knowledge, there is only one publically available package for RNA pocket detection, i.e. Fpocket (Le Guilloux <italic toggle="yes">et al.</italic>, 2009). Fpocket detects pockets based on Voronoi tessellation and alpha spheres and it works for both protein and RNA structures.</p>
      <p>We combine the pocket detection into RNAsite to see if further improvement could be achieved. First, Fpocket returns a few binding pockets for each RNA structure, which are sorted based on the number of nucleotides. Second, the nucleotides of the target sequence are encoded by 1 if they are within the first pocket; and 0 otherwise. After combing this feature with previous ones of RNAsite, we retrained an RF-based predictor and tested it on the previous datasets. For the sake of convenience, this new predictor is named as fRNAsite. As shown in <xref rid="btaa1092-F6" ref-type="fig">Figure 6</xref>, when the native structure is used, MCC and AUC on both test sets are significantly improved in fRNAsite. This is expected as the native structures are in <italic toggle="yes">holo</italic> form with bound small molecule and geometry-based pocket detection can easily recognize the small molecule-binding regions from the <italic toggle="yes">holo</italic> structures. However, when the input structures are computational models, the pocket detection seems to be useless to improve the accuracy. This is probably because the modeled structures are in <italic toggle="yes">apo</italic> form without bound small molecule. In addition, some of the modeled structures have low resolution. In reality, this is the case for most RNAs. Thus, we did not combine pocket detection in RNAsite.</p>
      <fig position="float" id="btaa1092-F6">
        <label>Fig. 6.</label>
        <caption>
          <p>Comparison between fRNAsite and RNAsite. RNAsite<sup>m</sup> and fRANsite<sup>m</sup> represent the respective RNAsite and fRANsite with input of predicted structure model</p>
        </caption>
        <graphic xlink:href="btaa1092f6" position="float"/>
      </fig>
    </sec>
    <sec>
      <title>3.7 The impact of the dynamic feature of RNA structure</title>
      <p>As RNA molecular is usually more flexible, which was not considered in the design of our method. We tested if the consideration of the dynamic feature of RNA structure could improve our method or not here. The GROMACS package (Abraham <italic toggle="yes">et al.</italic>, 2015) was applied to perform molecular dynamics simulations to generate five alternative structural configurations for each RNA structure in the dataset RB78. The two network-based features, CL and DG, were extracted from each conformation. Hence, 10 additional structural features were added for each target. We retrained the RF models on TR60 and tested on the TE18. With these new features, we got slightly higher Recall on TE18, but lower values for other metrics (<xref rid="sup1" ref-type="supplementary-material">Table S6</xref>). Other new features may be designed to make full use of the dynamic nature of RNA structure in future.</p>
    </sec>
    <sec>
      <title>3.8 The impact of <italic toggle="yes">holo</italic> and <italic toggle="yes">apo</italic> structures</title>
      <p>When RNA bind to small molecules, there may be some conformational changes. By comparing the RNAs in the test dataset TE18 with other RNAs in PDB, we detected four RNAs that have both <italic toggle="yes">holo</italic> and <italic toggle="yes">apo</italic> structures. We evaluated the performance of RNAsite_str on these four paired structures.</p>
      <p><xref rid="btaa1092-T2" ref-type="table">Table 2</xref> shows that two RNAs (on the 2nd and the 3rd rows) have larger conformational changes, as reflected by the high RMSD values (5.05 and 1.71 Å, respectively). For these two RNAs, the MCC values decrease significantly. For the remaining two RNAs (on the 4th and the 5th rows), the conformational changes are relatively low (RMSD &lt;1 Å). For the third RNA, its MCC values are very low for both the <italic toggle="yes">holo</italic> (379 dB) and the <italic toggle="yes">apo</italic> (1mmeB) structures. For the last RNA, the MCC for the <italic toggle="yes">holo</italic> structure (2misA) is 1, which decreases for the <italic toggle="yes">apo</italic> structure but is still reasonable (0.752). To summarize, the accuracy for binding residues prediction for <italic toggle="yes">holo</italic> structures is usually higher than the <italic toggle="yes">apo</italic> structures. This is probably because our prediction model was trained on <italic toggle="yes">holo</italic> structures only. Extended training on both <italic toggle="yes">holo</italic> and <italic toggle="yes">apo</italic> structures should be helpful for improving the binding residues prediction accuracy on <italic toggle="yes">apo</italic> structures, which will be investigated in future work.</p>
      <table-wrap position="float" id="btaa1092-T2">
        <label>Table 2.</label>
        <caption>
          <p>MCC of RNAsite_str for four RNAs from the test set TE18 that have <italic toggle="yes">apo</italic> and <italic toggle="yes">holo</italic> structures</p>
        </caption>
        <table frame="hsides" rules="groups">
          <colgroup span="1">
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="char" char="." span="1"/>
            <col valign="top" align="center" span="1"/>
            <col valign="top" align="char" char="." span="1"/>
          </colgroup>
          <thead>
            <tr>
              <th rowspan="2" colspan="1">PDB ID</th>
              <th rowspan="2" colspan="1">RMSD (Å)</th>
              <th colspan="2" rowspan="1">Conformation<hr/></th>
            </tr>
            <tr>
              <th rowspan="1" colspan="1">
                <italic toggle="yes">holo</italic>
              </th>
              <th rowspan="1" colspan="1">
                <italic toggle="yes">apo</italic>
              </th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td rowspan="1" colspan="1">430dA (1sclA)</td>
              <td rowspan="1" colspan="1">5.05</td>
              <td rowspan="1" colspan="1">1</td>
              <td rowspan="1" colspan="1">0.033</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">2jukA (1pjyA)</td>
              <td rowspan="1" colspan="1">1.71</td>
              <td rowspan="1" colspan="1">0.436</td>
              <td rowspan="1" colspan="1">0.27</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">379dB (1mmeB)</td>
              <td rowspan="1" colspan="1">0.91</td>
              <td rowspan="1" colspan="1">0.031</td>
              <td rowspan="1" colspan="1">0.011</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">2misA (2l5zA)</td>
              <td rowspan="1" colspan="1">0.64</td>
              <td rowspan="1" colspan="1">1</td>
              <td rowspan="1" colspan="1">0.752</td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <fn id="tblfn1">
            <p><italic toggle="yes">Note</italic>: The PDB IDs outside/inside the brackets are for the holo/<italic toggle="yes">apo</italic> structures.</p>
          </fn>
        </table-wrap-foot>
      </table-wrap>
    </sec>
  </sec>
  <sec>
    <title>4 Conclusions</title>
    <p>We presented a new method RNAsite for small molecule–RNA binding sites prediction by combining sequence and structure information. The sequence-based features are obtained based on sequence profile, reflecting position-specific evolutionary conservation of nucleotides. The structure-based features include LN, nucleotides interaction network-based topological features and SA. RNAsite was shown to be competitive with the state-of-the-art methods on two independent test sets. When predicted structure models were used, RNAsite outperforms other methods by a large margin, probably due to its combination of sequence- and structure-based descriptors. We explored the possibility of improving RNAsite by geometry-based binding pocket detection. It suggests that RNAsite can be enhanced by the inclusion of pocket detection for experimental structures. However, for predicted structure models, pocket detection does not contribute to RNAsite. In addition, we also considered and discussed the influence of conformational flexibility and conformational changes caused by ligand binding on RNAsite.</p>
  </sec>
  <sec>
    <title>Funding</title>
    <p>This work has been supported by the National Natural Science Foundation of China (NSFC 11871290 and 61873185), Fok Ying-Tong Education Foundation (161003) and KLMDASR.</p>
  </sec>
  <sec>
    <title> </title>
    <p><italic toggle="yes">Conflict of Interest</italic>: none declared.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="sup1" position="float" content-type="local-data">
      <label>btaa1092_Supplementary_Data</label>
      <media xlink:href="btaa1092_supplementary_data.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="btaa1092-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Abraham</surname><given-names>M.J.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2015</year>) 
<article-title>GROMACS: high performance molecular simulations through multi-level parallelism from laptops to supercomputers</article-title>. <source>SoftwareX</source>, <volume>1–2</volume>, <fpage>19</fpage>–<lpage>25</lpage>.</mixed-citation>
    </ref>
    <ref id="btaa1092-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Alipanahi</surname><given-names>B.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2015</year>) 
<article-title>Predicting the sequence specificities of DNA- and RNA-binding proteins by deep learning</article-title>. <source>Nat. Biotechnol</source>., <volume>33</volume>, <fpage>831</fpage>–<lpage>838</lpage>.<pub-id pub-id-type="pmid">26213851</pub-id></mixed-citation>
    </ref>
    <ref id="btaa1092-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Altschul</surname><given-names>S.F.</given-names></string-name></person-group>  <etal>et al</etal> (<year>1990</year>) 
<article-title>Basic local alignment search tool</article-title>. <source>J. Mol. Biol</source>., <volume>215</volume>, <fpage>403</fpage>–<lpage>410</lpage>.<pub-id pub-id-type="pmid">2231712</pub-id></mixed-citation>
    </ref>
    <ref id="btaa1092-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Biesiada</surname><given-names>M.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2016</year>) 
<article-title>Automated RNA 3D structure prediction with RNAComposer</article-title>. <source>Methods Mol. Biol</source>., <volume>1490</volume>, <fpage>199</fpage>–<lpage>215</lpage>.<pub-id pub-id-type="pmid">27665601</pub-id></mixed-citation>
    </ref>
    <ref id="btaa1092-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Bonnel</surname><given-names>N.</given-names></string-name>, <string-name><surname>Marteau</surname><given-names>P.F.</given-names></string-name></person-group> (<year>2012</year>) 
<article-title>LNA: fast protein structural comparison using a Laplacian characterization of tertiary structure</article-title>. <source>IEEE/ACM Trans. Comput. Biol. Bioinform</source>., <volume>9</volume>, <fpage>1451</fpage>–<lpage>1458</lpage>.<pub-id pub-id-type="pmid">22547433</pub-id></mixed-citation>
    </ref>
    <ref id="btaa1092-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Burley</surname><given-names>S.K.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2019</year>) 
<article-title>RCSB Protein Data Bank: biological macromolecular structures enabling research and education in fundamental biology, biomedicine, biotechnology and energy</article-title>. <source>Nucleic Acids Res</source>., <volume>47</volume>, <fpage>D464</fpage>–<lpage>D474</lpage>.<pub-id pub-id-type="pmid">30357411</pub-id></mixed-citation>
    </ref>
    <ref id="btaa1092-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Cavallo</surname><given-names>L.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2003</year>) 
<article-title>POPS: a fast algorithm for solvent accessible surface areas at atomic and residue level</article-title>. <source>Nucleic Acids Res</source>., <volume>31</volume>, <fpage>3364</fpage>–<lpage>3366</lpage>.<pub-id pub-id-type="pmid">12824328</pub-id></mixed-citation>
    </ref>
    <ref id="btaa1092-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Childs-Disney</surname><given-names>J.L.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2018</year>) 
<article-title>A massively parallel selection of small molecule-RNA motif binding partners informs design of an antiviral from sequence</article-title>. <source>Chem</source>, <volume>4</volume>, <fpage>2384</fpage>–<lpage>2404</lpage>.<pub-id pub-id-type="pmid">30719503</pub-id></mixed-citation>
    </ref>
    <ref id="btaa1092-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Disney</surname><given-names>M.D.</given-names></string-name></person-group> (<year>2019</year>) 
<article-title>Targeting RNA with small molecules to capture opportunities at the intersection of chemistry, biology, and medicine</article-title>. <source>J. Am. Chem. Soc</source>., <volume>141</volume>, <fpage>6776</fpage>–<lpage>6790</lpage>.<pub-id pub-id-type="pmid">30896935</pub-id></mixed-citation>
    </ref>
    <ref id="btaa1092-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Disney</surname><given-names>M.D.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2016</year>) 
<article-title>Inforna 2.0: a platform for the sequence-based design of small molecules targeting structured RNAs</article-title>. <source>ACS Chem. Biol</source>., <volume>11</volume>, <fpage>1720</fpage>–<lpage>1728</lpage>.<pub-id pub-id-type="pmid">27097021</pub-id></mixed-citation>
    </ref>
    <ref id="btaa1092-B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Gong</surname><given-names>S.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2019</year>) 
<article-title>RNA-align: quick and accurate alignment of RNA 3D structures based on size-independent TM-scoreRNA</article-title>. <source>Bioinformatics</source>, <volume>35</volume>, <fpage>4459</fpage>–<lpage>4461</lpage>.<pub-id pub-id-type="pmid">31161212</pub-id></mixed-citation>
    </ref>
    <ref id="btaa1092-B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Henikoff</surname><given-names>S.</given-names></string-name>, <string-name><surname>Henikoff</surname><given-names>J.G.</given-names></string-name></person-group> (<year>1994</year>) 
<article-title>Position-based sequence weights</article-title>. <source>J. Mol. Biol</source>., <volume>243</volume>, <fpage>574</fpage>–<lpage>578</lpage>.<pub-id pub-id-type="pmid">7966282</pub-id></mixed-citation>
    </ref>
    <ref id="btaa1092-B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Le Guilloux</surname><given-names>V.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2009</year>) 
<article-title>Fpocket: an open source platform for ligand pocket detection</article-title>. <source>BMC Bioinform</source>., <volume>10</volume>, <fpage>168</fpage>.</mixed-citation>
    </ref>
    <ref id="btaa1092-B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Li</surname><given-names>S.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2014</year>) 
<article-title>Quantifying sequence and structural features of protein-RNA interactions</article-title>. <source>Nucleic Acids Res</source>., <volume>42</volume>, <fpage>10086</fpage>–<lpage>10098</lpage>.<pub-id pub-id-type="pmid">25063293</pub-id></mixed-citation>
    </ref>
    <ref id="btaa1092-B15">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Li</surname><given-names>W.</given-names></string-name>, <string-name><surname>Godzik</surname><given-names>A.</given-names></string-name></person-group> (<year>2006</year>) 
<article-title>Cd-hit: a fast program for clustering and comparing large sets of protein or nucleotide sequences</article-title>. <source>Bioinformatics</source>, <volume>22</volume>, <fpage>1658</fpage>–<lpage>1659</lpage>.<pub-id pub-id-type="pmid">16731699</pub-id></mixed-citation>
    </ref>
    <ref id="btaa1092-B16">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Liu</surname><given-names>H.F.</given-names></string-name>, <string-name><surname>Liu</surname><given-names>R.</given-names></string-name></person-group> (<year>2020</year>) 
<article-title>Structure-based prediction of post-translational modification cross-talk within proteins using complementary residue- and residue pair-based features</article-title>. <source>Brief. Bioinform</source>., <volume>21</volume>, <fpage>609</fpage>–<lpage>620</lpage>.<pub-id pub-id-type="pmid">30649184</pub-id></mixed-citation>
    </ref>
    <ref id="btaa1092-B17">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lu</surname><given-names>X.J.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2015</year>) 
<article-title>DSSR: an integrated software tool for dissecting the spatial structure of RNA</article-title>. <source>Nucleic Acids Res</source>., <volume>43</volume>, <fpage>e142</fpage>.<pub-id pub-id-type="pmid">26184874</pub-id></mixed-citation>
    </ref>
    <ref id="btaa1092-B18">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Meng</surname><given-names>Q.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2018</year>) 
<article-title>CoABind: a novel algorithm for coenzyme A (CoA)- and CoA derivatives-binding residues prediction</article-title>. <source>Bioinformatics</source>, <volume>34</volume>, <fpage>2598</fpage>–<lpage>2604</lpage>.<pub-id pub-id-type="pmid">29547921</pub-id></mixed-citation>
    </ref>
    <ref id="btaa1092-B19">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Philips</surname><given-names>A.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2012</year>) 
<article-title>MetalionRNA: computational predictor of metal-binding sites in RNA structures</article-title>. <source>Bioinformatics</source>, <volume>28</volume>, <fpage>198</fpage>–<lpage>205</lpage>.<pub-id pub-id-type="pmid">22110243</pub-id></mixed-citation>
    </ref>
    <ref id="btaa1092-B20">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Philips</surname><given-names>A.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2013</year>) 
<article-title>LigandRNA: computational predictor of RNA-ligand interactions</article-title>. <source>RNA</source>, <volume>19</volume>, <fpage>1605</fpage>–<lpage>1616</lpage>.<pub-id pub-id-type="pmid">24145824</pub-id></mixed-citation>
    </ref>
    <ref id="btaa1092-B21">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Su</surname><given-names>H.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2019</year>) 
<article-title>Improving the prediction of protein-nucleic acids binding residues via multiple sequence profiles and the consensus of complementary methods</article-title>. <source>Bioinformatics</source>, <volume>35</volume>, <fpage>930</fpage>–<lpage>936</lpage>.<pub-id pub-id-type="pmid">30169574</pub-id></mixed-citation>
    </ref>
    <ref id="btaa1092-B22">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Sun</surname><given-names>J.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2016</year>) 
<article-title>CRHunter: integrating multifaceted information to predict catalytic residues in enzymes</article-title>. <source>Sci. Rep</source>., <volume>6</volume>, <fpage>34044</fpage>.<pub-id pub-id-type="pmid">27665935</pub-id></mixed-citation>
    </ref>
    <ref id="btaa1092-B23">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ursu</surname><given-names>A.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2019</year>) 
<article-title>Methods to identify and optimize small molecules interacting with RNA (SMIRNAs)</article-title>. <source>Drug Disc. Today</source>, <volume>24</volume>, <fpage>2002</fpage>–<lpage>2016</lpage>.</mixed-citation>
    </ref>
    <ref id="btaa1092-B24">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wang</surname><given-names>K.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2018</year>) 
<article-title>RBind: computational network method to predict RNA binding sites</article-title>. <source>Bioinformatics</source>, <volume>34</volume>, <fpage>3131</fpage>–<lpage>3136</lpage>.<pub-id pub-id-type="pmid">29718097</pub-id></mixed-citation>
    </ref>
    <ref id="btaa1092-B25">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Weinreb</surname><given-names>C.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2016</year>) 
<article-title>3D RNA and functional interactions from evolutionary couplings</article-title>. <source>Cell</source>, <volume>165</volume>, <fpage>963</fpage>–<lpage>975</lpage>.<pub-id pub-id-type="pmid">27087444</pub-id></mixed-citation>
    </ref>
    <ref id="btaa1092-B26">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Yang</surname><given-names>J.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2012</year>) 
<article-title>BioLiP: a semi-manually curated database for biologically relevant ligand-protein interactions</article-title>. <source>Nucleic Acids Res</source>., <volume>41</volume>, <fpage>D1096</fpage>–<lpage>D1103</lpage>.<pub-id pub-id-type="pmid">23087378</pub-id></mixed-citation>
    </ref>
    <ref id="btaa1092-B27">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zeng</surname><given-names>P.</given-names></string-name>, <string-name><surname>Cui</surname><given-names>Q.</given-names></string-name></person-group> (<year>2016</year>) 
<article-title>Rsite2: an efficient computational method to predict the functional sites of noncoding RNAs</article-title>. <source>Sci. Rep</source>., <volume>6</volume>, <fpage>19016</fpage>.<pub-id pub-id-type="pmid">26751501</pub-id></mixed-citation>
    </ref>
    <ref id="btaa1092-B28">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zeng</surname><given-names>P.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2015</year>) 
<article-title>Rsite: a computational method to identify the functional sites of noncoding RNAs</article-title>. <source>Sci. Rep</source>., <volume>5</volume>, <fpage>9179</fpage>.<pub-id pub-id-type="pmid">25776805</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
