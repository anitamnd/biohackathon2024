<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1 20151215//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.1?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">6157071</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/bty344</article-id>
    <article-id pub-id-type="publisher-id">bty344</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Applications Notes</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Systems Biology</subject>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>MetaboDiff: an R package for differential metabolomic analysis</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">http://orcid.org/0000-0002-3332-9166</contrib-id>
        <name>
          <surname>Mock</surname>
          <given-names>Andreas</given-names>
        </name>
        <xref ref-type="aff" rid="bty344-aff1">1</xref>
        <xref ref-type="aff" rid="bty344-aff2">2</xref>
        <xref ref-type="aff" rid="bty344-aff3">3</xref>
        <xref ref-type="corresp" rid="bty344-cor1"/>
        <!--<email>andreas.mock@med.uni-heidelberg.de</email>-->
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Warta</surname>
          <given-names>Rolf</given-names>
        </name>
        <xref ref-type="aff" rid="bty344-aff1">1</xref>
        <xref ref-type="aff" rid="bty344-aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Dettling</surname>
          <given-names>Steffen</given-names>
        </name>
        <xref ref-type="aff" rid="bty344-aff1">1</xref>
        <xref ref-type="aff" rid="bty344-aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Brors</surname>
          <given-names>Benedikt</given-names>
        </name>
        <xref ref-type="aff" rid="bty344-aff2">2</xref>
        <xref ref-type="aff" rid="bty344-aff4">4</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Jäger</surname>
          <given-names>Dirk</given-names>
        </name>
        <xref ref-type="aff" rid="bty344-aff2">2</xref>
        <xref ref-type="aff" rid="bty344-aff3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Herold-Mende</surname>
          <given-names>Christel</given-names>
        </name>
        <xref ref-type="aff" rid="bty344-aff1">1</xref>
        <xref ref-type="aff" rid="bty344-aff2">2</xref>
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Valencia</surname>
          <given-names>Alfonso</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <aff id="bty344-aff1"><label>1</label>Division of Experimental Neurosurgery, Heidelberg University Hospital, Heidelberg, Germany</aff>
    <aff id="bty344-aff2"><label>2</label>German Cancer Consortium (DKTK), Heidelberg, Germany</aff>
    <aff id="bty344-aff3"><label>3</label>Department of Medical Oncology, National Center for Tumor Diseases (NCT), Heidelberg, Germany</aff>
    <aff id="bty344-aff4"><label>4</label>Division of Applied Bioinformatics, German Cancer Research Center (DKFZ), Heidelberg, Germany</aff>
    <author-notes>
      <corresp id="bty344-cor1">To whom correspondence should be addressed. <email>andreas.mock@med.uni-heidelberg.de</email></corresp>
    </author-notes>
    <pub-date pub-type="ppub">
      <day>01</day>
      <month>10</month>
      <year>2018</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2018-04-26">
      <day>26</day>
      <month>4</month>
      <year>2018</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>26</day>
      <month>4</month>
      <year>2018</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the <pub-date pub-type="epub"/>. -->
    <volume>34</volume>
    <issue>19</issue>
    <fpage>3417</fpage>
    <lpage>3418</lpage>
    <history>
      <date date-type="received">
        <day>07</day>
        <month>11</month>
        <year>2017</year>
      </date>
      <date date-type="rev-recd">
        <day>26</day>
        <month>2</month>
        <year>2018</year>
      </date>
      <date date-type="accepted">
        <day>24</day>
        <month>4</month>
        <year>2018</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2018. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2018</copyright-year>
      <license license-type="cc-by-nc" xlink:href="http://creativecommons.org/licenses/by-nc/4.0/">
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by-nc/4.0/">http://creativecommons.org/licenses/by-nc/4.0/</ext-link>), which permits non-commercial re-use, distribution, and reproduction in any medium, provided the original work is properly cited. For commercial re-use, please contact journals.permissions@oup.com</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="bty344.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Summary</title>
        <p>Comparative metabolomics comes of age through commercial vendors offering metabolomics for translational researchers outside the mass spectrometry field. The MetaboDiff packages aims to provide a low-level entry to differential metabolomic analysis with R by starting off with the table of metabolite measurements. As a key functionality, MetaboDiffs offers the exploration of sample traits in a data-derived metabolic correlation network.</p>
      </sec>
      <sec id="s2">
        <title>Availability and implementation</title>
        <p>The MetaboDiff R package is platform-independent, available at <ext-link ext-link-type="uri" xlink:href="http://github.com/andreasmock/MetaboDiff/">http://github.com/andreasmock/MetaboDiff/</ext-link> and released under the MIT licence. The package documentation comprises a step-by-step markdown tutorial.</p>
      </sec>
      <sec id="s3">
        <title>Supplementary information</title>
        <p><xref ref-type="supplementary-material" rid="sup1">Supplementary data</xref> are available at <italic>Bioinformatics</italic> online.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <named-content content-type="funder-name">Anni Hofmann Stiftung</named-content>
        </funding-source>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="2"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>The comparative study of the metabolism promises more direct insights about health and disease phenotypes than obtained by genomic analyses (<xref rid="bty344-B4" ref-type="bibr">Johnson <italic>et al.</italic>, 2016</xref>). However, metabolomic profiling requires ultra-high performance liquid chromatography/tandem mass spectrometry and gas chromatography/mass spectrometry. The acquisition and maintenance of this analytic setup is cost- and labor-intensive and requires expert-level knowledge in both the experimental and bioinformatical analysis. As a consequence, an increasing number of translational researchers are using the service of commercial vendors or core facilities for metabolomic profiling. The common result format researchers obtain from these vendors is a table of relative metabolic measurements that were identified through the process of peak picking and peak annotation. As much as the complexity and cost of running a metabolomics facility created the need for commercial vendors, there is a need for user-friendly computational solutions for R-using experimental biologist and bioinformaticians outside the mass spectrometry field. Comprehensive computational workflows for metabolomic analysis in R exists with the recent publication of ‘metaX’ leading the way including an extensive review of metabolomics tools since 2006 (<xref rid="bty344-B8" ref-type="bibr">Wen <italic>et al.</italic>, 2017</xref>). However, we felt that available tools are still requiring too much expert-level knowledge about the details of processing metabolomic data. To this end, we developed ‘MetaboDiff’, an open source R package for differential metabolomic analysis (<xref ref-type="fig" rid="bty344-F1">Fig. 1</xref>). The defining features what we believe makes MetaboDiff more user-friendly than previous tools are (i) the start of the analytic workflow from relative metabolic measurements, (ii) the storage of all metabolomic data within a single object, (iii) the usage of current gold standards for data imputation and normalization without the need to extensively study and compare methodologies and (iv) a step-by-step markdown tutorial.
</p>
    <fig id="bty344-F1" orientation="portrait" position="float">
      <label>Fig. 1.</label>
      <caption>
        <p>Overview of data representation and analytic workflow of ’MetaboDiff’ package. Input is the table of relative metabolic measurements. The data and all its associated metadata are stored within a ’MultiAssayExperiment’ object. After processing, the object contains the four slots raw, raw imputed, norm and norm imputed. MAE, MultiAssayExperiment; PCA, Principal Component Analysis and tSNE, <italic>t</italic>-Distributed Stochastic Neighbor Embedding</p>
      </caption>
      <graphic xlink:href="bty344f1"/>
    </fig>
  </sec>
  <sec>
    <title>2 Features and methods</title>
    <sec>
      <title>2.1 Data processing</title>
      <p>Within MetaboDiff, metabolic measurements and all related data are stored within a so called ‘MultiAssayExperiment’ object enabling the coordinated representation of multiple experiments and integrated sub-setting across experiments (<xref rid="bty344-B7" ref-type="bibr">Ramos <italic>et al.</italic>, 2017</xref>; <xref ref-type="supplementary-material" rid="sup1">Supplementary Material</xref>). All common metabolic identifiers in the dataset (HMDB, KEGG and ChEBI) are used to query the Small Molecular Pathway Database (SMPDB 2.0; <xref rid="bty344-B3" ref-type="bibr">Jewison <italic>et al.</italic>, 2014</xref>). In contrast to other high-throughput technologies, missing values are common in quantitative metabolomic datasets. <italic>K</italic>-nearest neighbor imputation is employed to minimize effects on the normality and variance of the data (<xref rid="bty344-B1" ref-type="bibr">Armitage <italic>et al.</italic>, 2015</xref>). Combined hierarchical and <italic>k</italic>-means clustering can be used to determine outliers with the option to exclude individual samples or a cluster of samples from further analysis. Lastly, variance stabilizing normalization is used to ensure that the variance remains nearly constant over the measurement spectrum (<xref rid="bty344-B2" ref-type="bibr">Huber <italic>et al.</italic>, 2002</xref>).</p>
    </sec>
    <sec>
      <title>2.2 Data analysis</title>
      <p>The data analysis section of ‘MetaboDiff’ starts by exploring the metabolome-wide difference between samples in an unsupervised fashion (see <xref rid="bty344-T1" ref-type="table">Table 1</xref> for corresponding functions). Here, principal component analysis (PCA) and t-distributed stochastic neighbor embedding (tSNE) are at hand. Differential analysis (two or more groups) for individual metabolites is performed using Student’s <italic>t</italic>-Tests or ANOVA and corrected for multiple testing. The result of the comparative analysis can be visualized by a volcano plot. As a key functionality, ‘MetaboDiff’ offers the identification and exploration of metabolic correlation modules by the ‘weighted gene co-expression network analysis’ (WGCNA; <xref rid="bty344-B5" ref-type="bibr">Langfelder and Horvath, 2008</xref>) methodology. WGCNA is not limited by the need to define <italic>a priori</italic> metabolite sets for evaluation, factors in the topology of interactions and offers the possibility to relate modules to sample traits (<xref ref-type="supplementary-material" rid="sup1">Supplementary Material</xref>).
<table-wrap id="bty344-T1" orientation="portrait" position="float"><label>Table 1.</label><caption><p>Biological questions that can be answered by MetaboDiff</p></caption><table frame="hsides" rules="groups"><colgroup span="1"><col valign="top" align="left" span="1"/><col valign="top" align="left" span="1"/></colgroup><thead><tr><th rowspan="1" colspan="1">Question</th><th align="left" rowspan="1" colspan="1">Function</th></tr></thead><tbody><tr><td rowspan="1" colspan="1">Missing measurements in dataset?</td><td rowspan="1" colspan="1"><monospace>na_heatmap</monospace></td></tr><tr><td rowspan="1" colspan="1">Outliers in dataset?</td><td rowspan="1" colspan="1"><monospace>outlier_heatmap</monospace></td></tr><tr><td rowspan="1" colspan="1">Metabolome-wide changes between samples?</td><td rowspan="1" colspan="1"><monospace>pca_plot, tsne_plot</monospace></td></tr><tr><td rowspan="1" colspan="1">Differential metabolite abundance between groups?</td><td rowspan="1" colspan="1"><monospace>diff_test</monospace></td></tr><tr><td rowspan="1" colspan="1">Differential sub-pathways between groups?</td><td rowspan="1" colspan="1"><monospace>MS_plot</monospace></td></tr><tr><td rowspan="1" colspan="1">How do metabolites relate to each other in sub-pathway?</td><td rowspan="1" colspan="1"><monospace>MOI_plot</monospace></td></tr></tbody></table></table-wrap></p>
    </sec>
  </sec>
  <sec>
    <title>3 Usage scenario and benchmarking</title>
    <p>The usability of ‘MetaboDiff’ is showcased in a case study of three datasets from a study by <xref rid="bty344-B6" ref-type="bibr">Priolo <italic>et al.</italic> (2014)</xref> and presented in the Supplementary Results. Here, a special emphasis is placed on the application and interpretation of the metabolic correlation network methodology.</p>
  </sec>
  <sec>
    <title>4 Discussion</title>
    <p>We present ‘MetaboDiff’, an R package for low-entry level differential metabolomic analysis. The functionality of the MultiAssayExperiment class opens up the possibility to incorporate other high-throughput data (e.g. expression data) from the same patient set (<xref rid="bty344-B7" ref-type="bibr">Ramos <italic>et al.</italic>, 2017</xref>). ‘MetaboDiff’ will be continously updated as new evidence about metabolomic analysis arises.</p>
  </sec>
  <sec>
    <title>Funding</title>
    <p>This work was supported by the Anni Hofmann Stiftung (CHM).</p>
    <p><italic>Conflict of Interest</italic>: none declared.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material content-type="local-data" id="sup1">
      <label>Supplementary Data</label>
      <media xlink:href="bty344_supplements.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ref-list>
    <title>References</title>
    <ref id="bty344-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Armitage</surname><given-names>E.G.</given-names></name></person-group><etal>et al</etal> (<year>2015</year>) 
<article-title>Missing value imputation strategies for metabolomics data</article-title>. <source>Electrophoresis</source>, <volume>36</volume>, <fpage>3050</fpage>–<lpage>3060</lpage>.<pub-id pub-id-type="pmid">26376450</pub-id></mixed-citation>
    </ref>
    <ref id="bty344-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Huber</surname><given-names>W.</given-names></name></person-group><etal>et al</etal> (<year>2002</year>) 
<article-title>Variance stabilization applied to microarray data calibration and to the quantification of differential expression</article-title>. <source>Bioinformatics</source>, <volume>18</volume>, <fpage>S96</fpage>–<lpage>104</lpage>.<pub-id pub-id-type="pmid">12169536</pub-id></mixed-citation>
    </ref>
    <ref id="bty344-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Jewison</surname><given-names>T.</given-names></name></person-group><etal>et al</etal> (<year>2014</year>) 
<article-title>SMPDB 2.0: big improvements to the small molecule pathway database</article-title>. <source>Nucleic Acids Res</source>., <volume>42(Database issue)</volume>, <fpage>D478</fpage>–<lpage>D484</lpage>.<pub-id pub-id-type="pmid">24203708</pub-id></mixed-citation>
    </ref>
    <ref id="bty344-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Johnson</surname><given-names>C.H.</given-names></name></person-group><etal>et al</etal> (<year>2016</year>) 
<article-title>Metabolomics: beyond biomarkers and towards mechanisms</article-title>. <source>Nat. Rev. Mol. Cell Biol</source>., <volume>17</volume>, <fpage>451</fpage>–<lpage>459</lpage>.<pub-id pub-id-type="pmid">26979502</pub-id></mixed-citation>
    </ref>
    <ref id="bty344-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Langfelder</surname><given-names>P.</given-names></name>, <name name-style="western"><surname>Horvath</surname><given-names>S.</given-names></name></person-group> (<year>2008</year>) 
<article-title>WGCNA: an R package for weighted correlation network analysis</article-title>. <source>BMC Bioinformatics</source>, <volume>9</volume>, <fpage>559.</fpage><pub-id pub-id-type="pmid">19114008</pub-id></mixed-citation>
    </ref>
    <ref id="bty344-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Priolo</surname><given-names>C.</given-names></name></person-group><etal>et al</etal> (<year>2014</year>) 
<article-title>AKT1 and MYC induce distinctive metabolic fingerprints in human prostate cancer</article-title>. <source>Cancer Res</source>., <volume>74</volume>, <fpage>7198</fpage>–<lpage>7204</lpage>.<pub-id pub-id-type="pmid">25322691</pub-id></mixed-citation>
    </ref>
    <ref id="bty344-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Ramos</surname><given-names>M.</given-names></name></person-group><etal>et al</etal> (<year>2017</year>) 
<article-title>Software for the integration of multi-omics experiments in bioconductor</article-title>. <source>Cancer Res.</source>, <volume>77</volume>, <fpage>e39</fpage>–<lpage>e42</lpage>.<pub-id pub-id-type="pmid">29092936</pub-id></mixed-citation>
    </ref>
    <ref id="bty344-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Wen</surname><given-names>B.</given-names></name></person-group><etal>et al</etal> (<year>2017</year>) 
<article-title>metaX: a flexible and comprehensive software for processing metabolomics data</article-title>. <source>BMC Bioinformatics</source>, <volume>18</volume>, <fpage>1</fpage>–<lpage>14</lpage>.<pub-id pub-id-type="pmid">28049414</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
