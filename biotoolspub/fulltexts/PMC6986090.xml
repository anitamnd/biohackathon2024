<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Genomics</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Genomics</journal-id>
    <journal-title-group>
      <journal-title>BMC Genomics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2164</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">6986090</article-id>
    <article-id pub-id-type="publisher-id">6486</article-id>
    <article-id pub-id-type="doi">10.1186/s12864-020-6486-3</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>QuantTB – a method to classify mixed <italic>Mycobacterium tuberculosis</italic> infections within whole genome sequencing data</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Anyansi</surname>
          <given-names>Christine</given-names>
        </name>
        <address>
          <email>c.a.anyansi@tudelft.nl</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Keo</surname>
          <given-names>Arlin</given-names>
        </name>
        <address>
          <email>D.L.Keo@tudelft.nl</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Walker</surname>
          <given-names>Bruce J.</given-names>
        </name>
        <address>
          <email>bruce@broadinstitute.org</email>
        </address>
        <xref ref-type="aff" rid="Aff2">2</xref>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Straub</surname>
          <given-names>Timothy J.</given-names>
        </name>
        <address>
          <email>tstraub@broadinstitute.org</email>
        </address>
        <xref ref-type="aff" rid="Aff2">2</xref>
        <xref ref-type="aff" rid="Aff4">4</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Manson</surname>
          <given-names>Abigail L.</given-names>
        </name>
        <address>
          <email>amanson@broadinstitute.org</email>
        </address>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Earl</surname>
          <given-names>Ashlee M.</given-names>
        </name>
        <address>
          <email>aearl@broadinstitute.org</email>
        </address>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-7205-7431</contrib-id>
        <name>
          <surname>Abeel</surname>
          <given-names>Thomas</given-names>
        </name>
        <address>
          <email>t.abeel@tudelft.nl</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 2097 4740</institution-id><institution-id institution-id-type="GRID">grid.5292.c</institution-id><institution>Delft Bioinformatics Lab, </institution><institution>Delft University of Technology, </institution></institution-wrap>Van Mourik Broekmanweg 6, Delft, 2628XE The Netherlands </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="GRID">grid.66859.34</institution-id><institution>Infectious Disease and Microbiome Program, </institution><institution>Broad Institute of MIT and Harvard, </institution></institution-wrap>415 Main Street, Cambridge, MA 02142 USA </aff>
      <aff id="Aff3"><label>3</label>Applied Invention, LLC, 486 Green Street, Cambridge, MA 02139 USA </aff>
      <aff id="Aff4"><label>4</label><institution-wrap><institution-id institution-id-type="ISNI">000000041936754X</institution-id><institution-id institution-id-type="GRID">grid.38142.3c</institution-id><institution>Department of Immunology and Infectious Disease, </institution><institution>Harvard T.H. Chan School of Public Health, </institution></institution-wrap>677 Huntington Avenue, Boston, MA 02115 USA </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>28</day>
      <month>1</month>
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>28</day>
      <month>1</month>
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2020</year>
    </pub-date>
    <volume>21</volume>
    <elocation-id>80</elocation-id>
    <history>
      <date date-type="received">
        <day>21</day>
        <month>6</month>
        <year>2019</year>
      </date>
      <date date-type="accepted">
        <day>13</day>
        <month>1</month>
        <year>2020</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s). 2020</copyright-statement>
      <license license-type="OpenAccess">
        <license-p><bold>Open Access</bold>This article is distributed under the terms of the Creative Commons Attribution 4.0 International License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p id="Par1">Mixed infections of <italic>Mycobacterium tuberculosis</italic> and antibiotic heteroresistance continue to complicate tuberculosis (TB) diagnosis and treatment. Detection of mixed infections has been limited to molecular genotyping techniques, which lack the sensitivity and resolution to accurately estimate the multiplicity of TB infections. In contrast, whole genome sequencing offers sensitive views of the genetic differences between strains of <italic>M. tuberculosis</italic> within a sample. Although metagenomic tools exist to classify strains in a metagenomic sample, most tools have been developed for more divergent species, and therefore cannot provide the sensitivity required to disentangle strains within closely related bacterial species such as <italic>M. tuberculosis</italic>.</p>
        <p id="Par2">Here we present QuantTB, a method to identify and quantify individual <italic>M. tuberculosis</italic> strains in whole genome sequencing data. QuantTB uses SNP markers to determine the combination of strains that best explain the allelic variation observed in a sample. QuantTB outputs a list of identified strains, their corresponding relative abundances, and a list of drugs for which resistance-conferring mutations (or heteroresistance) have been predicted within the sample.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p id="Par3">We show that QuantTB has a high degree of resolution and is capable of differentiating communities differing by less than 25 SNPs and identifying strains down to 1× coverage. Using simulated data, we found QuantTB outperformed other metagenomic strain identification tools at detecting strains and quantifying strain multiplicity. In a real-world scenario, using a dataset of 50 paired clinical isolates from a study of patients with either reinfections or relapses, we found that QuantTB could detect mixed infections and reinfections at rates concordant with a manually curated approach.</p>
      </sec>
      <sec>
        <title>Conclusion</title>
        <p id="Par4">QuantTB can determine infection multiplicity, identify hetero-resistance patterns, enable differentiation between relapse and re-infection, and clarify transmission events across seemingly unrelated patients – even in low-coverage (1×) samples. QuantTB outperforms existing tools and promises to serve as a valuable resource for both clinicians and researchers working with clinical TB samples.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Tuberculosis</kwd>
      <kwd>
        <italic>Mycobacterium tuberculosis</italic>
      </kwd>
      <kwd>Mixed infection</kwd>
      <kwd>Metagenomics</kwd>
      <kwd>Strain level classification</kwd>
      <kwd>Strain identification</kwd>
      <kwd>Whole genome sequencing</kwd>
      <kwd>Bioinformatics</kwd>
      <kwd>Reinfection</kwd>
      <kwd>Transmission</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000060</institution-id>
            <institution>National Institute of Allergy and Infectious Diseases</institution>
          </institution-wrap>
        </funding-source>
        <award-id>U19AI110818</award-id>
        <principal-award-recipient>
          <name>
            <surname>Earl</surname>
            <given-names>Ashlee M.</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2020</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p id="Par9">Tuberculosis (TB) - one of the oldest diseases in the world - continues to devastate the lives of millions per year. The World Health Organization’s <italic>End TB Strategy</italic> calls for a 95% reduction of TB deaths by 2035, a feat that will require more innovative and effective methods to treat, control and diagnose the disease [<xref ref-type="bibr" rid="CR1">1</xref>].</p>
    <p id="Par10">For centuries it was assumed TB patients were infected with a single strain of <italic>Mycobacterium tuberculosis,</italic> the causative bacteria of TB. However, molecular genotyping methods have illuminated the phenomena of <italic>mixed infections</italic> - sometimes also referred to as superinfections or co-infections [<xref ref-type="bibr" rid="CR2">2</xref>–<xref ref-type="bibr" rid="CR6">6</xref>]. Patients with mixed infections harbor multiple genetically distinct strains of TB at the same time. Previous research has suggested that mixed TB infections account for up to 30% of cases [<xref ref-type="bibr" rid="CR4">4</xref>]. However, the real incidence largely remains unknown [<xref ref-type="bibr" rid="CR7">7</xref>], with estimates ranging from 19% for sputum samples up to 51% for combinations of pulmonary and extra-pulmonary samples [<xref ref-type="bibr" rid="CR5">5</xref>]. Mixed infections can complicate treatment and diagnosis through heteroresistance (presence of both drug susceptible and resistant patterns), which can cause false negatives in drug susceptibility tests and enable the spread of antibiotic resistance when left undetected [<xref ref-type="bibr" rid="CR8">8</xref>–<xref ref-type="bibr" rid="CR10">10</xref>]. Therefore, accurate detection of strains within a mixed infection, as well as their distinct resistance patterns, is important for decreasing the worldwide TB burden and slowing the spread of drug resistance.</p>
    <p id="Par11">Various molecular typing methods that can differentiate across the 8 major TB lineages, have been used to gain clues as to whether a particular infection contains more than 1 <italic>M. tuberculosis</italic> strain. Restriction Fragment Length Polymorphism (RFLP) analysis relies on the positioning and copy number of the variable transposable insertion element IS6110 [<xref ref-type="bibr" rid="CR11">11</xref>]. Mycobacterial Interspersed Repetitive Unit-Variable Number Tandem Repeat (MIRU-VNTR) typing analyzes PCR amplified loci which vary in size and number of repeats [<xref ref-type="bibr" rid="CR12">12</xref>]. Finally, spoligotyping analyzes a series of 43 spacer oligonucleotides in the directed repeat region [<xref ref-type="bibr" rid="CR12">12</xref>]. As these methods only indicate the lineage(s) of the strain within a sample, they cannot identify intra-lineage infections, making them unsuitable for mixed infection classification. In addition, these approaches only examine a small portion of the genome, and were not originally intended for the detection of mixed infections.</p>
    <p id="Par12">In contrast, whole genome sequencing (WGS) offers a more comprehensive view into the genetic composition of a sample that includes distinct genetic information from individual strains. However, interpreting and analyzing such genomic data to identify and disentangle the composition of a mixed infection still remains a difficult task. To the best of our knowledge, few established methods exist to identify mixed infections for <italic>M. tuberculosis</italic> using WGS data. Some studies have classified a sample as mixed if the number of heterozygous positions (positions with evidence for more than one allele), exceeds a predefined arbitrary threshold [<xref ref-type="bibr" rid="CR13">13</xref>, <xref ref-type="bibr" rid="CR14">14</xref>]. These methods, which only consider mixes of two strains (bi-allelic variation), require sufficient coverage (&gt;5x) for each allele and cannot be used to pinpoint actual strain identities. More recently, a paper by Sobkowiak et al. [<xref ref-type="bibr" rid="CR15">15</xref>], presents two methods, one based on the counts of heterozygous alleles and another based on a Bayesian framework to delineate strains. Neither method provides information on the identity of the strains, limiting their utility in comparing across samples, a valuable resource in transmission studies or when differentiating relapse from reinfection. On the other hand, a previous method by Gan et al. [<xref ref-type="bibr" rid="CR16">16</xref>] classifies using a reference database. However their method and database is custom built for their own specific need and has not been made available or benchmarked. Other metagenomic tools exist to classify mixed populations of strains within a single species, such as Sigma, StrainEst, Strain Seeker, and Pathoscope [<xref ref-type="bibr" rid="CR17">17</xref>–<xref ref-type="bibr" rid="CR20">20</xref>]; however these tools were developed and benchmarked using bacteria with greater intra-species diversity, such as <italic>Escherichia coli,</italic> where high numbers of variable sites and strain-specific structural variations can be exploited to delineate strains<italic>.</italic> These methods were not designed to be able to discriminate between strains of highly clonal species like <italic>M. tuberculosis</italic>, where there is near perfect syntenic gene conservation, and typically much less than 2000 genome wide single nucleotide polymorphisms (SNPs) between the most genetically distant isolates, resulting in an average sequence similarity over 99.97% between any two independent isolates.</p>
    <p id="Par13">We present QuantTB, a tool that is specifically designed to identify and quantify the abundance of closely related <italic>M. tuberculosis</italic> strains in WGS samples containing TB at a detectable level, whether sourced from culture or sputum. QuantTB is highly relevant not only for TB research but also for diagnosis of TB in WGS data. Qualitative detection of mixed infections offers many benefits such as: characterizing hard to treat TB cases [<xref ref-type="bibr" rid="CR21">21</xref>], facilitating analysis of seemingly unrelated transmission events involving lesser abundant strains, differentiating patients who have relapsed apart from those who harbor novel infections, and elucidating cases of poor treatment outcomes due to heteroresistance. In addition, QuantTB can readily be used in a diagnostic context, reducing processing time for TB identification in direct from sputum patient samples.</p>
    <p id="Par14">QuantTB classifies by iteratively comparing SNPs from an uncharacterized TB sample with a database of TB SNP profiles from known reference strains, resulting in a low rate of false positives, while retaining sensitivity at coverages as little as 1×. Unlike other tools that were designed for use on species with higher levels of intra-species variation, QuantTB can accurately and precisely disentangle TB strains that differ by as few as 25 SNPs. QuantTB also informs the user of any drug resistant or hetero-resistant loci within the sample.</p>
    <p id="Par15">QuantTB is available on GitHub: <ext-link ext-link-type="uri" xlink:href="https://github.com/AbeelLab/quanttb/">https://github.com/AbeelLab/quanttb/</ext-link></p>
  </sec>
  <sec id="Sec2">
    <title>Methods</title>
    <sec id="Sec3">
      <title>Construction of a SNP-based reference database</title>
      <p id="Par16">QuantTB uses a reference database of SNP sequences for strain classification which is constructed in four steps: 1) selecting a broad set of TB genomes, 2) selecting representative SNPs within these reference genomes 3) filtering genomes based on SNP similarity, 4) addressing reference genome bias.</p>
      <sec id="Sec4">
        <title>Acquiring genomes for the reference database</title>
        <p id="Par17">Although QuantTB can use either assemblies or raw sequencing reads for the construction of the reference database, assemblies are the preferred input. Assemblies represent aggregate, error-corrected versions of the corresponding read set and will yield superior results. We downloaded all available <italic>M. tuberculosis</italic> assemblies (5867 complete and draft genomes as of July 232,018) from NCBI [<xref ref-type="bibr" rid="CR22">22</xref>, <xref ref-type="bibr" rid="CR23">23</xref>] using the taxonomic id: txid77643. We assigned lineages to each assembly based on lineage-specific markers using a method described previously [<xref ref-type="bibr" rid="CR24">24</xref>]. We filtered out 217 assemblies that did not associate with any known <italic>M. tuberculosis</italic> lineage. We removed 12 assemblies containing markers from more than one lineage, then confirmed the remaining genomes were of appropriate size, within a range of 4.4 ± 0.5 million bases. In total, 5637 assemblies passed quality filtering. Additional file <xref rid="MOESM3" ref-type="media">3</xref>: Table S1 contains the NCBI accession codes and lineage prediction for all assemblies.</p>
      </sec>
      <sec id="Sec5">
        <title>Selecting representative SNPs</title>
        <p id="Par18">Selecting high quality SNPs for each genome present in the reference database is paramount to the success of our method. QuantTB can extract SNPs from two different sources: assemblies (FASTA files or SNP files outputted by MUMmer’s show-snps program (version 3) [<xref ref-type="bibr" rid="CR25">25</xref>]) and read sets (FASTQ files or VCF files outputted by Pilon (version 1.22) [<xref ref-type="bibr" rid="CR26">26</xref>]).</p>
        <p id="Par19">When extracting SNPs from assemblies, QuantTB aligns each assembly against the H37Rv reference genome (Genbank: CP003248.2) using MUMmer’s nucmer command with the minimum cluster length set to 100 [<xref ref-type="bibr" rid="CR25">25</xref>] and other parameters set to the default values. All outputted SNPs are used, except for those marked as ambiguous by MUMmer. In the analysis presented here, we extracted SNPs from the 5637 reference assemblies that passed quality filtering for our reference database.</p>
        <p id="Par20">Although not used for the analysis presented in this manuscript, QuantTB can also extract SNPs from read sets. QuantTB aligns each read set against the H37Rv (Genbank: CP003248.2) genome with BWA-MEM (Version: 0.7.17-r1188) [<xref ref-type="bibr" rid="CR27">27</xref>] using default settings, then index-sorts with samtools (Version: 1.6, using htslib 1.6) [<xref ref-type="bibr" rid="CR28">28</xref>]. By default, QuantTB uses Pilon (version 1.22, default settings with fixes set to none) [<xref ref-type="bibr" rid="CR26">26</xref>] to generate a pileup and characterize each site. Sites denoted by Pilon as deletions, insertions, low coverage, and reference calls are excluded, in addition to low quality sites (Phred quality score less than 11), and ambiguous sites (alternate allele frequencies less than 0.9).</p>
        <p id="Par21">For SNPs from both assemblies and read sets, we applied a number of additional filters. SNPs within a specified distance from one another (default 25 bp) were removed from consideration, as these could be indicative of sequencing or alignment error. QuantTB also excludes all variants that are located in genes annotated as PE/PPE (Additional file <xref rid="MOESM4" ref-type="media">4</xref>: Table S2) within the H37Rv reference, as these genes are known to be highly repetitive and prone to mapping errors, making it difficult to call variants using short-read data [<xref ref-type="bibr" rid="CR29">29</xref>–<xref ref-type="bibr" rid="CR31">31</xref>]. The resulting SNP sequence for a genome is a dictionary of positions <italic>(p)</italic> that differ from the H37Rv genome mapped to their corresponding alleles, where <italic>allele</italic>(<italic>p</italic><sub><italic>x</italic></sub>) → {<italic>A</italic>, <italic>C</italic>, <italic>G</italic>, <italic>T</italic>}. The complete collection of SNP sequences in the reference database is stored in a binary matrix, where rows are the genomes and columns are the locus/allele pair (Fig. <xref rid="Fig1" ref-type="fig">1</xref>).
<fig id="Fig1"><label>Fig. 1</label><caption><p>Iterative multiple strain identification process in QuantTB for a mixed sample, where two strains are present, strain 1(red) and strain 2 (green). First, SNPs from the sample are compared against SNP sequences in the reference database to calculate a strain presence score for every genome in the database. The sample is represented as a pileup, where every circle represents an allele copy. Red circles indicate alleles unique to strain A, green indicates alleles unique to strain B, and blue indicates reference strain (blue). The database (top right) is an example matrix representation of a reference genome database. Each column represents a single SNP (unique position and variant), and each row represents a genome in the reference database with this SNP present (1) or absent (0). Strain presence scores are calculated for every genome in the reference database. The genome with the highest strain presence score (<italic>s</italic><sub><italic>i</italic></sub>) is selected, in this case strain A (red). The SNPs associated with strain A are removed from the database and the input sample, along with additional reference alleles. In each subsequent iteration the scores are recalculated, allowing for the identification of additional strains, and the process continues until there are no more SNPs or a threshold has been reached</p></caption><graphic xlink:href="12864_2020_6486_Fig1_HTML" id="MO1"/></fig></p>
      </sec>
      <sec id="Sec6">
        <title>Filtering genomes based on sequence similarity</title>
        <p id="Par22">The last step in constructing the reference database is to remove highly similar genomes. We calculated the pairwise SNP distances between each genome pair by summing the number of SNPs unique to each genome, i.e. by taking the union of variants minus the intersection of variants. If the SNP distance was below a specified threshold, the genome with the lowest number of SNPs was removed. This process was repeated until all genomes differed by the specified minimum SNP distance. We evaluated the performance of QuantTB by constructing reference databases with four different SNP distance thresholds: 10, 25, 50 and 100 SNPs. Table <xref rid="Tab1" ref-type="table">1</xref> shows the number of strains within each reference database.
<table-wrap id="Tab1"><label>Table 1</label><caption><p>The number of genomes in each database after filtering by SNP distance. The distance was calculated by summing the number of unique SNPs between genomes. <sup>a</sup>In order to have a smaller database to benchmark against slower/more memory intensive tools, the number of genomes in d10small was restricted to be 200. The 200 genomes were randomly selected relative to the overall distribution of lineages, with a minimum requirement of five genomes for each lineage. D10 was selected as source set for the small benchmarking set to ensure the broadest possible strain and distance representation</p></caption><table frame="hsides" rules="groups"><thead><tr><th>Name</th><th>Minimum Genomic Distance (SNPs)</th><th>Number of genomes</th></tr></thead><tbody><tr><td>d10</td><td>10</td><td>4933</td></tr><tr><td>d10small<sup>a</sup></td><td>10<sup>a</sup></td><td>200<sup>a</sup></td></tr><tr><td>d25</td><td>25</td><td>3686</td></tr><tr><td>d50</td><td>50</td><td>2843</td></tr><tr><td>d100</td><td>100</td><td>2167</td></tr></tbody></table></table-wrap></p>
      </sec>
      <sec id="Sec7">
        <title>Addressing reference genome bias</title>
        <p id="Par23">All SNPs were called using the reference genome, H37Rv, introducing a bias that strains highly similar to the reference genome become ‘invisible’ using this method, because they have a very low number of SNPs. To remedy this issue, a custom SNP-based representation of the H37Rv sequence was generated, based on the frequencies of SNPs across all other genomes in our reference database. If the same variant is observed in almost all the genomes in the reference database, we designate this as an H37Rv specific variant, i.e. a SNP within the H37Rv genome compared to every other genome. Therefore, QuantTB generates an “H37Rv SNP sequence” including positions where more than 75% of the genomes in the reference database have a common allele that differs from H37Rv. These locations are a fingerprint for H37Rv-like strains to identify them from the rest of the database.</p>
      </sec>
    </sec>
    <sec id="Sec8">
      <title>Using the SNP database to quantify strains present within a sample</title>
      <p id="Par24">QuantTB uses a SNP-based reference database to process short-read data in order to quantify the set of strain(s) present within a sample, such as short-read data from a clinical sample or isolate. Sample processing is done in two steps: 1) Extracting SNPs from a sample 2) Iterative classification of strains in the sample.</p>
      <sec id="Sec9">
        <title>Extracting SNPs from a sample</title>
        <p id="Par25">QuantTB can accept either a FASTQ file or a VCF file as an input sample for classification. Given a FASTQ file, reads are aligned against the H37Rv genome using BWA-MEM with default settings. A pileup is generated using Pilon with the default parameters and fixes set to none. Insertions, deletions, bases with low quality (Phred less than 11) and bases within PE/PPE regions are removed as in the construction in the reference database. All other bases with a frequency greater than 0.99 for the reference allele are removed. The end result is a dictionary containing the extracted allele coverages and frequencies for every SNP position identified in the database. Note that QuantTB does not filter based on coverage; this allows for the detection of low abundance strains within a sample.</p>
      </sec>
      <sec id="Sec10">
        <title>Iterative classification of strains in the sample</title>
        <p id="Par26">Specific TB strains within the reference database are identified as present within a sample by iteratively querying against the SNP-based reference database. Figure <xref rid="Fig1" ref-type="fig">1</xref> shows an example of this iterative process in a mixed sample. The steps of the algorithm are as follows:
<list list-type="simple"><list-item><label>I.</label><p id="Par27">Compute a “strain presence score” (<italic>s</italic><sub><italic>i</italic></sub>) for every genome <italic>(i)</italic> in the database (see below for computation of score).</p></list-item><list-item><label>II.</label><p id="Par28">Choose the genome with the highest strain presence score, <italic>s</italic><sub><italic>i</italic></sub>.</p></list-item><list-item><label>III.</label><p id="Par29">Remove the chosen genome’s SNPs from the database and sample.</p></list-item><list-item><label>IV.</label><p id="Par30">Repeat steps 1–3 until no more SNPs remain, the strain presence score is below the threshold, or the maximum number of iterations have been reached.</p></list-item></list></p>
        <sec id="FPar1">
          <title>Computation of strain presence score</title>
          <p id="Par31">During each iteration, a strain presence score <italic>(s</italic><sub><italic>i</italic></sub>) is calculated for every genome in the database (<italic>D).</italic> The strain presence score is an average of two statistics, <italic>O</italic><sub><italic>i</italic></sub> and <italic>A</italic><sub><italic>i</italic></sub>, and represents the overall presence of a strain within the sample. <italic>O</italic><sub><italic>i</italic></sub> and <italic>A</italic><sub><italic>i</italic></sub> are described below.</p>
          <p id="Par32"><bold><italic>O</italic></bold><sub><bold><italic>i</italic></bold></sub> represents the fraction of SNPs from a particular reference genome, <italic>i</italic>, that was observed in the sample. The higher <italic>O</italic><sub><italic>i</italic></sub>, the more likely the set of SNPs observed in the sample originated from genome <italic>i</italic>.
<disp-formula id="Equa"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {O}_i=\frac{\mid A{l}_{sample}\cap Snp{s}_i\mid }{\mid Snp{s}_i\mid } $$\end{document}</tex-math><mml:math id="M2" display="block"><mml:msub><mml:mi>O</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mo>∣</mml:mo><mml:mi>A</mml:mi><mml:msub><mml:mi>l</mml:mi><mml:mtext mathvariant="italic">sample</mml:mtext></mml:msub><mml:mo>∩</mml:mo><mml:mi mathvariant="italic">Snp</mml:mi><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>∣</mml:mo></mml:mrow><mml:mrow><mml:mo>∣</mml:mo><mml:mi mathvariant="italic">Snp</mml:mi><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>∣</mml:mo></mml:mrow></mml:mfrac></mml:math><graphic xlink:href="12864_2020_6486_Article_Equa.gif" position="anchor"/></alternatives></disp-formula></p>
          <p id="Par33"><italic>Al</italic><sub><italic>sample</italic></sub> is the set of alleles observed above a coverage threshold <italic>t</italic><sub><italic>a</italic></sub>. Applying a coverage threshold diminishes the effect of random errors in the sample, while retaining sensitivity for true variation. This threshold <italic>t</italic><sub><italic>a</italic></sub>, is dynamic and determined by the average coverage of the sample, <italic>C</italic><sub><italic>sample</italic></sub>, and the average coverage of the genome identified in the previous iteration, <inline-formula id="IEq1"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {C}_{G_{k-1}} $$\end{document}</tex-math><mml:math id="M4" display="inline"><mml:msub><mml:mi>C</mml:mi><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:msub></mml:math><inline-graphic xlink:href="12864_2020_6486_Article_IEq1.gif"/></alternatives></inline-formula>.
<disp-formula id="Equb"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {t}_a=\left\{\begin{array}{c}\max \left(2,0.05\times {C}_{G_{k-1}}\right)\kern1.25em \mathrm{if}\ {C}_{sample}&gt;25\\ {}0.05\times {C}_{G_{k-1}}\kern5.75em \mathrm{if}\ {C}_{sample}\le 25\ \end{array}\right. $$\end{document}</tex-math><mml:math id="M6" display="block"><mml:msub><mml:mi>t</mml:mi><mml:mi>a</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfenced close="" open="{"><mml:mtable><mml:mtr><mml:mtd><mml:maligngroup/><mml:mo>max</mml:mo><mml:mfenced close=")" open="(" separators=","><mml:mn>2</mml:mn><mml:mrow><mml:mn>0.05</mml:mn><mml:mo>×</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:msub></mml:mrow></mml:mfenced><mml:mspace width="1.25em"/><mml:mtext>if</mml:mtext><mml:mspace width="0.25em"/><mml:msub><mml:mi>C</mml:mi><mml:mtext mathvariant="italic">sample</mml:mtext></mml:msub><mml:mo>&gt;</mml:mo><mml:mn>25</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:maligngroup/><mml:mn>0.05</mml:mn><mml:mo>×</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:msub><mml:mspace width="5.75em"/><mml:mtext>if</mml:mtext><mml:mspace width="0.25em"/><mml:msub><mml:mi>C</mml:mi><mml:mtext mathvariant="italic">sample</mml:mtext></mml:msub><mml:mo>≤</mml:mo><mml:mn>25</mml:mn><mml:mspace width="0.25em"/></mml:mtd></mml:mtr></mml:mtable></mml:mfenced></mml:math><graphic xlink:href="12864_2020_6486_Article_Equb.gif" position="anchor"/></alternatives></disp-formula></p>
          <p id="Par34">If the sample has an average coverage greater than 25, a minimum coverage threshold of 2 is set for all iterations, whereas for samples with an average coverage less than 25, there is no minimum, so that strains at low coverage can still be detected. For each iteration <italic>k</italic>, the threshold is set as 5% of the average coverage of the strain identified in the previous iteration. This is initialized at <italic>k = 0</italic> as 5% of the sample coverage (<italic>C</italic><sub><italic>sample</italic></sub>). Applying a coverage threshold diminishes the effect of random errors in the sample, while retaining sensitivity for true variation. Notice that this threshold likely goes down in every iteration as the coverage of the previously detected strain is used with a minimum of 2.</p>
          <p id="Par35"><bold><italic>A</italic></bold><sub><bold><italic>i</italic></bold></sub> represents the frequency with which a particular genome’s SNPs accounts for all the allelic variants present in the sample. The previous statistic, <italic>O</italic><sub><italic>i</italic></sub>, represents how many SNPs of a particular genome have been observed with sufficiently high coverage. However, when a sample has low coverage, the probability of observing the complete set of a genome’s SNPs is low. To account for strains present at low coverages, QuantTB also calculates, <italic>A</italic><sub><italic>i</italic></sub>.
<disp-formula id="Equc"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {A}_i=\frac{\mid {Freq}_i\mid }{\mid {Al}_{sample}\mid } $$\end{document}</tex-math><mml:math id="M8" display="block"><mml:msub><mml:mi>A</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mo>∣</mml:mo><mml:msub><mml:mtext mathvariant="italic">Freq</mml:mtext><mml:mi>i</mml:mi></mml:msub><mml:mo>∣</mml:mo></mml:mrow><mml:mrow><mml:mo>∣</mml:mo><mml:msub><mml:mi mathvariant="italic">Al</mml:mi><mml:mtext mathvariant="italic">sample</mml:mtext></mml:msub><mml:mo>∣</mml:mo></mml:mrow></mml:mfrac></mml:math><graphic xlink:href="12864_2020_6486_Article_Equc.gif" position="anchor"/></alternatives></disp-formula></p>
          <p id="Par36">Where <italic>Freq</italic><sub><italic>i</italic></sub> represents the vector of frequencies for each allele of genome <italic>i</italic> within the sample: <inline-formula id="IEq2"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {Freq}_i=\left({f}_{p_{i,1}},{f}_{p_{i,2}},{f}_{p_{i,3}},\dots, {f}_{p_{i,L}}\right),\kern1.5em {f}_x\in \left[0,1\right] $$\end{document}</tex-math><mml:math id="M10" display="inline"><mml:msub><mml:mtext mathvariant="italic">Freq</mml:mtext><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfenced close=")" open="(" separators=",,,,"><mml:msub><mml:mi>f</mml:mi><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:msub><mml:msub><mml:mi>f</mml:mi><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:msub><mml:msub><mml:mi>f</mml:mi><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msub></mml:msub><mml:mo>…</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:msub></mml:msub></mml:mfenced><mml:mo>,</mml:mo><mml:mspace width="1.5em"/><mml:msub><mml:mi>f</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:mfenced close="]" open="[" separators=","><mml:mn>0</mml:mn><mml:mn>1</mml:mn></mml:mfenced></mml:math><inline-graphic xlink:href="12864_2020_6486_Article_IEq2.gif"/></alternatives></inline-formula><italic>.</italic></p>
        </sec>
        <sec id="FPar2">
          <title>Choose the genome with the highest strain presence score</title>
          <p id="Par37">At the end of each iteration, the strain presence score <italic>(s</italic><sub><italic>i</italic></sub><italic>,)</italic>, is calculated as an average between <italic>O</italic><sub><italic>i</italic></sub> and <italic>A</italic><sub><italic>i</italic></sub>, and the genome with the highest <italic>s</italic><sub><italic>i</italic></sub><italic>,</italic>is selected as being present in the sample.</p>
        </sec>
        <sec id="FPar3">
          <title>Remove the chosen genome’s SNPs from the database and sample</title>
          <p id="Par38">Before the next iteration begins, SNPs corresponding to the chosen genome are 1) removed from each SNP sequence in the database and 2) removed from the sample. In addition, any H37Rv alleles present in the sample at positions outside of the identified genomes’ SNP sequences are also removed. This is because those alleles have already been accounted for by the presence in the identified genome.</p>
          <p id="Par39">Because it is unlikely that the true strain present in the sample shares the exact collection of SNPs with its highest scoring match in the database, additional SNPs from the sample could match erroneously across multiple other genomes in the database with enough coverage to be marked as ‘observed’. As the coverage increases, the probability that an additional genome is spuriously detected also increases, due to the number of these uninformative SNPs that do not match perfectly with the originally selected genome. QuantTB implements a check to safeguard against this. To account for spuriously detected genomes due to higher coverages (greater than 25), we only allow strains to be detected in a sample when their prevalence accounts for at least 1% of the sample coverage. Therefore, SNPs from a particular strain are only removed from the sample when the change of coverage at each iteration would be at least 1%, otherwise the strain is ruled out for detection.</p>
        </sec>
        <sec id="FPar4">
          <title>Iteration</title>
          <p id="Par40">The QuantTB algorithm iterates until the score threshold has been reached (the default is 0.15 but this can be adjusted by the user). Before starting the next iteration, a check is performed to ensure that a sufficient number of SNPs (15) still remain in the sample and in the database for reliable classification. This value was empirically determined during large scale testing.</p>
          <p id="Par41">At the end of the iterations, relative abundance is calculated by taking the average coverage of unique SNPs for each genome in the sample.</p>
        </sec>
      </sec>
    </sec>
    <sec id="Sec11">
      <title>Prediction of antibiotic resistance status of detected strains</title>
      <p id="Par42">In order to identify presence or absence of a resistance phenotype in the sample, QuantTB uses a curated set of SNPs conferring antibiotic resistance to 7 TB drugs generated from the previous study of Manson et al. [<xref ref-type="bibr" rid="CR24">24</xref>] (Additional file <xref rid="MOESM5" ref-type="media">5</xref>: Table S3). QuantTB also allows users to upload their own curated set of variants. If resistance conferring allele(s) are present at a frequency of more than 90%, the sample is considered fully resistant for that drug. Heteroresistance, where there is evidence of both a resistant and a susceptible phenotype in a sample, can occur due to mixed infections or through in-host microevolution. If a resistance conferring allele(s) is present at a frequency between 10 and 90%, then the sample is considered heteroresistant for that drug. QuantTB outputs the results of the resistance testing in a separate file, if the appropriate command-line flag is set.</p>
    </sec>
    <sec id="Sec12">
      <title>Benchmarking using synthetic read sets</title>
      <p id="Par43">We constructed test datasets to benchmark QuantTB and compare its performance to two other strain level identification methods, StrainSeeker [<xref ref-type="bibr" rid="CR18">18</xref>] and Sigma [<xref ref-type="bibr" rid="CR17">17</xref>]. Another tool, StrainEst [<xref ref-type="bibr" rid="CR32">32</xref>] is also capable of performing single strain classification; however, a downloadable script is not provided to construct a database for <italic>M. tuberculosis</italic> genomes compatible with their algorithm, so we were unable to include it in our benchmark.</p>
      <p id="Par44">Synthetic mixed samples of two and four strains were used to perform benchmarking. In order to benchmark overall performance across different coverage levels, as well as across databases with different levels of strain similarity, we constructed mixes of four strains, where all four strains were present at equal relative abundance. In order to further benchmark the ability of QuantTB to assess samples containing strains with different relative abundances, we generated synthetic mixes of two strains sampled at different relative abundances.</p>
      <p id="Par45">To generate the four strain mixtures we randomly selected 200 combinations of four assemblies from each of the four reference databases generated with different SNP-distances using publicly available <italic>M. tuberculosis</italic> assemblies. In total, we selected 800 different combinations of four strains. For each reference database, we ensured that all 7 main lineages were represented across the selected sets of assemblies. Then, for each selected assembly, we synthesized paired end reads using ART (Version 2.5.8) [<xref ref-type="bibr" rid="CR33">33</xref>] with default settings for the Illumina HiSeq 2500 platform, at a read length of 101 bp and a final coverage of 100×. Each read set was down sampled to 0.1×, 1×, 10×, and 20× coverage, then merged into mixes of four. This corresponds to 800 mixed sets of four different coverage levels, or 3200 synthetic mixes of strains.</p>
      <p id="Par46">To generate synthetic two-strain mixtures of strains at different relative abundances, we randomly selected 100 pairs of assemblies from each of the d50 and d100 reference databases. Paired end reads were simulated for each assembly, then the read sets were merged in mixes at 1×/9× coverage and 3×/7× coverage. This corresponds to 200 mixed sets at two different coverage levels, resulting in 400 synthetic mixes of varying relative abundance.</p>
      <p id="Par47">In addition, we generated synthetic four-strain mixtures for a smaller dataset, able to run in shorter compute time. StrainSeeker and Sigma are not capable of processing large sized reference sets (&gt; 2000 genomes) and required &gt; 3 days of compute time per sample or &gt; 7 days for reference database construction of 2000 genomes. Therefore, to compare the performance of QuantTB against that of StrainSeeker and Sigma within a reasonable time frame, we created a smaller reference database, d10small. Using the reference genomes from the d10 database (see Methods), we randomly selected 200 genomes such that each TB lineage was represented in proportion to its relative incidence in the overall dataset, with a minimum requirement of five representatives for each lineage. Synthetic sample sets were then created based on the small reference set, using 200 randomly selected sets of 4 genomes. These sets were synthesized using the same method as for the previous databases, with the only exception being that we only created samples where the strains are present at either 1× and 10× coverage.</p>
    </sec>
    <sec id="Sec13">
      <title>Benchmark evaluation using synthetic sets</title>
      <p id="Par48">In order to test the performance of each method, we calculated the <italic>Recall</italic>, <italic>Precision</italic>, and the <italic>F1 score</italic> for every test category. True positive (<italic>TP</italic>) refers to the number of correctly identified strains. False positive (<italic>FP</italic>) refers to the number of identified strains that were not present in the sample. False negative (<italic>FN</italic>) refers to the number of strains present in the sample that were not identified.
<disp-formula id="Equd"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\displaystyle \begin{array}{c} Recall=\frac{TP}{TP+ FN},\kern0.5em Precision=\frac{TP}{TP+ FP},\kern0.5em \\ {}\kern0ex F1=2\times \frac{Recall\times Precision}{Recall+ Precision}\end{array}} $$\end{document}</tex-math><mml:math id="M12" display="block"><mml:mi>R</mml:mi><mml:mi>e</mml:mi><mml:mi>c</mml:mi><mml:mi>a</mml:mi><mml:mi>l</mml:mi><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>T</mml:mi><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi><mml:mi>P</mml:mi><mml:mo>+</mml:mo><mml:mi>F</mml:mi><mml:mi>N</mml:mi></mml:mrow></mml:mfrac><mml:mo>,</mml:mo><mml:mspace width="0.5em"/><mml:mi>P</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>c</mml:mi><mml:mi>i</mml:mi><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mi>o</mml:mi><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>T</mml:mi><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi><mml:mi>P</mml:mi><mml:mo>+</mml:mo><mml:mi>F</mml:mi><mml:mi>P</mml:mi></mml:mrow></mml:mfrac><mml:mo>,</mml:mo><mml:mspace width="0.5em"/><mml:mspace linebreak="newline"/><mml:mi>F</mml:mi><mml:mn>1</mml:mn><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:mo>×</mml:mo><mml:mfrac><mml:mrow><mml:mi>R</mml:mi><mml:mi>e</mml:mi><mml:mi>c</mml:mi><mml:mi>a</mml:mi><mml:mi>l</mml:mi><mml:mi>l</mml:mi><mml:mo>×</mml:mo><mml:mi>P</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>c</mml:mi><mml:mi>i</mml:mi><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mi>o</mml:mi><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>R</mml:mi><mml:mi>e</mml:mi><mml:mi>c</mml:mi><mml:mi>a</mml:mi><mml:mi>l</mml:mi><mml:mi>l</mml:mi><mml:mo>+</mml:mo><mml:mi>P</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>c</mml:mi><mml:mi>i</mml:mi><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mi>o</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:mfrac></mml:math><graphic xlink:href="12864_2020_6486_Article_Equd.gif" position="anchor"/></alternatives></disp-formula></p>
    </sec>
    <sec id="Sec14">
      <title>Evaluation using real genomic data</title>
      <p id="Par49">We demonstrated the utility of QuantTB with real data samples from a study investigating reinfection and relapse using WGS [<xref ref-type="bibr" rid="CR13">13</xref>]. Sequencing reads from 50 pairs of isolates were downloaded from the SRA [<xref ref-type="bibr" rid="CR34">34</xref>]. SRA files were extracted using fastqdump (Version 2.9.0) [<xref ref-type="bibr" rid="CR34">34</xref>] from the SRA toolkit, using the “split-3”, “skip-technical”, and “clip” flags to split left and right reads into separate files, remove technical reads, and clip off poor-quality ends of reads, respectively.</p>
      <p id="Par50">To construct a phylogenetic tree from these samples, SNPs were extracted and filtered as described above. FastTree [<xref ref-type="bibr" rid="CR35">35</xref>] was used to generate a tree from the concatenated SNPs.</p>
    </sec>
  </sec>
  <sec id="Sec15">
    <title>Results</title>
    <sec id="Sec16">
      <title>Comprehensive TB reference database captures the breadth of the <italic>Mycobacterium tuberculosis</italic> species</title>
      <p id="Par51">QuantTB requires a reference database of known <italic>M. tuberculosis</italic> genomes for classification, where every genome is represented by a set of SNPs (see right panel in Fig. <xref rid="Fig1" ref-type="fig">1</xref>). To construct a TB reference database, we used 5637 assemblies from NCBI which passed our quality filters (see Methods).</p>
      <p id="Par52">Our database contained eight major lineages of TB at frequencies reflecting the overall abundances of sequences for each lineage in NCBI (Fig. <xref rid="Fig2" ref-type="fig">2</xref>a). Lineage 4 strains encompass the vast majority of <italic>M. tuberculosis</italic> assemblies currently available at NCBI (3455 strains), while lineage 7 and lineage 5 are the least abundant with 6 strains for each (Fig. <xref rid="Fig2" ref-type="fig">2</xref>a). The genetic diversity within lineages (Fig. <xref rid="Fig2" ref-type="fig">2</xref>b) was in agreement with previous studies (33): (i) lineage 1 had the greatest intra-lineage genetic diversity (median of 871 SNPs pairwise distance) and (ii) lineage 2, the second most frequently occurring lineage, had the lowest diversity, (median of 240 SNPs pairwise distance). The six strains that comprise lineage 7 had a wide range of genetic diversity, suggesting the need for increased sequencing of less well-characterized lineages, which would improve the resolution of classification within these less abundant lineages.
<fig id="Fig2"><label>Fig. 2</label><caption><p><bold>a</bold> Number of representatives from each lineage amongst all 5637 <italic>M. tuberculosis</italic> assemblies in our reference database. <bold>b</bold> Intra-lineage pairwise distance for each lineage as measured by the number of unique SNPs between a pair. The number in the box plot is the median distance of all pairs of samples from that lineage</p></caption><graphic xlink:href="12864_2020_6486_Fig2_HTML" id="MO2"/></fig></p>
      <p id="Par53">To benchmark QuantTB’s performance across databases with varying intra-database genetic distances, we constructed a set of databases with differing minimum differences between strains (10, 25, 50 and 100 SNPS, Table <xref rid="Tab1" ref-type="table">1</xref>, Methods). Each database contained a representative distribution of strains from each lineage (Additional file <xref rid="MOESM6" ref-type="media">6</xref>: Table S4), as well as representative genetic diversity within each lineage (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S1, Fig. <xref rid="Fig2" ref-type="fig">2</xref>b) [<xref ref-type="bibr" rid="CR36">36</xref>]. There was good concordance between the diversity represented in the complete data set (Fig. <xref rid="Fig2" ref-type="fig">2</xref>b) and the derived benchmarking sets (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S1).</p>
    </sec>
    <sec id="Sec17">
      <title>QuantTB outperforms other tools using simulated data</title>
      <p id="Par54">We compared QuantTB’s ability to accurately identify strains with Sigma [<xref ref-type="bibr" rid="CR17">17</xref>] and StrainSeeker [<xref ref-type="bibr" rid="CR18">18</xref>]. We used five reference databases that varied both in size and in the genetic distance between representative genomes (Table <xref rid="Tab1" ref-type="table">1</xref>). As Sigma and StrainSeeker are more computationally expensive than QuantTB, we were not able to use our larger databases of mixtures of four strains (&gt; 200 strains) with tools other than QuantTB. In contrast, QuantTB scaled well with database size: database construction was complete in less than 2 hours, and a sample took less than 20 min on average to process using the same computer hardware. The ability to take advantage of a large reference database is a substantial advantage for QuantTB over StrainSeeker and Sigma, since the number of publicly available TB sequences in NCBI that could be included in the database is increasing rapidly. In future, an even larger database could allow for even finer resolution strain detection.</p>
      <p id="Par55">We compared performance of QuantTB with StrainSeeker and Sigma, using a smaller, lower-resolution database of 200 strains (d10small). While StrainSeeker performed on par with QuantTB (Fig. <xref rid="Fig3" ref-type="fig">3</xref>a), both achieving near perfect F1 scores at both coverage levels, Sigma did not perform as well. Sigma identified the correct strains in almost all cases; however, this was accompanied with greatly reduced precision (Additional file <xref rid="MOESM7" ref-type="media">7</xref>: Table S5), i.e. including many false positives and decreasing its overall F1 score (Fig. <xref rid="Fig3" ref-type="fig">3</xref>a).
<fig id="Fig3"><label>Fig. 3</label><caption><p>Benchmarking results of synthetically mixed read sets of three different strain identification tools, QuantTB, StrainSeeker and Sigma. A) Results from a smaller database (d10small, <italic>n</italic> = 200) are shown for all tools for coverage levels of 1× and 10×, B) results from four larger databases (see Table <xref rid="Tab1" ref-type="table">1</xref>) are shown only for QuantTB, for coverages ranging from 0.1× − 20x</p></caption><graphic xlink:href="12864_2020_6486_Fig3_HTML" id="MO3"/></fig></p>
      <p id="Par56">Classification of synthetic four-sample mixes using the larger reference databases presented a more difficult task; however, QuantTB’s performance remained high (Fig. <xref rid="Fig3" ref-type="fig">3</xref>b), achieving F1 scores above 0.9 at all coverages above 1x per strain, indicating that QuantTB was almost always able to predict all four strains in the synthetic mixes correctly. Scores for lower sample coverage (0.1× per strain) were reduced (F1 score of 0.4). The decreased SNP counts in these very low-coverage simulations led QuantTB to predict only one of the strains present for most of these samples (Additional file <xref rid="MOESM7" ref-type="media">7</xref>: Table S5) We also observed that samples of 20× coverage per strain performed just as well as samples of 10× coverage per strain, indicating no gain in performance from additional coverage. At 1× coverage per strain, QuantTB still performed adequately, with only a slight performance dip noticeable in the largest database containing 4933 strains differing by at least 10 SNPs. We observed that the lower performance occurred mostly because QuantTB would predict a genetically similar strain instead of the <italic>correct</italic> strain. Taken together, these results suggest that QuantTB can detect strains present at a minimum of 1× coverage. In addition, the fact that the QuantTB algorithm efficiently scales to larger databases not only shows it can accurately classify genomes regardless of database content, but that it runs sufficiently fast to provide the required quick turnaround time in a clinical setting using a large, clinically representative database.</p>
    </sec>
    <sec id="Sec18">
      <title>QuantTB accurately predicts relative abundances</title>
      <p id="Par57">To assess the ability of QuantTB, StrainSeeker, and Sigma to correctly predict relative strain abundances, we simulated mixed samples of pairs of strains that varied in their relative proportions (Fig. <xref rid="Fig4" ref-type="fig">4</xref>). The setup represented a more realistic scenario, where strains in the samples (sourced from the d50 database) were not already present in the database (d10small). Additionally, we tested QuantTB’s ability to predict relative abundance across different datasets of known strain identity (Fig. <xref rid="Fig4" ref-type="fig">4</xref>a). Data for StrainSeeker and Sigma were not shown for this experiment due to inability to construct the larger reference databases.
<fig id="Fig4"><label>Fig. 4</label><caption><p><bold>a</bold> Relative abundance predictions across the synthetic sample sets, using randomly selected strains from the d50 and d100 database for QuantTB only. If the strain was correctly predicted for the sample it is colored green (true positive), whereas incorrectly predicted strains are colored red (false positive). The left graph contains samples where two strains are present at 1× and 9× coverage. The right graph contains samples where two strains are present at 3× and 7× coverage. <bold>b</bold> Predicted relative abundances across synthetically mixed samples for QuantTB, StrainSeeker and Sigma. Each point represents a predicted relative abundance for a single strain. Each mixed sample contained a pair of strains from the d50 dataset at either 1 × − 9× or 3 × − 7× abundance. Although samples were sourced from the d50 dataset, the tools used a different set of genomes as a reference set (sourced from d10). Thus genomes in the samples were not present in the underlying database the tools were trained on. This lets us see how well each tool is at predicting the correct number of strains and the correct relative abundance between strains if the ‘correct’ strain in the sample is not already present in the database</p></caption><graphic xlink:href="12864_2020_6486_Fig4_HTML" id="MO4"/></fig></p>
      <p id="Par58">QuantTB was by far the most successful tool at identifying the correct number of strains. QuantTB identified the correct number of strains (two) in the majority of samples (72%). StrainSeeker usually underestimated the number of strains and was only able to identify the correct number of strains in 25% of cases. Sigma failed to predict the correct number of strains in any sample, predicting at least 9 strains for all of the samples (Fig. <xref rid="Fig4" ref-type="fig">4</xref>b). For samples where QuantTB correctly predicted the strain multiplicity, it also predicted relative abundances close to the expected values, performing best for samples with a 0.1/0.9 strain ratio (Fig. <xref rid="Fig4" ref-type="fig">4</xref>, left graphs).</p>
      <p id="Par59">It is not only important to determine whether a tool is able to predict the correct abundances, but also whether it can select the most appropriate genome when the correct strain is absent from the reference database. Therefore, as genomes from the d50 database were used as test samples and tested against genomes in the d10small database, we evaluated the accuracy of strain predictions by assigning a true positive to each strain in a sample if QuantTB predicted the ‘correct’ relative genome in the d10small database (i.e. amongst the top 3 genomes with the highest pairwise SNP distance to the original strain). We found that QuantTB predicts the closest strain to the actual genome with an average precision value of 95%. This more realistic scenario, with previously unseen strains, suggests that QuantTB is able to accurately predict the correct number of strains even in cases where a near-identical strain is not already present in the database. Predictions of Sigma and StrainSeeker for strain multiplicity and relative abundances were insufficiently accurate (Fig. <xref rid="Fig4" ref-type="fig">4</xref>b and Table <xref rid="Tab2" ref-type="table">2</xref>) to perform this analysis meaningfully.
<table-wrap id="Tab2"><label>Table 2</label><caption><p>Number of samples predicted to contain the specified number of strains, using different methods and databases, for the set of 105 samples from Bryant et al.</p></caption><table frame="hsides" rules="groups"><thead><tr><th>Number of predicted Strains</th><th>QuantTB<break/>(d10*)</th><th>StrainSeeker<break/>(d10*)</th><th>Sigma<break/>(d10*)</th><th>QuantTB<break/>(d10)</th><th>QuantTB<break/>(d25)</th><th>QuantTB<break/>(d50)</th><th>QuantTB<break/>(d100)</th></tr></thead><tbody><tr><td>1</td><td>96</td><td>1</td><td>1</td><td>94</td><td>96</td><td>95</td><td>94</td></tr><tr><td>2</td><td>9</td><td>0</td><td>0</td><td>11</td><td>9</td><td>10</td><td>11</td></tr><tr><td>5 to25</td><td>0</td><td>6</td><td>21</td><td>0</td><td>0</td><td>0</td><td>0</td></tr><tr><td>26 to 45</td><td>0</td><td>90</td><td>65</td><td>0</td><td>0</td><td>0</td><td>0</td></tr><tr><td>46 to 60</td><td>0</td><td>2</td><td>8</td><td>0</td><td>0</td><td>0</td><td>0</td></tr></tbody></table></table-wrap></p>
      <p id="Par60">As only QuantTB could process samples using the larger databases, we further tested its accuracy at identifying correct strain pairs and their differing relative abundances using the d50 and d100 databases. For both databases, QuantTB accurately classified the identity of each strain in the pair (F1 measure of 0.98 and 0.92 for the d100 and d50 databases, respectively, Additional file <xref rid="MOESM7" ref-type="media">7</xref>: Table S5) and accurately determined the relative abundance for each strain in the pair (Fig. <xref rid="Fig4" ref-type="fig">4</xref>b). The majority of relative abundances predicted were within 0.05 of the correct value (Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Figure S2). Even in the few cases where QuantTB predicted the incorrect strain, QuantTB predicted it to be present in the sample at the correct relative abundance.</p>
    </sec>
    <sec id="Sec19">
      <title>QuantTB differentiates between relapse, reinfection, and mixed infections in real world data</title>
      <p id="Par61">To demonstrate QuantTB’s utility for (clinical) research, we quantified the distribution of <italic>M. tuberculosis</italic> strains within samples from a study investigating the frequency of TB relapses within patients from the REMoxTB clinical trial, a trial which evaluated treatment for TB in previously untreated patients [<xref ref-type="bibr" rid="CR13">13</xref>]. Bryant et al. sequenced 50 pairs of isolates, one taken at an initial time point and the other taken after more than 17 weeks of treatment. Some samples were sequenced more than once (105 total sequencing datasets). Since there are no established methods for detection of mixed infections in <italic>M. tuberculosis</italic> genomic data, the original study used manual inspection of heterozygous SNPs to differentiate between relapse (same infecting strain), reinfection (a different infecting strain) and mixed infections. In the original study, a sample was labeled as mixed if the number of heterozygous loci exceeded a threshold, and as a reinfection if the SNP distance between pairs exceeded a threshold.</p>
      <p id="Par62">Here, we systematically reanalyzed this data using QuantTB and compared our findings from this dataset to those of Sigma and StrainSeeker. As it is impossible to know the identity of the strains present in the real samples in advance, we limited analysis to the multiplicity, or the number of strains identified in each sample. Table <xref rid="Tab2" ref-type="table">2</xref> shows the multiplicity of infection detected across the dataset of 105 samples for QuantTB, Sigma and StrainSeeker.</p>
      <p id="Par63">QuantTB reported a consistently low (0–2) number of strains, and identified the same seven samples as mixed, irrespective of the database used as a reference, which was in agreement with the expected strain multiplicity based on Bryant et al. In contrast, StrainSeeker and Sigma reported an unrealistically large number of strains (greater than 25 on average).</p>
      <p id="Par64">By applying the results from QuantTB we were able to classify each sample as either part of a relapse, a reinfection or a mixed infection (4 cases). We used results from the d25 database because it performed optimally in our benchmarking tests. If more than one strain was identified by QuantTB, the sample was marked as a mixed infection. If the same strain was identified for both isolates in a pair, the sample pair was marked as a relapse case (35 cases). Finally, if different strains were identified across pairs, the sample pair was marked as a reinfection (3 cases). Bryant et al. removed 9 samples due to contamination but did not mention how how contamination was determined. Although cross contamination from other species would have had little impact on QuantTB (given sufficient TB coverage), we also removed these samples during our analysis.</p>
      <p id="Par65">The manual analysis of Bryan et al. designated six samples as mixes. The results from QuantTB match those of Bryant et al. for the vast majority of cases (Table <xref rid="Tab3" ref-type="table">3</xref>), classifying the same 3 samples as reinfections, 4 samples as mixed infections, and 33 samples as relapses. QuantTB classified three additional samples as relapses. Samples 42 and 45 were identified as mixed infections in the original study. Upon investigation, it was found that the original study labeled these as mixed infections not based on their original threshold but based off of a ‘manual inspection’, which was not well described. Sample 3 was manually identified as a ‘single isolated positive’, a label given when the second isolate of a pair tested negative for <italic>M. tuberculosis</italic> under culture. Four additional samples were given this label by Bryant et al., who mentioned that these cases were mostly caused by cross contamination. In three culture negative samples labeled ‘single isolate positive’ by Bryant et al., QuantTB identified H37Rv (a laboratory strain). As the coverage for the H37Rv reference strain was high in these three samples, our analysis supports the hypothesis that three culture negative isolates resulting in the sequencing of the H37Rv laboratory strain. The remaining discrepancy, Sample 15, was classified as a reinfection by QuantTB instead of a single isolated positive.
<table-wrap id="Tab3"><label>Table 3</label><caption><p>Comparison of all mixed infections, reinfection and relapses called between QuantTB and Bryant et al. Samples in bold are discordant between the two methods. QuantTB predictions also include the abundance levels of both strains identified within the sample. Samples labeled as Clinically TB negative on follow up were cases in which the second of the isolate pair assigned to the H37Rv strain by QuantTB, and tested negative for TB in the original study</p></caption><table frame="hsides" rules="groups"><thead><tr><th>Category</th><th>QuantTB</th><th>Bryant et al.</th></tr></thead><tbody><tr><td rowspan="4">Mixed (Lost a strain at later time point)</td><td>Sample 2: 81–18%</td><td>Sample 2</td></tr><tr><td>Sample 8: 53–47%</td><td>Sample 8</td></tr><tr><td>Sample 23: 60–40%</td><td>Sample 23</td></tr><tr><td>Sample 50: 75–25%</td><td>Sample 50</td></tr><tr><td rowspan="2">Mixed (Gained a strain at later time point)</td><td rowspan="2"/><td><bold>Sample 42</bold></td></tr><tr><td><bold>Sample 45</bold></td></tr><tr><td rowspan="4">Reinfection</td><td>Sample 10</td><td>Sample 10</td></tr><tr><td>Sample 14</td><td>Sample 14</td></tr><tr><td>Sample 35</td><td>Sample 35</td></tr><tr><td><bold>Sample 15</bold></td><td/></tr><tr><td rowspan="4">Relapse</td><td>33 matching samples</td><td>33 matching samples</td></tr><tr><td><bold>Sample 42</bold></td><td rowspan="3"/></tr><tr><td><bold>Sample 45</bold></td></tr><tr><td><bold>Sample 3</bold></td></tr><tr><td rowspan="5">Clinically TB negative on follow up</td><td>Sample 36 (H37Rv)</td><td>Sample 36</td></tr><tr><td>Sample 37 (H37Rv)</td><td>Sample 37</td></tr><tr><td>Sample 38 (H37Rv)</td><td>Sample 38</td></tr><tr><td/><td><bold>Sample 3</bold></td></tr><tr><td/><td><bold>Sample 15</bold></td></tr></tbody></table></table-wrap></p>
      <p id="Par66">To further validate our predictions and clarify discrepancies with the original study, we constructed a phylogenetic tree of all 105 sample isolate pairs based on concatenated SNP sequences (see Methods). This allowed us to visualize the phylogenetic distances between isolates of a sample pair (Fig. <xref rid="Fig5" ref-type="fig">5</xref>). We observed that most sister leaves in the tree were part of the same sample isolate pair, representing relapse cases. The two samples classified as mixed by the original study but as relapses by QuantTB also appear as sister nodes on the tree (Fig. <xref rid="Fig5" ref-type="fig">5</xref>, boxes A.1 and A.2). Although this does not rule out a mixed infection, it justifies QuantTB’s relapse classification. In addition, we observed the clustering of isolates which QuantTB identified as most similar to H37Rv (purple nodes in Fig. <xref rid="Fig5" ref-type="fig">5</xref>, box B), which were classified as ‘single isolated positive’ by the original study. The other samples given this designation by the original study, Sample 3 and Sample 15, did not have an isolate clustered with the H37Rv strain. Instead Sample 3’s isolates were sister nodes on the tree (Fig. <xref rid="Fig5" ref-type="fig">5</xref>, box C) and the two isolates of Sample 15 were found on opposite ends of the tree (Fig. <xref rid="Fig5" ref-type="fig">5</xref>, boxes D.1 and D.2), both locations confirm QuantTB’s predictions of relapse and reinfection, respectively.
<fig id="Fig5"><label>Fig. 5</label><caption><p>Phylogenetic tree of 47 pairs of isolates from sequencing reads taken from the study of Bryant et al. Tips are labeled with the isolate number and its part of the pair (a or b), and are colored by its isolate classification as predicted by QuantTB. Isolates containing a mixed infection are colored in red. Isolates part of a reinfection pair are colored in blue. Isolates containing the H37Rv strain are colored in purple. Isolates containing antibiotic heterozygous (h) or homozygous (H) resistance mutations are in orange. All single infections isolates are colored in green. To the right of the mixed and reinfection isolates, we show the strains present in the isolate as predicted by QuantTB. Boxes are discussed in the main text</p></caption><graphic xlink:href="12864_2020_6486_Fig5_HTML" id="MO5"/></fig></p>
      <p id="Par67">Finally, we observed two samples whose isolate pairs appeared swapped on the tree: Sample 2 (mixed infection) and Sample 10 (reinfection). Sample 2A has sister nodes with Sample 10B (box E.1), while Sample 10A has sister nodes with Sample 2B on a distant part of the tree (box E.2). Before treatment, Sample 2 (isolate 2A) was mixed with two strains, the minor of which was present within isolate 10A. After treatment, the major strain of Sample 2 was lost, leaving the second pair of Sample 2 (isolate 2B) with only the minor strain, explaining its change of location (next to isolate 10A) on the tree. On the other hand, after treatment, the patient carrying sample 10 was re-infected with a different strain that was similar to the major strain of isolate 2A. Without the annotation of QuantTB it would appear a sample swap might have occurred. But with QuantTB this occurrence can be explained by reviewing the strain identities, because QuantTB outputs which genome has been detected in the sample.</p>
      <p id="Par68">Overall, QuantTB and the manual curation presented in the original study resulted in agreement for 43 of the 47 sample predictions (91%). In the remaining cases, we have presented reasons why QuantTB’s prediction may be at least as accurate as the original manual designations. In addition, QuantTB gives information that was not available from the manual approach of Bryant et al., including detail on multiplicity of infection, and the identity and abundance of each strain, giving a detailed overview of each sample’s genetic makeup.</p>
    </sec>
    <sec id="Sec20">
      <title>QuantTB provides insight into antibiotic resistance</title>
      <p id="Par69">Using QuantTB, we determined the antibiotic resistance genotype for each of the isolates. Antibiotic resistance was indicated if the sample had a SNP in one of the antibiotic resistance causing loci from a previously published curated list (see Methods) [<xref ref-type="bibr" rid="CR24">24</xref>]. Heteroresistance was indicated if the sample had alleles supporting both the resistant and susceptible genotype at a particular locus. Bryant et al. also tested for antibiotic resistance, both phenotypically (with mycobacterial growth indicator tube susceptibility testing) and genotypically (their method was not described). They found no evidence of genotypic or phenotypic antibiotic resistance in any sample. However, we found evidence for genotypic antibiotic resistance in five isolates (Table <xref rid="Tab4" ref-type="table">4</xref>, Fig. <xref rid="Fig5" ref-type="fig">5</xref>). Two isolates were from the same patient, 33 and 49 (relapse cases) while one was the second isolate in its sample pair, 35b (reinfection case). We found no relation between mixed infections and heteroresistance, nor do we find evidence of the emergence of antibiotic resistance within a relapse case. Isolate 35b exhibited heteroresistance to kanamycin in one locus: 13% of alleles were of the resistance phenotype, and 87% were susceptible. Because this was a reinfection case, it is not possible to determine whether the heteroresistance arose due to within host evolution.
<table-wrap id="Tab4"><label>Table 4</label><caption><p>Isolates exhibiting genotypic antibiotic resistance from the Bryant et al. dataset</p></caption><table frame="hsides" rules="groups"><thead><tr><th>Isolate</th><th>Drug</th><th>Gene: Amino Acid position, Amino acid change</th><th>Type</th><th>distribution</th></tr></thead><tbody><tr><td>33a</td><td>rifampicin</td><td>RpoB: His-445-Ser</td><td>homozygous resistant</td><td/></tr><tr><td>33b</td><td>rifampicin</td><td>RpoB: His-445-Ser</td><td>homozygous resistant</td><td/></tr><tr><td>35b</td><td>kanamycin</td><td>Intergenic: MurA-Ogt</td><td>heteroresistant</td><td>res: 0.13% sus: 0.87%</td></tr><tr><td>49a</td><td>isoniazid</td><td>KatG: Ser-315-Thr</td><td>homozygous resistant</td><td/></tr><tr><td>49b</td><td>isoniazid</td><td>KatG: Ser-315-Thr</td><td>homozygous resistant</td><td/></tr></tbody></table></table-wrap></p>
    </sec>
  </sec>
  <sec id="Sec21">
    <title>Discussion</title>
    <p id="Par70">Mixed infections are known to complicate treatment and diagnosis of tuberculosis [<xref ref-type="bibr" rid="CR8">8</xref>–<xref ref-type="bibr" rid="CR10">10</xref>]; however, the true clinical impact and prevalence of mixed infections is still poorly understood due to the lack of suitable methods to detect and quantify individual strains of <italic>M. tuberculosis</italic>. WGS studies investigating <italic>M. tuberculosis</italic> typically identify mixed infections based on the amount of heterozygous base calls [<xref ref-type="bibr" rid="CR6">6</xref>, <xref ref-type="bibr" rid="CR13">13</xref>, <xref ref-type="bibr" rid="CR14">14</xref>, <xref ref-type="bibr" rid="CR37">37</xref>]. However, both the definition of a heterozygous locus and the number of heterozygous positions indicative of a mixed infection varies among studies. For example, Bryant et al. defined a position as heterozygous when two alleles were supported by at least 5% of the reads with a minimum read depth per allele of 4, and a sample as mixed if it had more than 80 heterozygous base calls [<xref ref-type="bibr" rid="CR13">13</xref>]. Guerra-Assunção et al. defined a position as heterozygous if it had at least 30× coverage and more than one allele accounted for in at least 30% of the reads, and classified a sample as mixed if more than 140 bases were heterozygous [<xref ref-type="bibr" rid="CR14">14</xref>]. Perez Lago et al. simply called a position heterozygous when the less frequent allele was supported by at least 5 reads [<xref ref-type="bibr" rid="CR37">37</xref>]. With QuantTB we aimed to provide analgorithm capable of systematically quantifying the multiplicity and abundance of <italic>M. tuberculosis</italic> strains at high resolution using WGS data that does not require manual definitions or counting of heterozygous positions. Because of QuantTB’s unique algorithm that identifies strains in an iterative process, strains can be detected at low coverages (1×), irrespective of the relative frequencies of alleles. The information provided by QuantTB provides several key improvements over a manual approach of counting heterozygous positions. QuantTB: 1) outputs the specific identity of the strain, making the tracking of specific strains across samples possible; 2) outputs the abundances of every strain identified in the sample, enabling the quick identification of major and minor subpopulations; 3) is capable of detecting more than two strains; 4) reduces time required to identify mixed infection to less than half an hour; 5) simplifies the manual process into an easy to use package reducing the amount of overhead; and 6) increases reproducibility across TB studies.</p>
    <p id="Par71">Due to QuantTB’s use of a reference database, tracking the presence or absence of specific strains across a set of longitudinal or outbreak samples is also possible. Within a sample, QuantTB can identify the closest strain(s) present from a reference database, even using a large database containing many highly similar genomes (differing by as little as 25 SNPs), allowing us to pinpoint specific strains to within 25 SNPs. This ability to pinpoint (mixes of) specific strains can aid in accurately identifying reinfection cases vs relapses, giving more useful results compared to the manual approach of the Bryant case-study with which our findings are largely consistent.</p>
    <p id="Par72">Using a systematic approach such as QuantTB aids in identifying cryptic transmission events, such as for samples with dissimilar major strains but matching minor strains. This may have occurred in two of the samples we surveyed in the data of Bryant et al. (samples 2 and 10). The ability to pinpoint strain mixtures can also aid in tracking progression of microevolution between sample isolates, including the evolution of resistance.</p>
    <p id="Par73">Using simulated data, we showed that QuantTB can accurately classify <italic>M. tuberculosis</italic> strains across a variety of database sizes. QuantTB is highly scalable, and can efficiently classify samples with databases as large as 4000 strains in minutes, a necessary functionality as more and more TB assemblies are resolved. Other published tools made for classifying single strains in samples, StrainSeeker and Sigma<italic>,</italic> were not capable of working with large databases, limiting their applicability as a diagnostic tool for <italic>M. tuberculosis</italic>. On tests using a smaller database - an easier and low resolution experiment - QuantTB identified the strain composition of synthetic sets with comparable accuracy as StrainSeeker, while Sigma’s results included numerous false positives. On tests where the mixed samples contained strains absent from the database, QuantTB outperformed the other tools by accurately outputting the correct multiplicity in 72% of cases, in comparison to 25% for StrainSeeker and 0% for Sigma. Both Sigma and StrainSeeker consistently output aberrantly high number of strains making any downstream analysis impossible. In addition, QuantTB predicted the closest related genome in the database for these strains in 94% of the samples.</p>
    <p id="Par74">The detection of high quality SNPs in a sample is an essential part of QuantTB’s algorithm. In order to ensure erroneous SNPs are not considered, QuantTB disregards SNPs present at less than 5% abundance relative to that of the previously identified strain. Therefore, QuantTB can only detect mixed infections in which the minor strain represents at least 5% of the allelic variation. However, QuantTB is still able to pinpoint low-abundance strains with greater sensitivity than previous approaches based on the counting of heterozygous positions, due to its ability to identify strains down to coverages as low as 1x.</p>
    <p id="Par75">An advantage of approaches based purely on heterozygous locations is that they do not depend on a reference database. QuantTB’s ability to accurately detect mixed infections is closely integrated with the distribution of genomes used to construct the database. Though we have tested QuantTB’s performance on samples containing strains absent from the database, we have not extensively tested how the absence of a large proportion of a strain’s lineage would affect its classification. QuantTB’s ability to detect a strain not in the database depends on how distant it is from its nearest relative in the database. If the strain is sufficiently distant, it is likely that the strain would not be detected, underestimating sample diversity. The effects of QuantTB’s database reliance is mitigated by ensuring the database covers as much diversity as possible. We found the currently available data is skewed to favor genomes of lineage 4 and lineage 2, with lineage 7 and 5 representing only 0.2% of the downloaded assemblies. Therefore, further sequencing of these underrepresented lineages would aid QuantTB in proper classification of novel strains.</p>
    <p id="Par76">QuantTB determines antibiotic resistance phenotypes by querying the sample against a manually curated list of SNPs that were shown to cause antibiotic resistances in previous studies. Bryant et al. did not find clinical evidence for antibiotic resistance amongst the samples. Using the curated list provided by Manson et al. [<xref ref-type="bibr" rid="CR24">24</xref>] we found antibiotic resistance in five samples, one being a case of heteroresistance in the second isolate of its sample pair. We did not observe any relationship between antibiotic resistance and mixed infections in the clinical isolates. The observed resistance mutations are well-known causal mutations for their respective resistances and WGS has been shown to outperform phenotypic susceptibility tests for predicting resistance [<xref ref-type="bibr" rid="CR38">38</xref>]. Since Bryant et al. did not specify the type of genotypic testing they employed, it is impossible to explain why they were unable to detect genotypic resistant isolates. Particularly the <italic>katG</italic> mutation predicted from genotypic data in samples 49a and 49b is widely known and confirmed to confer resistance to isoniazid. The ability to accurately determine antibiotic resistance from sequencing data is still an active research topic for TB [<xref ref-type="bibr" rid="CR39">39</xref>, <xref ref-type="bibr" rid="CR40">40</xref>]. As antibiotic resistance is one of the biggest threats to world-wide TB eradication, the accurate detection of resistance determinants in samples is crucial.</p>
  </sec>
  <sec id="Sec22">
    <title>Conclusion</title>
    <p id="Par77">We introduce QuantTB, a new classification method that leverages the high-resolution capability of WGS for the detection of mixed <italic>M. tuberculosis</italic> infections. In contrast to existing tools such as Sigma and StrainSeeker, QuantTB is scalable and able to leverage a high-resolution reference database representing the scope of diversity within TB. Even when using a smaller database that allows comparisons between these tools, QuantTB shows substantially better performance on both synthetic and clinical datasets. This tool can be used to rapidly and accurately identify specific <italic>M. tuberculosis</italic> strains in clinical samples, track transmission of TB strains across longitudinal samples and outbreaks, and differentiate between relapse and reinfection cases. The ability to disentangle mixed infections in an accurate and scalable manner will help control TB and help limit the spread of antibiotic resistance.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary information</title>
    <sec id="Sec23">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="12864_2020_6486_MOESM1_ESM.pdf">
            <caption>
              <p><bold>Additional file 1: Figure S1</bold>. Intra-lineage pairwise distance for the different <italic>M. tuberculosis</italic> genomes in different databases. Pairwise distance was measured as the number of unique SNPs between a pair of genomes. The number in the box plot is the median distance of all pairs of samples from that lineage. The databases vary in the number of genomes and the minimum SNP distance between strains.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM2">
          <media xlink:href="12864_2020_6486_MOESM2_ESM.pdf">
            <caption>
              <p><bold>Additional file 2: Figure S2</bold>. Histogram of residual error of QuantTB’s relative abundance prediction across different testing scenarios. The x axis is the difference between relative abundance prediction of QuantTB and the actual relative abundance value. The y axis is the total number of strains with that error. A distance of 0 means that QuantTB predicted the relative abundance perfectly for that strain. Higher distance/error indicates that QuantTB predicted the relative abundance further away from the actual value. Color indicates whether QuantTB predicted the correct strain (TP) or the wrong strain (FP). Tests were conducted using two different databases (d50 and d100) with mixed samples where the two strains are present at different coverages (1x-9x or 3x-7x).</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM3">
          <media xlink:href="12864_2020_6486_MOESM3_ESM.csv">
            <caption>
              <p><bold>Additional file 3: Table S1</bold>. List of NCBI accession numbers, and their strain name for the downloaded assemblies. Determination of the lineage is explained in the methods section. Whether or not it passed QC filtering is indicated in the ‘passed’ column.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM4">
          <media xlink:href="12864_2020_6486_MOESM4_ESM.xlsx">
            <caption>
              <p><bold>Additional file 4: Table S2</bold>. List of excluded PE/PPE/PGRS gene loci.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM5">
          <media xlink:href="12864_2020_6486_MOESM5_ESM.txt">
            <caption>
              <p><bold>Additional file 5: Table S3</bold>. List of antibiotic resistant causing mutations used in QuantTB. The base is the genomic location, ref. is the H37Rv reference allele at that position, mutation is the corresponding resistant causing mutation, and the drug initial is indicated in the ‘drug’ column. The initial dictionary is as follows: {O: Ofloxacin, R: Rifampicin, S: Streptomycin, K: kanamycin, T: common to isoniazid and ethionamide, I: Isoniazid, P: Pyrazinamide, K: Kanamycin, E: Ethambutol, M: Ethionamide}.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM6">
          <media xlink:href="12864_2020_6486_MOESM6_ESM.csv">
            <caption>
              <p><bold>Additional file 6: Table S4</bold>. Number of genomes in each lineage for each database. Lineage specification method can be found in the methods section.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM7">
          <media xlink:href="12864_2020_6486_MOESM7_ESM.csv">
            <caption>
              <p><bold>Additional file 7: Table S5</bold>. Accuracy measures of benchmarks with QuantTB, StrainSeeker, and Sigma for all experiments in this study.</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <glossary>
    <title>Abbreviations</title>
    <def-list>
      <def-item>
        <term>MIRU-VNTR</term>
        <def>
          <p id="Par5">Mycobacterial Interspersed Repetitive Unit-Variable Number Tandem Repeat</p>
        </def>
      </def-item>
      <def-item>
        <term>RFLP</term>
        <def>
          <p id="Par6">Restriction Fragment Length Polymorphism</p>
        </def>
      </def-item>
      <def-item>
        <term>WGS</term>
        <def>
          <p id="Par7">Whole genome sequencing</p>
        </def>
      </def-item>
      <def-item>
        <term>SNP</term>
        <def>
          <p id="Par8">Single nucleotide polymorphism</p>
        </def>
      </def-item>
    </def-list>
  </glossary>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher’s Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <sec>
    <title>Supplementary information</title>
    <p><bold>Supplementary information</bold> accompanies this paper at 10.1186/s12864-020-6486-3.</p>
  </sec>
  <ack>
    <title>Acknowledgements</title>
    <p>Not applicable.</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Authors’ contributions</title>
    <p>AK, TA, AE, BW conceived the project. CA and TA designed and implemented the analyses and wrote the manuscript. AM, TS, TA, AK, AE provided comments on the manuscript. All authors read and approved the final manuscript.</p>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>This project has been funded in whole or in part with Federal funds from the National Institute of Allergy and Infectious Diseases, National Institutes of Health, Department of Health and Human Services, under Grant Number U19AI110818 to the Broad Institute.</p>
    <p>This research is supported by the TU Delft | Global Initiative, a program of the Delft University of Technology to boost Science and Technology for Global Development.</p>
    <p>The funding bodies played no role in the design of the study and collection, analysis, and interpretation of data and in writing the manuscript.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and materials</title>
    <p>The FASTA files used in this study can be downloaded from NCBI using the accession numbers listed in Additional file <xref rid="MOESM3" ref-type="media">3</xref>: Table S1.</p>
    <p>The raw sequence data analyzed in this study can be downloaded from the Sequencing Read Archive (BioProject Accession: PRJEB2777).</p>
    <p>QuantTB can be downloaded and installed from github: <ext-link ext-link-type="uri" xlink:href="https://github.com/AbeelLab/quanttb/">https://github.com/AbeelLab/quanttb/</ext-link></p>
  </notes>
  <notes>
    <title>Ethics approval and consent to participate</title>
    <p id="Par78">Not applicable.</p>
  </notes>
  <notes>
    <title>Consent for publication</title>
    <p id="Par79">Not applicable.</p>
  </notes>
  <notes notes-type="COI-statement">
    <title>Competing interests</title>
    <p id="Par80">The authors declare that they have no competing interests.</p>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <collab>World Health Organization</collab>
        </person-group>
        <source>Tuberculosis Fact Sheet</source>
        <year>2018</year>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Colijn</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Cohen</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Murray</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Latent coinfection and the maintenance of strain diversity</article-title>
        <source>Bull Math Biol</source>
        <year>2009</year>
        <volume>71</volume>
        <fpage>247</fpage>
        <lpage>263</lpage>
        <pub-id pub-id-type="doi">10.1007/s11538-008-9361-y</pub-id>
        <pub-id pub-id-type="pmid">19082663</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Warren</surname>
            <given-names>RM</given-names>
          </name>
          <name>
            <surname>Victor</surname>
            <given-names>TC</given-names>
          </name>
          <name>
            <surname>Streicher</surname>
            <given-names>EM</given-names>
          </name>
          <name>
            <surname>Richardson</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Beyers</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>van Pittius</surname>
            <given-names>NCG</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Patients with active tuberculosis often have different strains in the same sputum specimen</article-title>
        <source>Am J Respir Crit Care Med</source>
        <year>2004</year>
        <volume>169</volume>
        <fpage>610</fpage>
        <lpage>614</lpage>
        <pub-id pub-id-type="doi">10.1164/rccm.200305-714OC</pub-id>
        <pub-id pub-id-type="pmid">14701710</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cohen</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>van Helden</surname>
            <given-names>PD</given-names>
          </name>
          <name>
            <surname>Wilson</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Colijn</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>McLaughlin</surname>
            <given-names>MM</given-names>
          </name>
          <name>
            <surname>Abubakar</surname>
            <given-names>I</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Mixed-strain mycobacterium tuberculosis infections and the implications for tuberculosis treatment and control</article-title>
        <source>Clin Microbiol Rev</source>
        <year>2012</year>
        <volume>25</volume>
        <fpage>708</fpage>
        <lpage>719</lpage>
        <pub-id pub-id-type="doi">10.1128/CMR.00021-12</pub-id>
        <?supplied-pmid 23034327?>
        <pub-id pub-id-type="pmid">23034327</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mcivor</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Koornhof</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Kana</surname>
            <given-names>BD</given-names>
          </name>
        </person-group>
        <article-title>Relapse, re-infection and mixed infections in tuberculosis disease</article-title>
        <source>Pathog Dis</source>
        <year>2017</year>
        <volume>75</volume>
        <fpage>1</fpage>
        <lpage>16</lpage>
        <pub-id pub-id-type="doi">10.1093/femspd/ftx020</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <mixed-citation publication-type="other">Hatherell H, Colijn C, Stagg HR, Jackson C, Winter JR, Abubakar I. Interpreting whole genome sequencing for investigating tuberculosis transmission : a systematic review. BMC Med. 2016:1–13. 10.1186/s12916-016-0566-x.</mixed-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tarashi</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Fateh</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Mirsaeidi</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Siadat</surname>
            <given-names>SD</given-names>
          </name>
          <name>
            <surname>Vaziri</surname>
            <given-names>F</given-names>
          </name>
        </person-group>
        <article-title>Mixed infections in tuberculosis: the missing part in a puzzle</article-title>
        <source>Tuberculosis.</source>
        <year>2017</year>
        <volume>107</volume>
        <fpage>168</fpage>
        <lpage>174</lpage>
        <pub-id pub-id-type="doi">10.1016/j.tube.2017.09.004</pub-id>
        <pub-id pub-id-type="pmid">29050766</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>van Rie</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Victor</surname>
            <given-names>TC</given-names>
          </name>
          <name>
            <surname>Richardson</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Johnson</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>van der Spuy</surname>
            <given-names>GD</given-names>
          </name>
          <name>
            <surname>Murray</surname>
            <given-names>EJ</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Reinfection and mixed infection cause changing <italic>Mycobacterium tuberculosis</italic> drug-resistance patterns</article-title>
        <source>Am J Respir Crit Care Med</source>
        <year>2005</year>
        <volume>172</volume>
        <fpage>636</fpage>
        <lpage>642</lpage>
        <pub-id pub-id-type="doi">10.1164/rccm.200503-449OC</pub-id>
        <pub-id pub-id-type="pmid">15947286</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zetola</surname>
            <given-names>N. M.</given-names>
          </name>
          <name>
            <surname>Shin</surname>
            <given-names>S. S.</given-names>
          </name>
          <name>
            <surname>Tumedi</surname>
            <given-names>K. A.</given-names>
          </name>
          <name>
            <surname>Moeti</surname>
            <given-names>K.</given-names>
          </name>
          <name>
            <surname>Ncube</surname>
            <given-names>R.</given-names>
          </name>
          <name>
            <surname>Nicol</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Collman</surname>
            <given-names>R. G.</given-names>
          </name>
          <name>
            <surname>Klausner</surname>
            <given-names>J. D.</given-names>
          </name>
          <name>
            <surname>Modongo</surname>
            <given-names>C.</given-names>
          </name>
        </person-group>
        <article-title>Mixed Mycobacterium tuberculosis Complex Infections and False-Negative Results for Rifampin Resistance by GeneXpert MTB/RIF Are Associated with Poor Clinical Outcomes</article-title>
        <source>Journal of Clinical Microbiology</source>
        <year>2014</year>
        <volume>52</volume>
        <issue>7</issue>
        <fpage>2422</fpage>
        <lpage>2429</lpage>
        <pub-id pub-id-type="doi">10.1128/JCM.02489-13</pub-id>
        <pub-id pub-id-type="pmid">24789181</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Richardson</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Carroll</surname>
            <given-names>NM</given-names>
          </name>
          <name>
            <surname>Engelke</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Van Der Spuy</surname>
            <given-names>GD</given-names>
          </name>
          <name>
            <surname>Salker</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Munch</surname>
            <given-names>Z</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Multiple mycobacterium tuberculosis strains in early cultures from patients in a high-incidence community setting</article-title>
        <source>J Clin Microbiol</source>
        <year>2002</year>
        <volume>40</volume>
        <fpage>2750</fpage>
        <lpage>2754</lpage>
        <pub-id pub-id-type="doi">10.1128/JCM.40.8.2750-2754.2002</pub-id>
        <pub-id pub-id-type="pmid">12149324</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dai</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Long</surname>
            <given-names>Y</given-names>
          </name>
        </person-group>
        <article-title>Genotyping analysis using an rflp assay</article-title>
        <source>Methods Mol Biol</source>
        <year>2015</year>
        <volume>1245</volume>
        <fpage>91</fpage>
        <lpage>99</lpage>
        <pub-id pub-id-type="doi">10.1007/978-1-4939-1966-6_7</pub-id>
        <pub-id pub-id-type="pmid">25373751</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schürch</surname>
            <given-names>AC</given-names>
          </name>
          <name>
            <surname>van Soolingen</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>DNA fingerprinting of mycobacterium tuberculosis: from phage typing to whole-genome sequencing</article-title>
        <source>Infect Genet Evol</source>
        <year>2012</year>
        <volume>12</volume>
        <fpage>602</fpage>
        <lpage>609</lpage>
        <pub-id pub-id-type="doi">10.1016/j.meegid.2011.08.032</pub-id>
        <pub-id pub-id-type="pmid">22067515</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bryant</surname>
            <given-names>JM</given-names>
          </name>
          <name>
            <surname>Harris</surname>
            <given-names>SR</given-names>
          </name>
          <name>
            <surname>Parkhill</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Dawson</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Diacon</surname>
            <given-names>AH</given-names>
          </name>
          <name>
            <surname>van Helden</surname>
            <given-names>P</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Whole-genome sequencing to establish relapse or re-infection with mycobacterium tuberculosis: a retrospective observational study</article-title>
        <source>Lancet Respir Med</source>
        <year>2013</year>
        <volume>1</volume>
        <fpage>786</fpage>
        <lpage>792</lpage>
        <pub-id pub-id-type="doi">10.1016/S2213-2600(13)70231-5</pub-id>
        <pub-id pub-id-type="pmid">24461758</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Guerra-Assunção</surname>
            <given-names>José Afonso</given-names>
          </name>
          <name>
            <surname>Houben</surname>
            <given-names>Rein M. G. J.</given-names>
          </name>
          <name>
            <surname>Crampin</surname>
            <given-names>Amelia C.</given-names>
          </name>
          <name>
            <surname>Mzembe</surname>
            <given-names>Themba</given-names>
          </name>
          <name>
            <surname>Mallard</surname>
            <given-names>Kim</given-names>
          </name>
          <name>
            <surname>Coll</surname>
            <given-names>Francesc</given-names>
          </name>
          <name>
            <surname>Khan</surname>
            <given-names>Palwasha</given-names>
          </name>
          <name>
            <surname>Banda</surname>
            <given-names>Louis</given-names>
          </name>
          <name>
            <surname>Chiwaya</surname>
            <given-names>Arthur</given-names>
          </name>
          <name>
            <surname>Pereira</surname>
            <given-names>Rui P. A.</given-names>
          </name>
          <name>
            <surname>McNerney</surname>
            <given-names>Ruth</given-names>
          </name>
          <name>
            <surname>Harris</surname>
            <given-names>David</given-names>
          </name>
          <name>
            <surname>Parkhill</surname>
            <given-names>Julian</given-names>
          </name>
          <name>
            <surname>Clark</surname>
            <given-names>Taane G.</given-names>
          </name>
          <name>
            <surname>Glynn</surname>
            <given-names>Judith R.</given-names>
          </name>
        </person-group>
        <article-title>Recurrence due to Relapse or Reinfection WithMycobacterium tuberculosis: A Whole-Genome Sequencing Approach in a Large, Population-Based Cohort With a High HIV Infection Prevalence and Active Follow-up</article-title>
        <source>Journal of Infectious Diseases</source>
        <year>2014</year>
        <volume>211</volume>
        <issue>7</issue>
        <fpage>1154</fpage>
        <lpage>1163</lpage>
        <pub-id pub-id-type="doi">10.1093/infdis/jiu574</pub-id>
        <pub-id pub-id-type="pmid">25336729</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sobkowiak</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Glynn</surname>
            <given-names>JR</given-names>
          </name>
          <name>
            <surname>Houben</surname>
            <given-names>RMGJ</given-names>
          </name>
          <name>
            <surname>Mallard</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Phelan</surname>
            <given-names>JE</given-names>
          </name>
          <name>
            <surname>Guerra-Assunção</surname>
            <given-names>JA</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Identifying mixed mycobacterium tuberculosis infections from whole genome sequence data</article-title>
        <source>BMC Genomics</source>
        <year>2018</year>
        <volume>19</volume>
        <fpage>613</fpage>
        <pub-id pub-id-type="doi">10.1186/s12864-018-4988-z</pub-id>
        <pub-id pub-id-type="pmid">30107785</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gan</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>Q</given-names>
          </name>
          <name>
            <surname>Yang</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Gao</surname>
            <given-names>Q</given-names>
          </name>
          <name>
            <surname>Luo</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>Deep whole-genome sequencing to detect mixed infection of mycobacterium tuberculosis</article-title>
        <source>PLoS One</source>
        <year>2016</year>
        <volume>11</volume>
        <fpage>1</fpage>
        <lpage>14</lpage>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ahn</surname>
            <given-names>TH</given-names>
          </name>
          <name>
            <surname>Chai</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Pan</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>Sigma: strain-level inference of genomes from metagenomic analysis for biosurveillance</article-title>
        <source>Bioinformatics.</source>
        <year>2015</year>
        <volume>31</volume>
        <fpage>170</fpage>
        <lpage>177</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btu641</pub-id>
        <pub-id pub-id-type="pmid">25266224</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <mixed-citation publication-type="other">Roosaare M, Vaher M, Kaplinski L, Möls M, Andreson R, Lepamets M, et al. StrainSeeker: Fast identification of bacterial strains from raw sequencing reads using user-provided guide trees. PeerJ. 2017;2017:1–16.</mixed-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <mixed-citation publication-type="other">Sankar A, Malone B, Bayliss SC, Pascoe B, Méric G, Hitchings MD, et al. Bayesian identification of bacterial strains from sequencing data. Microb genomics. 2016;2:e000075.</mixed-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hong</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Manimaran</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Shen</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Perez-Rogers</surname>
            <given-names>JF</given-names>
          </name>
          <name>
            <surname>Byrd</surname>
            <given-names>AL</given-names>
          </name>
          <name>
            <surname>Castro-Nallar</surname>
            <given-names>E</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>PathoScope 2.0: a complete computational framework for strain identification in environmental or clinical sequencing samples</article-title>
        <source>Microbiome</source>
        <year>2014</year>
        <volume>2</volume>
        <fpage>33</fpage>
        <pub-id pub-id-type="doi">10.1186/2049-2618-2-33</pub-id>
        <pub-id pub-id-type="pmid">25225611</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <mixed-citation publication-type="other">Shin SS, Modongo C, Baik Y, Allender C, Lemmer D, Colman RE, et al. Mixed Mycobacterium tuberculosis-Strain Infections Are Associated With Poor Treatment Outcomes Among Patients With Newly Diagnosed Tuberculosis, Independent of Pretreatment Heteroresistance. J Infect Dis. 2018;218:1974–82. 10.1093/infdis/jiy480.</mixed-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>O’Leary</surname>
            <given-names>NA</given-names>
          </name>
          <name>
            <surname>Wright</surname>
            <given-names>MW</given-names>
          </name>
          <name>
            <surname>Brister</surname>
            <given-names>JR</given-names>
          </name>
          <name>
            <surname>Ciufo</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Haddad</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>McVeigh</surname>
            <given-names>R</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Reference sequence (RefSeq) database at NCBI: current status, taxonomic expansion, and functional annotation</article-title>
        <source>Nucleic Acids Res</source>
        <year>2016</year>
        <volume>44</volume>
        <fpage>D733</fpage>
        <lpage>D745</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkv1189</pub-id>
        <pub-id pub-id-type="pmid">26553804</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Benson</surname>
            <given-names>DA</given-names>
          </name>
          <name>
            <surname>Karsch-Mizrachi</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Lipman</surname>
            <given-names>DJ</given-names>
          </name>
          <name>
            <surname>Ostell</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Sayers</surname>
            <given-names>EW</given-names>
          </name>
        </person-group>
        <article-title>GenBank</article-title>
        <source>Nucleic Acids Res</source>
        <year>2011</year>
        <volume>39</volume>
        <fpage>D32</fpage>
        <lpage>D37</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkq1079</pub-id>
        <pub-id pub-id-type="pmid">21071399</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Manson</surname>
            <given-names>Abigail L</given-names>
          </name>
          <name>
            <surname>Cohen</surname>
            <given-names>Keira A</given-names>
          </name>
          <name>
            <surname>Abeel</surname>
            <given-names>Thomas</given-names>
          </name>
          <name>
            <surname>Desjardins</surname>
            <given-names>Christopher A</given-names>
          </name>
          <name>
            <surname>Armstrong</surname>
            <given-names>Derek T</given-names>
          </name>
          <name>
            <surname>Barry</surname>
            <given-names>Clifton E</given-names>
          </name>
          <name>
            <surname>Brand</surname>
            <given-names>Jeannette</given-names>
          </name>
          <name>
            <surname>Chapman</surname>
            <given-names>Sinéad B</given-names>
          </name>
          <name>
            <surname>Cho</surname>
            <given-names>Sang-Nae</given-names>
          </name>
          <name>
            <surname>Gabrielian</surname>
            <given-names>Andrei</given-names>
          </name>
          <name>
            <surname>Gomez</surname>
            <given-names>James</given-names>
          </name>
          <name>
            <surname>Jodals</surname>
            <given-names>Andreea M</given-names>
          </name>
          <name>
            <surname>Joloba</surname>
            <given-names>Moses</given-names>
          </name>
          <name>
            <surname>Jureen</surname>
            <given-names>Pontus</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>Jong Seok</given-names>
          </name>
          <name>
            <surname>Malinga</surname>
            <given-names>Lesibana</given-names>
          </name>
          <name>
            <surname>Maiga</surname>
            <given-names>Mamoudou</given-names>
          </name>
          <name>
            <surname>Nordenberg</surname>
            <given-names>Dale</given-names>
          </name>
          <name>
            <surname>Noroc</surname>
            <given-names>Ecaterina</given-names>
          </name>
          <name>
            <surname>Romancenco</surname>
            <given-names>Elena</given-names>
          </name>
          <name>
            <surname>Salazar</surname>
            <given-names>Alex</given-names>
          </name>
          <name>
            <surname>Ssengooba</surname>
            <given-names>Willy</given-names>
          </name>
          <name>
            <surname>Velayati</surname>
            <given-names>A A</given-names>
          </name>
          <name>
            <surname>Winglee</surname>
            <given-names>Kathryn</given-names>
          </name>
          <name>
            <surname>Zalutskaya</surname>
            <given-names>Aksana</given-names>
          </name>
          <name>
            <surname>Via</surname>
            <given-names>Laura E</given-names>
          </name>
          <name>
            <surname>Cassell</surname>
            <given-names>Gail H</given-names>
          </name>
          <name>
            <surname>Dorman</surname>
            <given-names>Susan E</given-names>
          </name>
          <name>
            <surname>Ellner</surname>
            <given-names>Jerrold</given-names>
          </name>
          <name>
            <surname>Farnia</surname>
            <given-names>Parissa</given-names>
          </name>
          <name>
            <surname>Galagan</surname>
            <given-names>James E</given-names>
          </name>
          <name>
            <surname>Rosenthal</surname>
            <given-names>Alex</given-names>
          </name>
          <name>
            <surname>Crudu</surname>
            <given-names>Valeriu</given-names>
          </name>
          <name>
            <surname>Homorodean</surname>
            <given-names>Daniela</given-names>
          </name>
          <name>
            <surname>Hsueh</surname>
            <given-names>Po-Ren</given-names>
          </name>
          <name>
            <surname>Narayanan</surname>
            <given-names>Sujatha</given-names>
          </name>
          <name>
            <surname>Pym</surname>
            <given-names>Alexander S</given-names>
          </name>
          <name>
            <surname>Skrahina</surname>
            <given-names>Alena</given-names>
          </name>
          <name>
            <surname>Swaminathan</surname>
            <given-names>Soumya</given-names>
          </name>
          <name>
            <surname>Van der Walt</surname>
            <given-names>Martie</given-names>
          </name>
          <name>
            <surname>Alland</surname>
            <given-names>David</given-names>
          </name>
          <name>
            <surname>Bishai</surname>
            <given-names>William R</given-names>
          </name>
          <name>
            <surname>Cohen</surname>
            <given-names>Ted</given-names>
          </name>
          <name>
            <surname>Hoffner</surname>
            <given-names>Sven</given-names>
          </name>
          <name>
            <surname>Birren</surname>
            <given-names>Bruce W</given-names>
          </name>
          <name>
            <surname>Earl</surname>
            <given-names>Ashlee M</given-names>
          </name>
        </person-group>
        <article-title>Genomic analysis of globally diverse Mycobacterium tuberculosis strains provides insights into the emergence and spread of multidrug resistance</article-title>
        <source>Nature Genetics</source>
        <year>2017</year>
        <volume>49</volume>
        <issue>3</issue>
        <fpage>395</fpage>
        <lpage>402</lpage>
        <pub-id pub-id-type="doi">10.1038/ng.3767</pub-id>
        <pub-id pub-id-type="pmid">28092681</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kurtz</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Phillippy</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Delcher</surname>
            <given-names>AL</given-names>
          </name>
          <name>
            <surname>Smoot</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Shumway</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Antonescu</surname>
            <given-names>C</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Versatile and open software for comparing large genomes</article-title>
        <source>Genome Biol</source>
        <year>2004</year>
        <volume>5</volume>
        <fpage>R12</fpage>
        <pub-id pub-id-type="doi">10.1186/gb-2004-5-2-r12</pub-id>
        <?supplied-pmid 14759262?>
        <pub-id pub-id-type="pmid">14759262</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Walker</surname>
            <given-names>BJ</given-names>
          </name>
          <name>
            <surname>Abeel</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Shea</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Priest</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Abouelliel</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Sakthikumar</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Pilon: an integrated tool for comprehensive microbial variant detection and genome assembly improvement</article-title>
        <source>PLoS One</source>
        <year>2014</year>
        <volume>9</volume>
        <fpage>e112963</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0112963</pub-id>
        <?supplied-pmid 25409509?>
        <pub-id pub-id-type="pmid">25409509</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <source>Aligning sequence reads, clone sequences and assembly contigs with BWA-MEM</source>
        <year>2013</year>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Handsaker</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Wysoker</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Fennell</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Ruan</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Homer</surname>
            <given-names>N</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The sequence alignment/map format and SAMtools</article-title>
        <source>Bioinformatics.</source>
        <year>2009</year>
        <volume>25</volume>
        <fpage>2078</fpage>
        <lpage>2079</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btp352</pub-id>
        <?supplied-pmid 19505943?>
        <pub-id pub-id-type="pmid">19505943</pub-id>
      </element-citation>
    </ref>
    <ref id="CR29">
      <label>29.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Clark</surname>
            <given-names>TG</given-names>
          </name>
          <name>
            <surname>Mallard</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Coll</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Preston</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Assefa</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Harris</surname>
            <given-names>D</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Elucidating emergence and transmission of multidrug-resistant tuberculosis in treatment experienced patients by whole genome sequencing</article-title>
        <source>PLoS One</source>
        <year>2013</year>
        <volume>8</volume>
        <fpage>e83012</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0083012</pub-id>
        <?supplied-pmid 24349420?>
        <pub-id pub-id-type="pmid">24349420</pub-id>
      </element-citation>
    </ref>
    <ref id="CR30">
      <label>30.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Crispell</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Zadoks</surname>
            <given-names>RN</given-names>
          </name>
          <name>
            <surname>Harris</surname>
            <given-names>SR</given-names>
          </name>
          <name>
            <surname>Paterson</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Collins</surname>
            <given-names>DM</given-names>
          </name>
          <name>
            <surname>de-Lisle</surname>
            <given-names>GW</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Using whole genome sequencing to investigate transmission in a multi-host system: bovine tuberculosis in New Zealand</article-title>
        <source>BMC Genomics</source>
        <year>2017</year>
        <volume>18</volume>
        <fpage>180</fpage>
        <pub-id pub-id-type="doi">10.1186/s12864-017-3569-x</pub-id>
        <pub-id pub-id-type="pmid">28209138</pub-id>
      </element-citation>
    </ref>
    <ref id="CR31">
      <label>31.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sampson</surname>
            <given-names>SL</given-names>
          </name>
        </person-group>
        <article-title>Mycobacterial PE/PPE proteins at the host-pathogen interface</article-title>
        <source>Clin Dev Immunol</source>
        <year>2011</year>
        <volume>2011</volume>
        <fpage>497203</fpage>
        <pub-id pub-id-type="doi">10.1155/2011/497203</pub-id>
        <?supplied-pmid 21318182?>
        <pub-id pub-id-type="pmid">21318182</pub-id>
      </element-citation>
    </ref>
    <ref id="CR32">
      <label>32.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Albanese</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Donati</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>Strain profiling and epidemiology of bacterial species from metagenomic sequencing</article-title>
        <source>Nat Commun</source>
        <year>2017</year>
        <volume>8</volume>
        <fpage>2260</fpage>
        <pub-id pub-id-type="doi">10.1038/s41467-017-02209-5</pub-id>
        <pub-id pub-id-type="pmid">29273717</pub-id>
      </element-citation>
    </ref>
    <ref id="CR33">
      <label>33.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Huang</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Myers</surname>
            <given-names>JR</given-names>
          </name>
          <name>
            <surname>Marth</surname>
            <given-names>GT</given-names>
          </name>
        </person-group>
        <article-title>ART: a next-generation sequencing read simulator</article-title>
        <source>Bioinformatics.</source>
        <year>2012</year>
        <volume>28</volume>
        <fpage>593</fpage>
        <lpage>594</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btr708</pub-id>
        <pub-id pub-id-type="pmid">22199392</pub-id>
      </element-citation>
    </ref>
    <ref id="CR34">
      <label>34.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Leinonen</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Sugawara</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Shumway</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>International Nucleotide Sequence Database Collaboration. The sequence read archive</article-title>
        <source>Nucleic Acids Res</source>
        <year>2011</year>
        <volume>39</volume>
        <fpage>D19</fpage>
        <lpage>D21</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkq1019</pub-id>
        <pub-id pub-id-type="pmid">21062823</pub-id>
      </element-citation>
    </ref>
    <ref id="CR35">
      <label>35.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Price</surname>
            <given-names>MN</given-names>
          </name>
          <name>
            <surname>Dehal</surname>
            <given-names>PS</given-names>
          </name>
          <name>
            <surname>Arkin</surname>
            <given-names>AP</given-names>
          </name>
        </person-group>
        <article-title>FastTree: computing large minimum evolution trees with profiles instead of a distance matrix</article-title>
        <source>Mol Biol Evol</source>
        <year>2009</year>
        <volume>26</volume>
        <fpage>1641</fpage>
        <lpage>1650</lpage>
        <pub-id pub-id-type="doi">10.1093/molbev/msp077</pub-id>
        <pub-id pub-id-type="pmid">19377059</pub-id>
      </element-citation>
    </ref>
    <ref id="CR36">
      <label>36.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Coscolla</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Gagneux</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Consequences of genomic diversity in mycobacterium tuberculosis</article-title>
        <source>Semin Immunol</source>
        <year>2014</year>
        <volume>26</volume>
        <fpage>431</fpage>
        <lpage>444</lpage>
        <pub-id pub-id-type="doi">10.1016/j.smim.2014.09.012</pub-id>
        <pub-id pub-id-type="pmid">25453224</pub-id>
      </element-citation>
    </ref>
    <ref id="CR37">
      <label>37.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pérez-Lago</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Comas</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Navarro</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>González-Candelas</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Herranz</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Bouza</surname>
            <given-names>E</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Whole genome sequencing analysis of Intrapatient microevolution in mycobacterium tuberculosis: potential impact on the inference of tuberculosis transmission</article-title>
        <source>J Infect Dis</source>
        <year>2014</year>
        <volume>209</volume>
        <fpage>98</fpage>
        <lpage>108</lpage>
        <pub-id pub-id-type="doi">10.1093/infdis/jit439</pub-id>
        <pub-id pub-id-type="pmid">23945373</pub-id>
      </element-citation>
    </ref>
    <ref id="CR38">
      <label>38.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Feliciano</surname>
            <given-names>CS</given-names>
          </name>
          <name>
            <surname>Namburete</surname>
            <given-names>EI</given-names>
          </name>
          <name>
            <surname>Rodrigues Plaça</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Peronni</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Dippenaar</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Warren</surname>
            <given-names>RM</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Accuracy of whole genome sequencing versus phenotypic (MGIT) and commercial molecular tests for detection of drug-resistant mycobacterium tuberculosis isolated from patients in Brazil and Mozambique</article-title>
        <source>Tuberculosis.</source>
        <year>2018</year>
        <volume>110</volume>
        <fpage>59</fpage>
        <lpage>67</lpage>
        <pub-id pub-id-type="doi">10.1016/j.tube.2018.04.003</pub-id>
        <pub-id pub-id-type="pmid">29779775</pub-id>
      </element-citation>
    </ref>
    <ref id="CR39">
      <label>39.</label>
      <mixed-citation publication-type="other">Bradley P, Gordon NC, Walker TM, Dunn L, Heys S, Huang B, et al. Rapid antibiotic-resistance predictions from genome sequence data for Staphylococcus aureus and Mycobacterium tuberculosis. Nat Commun. 2015;6:10063. doi:10.1038/ncomms10063.</mixed-citation>
    </ref>
    <ref id="CR40">
      <label>40.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Walker</surname>
            <given-names>TM</given-names>
          </name>
          <name>
            <surname>Kohl</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Omar</surname>
            <given-names>SV</given-names>
          </name>
          <name>
            <surname>Hedge</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Del Ojo Elias</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Bradley</surname>
            <given-names>P</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Whole-genome sequencing for prediction of <italic>Mycobacterium tuberculosis</italic> drug susceptibility and resistance: a retrospective cohort study</article-title>
        <source>Lancet Infect Dis</source>
        <year>2015</year>
        <volume>3099</volume>
        <fpage>1</fpage>
        <lpage>10</lpage>
        <pub-id pub-id-type="doi">10.1016/S1473-3099(15)00062-6</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
