<?open_access?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Nucleic Acids Res</journal-id>
    <journal-id journal-id-type="publisher-id">Nucleic Acids Research</journal-id>
    <journal-title>Nucleic Acids Research</journal-title>
    <issn pub-type="ppub">0305-1048</issn>
    <issn pub-type="epub">1362-4962</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">1160138</article-id>
    <article-id pub-id-type="doi">10.1093/nar/gki377</article-id>
    <article-id pub-id-type="pmid">15980531</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>MuPlex: multi-objective multiplex PCR assay design</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Rachlin</surname>
          <given-names>John</given-names>
        </name>
        <xref ref-type="aff" rid="au1">1</xref>
        <xref ref-type="corresp" rid="cor1">*</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Ding</surname>
          <given-names>Chunming</given-names>
        </name>
        <xref ref-type="aff" rid="au2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Cantor</surname>
          <given-names>Charles</given-names>
        </name>
        <xref ref-type="aff" rid="au1">1</xref>
        <xref ref-type="aff" rid="au3">3</xref>
        <xref ref-type="aff" rid="au4">4</xref>
        <xref ref-type="aff" rid="au6">6</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Kasif</surname>
          <given-names>Simon</given-names>
        </name>
        <xref ref-type="aff" rid="au1">1</xref>
        <xref ref-type="aff" rid="au3">3</xref>
        <xref ref-type="aff" rid="au5">5</xref>
      </contrib>
      <aff id="au1">
        <sup>1</sup>
        <institution>Bioinformatics Program, Boston University</institution>
        <addr-line>Boston, MA 02215, USA</addr-line>
      </aff>
      <aff id="au2">
        <sup>2</sup>
        <institution>Centre for Emerging Infectious Diseases, The Chinese University of Hong Kong, Prince of Wales Hospital</institution>
        <addr-line>Shatin, New Territories, Hong Kong Special Administrative Region, China</addr-line>
      </aff>
      <aff id="au3">
        <sup>3</sup>
        <institution>Department of Biomedical Engineering, Boston University</institution>
        <addr-line>Boston, MA 02215, USA</addr-line>
      </aff>
      <aff id="au4">
        <sup>4</sup>
        <institution>Center for Advanced Biotechnology, Boston University</institution>
        <addr-line>Boston, MA 02215, USA</addr-line>
      </aff>
      <aff id="au5">
        <sup>5</sup>
        <institution>Center for Advanced Genomic Technologies, Boston University</institution>
        <addr-line>Boston, MA 02215, USA</addr-line>
      </aff>
      <aff id="au6">
        <sup>6</sup>
        <institution>SEQUENOM, Inc.</institution>
        <addr-line>San Diego, CA 92121-1331, USA</addr-line>
      </aff>
    </contrib-group>
    <author-notes>
      <corresp id="cor1"><sup>*</sup>To whom correspondence should be addressed. Tel: +1 617 921 9669; Fax: +1 617 353 4814; Email: <email>rachlin@bu.edu</email></corresp>
    </author-notes>
    <!--For NAR: both ppub and collection dates generated for PMC processing 1/27/05 beck-->
    <pub-date pub-type="collection">
      <day>01</day>
      <month>7</month>
      <year>2005</year>
    </pub-date>
    <pub-date pub-type="ppub">
      <day>01</day>
      <month>7</month>
      <year>2005</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>27</day>
      <month>6</month>
      <year>2005</year>
    </pub-date>
    <volume>33</volume>
    <issue>Web Server issue</issue>
    <fpage>W544</fpage>
    <lpage>W547</lpage>
    <history>
      <date date-type="received">
        <day>14</day>
        <month>2</month>
        <year>2005</year>
      </date>
      <date date-type="rev-recd">
        <day>08</day>
        <month>3</month>
        <year>2005</year>
      </date>
      <date date-type="accepted">
        <day>08</day>
        <month>3</month>
        <year>2005</year>
      </date>
    </history>
    <copyright-statement>© The Author 2005. Published by Oxford University Press. All rights reserved</copyright-statement>
    <copyright-year>2005</copyright-year>
    <license license-type="openaccess">
      <p>The online version of this article has been published under an open access model. Users are entitled to use, reproduce, disseminate, or display the open access version of this article for non-commercial purposes provided that: the original authorship is properly and fully attributed; the Journal and Oxford University Press are attributed as the original place of publication with the correct citation details given; if an article is subsequently reproduced or disseminated not in its entirety but only in part or as a derivative work this must be clearly indicated. For commercial re-use, please contact <email>journals.permissions@oupjournals.org</email></p>
    </license>
    <abstract>
      <p>We have developed a web-enabled system called MuPlex that aids researchers in the design of multiplex PCR assays. Multiplex PCR is a key technology for an endless list of applications, including detecting infectious microorganisms, whole-genome sequencing and closure, forensic analysis and for enabling flexible yet low-cost genotyping. However, the design of a multiplex PCR assays is computationally challenging because it involves tradeoffs among competing objectives, and extensive computational analysis is required in order to screen out primer-pair cross interactions. With MuPlex, users specify a set of DNA sequences along with primer selection criteria, interaction parameters and the target multiplexing level. MuPlex designs a set of multiplex PCR assays designed to cover as many of the input sequences as possible. MuPlex provides multiple solution alternatives that reveal tradeoffs among competing objectives. MuPlex is uniquely designed for large-scale multiplex PCR assay design in an automated high-throughput environment, where high coverage of potentially thousands of single nucleotide polymorphisms is required. The server is available at <ext-link ext-link-type="uri" xlink:href="http://genomics14.bu.edu:8080/MuPlex/MuPlex.html"/>.</p>
    </abstract>
  </article-meta>
</front>
<body>
  <sec>
    <title>INTRODUCTION</title>
    <p>MuPlex (<ext-link ext-link-type="uri" xlink:href="http://genomics14.bu.edu:8080/MuPlex/MuPlex.html"/>) is a web-enabled system for designing multiplex PCR assays. A multiplex PCR solution specifies a forward and reverse primer for each single nucleotide polymorphism (SNP) and assigns each primer pair to one of a finite set of tubes. In partitioning SNP primers into individual tubes, care must be taken to ensure that all primers within a tube are mutually compatible, i.e. that they do not form primer-dimers through cross-hybridization, which would otherwise reduce target product yield. The multiplex PCR problem is equivalent to partitioning a graph <italic>G</italic>(<italic>V</italic>, <italic>E</italic>) into a set of disjoint cliques, where nodes represent SNPs, edges connect two SNPs whose associated primers are tube-compatible and resulting cliques constitute valid multiplex PCR tubes. The problem of partitioning a graph into <italic>k</italic> ≤ <italic>K</italic> disjoint cliques is NP-complete (<xref ref-type="bibr" rid="b1">1</xref>). The MuPlex system is unique in that it provides multiple design alternatives that reveal inherent tradeoffs with respect to multiple competing objectives, such as average tube size, tube size uniformity and overall SNP coverage.</p>
    <p>Multiplex PCR is a core enabling technology for high-throughput SNP genotyping, serving as a foundation for applications in forensic analysis, including human identification and paternity testing (<xref ref-type="bibr" rid="b2">2</xref>), the diagnosis of infectious diseases (<xref ref-type="bibr" rid="b3">3</xref>,<xref ref-type="bibr" rid="b4">4</xref>), whole-genome sequencing (<xref ref-type="bibr" rid="b5">5</xref>), and pharmacogenomic studies aimed at understanding the connection between individual genetic traits, drug response and disease susceptibility (<xref ref-type="bibr" rid="b6">6</xref>).</p>
    <p>For example, in the hME assay (<xref ref-type="bibr" rid="b7">7</xref>), genomic sequences containing the SNPs of interest are first amplified by PCR. After shrimp alkaline phosphatase digestion of excess dNTPs, a primer extension reaction is carried out to interrogate the SNPs. The primer extension products (often oligonucleotides ∼18 to 25 bases long) are then detected by matrix-assisted laser desorption ionization time-of-flight (MALDI-TOF) mass spectrometry. Given the large molecular weight window (4500–9000 Da) and the high resolution of the mass spectrometry, 20 or more SNPs can be easily and simultaneously genotyped. Thus, the throughput-limiting step is often the PCR plex level. In a 384-well format with 20-plex PCR, the per-SNP cost can be reduced to just a few cents while a single MALDI-TOF mass spectrometry can be used to genotype 76 800 SNPs by a single operator in 1 day.</p>
    <sec>
      <title>MuPlex features</title>
      <p>Given a set of DNA sequences and a SNP location at each, the system aims at designing (i) a set of pair forward and reverse primers for each sequence; (ii) a placement of these primers into maximal size tubes such that the coverage (number of sequences) included in the PCR assay is maximized. <xref ref-type="fig" rid="fig1">Figure 1</xref> presents the MuPlex home page where specific problems may be submitted. (No user registration or fee is required.) The user provides a set of SNPs and associated flanking sequences in the standard FASTA format. These sequences may be entered manually or uploaded from a file. To improve primer specificity, users may instruct the MuPlex server to filter resulting primer candidates by aligning them against the human genome using BLAT (<xref ref-type="bibr" rid="b8">8</xref>). In addition to the SNP sequences, the user specifies primer selection criteria, including length, GC content, positional constraints, and melting temperature <italic>T</italic><sub>m</sub> constraints for individual primer oligos as well as interaction parameters (maximum local alignment score, 3′ tail Δ<italic>G</italic>), and a maximum <italic>T</italic><sub>m</sub> range for all primer pairs within a single multiplex assay.</p>
      <p>MuPlex then solves the dual problem of selecting primer pairs for amplifying the flanking sequence of each SNP and partitions these primer pairs into multiplex compatible sets each corresponding to a single multiplex PCR tube reaction. As noted above, MuPlex generates multiple solutions alternative each corresponding to a set of multiplex PCR tubes.</p>
      <p>Each solution is evaluated with respect to the following objectives:
<list list-type="roman-lower"><list-item><p>Total number of tubes required.</p></list-item><list-item><p>Minimum, average and maximum tube size (multiplexing level).</p></list-item><list-item><p>Number of unique tube sizes.</p></list-item><list-item><p>Total SNP coverage measured both in terms of the percentage of SNPs (associated primer pairs) assigned to maximum-sized tubes, as well as the percentage of SNPs assigned to tubes of any size.</p></list-item></list></p>
      <p>For example, some solutions may achieve higher overall multiplexing levels but at the expense of lower coverage, i.e. by excluding some SNPs from the solution. In addition, MuPlex tries to minimize the number of unique tube sizes in order to facilitate automation in a high-throughput genomics environment. Resulting solutions are emailed to the user. The email contains a solution summary allowing quick comparison of each alternative, and details for each solution including the selected primers, their individual properties and assigned tube.</p>
      <p>MuPlex employs a number of heuristic algorithms and allows new algorithms to be added over time. Solution time depends on the number of solution alternatives requested, the number of SNPs and the target multiplexing level. For typical problems involving &lt;100 SNPs, multiple solutions can often be generated in 5–10 min.</p>
    </sec>
  </sec>
  <sec>
    <title>ARCHITECTURE</title>
    <p>MuPlex is written entirely in Java (j2sdk1.4.2_05) and employs the Apache Jakarta Tomcat server (<ext-link ext-link-type="uri" xlink:href="http://jakarta.apache.org/tomcat"/>) connected to a backend mySQL database (<ext-link ext-link-type="uri" xlink:href="http://www.mysql.com"/>). Individual solvers operate asynchronously on a network of workstations running a customized distribution of the Linux operating system based on Fedora Core 3 (<ext-link ext-link-type="uri" xlink:href="http://fedora.redhat.com"/>). These solvers monitor the MuPlex database for the arrival of new problems. New problems are assigned to the first available solver. As depicted in <xref ref-type="fig" rid="fig2">Figure 2</xref>, the solver maintains a population of candidate solutions. Each solution is evaluated with respect to a set of registered objectives. Agents encapsulating specific algorithms either create new solutions from scratch, improve or modify existing solutions, or remove unpromising solutions from further consideration. For example, one ‘creator’ algorithm is based on a best-fit methodology that iteratively assigns SNPs to the largest open compatible tube. When the tube size reaches the target multiplexing level specified by the user, it is closed, and no further additions or modifications to that tube are made. Each unassigned SNP is assigned a new primer pair candidate and the process repeats. One improver algorithm eliminates partial tubes in order to reduce the number of unique tube sizes but while incurring reduced coverage, while another attempts at reformulating partial tubes in an effort to identify additional full tubes. Efficiency is enhanced during the optimization process by periodically culling unpromising solutions from the population of candidates. The architecture is scaleable in the sense that new algorithms can be readily plugged-in over time, and it is robust in that it does not depend on a single algorithm to generate every viable alternative, and because system load is balanced across a distributed collection of solvers.</p>
    <p>Within a given solution, there is no guarantee that a SNP will be assigned, and the results depend on the random order in which SNPs and primers are processed. Resulting coverage critically depends on the number of SNPs and the target level of multiplexing desired (J. Rachlin, C. M. Ding, C. Cantor and S. Kasif, manuscript submitted).</p>
  </sec>
  <sec>
    <title>CONCLUSIONS AND FUTURE WORK</title>
    <p>The MuPlex server allows scientists to design Multiplex PCR assays while explicitly considering intrinsic design tradeoffs. The consideration of competing alternatives has played a key role in the development of optimization and decision-support technologies in complex domains such as manufacturing and transportation logistics (<xref ref-type="bibr" rid="b9">9</xref>,<xref ref-type="bibr" rid="b10">10</xref>). Here, we have demonstrated the viability of such approaches to the optimization of multiplex PCR assays. Future efforts will focus on the development of new algorithms and on allowing users to impose dynamic feedback constraints in an effort to further guide the design optimization process towards solutions that more closely meet the scientist's particular design objectives. We also plan to develop a distributed version that will run on our 128-processor Linux cluster.</p>
  </sec>
</body>
<back>
  <ack>
    <p>The authors thank Noga Alon and Richard Beigel for many profound insights and suggestions. This work is supported in part by NSF grants DBI-0239435 and ITR-048715 and NHGRI grant #1R33HG002850-01A1. Funding to pay the Open Access publication charges for this article was provided by NHGRI.</p>
    <p><italic>Conflict of interest statement</italic>. None declared.</p>
  </ack>
  <ref-list>
    <title>REFERENCES</title>
    <ref id="b1">
      <label>1</label>
      <citation citation-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Garey</surname>
            <given-names>M.R.</given-names>
          </name>
          <name>
            <surname>Johnson</surname>
            <given-names>D.S.</given-names>
          </name>
        </person-group>
        <source>Computers and Intractability: A Guide to the Theory of NP-Completeness</source>
        <year>1979</year>
        <publisher-loc>San Francisco, CA</publisher-loc>
        <publisher-name>W.H. Freeman</publisher-name>
      </citation>
    </ref>
    <ref id="b2">
      <label>2</label>
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Inagaki</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Yamamoto</surname>
            <given-names>Y.</given-names>
          </name>
          <name>
            <surname>Doi</surname>
            <given-names>Y.</given-names>
          </name>
          <name>
            <surname>Takata</surname>
            <given-names>T.</given-names>
          </name>
          <name>
            <surname>Ishikawa</surname>
            <given-names>T.</given-names>
          </name>
          <name>
            <surname>Imabayashi</surname>
            <given-names>K.</given-names>
          </name>
          <name>
            <surname>Yoshitome</surname>
            <given-names>K.</given-names>
          </name>
          <name>
            <surname>Miyaishi</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Ishizu</surname>
            <given-names>H.</given-names>
          </name>
        </person-group>
        <article-title>A new 39-plex analysis method for SNPs including 15 blood group loci</article-title>
        <source>Forensic Sci. Int.</source>
        <year>2004</year>
        <volume>144</volume>
        <fpage>45</fpage>
        <lpage>57</lpage>
        <pub-id pub-id-type="pmid">15240020</pub-id>
      </citation>
    </ref>
    <ref id="b3">
      <label>3</label>
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Elnifro</surname>
            <given-names>E.</given-names>
          </name>
          <name>
            <surname>Ashshi</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Cooper</surname>
            <given-names>R.</given-names>
          </name>
          <name>
            <surname>Klapper</surname>
            <given-names>P.</given-names>
          </name>
        </person-group>
        <article-title>Multiplex PCR: optimization and application in diagnostic virology</article-title>
        <source>Clin. Microbiol. Rev.</source>
        <year>2000</year>
        <volume>13</volume>
        <fpage>559</fpage>
        <lpage>570</lpage>
        <pub-id pub-id-type="pmid">11023957</pub-id>
      </citation>
    </ref>
    <ref id="b4">
      <label>4</label>
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pinar</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Bozdemir</surname>
            <given-names>N.</given-names>
          </name>
          <name>
            <surname>Kocagoz</surname>
            <given-names>T.</given-names>
          </name>
          <name>
            <surname>Alacam</surname>
            <given-names>R.</given-names>
          </name>
        </person-group>
        <article-title>Rapid detection of bacterial atypical pneumonia agents by multiplex PCR</article-title>
        <source>Cent. Eur. J. Public Health</source>
        <year>2004</year>
        <volume>12</volume>
        <fpage>3</fpage>
        <lpage>5</lpage>
        <pub-id pub-id-type="pmid">15068198</pub-id>
      </citation>
    </ref>
    <ref id="b5">
      <label>5</label>
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tettelin</surname>
            <given-names>H.</given-names>
          </name>
          <name>
            <surname>Radune</surname>
            <given-names>D.</given-names>
          </name>
          <name>
            <surname>Kasif</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Khouri</surname>
            <given-names>H.</given-names>
          </name>
          <name>
            <surname>Salzberg</surname>
            <given-names>S.</given-names>
          </name>
        </person-group>
        <article-title>Optimized multiplex PCR: efficiently closing a whole-genome shotgun sequencing project</article-title>
        <source>Genomics</source>
        <year>1999</year>
        <volume>62</volume>
        <fpage>500</fpage>
        <lpage>507</lpage>
        <pub-id pub-id-type="pmid">10644449</pub-id>
      </citation>
    </ref>
    <ref id="b6">
      <label>6</label>
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Shi</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Bleavins</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>de la Iglesia</surname>
            <given-names>F.</given-names>
          </name>
        </person-group>
        <article-title>Technologies for detecting genetic polymorphisms in pharmacogenomics</article-title>
        <source>Mol. Diagn.</source>
        <year>1999</year>
        <volume>4</volume>
        <fpage>343</fpage>
        <lpage>351</lpage>
        <pub-id pub-id-type="pmid">10671645</pub-id>
      </citation>
    </ref>
    <ref id="b7">
      <label>7</label>
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tang</surname>
            <given-names>K.</given-names>
          </name>
          <name>
            <surname>Fu</surname>
            <given-names>D.J.</given-names>
          </name>
          <name>
            <surname>Julien</surname>
            <given-names>D.</given-names>
          </name>
          <name>
            <surname>Braun</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Cantor</surname>
            <given-names>C.R.</given-names>
          </name>
          <name>
            <surname>Koster</surname>
            <given-names>H.</given-names>
          </name>
        </person-group>
        <article-title>Chip-based genotyping by mass spectrometry</article-title>
        <source>Proc. Natl Acad. Sci. USA</source>
        <year>1999</year>
        <volume>96</volume>
        <fpage>10016</fpage>
        <lpage>10020</lpage>
        <pub-id pub-id-type="pmid">10468554</pub-id>
      </citation>
    </ref>
    <ref id="b8">
      <label>8</label>
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kent</surname>
            <given-names>W.J.</given-names>
          </name>
        </person-group>
        <article-title>BLAT: the BLAST-like alignment tool</article-title>
        <source>Genome Res.</source>
        <year>2002</year>
        <volume>12</volume>
        <fpage>656</fpage>
        <lpage>664</lpage>
        <pub-id pub-id-type="pmid">11932250</pub-id>
      </citation>
    </ref>
    <ref id="b9">
      <label>9</label>
      <citation citation-type="other">
        <person-group person-group-type="author">
          <name>
            <surname>Murthy</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Rachlin</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Akkiraju</surname>
            <given-names>R.</given-names>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>F.</given-names>
          </name>
        </person-group>
        <article-title>Agent-Based Cooperative Scheduling</article-title>
        <source>Constraints &amp; Agents</source>
        <year>1997</year>
        <comment>Technical Report WS 1997-97-05</comment>
      </citation>
    </ref>
    <ref id="b10">
      <label>10</label>
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rachlin</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Goodwin</surname>
            <given-names>R.</given-names>
          </name>
          <name>
            <surname>Murthy</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Akkiraju</surname>
            <given-names>R.</given-names>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>F.</given-names>
          </name>
          <name>
            <surname>Kumaran</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Das</surname>
            <given-names>R.</given-names>
          </name>
        </person-group>
        <article-title>A-Teams: An Agent Architecture for Optimization and Decision-Support. Lecture Notes in Artificial Intelligence</article-title>
        <year>1999</year>
        <volume>1555</volume>
      </citation>
    </ref>
  </ref-list>
  <sec sec-type="display-objects">
    <title>Figures and Tables</title>
    <fig id="fig1" position="float">
      <label>Figure 1</label>
      <caption>
        <p>The MuPlex homepage. Users specify primer selection criteria and provide a collection of SNPs in the FASTA format. The system emails to the user one or more solution alternatives revealing key design tradeoffs.</p>
      </caption>
      <graphic xlink:href="gki377f1"/>
    </fig>
    <fig id="fig2" position="float">
      <label>Figure 2</label>
      <caption>
        <p>The MuPlex Optimizer. Once a problem is submitted and validated, it is assigned to one of the several solvers distributed across the network. Each solver instantiates one or more agents (algorithms) that either create new solutions from scratch, attempt to improve an existing solution candidate or eliminate unpromising solutions from further consideration. The collaboration of algorithms in this manner enables the system to produce multiple Multiplex PCR solutions that reveal intrinsic design tradeoffs.</p>
      </caption>
      <graphic xlink:href="gki377f2"/>
    </fig>
  </sec>
</back>
