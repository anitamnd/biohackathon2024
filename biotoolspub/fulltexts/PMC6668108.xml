<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>BMC Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">6668108</article-id>
    <article-id pub-id-type="publisher-id">2991</article-id>
    <article-id pub-id-type="doi">10.1186/s12859-019-2991-2</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>HIV drug resistance prediction with weighted categorical kernel functions</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-7953-8115</contrib-id>
        <name>
          <surname>Ramon</surname>
          <given-names>Elies</given-names>
        </name>
        <address>
          <email>elies.ramon@cragenomica.es</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Belanche-Muñoz</surname>
          <given-names>Lluís</given-names>
        </name>
        <address>
          <email>belanche@cs.upc.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Pérez-Enciso</surname>
          <given-names>Miguel</given-names>
        </name>
        <address>
          <email>miguel.perez@uab.es</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="GRID">grid.7080.f</institution-id><institution>Centre for Research in Agricultural Genomics (CRAG), </institution><institution>CSIC-IRTA-UAB-UB Consortium, Campus UAB, </institution></institution-wrap>08193 Bellaterra, Barcelona, Spain </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="GRID">grid.6835.8</institution-id><institution>Computer Science Department, </institution><institution>Technical University of Catalonia, </institution></institution-wrap>Carrer de Jordi Girona 1-3, 08034 Barcelona, Spain </aff>
      <aff id="Aff3"><label>3</label>Institució Catalana de Recerca i Estudis Avançats (ICREA), Passeig de Lluís Companys 23, 08010 Barcelona, Spain </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>30</day>
      <month>7</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>30</day>
      <month>7</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2019</year>
    </pub-date>
    <volume>20</volume>
    <elocation-id>410</elocation-id>
    <history>
      <date date-type="received">
        <day>28</day>
        <month>2</month>
        <year>2019</year>
      </date>
      <date date-type="accepted">
        <day>11</day>
        <month>7</month>
        <year>2019</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s). 2019</copyright-statement>
      <license license-type="OpenAccess">
        <license-p><bold>Open Access</bold>This article is distributed under the terms of the Creative Commons Attribution 4.0 International License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p id="Par1">Antiretroviral drugs are a very effective therapy against HIV infection. However, the high mutation rate of HIV permits the emergence of variants that can be resistant to the drug treatment. Predicting drug resistance to previously unobserved variants is therefore very important for an optimum medical treatment. In this paper, we propose the use of weighted categorical kernel functions to predict drug resistance from virus sequence data. These kernel functions are very simple to implement and are able to take into account HIV data particularities, such as allele mixtures, and to weigh the different importance of each protein residue, as it is known that not all positions contribute equally to the resistance.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p id="Par2">We analyzed 21 drugs of four classes: protease inhibitors (PI), integrase inhibitors (INI), nucleoside reverse transcriptase inhibitors (NRTI) and non-nucleoside reverse transcriptase inhibitors (NNRTI). We compared two categorical kernel functions, Overlap and Jaccard, against two well-known noncategorical kernel functions (Linear and RBF) and Random Forest (RF). Weighted versions of these kernels were also considered, where the weights were obtained from the RF decrease in node impurity. The Jaccard kernel was the best method, either in its weighted or unweighted form, for 20 out of the 21 drugs.</p>
      </sec>
      <sec>
        <title>Conclusions</title>
        <p id="Par3">Results show that kernels that take into account both the categorical nature of the data and the presence of mixtures consistently result in the best prediction model. The advantage of including weights depended on the protein targeted by the drug. In the case of reverse transcriptase, weights based in the relative importance of each position clearly increased the prediction performance, while the improvement in the protease was much smaller. This seems to be related to the distribution of weights, as measured by the Gini index. All methods described, together with documentation and examples, are freely available at <ext-link ext-link-type="uri" xlink:href="https://bitbucket.org/elies_ramon/catkern">https://bitbucket.org/elies_ramon/catkern</ext-link>.</p>
      </sec>
      <sec>
        <title>Electronic supplementary material</title>
        <p>The online version of this article (10.1186/s12859-019-2991-2) contains supplementary material, which is available to authorized users.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>HIV</kwd>
      <kwd>Drug resistance prediction</kwd>
      <kwd>Categorical kernel</kwd>
      <kwd>Weighted kernel</kwd>
      <kwd>PI</kwd>
      <kwd>NRTI</kwd>
      <kwd>NNRTI</kwd>
      <kwd>INI</kwd>
      <kwd>Machine learning</kwd>
      <kwd>Support vector machine</kwd>
      <kwd>Random Forest</kwd>
      <kwd>Kernel PCA</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100003329</institution-id>
            <institution>Ministerio de Economía y Competitividad</institution>
          </institution-wrap>
        </funding-source>
        <award-id>AGL2016-78709-R</award-id>
        <principal-award-recipient>
          <name>
            <surname>Pérez-Enciso</surname>
            <given-names>Miguel</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100002809</institution-id>
            <institution>Generalitat de Catalunya</institution>
          </institution-wrap>
        </funding-source>
        <award-id>2018FI_B1_00189</award-id>
        <principal-award-recipient>
          <name>
            <surname>Ramon</surname>
            <given-names>Elies</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2019</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p id="Par41">HIV is a retrovirus that infects human immune cells, causing a progressive weakening of the immune system. When untreated, the affected person develops acquired immunodeficiency syndrome (AIDS), which leads to a rise of opportunistic infections and, finally, death. HIV has infected more than 35 million people worldwide and is considered a global pandemic [<xref ref-type="bibr" rid="CR1">1</xref>]. Despite the efforts, to date there is no definitive cure that eradicates the virus from the organism. However, the lifespan and quality of life of many people that live with HIV have expanded greatly thanks to antiretroviral therapy. Antiretroviral drugs lower the virus level in blood by targeting different stages of the virus life cycle. The most important classes of antiretroviral drugs are protease inhibitors (PIs), which target the protease, and nucleoside and non-nucleoside reverse transcriptase inhibitors (NRTIs and NNRTIs, respectively) which target the reverse transcriptase. Other classes of antiretroviral drugs are the integrase inhibitors (INIs) and the fusion inhibitors.</p>
    <p id="Par42">Some of the main reasons why HIV is so difficult to fight are its short life cycle (1–2 days), high replication rate (10<sup>8</sup>–10<sup>9</sup> new virions each day), and high mutation rate (10<sup>− 4</sup>–10<sup>− 5</sup> mutations per nucleotide site per replication cycle) caused because reverse transcriptase lacks proofreading activity. This permits the fast emergence of new HIV variants, some of which may be resistant to the drug treatment [<xref ref-type="bibr" rid="CR2">2</xref>]. These variants can be transmitted, and some studies show that ~ 10% of patients who had never been on antiretroviral therapy carry at least one resistant HIV [<xref ref-type="bibr" rid="CR3">3</xref>]. Cross-resistance (simultaneous resistance to two or more drugs, often of the same class) is also a common phenomenon. It is therefore advisable to do a resistance test before the treatment to find the best drug choice [<xref ref-type="bibr" rid="CR2">2</xref>, <xref ref-type="bibr" rid="CR4">4</xref>], especially in developing countries, as recommended by the WHO and the International AIDS Society-USA Panel [<xref ref-type="bibr" rid="CR3">3</xref>]. A resistance test can be performed in vitro, obtaining HIV samples from the patient and using them to infect host cells cultured in presence of increasing levels of drug concentration. The virus susceptibility is then obtained empirically as the IC50 [<xref ref-type="bibr" rid="CR4">4</xref>] and usually delivered as the relative IC50 (resistance of the virus variant compared to the wild type). Another strategy is to infer the HIV variant resistance from its sequence. This can be either gene sequence or the translated protein sequence; this latter approach eliminates the noise of synonymous mutations. In any case, as genome sequencing is cheaper, faster and more widely available than performing an in vitro drug susceptibility test, much effort has been invested in developing algorithms that predict the drug resistance from the virus sequence [<xref ref-type="bibr" rid="CR5">5</xref>].</p>
    <p id="Par43">The first attempts of automatic prediction can be traced back, at least, to the early 2000s [<xref ref-type="bibr" rid="CR6">6</xref>]. These approaches were rule-based: study the mutational profile of the HIV variant to look for known major drug-associated resistance mutations (lists of these mutations are periodically updated and can be found in reviews, e.g., [<xref ref-type="bibr" rid="CR7">7</xref>]). The rule-based algorithms continue to be used to this day because of their interpretability. Some publicly available examples are the Stanford HIVdb, Rega or ANRS softwares [<xref ref-type="bibr" rid="CR5">5</xref>]. However, the aforementioned high mutation rate of the HIV, which favors the emergence of large numbers of new resistance mutations and complex mutational patterns, makes the rule-based approach suboptimal. In this scenario machine learning methods can be extremely helpful, especially in recent years with the increasing size of available data. This second approach is also very popular and there exists machine learning software to predict resistance online [<xref ref-type="bibr" rid="CR8">8</xref>, <xref ref-type="bibr" rid="CR9">9</xref>]. Different methods have been proposed, the most common ones being Linear Regression [<xref ref-type="bibr" rid="CR10">10</xref>, <xref ref-type="bibr" rid="CR11">11</xref>], Artificial Neural Networks (ANN) [<xref ref-type="bibr" rid="CR10">10</xref>, <xref ref-type="bibr" rid="CR12">12</xref>–<xref ref-type="bibr" rid="CR14">14</xref>], Support Vector Machines (SVMs) [<xref ref-type="bibr" rid="CR10">10</xref>, <xref ref-type="bibr" rid="CR15">15</xref>, <xref ref-type="bibr" rid="CR16">16</xref>], Decision Trees (DT) [<xref ref-type="bibr" rid="CR10">10</xref>, <xref ref-type="bibr" rid="CR17">17</xref>] and their ensemble counterpart, Random Forests (RF) [<xref ref-type="bibr" rid="CR15">15</xref>, <xref ref-type="bibr" rid="CR16">16</xref>, <xref ref-type="bibr" rid="CR18">18</xref>, <xref ref-type="bibr" rid="CR19">19</xref>]. Some machine learning studies have complemented the sequence data with structural information, e.g., [<xref ref-type="bibr" rid="CR11">11</xref>, <xref ref-type="bibr" rid="CR15">15</xref>, <xref ref-type="bibr" rid="CR16">16</xref>, <xref ref-type="bibr" rid="CR18">18</xref>], or have benefited from the knowledge about major drug associated mutations to perform feature selection. The inclusion of cross-resistance information in the form of ensemble methods has also been reported to improve resistance prediction [<xref ref-type="bibr" rid="CR20">20</xref>–<xref ref-type="bibr" rid="CR22">22</xref>].</p>
    <p id="Par44">Nevertheless, HIV sequence data specificities pose significant challenges to resistance prediction. First, sequence data is categorical in nature. However, most machine learning algorithms are designed to cope with numeric data (DT and RF being exceptions), thus obliging to perform some kind of pre-processing. A typical approach is to recode each position into <italic>m</italic> or <italic>m − 1</italic> “dummy variables”, which can take the values 0 or 1 [<xref ref-type="bibr" rid="CR5">5</xref>]. Usually, <italic>m</italic> is the number of all possible alleles that can be potentially found in a position (i.e., <italic>m</italic> = 20 in protein sequences). However, some authors restrict the dummy variables to the drug associated mutations already appearing in the literature [<xref ref-type="bibr" rid="CR6">6</xref>, <xref ref-type="bibr" rid="CR10">10</xref>, <xref ref-type="bibr" rid="CR12">12</xref>]. A very different approach is found in [<xref ref-type="bibr" rid="CR14">14</xref>], where each amino acid was codified as an integer ranging 1–22 (the 20 canonical amino acids plus two extra characters B and Z). Other encodings have been used with HIV sequence data, like amino acid composition frequencies, reduced amino acid alphabets or physicochemical properties [<xref ref-type="bibr" rid="CR5">5</xref>, <xref ref-type="bibr" rid="CR16">16</xref>, <xref ref-type="bibr" rid="CR20">20</xref>].</p>
    <p id="Par45">Another challenge is the presence of mixtures of alleles (normally two, rarely three or four) in at least one position of the viral sequence for most clinical samples. In the case of HIV, this event indicates that the patient carries two or more virus variants [<xref ref-type="bibr" rid="CR4">4</xref>]. It is well established that HIV tends to generate viral swarms of closely related viruses (quasispecies), as a consequence of its high mutation rate [<xref ref-type="bibr" rid="CR2">2</xref>]. Mixtures introduce ambiguity in the genotype-phenotype correlation [<xref ref-type="bibr" rid="CR6">6</xref>] and a problem of technical nature: the vast majority of machine learning methods are not able to deal directly with these “multiallelic” codes. To our knowledge, algorithms so far have handled allele mixtures with some sort of previous pre-processing of the data, e.g., keeping only the most frequent amino acid of the mixture [<xref ref-type="bibr" rid="CR19">19</xref>], replacing the positions by a missing value [<xref ref-type="bibr" rid="CR17">17</xref>], excluding the affected sequences [<xref ref-type="bibr" rid="CR15">15</xref>] or expanding the data to obtain all the possible sequences that could be generated with the observed mixtures [<xref ref-type="bibr" rid="CR11">11</xref>, <xref ref-type="bibr" rid="CR14">14</xref>, <xref ref-type="bibr" rid="CR18">18</xref>].</p>
    <p id="Par46">In this paper, we propose the use of kernel functions specifically adapted to the aforementioned HIV data intricacies, and able to integrate the relevance of the major resistance associated protein residues. Kernels are mathematical functions with interesting properties. They can be coupled to numerous machine learning algorithms, the so-called kernel methods, and provide a framework to deal with data of virtually any type (e.g. vectors, strings, graphs). They can also encode complementary knowledge about a problem, as long as some mathematical conditions are satisfied [<xref ref-type="bibr" rid="CR23">23</xref>]. Our aim using kernel functions that address the aforementioned HIV data particularities was not only to improve prediction, but also reduce pre-processing, thus preserving the data integrity and lowering the risk of inserting spurious patterns.</p>
  </sec>
  <sec id="Sec2">
    <title>Methods</title>
    <sec id="Sec3">
      <title>Datasets and data pre-processing</title>
      <p id="Par47">The Genotype-Phenotype Stanford HIV Drug Resistance Database [<xref ref-type="bibr" rid="CR24">24</xref>] is a public dataset with sequences from HIV isolates and its relative susceptibility to several antiretroviral drugs. We retrieved the PhenoSense dataset from Stanford webpage (version date: 2019-2-20). The data is split in four databases (PI, NRTI, NNRTI and INI), which contain between 1,000–3,500 HIV isolates. INI is a new addition to the Stanford database and includes some of the drugs most recently approved for therapeutic use. The complete dataset contains eight protease inhibitors: atazanavir (ATV), darunavir (DRV), fosamprenavir (FPV), indinavir (IDV), lopinavir (LPV), nelfinavir (NFV), saquinavir (SQV) and tipranavir (TPV); five integrase inhibitors: bictegravir (BIC), cabotegravir (CAB), dolutegravir (DTG), elvitegravir (EVG) and raltegravir (RAL); and two classes of reverse transcriptase inhibitors: six NRTIs, lamivudine (3TC), abacavir (ABC), zidovudine (AZT), stavudine (D4T), didanosine (DDI) and tenofovir (TDF); and four NNRTIs, efavirenz (EFV), etravirine (ETR), nevirapine (NVP) and rilpivirine (RPV). Sequence length is 99 amino acids in the case of PI database, 288 in the case of INI database and 240 in the case of NRTI and NNRTI databases. The dataset contains the strain virus resistance (relative IC50) to each drug, and the sequence of the protein targeted by this drug. We built the regression models for each drug separately, taking each polymorphic protein position as a predictor variable and the drug resistance value as the target variable. Since the distributions of resistances are highly skewed we used the log-transformed values, as recommended in [<xref ref-type="bibr" rid="CR5">5</xref>]. Redundant viruses obtained from the same patient were removed to minimize bias. We deleted all sequences affected by events that changed protein length (protein truncations, insertions and deletions). These events were uncommon in the dataset and affected less than 5% of HIV sequences. Also, we removed all isolates with one or more missing values. Missing values are present in the target variables as well as in the sequences, because not all HIV isolates have been tested for all drugs. The final number of data instances for each drug is shown in Table <xref rid="Tab1" ref-type="table">1</xref>. To ensure a minimum of data rows for training/test partitions and cross-validation, we did not consider drugs with a sample size lower than 100.<table-wrap id="Tab1"><label>Table 1</label><caption><p>Final number of HIV isolates per drug</p></caption><table frame="hsides" rules="groups"><thead><tr><th>Drug</th><th>Data size</th><th>Drug</th><th>Data size</th><th>Drug</th><th>Data size</th><th>Drug</th><th>Data size</th></tr></thead><tbody><tr><td>ATV</td><td>1058</td><td>SQV</td><td>1603</td><td>DDI</td><td>1511</td><td>BIC</td><td>84</td></tr><tr><td>DRV</td><td>665</td><td>TPV</td><td>766</td><td>TDF</td><td>1236</td><td>CAB</td><td>0</td></tr><tr><td>FPV</td><td>1559</td><td>3TC</td><td>1482</td><td>EFV</td><td>1511</td><td>DTG</td><td>209</td></tr><tr><td>IDV</td><td>1607</td><td>ABC</td><td>1513</td><td>ETR</td><td>502</td><td>EVG</td><td>577</td></tr><tr><td>LPV</td><td>1372</td><td>AZT</td><td>1502</td><td>NVP</td><td>1517</td><td rowspan="2">RAL</td><td rowspan="2">636</td></tr><tr><td>NFV</td><td>1654</td><td>D4T</td><td>1510</td><td>RPV</td><td>181</td></tr></tbody></table></table-wrap></p>
    </sec>
    <sec id="Sec4">
      <title>Methods</title>
      <p id="Par48">We compared the performance of a nonlinear, nonkernel method (RF) to a kernel method: SVMs. SVMs can be either linear or nonlinear, depending on the kernel used. The linear kernel is the simplest of all kernel functions, given by the inner product of two vectors in input space, <bold>x</bold> and <bold>y</bold>:<disp-formula id="Equ1"><label>1</label><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {k}_{Lin}\left(\mathbf{x},\mathbf{y}\right)={\mathbf{x}}^{\mathrm{T}}\mathbf{y} $$\end{document}</tex-math><mml:math id="M2" display="block"><mml:msub><mml:mi>k</mml:mi><mml:mi mathvariant="italic">Lin</mml:mi></mml:msub><mml:mfenced close=")" open="(" separators=","><mml:mi mathvariant="bold">x</mml:mi><mml:mi mathvariant="bold">y</mml:mi></mml:mfenced><mml:mo>=</mml:mo><mml:msup><mml:mi mathvariant="bold">x</mml:mi><mml:mi mathvariant="normal">T</mml:mi></mml:msup><mml:mi mathvariant="bold">y</mml:mi></mml:math><graphic xlink:href="12859_2019_2991_Article_Equ1.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par49">In our case, <bold>x</bold> and <bold>y</bold> represent the protein sequence of two HIV isolates, recoded as dummy variables [<xref ref-type="bibr" rid="CR25">25</xref>]. We used this kernel as the linear method of reference. An alternative expression is:<disp-formula id="Equ2"><label>2</label><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {k}_{Lin}\left(\mathbf{x},\mathbf{y}\right)=\sum \limits_{i=1}^d{w}_i{x}_i{y}_i $$\end{document}</tex-math><mml:math id="M4" display="block"><mml:msub><mml:mi>k</mml:mi><mml:mi mathvariant="italic">Lin</mml:mi></mml:msub><mml:mfenced close=")" open="(" separators=","><mml:mi mathvariant="bold">x</mml:mi><mml:mi mathvariant="bold">y</mml:mi></mml:mfenced><mml:mo>=</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>d</mml:mi></mml:munderover><mml:msub><mml:mi>w</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><graphic xlink:href="12859_2019_2991_Article_Equ2.gif" position="anchor"/></alternatives></disp-formula>where <italic>d</italic> is the length of the sequence. This expression stresses the possibility of assigning a weight <italic>w</italic><sub><italic>i</italic></sub> to each protein position, as it is known that not all positions contribute equally to the virus resistance [<xref ref-type="bibr" rid="CR2">2</xref>]. Weights are nonnegative and sum to one. We considered two options: the simplest one was to consider that all positions have the same importance, i.e., assigning equal weight <italic>1/d</italic> to all variables. The second one was including additional information into the kernels, using RF mean decrease in node impurity as a metric for position importance.</p>
      <sec id="Sec5">
        <title>RBF kernel</title>
        <p id="Par50">It is a nonlinear kernel, usually defined as:<disp-formula id="Equ3"><label>3</label><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {k}_{RBF}\left(\mathbf{x},\mathbf{y}\right)={e}^{-\gamma {\left|\left|\mathbf{x}-\mathbf{y}\right|\right|}^2} $$\end{document}</tex-math><mml:math id="M6" display="block"><mml:msub><mml:mi>k</mml:mi><mml:mi mathvariant="italic">RBF</mml:mi></mml:msub><mml:mfenced close=")" open="(" separators=","><mml:mi mathvariant="bold">x</mml:mi><mml:mi mathvariant="bold">y</mml:mi></mml:mfenced><mml:mo>=</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mi>γ</mml:mi><mml:msup><mml:mfenced close="|" open="|"><mml:mfenced close="|" open="|"><mml:mrow><mml:mi mathvariant="bold">x</mml:mi><mml:mo>−</mml:mo><mml:mi mathvariant="bold">y</mml:mi></mml:mrow></mml:mfenced></mml:mfenced><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:msup></mml:math><graphic xlink:href="12859_2019_2991_Article_Equ3.gif" position="anchor"/></alternatives></disp-formula></p>
        <p id="Par51">Where ||<bold>x</bold> − <bold>y</bold>||<sup>2</sup> is the squared Euclidean distance between two vectors, and <italic>γ</italic> &gt; 0 is a hyperparameter. As in the case of the linear kernel, the original data was recoded. We also introduced the possibility of weighting the positions:<disp-formula id="Equ4"><label>4</label><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {k}_{RBF}\left(\mathbf{x},\mathbf{y}\right)={e}^{-\gamma \sum \limits_{i=1}^d{w}_i{\left({x}_i-{y}_i\right)}^2} $$\end{document}</tex-math><mml:math id="M8" display="block"><mml:msub><mml:mi>k</mml:mi><mml:mi mathvariant="italic">RBF</mml:mi></mml:msub><mml:mfenced close=")" open="(" separators=","><mml:mi mathvariant="bold">x</mml:mi><mml:mi mathvariant="bold">y</mml:mi></mml:mfenced><mml:mo>=</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mi>γ</mml:mi><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>d</mml:mi></mml:munderover><mml:msub><mml:mi>w</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:msup><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mfenced><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:msup></mml:math><graphic xlink:href="12859_2019_2991_Article_Equ4.gif" position="anchor"/></alternatives></disp-formula></p>
        <p id="Par52">The RBF kernel is a widely accepted default method [<xref ref-type="bibr" rid="CR23">23</xref>, <xref ref-type="bibr" rid="CR25">25</xref>], so we used it as a benchmark to compare with the categorical kernels.</p>
      </sec>
      <sec id="Sec6">
        <title>Overlap kernel</title>
        <p id="Par53">This is the most basic categorical kernel. This kernel assigns 1 if the two instances compared are equal and 0 otherwise.<disp-formula id="Equ5"><label>5</label><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {k}_{Ov}\left({x}_i,{y}_i\right)=\left\{\begin{array}{c}1\  if\ {x}_i={y}_i\\ {}0\  if\ {x}_i\ne {y}_i\end{array}\right. $$\end{document}</tex-math><mml:math id="M10" display="block"><mml:msub><mml:mi>k</mml:mi><mml:mi mathvariant="italic">Ov</mml:mi></mml:msub><mml:mfenced close=")" open="(" separators=","><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mfenced><mml:mo>=</mml:mo><mml:mfenced close="" open="{"><mml:mtable><mml:mtr><mml:mtd><mml:maligngroup/><mml:mn>1</mml:mn><mml:mspace width="0.25em"/><mml:mtext mathvariant="italic">if</mml:mtext><mml:mspace width="0.25em"/><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:maligngroup/><mml:mn>0</mml:mn><mml:mspace width="0.25em"/><mml:mtext mathvariant="italic">if</mml:mtext><mml:mspace width="0.25em"/><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>≠</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mtd></mml:mtr></mml:mtable></mml:mfenced></mml:math><graphic xlink:href="12859_2019_2991_Article_Equ5.gif" position="anchor"/></alternatives></disp-formula>where <italic>x</italic><sub><italic>i</italic></sub> and <italic>y</italic><sub><italic>i</italic></sub> represent the alleles of a given protein position <italic>i</italic> in two HIV sequences, <bold>x</bold> and <bold>y</bold>.</p>
      </sec>
      <sec id="Sec7">
        <title>Jaccard kernel</title>
        <p id="Par54">The Jaccard index measures the similarity between two finite sets and is a valid kernel function [<xref ref-type="bibr" rid="CR26">26</xref>]. We used it to handle allele mixtures, while in the rest of methods we randomly sampled one allele of the mixture. Letting again <italic>i</italic> denote a given protein position (so that <italic>X</italic><sub><italic>i</italic></sub> and <italic>Y</italic><sub><italic>i</italic></sub> are non-empty sets of alleles in the <italic>i</italic>-th position for isolates <bold>x</bold> and <bold>y</bold>) then:<disp-formula id="Equ6"><label>6</label><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {k}_{Jac}\left({X}_i,{Y}_i\right)=\frac{\mid {X}_i\cap {Y}_i\mid }{\mid {X}_i\cup {Y}_i\mid } $$\end{document}</tex-math><mml:math id="M12" display="block"><mml:msub><mml:mi>k</mml:mi><mml:mi mathvariant="italic">Jac</mml:mi></mml:msub><mml:mfenced close=")" open="(" separators=","><mml:msub><mml:mi>X</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:msub><mml:mi>Y</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mfenced><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mo>∣</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>∩</mml:mo><mml:msub><mml:mi>Y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>∣</mml:mo></mml:mrow><mml:mrow><mml:mo>∣</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>∪</mml:mo><mml:msub><mml:mi>Y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>∣</mml:mo></mml:mrow></mml:mfrac><mml:mspace width="0.25em"/></mml:math><graphic xlink:href="12859_2019_2991_Article_Equ6.gif" position="anchor"/></alternatives></disp-formula></p>
        <p id="Par55">When ∣<italic>X</italic><sub><italic>i</italic></sub> ∣  =  ∣ <italic>Y</italic><sub><italic>i</italic></sub> ∣  = 1, i.e., none of the individuals have an allele mixture at that i-th position, Jaccard reduces to the Overlap kernel. Unlike Overlap, the Jaccard kernel can deal simultaneously with allele mixtures and categorical data.</p>
      </sec>
      <sec id="Sec8">
        <title>“RBF-like” categorical kernels</title>
        <p id="Par56">For the whole protein sequences, we can aggregate all single position Overlap and Jaccard evaluations as the convex combination of kernels evaluations (Eq. 5 or 6) and position weights. This results in a valid kernel function, since the product of a positive scalar and a kernel is a kernel, and the sum of kernels is also a kernel. To ensure that the only difference between categorical kernels and RBF was the categorical part, we introduced an exponential factor and the hyperparameter <italic>γ</italic>, in a way analogous to (3) and (4):<disp-formula id="Equ7"><label>7</label><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {k}_{cat}\left(\mathrm{x},\mathrm{y}\right)={e}^{-\gamma }{e}^{\gamma \sum \limits_{i=1}^d{w}_i\cdotp k\left({x}_i,{y}_i\right)} $$\end{document}</tex-math><mml:math id="M14" display="block"><mml:msub><mml:mi>k</mml:mi><mml:mi mathvariant="italic">cat</mml:mi></mml:msub><mml:mfenced close=")" open="(" separators=","><mml:mi mathvariant="normal">x</mml:mi><mml:mi mathvariant="normal">y</mml:mi></mml:mfenced><mml:mo>=</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mi>γ</mml:mi></mml:mrow></mml:msup><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mi>γ</mml:mi><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>d</mml:mi></mml:munderover><mml:msub><mml:mi>w</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>·</mml:mo><mml:mi>k</mml:mi><mml:mfenced close=")" open="(" separators=","><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mfenced></mml:mrow></mml:msup><mml:mspace width="0.25em"/></mml:math><graphic xlink:href="12859_2019_2991_Article_Equ7.gif" position="anchor"/></alternatives></disp-formula></p>
        <p id="Par57">This is also a valid kernel function, since the exponential of a kernel gives another kernel, and where <italic>e</italic><sup>−<italic>γ</italic></sup> normalizes the kernel matrix, keeping the evaluations between 0 and 1. The final versions of the Overlap and the Jaccard kernels are obtained replacing the <italic>k</italic>(<italic>x</italic><sub><italic>i</italic></sub>, <italic>y</italic><sub><italic>i</italic></sub>) term by (5) or (6), respectively. In our analyses, we compared weighted and unweighted versions for all linear, RBF, Overlap and Jaccard kernels. Thus we can ensure a fair comparison between the categorical and the noncategorical kernels.</p>
      </sec>
    </sec>
    <sec id="Sec9">
      <title>Stacked models</title>
      <p id="Par58">So far, we have built prediction models for each inhibitor separately. As mentioned in the Introduction, it is reported that there exists some degree of relationship between the resistance of different drugs (e.g. in case of cross-resistance). To check whether the use of this information can improve prediction, we implemented the stacking algorithm described in [<xref ref-type="bibr" rid="CR22">22</xref>] for continuous outcomes. This meta-learner approach consists of two principal steps. In the first step, single drug models are built from the training data as usual. In the second step, the fitted values (i.e. predictions of the training data) of all drugs obtained in step 1 are used as input to a new (stacked) model, being each drug a different predictor. The method that integrates the single drug models in step 2 and delivers the definitive predictions is called a combiner algorithm. Data size largely varied between drugs (see Table <xref rid="Tab1" ref-type="table">1</xref>), even within the same drug class, so we chose Decision Trees (DT) as our combiner algorithm, as they can easily handle missing data. We combined the drugs within the same database (PI, NRTI, NNRTI and INI) and applied this stacking methodology to our previously proposed weighted kernels (Linear, RBF, Overlap and Jaccard).</p>
    </sec>
    <sec id="Sec10">
      <title>Experimental setup and model tuning</title>
      <p id="Par59">To assess the performance of the methods used, each database was split at random in two partitions: training set (60% of the database) and test set (40%). Hyperparameter optimization was done by a 10 × 10 cross-validation on the training set. Once the optimum hyperparameter was found, the final model was built using the whole training set. To assess the model performance, the NMSE (Normalized Mean Square Error) between the actual and the predicted drug resistances of the test set was computed:<disp-formula id="Equ8"><label>8</label><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ NMSE\left( observed, predicted\right)=\frac{\sum {\left( observed- predicted\right)}^2}{\left(N-1\right)\cdotp \mathit{\operatorname{var}}(observed)} $$\end{document}</tex-math><mml:math id="M16" display="block"><mml:mtext mathvariant="italic">NMSE</mml:mtext><mml:mfenced close=")" open="(" separators=","><mml:mtext mathvariant="italic">observed</mml:mtext><mml:mtext mathvariant="italic">predicted</mml:mtext></mml:mfenced><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mo>∑</mml:mo><mml:msup><mml:mfenced close=")" open="("><mml:mrow><mml:mtext mathvariant="italic">observed</mml:mtext><mml:mo>−</mml:mo><mml:mtext mathvariant="italic">predicted</mml:mtext></mml:mrow></mml:mfenced><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mrow><mml:mfenced close=")" open="("><mml:mrow><mml:mi>N</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced><mml:mo>·</mml:mo><mml:mo mathvariant="italic">var</mml:mo><mml:mfenced close=")" open="("><mml:mtext mathvariant="italic">observed</mml:mtext></mml:mfenced></mml:mrow></mml:mfrac><mml:mspace width="0.25em"/></mml:math><graphic xlink:href="12859_2019_2991_Article_Equ8.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par60">NMSE can be understood as the fraction of target variance not explained by the model.</p>
      <p id="Par61">We repeated the whole process 40 times, each time with different 60/40 randomly split training/test partitions, to obtain an error distribution. Kernel position weights were calculated using the training set only. Note that only the Jaccard kernel can directly handle allele mixtures; for the rest of kernels and the RF, we generated 40 versions of the database randomly sampling one allele at a time. Then, the 40 replicates were used to compute all the models except Jaccard, which could deal directly with the database without further preprocessing. This way we can ensure an honest comparison between Jaccard and the rest of kernels and methods.</p>
      <p id="Par62">All analyses were implemented in the R statistical computing language [<xref ref-type="bibr" rid="CR27">27</xref>]. A documented package implementing these methods is available at <ext-link ext-link-type="uri" xlink:href="https://bitbucket.org/elies_ramon/catkern/">https://bitbucket.org/elies_ramon/catkern/</ext-link>.</p>
    </sec>
    <sec id="Sec11">
      <title>Visualization</title>
      <p id="Par63">Kernel PCA is a kernel method obtained by coupling kernel functions to a Principal Components Analysis. We used the Jaccard kernel PCA to visually check whether sequences that are considered more similar by the kernel function are also similar in their drug resistance. As this method is for visualization purposes only, we did not separate training and test sequences. Thus, we used the mean kernel weights of the 40 training sets to compute the weighted Jaccard.</p>
      <p id="Par64">To check whether the important protein positions (i.e. kernel weights) detected by RF could have an structural relevance, we highlighted our top ranking positions on the tridimensional structure of the protein. Pictures of protein-drug complexes were generated with Molsoft ICM-Browser v.3.7–2 using structural data obtained from RCSB Protein Data Bank.</p>
    </sec>
    <sec id="Sec12">
      <title>Performance comparison to other approaches</title>
      <p id="Par65">We compared our SVM plus weighted Jaccard with the ANN approach described in [<xref ref-type="bibr" rid="CR14">14</xref>], which to our knowledge achieves the best performance so far in this dataset. We used the R interface to keras to implement the ANN. First, we followed the specifications described in [<xref ref-type="bibr" rid="CR14">14</xref>] about the range of candidate architectures (1–3 hidden layers, with 2–10 nodes per layer, for all drugs), number of epochs and early stopping. As our dataset version and data pre-processing differ from [<xref ref-type="bibr" rid="CR14">14</xref>], we also evaluated a different range of hyperparameters: three fixed ANN architectures (one hidden layer with 30 nodes, two hidden layers with 20 and 10 nodes respectively, and three hidden layers with 30, 20 and 10 nodes) with the L2 regularization parameter λ. Both approaches (from now on referred to as ANN1 and ANN2) were trained and tested as for the rest of methods (see: Data and dataset pre-processing), with the previously described 40 replicates, allele mixture treatment, training/test ratio and 10 × 10 cross-validation to choose the best number of layers and nodes per layer (in the case of ANN1) or λ (in the case of ANN2). We chose the best architecture obtained in training within ANN1 and ANN2 options for each drug.</p>
    </sec>
  </sec>
  <sec id="Sec13">
    <title>Results</title>
    <p id="Par66">As expected, HIV protein sequences showed a large variability. As many as 93% of the protease positions were polymorphic and, among these, the number of different observed alleles varied between 2 and 16. In the case of reverse transcriptase, 89% of the positions were polymorphic and the number of alleles per polymorphic position ranged between 2 and 14. Integrase was the least variable protein: 75% of the positions were polymorphic and, in these positions, the number of alleles ranged between 2 and 8. Almost 60% of the sequences had at least one allele mixture.</p>
    <p id="Par67">Figure <xref rid="Fig1" ref-type="fig">1</xref> shows the NMSE distribution boxplot for four representative drugs: FPV (PI database, panel a), DDI (NRTI database, panel b), NVP (NNRTI database, panel c) and EVG (INI database, panel d). The remaining 17 boxplots can be found at Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figures S1-S17.<fig id="Fig1"><label>Fig. 1</label><caption><p>NMSE distributions for a PI (FPV, panel <bold>a</bold>), an NRTI (DDI, panel <bold>b</bold>), an NNRTI (NVP, panel <bold>c</bold>) and an INI (EVG, panel <bold>d</bold>). Note that NMSE scale varies between panels</p></caption><graphic xlink:href="12859_2019_2991_Fig1_HTML" id="MO1"/></fig></p>
    <sec id="Sec14">
      <title>Performance overview</title>
      <p id="Par68">NMSE varied greatly across drugs and methods. The best prediction was achieved for 3TC, with an average NMSE ranging 0.07–0.16 depending on the method used (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S8). The drug with worst prediction error was DTG, with an average NMSE ranging 0.65–0.75 (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S16). This was also the second drug with lowest data size (Table <xref rid="Tab1" ref-type="table">1</xref>). Not unexpectedly, methods applied to drugs with low N had considerably worse performance overall (especially DTG, RPV, ETR and TPV, but also TDF and to some extent DRV). In the PI database, errors were fairly similar across all drugs and around 0.12–0.20 on average (e.g. Figure <xref rid="Fig1" ref-type="fig">1</xref>a), with the sole exception of TPV, with an average NMSE ranging 0.30–0.45. In turn, predictive performances for the integrase and reverse transcriptase inhibitors were far more variable across drugs. Overall, the best method was the SVM with the Jaccard kernel (either in its weighted or in its unweighted version), which achieved the best performance in 20 out of 21 drugs.</p>
      <sec id="Sec15">
        <title>Unweighted case</title>
        <p id="Par69">Nonlinear kernels performed much better than the linear kernel in almost all drugs, with the only exception of ETR and D4T. Categorical kernels outperformed RBF, although RBF was close to Overlap (or even marginally better) in some cases. Among categorical kernels, the Jaccard kernel performed better than Overlap in all inhibitors, sometimes by a large margin, as in the cases of SQV, 3TC, AZT, EFV, NVP, RAL or EVG (Fig. <xref rid="Fig1" ref-type="fig">1</xref> c and d). Predictive performances of unweighted kernels and of RF were markedly different in protease with respect to integrase and transcriptase inhibitors. RF was consistently worse than kernel methods for the PI database (e.g. Figure <xref rid="Fig1" ref-type="fig">1</xref>a), whereas RF performance was comparable or better than those of kernel methods in both reverse transcriptase and integrase inhibitors (e.g. Figure <xref rid="Fig1" ref-type="fig">1</xref>b, c and d).</p>
      </sec>
      <sec id="Sec16">
        <title>Weighted case</title>
        <p id="Par70">Figure <xref rid="Fig2" ref-type="fig">2</xref> shows three representative examples of the weights obtained from RF. The remaining plots are shown in Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Figures S18-S35. We ascertained that RF detected most of the major resistance associated positions described in the literature (e.g. review in [<xref ref-type="bibr" rid="CR2">2</xref>]). Overall, a higher percentage of relevant positions were identified in protease inhibitors than in both reverse transcriptase and integrase inhibitors. To evaluate this numerically, we computed the Gini index of the RF importance distributions for each of the drugs. This index is shown in Fig. <xref rid="Fig2" ref-type="fig">2</xref> and Additional file <xref rid="MOESM2" ref-type="media">2</xref>. We also noticed differences regarding the location of the important positions in the tridimensional structures of protease (Fig. <xref rid="Fig3" ref-type="fig">3</xref>a) and reverse transcriptase (Fig. <xref rid="Fig3" ref-type="fig">3</xref>b). The most important protease positions according to RF are distributed over the whole structure, whereas in the case of the reverse transcriptase they are located at the drug binding site.<fig id="Fig2"><label>Fig. 2</label><caption><p>RF relative importance of each protein position for three drugs: a protease inhibitor (<bold>a</bold>), a reverse transcriptase inhibitor (<bold>b</bold>) and an integrase inhibitor (<bold>c</bold>). Standard error across the 40 replicates is marked with error bars. Asterisks highlight the major drug related positions reported in the literature [<xref ref-type="bibr" rid="CR2">2</xref>]</p></caption><graphic xlink:href="12859_2019_2991_Fig2_HTML" id="MO2"/></fig><fig id="Fig3"><label>Fig. 3</label><caption><p><bold>a</bold> Wild type protease (in yellow and blue) with an inhibitor (NFV, in green) (PDB code: 3EKX). We highlight the ten most important positions according to RF: 10, 90, 54, 46, 71, 88, 84, 30, 20 and 82. These positions are scattered throughout the protein and only a few belong to the drug binding site (e.g. 30, 82 and 84). Mutations at the binding site reduce the affinity for the inhibitor, but can impair the protease catalytic activity as a collateral damage. Mutations in distant residues are typically concurrent with these binding site mutations and often have a compensatory role (e.g. stabilizing the protease structure or restoring the catalytic activity). Position 30 appears to be important only in the case of the NFV drug, while the other positions are found in all (or almost all) protease inhibitors. This agrees with the literature [<xref ref-type="bibr" rid="CR2">2</xref>]. <bold>b</bold> Binding pocket of the reverse transcriptase (in yellow) with an NNRTI (NVP, in pink) (PDB code: 3V81). We highlight the five most important positions for NVP according to RF: 103, 181, 190, 188 and 101. All these positions reside in the NNRTI binding pocket of the enzyme, and also appear in the other NNRTIs analyzed. Thus, in EFV, we find 100 (but not 181) in the top 5; and in ETR, we have 179 instead of 188 (also highlighted). Positions 103 and 101 are located near the entry of the inhibitor binding pocket and, when mutated, interfere with the entrance of the inhibitor to the binding site. Y181 and Y188 have a crucial contribution the NVP binding via stacking interactions between its side chains and the inhibitor aromatic groups. G190 mutations lead to resistance through steric hindrance, because of the substitution by a more voluminous side chain. L100 effect is also related to steric hindrance [<xref ref-type="bibr" rid="CR2">2</xref>]</p></caption><graphic xlink:href="12859_2019_2991_Fig3_HTML" id="MO3"/></fig></p>
        <p id="Par71">As for predictive performance, weighting was more effective in integrase and reverse transcriptase inhibitors than in protease inhibitors. In NRTI and NNRTI databases, weighted kernels outperformed RF in all cases, whereas their unweighted counterparts did not. This was particularly the case for 3TC, DDI (Fig. <xref rid="Fig1" ref-type="fig">1</xref>b), EVG (Fig. <xref rid="Fig1" ref-type="fig">1</xref>d) and especially NVP (Fig. <xref rid="Fig1" ref-type="fig">1</xref>c), where weighting decreased the Jaccard kernel error by around 50%. In contrast, the effect of weighting was less marked in the PI database: similar errors were obtained (e.g. Figure <xref rid="Fig1" ref-type="fig">1</xref>a) for all drugs but TPV, where the error actually increased. In the INI database, weighting decreased dramatically the error in RAL and EVG drugs but not in DTG. In summary, Jaccard was the best weighted kernel followed by Overlap, RBF and Linear.</p>
      </sec>
    </sec>
    <sec id="Sec17">
      <title>Factors affecting prediction error</title>
      <p id="Par72">To investigate the relevance of each factor in prediction, we fitted the following linear model to NMSE obtained in each replicate across all kernels and drugs (40 replicates × 21 drugs × 8 kernels):<disp-formula id="Equ9"><label>9</label><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ NMSE\sim N+K+W+ GINI+\varepsilon $$\end{document}</tex-math><mml:math id="M18" display="block"><mml:mtext mathvariant="italic">NMSE</mml:mtext><mml:mo>~</mml:mo><mml:mi>N</mml:mi><mml:mo>+</mml:mo><mml:mi>K</mml:mi><mml:mo>+</mml:mo><mml:mi>W</mml:mi><mml:mo>+</mml:mo><mml:mtext mathvariant="italic">GINI</mml:mtext><mml:mo>+</mml:mo><mml:mi>ε</mml:mi></mml:math><graphic xlink:href="12859_2019_2991_Article_Equ9.gif" position="anchor"/></alternatives></disp-formula>where <italic>N</italic> is the drug data size (Table <xref rid="Tab1" ref-type="table">1</xref>), <italic>K</italic> is a class variable with the kernel used (Linear, RBF, Overlap or Jaccard), <italic>W =</italic> 0 or 1 depending on whether the kernel was unweighted or weighted, respectively, and <italic>GINI</italic> is the standardized Gini index of RF weights. Table <xref rid="Tab2" ref-type="table">2</xref> summarizes the coefficients and their significance. We found that all factors are significant and behave additively (interactions were not significant; results not shown). As expected NMSE decreases with <italic>N</italic> but, interestingly, also with Gini index, i.e., prediction improves when there are only a few positions of large effect. Categorical kernels were consistently better than noncategorical ones and Jaccard was the best option in all cases. Weighting protein positions significantly lowers the error, although only in reverse transcriptase and integrase inhibitors (as also observed in Fig. <xref rid="Fig1" ref-type="fig">1</xref> and Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figures S1-S17).<table-wrap id="Tab2"><label>Table 2</label><caption><p>Linear model coefficient estimates and <italic>p</italic>-values</p></caption><table frame="hsides" rules="groups"><thead><tr><th/><th>All drugs</th><th>PIs</th><th>NRTIs + NNRTIs</th><th>INIs</th></tr></thead><tbody><tr><td>N increment</td><td>−2.1·10<sup>− 4</sup> ***</td><td>−2.0·10<sup>− 5</sup> ***</td><td>−1.8·10<sup>− 4</sup> ***</td><td>−1.3·10<sup>− 3</sup> ***</td></tr><tr><td>Unweighted → Weighted</td><td>−2.0·10<sup>− 2</sup> ***</td><td>2.0·10<sup>− 3</sup></td><td>−3.4·10<sup>− 2</sup> ***</td><td>−3.1·10<sup>− 2</sup> ***</td></tr><tr><td>Gini Index increment</td><td>−4.9·10<sup>− 3</sup> ***</td><td>−6.0·10<sup>− 2</sup> ***</td><td>−5.4·10<sup>− 2</sup> ***</td><td>1.7·10<sup>−2</sup> **</td></tr><tr><td>Jaccard → Linear</td><td>4.5·10<sup>−2</sup> ***</td><td>2.1·10<sup>−2</sup> ***</td><td>5.0·10<sup>− 2</sup> ***</td><td>9.4·10<sup>− 2</sup> ***</td></tr><tr><td>Jaccard → RBF</td><td>2.5·10<sup>− 2</sup> ***</td><td>1.3·10<sup>− 2</sup> ***</td><td>2.8·10<sup>− 2</sup> ***</td><td>4.7·10<sup>− 2</sup> ***</td></tr><tr><td>Jaccard → Overlap</td><td>1.9·10<sup>− 2</sup> ***</td><td>9.3·10<sup>− 3</sup> ***</td><td>2.1·10<sup>− 2</sup> ***</td><td>3.6·10<sup>− 2</sup> ***</td></tr></tbody></table><table-wrap-foot><p>Legend: Significance codes are 0 *** 0.001 ** 0.01 * 0.05</p></table-wrap-foot></table-wrap></p>
      <p id="Par73">To visualize the impact of Gini index not ascribable to the effects of data size (<italic>N</italic>) and the kernel used (<italic>K)</italic>, we plotted the residuals of model NMSE ~ <italic>N + K + ε</italic> against <italic>GINI</italic> (Fig. <xref rid="Fig4" ref-type="fig">4</xref> panels a, b and c). For protease inhibitors, the Gini effect is confined to TPV drug (red dots in Fig. <xref rid="Fig4" ref-type="fig">4</xref>a). The effect is rather linear for reverse transcriptase inhibitors, although NMSE variability was larger than average for RPV (red dots), the drug with lowest N. In the case of integrase inhibitors, Gini takes values in a narrow range and does not seem to have an impact on prediction. As in the case of RPV, large variability in NMSE values is observed in DTG (blue dots), which is the drug with second lowest sample size.<fig id="Fig4"><label>Fig. 4</label><caption><p><bold>a, b and c</bold> NMSE residuals (<italic>observed − fitted</italic> values) of the linear model containing only data size (<italic>N</italic>) and kernel (<italic>K</italic>) vs. Gini index. Each color represents a different drug. Note different scale for the Gini index between panels. <bold>d, e and f</bold> Residuals (<italic>observed − fitted</italic> values) of the linear model containing <italic>K, W</italic> and <italic>GINI</italic> vs. data size (<italic>N</italic>). Each color represents a different drug</p></caption><graphic xlink:href="12859_2019_2991_Fig4_HTML" id="MO4"/></fig></p>
      <p id="Par74">Sample size is one of the most important factors in any experimental design, and the main one influencing total cost. Figure <xref rid="Fig4" ref-type="fig">4</xref> panels d, e and f show the residuals of model <italic>NMSE</italic> ~ <italic>K + W + GINI</italic> vs. <italic>N</italic>. Although Table <xref rid="Tab2" ref-type="table">2</xref> shows that the NMSE decreases with sample size for all drugs and proteins, a clear trend appears only for reverse transcriptase inhibitors. In this case, a law of diminishing returns is observed, and adjusted NMSE decrease with N is very small for N &gt; ~ 600.</p>
    </sec>
    <sec id="Sec18">
      <title>Kernel PCA</title>
      <p id="Par75">Even if weighting increases prediction accuracy overall, the effect was markedly different when we compare reverse transcriptase and integrase with protease (Table <xref rid="Tab2" ref-type="table">2</xref>). In the latter protein, weighted kernels were not clearly superior. To further investigate this issue, we performed a PCA on the Jaccard kernel. Figure <xref rid="Fig5" ref-type="fig">5</xref> shows the results of for FPV (a protease inhibitor, panels a and b) and NVP (a reverse transcriptase inhibitor, panel c and d), both with unweighted and weighted Jaccard kernels. The remaining figures can be found at (Additional file <xref rid="MOESM4" ref-type="media">4</xref>: Figures S36-S54). Unweighted kernel PCA results, overall, in a good, spectrum-like separation between resistant and susceptible isolates for protease inhibitors, whereas weighted kernels can improve dramatically the separation in the case of reverse transcriptase. The integrase inhibitors RAL and EVG behave similarly to reverse transcriptase inhibitors, while DTG (which has a very small sample size) do not achieve a good separation either in the weighted or the unweighted kernel PCAs.<fig id="Fig5"><label>Fig. 5</label><caption><p>The Jaccard kernel PCA in a protease inhibitor (FPV, panels <bold>a</bold> and <bold>b</bold>) and a reverse transcriptase inhibitor (NVP, panels <bold>c</bold> and <bold>d</bold>). Panels <bold>a</bold> and <bold>c</bold> correspond to unweighted Jaccard, and <bold>b</bold> and <bold>d</bold> to weighted Jaccard. Dot color represents the actual log-resistance value for each specific drug; in red the more resistant, and in green the least resistant. Sequences with missing resistance value are in gray</p></caption><graphic xlink:href="12859_2019_2991_Fig5_HTML" id="MO5"/></fig></p>
    </sec>
    <sec id="Sec19">
      <title>Stacked models</title>
      <p id="Par76">We compared the performances of four methods (SVM plus weighted Linear, RBF, Overlap and Jaccard kernels) with those of their stacked counterparts in Additional file <xref rid="MOESM3" ref-type="media">3</xref>: Tables S1 (mean NMSE) and S2 (NMSE standard error). Intriguingly, we found that the stacked versions of SVM with weighted kernels have similar performances to those of the individual models. This suggests that all the information of the sequence has been already extracted in the first step, and so stacking the models was of no additional value.</p>
    </sec>
    <sec id="Sec20">
      <title>Performance comparison to other approaches</title>
      <p id="Par77">Figure <xref rid="Fig6" ref-type="fig">6</xref> shows the performance comparison between our best method (SVM with weighted Jaccard kernel) with the ANN1 and ANN2 (see “Performance comparison to other approaches” in Material and methods). ANN2 tends to have better performance than ANN1, especially in drugs with small sample size, but also presents greater standard errors in some drugs. In the case of protease inhibitors (panel a) both ANN1 and ANN2 are only marginally worse than the weighted Jaccard SVM, with the exception of the FPV drug. In the case of reverse transcriptase and the integrase inhibitors (panels b, c and d), the difference between the performance of weighted Jaccard and the ANN increases. The latter method presents higher NMSE and larger standard errors, especially for 3TC, DDI, TDF, the NNRTIs, and the INIs.<fig id="Fig6"><label>Fig. 6</label><caption><p>Mean NMSE values and their corresponding standard errors for the SVM + weighted Jaccard kernels (red), ANN1 (light gray) and ANN2 (dark gray). PIs are shown in panel <bold>a</bold>, NRTIs in panel <bold>c</bold>, NNRTIs in panel <bold>b</bold> and INIs in panel <bold>d</bold></p></caption><graphic xlink:href="12859_2019_2991_Fig6_HTML" id="MO6"/></fig></p>
    </sec>
  </sec>
  <sec id="Sec21">
    <title>Discussion</title>
    <p id="Par78">Recent results on predicting HIV drug resistance as a regression problem can be found in [<xref ref-type="bibr" rid="CR14">14</xref>, <xref ref-type="bibr" rid="CR18">18</xref>]. Shen et al. [<xref ref-type="bibr" rid="CR18">18</xref>] used RF and computed the 5-fold cross-validation R<sup>2</sup>. Sheik Amamuddy et al. [<xref ref-type="bibr" rid="CR14">14</xref>] used ANN and computed the R<sup>2</sup> of the test set without replicates. The two approaches were based in a previous version of the Stanford dataset (version date: 2014-9-28) and share a similar treatment of amino acid mixtures based on sequence expansions. We did a comparison with the ANN, which to our knowledge achieved the best performance so far in this dataset [<xref ref-type="bibr" rid="CR14">14</xref>]. We observed that weighted Jaccard outperforms ANN in all drugs, and that the ANN prediction performances were worse than those originally reported (which had R<sup>2</sup> values ranging between of 0.85 and 0.99). It has to be stressed, however, that we used different versions of the dataset (the version used by [<xref ref-type="bibr" rid="CR14">14</xref>], for instance, did not contain information about the INIs) and that we followed very different strategies concerning pre-processing. In [<xref ref-type="bibr" rid="CR14">14</xref>] a pre-processing with removal of outliers and rare variant filtering is performed, which can result in a loss of generalizability, as is acknowledged by the authors. Another reason for the discrepancy is probably the treatment of allele mixtures, as we discuss next.</p>
    <p id="Par79">In this work, we present a novel approach to predict drug resistance in HIV, using kernel functions that directly address the presence of allele mixtures and the categorical nature of the data. Previous work handled these two issues using several pre-processing strategies. Categorical data are systematically recoded into numeric data, usually in the form of dummy data or, in [<xref ref-type="bibr" rid="CR14">14</xref>], assigning an integer to each category. Here, we have shown that addressing the categorical nature of the data and the presence of allele mixtures does lower the test error in comparison to the dummy variable approach (Table <xref rid="Tab2" ref-type="table">2</xref>). In fact, even the simplest categorical kernel (i.e. the Overlap kernel) improves prediction upon the standard RBF kernel, although the extent of the improvement depends on the specific drug. It has to be stressed that recoding the categorical data into dummy variables increases the dimensionality of the problem, thus increasing computation needs and leading to sparse datasets. As this effect depends on the number of different categories of the variables, categorical methods may be more useful when data has more than few categories. Coding the different alleles as an integer does not increase the dimensionality either, but introduces an order without biological meaning among the amino acids.</p>
    <p id="Par80">The treatment of amino acid mixtures is more challenging. In the data analyzed we observed that it is a widespread phenomenon: about 60% of the sequences had at least one mixture. Mixtures introduce ambiguity in the genotype-phenotype correlation since it makes impossible to know the actual sequences of strains. Also, the quasispecies distribution may have undergone undefined modifications during the in vitro assay [<xref ref-type="bibr" rid="CR28">28</xref>]. Previous approaches to deal with this issue included keeping the most frequent amino acid of the mixture [<xref ref-type="bibr" rid="CR19">19</xref>] and sequence expansion [<xref ref-type="bibr" rid="CR11">11</xref>, <xref ref-type="bibr" rid="CR14">14</xref>, <xref ref-type="bibr" rid="CR18">18</xref>]. The latter strategy consists on expanding the data to sequences with single amino acids at each mixture location until all possible combinations have been exhausted. These “derived” sequences share the resistance value, i.e., the resistance of the original sequence. This approach dramatically enlarges data size (in the aforementioned works, minimum by a 10x factor in the protease inhibitors and almost a 30x in the reverse transcriptase inhibitors). This might be one of the main reasons for the discrepancy between the ANN performance computed in this work and in [<xref ref-type="bibr" rid="CR14">14</xref>]. Without expansion, the data size ranges between 200 and 1500, but the number of (dummy) variables is almost 2000 in the PIs, and more than 4000 in the other drugs. The higher number of variables compared to observations might have adversely affected the ANN performance in comparison to the original work and, also, in comparison to SVMs, as the latter are less prone to over-fitting. Furthermore, the expansion potentially biases the dataset by over representing sequences with mixtures (especially those with a larger number of mixtures and/or alleles per mixture) and it can generate HIV variants not found in the patient. Expansion also increases the difficulty of the training/test splitting because all expansions of the same sequence must be placed either in the training set or in the test set; otherwise, the independence of both sets is lost. In our work, we preferred keeping only one amino acid of the mixture, which is allegedly the most conservative pre-processing choice. This differs from e.g. [<xref ref-type="bibr" rid="CR19">19</xref>], because we keep one amino acid at random, while they pick the most frequent one, which is sound if mixtures are considered a technical artifact. However, in case of HIV, this event mostly reflects the coexistence of actual HIV variants in the body of the patient [<xref ref-type="bibr" rid="CR2">2</xref>, <xref ref-type="bibr" rid="CR4">4</xref>, <xref ref-type="bibr" rid="CR6">6</xref>, <xref ref-type="bibr" rid="CR28">28</xref>] and the ambiguity lies in the resistance value delivered via the in vitro test. In any case, part of the original information is lost by picking one of the allele of the mixture. This does not happen when using the Jaccard kernel, which naturally handles allele mixtures. We have shown that Jaccard is clearly the best among kernels assessed and that also improves the RF results, in most cases by a large margin. Both Overlap and Jaccard are basic kernel functions, but our kernel definition (7) is general enough to replace them for more sophisticated categorical kernels, perhaps with improved prediction performance.</p>
    <p id="Par81">An additional theoretical proposal was to weigh kernel positions according to its inferred influence on drug resistance. Here we employed RF decrease in impurity as weights but numerous options are equally justified and so additional research on this topic is warranted. Using RF we were able to identify, from protein sequence alone, important positions for the drug resistance that have a structural meaning (Fig. <xref rid="Fig3" ref-type="fig">3</xref>). We observed a distinct effect of weighting in protease inhibitors and transcriptase reverse inhibitors that correlates with the distribution of the importances. At least part of this behavior might be due to differences in the mutational pattern between the two enzymes in regards to drug resistance. In the reverse transcriptase, the major resistance mutations tend to be located in specific positions, particularly at the drug binding sites of the N-terminal side, weakening the affinity between drug and enzyme. As early as 1998, it was noted that a single mutation of the reverse transcriptase may confer high resistance to drugs like 3TC and NVP [<xref ref-type="bibr" rid="CR28">28</xref>], whereas the virus acquires resistance to protease inhibitors by accumulating mutations. First, primary resistance mutations arise at the active site pocket and the surrounding residues. But, as these mutations often cause conformational changes, additional secondary mutations that compensate the impaired catalytic activity and stabilize the protease tend to be selected in turn [<xref ref-type="bibr" rid="CR2">2</xref>]. There are at least 36 important residues (out of a total of 99) involved in protease drug resistance mutations and (unlike reverse transcriptase) they are distributed along the whole sequence [<xref ref-type="bibr" rid="CR2">2</xref>]. These differences may explain why RF, and therefore the weighted categorical kernels, performed better at the NRTI and NNRTI databases. Further, the estimate of the variable importance is more reliable when few relevant protein positions have a large impact on resistance. In contrast, the compensatory secondary mutations of the protease probably introduce some degree of correlation between protein positions, which may explain why weighting in PI database does not result in a clear improvement of performance.</p>
  </sec>
  <sec id="Sec22">
    <title>Conclusions</title>
    <p id="Par82">Machine learning is an effective approach to predict HIV drug resistance, and a straightforward alternative to the much slower and expensive in vitro assay. Results show that kernels that take into account both the categorical nature of the data and the presence of mixtures consistently result in the best prediction model. As for the introduction of position weights, we found that the amount of improvement was a function of the number of positions with large effect on drug resistance, which may be related to the known different mutational patterns regarding drug resistance among the viral proteins. Using more sophisticated categorical kernels and/or kernels able to take into account structural information may improve even more the resistance prediction.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Additional files</title>
    <sec id="Sec23">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="12859_2019_2991_MOESM1_ESM.pdf">
            <label>Additional file 1:</label>
            <caption>
              <p><bold>Figures S1-S17</bold>. NMSE distribution for drugs ATV, DRV, IDV, LPV, NFV, TPV, SQV, 3TC, ABC, AZT, D4T, TDF, EFV, ETR, RPV, RAL and DTG (PDF 671 kb)</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM2">
          <media xlink:href="12859_2019_2991_MOESM2_ESM.pdf">
            <label>Additional file 2:</label>
            <caption>
              <p><bold>Figures S18-S35</bold>. RF weights for drugs ATV, DRV, IDV, LPV, NFV, TPV, SQV, 3TC, ABC, AZT, D4T, DDI, TDF, EFV, ETR, RPV, DTG and RAL (PDF 530 kb)</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM3">
          <media xlink:href="12859_2019_2991_MOESM3_ESM.pdf">
            <label>Additional file 3:</label>
            <caption>
              <p><bold>Table S1</bold>. Average NMSE of stacked methods<bold>. Table S2.</bold> NMSE Standard error of stacked methods (PDF 42 kb)</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM4">
          <media xlink:href="12859_2019_2991_MOESM4_ESM.pdf">
            <label>Additional file 4:</label>
            <caption>
              <p><bold>Figures S36-S54</bold>. Kernel PCAs for drugs ATV, DRV, IDV, LPV, NFV, TPV, SQV, 3TC, ABC, AZT, D4T, DDI, TDF, EFV, ETR, RPV, DTG, EVG and RAL (PDF 2075 kb)</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <glossary>
    <title>Abbreviations</title>
    <def-list>
      <def-item>
        <term>3TC</term>
        <def>
          <p id="Par4">Lamivudine</p>
        </def>
      </def-item>
      <def-item>
        <term>ABC</term>
        <def>
          <p id="Par5">Abacavir</p>
        </def>
      </def-item>
      <def-item>
        <term>AIDS</term>
        <def>
          <p id="Par6">Acquired immunodeficiency syndrome</p>
        </def>
      </def-item>
      <def-item>
        <term>ANN</term>
        <def>
          <p id="Par7">Artificial Neural Networks</p>
        </def>
      </def-item>
      <def-item>
        <term>ATV</term>
        <def>
          <p id="Par8">Atazanavir</p>
        </def>
      </def-item>
      <def-item>
        <term>AZT</term>
        <def>
          <p id="Par9">Zidovudine</p>
        </def>
      </def-item>
      <def-item>
        <term>BIC</term>
        <def>
          <p id="Par10">Bictegravir</p>
        </def>
      </def-item>
      <def-item>
        <term>CAB</term>
        <def>
          <p id="Par11">Cabotegravir</p>
        </def>
      </def-item>
      <def-item>
        <term>D4T</term>
        <def>
          <p id="Par12">Stavudine</p>
        </def>
      </def-item>
      <def-item>
        <term>DDI</term>
        <def>
          <p id="Par13">Didanosine</p>
        </def>
      </def-item>
      <def-item>
        <term>DRV</term>
        <def>
          <p id="Par14">Darunavir</p>
        </def>
      </def-item>
      <def-item>
        <term>DT</term>
        <def>
          <p id="Par15">Decision Trees</p>
        </def>
      </def-item>
      <def-item>
        <term>DTG</term>
        <def>
          <p id="Par16">Dolutegravir</p>
        </def>
      </def-item>
      <def-item>
        <term>EFV</term>
        <def>
          <p id="Par17">Efavirenz</p>
        </def>
      </def-item>
      <def-item>
        <term>ETR</term>
        <def>
          <p id="Par18">Etravirine</p>
        </def>
      </def-item>
      <def-item>
        <term>EVG</term>
        <def>
          <p id="Par19">Elvitegravir</p>
        </def>
      </def-item>
      <def-item>
        <term>FPV</term>
        <def>
          <p id="Par20">Fosamprenavir</p>
        </def>
      </def-item>
      <def-item>
        <term>HIV</term>
        <def>
          <p id="Par21">Human immunodeficiency virus</p>
        </def>
      </def-item>
      <def-item>
        <term>IC50</term>
        <def>
          <p id="Par22">Half maximal inhibitory concentration</p>
        </def>
      </def-item>
      <def-item>
        <term>IDV</term>
        <def>
          <p id="Par23">Indinavir</p>
        </def>
      </def-item>
      <def-item>
        <term>INI</term>
        <def>
          <p id="Par24">Integrase inhibitor</p>
        </def>
      </def-item>
      <def-item>
        <term>LPV</term>
        <def>
          <p id="Par25">Lopinavir</p>
        </def>
      </def-item>
      <def-item>
        <term>NFV</term>
        <def>
          <p id="Par26">Nelfinavir</p>
        </def>
      </def-item>
      <def-item>
        <term>NMSE</term>
        <def>
          <p id="Par27">Normalized Mean Square Error</p>
        </def>
      </def-item>
      <def-item>
        <term>NNRTI</term>
        <def>
          <p id="Par28">Non-nucleoside reverse transcriptase inhibitors</p>
        </def>
      </def-item>
      <def-item>
        <term>NRTI</term>
        <def>
          <p id="Par29">Nucleoside reverse transcriptase inhibitors</p>
        </def>
      </def-item>
      <def-item>
        <term>NVP</term>
        <def>
          <p id="Par30">Nevirapine</p>
        </def>
      </def-item>
      <def-item>
        <term>PCA</term>
        <def>
          <p id="Par31">Principal Components Analysis</p>
        </def>
      </def-item>
      <def-item>
        <term>PI</term>
        <def>
          <p id="Par32">Protease inhibitors</p>
        </def>
      </def-item>
      <def-item>
        <term>RAL</term>
        <def>
          <p id="Par33">Raltegravir</p>
        </def>
      </def-item>
      <def-item>
        <term>RF</term>
        <def>
          <p id="Par34">Random Forests</p>
        </def>
      </def-item>
      <def-item>
        <term>RPV</term>
        <def>
          <p id="Par35">Rilpivirine</p>
        </def>
      </def-item>
      <def-item>
        <term>SQV</term>
        <def>
          <p id="Par36">Saquinavir</p>
        </def>
      </def-item>
      <def-item>
        <term>SVM</term>
        <def>
          <p id="Par37">Support Vector Machine</p>
        </def>
      </def-item>
      <def-item>
        <term>TDF</term>
        <def>
          <p id="Par38">Tenofovir</p>
        </def>
      </def-item>
      <def-item>
        <term>TPV</term>
        <def>
          <p id="Par39">Tipranavir</p>
        </def>
      </def-item>
      <def-item>
        <term>WHO</term>
        <def>
          <p id="Par40">World Health Organization</p>
        </def>
      </def-item>
    </def-list>
  </glossary>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher’s Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <ack>
    <title>Acknowledgements</title>
    <p>A partial version of this work was presented at the 7th International Work-Conference IWBBIO 2019 in Granada, Spain (May 8-10, 2019), and is available on the conference proceedings (LNBI Proceedings Part II).</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Authors’ contributions</title>
    <p>LBM and MPE conceived and supervised research. ER developed code and performed research. ER and MPE wrote the manuscript with help from LBM. All authors read and approved the final manuscript.</p>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>This work was funded by project AGL2016–78709-R (Ministry of Economy and Competitiveness, Spain) to MPE. ER has funding from a FI-AGAUR PhD studentship grant (Generalitat de Catalunya). We acknowledge financial support from the Spanish Ministry of Economy and Competitiveness, through the “Severo Ochoa Programme for Centres of Excellence in R&amp;D” 2016–2019 (SEV-2015-0533)”, and from the EU through the BFU2016–77236-P (MINECO/AEI/FEDER, EU).</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and materials</title>
    <p>The datasets analyzed during the current study are available in the Genotype-Phenotype Stanford HIV Drug Resistance Database repository, <ext-link ext-link-type="uri" xlink:href="https://hivdb.stanford.edu/pages/genopheno.dataset.html">https://hivdb.stanford.edu/pages/genopheno.dataset.html</ext-link>. Structural data can be found at <ext-link ext-link-type="uri" xlink:href="https://www.rcsb.org/structure/3ekx">https://www.rcsb.org/structure/3ekx</ext-link> and <ext-link ext-link-type="uri" xlink:href="https://www.rcsb.org/structure/3v81">https://www.rcsb.org/structure/3v81</ext-link>. Code used in this manuscript is available at <ext-link ext-link-type="uri" xlink:href="https://bitbucket.org/elies_ramon/catkern">https://bitbucket.org/elies_ramon/catkern</ext-link>.</p>
  </notes>
  <notes>
    <title>Ethics approval and consent to participate</title>
    <p id="Par83">Not applicable.</p>
  </notes>
  <notes>
    <title>Consent for publication</title>
    <p id="Par84">Not applicable.</p>
  </notes>
  <notes notes-type="COI-statement">
    <title>Competing interests</title>
    <p id="Par85">MPE is a member of the editorial board (Associate Editor) of BMC Bioinformatics.</p>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <mixed-citation publication-type="other">UNAIDS. Facts sheet – world AIDS day 2018. UNAIDS. <ext-link ext-link-type="uri" xlink:href="http://www.unaids.org/sites/default/files/media_asset/UNAIDS_FactSheet_en.pdf">http://www.unaids.org/sites/default/files/media_asset/UNAIDS_FactSheet_en.pdf</ext-link>. Accessed 02 Feb 2019.</mixed-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Iyidogan</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Anderson</surname>
            <given-names>KS</given-names>
          </name>
        </person-group>
        <article-title>Current perspectives on HIV-1 antiretroviral drug resistance</article-title>
        <source>Viruses.</source>
        <year>2014</year>
        <volume>6</volume>
        <issue>10</issue>
        <fpage>4095</fpage>
        <lpage>4139</lpage>
        <pub-id pub-id-type="doi">10.3390/v6104095</pub-id>
        <pub-id pub-id-type="pmid">25341668</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <collab>German Advisory Committee Blood (Arbeitskreis Blut)</collab>
        </person-group>
        <article-title>Subgroup ‘assessment of pathogens transmissible by Blood'. Human immunodeficiency virus (HIV)</article-title>
        <source>Transfus Med Hemother</source>
        <year>2016</year>
        <volume>43</volume>
        <issue>3</issue>
        <fpage>203</fpage>
        <lpage>222</lpage>
        <pub-id pub-id-type="doi">10.1159/000445852</pub-id>
        <pub-id pub-id-type="pmid">27403093</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Shafer</surname>
            <given-names>RW</given-names>
          </name>
          <name>
            <surname>Dupnik</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Winters</surname>
            <given-names>MA</given-names>
          </name>
        </person-group>
        <article-title>Eshleman SH. A guide to HIV-1 reverse transcriptase and protease sequencing for drug resistance studies</article-title>
        <source>HIV Seq Compend</source>
        <year>2001</year>
        <volume>2001</volume>
        <fpage>1</fpage>
        <lpage>51</lpage>
        <?supplied-pmid 22324021?>
        <pub-id pub-id-type="pmid">22324021</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bonet</surname>
            <given-names>I</given-names>
          </name>
        </person-group>
        <article-title>Machine learning for prediction of HIV drug resistance: a review</article-title>
        <source>Curr Bioinforma</source>
        <year>2015</year>
        <volume>10</volume>
        <issue>5</issue>
        <fpage>579</fpage>
        <lpage>585</lpage>
        <pub-id pub-id-type="doi">10.2174/1574893610666151008011731</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schmidt</surname>
            <given-names>B</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Simple algorithm derived from a geno−/phenotypic database to predict HIV-1 protease inhibitor resistance</article-title>
        <source>AIDS (London, England)</source>
        <year>2000</year>
        <volume>14</volume>
        <issue>12</issue>
        <fpage>1731</fpage>
        <lpage>1738</lpage>
        <pub-id pub-id-type="doi">10.1097/00002030-200008180-00007</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wensing</surname>
            <given-names>AM</given-names>
          </name>
          <name>
            <surname>Calvez</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Gunthard</surname>
            <given-names>HF</given-names>
          </name>
          <name>
            <surname>Johnson</surname>
            <given-names>VA</given-names>
          </name>
          <name>
            <surname>Paredes</surname>
            <given-names>R</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>2017 update of the drug resistance mutations in HIV-1</article-title>
        <source>Top Antivir Med</source>
        <year>2017</year>
        <volume>24</volume>
        <issue>4</issue>
        <fpage>132</fpage>
        <lpage>133</lpage>
        <?supplied-pmid 28208121?>
        <pub-id pub-id-type="pmid">28208121</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Beerenwinkel</surname>
            <given-names>N</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Geno2pheno: estimating phenotypic drug resistance from HIV-1 genotypes</article-title>
        <source>Nucleic Acids Res</source>
        <year>2003</year>
        <volume>31</volume>
        <issue>13</issue>
        <fpage>3850</fpage>
        <lpage>3855</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkg575</pub-id>
        <pub-id pub-id-type="pmid">12824435</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Riemenschneider</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Hummel</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>Heider D. SHIVA - a web application for drug resistance and tropism testing in HIV</article-title>
        <source>BMC Bioinformatics</source>
        <year>2016</year>
        <volume>17</volume>
        <issue>1</issue>
        <fpage>314</fpage>
        <pub-id pub-id-type="doi">10.1186/s12859-016-1179-2</pub-id>
        <pub-id pub-id-type="pmid">27549230</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rhee</surname>
            <given-names>SY</given-names>
          </name>
          <name>
            <surname>Taylor</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Wadhera</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Ben-Hur</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Brutlag</surname>
            <given-names>DL</given-names>
          </name>
          <name>
            <surname>Shafer</surname>
            <given-names>RW</given-names>
          </name>
        </person-group>
        <article-title>Genotypic predictors of human immunodeficiency virus type 1 drug resistance</article-title>
        <source>Proc Natl Acad Sci U S A</source>
        <year>2006</year>
        <volume>103</volume>
        <issue>46</issue>
        <fpage>17355</fpage>
        <lpage>17360</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.0607274103</pub-id>
        <pub-id pub-id-type="pmid">17065321</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yu</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Weber</surname>
            <given-names>IT</given-names>
          </name>
          <name>
            <surname>Harrison</surname>
            <given-names>RW</given-names>
          </name>
        </person-group>
        <article-title>Prediction of HIV drug resistance from genotype with encoded three-dimensional protein structure</article-title>
        <source>BMC Genomics</source>
        <year>2014</year>
        <volume>15</volume>
        <issue>Suppl 5</issue>
        <fpage>S1</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2164-15-S5-S1</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Larder</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <article-title>Enhanced prediction of lopinavir resistance from genotype by use of artificial neural networks</article-title>
        <source>J Infect Dis</source>
        <year>2003</year>
        <volume>188</volume>
        <issue>5</issue>
        <fpage>653</fpage>
        <lpage>660</lpage>
        <pub-id pub-id-type="doi">10.1086/377453</pub-id>
        <pub-id pub-id-type="pmid">12934180</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pasomsub</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Sukasem</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Sungkanuparph</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Kijsirikul</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Chantratita</surname>
            <given-names>W</given-names>
          </name>
        </person-group>
        <article-title>The application of artificial neural networks for phenotypic drug resistance prediction: evaluation and comparison with other interpretation systems</article-title>
        <source>Jpn J Infect Dis</source>
        <year>2010</year>
        <volume>63</volume>
        <issue>2</issue>
        <fpage>87</fpage>
        <lpage>94</lpage>
        <?supplied-pmid 20332568?>
        <pub-id pub-id-type="pmid">20332568</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sheik Amamuddy</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Bishop</surname>
            <given-names>NT</given-names>
          </name>
          <name>
            <surname>Tastan Bishop</surname>
            <given-names>Ö</given-names>
          </name>
        </person-group>
        <article-title>Improving fold resistance prediction of HIV-1 against protease and reverse transcriptase inhibitors using artificial neural networks</article-title>
        <source>BMC Bioinformatics</source>
        <year>2017</year>
        <volume>18</volume>
        <issue>1</issue>
        <fpage>369</fpage>
        <pub-id pub-id-type="doi">10.1186/s12859-017-1782-x</pub-id>
        <pub-id pub-id-type="pmid">28810826</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Masso</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Vaisman</surname>
            <given-names>II</given-names>
          </name>
        </person-group>
        <article-title>Sequence and structure based models of HIV-1 protease and reverse transcriptase drug resistance</article-title>
        <source>BMC Genomics</source>
        <year>2013</year>
        <volume>14</volume>
        <issue>Suppl 4</issue>
        <fpage>S3</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2164-14-S4-S3</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Khalid</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Sezerman</surname>
            <given-names>OU</given-names>
          </name>
        </person-group>
        <article-title>Prediction of HIV drug resistance by combining sequence and structural properties</article-title>
        <source>IEEE/ACM Trans Comput Biol Bioinform</source>
        <year>2018</year>
        <volume>15</volume>
        <issue>3</issue>
        <fpage>966</fpage>
        <lpage>973</lpage>
        <pub-id pub-id-type="doi">10.1109/TCBB.2016.2638821</pub-id>
        <pub-id pub-id-type="pmid">27992346</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <collab>Beerenwinkel, et al.</collab>
        </person-group>
        <article-title>Diversity and complexity of HIV-1 drug resistance: a bioinformatics approach to predicting phenotype from genotype</article-title>
        <source>Proc Natl Acad Sci U S A</source>
        <year>2002</year>
        <volume>99</volume>
        <issue>12</issue>
        <fpage>8271</fpage>
        <lpage>8276</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.112177799</pub-id>
        <pub-id pub-id-type="pmid">12060770</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Shen</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Yu</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Harrison</surname>
            <given-names>RW</given-names>
          </name>
          <name>
            <surname>Weber</surname>
            <given-names>IT</given-names>
          </name>
        </person-group>
        <article-title>Automated prediction of HIV drug resistance from genotype data</article-title>
        <source>BMC Bioinformatics</source>
        <year>2016</year>
        <volume>17</volume>
        <issue>Suppl 8</issue>
        <fpage>278</fpage>
        <pub-id pub-id-type="doi">10.1186/s12859-016-1114-6</pub-id>
        <pub-id pub-id-type="pmid">27586700</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tarasova</surname>
            <given-names>Olga</given-names>
          </name>
          <name>
            <surname>Biziukova</surname>
            <given-names>Nadezhda</given-names>
          </name>
          <name>
            <surname>Filimonov</surname>
            <given-names>Dmitry</given-names>
          </name>
          <name>
            <surname>Poroikov</surname>
            <given-names>Vladimir</given-names>
          </name>
        </person-group>
        <article-title>A Computational Approach for the Prediction of HIV Resistance Based on Amino Acid and Nucleotide Descriptors</article-title>
        <source>Molecules</source>
        <year>2018</year>
        <volume>23</volume>
        <issue>11</issue>
        <fpage>2751</fpage>
        <pub-id pub-id-type="doi">10.3390/molecules23112751</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Heider</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Senge</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Cheng</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Hüllermeier</surname>
            <given-names>E</given-names>
          </name>
        </person-group>
        <article-title>Multilabel classification for exploiting cross-resistance information in HIV-1 drug resistance prediction</article-title>
        <source>Bioinformatics.</source>
        <year>2013</year>
        <volume>29</volume>
        <issue>16</issue>
        <fpage>1946</fpage>
        <lpage>1952</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btt331</pub-id>
        <pub-id pub-id-type="pmid">23793752</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Riemenschneider</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Senge</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Neumann</surname>
            <given-names>U</given-names>
          </name>
          <name>
            <surname>Hüllermeier</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Heider</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>Exploiting HIV-1 protease and reverse transcriptase cross-resistance information for improved drug resistance prediction by means of multi-label classification</article-title>
        <source>BioData Min</source>
        <year>2016</year>
        <volume>9</volume>
        <fpage>10</fpage>
        <pub-id pub-id-type="doi">10.1186/s13040-016-0089-1</pub-id>
        <pub-id pub-id-type="pmid">26933450</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <mixed-citation publication-type="other">Xing L, Lesperance M, Zhang X. Simultaneous prediction of multiple outcomes using revised stacking algorithms. Version 1. 29 Jan 2019. <ext-link ext-link-type="uri" xlink:href="https://arxiv.org/abs/1901.10153v1">arXiv:1901.10153v1</ext-link> [q-bio.QM].</mixed-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <mixed-citation publication-type="other">Scholkopf B, Vert JP, Tsuda K. Kernel methods in computational biology. 1st ed. Cambridge: The MIT Press/A Bradford Book; 2004.</mixed-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <mixed-citation publication-type="other">Genotype-Phenotype Stanford University HIV Drug Resistance Database. <ext-link ext-link-type="uri" xlink:href="https://hivdb.stanford.edu/pages/genopheno.dataset.html">https://hivdb.stanford.edu/pages/genopheno.dataset.html</ext-link>. Accessed 30 May 2019.</mixed-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Belanche</surname>
            <given-names>LA</given-names>
          </name>
          <name>
            <surname>Villegas</surname>
            <given-names>MA</given-names>
          </name>
        </person-group>
        <article-title>Kernel functions for categorical variables with application to problems in the life sciences</article-title>
        <source>Front Artif Intell Appl</source>
        <year>2013</year>
        <volume>256</volume>
        <fpage>171</fpage>
        <lpage>180</lpage>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bouchard</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Jousselme</surname>
            <given-names>AL</given-names>
          </name>
        </person-group>
        <article-title>Doré PE. A proof for the positive definiteness of the Jaccard index matrix</article-title>
        <source>Int J Approx Reason</source>
        <year>2013</year>
        <volume>54</volume>
        <issue>5</issue>
        <fpage>615</fpage>
        <lpage>626</lpage>
        <pub-id pub-id-type="doi">10.1016/j.ijar.2013.01.006</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <mixed-citation publication-type="other">R Core Team. R: a language and environment for statistical computing. Vienna: R Foundation for Statistical Computing. <ext-link ext-link-type="uri" xlink:href="https://www.r-project.org/">https://www.R-project.org/</ext-link>. Accessed 15 Feb 2019</mixed-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Perrin</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Telenti</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>HIV treatment failure: testing for HIV resistance in clinical practice</article-title>
        <source>Science.</source>
        <year>1998</year>
        <volume>280</volume>
        <issue>5371</issue>
        <fpage>1871</fpage>
        <lpage>1873</lpage>
        <pub-id pub-id-type="doi">10.1126/science.280.5371.1871</pub-id>
        <pub-id pub-id-type="pmid">9669946</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
