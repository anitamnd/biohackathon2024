<?DTDIdentifier.IdentifierValue article.dtd?>
<?DTDIdentifier.IdentifierType system?>
<?SourceDTD.DTDName article.dtd?>
<?SourceDTD.Version 1.0?>
<?ConverterInfo.XSLTName bmc2nlmx2.xsl?>
<?ConverterInfo.Version 2?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>BMC Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">4003822</article-id>
    <article-id pub-id-type="publisher-id">1471-2105-15-74</article-id>
    <article-id pub-id-type="pmid">24629125</article-id>
    <article-id pub-id-type="doi">10.1186/1471-2105-15-74</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>BCRgt: a Bayesian cluster regression-based genotyping algorithm for the samples with copy number alterations</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" id="A1">
        <name>
          <surname>Yang</surname>
          <given-names>Shengping</given-names>
        </name>
        <xref ref-type="aff" rid="I1">1</xref>
        <xref ref-type="aff" rid="I2">2</xref>
        <email>shengping.yang@ttuhsc.edu</email>
      </contrib>
      <contrib contrib-type="author" id="A2">
        <name>
          <surname>Cui</surname>
          <given-names>Xiangqin</given-names>
        </name>
        <xref ref-type="aff" rid="I3">3</xref>
        <email>xcui@uab.edu</email>
      </contrib>
      <contrib contrib-type="author" corresp="yes" id="A3">
        <name>
          <surname>Fang</surname>
          <given-names>Zhide</given-names>
        </name>
        <xref ref-type="aff" rid="I1">1</xref>
        <email>zfang@lsuhsc.edu</email>
      </contrib>
    </contrib-group>
    <aff id="I1"><label>1</label>Biostatistics Program, School of Public Health, LSU Health Sciences Center, 2020 Gravier Street, New Orleans, LA 70115, USA</aff>
    <aff id="I2"><label>2</label>Department of Pathology, School of Medicine, Texas Tech University Health Science Center, Lubbock, Texas, USA</aff>
    <aff id="I3"><label>3</label>Department of Biostatistics, University of Alabama at Birmingham, 1665 University Blvd, Birmingham, AL 35294, USA</aff>
    <pub-date pub-type="collection">
      <year>2014</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>15</day>
      <month>3</month>
      <year>2014</year>
    </pub-date>
    <volume>15</volume>
    <fpage>74</fpage>
    <lpage>74</lpage>
    <history>
      <date date-type="received">
        <day>3</day>
        <month>6</month>
        <year>2013</year>
      </date>
      <date date-type="accepted">
        <day>10</day>
        <month>3</month>
        <year>2014</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>Copyright © 2014 Yang et al.; licensee BioMed Central Ltd.</copyright-statement>
      <copyright-year>2014</copyright-year>
      <copyright-holder>Yang et al.; licensee BioMed Central Ltd.</copyright-holder>
      <license license-type="open-access" xlink:href="http://creativecommons.org/licenses/by/2.0">
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/2.0">http://creativecommons.org/licenses/by/2.0</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly credited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="http://www.biomedcentral.com/1471-2105/15/74"/>
    <abstract>
      <sec>
        <title>Background</title>
        <p>Accurate genotype calling is a pre-requisite of a successful Genome-Wide Association Study (GWAS). Although most genotyping algorithms can achieve an accuracy rate greater than 99% for genotyping DNA samples without copy number alterations (CNAs), almost all of these algorithms are not designed for genotyping tumor samples that are known to have large regions of CNAs.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p>This study aims to develop a statistical method that can accurately genotype tumor samples with CNAs. The proposed method adds a Bayesian layer to a cluster regression model and is termed a Bayesian Cluster Regression-based genotyping algorithm (BCRgt). We demonstrate that high concordance rates with HapMap calls can be achieved without using reference/training samples, when CNAs do not exist. By adding a training step, we have obtained higher genotyping concordance rates, without requiring large sample sizes. When CNAs exist in the samples, accuracy can be dramatically improved in regions with DNA copy loss and slightly improved in regions with copy number gain, comparing with the Bayesian Robust Linear Model with Mahalanobis distance classifier (BRLMM).</p>
      </sec>
      <sec>
        <title>Conclusions</title>
        <p>In conclusion, we have demonstrated that BCRgt can provide accurate genotyping calls for tumor samples with CNAs.</p>
      </sec>
    </abstract>
    <kwd-group>
      <kwd>Bayesian cluster regression</kwd>
      <kwd>Copy number alteration</kwd>
      <kwd>Genotyping</kwd>
      <kwd>SNP array</kwd>
    </kwd-group>
  </article-meta>
</front>
<body>
  <sec>
    <title>Background</title>
    <p>Most multicellular organisms have two copies of chromosomes (diploid organisms). An allele refers to one of the different arrangements of nucleus acids in the same genetic location (locus) on homologous chromosomes. Every individual has two alleles in one locus, making up the genotype, either homozygous or heterozygous. A Single Nucleotide Polymorphism (SNP) is a genetic variation where one single nucleotide differs between the two alleles in members of a population or paired chromosomes. In humans, although most SNPs have no effect on health, some of them have been shown to affect how an individual develops diseases and responds to drug treatments. As a result, a great deal of contemporary biomedical research focuses on investigating the association between SNPs and phenotypes (e.g. diseases), known as Genome-Wide Association Study (GWAS).</p>
    <p>Since the release of the first commercial SNP array in 1996 by Affymetrix (Santa Clara, CA, USA), SNP arrays have been intensively used in GWAS. In the last decade, these applications have resulted in the identification of a large number of common genetic variants that are associated with different diseases. Today, while Next-Generation Sequencing (NGS) has greatly changed the landscape of genetic research due to the rapid drop in cost, SNP array technique is still more economical to use and has many other advantages, such as less labor intensive sample preparation and being more conducive to working for a large number of samples.</p>
    <p>Accurate SNP genotyping is one of the important factors of a successful GWAS. This has motivated researchers, in both academia and industry, to develop sophisticated algorithms to improve genotyping accuracy.</p>
    <p>For technical supports, Affymetrix developed the accompanying genotyping software - Modified Partitioning Around Medoids (MPAM), after the release of their first generation GeneChip array, and then the Dynamic Model (DM) algorithm for the GeneChip 100 K array. These two arrays have similar designs although the 100 K arrays include more SNPs. For each array, every SNP is interrogated by a number of probe quartets, each of which is composed of a 25-base-pair Perfect Match oligonucleotide probe (PM; probe sequence matching the target sequence) and a Mismatch probe (MM; probe sequence obtained by replacing the middle (13th) base of the PM with its Watson-Crick complement) for alleles A and B separately. To make a genotype call for a SNP, one can use allelic intensities detected by the PM probe(s) as foreground and those by the MM probe(s) as background to calculate the likelihood for each possible genotype (AA, AB, BB, or NoCall), and then make the genotyping call, based on the highest likelihood [<xref ref-type="bibr" rid="B1">1</xref>]. For example, if the likelihood for genotype AA is the largest, we assign “AA” as the genotype for the SNP. However, since both MAPM and DM were designed to genotype one SNP on one chip (sample) at a time, their overall genotyping call accuracies are not satisfactory. To improve genotyping accuracy, many other methods have been proposed, including the Robust Linear Model with Mahalanobis distance classifier (RLMM) [<xref ref-type="bibr" rid="B2">2</xref>]. Specifically, for each SNP, by using PM probes only (it has been shown that MM probes can cause more trouble than good), RLMM includes all allelic intensities across multiple chips in a model to estimate the possible genotype clusters. In this way, the between-chip-level variations can be well accommodated. Subsequently, an improved model, named BRLMM [<xref ref-type="bibr" rid="B3">3</xref>], was proposed by adding a Bayesian step to RLMM. BRLMM utilizes the genotyping calls from DM as the initial “seed” genotypes to determine the parameters of the Bayesian prior distributions, and adopts the multi-array model approach to enhance the accuracy of genotype cluster estimates. Note that the link between BRLMM and DM limits the application of BRLMM to newer generations of arrays, such as SNP array 5.0/6.0, because these new arrays do not have MM probes that are employed by DM to make the initial “seed” genotype calls. To overcome this limitation, BRLMM-P was introduced, which estimates initial “seed” genotypes directly from the clustering properties of the PM probes [<xref ref-type="bibr" rid="B4">4</xref>]. However, this data-driven approach requires a rigorous performance standard for SNP screening. As a result, for 500 k array, only 440,794, out of 500,568, SNPs are considered to have high quality BRLMM-P calls.</p>
    <p>The Birdsuite software, introduced by the Broad Institute in collaboration with Affymetrix, was initially developed for genotyping SNP 6.0 array data. The birdseed, one component of the software, like all other software mentioned above, was developed exclusively for genotyping diploid genomic regions that do not have CNAs (duplication and deletion events occurring in somatic cells) [<xref ref-type="bibr" rid="B5">5</xref>], and copy number variations (CNVs; local duplication and deletion events occurring at kb or Mb scale in germline cells). The Birdseye software, another component of Birdsuite, although being able to detect rare CNVs and genotype SNPs in CNV regions, was not designed to make genotype calls for samples with CNAs. This is generally because of issues such as random occurrence of CNAs along the genome and contamination of normal tissues in tumor samples [<xref ref-type="bibr" rid="B6">6</xref>].</p>
    <p>Like Affymetrix, Illumina has its own genotyping software, called GenCall and implemented within the BeadStudio, to genotype SNPs on the BeadChip arrays. Similar to RLMM and BRLMM-P, GenCall applies a multi-array approach and can make genotype calls with or without using a reference dataset, depending on the sample size.</p>
    <p>In addition, other methods are also available for genotyping Affymetrix/Illumina arrays. These algorithms differ in their aims. For example, Corrected Robust Model with Maximum Likelihood Distance (CRLMM) [<xref ref-type="bibr" rid="B7">7</xref>] focused on reducing across-lab variations through improving data pre-processing. SNiPer-High Density (SNiPer-HD) [<xref ref-type="bibr" rid="B8">8</xref>] was designed to obtain high accuracy for highly informative (that is, the genotype is called with high confidence) SNPs. Chiamo [<xref ref-type="bibr" rid="B9">9</xref>] and ALCHEMY [<xref ref-type="bibr" rid="B10">10</xref>] were especially useful for calling small batch sizes and highly homozygous populations. Algorithms designed for Illumina arrays include GenoSNP [<xref ref-type="bibr" rid="B11">11</xref>] for improved calling on rare variants; M<sup>3</sup>[<xref ref-type="bibr" rid="B12">12</xref>], which is based on Modified Mixed Model; and Opticall [<xref ref-type="bibr" rid="B13">13</xref>] for more accurately genotyping rare, low-frequency and common variants.</p>
    <p>Although the majority of these algorithms showed some success in improving the genotyping accuracy, they were initially developed for genotyping samples without CNAs. We comment that GenoCN [<xref ref-type="bibr" rid="B14">14</xref>] could genotype samples with CNAs, but it adopted a one chip at a time approach, and was designed mainly for Illumina array data.</p>
    <p>On the other hand, many genetic diseases (cancers) are associated with CNAs, and lots of methodologies have been developed to correctly detect CNAs [<xref ref-type="bibr" rid="B15">15</xref>-<xref ref-type="bibr" rid="B17">17</xref>]. By each of these methods, copy number status (gain/loss/unchanged) can be obtained for every SNP in a sample. Generally, CNA calls for tumor samples with paired normal samples can have a high level of accuracy. If there are no paired normal samples, one can still be able to obtain reliable CNA calls by using a generic normal as control [<xref ref-type="bibr" rid="B18">18</xref>]. Note that since CNAs are somatic alterations, it is difficult to predict where on the chromosome CNAs occur. Meanwhile, in the sample preparing step, it is usually hard to avoid normal tissue contamination. Most cluster-based genotyping algorithms could run into the problem of misclassification at the regions of CNAs because CNAs substantially altered the number of A and B alleles, and thus, the A and B allele log-intensities from the array. We recommend incorporating CNA status into the cluster regression model to adjust for the effect of CNAs. To do so, both high quality copy number calls and stringent sample screening are necessary.</p>
    <p>In this paper, we propose a Bayesian Cluster Regression based genotyping (BCRgt) approach to genotype samples with CNAs. This is motivated by the facts that cancer tissues often have large regions of genetic structural alterations such as CNAs [<xref ref-type="bibr" rid="B19">19</xref>], and that researchers have been interested in genotyping SNPs from such samples.</p>
    <p>The setup of the paper is as follows. In Section Methods, we will describe the steps of BCRgt. In Section Results and discussion, we use HapMap (details in Subsection Genotyping the samples without CNAs by BCRgt) genotype calls as a gold standard to calculate the concordance rates, the probability that a pair of genotyping results have a certain genotype, given that one of the pair has such a genotype, in order to evaluate the performance of BCRgt for samples without CNAs. Furthermore, we will apply BCRgt to samples with CNAs, to illustrate the improvement that BCRgt makes in genotyping CNA regions comparing over BRLMM. At the end of the paper, we will briefly discuss the ideal situation for using BCRgt and the limitations of this method.</p>
  </sec>
  <sec sec-type="methods">
    <title>Methods</title>
    <p>There are several widely used Affymetrix SNP array platforms, including the genome-wide human SNP Array 5.0/6.0, GeneChip® Mapping 10 K/100 K/500 K Array. In this paper, we will focus on the Affymetrix GeneChip® Mapping 500 K array. The Array Set consis ts of Nsp and Sty arrays for Nsp I and Sty I restriction enzyme digested genomes, respectively. Each Nsp (or Sty) array has the capacity to interrogate about 250,000 SNPs, with, on average, 6 to 10 pairs of allele-specific intensity measurements per SNP. In our analysis, for each SNP, these 6 to 10 measurements are averaged for both A and B alleles, and the averaged values will be used as the input in BCRgt. Note that although Mapping 500 K array has both PM and MM probes for each allele, BCRgt utilizes only PM probe intensities, and thus, can be directly applied to newer generations of Affymetrix arrays.</p>
    <sec>
      <title>Quantile normalization</title>
      <p>SNP-specific signal intensity distributions are different not only across SNPs but also across samples/labs/studies. SNP array genotyping is usually carried out array-wisely, one SNP at a time. Thus, a successful genotyping algorithm can benefit from an appropriate normalization step to adjust for the undesirable between-array experimental/biological variations. Quantile Normalization (QN) is one of the widely used normalization methods. By assuming that the distributions of DNA abundances are nearly the same across all samples, QN transforms the raw intensities to the corresponding quantile’s value. Although QN has many good properties when all the samples for genotyping do not have CNAs, it does not perform well in normalizing samples with CNAs [<xref ref-type="bibr" rid="B20">20</xref>]. Therefore, for simplicity we recommend applying QN on samples without CNAs, but not doing so for samples with CNAs.</p>
    </sec>
    <sec>
      <title>Bayesian cluster regression</title>
      <p>Let <italic>x</italic><sub><italic>ij</italic></sub> ∈ (0, <italic>∞</italic>), <italic>y</italic><sub><italic>ij</italic></sub> ∈ (0, <italic>∞</italic>) denote the log-intensities of <italic>A</italic>, <italic>B</italic> alleles of the <italic>j</italic><sup><italic>th</italic></sup> SNP of the <italic>i</italic><sup><italic>th</italic></sup> subject. A successful genotyping approach should depend on the relative relationship between A and B alleles, not on the absolute values of A and B alleles. Thus, we will make genotype calls based on such allelic relationship, and arbitrarily choose either A or B allelic log-intensity as the predictor so that the linear relationship between A and B alleles can be investigated via a traditional linear regression if they come from the same population (genotype). We further assume, for simplification, that the allelic log-intensities of adjacent SNPs are independent of each other. The rationale underlying this assumption is that the physical distance between two consecutive SNPs is very often at least hundreds of base pairs apart. For notational convenience, we will drop the subscript <italic>j</italic> because genotyping call is made independently for each SNP in the proposed algorithm. In addition, for every SNP, both A and B allelic log-intensities are centralized at the median of the A allele log-intensities.</p>
      <sec>
        <title>Traditional cluster regression</title>
        <p>Consider the case of three clusters, and assume that the paired observations (<italic>x</italic><sub><italic>i</italic></sub>, <italic>y</italic><sub><italic>i</italic></sub>) come from one of the three unknown component populations (clusters), that is, <italic>C</italic><sub><italic>i</italic></sub> = <italic>k</italic> with probability <italic>π</italic><sub><italic>k</italic></sub>, where <italic>k</italic> ∈ {1, 2, 3}. Let <bold><italic>X</italic></bold> be a matrix with the first column being an all-ones vector, and the second column consisting of the corresponding <italic>x</italic> values from the cluster <italic>k</italic>. For a given cluster <italic>C</italic><sub><italic>i</italic></sub> = <italic>k</italic>, the relationship between <bold><italic>X</italic></bold> and <italic>y</italic> can be expressed in the following model with parameter <bold>β</bold><sub>k</sub>,</p>
        <p>
          <disp-formula>
            <mml:math id="M1" name="1471-2105-15-74-i1" overflow="scroll">
              <mml:mrow>
                <mml:msub>
                  <mml:mi mathvariant="italic">y</mml:mi>
                  <mml:mrow>
                    <mml:msub>
                      <mml:mi mathvariant="italic">C</mml:mi>
                      <mml:mi mathvariant="italic">i</mml:mi>
                    </mml:msub>
                    <mml:mo>=</mml:mo>
                    <mml:mi mathvariant="italic">k</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:mo>=</mml:mo>
                <mml:msub>
                  <mml:mi mathvariant="italic">X</mml:mi>
                  <mml:mrow>
                    <mml:msub>
                      <mml:mi mathvariant="italic">C</mml:mi>
                      <mml:mi mathvariant="italic">i</mml:mi>
                    </mml:msub>
                    <mml:mo>=</mml:mo>
                    <mml:mi mathvariant="italic">k</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:msub>
                  <mml:mi mathvariant="bold">β</mml:mi>
                  <mml:mi mathvariant="italic">k</mml:mi>
                </mml:msub>
                <mml:mo>+</mml:mo>
                <mml:msub>
                  <mml:mi mathvariant="italic">ξ</mml:mi>
                  <mml:mi mathvariant="italic">k</mml:mi>
                </mml:msub>
                <mml:mo>,</mml:mo>
              </mml:mrow>
            </mml:math>
          </disp-formula>
        </p>
        <p>where <italic>C</italic><sub><italic>i</italic></sub> ~ <italic>Multinomial</italic>(<italic>π</italic>)  and the error vector <italic>ξ</italic><sub><italic>k</italic></sub> ~ <italic>N</italic>(0, <italic>σ</italic><sup>2</sup><italic>I</italic>) [<xref ref-type="bibr" rid="B21">21</xref>]. Note that the three clusters represent three different genotypes, AA, AB, BB, and that each of the three linear regression models in the above equation is fitted for one of the three genotypes. A NoCall can be made if none of the probability of AA, AB or BB is above a certain threshold, such as 99.9%. We comment that setting such a threshold can improve the overall genotyping accuracy, but, as a tradeoff, the overall call rate (the percentage of SNPs that are called as AA, AB or BB rather than NoCall) drops.</p>
      </sec>
      <sec>
        <title>Bayesian cluster regression</title>
        <p>Despite the fact that cluster regression has many good properties in classifying samples into different groups at the individual SNP level, further improvement can be made by incorporating additional information from all SNPs across the samples. Adding a Bayesian step would be a good choice for this purpose.</p>
        <p>For every SNP, cluster regression partitions all samples into “AA”, “BB” and “AB” genotype clusters. However, problems might arise if one or even two genotypes do not exist for all samples, thus misclassification is very likely to occur. BCRgt adds a Bayesian layer to pre-define the distribution of each of the three clusters based on the intercept and slope of each cluster, which are estimated from the A and B allele log-intensities of a large sample of all SNPs and all samples. Then, if the genotypes of a SNP are the same for all the samples, applying a prior distribution based on these estimates will improve the accuracy in estimating the parameters of the posterior distributions.</p>
        <p>One of the key issues in a Bayesian model is to derive the posterior distribution. In order to have a closed-form posterior distribution, the commonly used prior for (<bold>β</bold>, σ<sup>2</sup>) is a normal-inverse-gamma distribution of the form <italic>p</italic>(<bold>β</bold>, <italic>σ</italic><sup>2</sup>) = <italic>p</italic>(<bold>β</bold> | <italic>σ</italic><sup>2</sup>)<italic>p</italic>( <italic>σ</italic><sup>2</sup>) with the first part being a multivariate normal distribution and the second part an inverse-gamma distribution [<xref ref-type="bibr" rid="B21">21</xref>]. Note that the posterior distribution is also a normal-inverse-gamma distribution. In this paper, for model and computational simplicity, we will use the frequentist method (that is, parameters are estimated from the current data itself, no prior information is needed) to estimate <italic>σ</italic><sup><italic>2</italic></sup>, instead of imposing a prior on <italic>σ</italic><sup><italic>2</italic></sup>. By doing so, we impose that the prior is reduced to a multivariate normal distribution <italic>N</italic>(<bold>β</bold><sub><italic>prior</italic></sub>, <italic>σ</italic><sup>2</sup><bold>V</bold>), where the elements <italic>β</italic><sub><italic>k</italic>0,<italic>prior</italic></sub> and <italic>β</italic><sub><italic>k</italic>1,<italic>prior</italic></sub> of the two-dimensional mean vector <bold>β</bold><sub><italic>prior</italic></sub> represent the expected values of the distributions of the intercept and slope for the cluster <italic>k</italic>, respectively, and <italic>σ</italic><sup>2</sup><bold>V</bold> is a diagonal matrix with the diagonal elements being the corresponding variances. The expectation of the posterior distribution can be easily derived as <inline-formula><mml:math id="M2" name="1471-2105-15-74-i2" overflow="scroll"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold">β</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mi mathvariant="italic">Bayes</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mfenced close=")" open="("><mml:mrow><mml:msup><mml:mi mathvariant="bold">V</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:mi mathvariant="italic">X</mml:mi><mml:mo>'</mml:mo><mml:mi mathvariant="italic">X</mml:mi></mml:mrow></mml:mfenced><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mfenced close=")" open="("><mml:mrow><mml:msup><mml:mi mathvariant="bold">V</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:msub><mml:mi mathvariant="bold">β</mml:mi><mml:mi mathvariant="italic">prior</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mi mathvariant="italic">X</mml:mi><mml:mo>'</mml:mo><mml:mi mathvariant="italic">y</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:math></inline-formula> (see Additional file <xref ref-type="supplementary-material" rid="S1">1</xref>). We comment that higher-order polynomial terms may be added to the model in order to better accommodate the samples with less stringent quality control. However, since minor changes in higher-order terms usually have substantial effects on model fitting, in order to make sure that the prior distributions of the higher order terms do not have dominating effects on the posterior distribution, a very strong prior favoring the null hypothesis, i.e., higher order terms do not contribute to the model, should be used. In practice, we observed that, for the samples we have tested, adding a quadratic term to the simple linear model could only result in a negligible difference in the fitting results. Thus, for the model parsimony reason, we only considered a simple linear model.</p>
        <p>The Expectation-Maximization (EM) algorithm [<xref ref-type="bibr" rid="B22">22</xref>,<xref ref-type="bibr" rid="B23">23</xref>] was used to estimate <bold>β</bold>. Specifically, the expectation step was to find the expectation of <italic>Q</italic>(<bold>β</bold>, <italic>σ</italic><sup>2</sup>|<bold>β</bold><sup>(<italic>t</italic>)</sup>, <italic>σ</italic><sup>2(<italic>t</italic>)</sup>), namely <italic>E</italic>(<italic>C</italic><sub><italic>ik</italic></sub> | <italic>y</italic>, <bold>β</bold><sub><italic>k</italic></sub>, <italic>σ</italic><sup>2</sup>), based on data; and the maximization step was to update (<bold>β</bold>, σ<sup>2</sup>) with (<bold>β</bold><sup>(t+1)</sup>, σ<sup>2(t+1)</sup>) that maximizes <italic>Q</italic>(<bold>β</bold>, <italic>σ</italic><sup>2</sup>|<bold>β</bold><sup>(<italic>t</italic>)</sup>, <italic>σ</italic><sup>2(<italic>t</italic>)</sup>) (see Additional file <xref ref-type="supplementary-material" rid="S1">1</xref>). The EM algorithm was converged/stopped when the difference of two consecutive estimates of the parameters was smaller than a pre-set small value or after 30 iterations. The parameter values from the last iteration were taken as the final estimates.</p>
      </sec>
    </sec>
    <sec>
      <title>The values of the parameters of the prior distributions</title>
      <p>Setting parameter values for the prior distributions is a critical step in a successful Bayesian cluster regression. We describe in the next subsections how to setup these values.</p>
      <sec>
        <title>The expectations of the intercepts and slopes of the prior distributions</title>
        <p>We followed the approach in [<xref ref-type="bibr" rid="B13">13</xref>] to take advantage of the information obtained from the data. Specifically, we randomly selected a subset of all the paired A and B allelic log-intensities across samples. The size of the subset is quite arbitrary, for example, 5,000 to 50,000. The three clusters representing AA, AB and BB genotypes are clearly separated (Figure <xref ref-type="fig" rid="F1">1</xref>(a)) and can be roughly classified by most of cluster analysis methods proposed in literature. Our approach is a computationally simple alternative. We calculated the first difference statistics [<xref ref-type="bibr" rid="B24">24</xref>], <italic>diff</italic>(<italic>x</italic> - <italic>y</italic>) = (<italic>x</italic> - <italic>y</italic>)<sub>(<italic>t</italic>)</sub> - (<italic>x</italic> - <italic>y</italic>)<sub>(<italic>t</italic> - 1)</sub>, where (<italic>x-y</italic>) is log-Ratio of the A and B allelic signal intensities and <italic>t</italic> is the order, and searched by a moving average (the un-weighted mean of the previous <italic>n</italic> data points) approach for the two maximum values, between the 25th and 50th percentiles and between the 50th and 75th percentiles, respectively. The numbers of observations separated by the two maximum values are roughly equal to the numbers of observations with AA, AB and BB genotypes respectively (Figure <xref ref-type="fig" rid="F1">1</xref>(b)). After identifying these three clusters, we fitted a simple linear regression for each cluster and used the estimated model parameters as the intercept and slope of the prior distribution for the corresponding cluster. We comment that, 1) in practice, although the estimates of the slopes are somewhat different from 1 (45 degree), it usually works well to use 1 for all slopes for simplification purpose; 2) the proportion of observations with AB genotype is lower than those of observations with AA/BB genotypes, and this can be conveniently adjusted in the EM algorithm by putting different weights for AB and AA/BB genotypes.</p>
        <fig id="F1" position="float">
          <label>Figure 1</label>
          <caption>
            <p><bold>Plots illustrate how parameters of the prior distributions are estimated. (a)</bold> Scatter plot of Centralized A and B allelic log-intensities for 5,000 SNPs. Note that observations are symmetric about the 45 degree line. <bold>(b)</bold> First difference plot: the two vertical lines partition observations into three clusters corresponding to observations with AA, AB and BB genotypes.</p>
          </caption>
          <graphic xlink:href="1471-2105-15-74-1"/>
        </fig>
      </sec>
      <sec>
        <title>The variances of the intercepts and slopes of the prior distributions</title>
        <p>It is well known that the posterior mean of the parameter vector in Bayesian linear regression can be expressed in terms of the least square estimate and the prior mean. To obtain the variance of the least square estimate, we chose 100 SNPs that have only one genotype (either AA or BB), and calculated the average of the 100 variances of the least square estimates of the slope. We then used one third of such an average value as the variance of the prior distribution for the slope to ensure that the prior information on the slope plays a substantial role. As a justification, we replaced one third by a decreasing sequence: one fifth, one tenth of the average value, and observed very small differences in genotype calling results (data not shown). Similarly, we set the variance of the prior distribution for the intercept to be roughly equal to three times of that estimated from the data so that the intercepts are more influenced by the data.</p>
        <p>Meanwhile, the model in maximization step is defined as</p>
        <p>
          <disp-formula>
            <mml:math id="M3" name="1471-2105-15-74-i3" overflow="scroll">
              <mml:mtable columnalign="left">
                <mml:mtr>
                  <mml:mtd>
                    <mml:msub>
                      <mml:mi mathvariant="italic">y</mml:mi>
                      <mml:mrow>
                        <mml:msub>
                          <mml:mi mathvariant="italic">C</mml:mi>
                          <mml:mi mathvariant="italic">i</mml:mi>
                        </mml:msub>
                        <mml:mo>=</mml:mo>
                        <mml:mi mathvariant="italic">k</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                    <mml:mo>=</mml:mo>
                    <mml:msub>
                      <mml:mi mathvariant="italic">β</mml:mi>
                      <mml:mrow>
                        <mml:mi mathvariant="italic">k</mml:mi>
                        <mml:mn>0</mml:mn>
                      </mml:mrow>
                    </mml:msub>
                    <mml:mo>+</mml:mo>
                    <mml:msub>
                      <mml:mi mathvariant="italic">x</mml:mi>
                      <mml:mrow>
                        <mml:msub>
                          <mml:mi mathvariant="italic">C</mml:mi>
                          <mml:mi mathvariant="italic">i</mml:mi>
                        </mml:msub>
                        <mml:mo>=</mml:mo>
                        <mml:mi mathvariant="italic">k</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                    <mml:msub>
                      <mml:mi mathvariant="italic">β</mml:mi>
                      <mml:mrow>
                        <mml:mi mathvariant="italic">k</mml:mi>
                        <mml:mn>1</mml:mn>
                      </mml:mrow>
                    </mml:msub>
                    <mml:mo>+</mml:mo>
                    <mml:msub>
                      <mml:mi mathvariant="italic">ξ</mml:mi>
                      <mml:mi mathvariant="italic">k</mml:mi>
                    </mml:msub>
                    <mml:mo>,</mml:mo>
                  </mml:mtd>
                </mml:mtr>
                <mml:mtr>
                  <mml:mtd>
                    <mml:mi mathvariant="normal">where</mml:mi>
                    <mml:mspace width="0.12em"/>
                    <mml:mi mathvariant="italic">k</mml:mi>
                    <mml:mo mathvariant="italic">=</mml:mo>
                    <mml:mn>1</mml:mn>
                    <mml:mo>,</mml:mo>
                    <mml:mn>2</mml:mn>
                    <mml:mo>,</mml:mo>
                    <mml:mn>3</mml:mn>
                    <mml:mo>,</mml:mo>
                    <mml:mi mathvariant="normal">and</mml:mi>
                    <mml:mspace width="0.25em"/>
                    <mml:msub>
                      <mml:mi mathvariant="italic">ξ</mml:mi>
                      <mml:mn>1</mml:mn>
                    </mml:msub>
                    <mml:mo>=</mml:mo>
                    <mml:msub>
                      <mml:mi mathvariant="italic">ξ</mml:mi>
                      <mml:mn>3</mml:mn>
                    </mml:msub>
                    <mml:mo>=</mml:mo>
                    <mml:msqrt>
                      <mml:mrow>
                        <mml:mn>2</mml:mn>
                        <mml:msub>
                          <mml:mi mathvariant="italic">ξ</mml:mi>
                          <mml:mn>2</mml:mn>
                        </mml:msub>
                      </mml:mrow>
                    </mml:msqrt>
                    <mml:mo>.</mml:mo>
                  </mml:mtd>
                </mml:mtr>
              </mml:mtable>
            </mml:math>
          </disp-formula>
        </p>
        <p>The error term for the heterozygous AB cluster was set smaller than those of the homozygous clusters in order to adjust for the difference in the spreads of the heterozygous and homozygous observations (Figure <xref ref-type="fig" rid="F1">1</xref>). The adjustment factor could be obtained empirically from the sample data described in Section Genotyping the samples without CNAs by BCRgt. Here we use <inline-formula><inline-graphic xlink:href="1471-2105-15-74-i4.gif"/></inline-formula> for convenience.</p>
        <p>For demonstration purposes, we applied BCRgt to a good-quality SNP with no missing genotypes and presented the results in Figure <xref ref-type="fig" rid="F2">2</xref>. The effect of the priors can be seen from two observations with BB genotype (circles). The prediction line would go through both dots if no prior were imposed. With BCRgt, the slope for BB genotype is very close to 1 (45 degree line). This example shows how the prior information on slope works. And we expect that the true slope for BB genotype would be approximately 1 if more samples were observed. In addition, the heterozygous cluster (solid squares) has less spread than the cluster representing AA genotype (symbol “*”), which concurs with the pattern in Figure <xref ref-type="fig" rid="F1">1</xref>. We also demonstrated in Additional file <xref ref-type="supplementary-material" rid="S1">1</xref>: Figure S1 that BCRgt performed well if one or two genotypes were missing.</p>
        <fig id="F2" position="float">
          <label>Figure 2</label>
          <caption>
            <p><bold>An example of applying BCRgt to genotype calling on one SNP.</bold> Three clusters represent three genotypes (AA, AB and BB are represented by star “*”, solid square and circle, respectively). The bold black line is the 45 degree line, and the three dotted lines are the prediction lines for three clusters separately.</p>
          </caption>
          <graphic xlink:href="1471-2105-15-74-2"/>
        </fig>
      </sec>
    </sec>
    <sec>
      <title>Incorporating the CNA variable into the model</title>
      <p>Comparing with the commonly used genotyping methods (cluster-based models), BCRgt has the advantage of conveniently adding extra covariates in the model. Next, we will explain how to utilize this advantage in incorporating copy number information in BCRgt. The reason for adding this information is given in Section Background.</p>
      <p>Once the CNA calls are obtained, we include CNA as a covariate in the regression, and the maximization step will be to find the maximum likelihood estimators for the following new regression model. The main rationales behind this model are that the relationship between the log-intensities of A, B alleles within a cluster (genotype) is approximately linear (see the left panel of Figure <xref ref-type="fig" rid="F1">1</xref>), and that any allele gain/loss will move the corresponding observation vertically.</p>
      <p>
        <disp-formula>
          <mml:math id="M4" name="1471-2105-15-74-i5" overflow="scroll">
            <mml:mtable columnalign="left">
              <mml:mtr>
                <mml:mtd>
                  <mml:msub>
                    <mml:mi mathvariant="italic">y</mml:mi>
                    <mml:mrow>
                      <mml:msub>
                        <mml:mi mathvariant="italic">C</mml:mi>
                        <mml:mi mathvariant="italic">i</mml:mi>
                      </mml:msub>
                      <mml:mo>=</mml:mo>
                      <mml:mi mathvariant="italic">k</mml:mi>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mo>=</mml:mo>
                  <mml:msub>
                    <mml:mi mathvariant="italic">β</mml:mi>
                    <mml:mrow>
                      <mml:mi mathvariant="italic">k</mml:mi>
                      <mml:mn>0</mml:mn>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mo>+</mml:mo>
                  <mml:msub>
                    <mml:mi mathvariant="italic">x</mml:mi>
                    <mml:mrow>
                      <mml:msub>
                        <mml:mi mathvariant="italic">C</mml:mi>
                        <mml:mi mathvariant="italic">i</mml:mi>
                      </mml:msub>
                      <mml:mo>=</mml:mo>
                      <mml:mi mathvariant="italic">k</mml:mi>
                    </mml:mrow>
                  </mml:msub>
                  <mml:msub>
                    <mml:mi mathvariant="italic">β</mml:mi>
                    <mml:mrow>
                      <mml:mi mathvariant="italic">k</mml:mi>
                      <mml:mn>1</mml:mn>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mo>+</mml:mo>
                  <mml:mi mathvariant="italic">C</mml:mi>
                  <mml:msub>
                    <mml:mi mathvariant="italic">N</mml:mi>
                    <mml:mrow>
                      <mml:msub>
                        <mml:mi mathvariant="italic">C</mml:mi>
                        <mml:mi mathvariant="italic">i</mml:mi>
                      </mml:msub>
                      <mml:mo>=</mml:mo>
                      <mml:mi mathvariant="italic">k</mml:mi>
                    </mml:mrow>
                  </mml:msub>
                  <mml:msub>
                    <mml:mi mathvariant="italic">β</mml:mi>
                    <mml:msub>
                      <mml:mi mathvariant="italic">k</mml:mi>
                      <mml:mi mathvariant="italic">CN</mml:mi>
                    </mml:msub>
                  </mml:msub>
                  <mml:mo>+</mml:mo>
                  <mml:msub>
                    <mml:mi mathvariant="italic">ξ</mml:mi>
                    <mml:mi mathvariant="italic">k</mml:mi>
                  </mml:msub>
                  <mml:mo>,</mml:mo>
                </mml:mtd>
              </mml:mtr>
              <mml:mtr>
                <mml:mtd>
                  <mml:mi mathvariant="normal">where</mml:mi>
                  <mml:mspace width="0.25em"/>
                  <mml:mi mathvariant="italic">k</mml:mi>
                  <mml:mo>=</mml:mo>
                  <mml:mn>1</mml:mn>
                  <mml:mo>,</mml:mo>
                  <mml:mn>2</mml:mn>
                  <mml:mo>,</mml:mo>
                  <mml:mn>3</mml:mn>
                  <mml:mo>,</mml:mo>
                  <mml:mi mathvariant="normal">and</mml:mi>
                  <mml:mspace width="0.25em"/>
                  <mml:mi mathvariant="italic">CN</mml:mi>
                  <mml:mspace width="0.25em"/>
                  <mml:mi mathvariant="normal">is</mml:mi>
                  <mml:mspace width="0.25em"/>
                  <mml:mi mathvariant="normal">defined</mml:mi>
                  <mml:mspace width="0.25em"/>
                  <mml:mi mathvariant="normal">as</mml:mi>
                </mml:mtd>
              </mml:mtr>
              <mml:mtr>
                <mml:mtd>
                  <mml:mtable columnalign="left">
                    <mml:mtr>
                      <mml:mtd>
                        <mml:mi mathvariant="italic">CN</mml:mi>
                        <mml:mo>=</mml:mo>
                        <mml:mspace width="0.5em"/>
                        <mml:mn>0</mml:mn>
                        <mml:mo>,</mml:mo>
                      </mml:mtd>
                      <mml:mtd>
                        <mml:mi mathvariant="normal">if</mml:mi>
                        <mml:mspace width="0.25em"/>
                        <mml:mi mathvariant="normal">no</mml:mi>
                        <mml:mspace width="0.25em"/>
                        <mml:mi mathvariant="normal">copy</mml:mi>
                        <mml:mspace width="0.25em"/>
                        <mml:mi mathvariant="normal">number</mml:mi>
                        <mml:mspace width="0.25em"/>
                        <mml:mi mathvariant="normal">change</mml:mi>
                        <mml:mo>,</mml:mo>
                      </mml:mtd>
                    </mml:mtr>
                    <mml:mtr>
                      <mml:mtd>
                        <mml:mi mathvariant="italic">CN</mml:mi>
                        <mml:mo>=</mml:mo>
                        <mml:mo>‒</mml:mo>
                        <mml:mi mathvariant="normal">constant</mml:mi>
                        <mml:mo>,</mml:mo>
                      </mml:mtd>
                      <mml:mtd>
                        <mml:mi mathvariant="normal">if</mml:mi>
                        <mml:mspace width="0.25em"/>
                        <mml:mi mathvariant="normal">A</mml:mi>
                        <mml:mspace width="0.25em"/>
                        <mml:mi mathvariant="normal">allele</mml:mi>
                        <mml:mspace width="0.25em"/>
                        <mml:mi mathvariant="normal">loss</mml:mi>
                        <mml:mo>,</mml:mo>
                      </mml:mtd>
                    </mml:mtr>
                    <mml:mtr>
                      <mml:mtd>
                        <mml:mi mathvariant="italic">CN</mml:mi>
                        <mml:mo>=</mml:mo>
                        <mml:mspace width="0.75em"/>
                        <mml:mi mathvariant="normal">constant</mml:mi>
                        <mml:mo>,</mml:mo>
                      </mml:mtd>
                      <mml:mtd>
                        <mml:mi mathvariant="normal">if</mml:mi>
                        <mml:mspace width="0.25em"/>
                        <mml:mi mathvariant="normal">B</mml:mi>
                        <mml:mspace width="0.25em"/>
                        <mml:mi mathvariant="normal">allele</mml:mi>
                        <mml:mspace width="0.25em"/>
                        <mml:mi mathvariant="normal">loss</mml:mi>
                        <mml:mo>,</mml:mo>
                      </mml:mtd>
                    </mml:mtr>
                    <mml:mtr>
                      <mml:mtd>
                        <mml:mi mathvariant="italic">CN</mml:mi>
                        <mml:mo>=</mml:mo>
                        <mml:mo>‒</mml:mo>
                        <mml:mi mathvariant="normal">constant</mml:mi>
                        <mml:mo stretchy="true">/</mml:mo>
                        <mml:mn>5</mml:mn>
                        <mml:mo>,</mml:mo>
                      </mml:mtd>
                      <mml:mtd>
                        <mml:mi mathvariant="normal">if</mml:mi>
                        <mml:mspace width="0.25em"/>
                        <mml:mi mathvariant="normal">B</mml:mi>
                        <mml:mspace width="0.25em"/>
                        <mml:mi mathvariant="normal">allele</mml:mi>
                        <mml:mspace width="0.25em"/>
                        <mml:mi mathvariant="normal">gain</mml:mi>
                        <mml:mo>,</mml:mo>
                      </mml:mtd>
                    </mml:mtr>
                    <mml:mtr>
                      <mml:mtd>
                        <mml:mi mathvariant="italic">CN</mml:mi>
                        <mml:mo>=</mml:mo>
                        <mml:mspace width="0.75em"/>
                        <mml:mi mathvariant="normal">constant</mml:mi>
                        <mml:mo stretchy="true">/</mml:mo>
                        <mml:mn>5</mml:mn>
                        <mml:mo>,</mml:mo>
                      </mml:mtd>
                      <mml:mtd>
                        <mml:mi mathvariant="normal">if</mml:mi>
                        <mml:mspace width="0.25em"/>
                        <mml:mi mathvariant="normal">A</mml:mi>
                        <mml:mspace width="0.25em"/>
                        <mml:mi mathvariant="normal">allele</mml:mi>
                        <mml:mspace width="0.25em"/>
                        <mml:mi mathvariant="normal">gain</mml:mi>
                        <mml:mo>,</mml:mo>
                      </mml:mtd>
                    </mml:mtr>
                    <mml:mtr>
                      <mml:mtd>
                        <mml:mi mathvariant="normal">with</mml:mi>
                        <mml:msub>
                          <mml:mi mathvariant="italic">x</mml:mi>
                          <mml:mrow>
                            <mml:msub>
                              <mml:mi mathvariant="italic">C</mml:mi>
                              <mml:mi mathvariant="italic">i</mml:mi>
                            </mml:msub>
                            <mml:mo>=</mml:mo>
                            <mml:mi mathvariant="italic">k</mml:mi>
                          </mml:mrow>
                        </mml:msub>
                        <mml:mi mathvariant="normal">and</mml:mi>
                        <mml:msub>
                          <mml:mi mathvariant="normal">y</mml:mi>
                          <mml:mrow>
                            <mml:msub>
                              <mml:mi mathvariant="italic">C</mml:mi>
                              <mml:mi mathvariant="italic">i</mml:mi>
                            </mml:msub>
                            <mml:mo>=</mml:mo>
                            <mml:mi mathvariant="italic">k</mml:mi>
                          </mml:mrow>
                        </mml:msub>
                      </mml:mtd>
                      <mml:mtd>
                        <mml:mi mathvariant="normal">being</mml:mi>
                        <mml:mi mathvariant="normal">the</mml:mi>
                        <mml:mo>log</mml:mo>
                        <mml:mo>‒</mml:mo>
                        <mml:mi mathvariant="normal">intensities</mml:mi>
                        <mml:mspace width="0.25em"/>
                        <mml:mi mathvariant="normal">of</mml:mi>
                        <mml:mspace width="0.25em"/>
                        <mml:mi mathvariant="normal">A</mml:mi>
                      </mml:mtd>
                    </mml:mtr>
                    <mml:mtr>
                      <mml:mtd/>
                      <mml:mtd>
                        <mml:mi mathvariant="normal">and</mml:mi>
                        <mml:mspace width="0.25em"/>
                        <mml:mi mathvariant="normal">B</mml:mi>
                        <mml:mspace width="0.25em"/>
                        <mml:mi mathvariant="normal">alleles</mml:mi>
                        <mml:mo>,</mml:mo>
                        <mml:mi mathvariant="normal">respectively</mml:mi>
                        <mml:mo>.</mml:mo>
                      </mml:mtd>
                    </mml:mtr>
                  </mml:mtable>
                </mml:mtd>
              </mml:mtr>
            </mml:mtable>
          </mml:math>
        </disp-formula>
      </p>
      <p>Note that, for samples with copy number loss, if the log-intensity of A allele is greater than that of B allele, we define them as B allele loss; otherwise, we define them as A allele loss. A or B allele gain can be defined similarly for the samples with copy number gain. In EM algorithm, we treated <italic>CN</italic> as a fixed factor for computational simplification. Also, for copy number gain based on empirical evaluation, the input value for <italic>CN</italic> is five times smaller than that for copy number loss in order to adjust for 1) the saturation effect – the maximal signal intensity is limited by the amount of corresponding probes on the array, so that increases in copy number might not be proportionally reflected in signal intensity; and 2) the difference in absolute change in signal intensity between copy number gain and loss (see Additional file <xref ref-type="supplementary-material" rid="S1">1</xref>: Figure S2). In addition, we used the larger of the absolute values of the 2.5 and 97.5 percentiles of the differences of A and B allele log-intensities as the input value for “constant” in the above model. We comment that, because we choose a weak prior on <inline-formula><mml:math id="M5" name="1471-2105-15-74-i6" overflow="scroll"><mml:mrow><mml:msub><mml:mi mathvariant="italic">β</mml:mi><mml:msub><mml:mi mathvariant="italic">k</mml:mi><mml:mi mathvariant="italic">CN</mml:mi></mml:msub></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:math></inline-formula> these pre-set values do not significantly affect genotyping results unless they are completely out of range.</p>
    </sec>
  </sec>
  <sec>
    <title>Results and discussion</title>
    <sec>
      <title>Genotyping the samples without CNAs by BCRgt</title>
      <p>In order to evaluate the performance of our proposed method, a decent number of samples with known genotypes are needed. The International HapMap Consortium has made such samples available – the Phase 2 of HapMap data release provides reference calls for approximately 70% of the SNPs on the GeneChip® Human Mapping 500 K Array Set for a collection of 270 samples, and the Phase 3 release provides more reference calls. These calls were generated from the consent of results from various technologies and sources, and are generally considered as a gold standard, although it is reasonable to assume that the genotype calls in HapMap still have some rare errors.</p>
      <p>The Mapping 500 K Array data for all 270 HapMap samples were downloaded from the NCBI’s Gene Expression Omnibus website (Accession number: GSE5173). In the comparison, we focused on chromosome 1 to demonstrate the performance of BCRgt, but it is reasonable to assume that results from other autosomal chromosomes would be very similar.</p>
      <p>Genotype calls for over 93% of SNPs on chromosome 1 are available from the HapMap genotype data (July 2009 release, <ext-link ext-link-type="uri" xlink:href="http://www.HapMap.org">http://www.HapMap.org</ext-link>). Concordance rates, the percentage of agreement between HapMap calls and BCRgt calls, for different datasets are presented in Table <xref ref-type="table" rid="T1">1</xref>. There are two sections in this table. The upper section (datasets from A to G) displays genotyping concordance rates using the BCRgt without any model training, that is, we used generic prior distributions for every SNP. Note that in this upper section we genotyped different numbers of samples (270 samples for A; 50 for B, C, D; and 30 for E, F, G) in order to evaluate the effect of sample size on concordance rate. Also, for datasets A to D, H, each dataset has two rows corresponding to two different call rates. The lower section (datasets from H to O) displays the concordance rates using BCRgt with a model training step. We randomly split the whole HapMap 270 samples into two groups of equal size (135 each), and used one group as the training set to obtain parameter estimates (including intercepts and slopes) of the prior distributions for each SNP. Then we employed these prior distributions in BCRgt, and performed genotyping on different subsets of samples (with size 135, 50, 30 and 20) randomly selected from the other group. We expected that, by including the training step, much higher concordance rates with HapMap genotype calls can be achieved.</p>
      <table-wrap position="float" id="T1">
        <label>Table 1</label>
        <caption>
          <p>Call rates and concordance rates for various datasets of different sizes (values are in percentages)</p>
        </caption>
        <table frame="hsides" rules="groups" border="1">
          <colgroup>
            <col align="center"/>
            <col align="center"/>
            <col align="center"/>
            <col align="center"/>
            <col align="center"/>
            <col align="center"/>
            <col align="center"/>
            <col align="center"/>
          </colgroup>
          <thead valign="top">
            <tr>
              <th align="center" valign="middle">
                <bold>DataSet</bold>
              </th>
              <th align="center" valign="middle">
                <bold># of Samples</bold>
              </th>
              <th align="center" valign="middle">
                <bold>Overall call rate</bold>
              </th>
              <th align="center" valign="middle">
                <bold>Homo call rate</bold>
              </th>
              <th align="center" valign="middle">
                <bold>Hetero call rate</bold>
              </th>
              <th align="center" valign="middle">
                <bold>Overall concord rate</bold>
              </th>
              <th align="center" valign="middle">
                <bold>Homo concord rate</bold>
              </th>
              <th align="center" valign="middle">
                <bold>Hetero concord rate</bold>
              </th>
            </tr>
          </thead>
          <tbody valign="top">
            <tr>
              <td align="center" valign="bottom">A<hr/></td>
              <td align="center" valign="bottom">270<hr/></td>
              <td align="center" valign="bottom">
                <bold>99.56</bold>
                <hr/>
              </td>
              <td align="center" valign="bottom">99.80<hr/></td>
              <td align="center" valign="bottom">98.97<hr/></td>
              <td align="center" valign="bottom">
                <bold>99.59</bold>
                <hr/>
              </td>
              <td align="center" valign="bottom">99.58<hr/></td>
              <td align="center" valign="bottom">99.63<hr/></td>
            </tr>
            <tr>
              <td align="center" valign="bottom">A<hr/></td>
              <td align="center" valign="bottom">270<hr/></td>
              <td align="center" valign="bottom">
                <bold>100.0</bold>
                <hr/>
              </td>
              <td align="center" valign="bottom">100.0<hr/></td>
              <td align="center" valign="bottom">100.0<hr/></td>
              <td align="center" valign="bottom">
                <bold>99.50</bold>
                <hr/>
              </td>
              <td align="center" valign="bottom">99.51<hr/></td>
              <td align="center" valign="bottom">99.46<hr/></td>
            </tr>
            <tr>
              <td align="center" valign="bottom">B<hr/></td>
              <td align="center" valign="bottom">50<hr/></td>
              <td align="center" valign="bottom">
                <bold>99.56</bold>
                <hr/>
              </td>
              <td align="center" valign="bottom">99.82<hr/></td>
              <td align="center" valign="bottom">98.82<hr/></td>
              <td align="center" valign="bottom">
                <bold>99.58</bold>
                <hr/>
              </td>
              <td align="center" valign="bottom">99.58<hr/></td>
              <td align="center" valign="bottom">99.57<hr/></td>
            </tr>
            <tr>
              <td align="center" valign="bottom">B<hr/></td>
              <td align="center" valign="bottom">50<hr/></td>
              <td align="center" valign="bottom">
                <bold>100.0</bold>
                <hr/>
              </td>
              <td align="center" valign="bottom">100.0<hr/></td>
              <td align="center" valign="bottom">100.0<hr/></td>
              <td align="center" valign="bottom">
                <bold>99.47</bold>
                <hr/>
              </td>
              <td align="center" valign="bottom">99.52<hr/></td>
              <td align="center" valign="bottom">99.35<hr/></td>
            </tr>
            <tr>
              <td align="center" valign="bottom">C<hr/></td>
              <td align="center" valign="bottom">50<hr/></td>
              <td align="center" valign="bottom">
                <bold>99.73</bold>
                <hr/>
              </td>
              <td align="center" valign="bottom">99.90<hr/></td>
              <td align="center" valign="bottom">99.49<hr/></td>
              <td align="center" valign="bottom">
                <bold>99.58</bold>
                <hr/>
              </td>
              <td align="center" valign="bottom">99.61<hr/></td>
              <td align="center" valign="bottom">99.27<hr/></td>
            </tr>
            <tr>
              <td align="center" valign="bottom">C<hr/></td>
              <td align="center" valign="bottom">50<hr/></td>
              <td align="center" valign="bottom">
                <bold>100.0</bold>
                <hr/>
              </td>
              <td align="center" valign="bottom">100.0<hr/></td>
              <td align="center" valign="bottom">100.0<hr/></td>
              <td align="center" valign="bottom">
                <bold>99.52</bold>
                <hr/>
              </td>
              <td align="center" valign="bottom">99.58<hr/></td>
              <td align="center" valign="bottom">99.35<hr/></td>
            </tr>
            <tr>
              <td align="center" valign="bottom">D<hr/></td>
              <td align="center" valign="bottom">50<hr/></td>
              <td align="center" valign="bottom">
                <bold>99.53</bold>
                <hr/>
              </td>
              <td align="center" valign="bottom">99.79<hr/></td>
              <td align="center" valign="bottom">98.89<hr/></td>
              <td align="center" valign="bottom">
                <bold>99.44</bold>
                <hr/>
              </td>
              <td align="center" valign="bottom">99.41<hr/></td>
              <td align="center" valign="bottom">99.51<hr/></td>
            </tr>
            <tr>
              <td align="center" valign="bottom">D<hr/></td>
              <td align="center" valign="bottom">50<hr/></td>
              <td align="center" valign="bottom">
                <bold>100.0</bold>
                <hr/>
              </td>
              <td align="center" valign="bottom">100.0<hr/></td>
              <td align="center" valign="bottom">100.0<hr/></td>
              <td align="center" valign="bottom">
                <bold>99.33</bold>
                <hr/>
              </td>
              <td align="center" valign="bottom">99.34<hr/></td>
              <td align="center" valign="bottom">99.31<hr/></td>
            </tr>
            <tr>
              <td align="center" valign="bottom">E<hr/></td>
              <td align="center" valign="bottom">30<hr/></td>
              <td align="center" valign="bottom">
                <bold>99.61</bold>
                <hr/>
              </td>
              <td align="center" valign="bottom">99.84<hr/></td>
              <td align="center" valign="bottom">98.92<hr/></td>
              <td align="center" valign="bottom">
                <bold>99.35</bold>
                <hr/>
              </td>
              <td align="center" valign="bottom">99.43<hr/></td>
              <td align="center" valign="bottom">99.13<hr/></td>
            </tr>
            <tr>
              <td align="center" valign="bottom">F<hr/></td>
              <td align="center" valign="bottom">30<hr/></td>
              <td align="center" valign="bottom">
                <bold>99.71</bold>
                <hr/>
              </td>
              <td align="center" valign="bottom">99.89<hr/></td>
              <td align="center" valign="bottom">99.24<hr/></td>
              <td align="center" valign="bottom">
                <bold>99.43</bold>
                <hr/>
              </td>
              <td align="center" valign="bottom">99.21<hr/></td>
              <td align="center" valign="bottom">99.51<hr/></td>
            </tr>
            <tr>
              <td align="center" valign="bottom">G<hr/></td>
              <td align="center" valign="bottom">30<hr/></td>
              <td align="center" valign="bottom">
                <bold>99.56</bold>
                <hr/>
              </td>
              <td align="center" valign="bottom">99.79<hr/></td>
              <td align="center" valign="bottom">98.92<hr/></td>
              <td align="center" valign="bottom">
                <bold>99.25</bold>
                <hr/>
              </td>
              <td align="center" valign="bottom">99.29<hr/></td>
              <td align="center" valign="bottom">99.13<hr/></td>
            </tr>
            <tr>
              <td align="center" valign="bottom">H<hr/></td>
              <td align="center" valign="bottom">135<hr/></td>
              <td align="center" valign="bottom">
                <bold>99.51</bold>
                <hr/>
              </td>
              <td align="center" valign="bottom">99.76<hr/></td>
              <td align="center" valign="bottom">98.94<hr/></td>
              <td align="center" valign="bottom">
                <bold>99.77</bold>
                <hr/>
              </td>
              <td align="center" valign="bottom">99.83<hr/></td>
              <td align="center" valign="bottom">99.61<hr/></td>
            </tr>
            <tr>
              <td align="center" valign="bottom">H<hr/></td>
              <td align="center" valign="bottom">135<hr/></td>
              <td align="center" valign="bottom">
                <bold>100.0</bold>
                <hr/>
              </td>
              <td align="center" valign="bottom">100.0<hr/></td>
              <td align="center" valign="bottom">100.0<hr/></td>
              <td align="center" valign="bottom">
                <bold>99.70</bold>
                <hr/>
              </td>
              <td align="center" valign="bottom">99.77<hr/></td>
              <td align="center" valign="bottom">99.52<hr/></td>
            </tr>
            <tr>
              <td align="center" valign="bottom">I<hr/></td>
              <td align="center" valign="bottom">50<hr/></td>
              <td align="center" valign="bottom">
                <bold>100.0</bold>
                <hr/>
              </td>
              <td align="center" valign="bottom">100.0<hr/></td>
              <td align="center" valign="bottom">100.0<hr/></td>
              <td align="center" valign="bottom">
                <bold>99.65</bold>
                <hr/>
              </td>
              <td align="center" valign="bottom">99.71<hr/></td>
              <td align="center" valign="bottom">99.51<hr/></td>
            </tr>
            <tr>
              <td align="center" valign="bottom">J<hr/></td>
              <td align="center" valign="bottom">50<hr/></td>
              <td align="center" valign="bottom">
                <bold>100.0</bold>
                <hr/>
              </td>
              <td align="center" valign="bottom">100.0<hr/></td>
              <td align="center" valign="bottom">100.0<hr/></td>
              <td align="center" valign="bottom">
                <bold>99.61</bold>
                <hr/>
              </td>
              <td align="center" valign="bottom">99.68<hr/></td>
              <td align="center" valign="bottom">99.43<hr/></td>
            </tr>
            <tr>
              <td align="center" valign="bottom">K<hr/></td>
              <td align="center" valign="bottom">50<hr/></td>
              <td align="center" valign="bottom">
                <bold>100.0</bold>
                <hr/>
              </td>
              <td align="center" valign="bottom">100.0<hr/></td>
              <td align="center" valign="bottom">100.0<hr/></td>
              <td align="center" valign="bottom">
                <bold>99.76</bold>
                <hr/>
              </td>
              <td align="center" valign="bottom">99.82<hr/></td>
              <td align="center" valign="bottom">99.61<hr/></td>
            </tr>
            <tr>
              <td align="center" valign="bottom">L<hr/></td>
              <td align="center" valign="bottom">30<hr/></td>
              <td align="center" valign="bottom">
                <bold>100.0</bold>
                <hr/>
              </td>
              <td align="center" valign="bottom">100.0<hr/></td>
              <td align="center" valign="bottom">100.0<hr/></td>
              <td align="center" valign="bottom">
                <bold>99.65</bold>
                <hr/>
              </td>
              <td align="center" valign="bottom">99.71<hr/></td>
              <td align="center" valign="bottom">99.50<hr/></td>
            </tr>
            <tr>
              <td align="center" valign="bottom">M<hr/></td>
              <td align="center" valign="bottom">30<hr/></td>
              <td align="center" valign="bottom">
                <bold>100.0</bold>
                <hr/>
              </td>
              <td align="center" valign="bottom">100.0<hr/></td>
              <td align="center" valign="bottom">100.0<hr/></td>
              <td align="center" valign="bottom">
                <bold>99.64</bold>
                <hr/>
              </td>
              <td align="center" valign="bottom">99.66<hr/></td>
              <td align="center" valign="bottom">99.60<hr/></td>
            </tr>
            <tr>
              <td align="center" valign="bottom">N<hr/></td>
              <td align="center" valign="bottom">30<hr/></td>
              <td align="center" valign="bottom">
                <bold>100.0</bold>
                <hr/>
              </td>
              <td align="center" valign="bottom">100.0<hr/></td>
              <td align="center" valign="bottom">100.0<hr/></td>
              <td align="center" valign="bottom">
                <bold>99.56</bold>
                <hr/>
              </td>
              <td align="center" valign="bottom">99.61<hr/></td>
              <td align="center" valign="bottom">99.41<hr/></td>
            </tr>
            <tr>
              <td align="center">O</td>
              <td align="center">20</td>
              <td align="center">
                <bold>100.0</bold>
              </td>
              <td align="center">100.0</td>
              <td align="center">100.0</td>
              <td align="center">
                <bold>99.49</bold>
              </td>
              <td align="center">99.50</td>
              <td align="center">99.44</td>
            </tr>
          </tbody>
        </table>
      </table-wrap>
      <p>For dataset A, the overall concordance rates between HapMap and BCRgt genotypes are 99.59% and 99.50% with overall calling rates at 99.56% and 100%, respectively. We can see that the lower call rate is associated with a higher concordance rate because SNPs that are difficult to call were treated as NoCall, and this reduced the probability of making an error. For datasets B, C and D, each having 50 samples randomly selected from the HapMap samples, the average overall concordance rates are 99.53% and 99.44% with average calling rates at 99.60% and 100%, respectively. With further reduced size of 30, datasets E, F and G have the average overall concordance rate of above 99.34% with an average overall call rate of 99.63%. We observed that the concordance rate declines as the dataset becomes smaller. Note that this is an empirical conclusion from several estimations. It would be interesting to rigorously assess the statistical relationship between sample size and concordance rate in the future study.</p>
      <p>The percentages in the lower section of Table <xref ref-type="table" rid="T1">1</xref> indicate that adding the training step can greatly improve genotyping accuracy. For example, the overall concordance rates (dataset H) reach 99.70% and 99.77% with overall call rates at 100% and 99.51%, respectively. For a further reduced sample size of 20, we could still have an overall concordance rate at about 99.5% (dataset O). In Table <xref ref-type="table" rid="T1">1</xref>, we also list concordance rates for homozygous and heterozygous calls separately, which are generally close to the overall concordance rates.</p>
      <p>We could not provide the concordance rate for dataset of size greater than 270 due to the sample size limitation in the HapMap database. Interested users are encouraged to apply the strategy described in [<xref ref-type="bibr" rid="B25">25</xref>] for genotyping larger datasets.</p>
      <p>Our training step is different from the commonly used approach in that the latter would use the whole set of the 270 samples from one laboratory to train the model, and then perform genotyping on another independent dataset from a different laboratory (the same 270 samples). We comment that, although not taking advantage of the whole HapMap samples in the training step, our method can avoid the possibility of inflating the measures of performance because it does not use the same biological samples in both the training and validating sets. Note that if the objective is to genotype samples other than those participated in the HapMap study, we will use all the 270 samples as the training set.</p>
    </sec>
    <sec>
      <title>Genotyping samples with CNAs by BCRgt</title>
      <p>Genotyping samples with CNAs is more challenging, and the validation of genotypes for such samples is currently difficult due to the lack of a gold standard such as the HapMap genotype data. Therefore, in this subsection, we will provide some individual SNP level as well as individual sample level examples to illustrate how BCRgt performs. The comparisons, regarding heterozygous call rate and genotyping error rate, between genotype calls made by BCRgt and BRLMM, will be presented at the end of this subsection.</p>
      <p>The data, downloaded from GEO (access#: GSE21349), were generated for the study of myeloma, a disease associated with CNAs [<xref ref-type="bibr" rid="B26">26</xref>]. There are 80 paired myeloma samples in the dataset. The rationales of using these samples include the known existence of CNAs in the tumor samples and the availability of the paired normal samples from the same patients. We comment that BCRgt does not require paired normal samples in genotype calling, but it could achieve higher accuracy in genotyping from improved copy number assignment if paired normal samples are available (details not discussed here). The genotype calls for the paired normal samples were used to evaluate the performance of the genotype calls for the tumor samples. Note that, since tumor samples can have normal cell contamination, we excluded samples with choppy noises or poor quality, as well as those having less than 1% CNAs, in order to obtain reliable genotype calls. Thus, only 66 samples were genotyped by BCRgt.</p>
      <p>As indicated by the three clusters in Figure <xref ref-type="fig" rid="F2">2</xref>, if there are no CNAs, samples with the same genotype, AA or AB or BB, tend to cluster together in the scattered plot of A versus B allele log-intensities. This is not the case if there are CNAs in some tumor samples. Figure <xref ref-type="fig" rid="F3">3</xref>(c) shows that it is difficult to call the observations pointed by the black and red arrows without knowing the copy number status. Note that BRLMM has no call on the observation pointed by the black arrow, and a call of AB for the observation pointed by the red arrow (Figure <xref ref-type="fig" rid="F3">3</xref>(d)). This is not consistent with the copy number status because the copy number call plot (Figure <xref ref-type="fig" rid="F3">3</xref>(b)) implies that both tumor samples have copy number loss at this SNP locus, and thus, they cannot be heterozygous. As a comparison, BCRgt is able to call both correctly as AA/A (Figure <xref ref-type="fig" rid="F3">3</xref>(c)). Since paired normal samples are available, we can use the genotypes of them as references (Figure <xref ref-type="fig" rid="F3">3</xref>(a)), to assess how copy number change affects genotype callings (see Additional file <xref ref-type="supplementary-material" rid="S1">1</xref>: Figure S3 explanation of how the intensities of two observations drop because of the copy number loss). Furthermore, we can see that among the three BB observations (colored in red, Figure <xref ref-type="fig" rid="F3">3</xref>(c)), one does not have copy number loss, while the other two do. The prediction line (the bottom gray line, Figure <xref ref-type="fig" rid="F3">3</xref>(c)) provides a good fit even though there are only three observations with the BB genotype.</p>
      <fig id="F3" position="float">
        <label>Figure 3</label>
        <caption>
          <p><bold>An example of applying gtBCR on samples with CNAs. (a)</bold> A and B allele log-intensity plot with samples colored by the genotypes of their paired normal samples: blue, green and red representing “AA”, “AB” and “BB” genotype, respectively. <bold>(b)</bold> The copy number status plot for each sample: red squares represent samples with copy number loss, green squares represent samples with copy number gain, and gray squares are samples without CNAs. <bold>(c)</bold> Genotypes called by BCRgt, with colors being the same as (a). Both the black and red arrows point to the observations that have “AB” genotype in the paired normal sample (see (a)) and have copy number loss (see (b)). They are both correctly called “AA” by BCRgt, which agrees with their copy number status. <bold>(d)</bold> Genotypes called by BRLMM: no call on the observation pointed by the black arrow, and “AB” call on the observation pointed by the red arrow, which is inconsistent to its copy number status.</p>
        </caption>
        <graphic xlink:href="1471-2105-15-74-3"/>
      </fig>
      <p>At the individual sample level, copy number status can be visualized on a scatter plot. We illustrate this with a sample that has multiple large segments of copy number losses (Figure <xref ref-type="fig" rid="F4">4</xref>). The copy number analysis suggested that chromosomes 1, 4, 6, 8, 10, 12–14, 16–18, 21 and 22 have copy number losses (see Additional file <xref ref-type="supplementary-material" rid="S1">1</xref>: Figure S4, or Figure <xref ref-type="fig" rid="F3">3</xref>(b) in [<xref ref-type="bibr" rid="B27">27</xref>]). Thus, we expect no heterozygous calls because only one copy of chromosome exists on those chromosomes. The genotype calls by BCRgt and BRLMM are presented in Figure <xref ref-type="fig" rid="F4">4</xref>. Figure <xref ref-type="fig" rid="F4">4</xref>(a) and (c) are SNPs with AB genotypes called by BCRgt and BRLMM, respectively, while Figure <xref ref-type="fig" rid="F4">4</xref>b) and (d) are SNPs with either AA or BB genotypes called by BCRgt and BRLMM separately. It is clear that on chromosomes with copy number loss, BCRgt called much less AB genotypes than BRLMM did. Note that some regions of chromosomes 11 and 18 are minor clone (the smaller population of a sample of heterogeneous tumor cells) copy number losses, but BCRgt still performs better than BRLMM on these regions. There are on average more than 4% heterozygous genotypes called by BRLMM, comparing to only 0.23% by BCRgt (Table <xref ref-type="table" rid="T2">2</xref>) for SNPs in regions with copy number loss. We also calculated the genotyping error rates for SNPs in CNA and normal two-copy regions separately. A genotyping error occurs if the paired normal sample has AA/BB, but the tumor has AB call, or, very uncommonly, the tumor and paired normal samples have different homozygous calls. Here, we assume that the calls for the paired normal samples are highly accurate. From Table <xref ref-type="table" rid="T2">2</xref>, we observe that in the CNA regions, the calling error rate by BRLMM is much higher (&gt; 10 folds) than that by BCRgt, while these rates are similar in regions without CNAs. In addition, for the tumor samples with higher normal cell contamination, BRLMM generally has a much worse performance in that the proportion of AB genotypes in copy number loss regions can be as high as 13%, while the proportion by BCRgt is only around 1.5% in the same regions (see the example in Additional file <xref ref-type="supplementary-material" rid="S1">1</xref>: Figure S5).</p>
      <fig id="F4" position="float">
        <label>Figure 4</label>
        <caption>
          <p><bold>Comparison of genotyping results generated by BCRgt, BRLMM and BCRgt with correct and incorrect copy number data.</bold> Correct copy number data were used for <bold>(a)-(d)</bold>, and incorrect copy number data (we intentionally call copy number loss regions as normal regions) were used for <bold>(e)</bold> and <bold>(f). (a)</bold> SNPs with “AB” genotype called by BCRgt on a sample with multiple copy number losses on chromosomes 1, 4, 6, 8, 10, 12–14, 16–18, 21 and 22. <bold>(b)</bold> SNPs called “AA”/“BB” by BCRgt. <bold>(c)</bold> SNPs called “AB” by BRLMM. <bold>(d)</bold> SNPs called “AA”/“BB” by BRLMM. (e) SNPs with “AB” genotype called by BCRgt, but we intentionally misclassified the CNA status. <bold>(f)</bold> SNPs with “AA/BB” genotype called by BCRgt.</p>
        </caption>
        <graphic xlink:href="1471-2105-15-74-4"/>
      </fig>
      <table-wrap position="float" id="T2">
        <label>Table 2</label>
        <caption>
          <p>Percentages of heterozygous calls on chromosomes with copy number loss and genotyping errors (CN = copy number)</p>
        </caption>
        <table frame="hsides" rules="groups" border="1">
          <colgroup>
            <col align="center"/>
            <col align="center"/>
            <col align="center"/>
            <col align="center"/>
          </colgroup>
          <thead valign="top">
            <tr>
              <th align="center" valign="middle">
                <bold>Method</bold>
              </th>
              <th align="center" valign="middle">
                <bold>Heterozygous calls at CN loss region</bold>
              </th>
              <th align="center" valign="middle">
                <bold>Genotyping error at CN loss region</bold>
              </th>
              <th align="center" valign="middle">
                <bold>Genotyping error at CN normal region</bold>
              </th>
            </tr>
          </thead>
          <tbody valign="top">
            <tr>
              <td align="center" valign="bottom">BCRgt<hr/></td>
              <td align="center" valign="bottom">0.23%<hr/></td>
              <td align="center" valign="bottom">0.03%<hr/></td>
              <td align="center" valign="bottom">0.16%<hr/></td>
            </tr>
            <tr>
              <td align="center">BRLMM</td>
              <td align="center">4.11%</td>
              <td align="center">1.83%</td>
              <td align="center">0.28%</td>
            </tr>
          </tbody>
        </table>
      </table-wrap>
      <p>Misclassification of CNA status may be an issue in BCRgt because CNA status is an input covariate. However, with a retrospective check of the genotyping calls, we can recognize possible CNA global misclassification. In Figure <xref ref-type="fig" rid="F4">4</xref>(e), we intentionally misclassified the copy loss regions on chromosomes 1, 4, 6, 8, 10, 12–14, 16–18, 21 and 22 as normal, and thus the proportion of heterozygous SNPs substantially increased (in another example, Additional file <xref ref-type="supplementary-material" rid="S1">1</xref>: Figure S6, we considered the situation that the normal regions were intentionally misclassified as copy number loss regions). Based on our empirical study, we recommend that if this proportion is higher than 1%, we will examine the CNA detection algorithm. Note that this step is important not only for generating correct genotype calls, but also for examining the validity of the upstream copy number analysis. On the other hand, this type of overall misclassification is less likely if both tumor and paired normal samples are available because new statistical methods can handle this situation very well. In our recent paper on SNP array data normalization of paired samples [<xref ref-type="bibr" rid="B27">27</xref>], we showed that two-copy regions can be explicitly identified in the normalization process, and thus the major CNAs can be identified with very high accuracy. Note that some focal gains/losses may be missed or falsely detected. But, if true gains/losses are misidentified as normal copy number, BCRgt will perform similarly to other genotyping methods.</p>
      <p>In regions with copy number gain, the proportion of the heterozygous calls does not provide much information because the loss of heterozygosity (LOH) does not occur in these regions. However, again because genotyping calls for the paired normal samples are available, we can calculate and compare the concordances of genotyping calls from the tumor samples with those from the paired normal samples by BCRgt and BRLMM. The results are presented in Table <xref ref-type="table" rid="T3">3</xref>. Note that a SNP with at least one A allele and one B allele is termed as AB genotype, regardless of how many extra copies of A and/or B allele it actually has. Similarly, a homozygous SNP with at least two A alleles or two B alleles is termed as AA or BB. The overall concordance at the copy number gain regions is higher by BCRgt (99.56%) than that by BRLMM (99.14%). This reflects an approximately 1.8% increase in the concordance rate for heterozygous calls, and a slightly lower concordance (difference &lt; 0.1%) for homozygous calls. Both calling methods give much higher (about 1 - 2%) concordance rates for homozygous calls than for heterozygous calls. Theoretically, for SNPs with AB genotype, copy number gain should not cause LOH, and should not add heterozygosity for AA or BB alleles based on the definition of LOH. Therefore, we expect a (ideally) 100% concordance rate. However, due to the issues such as normal cell contamination, the existence of minor clone, and signal saturation effect, the concordance rate is much lower compared to that of repeated arrays with the same normal samples, which often has a concordance rate of around 99.9% [<xref ref-type="bibr" rid="B7">7</xref>]. The (about 1 - 2%) difference between concordance rates for homozygous calls and for heterozygous calls makes perfect sense because copy number gains for homozygous calls move the intensities of the homozygous SNPs away from the heterozygous SNPs in scattered plots, as shown in Figures <xref ref-type="fig" rid="F1">1</xref> and <xref ref-type="fig" rid="F2">2</xref>, and thus are unlikely to cause incorrect genotyping calls. On the other hand, copy number gains make heterozygous SNPs to move closer to homozygous SNPs, and consequently increase the possibility of incorrect genotyping calls.</p>
      <table-wrap position="float" id="T3">
        <label>Table 3</label>
        <caption>
          <p>Concordance rates at copy number gain and copy number normal regions</p>
        </caption>
        <table frame="hsides" rules="groups" border="1">
          <colgroup>
            <col align="center"/>
            <col align="center"/>
            <col align="center"/>
            <col align="center"/>
          </colgroup>
          <thead valign="top">
            <tr>
              <th align="center" valign="middle">
                <bold>Method</bold>
              </th>
              <th align="center" valign="middle">
                <bold>Overall concordance at CN gain region</bold>
              </th>
              <th align="center" valign="middle">
                <bold>Heterozygous call concordance at CN gain region</bold>
              </th>
              <th align="center" valign="middle">
                <bold>Homozygous call concordance at CN gain region</bold>
              </th>
            </tr>
          </thead>
          <tbody valign="top">
            <tr>
              <td align="center" valign="bottom">BCRgt<hr/></td>
              <td align="center" valign="bottom">99.56%<hr/></td>
              <td align="center" valign="bottom">98.76%<hr/></td>
              <td align="center" valign="bottom">99.80%<hr/></td>
            </tr>
            <tr>
              <td align="center">BRLMM</td>
              <td align="center">99.14%</td>
              <td align="center">96.95%</td>
              <td align="center">99.88%</td>
            </tr>
          </tbody>
        </table>
      </table-wrap>
      <p>To conclude this section, we comment that including more term(s), such as the percentage of normal cell contamination, in BCRgt may help improve the concordance rate. This will be investigated in our future research.</p>
    </sec>
  </sec>
  <sec sec-type="conclusions">
    <title>Conclusions</title>
    <p>Accurate genotyping is one of the key components for a successful GWAS study. Genotyping calls for samples without CNAs can achieve a 99.5% or higher accuracy [<xref ref-type="bibr" rid="B6">6</xref>]. However, it remains a challenge to genotype samples with CNAs, and the result of a well-designed GWAS study can be severely compromised if the genotyping calls have low accuracy. Therefore, it is appealing to develop methods that can achieve high genotyping accuracy for samples with CNAs. Note that there are many statistical methods for analyzing copy number abnormalities. Although most of those methods work well in detecting CNAs at individual sample level, methods for formally evaluating the effect of CNAs are largely lacking.</p>
    <p>Whether or not applying Hardy-Weinberg (HW; allele and genotype frequencies in a population will remain constant from generation to generation in the absence of other evolutionary influences) test in BCRgt should be considered case by case. For samples without CNAs, if the main assumptions of HW equilibrium are violated (for example, the violation of random mating assumption), the HW test should not be used to refine genotype calling, and a significant test result does not imply a problem in genotyping. Similarly, the HW test should not be applied when genotyping samples with CNAs because HW is not supposed to be valid for samples that are not diploid.</p>
    <p>We achieved fairly high calling accuracy for samples without CNAs when directly applying BCRgt to all 270 HapMap samples. Later, a training step was added to further improve the accuracy. We adopted a strategy similar to the cross-validation approach – half of the 270 samples were randomly selected and used to train the model, while the remaining half were used as the validation set to calculate the concordance rates with HapMap call. We comment that this strategy is unlikely to overestimate the concordance rate because we avoided using the same biological sample in both the training and validation sets. Note that there are other strategies that may work better. For example, we can train the data produced by one laboratory for a subset of the HapMap samples, and then apply the trained model to the data obtained from a different laboratory for the complementary subset of HapMap samples. By so doing, both biological samples and experimental variations are independent between the training and validation sets.</p>
    <p>BCRgt has substantial improvement over BRLMM for calling SNPs in copy number loss regions, and performs better in copy number gain regions. There is minimal difference between these two methods in calling SNPs in normal two copy regions.</p>
    <p>The core of BCRgt is a Bayesian linear regression, which allows the adjustment for CNAs in SNP calling. It is also feasible to incorporate additional information, such as the percentage of normal cell contamination, into the model for better genotype calling results. Moreover, incorporating genotypes of the paired normal samples into the model might further reduce genotyping error should those data be available.</p>
    <p>Depending on objectives, the output format of genotype calls for SNPs in the CNA regions can be flexible. For example, genotypes in the copy number loss regions can be outputted as 0/A/B, or 00/AA/BB, and similarly those in one copy gain regions can be outputted as AAA/AAB/ABB/BBB, or AA/AB/BB. We do not suggest assigning higher copy number calls to the genotypes in copy number gain regions due to several issues including: 1) normal cell contamination, 2) array signal saturation effect, 3) less robustness of more complex models, and 4) increased difficulty in result interpretation.</p>
    <p>Unlike the Affymetrix platform, Illumina arrays produce two measurement variables, log R Ratio and B Allele Frequency (BAF; a normalized measure of relative signal intensity of the B and A alleles). Statistical methods, based on either the Bayesian approach or HMM, have been proposed to utilize both variables simultaneously to perform the analysis. However, most of these methods, such as PennCNV [<xref ref-type="bibr" rid="B28">28</xref>], QuantiSNP [<xref ref-type="bibr" rid="B29">29</xref>] and OncoSNP [<xref ref-type="bibr" rid="B30">30</xref>], were designed mainly for detecting CNA/CNV, and are not applicable to make genotyping calls by default. GenoSNP [<xref ref-type="bibr" rid="B11">11</xref>], for an Illumina platform too, provided a very low homozygosity rate (about 90%) when used for genotyping deletion regions in the HapMap samples [<xref ref-type="bibr" rid="B28">28</xref>,<xref ref-type="bibr" rid="B31">31</xref>]. In addition, though PennCNV has a plug-in for calculating BAF for Affymetrix data, the QN component used in the process makes it unattractive for samples with CNAs (it has been shown that QN is not optimal for handling samples with CNAs).</p>
    <p>Most of the current genotyping methods assume bivariate normality on the joint distribution of A and B alleles for each genotype, which implicitly assumes that the marginal distribution of each allele is unimodal. This may not be true if CNAs exist because the marginal distribution may be bimodal. In contrast, BCRgt adopts a linear regression approach. Thus the assumption we need is that the residuals of each cluster follow a normal distribution, which is commonly made in regression analysis.</p>
    <p>Alhough accurate copy number calls are required by BCRgt, at each SNP, an incorrect copy number call for one sample does not affect genotyping calls for other samples even though this property will not hold if the majority of the copy number calls are incorrect. In sum, BCRgt requests that the extra information added to the regression model is of high quality, but this should not be a big concern if paired normal samples are available. If the paired normal samples are not available, how to obtain high quality information from quality array and cytogenetic data is worth a lot of discussion. This is out of the scope of this paper.</p>
    <sec>
      <title>Availability</title>
      <p>The R package “BCRgt” including documentation is available online. See the website, <ext-link ext-link-type="uri" xlink:href="http://publichealth.lsuhsc.edu/BCRgt.html">http://publichealth.lsuhsc.edu/BCRgt.html</ext-link> for details.</p>
    </sec>
  </sec>
  <sec>
    <title>Competing interests</title>
    <p>The authors declare that they have no competing interests.</p>
  </sec>
  <sec>
    <title>Authors’ contributions</title>
    <p>SY and ZF designed the experiments. SY did the data analysis. SY, ZF and XC wrote the paper. All authors read and approved the final manuscript.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material content-type="local-data" id="S1">
      <caption>
        <title>Additional file 1: Figure S1</title>
        <p>A brief derivation of the posterior distribution for β<sub>s.</sub><bold>S2</bold>. Cluster regression parameter estimation. <bold>Figure S1.</bold> An example of “BB” genotype missing (SNP #12). <bold>Figure S2.</bold> Illustration of the difference in absolute change in signal intensity between copy number gain and loss. <bold>Figure S3.</bold> Illustration of copy number loss caused signal intensity drop. <bold>Figure S4.</bold> Copy number status of the same sample presented in Figure <xref ref-type="fig" rid="F4">4</xref>. <bold>Figure S5.</bold> (1) An example of higher normal cell contamination. <bold>Figure S5.</bold> (2) The copy number status of the sample presented in <bold>Figure S5. </bold><bold>Figure S6.</bold> An example that the normal regions were intentionally misclassified as copy number loss regions.</p>
      </caption>
      <media xlink:href="1471-2105-15-74-S1.doc">
        <caption>
          <p>Click here for file</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <sec>
    <title>Acknowledgements</title>
    <p>We are grateful for the thorough review by two anonymous referees of a previous version of this paper, and for the helpful comments of these referees and the Associate Editor. We also thank Ms. Alice LeBlanc for her English editing of the paper.</p>
    <p>ZF’s research was supported by 1 U54 GM104940 from the National Institute of General Medical Sciences of the National Institutes of Health which funds the Louisiana Clinical and Translational Science Center of Pennington Biomedical Research Center.</p>
  </sec>
  <ref-list>
    <ref id="B1">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Lamy</surname>
          <given-names>P</given-names>
        </name>
        <name>
          <surname>Grove</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Wiuf</surname>
          <given-names>C</given-names>
        </name>
        <article-title>A review of software for microarray genotyping</article-title>
        <source>Hum Genomics</source>
        <year>2011</year>
        <volume>5</volume>
        <issue>4</issue>
        <fpage>304</fpage>
        <lpage>309</lpage>
        <?supplied-pmid 21712191?>
        <pub-id pub-id-type="pmid">21712191</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B2">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Rabbee</surname>
          <given-names>N</given-names>
        </name>
        <article-title>Speed TP A genotype calling algorithm for affymetrix SNP arrays</article-title>
        <source>Bioinformatics</source>
        <year>2006</year>
        <volume>22</volume>
        <issue>1</issue>
        <fpage>7</fpage>
        <lpage>12</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bti741</pub-id>
        <?supplied-pmid 16267090?>
        <pub-id pub-id-type="pmid">16267090</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B3">
      <mixed-citation publication-type="book">
        <collab>Affymetrix</collab>
        <source>BRLMM: An Improved Genotype Calling Method for the GeneChip Human Mapping 500K Array Set. Technical Report, White Paper</source>
        <year>2006</year>
        <publisher-name>Santa Clara, CA: Affymetrix, Inc</publisher-name>
      </mixed-citation>
    </ref>
    <ref id="B4">
      <mixed-citation publication-type="book">
        <collab>Affymetrix</collab>
        <source>BRLMM-P: A Genotype Calling Method for the SNP 5.0 Array. Technical Report, White Paper</source>
        <year>2007</year>
        <publisher-name>Santa Clara, CA: Affymetrix, Inc</publisher-name>
      </mixed-citation>
    </ref>
    <ref id="B5">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Korn</surname>
          <given-names>JM</given-names>
        </name>
        <name>
          <surname>Kuruvilla</surname>
          <given-names>FG</given-names>
        </name>
        <name>
          <surname>McCarroll</surname>
          <given-names>SA</given-names>
        </name>
        <name>
          <surname>Wysoker</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Nemesh</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Cawley</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Hubbell</surname>
          <given-names>E</given-names>
        </name>
        <name>
          <surname>Veitch</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Collins</surname>
          <given-names>PJ</given-names>
        </name>
        <name>
          <surname>Darvishi</surname>
          <given-names>K</given-names>
        </name>
        <name>
          <surname>Lee</surname>
          <given-names>C</given-names>
        </name>
        <name>
          <surname>Nizzari</surname>
          <given-names>MM</given-names>
        </name>
        <name>
          <surname>Gabriel</surname>
          <given-names>SB</given-names>
        </name>
        <name>
          <surname>Purcell</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Daly</surname>
          <given-names>MJ</given-names>
        </name>
        <name>
          <surname>Altshuler</surname>
          <given-names>D</given-names>
        </name>
        <article-title>Integrated genotype calling and association analysis of SNPs, common copy number polymorphisms and rare CNVs</article-title>
        <source>Nat Genet</source>
        <year>2008</year>
        <volume>40</volume>
        <issue>10</issue>
        <fpage>1253</fpage>
        <lpage>1260</lpage>
        <pub-id pub-id-type="doi">10.1038/ng.237</pub-id>
        <?supplied-pmid 18776909?>
        <pub-id pub-id-type="pmid">18776909</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B6">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Li</surname>
          <given-names>W</given-names>
        </name>
        <name>
          <surname>Lee</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Gregersen</surname>
          <given-names>PK</given-names>
        </name>
        <article-title>Copy number variation region detection by cumulative plots</article-title>
        <source>BMC Bioinforma</source>
        <year>2009</year>
        <volume>10</volume>
        <issue>suppl 1</issue>
        <fpage>S67</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-10-S1-S67</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B7">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Carvalho</surname>
          <given-names>B</given-names>
        </name>
        <name>
          <surname>Bengtsson</surname>
          <given-names>H</given-names>
        </name>
        <name>
          <surname>Speed</surname>
          <given-names>TP</given-names>
        </name>
        <name>
          <surname>Irizarry</surname>
          <given-names>RA</given-names>
        </name>
        <article-title>Exploration, normalization, and genotype calls of high-density oligonucleotide SNP array data</article-title>
        <source>Biostatistics</source>
        <year>2007</year>
        <volume>8</volume>
        <issue>2</issue>
        <fpage>485</fpage>
        <lpage>499</lpage>
        <pub-id pub-id-type="doi">10.1093/biostatistics/kxl042</pub-id>
        <?supplied-pmid 17189563?>
        <pub-id pub-id-type="pmid">17189563</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B8">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Hua</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Craig</surname>
          <given-names>DW</given-names>
        </name>
        <name>
          <surname>Brun</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Webster</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Zismann</surname>
          <given-names>V</given-names>
        </name>
        <name>
          <surname>Tembe</surname>
          <given-names>W</given-names>
        </name>
        <name>
          <surname>Joshipura</surname>
          <given-names>K</given-names>
        </name>
        <name>
          <surname>Huentelman</surname>
          <given-names>MJ</given-names>
        </name>
        <name>
          <surname>Dougherty</surname>
          <given-names>ER</given-names>
        </name>
        <name>
          <surname>Stephan</surname>
          <given-names>DA</given-names>
        </name>
        <article-title>SNiPer-HD: improved genotype calling accuracy by an expectation-maximization algorithm for high-density SNP arrays</article-title>
        <source>Bioinformatics</source>
        <year>2007</year>
        <volume>23</volume>
        <issue>1</issue>
        <fpage>57</fpage>
        <lpage>63</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btl536</pub-id>
        <?supplied-pmid 17062589?>
        <pub-id pub-id-type="pmid">17062589</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B9">
      <mixed-citation publication-type="journal">
        <collab>Wellcome Trust Case Control Consortium</collab>
        <article-title>Genome-wide association study of 14,000 cases of seven common diseases and 3,000 shared controls</article-title>
        <source>Nature</source>
        <year>2007</year>
        <volume>447</volume>
        <fpage>661</fpage>
        <lpage>678</lpage>
        <pub-id pub-id-type="doi">10.1038/nature05911</pub-id>
        <?supplied-pmid 17554300?>
        <pub-id pub-id-type="pmid">17554300</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B10">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Wright</surname>
          <given-names>MH</given-names>
        </name>
        <name>
          <surname>Tung</surname>
          <given-names>CW</given-names>
        </name>
        <name>
          <surname>Zhao</surname>
          <given-names>K</given-names>
        </name>
        <name>
          <surname>Reynolds</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>McCouch</surname>
          <given-names>SR</given-names>
        </name>
        <name>
          <surname>Bustamante</surname>
          <given-names>CD</given-names>
        </name>
        <article-title>ALCHEMY: a reliable method for automated SNP genotype calling for small batch sizes and highly homozygous populations</article-title>
        <source>Bioinformatics</source>
        <year>2010</year>
        <volume>26</volume>
        <issue>23</issue>
        <fpage>2952</fpage>
        <lpage>2960</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btq533</pub-id>
        <?supplied-pmid 20926420?>
        <pub-id pub-id-type="pmid">20926420</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B11">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Giannoulatou</surname>
          <given-names>E</given-names>
        </name>
        <name>
          <surname>Yau</surname>
          <given-names>C</given-names>
        </name>
        <name>
          <surname>Colella</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Ragoussis</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Holmes</surname>
          <given-names>CC</given-names>
        </name>
        <article-title>GenoSNP: a variational Bayes within-sample SNP genotyping algorithm that does not require a reference population</article-title>
        <source>Bioinformatics</source>
        <year>2008</year>
        <volume>24</volume>
        <issue>19</issue>
        <fpage>2209</fpage>
        <lpage>2214</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btn386</pub-id>
        <?supplied-pmid 18653518?>
        <pub-id pub-id-type="pmid">18653518</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B12">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Li</surname>
          <given-names>G</given-names>
        </name>
        <name>
          <surname>Gelernter</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Kranzler</surname>
          <given-names>HR</given-names>
        </name>
        <name>
          <surname>Zhao</surname>
          <given-names>H</given-names>
        </name>
        <article-title>M<sup>3</sup>: an improved SNP calling algorithm for Illumina BeadArray data</article-title>
        <source>Bioinformatics</source>
        <year>2012</year>
        <volume>28</volume>
        <issue>3</issue>
        <fpage>358</fpage>
        <lpage>365</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btr673</pub-id>
        <?supplied-pmid 22155947?>
        <pub-id pub-id-type="pmid">22155947</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B13">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Shah</surname>
          <given-names>TS</given-names>
        </name>
        <name>
          <surname>Liu</surname>
          <given-names>JZ</given-names>
        </name>
        <name>
          <surname>Floyd</surname>
          <given-names>JA</given-names>
        </name>
        <name>
          <surname>Morris</surname>
          <given-names>JA</given-names>
        </name>
        <name>
          <surname>Wirth</surname>
          <given-names>N</given-names>
        </name>
        <name>
          <surname>Barrett</surname>
          <given-names>JC</given-names>
        </name>
        <name>
          <surname>Anderson</surname>
          <given-names>CA</given-names>
        </name>
        <article-title>OptiCall: a robust genotype-calling algorithm for rare, low-frequency and common variants</article-title>
        <source>Bioinformatics</source>
        <year>2012</year>
        <volume>28</volume>
        <issue>12</issue>
        <fpage>1598</fpage>
        <lpage>1603</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bts180</pub-id>
        <?supplied-pmid 22500001?>
        <pub-id pub-id-type="pmid">22500001</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B14">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Sun</surname>
          <given-names>W</given-names>
        </name>
        <name>
          <surname>Wright</surname>
          <given-names>FA</given-names>
        </name>
        <name>
          <surname>Tang</surname>
          <given-names>Z</given-names>
        </name>
        <name>
          <surname>Nordgard</surname>
          <given-names>SH</given-names>
        </name>
        <name>
          <surname>Van Loo</surname>
          <given-names>P</given-names>
        </name>
        <name>
          <surname>Yu</surname>
          <given-names>T</given-names>
        </name>
        <name>
          <surname>Kristensen</surname>
          <given-names>VN</given-names>
        </name>
        <name>
          <surname>Perou</surname>
          <given-names>CM</given-names>
        </name>
        <article-title>Integrated study of copy number states and genotype calls using high density SNP arrays</article-title>
        <source>Nucleic Acids Res</source>
        <year>2009</year>
        <volume>37</volume>
        <issue>16</issue>
        <fpage>5365</fpage>
        <lpage>5377</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkp493</pub-id>
        <?supplied-pmid 19581427?>
        <pub-id pub-id-type="pmid">19581427</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B15">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Olshen</surname>
          <given-names>AB</given-names>
        </name>
        <name>
          <surname>Venkatraman</surname>
          <given-names>ES</given-names>
        </name>
        <name>
          <surname>Lucito</surname>
          <given-names>R</given-names>
        </name>
        <name>
          <surname>Wigler</surname>
          <given-names>M</given-names>
        </name>
        <article-title>Circular binary segmentation for the analysis of array-based DNA copy number data</article-title>
        <source>Biostatistics</source>
        <year>2004</year>
        <volume>5</volume>
        <issue>4</issue>
        <fpage>557</fpage>
        <lpage>572</lpage>
        <pub-id pub-id-type="doi">10.1093/biostatistics/kxh008</pub-id>
        <?supplied-pmid 15475419?>
        <pub-id pub-id-type="pmid">15475419</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B16">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Li</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Liu</surname>
          <given-names>Z</given-names>
        </name>
        <name>
          <surname>Lezon-Geyda</surname>
          <given-names>K</given-names>
        </name>
        <name>
          <surname>Sarkar</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Lannin</surname>
          <given-names>D</given-names>
        </name>
        <name>
          <surname>Schulz</surname>
          <given-names>V</given-names>
        </name>
        <name>
          <surname>Krop</surname>
          <given-names>I</given-names>
        </name>
        <name>
          <surname>Winer</surname>
          <given-names>E</given-names>
        </name>
        <name>
          <surname>Harris</surname>
          <given-names>L</given-names>
        </name>
        <name>
          <surname>Tuck</surname>
          <given-names>D</given-names>
        </name>
        <article-title>GPHMM: an integrated hidden Markov model for identification of copy number alteration and loss of heterozygosity in complex tumor samples using whole genome SNP arrays</article-title>
        <source>Nucleic Acids Res</source>
        <year>2010</year>
        <volume>39</volume>
        <issue>12</issue>
        <fpage>4928</fpage>
        <lpage>4941</lpage>
        <pub-id pub-id-type="pmid">21398628</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B17">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Van Loo</surname>
          <given-names>P</given-names>
        </name>
        <name>
          <surname>Nordgard</surname>
          <given-names>SH</given-names>
        </name>
        <name>
          <surname>Lingjærde</surname>
          <given-names>OC</given-names>
        </name>
        <name>
          <surname>Russnes</surname>
          <given-names>HG</given-names>
        </name>
        <name>
          <surname>Rye</surname>
          <given-names>IH</given-names>
        </name>
        <name>
          <surname>Sun</surname>
          <given-names>W</given-names>
        </name>
        <name>
          <surname>Weigman</surname>
          <given-names>VJ</given-names>
        </name>
        <name>
          <surname>Marynen</surname>
          <given-names>P</given-names>
        </name>
        <name>
          <surname>Zetterberg</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Naume</surname>
          <given-names>B</given-names>
        </name>
        <name>
          <surname>Perou</surname>
          <given-names>CM</given-names>
        </name>
        <name>
          <surname>Børresen-Dale</surname>
          <given-names>AL</given-names>
        </name>
        <name>
          <surname>Kristensen</surname>
          <given-names>VN</given-names>
        </name>
        <article-title>Allele-specific copy number analysis of tumors</article-title>
        <source>PNAS</source>
        <year>2010</year>
        <volume>107</volume>
        <issue>39</issue>
        <fpage>16910</fpage>
        <lpage>16915</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.1009843107</pub-id>
        <?supplied-pmid 20837533?>
        <pub-id pub-id-type="pmid">20837533</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B18">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Mullighan</surname>
          <given-names>CG</given-names>
        </name>
        <name>
          <surname>Goorha</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Radtke</surname>
          <given-names>I</given-names>
        </name>
        <name>
          <surname>Miller</surname>
          <given-names>CB</given-names>
        </name>
        <name>
          <surname>Coustan-Smith</surname>
          <given-names>E</given-names>
        </name>
        <name>
          <surname>Dalton</surname>
          <given-names>JD</given-names>
        </name>
        <name>
          <surname>Girtman</surname>
          <given-names>K</given-names>
        </name>
        <name>
          <surname>Mathew</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Ma</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Pounds</surname>
          <given-names>SB</given-names>
        </name>
        <name>
          <surname>Su</surname>
          <given-names>X</given-names>
        </name>
        <name>
          <surname>Pui</surname>
          <given-names>CH</given-names>
        </name>
        <name>
          <surname>Relling</surname>
          <given-names>MV</given-names>
        </name>
        <name>
          <surname>Evans</surname>
          <given-names>WE</given-names>
        </name>
        <name>
          <surname>Shurtleff</surname>
          <given-names>SA</given-names>
        </name>
        <name>
          <surname>Downing</surname>
          <given-names>JR</given-names>
        </name>
        <article-title>Genome-wide analysis of genetic alterations in Acute Lymphoblastic Leukemia</article-title>
        <source>Nature</source>
        <year>2007</year>
        <volume>446</volume>
        <issue>7137</issue>
        <fpage>758</fpage>
        <lpage>764</lpage>
        <pub-id pub-id-type="doi">10.1038/nature05690</pub-id>
        <?supplied-pmid 17344859?>
        <pub-id pub-id-type="pmid">17344859</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B19">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Pounds</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Cheng</surname>
          <given-names>C</given-names>
        </name>
        <name>
          <surname>Mullighan</surname>
          <given-names>C</given-names>
        </name>
        <name>
          <surname>Raimondi</surname>
          <given-names>SC</given-names>
        </name>
        <name>
          <surname>Shurtleff</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Downing</surname>
          <given-names>JR</given-names>
        </name>
        <article-title>Reference alignment of SNP microarray signals for copy number analysis of tumors</article-title>
        <source>Bioinformatics</source>
        <year>2009</year>
        <volume>25</volume>
        <issue>3</issue>
        <fpage>315</fpage>
        <lpage>321</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btn624</pub-id>
        <?supplied-pmid 19052058?>
        <pub-id pub-id-type="pmid">19052058</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B20">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Dominici</surname>
          <given-names>F</given-names>
        </name>
        <name>
          <surname>Parmigiani</surname>
          <given-names>G</given-names>
        </name>
        <name>
          <surname>Clyde</surname>
          <given-names>M</given-names>
        </name>
        <article-title>Conjugate analysis of multivariate normal data with incomplete observations</article-title>
        <source>Can J Stat</source>
        <year>2000</year>
        <volume>28</volume>
        <issue>3</issue>
        <fpage>533</fpage>
        <lpage>550</lpage>
        <pub-id pub-id-type="doi">10.2307/3315963</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B21">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Qin</surname>
          <given-names>L</given-names>
        </name>
        <name>
          <surname>Self</surname>
          <given-names>SG</given-names>
        </name>
        <article-title>The clustering of regression models method with applications in gene expression data</article-title>
        <source>Biometrics</source>
        <year>2006</year>
        <volume>62</volume>
        <issue>2</issue>
        <fpage>526</fpage>
        <lpage>533</lpage>
        <pub-id pub-id-type="doi">10.1111/j.1541-0420.2005.00498.x</pub-id>
        <?supplied-pmid 16918917?>
        <pub-id pub-id-type="pmid">16918917</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B22">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Dempster</surname>
          <given-names>AP</given-names>
        </name>
        <name>
          <surname>Laird</surname>
          <given-names>NM</given-names>
        </name>
        <name>
          <surname>Rubin</surname>
          <given-names>DB</given-names>
        </name>
        <article-title>Maximum likelihood from incomplete data via the EM algorithm</article-title>
        <source>J R Stat Soc Ser B</source>
        <year>1977</year>
        <volume>39</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <lpage>38</lpage>
      </mixed-citation>
    </ref>
    <ref id="B23">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Rice</surname>
          <given-names>J</given-names>
        </name>
        <article-title>Bandwidth choice for nonparametric regression</article-title>
        <source>Annu Stat</source>
        <year>1984</year>
        <volume>12</volume>
        <issue>4</issue>
        <fpage>1215</fpage>
        <lpage>1230</lpage>
        <pub-id pub-id-type="doi">10.1214/aos/1176346788</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B24">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Huang</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Wei</surname>
          <given-names>W</given-names>
        </name>
        <name>
          <surname>Zhang</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Liu</surname>
          <given-names>G</given-names>
        </name>
        <name>
          <surname>Bignell</surname>
          <given-names>GR</given-names>
        </name>
        <name>
          <surname>Stratton</surname>
          <given-names>MR</given-names>
        </name>
        <name>
          <surname>Futreal</surname>
          <given-names>PA</given-names>
        </name>
        <name>
          <surname>Wooster</surname>
          <given-names>R</given-names>
        </name>
        <name>
          <surname>Jones</surname>
          <given-names>KW</given-names>
        </name>
        <name>
          <surname>Shapero</surname>
          <given-names>MH</given-names>
        </name>
        <article-title>Whole genome DNA copy number changes identified by high density oligonucleotide arrays</article-title>
        <source>Hum Genomics</source>
        <year>2004</year>
        <volume>1</volume>
        <issue>4</issue>
        <fpage>287</fpage>
        <lpage>299</lpage>
        <pub-id pub-id-type="doi">10.1186/1479-7364-1-4-287</pub-id>
        <?supplied-pmid 15588488?>
        <pub-id pub-id-type="pmid">15588488</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B25">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Hong</surname>
          <given-names>H</given-names>
        </name>
        <name>
          <surname>Su</surname>
          <given-names>Z</given-names>
        </name>
        <name>
          <surname>Ge</surname>
          <given-names>W</given-names>
        </name>
        <name>
          <surname>Shi</surname>
          <given-names>L</given-names>
        </name>
        <name>
          <surname>Perkins</surname>
          <given-names>R</given-names>
        </name>
        <name>
          <surname>Fang</surname>
          <given-names>H</given-names>
        </name>
        <name>
          <surname>Xu</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Chen</surname>
          <given-names>JJ</given-names>
        </name>
        <name>
          <surname>Han</surname>
          <given-names>T</given-names>
        </name>
        <name>
          <surname>Kaput</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Fuscoe</surname>
          <given-names>JC</given-names>
        </name>
        <name>
          <surname>Tong</surname>
          <given-names>W</given-names>
        </name>
        <article-title>Assessing batch effects of genotype calling algorithm BRLMM for the affymetrix GeneChip human mapping 500 K array set using 270 HapMap samples</article-title>
        <source>BMC Bioinformatic</source>
        <year>2008</year>
        <volume>9</volume>
        <issue>Suppl 9</issue>
        <fpage>S17</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-9-S9-S17</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B26">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Walker</surname>
          <given-names>BA</given-names>
        </name>
        <name>
          <surname>Leone</surname>
          <given-names>PE</given-names>
        </name>
        <name>
          <surname>Chiecchio</surname>
          <given-names>L</given-names>
        </name>
        <name>
          <surname>Dickens</surname>
          <given-names>NJ</given-names>
        </name>
        <name>
          <surname>Jenner</surname>
          <given-names>MW</given-names>
        </name>
        <name>
          <surname>Boyd</surname>
          <given-names>KD</given-names>
        </name>
        <name>
          <surname>Johnson</surname>
          <given-names>DC</given-names>
        </name>
        <name>
          <surname>Gonzalez</surname>
          <given-names>D</given-names>
        </name>
        <name>
          <surname>Dagrada</surname>
          <given-names>GP</given-names>
        </name>
        <name>
          <surname>Protheroe</surname>
          <given-names>RK</given-names>
        </name>
        <name>
          <surname>Konn</surname>
          <given-names>ZJ</given-names>
        </name>
        <name>
          <surname>Stockley</surname>
          <given-names>DM</given-names>
        </name>
        <name>
          <surname>Gregory</surname>
          <given-names>WM</given-names>
        </name>
        <name>
          <surname>Davies</surname>
          <given-names>FE</given-names>
        </name>
        <name>
          <surname>Ross</surname>
          <given-names>FM</given-names>
        </name>
        <name>
          <surname>Morgan</surname>
          <given-names>GJ</given-names>
        </name>
        <article-title>A compendium of myeloma-associated chromosomal copy number abnormalities and their prognostic value</article-title>
        <source>Blood</source>
        <year>2010</year>
        <volume>116</volume>
        <issue>15</issue>
        <fpage>e56</fpage>
        <lpage>e65</lpage>
        <pub-id pub-id-type="doi">10.1182/blood-2010-04-279596</pub-id>
        <?supplied-pmid 20616218?>
        <pub-id pub-id-type="pmid">20616218</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B27">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Yang</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Pounds</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Zhang</surname>
          <given-names>K</given-names>
        </name>
        <name>
          <surname>Fang</surname>
          <given-names>Z</given-names>
        </name>
        <article-title>PAIR: paired allelic log-intensity-ratio based normalization method for SNP-CGH arrays</article-title>
        <source>Bioinformatics</source>
        <year>2013</year>
        <volume>29</volume>
        <issue>3</issue>
        <fpage>299</fpage>
        <lpage>307</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bts683</pub-id>
        <?supplied-pmid 23196989?>
        <pub-id pub-id-type="pmid">23196989</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B28">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Wang</surname>
          <given-names>K</given-names>
        </name>
        <name>
          <surname>Li</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Hadley</surname>
          <given-names>D</given-names>
        </name>
        <name>
          <surname>Liu</surname>
          <given-names>R</given-names>
        </name>
        <name>
          <surname>Glessner</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Grant</surname>
          <given-names>SF</given-names>
        </name>
        <name>
          <surname>Hakonarson</surname>
          <given-names>H</given-names>
        </name>
        <name>
          <surname>Bucan</surname>
          <given-names>M</given-names>
        </name>
        <article-title>PennCNV: an integrated hidden Markov model designed for high-resolution copy number variation detection in whole-genome SNP genotyping data</article-title>
        <source>Genome Res</source>
        <year>2007</year>
        <volume>17</volume>
        <issue>11</issue>
        <fpage>1665</fpage>
        <lpage>1674</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.6861907</pub-id>
        <?supplied-pmid 17921354?>
        <pub-id pub-id-type="pmid">17921354</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B29">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Colella</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Yau</surname>
          <given-names>C</given-names>
        </name>
        <name>
          <surname>Taylor</surname>
          <given-names>JM</given-names>
        </name>
        <name>
          <surname>Mirza</surname>
          <given-names>G</given-names>
        </name>
        <name>
          <surname>Butler</surname>
          <given-names>H</given-names>
        </name>
        <name>
          <surname>Clouston</surname>
          <given-names>P</given-names>
        </name>
        <name>
          <surname>Bassett</surname>
          <given-names>AS</given-names>
        </name>
        <name>
          <surname>Seller</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Holmes</surname>
          <given-names>CC</given-names>
        </name>
        <name>
          <surname>Ragoussis</surname>
          <given-names>J</given-names>
        </name>
        <article-title>QuantiSNP: an objective bayes hidden-Markov model to detect and accurately map copy number variation using SNP genotyping data</article-title>
        <source>Nucleic Acids Res</source>
        <year>2007</year>
        <volume>35</volume>
        <issue>6</issue>
        <fpage>2013</fpage>
        <lpage>2025</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkm076</pub-id>
        <?supplied-pmid 17341461?>
        <pub-id pub-id-type="pmid">17341461</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B30">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Yau</surname>
          <given-names>C</given-names>
        </name>
        <name>
          <surname>Mouradov</surname>
          <given-names>D</given-names>
        </name>
        <name>
          <surname>Jorissen</surname>
          <given-names>RN</given-names>
        </name>
        <name>
          <surname>Colella</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Mirza</surname>
          <given-names>G</given-names>
        </name>
        <name>
          <surname>Steers</surname>
          <given-names>G</given-names>
        </name>
        <name>
          <surname>Harris</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Ragoussis</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Sieber</surname>
          <given-names>O</given-names>
        </name>
        <name>
          <surname>Holmes</surname>
          <given-names>CC</given-names>
        </name>
        <article-title>A statistical approach for detecting genomic aberrations in heterogeneous tumor samples from single nucleotide polymorphism genotyping data</article-title>
        <source>Genome Biol</source>
        <year>2010</year>
        <volume>11</volume>
        <issue>9</issue>
        <fpage>R92</fpage>
        <lpage>R92</lpage>
        <?supplied-pmid 20858232?>
        <pub-id pub-id-type="pmid">20858232</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B31">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Redon</surname>
          <given-names>R</given-names>
        </name>
        <name>
          <surname>Redon</surname>
          <given-names>R</given-names>
        </name>
        <name>
          <surname>Ishikawa</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Fitch</surname>
          <given-names>KR</given-names>
        </name>
        <name>
          <surname>Feuk</surname>
          <given-names>L</given-names>
        </name>
        <name>
          <surname>Perry</surname>
          <given-names>GH</given-names>
        </name>
        <name>
          <surname>Andrews</surname>
          <given-names>TD</given-names>
        </name>
        <name>
          <surname>Fiegler</surname>
          <given-names>H</given-names>
        </name>
        <name>
          <surname>Shapero</surname>
          <given-names>MH</given-names>
        </name>
        <name>
          <surname>Carson</surname>
          <given-names>AR</given-names>
        </name>
        <name>
          <surname>Chen</surname>
          <given-names>W</given-names>
        </name>
        <name>
          <surname>Cho</surname>
          <given-names>EK</given-names>
        </name>
        <name>
          <surname>Dallaire</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Freeman</surname>
          <given-names>JL</given-names>
        </name>
        <name>
          <surname>Gonzalez</surname>
          <given-names>JR</given-names>
        </name>
        <name>
          <surname>Gratacos</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Huang</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Kalaitzopoulos</surname>
          <given-names>D</given-names>
        </name>
        <name>
          <surname>Komura</surname>
          <given-names>D</given-names>
        </name>
        <name>
          <surname>MacDonald</surname>
          <given-names>JR</given-names>
        </name>
        <name>
          <surname>Marshall</surname>
          <given-names>CR</given-names>
        </name>
        <name>
          <surname>Mei</surname>
          <given-names>R</given-names>
        </name>
        <name>
          <surname>Montgomery</surname>
          <given-names>L</given-names>
        </name>
        <name>
          <surname>Nishimura</surname>
          <given-names>K</given-names>
        </name>
        <name>
          <surname>Okamura</surname>
          <given-names>K</given-names>
        </name>
        <name>
          <surname>Shen</surname>
          <given-names>F</given-names>
        </name>
        <name>
          <surname>Somerville</surname>
          <given-names>MJ</given-names>
        </name>
        <name>
          <surname>Tchinda</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Valsesia</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Woodwark</surname>
          <given-names>C</given-names>
        </name>
        <name>
          <surname>Yang</surname>
          <given-names>F</given-names>
        </name>
        <etal/>
        <article-title>Global variation in copy number in the human genome</article-title>
        <source>Nature</source>
        <year>2006</year>
        <volume>444</volume>
        <issue>7118</issue>
        <fpage>445</fpage>
        <lpage>454</lpage>
      </mixed-citation>
    </ref>
  </ref-list>
</back>
