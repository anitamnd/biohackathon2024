<?DTDIdentifier.IdentifierValue article.dtd?>
<?DTDIdentifier.IdentifierType system?>
<?SourceDTD.DTDName article.dtd?>
<?SourceDTD.Version 1.0?>
<?ConverterInfo.XSLTName bmc2nlmx2.xsl?>
<?ConverterInfo.Version 2?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Genomics</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Genomics</journal-id>
    <journal-title-group>
      <journal-title>BMC Genomics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2164</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">3582591</article-id>
    <article-id pub-id-type="publisher-id">1471-2164-13-591</article-id>
    <article-id pub-id-type="doi">10.1186/1471-2164-13-591</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Software</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title><italic>Copynumber:</italic> Efficient algorithms for single- and multi-track copy number segmentation</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" equal-contrib="yes" id="A1">
        <name>
          <surname>Nilsen</surname>
          <given-names>Gro</given-names>
        </name>
        <xref ref-type="aff" rid="I1">1</xref>
        <xref ref-type="aff" rid="I2">2</xref>
        <email>gronilse@ifi.uio.no</email>
      </contrib>
      <contrib contrib-type="author" equal-contrib="yes" id="A2">
        <name>
          <surname>Liestøl</surname>
          <given-names>Knut</given-names>
        </name>
        <xref ref-type="aff" rid="I1">1</xref>
        <xref ref-type="aff" rid="I2">2</xref>
        <email>knut@ifi.uio.no</email>
      </contrib>
      <contrib contrib-type="author" id="A3">
        <name>
          <surname>Loo</surname>
          <given-names>Peter Van</given-names>
        </name>
        <xref ref-type="aff" rid="I3">3</xref>
        <xref ref-type="aff" rid="I4">4</xref>
        <email>pvl@sanger.ac.uk</email>
      </contrib>
      <contrib contrib-type="author" id="A4">
        <name>
          <surname>Moen Vollan</surname>
          <given-names>Hans Kristian</given-names>
        </name>
        <xref ref-type="aff" rid="I5">5</xref>
        <xref ref-type="aff" rid="I6">6</xref>
        <xref ref-type="aff" rid="I7">7</xref>
        <email>hans.kristian.moen.vollan@rr-research.no</email>
      </contrib>
      <contrib contrib-type="author" id="A5">
        <name>
          <surname>Eide</surname>
          <given-names>Marianne B</given-names>
        </name>
        <xref ref-type="aff" rid="I2">2</xref>
        <xref ref-type="aff" rid="I8">8</xref>
        <email>marianne.brodtkorb.eide@rr-research.no</email>
      </contrib>
      <contrib contrib-type="author" id="A6">
        <name>
          <surname>Rueda</surname>
          <given-names>Oscar M</given-names>
        </name>
        <xref ref-type="aff" rid="I9">9</xref>
        <email>oscar.rueda@cancer.org.uk</email>
      </contrib>
      <contrib contrib-type="author" id="A7">
        <name>
          <surname>Chin</surname>
          <given-names>Suet-Feung</given-names>
        </name>
        <xref ref-type="aff" rid="I9">9</xref>
        <email>suet-feung.chin@cancer.org.uk</email>
      </contrib>
      <contrib contrib-type="author" id="A8">
        <name>
          <surname>Russell</surname>
          <given-names>Roslin</given-names>
        </name>
        <xref ref-type="aff" rid="I9">9</xref>
        <email>roslin.russell@cancer.org.uk</email>
      </contrib>
      <contrib contrib-type="author" id="A9">
        <name>
          <surname>Baumbusch</surname>
          <given-names>Lars O</given-names>
        </name>
        <xref ref-type="aff" rid="I5">5</xref>
        <email>lars.o.baumbusch@rr-research.no</email>
      </contrib>
      <contrib contrib-type="author" id="A10">
        <name>
          <surname>Caldas</surname>
          <given-names>Carlos</given-names>
        </name>
        <xref ref-type="aff" rid="I9">9</xref>
        <xref ref-type="aff" rid="I10">10</xref>
        <email>carlos.caldas@cancer.org.uk</email>
      </contrib>
      <contrib contrib-type="author" id="A11">
        <name>
          <surname>Børresen-Dale</surname>
          <given-names>Anne-Lise</given-names>
        </name>
        <xref ref-type="aff" rid="I5">5</xref>
        <xref ref-type="aff" rid="I6">6</xref>
        <email>a.l.borresen-dale@medisin.uio.no</email>
      </contrib>
      <contrib contrib-type="author" corresp="yes" id="A12">
        <name>
          <surname>Lingjærde</surname>
          <given-names>Ole Christian</given-names>
        </name>
        <xref ref-type="aff" rid="I1">1</xref>
        <xref ref-type="aff" rid="I2">2</xref>
        <xref ref-type="aff" rid="I5">5</xref>
        <email>ole@ifi.uio.no</email>
      </contrib>
    </contrib-group>
    <aff id="I1"><label>1</label>Biomedical Informatics, Dept of Informatics, University of Oslo, Oslo, Norway</aff>
    <aff id="I2"><label>2</label>Centre for Cancer Biomedicine, University of Oslo, Oslo, Norway</aff>
    <aff id="I3"><label>3</label>Cancer Genome Project, Wellcome Trust Sanger Institute, Hinxton, Cambridge, UK</aff>
    <aff id="I4"><label>4</label>Dept of Human Genetics, VIB and University of Leuven, Leuven, Belgium</aff>
    <aff id="I5"><label>5</label>Dept of Genetics, Institute for Cancer Research, Oslo University Hospital Radiumhospitalet, Oslo, Norway</aff>
    <aff id="I6"><label>6</label>Institute of Clinical Medicine, Faculty of Medicine, University of Oslo, Oslo, Norway</aff>
    <aff id="I7"><label>7</label>Dept of Oncology, Division of Cancer, Surgery and Transplantation, Oslo University Hospital Radiumhospitalet, Oslo, Norway</aff>
    <aff id="I8"><label>8</label>Dept of Immunology, Institute for Cancer Research, Oslo University Hospital Radiumhospitalet, Oslo, Norway</aff>
    <aff id="I9"><label>9</label>Breast Cancer Functional Genomics, Cancer Research UK Cambridge Research Institute and Dept of Oncology, University of Cambridge, Li Ka-Shing Centre, Cambridge, UK</aff>
    <aff id="I10"><label>10</label>Cambridge Breast Unit, Addenbrookes Hospital and Cambridge National Institute for Health Research Biomedical Research Centre, Cambridge University Hospitals NHS Foundation Trust, Cambridge, UK</aff>
    <pub-date pub-type="collection">
      <year>2012</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>4</day>
      <month>11</month>
      <year>2012</year>
    </pub-date>
    <volume>13</volume>
    <fpage>591</fpage>
    <lpage>591</lpage>
    <history>
      <date date-type="received">
        <day>16</day>
        <month>5</month>
        <year>2012</year>
      </date>
      <date date-type="accepted">
        <day>15</day>
        <month>10</month>
        <year>2012</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>Copyright ©2012 Nilsen et al.; licensee BioMed Central Ltd.</copyright-statement>
      <copyright-year>2012</copyright-year>
      <copyright-holder>Nilsen et al.; licensee BioMed Central Ltd.</copyright-holder>
      <license license-type="open-access" xlink:href="http://creativecommons.org/licenses/by/2.0">
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License(<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/2.0">http://creativecommons.org/licenses/by/2.0</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="http://www.biomedcentral.com/1471-2164/13/591"/>
    <abstract>
      <sec>
        <title>Background</title>
        <p>Cancer progression is associated with genomic instability and an accumulation of gains and losses of DNA. The growing variety of tools for measuring genomic copy numbers, including various types of array-CGH, SNP arrays and high-throughput sequencing, calls for a coherent framework offering unified and consistent handling of single- and multi-track segmentation problems. In addition, there is a demand for highly computationally efficient segmentation algorithms, due to the emergence of very high density scans of copy number.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p>A comprehensive Bioconductor package for copy number analysis is presented. The package offers a unified framework for single sample, multi-sample and multi-track segmentation and is based on statistically sound penalized least squares principles. Conditional on the number of breakpoints, the estimates are optimal in the least squares sense. A novel and computationally highly efficient algorithm is proposed that utilizes vector-based operations in R. Three case studies are presented.</p>
      </sec>
      <sec>
        <title>Conclusions</title>
        <p>The R package <monospace>copynumber</monospace> is a software suite for segmentation of single- and multi-track copy number data using algorithms based on coherent least squares principles.</p>
      </sec>
    </abstract>
    <kwd-group>
      <kwd>Copy number</kwd>
      <kwd>aCGH</kwd>
      <kwd>Segmentation</kwd>
      <kwd>Allele-specific segmentation</kwd>
      <kwd>Penalized regression</kwd>
      <kwd>Least squares</kwd>
      <kwd>Bioconductor</kwd>
    </kwd-group>
  </article-meta>
</front>
<body>
  <sec>
    <title>Background</title>
    <p>In cancer, the path from normal to malignant cell involves multiple genomic alterations including losses and gains of genomic DNA. A long series of studies have demonstrated the biological and clinical relevance of studying such genomic alterations (see, e.g., [<xref ref-type="bibr" rid="B1">1</xref>,<xref ref-type="bibr" rid="B2">2</xref>] and references therein). Genome-wide scans of copy number alterations may be obtained with array-based comparative genomic hybridization (aCGH), SNP arrays and high-throughput sequencing (HTS). After proper normalization and transformation of the raw signal intensities obtained from such technologies, the next step is usually to perform segmentation to identify regions of constant copy number. Many segmentation algorithms are designed to analyse samples individually (see, e.g., [<xref ref-type="bibr" rid="B3">3</xref>-<xref ref-type="bibr" rid="B16">16</xref>] and references therein), while most studies involve multiple samples, multiple tracks, or both. Joint handling of multiple samples is computationally and conceptually challenging, see e.g. [<xref ref-type="bibr" rid="B17">17</xref>,<xref ref-type="bibr" rid="B18">18</xref>]. Most systematic approaches for this problem are based on individual segmentation of each sample followed by post-processing to combine results across samples (see, e.g., [<xref ref-type="bibr" rid="B18">18</xref>] and references therein), while some recent publications propose strategies for joint segmentation of all samples [<xref ref-type="bibr" rid="B19">19</xref>-<xref ref-type="bibr" rid="B23">23</xref>]. Recently, the emergence of new technologies have pushed the limit of genomic resolution, opening new vistas for studying very short aberrations, including aberrations affecting only part of a gene or gene regulatory sites in the DNA. A major challenge raised by these novel technologies is the steadily growing length of the data tracks, which drastically increases the demand for computationally efficient algorithms. The occurrence of extreme observations (outliers) of biological or technical origin pose an additional challenge, as most segmentation methods are substantially affected by such observations. Picard et al. [<xref ref-type="bibr" rid="B6">6</xref>] propose a least squares based segmentation method that results in a piecewise constant fit to the copy number data. Their approach assumes that the user either supplies the desired number of segments or leaves to the method to automatically determine this number. In this paper, we describe a related approach. In particular, the proposed method utilizes penalized least squares regression to determine a piecewise constant fit to the data. Introducing a fixed penalty <italic>γ</italic>&gt;0 for any difference in the fitted values of two neighboring observations induces an optimal solution of particular relevance to copy number data: a piecewise constant curve fully determined by the breakpoints and the average copy number values on each segment. The user defined penalty <italic>γ</italic>essentially controls the level of empirical evidence required to introduce a breakpoint. Given the number of breakpoints, the solution will be optimal in terms of least squares error.</p>
    <p>To achieve high processing efficiency, dynamic programming is used (see [<xref ref-type="bibr" rid="B24">24</xref>]). To further increase computational efficiency, a novel vector based algorithm is proposed, and even further speed optimization is obtained through heuristics. A central aim of the present work has been to provide methodology and high-performance algorithms for solving single- and multiple-track problems within a statistically and computationally unified framework. All proposed algorithms are embedded in a comprehensive software suite for copy number segmentation and visualization, available as the Bioconductor package <monospace>copynumber</monospace>. Main features of the package include: </p>
    <p>• Independent as well as joint segmentation of multiple samples</p>
    <p>• Segmentation of allele-specific SNP array data</p>
    <p>• Preprocessing tools for outlier detection and handling, and missing value imputation.</p>
    <p>• Visualization tools</p>
  </sec>
  <sec>
    <title>Implementation</title>
    <sec>
      <title>Systems overview</title>
      <p>The <monospace>copynumber</monospace> package provides functionality for many of the tasks typically encountered in copy number analysis: data preprocessing tools, segmentation methods for various analysis scenarios, and visualization tools. Figure <xref ref-type="fig" rid="F1">1</xref> shows an overview of the typical work flow. Input is normalized and log<sub>2</sub>-transformed copy number measurements from one or more aCGH, SNP-array or HTS experiments. Allele-frequencies may also be specified for the segmentation of SNP-array data. It is strongly recommended to detect and appropriately modify extreme observations (outliers) prior to segmentation, as these can have a substantial negative effect on the analysis. For this purpose, a specially designed Winsorization method is included in the software package. A missing-value imputation method appropriate for copy number data is also available.</p>
      <fig id="F1" position="float">
        <label>Figure 1</label>
        <caption>
          <p><bold>An overview of the </bold><bold>copynumber </bold><bold>package.</bold> Depending on the aim of the analysis, the input will be copy number data and possibly allele frequencies from one or more experiments. Preprocessing tools are available for outlier handling and missing data imputation, and three different methods handle single sample, multi-sample and allele-specific segmentation. Several options are also available for the graphical visualization of data and segmentation results.</p>
        </caption>
        <graphic xlink:href="1471-2164-13-591-1"/>
      </fig>
      <p>Segmentation methods for three different scenarios (single sample, multi-sample and allele-specific segmentation) are implemented in the package. All these methods are referred to as Piecewise Constant Fitting (PCF) algorithms and seek to minimize a penalized least squares criterion. In single sample PCF, individual segmentation curves are fitted to each sample. In multi-sample PCF, segmentation curves with common segment borders are simultaneously fitted to all samples. In allele-specific PCF, the segmentation curves are fitted to bivariate SNP-array data, providing identical segment borders for both data tracks. A set of graphical tools are also available in the package to visualize data and segmentation results, and to plot aberration frequencies and heatmaps. Also included are diagnostics to explore different trade-offs between goodness-of-fit and parsimony in terms of the number of segments. In the remaining part of this section, a formal description of the algorithms is given. However, note that these details are not a prerequisite for reading later sections or for using the <monospace>copynumber</monospace> package.</p>
    </sec>
    <sec>
      <title>Preprocessing: Outlier handling</title>
      <p>A challenging factor in copy number analysis is the frequent occurrence of outliers - single probe values that differ markedly from their neighbors. Such extreme observations can be due to the presence of very short segments of DNA with deviant copy numbers, to technical aberrations, or a combination. When identification of CNVs is a purpose of the study, the multi-sample method described below may be applied for such detection. However, when the focus is on detection of broader aberrations, the potentially harmful effect of extreme observations on aberration detection methods induces a need for outlier handling procedures (see, e.g., [<xref ref-type="bibr" rid="B3">3</xref>,<xref ref-type="bibr" rid="B6">6</xref>]). Since the <monospace>copynumber</monospace> package is based on least squares, an extreme observation will tend to cause the detection of a short segment. When searching for broader segments, such short (and abundant) segments will represent noise and may also affect the identification of other segments. We therefore now describe a procedure for reducing the effect of extreme observations, while the effects of this method will be considered in the Results and discussion section. Winsorization is a simple transformation reducing the influence of outliers by moving observations outside a certain fractile in the distribution to that fractile (see [<xref ref-type="bibr" rid="B25">25</xref>]). For identically distributed observations <italic>y</italic><sub>1</sub>,…,<italic>y</italic><sub><italic>p</italic></sub>, the corresponding Winsorized observations are defined as <inline-formula><mml:math id="M1" name="1471-2164-13-591-i1" overflow="scroll"><mml:msubsup><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>w</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mi>Ψ</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:math></inline-formula> where </p>
      <p>
        <disp-formula>
          <mml:math id="M2" name="1471-2164-13-591-i2" overflow="scroll">
            <mml:mrow>
              <mml:mi>Ψ</mml:mi>
              <mml:mo>(</mml:mo>
              <mml:mi>y</mml:mi>
              <mml:mo>)</mml:mo>
              <mml:mo>=</mml:mo>
              <mml:mi>Ψ</mml:mi>
              <mml:mo>(</mml:mo>
              <mml:mi>y</mml:mi>
              <mml:mspace width="0.3em"/>
              <mml:mo>|</mml:mo>
              <mml:mspace width="0.3em"/>
              <mml:mi>θ</mml:mi>
              <mml:mo>)</mml:mo>
              <mml:mo>=</mml:mo>
              <mml:mfenced open="{">
                <mml:mrow>
                  <mml:mtable class="align" columnalign="left">
                    <mml:mtr>
                      <mml:mtd class="align-1">
                        <mml:mo>−</mml:mo>
                        <mml:mi>θ</mml:mi>
                        <mml:mo>,</mml:mo>
                      </mml:mtd>
                      <mml:mtd class="align-2">
                        <mml:mspace width="1em"/>
                        <mml:mi>y</mml:mi>
                        <mml:mo>&lt;</mml:mo>
                        <mml:mo>−</mml:mo>
                        <mml:mi>θ</mml:mi>
                      </mml:mtd>
                    </mml:mtr>
                    <mml:mtr>
                      <mml:mtd class="align-1">
                        <mml:mspace width=".8em"/>
                        <mml:mi>θ</mml:mi>
                        <mml:mo>,</mml:mo>
                      </mml:mtd>
                      <mml:mtd class="align-2">
                        <mml:mspace width="1em"/>
                        <mml:mi>y</mml:mi>
                        <mml:mo>&gt;</mml:mo>
                        <mml:mi>θ</mml:mi>
                      </mml:mtd>
                    </mml:mtr>
                    <mml:mtr>
                      <mml:mtd class="align-1">
                        <mml:mspace width=".8em"/>
                        <mml:mi>y</mml:mi>
                        <mml:mo>,</mml:mo>
                      </mml:mtd>
                      <mml:mtd class="align-2">
                        <mml:mspace width="1em"/>
                        <mml:mtext>otherwise.</mml:mtext>
                      </mml:mtd>
                    </mml:mtr>
                  </mml:mtable>
                </mml:mrow>
              </mml:mfenced>
            </mml:mrow>
          </mml:math>
        </disp-formula>
      </p>
      <p>Here, <italic>θ</italic>&gt;0 determines how extreme an observation must be to be relocated, as well as the replacement value. A common choice is <italic>θ</italic>=<italic>τs</italic>, where typically <italic>τ</italic>∈[1.5,3] and <italic>s</italic> is a robust estimate of the standard deviation (SD). A robust scale estimator is the Median Absolute Deviation (MAD), defined as the median of the values <inline-formula><mml:math id="M3" name="1471-2164-13-591-i3" overflow="scroll"><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover><mml:mo>|</mml:mo></mml:math></inline-formula>, where <inline-formula><mml:math id="M4" name="1471-2164-13-591-i4" overflow="scroll"><mml:mover accent="true"><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:math></inline-formula> is the median of <italic>y</italic><sub>1</sub>,…,<italic>y</italic><sub><italic>p</italic></sub>. For normally distributed observations, <italic>s</italic><sub><italic>M</italic></sub>=1.4826·MAD corresponds to SD.</p>
      <p>Winsorization of copy number data may be achieved by first estimating the trend in the data and then Winsorizing the residuals. Let the observations representing copy numbers in <italic>p</italic> genomic loci be <bold>y</bold>=(<italic>y</italic><sub>1</sub>,…,<italic>y</italic><sub><italic>p</italic></sub>), ordered according to genomic position. A simple estimator of the trend is the median filter. The trend estimate <inline-formula><mml:math id="M5" name="1471-2164-13-591-i5" overflow="scroll"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> in the <italic>j</italic>th locus is then given by the median of <italic>y</italic><sub><italic>j</italic>−<italic>k</italic></sub>,…,<italic>y</italic><sub><italic>j</italic> + <italic>k </italic></sub>for some <italic>k</italic>&gt;0, e.g. <italic>k</italic>=25. The SD of the residuals <inline-formula><mml:math id="M6" name="1471-2164-13-591-i6" overflow="scroll"><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> may then be estimated with the MAD estimator <italic>s</italic><sub><italic>M</italic></sub>, and Winsorized observations <inline-formula><mml:math id="M7" name="1471-2164-13-591-i7" overflow="scroll"><mml:msubsup><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>w</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>w</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula> obtained by <inline-formula><mml:math id="M8" name="1471-2164-13-591-i8" overflow="scroll"><mml:msubsup><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>w</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>Ψ</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mspace width="0.3em"/><mml:mo>|</mml:mo><mml:mspace width="0.3em"/><mml:mi>τ</mml:mi><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>M</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:math></inline-formula>. Often, such simple and fast Winsorization is sufficient. However, <monospace>copynumber</monospace> also includes an iterative procedure with improved trend estimation based on the segmentation procedures described below (see Additional file <xref ref-type="supplementary-material" rid="S1">1</xref>).</p>
    </sec>
    <sec>
      <title>Single sample segmentation</title>
      <p>Consider first the basic problem of obtaining individual segmentations for each of a number of samples. Suppose attention is restricted to one chromosome arm on one sample. For each of the <italic>p</italic> loci, the obtained measurement can be conceived of as a sum of two contributions: </p>
      <p>
        <disp-formula id="bmcM1">
          <label>(1)</label>
          <mml:math id="M9" name="1471-2164-13-591-i9" overflow="scroll">
            <mml:msub>
              <mml:mrow>
                <mml:mi>y</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>j</mml:mi>
              </mml:mrow>
            </mml:msub>
            <mml:mo>=</mml:mo>
            <mml:msub>
              <mml:mrow>
                <mml:mi>z</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>j</mml:mi>
              </mml:mrow>
            </mml:msub>
            <mml:mo>+</mml:mo>
            <mml:msub>
              <mml:mrow>
                <mml:mi>ε</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>j</mml:mi>
              </mml:mrow>
            </mml:msub>
          </mml:math>
        </disp-formula>
      </p>
      <p>where <italic>z</italic><sub><italic>j</italic></sub>is an unknown parameter reflecting the actual amount of sample DNA at the j’th locus and <italic>ε</italic><sub><italic>j</italic></sub>represents measurement noise. A breakpoint is said to occur between probe <italic>j</italic> and <italic>j</italic> + 1 if <italic>z</italic><sub><italic>j</italic></sub>≠<italic>z</italic><sub><italic>j</italic> + 1</sub>. The sequence <italic>z</italic><sub>1</sub>,…,<italic>z</italic><sub><italic>p</italic></sub> thus implies a segmentation <italic>S</italic>={<italic>I</italic><sub>1</sub>,…,<italic>I</italic><sub><italic>M</italic></sub>} of the chromosome arm, where <italic>I</italic><sub>1 </sub>consists of the probes before the first breakpoint, <italic>I</italic><sub>2 </sub>consists of the subsequent probes until the second breakpoint, and so on. To fit model (1), we minimize the penalized least squares criterion </p>
      <p>
        <disp-formula id="bmcM2">
          <label>(2)</label>
          <mml:math id="M10" name="1471-2164-13-591-i10" overflow="scroll">
            <mml:munderover accentunder="false" accent="false">
              <mml:mrow>
                <mml:mo>∑</mml:mo>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>j</mml:mi>
                <mml:mo>=</mml:mo>
                <mml:mn>1</mml:mn>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>p</mml:mi>
              </mml:mrow>
            </mml:munderover>
            <mml:msup>
              <mml:mrow>
                <mml:mo>(</mml:mo>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>y</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>j</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:mo>−</mml:mo>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>z</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>j</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:mo>)</mml:mo>
              </mml:mrow>
              <mml:mrow>
                <mml:mn>2</mml:mn>
              </mml:mrow>
            </mml:msup>
            <mml:mo>+</mml:mo>
            <mml:mi>γ</mml:mi>
            <mml:mo>·</mml:mo>
            <mml:mo>|</mml:mo>
            <mml:mi>S</mml:mi>
            <mml:mo>|</mml:mo>
          </mml:math>
        </disp-formula>
      </p>
      <p>with respect to the sequence <italic>z</italic><sub>1</sub>,…,<italic>z</italic><sub><italic>p</italic></sub>. Here, |<italic>S</italic>| denotes the number of segments in <italic>S</italic>, and <italic>γ</italic>&gt;0 is a constant that controls the trade-off between seeking a good fit to the data (the first term) and restraining the number of level shifts (the second term). The minimizer <inline-formula><mml:math id="M11" name="1471-2164-13-591-i11" overflow="scroll"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> of (2) is fully determined by the segmentation <italic>S</italic>, since the best fit <inline-formula><mml:math id="M12" name="1471-2164-13-591-i12" overflow="scroll"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> on a given segment <italic>I</italic> is the average <inline-formula><mml:math id="M13" name="1471-2164-13-591-i13" overflow="scroll"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>I</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> of the observations on that segment. Substituting the latter into (2) we obtain the equivalent criterion: </p>
      <p>
        <disp-formula id="bmcM3">
          <label>(3)</label>
          <mml:math id="M14" name="1471-2164-13-591-i14" overflow="scroll">
            <mml:mi>L</mml:mi>
            <mml:mo>(</mml:mo>
            <mml:mi>S</mml:mi>
            <mml:mspace width="0.3em"/>
            <mml:mo>|</mml:mo>
            <mml:mspace width="0.3em"/>
            <mml:mi mathvariant="bold">y</mml:mi>
            <mml:mo>,</mml:mo>
            <mml:mi>γ</mml:mi>
            <mml:mo>)</mml:mo>
            <mml:mo>=</mml:mo>
            <mml:munder>
              <mml:mrow>
                <mml:mo>∑</mml:mo>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>I</mml:mi>
                <mml:mo>∈</mml:mo>
                <mml:mi>S</mml:mi>
              </mml:mrow>
            </mml:munder>
            <mml:munder>
              <mml:mrow>
                <mml:mo>∑</mml:mo>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>j</mml:mi>
                <mml:mo>∈</mml:mo>
                <mml:mi>I</mml:mi>
              </mml:mrow>
            </mml:munder>
            <mml:msup>
              <mml:mrow>
                <mml:mo>(</mml:mo>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>y</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>j</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:mo>−</mml:mo>
                <mml:msub>
                  <mml:mrow>
                    <mml:mover accent="true">
                      <mml:mrow>
                        <mml:mi>y</mml:mi>
                      </mml:mrow>
                      <mml:mo>¯</mml:mo>
                    </mml:mover>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>I</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:mo>)</mml:mo>
              </mml:mrow>
              <mml:mrow>
                <mml:mn>2</mml:mn>
              </mml:mrow>
            </mml:msup>
            <mml:mo>+</mml:mo>
            <mml:mi>γ</mml:mi>
            <mml:mo>·</mml:mo>
            <mml:mo>|</mml:mo>
            <mml:mi>S</mml:mi>
            <mml:mo>|</mml:mo>
          </mml:math>
        </disp-formula>
      </p>
      <p>
        <disp-formula id="bmcM4">
          <label>(4)</label>
          <mml:math id="M15" name="1471-2164-13-591-i15" overflow="scroll">
            <mml:mspace width="2em"/>
            <mml:mspace width="2em"/>
            <mml:mspace width="2.77695pt"/>
            <mml:mo>=</mml:mo>
            <mml:munder>
              <mml:mrow>
                <mml:mo>∑</mml:mo>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>I</mml:mi>
                <mml:mo>∈</mml:mo>
                <mml:mi>S</mml:mi>
              </mml:mrow>
            </mml:munder>
            <mml:munder>
              <mml:mrow>
                <mml:mo>∑</mml:mo>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>j</mml:mi>
                <mml:mo>∈</mml:mo>
                <mml:mi>I</mml:mi>
              </mml:mrow>
            </mml:munder>
            <mml:msubsup>
              <mml:mrow>
                <mml:mi>y</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>j</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mn>2</mml:mn>
              </mml:mrow>
            </mml:msubsup>
            <mml:mo>−</mml:mo>
            <mml:munder>
              <mml:mrow>
                <mml:mo>∑</mml:mo>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>I</mml:mi>
                <mml:mo>∈</mml:mo>
                <mml:mi>S</mml:mi>
              </mml:mrow>
            </mml:munder>
            <mml:msup>
              <mml:mrow>
                <mml:mo>(</mml:mo>
                <mml:munder>
                  <mml:mrow>
                    <mml:mo>∑</mml:mo>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>j</mml:mi>
                    <mml:mo>∈</mml:mo>
                    <mml:mi>I</mml:mi>
                  </mml:mrow>
                </mml:munder>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>y</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>j</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:mo>)</mml:mo>
              </mml:mrow>
              <mml:mrow>
                <mml:mn>2</mml:mn>
              </mml:mrow>
            </mml:msup>
            <mml:mo>/</mml:mo>
            <mml:msub>
              <mml:mrow>
                <mml:mi>n</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>I</mml:mi>
              </mml:mrow>
            </mml:msub>
            <mml:mo>+</mml:mo>
            <mml:mi>γ</mml:mi>
            <mml:mo>·</mml:mo>
            <mml:mo>|</mml:mo>
            <mml:mi>S</mml:mi>
            <mml:mo>|</mml:mo>
          </mml:math>
        </disp-formula>
      </p>
      <p>where <italic>n</italic><sub><italic>I </italic></sub>denotes the number of probes in segment <italic>I</italic>. Note that the first term in (4) does not depend on the segmentation <italic>S</italic>, hence minimization of (3) is equivalent to minimizing </p>
      <p>
        <disp-formula id="bmcM5">
          <label>(5)</label>
          <mml:math id="M16" name="1471-2164-13-591-i16" overflow="scroll">
            <mml:msup>
              <mml:mrow>
                <mml:mi>L</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>′</mml:mi>
              </mml:mrow>
            </mml:msup>
            <mml:mo>(</mml:mo>
            <mml:mi>S</mml:mi>
            <mml:mspace width="0.3em"/>
            <mml:mo>|</mml:mo>
            <mml:mspace width="0.3em"/>
            <mml:mi mathvariant="bold">y</mml:mi>
            <mml:mo>,</mml:mo>
            <mml:mi>γ</mml:mi>
            <mml:mo>)</mml:mo>
            <mml:mo>=</mml:mo>
            <mml:mo>−</mml:mo>
            <mml:munder>
              <mml:mrow>
                <mml:mo>∑</mml:mo>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>I</mml:mi>
                <mml:mo>∈</mml:mo>
                <mml:mi>S</mml:mi>
              </mml:mrow>
            </mml:munder>
            <mml:msup>
              <mml:mrow>
                <mml:mo>(</mml:mo>
                <mml:munder>
                  <mml:mrow>
                    <mml:mo>∑</mml:mo>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>j</mml:mi>
                    <mml:mo>∈</mml:mo>
                    <mml:mi>I</mml:mi>
                  </mml:mrow>
                </mml:munder>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>y</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>j</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:mo>)</mml:mo>
              </mml:mrow>
              <mml:mrow>
                <mml:mn>2</mml:mn>
              </mml:mrow>
            </mml:msup>
            <mml:mo>/</mml:mo>
            <mml:msub>
              <mml:mrow>
                <mml:mi>n</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>I</mml:mi>
              </mml:mrow>
            </mml:msub>
            <mml:mo>+</mml:mo>
            <mml:mi>γ</mml:mi>
            <mml:mo>·</mml:mo>
            <mml:mo>|</mml:mo>
            <mml:mi>S</mml:mi>
            <mml:mo>|</mml:mo>
            <mml:mi>.</mml:mi>
          </mml:math>
        </disp-formula>
      </p>
      <p>Naive optimization of the cost function (5) with respect to the segmentation <italic>S</italic> requires examination of every possible division of the probes on a chromosome arm into segments. For large <italic>p</italic>, this is not practically feasible. However, a much more efficient implementation based on dynamic programming and requiring only <italic>O</italic>(<italic>p</italic><sup>2</sup>) operations is available. Dynamic programming is a method for solving complex problems by breaking them down into simpler subproblems, and specifically for problems where global decisions can be decomposed into a series of nested smaller decision problems. The crucial observation that allows the use of dynamic programming to solve the present segmentation problem is that the optimal segmentations on each side of a breakpoint are mutually independent. This can be used to iteratively build up a solution to the global segmentation problem. Suppose we know the optimal segmentations from the first probe up until the (<italic>k</italic>−1)st probe. Assume furthermore that the optimal segmentation for the <italic>k</italic> first probes contains breakpoints. Then the optimal segmentations from the last of these breakpoints and downwards has already been computed. Thus, by solving the above subproblems iteratively for increasing <italic>k</italic>, each step can utilize the results from the previous steps (see [<xref ref-type="bibr" rid="B24">24</xref>]). More formally, assume that the optimal segmentation of 1…<italic>r</italic> and the corresponding total error <italic>e</italic><sub><italic>r </italic></sub>are known for all probes <italic>r</italic>&lt;<italic>k</italic>. To extend the solution to <italic>r</italic>=<italic>k</italic>, first note that there must be a last segment starting at some index <italic>j</italic>≤<italic>k</italic>. From (5) we find that the cost term associated with that segment is: </p>
      <p>
        <disp-formula>
          <mml:math id="M17" name="1471-2164-13-591-i17" overflow="scroll">
            <mml:mrow>
              <mml:msubsup>
                <mml:mrow>
                  <mml:mi>d</mml:mi>
                </mml:mrow>
                <mml:mrow>
                  <mml:mi>j</mml:mi>
                </mml:mrow>
                <mml:mrow>
                  <mml:mi>k</mml:mi>
                </mml:mrow>
              </mml:msubsup>
              <mml:mo>=</mml:mo>
              <mml:mfrac>
                <mml:mrow>
                  <mml:mn>1</mml:mn>
                </mml:mrow>
                <mml:mrow>
                  <mml:mi>j</mml:mi>
                  <mml:mo>−</mml:mo>
                  <mml:mi>k</mml:mi>
                  <mml:mo>−</mml:mo>
                  <mml:mn>1</mml:mn>
                </mml:mrow>
              </mml:mfrac>
              <mml:msup>
                <mml:mrow>
                  <mml:mfenced open="(" close=")">
                    <mml:mrow>
                      <mml:munderover accentunder="false" accent="false">
                        <mml:mrow>
                          <mml:mo>∑</mml:mo>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>r</mml:mi>
                          <mml:mo>=</mml:mo>
                          <mml:mi>j</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>k</mml:mi>
                        </mml:mrow>
                      </mml:munderover>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi>y</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>r</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                    </mml:mrow>
                  </mml:mfenced>
                </mml:mrow>
                <mml:mrow>
                  <mml:mn>2</mml:mn>
                </mml:mrow>
              </mml:msup>
              <mml:mi>.</mml:mi>
            </mml:mrow>
          </mml:math>
        </disp-formula>
      </p>
      <p>Then the total error for the optimal solution up until index <italic>k</italic> is found by minimizing the cost over the possible start positions <italic>j</italic> of the last segment. This cost consists of three terms: the cost of the last segment (<inline-formula><mml:math id="M18" name="1471-2164-13-591-i18" overflow="scroll"><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula>), the optimal cost of the segmentation up until that point (<italic>e</italic><sub><italic>j</italic>−1</sub>) and the penalty for the break point (<italic>γ</italic>): </p>
      <p>
        <disp-formula>
          <mml:math id="M19" name="1471-2164-13-591-i19" overflow="scroll">
            <mml:mrow>
              <mml:msub>
                <mml:mrow>
                  <mml:mi>e</mml:mi>
                </mml:mrow>
                <mml:mrow>
                  <mml:mi>k</mml:mi>
                </mml:mrow>
              </mml:msub>
              <mml:mo>=</mml:mo>
              <mml:munder>
                <mml:mrow>
                  <mml:mo>min</mml:mo>
                </mml:mrow>
                <mml:mrow>
                  <mml:mi>j</mml:mi>
                  <mml:mo>∈</mml:mo>
                  <mml:mo>{</mml:mo>
                  <mml:mn>1</mml:mn>
                  <mml:mo>,</mml:mo>
                  <mml:mo>…</mml:mo>
                  <mml:mo>,</mml:mo>
                  <mml:mi>k</mml:mi>
                  <mml:mo>}</mml:mo>
                </mml:mrow>
              </mml:munder>
              <mml:mo>(</mml:mo>
              <mml:msubsup>
                <mml:mrow>
                  <mml:mi>d</mml:mi>
                </mml:mrow>
                <mml:mrow>
                  <mml:mi>j</mml:mi>
                </mml:mrow>
                <mml:mrow>
                  <mml:mi>k</mml:mi>
                </mml:mrow>
              </mml:msubsup>
              <mml:mo>+</mml:mo>
              <mml:msub>
                <mml:mrow>
                  <mml:mi>e</mml:mi>
                </mml:mrow>
                <mml:mrow>
                  <mml:mi>j</mml:mi>
                  <mml:mo>−</mml:mo>
                  <mml:mn>1</mml:mn>
                </mml:mrow>
              </mml:msub>
              <mml:mo>+</mml:mo>
              <mml:mi>γ</mml:mi>
              <mml:mo>)</mml:mo>
            </mml:mrow>
          </mml:math>
        </disp-formula>
      </p>
      <p> where <italic>e</italic><sub>0</sub>=0. The main work load of the above computation is to determine <inline-formula><mml:math id="M20" name="1471-2164-13-591-i20" overflow="scroll"><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula> for all 1≤<italic>j</italic>≤<italic>k</italic>≤<italic>p</italic>. In interpreted languages (such as R) where loop execution is often quite inefficient, a considerable improvement of performance may be obtained by utilizing native-language vector operations. Let <inline-formula><mml:math id="M21" name="1471-2164-13-591-i21" overflow="scroll"><mml:msubsup><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:munderover><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="M22" name="1471-2164-13-591-i22" overflow="scroll"><mml:msub><mml:mrow><mml:mi mathvariant="bold">a</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo>(</mml:mo><mml:msubsup><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msubsup><mml:mo>)</mml:mo></mml:math></inline-formula> and <inline-formula><mml:math id="M23" name="1471-2164-13-591-i23" overflow="scroll"><mml:msub><mml:mrow><mml:mi mathvariant="bold">d</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo>(</mml:mo><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msubsup><mml:mo>)</mml:mo></mml:math></inline-formula>. Then we may calculate all required coefficients through a simple recursion: </p>
      <p>
        <disp-formula>
          <mml:math id="M24" name="1471-2164-13-591-i24" overflow="scroll">
            <mml:mtable class="align" columnalign="left">
              <mml:mtr>
                <mml:mtd class="align-1">
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi mathvariant="bold">a</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>k</mml:mi>
                    </mml:mrow>
                  </mml:msub>
                </mml:mtd>
                <mml:mtd class="align-2">
                  <mml:mo>=</mml:mo>
                  <mml:mo>[</mml:mo>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi mathvariant="bold">a</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>k</mml:mi>
                      <mml:mo>−</mml:mo>
                      <mml:mn>1</mml:mn>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mspace width="2.77695pt"/>
                  <mml:mspace width="2.77695pt"/>
                  <mml:mn>0</mml:mn>
                  <mml:mo>]</mml:mo>
                  <mml:mo>+</mml:mo>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>y</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>k</mml:mi>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mspace width="2em"/>
                </mml:mtd>
                <mml:mtd>
                  <mml:mspace width="2em"/>
                </mml:mtd>
              </mml:mtr>
              <mml:mtr>
                <mml:mtd class="align-1">
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi mathvariant="bold">d</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>k</mml:mi>
                    </mml:mrow>
                  </mml:msub>
                </mml:mtd>
                <mml:mtd class="align-2">
                  <mml:mo>=</mml:mo>
                  <mml:mo>−</mml:mo>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi mathvariant="bold">a</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>k</mml:mi>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mo>∗</mml:mo>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi mathvariant="bold">a</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>k</mml:mi>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mo>/</mml:mo>
                  <mml:mo>(</mml:mo>
                  <mml:mi>k</mml:mi>
                  <mml:mo>:</mml:mo>
                  <mml:mn>1</mml:mn>
                  <mml:mo>)</mml:mo>
                  <mml:mspace width="2em"/>
                </mml:mtd>
                <mml:mtd>
                  <mml:mspace width="2em"/>
                </mml:mtd>
              </mml:mtr>
            </mml:mtable>
          </mml:math>
        </disp-formula>
      </p>
      <p>where (<italic>k</italic>:1)=(<italic>k</italic>,<italic>k</italic>−1,…,1) and operators are vector-based. Hence, addition of a vector and a scalar adds the latter to each component of the former, and multiplications and divisions are performed component-wise on the operands, e.g., <inline-formula><mml:math id="M25" name="1471-2164-13-591-i25" overflow="scroll"><mml:msub><mml:mrow><mml:mi mathvariant="bold">a</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>∗</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">a</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo>[</mml:mo><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:msubsup><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msubsup><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:msubsup><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msubsup><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>]</mml:mo></mml:math></inline-formula>. Algorithm 1 summarizes the computations.</p>
    </sec>
    <sec>
      <title>Algorithm 1: Single sample PCF</title>
      <p><italic>Input:</italic> Log-transformed copy numbers <italic>y</italic><sub>1</sub>,…,<italic>y</italic><sub><italic>p</italic></sub>; penalty <italic>γ</italic>&gt;0.<italic>Output:</italic> Segment start indices <italic>s</italic><sub>1</sub>,…,<italic>s</italic><sub><italic>M </italic></sub>and segment averages <inline-formula><mml:math id="M26" name="1471-2164-13-591-i26" overflow="scroll"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>M</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>. </p>
      <p>1. Calculate scores by letting <bold>a</bold><sub>0</sub>=[ ] and <bold>e</bold><sub>0</sub>=0, and iterate for <italic>k</italic>=1…<italic>p</italic>:</p>
      <p>•
<bold>a</bold><sub><italic>k</italic></sub>=[<bold>a</bold><sub><italic>k</italic>−1</sub> 0] + <italic>y</italic><sub><italic>k</italic></sub></p>
      <p>•
<bold>d</bold><sub><italic>k</italic></sub>=−<bold>a</bold><sub><italic>k</italic></sub>∗<bold>a</bold><sub><italic>k</italic></sub>/(<italic>k</italic>:1)</p>
      <p>•<inline-formula><mml:math id="M27" name="1471-2164-13-591-i27" overflow="scroll"><mml:msub><mml:mrow><mml:mi mathvariant="bold">e</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo>[</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">e</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mspace width="2.77695pt"/><mml:mspace width="2.77695pt"/><mml:mo>min</mml:mo><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">d</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">e</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>γ</mml:mi><mml:mo>)</mml:mo><mml:mo>]</mml:mo></mml:math></inline-formula></p>
      <p>storing also the index <italic>t</italic><sub><italic>k</italic></sub>∈{1,2,…,<italic>k</italic>} at which the minimum in the last step is achieved.</p>
      <p>2. Find segment start indices (right to left) <inline-formula><mml:math id="M28" name="1471-2164-13-591-i28" overflow="scroll"><mml:mfenced><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>M</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced></mml:math></inline-formula>, where <italic>M</italic>≥1.</p>
      <p>3. Find segment averages <inline-formula><mml:math id="M29" name="1471-2164-13-591-i29" overflow="scroll"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mtext>ave</mml:mtext><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>m</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:math></inline-formula> for <italic>m</italic>=1,…,<italic>M</italic>, where <italic>s</italic><sub>0</sub>=<italic>p</italic> + 1.</p>
      <p>Throughout the paper we will tacitly assume that the penalty for the <italic>i</italic>th sample is <inline-formula><mml:math id="M30" name="1471-2164-13-591-i30" overflow="scroll"><mml:msub><mml:mrow><mml:mi>γ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>γ</mml:mi><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:math></inline-formula>, where <inline-formula><mml:math id="M31" name="1471-2164-13-591-i31" overflow="scroll"><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:math></inline-formula> is the estimated sample specific residual variance. In this way, we avoid scale dependency, and obtain consistent results for samples with equal signal-to-noise ratios. Such rescaling is also done by default in <monospace>copynumber</monospace>. Note that replacing the data <inline-formula><mml:math id="M32" name="1471-2164-13-591-i32" overflow="scroll"><mml:msubsup><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula> for the <italic>i</italic>th sample with <inline-formula><mml:math id="M33" name="1471-2164-13-591-i33" overflow="scroll"><mml:msubsup><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup><mml:mo>/</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> for <italic>j</italic>=1,…,<italic>p</italic>, and rescaling after estimation, has the same effect. In <monospace>copynumber</monospace>, the algorithm has also been extended to allow a constraint on the least number of probes in a segment.</p>
    </sec>
    <sec>
      <title>Multi-sample segmentation</title>
      <p>Detection of very short or very low amplitude segments requires a small penalty <italic>γ</italic>, with low specificity as a potential result. However, when such segments are common to several samples, joint segmentation of multiple samples is an additional mechanism to increase sensitivity. This is a main motivation for introducing multi-sample segmentation methods that impose common breakpoints across all samples. Such methods are potentially useful for discovery of copy number variations (CNVs) and in those instances where the origin of the samples implies that segment boundaries are partly shared. Multi-sample segmentation with high penalty on breakpoints may also be used to obtain low-dimensional descriptions of the data, which may form the basis for defining variables to be used in statistical procedures relating aberration patterns to clinical outcome. In the following, we describe a direct generalization of single sample PCF to handle multiple samples simultaneously, obtaining common breakpoints for all the samples with minimal residual sum of squares for a given number of breakpoints. Suppose copy number measurements <inline-formula><mml:math id="M34" name="1471-2164-13-591-i34" overflow="scroll"><mml:msub><mml:mrow><mml:mi mathvariant="bold">y</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo>(</mml:mo><mml:msubsup><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup><mml:mo>)</mml:mo></mml:math></inline-formula> for samples <italic>i</italic>=1,2,…,<italic>n</italic>are obtained at the same loci in each sample. By direct generalization of the criterion (3), we seek in multi-sample PCF the minimizer of </p>
      <p>
        <disp-formula id="bmcM6">
          <label>(6)</label>
          <mml:math id="M35" name="1471-2164-13-591-i35" overflow="scroll">
            <mml:mi>L</mml:mi>
            <mml:mo>(</mml:mo>
            <mml:mi>S</mml:mi>
            <mml:mspace width="0.3em"/>
            <mml:mo>|</mml:mo>
            <mml:mspace width="0.3em"/>
            <mml:msub>
              <mml:mrow>
                <mml:mi mathvariant="bold">y</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mn>1</mml:mn>
              </mml:mrow>
            </mml:msub>
            <mml:mo>,</mml:mo>
            <mml:mo>…</mml:mo>
            <mml:mo>,</mml:mo>
            <mml:msub>
              <mml:mrow>
                <mml:mi mathvariant="bold">y</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>n</mml:mi>
              </mml:mrow>
            </mml:msub>
            <mml:mo>,</mml:mo>
            <mml:mi>γ</mml:mi>
            <mml:mo>)</mml:mo>
            <mml:mo>=</mml:mo>
            <mml:munderover accentunder="false" accent="false">
              <mml:mrow>
                <mml:mo>∑</mml:mo>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>i</mml:mi>
                <mml:mo>=</mml:mo>
                <mml:mn>1</mml:mn>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>n</mml:mi>
              </mml:mrow>
            </mml:munderover>
            <mml:mi>L</mml:mi>
            <mml:mo>(</mml:mo>
            <mml:mi>S</mml:mi>
            <mml:mspace width="0.3em"/>
            <mml:mo>|</mml:mo>
            <mml:mspace width="0.3em"/>
            <mml:msub>
              <mml:mrow>
                <mml:mi mathvariant="bold">y</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>i</mml:mi>
              </mml:mrow>
            </mml:msub>
            <mml:mo>,</mml:mo>
            <mml:mi>γ</mml:mi>
            <mml:mo>)</mml:mo>
          </mml:math>
        </disp-formula>
      </p>
      <p>where <italic>L</italic>(<italic>S</italic> | <bold>y</bold>,<italic>γ</italic>) is defined as in (3) and <italic>S</italic> is a given segmentation common to all samples.</p>
    </sec>
    <sec>
      <title>Algorithm 2: Multi-sample PCF</title>
      <p><italic>Input:</italic> Log-transformed copy numbers for <italic>n</italic> samples <bold>y</bold><sub>1</sub>,…,<bold>y</bold><sub><italic>p</italic></sub>∈<italic>R</italic><sup><italic>n</italic></sup>; penalty <italic>γ</italic>&gt;0.<italic>Output:</italic> Common segment start indices <italic>s</italic><sub>1</sub>,…,<italic>s</italic><sub><italic>M </italic></sub>and segment averages <inline-formula><mml:math id="M36" name="1471-2164-13-591-i36" overflow="scroll"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold">y</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold">y</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>M</mml:mi></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula>. </p>
      <p>1. Calculate scores by letting <bold>A</bold><sub>0</sub>=[ ] and <bold>e</bold><sub>0</sub>=0, and iterate for <italic>k</italic>=1…<italic>p</italic>:</p>
      <p>•
<bold>A</bold><sub><italic>k</italic></sub>=[<bold>A</bold><sub><italic>k</italic>−1</sub> 0] + <bold>y</bold><sub><italic>k</italic></sub></p>
      <p>•
<inline-formula><mml:math id="M37" name="1471-2164-13-591-i37" overflow="scroll"><mml:msub><mml:mrow><mml:mi mathvariant="bold">d</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:msup><mml:mrow><mml:mn mathvariant="bold">1</mml:mn></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">A</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>∗</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">A</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>/</mml:mo><mml:mo>(</mml:mo><mml:mi>k</mml:mi><mml:mo>:</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:math></inline-formula></p>
      <p>•<inline-formula><mml:math id="M38" name="1471-2164-13-591-i38" overflow="scroll"><mml:msub><mml:mrow><mml:mi mathvariant="bold">e</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo>[</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">e</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mspace width="2.77695pt"/><mml:mspace width="2.77695pt"/><mml:mo>min</mml:mo><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">d</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">e</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>nγ</mml:mi><mml:mo>)</mml:mo><mml:mo>]</mml:mo></mml:math></inline-formula></p>
      <p>storing also the index <italic>t</italic><sub><italic>k</italic></sub>∈{1,2,…,<italic>k</italic>} at which the minimum in the last step is achieved.</p>
      <p>2. Find segment start indices (right to left) <inline-formula><mml:math id="M39" name="1471-2164-13-591-i39" overflow="scroll"><mml:mfenced><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>M</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced></mml:math></inline-formula>, where <italic>M</italic>≥1.</p>
      <p>3. Find segment averages <inline-formula><mml:math id="M40" name="1471-2164-13-591-i40" overflow="scroll"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold">y</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mtext>ave</mml:mtext><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">y</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">y</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>m</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:math></inline-formula> for <italic>m</italic>=1,…,<italic>M</italic>, where <italic>s</italic><sub>0</sub>=<italic>p</italic> + 1.</p>
      <p>The multi-sample PCF algorithm (see Algorithm 2) is in principle quite similar to single sample PCF. However, when updating the solution from <italic>k</italic>−1 to <italic>k</italic>, the sums and sums of squares for the segments must be accumulated and stored separately for each sample. This can still be done iteratively, implying that the computational effort will be approximately equal to carrying out single sample PCF on the same set of samples. Since the noise level may vary between samples, normalisation of the samples prior to segmentation and corresponding rescaling after estimation is advisable. It may also be desirable to scale the samples, e.g. to adjust for different tumor percentages. Thus, prior to running multi-sample PCF, we may replace <bold>y</bold><sup><italic>i</italic></sup> by <inline-formula><mml:math id="M41" name="1471-2164-13-591-i41" overflow="scroll"><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mrow><mml:mi mathvariant="bold">y</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msup><mml:mo>/</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> for <italic>i</italic>=1,…,<italic>n</italic>, where <italic>w</italic><sub><italic>i </italic></sub>are weights and <inline-formula><mml:math id="M42" name="1471-2164-13-591-i42" overflow="scroll"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is an estimate of the SD. In <monospace>copynumber</monospace> normalization is performed by default for multi-sample PCF while further weighting is left as an option for the user.</p>
    </sec>
    <sec>
      <title>Allele-specific segmentation</title>
      <p>The PCF algorithm is easily adapted to variants of the basic segmentation problem discussed above. Here, we consider an adaptation to handle SNP genotype data. We then have for each SNP locus a measurement of (total) copy number (logR) as well as the B allele frequency (BAF). We may also have measurements of copy number only for a number of additional loci. The B allele frequency is a number between 0 and 1 indicating the allelic imbalance of a SNP. For a homozygous locus we have BAF close to 0 or 1, while for a heterozygous locus with an equal number of the two alleles A and B, BAF will be close to 0.5. An imbalance between the number of A’s and B’s results in a BAF value deviating from 0.5. A change in the total number of copies of a segment will alter the logR value, hence result in a level shift in the logR track. Unless the copy number change is balanced with respect to the two alleles, the BAF value will also change. In cases involving multiple copy number events at the same locus, the change may manifest itself only in one of the two tracks. For example, a loss of one copy of A followed by a gain of one copy of B would lead to unchanged logR and changed BAF. The purpose of the allele-specific PCF algorithm is to detect breakpoints for all such events. It fits piecewise constant curves simultaneously to the logR and the BAF data, forcing breakpoints to occur at the same positions in both. We emphasize that the purpose of the allele-specific PCF algorithm is segmentation only and not to make allele-specific copy number calls. However, such calls can be made on the basis of the segmentation described below, and this is done e.g. in the ASCAT algorithm (Allele-Specific Copy number Analysis of Tumors) which estimates allele-specific copy numbers as well as the percentage of cells with aberrant DNA and the tumor ploidy [<xref ref-type="bibr" rid="B26">26</xref>]. Suppose the data are given by (<italic>r</italic><sub><italic>j</italic></sub><italic>b</italic><sub><italic>j</italic></sub>) for <italic>j</italic>=1,…,<italic>p</italic>, where <italic>r</italic><sub><italic>j </italic></sub>denotes the logR value and <italic>b</italic><sub><italic>j </italic></sub>the BAF value at the <italic>j</italic>th locus. For copy number probes, only <italic>r</italic><sub><italic>j </italic></sub>is given and <italic>b</italic><sub><italic>j </italic></sub>will be missing (henceforth coded as NA). For germline homozygous probes, the BAF values are noninformative and should be omitted from the analysis. If the germline genotype is known (e.g. from a matching blood sample), the user should replace the corresponding BAF values by NA. If the genotype is not known, the algorithm will apply a proxy to handle this issue (see below). Prior to segmentation, the allele-specific PCF algorithm performs the following steps: </p>
      <p>The BAF data are mirrored around 0.5 by replacing <italic>b</italic><sub><italic>j</italic></sub>with 1−<italic>b</italic><sub><italic>j</italic></sub>if <italic>b</italic><sub><italic>j</italic></sub>&gt;0.5.</p>
      <p>BAF values <italic>b</italic><sub><italic>j</italic></sub>&lt;<italic>θ</italic>are replaced by NA. By default <italic>θ</italic>=0.1. If germline homozygous probes have previously been replaced by NA’s, let <italic>θ</italic>=0.</p>
      <p>Let <inline-formula><mml:math id="M43" name="1471-2164-13-591-i43" overflow="scroll"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> denote the nonmissing B allele frequencies. Corresponding copy number values <inline-formula><mml:math id="M44" name="1471-2164-13-591-i44" overflow="scroll"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> are found by pairing each logR probe with the nearest B-allele probe (ignoring those with missing values) and then averaging logR values paired to the same B-allele probe. Finally, let <inline-formula><mml:math id="M45" name="1471-2164-13-591-i45" overflow="scroll"><mml:msub><mml:mrow><mml:mi mathvariant="bold">y</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:math></inline-formula> and <inline-formula><mml:math id="M46" name="1471-2164-13-591-i46" overflow="scroll"><mml:msub><mml:mrow><mml:mi mathvariant="bold">y</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:math></inline-formula>.</p>
      <p>The remaining part of the allele-specific PCF algorithm is then essentially an adaptation of the multi-sample PCF algorithm applied to two samples. It finds a common segmentation <italic>S</italic> for the two tracks by minimizing the penalized criterion </p>
      <p>
        <disp-formula id="bmcM7">
          <label>(7)</label>
          <mml:math id="M47" name="1471-2164-13-591-i47" overflow="scroll">
            <mml:mi>L</mml:mi>
            <mml:mo>(</mml:mo>
            <mml:mi>S</mml:mi>
            <mml:mspace width="0.3em"/>
            <mml:mo>|</mml:mo>
            <mml:mspace width="0.3em"/>
            <mml:msub>
              <mml:mrow>
                <mml:mi mathvariant="bold">y</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mn>1</mml:mn>
              </mml:mrow>
            </mml:msub>
            <mml:mo>,</mml:mo>
            <mml:msub>
              <mml:mrow>
                <mml:mi mathvariant="bold">y</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mn>2</mml:mn>
              </mml:mrow>
            </mml:msub>
            <mml:mo>,</mml:mo>
            <mml:mi>γ</mml:mi>
            <mml:mo>)</mml:mo>
            <mml:mo>=</mml:mo>
            <mml:mi>L</mml:mi>
            <mml:mo>(</mml:mo>
            <mml:mi>S</mml:mi>
            <mml:mspace width="0.3em"/>
            <mml:mo>|</mml:mo>
            <mml:mspace width="0.3em"/>
            <mml:msub>
              <mml:mrow>
                <mml:mi mathvariant="bold">y</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mn>1</mml:mn>
              </mml:mrow>
            </mml:msub>
            <mml:mo>,</mml:mo>
            <mml:mi>γ</mml:mi>
            <mml:mo>)</mml:mo>
            <mml:mo>+</mml:mo>
            <mml:mi>L</mml:mi>
            <mml:mo>(</mml:mo>
            <mml:mi>S</mml:mi>
            <mml:mspace width="0.3em"/>
            <mml:mo>|</mml:mo>
            <mml:mspace width="0.3em"/>
            <mml:msub>
              <mml:mrow>
                <mml:mi mathvariant="bold">y</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mn>2</mml:mn>
              </mml:mrow>
            </mml:msub>
            <mml:mo>,</mml:mo>
            <mml:mi>γ</mml:mi>
            <mml:mo>)</mml:mo>
          </mml:math>
        </disp-formula>
      </p>
      <p>where <italic>L</italic>(<italic>S</italic> | ·,<italic>γ</italic>) is defined as in (3).</p>
    </sec>
    <sec>
      <title>Fast implementations of PCF</title>
      <p>The PCF algorithms may be generalized to allow breakpoints only at certain prespecified positions. Combined with simple heuristics, this may be used to further enhance the computational speed of PCF. For brevity we describe only the single sample segmentation case here; however the <monospace>copynumber</monospace> package contains fast implementations of both single- and multi-sample PCF. Computationally inexpensive methods can be used to identify a set of potential breakpoints among which the breakpoints of the solution to (3) are highly likely to be found. Suppose we restrict our attention to such a set of potential breakpoints. All relevant information for solving the optimization problem in (3) may then be condensed into three arrays containing the number of observations between two potential breakpoints, the corresponding sum of the observations and the sum of squares. Based on these quantities, PCF may be used with straightforward modifications. Since the algorithm is of order <italic>O</italic>(<italic>q</italic><sup>2</sup>), where <italic>q</italic> is the number of potential breakpoints, the potential increase in speed is substantial. Algorithm 3 outlines the procedure, while possible heuristics for finding potential breakpoints are discussed below. One way to identify potential breakpoints is to use high-pass filters, i.e. a filter obtaining high absolute values when passing over a breakpoint. The simplest such filter uses for each position <italic>i</italic> the difference <inline-formula><mml:math id="M48" name="1471-2164-13-591-i48" overflow="scroll"><mml:munderover><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mspace width="0.3em"/><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:munderover><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mi>i</mml:mi><mml:mspace width="0.3em"/><mml:mo>−</mml:mo><mml:mspace width="0.3em"/><mml:mi>k</mml:mi><mml:mspace width="0.3em"/><mml:mo>+</mml:mo><mml:mspace width="0.3em"/><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> for some <italic>k</italic>. To reduce artifacts due to the abrupt edges of such a filter, the <monospace>copynumber</monospace> implementation assigns half weight to the outer 1/3 of the observations on each side. Fast implementations of such filters in R may be obtained using the <monospace>cumsum</monospace> function. We currently use two filters with k=3 and 12, respectively; additionally the single sample PCF implementation includes a filter searching for aberrations of length equal to the lowest accepted one. These filters together identify about 15% of the probe positions as potential breakpoints. An additional way to speed up the computations on long sequences is to initially divide the sequence into overlapping subsequences, and iteratively find the solution.</p>
      <p>Having found the solution for the <italic>m</italic> first subsequences, we use high-pass filters to detect potential breakpoints for subsequence <italic>m</italic> + 1, and then use the fast PCF algorithm with the latter potential breakpoints as well as those found by PCF on earlier subsequences. The intention behind this iterative approach is to reduce potential boundary effects. Due to the quadratic order of the algorithm, this division into subsequences implies a substantial efficiency gain. In <monospace>copynumber</monospace>, subsequences are used when the chromosomal arm length exceeds 15000 probes, with subsequences of length 5000 and overlap 1000.</p>
    </sec>
    <sec>
      <title>Algorithm 3: Fast PCF</title>
      <p><italic>Input:</italic> Log-transformed copy numbers <italic>y</italic><sub>1</sub>,…,<italic>y</italic><sub><italic>p</italic></sub>; penalty <italic>γ</italic>&gt;0.<italic>Output:</italic> Segment start indices <italic>s</italic><sub>1</sub>,…,<italic>s</italic><sub><italic>M </italic></sub>and segment averages <inline-formula><mml:math id="M49" name="1471-2164-13-591-i49" overflow="scroll"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>M</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>. </p>
      <p>1. Apply heuristics to find potential breakpoints <italic>r</italic><sub>0</sub>,<italic>r</italic><sub>1</sub>,…,<italic>r</italic><sub><italic>q</italic></sub>, where <italic>r</italic><sub>0</sub>=1 and <italic>r</italic><sub><italic>q</italic></sub>=<italic>p</italic> + 1.</p>
      <p>2. Form aggregates by letting <inline-formula><mml:math id="M50" name="1471-2164-13-591-i50" overflow="scroll"><mml:msub><mml:mrow><mml:mi>u</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:munderover><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, where <italic>k</italic>=1,…,<italic>q</italic>.</p>
      <p>3. Calculate scores by letting <bold>a</bold><sub>0</sub>=[ ], <bold>c</bold><sub>0</sub>=[ ], <bold>e</bold><sub>0</sub>=0, and iterate for <italic>k</italic>=1,…,<italic>q</italic>:</p>
      <p>•
<bold>a</bold><sub><italic>k</italic></sub>=[<bold>a</bold><sub><italic>k</italic>−1</sub> 0] + <italic>u</italic><sub><italic>k</italic></sub></p>
      <p>•
<bold>c</bold><sub><italic>k</italic></sub>=[<bold>c</bold><sub><italic>k</italic>−1</sub> 0] + <italic>r</italic><sub><italic>k</italic></sub>−<italic>r</italic><sub><italic>k</italic>−1</sub></p>
      <p>•
<bold>d</bold><sub><italic>k</italic></sub>=−<bold>a</bold><sub><italic>k</italic></sub>∗<bold>a</bold><sub><italic>k</italic></sub>/<bold>c</bold><sub><italic>k</italic></sub></p>
      <p>•
<inline-formula><mml:math id="M51" name="1471-2164-13-591-i51" overflow="scroll"><mml:msub><mml:mrow><mml:mi mathvariant="bold">e</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo>[</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">e</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mspace width="2.77695pt"/><mml:mspace width="2.77695pt"/><mml:mo>min</mml:mo><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">d</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">e</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>γ</mml:mi><mml:mo>)</mml:mo><mml:mo>]</mml:mo></mml:math></inline-formula></p>
      <p>storing also the index <italic>t</italic><sub><italic>k</italic></sub>∈{1,2,…,<italic>k</italic>} at which the minimum in the last step is achieved.</p>
      <p>4. Find segment start indices (right to left) <inline-formula><mml:math id="M52" name="1471-2164-13-591-i52" overflow="scroll"><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>q</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>M</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:math></inline-formula>, where <italic>M</italic>≥1.</p>
      <p>5. Find segment averages <inline-formula><mml:math id="M53" name="1471-2164-13-591-i53" overflow="scroll"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mtext>ave</mml:mtext><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>m</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:math></inline-formula> for <italic>m</italic>=1,…,<italic>M</italic>, where <italic>s</italic><sub>0</sub>=<italic>p</italic> + 1.</p>
    </sec>
  </sec>
  <sec>
    <title>Results and discussion</title>
    <sec>
      <title>Selection of penalty</title>
      <p>The selection of parameters determining the trade-off between high sensitivity (i.e. few missed true aberrations) and high specificity (i.e. few false aberrations) is important in all segmentation procedures. In PCF, this is controlled by the single penalty parameter <italic>γ</italic>. A number of general model selection criteria exist, such as Cross-Validation, the Akaike Information Criterion (AIC) and the related Schwarz’s Bayesian Information Criterion (BIC). However, model selection for copy number segmentation is complicated by several factors. First, the distribution of the data at hand may vary substantially. An important example is the presence of local trends mimicking smaller aberrations; such low-amplitude “waves” in the data may e.g. be due to variations in GC-content (see, e.g., [<xref ref-type="bibr" rid="B9">9</xref>]). Second, the purpose of the analysis may favor either higher sensitivity or higher specificity. For example, in clinical studies aimed at finding prognostic markers, the main focus may be on the most pronounced and commonly occurring deviations, while detecting more sporadic aberrations may simply increase the noise level. In our experience, the above model selection criteria tend to give too small penalty estimates and thus undersmooth the data. This is consistent with previous investigations showing that AIC and BIC are not appropriate for the breakpoint problem (for details and discussions of other alternatives, see [<xref ref-type="bibr" rid="B6">6</xref>,<xref ref-type="bibr" rid="B27">27</xref>]). Simulation studies of specificity may suggest a lower bound on the penalty <italic>γ</italic>. For this purpose, sequences of independent and normally distributed observations without underlying aberrations were generated, and PCF was applied with different choices of <italic>γ</italic>. At <italic>γ</italic>=12 the number of falsely called aberrations is about 0.5 per 10.000 probes, at <italic>γ</italic>=10 roughly 2 per 10.000 probes, at <italic>γ</italic>=8 roughly 10 per 10.000 probes, and for <italic>γ</italic>≤6 the number of falsely called aberrations is substantial. This suggests <italic>γ</italic>≈8−12 as a lower bound. Since the number of false aberrations per chromosome increases with increasing probe density, low values are most relevant for arrays with low probe density. In the presence of local trends, the number of false calls tends to inflate and the penalty should thus be increased above the lower bound. A fairly conservative penalty of <italic>γ</italic>=40 is the default in the <monospace>copynumber</monospace> package. This provides a starting point for exploration of the best penalty value for the specific problem at hand, however a systematic inspection of results obtained for different penalties is advisable. Figure <xref ref-type="fig" rid="F2">2</xref> illustrates the effect of changing <italic>γ</italic>. Notice that the main features in the data are captured across the whole range of <italic>γ</italic>-values, while finer details are only evident for smaller values.</p>
      <fig id="F2" position="float">
        <label>Figure 2</label>
        <caption>
          <p><bold>The effect of changing the penalty </bold><bold><italic>γ </italic></bold><bold>in PCF.</bold> The plot in the upper left corner shows the copy number data for a selected chromosome (in this case, chromosome 17), while the lower right plot shows the number of segments found by PCF as a function of <italic>γ</italic>. The remaining plots show the segmentation curves for ten different values of <italic>γ</italic>. The plot was created with the function <monospace>plotGamma</monospace> in <monospace>copynumber</monospace>.</p>
        </caption>
        <graphic xlink:href="1471-2164-13-591-2"/>
      </fig>
    </sec>
    <sec>
      <title>Aberration calling</title>
      <p>Aberration calling is used for detection of recurring alterations and in many other analyses. Introducing a parameter <italic>θ</italic>&gt;0 that determines the sensitivity of the aberration calling (and hence what to consider as biologically significant aberrations), we call probes for which <inline-formula><mml:math id="M54" name="1471-2164-13-591-i54" overflow="scroll"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>&lt;</mml:mo><mml:mo>−</mml:mo><mml:mi>θ</mml:mi></mml:math></inline-formula> as losses and probes for which <inline-formula><mml:math id="M55" name="1471-2164-13-591-i55" overflow="scroll"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>&gt;</mml:mo><mml:mi>θ</mml:mi></mml:math></inline-formula> as gains. Optionally, different thresholds <italic>θ</italic><sub> + </sub>and <italic>θ</italic><sub>−</sub> may be used for gains and losses. To examine how well PCF aberration calling manages to distinguish between normal and aberrant regions, performance was compared with a very accurate measurement method. Specifically, aberration calls obtained with PCF on the basis of 1.8M SNP array data on 40 samples were compared with calls obtained with MLPA (Multiplex Ligation-dependent Probe Amplification; see Additional file <xref ref-type="supplementary-material" rid="S2">2</xref> for details). Since MLPA is limited to a small set of genomic positions, only 88 loci were used for the comparison. In all samples combined, MLPA identified 546 aberrant and 2542 normal loci (the remaining 432 loci were ambiguous or unclassified and left out of the analysis). Using the MLPA-classification as the gold standard, the sensitivity and specificity of PCF aberration calling were calculated for a range of threshold values <italic>θ</italic>. Figure <xref ref-type="fig" rid="F3">3</xref> shows the resulting ROC curves, and panel (a) illustrates how the results for PCF depend on the choice of <italic>γ</italic>. Importantly, aberration calling appears to be only moderately dependent on the choice of parameter values over a fairly wide range of <italic>γ</italic>-values.</p>
      <fig id="F3" position="float">
        <label>Figure 3</label>
        <caption>
          <p><bold>Aberration calling accuracy.</bold> The ROC-curves show the sensitivity and specificity for a sequence of thresholds as calculated by comparing aberration calls to the classifications made in a MLPA-analysis on the same data material. In panel <bold>(a)</bold>, classifications were made based on PCF segmentations found for a wide range of <italic>γ</italic>-values. Notably, the classification accuracy is not affected much by the choice of <italic>γ</italic>, except to some extent for very low values. Panel <bold>(b)</bold> shows that aberration calls based on multi-sample PCF segmentations are about as accurate as those based on single sample PCF. In panel <bold>(c)</bold>, ROC-curves are shown for calls made on the basis of the segmentations found by PCF and CBS, a running median with window size 50 and raw data. In terms of aberration calling accuracy, PCF and CBS give nearly the same results, while using the running median gives slightly less accurate classifications. Using only raw data leads to much poorer accuracy. Note the range on the ordinate axis.</p>
        </caption>
        <graphic xlink:href="1471-2164-13-591-3"/>
      </fig>
    </sec>
    <sec>
      <title>Single- versus multi-sample segmentation</title>
      <p>Whether the initial segmentation of a dataset is most appropriately done using single- or multi-sample methods depends both on the purpose and the data. Using methods with common breakpoints for samples will increase the power for detecting concordant but quantitatively weak segments, while it will reduce the ability of detecting (or correctly positioning) discrepant breakpoints. A well known example of aberrations with common boundaries is germline copy number variants (CNVs), thus some proposed algorithms for CNV detection utilize segmentation with joint segment borders (e.g. [<xref ref-type="bibr" rid="B21">21</xref>]). Another important example of samples with (partially) common segment boundaries arises when the samples originate from different clones of the same (early) tumor. This is illustrated below in two examples, one on disseminated tumor cells from breast carcinomas, the other on tumor clones found at successive biopsies from lymphoma patients. Recent reports [<xref ref-type="bibr" rid="B28">28</xref>] on marked variations in aberration patterns within the same tumor is likely to increase the number of studies using several samples taken from each tumor. What is common as well as what differs in the aberration patterns will then be of interest, motivating the combined use of single- and multi-sample methods. In applications searching for genomic copy number <italic>hot spots</italic> with relevance to cancer development, it may be important to utilize the precise delineation of the aberrations found in each sample, and thus the use of single-sample methods is most appropriate. The identification of the relevant recurrent aberrations may then utilize post processing tools like GISTIC [<xref ref-type="bibr" rid="B29">29</xref>], KCsmart [<xref ref-type="bibr" rid="B30">30</xref>] or cghMCR [<xref ref-type="bibr" rid="B31">31</xref>] (see also the review in Rueda [<xref ref-type="bibr" rid="B18">18</xref>]). If focus is on clustering samples or on constructing regression variables for relating more broad aberrations to clinical outcome, one may consider using multi-sample methods. However, to be useful, the estimates from the multi-sample methods should in a proper way reflect the main information content in each sample. This implies that a multi-sample analysis should result in estimates approximating those obtained from single-sample analyses. Figure <xref ref-type="fig" rid="F4">4</xref> shows heatmaps of results from single- and multi-sample PCF for 49 breast cancers from the so-called MicMa data set (see [<xref ref-type="bibr" rid="B32">32</xref>] and Additional file <xref ref-type="supplementary-material" rid="S2">2</xref>) analyzed on 244K Agilent arrays. The main features appear to be well reflected in the multi-sample analysis. On a more detailed level, differences can be observed: the multi-sample solution misses some short aberrations occurring in only a few samples, aberration borders are sometimes slightly shifted, and longer segments obtained with single sample PCF are often divided into subsegments with slightly different copy number estimates. The moderate difference between the results of single- and multi-sample PCF was also confirmed by a comparison of the ability to detect specific aberrations as revealed by comparison to MLPA analyses, see Figure <xref ref-type="fig" rid="F3">3</xref>b. This indicates that at least for cancer types where aberrations are focused in certain areas of the genome, methods using joint boundaries might be considered for constructing variables to be used in further statistical analysis.</p>
      <fig id="F4" position="float">
        <label>Figure 4</label>
        <caption>
          <p><bold>Comparison of results from single sample and multi-sample PCF.</bold> In single sample PCF, <italic>γ</italic>=40 was used, while in multi-sample PCF, <italic>γ</italic>=120 was used to limit the number of segments. Note that the estimated aberration patterns are quite similar; indicating that the multi-sample PCF estimates (panel <bold>b</bold>) should be well suited as variables in statistical analyses. On a more detailed level there are differences, e.g., longer segments in the single sample analysis (panel <bold>a</bold>) are divided into subsegments with slightly different estimates in the multi-sample analysis. The plot was created with the function <monospace>plotHeatmap</monospace> in <monospace>copynumber</monospace>.</p>
        </caption>
        <graphic xlink:href="1471-2164-13-591-4"/>
      </fig>
    </sec>
    <sec>
      <title>Comparing tracks: Analysis of disseminated tumor cells</title>
      <p>Disseminated tumor cells (DTCs) are detected in the bone marrow of some patients with breast carcinomas. The presence of DTCs in the bone marrow identifies patients with less favorable outcome (see, e.g., [<xref ref-type="bibr" rid="B33">33</xref>]), and genomic characterization of such cells is of substantial interest. It is still an open question to what extent the aberration patterns in DTCs correspond to those found in the primary tumor; the DTCs may potentially have obtained new aberrations or, alternatively, the cells may have originated from (early) subclones of the tumor with less aberrations. It is possible to analyze single cells using aCGH; however, currently the noise level is high, making it difficult to draw definitive conclusions from a single cell. However, since segment boundaries are assumed to be partly common, we tested the multi-sample PCF algorithm on breast cancer cases from which DTCs were available (cf. [<xref ref-type="bibr" rid="B32">32</xref>] and GEO accession number GSE27574). Figure <xref ref-type="fig" rid="F5">5</xref> shows the results on a set of DTCs and the corresponding primary tumor from one such patient. Since multi-sample PCF is used, segment boundaries are common, while the estimated level in each segment is determined by the individual DTC/primary tumor. In Figure <xref ref-type="fig" rid="F5">5</xref>, two of the single cells seem to have a pattern similar to the primary tumor. The last one has an essentially flat (balanced) profile and is likely to be a hematopoietic cell misclassified as a tumor cell (separation of DTCs from other cells is often difficult). These data thus indicate that the aberration pattern of the DTCs quite closely reflect that of the primary tumor. With only two single cells present, Figure <xref ref-type="fig" rid="F5">5</xref> primarily shows that DTCs inherit the aberrations of the primary tumor; with higher numbers of cells, multi-sample PCF may also be used to search for aberrations found in DTCs but not in the tumor.</p>
      <fig id="F5" position="float">
        <label>Figure 5</label>
        <caption>
          <p><bold>Analysis of disseminated tumor cells (DTCs) with multi-sample PCF.</bold> The top panel shows the primary tumor and the three panels below show single cells morphologically classified as DTCs (all for chromosome 2). High noise levels make separate analyses of each DTC difficult; co-analyzing multiple DTCs, possibly together with a primary tumor, thus facilitates an evaluation of the degree of correspondence between the aberration patterns. In the present case, two DTCs seem to have aberration patterns similar to the primary tumor, while the last cell has an essentially flat (balanced) pattern and is probably a hematopoietic cell misclassified as a DTC. The plot was created with the function <monospace>plotChrom</monospace> in <monospace>copynumber</monospace>.</p>
        </caption>
        <graphic xlink:href="1471-2164-13-591-5"/>
      </fig>
    </sec>
    <sec>
      <title>Defining variables: Genetic evolution in follicular lymphoma</title>
      <p>Follicular lymphoma is normally a slowly progressing malignancy, but relapses are common and the disease is usually fatal. In a recent study, 100 biopsies from 44 patients diagnosed with follicular lymphoma were evaluated using a custom-made aCGH platform consisting of 3k BAC/PAC probes [<xref ref-type="bibr" rid="B34">34</xref>]. A whole-genome view of aberration frequencies (based on single sample PCF) and highly correlated aberrations (based on multi-sample PCF) are shown in Figure <xref ref-type="fig" rid="F6">6</xref>.</p>
      <fig id="F6" position="float">
        <label>Figure 6</label>
        <caption>
          <p><bold>Whole-genome view of aberrations in the follicular lymphoma data.</bold> The plot is based on all 100 biopsies, and aberrations were defined as copy number estimates above 0.05 (for gains) or below -0.05 (for losses). Aberration frequencies are shown in red for gains and green for losses. Correlations between the copy number activity at different genomic locations are shown as arcs (blue for positive correlations and yellow for negative correlations), using a correlation threshold of ±0.68 to determine which correlations to display. Aberration frequencies are based on the segmentation found with single sample PCF (with <italic>γ</italic>=16 and <italic>kmin</italic>=3), while correlations are based on the segmentation found with multi-sample PCF (with <italic>γ</italic>=6). The plot was created with the function <monospace>plotCircle</monospace> in <monospace>copynumber</monospace>.</p>
        </caption>
        <graphic xlink:href="1471-2164-13-591-6"/>
      </fig>
      <p>Although the delineation of segments varied between biopsies, several areas with a high frequency of aberrations could be detected. To try to identify aberrations with prognostic potential, we therefore found a common segmentation for the initial biopsies taken from each of the 44 patients using the multi-sample PCF algorithm. Removing very low variance segments, 93 segments remained. The corresponding copy number estimates were used as covariates in a multivariate Cox proportional hazards regression. This revealed 11 segments for which gains were significantly associated with a survival disadvantage. A particularly strong association was detected for gains on chromosome X in male patients. To study the relation between successive biopsies taken from the same patient, multi-sample PCF was applied to each patient individually (see Additional file <xref ref-type="supplementary-material" rid="S2">2</xref>). As expected, many aberrations are common, but interestingly, some aberrations are present in early biopsies and not in later ones. This contradicts the hypothesis of linear development which states that late tumor clones arise from earlier ones, and supports the alternative hypothesis of parallel evolution in different lymph nodes.</p>
    </sec>
    <sec>
      <title>Allele-specific copy number analysis in breast cancer</title>
      <p>Copy number alterations have been extensively studied in breast cancer. To what degree gains and losses are associated only with certain alleles has been less studied. In a recent study, genotyping of 112 breast carcinoma samples was performed using Illumina 109K SNP arrays, and the ASCAT method was used to infer the allele-specific copy numbers at each locus [<xref ref-type="bibr" rid="B26">26</xref>]. However, to do this we first had to segment the data; for this purpose we applied allele-specific PCF segmentation to all samples. In Figure <xref ref-type="fig" rid="F7">7</xref>, the result of this segmentation is shown for one particular sample and two different chromosomes. In Figure <xref ref-type="fig" rid="F7">7</xref>a, the segmentation of chromosome 1 is shown, and we clearly identify three segments on the p-arm with copy numbers less than two, larger than two, and identical to two (we assume here that tumor ploidy is 2). Suppose we consider only germline heterozygous loci, in which case the allelic ratio is 1/2 when no aberrations are present (one copy of B and two copies in total). The BAF track reveals allelic imbalance in the first two segments, and more pronounced in the first segment than in the second. This is consistent with a loss of one copy in the first segment (i.e. a hemizygous loss, resulting in an allelic ratio of 0/1 or 1/1 depending on whether the A-allele or the B allele is lost), and a gain of one copy in the second segment (resulting in an allelic ratio of 1/3 or 2/3 depending on which allele is gained). The third segment has an allelic ratio of 1/2. Notice that in case of allelic imbalance, the observed allele ratio is substantially closer to 0.5 than expected by the above theoretical ratios. This attenuation of the signal (which also affects the logR values) is due to technical issues like cross-hybridization, as well as the fact that in reality the tumor is a mixture of cells with normal DNA (two copies of each locus) and tumor cells with aberrant DNA. In Figure <xref ref-type="fig" rid="F7">7</xref>b we notice a sharp trough in the logR track on 17p, accompanied by an allelic ratio close to 0.5.</p>
      <fig id="F7" position="float">
        <label>Figure 7</label>
        <caption>
          <p><bold>Allele-specific PCF analysis of SNP array data.</bold> Results are shown for a breast carcinoma sample in the MicMa cohort for chromosome 1 (panel <bold>a</bold>) and chromosome 17 (panel <bold>b</bold>). The points in the upper two panels show observed total copy numbers (logR) while the points in the lower two panels show observed B allele frequencies (BAF). The red curves show the result of applying the allele-specific PCF segmentation method to the data. The plot was created with the function <monospace>plotAllele</monospace> in <monospace>copynumber</monospace>.</p>
        </caption>
        <graphic xlink:href="1471-2164-13-591-7"/>
      </fig>
      <p>If for a certain SNP locus one allele is substantially more frequently gained than the other allele, one may hypothesize that the former allele is subject to a larger selective pressure to change copy number. This, in turn, may be an indication of different roles being played by the two alleles with respect to cancer progression and evolution, suggesting that loci subject to allelic skewness can be potential unique markers for breast cancer development. Even from a relatively small number of samples, probes with highly significant allelic skewness have been identified in a genome-wide statistical evaluation [<xref ref-type="bibr" rid="B26">26</xref>].</p>
    </sec>
    <sec>
      <title>Outliers and Winsorization</title>
      <p>While least squares methods are often favored due to their optimality properties, they are also known to be sensitive to extreme observations. Thus, except if the purpose is to search for short aberrations of biological origins (CNVs), we advise the use of an outlier handling procedure. To evaluate the proposed Winsorization scheme, we first established a suitable way of simulating extreme observations. A classical way is to use “contaminated normals”, where the error distribution is a mixture of two normal distributions [<xref ref-type="bibr" rid="B35">35</xref>]. With probability 1−<italic>α</italic> the error is drawn from a distribution <italic>N</italic>(0,<italic>σ</italic><sup>2</sup>), and with probability <italic>α</italic>from <italic>N</italic>(0,<italic>d</italic><sup>2</sup><italic>σ</italic><sup>2</sup>), typically with <italic>d</italic>=3 and <italic>α</italic>=0.05. We compared the fraction of outliers in observed copy number data to the corresponding fractions in normals and contaminated normals, using MAD to estimate SDs. For the normal distribution, the fraction of observations outside 3 SD is 0.27% and outside 5 SD &lt; 0.00001<italic>%</italic>, while these fractions for the 5% contaminated normal are 1.64% and 0.42%. For the Agilent 244K used on the MicMa dataset, the fractions were 1.89% and 0.59%, that is, slightly above the values for the contaminated normal. For the 44K Agilent and Illumina 109K applied to the same data, the percentages were slightly lower (3 SD: 1.41% and 1.18%; for 5 SD 0.29% and 0.11%), however still indicating that the 5% contaminated normal is an appropriate distribution when evaluating robustness of copy number assessment procedures. Inspection of data obtained by the 318K Illumina, 4 x 180K Agilent and Nimblegen 2.1M arrays also confirmed the existence of substantial amounts of outliers. The PCF algorithm was tested with and without Winsorization on simulated data with outliers (Table <xref ref-type="table" rid="T1">1</xref>). Outliers in the contaminated distributions may cause the detection of short false aberrations; such spikes occurred roughly ten times per 1000 probes, as compared to less than two times per 1000 for uncontaminated data. Table <xref ref-type="table" rid="T1">1</xref> further shows that Winsorization efficiently reduces the number of falsely detected aberrations and make results for the contaminated distribution roughly equal to the ones for the normal distribution. In line with these observations, outliers tend to change the form of aberrations (their height and length), while Winsorization brings the distribution fairly close to the one found for normal data (data not shown).</p>
      <table-wrap position="float" id="T1">
        <label>Table 1</label>
        <caption>
          <p>Outlier effects</p>
        </caption>
        <table frame="hsides" rules="groups" border="1">
          <colgroup>
            <col align="left"/>
            <col align="left"/>
            <col align="center"/>
            <col align="center"/>
            <col align="center"/>
          </colgroup>
          <thead valign="top">
            <tr>
              <th align="left">
                <bold>Type</bold>
              </th>
              <th align="left">
                <bold>Distribution</bold>
              </th>
              <th align="center">
                <bold>Sensitivity(%)</bold>
              </th>
              <th align="center">
                <bold>Specificity(%)</bold>
              </th>
              <th align="center">
                <bold>False aberrations (%)</bold>
              </th>
            </tr>
          </thead>
          <tbody valign="top">
            <tr>
              <td align="left" valign="bottom"> <hr/></td>
              <td align="left" valign="bottom">Normal<hr/></td>
              <td align="center" valign="bottom">79.5<hr/></td>
              <td align="center" valign="bottom">96.5<hr/></td>
              <td align="center" valign="bottom">0.15<hr/></td>
            </tr>
            <tr>
              <td align="left" valign="bottom">A<hr/></td>
              <td align="left" valign="bottom">Normal w/5% contam.<hr/></td>
              <td align="center" valign="bottom">78.8<hr/></td>
              <td align="center" valign="bottom">93.7<hr/></td>
              <td align="center" valign="bottom">1.04<hr/></td>
            </tr>
            <tr>
              <td align="left" valign="bottom"> <hr/></td>
              <td align="left" valign="bottom">Normal w/5% contam., Winsor.<hr/></td>
              <td align="center" valign="bottom">78.1<hr/></td>
              <td align="center" valign="bottom">96.0<hr/></td>
              <td align="center" valign="bottom">0.13<hr/></td>
            </tr>
            <tr>
              <td align="left" valign="bottom"> <hr/></td>
              <td align="left" valign="bottom">Normal<hr/></td>
              <td align="center" valign="bottom">78.9<hr/></td>
              <td align="center" valign="bottom">93.6<hr/></td>
              <td align="center" valign="bottom">0.20<hr/></td>
            </tr>
            <tr>
              <td align="left" valign="bottom">B<hr/></td>
              <td align="left" valign="bottom">Normal w/5% contam.<hr/></td>
              <td align="center" valign="bottom">77.8<hr/></td>
              <td align="center" valign="bottom">90.6<hr/></td>
              <td align="center" valign="bottom">1.06<hr/></td>
            </tr>
            <tr>
              <td align="left"> </td>
              <td align="left">Normal w/5% contam., Winsor.</td>
              <td align="center">77.5</td>
              <td align="center">93.3</td>
              <td align="center">0.15</td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <p>Shown is the effect of Winsorization on simulated data with outliers and artificial (low-amplitude) aberrations. Two types of aberrations are considered: (A) aberrations of height 1.5 and length 10 probes and (B) aberrations of height 1.0 and length 30. The contamination consists of normals with SD=3 and the MAD estimate of SD equals 1.0. Sensitivity is the percentage of amplified probes that are detected as amplified, while specificity is the percentage of non-amplified probes classified as such. The false aberration column gives the percentage of aberrations not covering the central part of the real amplifications.</p>
        </table-wrap-foot>
      </table-wrap>
      <p>Another way to avoid that a few extreme observations result in a segment is to impose a lower limit on the length (number of probes) of a segment. With a lower length limit of five probes, we found about twice as many false spikes as with Winsorization when adjusting <italic>γ</italic>to give equal sensitivity for true aberrations. Still, simulations indicate that a lower limit on segment length is valuable in combination with Winsorization. Note that outliers of biological origin will be more extreme if the technology has an inherent low noise level, as is the case, e.g., for BAC arrays and for high throughput sequencing. Thus, outliers are not a sign of inappropriate functioning of a technique, but a characteristic of the data requiring consideration in the analysis. In summary, copy number data tend to contain a high fraction of outliers. These outliers often induce false aberrations, but simple procedures like Winsorization will efficiently reduce these undesired effects.</p>
    </sec>
    <sec>
      <title>Computational performance</title>
      <p>In R, using the vector based PCF implementation described in Algorithm 1 implies a substantial efficiency gain over loop based implementation, roughly a 10-20 times reduction in time requirements. The fast implementation of PCF (Algorithm 3) gives a further marked reduction in computing time. On the MicMa 244k dataset (longest arm ≈10000 probes), the implemented fast version is about 15 times faster than the exact one, and uses around 3.5 minutes to process the 49 samples (4 seconds per sample, see Table <xref ref-type="table" rid="T2">2</xref>). The multi-sample method was slightly faster than the single sample version.</p>
      <table-wrap position="float" id="T2">
        <label>Table 2</label>
        <caption>
          <p>Computational performance</p>
        </caption>
        <table frame="hsides" rules="groups" border="1">
          <colgroup>
            <col align="left"/>
            <col align="left"/>
            <col align="center"/>
            <col align="center"/>
            <col align="center"/>
            <col align="center"/>
          </colgroup>
          <thead valign="top">
            <tr>
              <th align="left" valign="bottom">
                <bold>Method</bold>
                <hr/>
              </th>
              <th align="left" valign="bottom">
                <bold>R package</bold>
                <hr/>
              </th>
              <th colspan="2" align="center" valign="bottom">
                <bold>Agilent 244K</bold>
                <hr/>
              </th>
              <th colspan="2" align="center" valign="bottom">
                <bold>Illumina 1.1M</bold>
                <hr/>
              </th>
            </tr>
            <tr>
              <th align="left"> </th>
              <th align="left"> </th>
              <th align="center">
                <bold>Raw data</bold>
              </th>
              <th align="center">
                <bold>Outliers removed</bold>
              </th>
              <th align="center">
                <bold>Raw data</bold>
              </th>
              <th align="center">
                <bold>Outliers removed</bold>
              </th>
            </tr>
          </thead>
          <tbody valign="top">
            <tr>
              <td align="left" valign="bottom">PCF<hr/></td>
              <td align="left" valign="bottom">copynumber<hr/></td>
              <td align="center" valign="bottom">4 (0.2)<hr/></td>
              <td align="center" valign="bottom">4 (0.2)<hr/></td>
              <td align="center" valign="bottom">23 (0.7)<hr/></td>
              <td align="center" valign="bottom">22 (0.4)<hr/></td>
            </tr>
            <tr>
              <td align="left" valign="bottom">Fused Lasso<hr/></td>
              <td align="left" valign="bottom">cghFLasso<hr/></td>
              <td align="center" valign="bottom">5 (0.2)<hr/></td>
              <td align="center" valign="bottom">5 (0.2)<hr/></td>
              <td align="center" valign="bottom">97 (0.7)<hr/></td>
              <td align="center" valign="bottom">99 (3.3)<hr/></td>
            </tr>
            <tr>
              <td align="left">CBS</td>
              <td align="left">DNAcopy</td>
              <td align="center">15 (4.7)</td>
              <td align="center">35 (4.1)</td>
              <td align="center">71 (12.9)</td>
              <td align="center">219 (12.8)</td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <p>The average computation time (in seconds) per sample is shown for <monospace>copynumber</monospace> (PCF), <monospace>DNAcopy</monospace> v1.30.0 (CBS) and <monospace>cghFLasso</monospace> v0.2-1 (Fused Lasso) on the MicMa 244 K data set (49 samples) and on the logR values from an Illumina 1.1 M SNP array data set (6 samples). The IQR over samples is given in parenthesis. The methods were applied to both raw data and data with outliers removed using the Winsorization method. All tests were performed on a PC with a 2.93GHz Intel i7 CPU with 8 Gb of memory running Windows 7 and R 2.15.1 (64-bit).</p>
        </table-wrap-foot>
      </table-wrap>
      <p>The deviations between the solutions found by the exact PCF and fast PCF on the MicMa set were small; in terms of reduction in variance (difference between sample variance and residual variance after fitting PCF curves) below 0.01%. The differences observed for the curves were typically small shifts in the border of aberrations. Thus, we conclude that the results from the fast procedure for practical purposes may be regarded as global solutions to (3), and the fast version is therefore used by default in <monospace>copynumber</monospace>. We also compared the performance of PCF with two other segmentation methods: Circular Binary Segmentation (CBS) [<xref ref-type="bibr" rid="B4">4</xref>,<xref ref-type="bibr" rid="B36">36</xref>] and Fused Lasso Regression (FL) [<xref ref-type="bibr" rid="B12">12</xref>]. In comparison studies [<xref ref-type="bibr" rid="B5">5</xref>,<xref ref-type="bibr" rid="B8">8</xref>], CBS has shown good performance in terms of sensitivity and false discovery rate. It is probably the most commonly used freely available algorithm and is also implemented in several commercial analysis tools. CBS is available in the R package <monospace>DNAcopy</monospace>, which is used for this comparison. FL is a more recent proposal implemented in the R package <monospace>cghFLasso</monospace>, and is one of three preferred methods in the web-based segmentation tool CGHweb [<xref ref-type="bibr" rid="B37">37</xref>]. Using default parameter settings, we compared the computing times of PCF, CBS and FL on the 49 samples in the 244 K MicMa data set, and on 6 samples from a 1.1 M Illumina SNP array (using the logR values). Table <xref ref-type="table" rid="T2">2</xref> gives the average computation time (in seconds) per sample. With no preprocessing of the data, PCF is on average 3-4 times faster than CBS on both data sets, and about 4 times faster than FL on the largest data set. Note that <monospace>copynumber</monospace> detects and operates on chromosome arms, while <monospace>DNAcopy</monospace> operates on whole chromosomes. This partly explains the difference in performance between PCF and CBS for the MicMa data set; for the Illumina data this has little impact due to the iterative approach used in PCF for the longest sequences. PCF was also markedly faster in evaluations based on simulated data; however, comparisons are complicated by the fact that the speed of CBS depends on the data in a nontrivial manner. As seen from the IQRs listed in parentheses in Table <xref ref-type="table" rid="T2">2</xref>, the speed of CBS is quite variable from sample to sample while PCF and FL is nearly constant. Moreover, the table shows that CBS runs 2-3 times slower when outliers have been removed using Winsorization, underlining that the performance of CBS is highly data dependent. We underline that the above-mentioned results only relate to the current R implementations. As mentioned in the introduction, PCF is conceptually similar to the CGHseg method described by Picard et al.[<xref ref-type="bibr" rid="B6">6</xref>], and we also examined the computational performance of this method using the implementation in the R package <monospace>cghseg</monospace>. Using the version of CGHseg that requires a prespecified number of segments for each chromosome, the algorithm is fast, although the speed depends on the number of segments. Using the full CGHseg algorithm that automatically determines the number of segments, the algorithm is very slow for high-resolution data. Hence, making a fair comparison between PCF and CGHseg is difficult.</p>
    </sec>
    <sec>
      <title>Segmentation accuracy</title>
      <p>We further compare the accuracy of the segmentation solutions found by PCF and CBS. Figure <xref ref-type="fig" rid="F3">3</xref>c shows ROC curves using MLPA classifications as the truth, and then applying a range of aberration calling thresholds to PCF estimates, CBS estimates, a running median with window size 50 and raw copy number data (details in Additional file <xref ref-type="supplementary-material" rid="S2">2</xref>). Results for PCF and CBS are similar, both achieving high sensitivity and specificity. The running median also gives good results, illustrating that many probes are fairly easy to classify and that the gain obtained by using methods like CBS and PCF is mainly an improved classification close to borders between segments. We also repeated the simulation study in [<xref ref-type="bibr" rid="B8">8</xref>] where CBS was found to be the most sensitive method while also having the lowest false discovery rate. Again, we found that PCF and CBS had very similar performance (results not shown). A more detailed comparison of segmentation results shows that overall results are quite similar for single sample PCF and CBS, however for both methods the results depend on the choice of parameter values and the handling of extreme observations, see Additional file <xref ref-type="supplementary-material" rid="S3">3</xref>. In conclusion, PCF and CBS typically provide similar results and have equivalent accuracy when parameters are tuned appropriately.</p>
    </sec>
  </sec>
  <sec sec-type="conclusions">
    <title>Conclusions</title>
    <p>Copy number segmentation based on least squares principles and combined with a suitable penalization scheme is appealing, since the solution will be optimal in a least squares sense for a given number of breakpoints. We have proposed a suite of platform independent algorithms based on this principle for independent as well as joint segmentation of copy number data. The algorithms perform similarly as other leading segmentation methods in terms of sensitivity and specificity. Furthermore, the proposed algorithms are easy to generalize and are computationally very efficient also on high-resolution data. The Bioconductor package <monospace>copynumber</monospace> offers a user-friendly interface to the proposed algorithms.</p>
    <p>Several extensions and modifications of the proposed least-squares framework are possible. In principle, the L2-based distance measure used in the current implementation of PCF is easily extended to general Lp-distances. However the current implementation is highly optimized for L2, and other distance measures would require substantial heuristics to obtain comparable computational performance. Another extension is to introduce locus specific penalties for breakpoints, thus essentially introducing a prior on the location of breakpoints. Work in progress includes specialized routines to handle high throughput sequencing data more efficiently and joint analysis of multiple samples in allele-specific PCF.</p>
  </sec>
  <sec>
    <title>Availability and requirements</title>
    <p><bold>Project name:</bold> Copynumber</p>
    <p>
      <bold>Project home page:</bold>
      <ext-link ext-link-type="uri" xlink:href="http://heim.ifi.uio.no/bioinf/Projects/Copynumber/">http://heim.ifi.uio.no/bioinf/Projects/Copynumber/</ext-link>
    </p>
    <p><bold>Operating system(s):</bold> All systems supporting the R environment</p>
    <p><bold>Programming language:</bold> R</p>
    <p><bold>Other requirements:</bold> No</p>
    <p><bold>License:</bold> GNU Artistic License 2.0.</p>
  </sec>
  <sec>
    <title>Abbreviations</title>
    <p>aCGH: Array Comparative Genomic Hybridization; AIC: Akaike’s Information Criterion. ASCAT: Allele-Specific Copy number Analysis of Tumors; BAC: Bacterial Artificial Chromosome; BAF: B-Allele Frequency; BIC: Schwarz’s Bayesian Information Criterion; CBS: Circular Binary Segmentation; CNV: Copy Number Variation; DTC: Disseminated Tumor Cells; FL: Fused Lasso; HTS: High-Throughput Sequencing; IQR: Interquartile Range; MAD: Median Absolute Deviation; MLPA: Multiplex Ligation-dependent Probe Amplification; PCF: Piecewise Constant Fitting (the method used for segmentation in this paper); ROC: Receiver Operating Characteristic curve; SNP: Single-nucleotide Polymorphism.</p>
  </sec>
  <sec>
    <title>Competing interests</title>
    <p>The authors declare that they have no competing interests.</p>
  </sec>
  <sec>
    <title>Authors’ contributions</title>
    <p>The study was initiated by KL, ALBD and OCL. GN, KL and OCL drafted the manuscript. The software was written by GN with contributions from KL based on algorithms developed by GN, KL and OCL. PVL, HKMV, MBE and LOB contributed with examples and in discussions of the manuscript and software. OMR, SFC, RR and CC provided and analysed the MLPA data. All authors have read, commented on and accepted the final manuscript.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material content-type="local-data" id="S1">
      <caption>
        <title>Additional file 1</title>
        <p>This pdf-file contains a formal description of the iterative PCF-based Winsorization algorithm.</p>
      </caption>
      <media xlink:href="1471-2164-13-591-S1.pdf" mimetype="application" mime-subtype="pdf">
        <caption>
          <p>Click here for file</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="S2">
      <caption>
        <title>Additional file 2</title>
        <p>This pdf-file contains a description of the three data sets used in this paper.</p>
      </caption>
      <media xlink:href="1471-2164-13-591-S2.pdf" mimetype="application" mime-subtype="pdf">
        <caption>
          <p>Click here for file</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="S3">
      <caption>
        <title>Additional file 3</title>
        <p>This pdf-file describes a comparison of segmentations performed by CBS and PCF on a MicMa sample.</p>
      </caption>
      <media xlink:href="1471-2164-13-591-S3.pdf" mimetype="application" mime-subtype="pdf">
        <caption>
          <p>Click here for file</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <sec>
    <title>Acknowledgements</title>
    <p>GN, KL and OCL received funding from the Centre of Cancer Biomedicine (CCB) at the University of Oslo for equipment and travelling. PVL is a postdoctoral researcher of the Research Foundation - Flanders (FWO).</p>
  </sec>
  <ref-list>
    <ref id="B1">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Beroukhim</surname>
          <given-names>R</given-names>
        </name>
        <name>
          <surname>Mermel</surname>
          <given-names>CH</given-names>
        </name>
        <name>
          <surname>Porter</surname>
          <given-names>D</given-names>
        </name>
        <name>
          <surname>Wei</surname>
          <given-names>G</given-names>
        </name>
        <name>
          <surname>Raychaudhuri</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Donovan</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Barretina</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Boehm</surname>
          <given-names>JS</given-names>
        </name>
        <name>
          <surname>Dobson</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Urashima</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>McHenry</surname>
          <given-names>KT</given-names>
        </name>
        <name>
          <surname>Pinchback</surname>
          <given-names>RM</given-names>
        </name>
        <name>
          <surname>Ligon</surname>
          <given-names>AH</given-names>
        </name>
        <name>
          <surname>Cho</surname>
          <given-names>YJ</given-names>
        </name>
        <name>
          <surname>Haery</surname>
          <given-names>L</given-names>
        </name>
        <name>
          <surname>Greulich</surname>
          <given-names>H</given-names>
        </name>
        <name>
          <surname>Reich</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Winckler</surname>
          <given-names>W</given-names>
        </name>
        <name>
          <surname>Lawrence</surname>
          <given-names>MS</given-names>
        </name>
        <name>
          <surname>Weir</surname>
          <given-names>BA</given-names>
        </name>
        <name>
          <surname>Tanaka</surname>
          <given-names>KE</given-names>
        </name>
        <name>
          <surname>Chiang</surname>
          <given-names>DY</given-names>
        </name>
        <name>
          <surname>Bass</surname>
          <given-names>AJ</given-names>
        </name>
        <name>
          <surname>Loo</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Hoffman</surname>
          <given-names>C</given-names>
        </name>
        <name>
          <surname>Prensner</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Liefeld</surname>
          <given-names>T</given-names>
        </name>
        <name>
          <surname>Gao</surname>
          <given-names>Q</given-names>
        </name>
        <name>
          <surname>Yecies</surname>
          <given-names>D</given-names>
        </name>
        <name>
          <surname>Signoretti</surname>
          <given-names>S</given-names>
        </name>
        <etal/>
        <article-title>The landscape of somatic copy-number alteration across human cancers</article-title>
        <source>Nature</source>
        <year>2010</year>
        <volume>18</volume>
        <fpage>899</fpage>
        <lpage>905</lpage>
        <pub-id pub-id-type="pmid">20164920</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B2">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Russnes</surname>
          <given-names>HG</given-names>
        </name>
        <name>
          <surname>Vollan</surname>
          <given-names>HKM</given-names>
        </name>
        <name>
          <surname>Lingjærde</surname>
          <given-names>OC</given-names>
        </name>
        <name>
          <surname>Krasnitz</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Lundin</surname>
          <given-names>P</given-names>
        </name>
        <name>
          <surname>Naume</surname>
          <given-names>B</given-names>
        </name>
        <name>
          <surname>Sørlie</surname>
          <given-names>T</given-names>
        </name>
        <name>
          <surname>Borgen</surname>
          <given-names>E</given-names>
        </name>
        <name>
          <surname>Rye</surname>
          <given-names>IH</given-names>
        </name>
        <name>
          <surname>Langerød</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Chin</surname>
          <given-names>SF</given-names>
        </name>
        <name>
          <surname>Teschendorff</surname>
          <given-names>AE</given-names>
        </name>
        <name>
          <surname>Stephens</surname>
          <given-names>PJ</given-names>
        </name>
        <name>
          <surname>Månér</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Schlichting</surname>
          <given-names>E</given-names>
        </name>
        <name>
          <surname>Baumbusch</surname>
          <given-names>LO</given-names>
        </name>
        <name>
          <surname>Kåresen</surname>
          <given-names>R</given-names>
        </name>
        <name>
          <surname>Stratton</surname>
          <given-names>MP</given-names>
        </name>
        <name>
          <surname>Wigler</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Caldas</surname>
          <given-names>C</given-names>
        </name>
        <name>
          <surname>Zetterberg</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Hicks</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Børresen-Dale</surname>
          <given-names>AB</given-names>
        </name>
        <article-title>Genomic architecture characterizes tumor progression paths and fate in breast cancer patients</article-title>
        <source>Sci Transl Med</source>
        <year>2010</year>
        <volume>2</volume>
        <fpage>38</fpage>
        <lpage>47</lpage>
      </mixed-citation>
    </ref>
    <ref id="B3">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Hupe</surname>
          <given-names>P</given-names>
        </name>
        <name>
          <surname>Stransky</surname>
          <given-names>N</given-names>
        </name>
        <name>
          <surname>Thiery</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Barillot</surname>
          <given-names>E</given-names>
        </name>
        <article-title>Analysis of array CGH data: from signal ratio to gain and loss of DNA regions</article-title>
        <source>Bioinformatics</source>
        <year>2004</year>
        <volume>20</volume>
        <fpage>3413</fpage>
        <lpage>3422</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bth418</pub-id>
        <pub-id pub-id-type="pmid">15381628</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B4">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Olshen</surname>
          <given-names>AB</given-names>
        </name>
        <name>
          <surname>Venkatraman</surname>
          <given-names>ES</given-names>
        </name>
        <name>
          <surname>Lucito</surname>
          <given-names>R</given-names>
        </name>
        <name>
          <surname>Wigler</surname>
          <given-names>M</given-names>
        </name>
        <article-title>Circular binary segmentation for the analysis of array-based copy number data</article-title>
        <source>Biostatistics</source>
        <year>2004</year>
        <volume>5</volume>
        <fpage>557</fpage>
        <lpage>572</lpage>
        <pub-id pub-id-type="doi">10.1093/biostatistics/kxh008</pub-id>
        <pub-id pub-id-type="pmid">15475419</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B5">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Lai</surname>
          <given-names>WR</given-names>
        </name>
        <name>
          <surname>Johnson</surname>
          <given-names>MD</given-names>
        </name>
        <name>
          <surname>Kucherlapati</surname>
          <given-names>R</given-names>
        </name>
        <name>
          <surname>Park</surname>
          <given-names>PJ</given-names>
        </name>
        <article-title>Comparative analysis of algorithms for identifying amplifications and deletions in array CGH data</article-title>
        <source>Bioinformatics</source>
        <year>2005</year>
        <volume>21</volume>
        <fpage>3763</fpage>
        <lpage>3770</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bti611</pub-id>
        <pub-id pub-id-type="pmid">16081473</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B6">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Picard</surname>
          <given-names>F</given-names>
        </name>
        <name>
          <surname>Robin</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Lavielle</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Vaisse</surname>
          <given-names>C</given-names>
        </name>
        <name>
          <surname>Daudin</surname>
          <given-names>J</given-names>
        </name>
        <article-title>A statistical approach for array CGH data analysis</article-title>
        <source>BMC Bioinf</source>
        <year>2005</year>
        <volume>6</volume>
        <fpage>27</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-6-27</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B7">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Wang</surname>
          <given-names>P</given-names>
        </name>
        <name>
          <surname>Kim</surname>
          <given-names>Y</given-names>
        </name>
        <name>
          <surname>Pollack</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Narasimhan</surname>
          <given-names>B</given-names>
        </name>
        <name>
          <surname>Tibshirani</surname>
          <given-names>R</given-names>
        </name>
        <article-title>A method for calling gains and losses in array CGH data</article-title>
        <source>Biostatistics</source>
        <year>2005</year>
        <volume>6</volume>
        <fpage>45</fpage>
        <lpage>58</lpage>
        <pub-id pub-id-type="doi">10.1093/biostatistics/kxh017</pub-id>
        <pub-id pub-id-type="pmid">15618527</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B8">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Willenbrock</surname>
          <given-names>H</given-names>
        </name>
        <name>
          <surname>Fridlyand</surname>
          <given-names>J</given-names>
        </name>
        <article-title>A comparison study: applying segmentation to array CGH data for downstream analyses</article-title>
        <source>Bioinformatics</source>
        <year>2005</year>
        <volume>21</volume>
        <fpage>4084</fpage>
        <lpage>4091</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bti677</pub-id>
        <pub-id pub-id-type="pmid">16159913</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B9">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Marioni</surname>
          <given-names>JC</given-names>
        </name>
        <name>
          <surname>Thorne</surname>
          <given-names>NP</given-names>
        </name>
        <name>
          <surname>Valsesia</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Fitzgerald</surname>
          <given-names>T</given-names>
        </name>
        <name>
          <surname>Redon</surname>
          <given-names>R</given-names>
        </name>
        <name>
          <surname>Fiegler</surname>
          <given-names>H</given-names>
        </name>
        <name>
          <surname>Andrews</surname>
          <given-names>TD</given-names>
        </name>
        <name>
          <surname>Stranger</surname>
          <given-names>BE</given-names>
        </name>
        <name>
          <surname>Lynch</surname>
          <given-names>AG</given-names>
        </name>
        <name>
          <surname>Dermitzakis</surname>
          <given-names>ET</given-names>
        </name>
        <name>
          <surname>Carter</surname>
          <given-names>NP</given-names>
        </name>
        <name>
          <surname>Tavaré</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Hurles</surname>
          <given-names>ME</given-names>
        </name>
        <article-title>Breaking the waves: improved detection of copy number variation from microarray-based comparative genomic hybridization</article-title>
        <source>Genome Biol</source>
        <year>2007</year>
        <volume>8</volume>
        <fpage>R228</fpage>
        <pub-id pub-id-type="doi">10.1186/gb-2007-8-10-r228</pub-id>
        <pub-id pub-id-type="pmid">17961237</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B10">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Yu</surname>
          <given-names>T</given-names>
        </name>
        <name>
          <surname>Ye</surname>
          <given-names>H</given-names>
        </name>
        <name>
          <surname>Sun</surname>
          <given-names>W</given-names>
        </name>
        <name>
          <surname>Li</surname>
          <given-names>K</given-names>
        </name>
        <name>
          <surname>Chen</surname>
          <given-names>Z</given-names>
        </name>
        <name>
          <surname>Jacobs</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Bailey</surname>
          <given-names>D</given-names>
        </name>
        <name>
          <surname>Wong</surname>
          <given-names>D</given-names>
        </name>
        <name>
          <surname>Zhou</surname>
          <given-names>X</given-names>
        </name>
        <article-title>A forward-backward fragment assembling algorithm for the identification of genomic amplification and deletion breakpoints using high-density single nucleotide polymorphism (SNP) array</article-title>
        <source>BMC Bioinf</source>
        <year>2007</year>
        <volume>8</volume>
        <fpage>145</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-8-145</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B11">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Ben-Yaacov</surname>
          <given-names>E</given-names>
        </name>
        <name>
          <surname>Eldar</surname>
          <given-names>YC</given-names>
        </name>
        <article-title>A fast and flexible method for the segmentation of aCGH data</article-title>
        <source>Bioinformatics</source>
        <year>2008</year>
        <volume>24</volume>
        <issue>16</issue>
        <fpage>i139</fpage>
        <lpage>i145</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btn272</pub-id>
        <pub-id pub-id-type="pmid">18689815</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B12">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Tibshirani</surname>
          <given-names>R</given-names>
        </name>
        <name>
          <surname>Wang</surname>
          <given-names>P</given-names>
        </name>
        <article-title>Spatial smoothing and hot spot detection for CGH data using the fused lasso</article-title>
        <source>Biostatistics</source>
        <year>2008</year>
        <volume>9</volume>
        <fpage>18</fpage>
        <lpage>29</lpage>
        <pub-id pub-id-type="pmid">17513312</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B13">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Scharpf</surname>
          <given-names>RB</given-names>
        </name>
        <name>
          <surname>Parmigiani</surname>
          <given-names>G</given-names>
        </name>
        <name>
          <surname>Pevsner</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Ruczinski</surname>
          <given-names>I</given-names>
        </name>
        <article-title>Hidden Markov models for the assessment of chromosomal alterations using high-throughput SNP arrays</article-title>
        <source>Ann Appl Stat</source>
        <year>2008</year>
        <volume>2</volume>
        <fpage>687</fpage>
        <lpage>713</lpage>
        <pub-id pub-id-type="doi">10.1214/07-AOAS155</pub-id>
        <pub-id pub-id-type="pmid">19609370</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B14">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Wang</surname>
          <given-names>L</given-names>
        </name>
        <name>
          <surname>Abyzov</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Korbel</surname>
          <given-names>JO</given-names>
        </name>
        <name>
          <surname>Snyder</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Gerstein</surname>
          <given-names>M</given-names>
        </name>
        <article-title>MSB: A mean-shift-based approach for the analysis of structural variation in the genome</article-title>
        <source>Genome Res</source>
        <year>2009</year>
        <volume>19</volume>
        <fpage>106</fpage>
        <lpage>117</lpage>
        <pub-id pub-id-type="pmid">19037015</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B15">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Coe</surname>
          <given-names>BP</given-names>
        </name>
        <name>
          <surname>Chari</surname>
          <given-names>R</given-names>
        </name>
        <name>
          <surname>MacAulay</surname>
          <given-names>C</given-names>
        </name>
        <name>
          <surname>Lam</surname>
          <given-names>WL</given-names>
        </name>
        <article-title>FACADE: a fast and sensitive algorithm for the segmentation and calling of high resolution array CGH data</article-title>
        <source>Nucleic Acids Res</source>
        <year>2010</year>
        <volume>38</volume>
        <issue>15</issue>
        <fpage>e157</fpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkq548</pub-id>
        <pub-id pub-id-type="pmid">20551132</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B16">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Chen</surname>
          <given-names>C</given-names>
        </name>
        <name>
          <surname>Lee</surname>
          <given-names>H</given-names>
        </name>
        <name>
          <surname>Ling</surname>
          <given-names>Q</given-names>
        </name>
        <name>
          <surname>Chen</surname>
          <given-names>H</given-names>
        </name>
        <name>
          <surname>Ko</surname>
          <given-names>Y</given-names>
        </name>
        <name>
          <surname>Tsou</surname>
          <given-names>T</given-names>
        </name>
        <name>
          <surname>Wang</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Wu</surname>
          <given-names>L</given-names>
        </name>
        <name>
          <surname>Lee</surname>
          <given-names>HC</given-names>
        </name>
        <article-title>An all-statistics, high-speed algorithm for the analysis of copy number variation in genomes</article-title>
        <source>Nucleic Acids Res</source>
        <year>2011</year>
        <volume>39</volume>
        <issue>13</issue>
        <fpage>e89</fpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkr137</pub-id>
        <pub-id pub-id-type="pmid">21576227</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B17">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Scherer</surname>
          <given-names>SW</given-names>
        </name>
        <name>
          <surname>Lee</surname>
          <given-names>C</given-names>
        </name>
        <name>
          <surname>Birney</surname>
          <given-names>E</given-names>
        </name>
        <name>
          <surname>Altshuler</surname>
          <given-names>DM</given-names>
        </name>
        <name>
          <surname>Eichler</surname>
          <given-names>EE</given-names>
        </name>
        <name>
          <surname>Carter</surname>
          <given-names>NP</given-names>
        </name>
        <name>
          <surname>Hurles</surname>
          <given-names>ME</given-names>
        </name>
        <name>
          <surname>Feuk</surname>
          <given-names>L</given-names>
        </name>
        <article-title>Challenges and standards in integrating surveys and structural variation</article-title>
        <source>Nat Genet</source>
        <year>2007</year>
        <volume>39</volume>
        <fpage>S7</fpage>
        <lpage>S15</lpage>
        <pub-id pub-id-type="doi">10.1038/ng2093</pub-id>
        <pub-id pub-id-type="pmid">17597783</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B18">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Rueda</surname>
          <given-names>OM</given-names>
        </name>
        <name>
          <surname>Diaz-Uriarte</surname>
          <given-names>R</given-names>
        </name>
        <article-title>Finding recurrent copy number alteration regions: A review of methods</article-title>
        <source>Curr Bioinf</source>
        <year>2010</year>
        <volume>5</volume>
        <fpage>1</fpage>
        <lpage>17</lpage>
        <pub-id pub-id-type="doi">10.2174/157489310790596402</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B19">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Shah</surname>
          <given-names>SP</given-names>
        </name>
        <name>
          <surname>Lam</surname>
          <given-names>WL</given-names>
        </name>
        <name>
          <surname>Ng</surname>
          <given-names>RT</given-names>
        </name>
        <name>
          <surname>Murphy</surname>
          <given-names>KP</given-names>
        </name>
        <article-title>Modeling recurrent DNA copy number alterations in array CGH data</article-title>
        <source>Bioinformatics</source>
        <year>2007</year>
        <volume>23</volume>
        <fpage>i450</fpage>
        <lpage>i458</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btm221</pub-id>
        <pub-id pub-id-type="pmid">17646330</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B20">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Zhang</surname>
          <given-names>NR</given-names>
        </name>
        <name>
          <surname>Senbabaoglu</surname>
          <given-names>Y</given-names>
        </name>
        <name>
          <surname>Li</surname>
          <given-names>JZ</given-names>
        </name>
        <article-title>Joint estimation of DNA copy number from multiple platforms</article-title>
        <source>Bioinformatics</source>
        <year>2010</year>
        <volume>26</volume>
        <fpage>153</fpage>
        <lpage>160</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btp653</pub-id>
        <pub-id pub-id-type="pmid">19933593</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B21">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Zhang</surname>
          <given-names>NR</given-names>
        </name>
        <name>
          <surname>Siegmund</surname>
          <given-names>DO</given-names>
        </name>
        <name>
          <surname>Ji</surname>
          <given-names>H</given-names>
        </name>
        <name>
          <surname>Li</surname>
          <given-names>JZ</given-names>
        </name>
        <article-title>Detecting simultaneous changepoints in multiple sequences</article-title>
        <source>Biometrica</source>
        <year>2010</year>
        <volume>97</volume>
        <fpage>631</fpage>
        <lpage>645</lpage>
        <pub-id pub-id-type="doi">10.1093/biomet/asq025</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B22">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Picard</surname>
          <given-names>F</given-names>
        </name>
        <name>
          <surname>Lebarbier</surname>
          <given-names>E</given-names>
        </name>
        <name>
          <surname>Hoebeke</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Rigaill</surname>
          <given-names>G</given-names>
        </name>
        <name>
          <surname>Thiam</surname>
          <given-names>B</given-names>
        </name>
        <name>
          <surname>Robin</surname>
          <given-names>S</given-names>
        </name>
        <article-title>Joint segmentation, calling and normalization of multiple CGH profiles</article-title>
        <source>Biostatistics</source>
        <year>2011</year>
        <volume>12</volume>
        <fpage>413</fpage>
        <lpage>428</lpage>
        <pub-id pub-id-type="doi">10.1093/biostatistics/kxq076</pub-id>
        <pub-id pub-id-type="pmid">21209153</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B23">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Teo</surname>
          <given-names>SM</given-names>
        </name>
        <name>
          <surname>Pawitan</surname>
          <given-names>Y</given-names>
        </name>
        <name>
          <surname>Kumar</surname>
          <given-names>V</given-names>
        </name>
        <name>
          <surname>Thalamuthu</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Seielstad</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Chia</surname>
          <given-names>KS</given-names>
        </name>
        <name>
          <surname>Salim</surname>
          <given-names>A</given-names>
        </name>
        <article-title>Multi-platform segmentation for joint detection of copy number variants</article-title>
        <source>Bioinformatics</source>
        <year>2011</year>
        <volume>27</volume>
        <fpage>1555</fpage>
        <lpage>1561</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btr162</pub-id>
        <pub-id pub-id-type="pmid">21471018</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B24">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Winkler</surname>
          <given-names>G</given-names>
        </name>
        <name>
          <surname>Liebscher</surname>
          <given-names>V</given-names>
        </name>
        <article-title>Smoothers for discontinuous signals</article-title>
        <source>J Nonparametr Stat</source>
        <year>2002</year>
        <volume>14</volume>
        <fpage>203</fpage>
        <lpage>222</lpage>
        <pub-id pub-id-type="doi">10.1080/10485250211388</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B25">
      <mixed-citation publication-type="book">
        <name>
          <surname>Venables</surname>
          <given-names>WN</given-names>
        </name>
        <name>
          <surname>Ripley</surname>
          <given-names>BD</given-names>
        </name>
        <source>Modern Applied Statistics with S-Plus</source>
        <year>1994</year>
        <publisher-name>New York: Springer-Verlag</publisher-name>
      </mixed-citation>
    </ref>
    <ref id="B26">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Van Loo</surname>
          <given-names>P</given-names>
        </name>
        <name>
          <surname>Nordgard</surname>
          <given-names>SH</given-names>
        </name>
        <name>
          <surname>Lingjærde</surname>
          <given-names>OC</given-names>
        </name>
        <name>
          <surname>Russnes</surname>
          <given-names>HG</given-names>
        </name>
        <name>
          <surname>Rye</surname>
          <given-names>IH</given-names>
        </name>
        <name>
          <surname>Sun</surname>
          <given-names>W</given-names>
        </name>
        <name>
          <surname>Weigman</surname>
          <given-names>VJ</given-names>
        </name>
        <name>
          <surname>Marynen</surname>
          <given-names>P</given-names>
        </name>
        <name>
          <surname>Zetterberg</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Naume</surname>
          <given-names>B</given-names>
        </name>
        <name>
          <surname>Perou</surname>
          <given-names>CM</given-names>
        </name>
        <name>
          <surname>Børresen-Dale</surname>
          <given-names>AL</given-names>
        </name>
        <name>
          <surname>Kristensen</surname>
          <given-names>VN</given-names>
        </name>
        <article-title>Allele-specific copy number analysis of tumors</article-title>
        <source>Proc Natl Acad Sci US</source>
        <year>2010</year>
        <volume>107</volume>
        <fpage>16910</fpage>
        <lpage>16915</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.1009843107</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B27">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Zhang</surname>
          <given-names>NR</given-names>
        </name>
        <name>
          <surname>Siegmund</surname>
          <given-names>DO</given-names>
        </name>
        <article-title>A modified Bayes information criterion with applications to the analysis of comparative genomic hybridization data</article-title>
        <source>Biometrics</source>
        <year>2007</year>
        <volume>63</volume>
        <fpage>22</fpage>
        <lpage>32</lpage>
        <pub-id pub-id-type="doi">10.1111/j.1541-0420.2006.00662.x</pub-id>
        <pub-id pub-id-type="pmid">17447926</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B28">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Gerlinger</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Rowan</surname>
          <given-names>AJ</given-names>
        </name>
        <name>
          <surname>Horswell</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Larkin</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Endesfelder</surname>
          <given-names>D</given-names>
        </name>
        <name>
          <surname>Gronroos</surname>
          <given-names>E</given-names>
        </name>
        <name>
          <surname>Martinez</surname>
          <given-names>P</given-names>
        </name>
        <name>
          <surname>Matthews</surname>
          <given-names>N</given-names>
        </name>
        <name>
          <surname>Stewart</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Tarpey</surname>
          <given-names>P</given-names>
        </name>
        <name>
          <surname>Varela</surname>
          <given-names>I</given-names>
        </name>
        <name>
          <surname>Phillimore</surname>
          <given-names>B</given-names>
        </name>
        <name>
          <surname>Begum</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>McDonald</surname>
          <given-names>NQ</given-names>
        </name>
        <name>
          <surname>Butler</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Jones</surname>
          <given-names>D</given-names>
        </name>
        <name>
          <surname>Raine</surname>
          <given-names>K</given-names>
        </name>
        <name>
          <surname>Latimer</surname>
          <given-names>C</given-names>
        </name>
        <name>
          <surname>Santos</surname>
          <given-names>C</given-names>
        </name>
        <name>
          <surname>Nohadani</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Eklund</surname>
          <given-names>AC</given-names>
        </name>
        <name>
          <surname>Spencer-Dene</surname>
          <given-names>B</given-names>
        </name>
        <name>
          <surname>Clark</surname>
          <given-names>G</given-names>
        </name>
        <name>
          <surname>Pickering</surname>
          <given-names>L</given-names>
        </name>
        <name>
          <surname>Stamp</surname>
          <given-names>G</given-names>
        </name>
        <name>
          <surname>Gore</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Szallasi</surname>
          <given-names>Z</given-names>
        </name>
        <name>
          <surname>Downward</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Futreal</surname>
          <given-names>PA</given-names>
        </name>
        <name>
          <surname>Swanton</surname>
          <given-names>C</given-names>
        </name>
        <article-title>Intratumor heterogeneity and branched evolution revealed by multiregion sequencing</article-title>
        <source>N Engl J Med</source>
        <year>2012</year>
        <volume>366</volume>
        <fpage>883</fpage>
        <lpage>892</lpage>
        <pub-id pub-id-type="doi">10.1056/NEJMoa1113205</pub-id>
        <pub-id pub-id-type="pmid">22397650</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B29">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Beroukhim</surname>
          <given-names>R</given-names>
        </name>
        <name>
          <surname>Getz</surname>
          <given-names>G</given-names>
        </name>
        <name>
          <surname>Nghiemphu</surname>
          <given-names>L</given-names>
        </name>
        <name>
          <surname>Barretina</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Hsueh</surname>
          <given-names>T</given-names>
        </name>
        <name>
          <surname>Linhart</surname>
          <given-names>D</given-names>
        </name>
        <name>
          <surname>Vivanco</surname>
          <given-names>I</given-names>
        </name>
        <name>
          <surname>Lee</surname>
          <given-names>JH</given-names>
        </name>
        <name>
          <surname>Huang</surname>
          <given-names>JC</given-names>
        </name>
        <name>
          <surname>Alexander</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Du</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Kau</surname>
          <given-names>T</given-names>
        </name>
        <name>
          <surname>Thomas</surname>
          <given-names>RK</given-names>
        </name>
        <name>
          <surname>Shah</surname>
          <given-names>K</given-names>
        </name>
        <name>
          <surname>Soto</surname>
          <given-names>H</given-names>
        </name>
        <name>
          <surname>Perner</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Prensner</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Debiasi</surname>
          <given-names>RM</given-names>
        </name>
        <name>
          <surname>Demichelis</surname>
          <given-names>F</given-names>
        </name>
        <name>
          <surname>Hatton</surname>
          <given-names>C</given-names>
        </name>
        <name>
          <surname>Rubin</surname>
          <given-names>MA</given-names>
        </name>
        <name>
          <surname>Garraway</surname>
          <given-names>LA</given-names>
        </name>
        <name>
          <surname>Nelson</surname>
          <given-names>SF</given-names>
        </name>
        <name>
          <surname>Liau</surname>
          <given-names>L</given-names>
        </name>
        <name>
          <surname>Mischel</surname>
          <given-names>P</given-names>
        </name>
        <name>
          <surname>Cloughesy</surname>
          <given-names>T</given-names>
        </name>
        <name>
          <surname>Meyerson</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Golub</surname>
          <given-names>T</given-names>
        </name>
        <name>
          <surname>Lander</surname>
          <given-names>ES</given-names>
        </name>
        <name>
          <surname>Mellinghoff</surname>
          <given-names>IK</given-names>
        </name>
        <name>
          <surname>Sellers</surname>
          <given-names>WR</given-names>
        </name>
        <article-title>Genomic alterations reveal potential for higher grade transformation in follicular lymphoma and confirm parallel evolution of tumor cell clones</article-title>
        <source>Proc Natl Acad Sci USA</source>
        <year>2007</year>
        <volume>104</volume>
        <fpage>20007</fpage>
        <lpage>20012</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.0710052104</pub-id>
        <pub-id pub-id-type="pmid">18077431</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B30">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Klijn</surname>
          <given-names>C</given-names>
        </name>
        <name>
          <surname>Holstege</surname>
          <given-names>H</given-names>
        </name>
        <name>
          <surname>de Ridder</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Liu</surname>
          <given-names>X</given-names>
        </name>
        <name>
          <surname>Reinders</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Jonkers</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Wessels</surname>
          <given-names>L</given-names>
        </name>
        <article-title>Identification of cancer genes using a statistical framework for multiexperiment analysis of nondiscretized array CGH data</article-title>
        <source>Nucleic Acids Res</source>
        <year>2008</year>
        <volume>36</volume>
        <fpage>e13</fpage>
        <pub-id pub-id-type="pmid">18187509</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B31">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Aguirre</surname>
          <given-names>AJ</given-names>
        </name>
        <name>
          <surname>Brennan</surname>
          <given-names>C</given-names>
        </name>
        <name>
          <surname>Bailey</surname>
          <given-names>G</given-names>
        </name>
        <article-title>High-resolution characterization of the pancreatic adenocarcinoma genome</article-title>
        <source>Proc Natl Acad Sci US</source>
        <year>2004</year>
        <volume>101</volume>
        <fpage>9067</fpage>
        <lpage>9072</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.0402932101</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B32">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Mathiesen</surname>
          <given-names>RR</given-names>
        </name>
        <name>
          <surname>Fjelldal</surname>
          <given-names>R</given-names>
        </name>
        <name>
          <surname>Liestøl</surname>
          <given-names>K</given-names>
        </name>
        <name>
          <surname>Due</surname>
          <given-names>EU</given-names>
        </name>
        <name>
          <surname>Geigl</surname>
          <given-names>JB</given-names>
        </name>
        <name>
          <surname>Riethdorf</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Borgen</surname>
          <given-names>E</given-names>
        </name>
        <name>
          <surname>Rye</surname>
          <given-names>IH</given-names>
        </name>
        <name>
          <surname>Schneider</surname>
          <given-names>IJ</given-names>
        </name>
        <name>
          <surname>Obenauf</surname>
          <given-names>AC</given-names>
        </name>
        <name>
          <surname>Mauermann</surname>
          <given-names>O</given-names>
        </name>
        <name>
          <surname>Nilsen</surname>
          <given-names>G</given-names>
        </name>
        <name>
          <surname>Lingjærde</surname>
          <given-names>OC</given-names>
        </name>
        <name>
          <surname>Børresen-Dale</surname>
          <given-names>AL</given-names>
        </name>
        <name>
          <surname>Pantel</surname>
          <given-names>K</given-names>
        </name>
        <name>
          <surname>Speicher</surname>
          <given-names>MR</given-names>
        </name>
        <name>
          <surname>Naume</surname>
          <given-names>B</given-names>
        </name>
        <name>
          <surname>Baumbusch</surname>
          <given-names>LO</given-names>
        </name>
        <article-title>High resolution analysis of copy number changes in disseminated tumor cells of patients with breast cancer</article-title>
        <source>Int J Cancer</source>
        <year>2011</year>
        <volume>131</volume>
        <issue>4</issue>
        <fpage>E405</fpage>
        <lpage>E415</lpage>
        <pub-id pub-id-type="doi">10.1002/ijc.26444</pub-id>
        <pub-id pub-id-type="pmid">21935921</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B33">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Wiedswang</surname>
          <given-names>G</given-names>
        </name>
        <name>
          <surname>Borgen</surname>
          <given-names>E</given-names>
        </name>
        <name>
          <surname>Kaaresen</surname>
          <given-names>R</given-names>
        </name>
        <name>
          <surname>Kvalheim</surname>
          <given-names>G</given-names>
        </name>
        <name>
          <surname>Nesland</surname>
          <given-names>JM</given-names>
        </name>
        <name>
          <surname>Qvist</surname>
          <given-names>H</given-names>
        </name>
        <name>
          <surname>Schlichting</surname>
          <given-names>E</given-names>
        </name>
        <name>
          <surname>Sauer</surname>
          <given-names>T</given-names>
        </name>
        <name>
          <surname>Janbu</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Harbitz</surname>
          <given-names>T</given-names>
        </name>
        <name>
          <surname>Naume</surname>
          <given-names>B</given-names>
        </name>
        <article-title>Detection of isolated tumor cells in bone marrow is an independent prognostic factor in breast cancer</article-title>
        <source>J Clin Oncol</source>
        <year>2003</year>
        <volume>21</volume>
        <fpage>3469</fpage>
        <lpage>3478</lpage>
        <pub-id pub-id-type="doi">10.1200/JCO.2003.02.009</pub-id>
        <pub-id pub-id-type="pmid">12972522</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B34">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Eide</surname>
          <given-names>MB</given-names>
        </name>
        <name>
          <surname>Liestøl</surname>
          <given-names>K</given-names>
        </name>
        <name>
          <surname>Lingjærde</surname>
          <given-names>OC</given-names>
        </name>
        <name>
          <surname>Hystad</surname>
          <given-names>ME</given-names>
        </name>
        <name>
          <surname>Kresse</surname>
          <given-names>SH</given-names>
        </name>
        <name>
          <surname>Meza-Zepeda</surname>
          <given-names>L</given-names>
        </name>
        <name>
          <surname>Myklebost</surname>
          <given-names>O</given-names>
        </name>
        <name>
          <surname>Trøen</surname>
          <given-names>G</given-names>
        </name>
        <name>
          <surname>Aamot</surname>
          <given-names>HV</given-names>
        </name>
        <name>
          <surname>Holte</surname>
          <given-names>H</given-names>
        </name>
        <name>
          <surname>Smeland</surname>
          <given-names>EB</given-names>
        </name>
        <name>
          <surname>Delabie</surname>
          <given-names>J</given-names>
        </name>
        <article-title>Genomic alterations reveal potential for higher grade transformation in follicular lymphoma and confirm parallel evolution of tumor cell clones</article-title>
        <source>Blood</source>
        <year>2010</year>
        <volume>116</volume>
        <fpage>1489</fpage>
        <lpage>1497</lpage>
        <pub-id pub-id-type="doi">10.1182/blood-2010-03-272278</pub-id>
        <pub-id pub-id-type="pmid">20505157</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B35">
      <mixed-citation publication-type="book">
        <name>
          <surname>Tukey</surname>
          <given-names>JW</given-names>
        </name>
        <person-group person-group-type="editor">Olkin I, Ghurye SG, Hoeffding W, Madow WG, Mann HB</person-group>
        <article-title>A survey of sampling from contaminated distributions</article-title>
        <source>Contributions to Probability and Statistics: Essays in Honor of Harold Hotelling</source>
        <year>1960</year>
        <publisher-name>Stanford University Press: Stanford</publisher-name>
        <fpage>448</fpage>
        <lpage>485</lpage>
      </mixed-citation>
    </ref>
    <ref id="B36">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Venkatraman</surname>
          <given-names>ES</given-names>
        </name>
        <name>
          <surname>Olshen</surname>
          <given-names>AB</given-names>
        </name>
        <article-title>A faster circular binary segmentation algorithm for the analysis of array CGH data</article-title>
        <source>Bioinformatics</source>
        <year>2007</year>
        <volume>23</volume>
        <fpage>657</fpage>
        <lpage>663</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btl646</pub-id>
        <pub-id pub-id-type="pmid">17234643</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B37">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Lai</surname>
          <given-names>W</given-names>
        </name>
        <name>
          <surname>Choudhary</surname>
          <given-names>V</given-names>
        </name>
        <name>
          <surname>Park</surname>
          <given-names>PJ</given-names>
        </name>
        <article-title>CGHweb: a tool for comparing DNA copy number segmentations from multiple algorithms</article-title>
        <source>Bioinformatics</source>
        <year>2008</year>
        <volume>24</volume>
        <issue>7</issue>
        <fpage>1014</fpage>
        <lpage>1015</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btn067</pub-id>
        <pub-id pub-id-type="pmid">18296463</pub-id>
      </mixed-citation>
    </ref>
  </ref-list>
</back>
