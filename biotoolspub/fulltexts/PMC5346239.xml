<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>BMC Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">5346239</article-id>
    <article-id pub-id-type="publisher-id">1575</article-id>
    <article-id pub-id-type="doi">10.1186/s12859-017-1575-2</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Software</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>ClonoCalc and ClonoPlot: immune repertoire analysis from raw files to publication figures with graphical user interface</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Fähnrich</surname>
          <given-names>Anke</given-names>
        </name>
        <address>
          <email>faehnrich@anat.uni-luebeck.de</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Krebbel</surname>
          <given-names>Moritz</given-names>
        </name>
        <address>
          <email>moritz.krebbel@student.uni-luebeck.de</email>
        </address>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Decker</surname>
          <given-names>Normann</given-names>
        </name>
        <address>
          <email>decker@isp.uni-luebeck.de</email>
        </address>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Leucker</surname>
          <given-names>Martin</given-names>
        </name>
        <address>
          <email>leucker@isp.uni-luebeck.de</email>
        </address>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Lange</surname>
          <given-names>Felix D.</given-names>
        </name>
        <address>
          <email>felix.lange@student.uni-luebeck.de</email>
        </address>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Kalies</surname>
          <given-names>Kathrin</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Möller</surname>
          <given-names>Steffen</given-names>
        </name>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <aff id="Aff1"><label>1</label>Institute of Anatomy, Ratzeburger Allee, Lübeck, 160, 23562 Germany </aff>
      <aff id="Aff2"><label>2</label>Institute for Software Engineering and Programming Languages, Ratzeburger Allee, Lübeck, 160, 23562 Germany </aff>
      <aff id="Aff3"><label>3</label>Institute for Biostatistics and Informatics in Medicine and Ageing Research, Ernst-Heydemann-Str. 8, Rostock, 18057 Germany </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>11</day>
      <month>3</month>
      <year>2017</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>11</day>
      <month>3</month>
      <year>2017</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2017</year>
    </pub-date>
    <volume>18</volume>
    <elocation-id>164</elocation-id>
    <history>
      <date date-type="received">
        <day>22</day>
        <month>6</month>
        <year>2016</year>
      </date>
      <date date-type="accepted">
        <day>1</day>
        <month>3</month>
        <year>2017</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2017</copyright-statement>
      <license license-type="OpenAccess">
        <license-p><bold>Open Access</bold> This article is distributed under the terms of the Creative Commons Attribution 4.0 International License(<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The Creative Commons Public Domain Dedication waiver(<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p>Next generation sequencing (NGS) technologies enable studies and analyses of the diversity of both T and B cell receptors (TCR and BCR) in human and animal systems to elucidate immune functions in health and disease. Over the last few years, several algorithms and tools have been developed to support respective analyses of raw sequencing data of the immune repertoire. These tools focus on distinct aspects of the data processing and require a strong bioinformatics background. To facilitate the analysis of T and B cell repertoires by less experienced users, software is needed that combines the most common tools for repertoire analysis.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p>We introduce a graphical user interface (GUI) providing a complete analysis pipeline for processing raw NGS data for human and animal TCR and BCR clonotype determination and advanced differential repertoire studies. It provides two applications. ClonoCalc prepares the raw data for downstream analyses. It combines a demultiplexer for barcode splitting and employs MiXCR for paired-end read merging and the extraction of human and animal TCR/BCR sequences. ClonoPlot wraps the R package tcR and further contributes self-developed plots for the descriptive comparative investigation of immune repertoires.</p>
      </sec>
      <sec>
        <title>Conclusion</title>
        <p>This workflow reduces the amount of programming required to perform the respective analyses and supports both communication and training between scientists and technicians, and across scientific disciplines.</p>
        <p>The Open Source development in Java and R is modular and invites advanced users to extend its functionality. Software and documentation are freely available at <ext-link ext-link-type="uri" xlink:href="https://bitbucket.org/ClonoSuite/clonocalc-plot">https://bitbucket.org/ClonoSuite/clonocalc-plot</ext-link>.</p>
      </sec>
      <sec>
        <title>Electronic supplementary material</title>
        <p>The online version of this article (doi:10.1186/s12859-017-1575-2) contains supplementary material, which is available to authorized users.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Next-generation sequencing</kwd>
      <kwd>Immune repertoire analysis</kwd>
      <kwd>Graphical user interface</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>Deutsche Forschungsgemeinschaft</institution>
        </funding-source>
        <award-id>SFB 564</award-id>
      </award-group>
      <award-group>
        <funding-source>
          <institution>Deutsche Forschungsgemeinschaft</institution>
        </funding-source>
        <award-id>Excellence Cluster Inflammation at Interfaces EXC306</award-id>
      </award-group>
      <award-group>
        <funding-source>
          <institution>Horizon 2020</institution>
        </funding-source>
        <award-id>633589</award-id>
      </award-group>
      <award-group>
        <funding-source>
          <institution>European Cooperation in Science and Technology (BE)</institution>
        </funding-source>
        <award-id>IC1406</award-id>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2017</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p>Both B and T cells are essential for cellular immunity as key players in antigen recognition. The antigen, directly for B cells or presented as a cleaved fragment via the MHC for T cells, is bound by a cognate surface receptor. These B and T cell receptors have a well-defined sequence once the cell has matured. One distinguishes complementarity determining regions (CDR) 1 to 3 of which CDR3 is the most variable, but all contribute to antigen binding and need to be investigated together.</p>
    <p>In order to provide protection from a wide range of pathogens, the diversity of these sequences is enormous. First measurements have estimated a mouse TCR diversity of 10<sup>10</sup>, which, however, is still short of the theoretical expectation of 10<sup>15</sup> [<xref ref-type="bibr" rid="CR1">1</xref>]. The maturation of the sequences is localized in distinct organs. Differences in the relative abundances, i.e. by comparing subtypes of cells, activation states, tissues or time points, are hence accredited to systemic signaling. The study of these promises novel insights in basic research on the regulation of immune processes and with direct links to autoimmune disorders and oncology, with good prospects for early diagnoses and therapy monitoring [<xref ref-type="bibr" rid="CR2">2</xref>].</p>
    <p>Next generation sequencing (NGS) technologies allow to quantify B and T cell receptor diversity. Under the influence of steadily improving sequencing technologies and decreasing costs, the amount of available raw data rapidly increases. As a consequence, software is required that provides fast and comprehensive means for their analysis to answer both general and highly specific questions.</p>
    <p>Several algorithms and tools are available to process raw NGS data of multiple samples. For example, MiXCR is a well-accepted tool to extract BCR and TCR clonotypes from raw NGS data [<xref ref-type="bibr" rid="CR3">3</xref>]. The recently developed tool LymAnalyzer provides a GUI but does not include options for all sub-tasks in data processing, e.g. paired-end merging [<xref ref-type="bibr" rid="CR4">4</xref>].</p>
    <p>For more conclusive comparisons of BCR/TCR data further analyses are required. The scientific community provides partial implementations of the complete workflow, e.g. tcR, gplots, RCircos and descriptive statistics [<xref ref-type="bibr" rid="CR5">5</xref>, <xref ref-type="bibr" rid="CR6">6</xref>], but these software libraries are complex and demand advanced programming skills. This creates barriers for new users who are not familiar with command line interfaces and programming.</p>
    <p>We therefore developed ClonoCalc and ClonoPlot, two open source programs that wrap a selection of widely-accepted freely available tools in order to simplify and streamline the analysis workflow for BCR/TCR repertoire studies. These new tools make these analyses accessible to users with less advanced programming skills. A newly developed graphical interface guides the user through the process from parsing raw data to creating diagrams for comparative and statistical analyses. The whole workflow is summarized in Fig. <xref rid="Fig1" ref-type="fig">1</xref>
<xref rid="Fig1" ref-type="fig">a</xref>. Advanced users can adapt and extend the applications due to the adoption of a modular architecture. An additional batch mode permits high throughput execution of a defined analysis protocol without requiring the user to launch the GUI.
<fig id="Fig1"><label>Fig. 1</label><caption><p>ClonoCalc and ClonoPlot provide a GUI to guide the scientist through a complete workflow for generating publication-ready figures from NGS raw data: <bold>a</bold> Animal and human TCR and IG sequences are input, ClonoCalc pre-processes FASTQ files. ClonoPlot creates final plots using R scripts for data comparison and visualization. <bold>b</bold> Screenshots from ClonoCalc application. From the start screen, a button opens a file dialog, where FASTQ-files can be chosen. Parameters for sub-tasks of data preprocessing can be chosen from buttons depicted on the right. A log file to review the analysis will be generated automatically and made available on the finish screen. <bold>c</bold> ClonoPlot’s user interface <italic>(i)</italic> is divided into two sides: on the left, folders can be chosen from the working directory and will be added to the treeview. On the right, various functions can be selected, each of which produces a plot. Examples of resulting plots include frequency plots <italic>(ii)</italic>, circular visualization of similarities between samples <italic>(iii)</italic>, and CDR3 intersection plots including Venn diagrams and heatmaps <italic>(iV and V)</italic>
</p></caption><graphic xlink:href="12859_2017_1575_Fig1_HTML" id="MO1"/></fig>
</p>
  </sec>
  <sec id="Sec2">
    <title>Implementation</title>
    <sec id="Sec3">
      <title>ClonoCalc</title>
      <p>ClonoCalc provides a GUI for the sub-tasks of processing raw NGS data by wrapping existing 3rd-party implementations of multiple algorithms (Fig. <xref rid="Fig1" ref-type="fig">1</xref>
<xref rid="Fig1" ref-type="fig">b</xref>, left). The wrapped tools are started from within BASH shell scripts which may be amended by advanced users without a need for a development environment. ClonoCalc’s Java front-end handles only the user input, while the main processing is passed to the shell scripts to execute the individual analysis steps and to aggregate their output. ClonoCalc ships with interfaces to a series of current well-established tools and comprises the following features: 
<list list-type="bullet"><list-item><p>Demultiplexing of samples: ClonoCalc first splits the raw data (expected in FASTQ format) and classifies the individual reads according to their barcode by wrapping the FASTX Barcode Splitter [<xref ref-type="bibr" rid="CR7">7</xref>] (Fig. <xref rid="Fig1" ref-type="fig">1</xref>
<xref rid="Fig1" ref-type="fig">b</xref>, start screen (5)). This process needs to suit the wet-lab protocol and limitations of the Illumina demultiplexer led to the employment of the FASTX Barcode Splitter [<xref ref-type="bibr" rid="CR7">7</xref>] for preprocessing. The user selects input and output files for the analysis and enters the barcode to identify specific samples. A readable name can be chosen for every sample and the user is supported by an auto completion and error correction system. Additional parameters for accurate identification of the barcode can be selected from the GUI. This allows for a perfect matching of the barcode while expecting a downstream shift of its location in the sequence (Fig. <xref rid="Fig1" ref-type="fig">1</xref>
<xref rid="Fig1" ref-type="fig">b</xref>).</p></list-item><list-item><p>Clonotype determination: Raw NGS data is processed by wrapping the tool MiXCR to perform paired-end read merging (if using the Illumina system). MiXCR extracts human or animal BCR and TCR clonotypes providing corrections of erroneous sequences introduced by NGS [<xref ref-type="bibr" rid="CR3">3</xref>] (Fig. <xref rid="Fig1" ref-type="fig">1</xref>
<xref rid="Fig1" ref-type="fig">b</xref>).</p></list-item><list-item><p>Automated documentation: A report of the data analysis process is automatically created with every workflow invocation (Fig. <xref rid="Fig1" ref-type="fig">1</xref>
<xref rid="Fig1" ref-type="fig">b</xref>, right) to facilitate the review and report of the observations made. The call parameters (options) can be modified and will be stored for later reproduction of the analysis. A log file extends the report with detailed information on the performed run, including the configuration parameters and the output of MiXCR (Fig. <xref rid="Fig1" ref-type="fig">1</xref>
<xref rid="Fig1" ref-type="fig">b</xref>).</p></list-item><list-item><p>Flexibility: Other back-ends may be integrated by the user, substituting MiXCR or the demultiplexer by adjusting the respective call script.</p></list-item></list>
</p>
    </sec>
    <sec id="Sec4">
      <title>ClonoPlot</title>
      <p>ClonoPlot provides a user-friendly GUI to visualize observations in comparative BCR and TCR repertoire analysis (Fig. <xref rid="Fig1" ref-type="fig">1</xref>
<xref rid="Fig1" ref-type="fig">c</xref>). It removes any requirement for users to become familiar with the programming language R in order to create high-quality figures (Fig. <xref rid="Fig1" ref-type="fig">1</xref>
<xref rid="Fig1" ref-type="fig">c</xref>, ii–V.). The desired figure types can be selected from within the GUI. ClonoPlot offers the following features: 
<list list-type="bullet"><list-item><p>A tab-delimited file format with clonotype sequence information, e.g. their DNA sequence, its translation to amino acids and their abundances, is imported from ClonoCalc. The table may be offered in CSV or XLS format, similar to the output format of the MiXCR software.</p></list-item><list-item><p>Primary descriptive analyses are performed by wrapping the tcR package [<xref ref-type="bibr" rid="CR5">5</xref>].</p></list-item><list-item><p>Comparative statistical analyses are offered with support of the RCircos package [<xref ref-type="bibr" rid="CR6">6</xref>], Venn diagrams generated by the gplots package and custom routines to assess the differences between samples.</p></list-item><list-item><p>ClonoPlot stores the program state and supports profiles to allow for quick transitions between multiple projects or configurations. A preview mode allows the user to review and save specific visualizations. A batch mode allows multiple plots to be created and saved at once.</p></list-item><list-item><p>The set of available diagram types can be extended, if required, to meet local demands. To do so, the user provides a custom R script file in ClonoPlot’s working directory. ClonoPlot will automatically read this script and makes the new plot type available in the GUI.</p></list-item></list>
</p>
      <p>ClonoPlot’s Java front-end communicates with the R extension Rserve [<xref ref-type="bibr" rid="CR8">8</xref>] which itself maintains the underlying R session (see Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S1). Furthermore, the R back-end brings the full language support including all packages and the ability to start third-party executables for integration into the visualization process. The Java application parses R documentation headers from the script files and displays information on available functions and their arguments in the GUI. Moreover, errors occurring in the R back-end will be displayed in the GUI, allowing scripts to react to possible user errors and return comprehensible error messages. To ensure reproducibility the batch mode provides the option to save the complete R workspace and all executed commands. Consequently, every step leading to the final plot has full provenance and can be audited and verified.</p>
    </sec>
  </sec>
  <sec id="Sec5">
    <title>Results and discussion</title>
    <p>NGS technologies enable deep analysis of repertoires and their diversity and facilitate the investigation of immune functions in health and disease. The available data is huge and analysis is not practical without dedicated tools. Therefore there is a strong demand for bioinformatic pipelines for comparative analyses of BCR and TCR repertoires.</p>
    <p>The approach we developed has been accepted by local practical colleagues both as a way to reduce their workload and to become familiar with the underlying technology. It combines well tested and robust tools for primary (from FASTQ format to clonotype determination) and advanced BCR and TCR analysis (comparative and statistical approaches) and extends several functions.</p>
    <p>We provide two executables to support the common workflow in a lab environment. First, ClonoCalc works on data as directly retrieved from the sequencer to identify the clonotypes. This first step considerably reduces the data size for downstream comparative analyses with ClonoPlot. ClonoCalc is expected to be executed only once per project by a more technical person on powerful hardware. ClonoPlot is more likely to be executed with a scientific question in mind and analyses rerun with parameters changed. Together, ClonoCalc and ClonoPlot provide a complete analysis pipeline (see comparison in Table <xref rid="Tab1" ref-type="table">1</xref>).
<table-wrap id="Tab1"><label>Table 1</label><caption><p>Feature comparison of ClonoCalc/ClonoPlot, MiXCR [<xref ref-type="bibr" rid="CR3">3</xref>], LymAnalyzer [<xref ref-type="bibr" rid="CR4">4</xref>], tcR [<xref ref-type="bibr" rid="CR5">5</xref>] and VDJtools [<xref ref-type="bibr" rid="CR9">9</xref>]</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left"/><th align="left">ClonoCalc/ClonoPlot</th><th align="left">MiXCR</th><th align="left">LymAnalyzer</th><th align="left">tcR &amp; VDJtools</th></tr></thead><tbody><tr><td align="justify">GUI</td><td align="left"><inline-graphic xlink:href="12859_2017_1575_Figa_HTML.gif" id="d29e597"/></td><td align="left">✕</td><td align="left">✔</td><td align="justify">✕</td></tr><tr><td align="justify">Demultiplexing</td><td align="left">✔ (wraps FASTX)</td><td align="left">✔</td><td align="left">✕</td><td align="justify">✕</td></tr><tr><td align="justify">Paired-end merging</td><td align="left">✔</td><td align="left">✔</td><td align="left">✕</td><td align="justify">✕</td></tr><tr><td align="justify">TCR/Immunoglobulins</td><td align="left">✔ (wraps MiXCR)</td><td align="left">✔</td><td align="left">✔</td><td align="justify">✕</td></tr><tr><td align="justify">CDR3 Extraction, including error correction</td><td align="left">✔ (wraps MiXCR)</td><td align="left">✔</td><td align="left">✔</td><td align="justify">✕</td></tr><tr><td align="justify">V, D and J gene alignment</td><td align="left">✔ (wraps MiXCR)</td><td align="left">✔</td><td align="left">✔</td><td align="justify">✕</td></tr><tr><td align="justify">Evaluation of relative/absolute frequency of clonotypes</td><td align="left">✔</td><td align="left">✕</td><td align="left">✕</td><td align="justify">✔</td></tr><tr><td align="justify">Statistics (CDR3 length, VJ gene usage)</td><td align="left">✔ (wraps tcR)</td><td align="left">✕</td><td align="left">✕</td><td align="justify">✔</td></tr><tr><td align="justify">Descriptive statistics providing means and standard deviation (CDR3 length, VJ gene usage)</td><td align="left"><inline-graphic xlink:href="12859_2017_1575_Figb_HTML.gif" id="d29e728"/></td><td align="left">✕</td><td align="left">✕</td><td align="justify">✕</td></tr><tr><td align="justify">CDR3 intersection plots, like heatmaps and</td><td align="left">✔</td><td align="left">✕</td><td align="left">✕</td><td align="justify">✔</td></tr><tr><td align="justify">Venn diagrams</td><td align="left"><inline-graphic xlink:href="12859_2017_1575_Figc_HTML.gif" id="d29e763"/></td><td align="left">✕</td><td align="left">✕</td><td align="justify">✕</td></tr><tr><td align="justify">Circular visualization of similarities and differences</td><td align="left"><inline-graphic xlink:href="12859_2017_1575_Figd_HTML.gif" id="d29e783"/></td><td align="left">✕</td><td align="left">✕</td><td align="justify">✕</td></tr><tr><td align="justify">Automated documentation of all analysis steps</td><td align="left"><inline-graphic xlink:href="12859_2017_1575_Fige_HTML.gif" id="d29e802"/></td><td align="left">✕</td><td align="left">✕</td><td align="justify">✕</td></tr></tbody></table><table-wrap-foot><p>Novel contributions from ClonoPlot/ClonoCalc are highlighted in green</p></table-wrap-foot></table-wrap>
</p>
    <p>Table <xref rid="Tab1" ref-type="table">1</xref> provides a feature comparison of ClonoCalc and ClonoPlot with a selection of similar tools from a broader overview in the supplement to the paper accompanying VDJtools [<xref ref-type="bibr" rid="CR9">9</xref>]. ClonoCalc provides a GUI that combines all sub-tasks of raw data processing. ClonoPlot in particular wraps existing tools such as the tcR package for visualization and contributes additional functions for advanced and comparative analyses of BCR/TCR repertoires as summarized in Table <xref rid="Tab1" ref-type="table">1</xref>.</p>
    <p>We found other GUI-enabled tools such as LymAnalyzer lacking in features for analysis or pre-processing. Command-line tools such as MiXCR and VDJtools provide primary and descriptive analyses for BCR and TCR repertoires but lack a GUI [<xref ref-type="bibr" rid="CR3">3</xref>, <xref ref-type="bibr" rid="CR4">4</xref>, <xref ref-type="bibr" rid="CR9">9</xref>].</p>
    <p>ClonoCalc and ClonoPlot together with accompanying documentation can be freely downloaded. Both tools can be executed on Linux, MacOS and Windows. The applications are modular and as such advanced users can adapt it to the latest developments in the field or incorporate additional features based on their existing in-house expertise. An alternative to the direct implementation using Java and incorporating R would have been the deployment of custom workflows built upon generic workflow engines. Due to the relative simplicity of the underlying processes, we considered this approach unduly complicated.</p>
    <p>Web-based applications come with the advantage that no local software has to be installed and that multiple projects can be run in parallel. However, data privacy considerations together with the multi-user support required of a central server solution led us to prefer the development of a tool suitable for installation on a local computer.</p>
  </sec>
  <sec id="Sec6" sec-type="conclusion">
    <title>Conclusion</title>
    <p>Our two new introduced programs implement a complete workflow for the analysis of B and T cell repertoires from raw data in a way that is more readily accessible to scientist and technicians. These tools enable immunologists unfamiliar with computational languages to investigate immune repertoires and produce publication-ready figures. ClonoCalc expects raw data for primary analyses to determine human or animal BCR and TCR clonotypes. Subsequently, ClonoPlot provides descriptive and comparative statistical analysis for visualization. ClonoCalc and ClonoPlot provide a GUI, reducing barriers for less experienced users and providing a guide to scientists.</p>
  </sec>
  <sec id="Sec7">
    <title>Availability and requirements</title>
    <p><bold>Project home page:</bold><ext-link ext-link-type="uri" xlink:href="https://bitbucket.org/ClonoSuite/clonocalc-plot">https://bitbucket.org/ClonoSuite/clonocalc-plot</ext-link>.The source code contains self generated sample raw sequence data from murine spleen.<bold>Operating systems:</bold> Linux, MacOS X, Windows<bold>Programming language:</bold> R, Java.<bold>License:</bold> GNU GPL v3</p>
  </sec>
</body>
<back>
  <app-group>
    <app id="App1">
      <sec id="Sec8">
        <title>Additional file</title>
        <p>
          <media position="anchor" xlink:href="12859_2017_1575_MOESM1_ESM.pdf" id="MOESM1">
            <label>Additional file 1</label>
            <caption>
              <p><bold>Figure S1.</bold> Component diagram shows the software architecture of ClonoPlot. (PDF 22 kb)</p>
            </caption>
          </media>
        </p>
      </sec>
    </app>
  </app-group>
  <glossary>
    <title>Abbreviations</title>
    <def-list>
      <def-item>
        <term>BCR</term>
        <def>
          <p>B cell receptor</p>
        </def>
      </def-item>
      <def-item>
        <term>CDR</term>
        <def>
          <p>Complementarity determining region</p>
        </def>
      </def-item>
      <def-item>
        <term>IG</term>
        <def>
          <p>Immune globulin</p>
        </def>
      </def-item>
      <def-item>
        <term>GUI</term>
        <def>
          <p>Graphical User Interface</p>
        </def>
      </def-item>
      <def-item>
        <term>NGS</term>
        <def>
          <p>Next generation sequencing</p>
        </def>
      </def-item>
      <def-item>
        <term>TCR</term>
        <def>
          <p>T cell receptor</p>
        </def>
      </def-item>
    </def-list>
  </glossary>
  <ack>
    <title>Acknowledgements</title>
    <p>The authors gratefully acknowledge the support and advice by Jürgen Westermann and other colleagues at the Institute of Anatomy. The logo was kindly designed by Friedrich Gottelt. Richard Holland is thanked for language editing. We thank the anonymous reviewers for testing our software and their helpful comments.</p>
    <sec id="d29e877">
      <title>Funding</title>
      <p>This work was funded by the Excellence Cluster Inflammation at Interfaces EXC306 and by the SFB 654 from the German Research Foundation. This project has received funding from the European Union’s Horizon 2020 research and innovation programme under Grant agreement No 633589 and benefited from EU COST "cHiPSet" (IC1406). This publication reflects only the authors’ views and the Commission is not responsible for any use that may be made of the information it contains.</p>
    </sec>
    <sec id="d29e882">
      <title>Authors’ contributions</title>
      <p>AF specified the requirements for the software. MK and FL implemented the Graphical User Interface under the supervision of AF, ND and ML. SM contributed R scripts for the visualization, designed with AF and KK. All authors contributed to the manuscript, read and approved it.</p>
    </sec>
    <sec id="d29e887">
      <title>Competing interests</title>
      <p>The authors declare that they have no competing interests.</p>
    </sec>
    <sec id="d29e892">
      <title>Consent for publication</title>
      <p>Not applicable.</p>
    </sec>
    <sec id="d29e897">
      <title>Ethics approval and consent to participate</title>
      <p>Not applicable.</p>
    </sec>
    <sec id="d29e902">
      <title>Publisher’s Note</title>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </sec>
  </ack>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nikolich-Zugich</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Slifka</surname>
            <given-names>MK</given-names>
          </name>
          <name>
            <surname>Messaoudi</surname>
            <given-names>I</given-names>
          </name>
        </person-group>
        <article-title>The many important facets of T-cell repertoire diversity</article-title>
        <source>Nat Rev Immun</source>
        <year>2004</year>
        <volume>4</volume>
        <fpage>123</fpage>
        <lpage>32</lpage>
        <pub-id pub-id-type="doi">10.1038/nri1292</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Six</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Mariotti-Ferrandiz</surname>
            <given-names>ME</given-names>
          </name>
          <name>
            <surname>Chaara</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Magadan</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Pham</surname>
            <given-names>HP</given-names>
          </name>
          <name>
            <surname>Lefranc</surname>
            <given-names>MP</given-names>
          </name>
          <name>
            <surname>Mora</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Thomas-Vaslin</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Walczak</surname>
            <given-names>AM</given-names>
          </name>
          <name>
            <surname>Boudinot</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>The past, present, and future of immune repertoire biology – The rise of next-generation repertoire analysis</article-title>
        <source>Front Immunol</source>
        <year>2014</year>
        <volume>3</volume>
        <fpage>413</fpage>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bolotin</surname>
            <given-names>DA</given-names>
          </name>
          <name>
            <surname>Poslavsky</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Mitrophanov</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Shugay</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Mamedov</surname>
            <given-names>IZ</given-names>
          </name>
          <name>
            <surname>Putintseva</surname>
            <given-names>EV</given-names>
          </name>
          <name>
            <surname>Chudakov</surname>
            <given-names>DM</given-names>
          </name>
        </person-group>
        <article-title>MiXCR: software for comprehensive adaptive immunity profiling</article-title>
        <source>Nat Methods</source>
        <year>2015</year>
        <volume>12</volume>
        <fpage>380</fpage>
        <lpage>1</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.3364</pub-id>
        <?supplied-pmid 25924071?>
        <pub-id pub-id-type="pmid">25924071</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yu</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Ceredig</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Seoighe</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>LymAnalyzer: a tool for comprehensive analysis of next generation sequencing data of T cell receptors and immunoglobulins</article-title>
        <source>Nucleic Acids Res</source>
        <year>2016</year>
        <volume>4</volume>
        <fpage>4</fpage>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nazarov</surname>
            <given-names>VI</given-names>
          </name>
          <name>
            <surname>Pogorelyy</surname>
            <given-names>MV</given-names>
          </name>
          <name>
            <surname>Komech</surname>
            <given-names>EA</given-names>
          </name>
          <name>
            <surname>Zvyagin</surname>
            <given-names>IV</given-names>
          </name>
          <name>
            <surname>Bolotin</surname>
            <given-names>DA</given-names>
          </name>
          <name>
            <surname>Shugay</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Chudakov</surname>
            <given-names>DM</given-names>
          </name>
          <name>
            <surname>Mamedov</surname>
            <given-names>IZ</given-names>
          </name>
        </person-group>
        <article-title>tcR: an R package for T cell receptor repertoire advanced data analysis</article-title>
        <source>BMC Bioinforma</source>
        <year>2015</year>
        <volume>16</volume>
        <fpage>175</fpage>
        <lpage>80</lpage>
        <pub-id pub-id-type="doi">10.1186/s12859-015-0613-1</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhang</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Meltzer</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Davis</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>RCircos: an R package for Circos 2D track plots</article-title>
        <source>BMC Bioinforma</source>
        <year>2013</year>
        <volume>14</volume>
        <fpage>244</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-14-244</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7</label>
      <mixed-citation publication-type="other">Gordon A. FASTX Barcode Splitter. <ext-link ext-link-type="uri" xlink:href="http://hannonlab.cshl.edu/fastx_toolkit/">http://hannonlab.cshl.edu/fastx_toolkit/</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR8">
      <label>8</label>
      <mixed-citation publication-type="other">Urbanek S. Rserve - A Fast Way to Provide R Functionality to Applications. In: Proc. of the 3rd International Workshop on Distributed Statistical Computing. DSC: 2003. p. 1609–395. ISSN 1609-395X.</mixed-citation>
    </ref>
    <ref id="CR9">
      <label>9</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Shugay</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Bagaev</surname>
            <given-names>DV</given-names>
          </name>
          <name>
            <surname>Turchaninova</surname>
            <given-names>MA</given-names>
          </name>
          <name>
            <surname>Bolotin</surname>
            <given-names>DA</given-names>
          </name>
          <name>
            <surname>Britanova</surname>
            <given-names>OV</given-names>
          </name>
          <name>
            <surname>Putintseva</surname>
            <given-names>EV</given-names>
          </name>
        </person-group>
        <article-title>VDJtools: Unifying Post-analysis of T Cell Receptor Repertoires</article-title>
        <source>PLOS Comput Biol</source>
        <year>2015</year>
        <volume>11</volume>
        <fpage>e1004503</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pcbi.1004503</pub-id>
        <?supplied-pmid 26606115?>
        <pub-id pub-id-type="pmid">26606115</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
