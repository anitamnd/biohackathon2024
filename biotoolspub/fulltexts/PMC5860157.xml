<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1 20151215//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.1?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">5860157</article-id>
    <article-id pub-id-type="pmid">29121169</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btx700</article-id>
    <article-id pub-id-type="publisher-id">btx700</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Applications Notes</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Genome Analysis</subject>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>MOAT: efficient detection of highly mutated regions with the Mutations Overburdening Annotations Tool</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">http://orcid.org/0000-0003-2655-8494</contrib-id>
        <name>
          <surname>Lochovsky</surname>
          <given-names>Lucas</given-names>
        </name>
        <xref ref-type="aff" rid="btx700-aff1">1</xref>
        <xref ref-type="aff" rid="btx700-aff2">2</xref>
        <xref ref-type="author-notes" rid="btx700-FM1"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Zhang</surname>
          <given-names>Jing</given-names>
        </name>
        <xref ref-type="aff" rid="btx700-aff1">1</xref>
        <xref ref-type="aff" rid="btx700-aff2">2</xref>
        <xref ref-type="author-notes" rid="btx700-FM1"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Gerstein</surname>
          <given-names>Mark</given-names>
        </name>
        <xref ref-type="aff" rid="btx700-aff1">1</xref>
        <xref ref-type="aff" rid="btx700-aff2">2</xref>
        <xref ref-type="aff" rid="btx700-aff3">3</xref>
        <xref ref-type="corresp" rid="btx700-cor1"/>
        <!--<email>mark@gersteinlab.org</email>-->
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Berger</surname>
          <given-names>Bonnie</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <aff id="btx700-aff1"><label>1</label>Program in Computational Biology and Bioinformatics, Yale University, New Haven, CT, USA</aff>
    <aff id="btx700-aff2"><label>2</label>Department of Molecular Biophysics and Biochemistry, Yale University, New Haven, CT, USA</aff>
    <aff id="btx700-aff3"><label>3</label>Department of Computer Science, Yale University, New Haven, CT, USA</aff>
    <author-notes>
      <fn id="btx700-FM1">
        <p>The authors wish it to be known that, in their opinion, Lucas Lochovsky and Jing Zhang authors should be regarded as Joint First Authors.</p>
      </fn>
      <corresp id="btx700-cor1">To whom correspondence should be addressed. Email: <email>mark@gersteinlab.org</email></corresp>
    </author-notes>
    <pub-date pub-type="ppub">
      <day>15</day>
      <month>3</month>
      <year>2018</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2017-11-24">
      <day>24</day>
      <month>11</month>
      <year>2017</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>24</day>
      <month>11</month>
      <year>2017</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the <pub-date pub-type="epub"/>. -->
    <volume>34</volume>
    <issue>6</issue>
    <fpage>1031</fpage>
    <lpage>1033</lpage>
    <history>
      <date date-type="received">
        <day>08</day>
        <month>5</month>
        <year>2017</year>
      </date>
      <date date-type="rev-recd">
        <day>19</day>
        <month>9</month>
        <year>2017</year>
      </date>
      <date date-type="accepted">
        <day>6</day>
        <month>11</month>
        <year>2017</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author 2017. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2017</copyright-year>
      <license xlink:href="http://creativecommons.org/licenses/by-nc/4.0/" license-type="cc-by-nc">
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by-nc/4.0/">http://creativecommons.org/licenses/by-nc/4.0/</ext-link>), which permits non-commercial re-use, distribution, and reproduction in any medium, provided the original work is properly cited. For commercial re-use, please contact journals.permissions@oup.com</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btx700.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Summary</title>
        <p>Identifying genomic regions with higher than expected mutation count is useful for cancer driver detection. Previous parametric approaches require numerous cell-type-matched covariates for accurate background mutation rate (BMR) estimation, which is not practical for many situations. Non-parametric, permutation-based approaches avoid this issue but usually suffer from considerable compute-time cost. Hence, we introduce Mutations Overburdening Annotations Tool (MOAT), a non-parametric scheme that makes no assumptions about mutation process except requiring that the BMR changes smoothly with genomic features. MOAT randomly permutes single-nucleotide variants, or target regions, on a relatively large scale to provide robust burden analysis. Furthermore, we show how we can do permutations in an efficient manner using graphics processing unit acceleration, speeding up the calculation by a factor of ∼250.</p>
      </sec>
      <sec id="s2">
        <title>Availability and implementation</title>
        <p>MOAT is available at <ext-link ext-link-type="uri" xlink:href="http://moat.gersteinlab.org">moat.gersteinlab.org</ext-link>.</p>
      </sec>
      <sec id="s4">
        <title>Supplementary information</title>
        <p><xref ref-type="supplementary-material" rid="sup1">Supplementary data</xref> are available at <italic>Bioinformatics</italic> online.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <named-content content-type="funder-name">National Institutes of Health</named-content>
          <named-content content-type="funder-identifier">10.13039/100000002</named-content>
        </funding-source>
        <award-id>5U41HG007000-04</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="3"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>A common analysis strategy in cancer driver detection is to look for genomic elements with high variant accumulation across patients. However, the background mutation rate (BMR) is highly heterogeneous across the genome due to numerous influences. Inaccurate modeling of BMRs could in turn introduce false positives into cancer driver detection. Our Mutations Overburdening Annotations Tool (MOAT) differs from parametric schemes and does not make any assumption except that the BMR remains constant within a local context.</p>
    <p>MOAT offers an annotation-centric algorithm (MOAT-a), a variant-centric algorithm (MOAT-v) and a somatic variant simulator (MOAT-s) built on MOAT-v’s variant placement algorithm. Moreover, we can use MOAT to gauge the functional impact burden of annotations relative to the surrounding genome. MOAT is useful for comparing observed and permuted variant impact scores. Here, we provide an example using FunSeq2 scores (<xref rid="btx700-B2" ref-type="bibr">Fu <italic>et al.</italic>, 2014</xref>). In the following sections, we describe MOAT’s implementation and recall of known non-coding cancer drivers.</p>
  </sec>
  <sec>
    <title>2 Materials and methods</title>
    <p>Several covariates jointly affect the BMR in a complicated and dynamic manner, making variant burden analysis very challenging (<xref rid="btx700-B5" ref-type="bibr">Lawrence <italic>et al.</italic>, 2013</xref>). The length of the test region usually varies from hundreds to thousands of bases, while external features such as replication timing can work at up to a megabase resolution. To address these challenges, MOAT circumvents the need for parametric models by explicitly permuting the variants or annotations within a region where the levels of all the covariates are essentially constant. One important issue with these permutation algorithms is that their running times do not scale well to whole-genome annotation sets. We addressed this issue by taking advantage of large-scale graphics processing unit (GPU) parallelization.</p>
    <sec>
      <title>2.1 MOAT-a: annotation-centric permutation</title>
      <p>MOAT requires two input files: an annotation file (<italic>afile</italic>) and a variant file (<italic>vfile</italic>). MOAT-a uses NVIDIA’s compute unified device architecture language (<xref rid="btx700-B6" ref-type="bibr">Nickolls <italic>et al.</italic>, 2008</xref>) for general-purpose GPU acceleration (<xref ref-type="fig" rid="btx700-F1">Fig. 1a</xref>). MOAT-a iterates through each annotation, computing the intersecting variant count. It defines a genomic block with user-defined boundaries for permuting the annotation <italic>n</italic> times. MOAT-a then finds the variant counts of the <italic>n</italic> random bins and compares them to the annotation’s observed variant count to provide empirical <italic>P</italic>-values. When MOAT-a is used with a variant impact signal file, it generates observed and permuted annotation impact scores by summing the intersecting variants’ impact scores to calculate <italic>P</italic>-values.
</p>
      <fig id="btx700-F1" orientation="portrait" position="float">
        <label>Fig. 1</label>
        <caption>
          <p>(<bold>a</bold>) MOAT-a shuffles each annotation to a new location within the local genome context bounded by user-defined parameters <italic>d_min</italic> and <italic>d_max</italic>, producing <italic>n</italic> permutations. (<bold>b</bold>) In MOAT-v, the whole genome is divided into bins of user-defined width <italic>W</italic>, within which variants are moved to new coordinates, thereby preserving the local mutation context. As with MOAT-a, MOAT-v produces <italic>n</italic> permutations. (<bold>c</bold>) MOAT-s bins the entire genome, whereupon it calculates the covariate values for each bin. The program then clusters bins with similar covariate values, represented here as bins with the same color (we refer to these clusters as equivalence classes). The input variants that fall within each cluster are then permuted to new locations chosen from the bins within the same cluster, honoring trinucleotide context preservation if requested</p>
        </caption>
        <graphic xlink:href="btx700f1"/>
      </fig>
      <p>We can adjust the boundaries of the intervals for choosing permuted annotations—<italic>d_min</italic> and <italic>d_max</italic>—to scale the surrounding genome context with respect to the size of the original annotation. Ideally, the permutation intervals will provide enough range to enable non-overlapping sampling. As a rule of thumb, the choice of <italic>d_min</italic> should be large enough to avoid potential mutation burden signal from ‘bleeding’ into the permutation intervals. Simultaneously, the selected <italic>d_max</italic> must be small enough that the BMR covariates remain approximately constant within the permutation intervals. For example, in our analysis of transcription start site(s) (TSS) mutation burdens, where TSS are roughly 100 bp in length, we used a <italic>d_min</italic> of 2 kb and a <italic>d_max</italic> of 50 kb.</p>
    </sec>
    <sec>
      <title>2.2 MOAT-v: variant-centric permutation</title>
      <p>MOAT-v creates permuted datasets by assigning new coordinates to each variant within a local genomic region to account for the covariate effects from known genomic features (<xref ref-type="fig" rid="btx700-F1">Fig. 1</xref>). MOAT-v and MOAT-s offer the option to preserve the trinucleotide context of the original variant when choosing a new variant location (see <xref ref-type="supplementary-material" rid="sup1">Supplementary Material</xref>). This constraint reflects the differential mutation probabilities of different trinucleotides while preserving the mutational signatures. MOAT-v generates a permuted dataset by subdividing the genome into blocks of a user-defined size within which variants are permuted, thus generating <italic>n</italic> permutations (<xref ref-type="fig" rid="btx700-F1">Fig. 1b</xref>). We can determine the empirical <italic>P</italic>-value for each annotation based on the fraction of permutations with variants equal to or greater than the observed variant count. Unlike MOAT-a, we designed MOAT-v to parallelize its workflow across multiple central processing unit (CPU) cores using the OpenMPI framework (<xref rid="btx700-B3" ref-type="bibr">Gabriel <italic>et al.</italic>, 2004</xref>), due to the more memory intensive nature of the trinucleotide context preservation.</p>
      <p>The ability to adjust the width of the whole-genome bins in MOAT-v enables users to select a width that represents regions in which the BMR covariates are expected to be approximately constant. Hence, the permutations that MOAT-v creates will honor the expected density of regional mutations due to these covariates. Our analyses of a few of the most significant covariates, such as DNA replication timing, histone marks and guanine–cytosine content, indicate that a suitable bin size range is 50–100 kb (see <xref ref-type="supplementary-material" rid="sup1">Supplementary Material</xref>).</p>
    </sec>
    <sec>
      <title>2.3 MOAT-s: simulated somatic variant datasets</title>
      <p>In addition to the main MOAT programs, we developed a variant simulator, MOAT-s, which reflects the levels of whole-genome covariates that directly influence the BMR. MOAT-s evaluates covariate signals over a set of whole-genome bins. The simulator then clusters these bins based on their covariate signal profiles and allows variants to be permuted not just within their local genome context, but across all bins that share the same covariate signal profile (i.e. across bins in the same equivalence class). Specifically, MOAT-s clusters the whole-genome bins using <italic>k</italic> means, which use the distances between the bins’ covariate signal profiles to group them into a pre-defined number of clusters (see <xref ref-type="supplementary-material" rid="sup1">Supplementary Material</xref>).</p>
    </sec>
  </sec>
  <sec>
    <title>3 Results</title>
    <sec>
      <title>3.1 MOAT-a</title>
      <p>We demonstrated the parallel speedup by running MOAT-a on datasets of various sizes. Using a dataset of ∼8 million cancer variants from <xref rid="btx700-B1" ref-type="bibr">Alexandrov <italic>et al.</italic> (2013)</xref> and <xref rid="btx700-B8" ref-type="bibr">Wang <italic>et al.</italic> (2014)</xref>, we used three different annotation sets to demonstrate the scalability of MOAT-a (<xref rid="btx700-B4" ref-type="bibr">Harrow <italic>et al.</italic>, 2012</xref>; <xref rid="btx700-B7" ref-type="bibr">Thurman <italic>et al.</italic>, 2012</xref>; <xref rid="btx700-B9" ref-type="bibr">Yip <italic>et al.</italic>, 2012</xref>). We demonstrate that the GPU version of MOAT-a scales very well with respect to the number of annotations (e.g. ∼9-fold speedup on ∼3 million annotations), and with respect to the number of permutations (e.g. ∼256-fold speedup on 100 000 permutations), resulting in dramatically improved running times (<xref ref-type="supplementary-material" rid="sup1">Supplementary Table S1</xref>).</p>
      <p>Due to the lack of a gold standard, assessing MOAT’s predictions is challenging. Nevertheless, we used the aforementioned cancer variant dataset to demonstrate how MOAT-a can find elevated mutation burdens in genomic elements by identifying highly mutated GENCODE elements. TERT, which has well-documented cancer-associated promoter mutations, carried a significant mutation burden. Other well-known cancer-associated TSS, such as TP53, LMO3 and AGAP5, also had significant mutation burdens.</p>
    </sec>
    <sec>
      <title>3.2 MOAT-v and MOAT-s</title>
      <p>Using the same set of cancer variants as in the MOAT-a tests, we evaluated MOAT-v’s running time. The running time scales close to linear with the number of CPUs, indicating an even division of labor between each CPU core. MOAT-s’s running time exhibited similar characteristics (data not shown).</p>
      <p>We then applied MOAT-v on the same variant and annotation sets to find elevated cancer mutation burdens. MOAT-v produced comparable results as MOAT-a, flagging the same known cancer-associated TSS as significant.</p>
    </sec>
  </sec>
  <sec>
    <title>4 Discussion</title>
    <p>Here, we introduce MOAT, a new software tool to facilitate identification of high mutation burden. We demonstrate the usefulness of this tool for flagging putative non-coding cancer drivers and provide parallelized versions that dramatically improve running time. Given the demand for efficient and meaningful analysis of genome sequence data, which scientists are producing at very high rates, we believe that MOAT’s provision of such analysis for genetic disease drivers is timely.</p>
  </sec>
  <sec>
    <title>Funding</title>
    <p>This work was supported by the National Institutes of Health [grant number 5U41HG007000-04].</p>
    <p><italic>Conflict of Interest</italic>: none declared.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material content-type="local-data" id="sup1">
      <label>Supplementary Data</label>
      <media xlink:href="btx700_moat_supplementary_text_08.31.2017.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ref-list>
    <title>References</title>
    <ref id="btx700-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Alexandrov</surname><given-names>L.B.</given-names></name></person-group><etal>et al</etal> (<year>2013</year>) 
<article-title>Signatures of mutational processes in human cancer</article-title>. <source>Nature</source>, <volume>500</volume>, <fpage>415</fpage>–<lpage>421</lpage>.<pub-id pub-id-type="pmid">23945592</pub-id></mixed-citation>
    </ref>
    <ref id="btx700-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Fu</surname><given-names>Y.</given-names></name></person-group><etal>et al</etal> (<year>2014</year>) 
<article-title>FunSeq2: a framework for prioritizing noncoding regulatory variants in cancer</article-title>. <source>Genome Biol</source>., <volume>15</volume>, <fpage>480</fpage>.<pub-id pub-id-type="pmid">25273974</pub-id></mixed-citation>
    </ref>
    <ref id="btx700-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Gabriel</surname><given-names>E.</given-names></name></person-group><etal>et al</etal> (<year>2004</year>) 
<article-title>Open MPI: goals, concept, and design of a next generation MPI implementation</article-title>. <source>Springer</source>, <fpage>97</fpage>–<lpage>104</lpage>.</mixed-citation>
    </ref>
    <ref id="btx700-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Harrow</surname><given-names>J.</given-names></name></person-group><etal>et al</etal> (<year>2012</year>) 
<article-title>GENCODE: the reference human genome annotation for The ENCODE Project</article-title>. <source>Genome Res</source>., <volume>22</volume>, <fpage>1760</fpage>–<lpage>1774</lpage>.<pub-id pub-id-type="pmid">22955987</pub-id></mixed-citation>
    </ref>
    <ref id="btx700-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Lawrence</surname><given-names>M.S.</given-names></name></person-group><etal>et al</etal> (<year>2013</year>) 
<article-title>Mutational heterogeneity in cancer and the search for new cancer-associated genes</article-title>. <source>Nature</source>, <volume>499</volume>, <fpage>214</fpage>–<lpage>218</lpage>.<pub-id pub-id-type="pmid">23770567</pub-id></mixed-citation>
    </ref>
    <ref id="btx700-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Nickolls</surname><given-names>J.</given-names></name></person-group><etal>et al</etal> (<year>2008</year>) 
<article-title>Scalable parallel programming w/CUDA</article-title>. <source>Queue</source>, <volume>6</volume>, <fpage>40</fpage>–<lpage>53</lpage>.</mixed-citation>
    </ref>
    <ref id="btx700-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Thurman</surname><given-names>R.E.</given-names></name></person-group><etal>et al</etal> (<year>2012</year>) 
<article-title>The accessible chromatin landscape of the human genome</article-title>. <source>Nature</source>, <volume>489</volume>, <fpage>75</fpage>–<lpage>82</lpage>.<pub-id pub-id-type="pmid">22955617</pub-id></mixed-citation>
    </ref>
    <ref id="btx700-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Wang</surname><given-names>K.</given-names></name></person-group><etal>et al</etal> (<year>2014</year>) 
<article-title>Whole-genome sequencing and comprehensive molecular profiling identify new driver mutations in gastric cancer</article-title>. <source>Nat. Genet</source>., <volume>46</volume>, <fpage>573</fpage>–<lpage>582</lpage>.<pub-id pub-id-type="pmid">24816253</pub-id></mixed-citation>
    </ref>
    <ref id="btx700-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Yip</surname><given-names>K.Y.</given-names></name></person-group><etal>et al</etal> (<year>2012</year>) 
<article-title>Classification of human genomic regions based on experimentally determined binding sites of more than 100 transcription-related factors</article-title>. <source>Genome Biol</source>., <volume>13</volume>, <fpage>R48</fpage>.<pub-id pub-id-type="pmid">22950945</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
