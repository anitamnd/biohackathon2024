<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Int J Epidemiol</journal-id>
    <journal-id journal-id-type="iso-abbrev">Int J Epidemiol</journal-id>
    <journal-id journal-id-type="publisher-id">ije</journal-id>
    <journal-title-group>
      <journal-title>International Journal of Epidemiology</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">0300-5771</issn>
    <issn pub-type="epub">1464-3685</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10749764</article-id>
    <article-id pub-id-type="pmid">37670428</article-id>
    <article-id pub-id-type="doi">10.1093/ije/dyad122</article-id>
    <article-id pub-id-type="publisher-id">dyad122</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Software Application Profile</subject>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/MED00860</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Software Application Profile: <italic toggle="yes">dynamicLM</italic>—a tool for performing dynamic risk prediction using a landmark supermodel for survival data under competing risks</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Fries</surname>
          <given-names>Anya H</given-names>
        </name>
        <aff><institution>Quantitative Sciences Unit, Department of Medicine, Stanford University School of Medicine</institution>, Stanford, CA, <country country="US">USA</country></aff>
        <xref rid="dyad122-FM1" ref-type="author-notes"/>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0003-1315-1433</contrib-id>
        <name>
          <surname>Choi</surname>
          <given-names>Eunji</given-names>
        </name>
        <aff><institution>Quantitative Sciences Unit, Department of Medicine, Stanford University School of Medicine</institution>, Stanford, CA, <country country="US">USA</country></aff>
        <xref rid="dyad122-FM1" ref-type="author-notes"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Wu</surname>
          <given-names>Julie T</given-names>
        </name>
        <aff><institution>Division of Oncology, Department of Medicine, Stanford University School of Medicine</institution>, Stanford, CA, <country country="US">USA</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Lee</surname>
          <given-names>Justin H</given-names>
        </name>
        <aff><institution>Quantitative Sciences Unit, Department of Medicine, Stanford University School of Medicine</institution>, Stanford, CA, <country country="US">USA</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Ding</surname>
          <given-names>Victoria Y</given-names>
        </name>
        <aff><institution>Quantitative Sciences Unit, Department of Medicine, Stanford University School of Medicine</institution>, Stanford, CA, <country country="US">USA</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Huang</surname>
          <given-names>Robert J</given-names>
        </name>
        <aff><institution>Division of Gastroenterology and Hepatology, Department of Medicine, Stanford University School of Medicine</institution>, Stanford, CA, <country country="US">USA</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Liang</surname>
          <given-names>Su-Ying</given-names>
        </name>
        <aff><institution>Palo Alto Medical Foundation Research Institute, Palo Alto Medical Foundation</institution>, Palo Alto, CA, <country country="US">USA</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Wakelee</surname>
          <given-names>Heather A</given-names>
        </name>
        <aff><institution>Division of Oncology, Department of Medicine, Stanford University School of Medicine</institution>, Stanford, CA, <country country="US">USA</country></aff>
        <aff><institution>Stanford Cancer Institute</institution>, Stanford, CA, <country country="US">USA</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Wilkens</surname>
          <given-names>Lynne R</given-names>
        </name>
        <aff><institution>Cancer Epidemiology Program, University of Hawaii Cancer Center</institution>, Honolulu, HI, <country country="US">USA</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Cheng</surname>
          <given-names>Iona</given-names>
        </name>
        <aff><institution>Department of Epidemiology and Biostatistics, University of California</institution>, San Francisco, CA, <country country="US">USA</country></aff>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-2013-6883</contrib-id>
        <name>
          <surname>Han</surname>
          <given-names>Summer S</given-names>
        </name>
        <aff><institution>Quantitative Sciences Unit, Department of Medicine, Stanford University School of Medicine</institution>, Stanford, CA, <country country="US">USA</country></aff>
        <aff><institution>Stanford Cancer Institute</institution>, Stanford, CA, <country country="US">USA</country></aff>
        <aff><institution>Department of Epidemiology and Population Health, Stanford University School of Medicine</institution>, Stanford, CA, <country country="US">USA</country></aff>
        <aff><institution>Department of Neurosurgery, Stanford University School of Medicine</institution>, Stanford, CA, <country country="US">USA</country></aff>
        <xref rid="dyad122-cor1" ref-type="corresp"/>
        <!--summer.han@stanford.edu-->
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="dyad122-cor1">Corresponding author. Quantitative Sciences Unit, Department of Medicine, Department of Neurosurgery, and Department of Epidemiology and Population Health, Stanford University School of Medicine, 3180 Porter Drive, Office 118, Stanford, CA 94304, USA. E-mail: <email>summer.han@stanford.edu</email></corresp>
      <fn id="dyad122-FM1">
        <p>Anya H Fries and Eunji Choi Equal contributions.</p>
      </fn>
    </author-notes>
    <pub-date pub-type="collection">
      <month>12</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2023-09-06">
      <day>06</day>
      <month>9</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>06</day>
      <month>9</month>
      <year>2023</year>
    </pub-date>
    <volume>52</volume>
    <issue>6</issue>
    <fpage>1984</fpage>
    <lpage>1989</lpage>
    <history>
      <date date-type="received">
        <day>06</day>
        <month>10</month>
        <year>2022</year>
      </date>
      <date date-type="editorial-decision">
        <day>03</day>
        <month>8</month>
        <year>2023</year>
      </date>
      <date date-type="accepted">
        <day>24</day>
        <month>8</month>
        <year>2023</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2023. Published by Oxford University Press on behalf of the International Epidemiological Association.</copyright-statement>
      <copyright-year>2023</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="dyad122.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Motivation</title>
        <p>Providing a dynamic assessment of prognosis is essential for improved personalized medicine. The landmark model for survival data provides a potentially powerful solution to the dynamic prediction of disease progression. However, a general framework and a flexible implementation of the model that incorporates various outcomes, such as competing events, have been lacking. We present an R package, <italic toggle="yes">dynamicLM</italic>, a user-friendly tool for the landmark model for the dynamic prediction of survival data under competing risks, which includes various functions for data preparation, model development, prediction and evaluation of predictive performance.</p>
      </sec>
      <sec id="s2">
        <title>Implementation</title>
        <p><italic toggle="yes">dynamicLM</italic> as an R package.</p>
      </sec>
      <sec id="s3">
        <title>General features</title>
        <p>The package includes options for incorporating time-varying covariates, capturing time-dependent effects of predictors and fitting a cause-specific landmark model for time-to-event data with or without competing risks. Tools for evaluating the prediction performance include time-dependent area under the ROC curve, Brier Score and calibration.</p>
      </sec>
      <sec id="s4">
        <title>Availability</title>
        <p>Available on GitHub [<ext-link xlink:href="https://github.com/thehanlab/dynamicLM" ext-link-type="uri">https://github.com/thehanlab/dynamicLM</ext-link>].</p>
      </sec>
    </abstract>
    <kwd-group>
      <kwd>Landmark</kwd>
      <kwd>competing risks</kwd>
      <kwd>dynamic prediction</kwd>
      <kwd>time-dependent variables</kwd>
      <kwd>R</kwd>
    </kwd-group>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>National Institutes of Health</institution>
            <institution-id institution-id-type="DOI">10.13039/100000002</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>4R37CA226081</award-id>
        <award-id>1R01CA282793</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Stanford Cancer Institute</institution>
            <institution-id institution-id-type="DOI">10.13039/100014549</institution-id>
          </institution-wrap>
        </funding-source>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>NCI</institution>
            <institution-id institution-id-type="DOI">10.13039/100000054</institution-id>
          </institution-wrap>
        </funding-source>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="6"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec sec-type="intro">
    <title>Introduction</title>
    <p>Accurate prediction of disease prognosis is essential for effective clinical decision-making.<xref rid="dyad122-B1" ref-type="bibr"><sup>1</sup></xref> Traditional prediction models are commonly used to estimate the risk of the event of interest (e.g. mortality) at a fixed time point—such as at the time of diagnosis<xref rid="dyad122-B2" ref-type="bibr"><sup>2</sup></xref><sup>,</sup><xref rid="dyad122-B3" ref-type="bibr"><sup>3</sup></xref> or the end of curative treatment<xref rid="dyad122-B4" ref-type="bibr"><sup>4</sup></xref><sup>,</sup><xref rid="dyad122-B5" ref-type="bibr"><sup>5</sup></xref>—and thus may fail to provide updated risk estimates that can change over time.<xref rid="dyad122-B6" ref-type="bibr"><sup>6</sup></xref><sup>,</sup><xref rid="dyad122-B7" ref-type="bibr"><sup>7</sup></xref> Temporal changes in patient data can affect the subsequent risk, and incorporating these changes can help update risk estimations for optimal patient management.<xref rid="dyad122-B6" ref-type="bibr"><sup>6</sup></xref><sup>,</sup><xref rid="dyad122-B8" ref-type="bibr"><sup>8</sup></xref></p>
    <p>The landmark model<xref rid="dyad122-B6" ref-type="bibr"><sup>6</sup></xref><sup>,</sup><xref rid="dyad122-B8" ref-type="bibr"><sup>8–10</sup></xref> and joint modeling<xref rid="dyad122-B11" ref-type="bibr"><sup>11</sup></xref><sup>,</sup><xref rid="dyad122-B12" ref-type="bibr"><sup>12</sup></xref> are two approaches used for dynamic prediction for survival data. Joint modeling can provide accurate estimates by simultaneously modeling the longitudinal markers and time-to-event outcome, but it is computationally intensive and requires more modelling assumptions. Alternatively the landmark model, built based on the concept of ongoing risk assessment times (i.e. landmarks) following the baseline, reduces the computational burden to provide updated risk estimates for large-scale data. Specifically, the dataset is transformed into multiple censored datasets based on a prediction window of interest and predefined landmarks. A model is then fitted on this stacked dataset (i.e. supermodel) that incorporates the dynamic trajectories of the patients, which can be used to provide the most up-to-date risk predictions.</p>
    <p>Most landmark models for dynamic prediction have been applied in the context of standard survival outcomes using the Cox model.<xref rid="dyad122-B6" ref-type="bibr"><sup>6</sup></xref><sup>,</sup><xref rid="dyad122-B9" ref-type="bibr"><sup>9</sup></xref><sup>,</sup><xref rid="dyad122-B10" ref-type="bibr"><sup>10</sup></xref> However, it is often observed that other causes of failure (i.e. competing events) may preclude the occurrence of the event of interest. Ignoring competing risks from prediction can lead to an overestimation of the risk.<xref rid="dyad122-B13" ref-type="bibr"><sup>13–15</sup></xref> The cause-specific Cox (CSC) model<xref rid="dyad122-B16" ref-type="bibr"><sup>16</sup></xref> is one solution that combines several fitted Cox models to avoid the overestimation of the predicted risk.<xref rid="dyad122-B15" ref-type="bibr"><sup>15</sup></xref> There have been efforts to incorporate competing risks into dynamic prediction,<xref rid="dyad122-B10" ref-type="bibr"><sup>10</sup></xref><sup>,</sup><xref rid="dyad122-B14" ref-type="bibr"><sup>14</sup></xref><sup>,</sup><xref rid="dyad122-B17" ref-type="bibr"><sup>17</sup></xref><sup>,</sup><xref rid="dyad122-B18" ref-type="bibr"><sup>18</sup></xref> but they lack a user-friendly implementation. Furthermore, practical evaluations (e.g. computational feasibility) of the dynamic landmark model for competing-risk data have been lacking.</p>
    <p>We introduce an R package, <italic toggle="yes">dynamicLM</italic>, a tool to implement the landmark model for dynamic predictions using survival data incorporating competing risks. The package provides a framework including data preparation, model fitting, prediction, evaluation and visualization. We illustrate this method by applying it to predict second primary lung cancer risk from the Multiethnic Cohort Study<xref rid="dyad122-B19" ref-type="bibr"><sup>19</sup></xref> with a set of simulations.</p>
  </sec>
  <sec>
    <title>Implementation</title>
    <p>The <italic toggle="yes">dynamicLM</italic> tool provides a simple framework to perform dynamic <inline-formula id="IE1"><mml:math id="IM1" display="inline" overflow="scroll"><mml:mi>w</mml:mi></mml:math></inline-formula>-year risk predictions, i.e. predicting the risk of developing the event of interest within <inline-formula id="IE2"><mml:math id="IM2" display="inline" overflow="scroll"><mml:mi>w</mml:mi></mml:math></inline-formula> years from each risk assessment. Risk prediction for the next <inline-formula id="IE3"><mml:math id="IM3" display="inline" overflow="scroll"><mml:mi>w</mml:mi></mml:math></inline-formula> years is made at baseline (e.g. diagnosis) and at a later set of risk assessment times (‘landmark’ times).</p>
    <p>Input data can take various forms; covariates can be static (e.g. race), time-varying (e.g. biomarker changes) or a mix. Time-varying covariates can be in long or wide formats. Outcomes can be time-to-event for one cause (standard survival data) or a specific event in the presence of competing event(s). <italic toggle="yes">dynamicLM</italic> includes implementations of the Cox landmark model for standard survival data and the CSC landmark model for competing risk data.</p>
    <p>The hazard of each cause-specific landmark supermodel for cause <inline-formula id="IE4"><mml:math id="IM4" display="inline" overflow="scroll"><mml:mi>j</mml:mi></mml:math></inline-formula> (<inline-formula id="IE5"><mml:math id="IM5" display="inline" overflow="scroll"><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mi>C</mml:mi><mml:mo>)</mml:mo></mml:math></inline-formula> from a landmark time <inline-formula id="IE6"><mml:math id="IM6" display="inline" overflow="scroll"><mml:mi>s</mml:mi><mml:mo>∈</mml:mo><mml:mfenced open="[" close="]" separators="|"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:mfenced></mml:math></inline-formula> for time <italic toggle="yes">t</italic> (<inline-formula id="IE7"><mml:math id="IM7" display="inline" overflow="scroll"><mml:mi>s</mml:mi><mml:mo>≤</mml:mo><mml:mi>t</mml:mi><mml:mo>≤</mml:mo><mml:mi>s</mml:mi><mml:mo>+</mml:mo><mml:mi>w</mml:mi></mml:math></inline-formula>) is:</p>
    <disp-formula id="E1">
      <mml:math id="M1" display="block" overflow="scroll">
        <mml:mrow>
          <mml:msub>
            <mml:mrow>
              <mml:mi>h</mml:mi>
            </mml:mrow>
            <mml:mrow>
              <mml:mi>j</mml:mi>
            </mml:mrow>
          </mml:msub>
        </mml:mrow>
        <mml:mfenced open="(" close=")" separators="|">
          <mml:mrow>
            <mml:mi>t</mml:mi>
          </mml:mrow>
          <mml:mrow>
            <mml:mi mathvariant="bold-italic">Z</mml:mi>
            <mml:mfenced open="(" close=")" separators="|">
              <mml:mrow>
                <mml:mi>s</mml:mi>
              </mml:mrow>
            </mml:mfenced>
            <mml:mo>,</mml:mo>
            <mml:mi>s</mml:mi>
          </mml:mrow>
        </mml:mfenced>
        <mml:mo>=</mml:mo>
        <mml:mrow>
          <mml:msub>
            <mml:mrow>
              <mml:mi>h</mml:mi>
            </mml:mrow>
            <mml:mrow>
              <mml:mi>j</mml:mi>
              <mml:mn>0</mml:mn>
            </mml:mrow>
          </mml:msub>
        </mml:mrow>
        <mml:mfenced open="(" close=")" separators="|">
          <mml:mrow>
            <mml:mi>t</mml:mi>
          </mml:mrow>
        </mml:mfenced>
        <mml:mrow>
          <mml:mrow>
            <mml:mi mathvariant="normal">exp</mml:mi>
          </mml:mrow>
          <mml:mo>⁡</mml:mo>
          <mml:mrow>
            <mml:mfenced open="(" close=")" separators="|">
              <mml:mrow>
                <mml:mrow>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mo>θ</mml:mo>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>j</mml:mi>
                    </mml:mrow>
                  </mml:msub>
                </mml:mrow>
                <mml:mfenced open="(" close=")" separators="|">
                  <mml:mrow>
                    <mml:mi>s</mml:mi>
                  </mml:mrow>
                </mml:mfenced>
                <mml:mo>+</mml:mo>
                <mml:mrow>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi mathvariant="bold-italic">β</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>j</mml:mi>
                    </mml:mrow>
                  </mml:msub>
                </mml:mrow>
                <mml:mfenced open="(" close=")" separators="|">
                  <mml:mrow>
                    <mml:mi>s</mml:mi>
                  </mml:mrow>
                </mml:mfenced>
                <mml:mi mathvariant="bold-italic">Z</mml:mi>
                <mml:mo>(</mml:mo>
                <mml:mi>s</mml:mi>
                <mml:mo>)</mml:mo>
              </mml:mrow>
            </mml:mfenced>
          </mml:mrow>
        </mml:mrow>
      </mml:math>
    </disp-formula>
    <p>where <inline-formula id="IE8"><mml:math id="IM8" display="inline" overflow="scroll"><mml:mo>θ</mml:mo><mml:mfenced open="(" close=")" separators="|"><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:mfenced></mml:math></inline-formula> models the main effects of the landmark time <inline-formula id="IE9"><mml:math id="IM9" display="inline" overflow="scroll"><mml:mi>s</mml:mi></mml:math></inline-formula> and <inline-formula id="IE10"><mml:math id="IM10" display="inline" overflow="scroll"><mml:mi mathvariant="bold-italic">Z</mml:mi><mml:mo>(</mml:mo><mml:mi>s</mml:mi><mml:mo>)</mml:mo></mml:math></inline-formula> denotes the most recent covariates of individual observed until <inline-formula id="IE11"><mml:math id="IM11" display="inline" overflow="scroll"><mml:mi>s</mml:mi></mml:math></inline-formula>. In particular, the baseline hazard at time <inline-formula id="IE12"><mml:math id="IM12" display="inline" overflow="scroll"><mml:mi>t</mml:mi></mml:math></inline-formula>, <inline-formula id="IE13"><mml:math id="IM13" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mfenced open="(" close=")" separators="|"><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:mfenced><mml:mrow><mml:mrow><mml:mi mathvariant="normal">exp</mml:mi></mml:mrow><mml:mo>⁡</mml:mo><mml:mrow><mml:mfenced open="(" close=")" separators="|"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mo>θ</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mfenced open="(" close=")" separators="|"><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced></mml:mrow></mml:mrow></mml:math></inline-formula>, is the probability that a person with all zero covariates will experience the event in the next instant if that person survives to <inline-formula id="IE14"><mml:math id="IM14" display="inline" overflow="scroll"><mml:mi>t</mml:mi></mml:math></inline-formula> from <inline-formula id="IE15"><mml:math id="IM15" display="inline" overflow="scroll"><mml:mi>s</mml:mi></mml:math></inline-formula>. The interaction of <inline-formula id="IE16"><mml:math id="IM16" display="inline" overflow="scroll"><mml:mi>s</mml:mi></mml:math></inline-formula> with the covariates, modelled by <inline-formula id="IE17"><mml:math id="IM17" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mfenced open="(" close=")" separators="|"><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:mfenced></mml:math></inline-formula>, captures the time-dependent effects of covariates. The <inline-formula id="IE18"><mml:math id="IM18" display="inline" overflow="scroll"><mml:mi>w</mml:mi></mml:math></inline-formula>-year survival and (cause-specific) cumulative incidence for cause <inline-formula id="IE19"><mml:math id="IM19" display="inline" overflow="scroll"><mml:mi>j</mml:mi></mml:math></inline-formula> can be predicted at any point <inline-formula id="IE20"><mml:math id="IM20" display="inline" overflow="scroll"><mml:mi>s</mml:mi></mml:math></inline-formula> in the window <inline-formula id="IE21"><mml:math id="IM21" display="inline" overflow="scroll"><mml:mo>[</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>]</mml:mo></mml:math></inline-formula>:</p>
    <disp-formula id="E2">
      <mml:math id="M2" display="block" overflow="scroll">
        <mml:mi>S</mml:mi>
        <mml:mfenced open="(" close=")" separators="|">
          <mml:mrow>
            <mml:mi>s</mml:mi>
            <mml:mo>+</mml:mo>
            <mml:mi>w</mml:mi>
          </mml:mrow>
          <mml:mrow>
            <mml:mi mathvariant="bold-italic">Z</mml:mi>
            <mml:mfenced open="(" close=")" separators="|">
              <mml:mrow>
                <mml:mi>s</mml:mi>
              </mml:mrow>
            </mml:mfenced>
            <mml:mo>,</mml:mo>
            <mml:mi>s</mml:mi>
          </mml:mrow>
        </mml:mfenced>
        <mml:mo>=</mml:mo>
        <mml:mrow>
          <mml:mrow>
            <mml:mi mathvariant="normal">exp</mml:mi>
          </mml:mrow>
          <mml:mo>⁡</mml:mo>
          <mml:mrow>
            <mml:mfenced open="(" close=")" separators="|">
              <mml:mrow>
                <mml:mo>-</mml:mo>
                <mml:mrow>
                  <mml:mrow>
                    <mml:msubsup>
                      <mml:mo stretchy="false">∫</mml:mo>
                      <mml:mrow>
                        <mml:mi>s</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>s</mml:mi>
                        <mml:mo>+</mml:mo>
                        <mml:mi>w</mml:mi>
                      </mml:mrow>
                    </mml:msubsup>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mrow>
                      <mml:mrow>
                        <mml:msubsup>
                          <mml:mo stretchy="false">∑</mml:mo>
                          <mml:mrow>
                            <mml:mi>j</mml:mi>
                            <mml:mo>=</mml:mo>
                            <mml:mn>1</mml:mn>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mi>C</mml:mi>
                          </mml:mrow>
                        </mml:msubsup>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mi>h</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mi>j</mml:mi>
                            </mml:mrow>
                          </mml:msub>
                        </mml:mrow>
                        <mml:mfenced open="(" close=")" separators="|">
                          <mml:mrow>
                            <mml:mi>t</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mi mathvariant="bold-italic">Z</mml:mi>
                            <mml:mfenced open="(" close=")" separators="|">
                              <mml:mrow>
                                <mml:mi>s</mml:mi>
                              </mml:mrow>
                            </mml:mfenced>
                            <mml:mo>,</mml:mo>
                            <mml:mi>s</mml:mi>
                          </mml:mrow>
                        </mml:mfenced>
                      </mml:mrow>
                    </mml:mrow>
                    <mml:mi>d</mml:mi>
                    <mml:mi>t</mml:mi>
                  </mml:mrow>
                </mml:mrow>
              </mml:mrow>
            </mml:mfenced>
          </mml:mrow>
        </mml:mrow>
      </mml:math>
    </disp-formula>
    <p>and</p>
    <disp-formula id="E3">
      <mml:math id="M3" display="block" overflow="scroll">
        <mml:mrow>
          <mml:msub>
            <mml:mrow>
              <mml:mi>F</mml:mi>
            </mml:mrow>
            <mml:mrow>
              <mml:mi>j</mml:mi>
            </mml:mrow>
          </mml:msub>
        </mml:mrow>
        <mml:mfenced open="(" close=")" separators="|">
          <mml:mrow>
            <mml:mi>s</mml:mi>
            <mml:mo>+</mml:mo>
            <mml:mi>w</mml:mi>
          </mml:mrow>
          <mml:mrow>
            <mml:mi mathvariant="bold-italic">Z</mml:mi>
            <mml:mfenced open="(" close=")" separators="|">
              <mml:mrow>
                <mml:mi>s</mml:mi>
              </mml:mrow>
            </mml:mfenced>
            <mml:mo>,</mml:mo>
            <mml:mi>s</mml:mi>
          </mml:mrow>
        </mml:mfenced>
        <mml:mo>=</mml:mo>
        <mml:mrow>
          <mml:mrow>
            <mml:msubsup>
              <mml:mo stretchy="false">∫</mml:mo>
              <mml:mrow>
                <mml:mi>s</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>s</mml:mi>
                <mml:mo>+</mml:mo>
                <mml:mi>w</mml:mi>
              </mml:mrow>
            </mml:msubsup>
          </mml:mrow>
          <mml:mrow>
            <mml:mrow>
              <mml:msub>
                <mml:mrow>
                  <mml:mi>h</mml:mi>
                </mml:mrow>
                <mml:mrow>
                  <mml:mi>j</mml:mi>
                </mml:mrow>
              </mml:msub>
            </mml:mrow>
            <mml:mfenced open="(" close=")" separators="|">
              <mml:mrow>
                <mml:mi>t</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi mathvariant="bold-italic">Z</mml:mi>
                <mml:mfenced open="(" close=")" separators="|">
                  <mml:mrow>
                    <mml:mi>s</mml:mi>
                  </mml:mrow>
                </mml:mfenced>
                <mml:mo>,</mml:mo>
                <mml:mi>s</mml:mi>
              </mml:mrow>
            </mml:mfenced>
            <mml:mi>S</mml:mi>
            <mml:mfenced open="(" close=")" separators="|">
              <mml:mrow>
                <mml:mi>t</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi mathvariant="bold-italic">Z</mml:mi>
                <mml:mfenced open="(" close=")" separators="|">
                  <mml:mrow>
                    <mml:mi>s</mml:mi>
                  </mml:mrow>
                </mml:mfenced>
                <mml:mo>,</mml:mo>
                <mml:mi>s</mml:mi>
              </mml:mrow>
            </mml:mfenced>
            <mml:mi>d</mml:mi>
            <mml:mi>t</mml:mi>
          </mml:mrow>
        </mml:mrow>
      </mml:math>
    </disp-formula>
    <p>respectively.</p>
    <p>Estimating cumulative incidence in <italic toggle="yes">dynamicLM</italic> involves an iteration over the causes and landmarks in the super dataset. It also uses <italic toggle="yes">prodlim,</italic><xref rid="dyad122-B20" ref-type="bibr"><sup>20</sup></xref><italic toggle="yes">riskRegression,</italic><xref rid="dyad122-B21" ref-type="bibr"><sup>21</sup></xref><italic toggle="yes">survival</italic><xref rid="dyad122-B22" ref-type="bibr"><sup>22</sup></xref> and <italic toggle="yes">dynpred</italic><xref rid="dyad122-B23" ref-type="bibr"><sup>23</sup></xref> R packages. The <italic toggle="yes">dynamicLM</italic> package has a PDF manual that is downloadable from GitHub [<ext-link xlink:href="https://github.com/thehanlab/dynamicLM" ext-link-type="uri">https://github.com/thehanlab/dynamicLM</ext-link>] and accessible in R program (See <xref rid="sup1" ref-type="supplementary-material">Supplementary Method 1</xref>, available as <xref rid="sup1" ref-type="supplementary-material">Supplementary data</xref> at <italic toggle="yes">IJE</italic> online).</p>
  </sec>
  <sec>
    <title>Use</title>
    <p>This section presents the application of <italic toggle="yes">dynamicLM</italic> to develop a risk-prediction model for second primary lung cancer (SPLC) among lung cancer patients using the CSC landmark supermodel. The data contain 3844 ever-smoking patients diagnosed with initial primary lung cancer (IPLC) between 1993 and 2007, followed through 2017, in the Multiethnic Cohort Study (MEC) (<xref rid="sup1" ref-type="supplementary-material">Supplementary Method 2</xref>, available as <xref rid="sup1" ref-type="supplementary-material">Supplementary data</xref> at <italic toggle="yes">IJE</italic> online).</p>
    <p>The event of interest is the time from IPLC to SPLC diagnosis (Cause 1) with competing events of lung cancer death (Cause 2) and other-cause death (Cause 3). First, we load the package and data into our R session:<disp-quote content-type="extract"><p><monospace>&gt; devtools::install_github("thehanlab/dynamicLM")</monospace></p><p><monospace>&gt; library(dynamicLM)</monospace></p><p><monospace>&gt; data(splc)</monospace></p><p>*The example dataset in this R package is synthetic because the original MEC data are only available under a data use agreement. Readers can apply the code but cannot replicate the same estimates.</p></disp-quote></p>
    <p>The super dataset setup requires: (ii) the outcome columns; and (ii) variable types (fixed vs time-varying). Fixed variables (e.g. sex) do not change over time, whereas time-varying covariates (e.g. smoking status at baseline and 10-year follow-up surveys) do. In this example, the fixed covariates include age at IPLC diagnosis (‘age.ix’), family history of lung cancer (‘fh’), prior history of cancer (‘ph’), IPLC stage (‘stage.ix’), IPLC histology and IPLC treatment. The time-varying covariates include smoking-related variables. The following code sets this up:<disp-quote content-type="extract"><p><monospace>&gt; outcome &lt;- list(time = "Time", status = "event")</monospace></p><p><monospace>&gt; fix_covs &lt;- c("age.ix", "male", "fh", "ph",          "bmi", "stage.ix",</monospace></p><p><monospace>         "hist_AD", "hist_LC",          "hist_NSCLC_NOS", "hist_SC",</monospace></p><p><monospace>         "hist_OTH", "surgery.ix",          "radiation.ix",</monospace></p><p><monospace>         "chemo.ix", "quityears")</monospace></p><p><monospace>&gt; vary_covs &lt;- c("smkstatus", "cigday",           "packyears")</monospace></p><p><monospace>&gt; covs &lt;- list(fixed = fix_covs,          varying = vary_covs)</monospace></p></disp-quote></p>
    <p>To predict the 5-year SPLC risk during the first 3 years of IPLC diagnosis, we first specified a prediction window and established a set of landmarks (i.e. risk assessment time points at 0, 1, 2 and 3 years from IPLC diagnosis), producing one stacked dataset (‘lmdata’) of four landmark datasets (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S1</xref> and <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S1</xref>, available as <xref rid="sup1" ref-type="supplementary-material">Supplementary data</xref> at <italic toggle="yes">IJE</italic> online). The original dataset (splc) is in long-form format that may include multiple observations per patient if the patient has 10-year follow-up survey data (<xref rid="sup1" ref-type="supplementary-material">Supplementary Method 2</xref>, available as <xref rid="sup1" ref-type="supplementary-material">Supplementary data</xref> at <italic toggle="yes">IJE</italic> online). The column ‘T.fup’ represents the duration between baseline and follow-up measurements of time-varying covariates (‘smkstatus’, ‘cigday’ and ‘packyears’). This follow-up time is specified in the ‘rtime’ argument:<disp-quote content-type="extract"><p><monospace>&gt; w &lt;- 5           #5-year prediction                 window</monospace></p><p><monospace>&gt; lms &lt;- seq(0, 3, by = 1) #landmarks</monospace></p><p><monospace>&gt; lmdata &lt;- stack_data(data = splc,              outcome = outcome,              lms = lms,</monospace></p><p><monospace>                 w = w, covs = covs,                id = "ID",</monospace></p><p><monospace>               format = "long",                rtime = "T.fup")</monospace></p><p><monospace>&gt; table(lmdata$data$LM) #Number of patients per landmark</monospace></p></disp-quote></p>
    <p>Certain time-varying covariates can be manually updated as time passes. In our data, smoking quit years (‘quityears’) increase linearly for former smokers:<disp-quote content-type="extract"><p><monospace>&gt; former_smokers &lt;- lmdata$data$smkstatus == 2</monospace></p><p><monospace>&gt; lmdata$data[former_smokers, "quityears"] &lt;-</monospace></p><p><monospace>    lmdata$data[former_smokers,     "quityears"] +</monospace></p><p><monospace>    lmdata$data[former_smokers, "LM"]</monospace></p></disp-quote></p>
    <p>The next step involves creating; (i) interaction terms between chosen covariates (‘lm_covs’) and landmark times (linear, quadratic, or other forms using ‘func_covars’) to examine time-dependent effects of the covariate and check the proportional hazard assumption; and (ii) transformations of the landmark time variables (‘func_lms’).</p>
    <p>Unlike time-varying covariates, time-dependent effects occur when the hazard of a covariate changes over time. For example, the effect of radiotherapy given to treat IPLC on SPLC risk has been reported to increase over time.<xref rid="dyad122-B24" ref-type="bibr"><sup>24</sup></xref> We selected a priori a list of variables and associated transformations (linear, quadratic) to be checked for the time-dependent effects based on domain knowledge of how variable effects change over time. Certain other transformations (e.g. logarithmic) can be added if necessary (<xref rid="sup1" ref-type="supplementary-material">Supplementary Method 2</xref>, available as <xref rid="sup1" ref-type="supplementary-material">Supplementary data</xref> at <italic toggle="yes">IJE</italic> online). The newly created interaction terms are identified by each variable name followed by an underscore and number (e.g. stage.ix_1 = stage.ix*LM, and stage.ix_2 = stage.ix*LM<sup>2</sup>).</p>
    <p>We add linear and quadratic landmark time transformations using ‘func_lms’ to incorporate the smoothing across landmarks into modelling:<disp-quote content-type="extract"><p><monospace>&gt; lm_covs &lt;- c("packyears", "radiation.ix",            "ph", "stage.ix",</monospace></p><p><monospace>         "hist_AD", "hist_LC",          "hist_NSCLC_NOS", "hist_SC",</monospace></p><p><monospace>         "hist_OTH")</monospace></p><p><monospace>&gt; lmdata &lt;- add_interactions            (lmdata = lmdata,             lm_covs = lm_covs,</monospace></p><p><monospace>            func_covars = c("linear",             "quadratic"),</monospace></p><p><monospace>            func_lms = c("linear",             "quadratic"))</monospace></p><p><monospace>&gt; colnames(lmdata$data) #columns of added terms</monospace></p></disp-quote></p>
    <p>A model is then fit on the stacked dataset. Our model selection procedure is in <xref rid="sup1" ref-type="supplementary-material">Supplementary Method 2</xref>, available as <xref rid="sup1" ref-type="supplementary-material">Supplementary data</xref> at <italic toggle="yes">IJE</italic> online:<disp-quote content-type="extract"><p><monospace>formula &lt;- "Hist(Time, event, LM) ∼      male + ph + ph_1 +     radiation.ix + radiation.ix_1 +      packyears + quityears +      hist_AD + hist_LC +      hist_NSCLC_NOS +      hist_OTH + hist_SC +      hist_AD_1 + hist_LC_1 +      hist_NSCLC_NOS_1 +      hist_OTH_1 + hist_SC_1 +      stage.ix + stage.ix_1 + stage.ix_2 +      LM_1 + LM_2 +      cluster(ID)"</monospace></p><p><monospace>&gt; supermodel &lt;- dynamic_lm(lmdata = lmdata,</monospace></p><p><monospace>        formula = as.formula(formula),</monospace></p><p><monospace>        type = "CSC")</monospace></p><p><monospace>&gt; print(supermodel)</monospace></p></disp-quote></p>
    <p>The dynamic cause-specific hazard ratios of the final model are depicted in <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S2</xref> (available as <xref rid="sup1" ref-type="supplementary-material">Supplementary data</xref> at <italic toggle="yes">IJE</italic> online). Covariates with time-dependent effects included IPLC radiotherapy (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S2</xref>, available as <xref rid="sup1" ref-type="supplementary-material">Supplementary data</xref> at <italic toggle="yes">IJE</italic> online). To plot dynamic hazard ratios to capture the increased effect on SPLC risk:<disp-quote content-type="extract"><p><monospace>&gt; plot(supermodel, "radiation.ix", logHR = FALSE)</monospace></p></disp-quote></p>
    <p>Individual 5-year predicted risk can be estimated:<disp-quote content-type="extract"><p><monospace>&gt; p &lt;- predict(supermodel); summary(p$preds)</monospace></p></disp-quote></p>
    <p>To evaluate the model, we create calibration plots and compute area under the curve (AUC) and Brier score. Bootstrapped internal validation and external validation can be performed (<xref rid="sup1" ref-type="supplementary-material">Supplementary Method 2</xref>, available as <xref rid="sup1" ref-type="supplementary-material">Supplementary data</xref> at <italic toggle="yes">IJE</italic> online). Our model showed good calibration (calibration slope: 0.9–1.2 across landmarks) (<xref rid="dyad122-F1" ref-type="fig">Figure 1</xref>; <xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S3</xref>, available as <xref rid="sup1" ref-type="supplementary-material">Supplementary data</xref> at <italic toggle="yes">IJE</italic> online) and high discrimination at baseline (AUC &gt;80%). The AUC decreased over landmarks because most of the data in model fitting come from the baseline in MEC, which could be one limitation of this data. If patient features are updated over time, the model’s predictive accuracy could stay consistent:<disp-quote content-type="extract"><p><monospace>&gt; par(mfrow = c(2, 2))</monospace></p><p><monospace>&gt; cal &lt;- calplot(list("CSC" = p),</monospace></p><p><monospace>          xlim = c(0, 0.25),           ylim = c(0, 0.25),</monospace></p><p><monospace>          method</monospace><monospace>= "quantile",           q = 10) #deciles</monospace></p><p><monospace>&gt; score(list("CSC" = p)) #AUC and Brier</monospace></p></disp-quote></p>
    <fig position="float" id="dyad122-F1">
      <label>Figure 1.</label>
      <caption>
        <p>A dynamic prediction model for 5-year risk of SPLC among IPLC patients in the Multiethnic Cohort Study. (A) Predictive performance [discrimination (AUC), calibration (calibration slope) and predictive accuracy [Brier score]) of the proposed model across risk assessment times. (B) The dynamic trajectory of estimated 5-year SPLC risk across different risk assessment times (landmark times) among two example individuals. With a 5-year predefined prediction window (w = 5), the risk of developing SPLC in 5 years was estimated at each landmark time [i.e. risk assessment time or prediction time point (unit: years)] across the horizontal coordinates. In this example, the 5-year risk of developing SPLC in Patient P1 is 0.97% when predicted at IPLC diagnosis (Landmark = 0), which is updated to 1.43% [when predicted at 1 year after IPLC diagnosis (Landmark = 1)], 3.06% [when predicted at 2 years after IPLC diagnosis (Landmark = 2)] and 4.38% [when predicted at 3 years after IPLC diagnosis (Landmark = 3)] at successive landmarks based on the most recent patient information seen till each landmark. (C) In Panel (B), Patient P1’s 5-year SPLC risk increases over the landmark times due to accumulated smoking pack-years and IPLC radiotherapy which have time-dependent effects for SPLC risk; Patient P2’s 5-year SPLC risk decreases over time due to increasing smoking quit-years and ‘other’ IPLC histology which have time-dependent effects for SPLC risk (see <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S2</xref>, available as <xref rid="sup1" ref-type="supplementary-material">Supplementary data</xref> at <italic toggle="yes">IJE</italic> online). AD, adenocarcinoma IPLC histology; AUC, srea under the receiver operating characteristic curve; ID, identifier; IPLC, initial primary lung cancer; LM, landmark time; OTH, Other (not belonging to non-small-cell lung cancer nor small-cell lung cancer) IPLC histology; SPLC, second primary lung cancer</p>
      </caption>
      <graphic xlink:href="dyad122f1" position="float"/>
    </fig>
    <p>An example of two patients’ dynamic 5-year SPLC risk is shown in <xref rid="dyad122-F1" ref-type="fig">Figure 1B</xref>. The increasing SPLC risk in Patient P1 was driven by latent IPLC radiotherapy, which has an increasing effect on SPLC over time (<xref rid="dyad122-F1" ref-type="fig">Figure 1C</xref>):<disp-quote content-type="extract"><p><monospace>&gt; par(mfrow = c(1, 1))</monospace></p><p><monospace>&gt; inds &lt;- lmdata$data[lmdata$data$ID %in%             c("ID2", "ID7"), ]</monospace></p><p><monospace>&gt; plotrisk(supermodel, inds, format = "long",        ylim = c(0, 0.2))</monospace></p></disp-quote></p>
  </sec>
  <sec>
    <title>Simulation</title>
    <p>We conducted simulations to evaluate the computational feasibility of <italic toggle="yes">dynamicLM</italic> and to assess the impact of accounting for competing risks in the landmark supermodel when they are present. The simulation methods are included in <xref rid="sup1" ref-type="supplementary-material">Supplementary Method</xref> 3 (available as <xref rid="sup1" ref-type="supplementary-material">Supplementary data</xref> at <italic toggle="yes">IJE</italic> online).</p>
    <p>The computational feasibility of <italic toggle="yes">dynamicLM</italic> compared with joint modeling (packages <italic toggle="yes">JMbayes2</italic><xref rid="dyad122-B12" ref-type="bibr"><sup>12</sup></xref> and <italic toggle="yes">FastJM</italic><xref rid="dyad122-B25" ref-type="bibr"><sup>25</sup></xref>) across different scenarios is shown in <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S3</xref> (available as <xref rid="sup1" ref-type="supplementary-material">Supplementary data</xref> at <italic toggle="yes">IJE</italic> online). <italic toggle="yes">dynamicLM</italic> has the shortest mean time (&lt;0.1 s) for fitting a CSC landmark model and calculating individual-level predictions (&lt;41 s). <italic toggle="yes">JMbayes2</italic> takes considerably longer (&gt;240 s for model fitting and &gt;120 s for prediction using 3000 individuals). Although <italic toggle="yes">FastJM</italic> scales better than <italic toggle="yes">JMbayes2</italic> for model fitting, it cannot handle multiple time-varying covariates. Landmark modelling (<italic toggle="yes">dynamicLM</italic>) is scalable for high-dimensional data with multiple time-varying covariates.</p>
    <p>The simulation results for evaluating the impact of correctly handling competing events on predictive accuracy are shown in <xref rid="dyad122-F2" ref-type="fig">Figure 2</xref>. Using a standard Cox landmark model instead of a CSC landmark model leads to reduced predictive performance when competing risks exist. The difference in AUC between the two models becomes more pronounced over landmark times.</p>
    <fig position="float" id="dyad122-F2">
      <label>Figure 2.</label>
      <caption>
        <p>Simulation study to evaluate the impact of model misspecification for analysing landmark superdata under competing risks. Dynamic time-dependent AUCs are compared across four different landmark times of 0, 0.5, 1 and 1.5 years from baseline for predicting a 2-year risk using a standard Cox landmark model (that censors competing events) vs a cause-specific Cox (CSC) landmark model (correct model that accounts for competing risks). We simulated 100 datasets in the presence of competing risks, with each dataset including 1000 individuals and 10 predictors. The details of the simulation methods are shown in the <xref rid="sup1" ref-type="supplementary-material">Supplementary Methods</xref> (available as <xref rid="sup1" ref-type="supplementary-material">Supplementary data</xref> at <italic toggle="yes">IJE</italic> online). AUC, area under the receiver operating characteristic curve; CSC, cause-specific Cox model; tLM, landmark time</p>
      </caption>
      <graphic xlink:href="dyad122f2" position="float"/>
    </fig>
    <p>Additionally, we compared the two models in our application example of SPLC (vs simulation). The predicted risk score was overestimated (1.5–5.3 times higher) in a standard Cox landmark vs CSC landmark (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S4</xref>, available as <xref rid="sup1" ref-type="supplementary-material">Supplementary data</xref> at <italic toggle="yes">IJE</italic> online), emphasizing the importance of correctly handling competing risks in dynamic prediction.</p>
  </sec>
  <sec sec-type="discussion">
    <title>Discussion</title>
    <p>In this study, we presented the R package <italic toggle="yes">dynamicLM</italic> that implements a flexible framework for building a dynamic landmark supermodel for competing risk data, covering the entire pipeline for data preparation, model development, prediction and evaluation. By providing researchers with practical tools and instructions on how and when to use this approach, <italic toggle="yes">dynamicLM</italic> holds great promise to improve individual risk predictions by using updated patient data.</p>
    <p>The proposed implementation can be applied in many clinical settings, such as predicting a cancer recurrence<xref rid="dyad122-B6" ref-type="bibr"><sup>6</sup></xref> (or a therapy response) using time-varying biomarkers (i.e. circulating tumour DNA)<xref rid="dyad122-B1" ref-type="bibr"><sup>1</sup></xref> in clinical trials or predicting second malignancies using updated patients’ treatment histories in electronic health records. Future research directions include incorporating regularization for feature selection in high-dimensional data and developing unified performance metrics summarized across landmarks to evaluate the predictive performance of the landmark model.</p>
  </sec>
  <sec>
    <title>Ethics approval</title>
    <p>Study participants provided informed consent in accordance with the Declaration of Helsinki and the study was approved by the institutional review boards of the University of Hawaii and the University of Southern California.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="sup1" position="float" content-type="local-data">
      <label>dyad122_Supplementary_Data</label>
      <media xlink:href="dyad122_supplementary_data.zip">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <sec sec-type="data-availability">
    <title>Data availability</title>
    <p>The data underlying this analysis were provided by the Multiethnic Cohort Study (MEC) under data use agreement. Researchers interested in the MEC data may submit an inquiry online: [<ext-link xlink:href="https://www.uhcancercenter.org/for-researchers/mec-data-sharing" ext-link-type="uri">https://www.uhcancercenter.org/for-researchers/mec-data-sharing</ext-link>].</p>
  </sec>
  <sec>
    <title>Supplementary data</title>
    <p><xref rid="sup1" ref-type="supplementary-material">Supplementary data</xref> are available at <italic toggle="yes">IJE</italic> online.</p>
  </sec>
  <sec>
    <title>Author contributions</title>
    <p>A.H.F., E.C. and S.S.H. conceptualized research; A.H.F. and E.C. contributed to data curation and formal analysis, and wrote original draft; S.S.H. supervised research; all authors participated in the reviewing and editing of the paper and validation process.</p>
  </sec>
  <sec>
    <title>Funding</title>
    <p>This study is supported by grants from the National Institutes of Health (4R37CA226081 and 1R01CA282793). This work was supported by the Stanford Cancer Institute, an NCI-designated comprehensive cancer centre.</p>
  </sec>
  <sec sec-type="COI-statement">
    <title>Conflict of interest</title>
    <p>H.A.W. reports grants from ACEA Biosciences, grants from Arrys Therapeutics, grants from BMS, grants from Celgene, grants from Clovis Oncology, grants from Exelixis, grants from Genetech/Roche, grants from Gilead, grants from Merck, grants from Novartis, grants from Pharmacyclics, grants from Sea Gen, grants from Xcovery, other from AstraZeneca, other from Xcovery, other from Janssen, other from Daiichi Sankyo, other from Blueprint, other from Mirati, other from Helsinn, other from Merch—not compensated, other from Genetech/Roche—not compensated, other from IASLC, other from ECOG-ACRIN, outside the submitted work. All remaining authors report no other disclosures.</p>
  </sec>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="dyad122-B1">
      <label>1</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kurtz</surname><given-names>DM</given-names></string-name>, <string-name><surname>Esfahani</surname><given-names>MS</given-names></string-name>, <string-name><surname>Scherer</surname><given-names>F</given-names></string-name></person-group><etal>et al</etal><article-title>Dynamic risk profiling using serial tumor biomarkers for personalized outcome prediction</article-title>. <source>Cell</source><year>2019</year>;<volume>178</volume>:<fpage>699</fpage>–<lpage>713.e619</lpage>.<pub-id pub-id-type="pmid">31280963</pub-id></mixed-citation>
    </ref>
    <ref id="dyad122-B2">
      <label>2</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Han</surname><given-names>SS</given-names></string-name>, <string-name><surname>Rivera</surname><given-names>GA</given-names></string-name>, <string-name><surname>Tammemägi</surname><given-names>MC</given-names></string-name></person-group><etal>et al</etal><article-title>Risk stratification for second primary lung cancer</article-title>. <source>J Clin Oncol</source><year>2017</year>;<volume>35</volume>:<fpage>2893</fpage>–<lpage>99</lpage>.<pub-id pub-id-type="pmid">28644772</pub-id></mixed-citation>
    </ref>
    <ref id="dyad122-B3">
      <label>3</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Barcenas</surname><given-names>CH</given-names></string-name>, <string-name><surname>Song</surname><given-names>J</given-names></string-name>, <string-name><surname>Murthy</surname><given-names>RK</given-names></string-name></person-group><etal>et al</etal><article-title>Prognostic model for De Novo and recurrent metastatic breast cancer</article-title>. <source>JCO Clin Cancer Inform</source><year>2021</year>;<volume>5</volume>:<fpage>789</fpage>–<lpage>804</lpage>.<pub-id pub-id-type="pmid">34351787</pub-id></mixed-citation>
    </ref>
    <ref id="dyad122-B4">
      <label>4</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>D'Journo</surname><given-names>XB</given-names></string-name>, <string-name><surname>Boulate</surname><given-names>D</given-names></string-name>, <string-name><surname>Fourdrain</surname><given-names>A</given-names></string-name></person-group><etal>et al</etal>; <collab>International Esodata Study Group</collab>. <article-title>Risk prediction model of 90-day mortality after esophagectomy for cancer</article-title>. <source>JAMA Surg</source><year>2021</year>;<volume>156</volume>:<fpage>836</fpage>–<lpage>45</lpage>.<pub-id pub-id-type="pmid">34160587</pub-id></mixed-citation>
    </ref>
    <ref id="dyad122-B5">
      <label>5</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Jones</surname><given-names>GD</given-names></string-name>, <string-name><surname>Brandt</surname><given-names>WS</given-names></string-name>, <string-name><surname>Shen</surname><given-names>R</given-names></string-name></person-group><etal>et al</etal><article-title>A genomic-pathologic annotated risk model to predict recurrence in early-stage lung adenocarcinoma</article-title>. <source>JAMA Surg</source><year>2021</year>;<volume>156</volume>:<fpage>e205601</fpage>.<pub-id pub-id-type="pmid">33355651</pub-id></mixed-citation>
    </ref>
    <ref id="dyad122-B6">
      <label>6</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Fontein</surname><given-names>DBY</given-names></string-name>, <string-name><surname>Klinten Grand</surname><given-names>M</given-names></string-name>, <string-name><surname>Nortier</surname><given-names>JWR</given-names></string-name></person-group><etal>et al</etal><article-title>Dynamic prediction in breast cancer: proving feasibility in clinical practice using the TEAM trial</article-title>. <source>Ann Oncol</source><year>2015</year>;<volume>26</volume>:<fpage>1254</fpage>–<lpage>62</lpage>.<pub-id pub-id-type="pmid">25862439</pub-id></mixed-citation>
    </ref>
    <ref id="dyad122-B7">
      <label>7</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Luo</surname><given-names>SJ</given-names></string-name>, <string-name><surname>Choi</surname><given-names>E</given-names></string-name>, <string-name><surname>Aredo</surname><given-names>JV</given-names></string-name></person-group><etal>et al</etal><article-title>Smoking cessation after lung cancer diagnosis and the risk of second primary lung cancer: the multiethnic cohort study</article-title>. <source>JNCI Cancer Spectr</source><year>2021</year>;<volume>5</volume>:pkab076.</mixed-citation>
    </ref>
    <ref id="dyad122-B8">
      <label>8</label>
      <mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>van Houwelingen</surname><given-names>H</given-names></string-name>, <string-name><surname>Putter</surname><given-names>H.</given-names></string-name></person-group><source>Dynamic Prediction in Clinical Survival Analysis</source>. Boca Laton, FL: <publisher-name>CRC Press</publisher-name>, <year>2011</year>.</mixed-citation>
    </ref>
    <ref id="dyad122-B9">
      <label>9</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Paige</surname><given-names>E</given-names></string-name>, <string-name><surname>Barrett</surname><given-names>J</given-names></string-name>, <string-name><surname>Stevens</surname><given-names>D</given-names></string-name></person-group><etal>et al</etal><article-title>Landmark models for optimizing the use of repeated measurements of risk factors in electronic health records to predict future disease risk</article-title>. <source>Am J Epidemiol</source><year>2018</year>;<volume>187</volume>:<fpage>1530</fpage>–<lpage>38</lpage>.<pub-id pub-id-type="pmid">29584812</pub-id></mixed-citation>
    </ref>
    <ref id="dyad122-B10">
      <label>10</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Yang</surname><given-names>Z</given-names></string-name>, <string-name><surname>Hou</surname><given-names>Y</given-names></string-name>, <string-name><surname>Lyu</surname><given-names>J</given-names></string-name>, <string-name><surname>Liu</surname><given-names>D</given-names></string-name>, <string-name><surname>Chen</surname><given-names>Z.</given-names></string-name></person-group><article-title>Dynamic prediction and prognostic analysis of patients with cervical cancer: a landmarking analysis approach</article-title>. <source>Ann Epidemiol</source><year>2020</year>;<volume>44</volume>:<fpage>45</fpage>–<lpage>51</lpage>.<pub-id pub-id-type="pmid">32220511</pub-id></mixed-citation>
    </ref>
    <ref id="dyad122-B11">
      <label>11</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Asar</surname><given-names>Ö</given-names></string-name>, <string-name><surname>Ritchie</surname><given-names>J</given-names></string-name>, <string-name><surname>Kalra</surname><given-names>PA</given-names></string-name>, <string-name><surname>Diggle</surname><given-names>PJ.</given-names></string-name></person-group><article-title>Joint modelling of repeated measurement and time-to-event data: an introductory tutorial</article-title>. <source>Int J Epidemiol</source><year>2015</year>;<volume>44</volume>:<fpage>334</fpage>–<lpage>44</lpage>.<pub-id pub-id-type="pmid">25604450</pub-id></mixed-citation>
    </ref>
    <ref id="dyad122-B12">
      <label>12</label>
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Rizopoulos</surname><given-names>D</given-names></string-name>, <string-name><surname>Papageorgiou</surname><given-names>G</given-names></string-name>, <string-name><surname>Miranda Afonso</surname><given-names>P.</given-names></string-name></person-group><italic toggle="yes">JMbayes2: Extended Joint Models for Longitudinal and Time-To-Event Data</italic>. R package version 0.2–4. <year>2022</year>. <ext-link xlink:href="https://cran.r-project.org/package=JMbayes2" ext-link-type="uri">https://cran.r-project.org/package=JMbayes2</ext-link> (30 September 2022, date last accessed).</mixed-citation>
    </ref>
    <ref id="dyad122-B13">
      <label>13</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Leroy</surname><given-names>T</given-names></string-name>, <string-name><surname>Monnet</surname><given-names>E</given-names></string-name>, <string-name><surname>Guerzider</surname><given-names>S</given-names></string-name></person-group><etal>et al</etal><article-title>Let us not underestimate the long-term risk of SPLC after surgical resection of NSCLC</article-title>. <source>Lung Cancer</source><year>2019</year>;<volume>137</volume>:<fpage>23</fpage>–<lpage>30</lpage>.<pub-id pub-id-type="pmid">31521979</pub-id></mixed-citation>
    </ref>
    <ref id="dyad122-B14">
      <label>14</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Nicolaie</surname><given-names>MA</given-names></string-name>, <string-name><surname>van Houwelingen</surname><given-names>JC</given-names></string-name>, <string-name><surname>de Witte</surname><given-names>TM</given-names></string-name>, <string-name><surname>Putter</surname><given-names>H.</given-names></string-name></person-group><article-title>Dynamic prediction by landmarking in competing risks</article-title>. <source>Stat Med</source><year>2013</year>;<volume>32</volume>:<fpage>2031</fpage>–<lpage>47</lpage>.<pub-id pub-id-type="pmid">23086627</pub-id></mixed-citation>
    </ref>
    <ref id="dyad122-B15">
      <label>15</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Varadhan</surname><given-names>R</given-names></string-name>, <string-name><surname>Weiss</surname><given-names>CO</given-names></string-name>, <string-name><surname>Segal</surname><given-names>JB</given-names></string-name></person-group><etal>et al</etal><article-title>Evaluating health outcomes in the presence of competing risks: a review of statistical methods and clinical applications</article-title>. <source>Med Care</source><year>2010</year>;<volume>48</volume>:<fpage>S96</fpage>–<lpage>105</lpage>.<pub-id pub-id-type="pmid">20473207</pub-id></mixed-citation>
    </ref>
    <ref id="dyad122-B16">
      <label>16</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Benichou</surname><given-names>J</given-names></string-name>, <string-name><surname>Gail</surname><given-names>MH.</given-names></string-name></person-group><article-title>Estimates of absolute cause-specific risk in cohort studies</article-title>. <source>Biometrics</source><year>1990</year>;<volume>46</volume>:<fpage>813</fpage>–<lpage>26</lpage>.<pub-id pub-id-type="pmid">2242416</pub-id></mixed-citation>
    </ref>
    <ref id="dyad122-B17">
      <label>17</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>He</surname><given-names>P</given-names></string-name>, <string-name><surname>Eriksson</surname><given-names>F</given-names></string-name>, <string-name><surname>Scheike</surname><given-names>TH</given-names></string-name>, <string-name><surname>Zhang</surname><given-names>MJ.</given-names></string-name></person-group><article-title>A proportional hazards regression model for the sub-distribution with covariates adjusted censoring weight for competing risks data</article-title>. <source>Scand Stat Theory Appl</source><year>2016</year>;<volume>43</volume>:<fpage>103</fpage>–<lpage>22</lpage>.<pub-id pub-id-type="pmid">27034534</pub-id></mixed-citation>
    </ref>
    <ref id="dyad122-B18">
      <label>18</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Cortese</surname><given-names>G</given-names></string-name>, <string-name><surname>Gerds</surname><given-names>TA</given-names></string-name>, <string-name><surname>Andersen</surname><given-names>PK.</given-names></string-name></person-group><article-title>Comparing predictions among competing risks models with time-dependent covariates</article-title>. <source>Stat Med</source><year>2013</year>;<volume>32</volume>:<fpage>3089</fpage>–<lpage>101</lpage>.<pub-id pub-id-type="pmid">23494745</pub-id></mixed-citation>
    </ref>
    <ref id="dyad122-B19">
      <label>19</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Choi</surname><given-names>E</given-names></string-name>, <string-name><surname>Sanyal</surname><given-names>N</given-names></string-name>, <string-name><surname>Ding</surname><given-names>VY</given-names></string-name></person-group><etal>et al</etal><article-title>Development and validation of a risk prediction model for second primary lung cancer</article-title>. <source>J Natl Cancer Inst</source><year>2022</year>;<volume>114</volume>:<fpage>87</fpage>–<lpage>96</lpage>.<pub-id pub-id-type="pmid">34255071</pub-id></mixed-citation>
    </ref>
    <ref id="dyad122-B20">
      <label>20</label>
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Gerds</surname><given-names>TA.</given-names></string-name></person-group><italic toggle="yes">prodlim: Product-Limit Estimation for Censored Event History Analysis</italic>. R package version 2019.11.13. <year>2019</year>. <ext-link xlink:href="https://CRAN.R-project.org/package=prodlim" ext-link-type="uri">https://CRAN.R-project.org/package=prodlim</ext-link> (30 September 2022, date last accessed).</mixed-citation>
    </ref>
    <ref id="dyad122-B21">
      <label>21</label>
      <mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Gerds</surname><given-names>TA</given-names></string-name>, <string-name><surname>Kattan</surname><given-names>MW.</given-names></string-name></person-group><source>Medical Risk Prediction Models: With Ties to Machine Learning</source>. Boca Laton, FL: <publisher-name>CRC Press</publisher-name>, <year>2021</year>.</mixed-citation>
    </ref>
    <ref id="dyad122-B22">
      <label>22</label>
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Therneau</surname><given-names>T.</given-names></string-name></person-group><italic toggle="yes">A Package for Survival Analysis in R</italic>. R package version 3.2–13. <year>2021</year>. <ext-link xlink:href="https://CRAN.R-project.org/package=survival" ext-link-type="uri">https://CRAN.R-project.org/package=survival</ext-link> (30 September 2022, date last accessed).</mixed-citation>
    </ref>
    <ref id="dyad122-B23">
      <label>23</label>
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Putter</surname><given-names>H.</given-names></string-name></person-group><italic toggle="yes">dynpred: Companion Package to “Dynamic Prediction in Clinical Survival Analysis”.</italic> R package version 0.1.2. <year>2015</year>. <ext-link xlink:href="https://CRAN.R-project.org/package=dynpred" ext-link-type="uri">https://CRAN.R-project.org/package=dynpred</ext-link> (30 September 2022, date last accessed).</mixed-citation>
    </ref>
    <ref id="dyad122-B24">
      <label>24</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Choi</surname><given-names>E</given-names></string-name>, <string-name><surname>Lam</surname><given-names>VT</given-names></string-name>, <string-name><surname>Aredo</surname><given-names>JA</given-names></string-name></person-group><etal>et al</etal><article-title>Abstract 3445: Long term effect of radiotherapy on risk of second primary lung cancer and overall mortality among lung cancer patients</article-title>. <source>Cancer Res</source><year>2022</year>;<volume>82</volume>:<fpage>3445</fpage>.</mixed-citation>
    </ref>
    <ref id="dyad122-B25">
      <label>25</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Li</surname><given-names>S</given-names></string-name>, <string-name><surname>Li</surname><given-names>N</given-names></string-name>, <string-name><surname>Wang</surname><given-names>H</given-names></string-name></person-group><etal>et al</etal><article-title>Efficient algorithms and implementation of a semiparametric joint model for longitudinal and competing risk data: with applications to massive biobank data</article-title>. <source>Comput Math Methods Med</source><year>2022</year>;<volume>2022</volume>:<fpage>1362913</fpage>.<pub-id pub-id-type="pmid">35178111</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Int J Epidemiol</journal-id>
    <journal-id journal-id-type="iso-abbrev">Int J Epidemiol</journal-id>
    <journal-id journal-id-type="publisher-id">ije</journal-id>
    <journal-title-group>
      <journal-title>International Journal of Epidemiology</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">0300-5771</issn>
    <issn pub-type="epub">1464-3685</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10749764</article-id>
    <article-id pub-id-type="pmid">37670428</article-id>
    <article-id pub-id-type="doi">10.1093/ije/dyad122</article-id>
    <article-id pub-id-type="publisher-id">dyad122</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Software Application Profile</subject>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/MED00860</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Software Application Profile: <italic toggle="yes">dynamicLM</italic>—a tool for performing dynamic risk prediction using a landmark supermodel for survival data under competing risks</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Fries</surname>
          <given-names>Anya H</given-names>
        </name>
        <aff><institution>Quantitative Sciences Unit, Department of Medicine, Stanford University School of Medicine</institution>, Stanford, CA, <country country="US">USA</country></aff>
        <xref rid="dyad122-FM1" ref-type="author-notes"/>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0003-1315-1433</contrib-id>
        <name>
          <surname>Choi</surname>
          <given-names>Eunji</given-names>
        </name>
        <aff><institution>Quantitative Sciences Unit, Department of Medicine, Stanford University School of Medicine</institution>, Stanford, CA, <country country="US">USA</country></aff>
        <xref rid="dyad122-FM1" ref-type="author-notes"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Wu</surname>
          <given-names>Julie T</given-names>
        </name>
        <aff><institution>Division of Oncology, Department of Medicine, Stanford University School of Medicine</institution>, Stanford, CA, <country country="US">USA</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Lee</surname>
          <given-names>Justin H</given-names>
        </name>
        <aff><institution>Quantitative Sciences Unit, Department of Medicine, Stanford University School of Medicine</institution>, Stanford, CA, <country country="US">USA</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Ding</surname>
          <given-names>Victoria Y</given-names>
        </name>
        <aff><institution>Quantitative Sciences Unit, Department of Medicine, Stanford University School of Medicine</institution>, Stanford, CA, <country country="US">USA</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Huang</surname>
          <given-names>Robert J</given-names>
        </name>
        <aff><institution>Division of Gastroenterology and Hepatology, Department of Medicine, Stanford University School of Medicine</institution>, Stanford, CA, <country country="US">USA</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Liang</surname>
          <given-names>Su-Ying</given-names>
        </name>
        <aff><institution>Palo Alto Medical Foundation Research Institute, Palo Alto Medical Foundation</institution>, Palo Alto, CA, <country country="US">USA</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Wakelee</surname>
          <given-names>Heather A</given-names>
        </name>
        <aff><institution>Division of Oncology, Department of Medicine, Stanford University School of Medicine</institution>, Stanford, CA, <country country="US">USA</country></aff>
        <aff><institution>Stanford Cancer Institute</institution>, Stanford, CA, <country country="US">USA</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Wilkens</surname>
          <given-names>Lynne R</given-names>
        </name>
        <aff><institution>Cancer Epidemiology Program, University of Hawaii Cancer Center</institution>, Honolulu, HI, <country country="US">USA</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Cheng</surname>
          <given-names>Iona</given-names>
        </name>
        <aff><institution>Department of Epidemiology and Biostatistics, University of California</institution>, San Francisco, CA, <country country="US">USA</country></aff>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-2013-6883</contrib-id>
        <name>
          <surname>Han</surname>
          <given-names>Summer S</given-names>
        </name>
        <aff><institution>Quantitative Sciences Unit, Department of Medicine, Stanford University School of Medicine</institution>, Stanford, CA, <country country="US">USA</country></aff>
        <aff><institution>Stanford Cancer Institute</institution>, Stanford, CA, <country country="US">USA</country></aff>
        <aff><institution>Department of Epidemiology and Population Health, Stanford University School of Medicine</institution>, Stanford, CA, <country country="US">USA</country></aff>
        <aff><institution>Department of Neurosurgery, Stanford University School of Medicine</institution>, Stanford, CA, <country country="US">USA</country></aff>
        <xref rid="dyad122-cor1" ref-type="corresp"/>
        <!--summer.han@stanford.edu-->
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="dyad122-cor1">Corresponding author. Quantitative Sciences Unit, Department of Medicine, Department of Neurosurgery, and Department of Epidemiology and Population Health, Stanford University School of Medicine, 3180 Porter Drive, Office 118, Stanford, CA 94304, USA. E-mail: <email>summer.han@stanford.edu</email></corresp>
      <fn id="dyad122-FM1">
        <p>Anya H Fries and Eunji Choi Equal contributions.</p>
      </fn>
    </author-notes>
    <pub-date pub-type="collection">
      <month>12</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2023-09-06">
      <day>06</day>
      <month>9</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>06</day>
      <month>9</month>
      <year>2023</year>
    </pub-date>
    <volume>52</volume>
    <issue>6</issue>
    <fpage>1984</fpage>
    <lpage>1989</lpage>
    <history>
      <date date-type="received">
        <day>06</day>
        <month>10</month>
        <year>2022</year>
      </date>
      <date date-type="editorial-decision">
        <day>03</day>
        <month>8</month>
        <year>2023</year>
      </date>
      <date date-type="accepted">
        <day>24</day>
        <month>8</month>
        <year>2023</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2023. Published by Oxford University Press on behalf of the International Epidemiological Association.</copyright-statement>
      <copyright-year>2023</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="dyad122.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Motivation</title>
        <p>Providing a dynamic assessment of prognosis is essential for improved personalized medicine. The landmark model for survival data provides a potentially powerful solution to the dynamic prediction of disease progression. However, a general framework and a flexible implementation of the model that incorporates various outcomes, such as competing events, have been lacking. We present an R package, <italic toggle="yes">dynamicLM</italic>, a user-friendly tool for the landmark model for the dynamic prediction of survival data under competing risks, which includes various functions for data preparation, model development, prediction and evaluation of predictive performance.</p>
      </sec>
      <sec id="s2">
        <title>Implementation</title>
        <p><italic toggle="yes">dynamicLM</italic> as an R package.</p>
      </sec>
      <sec id="s3">
        <title>General features</title>
        <p>The package includes options for incorporating time-varying covariates, capturing time-dependent effects of predictors and fitting a cause-specific landmark model for time-to-event data with or without competing risks. Tools for evaluating the prediction performance include time-dependent area under the ROC curve, Brier Score and calibration.</p>
      </sec>
      <sec id="s4">
        <title>Availability</title>
        <p>Available on GitHub [<ext-link xlink:href="https://github.com/thehanlab/dynamicLM" ext-link-type="uri">https://github.com/thehanlab/dynamicLM</ext-link>].</p>
      </sec>
    </abstract>
    <kwd-group>
      <kwd>Landmark</kwd>
      <kwd>competing risks</kwd>
      <kwd>dynamic prediction</kwd>
      <kwd>time-dependent variables</kwd>
      <kwd>R</kwd>
    </kwd-group>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>National Institutes of Health</institution>
            <institution-id institution-id-type="DOI">10.13039/100000002</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>4R37CA226081</award-id>
        <award-id>1R01CA282793</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Stanford Cancer Institute</institution>
            <institution-id institution-id-type="DOI">10.13039/100014549</institution-id>
          </institution-wrap>
        </funding-source>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>NCI</institution>
            <institution-id institution-id-type="DOI">10.13039/100000054</institution-id>
          </institution-wrap>
        </funding-source>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="6"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec sec-type="intro">
    <title>Introduction</title>
    <p>Accurate prediction of disease prognosis is essential for effective clinical decision-making.<xref rid="dyad122-B1" ref-type="bibr"><sup>1</sup></xref> Traditional prediction models are commonly used to estimate the risk of the event of interest (e.g. mortality) at a fixed time point—such as at the time of diagnosis<xref rid="dyad122-B2" ref-type="bibr"><sup>2</sup></xref><sup>,</sup><xref rid="dyad122-B3" ref-type="bibr"><sup>3</sup></xref> or the end of curative treatment<xref rid="dyad122-B4" ref-type="bibr"><sup>4</sup></xref><sup>,</sup><xref rid="dyad122-B5" ref-type="bibr"><sup>5</sup></xref>—and thus may fail to provide updated risk estimates that can change over time.<xref rid="dyad122-B6" ref-type="bibr"><sup>6</sup></xref><sup>,</sup><xref rid="dyad122-B7" ref-type="bibr"><sup>7</sup></xref> Temporal changes in patient data can affect the subsequent risk, and incorporating these changes can help update risk estimations for optimal patient management.<xref rid="dyad122-B6" ref-type="bibr"><sup>6</sup></xref><sup>,</sup><xref rid="dyad122-B8" ref-type="bibr"><sup>8</sup></xref></p>
    <p>The landmark model<xref rid="dyad122-B6" ref-type="bibr"><sup>6</sup></xref><sup>,</sup><xref rid="dyad122-B8" ref-type="bibr"><sup>8–10</sup></xref> and joint modeling<xref rid="dyad122-B11" ref-type="bibr"><sup>11</sup></xref><sup>,</sup><xref rid="dyad122-B12" ref-type="bibr"><sup>12</sup></xref> are two approaches used for dynamic prediction for survival data. Joint modeling can provide accurate estimates by simultaneously modeling the longitudinal markers and time-to-event outcome, but it is computationally intensive and requires more modelling assumptions. Alternatively the landmark model, built based on the concept of ongoing risk assessment times (i.e. landmarks) following the baseline, reduces the computational burden to provide updated risk estimates for large-scale data. Specifically, the dataset is transformed into multiple censored datasets based on a prediction window of interest and predefined landmarks. A model is then fitted on this stacked dataset (i.e. supermodel) that incorporates the dynamic trajectories of the patients, which can be used to provide the most up-to-date risk predictions.</p>
    <p>Most landmark models for dynamic prediction have been applied in the context of standard survival outcomes using the Cox model.<xref rid="dyad122-B6" ref-type="bibr"><sup>6</sup></xref><sup>,</sup><xref rid="dyad122-B9" ref-type="bibr"><sup>9</sup></xref><sup>,</sup><xref rid="dyad122-B10" ref-type="bibr"><sup>10</sup></xref> However, it is often observed that other causes of failure (i.e. competing events) may preclude the occurrence of the event of interest. Ignoring competing risks from prediction can lead to an overestimation of the risk.<xref rid="dyad122-B13" ref-type="bibr"><sup>13–15</sup></xref> The cause-specific Cox (CSC) model<xref rid="dyad122-B16" ref-type="bibr"><sup>16</sup></xref> is one solution that combines several fitted Cox models to avoid the overestimation of the predicted risk.<xref rid="dyad122-B15" ref-type="bibr"><sup>15</sup></xref> There have been efforts to incorporate competing risks into dynamic prediction,<xref rid="dyad122-B10" ref-type="bibr"><sup>10</sup></xref><sup>,</sup><xref rid="dyad122-B14" ref-type="bibr"><sup>14</sup></xref><sup>,</sup><xref rid="dyad122-B17" ref-type="bibr"><sup>17</sup></xref><sup>,</sup><xref rid="dyad122-B18" ref-type="bibr"><sup>18</sup></xref> but they lack a user-friendly implementation. Furthermore, practical evaluations (e.g. computational feasibility) of the dynamic landmark model for competing-risk data have been lacking.</p>
    <p>We introduce an R package, <italic toggle="yes">dynamicLM</italic>, a tool to implement the landmark model for dynamic predictions using survival data incorporating competing risks. The package provides a framework including data preparation, model fitting, prediction, evaluation and visualization. We illustrate this method by applying it to predict second primary lung cancer risk from the Multiethnic Cohort Study<xref rid="dyad122-B19" ref-type="bibr"><sup>19</sup></xref> with a set of simulations.</p>
  </sec>
  <sec>
    <title>Implementation</title>
    <p>The <italic toggle="yes">dynamicLM</italic> tool provides a simple framework to perform dynamic <inline-formula id="IE1"><mml:math id="IM1" display="inline" overflow="scroll"><mml:mi>w</mml:mi></mml:math></inline-formula>-year risk predictions, i.e. predicting the risk of developing the event of interest within <inline-formula id="IE2"><mml:math id="IM2" display="inline" overflow="scroll"><mml:mi>w</mml:mi></mml:math></inline-formula> years from each risk assessment. Risk prediction for the next <inline-formula id="IE3"><mml:math id="IM3" display="inline" overflow="scroll"><mml:mi>w</mml:mi></mml:math></inline-formula> years is made at baseline (e.g. diagnosis) and at a later set of risk assessment times (‘landmark’ times).</p>
    <p>Input data can take various forms; covariates can be static (e.g. race), time-varying (e.g. biomarker changes) or a mix. Time-varying covariates can be in long or wide formats. Outcomes can be time-to-event for one cause (standard survival data) or a specific event in the presence of competing event(s). <italic toggle="yes">dynamicLM</italic> includes implementations of the Cox landmark model for standard survival data and the CSC landmark model for competing risk data.</p>
    <p>The hazard of each cause-specific landmark supermodel for cause <inline-formula id="IE4"><mml:math id="IM4" display="inline" overflow="scroll"><mml:mi>j</mml:mi></mml:math></inline-formula> (<inline-formula id="IE5"><mml:math id="IM5" display="inline" overflow="scroll"><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mi>C</mml:mi><mml:mo>)</mml:mo></mml:math></inline-formula> from a landmark time <inline-formula id="IE6"><mml:math id="IM6" display="inline" overflow="scroll"><mml:mi>s</mml:mi><mml:mo>∈</mml:mo><mml:mfenced open="[" close="]" separators="|"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:mfenced></mml:math></inline-formula> for time <italic toggle="yes">t</italic> (<inline-formula id="IE7"><mml:math id="IM7" display="inline" overflow="scroll"><mml:mi>s</mml:mi><mml:mo>≤</mml:mo><mml:mi>t</mml:mi><mml:mo>≤</mml:mo><mml:mi>s</mml:mi><mml:mo>+</mml:mo><mml:mi>w</mml:mi></mml:math></inline-formula>) is:</p>
    <disp-formula id="E1">
      <mml:math id="M1" display="block" overflow="scroll">
        <mml:mrow>
          <mml:msub>
            <mml:mrow>
              <mml:mi>h</mml:mi>
            </mml:mrow>
            <mml:mrow>
              <mml:mi>j</mml:mi>
            </mml:mrow>
          </mml:msub>
        </mml:mrow>
        <mml:mfenced open="(" close=")" separators="|">
          <mml:mrow>
            <mml:mi>t</mml:mi>
          </mml:mrow>
          <mml:mrow>
            <mml:mi mathvariant="bold-italic">Z</mml:mi>
            <mml:mfenced open="(" close=")" separators="|">
              <mml:mrow>
                <mml:mi>s</mml:mi>
              </mml:mrow>
            </mml:mfenced>
            <mml:mo>,</mml:mo>
            <mml:mi>s</mml:mi>
          </mml:mrow>
        </mml:mfenced>
        <mml:mo>=</mml:mo>
        <mml:mrow>
          <mml:msub>
            <mml:mrow>
              <mml:mi>h</mml:mi>
            </mml:mrow>
            <mml:mrow>
              <mml:mi>j</mml:mi>
              <mml:mn>0</mml:mn>
            </mml:mrow>
          </mml:msub>
        </mml:mrow>
        <mml:mfenced open="(" close=")" separators="|">
          <mml:mrow>
            <mml:mi>t</mml:mi>
          </mml:mrow>
        </mml:mfenced>
        <mml:mrow>
          <mml:mrow>
            <mml:mi mathvariant="normal">exp</mml:mi>
          </mml:mrow>
          <mml:mo>⁡</mml:mo>
          <mml:mrow>
            <mml:mfenced open="(" close=")" separators="|">
              <mml:mrow>
                <mml:mrow>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mo>θ</mml:mo>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>j</mml:mi>
                    </mml:mrow>
                  </mml:msub>
                </mml:mrow>
                <mml:mfenced open="(" close=")" separators="|">
                  <mml:mrow>
                    <mml:mi>s</mml:mi>
                  </mml:mrow>
                </mml:mfenced>
                <mml:mo>+</mml:mo>
                <mml:mrow>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi mathvariant="bold-italic">β</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>j</mml:mi>
                    </mml:mrow>
                  </mml:msub>
                </mml:mrow>
                <mml:mfenced open="(" close=")" separators="|">
                  <mml:mrow>
                    <mml:mi>s</mml:mi>
                  </mml:mrow>
                </mml:mfenced>
                <mml:mi mathvariant="bold-italic">Z</mml:mi>
                <mml:mo>(</mml:mo>
                <mml:mi>s</mml:mi>
                <mml:mo>)</mml:mo>
              </mml:mrow>
            </mml:mfenced>
          </mml:mrow>
        </mml:mrow>
      </mml:math>
    </disp-formula>
    <p>where <inline-formula id="IE8"><mml:math id="IM8" display="inline" overflow="scroll"><mml:mo>θ</mml:mo><mml:mfenced open="(" close=")" separators="|"><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:mfenced></mml:math></inline-formula> models the main effects of the landmark time <inline-formula id="IE9"><mml:math id="IM9" display="inline" overflow="scroll"><mml:mi>s</mml:mi></mml:math></inline-formula> and <inline-formula id="IE10"><mml:math id="IM10" display="inline" overflow="scroll"><mml:mi mathvariant="bold-italic">Z</mml:mi><mml:mo>(</mml:mo><mml:mi>s</mml:mi><mml:mo>)</mml:mo></mml:math></inline-formula> denotes the most recent covariates of individual observed until <inline-formula id="IE11"><mml:math id="IM11" display="inline" overflow="scroll"><mml:mi>s</mml:mi></mml:math></inline-formula>. In particular, the baseline hazard at time <inline-formula id="IE12"><mml:math id="IM12" display="inline" overflow="scroll"><mml:mi>t</mml:mi></mml:math></inline-formula>, <inline-formula id="IE13"><mml:math id="IM13" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mfenced open="(" close=")" separators="|"><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:mfenced><mml:mrow><mml:mrow><mml:mi mathvariant="normal">exp</mml:mi></mml:mrow><mml:mo>⁡</mml:mo><mml:mrow><mml:mfenced open="(" close=")" separators="|"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mo>θ</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mfenced open="(" close=")" separators="|"><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced></mml:mrow></mml:mrow></mml:math></inline-formula>, is the probability that a person with all zero covariates will experience the event in the next instant if that person survives to <inline-formula id="IE14"><mml:math id="IM14" display="inline" overflow="scroll"><mml:mi>t</mml:mi></mml:math></inline-formula> from <inline-formula id="IE15"><mml:math id="IM15" display="inline" overflow="scroll"><mml:mi>s</mml:mi></mml:math></inline-formula>. The interaction of <inline-formula id="IE16"><mml:math id="IM16" display="inline" overflow="scroll"><mml:mi>s</mml:mi></mml:math></inline-formula> with the covariates, modelled by <inline-formula id="IE17"><mml:math id="IM17" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mfenced open="(" close=")" separators="|"><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:mfenced></mml:math></inline-formula>, captures the time-dependent effects of covariates. The <inline-formula id="IE18"><mml:math id="IM18" display="inline" overflow="scroll"><mml:mi>w</mml:mi></mml:math></inline-formula>-year survival and (cause-specific) cumulative incidence for cause <inline-formula id="IE19"><mml:math id="IM19" display="inline" overflow="scroll"><mml:mi>j</mml:mi></mml:math></inline-formula> can be predicted at any point <inline-formula id="IE20"><mml:math id="IM20" display="inline" overflow="scroll"><mml:mi>s</mml:mi></mml:math></inline-formula> in the window <inline-formula id="IE21"><mml:math id="IM21" display="inline" overflow="scroll"><mml:mo>[</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>]</mml:mo></mml:math></inline-formula>:</p>
    <disp-formula id="E2">
      <mml:math id="M2" display="block" overflow="scroll">
        <mml:mi>S</mml:mi>
        <mml:mfenced open="(" close=")" separators="|">
          <mml:mrow>
            <mml:mi>s</mml:mi>
            <mml:mo>+</mml:mo>
            <mml:mi>w</mml:mi>
          </mml:mrow>
          <mml:mrow>
            <mml:mi mathvariant="bold-italic">Z</mml:mi>
            <mml:mfenced open="(" close=")" separators="|">
              <mml:mrow>
                <mml:mi>s</mml:mi>
              </mml:mrow>
            </mml:mfenced>
            <mml:mo>,</mml:mo>
            <mml:mi>s</mml:mi>
          </mml:mrow>
        </mml:mfenced>
        <mml:mo>=</mml:mo>
        <mml:mrow>
          <mml:mrow>
            <mml:mi mathvariant="normal">exp</mml:mi>
          </mml:mrow>
          <mml:mo>⁡</mml:mo>
          <mml:mrow>
            <mml:mfenced open="(" close=")" separators="|">
              <mml:mrow>
                <mml:mo>-</mml:mo>
                <mml:mrow>
                  <mml:mrow>
                    <mml:msubsup>
                      <mml:mo stretchy="false">∫</mml:mo>
                      <mml:mrow>
                        <mml:mi>s</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>s</mml:mi>
                        <mml:mo>+</mml:mo>
                        <mml:mi>w</mml:mi>
                      </mml:mrow>
                    </mml:msubsup>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mrow>
                      <mml:mrow>
                        <mml:msubsup>
                          <mml:mo stretchy="false">∑</mml:mo>
                          <mml:mrow>
                            <mml:mi>j</mml:mi>
                            <mml:mo>=</mml:mo>
                            <mml:mn>1</mml:mn>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mi>C</mml:mi>
                          </mml:mrow>
                        </mml:msubsup>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mi>h</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mi>j</mml:mi>
                            </mml:mrow>
                          </mml:msub>
                        </mml:mrow>
                        <mml:mfenced open="(" close=")" separators="|">
                          <mml:mrow>
                            <mml:mi>t</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mi mathvariant="bold-italic">Z</mml:mi>
                            <mml:mfenced open="(" close=")" separators="|">
                              <mml:mrow>
                                <mml:mi>s</mml:mi>
                              </mml:mrow>
                            </mml:mfenced>
                            <mml:mo>,</mml:mo>
                            <mml:mi>s</mml:mi>
                          </mml:mrow>
                        </mml:mfenced>
                      </mml:mrow>
                    </mml:mrow>
                    <mml:mi>d</mml:mi>
                    <mml:mi>t</mml:mi>
                  </mml:mrow>
                </mml:mrow>
              </mml:mrow>
            </mml:mfenced>
          </mml:mrow>
        </mml:mrow>
      </mml:math>
    </disp-formula>
    <p>and</p>
    <disp-formula id="E3">
      <mml:math id="M3" display="block" overflow="scroll">
        <mml:mrow>
          <mml:msub>
            <mml:mrow>
              <mml:mi>F</mml:mi>
            </mml:mrow>
            <mml:mrow>
              <mml:mi>j</mml:mi>
            </mml:mrow>
          </mml:msub>
        </mml:mrow>
        <mml:mfenced open="(" close=")" separators="|">
          <mml:mrow>
            <mml:mi>s</mml:mi>
            <mml:mo>+</mml:mo>
            <mml:mi>w</mml:mi>
          </mml:mrow>
          <mml:mrow>
            <mml:mi mathvariant="bold-italic">Z</mml:mi>
            <mml:mfenced open="(" close=")" separators="|">
              <mml:mrow>
                <mml:mi>s</mml:mi>
              </mml:mrow>
            </mml:mfenced>
            <mml:mo>,</mml:mo>
            <mml:mi>s</mml:mi>
          </mml:mrow>
        </mml:mfenced>
        <mml:mo>=</mml:mo>
        <mml:mrow>
          <mml:mrow>
            <mml:msubsup>
              <mml:mo stretchy="false">∫</mml:mo>
              <mml:mrow>
                <mml:mi>s</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>s</mml:mi>
                <mml:mo>+</mml:mo>
                <mml:mi>w</mml:mi>
              </mml:mrow>
            </mml:msubsup>
          </mml:mrow>
          <mml:mrow>
            <mml:mrow>
              <mml:msub>
                <mml:mrow>
                  <mml:mi>h</mml:mi>
                </mml:mrow>
                <mml:mrow>
                  <mml:mi>j</mml:mi>
                </mml:mrow>
              </mml:msub>
            </mml:mrow>
            <mml:mfenced open="(" close=")" separators="|">
              <mml:mrow>
                <mml:mi>t</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi mathvariant="bold-italic">Z</mml:mi>
                <mml:mfenced open="(" close=")" separators="|">
                  <mml:mrow>
                    <mml:mi>s</mml:mi>
                  </mml:mrow>
                </mml:mfenced>
                <mml:mo>,</mml:mo>
                <mml:mi>s</mml:mi>
              </mml:mrow>
            </mml:mfenced>
            <mml:mi>S</mml:mi>
            <mml:mfenced open="(" close=")" separators="|">
              <mml:mrow>
                <mml:mi>t</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi mathvariant="bold-italic">Z</mml:mi>
                <mml:mfenced open="(" close=")" separators="|">
                  <mml:mrow>
                    <mml:mi>s</mml:mi>
                  </mml:mrow>
                </mml:mfenced>
                <mml:mo>,</mml:mo>
                <mml:mi>s</mml:mi>
              </mml:mrow>
            </mml:mfenced>
            <mml:mi>d</mml:mi>
            <mml:mi>t</mml:mi>
          </mml:mrow>
        </mml:mrow>
      </mml:math>
    </disp-formula>
    <p>respectively.</p>
    <p>Estimating cumulative incidence in <italic toggle="yes">dynamicLM</italic> involves an iteration over the causes and landmarks in the super dataset. It also uses <italic toggle="yes">prodlim,</italic><xref rid="dyad122-B20" ref-type="bibr"><sup>20</sup></xref><italic toggle="yes">riskRegression,</italic><xref rid="dyad122-B21" ref-type="bibr"><sup>21</sup></xref><italic toggle="yes">survival</italic><xref rid="dyad122-B22" ref-type="bibr"><sup>22</sup></xref> and <italic toggle="yes">dynpred</italic><xref rid="dyad122-B23" ref-type="bibr"><sup>23</sup></xref> R packages. The <italic toggle="yes">dynamicLM</italic> package has a PDF manual that is downloadable from GitHub [<ext-link xlink:href="https://github.com/thehanlab/dynamicLM" ext-link-type="uri">https://github.com/thehanlab/dynamicLM</ext-link>] and accessible in R program (See <xref rid="sup1" ref-type="supplementary-material">Supplementary Method 1</xref>, available as <xref rid="sup1" ref-type="supplementary-material">Supplementary data</xref> at <italic toggle="yes">IJE</italic> online).</p>
  </sec>
  <sec>
    <title>Use</title>
    <p>This section presents the application of <italic toggle="yes">dynamicLM</italic> to develop a risk-prediction model for second primary lung cancer (SPLC) among lung cancer patients using the CSC landmark supermodel. The data contain 3844 ever-smoking patients diagnosed with initial primary lung cancer (IPLC) between 1993 and 2007, followed through 2017, in the Multiethnic Cohort Study (MEC) (<xref rid="sup1" ref-type="supplementary-material">Supplementary Method 2</xref>, available as <xref rid="sup1" ref-type="supplementary-material">Supplementary data</xref> at <italic toggle="yes">IJE</italic> online).</p>
    <p>The event of interest is the time from IPLC to SPLC diagnosis (Cause 1) with competing events of lung cancer death (Cause 2) and other-cause death (Cause 3). First, we load the package and data into our R session:<disp-quote content-type="extract"><p><monospace>&gt; devtools::install_github("thehanlab/dynamicLM")</monospace></p><p><monospace>&gt; library(dynamicLM)</monospace></p><p><monospace>&gt; data(splc)</monospace></p><p>*The example dataset in this R package is synthetic because the original MEC data are only available under a data use agreement. Readers can apply the code but cannot replicate the same estimates.</p></disp-quote></p>
    <p>The super dataset setup requires: (ii) the outcome columns; and (ii) variable types (fixed vs time-varying). Fixed variables (e.g. sex) do not change over time, whereas time-varying covariates (e.g. smoking status at baseline and 10-year follow-up surveys) do. In this example, the fixed covariates include age at IPLC diagnosis (‘age.ix’), family history of lung cancer (‘fh’), prior history of cancer (‘ph’), IPLC stage (‘stage.ix’), IPLC histology and IPLC treatment. The time-varying covariates include smoking-related variables. The following code sets this up:<disp-quote content-type="extract"><p><monospace>&gt; outcome &lt;- list(time = "Time", status = "event")</monospace></p><p><monospace>&gt; fix_covs &lt;- c("age.ix", "male", "fh", "ph",          "bmi", "stage.ix",</monospace></p><p><monospace>         "hist_AD", "hist_LC",          "hist_NSCLC_NOS", "hist_SC",</monospace></p><p><monospace>         "hist_OTH", "surgery.ix",          "radiation.ix",</monospace></p><p><monospace>         "chemo.ix", "quityears")</monospace></p><p><monospace>&gt; vary_covs &lt;- c("smkstatus", "cigday",           "packyears")</monospace></p><p><monospace>&gt; covs &lt;- list(fixed = fix_covs,          varying = vary_covs)</monospace></p></disp-quote></p>
    <p>To predict the 5-year SPLC risk during the first 3 years of IPLC diagnosis, we first specified a prediction window and established a set of landmarks (i.e. risk assessment time points at 0, 1, 2 and 3 years from IPLC diagnosis), producing one stacked dataset (‘lmdata’) of four landmark datasets (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S1</xref> and <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S1</xref>, available as <xref rid="sup1" ref-type="supplementary-material">Supplementary data</xref> at <italic toggle="yes">IJE</italic> online). The original dataset (splc) is in long-form format that may include multiple observations per patient if the patient has 10-year follow-up survey data (<xref rid="sup1" ref-type="supplementary-material">Supplementary Method 2</xref>, available as <xref rid="sup1" ref-type="supplementary-material">Supplementary data</xref> at <italic toggle="yes">IJE</italic> online). The column ‘T.fup’ represents the duration between baseline and follow-up measurements of time-varying covariates (‘smkstatus’, ‘cigday’ and ‘packyears’). This follow-up time is specified in the ‘rtime’ argument:<disp-quote content-type="extract"><p><monospace>&gt; w &lt;- 5           #5-year prediction                 window</monospace></p><p><monospace>&gt; lms &lt;- seq(0, 3, by = 1) #landmarks</monospace></p><p><monospace>&gt; lmdata &lt;- stack_data(data = splc,              outcome = outcome,              lms = lms,</monospace></p><p><monospace>                 w = w, covs = covs,                id = "ID",</monospace></p><p><monospace>               format = "long",                rtime = "T.fup")</monospace></p><p><monospace>&gt; table(lmdata$data$LM) #Number of patients per landmark</monospace></p></disp-quote></p>
    <p>Certain time-varying covariates can be manually updated as time passes. In our data, smoking quit years (‘quityears’) increase linearly for former smokers:<disp-quote content-type="extract"><p><monospace>&gt; former_smokers &lt;- lmdata$data$smkstatus == 2</monospace></p><p><monospace>&gt; lmdata$data[former_smokers, "quityears"] &lt;-</monospace></p><p><monospace>    lmdata$data[former_smokers,     "quityears"] +</monospace></p><p><monospace>    lmdata$data[former_smokers, "LM"]</monospace></p></disp-quote></p>
    <p>The next step involves creating; (i) interaction terms between chosen covariates (‘lm_covs’) and landmark times (linear, quadratic, or other forms using ‘func_covars’) to examine time-dependent effects of the covariate and check the proportional hazard assumption; and (ii) transformations of the landmark time variables (‘func_lms’).</p>
    <p>Unlike time-varying covariates, time-dependent effects occur when the hazard of a covariate changes over time. For example, the effect of radiotherapy given to treat IPLC on SPLC risk has been reported to increase over time.<xref rid="dyad122-B24" ref-type="bibr"><sup>24</sup></xref> We selected a priori a list of variables and associated transformations (linear, quadratic) to be checked for the time-dependent effects based on domain knowledge of how variable effects change over time. Certain other transformations (e.g. logarithmic) can be added if necessary (<xref rid="sup1" ref-type="supplementary-material">Supplementary Method 2</xref>, available as <xref rid="sup1" ref-type="supplementary-material">Supplementary data</xref> at <italic toggle="yes">IJE</italic> online). The newly created interaction terms are identified by each variable name followed by an underscore and number (e.g. stage.ix_1 = stage.ix*LM, and stage.ix_2 = stage.ix*LM<sup>2</sup>).</p>
    <p>We add linear and quadratic landmark time transformations using ‘func_lms’ to incorporate the smoothing across landmarks into modelling:<disp-quote content-type="extract"><p><monospace>&gt; lm_covs &lt;- c("packyears", "radiation.ix",            "ph", "stage.ix",</monospace></p><p><monospace>         "hist_AD", "hist_LC",          "hist_NSCLC_NOS", "hist_SC",</monospace></p><p><monospace>         "hist_OTH")</monospace></p><p><monospace>&gt; lmdata &lt;- add_interactions            (lmdata = lmdata,             lm_covs = lm_covs,</monospace></p><p><monospace>            func_covars = c("linear",             "quadratic"),</monospace></p><p><monospace>            func_lms = c("linear",             "quadratic"))</monospace></p><p><monospace>&gt; colnames(lmdata$data) #columns of added terms</monospace></p></disp-quote></p>
    <p>A model is then fit on the stacked dataset. Our model selection procedure is in <xref rid="sup1" ref-type="supplementary-material">Supplementary Method 2</xref>, available as <xref rid="sup1" ref-type="supplementary-material">Supplementary data</xref> at <italic toggle="yes">IJE</italic> online:<disp-quote content-type="extract"><p><monospace>formula &lt;- "Hist(Time, event, LM) ∼      male + ph + ph_1 +     radiation.ix + radiation.ix_1 +      packyears + quityears +      hist_AD + hist_LC +      hist_NSCLC_NOS +      hist_OTH + hist_SC +      hist_AD_1 + hist_LC_1 +      hist_NSCLC_NOS_1 +      hist_OTH_1 + hist_SC_1 +      stage.ix + stage.ix_1 + stage.ix_2 +      LM_1 + LM_2 +      cluster(ID)"</monospace></p><p><monospace>&gt; supermodel &lt;- dynamic_lm(lmdata = lmdata,</monospace></p><p><monospace>        formula = as.formula(formula),</monospace></p><p><monospace>        type = "CSC")</monospace></p><p><monospace>&gt; print(supermodel)</monospace></p></disp-quote></p>
    <p>The dynamic cause-specific hazard ratios of the final model are depicted in <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S2</xref> (available as <xref rid="sup1" ref-type="supplementary-material">Supplementary data</xref> at <italic toggle="yes">IJE</italic> online). Covariates with time-dependent effects included IPLC radiotherapy (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S2</xref>, available as <xref rid="sup1" ref-type="supplementary-material">Supplementary data</xref> at <italic toggle="yes">IJE</italic> online). To plot dynamic hazard ratios to capture the increased effect on SPLC risk:<disp-quote content-type="extract"><p><monospace>&gt; plot(supermodel, "radiation.ix", logHR = FALSE)</monospace></p></disp-quote></p>
    <p>Individual 5-year predicted risk can be estimated:<disp-quote content-type="extract"><p><monospace>&gt; p &lt;- predict(supermodel); summary(p$preds)</monospace></p></disp-quote></p>
    <p>To evaluate the model, we create calibration plots and compute area under the curve (AUC) and Brier score. Bootstrapped internal validation and external validation can be performed (<xref rid="sup1" ref-type="supplementary-material">Supplementary Method 2</xref>, available as <xref rid="sup1" ref-type="supplementary-material">Supplementary data</xref> at <italic toggle="yes">IJE</italic> online). Our model showed good calibration (calibration slope: 0.9–1.2 across landmarks) (<xref rid="dyad122-F1" ref-type="fig">Figure 1</xref>; <xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S3</xref>, available as <xref rid="sup1" ref-type="supplementary-material">Supplementary data</xref> at <italic toggle="yes">IJE</italic> online) and high discrimination at baseline (AUC &gt;80%). The AUC decreased over landmarks because most of the data in model fitting come from the baseline in MEC, which could be one limitation of this data. If patient features are updated over time, the model’s predictive accuracy could stay consistent:<disp-quote content-type="extract"><p><monospace>&gt; par(mfrow = c(2, 2))</monospace></p><p><monospace>&gt; cal &lt;- calplot(list("CSC" = p),</monospace></p><p><monospace>          xlim = c(0, 0.25),           ylim = c(0, 0.25),</monospace></p><p><monospace>          method</monospace><monospace>= "quantile",           q = 10) #deciles</monospace></p><p><monospace>&gt; score(list("CSC" = p)) #AUC and Brier</monospace></p></disp-quote></p>
    <fig position="float" id="dyad122-F1">
      <label>Figure 1.</label>
      <caption>
        <p>A dynamic prediction model for 5-year risk of SPLC among IPLC patients in the Multiethnic Cohort Study. (A) Predictive performance [discrimination (AUC), calibration (calibration slope) and predictive accuracy [Brier score]) of the proposed model across risk assessment times. (B) The dynamic trajectory of estimated 5-year SPLC risk across different risk assessment times (landmark times) among two example individuals. With a 5-year predefined prediction window (w = 5), the risk of developing SPLC in 5 years was estimated at each landmark time [i.e. risk assessment time or prediction time point (unit: years)] across the horizontal coordinates. In this example, the 5-year risk of developing SPLC in Patient P1 is 0.97% when predicted at IPLC diagnosis (Landmark = 0), which is updated to 1.43% [when predicted at 1 year after IPLC diagnosis (Landmark = 1)], 3.06% [when predicted at 2 years after IPLC diagnosis (Landmark = 2)] and 4.38% [when predicted at 3 years after IPLC diagnosis (Landmark = 3)] at successive landmarks based on the most recent patient information seen till each landmark. (C) In Panel (B), Patient P1’s 5-year SPLC risk increases over the landmark times due to accumulated smoking pack-years and IPLC radiotherapy which have time-dependent effects for SPLC risk; Patient P2’s 5-year SPLC risk decreases over time due to increasing smoking quit-years and ‘other’ IPLC histology which have time-dependent effects for SPLC risk (see <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S2</xref>, available as <xref rid="sup1" ref-type="supplementary-material">Supplementary data</xref> at <italic toggle="yes">IJE</italic> online). AD, adenocarcinoma IPLC histology; AUC, srea under the receiver operating characteristic curve; ID, identifier; IPLC, initial primary lung cancer; LM, landmark time; OTH, Other (not belonging to non-small-cell lung cancer nor small-cell lung cancer) IPLC histology; SPLC, second primary lung cancer</p>
      </caption>
      <graphic xlink:href="dyad122f1" position="float"/>
    </fig>
    <p>An example of two patients’ dynamic 5-year SPLC risk is shown in <xref rid="dyad122-F1" ref-type="fig">Figure 1B</xref>. The increasing SPLC risk in Patient P1 was driven by latent IPLC radiotherapy, which has an increasing effect on SPLC over time (<xref rid="dyad122-F1" ref-type="fig">Figure 1C</xref>):<disp-quote content-type="extract"><p><monospace>&gt; par(mfrow = c(1, 1))</monospace></p><p><monospace>&gt; inds &lt;- lmdata$data[lmdata$data$ID %in%             c("ID2", "ID7"), ]</monospace></p><p><monospace>&gt; plotrisk(supermodel, inds, format = "long",        ylim = c(0, 0.2))</monospace></p></disp-quote></p>
  </sec>
  <sec>
    <title>Simulation</title>
    <p>We conducted simulations to evaluate the computational feasibility of <italic toggle="yes">dynamicLM</italic> and to assess the impact of accounting for competing risks in the landmark supermodel when they are present. The simulation methods are included in <xref rid="sup1" ref-type="supplementary-material">Supplementary Method</xref> 3 (available as <xref rid="sup1" ref-type="supplementary-material">Supplementary data</xref> at <italic toggle="yes">IJE</italic> online).</p>
    <p>The computational feasibility of <italic toggle="yes">dynamicLM</italic> compared with joint modeling (packages <italic toggle="yes">JMbayes2</italic><xref rid="dyad122-B12" ref-type="bibr"><sup>12</sup></xref> and <italic toggle="yes">FastJM</italic><xref rid="dyad122-B25" ref-type="bibr"><sup>25</sup></xref>) across different scenarios is shown in <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S3</xref> (available as <xref rid="sup1" ref-type="supplementary-material">Supplementary data</xref> at <italic toggle="yes">IJE</italic> online). <italic toggle="yes">dynamicLM</italic> has the shortest mean time (&lt;0.1 s) for fitting a CSC landmark model and calculating individual-level predictions (&lt;41 s). <italic toggle="yes">JMbayes2</italic> takes considerably longer (&gt;240 s for model fitting and &gt;120 s for prediction using 3000 individuals). Although <italic toggle="yes">FastJM</italic> scales better than <italic toggle="yes">JMbayes2</italic> for model fitting, it cannot handle multiple time-varying covariates. Landmark modelling (<italic toggle="yes">dynamicLM</italic>) is scalable for high-dimensional data with multiple time-varying covariates.</p>
    <p>The simulation results for evaluating the impact of correctly handling competing events on predictive accuracy are shown in <xref rid="dyad122-F2" ref-type="fig">Figure 2</xref>. Using a standard Cox landmark model instead of a CSC landmark model leads to reduced predictive performance when competing risks exist. The difference in AUC between the two models becomes more pronounced over landmark times.</p>
    <fig position="float" id="dyad122-F2">
      <label>Figure 2.</label>
      <caption>
        <p>Simulation study to evaluate the impact of model misspecification for analysing landmark superdata under competing risks. Dynamic time-dependent AUCs are compared across four different landmark times of 0, 0.5, 1 and 1.5 years from baseline for predicting a 2-year risk using a standard Cox landmark model (that censors competing events) vs a cause-specific Cox (CSC) landmark model (correct model that accounts for competing risks). We simulated 100 datasets in the presence of competing risks, with each dataset including 1000 individuals and 10 predictors. The details of the simulation methods are shown in the <xref rid="sup1" ref-type="supplementary-material">Supplementary Methods</xref> (available as <xref rid="sup1" ref-type="supplementary-material">Supplementary data</xref> at <italic toggle="yes">IJE</italic> online). AUC, area under the receiver operating characteristic curve; CSC, cause-specific Cox model; tLM, landmark time</p>
      </caption>
      <graphic xlink:href="dyad122f2" position="float"/>
    </fig>
    <p>Additionally, we compared the two models in our application example of SPLC (vs simulation). The predicted risk score was overestimated (1.5–5.3 times higher) in a standard Cox landmark vs CSC landmark (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S4</xref>, available as <xref rid="sup1" ref-type="supplementary-material">Supplementary data</xref> at <italic toggle="yes">IJE</italic> online), emphasizing the importance of correctly handling competing risks in dynamic prediction.</p>
  </sec>
  <sec sec-type="discussion">
    <title>Discussion</title>
    <p>In this study, we presented the R package <italic toggle="yes">dynamicLM</italic> that implements a flexible framework for building a dynamic landmark supermodel for competing risk data, covering the entire pipeline for data preparation, model development, prediction and evaluation. By providing researchers with practical tools and instructions on how and when to use this approach, <italic toggle="yes">dynamicLM</italic> holds great promise to improve individual risk predictions by using updated patient data.</p>
    <p>The proposed implementation can be applied in many clinical settings, such as predicting a cancer recurrence<xref rid="dyad122-B6" ref-type="bibr"><sup>6</sup></xref> (or a therapy response) using time-varying biomarkers (i.e. circulating tumour DNA)<xref rid="dyad122-B1" ref-type="bibr"><sup>1</sup></xref> in clinical trials or predicting second malignancies using updated patients’ treatment histories in electronic health records. Future research directions include incorporating regularization for feature selection in high-dimensional data and developing unified performance metrics summarized across landmarks to evaluate the predictive performance of the landmark model.</p>
  </sec>
  <sec>
    <title>Ethics approval</title>
    <p>Study participants provided informed consent in accordance with the Declaration of Helsinki and the study was approved by the institutional review boards of the University of Hawaii and the University of Southern California.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="sup1" position="float" content-type="local-data">
      <label>dyad122_Supplementary_Data</label>
      <media xlink:href="dyad122_supplementary_data.zip">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <sec sec-type="data-availability">
    <title>Data availability</title>
    <p>The data underlying this analysis were provided by the Multiethnic Cohort Study (MEC) under data use agreement. Researchers interested in the MEC data may submit an inquiry online: [<ext-link xlink:href="https://www.uhcancercenter.org/for-researchers/mec-data-sharing" ext-link-type="uri">https://www.uhcancercenter.org/for-researchers/mec-data-sharing</ext-link>].</p>
  </sec>
  <sec>
    <title>Supplementary data</title>
    <p><xref rid="sup1" ref-type="supplementary-material">Supplementary data</xref> are available at <italic toggle="yes">IJE</italic> online.</p>
  </sec>
  <sec>
    <title>Author contributions</title>
    <p>A.H.F., E.C. and S.S.H. conceptualized research; A.H.F. and E.C. contributed to data curation and formal analysis, and wrote original draft; S.S.H. supervised research; all authors participated in the reviewing and editing of the paper and validation process.</p>
  </sec>
  <sec>
    <title>Funding</title>
    <p>This study is supported by grants from the National Institutes of Health (4R37CA226081 and 1R01CA282793). This work was supported by the Stanford Cancer Institute, an NCI-designated comprehensive cancer centre.</p>
  </sec>
  <sec sec-type="COI-statement">
    <title>Conflict of interest</title>
    <p>H.A.W. reports grants from ACEA Biosciences, grants from Arrys Therapeutics, grants from BMS, grants from Celgene, grants from Clovis Oncology, grants from Exelixis, grants from Genetech/Roche, grants from Gilead, grants from Merck, grants from Novartis, grants from Pharmacyclics, grants from Sea Gen, grants from Xcovery, other from AstraZeneca, other from Xcovery, other from Janssen, other from Daiichi Sankyo, other from Blueprint, other from Mirati, other from Helsinn, other from Merch—not compensated, other from Genetech/Roche—not compensated, other from IASLC, other from ECOG-ACRIN, outside the submitted work. All remaining authors report no other disclosures.</p>
  </sec>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="dyad122-B1">
      <label>1</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kurtz</surname><given-names>DM</given-names></string-name>, <string-name><surname>Esfahani</surname><given-names>MS</given-names></string-name>, <string-name><surname>Scherer</surname><given-names>F</given-names></string-name></person-group><etal>et al</etal><article-title>Dynamic risk profiling using serial tumor biomarkers for personalized outcome prediction</article-title>. <source>Cell</source><year>2019</year>;<volume>178</volume>:<fpage>699</fpage>–<lpage>713.e619</lpage>.<pub-id pub-id-type="pmid">31280963</pub-id></mixed-citation>
    </ref>
    <ref id="dyad122-B2">
      <label>2</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Han</surname><given-names>SS</given-names></string-name>, <string-name><surname>Rivera</surname><given-names>GA</given-names></string-name>, <string-name><surname>Tammemägi</surname><given-names>MC</given-names></string-name></person-group><etal>et al</etal><article-title>Risk stratification for second primary lung cancer</article-title>. <source>J Clin Oncol</source><year>2017</year>;<volume>35</volume>:<fpage>2893</fpage>–<lpage>99</lpage>.<pub-id pub-id-type="pmid">28644772</pub-id></mixed-citation>
    </ref>
    <ref id="dyad122-B3">
      <label>3</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Barcenas</surname><given-names>CH</given-names></string-name>, <string-name><surname>Song</surname><given-names>J</given-names></string-name>, <string-name><surname>Murthy</surname><given-names>RK</given-names></string-name></person-group><etal>et al</etal><article-title>Prognostic model for De Novo and recurrent metastatic breast cancer</article-title>. <source>JCO Clin Cancer Inform</source><year>2021</year>;<volume>5</volume>:<fpage>789</fpage>–<lpage>804</lpage>.<pub-id pub-id-type="pmid">34351787</pub-id></mixed-citation>
    </ref>
    <ref id="dyad122-B4">
      <label>4</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>D'Journo</surname><given-names>XB</given-names></string-name>, <string-name><surname>Boulate</surname><given-names>D</given-names></string-name>, <string-name><surname>Fourdrain</surname><given-names>A</given-names></string-name></person-group><etal>et al</etal>; <collab>International Esodata Study Group</collab>. <article-title>Risk prediction model of 90-day mortality after esophagectomy for cancer</article-title>. <source>JAMA Surg</source><year>2021</year>;<volume>156</volume>:<fpage>836</fpage>–<lpage>45</lpage>.<pub-id pub-id-type="pmid">34160587</pub-id></mixed-citation>
    </ref>
    <ref id="dyad122-B5">
      <label>5</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Jones</surname><given-names>GD</given-names></string-name>, <string-name><surname>Brandt</surname><given-names>WS</given-names></string-name>, <string-name><surname>Shen</surname><given-names>R</given-names></string-name></person-group><etal>et al</etal><article-title>A genomic-pathologic annotated risk model to predict recurrence in early-stage lung adenocarcinoma</article-title>. <source>JAMA Surg</source><year>2021</year>;<volume>156</volume>:<fpage>e205601</fpage>.<pub-id pub-id-type="pmid">33355651</pub-id></mixed-citation>
    </ref>
    <ref id="dyad122-B6">
      <label>6</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Fontein</surname><given-names>DBY</given-names></string-name>, <string-name><surname>Klinten Grand</surname><given-names>M</given-names></string-name>, <string-name><surname>Nortier</surname><given-names>JWR</given-names></string-name></person-group><etal>et al</etal><article-title>Dynamic prediction in breast cancer: proving feasibility in clinical practice using the TEAM trial</article-title>. <source>Ann Oncol</source><year>2015</year>;<volume>26</volume>:<fpage>1254</fpage>–<lpage>62</lpage>.<pub-id pub-id-type="pmid">25862439</pub-id></mixed-citation>
    </ref>
    <ref id="dyad122-B7">
      <label>7</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Luo</surname><given-names>SJ</given-names></string-name>, <string-name><surname>Choi</surname><given-names>E</given-names></string-name>, <string-name><surname>Aredo</surname><given-names>JV</given-names></string-name></person-group><etal>et al</etal><article-title>Smoking cessation after lung cancer diagnosis and the risk of second primary lung cancer: the multiethnic cohort study</article-title>. <source>JNCI Cancer Spectr</source><year>2021</year>;<volume>5</volume>:pkab076.</mixed-citation>
    </ref>
    <ref id="dyad122-B8">
      <label>8</label>
      <mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>van Houwelingen</surname><given-names>H</given-names></string-name>, <string-name><surname>Putter</surname><given-names>H.</given-names></string-name></person-group><source>Dynamic Prediction in Clinical Survival Analysis</source>. Boca Laton, FL: <publisher-name>CRC Press</publisher-name>, <year>2011</year>.</mixed-citation>
    </ref>
    <ref id="dyad122-B9">
      <label>9</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Paige</surname><given-names>E</given-names></string-name>, <string-name><surname>Barrett</surname><given-names>J</given-names></string-name>, <string-name><surname>Stevens</surname><given-names>D</given-names></string-name></person-group><etal>et al</etal><article-title>Landmark models for optimizing the use of repeated measurements of risk factors in electronic health records to predict future disease risk</article-title>. <source>Am J Epidemiol</source><year>2018</year>;<volume>187</volume>:<fpage>1530</fpage>–<lpage>38</lpage>.<pub-id pub-id-type="pmid">29584812</pub-id></mixed-citation>
    </ref>
    <ref id="dyad122-B10">
      <label>10</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Yang</surname><given-names>Z</given-names></string-name>, <string-name><surname>Hou</surname><given-names>Y</given-names></string-name>, <string-name><surname>Lyu</surname><given-names>J</given-names></string-name>, <string-name><surname>Liu</surname><given-names>D</given-names></string-name>, <string-name><surname>Chen</surname><given-names>Z.</given-names></string-name></person-group><article-title>Dynamic prediction and prognostic analysis of patients with cervical cancer: a landmarking analysis approach</article-title>. <source>Ann Epidemiol</source><year>2020</year>;<volume>44</volume>:<fpage>45</fpage>–<lpage>51</lpage>.<pub-id pub-id-type="pmid">32220511</pub-id></mixed-citation>
    </ref>
    <ref id="dyad122-B11">
      <label>11</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Asar</surname><given-names>Ö</given-names></string-name>, <string-name><surname>Ritchie</surname><given-names>J</given-names></string-name>, <string-name><surname>Kalra</surname><given-names>PA</given-names></string-name>, <string-name><surname>Diggle</surname><given-names>PJ.</given-names></string-name></person-group><article-title>Joint modelling of repeated measurement and time-to-event data: an introductory tutorial</article-title>. <source>Int J Epidemiol</source><year>2015</year>;<volume>44</volume>:<fpage>334</fpage>–<lpage>44</lpage>.<pub-id pub-id-type="pmid">25604450</pub-id></mixed-citation>
    </ref>
    <ref id="dyad122-B12">
      <label>12</label>
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Rizopoulos</surname><given-names>D</given-names></string-name>, <string-name><surname>Papageorgiou</surname><given-names>G</given-names></string-name>, <string-name><surname>Miranda Afonso</surname><given-names>P.</given-names></string-name></person-group><italic toggle="yes">JMbayes2: Extended Joint Models for Longitudinal and Time-To-Event Data</italic>. R package version 0.2–4. <year>2022</year>. <ext-link xlink:href="https://cran.r-project.org/package=JMbayes2" ext-link-type="uri">https://cran.r-project.org/package=JMbayes2</ext-link> (30 September 2022, date last accessed).</mixed-citation>
    </ref>
    <ref id="dyad122-B13">
      <label>13</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Leroy</surname><given-names>T</given-names></string-name>, <string-name><surname>Monnet</surname><given-names>E</given-names></string-name>, <string-name><surname>Guerzider</surname><given-names>S</given-names></string-name></person-group><etal>et al</etal><article-title>Let us not underestimate the long-term risk of SPLC after surgical resection of NSCLC</article-title>. <source>Lung Cancer</source><year>2019</year>;<volume>137</volume>:<fpage>23</fpage>–<lpage>30</lpage>.<pub-id pub-id-type="pmid">31521979</pub-id></mixed-citation>
    </ref>
    <ref id="dyad122-B14">
      <label>14</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Nicolaie</surname><given-names>MA</given-names></string-name>, <string-name><surname>van Houwelingen</surname><given-names>JC</given-names></string-name>, <string-name><surname>de Witte</surname><given-names>TM</given-names></string-name>, <string-name><surname>Putter</surname><given-names>H.</given-names></string-name></person-group><article-title>Dynamic prediction by landmarking in competing risks</article-title>. <source>Stat Med</source><year>2013</year>;<volume>32</volume>:<fpage>2031</fpage>–<lpage>47</lpage>.<pub-id pub-id-type="pmid">23086627</pub-id></mixed-citation>
    </ref>
    <ref id="dyad122-B15">
      <label>15</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Varadhan</surname><given-names>R</given-names></string-name>, <string-name><surname>Weiss</surname><given-names>CO</given-names></string-name>, <string-name><surname>Segal</surname><given-names>JB</given-names></string-name></person-group><etal>et al</etal><article-title>Evaluating health outcomes in the presence of competing risks: a review of statistical methods and clinical applications</article-title>. <source>Med Care</source><year>2010</year>;<volume>48</volume>:<fpage>S96</fpage>–<lpage>105</lpage>.<pub-id pub-id-type="pmid">20473207</pub-id></mixed-citation>
    </ref>
    <ref id="dyad122-B16">
      <label>16</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Benichou</surname><given-names>J</given-names></string-name>, <string-name><surname>Gail</surname><given-names>MH.</given-names></string-name></person-group><article-title>Estimates of absolute cause-specific risk in cohort studies</article-title>. <source>Biometrics</source><year>1990</year>;<volume>46</volume>:<fpage>813</fpage>–<lpage>26</lpage>.<pub-id pub-id-type="pmid">2242416</pub-id></mixed-citation>
    </ref>
    <ref id="dyad122-B17">
      <label>17</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>He</surname><given-names>P</given-names></string-name>, <string-name><surname>Eriksson</surname><given-names>F</given-names></string-name>, <string-name><surname>Scheike</surname><given-names>TH</given-names></string-name>, <string-name><surname>Zhang</surname><given-names>MJ.</given-names></string-name></person-group><article-title>A proportional hazards regression model for the sub-distribution with covariates adjusted censoring weight for competing risks data</article-title>. <source>Scand Stat Theory Appl</source><year>2016</year>;<volume>43</volume>:<fpage>103</fpage>–<lpage>22</lpage>.<pub-id pub-id-type="pmid">27034534</pub-id></mixed-citation>
    </ref>
    <ref id="dyad122-B18">
      <label>18</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Cortese</surname><given-names>G</given-names></string-name>, <string-name><surname>Gerds</surname><given-names>TA</given-names></string-name>, <string-name><surname>Andersen</surname><given-names>PK.</given-names></string-name></person-group><article-title>Comparing predictions among competing risks models with time-dependent covariates</article-title>. <source>Stat Med</source><year>2013</year>;<volume>32</volume>:<fpage>3089</fpage>–<lpage>101</lpage>.<pub-id pub-id-type="pmid">23494745</pub-id></mixed-citation>
    </ref>
    <ref id="dyad122-B19">
      <label>19</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Choi</surname><given-names>E</given-names></string-name>, <string-name><surname>Sanyal</surname><given-names>N</given-names></string-name>, <string-name><surname>Ding</surname><given-names>VY</given-names></string-name></person-group><etal>et al</etal><article-title>Development and validation of a risk prediction model for second primary lung cancer</article-title>. <source>J Natl Cancer Inst</source><year>2022</year>;<volume>114</volume>:<fpage>87</fpage>–<lpage>96</lpage>.<pub-id pub-id-type="pmid">34255071</pub-id></mixed-citation>
    </ref>
    <ref id="dyad122-B20">
      <label>20</label>
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Gerds</surname><given-names>TA.</given-names></string-name></person-group><italic toggle="yes">prodlim: Product-Limit Estimation for Censored Event History Analysis</italic>. R package version 2019.11.13. <year>2019</year>. <ext-link xlink:href="https://CRAN.R-project.org/package=prodlim" ext-link-type="uri">https://CRAN.R-project.org/package=prodlim</ext-link> (30 September 2022, date last accessed).</mixed-citation>
    </ref>
    <ref id="dyad122-B21">
      <label>21</label>
      <mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Gerds</surname><given-names>TA</given-names></string-name>, <string-name><surname>Kattan</surname><given-names>MW.</given-names></string-name></person-group><source>Medical Risk Prediction Models: With Ties to Machine Learning</source>. Boca Laton, FL: <publisher-name>CRC Press</publisher-name>, <year>2021</year>.</mixed-citation>
    </ref>
    <ref id="dyad122-B22">
      <label>22</label>
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Therneau</surname><given-names>T.</given-names></string-name></person-group><italic toggle="yes">A Package for Survival Analysis in R</italic>. R package version 3.2–13. <year>2021</year>. <ext-link xlink:href="https://CRAN.R-project.org/package=survival" ext-link-type="uri">https://CRAN.R-project.org/package=survival</ext-link> (30 September 2022, date last accessed).</mixed-citation>
    </ref>
    <ref id="dyad122-B23">
      <label>23</label>
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Putter</surname><given-names>H.</given-names></string-name></person-group><italic toggle="yes">dynpred: Companion Package to “Dynamic Prediction in Clinical Survival Analysis”.</italic> R package version 0.1.2. <year>2015</year>. <ext-link xlink:href="https://CRAN.R-project.org/package=dynpred" ext-link-type="uri">https://CRAN.R-project.org/package=dynpred</ext-link> (30 September 2022, date last accessed).</mixed-citation>
    </ref>
    <ref id="dyad122-B24">
      <label>24</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Choi</surname><given-names>E</given-names></string-name>, <string-name><surname>Lam</surname><given-names>VT</given-names></string-name>, <string-name><surname>Aredo</surname><given-names>JA</given-names></string-name></person-group><etal>et al</etal><article-title>Abstract 3445: Long term effect of radiotherapy on risk of second primary lung cancer and overall mortality among lung cancer patients</article-title>. <source>Cancer Res</source><year>2022</year>;<volume>82</volume>:<fpage>3445</fpage>.</mixed-citation>
    </ref>
    <ref id="dyad122-B25">
      <label>25</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Li</surname><given-names>S</given-names></string-name>, <string-name><surname>Li</surname><given-names>N</given-names></string-name>, <string-name><surname>Wang</surname><given-names>H</given-names></string-name></person-group><etal>et al</etal><article-title>Efficient algorithms and implementation of a semiparametric joint model for longitudinal and competing risk data: with applications to massive biobank data</article-title>. <source>Comput Math Methods Med</source><year>2022</year>;<volume>2022</volume>:<fpage>1362913</fpage>.<pub-id pub-id-type="pmid">35178111</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
