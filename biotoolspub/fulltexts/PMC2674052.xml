<?DTDIdentifier.IdentifierValue article.dtd?>
<?DTDIdentifier.IdentifierType system?>
<?SourceDTD.DTDName article.dtd?>
<?SourceDTD.Version v40?>
<?ConverterInfo.XSLTName bmc2nlm.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-title>BMC Bioinformatics</journal-title>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">2674052</article-id>
    <article-id pub-id-type="publisher-id">1471-2105-10-10</article-id>
    <article-id pub-id-type="pmid">19133123</article-id>
    <article-id pub-id-type="doi">10.1186/1471-2105-10-10</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Bayesian DNA copy number analysis</article-title>
    </title-group>
    <contrib-group>
      <contrib id="A1" corresp="yes" contrib-type="author">
        <name>
          <surname>Rancoita</surname>
          <given-names>Paola MV</given-names>
        </name>
        <xref ref-type="aff" rid="I1">1</xref>
        <xref ref-type="aff" rid="I2">2</xref>
        <xref ref-type="aff" rid="I3">3</xref>
        <email>paola@idsia.ch</email>
      </contrib>
      <contrib id="A2" contrib-type="author">
        <name>
          <surname>Hutter</surname>
          <given-names>Marcus</given-names>
        </name>
        <xref ref-type="aff" rid="I4">4</xref>
        <email>marcus.hutter@anu.edu.au</email>
      </contrib>
      <contrib id="A3" contrib-type="author">
        <name>
          <surname>Bertoni</surname>
          <given-names>Francesco</given-names>
        </name>
        <xref ref-type="aff" rid="I2">2</xref>
        <email>frbertoni@mac.com</email>
      </contrib>
      <contrib id="A4" contrib-type="author">
        <name>
          <surname>Kwee</surname>
          <given-names>Ivo</given-names>
        </name>
        <xref ref-type="aff" rid="I1">1</xref>
        <xref ref-type="aff" rid="I2">2</xref>
        <email>ivo@idsia.ch</email>
      </contrib>
    </contrib-group>
    <aff id="I1"><label>1</label>Istituto Dalle Molle di Studi sull'Intelligenza Artificiale (IDSIA), Galleria 2, 6928 Manno-Lugano, Switzerland</aff>
    <aff id="I2"><label>2</label>Laboratory of Experimental Oncology, Oncology Institute of Southern Switzerland (IOSI), via Vela 6, 6500 Bellinzona, Switzerland</aff>
    <aff id="I3"><label>3</label>Dipartimento di Matematica, Università degli Studi di Milano, via Saldini 50, 20137 Milano, Italy</aff>
    <aff id="I4"><label>4</label>RSISE, ANU and SML, NICTA, Canberra, ACT, 0200, Australia</aff>
    <pub-date pub-type="collection">
      <year>2009</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>8</day>
      <month>1</month>
      <year>2009</year>
    </pub-date>
    <volume>10</volume>
    <fpage>10</fpage>
    <lpage>10</lpage>
    <ext-link ext-link-type="uri" xlink:href="http://www.biomedcentral.com/1471-2105/10/10"/>
    <history>
      <date date-type="received">
        <day>19</day>
        <month>5</month>
        <year>2008</year>
      </date>
      <date date-type="accepted">
        <day>8</day>
        <month>1</month>
        <year>2009</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>Copyright © 2009 Rancoita et al; licensee BioMed Central Ltd.</copyright-statement>
      <copyright-year>2009</copyright-year>
      <copyright-holder>Rancoita et al; licensee BioMed Central Ltd.</copyright-holder>
      <license license-type="open-access" xlink:href="http://creativecommons.org/licenses/by/2.0">
        <p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/2.0"/>), which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly cited.</p>
        <!--<rdf xmlns="http://web.resource.org/cc/" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:dc="http://purl.org/dc/elements/1.1" xmlns:dcterms="http://purl.org/dc/terms"><Work xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:dcterms="http://purl.org/dc/terms/" rdf:about=""><license rdf:resource="http://creativecommons.org/licenses/by/2.0"/><dc:type rdf:resource="http://purl.org/dc/dcmitype/Text"/><dc:author>
               Rancoita
               MV
               Paola
               
               
               
               paola@idsia.ch
            </dc:author><dc:title>
            Bayesian DNA copy number analysis
         </dc:title><dc:date>2009</dc:date><dcterms:bibliographicCitation>BMC Bioinformatics 10(1): 10-. (2009)</dcterms:bibliographicCitation><dc:identifier type="sici">1471-2105(2009)10:1&#x0003c;10&#x0003e;</dc:identifier><dcterms:isPartOf>urn:ISSN:1471-2105</dcterms:isPartOf><License rdf:about="http://creativecommons.org/licenses/by/2.0"><permits rdf:resource="http://web.resource.org/cc/Reproduction" xmlns=""/><permits rdf:resource="http://web.resource.org/cc/Distribution" xmlns=""/><requires rdf:resource="http://web.resource.org/cc/Notice" xmlns=""/><requires rdf:resource="http://web.resource.org/cc/Attribution" xmlns=""/><permits rdf:resource="http://web.resource.org/cc/DerivativeWorks" xmlns=""/></License></Work></rdf>-->
      </license>
    </permissions>
    <abstract>
      <sec>
        <title>Background</title>
        <p>Some diseases, like tumors, can be related to chromosomal aberrations, leading to changes of DNA copy number. The copy number of an aberrant genome can be represented as a piecewise constant function, since it can exhibit regions of deletions or gains. Instead, in a healthy cell the copy number is two because we inherit one copy of each chromosome from each our parents.</p>
        <p>Bayesian Piecewise Constant Regression (BPCR) is a Bayesian regression method for data that are noisy observations of a piecewise constant function. The method estimates the unknown segment number, the endpoints of the segments and the value of the segment levels of the underlying piecewise constant function. The Bayesian Regression Curve (BRC) estimates the same data with a smoothing curve. However, in the original formulation, some estimators failed to properly determine the corresponding parameters. For example, the boundary estimator did not take into account the dependency among the boundaries and succeeded in estimating more than one breakpoint at the same position, losing segments.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p>We derived an improved version of the BPCR (called mBPCR) and BRC, changing the segment number estimator and the boundary estimator to enhance the fitting procedure. We also proposed an alternative estimator of the variance of the segment levels, which is useful in case of data with high noise. Using artificial data, we compared the original and the modified version of BPCR and BRC with other regression methods, showing that our improved version of BPCR generally outperformed all the others. Similar results were also observed on real data.</p>
      </sec>
      <sec>
        <title>Conclusion</title>
        <p>We propose an improved method for DNA copy number estimation, mBPCR, which performed very well compared to previously published algorithms. In particular, mBPCR was more powerful in the detection of the true position of the breakpoints and of small aberrations in very noisy data. Hence, from a biological point of view, our method can be very useful, for example, to find targets of genomic aberrations in clinical cancer samples.</p>
      </sec>
    </abstract>
  </article-meta>
</front>
<body>
  <sec>
    <title>Background</title>
    <p>Lesions at DNA level represent the cause of cancer and of many congenital or hereditary disorders. The change of the number of copies of DNA in a genomic region is one of the most common aberrations. In normal cells each genomic segment is present in two copies, but, for example, in tumor cells the genome can present regions of deletions (copy number one or zero), gains (copy number three or four) or amplifications (copy number greater than four). Thus, in general, the DNA copy number along the genome can be represented as a piecewise constant function.</p>
    <p>With microarray technology it is possible to simultaneously measure the copy number along the genome at hundred thousands of positions (see for example [<xref ref-type="bibr" rid="B1">1</xref>]). However, raw copy number data are generally very noisy. Hence, it is important to define a method which allows one to estimate the number of regions with different copy number, the endpoints of these regions (called <italic>breakpoints</italic>) and their copy number. Several methods have been developed to solve this issue. Many methods consider the log<sub>2 </sub>ratio of the data (the ratio is computed with respect to a normal reference sample) and model it as a normal random variable, since they assume that the errors are normally distributed. We can roughly subdivide all of these methods into two classes: those ones that estimate the copy numbers as a piecewise constant function and the others that estimate the copy numbers as a continuous curve. The methods belonging to the latter group are called smoothing methods.</p>
    <p>Among the methods belonging to the first class, we can find the following. The Circular Binary Segmentation (CBS) approach is a recursive method in which the breakpoints are determined on the basis of a test of hypothesis, with null hypothesis that in the interval considered there is no change in copy number [<xref ref-type="bibr" rid="B2">2</xref>]. Picard et al. [<xref ref-type="bibr" rid="B3">3</xref>] used a piecewise constant regression model, where the parameters are estimated maximizing a penalized likelihood (i.e. the likelihood with the addition of a penalty function). This method is usually denoted with the abbreviation CGHseg. The GLAD method is another piecewise constant regression method, but in this case the parameters are estimated maximizing a weighted likelihood [<xref ref-type="bibr" rid="B4">4</xref>]. Fridlyand et al. [<xref ref-type="bibr" rid="B5">5</xref>] applied Hidden Markov Models (HMM), while Marioni et al. [<xref ref-type="bibr" rid="B6">6</xref>] defined an HMM method which takes into account the distance among the data points (BioHMM). Recently, Nilsson et al [<xref ref-type="bibr" rid="B7">7</xref>] derived a segmentation method based on total variation minimization, called Rendersome. It is optimized for gene expression data, but the authors affirm that it can be used also on copy number data.</p>
    <p>Among the smoothing methods, Hsu et al. [<xref ref-type="bibr" rid="B8">8</xref>] used a wavelet regression method with Haar wavelet. Eilers and de Menez [<xref ref-type="bibr" rid="B9">9</xref>] applied a quantile smoothing regression (quantreg), with the solution found by minimizing a loss function based on the <italic>L</italic><sub>1 </sub>norm, to obtain a flatter curve. Huang et al. [<xref ref-type="bibr" rid="B10">10</xref>] proposed smoothseg, i.e. a smooth segmentation method based on a doubly heavy-tailed random-effect model.</p>
    <p>We propose a piecewise constant regression method, using Bayesian statistics, which appears appropriate when regions contain only few data points. The original version of the method (called Bayesian Piecewise Constant Regression, BPCR) was presented by Hutter [<xref ref-type="bibr" rid="B11">11</xref>,<xref ref-type="bibr" rid="B12">12</xref>]. In this paper we propose improved Bayesian estimators of the parameters involved and we apply the model to DNA copy number estimation. Finally, we compare our algorithm with some among the most cited or more recent methods, on artificial and real data.</p>
    <p>Our method was implemented in R and is freely available at <ext-link ext-link-type="uri" xlink:href="http://www.idsia.ch/~paola/mBPCR/"/> or in Additional file <xref ref-type="supplementary-material" rid="S1">1</xref>. Furthermore, an R package will be soon available.</p>
  </sec>
  <sec sec-type="methods">
    <title>Methods</title>
    <p>In the first two subsections, we briefly describe the original Bayesian Piecewise Constant Regression method, explaining the hypothesis of the model and the estimation of its parameters with Bayesian regression. We emphasize the definitions of the original parameter estimators in order to show how we changed some of these estimators in the other subsections.</p>
    <p>A brief explanation of the dynamic program for the computation of the estimators can be found in the Additional file <xref ref-type="supplementary-material" rid="S2">2</xref> (more details can be found in [<xref ref-type="bibr" rid="B11">11</xref>,<xref ref-type="bibr" rid="B12">12</xref>]).</p>
    <p>Regarding notations, we do not indicate explicitly the random variable to which a distribution is referred, if it is clear from the context. For example, <italic>p</italic><sub><italic>K</italic></sub>(<italic>k</italic>) ≡ <italic>p</italic>(<italic>k</italic>) or <italic>f</italic><sub><italic><bold>Y</bold></italic>, <bold>M</bold></sub>(<bold><italic>y</italic></bold>, <bold><italic>μ</italic></bold>) ≡ <italic>f</italic>(<bold><italic>y</italic></bold>, <bold><italic>μ</italic></bold>).</p>
    <sec>
      <title>Hypotheses of the model</title>
      <p>Let <bold><italic>Y </italic></bold>∊ ℝ<sup><italic>n </italic></sup>be a random vector, such that each component (called <italic>data point </italic>or, if <bold><italic>Y </italic></bold>represents a quantity measured on part of the genome, <italic>probe</italic>) is conditionally normally distributed:</p>
      <p>
        <disp-formula>
          <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M1" name="1471-2105-10-10-i1" overflow="scroll">
            <mml:semantics>
              <mml:mrow>
                <mml:msub>
                  <mml:mi>Y</mml:mi>
                  <mml:mi>i</mml:mi>
                </mml:msub>
                <mml:msub>
                  <mml:mo>|</mml:mo>
                  <mml:mrow>
                    <mml:msubsup>
                      <mml:mover accent="true">
                        <mml:mi>μ</mml:mi>
                        <mml:mo>˜</mml:mo>
                      </mml:mover>
                      <mml:mi>i</mml:mi>
                      <mml:mn>0</mml:mn>
                    </mml:msubsup>
                    <mml:mo>,</mml:mo>
                    <mml:msup>
                      <mml:mi>σ</mml:mi>
                      <mml:mn>2</mml:mn>
                    </mml:msup>
                  </mml:mrow>
                </mml:msub>
                <mml:mo>~</mml:mo>
                <mml:mi mathvariant="script">N</mml:mi>
                <mml:mo stretchy="false">(</mml:mo>
                <mml:msubsup>
                  <mml:mover accent="true">
                    <mml:mi>μ</mml:mi>
                    <mml:mo>˜</mml:mo>
                  </mml:mover>
                  <mml:mi>i</mml:mi>
                  <mml:mn>0</mml:mn>
                </mml:msubsup>
                <mml:mo>,</mml:mo>
                <mml:msup>
                  <mml:mi>σ</mml:mi>
                  <mml:mn>2</mml:mn>
                </mml:msup>
                <mml:mo stretchy="false">)</mml:mo>
                <mml:mo>.</mml:mo>
              </mml:mrow>
            </mml:semantics>
          </mml:math>
        </disp-formula>
      </p>
      <p>Suppose also that <bold><italic>Y </italic></bold>represents a noisy observation of a piecewise constant function, which consists of <italic>k</italic><sub>0 </sub>horizontal segments. Then, the segment level at a generic position <italic>i </italic>(<inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M2" name="1471-2105-10-10-i2" overflow="scroll"><mml:semantics><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>μ</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mi>i</mml:mi><mml:mn>0</mml:mn></mml:msubsup></mml:mrow></mml:semantics></mml:math></inline-formula>) does not assume different values for each <italic>i</italic>, but the data are divided into <italic>k</italic><sub>0 </sub>intervals (with boundaries <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M3" name="1471-2105-10-10-i3" overflow="scroll"><mml:semantics><mml:mrow><mml:mn>0</mml:mn><mml:mo>=</mml:mo><mml:msubsup><mml:mi>t</mml:mi><mml:mn>0</mml:mn><mml:mn>0</mml:mn></mml:msubsup><mml:mo>&lt;</mml:mo><mml:msubsup><mml:mi>t</mml:mi><mml:mn>1</mml:mn><mml:mn>0</mml:mn></mml:msubsup><mml:mo>&lt;</mml:mo><mml:mo>⋯</mml:mo><mml:mo>&lt;</mml:mo><mml:msubsup><mml:mi>t</mml:mi><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mn>0</mml:mn></mml:msubsup><mml:mo>&lt;</mml:mo><mml:msubsup><mml:mi>t</mml:mi><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mn>0</mml:mn></mml:msubsup><mml:mo>=</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:semantics></mml:math></inline-formula>) where <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M4" name="1471-2105-10-10-i4" overflow="scroll"><mml:semantics><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>μ</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>q</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mn>0</mml:mn></mml:msubsup><mml:mo>=</mml:mo><mml:mn>...</mml:mn><mml:mo>=</mml:mo><mml:msubsup><mml:mover accent="true"><mml:mi>μ</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mi>q</mml:mi></mml:msub></mml:mrow><mml:mn>0</mml:mn></mml:msubsup><mml:mo>=</mml:mo><mml:mo>:</mml:mo><mml:msubsup><mml:mi>μ</mml:mi><mml:mi>q</mml:mi><mml:mn>0</mml:mn></mml:msubsup></mml:mrow></mml:semantics></mml:math></inline-formula> for each q = 1,...,<italic>k</italic><sub>0</sub>. Hence, <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M5" name="1471-2105-10-10-i5" overflow="scroll"><mml:semantics><mml:mrow><mml:msubsup><mml:mi>μ</mml:mi><mml:mi>q</mml:mi><mml:mn>0</mml:mn></mml:msubsup></mml:mrow></mml:semantics></mml:math></inline-formula> represents the level of the <italic>q</italic><sup><italic>th </italic></sup>segment. Our goal is to estimate the levels <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M6" name="1471-2105-10-10-i6" overflow="scroll"><mml:semantics><mml:mrow><mml:msup><mml:mi>μ</mml:mi><mml:mn>0</mml:mn></mml:msup><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>μ</mml:mi><mml:mn>1</mml:mn><mml:mn>0</mml:mn></mml:msubsup><mml:mo>,</mml:mo><mml:mn>...</mml:mn><mml:mo>,</mml:mo><mml:msubsup><mml:mi>μ</mml:mi><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mn>0</mml:mn></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:semantics></mml:math></inline-formula> of all the segments. In order to do that, we first need to estimate the number of the segments <italic>k</italic><sub>0 </sub>and the partition of the data <bold><italic>t</italic></bold><sup>0</sup>. From a Bayesian point of view, <bold>μ</bold><sup>0</sup>, <bold>t</bold><sup>0 </sup>and <italic>k</italic><sub>0 </sub>are treated as random variables, hence we denote them with the corresponding upper case letters (<bold>M</bold>, <bold><italic>T </italic></bold>and <italic>K</italic>). Moreover, because of their randomness, we need to define a prior distribution for each of them to complete the model.</p>
      <p>For the number of segments and the boundaries, we assume noninformative prior distributions:</p>
      <p>
        <disp-formula id="bmcM1">
          <label>(1)</label>
          <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M7" name="1471-2105-10-10-i7" overflow="scroll">
            <mml:semantics>
              <mml:mrow>
                <mml:mtable>
                  <mml:mtr>
                    <mml:mtd>
                      <mml:mrow>
                        <mml:mi>p</mml:mi>
                        <mml:mo stretchy="false">(</mml:mo>
                        <mml:mi>k</mml:mi>
                        <mml:mo stretchy="false">)</mml:mo>
                        <mml:mo>=</mml:mo>
                        <mml:mfrac>
                          <mml:mn>1</mml:mn>
                          <mml:mrow>
                            <mml:msub>
                              <mml:mi>k</mml:mi>
                              <mml:mrow>
                                <mml:mi>max</mml:mi>
                                <mml:mo>⁡</mml:mo>
                              </mml:mrow>
                            </mml:msub>
                          </mml:mrow>
                        </mml:mfrac>
                      </mml:mrow>
                    </mml:mtd>
                    <mml:mtd>
                      <mml:mrow>
                        <mml:mi>k</mml:mi>
                        <mml:mo>∈</mml:mo>
                        <mml:mi mathvariant="double-struck">K</mml:mi>
                      </mml:mrow>
                    </mml:mtd>
                  </mml:mtr>
                </mml:mtable>
              </mml:mrow>
            </mml:semantics>
          </mml:math>
        </disp-formula>
      </p>
      <p>
        <disp-formula id="bmcM2">
          <label>(2)</label>
          <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M8" name="1471-2105-10-10-i8" overflow="scroll">
            <mml:semantics>
              <mml:mrow>
                <mml:mtable>
                  <mml:mtr>
                    <mml:mtd>
                      <mml:mrow>
                        <mml:mi>p</mml:mi>
                        <mml:mo stretchy="false">(</mml:mo>
                        <mml:mi mathvariant="bold-italic">t</mml:mi>
                        <mml:mo stretchy="false">|</mml:mo>
                        <mml:mi>k</mml:mi>
                        <mml:mo stretchy="false">)</mml:mo>
                        <mml:mo>=</mml:mo>
                        <mml:mfrac>
                          <mml:mn>1</mml:mn>
                          <mml:mrow>
                            <mml:mrow>
                              <mml:mo>(</mml:mo>
                              <mml:mrow>
                                <mml:mtable>
                                  <mml:mtr>
                                    <mml:mtd>
                                      <mml:mrow>
                                        <mml:mi>n</mml:mi>
                                        <mml:mo>−</mml:mo>
                                        <mml:mn>1</mml:mn>
                                      </mml:mrow>
                                    </mml:mtd>
                                  </mml:mtr>
                                  <mml:mtr>
                                    <mml:mtd>
                                      <mml:mrow>
                                        <mml:mi>k</mml:mi>
                                        <mml:mo>−</mml:mo>
                                        <mml:mn>1</mml:mn>
                                      </mml:mrow>
                                    </mml:mtd>
                                  </mml:mtr>
                                </mml:mtable>
                              </mml:mrow>
                              <mml:mo>)</mml:mo>
                            </mml:mrow>
                          </mml:mrow>
                        </mml:mfrac>
                      </mml:mrow>
                    </mml:mtd>
                    <mml:mtd>
                      <mml:mrow>
                        <mml:mi mathvariant="bold-italic">t</mml:mi>
                        <mml:mo>∈</mml:mo>
                        <mml:msub>
                          <mml:mi mathvariant="double-struck">T</mml:mi>
                          <mml:mrow>
                            <mml:mi>k</mml:mi>
                            <mml:mo>,</mml:mo>
                            <mml:mi>n</mml:mi>
                          </mml:mrow>
                        </mml:msub>
                        <mml:mo>,</mml:mo>
                      </mml:mrow>
                    </mml:mtd>
                  </mml:mtr>
                </mml:mtable>
              </mml:mrow>
            </mml:semantics>
          </mml:math>
        </disp-formula>
      </p>
      <p>where <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M9" name="1471-2105-10-10-i9" overflow="scroll"><mml:semantics><mml:mi mathvariant="double-struck">K</mml:mi></mml:semantics></mml:math></inline-formula> = {1,...,<italic>k</italic><sub>max</sub>} and <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M10" name="1471-2105-10-10-i10" overflow="scroll"><mml:semantics><mml:mrow><mml:msub><mml:mi mathvariant="double-struck">T</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:semantics></mml:math></inline-formula> is the subspace of <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M11" name="1471-2105-10-10-i11" overflow="scroll"><mml:semantics><mml:mrow><mml:msubsup><mml:mi>ℕ</mml:mi><mml:mn>0</mml:mn><mml:mrow><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:semantics></mml:math></inline-formula> such that <italic>t</italic><sub>0 </sub>= 0, <italic>t</italic><sub><italic>k </italic></sub>= <italic>n </italic>and <italic>t</italic><sub><italic>q </italic></sub>∊ {1,...,<italic>n </italic>- 1} for all <italic>q </italic>= 1,...,<italic>k </italic>- 1, in an ordered way and without repetitions.</p>
      <p>About <bold>M</bold>, we assume that all its components are mutually independent and identically normally distributed,</p>
      <p>
        <disp-formula>
          <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M12" name="1471-2105-10-10-i12" overflow="scroll">
            <mml:semantics>
              <mml:mrow>
                <mml:mstyle mathvariant="bold" mathsize="normal">
                  <mml:mi>M</mml:mi>
                </mml:mstyle>
                <mml:msub>
                  <mml:mo>|</mml:mo>
                  <mml:mrow>
                    <mml:mi>ν</mml:mi>
                    <mml:mo>,</mml:mo>
                    <mml:msup>
                      <mml:mi>ρ</mml:mi>
                      <mml:mn>2</mml:mn>
                    </mml:msup>
                    <mml:mo>,</mml:mo>
                    <mml:mi>K</mml:mi>
                    <mml:mo>=</mml:mo>
                    <mml:mi>k</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:mo>~</mml:mo>
                <mml:mi mathvariant="script">N</mml:mi>
                <mml:mo stretchy="false">(</mml:mo>
                <mml:mi mathvariant="bold-italic">ν</mml:mi>
                <mml:mo>,</mml:mo>
                <mml:msup>
                  <mml:mi>ρ</mml:mi>
                  <mml:mn>2</mml:mn>
                </mml:msup>
                <mml:mi mathvariant="double-struck">I</mml:mi>
                <mml:mo stretchy="false">)</mml:mo>
                <mml:mo>,</mml:mo>
              </mml:mrow>
            </mml:semantics>
          </mml:math>
        </disp-formula>
      </p>
      <p>where <bold><italic>ν </italic></bold>∊ ℝ<sup><italic>k</italic></sup>, such that <italic>ν</italic><sub><italic>q </italic></sub>= <italic>ν </italic>for each <italic>q </italic>= 1,...,<italic>k</italic>, and <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M13" name="1471-2105-10-10-i13" overflow="scroll"><mml:semantics><mml:mi mathvariant="double-struck">I</mml:mi></mml:semantics></mml:math></inline-formula> ∊ ℝ<sup><italic>k </italic>× <italic>k</italic></sup>, such that <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M14" name="1471-2105-10-10-i13" overflow="scroll"><mml:semantics><mml:mi mathvariant="double-struck">I</mml:mi></mml:semantics></mml:math></inline-formula><sub><italic>p</italic>, <italic>q </italic></sub>= <italic>δ</italic><sub><italic>p</italic>,<italic>q </italic></sub>for each <italic>p</italic>, <italic>q </italic>= 1,...,<italic>k</italic>.</p>
      <p>Instead of these assumptions, we could assume a Cauchy distribution for each <italic>Y</italic><sub><italic>i </italic></sub>or M<sub><italic>q </italic></sub>in order to model an observation whose noise has heavier tails, as previously done by Hutter [<xref ref-type="bibr" rid="B11">11</xref>,<xref ref-type="bibr" rid="B12">12</xref>].</p>
    </sec>
    <sec>
      <title>Original estimation: the BPCR method</title>
      <p>The statistical procedure consists in a sequence of estimations due to the relationship among the parameters.</p>
      <p>BPCR estimates the number of segments with the MAP (Maximum A Posteriori) estimate given the sample point <bold><italic>y</italic></bold>,</p>
      <p>
        <disp-formula id="bmcM3">
          <label>(3)</label>
          <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M15" name="1471-2105-10-10-i14" overflow="scroll">
            <mml:semantics>
              <mml:mrow>
                <mml:mover accent="true">
                  <mml:mi>k</mml:mi>
                  <mml:mo>^</mml:mo>
                </mml:mover>
                <mml:mo>:</mml:mo>
                <mml:mo>=</mml:mo>
                <mml:munder>
                  <mml:mrow>
                    <mml:mi>arg</mml:mi>
                    <mml:mo>⁡</mml:mo>
                    <mml:mi>max</mml:mi>
                    <mml:mo>⁡</mml:mo>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>k</mml:mi>
                    <mml:mo>∈</mml:mo>
                    <mml:mi mathvariant="double-struck">K</mml:mi>
                  </mml:mrow>
                </mml:munder>
                <mml:mi>p</mml:mi>
                <mml:mo stretchy="false">(</mml:mo>
                <mml:mi>k</mml:mi>
                <mml:mo stretchy="false">|</mml:mo>
                <mml:mi mathvariant="bold-italic">y</mml:mi>
                <mml:mo stretchy="false">)</mml:mo>
                <mml:mo>,</mml:mo>
              </mml:mrow>
            </mml:semantics>
          </mml:math>
        </disp-formula>
      </p>
      <p>and, given <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M16" name="1471-2105-10-10-i15" overflow="scroll"><mml:semantics><mml:mover accent="true"><mml:mi>k</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:semantics></mml:math></inline-formula>, also each boundary is estimated separately with its corresponding MAP estimate,</p>
      <p>
        <disp-formula id="bmcM4">
          <label>(4)</label>
          <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M17" name="1471-2105-10-10-i16" overflow="scroll">
            <mml:semantics>
              <mml:mrow>
                <mml:msub>
                  <mml:mover accent="true">
                    <mml:mi>t</mml:mi>
                    <mml:mo>^</mml:mo>
                  </mml:mover>
                  <mml:mi>p</mml:mi>
                </mml:msub>
                <mml:mo>:</mml:mo>
                <mml:mo>=</mml:mo>
                <mml:munder>
                  <mml:mrow>
                    <mml:mi>arg</mml:mi>
                    <mml:mo>⁡</mml:mo>
                    <mml:mi>max</mml:mi>
                    <mml:mo>⁡</mml:mo>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>h</mml:mi>
                    <mml:mo>∈</mml:mo>
                    <mml:mo>{</mml:mo>
                    <mml:mi>p</mml:mi>
                    <mml:mo>,</mml:mo>
                    <mml:mn>...</mml:mn>
                    <mml:mo>,</mml:mo>
                    <mml:mi>n</mml:mi>
                    <mml:mo>−</mml:mo>
                    <mml:mo stretchy="false">(</mml:mo>
                    <mml:mover accent="true">
                      <mml:mi>k</mml:mi>
                      <mml:mo>^</mml:mo>
                    </mml:mover>
                    <mml:mo>−</mml:mo>
                    <mml:mi>p</mml:mi>
                    <mml:mo stretchy="false">)</mml:mo>
                    <mml:mo>}</mml:mo>
                  </mml:mrow>
                </mml:munder>
                <mml:mtext>P</mml:mtext>
                <mml:mo stretchy="false">(</mml:mo>
                <mml:msub>
                  <mml:mi>T</mml:mi>
                  <mml:mi>p</mml:mi>
                </mml:msub>
                <mml:mo>=</mml:mo>
                <mml:mi>h</mml:mi>
                <mml:mo stretchy="false">|</mml:mo>
                <mml:mi mathvariant="bold-italic">y</mml:mi>
                <mml:mo>,</mml:mo>
                <mml:mover accent="true">
                  <mml:mi>k</mml:mi>
                  <mml:mo>^</mml:mo>
                </mml:mover>
                <mml:mo stretchy="false">)</mml:mo>
              </mml:mrow>
            </mml:semantics>
          </mml:math>
        </disp-formula>
      </p>
      <p>for all <italic>p </italic>= 1,...,<inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M18" name="1471-2105-10-10-i15" overflow="scroll"><mml:semantics><mml:mover accent="true"><mml:mi>k</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:semantics></mml:math></inline-formula> - 1. Finally, the <italic>r</italic><sup><italic>th </italic></sup>moment of the level of the <italic>m</italic><sup><italic>th </italic></sup>segment is estimated with its posterior mean. Since its computation needs the knowledge of the number of segments and the partition of the data, we replace them with the estimated ones,</p>
      <p>
        <disp-formula id="bmcM5">
          <label>(5)</label>
          <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M19" name="1471-2105-10-10-i17" overflow="scroll">
            <mml:semantics>
              <mml:mrow>
                <mml:msubsup>
                  <mml:mover accent="true">
                    <mml:mi>μ</mml:mi>
                    <mml:mo>^</mml:mo>
                  </mml:mover>
                  <mml:mi>m</mml:mi>
                  <mml:mi>r</mml:mi>
                </mml:msubsup>
                <mml:mo>:</mml:mo>
                <mml:mo>=</mml:mo>
                <mml:mi>E</mml:mi>
                <mml:mo stretchy="false">[</mml:mo>
                <mml:msubsup>
                  <mml:mtext>M</mml:mtext>
                  <mml:mi>m</mml:mi>
                  <mml:mi>r</mml:mi>
                </mml:msubsup>
                <mml:mo stretchy="false">|</mml:mo>
                <mml:mi mathvariant="bold-italic">y</mml:mi>
                <mml:mo>,</mml:mo>
                <mml:mover accent="true">
                  <mml:mi mathvariant="bold-italic">t</mml:mi>
                  <mml:mo>^</mml:mo>
                </mml:mover>
                <mml:mo>,</mml:mo>
                <mml:mover accent="true">
                  <mml:mi>k</mml:mi>
                  <mml:mo>^</mml:mo>
                </mml:mover>
                <mml:mo stretchy="false">]</mml:mo>
              </mml:mrow>
            </mml:semantics>
          </mml:math>
        </disp-formula>
      </p>
      <p>for all <italic>m </italic>= 1,...,<inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M20" name="1471-2105-10-10-i15" overflow="scroll"><mml:semantics><mml:mover accent="true"><mml:mi>k</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:semantics></mml:math></inline-formula>. When <italic>r </italic>= 1 and we assume that <bold><italic>Y </italic></bold>and <bold>M </bold>are normally distributed, the estimate turns out to be</p>
      <p>
        <disp-formula id="bmcM6">
          <label>(6)</label>
          <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M21" name="1471-2105-10-10-i18" overflow="scroll">
            <mml:semantics>
              <mml:mrow>
                <mml:msub>
                  <mml:mover accent="true">
                    <mml:mi>μ</mml:mi>
                    <mml:mo>^</mml:mo>
                  </mml:mover>
                  <mml:mi>m</mml:mi>
                </mml:msub>
                <mml:mo>=</mml:mo>
                <mml:mfrac>
                  <mml:mrow>
                    <mml:msup>
                      <mml:mi>ρ</mml:mi>
                      <mml:mn>2</mml:mn>
                    </mml:msup>
                    <mml:mstyle displaystyle="true">
                      <mml:msubsup>
                        <mml:mo>∑</mml:mo>
                        <mml:mrow>
                          <mml:mi>i</mml:mi>
                          <mml:mo>=</mml:mo>
                          <mml:msub>
                            <mml:mi>t</mml:mi>
                            <mml:mrow>
                              <mml:mi>m</mml:mi>
                              <mml:mo>−</mml:mo>
                              <mml:mn>1</mml:mn>
                            </mml:mrow>
                          </mml:msub>
                          <mml:mo>+</mml:mo>
                          <mml:mn>1</mml:mn>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mi>t</mml:mi>
                            <mml:mi>m</mml:mi>
                          </mml:msub>
                        </mml:mrow>
                      </mml:msubsup>
                      <mml:mrow>
                        <mml:msub>
                          <mml:mi>y</mml:mi>
                          <mml:mi>i</mml:mi>
                        </mml:msub>
                        <mml:mo>+</mml:mo>
                        <mml:msup>
                          <mml:mi>σ</mml:mi>
                          <mml:mn>2</mml:mn>
                        </mml:msup>
                        <mml:mi>ν</mml:mi>
                      </mml:mrow>
                    </mml:mstyle>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mo stretchy="false">(</mml:mo>
                    <mml:msub>
                      <mml:mi>t</mml:mi>
                      <mml:mi>m</mml:mi>
                    </mml:msub>
                    <mml:mo>−</mml:mo>
                    <mml:msub>
                      <mml:mi>t</mml:mi>
                      <mml:mrow>
                        <mml:mi>m</mml:mi>
                        <mml:mo>−</mml:mo>
                        <mml:mn>1</mml:mn>
                      </mml:mrow>
                    </mml:msub>
                    <mml:mo stretchy="false">)</mml:mo>
                    <mml:msup>
                      <mml:mi>ρ</mml:mi>
                      <mml:mn>2</mml:mn>
                    </mml:msup>
                    <mml:mo>+</mml:mo>
                    <mml:msup>
                      <mml:mi>σ</mml:mi>
                      <mml:mn>2</mml:mn>
                    </mml:msup>
                  </mml:mrow>
                </mml:mfrac>
                <mml:mo>,</mml:mo>
              </mml:mrow>
            </mml:semantics>
          </mml:math>
        </disp-formula>
      </p>
      <p>for all <italic>m </italic>= 1,...,<inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M22" name="1471-2105-10-10-i15" overflow="scroll"><mml:semantics><mml:mover accent="true"><mml:mi>k</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:semantics></mml:math></inline-formula>. When the sample contains only one segment, the Bayesian estimation of the posterior distribution of the levels should theoretically lead to a normal distribution, similar to a Dirac delta function centered at <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M23" name="1471-2105-10-10-i19" overflow="scroll"><mml:semantics><mml:mover accent="true"><mml:mi>ν</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:semantics></mml:math></inline-formula>, since the levels can assume only one value from the data. In fact, in this case, if we estimate <italic>ρ</italic><sup>2 </sup>only using the data (without using any prior or other information), then this value will be close to zero (the variance of a constant random variable) and so the level will be estimated with <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M24" name="1471-2105-10-10-i19" overflow="scroll"><mml:semantics><mml:mover accent="true"><mml:mi>ν</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:semantics></mml:math></inline-formula>, the mean of the data (see Equation (9)).</p>
      <p>We can estimate the segment level <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M25" name="1471-2105-10-10-i20" overflow="scroll"><mml:semantics><mml:mrow><mml:msub><mml:mover accent="true"><mml:mtext>M</mml:mtext><mml:mo>˜</mml:mo></mml:mover><mml:mi>s</mml:mi></mml:msub></mml:mrow></mml:semantics></mml:math></inline-formula> at a generic position <italic>s</italic>, using the fact that it belongs to some segment <italic>m </italic>and in this segment it is equal to the corresponding M<sub><italic>m</italic></sub>. Then, summing over all the possible segments, we can compute its posterior distribution in the following way:</p>
      <p>
        <disp-formula id="bmcM7">
          <label>(7)</label>
          <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M26" name="1471-2105-10-10-i21" overflow="scroll">
            <mml:semantics>
              <mml:mrow>
                <mml:mi>f</mml:mi>
                <mml:mo stretchy="false">(</mml:mo>
                <mml:msub>
                  <mml:mover accent="true">
                    <mml:mi>μ</mml:mi>
                    <mml:mo>˜</mml:mo>
                  </mml:mover>
                  <mml:mi>s</mml:mi>
                </mml:msub>
                <mml:mo stretchy="false">|</mml:mo>
                <mml:mi mathvariant="bold-italic">y</mml:mi>
                <mml:mo>,</mml:mo>
                <mml:mi>K</mml:mi>
                <mml:mo>=</mml:mo>
                <mml:msub>
                  <mml:mi>k</mml:mi>
                  <mml:mn>0</mml:mn>
                </mml:msub>
                <mml:mo stretchy="false">)</mml:mo>
                <mml:mo>=</mml:mo>
                <mml:mstyle displaystyle="true">
                  <mml:munderover>
                    <mml:mo>∑</mml:mo>
                    <mml:mrow>
                      <mml:mi>m</mml:mi>
                      <mml:mo>=</mml:mo>
                      <mml:mn>1</mml:mn>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:msub>
                        <mml:mi>k</mml:mi>
                        <mml:mn>0</mml:mn>
                      </mml:msub>
                    </mml:mrow>
                  </mml:munderover>
                  <mml:mrow>
                    <mml:mstyle displaystyle="true">
                      <mml:munderover>
                        <mml:mo>∑</mml:mo>
                        <mml:mrow>
                          <mml:mi>i</mml:mi>
                          <mml:mo>=</mml:mo>
                          <mml:mn>0</mml:mn>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>s</mml:mi>
                          <mml:mo>−</mml:mo>
                          <mml:mn>1</mml:mn>
                        </mml:mrow>
                      </mml:munderover>
                      <mml:mrow>
                        <mml:mstyle displaystyle="true">
                          <mml:munderover>
                            <mml:mo>∑</mml:mo>
                            <mml:mrow>
                              <mml:mi>j</mml:mi>
                              <mml:mo>=</mml:mo>
                              <mml:mi>s</mml:mi>
                            </mml:mrow>
                            <mml:mi>n</mml:mi>
                          </mml:munderover>
                          <mml:mrow>
                            <mml:mi>f</mml:mi>
                            <mml:mo stretchy="false">(</mml:mo>
                            <mml:msub>
                              <mml:mi>μ</mml:mi>
                              <mml:mi>m</mml:mi>
                            </mml:msub>
                            <mml:mo>,</mml:mo>
                            <mml:msub>
                              <mml:mi>T</mml:mi>
                              <mml:mrow>
                                <mml:mi>m</mml:mi>
                                <mml:mo>−</mml:mo>
                                <mml:mn>1</mml:mn>
                              </mml:mrow>
                            </mml:msub>
                            <mml:mo>=</mml:mo>
                            <mml:mi>i</mml:mi>
                            <mml:mo>,</mml:mo>
                            <mml:msub>
                              <mml:mi>T</mml:mi>
                              <mml:mi>m</mml:mi>
                            </mml:msub>
                            <mml:mo>=</mml:mo>
                            <mml:mi>j</mml:mi>
                            <mml:mo>|</mml:mo>
                            <mml:mi mathvariant="bold-italic">y</mml:mi>
                            <mml:mo>,</mml:mo>
                            <mml:mi>K</mml:mi>
                            <mml:mo>=</mml:mo>
                            <mml:msub>
                              <mml:mi>k</mml:mi>
                              <mml:mn>0</mml:mn>
                            </mml:msub>
                            <mml:mo stretchy="false">)</mml:mo>
                          </mml:mrow>
                        </mml:mstyle>
                      </mml:mrow>
                    </mml:mstyle>
                  </mml:mrow>
                </mml:mstyle>
              </mml:mrow>
            </mml:semantics>
          </mml:math>
        </disp-formula>
      </p>
      <p>and the corresponding estimate of <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M27" name="1471-2105-10-10-i20" overflow="scroll"><mml:semantics><mml:mrow><mml:msub><mml:mover accent="true"><mml:mtext>M</mml:mtext><mml:mo>˜</mml:mo></mml:mover><mml:mi>s</mml:mi></mml:msub></mml:mrow></mml:semantics></mml:math></inline-formula> given <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M28" name="1471-2105-10-10-i15" overflow="scroll"><mml:semantics><mml:mover accent="true"><mml:mi>k</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:semantics></mml:math></inline-formula> is</p>
      <p>
        <disp-formula id="bmcM8">
          <label>(8)</label>
          <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M29" name="1471-2105-10-10-i22" overflow="scroll">
            <mml:semantics>
              <mml:mrow>
                <mml:msub>
                  <mml:mover accent="true">
                    <mml:mover accent="true">
                      <mml:mi>μ</mml:mi>
                      <mml:mo>˜</mml:mo>
                    </mml:mover>
                    <mml:mo>^</mml:mo>
                  </mml:mover>
                  <mml:mi>s</mml:mi>
                </mml:msub>
                <mml:mo>:</mml:mo>
                <mml:mo>=</mml:mo>
                <mml:mi>E</mml:mi>
                <mml:mo stretchy="false">[</mml:mo>
                <mml:msub>
                  <mml:mover accent="true">
                    <mml:mtext>M</mml:mtext>
                    <mml:mo>˜</mml:mo>
                  </mml:mover>
                  <mml:mi>s</mml:mi>
                </mml:msub>
                <mml:mo>|</mml:mo>
                <mml:mi mathvariant="bold-italic">y</mml:mi>
                <mml:mo>,</mml:mo>
                <mml:mover accent="true">
                  <mml:mi>k</mml:mi>
                  <mml:mo>^</mml:mo>
                </mml:mover>
                <mml:mo stretchy="false">]</mml:mo>
                <mml:mo>,</mml:mo>
              </mml:mrow>
            </mml:semantics>
          </mml:math>
        </disp-formula>
      </p>
      <p>for all <italic>s </italic>= 1,...,<italic>n</italic>. The vector <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M30" name="1471-2105-10-10-i23" overflow="scroll"><mml:semantics><mml:mover accent="true"><mml:mover accent="true"><mml:mi mathvariant="bold-italic">μ</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mo>^</mml:mo></mml:mover></mml:semantics></mml:math></inline-formula> is called <italic>Bayesian Regression Curve </italic>(<italic>BRC</italic>).</p>
      <p>The probability distributions defined previously depend on the hyper-parameters <italic>ν</italic>, <italic>ρ</italic><sup>2 </sup>and <italic>σ</italic><sup>2 </sup>(respectively, the mean and the variance of the segment levels and the variance of the noise). Hutter [<xref ref-type="bibr" rid="B11">11</xref>,<xref ref-type="bibr" rid="B12">12</xref>] suggested the following estimators:</p>
      <p>
        <disp-formula id="bmcM9">
          <label>(9)</label>
          <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M31" name="1471-2105-10-10-i24" overflow="scroll">
            <mml:semantics>
              <mml:mrow>
                <mml:mover accent="true">
                  <mml:mi>ν</mml:mi>
                  <mml:mo>^</mml:mo>
                </mml:mover>
                <mml:mo>:</mml:mo>
                <mml:mo>=</mml:mo>
                <mml:mfrac>
                  <mml:mn>1</mml:mn>
                  <mml:mi>n</mml:mi>
                </mml:mfrac>
                <mml:mstyle displaystyle="true">
                  <mml:munderover>
                    <mml:mo>∑</mml:mo>
                    <mml:mrow>
                      <mml:mi>i</mml:mi>
                      <mml:mo>=</mml:mo>
                      <mml:mn>1</mml:mn>
                    </mml:mrow>
                    <mml:mi>n</mml:mi>
                  </mml:munderover>
                  <mml:mrow>
                    <mml:msub>
                      <mml:mi>Y</mml:mi>
                      <mml:mi>i</mml:mi>
                    </mml:msub>
                    <mml:mo>=</mml:mo>
                    <mml:mover accent="true">
                      <mml:mi>Y</mml:mi>
                      <mml:mo>¯</mml:mo>
                    </mml:mover>
                  </mml:mrow>
                </mml:mstyle>
              </mml:mrow>
            </mml:semantics>
          </mml:math>
        </disp-formula>
      </p>
      <p>
        <disp-formula id="bmcM10">
          <label>(10)</label>
          <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M32" name="1471-2105-10-10-i25" overflow="scroll">
            <mml:semantics>
              <mml:mrow>
                <mml:msup>
                  <mml:mover accent="true">
                    <mml:mi>ρ</mml:mi>
                    <mml:mo>^</mml:mo>
                  </mml:mover>
                  <mml:mn>2</mml:mn>
                </mml:msup>
                <mml:mo>:</mml:mo>
                <mml:mo>=</mml:mo>
                <mml:mfrac>
                  <mml:mn>1</mml:mn>
                  <mml:mi>n</mml:mi>
                </mml:mfrac>
                <mml:mstyle displaystyle="true">
                  <mml:munderover>
                    <mml:mo>∑</mml:mo>
                    <mml:mrow>
                      <mml:mi>i</mml:mi>
                      <mml:mo>=</mml:mo>
                      <mml:mn>1</mml:mn>
                    </mml:mrow>
                    <mml:mi>n</mml:mi>
                  </mml:munderover>
                  <mml:mrow>
                    <mml:msup>
                      <mml:mrow>
                        <mml:mo stretchy="false">(</mml:mo>
                        <mml:msub>
                          <mml:mi>Y</mml:mi>
                          <mml:mi>i</mml:mi>
                        </mml:msub>
                        <mml:mo>−</mml:mo>
                        <mml:mover accent="true">
                          <mml:mi>Y</mml:mi>
                          <mml:mo>¯</mml:mo>
                        </mml:mover>
                        <mml:mo stretchy="false">)</mml:mo>
                      </mml:mrow>
                      <mml:mn>2</mml:mn>
                    </mml:msup>
                  </mml:mrow>
                </mml:mstyle>
              </mml:mrow>
            </mml:semantics>
          </mml:math>
        </disp-formula>
      </p>
      <p>
        <disp-formula id="bmcM11">
          <label>(11)</label>
          <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M33" name="1471-2105-10-10-i26" overflow="scroll">
            <mml:semantics>
              <mml:mrow>
                <mml:msup>
                  <mml:mover accent="true">
                    <mml:mi>σ</mml:mi>
                    <mml:mo>^</mml:mo>
                  </mml:mover>
                  <mml:mn>2</mml:mn>
                </mml:msup>
                <mml:mo>:</mml:mo>
                <mml:mo>=</mml:mo>
                <mml:mfrac>
                  <mml:mn>1</mml:mn>
                  <mml:mrow>
                    <mml:mn>2</mml:mn>
                    <mml:mo stretchy="false">(</mml:mo>
                    <mml:mi>n</mml:mi>
                    <mml:mo>−</mml:mo>
                    <mml:mn>1</mml:mn>
                    <mml:mo stretchy="false">)</mml:mo>
                  </mml:mrow>
                </mml:mfrac>
                <mml:mstyle displaystyle="true">
                  <mml:munderover>
                    <mml:mo>∑</mml:mo>
                    <mml:mrow>
                      <mml:mi>i</mml:mi>
                      <mml:mo>=</mml:mo>
                      <mml:mn>1</mml:mn>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>n</mml:mi>
                      <mml:mo>−</mml:mo>
                      <mml:mn>1</mml:mn>
                    </mml:mrow>
                  </mml:munderover>
                  <mml:mrow>
                    <mml:msup>
                      <mml:mrow>
                        <mml:mo stretchy="false">(</mml:mo>
                        <mml:msub>
                          <mml:mi>Y</mml:mi>
                          <mml:mrow>
                            <mml:mi>i</mml:mi>
                            <mml:mo>+</mml:mo>
                            <mml:mn>1</mml:mn>
                          </mml:mrow>
                        </mml:msub>
                        <mml:mo>−</mml:mo>
                        <mml:msub>
                          <mml:mover accent="true">
                            <mml:mi>Y</mml:mi>
                            <mml:mo>¯</mml:mo>
                          </mml:mover>
                          <mml:mi>i</mml:mi>
                        </mml:msub>
                        <mml:mo stretchy="false">)</mml:mo>
                      </mml:mrow>
                      <mml:mn>2</mml:mn>
                    </mml:msup>
                    <mml:mo>.</mml:mo>
                  </mml:mrow>
                </mml:mstyle>
              </mml:mrow>
            </mml:semantics>
          </mml:math>
        </disp-formula>
      </p>
    </sec>
    <sec>
      <title>Improved estimators of the number of segments</title>
      <p>To understand the real meaning of the MAP estimator <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M34" name="1471-2105-10-10-i27" overflow="scroll"><mml:semantics><mml:mover accent="true"><mml:mi>K</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:semantics></mml:math></inline-formula>, we need to introduce the theory of the construction of a generic Bayesian estimator.</p>
      <p>In general, a Bayesian estimator is defined in the following way. Let us suppose that <italic>Z </italic>is a random variable whose distribution depends on an unknown parameter <italic>θ</italic>, which we want to estimate. Since we cannot exactly know the true value of the parameter, we consider it as a random variable Θ with a given prior probability distribution. In order to measure the goodness of the estimation, we define an error (or <italic>loss function</italic>) and we choose the estimator that minimizes the expected error given the sample <bold><italic>Z</italic></bold>,</p>
      <p>
        <disp-formula id="bmcM12">
          <label>(12)</label>
          <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M35" name="1471-2105-10-10-i28" overflow="scroll">
            <mml:semantics>
              <mml:mrow>
                <mml:mover accent="true">
                  <mml:mi>Θ</mml:mi>
                  <mml:mo>^</mml:mo>
                </mml:mover>
                <mml:mo>:</mml:mo>
                <mml:mo>=</mml:mo>
                <mml:mi>arg</mml:mi>
                <mml:mo>⁡</mml:mo>
                <mml:munder>
                  <mml:mrow>
                    <mml:mi>min</mml:mi>
                    <mml:mo>⁡</mml:mo>
                  </mml:mrow>
                  <mml:msup>
                    <mml:mi>θ</mml:mi>
                    <mml:mo>′</mml:mo>
                  </mml:msup>
                </mml:munder>
                <mml:mi>E</mml:mi>
                <mml:mo stretchy="false">[</mml:mo>
                <mml:mi>e</mml:mi>
                <mml:mi>r</mml:mi>
                <mml:mi>r</mml:mi>
                <mml:mo stretchy="false">(</mml:mo>
                <mml:mi>Θ</mml:mi>
                <mml:mo>,</mml:mo>
                <mml:msup>
                  <mml:mi>θ</mml:mi>
                  <mml:mo>′</mml:mo>
                </mml:msup>
                <mml:mo stretchy="false">)</mml:mo>
                <mml:mo stretchy="false">|</mml:mo>
                <mml:mi mathvariant="bold-italic">Z</mml:mi>
                <mml:mo stretchy="false">]</mml:mo>
                <mml:mo>.</mml:mo>
              </mml:mrow>
            </mml:semantics>
          </mml:math>
        </disp-formula>
      </p>
      <p>The 0–1 error (defined as 1 -<italic>δ</italic><sub><italic>θ</italic>, <italic>θ'</italic></sub>) is commonly used for a parameter which can assume only a discrete number of values. The estimator corresponding to this error is the MAP estimator,</p>
      <p>
        <disp-formula id="bmcM13">
          <label>(13)</label>
          <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M36" name="1471-2105-10-10-i29" overflow="scroll">
            <mml:semantics>
              <mml:mrow>
                <mml:mtable columnalign="left">
                  <mml:mtr columnalign="left">
                    <mml:mtd columnalign="left">
                      <mml:mrow>
                        <mml:mi>arg</mml:mi>
                        <mml:mo>⁡</mml:mo>
                        <mml:munder>
                          <mml:mrow>
                            <mml:mi>min</mml:mi>
                            <mml:mo>⁡</mml:mo>
                          </mml:mrow>
                          <mml:msup>
                            <mml:mi>θ</mml:mi>
                            <mml:mo>′</mml:mo>
                          </mml:msup>
                        </mml:munder>
                        <mml:mi>E</mml:mi>
                        <mml:mo stretchy="false">[</mml:mo>
                        <mml:mn>1</mml:mn>
                        <mml:mo>−</mml:mo>
                        <mml:msub>
                          <mml:mi>δ</mml:mi>
                          <mml:mrow>
                            <mml:mi>Θ</mml:mi>
                            <mml:mo>,</mml:mo>
                            <mml:msup>
                              <mml:mi>θ</mml:mi>
                              <mml:mo>′</mml:mo>
                            </mml:msup>
                          </mml:mrow>
                        </mml:msub>
                        <mml:mo stretchy="false">|</mml:mo>
                        <mml:mi mathvariant="bold-italic">Z</mml:mi>
                        <mml:mo stretchy="false">]</mml:mo>
                      </mml:mrow>
                    </mml:mtd>
                    <mml:mtd columnalign="left">
                      <mml:mo>=</mml:mo>
                    </mml:mtd>
                    <mml:mtd columnalign="left">
                      <mml:mrow>
                        <mml:mi>arg</mml:mi>
                        <mml:mo>⁡</mml:mo>
                        <mml:munder>
                          <mml:mrow>
                            <mml:mi>max</mml:mi>
                            <mml:mo>⁡</mml:mo>
                          </mml:mrow>
                          <mml:msup>
                            <mml:mi>θ</mml:mi>
                            <mml:mo>′</mml:mo>
                          </mml:msup>
                        </mml:munder>
                        <mml:mstyle displaystyle="true">
                          <mml:munder>
                            <mml:mo>∑</mml:mo>
                            <mml:mi>θ</mml:mi>
                          </mml:munder>
                          <mml:mrow>
                            <mml:msub>
                              <mml:mi>δ</mml:mi>
                              <mml:mrow>
                                <mml:mi>θ</mml:mi>
                                <mml:mo>,</mml:mo>
                                <mml:msup>
                                  <mml:mi>θ</mml:mi>
                                  <mml:mo>′</mml:mo>
                                </mml:msup>
                              </mml:mrow>
                            </mml:msub>
                            <mml:mi>p</mml:mi>
                            <mml:mo stretchy="false">(</mml:mo>
                            <mml:mi>θ</mml:mi>
                            <mml:mo stretchy="false">|</mml:mo>
                            <mml:mi mathvariant="bold-italic">Z</mml:mi>
                            <mml:mo stretchy="false">)</mml:mo>
                          </mml:mrow>
                        </mml:mstyle>
                      </mml:mrow>
                    </mml:mtd>
                  </mml:mtr>
                  <mml:mtr columnalign="left">
                    <mml:mtd columnalign="left">
                      <mml:mrow/>
                    </mml:mtd>
                    <mml:mtd columnalign="left">
                      <mml:mo>=</mml:mo>
                    </mml:mtd>
                    <mml:mtd columnalign="left">
                      <mml:mrow>
                        <mml:mi>arg</mml:mi>
                        <mml:mo>⁡</mml:mo>
                        <mml:munder>
                          <mml:mrow>
                            <mml:mi>max</mml:mi>
                            <mml:mo>⁡</mml:mo>
                          </mml:mrow>
                          <mml:msup>
                            <mml:mi>θ</mml:mi>
                            <mml:mo>′</mml:mo>
                          </mml:msup>
                        </mml:munder>
                        <mml:mi>p</mml:mi>
                        <mml:mo stretchy="false">(</mml:mo>
                        <mml:msup>
                          <mml:mi>θ</mml:mi>
                          <mml:mo>′</mml:mo>
                        </mml:msup>
                        <mml:mo stretchy="false">|</mml:mo>
                        <mml:mi mathvariant="bold-italic">Z</mml:mi>
                        <mml:mo stretchy="false">)</mml:mo>
                        <mml:mo>.</mml:mo>
                      </mml:mrow>
                    </mml:mtd>
                  </mml:mtr>
                </mml:mtable>
              </mml:mrow>
            </mml:semantics>
          </mml:math>
        </disp-formula>
      </p>
      <p>Obviously, if we use different types of errors, we can obtain different estimators. In the following, we will use <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M37" name="1471-2105-10-10-i27" overflow="scroll"><mml:semantics><mml:mover accent="true"><mml:mi>K</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:semantics></mml:math></inline-formula> to denote any estimator of <italic>K</italic>, while <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M38" name="1471-2105-10-10-i27" overflow="scroll"><mml:semantics><mml:mover accent="true"><mml:mi>K</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:semantics></mml:math></inline-formula><sub>01 </sub>to denote the parameter estimator <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M39" name="1471-2105-10-10-i27" overflow="scroll"><mml:semantics><mml:mover accent="true"><mml:mi>K</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:semantics></mml:math></inline-formula> based on the 0–1 error.</p>
      <p>Using the 0–1 error, we give the same penalty to each value different from the true value, whether it is close to or far away from the true one. To take into account the distance of the estimated value from the true one, we need to use other types of errors, which are based on different definitions of distance, such as,</p>
      <p>
        <disp-formula id="bmcM14"><label>(14)</label>absolute error := |<italic>θ </italic>- <italic>θ'</italic>|</disp-formula>
      </p>
      <p>
        <disp-formula id="bmcM15"><label>(15)</label>squared error := (<italic>θ </italic>- <italic>θ'</italic>)<sup>2</sup>.</disp-formula>
      </p>
      <p>If the parameter <italic>θ </italic>∊ ℝ, then the estimators corresponding to these errors are the median and the mean of its posterior distribution, respectively. In our case, we denote these estimators of <italic>k</italic><sub>0 </sub>with <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M40" name="1471-2105-10-10-i30" overflow="scroll"><mml:semantics><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>K</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:semantics></mml:math></inline-formula> and <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M41" name="1471-2105-10-10-i31" overflow="scroll"><mml:semantics><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>K</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:semantics></mml:math></inline-formula>.</p>
    </sec>
    <sec>
      <title>Improved estimators of the boundaries</title>
      <p>Similarly to the previous subsection, we derive alternative boundary estimators, by considering different types of errors. We denote the MAP boundary estimator defined in Equation (4) with <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M42" name="1471-2105-10-10-i32" overflow="scroll"><mml:semantics><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold-italic">T</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mn>01</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:semantics></mml:math></inline-formula>.</p>
      <sec>
        <title>Meaning of the estimator <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M43" name="1471-2105-10-10-i33" overflow="scroll"><mml:semantics><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold-italic">T</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mn>01</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:semantics></mml:math></inline-formula></title>
        <p>The estimator <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M44" name="1471-2105-10-10-i33" overflow="scroll"><mml:semantics><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold-italic">T</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mn>01</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:semantics></mml:math></inline-formula> is defined in such a way that each component minimizes the 0–1 error of the corresponding boundary, separately. Explicitly, given the sample point <bold><italic>y </italic></bold>and the segment number <italic>k</italic><sub>0</sub>, its estimate is</p>
        <p>
          <disp-formula>
            <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M45" name="1471-2105-10-10-i34" overflow="scroll">
              <mml:semantics>
                <mml:mrow>
                  <mml:msub>
                    <mml:mover accent="true">
                      <mml:mi mathvariant="bold-italic">T</mml:mi>
                      <mml:mo>^</mml:mo>
                    </mml:mover>
                    <mml:mrow>
                      <mml:mn>01</mml:mn>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mo>=</mml:mo>
                  <mml:mrow>
                    <mml:mo>(</mml:mo>
                    <mml:mrow>
                      <mml:mn>0</mml:mn>
                      <mml:mo>,</mml:mo>
                      <mml:mi>arg</mml:mi>
                      <mml:mo>⁡</mml:mo>
                      <mml:munder>
                        <mml:mrow>
                          <mml:mi>max</mml:mi>
                          <mml:mo>⁡</mml:mo>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mi>t</mml:mi>
                            <mml:mn>1</mml:mn>
                          </mml:msub>
                          <mml:mo>∈</mml:mo>
                          <mml:mi mathvariant="double-struck">T</mml:mi>
                        </mml:mrow>
                      </mml:munder>
                      <mml:mi>p</mml:mi>
                      <mml:mo stretchy="false">(</mml:mo>
                      <mml:msub>
                        <mml:mi>t</mml:mi>
                        <mml:mn>1</mml:mn>
                      </mml:msub>
                      <mml:mo stretchy="false">|</mml:mo>
                      <mml:mi>y</mml:mi>
                      <mml:mo>,</mml:mo>
                      <mml:mi>K</mml:mi>
                      <mml:mo>=</mml:mo>
                      <mml:msub>
                        <mml:mi>k</mml:mi>
                        <mml:mn>0</mml:mn>
                      </mml:msub>
                      <mml:mo stretchy="false">)</mml:mo>
                      <mml:mo>,</mml:mo>
                      <mml:mn>...</mml:mn>
                      <mml:mo>,</mml:mo>
                      <mml:mi>arg</mml:mi>
                      <mml:mo>⁡</mml:mo>
                      <mml:munder>
                        <mml:mrow>
                          <mml:mi>max</mml:mi>
                          <mml:mo>⁡</mml:mo>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mi>t</mml:mi>
                            <mml:mrow>
                              <mml:msub>
                                <mml:mi>k</mml:mi>
                                <mml:mn>0</mml:mn>
                              </mml:msub>
                              <mml:mo>−</mml:mo>
                              <mml:mn>1</mml:mn>
                            </mml:mrow>
                          </mml:msub>
                          <mml:mo>∈</mml:mo>
                          <mml:mi mathvariant="double-struck">T</mml:mi>
                        </mml:mrow>
                      </mml:munder>
                      <mml:mi>p</mml:mi>
                      <mml:mo stretchy="false">(</mml:mo>
                      <mml:msub>
                        <mml:mi>t</mml:mi>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mi>k</mml:mi>
                            <mml:mn>0</mml:mn>
                          </mml:msub>
                          <mml:mo>−</mml:mo>
                          <mml:mn>1</mml:mn>
                        </mml:mrow>
                      </mml:msub>
                      <mml:mo stretchy="false">|</mml:mo>
                      <mml:mi>y</mml:mi>
                      <mml:mo>,</mml:mo>
                      <mml:mi>K</mml:mi>
                      <mml:mo>=</mml:mo>
                      <mml:msub>
                        <mml:mi>k</mml:mi>
                        <mml:mn>0</mml:mn>
                      </mml:msub>
                      <mml:mo stretchy="false">)</mml:mo>
                      <mml:mo>,</mml:mo>
                      <mml:mi>n</mml:mi>
                    </mml:mrow>
                    <mml:mo>)</mml:mo>
                  </mml:mrow>
                  <mml:mo>,</mml:mo>
                </mml:mrow>
              </mml:semantics>
            </mml:math>
          </disp-formula>
        </p>
        <p>where <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M46" name="1471-2105-10-10-i35" overflow="scroll"><mml:semantics><mml:mi mathvariant="double-struck">T</mml:mi></mml:semantics></mml:math></inline-formula> = {1,...,<italic>n </italic>- 1}. <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M47" name="1471-2105-10-10-i33" overflow="scroll"><mml:semantics><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold-italic">T</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mn>01</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:semantics></mml:math></inline-formula> may be regarded as an approximation of the Bayesian estimator that minimizes the error which counts the number of wrongly estimated boundaries:</p>
        <p>
          <disp-formula id="bmcM16">
            <label>(16)</label>
            <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M48" name="1471-2105-10-10-i36" overflow="scroll">
              <mml:semantics>
                <mml:mrow>
                  <mml:mtext>sum </mml:mtext>
                  <mml:mn>0</mml:mn>
                  <mml:mtext>-</mml:mtext>
                  <mml:mn>1</mml:mn>
                  <mml:mtext> error</mml:mtext>
                  <mml:mo>=</mml:mo>
                  <mml:mstyle displaystyle="true">
                    <mml:munderover>
                      <mml:mo>∑</mml:mo>
                      <mml:mrow>
                        <mml:mi>p</mml:mi>
                        <mml:mo>=</mml:mo>
                        <mml:mn>1</mml:mn>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:msub>
                          <mml:mi>k</mml:mi>
                          <mml:mn>0</mml:mn>
                        </mml:msub>
                        <mml:mo>−</mml:mo>
                        <mml:mn>1</mml:mn>
                      </mml:mrow>
                    </mml:munderover>
                    <mml:mrow>
                      <mml:mrow>
                        <mml:mo>(</mml:mo>
                        <mml:mrow>
                          <mml:mn>1</mml:mn>
                          <mml:mo>−</mml:mo>
                          <mml:msub>
                            <mml:mi>δ</mml:mi>
                            <mml:mrow>
                              <mml:msubsup>
                                <mml:mi>t</mml:mi>
                                <mml:mi>p</mml:mi>
                                <mml:mn>0</mml:mn>
                              </mml:msubsup>
                              <mml:mo>,</mml:mo>
                              <mml:msub>
                                <mml:mi>t</mml:mi>
                                <mml:mi>p</mml:mi>
                              </mml:msub>
                            </mml:mrow>
                          </mml:msub>
                        </mml:mrow>
                        <mml:mo>)</mml:mo>
                      </mml:mrow>
                      <mml:mo>=</mml:mo>
                      <mml:msub>
                        <mml:mi>k</mml:mi>
                        <mml:mn>0</mml:mn>
                      </mml:msub>
                      <mml:mo>−</mml:mo>
                      <mml:mn>1</mml:mn>
                      <mml:mo>−</mml:mo>
                      <mml:mstyle displaystyle="true">
                        <mml:munderover>
                          <mml:mo>∑</mml:mo>
                          <mml:mrow>
                            <mml:mi>p</mml:mi>
                            <mml:mo>=</mml:mo>
                            <mml:mn>1</mml:mn>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:msub>
                              <mml:mi>k</mml:mi>
                              <mml:mn>0</mml:mn>
                            </mml:msub>
                            <mml:mo>−</mml:mo>
                            <mml:mn>1</mml:mn>
                          </mml:mrow>
                        </mml:munderover>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mi>δ</mml:mi>
                            <mml:mrow>
                              <mml:msubsup>
                                <mml:mi>t</mml:mi>
                                <mml:mi>p</mml:mi>
                                <mml:mn>0</mml:mn>
                              </mml:msubsup>
                              <mml:mo>,</mml:mo>
                              <mml:msub>
                                <mml:mi>t</mml:mi>
                                <mml:mi>p</mml:mi>
                              </mml:msub>
                            </mml:mrow>
                          </mml:msub>
                        </mml:mrow>
                      </mml:mstyle>
                    </mml:mrow>
                  </mml:mstyle>
                  <mml:mo>,</mml:mo>
                </mml:mrow>
              </mml:semantics>
            </mml:math>
          </disp-formula>
        </p>
        <p>that is</p>
        <p>
          <disp-formula id="bmcM17">
            <label>(17)</label>
            <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M49" name="1471-2105-10-10-i37" overflow="scroll">
              <mml:semantics>
                <mml:mrow>
                  <mml:msub>
                    <mml:mover accent="true">
                      <mml:mi mathvariant="bold-italic">T</mml:mi>
                      <mml:mo>^</mml:mo>
                    </mml:mover>
                    <mml:mrow>
                      <mml:mtext>sum</mml:mtext>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mo>=</mml:mo>
                  <mml:munder>
                    <mml:mrow>
                      <mml:mi>arg</mml:mi>
                      <mml:mo>⁡</mml:mo>
                      <mml:mi>max</mml:mi>
                      <mml:mo>⁡</mml:mo>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi mathvariant="bold-italic">t</mml:mi>
                      <mml:mo>∈</mml:mo>
                      <mml:msub>
                        <mml:mi mathvariant="double-struck">T</mml:mi>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mi>k</mml:mi>
                            <mml:mn>0</mml:mn>
                          </mml:msub>
                          <mml:mo>,</mml:mo>
                          <mml:mi>n</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                    </mml:mrow>
                  </mml:munder>
                  <mml:mstyle displaystyle="true">
                    <mml:munderover>
                      <mml:mo>∑</mml:mo>
                      <mml:mrow>
                        <mml:mi>p</mml:mi>
                        <mml:mo>=</mml:mo>
                        <mml:mn>1</mml:mn>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:msub>
                          <mml:mi>k</mml:mi>
                          <mml:mn>0</mml:mn>
                        </mml:msub>
                        <mml:mo>−</mml:mo>
                        <mml:mn>1</mml:mn>
                      </mml:mrow>
                    </mml:munderover>
                    <mml:mrow>
                      <mml:mi>p</mml:mi>
                      <mml:mo stretchy="false">(</mml:mo>
                      <mml:msub>
                        <mml:mi>t</mml:mi>
                        <mml:mi>p</mml:mi>
                      </mml:msub>
                      <mml:mo>|</mml:mo>
                      <mml:mi>K</mml:mi>
                      <mml:mo>=</mml:mo>
                      <mml:msub>
                        <mml:mi>k</mml:mi>
                        <mml:mn>0</mml:mn>
                      </mml:msub>
                      <mml:mo>,</mml:mo>
                      <mml:mi mathvariant="bold-italic">Y</mml:mi>
                      <mml:mo stretchy="false">)</mml:mo>
                      <mml:mo>.</mml:mo>
                    </mml:mrow>
                  </mml:mstyle>
                </mml:mrow>
              </mml:semantics>
            </mml:math>
          </disp-formula>
        </p>
      </sec>
      <sec>
        <title>Definition of the estimator <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M50" name="1471-2105-10-10-i38" overflow="scroll"><mml:semantics><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold-italic">Τ</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mtext>joint</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:semantics></mml:math></inline-formula></title>
        <p>A problem of the latter estimator (Equation (17)) is its computational complexity, because it needs the computation of all the ordered combinations of the boundaries. On the other hand, there are two reasons for which <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M51" name="1471-2105-10-10-i33" overflow="scroll"><mml:semantics><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold-italic">T</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mn>01</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:semantics></mml:math></inline-formula> is not a suitable estimator of the boundaries. First, it does not take into account that the boundaries are dependent, because they have to be ordered, and second, in principle, it can have more than one component with the same value. As a consequence, a theoretically more correct way to estimate the boundaries is minimizing the 0–1 error with respect to the joint boundary probability distribution (this error is called <italic>joint 0–1 error</italic>). Then, given <italic>k</italic><sub>0 </sub>and <bold><italic>Y</italic></bold>, the boundary estimator becomes</p>
        <p>
          <disp-formula id="bmcM18">
            <label>(18)</label>
            <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M52" name="1471-2105-10-10-i39" overflow="scroll">
              <mml:semantics>
                <mml:mrow>
                  <mml:msub>
                    <mml:mover accent="true">
                      <mml:mi mathvariant="bold-italic">T</mml:mi>
                      <mml:mo>^</mml:mo>
                    </mml:mover>
                    <mml:mrow>
                      <mml:mtext>joint</mml:mtext>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mo>=</mml:mo>
                  <mml:munder>
                    <mml:mrow>
                      <mml:mi>arg</mml:mi>
                      <mml:mo>⁡</mml:mo>
                      <mml:mi>max</mml:mi>
                      <mml:mo>⁡</mml:mo>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi mathvariant="bold-italic">t</mml:mi>
                      <mml:mo>∈</mml:mo>
                      <mml:msub>
                        <mml:mi mathvariant="double-struck">T</mml:mi>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mi>k</mml:mi>
                            <mml:mn>0</mml:mn>
                          </mml:msub>
                          <mml:mo>,</mml:mo>
                          <mml:mi>n</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                    </mml:mrow>
                  </mml:munder>
                  <mml:mi>p</mml:mi>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:mi mathvariant="bold-italic">t</mml:mi>
                  <mml:mo stretchy="false">|</mml:mo>
                  <mml:mi>K</mml:mi>
                  <mml:mo>=</mml:mo>
                  <mml:msub>
                    <mml:mi>k</mml:mi>
                    <mml:mn>0</mml:mn>
                  </mml:msub>
                  <mml:mo>,</mml:mo>
                  <mml:mi mathvariant="bold-italic">Y</mml:mi>
                  <mml:mo stretchy="false">)</mml:mo>
                  <mml:mo>.</mml:mo>
                </mml:mrow>
              </mml:semantics>
            </mml:math>
          </disp-formula>
        </p>
      </sec>
      <sec>
        <title>Definition of the estimators <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M53" name="1471-2105-10-10-i40" overflow="scroll"><mml:semantics><mml:mover accent="true"><mml:mi mathvariant="bold-italic">Τ</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:semantics></mml:math></inline-formula><sub>BinErr </sub>and <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M54" name="1471-2105-10-10-i40" overflow="scroll"><mml:semantics><mml:mover accent="true"><mml:mi mathvariant="bold-italic">Τ</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:semantics></mml:math></inline-formula><sub>BinErrAk</sub></title>
        <p>We must notice that the estimators considered until now have the same length of the true vector of the boundaries. In practice, the number of segments <italic>k</italic><sub>0 </sub>is unknown, so that we should use <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M55" name="1471-2105-10-10-i15" overflow="scroll"><mml:semantics><mml:mover accent="true"><mml:mi>k</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:semantics></mml:math></inline-formula>. As a consequence, if <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M56" name="1471-2105-10-10-i15" overflow="scroll"><mml:semantics><mml:mover accent="true"><mml:mi>k</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:semantics></mml:math></inline-formula> is different from <italic>k</italic><sub>0</sub>, then, strictly speaking, we cannot minimize the previous types of error because the vectors have different length.</p>
        <p>A way to solve this issue is to map each boundary vector into a vector <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M57" name="1471-2105-10-10-i41" overflow="scroll"><mml:semantics><mml:mrow><mml:mi mathvariant="bold-italic">τ</mml:mi><mml:mo>∈</mml:mo><mml:msubsup><mml:mi>ℝ</mml:mi><mml:mn>0</mml:mn><mml:mrow><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:semantics></mml:math></inline-formula> in the following way:</p>
        <p>
          <disp-formula id="bmcM19">
            <label>(19)</label>
            <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M58" name="1471-2105-10-10-i42" overflow="scroll">
              <mml:semantics>
                <mml:mrow>
                  <mml:mi mathvariant="bold-italic">t</mml:mi>
                  <mml:mo>↦</mml:mo>
                  <mml:mi mathvariant="bold-italic">τ</mml:mi>
                  <mml:mtext> such that </mml:mtext>
                  <mml:msub>
                    <mml:mi>τ</mml:mi>
                    <mml:mi>i</mml:mi>
                  </mml:msub>
                  <mml:mo>=</mml:mo>
                  <mml:mrow>
                    <mml:mo>{</mml:mo>
                    <mml:mrow>
                      <mml:mtable columnalign="left">
                        <mml:mtr columnalign="left">
                          <mml:mtd columnalign="left">
                            <mml:mn>1</mml:mn>
                          </mml:mtd>
                          <mml:mtd columnalign="left">
                            <mml:mrow>
                              <mml:mtext>if </mml:mtext>
                              <mml:mo>∃</mml:mo>
                              <mml:mi>p</mml:mi>
                              <mml:mtext> such that </mml:mtext>
                              <mml:msub>
                                <mml:mi>t</mml:mi>
                                <mml:mi>p</mml:mi>
                              </mml:msub>
                              <mml:mo>=</mml:mo>
                              <mml:mi>i</mml:mi>
                            </mml:mrow>
                          </mml:mtd>
                        </mml:mtr>
                        <mml:mtr columnalign="left">
                          <mml:mtd columnalign="left">
                            <mml:mn>0</mml:mn>
                          </mml:mtd>
                          <mml:mtd columnalign="left">
                            <mml:mrow>
                              <mml:mtext>otherwise</mml:mtext>
                              <mml:mo>.</mml:mo>
                            </mml:mrow>
                          </mml:mtd>
                        </mml:mtr>
                      </mml:mtable>
                    </mml:mrow>
                  </mml:mrow>
                </mml:mrow>
              </mml:semantics>
            </mml:math>
          </disp-formula>
        </p>
        <p>We denote with <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M59" name="1471-2105-10-10-i43" overflow="scroll"><mml:semantics><mml:mrow><mml:mi mathvariant="script">T</mml:mi><mml:msub><mml:mi mathvariant="script">T</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:semantics></mml:math></inline-formula> the set of all the possible <bold>τ </bold>with <italic>τ</italic><sub>0 </sub>= 1, <italic>τ</italic><sub><italic>n </italic></sub>= 1 and <italic>k </italic>- 1 of the other components equal to 1.</p>
        <p>Now, for the two new vectors <bold><italic>τ</italic></bold><sup>0 </sup>and <bold><italic>τ</italic></bold>, we define the following binary error,</p>
        <p>
          <disp-formula id="bmcM20">
            <label>(20)</label>
            <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M60" name="1471-2105-10-10-i44" overflow="scroll">
              <mml:semantics>
                <mml:mrow>
                  <mml:mtext>binary error</mml:mtext>
                  <mml:mo>=</mml:mo>
                  <mml:msub>
                    <mml:mi>k</mml:mi>
                    <mml:mn>0</mml:mn>
                  </mml:msub>
                  <mml:mo>−</mml:mo>
                  <mml:mn>1</mml:mn>
                  <mml:mo>−</mml:mo>
                  <mml:mo>〈</mml:mo>
                  <mml:msup>
                    <mml:mi mathvariant="bold-italic">τ</mml:mi>
                    <mml:mn>0</mml:mn>
                  </mml:msup>
                  <mml:mo>,</mml:mo>
                  <mml:mi mathvariant="bold-italic">τ</mml:mi>
                  <mml:mo>〉</mml:mo>
                  <mml:mo>=</mml:mo>
                  <mml:msub>
                    <mml:mi>k</mml:mi>
                    <mml:mn>0</mml:mn>
                  </mml:msub>
                  <mml:mo>−</mml:mo>
                  <mml:mn>1</mml:mn>
                  <mml:mo>−</mml:mo>
                  <mml:mstyle displaystyle="true">
                    <mml:munderover>
                      <mml:mo>∑</mml:mo>
                      <mml:mrow>
                        <mml:mi>i</mml:mi>
                        <mml:mo>=</mml:mo>
                        <mml:mn>1</mml:mn>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>n</mml:mi>
                        <mml:mo>−</mml:mo>
                        <mml:mn>1</mml:mn>
                      </mml:mrow>
                    </mml:munderover>
                    <mml:mrow>
                      <mml:msubsup>
                        <mml:mi>τ</mml:mi>
                        <mml:mi>i</mml:mi>
                        <mml:mn>0</mml:mn>
                      </mml:msubsup>
                      <mml:msub>
                        <mml:mi>τ</mml:mi>
                        <mml:mi>i</mml:mi>
                      </mml:msub>
                    </mml:mrow>
                  </mml:mstyle>
                  <mml:mo>.</mml:mo>
                </mml:mrow>
              </mml:semantics>
            </mml:math>
          </disp-formula>
        </p>
        <p>Since the two-norm of the vectors involved is fixed, minimizing (20) is the same as minimizing the Euclidean distance between the two vectors or the sum 0–1 error. Furthermore, error (20) is consistent with the Russell-Rao dissimilarity measure defined on the space of the binary vectors. Its corresponding estimator is</p>
        <p>
          <disp-formula id="bmcM21">
            <label>(21)</label>
            <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M61" name="1471-2105-10-10-i45" overflow="scroll">
              <mml:semantics>
                <mml:mrow>
                  <mml:msub>
                    <mml:mover accent="true">
                      <mml:mi mathvariant="bold-italic">Τ</mml:mi>
                      <mml:mo>^</mml:mo>
                    </mml:mover>
                    <mml:mrow>
                      <mml:mtext>BinErr</mml:mtext>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mo>:</mml:mo>
                  <mml:mo>=</mml:mo>
                  <mml:munder>
                    <mml:mrow>
                      <mml:mi>arg</mml:mi>
                      <mml:mo>⁡</mml:mo>
                      <mml:mi>min</mml:mi>
                      <mml:mo>⁡</mml:mo>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:msup>
                        <mml:mi>τ</mml:mi>
                        <mml:mo>′</mml:mo>
                      </mml:msup>
                      <mml:mo>∈</mml:mo>
                      <mml:mi mathvariant="script">T</mml:mi>
                      <mml:msub>
                        <mml:mi mathvariant="script">T</mml:mi>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mi>k</mml:mi>
                            <mml:mn>0</mml:mn>
                          </mml:msub>
                          <mml:mo>,</mml:mo>
                          <mml:mi>n</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                    </mml:mrow>
                  </mml:munder>
                  <mml:mtext>E</mml:mtext>
                  <mml:mrow>
                    <mml:mo>[</mml:mo>
                    <mml:mrow>
                      <mml:mrow>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mi>k</mml:mi>
                            <mml:mn>0</mml:mn>
                          </mml:msub>
                          <mml:mo>−</mml:mo>
                          <mml:mn>1</mml:mn>
                          <mml:mo>−</mml:mo>
                          <mml:mstyle displaystyle="true">
                            <mml:munderover>
                              <mml:mo>∑</mml:mo>
                              <mml:mrow>
                                <mml:mi>i</mml:mi>
                                <mml:mo>=</mml:mo>
                                <mml:mn>1</mml:mn>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mi>n</mml:mi>
                                <mml:mo>−</mml:mo>
                                <mml:mn>1</mml:mn>
                              </mml:mrow>
                            </mml:munderover>
                            <mml:mrow>
                              <mml:msub>
                                <mml:mi>τ</mml:mi>
                                <mml:mi>i</mml:mi>
                              </mml:msub>
                              <mml:msub>
                                <mml:msup>
                                  <mml:mi>τ</mml:mi>
                                  <mml:mo>′</mml:mo>
                                </mml:msup>
                                <mml:mi>i</mml:mi>
                              </mml:msub>
                            </mml:mrow>
                          </mml:mstyle>
                        </mml:mrow>
                        <mml:mo>|</mml:mo>
                      </mml:mrow>
                      <mml:mi mathvariant="bold-italic">Y</mml:mi>
                      <mml:mo>,</mml:mo>
                      <mml:msub>
                        <mml:mi>k</mml:mi>
                        <mml:mn>0</mml:mn>
                      </mml:msub>
                    </mml:mrow>
                    <mml:mo>]</mml:mo>
                  </mml:mrow>
                  <mml:mo>=</mml:mo>
                  <mml:munder>
                    <mml:mrow>
                      <mml:mi>arg</mml:mi>
                      <mml:mo>⁡</mml:mo>
                      <mml:mi>max</mml:mi>
                      <mml:mo>⁡</mml:mo>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:msup>
                        <mml:mi>τ</mml:mi>
                        <mml:mo>′</mml:mo>
                      </mml:msup>
                      <mml:mo>∈</mml:mo>
                      <mml:mi mathvariant="script">T</mml:mi>
                      <mml:msub>
                        <mml:mi mathvariant="script">T</mml:mi>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mi>k</mml:mi>
                            <mml:mn>0</mml:mn>
                          </mml:msub>
                          <mml:mo>,</mml:mo>
                          <mml:mi>n</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                    </mml:mrow>
                  </mml:munder>
                  <mml:mtext>E</mml:mtext>
                  <mml:mrow>
                    <mml:mo>[</mml:mo>
                    <mml:mrow>
                      <mml:mrow>
                        <mml:mrow>
                          <mml:mstyle displaystyle="true">
                            <mml:munderover>
                              <mml:mo>∑</mml:mo>
                              <mml:mrow>
                                <mml:mi>i</mml:mi>
                                <mml:mo>=</mml:mo>
                                <mml:mn>1</mml:mn>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mi>n</mml:mi>
                                <mml:mo>−</mml:mo>
                                <mml:mn>1</mml:mn>
                              </mml:mrow>
                            </mml:munderover>
                            <mml:mrow>
                              <mml:msub>
                                <mml:mi>τ</mml:mi>
                                <mml:mi>i</mml:mi>
                              </mml:msub>
                              <mml:msub>
                                <mml:msup>
                                  <mml:mi>τ</mml:mi>
                                  <mml:mo>′</mml:mo>
                                </mml:msup>
                                <mml:mi>i</mml:mi>
                              </mml:msub>
                            </mml:mrow>
                          </mml:mstyle>
                        </mml:mrow>
                        <mml:mo>|</mml:mo>
                      </mml:mrow>
                      <mml:mi mathvariant="bold-italic">Y</mml:mi>
                      <mml:mo>,</mml:mo>
                      <mml:msub>
                        <mml:mi>k</mml:mi>
                        <mml:mn>0</mml:mn>
                      </mml:msub>
                    </mml:mrow>
                    <mml:mo>]</mml:mo>
                  </mml:mrow>
                  <mml:mo>.</mml:mo>
                </mml:mrow>
              </mml:semantics>
            </mml:math>
          </disp-formula>
        </p>
        <p>Since we do not know the real value of <italic>k</italic><sub>0</sub>, we should replace it with <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M62" name="1471-2105-10-10-i15" overflow="scroll"><mml:semantics><mml:mover accent="true"><mml:mi>k</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:semantics></mml:math></inline-formula> to compute Equation (21). Doing this, we could amplify the error of the boundary estimation because of the addition of the error of the segment number estimation. A way to attenuate this issue is to integrate out the number of segments in the conditional expected value. Then the estimator becomes</p>
        <p>
          <disp-formula id="bmcM22">
            <label>(22)</label>
            <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M63" name="1471-2105-10-10-i46" overflow="scroll">
              <mml:semantics>
                <mml:mrow>
                  <mml:msub>
                    <mml:mover accent="true">
                      <mml:mi mathvariant="bold-italic">Τ</mml:mi>
                      <mml:mo>^</mml:mo>
                    </mml:mover>
                    <mml:mrow>
                      <mml:mtext>BinErrAk</mml:mtext>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mo>:</mml:mo>
                  <mml:mo>=</mml:mo>
                  <mml:munder>
                    <mml:mrow>
                      <mml:mi>arg</mml:mi>
                      <mml:mo>⁡</mml:mo>
                      <mml:mi>max</mml:mi>
                      <mml:mo>⁡</mml:mo>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:msup>
                        <mml:mi>τ</mml:mi>
                        <mml:mo>′</mml:mo>
                      </mml:msup>
                      <mml:mo>∈</mml:mo>
                      <mml:mi mathvariant="script">T</mml:mi>
                      <mml:msub>
                        <mml:mi mathvariant="script">T</mml:mi>
                        <mml:mrow>
                          <mml:mover accent="true">
                            <mml:mi>k</mml:mi>
                            <mml:mo>^</mml:mo>
                          </mml:mover>
                          <mml:mo>,</mml:mo>
                          <mml:mi>n</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                    </mml:mrow>
                  </mml:munder>
                  <mml:mtext>E</mml:mtext>
                  <mml:mrow>
                    <mml:mo>[</mml:mo>
                    <mml:mrow>
                      <mml:mrow>
                        <mml:mrow>
                          <mml:mstyle displaystyle="true">
                            <mml:munderover>
                              <mml:mo>∑</mml:mo>
                              <mml:mrow>
                                <mml:mi>i</mml:mi>
                                <mml:mo>=</mml:mo>
                                <mml:mn>1</mml:mn>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mi>n</mml:mi>
                                <mml:mo>−</mml:mo>
                                <mml:mn>1</mml:mn>
                              </mml:mrow>
                            </mml:munderover>
                            <mml:mrow>
                              <mml:msub>
                                <mml:mi>τ</mml:mi>
                                <mml:mi>i</mml:mi>
                              </mml:msub>
                              <mml:msub>
                                <mml:msup>
                                  <mml:mi>τ</mml:mi>
                                  <mml:mo>′</mml:mo>
                                </mml:msup>
                                <mml:mi>i</mml:mi>
                              </mml:msub>
                            </mml:mrow>
                          </mml:mstyle>
                        </mml:mrow>
                        <mml:mo>|</mml:mo>
                      </mml:mrow>
                      <mml:mi mathvariant="bold-italic">Y</mml:mi>
                    </mml:mrow>
                    <mml:mo>]</mml:mo>
                  </mml:mrow>
                  <mml:mo>.</mml:mo>
                </mml:mrow>
              </mml:semantics>
            </mml:math>
          </disp-formula>
        </p>
      </sec>
      <sec>
        <title>Improved regression curve</title>
        <p>As we saw in the previous subsections, there are cases in which the estimation of a parameter of our interest can be made independently of other parameters by integration. The computation of the BRC (see Equations (7) and (8)) suggests to average also over the number of segments by considering the posterior probability of <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M64" name="1471-2105-10-10-i20" overflow="scroll"><mml:semantics><mml:mrow><mml:msub><mml:mover accent="true"><mml:mtext>M</mml:mtext><mml:mo>˜</mml:mo></mml:mover><mml:mi>s</mml:mi></mml:msub></mml:mrow></mml:semantics></mml:math></inline-formula>, given only the sample point <bold><italic>y</italic></bold>,</p>
        <p>
          <disp-formula id="bmcM23">
            <label>(23)</label>
            <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M65" name="1471-2105-10-10-i47" overflow="scroll">
              <mml:semantics>
                <mml:mrow>
                  <mml:msub>
                    <mml:mover accent="true">
                      <mml:mover accent="true">
                        <mml:mi>μ</mml:mi>
                        <mml:mo>˜</mml:mo>
                      </mml:mover>
                      <mml:mo>^</mml:mo>
                    </mml:mover>
                    <mml:mi>s</mml:mi>
                  </mml:msub>
                  <mml:mo>:</mml:mo>
                  <mml:mo>=</mml:mo>
                  <mml:mi>E</mml:mi>
                  <mml:mo stretchy="false">[</mml:mo>
                  <mml:msub>
                    <mml:mover accent="true">
                      <mml:mtext>M</mml:mtext>
                      <mml:mo>˜</mml:mo>
                    </mml:mover>
                    <mml:mi>s</mml:mi>
                  </mml:msub>
                  <mml:mo>|</mml:mo>
                  <mml:mi mathvariant="bold-italic">y</mml:mi>
                  <mml:mo stretchy="false">]</mml:mo>
                  <mml:mo>.</mml:mo>
                </mml:mrow>
              </mml:semantics>
            </mml:math>
          </disp-formula>
        </p>
        <p>Unfortunately, the computation of this quantity requires time <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M66" name="1471-2105-10-10-i48" overflow="scroll"><mml:semantics><mml:mrow><mml:mi>O</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>n</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>max</mml:mi><mml:mo>⁡</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:semantics></mml:math></inline-formula> (see section "The dynamic program" in Additional file <xref ref-type="supplementary-material" rid="S2">2</xref>), hence it could be a problem with samples of big size. This new type of <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M67" name="1471-2105-10-10-i20" overflow="scroll"><mml:semantics><mml:mrow><mml:msub><mml:mover accent="true"><mml:mtext>M</mml:mtext><mml:mo>˜</mml:mo></mml:mover><mml:mi>s</mml:mi></mml:msub></mml:mrow></mml:semantics></mml:math></inline-formula> estimation is referred to as <italic>Bayesian Regression Curve Averaging over k </italic>(<italic>BRCAk</italic>).</p>
        <p>The same procedure cannot be applied for the level estimation, because in that case we need to know the partition of the whole interval.</p>
      </sec>
    </sec>
    <sec>
      <title>Properties of the hyper-parameter estimators and definition of new estimators</title>
      <p>In order to study the properties of the hyper-parameter estimators defined in Equations (9), (11) and (10), first we need to compute the moments of the data <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M68" name="1471-2105-10-10-i49" overflow="scroll"><mml:semantics><mml:mrow><mml:mi mathvariant="bold-italic">Y</mml:mi><mml:msub><mml:mo>|</mml:mo><mml:mrow><mml:mi>ν</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>ρ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:msub></mml:mrow></mml:semantics></mml:math></inline-formula>. In the following, we will denote with <italic>n</italic><sub><italic>q </italic></sub>the number of data points in the <italic>q</italic><sup><italic>th </italic></sup>segment.</p>
      <p>At first, let us consider only the data which belong to the <italic>q</italic><sup><italic>th </italic></sup>segment. From the hypothesis of the model, we know that</p>
      <p>
        <disp-formula>
          <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M69" name="1471-2105-10-10-i50" overflow="scroll">
            <mml:semantics>
              <mml:mrow>
                <mml:mtable columnalign="left">
                  <mml:mtr columnalign="left">
                    <mml:mtd columnalign="left">
                      <mml:mrow>
                        <mml:msub>
                          <mml:mi>Y</mml:mi>
                          <mml:mi>j</mml:mi>
                        </mml:msub>
                        <mml:msub>
                          <mml:mo>|</mml:mo>
                          <mml:mrow>
                            <mml:msub>
                              <mml:mi>M</mml:mi>
                              <mml:mi>q</mml:mi>
                            </mml:msub>
                            <mml:mo>,</mml:mo>
                            <mml:msup>
                              <mml:mi>σ</mml:mi>
                              <mml:mn>2</mml:mn>
                            </mml:msup>
                          </mml:mrow>
                        </mml:msub>
                      </mml:mrow>
                    </mml:mtd>
                    <mml:mtd columnalign="left">
                      <mml:mo>~</mml:mo>
                    </mml:mtd>
                    <mml:mtd columnalign="left">
                      <mml:mrow>
                        <mml:mtable>
                          <mml:mtr>
                            <mml:mtd>
                              <mml:mrow>
                                <mml:mi mathvariant="script">N</mml:mi>
                                <mml:mo stretchy="false">(</mml:mo>
                                <mml:msub>
                                  <mml:mtext>M</mml:mtext>
                                  <mml:mi>q</mml:mi>
                                </mml:msub>
                                <mml:mo>,</mml:mo>
                                <mml:msup>
                                  <mml:mi>σ</mml:mi>
                                  <mml:mn>2</mml:mn>
                                </mml:msup>
                                <mml:mo stretchy="false">)</mml:mo>
                              </mml:mrow>
                            </mml:mtd>
                            <mml:mtd>
                              <mml:mrow>
                                <mml:mi>j</mml:mi>
                                <mml:mo>=</mml:mo>
                                <mml:msub>
                                  <mml:mi>t</mml:mi>
                                  <mml:mrow>
                                    <mml:mi>q</mml:mi>
                                    <mml:mo>−</mml:mo>
                                    <mml:mn>1</mml:mn>
                                  </mml:mrow>
                                </mml:msub>
                                <mml:mo>+</mml:mo>
                                <mml:mn>1</mml:mn>
                                <mml:mo>,</mml:mo>
                                <mml:mn>...</mml:mn>
                                <mml:mo>,</mml:mo>
                                <mml:msub>
                                  <mml:mi>t</mml:mi>
                                  <mml:mi>q</mml:mi>
                                </mml:msub>
                              </mml:mrow>
                            </mml:mtd>
                          </mml:mtr>
                        </mml:mtable>
                      </mml:mrow>
                    </mml:mtd>
                  </mml:mtr>
                  <mml:mtr columnalign="left">
                    <mml:mtd columnalign="left">
                      <mml:mrow>
                        <mml:msub>
                          <mml:mi>M</mml:mi>
                          <mml:mi>q</mml:mi>
                        </mml:msub>
                        <mml:msub>
                          <mml:mo>|</mml:mo>
                          <mml:mrow>
                            <mml:mi>ν</mml:mi>
                            <mml:mo>,</mml:mo>
                            <mml:msup>
                              <mml:mi>ρ</mml:mi>
                              <mml:mn>2</mml:mn>
                            </mml:msup>
                          </mml:mrow>
                        </mml:msub>
                      </mml:mrow>
                    </mml:mtd>
                    <mml:mtd columnalign="left">
                      <mml:mo>~</mml:mo>
                    </mml:mtd>
                    <mml:mtd columnalign="left">
                      <mml:mrow>
                        <mml:mi mathvariant="script">N</mml:mi>
                        <mml:mo stretchy="false">(</mml:mo>
                        <mml:mi>ν</mml:mi>
                        <mml:mo>,</mml:mo>
                        <mml:msup>
                          <mml:mi>ρ</mml:mi>
                          <mml:mn>2</mml:mn>
                        </mml:msup>
                        <mml:mo stretchy="false">)</mml:mo>
                        <mml:mo>,</mml:mo>
                      </mml:mrow>
                    </mml:mtd>
                  </mml:mtr>
                </mml:mtable>
              </mml:mrow>
            </mml:semantics>
          </mml:math>
        </disp-formula>
      </p>
      <p>hence the marginal distribution of any two data points <italic>Y</italic><sub><italic>i </italic></sub>and <italic>Y</italic><sub><italic>j </italic></sub>belonging to the <italic>q</italic><sup><italic>th </italic></sup>segment is <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M70" name="1471-2105-10-10-i51" overflow="scroll"><mml:semantics><mml:mi mathvariant="script">N</mml:mi></mml:semantics></mml:math></inline-formula>(<bold>ν</bold>, Σ), where</p>
      <p>
        <disp-formula id="bmcM24">
          <label>(24)</label>
          <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M71" name="1471-2105-10-10-i52" overflow="scroll">
            <mml:semantics>
              <mml:mrow>
                <mml:mi>Σ</mml:mi>
                <mml:mo>=</mml:mo>
                <mml:mrow>
                  <mml:mo>[</mml:mo>
                  <mml:mrow>
                    <mml:mtable>
                      <mml:mtr>
                        <mml:mtd>
                          <mml:mrow>
                            <mml:msup>
                              <mml:mi>σ</mml:mi>
                              <mml:mn>2</mml:mn>
                            </mml:msup>
                            <mml:mo>+</mml:mo>
                            <mml:msup>
                              <mml:mi>ρ</mml:mi>
                              <mml:mn>2</mml:mn>
                            </mml:msup>
                          </mml:mrow>
                        </mml:mtd>
                        <mml:mtd>
                          <mml:mrow>
                            <mml:msup>
                              <mml:mi>ρ</mml:mi>
                              <mml:mn>2</mml:mn>
                            </mml:msup>
                          </mml:mrow>
                        </mml:mtd>
                      </mml:mtr>
                      <mml:mtr>
                        <mml:mtd>
                          <mml:mrow>
                            <mml:msup>
                              <mml:mi>ρ</mml:mi>
                              <mml:mn>2</mml:mn>
                            </mml:msup>
                          </mml:mrow>
                        </mml:mtd>
                        <mml:mtd>
                          <mml:mrow>
                            <mml:msup>
                              <mml:mi>σ</mml:mi>
                              <mml:mn>2</mml:mn>
                            </mml:msup>
                            <mml:mo>+</mml:mo>
                            <mml:msup>
                              <mml:mi>ρ</mml:mi>
                              <mml:mn>2</mml:mn>
                            </mml:msup>
                          </mml:mrow>
                        </mml:mtd>
                      </mml:mtr>
                    </mml:mtable>
                  </mml:mrow>
                  <mml:mo>]</mml:mo>
                </mml:mrow>
                <mml:mo>.</mml:mo>
              </mml:mrow>
            </mml:semantics>
          </mml:math>
        </disp-formula>
      </p>
      <p>It follows that the covariance between two data points, which belong to the same segment, is</p>
      <p>
        <disp-formula id="bmcM25"><label>(25)</label>Cov(<italic>Y</italic><sub><italic>i</italic></sub>, <italic>Y</italic><sub><italic>j</italic></sub>|<italic>ν</italic>, <italic>ρ</italic><sup>2</sup>, <italic>σ</italic><sup>2</sup>) = <italic>ρ</italic><sup>2 </sup><italic>i </italic>≠ <italic>j</italic>,</disp-formula>
      </p>
      <p>and</p>
      <p>
        <disp-formula id="bmcM26"><label>(26)</label><italic>E</italic>[<italic>Y</italic><sub><italic>j</italic></sub>|<italic>ν</italic>, <italic>ρ</italic><sup>2</sup>, <italic>σ</italic><sup>2</sup>] = <italic>ν</italic></disp-formula>
      </p>
      <p>
        <disp-formula id="bmcM27"><label>(27)</label>Var(<italic>Y</italic><sub><italic>j</italic></sub>|<italic>ν</italic>, <italic>ρ</italic><sup>2</sup>, <italic>σ</italic><sup>2</sup>) = <italic>σ</italic><sup>2 </sup>+ <italic>ρ</italic><sup>2</sup>,</disp-formula>
      </p>
      <p>for each <italic>j </italic>= 1,...,<italic>n</italic>, independently of the segment to which it belongs.</p>
      <p>Furthermore, from the hypotheses of the model, given the segmentation <bold><italic>t</italic></bold><sup>0</sup>, data points belonging to different segments are independent.</p>
      <sec>
        <title>Expected value and variance of the estimator <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M72" name="1471-2105-10-10-i53" overflow="scroll"><mml:semantics><mml:mover accent="true"><mml:mi>ν</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:semantics></mml:math></inline-formula></title>
        <p>The estimator of <italic>ν </italic>is defined as <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M73" name="1471-2105-10-10-i54" overflow="scroll"><mml:semantics><mml:mrow><mml:mover accent="true"><mml:mi>ν</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mover accent="true"><mml:mi>Y</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:mrow></mml:semantics></mml:math></inline-formula> (see Equation (9)). From Equation (26), we can see that this estimator is unbiased and its variance turns out to be</p>
        <p>
          <disp-formula id="bmcM28">
            <label>(28)</label>
            <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M74" name="1471-2105-10-10-i55" overflow="scroll">
              <mml:semantics>
                <mml:mrow>
                  <mml:mtext>Var</mml:mtext>
                  <mml:mo stretchy="false">[</mml:mo>
                  <mml:mover accent="true">
                    <mml:mi>Y</mml:mi>
                    <mml:mo>¯</mml:mo>
                  </mml:mover>
                  <mml:mo stretchy="false">]</mml:mo>
                  <mml:mo>=</mml:mo>
                  <mml:mfrac>
                    <mml:mrow>
                      <mml:msup>
                        <mml:mi>σ</mml:mi>
                        <mml:mn>2</mml:mn>
                      </mml:msup>
                    </mml:mrow>
                    <mml:mi>n</mml:mi>
                  </mml:mfrac>
                  <mml:mo>+</mml:mo>
                  <mml:msup>
                    <mml:mi>ρ</mml:mi>
                    <mml:mn>2</mml:mn>
                  </mml:msup>
                  <mml:mfrac>
                    <mml:mrow>
                      <mml:mstyle displaystyle="true">
                        <mml:msubsup>
                          <mml:mo>∑</mml:mo>
                          <mml:mrow>
                            <mml:mi>p</mml:mi>
                            <mml:mo>=</mml:mo>
                            <mml:mn>1</mml:mn>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:msub>
                              <mml:mi>k</mml:mi>
                              <mml:mn>0</mml:mn>
                            </mml:msub>
                          </mml:mrow>
                        </mml:msubsup>
                        <mml:mrow>
                          <mml:msubsup>
                            <mml:mi>n</mml:mi>
                            <mml:mi>p</mml:mi>
                            <mml:mn>2</mml:mn>
                          </mml:msubsup>
                        </mml:mrow>
                      </mml:mstyle>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:msup>
                        <mml:mi>n</mml:mi>
                        <mml:mn>2</mml:mn>
                      </mml:msup>
                    </mml:mrow>
                  </mml:mfrac>
                  <mml:mo>.</mml:mo>
                </mml:mrow>
              </mml:semantics>
            </mml:math>
          </disp-formula>
        </p>
        <p>Hence, the variance is always greater than <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M75" name="1471-2105-10-10-i56" overflow="scroll"><mml:semantics><mml:mrow><mml:mi>O</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:msup><mml:mi>ρ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:semantics></mml:math></inline-formula>, even if we use a denser sampling, i.e. we augment the number of data points in the interval in which we are estimating the piecewise constant function.</p>
      </sec>
      <sec>
        <title>New definition of the estimator <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M76" name="1471-2105-10-10-i57" overflow="scroll"><mml:semantics><mml:mrow><mml:mover accent="true"><mml:mrow><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mo stretchy="true">^</mml:mo></mml:mover></mml:mrow></mml:semantics></mml:math></inline-formula> and its expected value</title>
        <p>A circular version of the <italic>σ</italic><sup>2 </sup>estimator defined in Equation (11) is</p>
        <p>
          <disp-formula id="bmcM29">
            <label>(29)</label>
            <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M77" name="1471-2105-10-10-i58" overflow="scroll">
              <mml:semantics>
                <mml:mrow>
                  <mml:mover accent="true">
                    <mml:mrow>
                      <mml:msup>
                        <mml:mi>σ</mml:mi>
                        <mml:mn>2</mml:mn>
                      </mml:msup>
                    </mml:mrow>
                    <mml:mo stretchy="true">^</mml:mo>
                  </mml:mover>
                  <mml:mo>:</mml:mo>
                  <mml:mo>=</mml:mo>
                  <mml:mfrac>
                    <mml:mn>1</mml:mn>
                    <mml:mrow>
                      <mml:mn>2</mml:mn>
                      <mml:mi>n</mml:mi>
                    </mml:mrow>
                  </mml:mfrac>
                  <mml:mstyle displaystyle="true">
                    <mml:munderover>
                      <mml:mo>∑</mml:mo>
                      <mml:mrow>
                        <mml:mi>i</mml:mi>
                        <mml:mo>=</mml:mo>
                        <mml:mn>1</mml:mn>
                      </mml:mrow>
                      <mml:mi>n</mml:mi>
                    </mml:munderover>
                    <mml:mrow>
                      <mml:msup>
                        <mml:mrow>
                          <mml:mo stretchy="false">(</mml:mo>
                          <mml:msub>
                            <mml:mi>Y</mml:mi>
                            <mml:mrow>
                              <mml:mi>i</mml:mi>
                              <mml:mo>+</mml:mo>
                              <mml:mn>1</mml:mn>
                            </mml:mrow>
                          </mml:msub>
                          <mml:mo>−</mml:mo>
                          <mml:msub>
                            <mml:mi>Y</mml:mi>
                            <mml:mi>i</mml:mi>
                          </mml:msub>
                          <mml:mo stretchy="false">)</mml:mo>
                        </mml:mrow>
                        <mml:mn>2</mml:mn>
                      </mml:msup>
                    </mml:mrow>
                  </mml:mstyle>
                  <mml:mo>,</mml:mo>
                </mml:mrow>
              </mml:semantics>
            </mml:math>
          </disp-formula>
        </p>
        <p>where <italic>Y</italic><sub><italic>n</italic>+1 </sub>:= <italic>Y</italic><sub>1</sub>. Using the values of the moments of the data points, its expected value is</p>
        <p>
          <disp-formula id="bmcM30">
            <label>(30)</label>
            <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M78" name="1471-2105-10-10-i59" overflow="scroll">
              <mml:semantics>
                <mml:mrow>
                  <mml:mi>E</mml:mi>
                  <mml:mover accent="true">
                    <mml:mrow>
                      <mml:mo stretchy="false">[</mml:mo>
                      <mml:msup>
                        <mml:mi>σ</mml:mi>
                        <mml:mn>2</mml:mn>
                      </mml:msup>
                      <mml:mo stretchy="false">]</mml:mo>
                    </mml:mrow>
                    <mml:mo stretchy="true">^</mml:mo>
                  </mml:mover>
                  <mml:mo>=</mml:mo>
                  <mml:msup>
                    <mml:mi>σ</mml:mi>
                    <mml:mn>2</mml:mn>
                  </mml:msup>
                  <mml:mo>+</mml:mo>
                  <mml:msup>
                    <mml:mi>ρ</mml:mi>
                    <mml:mn>2</mml:mn>
                  </mml:msup>
                  <mml:mfrac>
                    <mml:mrow>
                      <mml:msub>
                        <mml:mi>k</mml:mi>
                        <mml:mn>0</mml:mn>
                      </mml:msub>
                    </mml:mrow>
                    <mml:mi>n</mml:mi>
                  </mml:mfrac>
                  <mml:msub>
                    <mml:mi mathvariant="double-struck">I</mml:mi>
                    <mml:mrow>
                      <mml:mo>{</mml:mo>
                      <mml:msub>
                        <mml:mi>k</mml:mi>
                        <mml:mn>0</mml:mn>
                      </mml:msub>
                      <mml:mo>≥</mml:mo>
                      <mml:mn>2</mml:mn>
                      <mml:mo>}</mml:mo>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mo>,</mml:mo>
                </mml:mrow>
              </mml:semantics>
            </mml:math>
          </disp-formula>
        </p>
        <p>where we considered two cases in the computation: (a) when <italic>k</italic><sub>0 </sub>= 1, <italic>Y</italic><sub>1 </sub>and <italic>Y</italic><sub><italic>n </italic></sub>belong to the same segment (thus they are dependent), (b) when <italic>k</italic><sub>0 </sub>≥ 2, we supposed that the first and the last segments have different levels and so <italic>Y</italic><sub>1 </sub>and <italic>Y</italic><sub><italic>n </italic></sub>are independent. If the first and the last segments had the same level, then the two segments would be joined together and thus <italic>Y</italic><sub>1 </sub>and <italic>Y</italic><sub><italic>n </italic></sub>would be dependent. In this case, the expected value would be the same but with <italic>k</italic><sub>0 </sub>- 1 instead of <italic>k</italic><sub>0</sub>, since the number of segments would be <italic>k</italic><sub>0 </sub>- 1. In any case, for <italic>k</italic><sub>0 </sub>= 1, the estimator <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M79" name="1471-2105-10-10-i57" overflow="scroll"><mml:semantics><mml:mrow><mml:mover accent="true"><mml:mrow><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mo stretchy="true">^</mml:mo></mml:mover></mml:mrow></mml:semantics></mml:math></inline-formula> is unbiased, while for <italic>k</italic><sub>0 </sub>≪ <italic>n </italic>but <italic>k</italic><sub>0 </sub>≠ 1, <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M80" name="1471-2105-10-10-i57" overflow="scroll"><mml:semantics><mml:mrow><mml:mover accent="true"><mml:mrow><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mo stretchy="true">^</mml:mo></mml:mover></mml:mrow></mml:semantics></mml:math></inline-formula> is almost unbiased.</p>
      </sec>
      <sec>
        <title>Expected value of the estimator <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M81" name="1471-2105-10-10-i60" overflow="scroll"><mml:semantics><mml:mrow><mml:mover accent="true"><mml:mrow><mml:msup><mml:mi>ρ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mo stretchy="true">^</mml:mo></mml:mover></mml:mrow></mml:semantics></mml:math></inline-formula></title>
        <p>The expected value of the estimator <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M82" name="1471-2105-10-10-i60" overflow="scroll"><mml:semantics><mml:mrow><mml:mover accent="true"><mml:mrow><mml:msup><mml:mi>ρ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mo stretchy="true">^</mml:mo></mml:mover></mml:mrow></mml:semantics></mml:math></inline-formula> (defined in Equation (10)) is</p>
        <p>
          <disp-formula id="bmcM31">
            <label>(31)</label>
            <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M83" name="1471-2105-10-10-i61" overflow="scroll">
              <mml:semantics>
                <mml:mrow>
                  <mml:mi>E</mml:mi>
                  <mml:mo stretchy="false">[</mml:mo>
                  <mml:mover accent="true">
                    <mml:mrow>
                      <mml:msup>
                        <mml:mi>ρ</mml:mi>
                        <mml:mn>2</mml:mn>
                      </mml:msup>
                    </mml:mrow>
                    <mml:mo stretchy="true">^</mml:mo>
                  </mml:mover>
                  <mml:mo stretchy="false">]</mml:mo>
                  <mml:mo>=</mml:mo>
                  <mml:msup>
                    <mml:mi>σ</mml:mi>
                    <mml:mn>2</mml:mn>
                  </mml:msup>
                  <mml:mrow>
                    <mml:mo>(</mml:mo>
                    <mml:mrow>
                      <mml:mn>1</mml:mn>
                      <mml:mo>−</mml:mo>
                      <mml:mfrac>
                        <mml:mn>1</mml:mn>
                        <mml:mi>n</mml:mi>
                      </mml:mfrac>
                    </mml:mrow>
                    <mml:mo>)</mml:mo>
                  </mml:mrow>
                  <mml:mo>+</mml:mo>
                  <mml:msup>
                    <mml:mi>ρ</mml:mi>
                    <mml:mn>2</mml:mn>
                  </mml:msup>
                  <mml:mrow>
                    <mml:mo>(</mml:mo>
                    <mml:mrow>
                      <mml:mn>1</mml:mn>
                      <mml:mo>−</mml:mo>
                      <mml:mfrac>
                        <mml:mrow>
                          <mml:mstyle displaystyle="true">
                            <mml:msubsup>
                              <mml:mo>∑</mml:mo>
                              <mml:mrow>
                                <mml:mi>p</mml:mi>
                                <mml:mo>=</mml:mo>
                                <mml:mn>1</mml:mn>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:msub>
                                  <mml:mi>k</mml:mi>
                                  <mml:mn>0</mml:mn>
                                </mml:msub>
                              </mml:mrow>
                            </mml:msubsup>
                            <mml:mrow>
                              <mml:msubsup>
                                <mml:mi>n</mml:mi>
                                <mml:mi>p</mml:mi>
                                <mml:mn>2</mml:mn>
                              </mml:msubsup>
                            </mml:mrow>
                          </mml:mstyle>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:msup>
                            <mml:mi>n</mml:mi>
                            <mml:mn>2</mml:mn>
                          </mml:msup>
                        </mml:mrow>
                      </mml:mfrac>
                    </mml:mrow>
                    <mml:mo>)</mml:mo>
                  </mml:mrow>
                  <mml:mo>.</mml:mo>
                </mml:mrow>
              </mml:semantics>
            </mml:math>
          </disp-formula>
        </p>
        <p>Note that when <italic>k</italic><sub>0 </sub>= 1 (i.e. having only one segment), <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M84" name="1471-2105-10-10-i62" overflow="scroll"><mml:semantics><mml:mrow><mml:mi>E</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mover accent="true"><mml:mrow><mml:msup><mml:mi>ρ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mo stretchy="false">]</mml:mo><mml:mo>=</mml:mo><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>n</mml:mi></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:semantics></mml:math></inline-formula>. In this degenerate case, the variance of the segment levels <italic>ρ</italic><sup>2 </sup>should be estimated with zero but <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M85" name="1471-2105-10-10-i60" overflow="scroll"><mml:semantics><mml:mrow><mml:mover accent="true"><mml:mrow><mml:msup><mml:mi>ρ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mo stretchy="true">^</mml:mo></mml:mover></mml:mrow></mml:semantics></mml:math></inline-formula> estimates it with the variance of the data points.</p>
        <p>Moreover, since <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M86" name="1471-2105-10-10-i63" overflow="scroll"><mml:semantics><mml:mrow><mml:mstyle displaystyle="true"><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>p</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:msubsup><mml:mrow><mml:msubsup><mml:mi>n</mml:mi><mml:mi>p</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:mstyle><mml:mo>≥</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:semantics></mml:math></inline-formula> (the equality holds only when <italic>k</italic><sub>0 </sub>= <italic>n</italic>), we obtain that</p>
        <p>
          <disp-formula id="bmcM32">
            <label>(32)</label>
            <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M87" name="1471-2105-10-10-i64" overflow="scroll">
              <mml:semantics>
                <mml:mrow>
                  <mml:msup>
                    <mml:mi>σ</mml:mi>
                    <mml:mn>2</mml:mn>
                  </mml:msup>
                  <mml:mrow>
                    <mml:mo>(</mml:mo>
                    <mml:mrow>
                      <mml:mn>1</mml:mn>
                      <mml:mo>−</mml:mo>
                      <mml:mfrac>
                        <mml:mn>1</mml:mn>
                        <mml:mi>n</mml:mi>
                      </mml:mfrac>
                    </mml:mrow>
                    <mml:mo>)</mml:mo>
                  </mml:mrow>
                  <mml:mo>≤</mml:mo>
                  <mml:mi>E</mml:mi>
                  <mml:mo stretchy="false">[</mml:mo>
                  <mml:mover accent="true">
                    <mml:mrow>
                      <mml:msup>
                        <mml:mi>ρ</mml:mi>
                        <mml:mn>2</mml:mn>
                      </mml:msup>
                    </mml:mrow>
                    <mml:mo stretchy="true">^</mml:mo>
                  </mml:mover>
                  <mml:mo stretchy="false">]</mml:mo>
                  <mml:mo>≤</mml:mo>
                  <mml:mrow>
                    <mml:mo>(</mml:mo>
                    <mml:mrow>
                      <mml:mn>1</mml:mn>
                      <mml:mo>−</mml:mo>
                      <mml:mfrac>
                        <mml:mn>1</mml:mn>
                        <mml:mi>n</mml:mi>
                      </mml:mfrac>
                    </mml:mrow>
                    <mml:mo>)</mml:mo>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mo>(</mml:mo>
                    <mml:mrow>
                      <mml:msup>
                        <mml:mi>σ</mml:mi>
                        <mml:mn>2</mml:mn>
                      </mml:msup>
                      <mml:mo>+</mml:mo>
                      <mml:msup>
                        <mml:mi>ρ</mml:mi>
                        <mml:mn>2</mml:mn>
                      </mml:msup>
                    </mml:mrow>
                    <mml:mo>)</mml:mo>
                  </mml:mrow>
                  <mml:mo>.</mml:mo>
                </mml:mrow>
              </mml:semantics>
            </mml:math>
          </disp-formula>
        </p>
        <p>Hence, if <italic>n </italic>is large the expected value is between <italic>σ</italic><sup>2 </sup>and <italic>σ</italic><sup>2 </sup>+ <italic>ρ</italic><sup>2</sup>, so that, if <italic>ρ</italic><sup>2 </sup>≪ <italic>σ</italic><sup>2</sup>, the estimator is almost unbiased for <italic>σ</italic><sup>2 </sup>(instead of <italic>ρ</italic><sup>2</sup>).</p>
      </sec>
      <sec>
        <title>Definition of alternative estimator of <italic>ρ</italic><sup>2</sup>: <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M88" name="1471-2105-10-10-i65" overflow="scroll"><mml:semantics><mml:mrow><mml:mover accent="true"><mml:mrow><mml:msubsup><mml:mi>ρ</mml:mi><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:msubsup></mml:mrow><mml:mo stretchy="true">^</mml:mo></mml:mover></mml:mrow></mml:semantics></mml:math></inline-formula></title>
        <p>Since the covariance between data points belonging to the same segment is <italic>ρ</italic><sup>2</sup>, we could try to use a circular version of the estimator of the autocovariance of a stationary time series</p>
        <p>
          <disp-formula id="bmcM33">
            <label>(33)</label>
            <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M89" name="1471-2105-10-10-i66" overflow="scroll">
              <mml:semantics>
                <mml:mrow>
                  <mml:mover accent="true">
                    <mml:mrow>
                      <mml:msubsup>
                        <mml:mi>ρ</mml:mi>
                        <mml:mn>1</mml:mn>
                        <mml:mn>2</mml:mn>
                      </mml:msubsup>
                    </mml:mrow>
                    <mml:mo stretchy="true">^</mml:mo>
                  </mml:mover>
                  <mml:mo>:</mml:mo>
                  <mml:mo>=</mml:mo>
                  <mml:mfrac>
                    <mml:mn>1</mml:mn>
                    <mml:mi>n</mml:mi>
                  </mml:mfrac>
                  <mml:mstyle displaystyle="true">
                    <mml:munderover>
                      <mml:mo>∑</mml:mo>
                      <mml:mrow>
                        <mml:mi>i</mml:mi>
                        <mml:mo>=</mml:mo>
                        <mml:mn>1</mml:mn>
                      </mml:mrow>
                      <mml:mi>n</mml:mi>
                    </mml:munderover>
                    <mml:mrow>
                      <mml:mo stretchy="false">(</mml:mo>
                      <mml:msub>
                        <mml:mi>Y</mml:mi>
                        <mml:mi>i</mml:mi>
                      </mml:msub>
                      <mml:mo>−</mml:mo>
                      <mml:mover accent="true">
                        <mml:mi>Y</mml:mi>
                        <mml:mo>¯</mml:mo>
                      </mml:mover>
                      <mml:mo stretchy="false">)</mml:mo>
                      <mml:mo stretchy="false">(</mml:mo>
                      <mml:msub>
                        <mml:mi>Y</mml:mi>
                        <mml:mrow>
                          <mml:mi>i</mml:mi>
                          <mml:mo>+</mml:mo>
                          <mml:mn>1</mml:mn>
                        </mml:mrow>
                      </mml:msub>
                      <mml:mo>−</mml:mo>
                      <mml:mover accent="true">
                        <mml:mi>Y</mml:mi>
                        <mml:mo>¯</mml:mo>
                      </mml:mover>
                      <mml:mo stretchy="false">)</mml:mo>
                      <mml:mo>,</mml:mo>
                    </mml:mrow>
                  </mml:mstyle>
                </mml:mrow>
              </mml:semantics>
            </mml:math>
          </disp-formula>
        </p>
        <p>where <italic>Y</italic><sub><italic>n</italic>+1 </sub>:= <italic>Y</italic><sub>1</sub>. The expected value of the estimator turns out to be</p>
        <p>
          <disp-formula id="bmcM34">
            <label>(34)</label>
            <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M90" name="1471-2105-10-10-i67" overflow="scroll">
              <mml:semantics>
                <mml:mrow>
                  <mml:mi>E</mml:mi>
                  <mml:mo stretchy="false">[</mml:mo>
                  <mml:mover accent="true">
                    <mml:mrow>
                      <mml:msubsup>
                        <mml:mi>ρ</mml:mi>
                        <mml:mn>1</mml:mn>
                        <mml:mn>2</mml:mn>
                      </mml:msubsup>
                    </mml:mrow>
                    <mml:mo stretchy="true">^</mml:mo>
                  </mml:mover>
                  <mml:mo stretchy="false">]</mml:mo>
                  <mml:mo>=</mml:mo>
                  <mml:mrow>
                    <mml:mo>{</mml:mo>
                    <mml:mrow>
                      <mml:mtable columnalign="left">
                        <mml:mtr columnalign="left">
                          <mml:mtd columnalign="left">
                            <mml:mrow>
                              <mml:mo>−</mml:mo>
                              <mml:mfrac>
                                <mml:mrow>
                                  <mml:msup>
                                    <mml:mi>σ</mml:mi>
                                    <mml:mn>2</mml:mn>
                                  </mml:msup>
                                </mml:mrow>
                                <mml:mi>n</mml:mi>
                              </mml:mfrac>
                            </mml:mrow>
                          </mml:mtd>
                          <mml:mtd columnalign="left">
                            <mml:mrow>
                              <mml:mtext>if </mml:mtext>
                              <mml:msub>
                                <mml:mi>k</mml:mi>
                                <mml:mn>0</mml:mn>
                              </mml:msub>
                              <mml:mo>=</mml:mo>
                              <mml:mn>1</mml:mn>
                            </mml:mrow>
                          </mml:mtd>
                        </mml:mtr>
                        <mml:mtr columnalign="left">
                          <mml:mtd columnalign="left">
                            <mml:mrow>
                              <mml:mfrac>
                                <mml:mrow>
                                  <mml:msup>
                                    <mml:mi>ρ</mml:mi>
                                    <mml:mn>2</mml:mn>
                                  </mml:msup>
                                </mml:mrow>
                                <mml:mi>n</mml:mi>
                              </mml:mfrac>
                              <mml:mrow>
                                <mml:mo>(</mml:mo>
                                <mml:mrow>
                                  <mml:mi>n</mml:mi>
                                  <mml:mo>−</mml:mo>
                                  <mml:msub>
                                    <mml:mi>k</mml:mi>
                                    <mml:mn>0</mml:mn>
                                  </mml:msub>
                                  <mml:mo>−</mml:mo>
                                  <mml:mfrac>
                                    <mml:mrow>
                                      <mml:mstyle displaystyle="true">
                                        <mml:msubsup>
                                          <mml:mo>∑</mml:mo>
                                          <mml:mrow>
                                            <mml:mi>p</mml:mi>
                                            <mml:mo>=</mml:mo>
                                            <mml:mn>1</mml:mn>
                                          </mml:mrow>
                                          <mml:mrow>
                                            <mml:msub>
                                              <mml:mi>k</mml:mi>
                                              <mml:mn>0</mml:mn>
                                            </mml:msub>
                                          </mml:mrow>
                                        </mml:msubsup>
                                        <mml:mrow>
                                          <mml:msubsup>
                                            <mml:mi>n</mml:mi>
                                            <mml:mi>p</mml:mi>
                                            <mml:mn>2</mml:mn>
                                          </mml:msubsup>
                                        </mml:mrow>
                                      </mml:mstyle>
                                    </mml:mrow>
                                    <mml:mi>n</mml:mi>
                                  </mml:mfrac>
                                </mml:mrow>
                                <mml:mo>)</mml:mo>
                              </mml:mrow>
                              <mml:mo>−</mml:mo>
                              <mml:mfrac>
                                <mml:mrow>
                                  <mml:msup>
                                    <mml:mi>σ</mml:mi>
                                    <mml:mn>2</mml:mn>
                                  </mml:msup>
                                </mml:mrow>
                                <mml:mi>n</mml:mi>
                              </mml:mfrac>
                            </mml:mrow>
                          </mml:mtd>
                          <mml:mtd columnalign="left">
                            <mml:mrow>
                              <mml:mtext>if </mml:mtext>
                              <mml:msub>
                                <mml:mi>k</mml:mi>
                                <mml:mn>0</mml:mn>
                              </mml:msub>
                              <mml:mo>≥</mml:mo>
                              <mml:mn>2.</mml:mn>
                            </mml:mrow>
                          </mml:mtd>
                        </mml:mtr>
                      </mml:mtable>
                    </mml:mrow>
                  </mml:mrow>
                </mml:mrow>
              </mml:semantics>
            </mml:math>
          </disp-formula>
        </p>
        <p>In the computation we considered two cases: <italic>k</italic><sub>0 </sub>= 1 and <italic>k</italic><sub>0 </sub>≥ 2. When <italic>k</italic><sub>0 </sub>= 1, <italic>Y</italic><sub>1 </sub>and <italic>Y</italic><sub><italic>n </italic></sub>belong to the same segment and so they are dependent; when <italic>k</italic><sub>0 </sub>≥ 2, we suppose that the first and the last segment have not the same level value and so <italic>Y</italic><sub>1 </sub>and <italic>Y</italic><sub><italic>n </italic></sub>are independent. If <italic>k</italic><sub>0 </sub>≥ 2 and the first and the last segment had the same level value (event with a very low probability), then the first and the last segments would be joined together and so <italic>Y</italic><sub>1 </sub>and <italic>Y</italic><sub><italic>n </italic></sub>would be dependent. In this case, the expected value of the estimator would have the same formula, but with <italic>k</italic><sub>0 </sub>- 1 instead of <italic>k</italic><sub>0</sub>.</p>
        <p>We can observe that, when <italic>k</italic><sub>0 </sub>= 1, the expected value is negative, while, when <italic>k</italic><sub>0 </sub>≥ 2, it can be negative or positive. Moreover, the coefficient of <italic>σ</italic><sup>2 </sup>is <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M91" name="1471-2105-10-10-i68" overflow="scroll"><mml:semantics><mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>n</mml:mi></mml:mfrac></mml:mrow></mml:semantics></mml:math></inline-formula> and so this addendum does not contribute so much to the unbiasedness of the estimator.</p>
        <p>The negativity of the expected value happens because the estimator is a generic estimator of the covariance and, in general, this quantity can be negative. To prevent the negativity of the estimator, we can use its absolute value. In this way, when the quantity in (33) is negative, we use the same estimator but with the sign changed in one of the factors of each product, <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M92" name="1471-2105-10-10-i69" overflow="scroll"><mml:semantics><mml:mrow><mml:mover accent="true"><mml:mrow><mml:msubsup><mml:mi>ρ</mml:mi><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:msubsup></mml:mrow><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>n</mml:mi></mml:mfrac><mml:mstyle displaystyle="true"><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>Y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mover accent="true"><mml:mi>Y</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mover accent="true"><mml:mi>Y</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mo>−</mml:mo><mml:msub><mml:mi>Y</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:mrow></mml:semantics></mml:math></inline-formula>. Hence, the meaning of the estimator is the same. We are interested only in the absolute value of the estimate and not in its sign. In fact, we already know that the correlation is positive and the negativity of the estimate is due only to the property of the estimator. Our final definition of the estimator is then</p>
        <p>
          <disp-formula id="bmcM35">
            <label>(35)</label>
            <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M93" name="1471-2105-10-10-i70" overflow="scroll">
              <mml:semantics>
                <mml:mrow>
                  <mml:mover accent="true">
                    <mml:mrow>
                      <mml:msubsup>
                        <mml:mi>ρ</mml:mi>
                        <mml:mn>1</mml:mn>
                        <mml:mn>2</mml:mn>
                      </mml:msubsup>
                    </mml:mrow>
                    <mml:mo stretchy="true">^</mml:mo>
                  </mml:mover>
                  <mml:mo>:</mml:mo>
                  <mml:mo>=</mml:mo>
                  <mml:mfrac>
                    <mml:mn>1</mml:mn>
                    <mml:mi>n</mml:mi>
                  </mml:mfrac>
                  <mml:mrow>
                    <mml:mo>|</mml:mo>
                    <mml:mrow>
                      <mml:mstyle displaystyle="true">
                        <mml:munderover>
                          <mml:mo>∑</mml:mo>
                          <mml:mrow>
                            <mml:mi>i</mml:mi>
                            <mml:mo>=</mml:mo>
                            <mml:mn>1</mml:mn>
                          </mml:mrow>
                          <mml:mi>n</mml:mi>
                        </mml:munderover>
                        <mml:mrow>
                          <mml:mo stretchy="false">(</mml:mo>
                          <mml:msub>
                            <mml:mi>Y</mml:mi>
                            <mml:mi>i</mml:mi>
                          </mml:msub>
                          <mml:mo>−</mml:mo>
                          <mml:mover accent="true">
                            <mml:mi>Y</mml:mi>
                            <mml:mo>¯</mml:mo>
                          </mml:mover>
                          <mml:mo stretchy="false">)</mml:mo>
                          <mml:mo stretchy="false">(</mml:mo>
                          <mml:msub>
                            <mml:mi>Y</mml:mi>
                            <mml:mrow>
                              <mml:mi>i</mml:mi>
                              <mml:mo>+</mml:mo>
                              <mml:mn>1</mml:mn>
                            </mml:mrow>
                          </mml:msub>
                          <mml:mo>−</mml:mo>
                          <mml:mover accent="true">
                            <mml:mi>Y</mml:mi>
                            <mml:mo>¯</mml:mo>
                          </mml:mover>
                          <mml:mo stretchy="false">)</mml:mo>
                        </mml:mrow>
                      </mml:mstyle>
                    </mml:mrow>
                    <mml:mo>|</mml:mo>
                  </mml:mrow>
                  <mml:mo>.</mml:mo>
                </mml:mrow>
              </mml:semantics>
            </mml:math>
          </disp-formula>
        </p>
      </sec>
    </sec>
  </sec>
  <sec>
    <title>Results and discussion</title>
    <p>In this section we show and discuss results obtained on both the simulated and the real data. We used the simulated data with a twofold aim. The first was to choose empirically the best estimators among those proposed in the previous section. The second was to compare the original version of BPCR/BRC and their modified versions with each other and with other existing methods estimating DNA copy number value [<xref ref-type="bibr" rid="B2">2</xref>-<xref ref-type="bibr" rid="B10">10</xref>]. On the basis of the results, we selected the best modified version of BPCR, called mBPCR, and of BRC.</p>
    <p>Finally, we compared the performance of mBPCR, CBS, CGHseg, GLAD, HMM, BioHMM and Rendersome on the real data.</p>
    <sec>
      <title>Simulation description</title>
      <p>In the comparisons, we used several types of artificial data. We call <italic>sample </italic>a sequence of data which represents the copy number data of a genomic region, we call <italic>dataset </italic>a set of samples, while <italic>collection </italic>a set of datasets.</p>
      <p>In order to experimentally evaluate the behavior of all the estimators proposed, we used the artificial datasets sampled from the priors, defined in the hypotheses of the model. We always chose <italic>ν </italic>= 0.2, while we changed the values of <italic>σ</italic><sup>2 </sup>and <italic>ρ</italic><sup>2 </sup>for each dataset, in order to study different situations of noise (some examples of data are in Figure <xref ref-type="fig" rid="F1">1</xref> and the corresponding estimated profiles obtained applying several methods are in Figure S.1 in Additional file <xref ref-type="supplementary-material" rid="S2">2</xref>). The most problematic cases were the ones with <italic>ρ</italic><sup>2 </sup>&lt;<italic>σ</italic><sup>2 </sup>(i.e. when the variance of the noise was higher than the variance of the segment levels), because in these cases it was hard to identify the true profile of the levels. We always used <italic>n </italic>= 200, similar to the mean number of probes of a small chromosome in the Affymetrix GeneChip Mapping 10K Array (hence it represented a difficult case due to the small sample size), and <italic>k</italic><sub>max </sub>= 40, in order to have at least 5 probes per segment on average.</p>
      <fig position="float" id="F1">
        <label>Figure 1</label>
        <caption>
          <p><bold>Example of simulated data</bold>. The simulated data in the figure represent an easy, medium and difficult case, respectively.</p>
        </caption>
        <graphic xlink:href="1471-2105-10-10-1"/>
      </fig>
      <p>Sometimes we needed datasets where all samples had the same true profile of the segment levels (i.e. <italic>K</italic>, <bold><italic>T </italic></bold>and <bold><italic>M </italic></bold>were sampled one time and only the noise varied in all samples). This type of dataset is called <italic>dataset with replicates</italic>. Otherwise, the dataset is called <italic>without replicates </italic>(i.e. each time we sampled <italic>K</italic>, <bold><italic>T</italic></bold>, <bold><italic>M </italic></bold>and added the noise to the profile). The number of samples per dataset was 100, for datasets with replicates, and 300 otherwise. We considered datasets with replicates in order to be able to compare the goodness of different types of estimations for a given profile.</p>
      <p>We also compared the behavior of our boundary estimators using the artificial dataset already employed in [<xref ref-type="bibr" rid="B13">13</xref>], where three methods for copy number estimation were examined. This dataset contained 500 samples consisting of 20 chromosomes, each of 100 probes, which emulated the real copy number data. This dataset is referred to as <italic>Simulated Chromosomes</italic>.</p>
      <p>To assess the performance of the several methods, we used three types of artificial datasets. The first type consisted of four datasets with replicates used in the comparison among the estimators. This collection of datasets is called <italic>Cases</italic>.</p>
      <p>The second type consisted of datasets adapted from the datasets used in [<xref ref-type="bibr" rid="B14">14</xref>] to compare several methods for copy number estimation. In these datasets, each sample was an artificial chromosome of 100 probes, where the copy number value was zero apart from the central part where there was an aberration. The Authors considered several widths of aberration: 40, 20, 10 and 5 probes. The noise was always distributed as <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M94" name="1471-2105-10-10-i51" overflow="scroll"><mml:semantics><mml:mi mathvariant="script">N</mml:mi></mml:semantics></mml:math></inline-formula>(0, 0.25<sup>2</sup>), while the signal to noise ratio (SNR) was 4, 3, 2 or 1. The SNR was defined as the ratio between the height of the aberration and the standard deviation of the noise. The data of the paper consisted of datasets of 100 samples for each combination of width and SNR.</p>
      <p>We defined our datasets in the following way. For a fixed SNR value, we constructed a chromosome with four aberrations of width of 40, 20, 10 and 5 probes, respectively, by joining the corresponding four types of chromosome of the previous datasets. This collection of datasets is called <italic>Four aberrations</italic>. In the following, we will consider only the datasets with SNR = 3 (medium noise) and SNR = 1 (high noise).</p>
      <p>The third type of dataset used was the <italic>Simulated Chromosomes </italic>dataset.</p>
    </sec>
    <sec>
      <title>Comparison among the estimators on simulated data</title>
      <p>In this subsection, we present how we selected the best estimators among those proposed in the Section Methods, on the basis of their results obtained on the artificial datasets. The comparisons were accomplished using both the true and the estimated values of the other parameters involved in the estimation.</p>
      <sec>
        <title>Comparison among the hyper-parameter estimators</title>
        <p>We applied the hyper-parameter estimators on 8 datasets without replicates, considering different values for <italic>σ</italic><sup>2 </sup>and <italic>ρ</italic><sup>2</sup>. To evaluate the behavior of the hyper-parameter estimators in all these cases, for each dataset we computed the (estimated) Mean Square Error, MSE, with respect to the true value of the parameter (Table <xref ref-type="table" rid="T1">1</xref>). To measure the accuracy of the estimators, we used the estimated mean relative error over all datasets (Table S.1 in Additional file <xref ref-type="supplementary-material" rid="S2">2</xref>).</p>
        <table-wrap position="float" id="T1">
          <label>Table 1</label>
          <caption>
            <p>Comparison among the hyper-parameter estimators</p>
          </caption>
          <table frame="hsides" rules="groups">
            <thead>
              <tr>
                <td/>
                <td align="center"><italic>σ</italic><sup>2 </sup>= 0.1</td>
                <td align="center"><italic>σ</italic><sup>2 </sup>= 0.3</td>
                <td align="center"><italic>σ</italic><sup>2 </sup>= 0.5</td>
                <td align="center"><italic>σ</italic><sup>2 </sup>= 0.5</td>
                <td align="center"><italic>σ</italic><sup>2 </sup>= 0.5</td>
                <td align="center"><italic>σ</italic><sup>2 </sup>= 0.7</td>
                <td align="center"><italic>σ</italic><sup>2 </sup>= 1</td>
                <td align="center"><italic>σ</italic><sup>2 </sup>= 1.2</td>
              </tr>
              <tr>
                <td/>
                <td align="center"><italic>ρ</italic><sup>2 </sup>= 0.5</td>
                <td align="center"><italic>ρ</italic><sup>2 </sup>= 0.05</td>
                <td align="center"><italic>ρ</italic><sup>2 </sup>= 0.02</td>
                <td align="center"><italic>ρ</italic><sup>2 </sup>= 0.05</td>
                <td align="center"><italic>ρ</italic><sup>2 </sup>= 0.1</td>
                <td align="center"><italic>ρ</italic><sup>2 </sup>= 0.5</td>
                <td align="center"><italic>ρ</italic><sup>2 </sup>= 0.05</td>
                <td align="center"><italic>ρ</italic><sup>2 </sup>= 0.5</td>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="left">
                  <inline-formula>
                    <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M95" name="1471-2105-10-10-i71" overflow="scroll">
                      <mml:semantics>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mtext>MSE</mml:mtext>
                            </mml:mrow>
                            <mml:mover accent="true">
                              <mml:mi>ν</mml:mi>
                              <mml:mo>^</mml:mo>
                            </mml:mover>
                          </mml:msub>
                        </mml:mrow>
                      </mml:semantics>
                    </mml:math>
                  </inline-formula>
                </td>
                <td align="center">0.0904</td>
                <td align="center">0.0091</td>
                <td align="center">0.0059</td>
                <td align="center">0.0094</td>
                <td align="center">0.021</td>
                <td align="center">0.067</td>
                <td align="center">0.0169</td>
                <td align="center">0.0729</td>
              </tr>
              <tr>
                <td align="left">
                  <inline-formula>
                    <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M96" name="1471-2105-10-10-i72" overflow="scroll">
                      <mml:semantics>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mtext>MSE</mml:mtext>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:msup>
                                <mml:mover accent="true">
                                  <mml:mi>σ</mml:mi>
                                  <mml:mo>^</mml:mo>
                                </mml:mover>
                                <mml:mn>2</mml:mn>
                              </mml:msup>
                            </mml:mrow>
                          </mml:msub>
                        </mml:mrow>
                      </mml:semantics>
                    </mml:math>
                  </inline-formula>
                </td>
                <td align="center">0.0042</td>
                <td align="center">0.0014</td>
                <td align="center">0.0041</td>
                <td align="center">0.0036</td>
                <td align="center">0.0037</td>
                <td align="center">0.0114</td>
                <td align="center">0.0123</td>
                <td align="center">0.0272</td>
              </tr>
              <tr>
                <td align="left">
                  <inline-formula>
                    <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M97" name="1471-2105-10-10-i73" overflow="scroll">
                      <mml:semantics>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mtext>MSE</mml:mtext>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:msup>
                                <mml:mover accent="true">
                                  <mml:mi>ρ</mml:mi>
                                  <mml:mo>^</mml:mo>
                                </mml:mover>
                                <mml:mn>2</mml:mn>
                              </mml:msup>
                            </mml:mrow>
                          </mml:msub>
                        </mml:mrow>
                      </mml:semantics>
                    </mml:math>
                  </inline-formula>
                </td>
                <td align="center">0.0633</td>
                <td align="center">0.0871</td>
                <td align="center">0.2508</td>
                <td align="center">0.2404</td>
                <td align="center">0.2426</td>
                <td align="center">0.4271</td>
                <td align="center">0.9921</td>
                <td align="center">1.3254</td>
              </tr>
              <tr>
                <td align="left">
                  <inline-formula>
                    <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M98" name="1471-2105-10-10-i74" overflow="scroll">
                      <mml:semantics>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mtext>MSE</mml:mtext>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:msubsup>
                                <mml:mover accent="true">
                                  <mml:mi>ρ</mml:mi>
                                  <mml:mo>^</mml:mo>
                                </mml:mover>
                                <mml:mn>1</mml:mn>
                                <mml:mn>2</mml:mn>
                              </mml:msubsup>
                            </mml:mrow>
                          </mml:msub>
                        </mml:mrow>
                      </mml:semantics>
                    </mml:math>
                  </inline-formula>
                </td>
                <td align="center">0.068</td>
                <td align="center">0.0009</td>
                <td align="center">0.0008</td>
                <td align="center">0.0014</td>
                <td align="center">0.0047</td>
                <td align="center">0.0593</td>
                <td align="center">0.0024</td>
                <td align="center">0.0623</td>
              </tr>
            </tbody>
          </table>
          <table-wrap-foot>
            <p>The table shows the estimated mean square error of the estimators <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M99" name="1471-2105-10-10-i53" overflow="scroll"><mml:semantics><mml:mover accent="true"><mml:mi>ν</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:semantics></mml:math></inline-formula>, <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M100" name="1471-2105-10-10-i75" overflow="scroll"><mml:semantics><mml:mrow><mml:msup><mml:mover accent="true"><mml:mi>σ</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:semantics></mml:math></inline-formula>, <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M101" name="1471-2105-10-10-i76" overflow="scroll"><mml:semantics><mml:mrow><mml:msup><mml:mover accent="true"><mml:mi>ρ</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:semantics></mml:math></inline-formula> and <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M102" name="1471-2105-10-10-i77" overflow="scroll"><mml:semantics><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>ρ</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:semantics></mml:math></inline-formula> applied to datasets without replicates, for different values of <italic>σ</italic><sup>2 </sup>and <italic>ρ</italic><sup>2</sup>. The table shows that <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M103" name="1471-2105-10-10-i71" overflow="scroll"><mml:semantics><mml:mrow><mml:msub><mml:mrow><mml:mtext>MSE</mml:mtext></mml:mrow><mml:mover accent="true"><mml:mi>ν</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:msub></mml:mrow></mml:semantics></mml:math></inline-formula> increased with <italic>ρ</italic><sup>2 </sup>and <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M104" name="1471-2105-10-10-i72" overflow="scroll"><mml:semantics><mml:mrow><mml:msub><mml:mrow><mml:mtext>MSE</mml:mtext></mml:mrow><mml:mrow><mml:msup><mml:mover accent="true"><mml:mi>σ</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:msub></mml:mrow></mml:semantics></mml:math></inline-formula> increased with <italic>σ</italic><sup>2</sup>. The estimator <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M105" name="1471-2105-10-10-i77" overflow="scroll"><mml:semantics><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>ρ</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:semantics></mml:math></inline-formula> was generally more accurate than <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M106" name="1471-2105-10-10-i76" overflow="scroll"><mml:semantics><mml:mrow><mml:msup><mml:mover accent="true"><mml:mi>ρ</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:semantics></mml:math></inline-formula> with respect to the MSE error measure.</p>
          </table-wrap-foot>
        </table-wrap>
        <p>From the results, we can deduce that <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M107" name="1471-2105-10-10-i75" overflow="scroll"><mml:semantics><mml:mrow><mml:msup><mml:mover accent="true"><mml:mi>σ</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:semantics></mml:math></inline-formula> is a good estimator because it was quite precise in all situations, while <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M108" name="1471-2105-10-10-i19" overflow="scroll"><mml:semantics><mml:mover accent="true"><mml:mi>ν</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:semantics></mml:math></inline-formula> was sometimes poor but in general acceptable. About the <italic>ρ</italic><sup>2 </sup>estimation, it is better to use <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M109" name="1471-2105-10-10-i77" overflow="scroll"><mml:semantics><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>ρ</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:semantics></mml:math></inline-formula> than <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M110" name="1471-2105-10-10-i76" overflow="scroll"><mml:semantics><mml:mrow><mml:msup><mml:mover accent="true"><mml:mi>ρ</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:semantics></mml:math></inline-formula>, when the variance of the noise is higher than the variance of the levels. Otherwise, it seems better to use <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M111" name="1471-2105-10-10-i76" overflow="scroll"><mml:semantics><mml:mrow><mml:msup><mml:mover accent="true"><mml:mi>ρ</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:semantics></mml:math></inline-formula> because it does not underestimate <italic>ρ</italic><sup>2 </sup>(see Section Methods).</p>
      </sec>
      <sec>
        <title>Comparison among the segment number estimators</title>
        <p>We evaluated the quality of the estimators of the number of segments, using datasets with and without replicates for different values of the hyper-parameters <italic>σ</italic><sup>2 </sup>and <italic>ρ</italic><sup>2</sup>. The estimations were made using either the true values of the hyper-parameters or the estimated ones. In this way, we could also observe the behavior of the boundary estimators without the influence of the hyper-parameter estimation.</p>
        <p>Comparing the absolute, squared and 0–1 errors, we found that <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M112" name="1471-2105-10-10-i31" overflow="scroll"><mml:semantics><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>K</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:semantics></mml:math></inline-formula> generally had the lowest upper bound (or its upper bound is very close to the lowest one) of the confidence interval at level 95%, for any type of error and any type of value of the parameter <italic>ρ</italic><sup>2 </sup>(see, for example, Figures S.2 and S.3 in Additional file <xref ref-type="supplementary-material" rid="S2">2</xref>). Moreover, all estimators always had a similar confidence interval of the 0–1 error, while using <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M113" name="1471-2105-10-10-i76" overflow="scroll"><mml:semantics><mml:mrow><mml:msup><mml:mover accent="true"><mml:mi>ρ</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:semantics></mml:math></inline-formula>, in most cases the upper bound of the confidence interval of the absolute and the squared error was lower than using <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M114" name="1471-2105-10-10-i77" overflow="scroll"><mml:semantics><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>ρ</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:semantics></mml:math></inline-formula>. All these results support the suggestion to use <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M115" name="1471-2105-10-10-i31" overflow="scroll"><mml:semantics><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>K</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:semantics></mml:math></inline-formula> with <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M116" name="1471-2105-10-10-i76" overflow="scroll"><mml:semantics><mml:mrow><mml:msup><mml:mover accent="true"><mml:mi>ρ</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:semantics></mml:math></inline-formula>.</p>
        <p>We should also observe that in general <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M117" name="1471-2105-10-10-i27" overflow="scroll"><mml:semantics><mml:mover accent="true"><mml:mi>K</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:semantics></mml:math></inline-formula><sub>01 </sub>underestimates <italic>k</italic><sub>0</sub>, while <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M118" name="1471-2105-10-10-i30" overflow="scroll"><mml:semantics><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>K</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:semantics></mml:math></inline-formula> and <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M119" name="1471-2105-10-10-i31" overflow="scroll"><mml:semantics><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>K</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:semantics></mml:math></inline-formula> overestimate it. In addition, the percentage of the underestimations increases using <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M120" name="1471-2105-10-10-i76" overflow="scroll"><mml:semantics><mml:mrow><mml:msup><mml:mover accent="true"><mml:mi>ρ</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:semantics></mml:math></inline-formula>.</p>
      </sec>
      <sec>
        <title>Comparison among the boundary estimators</title>
        <p>We compared the boundary estimators on the same datasets, previously used for the estimators of the number of segments, with both the estimated and the true value of the parameters involved. The following errors were taken into account: the sum 0–1 error, the joint 0–1 error and the binary error, defined in Section Methods, and the average square error,</p>
        <p>
          <disp-formula id="bmcM36">
            <label>(36)</label>
            <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M121" name="1471-2105-10-10-i78" overflow="scroll">
              <mml:semantics>
                <mml:mrow>
                  <mml:mtext>aver</mml:mtext>
                  <mml:mtext>. square error</mml:mtext>
                  <mml:mo>:</mml:mo>
                  <mml:mo>=</mml:mo>
                  <mml:mfrac>
                    <mml:mn>1</mml:mn>
                    <mml:mrow>
                      <mml:mi>k</mml:mi>
                      <mml:mo>−</mml:mo>
                      <mml:mn>1</mml:mn>
                    </mml:mrow>
                  </mml:mfrac>
                  <mml:mstyle displaystyle="true">
                    <mml:munderover>
                      <mml:mo>∑</mml:mo>
                      <mml:mrow>
                        <mml:mi>i</mml:mi>
                        <mml:mo>=</mml:mo>
                        <mml:mn>1</mml:mn>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>k</mml:mi>
                        <mml:mo>−</mml:mo>
                        <mml:mn>1</mml:mn>
                      </mml:mrow>
                    </mml:munderover>
                    <mml:mrow>
                      <mml:munder>
                        <mml:mrow>
                          <mml:mi>min</mml:mi>
                          <mml:mo>⁡</mml:mo>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>j</mml:mi>
                          <mml:mo>=</mml:mo>
                          <mml:mn>1</mml:mn>
                          <mml:mo>,</mml:mo>
                          <mml:mn>...</mml:mn>
                          <mml:mo>,</mml:mo>
                          <mml:mi>k</mml:mi>
                          <mml:mo>−</mml:mo>
                          <mml:mn>1</mml:mn>
                        </mml:mrow>
                      </mml:munder>
                    </mml:mrow>
                  </mml:mstyle>
                  <mml:msup>
                    <mml:mrow>
                      <mml:mrow>
                        <mml:mo>(</mml:mo>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mi>t</mml:mi>
                            <mml:mi>j</mml:mi>
                          </mml:msub>
                          <mml:mo>−</mml:mo>
                          <mml:msub>
                            <mml:mover accent="true">
                              <mml:mi>T</mml:mi>
                              <mml:mo>^</mml:mo>
                            </mml:mover>
                            <mml:mi>i</mml:mi>
                          </mml:msub>
                        </mml:mrow>
                        <mml:mo>)</mml:mo>
                      </mml:mrow>
                    </mml:mrow>
                    <mml:mn>2</mml:mn>
                  </mml:msup>
                  <mml:mo>,</mml:mo>
                </mml:mrow>
              </mml:semantics>
            </mml:math>
          </disp-formula>
        </p>
        <p>which corresponds to the mean square error over the whole vector of estimated boundaries. As observed in Section Methods, when the estimated segment number is used in the estimation of the boundaries, we are only able to compute the binary error, because it does not require that the vector of estimated boundaries has the same length as the vector of the true boundaries.</p>
        <p>We found (see, for example, Table <xref ref-type="table" rid="T2">2</xref> and Table S.2 in Additional file <xref ref-type="supplementary-material" rid="S2">2</xref>) that the best estimators were <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M122" name="1471-2105-10-10-i79" overflow="scroll"><mml:semantics><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold-italic">T</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mi>B</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mi>E</mml:mi><mml:mi>r</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:semantics></mml:math></inline-formula>, <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M123" name="1471-2105-10-10-i80" overflow="scroll"><mml:semantics><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold-italic">T</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mi>B</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mi>E</mml:mi><mml:mi>r</mml:mi><mml:mi>r</mml:mi><mml:mi>A</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:semantics></mml:math></inline-formula> and <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M124" name="1471-2105-10-10-i81" overflow="scroll"><mml:semantics><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold-italic">T</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mi>j</mml:mi><mml:mi>o</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:semantics></mml:math></inline-formula>, but it seemed that <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M125" name="1471-2105-10-10-i79" overflow="scroll"><mml:semantics><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold-italic">T</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mi>B</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mi>E</mml:mi><mml:mi>r</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:semantics></mml:math></inline-formula>, <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M126" name="1471-2105-10-10-i80" overflow="scroll"><mml:semantics><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold-italic">T</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mi>B</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mi>E</mml:mi><mml:mi>r</mml:mi><mml:mi>r</mml:mi><mml:mi>A</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:semantics></mml:math></inline-formula> were slightly better than <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M127" name="1471-2105-10-10-i81" overflow="scroll"><mml:semantics><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold-italic">T</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mi>j</mml:mi><mml:mi>o</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:semantics></mml:math></inline-formula>, when we estimated the parameters. Moreover, between these ones, we preferred the latter, because its computation depended less on the estimation of <italic>k</italic><sub>0 </sub>and thus it was more stable. In addition, in case of <italic>σ</italic><sup>2 </sup>&gt; <italic>ρ</italic><sup>2</sup>, we observed that there was a great difference between the errors obtained using <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M128" name="1471-2105-10-10-i76" overflow="scroll"><mml:semantics><mml:mrow><mml:msup><mml:mover accent="true"><mml:mi>ρ</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:semantics></mml:math></inline-formula> and <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M129" name="1471-2105-10-10-i77" overflow="scroll"><mml:semantics><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>ρ</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:semantics></mml:math></inline-formula>: using the latter, the errors were significantly lower (Table <xref ref-type="table" rid="T2">2</xref>).</p>
        <table-wrap position="float" id="T2">
          <label>Table 2</label>
          <caption>
            <p>Comparison among the several boundary estimators</p>
          </caption>
          <table frame="hsides" rules="groups">
            <thead>
              <tr>
                <td/>
                <td align="right"><italic>σ</italic><sup>2 </sup>= 0.1</td>
                <td align="right"><italic>σ</italic><sup>2 </sup>= 0.3</td>
                <td align="right"><italic>σ</italic><sup>2 </sup>= 0.5</td>
                <td align="right"><italic>σ</italic><sup>2 </sup>= 1.2</td>
              </tr>
              <tr>
                <td align="left">
                  <bold>method</bold>
                </td>
                <td align="right"><italic>ρ</italic><sup>2 </sup>= 0.5</td>
                <td align="right"><italic>ρ</italic><sup>2 </sup>= 0.05</td>
                <td align="right"><italic>ρ</italic><sup>2 </sup>= 0.1</td>
                <td align="right"><italic>ρ</italic><sup>2 </sup>= 0.5</td>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="left"><inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M130" name="1471-2105-10-10-i32" overflow="scroll"><mml:semantics><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold-italic">T</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mn>01</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:semantics></mml:math></inline-formula>, <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M131" name="1471-2105-10-10-i76" overflow="scroll"><mml:semantics><mml:mrow><mml:msup><mml:mover accent="true"><mml:mi>ρ</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:semantics></mml:math></inline-formula></td>
                <td align="right">11.5967 ± 0.4562</td>
                <td align="right">18.0933 ± 0.6388</td>
                <td align="right">18.2 ± 0.6177</td>
                <td align="right">17.6833 ± 0.5781</td>
              </tr>
              <tr>
                <td align="left"><inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M132" name="1471-2105-10-10-i81" overflow="scroll"><mml:semantics><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold-italic">T</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mi>j</mml:mi><mml:mi>o</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:semantics></mml:math></inline-formula>, <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M133" name="1471-2105-10-10-i76" overflow="scroll"><mml:semantics><mml:mrow><mml:msup><mml:mover accent="true"><mml:mi>ρ</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:semantics></mml:math></inline-formula></td>
                <td align="right">8.8667 ± 0.3329</td>
                <td align="right">17.6333± 0.6224</td>
                <td align="right">17.4833± 0.5898</td>
                <td align="right">16.6167 ± 0.5367</td>
              </tr>
              <tr>
                <td align="left"><inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M134" name="1471-2105-10-10-i79" overflow="scroll"><mml:semantics><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold-italic">T</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mi>B</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mi>E</mml:mi><mml:mi>r</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:semantics></mml:math></inline-formula>, <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M135" name="1471-2105-10-10-i76" overflow="scroll"><mml:semantics><mml:mrow><mml:msup><mml:mover accent="true"><mml:mi>ρ</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:semantics></mml:math></inline-formula></td>
                <td align="right">8.6833 ± 0.3437</td>
                <td align="right">17.3833 ± 0.6219</td>
                <td align="right">17.2467 ± 0.5983</td>
                <td align="right">15.8967 ± 0.5278</td>
              </tr>
              <tr>
                <td align="left"><inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M136" name="1471-2105-10-10-i80" overflow="scroll"><mml:semantics><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold-italic">T</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mi>B</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mi>E</mml:mi><mml:mi>r</mml:mi><mml:mi>r</mml:mi><mml:mi>A</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:semantics></mml:math></inline-formula>, <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M137" name="1471-2105-10-10-i76" overflow="scroll"><mml:semantics><mml:mrow><mml:msup><mml:mover accent="true"><mml:mi>ρ</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:semantics></mml:math></inline-formula></td>
                <td align="right">8.7267 ± 0.3449</td>
                <td align="right">17.3933 ± 0.6226</td>
                <td align="right">17.2567 ± 0.5978</td>
                <td align="right">15.9133 ± 0.5303</td>
              </tr>
              <tr>
                <td colspan="5">
                  <hr/>
                </td>
              </tr>
              <tr>
                <td align="left"><inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M138" name="1471-2105-10-10-i32" overflow="scroll"><mml:semantics><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold-italic">T</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mn>01</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:semantics></mml:math></inline-formula>, <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M139" name="1471-2105-10-10-i77" overflow="scroll"><mml:semantics><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>ρ</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:semantics></mml:math></inline-formula></td>
                <td align="right">11.4767 ± 0.4532</td>
                <td align="right">15.2867 ± 0.5325</td>
                <td align="right">15.6867 ± 0.536</td>
                <td align="right">16.1933 ± 0.5301</td>
              </tr>
              <tr>
                <td align="left"><inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M140" name="1471-2105-10-10-i81" overflow="scroll"><mml:semantics><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold-italic">T</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mi>j</mml:mi><mml:mi>o</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:semantics></mml:math></inline-formula>, <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M141" name="1471-2105-10-10-i77" overflow="scroll"><mml:semantics><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>ρ</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:semantics></mml:math></inline-formula></td>
                <td align="right">8.7933 ± 0.3294</td>
                <td align="right">13.73 ± 0.4731</td>
                <td align="right">13.81 ± 0.4691</td>
                <td align="right">14.1667 ± 0.451</td>
              </tr>
              <tr>
                <td align="left"><inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M142" name="1471-2105-10-10-i79" overflow="scroll"><mml:semantics><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold-italic">T</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mi>B</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mi>E</mml:mi><mml:mi>r</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:semantics></mml:math></inline-formula>, <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M143" name="1471-2105-10-10-i77" overflow="scroll"><mml:semantics><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>ρ</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:semantics></mml:math></inline-formula></td>
                <td align="right">8.47 ± 0.3372</td>
                <td align="right">13.0567 ± 0.4635</td>
                <td align="right">13.18 ± 0.4725</td>
                <td align="right">13.2367 ± 0.4344</td>
              </tr>
              <tr>
                <td align="left"><inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M144" name="1471-2105-10-10-i80" overflow="scroll"><mml:semantics><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold-italic">T</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mi>B</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mi>E</mml:mi><mml:mi>r</mml:mi><mml:mi>r</mml:mi><mml:mi>A</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:semantics></mml:math></inline-formula>, <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M145" name="1471-2105-10-10-i77" overflow="scroll"><mml:semantics><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>ρ</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:semantics></mml:math></inline-formula></td>
                <td align="right">8.4567 ± 0.3361</td>
                <td align="right">13.0467 ± 0.4676</td>
                <td align="right">13.08 ± 0.4695</td>
                <td align="right">13.2233 ± 0.4361</td>
              </tr>
            </tbody>
          </table>
          <table-wrap-foot>
            <p>The table shows the estimated mean binary errors ± standard deviation of the estimators of <bold><italic>t</italic></bold><sup>0 </sup>applied to datasets with replicates for different values of <italic>σ</italic><sup>2 </sup>and <italic>ρ</italic><sup>2</sup>. We always used <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M146" name="1471-2105-10-10-i31" overflow="scroll"><mml:semantics><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>K</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:semantics></mml:math></inline-formula>, <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M147" name="1471-2105-10-10-i19" overflow="scroll"><mml:semantics><mml:mover accent="true"><mml:mi>ν</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:semantics></mml:math></inline-formula>, <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M148" name="1471-2105-10-10-i75" overflow="scroll"><mml:semantics><mml:mrow><mml:msup><mml:mover accent="true"><mml:mi>σ</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:semantics></mml:math></inline-formula> and both <italic>ρ</italic><sup>2 </sup>estimators as estimators of the other parameters involved. The estimators <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M149" name="1471-2105-10-10-i79" overflow="scroll"><mml:semantics><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold-italic">T</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mi>B</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mi>E</mml:mi><mml:mi>r</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:semantics></mml:math></inline-formula> and <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M150" name="1471-2105-10-10-i80" overflow="scroll"><mml:semantics><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold-italic">T</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mi>B</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mi>E</mml:mi><mml:mi>r</mml:mi><mml:mi>r</mml:mi><mml:mi>A</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:semantics></mml:math></inline-formula> always had the lowest errors. When <italic>σ</italic><sup>2 </sup>&gt; <italic>ρ</italic><sup>2 </sup>the error was lower by using <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M151" name="1471-2105-10-10-i77" overflow="scroll"><mml:semantics><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>ρ</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:semantics></mml:math></inline-formula>, otherwise the two <italic>ρ</italic><sup>2 </sup>estimators gave similar errors.</p>
          </table-wrap-foot>
        </table-wrap>
        <p>To choose between the estimators <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M152" name="1471-2105-10-10-i80" overflow="scroll"><mml:semantics><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold-italic">T</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mi>B</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mi>E</mml:mi><mml:mi>r</mml:mi><mml:mi>r</mml:mi><mml:mi>A</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:semantics></mml:math></inline-formula> and <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M153" name="1471-2105-10-10-i81" overflow="scroll"><mml:semantics><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold-italic">T</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mi>j</mml:mi><mml:mi>o</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:semantics></mml:math></inline-formula>, we performed the segment level estimation, considering both <italic>ρ</italic><sup>2 </sup>estimators. Then, we computed the MSE of the estimated segment level per probe and its upper bound of the confidence interval at level 95% (the corresponding graphs regarding some datasets can be found in Figure S.5 in Additional file <xref ref-type="supplementary-material" rid="S2">2</xref>). The results showed that, for a given estimator of <italic>ρ</italic><sup>2</sup>, in general <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M154" name="1471-2105-10-10-i80" overflow="scroll"><mml:semantics><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold-italic">T</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mi>B</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mi>E</mml:mi><mml:mi>r</mml:mi><mml:mi>r</mml:mi><mml:mi>A</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:semantics></mml:math></inline-formula> was better than <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M155" name="1471-2105-10-10-i81" overflow="scroll"><mml:semantics><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold-italic">T</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mi>j</mml:mi><mml:mi>o</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:semantics></mml:math></inline-formula> and the upper bound of the confidence interval of the MSE of the former estimator was lower than that one of the latter. Moreover, using <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M156" name="1471-2105-10-10-i77" overflow="scroll"><mml:semantics><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>ρ</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:semantics></mml:math></inline-formula> the error was generally lower. </p>
        <p>In addition, we compared the behavior of our boundary estimators on dataset <italic>Simulated Chromosomes</italic>. To assess the goodness of their estimation, we measured the sensitivity (proportion of true breakpoints detected) and the false discovery rate (FDR, i.e. proportion of false estimated breakpoints among the estimated ones), while to assess the influence of the boundary estimation on the profile estimation, we calculated the sum of squared distance (SSQ), the median absolute deviation (MAD) and the accuracy (proportion of probes correctly assigned to an altered or unaltered state). The sensitivity and the FDR were computed not only looking at the exact position of the breakpoints (w = 0), but also accounting for a neighborhood of 1 or 2 probes around the true positions (w = 1, 2). We also computed the accuracy inside and outside the aberrations separately, since the samples of dataset <italic>Simulated Chromosomes </italic>contained only few small copy number changes and thus the accuracy depended more on the correct estimation/classification of the probes in the "normal" regions. A more detailed explanation of these measures can be found in [<xref ref-type="bibr" rid="B13">13</xref>].</p>
        <p>Since we estimated <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M157" name="1471-2105-10-10-i75" overflow="scroll"><mml:semantics><mml:mrow><mml:msup><mml:mover accent="true"><mml:mi>σ</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:semantics></mml:math></inline-formula> = 0.026 and <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M158" name="1471-2105-10-10-i77" overflow="scroll"><mml:semantics><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>ρ</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:semantics></mml:math></inline-formula> = 0.031 (using the whole dataset), we expected that using <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M159" name="1471-2105-10-10-i76" overflow="scroll"><mml:semantics><mml:mrow><mml:msup><mml:mover accent="true"><mml:mi>ρ</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:semantics></mml:math></inline-formula> we should obtain better results because <italic>σ</italic><sup>2 </sup>was lower than <italic>ρ</italic><sup>2 </sup>and indeed the results obtained with <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M160" name="1471-2105-10-10-i76" overflow="scroll"><mml:semantics><mml:mrow><mml:msup><mml:mover accent="true"><mml:mi>ρ</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:semantics></mml:math></inline-formula> were slightly better than the others (see Table <xref ref-type="table" rid="T3">3</xref> and Figure S.6 in Additional file <xref ref-type="supplementary-material" rid="S2">2</xref>). Moreover, we found in general that <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M161" name="1471-2105-10-10-i80" overflow="scroll"><mml:semantics><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold-italic">T</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mi>B</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mi>E</mml:mi><mml:mi>r</mml:mi><mml:mi>r</mml:mi><mml:mi>A</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:semantics></mml:math></inline-formula> had the highest sensitivity but also a higher FDR than <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M162" name="1471-2105-10-10-i33" overflow="scroll"><mml:semantics><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold-italic">T</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mn>01</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:semantics></mml:math></inline-formula> (Figure S.6 in Additional file <xref ref-type="supplementary-material" rid="S2">2</xref>). This was due to the fact that, although the estimated number of segments was the same, <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M163" name="1471-2105-10-10-i33" overflow="scroll"><mml:semantics><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold-italic">T</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mn>01</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:semantics></mml:math></inline-formula> could estimate some breakpoints with the same position, reducing the total number of breakpoints and so reducing the FDR. We can see in Table <xref ref-type="table" rid="T3">3</xref> that the false estimated breakpoints did not negatively influence the profile estimation. In fact, the false breakpoints are often used by the algorithm in two ways: either to divide a long segment into two or more segments with close levels or, if it is difficult to determine the position of a breakpoint, to add, before or after the aberration, a segment of one point with the value of the level between zero and the aberration level. Overall, <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M164" name="1471-2105-10-10-i80" overflow="scroll"><mml:semantics><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold-italic">T</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mi>B</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mi>E</mml:mi><mml:mi>r</mml:mi><mml:mi>r</mml:mi><mml:mi>A</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:semantics></mml:math></inline-formula> with <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M165" name="1471-2105-10-10-i76" overflow="scroll"><mml:semantics><mml:mrow><mml:msup><mml:mover accent="true"><mml:mi>ρ</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:semantics></mml:math></inline-formula> performed best on this dataset.</p>
        <table-wrap position="float" id="T3">
          <label>Table 3</label>
          <caption>
            <p>Comparison among the boundary estimators on <italic>Simulated Chromosomes</italic></p>
          </caption>
          <table frame="hsides" rules="groups">
            <thead>
              <tr>
                <td align="left">
                  <bold>method</bold>
                </td>
                <td align="center">
                  <bold>SSQ</bold>
                </td>
                <td align="center">
                  <bold>MAD</bold>
                </td>
                <td align="center">
                  <bold>accuracy</bold>
                </td>
                <td align="center">
                  <bold>accuracy inside aberrations</bold>
                </td>
                <td align="center">
                  <bold>accuracy outside aberrations</bold>
                </td>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="left"><inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M166" name="1471-2105-10-10-i32" overflow="scroll"><mml:semantics><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold-italic">T</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mn>01</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:semantics></mml:math></inline-formula>, <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M167" name="1471-2105-10-10-i76" overflow="scroll"><mml:semantics><mml:mrow><mml:msup><mml:mover accent="true"><mml:mi>ρ</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:semantics></mml:math></inline-formula></td>
                <td align="center">14.23</td>
                <td align="center">0.00877</td>
                <td align="center">0.889</td>
                <td align="center">0.961</td>
                <td align="center">0.883</td>
              </tr>
              <tr>
                <td align="left"><inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M168" name="1471-2105-10-10-i81" overflow="scroll"><mml:semantics><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold-italic">T</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mi>j</mml:mi><mml:mi>o</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:semantics></mml:math></inline-formula>, <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M169" name="1471-2105-10-10-i76" overflow="scroll"><mml:semantics><mml:mrow><mml:msup><mml:mover accent="true"><mml:mi>ρ</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:semantics></mml:math></inline-formula></td>
                <td align="center">2.22</td>
                <td align="center">0.00840</td>
                <td align="center">0.904</td>
                <td align="center">0.992</td>
                <td align="center">0.892</td>
              </tr>
              <tr>
                <td align="left"><inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M170" name="1471-2105-10-10-i80" overflow="scroll"><mml:semantics><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold-italic">T</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mi>B</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mi>E</mml:mi><mml:mi>r</mml:mi><mml:mi>r</mml:mi><mml:mi>A</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:semantics></mml:math></inline-formula>, <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M171" name="1471-2105-10-10-i76" overflow="scroll"><mml:semantics><mml:mrow><mml:msup><mml:mover accent="true"><mml:mi>ρ</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:semantics></mml:math></inline-formula></td>
                <td align="center">1.70</td>
                <td align="center">0.00733</td>
                <td align="center">0.936</td>
                <td align="center">0.992</td>
                <td align="center">0.932</td>
              </tr>
              <tr>
                <td colspan="6">
                  <hr/>
                </td>
              </tr>
              <tr>
                <td align="left"><inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M172" name="1471-2105-10-10-i32" overflow="scroll"><mml:semantics><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold-italic">T</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mn>01</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:semantics></mml:math></inline-formula>, <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M173" name="1471-2105-10-10-i77" overflow="scroll"><mml:semantics><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>ρ</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:semantics></mml:math></inline-formula></td>
                <td align="center">9.74</td>
                <td align="center">0.00952</td>
                <td align="center">0.881</td>
                <td align="center">0.960</td>
                <td align="center">0.877</td>
              </tr>
              <tr>
                <td align="left"><inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M174" name="1471-2105-10-10-i81" overflow="scroll"><mml:semantics><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold-italic">T</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mi>j</mml:mi><mml:mi>o</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:semantics></mml:math></inline-formula>, <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M175" name="1471-2105-10-10-i77" overflow="scroll"><mml:semantics><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>ρ</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:semantics></mml:math></inline-formula></td>
                <td align="center">2.67</td>
                <td align="center">0.00970</td>
                <td align="center">0.882</td>
                <td align="center">0.993</td>
                <td align="center">0.867</td>
              </tr>
              <tr>
                <td align="left"><inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M176" name="1471-2105-10-10-i80" overflow="scroll"><mml:semantics><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold-italic">T</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mi>B</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mi>E</mml:mi><mml:mi>r</mml:mi><mml:mi>r</mml:mi><mml:mi>A</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:semantics></mml:math></inline-formula>, <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M177" name="1471-2105-10-10-i77" overflow="scroll"><mml:semantics><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>ρ</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:semantics></mml:math></inline-formula></td>
                <td align="center">1.85</td>
                <td align="center">0.00781</td>
                <td align="center">0.929</td>
                <td align="center">0.993</td>
                <td align="center">0.920</td>
              </tr>
            </tbody>
          </table>
          <table-wrap-foot>
            <p>This table shows the comparison among the error measures for profile estimation, obtained on dataset <italic>Simulated Chromosomes</italic>, for all estimators of <bold><italic>t</italic></bold><sup>0 </sup>(apart <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M178" name="1471-2105-10-10-i79" overflow="scroll"><mml:semantics><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold-italic">T</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mi>B</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mi>E</mml:mi><mml:mi>r</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:semantics></mml:math></inline-formula>). We always used <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M179" name="1471-2105-10-10-i31" overflow="scroll"><mml:semantics><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>K</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:semantics></mml:math></inline-formula>, <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M180" name="1471-2105-10-10-i19" overflow="scroll"><mml:semantics><mml:mover accent="true"><mml:mi>ν</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:semantics></mml:math></inline-formula>, <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M181" name="1471-2105-10-10-i75" overflow="scroll"><mml:semantics><mml:mrow><mml:msup><mml:mover accent="true"><mml:mi>σ</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:semantics></mml:math></inline-formula> and both <italic>ρ</italic><sup>2 </sup>estimators as estimators of the other parameters involved. The estimator <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M182" name="1471-2105-10-10-i80" overflow="scroll"><mml:semantics><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold-italic">T</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mi>B</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mi>E</mml:mi><mml:mi>r</mml:mi><mml:mi>r</mml:mi><mml:mi>A</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:semantics></mml:math></inline-formula> always had the lowest SSQ and MAD errors and the highest accuracy both inside and outside the regions of aberration. Using <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M183" name="1471-2105-10-10-i76" overflow="scroll"><mml:semantics><mml:mrow><mml:msup><mml:mover accent="true"><mml:mi>ρ</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:semantics></mml:math></inline-formula> the performance was slightly better, because <italic>σ</italic><sup>2 </sup>&lt;<italic>ρ</italic><sup>2</sup>.</p>
          </table-wrap-foot>
        </table-wrap>
        <p>In conclusion, we suggest to use <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M184" name="1471-2105-10-10-i80" overflow="scroll"><mml:semantics><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold-italic">T</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mi>B</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mi>E</mml:mi><mml:mi>r</mml:mi><mml:mi>r</mml:mi><mml:mi>A</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:semantics></mml:math></inline-formula>, even if <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M185" name="1471-2105-10-10-i81" overflow="scroll"><mml:semantics><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold-italic">T</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mi>j</mml:mi><mml:mi>o</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:semantics></mml:math></inline-formula> is also a quite good estimator in some cases. Regarding the estimation of <italic>ρ</italic><sup>2</sup>, it seems that it is better to use <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M186" name="1471-2105-10-10-i77" overflow="scroll"><mml:semantics><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>ρ</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:semantics></mml:math></inline-formula> in presence of high noise.</p>
      </sec>
      <sec>
        <title>Comparison among the regression curves</title>
        <p>We compared the estimation of the levels of BRC with the one of BRCAk, also taking into account the influence of the different estimators of the parameters on the final results. To valuate the performance of the methods, we used the root mean square error (RMSE) per probe and per sample, computed with respect to the true profile of the levels. For this purpose, we necessarily needed datasets with replicates. Using BRCAk we generally obtained a better or equal result with respect to the BRC (see, for example, Figures S.7 and S.8 in Additional file <xref ref-type="supplementary-material" rid="S2">2</xref>). Moreover, we observed that, using BRC, it was better to estimate the segment number with <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M187" name="1471-2105-10-10-i30" overflow="scroll"><mml:semantics><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>K</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:semantics></mml:math></inline-formula> or <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M188" name="1471-2105-10-10-i31" overflow="scroll"><mml:semantics><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>K</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:semantics></mml:math></inline-formula>.</p>
        <p>Note that we still have to solve the problem to determine which is the best estimator of <italic>ρ</italic><sup>2</sup>. In most cases, the profile obtained by using <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M189" name="1471-2105-10-10-i77" overflow="scroll"><mml:semantics><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>ρ</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:semantics></mml:math></inline-formula> was better than using <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M190" name="1471-2105-10-10-i76" overflow="scroll"><mml:semantics><mml:mrow><mml:msup><mml:mover accent="true"><mml:mi>ρ</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:semantics></mml:math></inline-formula> (for example, see the plots at the bottom of Figure S.9 in Additional file <xref ref-type="supplementary-material" rid="S2">2</xref>). This is due to the fact that sometimes <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M191" name="1471-2105-10-10-i77" overflow="scroll"><mml:semantics><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>ρ</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:semantics></mml:math></inline-formula> slightly underestimated <italic>ρ</italic><sup>2</sup>, leading to overfitting. Still we recommend to use <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M192" name="1471-2105-10-10-i77" overflow="scroll"><mml:semantics><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>ρ</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:semantics></mml:math></inline-formula>, even if it could lead to a slight overfitting especially in the case of few segments.</p>
      </sec>
    </sec>
    <sec>
      <title>Comparison with other methods on simulated data</title>
      <p>In this subsection we compare the original and modified versions of BPCR and BRC, with other existing methods for genomic copy number estimation [<xref ref-type="bibr" rid="B2">2</xref>-<xref ref-type="bibr" rid="B10">10</xref>].</p>
      <sec>
        <title>Error measures used in the comparison</title>
        <p>We used two different measures to examine the behavior of the different methods on the collections <italic>Cases </italic>and <italic>Four aberrations</italic>: the root mean square error (for both) and the ROC curve (only for the latter). Each point of the ROC curve has as coordinates the false positive rate (FPR) and the true positive rate (TPR) for a certain threshold. The TPR is defined as the fraction of probes in the true aberrations whose estimated value is above the threshold considered, while the FPR consists in the fraction of probes outside the true aberrations whose estimated value is above the threshold. Hence, the ROC curve measures the accuracy of the method in the detection of the true aberrations.</p>
        <p>Instead, the evaluation of the several methods on dataset <italic>Simulated Chromosomes </italic>was accomplished using the error measures described in [<xref ref-type="bibr" rid="B13">13</xref>], already used in the study of the boundary estimators.</p>
        <p>Before showing the results, we need to remember that some methods estimate the copy numbers as a piecewise constant function, while other algorithms estimate them as a continuous curve. Hence, BPCR was compared to the former group of methods, while the Bayesian regression curves to the latter. Since some error measures of [<xref ref-type="bibr" rid="B13">13</xref>] suppose that the estimated profile is piecewise constant, we applied only the former group of methods on dataset <italic>Simulated Chromosomes</italic>.</p>
      </sec>
      <sec>
        <title>The piecewise constant estimation</title>
        <p>We compared the original and the modified versions of BPCR with CBS [<xref ref-type="bibr" rid="B2">2</xref>], CGHseg [<xref ref-type="bibr" rid="B3">3</xref>], GLAD [<xref ref-type="bibr" rid="B4">4</xref>], HMM [<xref ref-type="bibr" rid="B5">5</xref>], BioHMM [<xref ref-type="bibr" rid="B6">6</xref>] and Rendersome [<xref ref-type="bibr" rid="B7">7</xref>]. For thoroughness, in the modified versions of BPCR, we used both <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M193" name="1471-2105-10-10-i76" overflow="scroll"><mml:semantics><mml:mrow><mml:msup><mml:mover accent="true"><mml:mi>ρ</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:semantics></mml:math></inline-formula> and <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M194" name="1471-2105-10-10-i77" overflow="scroll"><mml:semantics><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>ρ</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:semantics></mml:math></inline-formula> as estimators of <italic>ρ</italic><sup>2</sup>, <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M195" name="1471-2105-10-10-i31" overflow="scroll"><mml:semantics><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>K</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:semantics></mml:math></inline-formula> as estimator of <italic>k</italic><sub>0 </sub>and both <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M196" name="1471-2105-10-10-i81" overflow="scroll"><mml:semantics><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold-italic">T</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mi>j</mml:mi><mml:mi>o</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:semantics></mml:math></inline-formula> and <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M197" name="1471-2105-10-10-i80" overflow="scroll"><mml:semantics><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold-italic">T</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mi>B</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mi>E</mml:mi><mml:mi>r</mml:mi><mml:mi>r</mml:mi><mml:mi>A</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:semantics></mml:math></inline-formula> as estimators of the boundaries. We used <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M198" name="1471-2105-10-10-i76" overflow="scroll"><mml:semantics><mml:mrow><mml:msup><mml:mover accent="true"><mml:mi>ρ</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:semantics></mml:math></inline-formula> when the noise was low (<italic>σ</italic><sup>2 </sup>&lt;<italic>ρ</italic><sup>2</sup>) and otherwise <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M199" name="1471-2105-10-10-i77" overflow="scroll"><mml:semantics><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>ρ</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:semantics></mml:math></inline-formula>. Examples of estimated profiles can be found in Figure <xref ref-type="fig" rid="F2">2</xref>.</p>
        <fig position="float" id="F2">
          <label>Figure 2</label>
          <caption>
            <p><bold>Example of estimated piecewise constant profiles</bold>. The plots show the differences in the level estimation among the piecewise constant methods on samples with SNR = 3 and SNR = 1: some are unable to identify the small aberrations in presence of high noise. In each graph, the grey segments represent the true profile.</p>
          </caption>
          <graphic xlink:href="1471-2105-10-10-2"/>
        </fig>
        <p>In general, in presence of medium noise, the GLAD method performed worst, since it had a high error in the level estimation of the small peaks, while, for high noise, often both GLAD and Rendersome failed to detect the aberrations (Figures S.12 and S.13 in Additional file <xref ref-type="supplementary-material" rid="S2">2</xref>). The CGHseg method did not usually exhibit an appropriate level estimation except sometimes for segments of large width (for example in Figure S.11 in Additional file <xref ref-type="supplementary-material" rid="S2">2</xref>). This is due to the fact that CGHseg estimates the level of a segment with the arithmetic mean of the data points in the segment and this estimator performs poorly if the segment contains few data points and the breakpoint estimation is not accurate. The CBS method, in general, performed quite well, but it was unable to detect aberrations of small width, especially when the noise was high (Figure S.13 in Additional file <xref ref-type="supplementary-material" rid="S2">2</xref>).</p>
        <p>On the collection <italic>Cases </italic>and the dataset of <italic>Four aberrations </italic>with SNR = 3, the RMSE plots and the ROC curves of the HMM method showed that it generally estimated the profile well, but sometimes it exhibited high errors near breakpoint positions (see, for example, Figure S.11 in Additional file <xref ref-type="supplementary-material" rid="S2">2</xref>), likely because it was unable to determine the true position of the breakpoints precisely. Moreover, on the dataset with SNR = 1, we recognized the true issues of the estimation with HMM. The RMSE plot showed that it had a high error outside the regions of the aberrations, while inside these regions the error was always more or less the same. Hence, it often failed also in the estimation of the largest aberration, the easiest one to detect (see the corresponding errors in Figure S.13 in Additional file <xref ref-type="supplementary-material" rid="S2">2</xref>). The reason of this behavior of the RMSE is the following. The method estimated the true profile either with only one segment, or more often with a profile consisting of a lot of small segments, but all with the same level. Since in the latter case the estimated levels were close to that one of the true aberrations, the RMSE was low in the regions of the aberrations but high outside them. However, the estimated profiles were not similar to the true one. In presence of medium noise (SNR = 3), the method BioHMM was more precise than HMM in the determination of the breakpoint positions and in the level estimation (Figure S.11 in Additional file <xref ref-type="supplementary-material" rid="S2">2</xref>), while for high noise it behaved similarly to HMM (Figure S.13 in Additional file <xref ref-type="supplementary-material" rid="S2">2</xref>).</p>
        <p>In general we found that, when <italic>σ</italic><sup>2 </sup>&lt;<italic>ρ</italic><sup>2 </sup>(when <italic>σ</italic><sup>2 </sup>&gt; <italic>ρ</italic><sup>2</sup>), the version of BPCR with <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M200" name="1471-2105-10-10-i80" overflow="scroll"><mml:semantics><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold-italic">T</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mi>B</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mi>E</mml:mi><mml:mi>r</mml:mi><mml:mi>r</mml:mi><mml:mi>A</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:semantics></mml:math></inline-formula> and <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M201" name="1471-2105-10-10-i76" overflow="scroll"><mml:semantics><mml:mrow><mml:msup><mml:mover accent="true"><mml:mi>ρ</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:semantics></mml:math></inline-formula> (<inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M202" name="1471-2105-10-10-i77" overflow="scroll"><mml:semantics><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>ρ</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:semantics></mml:math></inline-formula>) generally gave the best estimation compared to the other versions of BPCR and to the other methods (Figures S.10, S.11, S.12 and S.13 in Additional file <xref ref-type="supplementary-material" rid="S2">2</xref>). In the following, we will call this modified version of BPCR, mBPCR.</p>
        <p>Only on the dataset with SNR = 1, we could not choose the "best" method, because this case showed the limits of all the methods considered. The problem regarding the modified versions of BPCR was essentially the estimation of the number of segments. The ROC curves (Figure S.12 in Additional file <xref ref-type="supplementary-material" rid="S2">2</xref>) of the modified versions of BPCR with <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M203" name="1471-2105-10-10-i77" overflow="scroll"><mml:semantics><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>ρ</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:semantics></mml:math></inline-formula> were the closest to the left and the top sides of the box, while the RMSE plot (Figure S.13 in Additional file <xref ref-type="supplementary-material" rid="S2">2</xref>) showed that these methods were the best methods in the estimation of the levels inside the aberrations, but not outside them. In general, in case of very high noise, all the modified versions of BPCR well detected the aberrations, but had problems in the estimation of the profile outside them because of the poor estimation of the number of segments. In fact, <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M204" name="1471-2105-10-10-i31" overflow="scroll"><mml:semantics><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>K</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:semantics></mml:math></inline-formula> tends to overestimate the number of segments and this problem worsens using <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M205" name="1471-2105-10-10-i77" overflow="scroll"><mml:semantics><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>ρ</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:semantics></mml:math></inline-formula>. In conclusion, in a situation with very high noise, using <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M206" name="1471-2105-10-10-i77" overflow="scroll"><mml:semantics><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>ρ</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:semantics></mml:math></inline-formula> the BPCR methods detect better the small segments, but, at the same time, the large ones are divided in small segments. On the other hand, using <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M207" name="1471-2105-10-10-i76" overflow="scroll"><mml:semantics><mml:mrow><mml:msup><mml:mover accent="true"><mml:mi>ρ</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:semantics></mml:math></inline-formula>, smaller segments are not detected and are joined to the closest large segment.</p>
        <p>Finally, the comparison performed on dataset <italic>Simulated Chromosomes </italic>showed that CBS and mBPCR better estimated the profiles (see Table <xref ref-type="table" rid="T4">4</xref>). Regarding the breakpoint error measures (see Figure S.14 in Additional file <xref ref-type="supplementary-material" rid="S2">2</xref>), we found that mBPCR had the highest sensitivity (hence, it was the best method in determining the exact position of the breakpoints), but also a higher FDR than CBS. We have already explained in the previous subsection the possible reason of the high FDR of mBPCR and we can observe again that this fact did not influence negatively the profile estimation (see the SSQ error in Table <xref ref-type="table" rid="T4">4</xref>). The GLAD method showed a low sensitivity and low FDR, apart from the case regarding the exact position of the breakpoints (w = 0), which means that it underestimated the segment number and the estimated breakpoints were not located exactly at their true positions. Also CGHseg underestimated the number of segments because of low sensitivity and FDR, while HMM had low sensitivity and high FDR when w = 0 and vice versa in the other cases, which means that it often detected the true segment number, but it was unable to put the breakpoints at their exact position. Instead, BioHMM solved the issue of HMM with w = 0, but overall had a lower sensitivity than HMM. Rendersome missed several true aberrations (lowest sensitivity) and detected some false aberrations (medium FDR).</p>
        <table-wrap position="float" id="T4">
          <label>Table 4</label>
          <caption>
            <p>Comparison among the piecewise constant methods on <italic>Simulated Chromosomes</italic></p>
          </caption>
          <table frame="hsides" rules="groups">
            <thead>
              <tr>
                <td align="left">
                  <bold>method</bold>
                </td>
                <td align="center">
                  <bold>SSQ</bold>
                </td>
                <td align="center">
                  <bold>MAD</bold>
                </td>
                <td align="center">
                  <bold>accuracy</bold>
                </td>
                <td align="center">
                  <bold>accuracy inside aberrations</bold>
                </td>
                <td align="center">
                  <bold>accuracy outside aberrations</bold>
                </td>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="left">mBPCR <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M208" name="1471-2105-10-10-i76" overflow="scroll"><mml:semantics><mml:mrow><mml:msup><mml:mover accent="true"><mml:mi>ρ</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:semantics></mml:math></inline-formula></td>
                <td align="center">1.70</td>
                <td align="center">0.00733</td>
                <td align="center">0.936</td>
                <td align="center">0.992</td>
                <td align="center">0.932</td>
              </tr>
              <tr>
                <td align="left">mBPCR <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M209" name="1471-2105-10-10-i77" overflow="scroll"><mml:semantics><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>ρ</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:semantics></mml:math></inline-formula></td>
                <td align="center">1.85</td>
                <td align="center">0.00781</td>
                <td align="center">0.929</td>
                <td align="center">0.993</td>
                <td align="center">0.920</td>
              </tr>
              <tr>
                <td align="left">CBS</td>
                <td align="center">1.56</td>
                <td align="center">0.00705</td>
                <td align="center">0.953</td>
                <td align="center">0.985</td>
                <td align="center">0.950</td>
              </tr>
              <tr>
                <td align="left">CGHseg</td>
                <td align="center">5.42</td>
                <td align="center">0.00795</td>
                <td align="center">0.925</td>
                <td align="center">0.885</td>
                <td align="center">0.956</td>
              </tr>
              <tr>
                <td align="left">HMM</td>
                <td align="center">4.47</td>
                <td align="center">0.00350</td>
                <td align="center">0.993</td>
                <td align="center">0.968</td>
                <td align="center">0.997</td>
              </tr>
              <tr>
                <td align="left">GLAD</td>
                <td align="center">4.15</td>
                <td align="center">0.00846</td>
                <td align="center">0.939</td>
                <td align="center">0.930</td>
                <td align="center">0.952</td>
              </tr>
              <tr>
                <td align="left">BioHMM</td>
                <td align="center">5.69</td>
                <td align="center">0.003647</td>
                <td align="center">0.990</td>
                <td align="center">0.949</td>
                <td align="center">0.999</td>
              </tr>
              <tr>
                <td align="left">Rendersome</td>
                <td align="center">19.13</td>
                <td align="center">0</td>
                <td align="center">0.920</td>
                <td align="center">0.289</td>
                <td align="center">1</td>
              </tr>
            </tbody>
          </table>
          <table-wrap-foot>
            <p>The table shows the comparison of the level estimations obtained using several piecewise constant methods on dataset <italic>Simulated Chromosomes</italic>. In this comparison, the methods CBS and mBPCR exhibited the lowest SSQ error in the profile estimation and the highest accuracy inside the aberrated regions. On the other hand, HMM, BioHMM and Rendersome had the highest accuracy outside the aberrations, but a high SSQ error. Therefore, the former group of algorithms globally estimated a better profile than the latter. Because of its definition, the MAD error is less informative: it does not take into account if a small number of probes are wrongly estimated, but these probes could correspond to breakpoints or small aberrations.</p>
          </table-wrap-foot>
        </table-wrap>
      </sec>
      <sec>
        <title>Estimation with a continuous curve</title>
        <p>We compared the several versions of the Bayesian regression curves with methods which estimate the copy number as a continuous curve (lowess, wavelet, quantreg and smoothseg). Lowess is the acronym of "Locally Weighted Smoothing" (implemented in the stats library of R) and it is one of the methods considered in the comparison performed in [<xref ref-type="bibr" rid="B14">14</xref>]. As we saw previously, both the BRC, which uses <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M210" name="1471-2105-10-10-i31" overflow="scroll"><mml:semantics><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>K</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:semantics></mml:math></inline-formula>, and the BRCAk perform well, so we tested both versions with both estimators of <italic>ρ</italic><sup>2</sup>. Figure <xref ref-type="fig" rid="F3">3</xref> shows examples of estimated profiles with these smoothing methods.</p>
        <fig position="float" id="F3">
          <label>Figure 3</label>
          <caption>
            <p><bold>Example of estimated regression curves</bold>. The plots show the differences in the level estimation among the smoothing methods on samples with SNR = 3 and SNR = 1: some oscillate more in the regions outside the aberrations. In cases of high noise, the more oscillating the profiles are, the harder it is to identify which regions correspond to the aberrations. In each graph, the grey segments represent the true profile.</p>
          </caption>
          <graphic xlink:href="1471-2105-10-10-3"/>
        </fig>
        <p>In general, we found that all methods detected the regions of aberration quite well (see, for example, Figures S.16 and S.18 in Additional file <xref ref-type="supplementary-material" rid="S2">2</xref>). The wavelet method showed a higher error in the level estimation of the aberrations in the datasets SNR = 3 and SNR = 1 (Figures S.16 and S.18 in Additional file <xref ref-type="supplementary-material" rid="S2">2</xref>). The methods lowess and quantreg had the highest RMSE in the collection <italic>Cases</italic>, while their error was not significantly different outside and inside the aberrations on datasets with SNR = 1, 3. Therefore, in the last cases the error was low inside the aberrations and high outside them in comparison with the other methods. The method smoothseg showed a similar behavior, but with a lower error.</p>
        <p>Moreover, we found that the ROC measure was affected by oscillations in the estimated curve, which lead to ROC curves intersected and difficult to be interpreted (Figure S.15 in Additional file <xref ref-type="supplementary-material" rid="S2">2</xref>). This complex behavior is a consequence of the way in which lowess, wavelet, quantreg and smoothseg yielded oscillating curves with positive and negative values outside the aberrations; while BRCs estimated the true profile with a line almost flat and close to zero (see the examples in Figure <xref ref-type="fig" rid="F3">3</xref>).</p>
        <p>In conclusion, the version of BRC with <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M211" name="1471-2105-10-10-i31" overflow="scroll"><mml:semantics><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>K</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:semantics></mml:math></inline-formula> and BRCAk gave in general a better estimation than the other BRCs and the other smoothing methods considered. Regarding the <italic>ρ</italic><sup>2 </sup>estimation, we found that it is better to use <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M212" name="1471-2105-10-10-i76" overflow="scroll"><mml:semantics><mml:mrow><mml:msup><mml:mover accent="true"><mml:mi>ρ</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:semantics></mml:math></inline-formula>, if <italic>σ</italic><sup>2 </sup>&lt;<italic>ρ</italic><sup>2</sup>, and <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M213" name="1471-2105-10-10-i77" overflow="scroll"><mml:semantics><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>ρ</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:semantics></mml:math></inline-formula>, if <italic>σ</italic><sup>2 </sup>&gt; <italic>ρ</italic><sup>2</sup>.</p>
      </sec>
    </sec>
    <sec>
      <title>Application to real data</title>
      <p>In this subsection, we show how mBPCR performed compared to other piecewise constant estimation methods on the real data. We used samples from three mantle cell lymphoma cell lines (JEKO-1, GRANTA-519, REC-1) previously analyzed by us with the Affymetrix GeneChip Mapping 10K Array (Affymetrix, Santa Clara, CA), an oligonucleotides-based microarray [<xref ref-type="bibr" rid="B15">15</xref>]. We also used the data obtained on JEKO-1, by using the higher density Affymetrix GeneChip Mapping 250K Nsp Array. We considered eight recurrent gene regions of aberration in lymphoma plus other two gene regions (<italic>BIRC3 </italic>and <italic>LAMP1</italic>) and we compared the corresponding copy numbers obtained by the several piecewise constant methods with those obtained by the FISH technique in [<xref ref-type="bibr" rid="B15">15</xref>]. In the end, we also show a comparison among the estimated profiles of chromosome 11 of JEKO-1.</p>
      <p>The 10K Array data used are freely available at the public repository Gene Expression Omnibus [<xref ref-type="bibr" rid="B16">16</xref>] with GEO accession: GSM95567, GSM95568 and GSM95570. The 250K Array data of cell line JEKO-1 will be soon available in the same repository.</p>
      <p>With the current implementation, on a computer with dual CPU (AMD Opteron 250, 2.4 GHz) and 4 GB RAM, the algorithm needed about 4 minutes to analyze a 10K Array sample, while about 1 day to estimate the profile of a 250K Array sample. The computations were performed by chromosome (and by arm for the longest chromosomes in the 250K Array data) and using <italic>k</italic><sub>max </sub>= 100.</p>
      <sec>
        <title>Gene copy number estimation</title>
        <p>To properly evaluate the methods, the knowledge of the true underling profile is required. In general, large aberrations on chromosomes can be detected with conventional karyotype analysis or with SKY-FISH and one could use this information for the evaluation procedure, but the width of these aberrations is so large that all the methods can detect them well, leading to a useless comparison. For this reason, we decided to take into account only genes to compare the piecewise constant methods.</p>
        <p>In the comparison, as previously published [<xref ref-type="bibr" rid="B15">15</xref>], when two FISH copy numbers had been assigned to one gene, the first number should correspond to the copy number detected in the majority of the cells. We assigned two estimated copy numbers to one gene, when the position of the gene is between two SNPs and the method assigned two different values to these SNPs.</p>
        <p>The results on REC-1 (Table S.3 in Additional file <xref ref-type="supplementary-material" rid="S2">2</xref>) did not show any significant difference among the methods, instead those on GRANTA-519 (Table S.4 in Additional file <xref ref-type="supplementary-material" rid="S2">2</xref>) showed that GLAD was unable to detect the true copy number in five cases, while HMM, BioHMM and Rendersome detected an amplification on <italic>MALT1 </italic>greater than what detected by FISH analysis. All methods did not detect the true copy number of <italic>ATM</italic>, probably because the SNPs around <italic>ATM </italic>are far away from the corresponding FISH region (about 1 Mb) and the deletion affects only this region. Only mBPCR with <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M214" name="1471-2105-10-10-i77" overflow="scroll"><mml:semantics><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>ρ</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:semantics></mml:math></inline-formula> and HMM detected a breakpoint between the two SNPs around <italic>ATM </italic>region, indicating a copy number change.</p>
        <p>Regarding the JEKO-1 data, since the cell line is triploid, to obtain more realistic copy number value, we centered the estimated log<sub>2</sub>ratio around log<sub>2 </sub>3. With the denser 250K Array data, all methods behaved equally good. Only HMM had a problem in the detection of the breakpoint corresponding to the <italic>C</italic>-<italic>MYC </italic>amplification (see Table S.5 in Additional file <xref ref-type="supplementary-material" rid="S2">2</xref>). On both arrays, all methods identified a gain (copy number 3 or 4) at the <italic>CCND1 </italic>position, while the copy number detected by FISH is 2. This fact cannot be explained as previously for <italic>ATM</italic>, because this region is well covered by SNPs. Instead, on the JEKO-1 10K Array data (Table <xref ref-type="table" rid="T5">5</xref>), the noisiest among all samples, we can see several cases in which CBS, HMM and GLAD did not detect correctly the gene copy number (for example, <italic>BCL2 </italic>and <italic>MALT1</italic>). This occurred more frequently to BioHMM and Rendersome, while only once to CGHseg (<italic>LAMP1</italic>). The method mBPCR with <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M215" name="1471-2105-10-10-i77" overflow="scroll"><mml:semantics><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>ρ</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:semantics></mml:math></inline-formula> always estimated gene copy numbers correctly, apart from <italic>CCND1</italic>.</p>
        <table-wrap position="float" id="T5">
          <label>Table 5</label>
          <caption>
            <p>Copy number estimation results obtained on 10K Array data of sample JEKO-1</p>
          </caption>
          <table frame="hsides" rules="groups">
            <thead>
              <tr>
                <td/>
                <td/>
                <td align="center" colspan="2">
                  <bold>mBPCR</bold>
                </td>
                <td/>
                <td/>
                <td/>
                <td/>
                <td/>
                <td/>
              </tr>
              <tr>
                <td/>
                <td/>
                <td colspan="2">
                  <hr/>
                </td>
                <td/>
                <td/>
                <td/>
                <td/>
                <td/>
                <td/>
              </tr>
              <tr>
                <td align="left">
                  <bold>gene region</bold>
                </td>
                <td align="center">
                  <bold>FISH CN</bold>
                </td>
                <td align="center">
                  <inline-formula>
                    <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M216" name="1471-2105-10-10-i76" overflow="scroll">
                      <mml:semantics>
                        <mml:mrow>
                          <mml:msup>
                            <mml:mover accent="true">
                              <mml:mi>ρ</mml:mi>
                              <mml:mo>^</mml:mo>
                            </mml:mover>
                            <mml:mn>2</mml:mn>
                          </mml:msup>
                        </mml:mrow>
                      </mml:semantics>
                    </mml:math>
                  </inline-formula>
                </td>
                <td align="center">
                  <inline-formula>
                    <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M217" name="1471-2105-10-10-i77" overflow="scroll">
                      <mml:semantics>
                        <mml:mrow>
                          <mml:msubsup>
                            <mml:mover accent="true">
                              <mml:mi>ρ</mml:mi>
                              <mml:mo>^</mml:mo>
                            </mml:mover>
                            <mml:mn>1</mml:mn>
                            <mml:mn>2</mml:mn>
                          </mml:msubsup>
                        </mml:mrow>
                      </mml:semantics>
                    </mml:math>
                  </inline-formula>
                </td>
                <td align="center">
                  <bold>CBS</bold>
                </td>
                <td align="center">
                  <bold>CGHseg</bold>
                </td>
                <td align="center">
                  <bold>HMM</bold>
                </td>
                <td align="center">
                  <bold>GLAD</bold>
                </td>
                <td align="center">
                  <bold>BioHMM</bold>
                </td>
                <td align="center">
                  <bold>Rendersome</bold>
                </td>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="left">
                  <italic>BCL6</italic>
                </td>
                <td align="center">3/2</td>
                <td align="center">2.97</td>
                <td align="center">2.99</td>
                <td align="center">2.97</td>
                <td align="center">2.90</td>
                <td align="center">2.92</td>
                <td align="center">2.92</td>
                <td align="center">3.14</td>
                <td align="center">2.92</td>
              </tr>
              <tr>
                <td align="left">
                  <italic>C-MYC</italic>
                </td>
                <td align="center">ampl</td>
                <td align="center">12.11</td>
                <td align="center">9.35</td>
                <td align="center">10.27</td>
                <td align="center">10.27</td>
                <td align="center">13.95</td>
                <td align="center">9.82</td>
                <td align="center">8.26</td>
                <td align="center">
                  <italic>13.10/3.11</italic>
                </td>
              </tr>
              <tr>
                <td align="left">
                  <italic>CCND1</italic>
                </td>
                <td align="center">2</td>
                <td align="center">
                  <italic>4.08</italic>
                </td>
                <td align="center">
                  <italic>3.77</italic>
                </td>
                <td align="center">
                  <italic>4.08</italic>
                </td>
                <td align="center">
                  <italic>4.08</italic>
                </td>
                <td align="center">
                  <italic>3.84</italic>
                </td>
                <td align="center">
                  <italic>3.79</italic>
                </td>
                <td align="center">
                  <italic>3.14</italic>
                </td>
                <td align="center">
                  <italic>3.50</italic>
                </td>
              </tr>
              <tr>
                <td align="left">
                  <italic>BIRC3</italic>
                </td>
                <td align="center">4/5</td>
                <td align="center">4.08</td>
                <td align="center">4.29</td>
                <td align="center">4.08</td>
                <td align="center">4.08</td>
                <td align="center">3.84</td>
                <td align="center">3.79</td>
                <td align="center">
                  <italic>3.14</italic>
                </td>
                <td align="center">3.50</td>
              </tr>
              <tr>
                <td align="left">
                  <italic>ATM</italic>
                </td>
                <td align="center">4</td>
                <td align="center">4.08</td>
                <td align="center">4.29</td>
                <td align="center">4.08</td>
                <td align="center">4.08</td>
                <td align="center">3.84</td>
                <td align="center">3.79</td>
                <td align="center">
                  <italic>3.14</italic>
                </td>
                <td align="center">
                  <italic>3.50/2.39</italic>
                </td>
              </tr>
              <tr>
                <td align="left">
                  <italic>D13S319</italic>
                </td>
                <td align="center">4</td>
                <td align="center">3.72</td>
                <td align="center">3.59</td>
                <td align="center">3.57</td>
                <td align="center">3.72</td>
                <td align="center">3.62</td>
                <td align="center">3.58</td>
                <td align="center">
                  <italic>3.14</italic>
                </td>
                <td align="center">
                  <italic>3.43</italic>
                </td>
              </tr>
              <tr>
                <td align="left">
                  <italic>LAMP1</italic>
                </td>
                <td align="center">4</td>
                <td align="center">
                  <italic>3.41</italic>
                </td>
                <td align="center">3.82</td>
                <td align="center">
                  <italic>3.41</italic>
                </td>
                <td align="center">
                  <italic>3.41</italic>
                </td>
                <td align="center">3.62</td>
                <td align="center">
                  <italic>2.49</italic>
                </td>
                <td align="center">
                  <italic>3.14</italic>
                </td>
                <td align="center">
                  <italic>3.43</italic>
                </td>
              </tr>
              <tr>
                <td align="left">
                  <italic>TP53</italic>
                </td>
                <td align="center">2/3</td>
                <td align="center">2.81</td>
                <td align="center">3.00</td>
                <td align="center">2.83</td>
                <td align="center">2.50</td>
                <td align="center">
                  <italic>3.52</italic>
                </td>
                <td align="center">2.93</td>
                <td align="center">3.14</td>
                <td align="center">2.93</td>
              </tr>
              <tr>
                <td align="left">
                  <italic>MALT1</italic>
                </td>
                <td align="center">4</td>
                <td align="center">3.63</td>
                <td align="center">3.62</td>
                <td align="center">
                  <italic>3.48</italic>
                </td>
                <td align="center">3.64</td>
                <td align="center">
                  <italic>3.42</italic>
                </td>
                <td align="center">
                  <italic>3.42</italic>
                </td>
                <td align="center">
                  <italic>3.14</italic>
                </td>
                <td align="center">
                  <italic>3.42</italic>
                </td>
              </tr>
              <tr>
                <td align="left">
                  <italic>BCL2</italic>
                </td>
                <td align="center">4</td>
                <td align="center">3.63</td>
                <td align="center">3.62</td>
                <td align="center">
                  <italic>3.48</italic>
                </td>
                <td align="center">3.64</td>
                <td align="center">
                  <italic>3.42</italic>
                </td>
                <td align="center">
                  <italic>3.42</italic>
                </td>
                <td align="center">
                  <italic>3.14</italic>
                </td>
                <td align="center">
                  <italic>3.42</italic>
                </td>
              </tr>
            </tbody>
          </table>
          <table-wrap-foot>
            <p>On this noisy data, BioHMM and Rendersome often estimated the gene copy number wrongly, while this occurred only sometimes to CBS, HMM and GLAD. The method mBPCR with <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M218" name="1471-2105-10-10-i77" overflow="scroll"><mml:semantics><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>ρ</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:semantics></mml:math></inline-formula> correctly estimated the gene copy numbers, apart from <italic>CCND1 </italic>whose copy number was estimated by all methods differently from the FISH technique.</p>
          </table-wrap-foot>
        </table-wrap>
      </sec>
      <sec>
        <title>Profile estimation</title>
        <p>To compare the profile estimations, we chose the sample JEKO-1 because, using the results obtained on both types of array, we could at least understand which regions were more realistically estimated. For now, whole validated chromosomic profiles are not available. Among all chromosomes, we chose chromosome 11 since three of the previous genes belong to that: <italic>CCND1 </italic>(around 69.17 Mb), <italic>BIRC3 </italic>(around 101.7 Mb) and <italic>ATM </italic>(around 107.6 Mb).</p>
        <p>From the graphs in Figure <xref ref-type="fig" rid="F4">4</xref> we can observe that, among all the piecewise constant methods, only mBPCR with <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M219" name="1471-2105-10-10-i77" overflow="scroll"><mml:semantics><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>ρ</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:semantics></mml:math></inline-formula> was able to detect the high amplification after position 110 Mb on the 10K Array data, while it was recognized by all methods (apart from BioHMM) on the 250K Array data. Moreover, on the 10K Array data, almost all methods detected a false deletion around position 3 Mb, due to the presence of a sequence of outliers, and BioHMM did not find any copy number change in the chromosome. On the 250K Array data, HMM and Rendersome had problems in recognizing the last part of the chromosome as a flat region. Moreover, on the 10K Array data, Rendersome estimated several outliers as true aberrations and, on the 250K Array data, it was unable (contrary to all other algorithms) to identify the whole region from about 78 Mb to 111 Mb as gained.</p>
        <fig position="float" id="F4">
          <label>Figure 4</label>
          <caption>
            <p><bold>Comparison among the estimated profiles of chromosome 11 of JEKO-1</bold>. The figure shows the comparison among the piecewise constant estimated profiles of chromosome 11 of JEKO-1 using both 10K Array and 250K Array data. Only mBPCR with <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M220" name="1471-2105-10-10-i77" overflow="scroll"><mml:semantics><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>ρ</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:semantics></mml:math></inline-formula> was able to detect the high amplification after position 110 Mb on the 10K Array data. On the other hand, all methods (apart from BioHMM) recognized it on the 250K Array data.</p>
          </caption>
          <graphic xlink:href="1471-2105-10-10-4"/>
        </fig>
      </sec>
    </sec>
  </sec>
  <sec>
    <title>Conclusion</title>
    <p>We introduced new estimators for the parameters involved in BPCR and we selected the best ones on the basis of theoretic and empirical results. In particular, we found that the best way is to estimate the segment number with <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M221" name="1471-2105-10-10-i31" overflow="scroll"><mml:semantics><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>K</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:semantics></mml:math></inline-formula> and the boundaries with <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M222" name="1471-2105-10-10-i80" overflow="scroll"><mml:semantics><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold-italic">T</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mi>B</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mi>E</mml:mi><mml:mi>r</mml:mi><mml:mi>r</mml:mi><mml:mi>A</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:semantics></mml:math></inline-formula> (or possibly <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M223" name="1471-2105-10-10-i81" overflow="scroll"><mml:semantics><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold-italic">T</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mi>j</mml:mi><mml:mi>o</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:semantics></mml:math></inline-formula>). We call mBPCR the BPCR version which uses <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M224" name="1471-2105-10-10-i31" overflow="scroll"><mml:semantics><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>K</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:semantics></mml:math></inline-formula> and <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M225" name="1471-2105-10-10-i80" overflow="scroll"><mml:semantics><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold-italic">T</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mi>B</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mi>E</mml:mi><mml:mi>r</mml:mi><mml:mi>r</mml:mi><mml:mi>A</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:semantics></mml:math></inline-formula>.</p>
    <p>Concerning the estimation of the variance of the segment levels, we found that the original estimator <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M226" name="1471-2105-10-10-i76" overflow="scroll"><mml:semantics><mml:mrow><mml:msup><mml:mover accent="true"><mml:mi>ρ</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:semantics></mml:math></inline-formula> overestimates <italic>ρ</italic><sup>2 </sup>(variance of the segment levels) by an addendum proportional to <italic>σ</italic><sup>2 </sup>(variance of the noise), see Equation (31). Hence, the estimation fails when <italic>σ</italic><sup>2 </sup>&gt; <italic>ρ</italic><sup>2</sup>. The new estimator <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M227" name="1471-2105-10-10-i77" overflow="scroll"><mml:semantics><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>ρ</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:semantics></mml:math></inline-formula> is more precise but slightly underestimates <italic>ρ</italic><sup>2</sup>, leading to an overestimation of the segment number. Applying both estimators on artificial datasets, we found that, in general, the best way is to use <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M228" name="1471-2105-10-10-i76" overflow="scroll"><mml:semantics><mml:mrow><mml:msup><mml:mover accent="true"><mml:mi>ρ</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:semantics></mml:math></inline-formula> when <italic>σ</italic><sup>2 </sup>&lt;<italic>ρ</italic><sup>2 </sup>(low noise), but to use <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M229" name="1471-2105-10-10-i77" overflow="scroll"><mml:semantics><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>ρ</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:semantics></mml:math></inline-formula> when <italic>σ</italic><sup>2 </sup>&gt; <italic>ρ</italic><sup>2 </sup>(high noise), even if it could lead to a slight overfitting. On real DNA copy number data, commonly <italic>σ</italic><sup>2 </sup>&gt; <italic>ρ</italic><sup>2</sup>.</p>
    <p>We also compared mBPCR with other methods which also estimate the copy number as a piecewise constant function: CBS, HMM, CGHseg, GLAD, BioHMM and Rendersome. As a whole, the results showed that mBPCR gave the best estimation on the dataset used. However, when <italic>σ</italic><sup>2 </sup>≫ <italic>ρ</italic><sup>2 </sup>it is hard to understand which method is the most appropriate. Most of the other methods were not able to detect aberrations with a small width (5 and 10 probes) and the same was true for mBPCR using <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M230" name="1471-2105-10-10-i76" overflow="scroll"><mml:semantics><mml:mrow><mml:msup><mml:mover accent="true"><mml:mi>ρ</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:semantics></mml:math></inline-formula>. On the other hand, the use of <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M231" name="1471-2105-10-10-i77" overflow="scroll"><mml:semantics><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>ρ</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:semantics></mml:math></inline-formula> led to the detection of the smaller segments, but the larger ones were often divided in small segments and sometimes the segments consisted of only one point. The optimal choice of the <italic>ρ</italic><sup>2 </sup>estimator is still not fully determined.</p>
    <p>The new estimators improved also BRC, which is a Bayesian regression with a smooth curve. Moreover, we derived a formula to estimate BRC without employing the estimated number of segments. We referred to it as BRCAk. Applying these methods to artificial data, the best estimators were found to be the BRC version with <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M232" name="1471-2105-10-10-i31" overflow="scroll"><mml:semantics><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>K</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:semantics></mml:math></inline-formula> and BRCAk. About the choice of the two estimators of <italic>ρ</italic><sup>2</sup>, we found a similar conclusion as before, with the advantage of being less problematic when <italic>σ</italic><sup>2 </sup>≫ <italic>ρ</italic><sup>2</sup>. We compared these two regression methods with other methods which estimate the copy number data as a continuous curve: wavelet, lowess, quantreg and smoothseg. The results showed that our modified regression methods were the most appropriate for the estimation of the segment levels on the datasets considered.</p>
    <p>Even though these smoothing methods seem to have less problems in the estimation and the error measures (for example, the ROC curve) suggest that their estimation is even better than the piecewise constant estimation, these methods do not detect the position of the breakpoints explicitly and hence the changes in the value of the segment level. Thus, they seem to be less adequate in practice.</p>
    <p>For this reason, we feel that the ROC curve cannot be used as the only measure to compare methods, as previously done in [<xref ref-type="bibr" rid="B14">14</xref>]. The RMSE is generally an acceptable measure, but we observed that in some cases even this is not sufficient, due to the overfitting. Willenbrock and Fridlyand [<xref ref-type="bibr" rid="B13">13</xref>] proposed other measures to compare methods for copy number estimation, regarding both breakpoint and level estimation. In particular, the sensitivity measure of breakpoint estimation is useful to select which methods should be used, because it quantifies the precision of the methods in determining the position of the breakpoints.</p>
    <p>Finally, we have applied mBPCR and all other piecewise constant regression methods to real data. The comparisons showed that mBPCR estimated well the copy number of the genes. On these data, in most cases the choice of the <italic>ρ</italic><sup>2 </sup>estimator did not affect the analysis.</p>
    <p>In comparison with the other methods, the current implementation of our algorithm is computationally intensive. The real computational time can be reduced linearly diminishing <italic>k</italic><sub>max </sub>and quadratically diminishing the number of probes. Moreover, the computation can be easily parallelized by arm and by chromosome, reducing further the calculation time.</p>
    <p>In cancer research, the accuracy in the DNA copy number estimation is crucial for the correct determination of the mutations that characterize the disease. In particular, the estimation of the breakpoints must be precise to detect correctly which genes are affected by these genomic aberrations. As recently shown [<xref ref-type="bibr" rid="B17">17</xref>], SNP microarrays can also potentially detect the breakpoints involved in unbalanced translocations, allowing the identification of fusion genes (i.e. hybrid genes created by joining portions of two different genes). In this context, the use of our method can highly improve the disease investigation, because it accurately determines breakpoints, is less sensitive to high noise and generally outperforms all the methods considered in our comparisons. Moreover, smoothing algorithms are clearly not suitable for such analysis.</p>
  </sec>
  <sec>
    <title>Availability and requirements</title>
    <p><bold>Project name</bold>: mBPCR.</p>
    <p><bold>Project home page</bold>: <ext-link ext-link-type="uri" xlink:href="http://www.idsia.ch/~paola/mBPCR/"/>.</p>
    <p><bold>Operating systems</bold>: the software should run in Linux, Mac-OS or Windows. Tests were performed on Windows and Linux systems.</p>
    <p><bold>Programming language</bold>: R.</p>
    <p><bold>Other requirements</bold>: none.</p>
    <p><bold>Licence</bold>: GNU GPL.</p>
    <p><bold>Any restrictions to use by non-academics</bold>: none.</p>
  </sec>
  <sec>
    <title>Authors' contributions</title>
    <p>PMVR carried out the study and wrote the manuscript. MH and IK supervised the statistical analysis. FB supervised the validation study and provided the real data. All authors read and approved the final manuscript.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material content-type="local-data" id="S1">
      <caption>
        <title>Additional file 1</title>
        <p><bold>mBPCR source code.</bold> This zipped file contains the source code of the mBPCR algorithm in R, including help files, sample data and examples.</p>
      </caption>
      <media xlink:href="1471-2105-10-10-S1.zip" mimetype="application" mime-subtype="x-zip-compressed">
        <caption>
          <p>Click here for file</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="S2">
      <caption>
        <title>Additional file 2</title>
        <p><bold>Supplementary material.</bold> This file contains a brief description of the dynamic program used to implement the method, a formal definition of some error measure used, some supplementary tables and some supplementary figures.</p>
      </caption>
      <media xlink:href="1471-2105-10-10-S2.pdf" mimetype="application" mime-subtype="pdf">
        <caption>
          <p>Click here for file</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <sec>
      <title>Acknowledgements</title>
      <p>This work was supported by the grant 205321-112430 of the Swiss National Science Foundation and by Oncosuisse Grant OCS 1939-08-2006.</p>
    </sec>
  </ack>
  <ref-list>
    <ref id="B1">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Huang</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Wei</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Bignell</surname>
            <given-names>GR</given-names>
          </name>
          <name>
            <surname>Stratton</surname>
            <given-names>MR</given-names>
          </name>
          <name>
            <surname>Futreal</surname>
            <given-names>PA</given-names>
          </name>
          <name>
            <surname>Wooster</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Jones</surname>
            <given-names>KW</given-names>
          </name>
          <name>
            <surname>Shapero</surname>
            <given-names>MH</given-names>
          </name>
        </person-group>
        <article-title>Whole Genome DNA Copy Number Changes Identified by High Density Oligonucleotide Arrays</article-title>
        <source>Human Genomics</source>
        <year>2004</year>
        <volume>1</volume>
        <fpage>287</fpage>
        <lpage>299</lpage>
        <pub-id pub-id-type="pmid">15588488</pub-id>
      </citation>
    </ref>
    <ref id="B2">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Olshen</surname>
            <given-names>AB</given-names>
          </name>
          <name>
            <surname>Venkatraman</surname>
            <given-names>ES</given-names>
          </name>
          <name>
            <surname>Lucito</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Wigler</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Circular Binary Segmentation for the Analysis of Array-based DNA Copy Number Data</article-title>
        <source>Biostatistics</source>
        <year>2004</year>
        <volume>5</volume>
        <fpage>557</fpage>
        <lpage>572</lpage>
        <pub-id pub-id-type="pmid">15475419</pub-id>
        <pub-id pub-id-type="doi">10.1093/biostatistics/kxh008</pub-id>
      </citation>
    </ref>
    <ref id="B3">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Picard</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Robin</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Lavielle</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Vaisse</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Daudin</surname>
            <given-names>JJ</given-names>
          </name>
        </person-group>
        <article-title>A Statistical Approach for Array CGH Data Analysis</article-title>
        <source>BMC Bioinformatics</source>
        <year>2005</year>
        <volume>6</volume>
        <pub-id pub-id-type="pmid">15705208</pub-id>
      </citation>
    </ref>
    <ref id="B4">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hupé</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Stransky</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Thiery</surname>
            <given-names>JP</given-names>
          </name>
          <name>
            <surname>Radvanyi</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Barillot</surname>
            <given-names>E</given-names>
          </name>
        </person-group>
        <article-title>Analysis of array CGH data: from signal ratio to gain and loss of DNA regions</article-title>
        <source>Bioinformatics</source>
        <year>2004</year>
        <volume>20</volume>
        <fpage>3413</fpage>
        <lpage>3422</lpage>
        <pub-id pub-id-type="pmid">15381628</pub-id>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bth418</pub-id>
      </citation>
    </ref>
    <ref id="B5">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Fridlyand</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Snijders</surname>
            <given-names>AM</given-names>
          </name>
          <name>
            <surname>Pinkel</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Albertson</surname>
            <given-names>DG</given-names>
          </name>
          <name>
            <surname>Jain</surname>
            <given-names>AN</given-names>
          </name>
        </person-group>
        <article-title>Hidden Markov Models approach to the analysis of array CGH data</article-title>
        <source>Journal of Multivariate Analysis</source>
        <year>2004</year>
        <volume>90</volume>
        <fpage>132</fpage>
        <lpage>153</lpage>
        <pub-id pub-id-type="doi">10.1016/j.jmva.2004.02.008</pub-id>
      </citation>
    </ref>
    <ref id="B6">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Marioni</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Thorne</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Tavare</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>BioHMM: a heterogeneous hidden Markov model for segmenting array CGH data</article-title>
        <source>Bioinformatics</source>
        <year>2006</year>
        <volume>22</volume>
        <fpage>1144</fpage>
        <lpage>1146</lpage>
        <pub-id pub-id-type="pmid">16533818</pub-id>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btl089</pub-id>
      </citation>
    </ref>
    <ref id="B7">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nilsson</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Johansson</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Heyden</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Nelander</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Fioretos</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>An improved method for detecting and delineating genomic regions with altered gene expression in cancer</article-title>
        <source>Genome Biology</source>
        <year>2008</year>
        <volume>9</volume>
        <pub-id pub-id-type="pmid">18208590</pub-id>
      </citation>
    </ref>
    <ref id="B8">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hsu</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Self</surname>
            <given-names>SG</given-names>
          </name>
          <name>
            <surname>Grove</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Randolph</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Delrow</surname>
            <given-names>JJ</given-names>
          </name>
          <name>
            <surname>Loo</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Porter</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>Denoising array-based comparative genomic hybridization data using wavelets</article-title>
        <source>Biostatistics</source>
        <year>2005</year>
        <volume>6</volume>
        <fpage>211</fpage>
        <lpage>226</lpage>
        <pub-id pub-id-type="pmid">15772101</pub-id>
        <pub-id pub-id-type="doi">10.1093/biostatistics/kxi004</pub-id>
      </citation>
    </ref>
    <ref id="B9">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Eilers</surname>
            <given-names>PHC</given-names>
          </name>
          <name>
            <surname>de Menezes</surname>
            <given-names>RX</given-names>
          </name>
        </person-group>
        <article-title>Quantile smoothing of array CGH data</article-title>
        <source>Bioinformatics</source>
        <year>2005</year>
        <volume>21</volume>
        <fpage>1146</fpage>
        <lpage>1153</lpage>
        <pub-id pub-id-type="pmid">15572474</pub-id>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bti148</pub-id>
      </citation>
    </ref>
    <ref id="B10">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Huang</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Gusnanto</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>O'Sullivan</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Staaf</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Borg</surname>
            <given-names>Å</given-names>
          </name>
          <name>
            <surname>Pawitan</surname>
            <given-names>Y</given-names>
          </name>
        </person-group>
        <article-title>Robust smooth segmentation approach for array CGH data analysis</article-title>
        <source>Bioinformatics</source>
        <year>2007</year>
        <volume>23</volume>
        <fpage>2463</fpage>
        <lpage>2469</lpage>
        <pub-id pub-id-type="pmid">17660206</pub-id>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btm359</pub-id>
      </citation>
    </ref>
    <ref id="B11">
      <citation citation-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Hutter</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <person-group person-group-type="editor">
          <name>
            <surname>Bernardo JM, Bayarri MJ, Berger JO, David AP, D Heckerman D, Smith AFM, West M</surname>
          </name>
        </person-group>
        <article-title>Bayesian Regression of Piecewise Constant Functions</article-title>
        <source>Bayesian Statistics 8: Proceedings of the Eighth Valencia International Meeting</source>
        <year>2007</year>
        <publisher-name>Oxford University Press</publisher-name>
        <fpage>607</fpage>
        <lpage>612</lpage>
      </citation>
    </ref>
    <ref id="B12">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hutter</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Exact Bayesian Regression of Piecewise Constant Functions</article-title>
        <source>Bayesian Analysis</source>
        <year>2007</year>
        <volume>2</volume>
        <fpage>635</fpage>
        <lpage>664</lpage>
      </citation>
    </ref>
    <ref id="B13">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Willenbrock</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Fridlyand</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>A comparison study: applying segmentation to array CGH data for downstream analyses</article-title>
        <source>Bioinformatics</source>
        <year>2005</year>
        <volume>21</volume>
        <fpage>4084</fpage>
        <lpage>4091</lpage>
        <pub-id pub-id-type="pmid">16159913</pub-id>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bti677</pub-id>
      </citation>
    </ref>
    <ref id="B14">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lai</surname>
            <given-names>WR</given-names>
          </name>
          <name>
            <surname>Johnson</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Kucherlapati</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Park</surname>
            <given-names>PJ</given-names>
          </name>
        </person-group>
        <article-title>Comparative analysis of algorithms for identifying amplifications and deletions in array CGH data: from signal ratio to gain and loss of DNA regions</article-title>
        <source>Bioinformatics</source>
        <year>2005</year>
        <volume>21</volume>
        <fpage>3763</fpage>
        <lpage>3770</lpage>
        <pub-id pub-id-type="pmid">16081473</pub-id>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bti611</pub-id>
      </citation>
    </ref>
    <ref id="B15">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rinaldi</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Kwee</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Taborelli</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Largo</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Uccella</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Martin</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Poretti</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Gaidano</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Calabrese</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Martinelli</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Baldini</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Pruneri</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Capella</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Zucca</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Cotter</surname>
            <given-names>FE</given-names>
          </name>
          <name>
            <surname>Cigudosa</surname>
            <given-names>JC</given-names>
          </name>
          <name>
            <surname>Catapano</surname>
            <given-names>CV</given-names>
          </name>
          <name>
            <surname>Tibiletti</surname>
            <given-names>MG</given-names>
          </name>
          <name>
            <surname>Bertoni</surname>
            <given-names>F</given-names>
          </name>
        </person-group>
        <article-title>Genomic and expression profiling identifies the B-cell associated tyrosine kinase Syk as a possible therapeutic target in mantle cell lymphoma</article-title>
        <source>British Journal of Haematology</source>
        <year>2006</year>
        <volume>132</volume>
        <fpage>303</fpage>
        <lpage>316</lpage>
        <pub-id pub-id-type="pmid">16409295</pub-id>
        <pub-id pub-id-type="doi">10.1111/j.1365-2141.2005.05883.x</pub-id>
      </citation>
    </ref>
    <ref id="B16">
      <citation citation-type="other">
        <article-title>Gene Expression Omnibus</article-title>
        <ext-link ext-link-type="uri" xlink:href="http://www.ncbi.nlm.nih.gov/geo/"/>
      </citation>
    </ref>
    <ref id="B17">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kawamata</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Ogawa</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Zimmermann</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Niebuhr</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Stocking</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Sanada</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Hemminki</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Yamatomo</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Nannya</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Koeler</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Flohr</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Miller</surname>
            <given-names>CW</given-names>
          </name>
          <name>
            <surname>Harbott</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Ludwing</surname>
            <given-names>WD</given-names>
          </name>
          <name>
            <surname>Stanulla</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Shrappe</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Bartram</surname>
            <given-names>CR</given-names>
          </name>
          <name>
            <surname>Koeffer</surname>
            <given-names>HP</given-names>
          </name>
        </person-group>
        <article-title>Cloning og genes involving in chromosomal translocations by high-resolution single nucleotide polymorphism genomic microarray</article-title>
        <source>Proceedings of the National Academy of Sciences</source>
        <year>2008</year>
        <volume>105</volume>
        <fpage>11921</fpage>
        <lpage>11926</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.0711039105</pub-id>
      </citation>
    </ref>
  </ref-list>
</back>
