<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1 20151215//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.1?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">6184683</article-id>
    <article-id pub-id-type="pmid">29722786</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/bty371</article-id>
    <article-id pub-id-type="publisher-id">bty371</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Original Papers</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Genetics and Population Analysis</subject>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>polymapR—linkage analysis and genetic map construction from F<sub>1</sub> populations of outcrossing polyploids</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">http://orcid.org/0000-0002-0665-6508</contrib-id>
        <name>
          <surname>Bourke</surname>
          <given-names>Peter M</given-names>
        </name>
        <xref ref-type="aff" rid="bty371-aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>van Geest</surname>
          <given-names>Geert</given-names>
        </name>
        <xref ref-type="aff" rid="bty371-aff1">1</xref>
        <xref ref-type="aff" rid="bty371-aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Voorrips</surname>
          <given-names>Roeland E</given-names>
        </name>
        <xref ref-type="aff" rid="bty371-aff1">1</xref>
        <xref ref-type="corresp" rid="bty371-cor1"/>
        <!--<email>roeland.voorrips@wur.nl</email>-->
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Jansen</surname>
          <given-names>Johannes</given-names>
        </name>
        <xref ref-type="aff" rid="bty371-aff3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Kranenburg</surname>
          <given-names>Twan</given-names>
        </name>
        <xref ref-type="aff" rid="bty371-aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Shahin</surname>
          <given-names>Arwa</given-names>
        </name>
        <xref ref-type="aff" rid="bty371-aff1">1</xref>
        <xref ref-type="aff" rid="bty371-aff4">4</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Visser</surname>
          <given-names>Richard G F</given-names>
        </name>
        <xref ref-type="aff" rid="bty371-aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Arens</surname>
          <given-names>Paul</given-names>
        </name>
        <xref ref-type="aff" rid="bty371-aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Smulders</surname>
          <given-names>Marinus J M</given-names>
        </name>
        <xref ref-type="aff" rid="bty371-aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Maliepaard</surname>
          <given-names>Chris</given-names>
        </name>
        <xref ref-type="aff" rid="bty371-aff1">1</xref>
        <xref ref-type="corresp" rid="bty371-cor1"/>
        <!--<email>chris.maliepaard@wur.nl</email>-->
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Stegle</surname>
          <given-names>Oliver</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <aff id="bty371-aff1"><label>1</label>Plant Breeding, Wageningen University &amp; Research, Wageningen, PB, The Netherlands</aff>
    <aff id="bty371-aff2"><label>2</label>Deliflor Chrysanten B.V, Maasdijk, BS, The Netherlands</aff>
    <aff id="bty371-aff3"><label>3</label>Biometris, Wageningen University &amp; Research, Wageningen, PB, The Netherlands</aff>
    <aff id="bty371-aff4"><label>4</label>Van Zanten Breeding B. V, Rijsenhout, EW, The Netherlands</aff>
    <author-notes>
      <corresp id="bty371-cor1">To whom correspondence should be addressed. <email>chris.maliepaard@wur.nl</email> or <email>roeland.voorrips@wur.nl</email></corresp>
    </author-notes>
    <pub-date pub-type="ppub">
      <day>15</day>
      <month>10</month>
      <year>2018</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2018-05-02">
      <day>02</day>
      <month>5</month>
      <year>2018</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>02</day>
      <month>5</month>
      <year>2018</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the <pub-date pub-type="epub"/>. -->
    <volume>34</volume>
    <issue>20</issue>
    <fpage>3496</fpage>
    <lpage>3502</lpage>
    <history>
      <date date-type="received">
        <day>09</day>
        <month>12</month>
        <year>2017</year>
      </date>
      <date date-type="rev-recd">
        <day>18</day>
        <month>4</month>
        <year>2018</year>
      </date>
      <date date-type="accepted">
        <day>09</day>
        <month>5</month>
        <year>2018</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2018. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2018</copyright-year>
      <license license-type="cc-by-nc" xlink:href="http://creativecommons.org/licenses/by-nc/4.0/">
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by-nc/4.0/">http://creativecommons.org/licenses/by-nc/4.0/</ext-link>), which permits non-commercial re-use, distribution, and reproduction in any medium, provided the original work is properly cited. For commercial re-use, please contact journals.permissions@oup.com</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="bty371.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Motivation</title>
        <p>Polyploid species carry more than two copies of each chromosome, a condition found in many of the world’s most important crops. Genetic mapping in polyploids is more complex than in diploid species, resulting in a lack of available software tools. These are needed if we are to realize all the opportunities offered by modern genotyping platforms for genetic research and breeding in polyploid crops.</p>
      </sec>
      <sec id="s2">
        <title>Results</title>
        <p>polymapR is an R package for genetic linkage analysis and integrated genetic map construction from bi-parental populations of outcrossing autopolyploids. It can currently analyse triploid, tetraploid and hexaploid marker datasets and is applicable to various crops including potato, leek, alfalfa, blueberry, chrysanthemum, sweet potato or kiwifruit. It can detect, estimate and correct for preferential chromosome pairing, and has been tested on high-density marker datasets from potato, rose and chrysanthemum, generating high-density integrated linkage maps in all of these crops.</p>
      </sec>
      <sec id="s3">
        <title>Availability and implementation</title>
        <p>polymapR is freely available under the general public license from the Comprehensive R Archive Network (CRAN) at <ext-link ext-link-type="uri" xlink:href="http://cran.r-project.org/package=polymapR">http://cran.r-project.org/package=polymapR</ext-link>.</p>
      </sec>
      <sec id="s4">
        <title>Supplementary information</title>
        <p><xref ref-type="supplementary-material" rid="sup1">Supplementary data</xref> are available at <italic>Bioinformatics</italic> online.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <named-content content-type="funder-name">TKI projects</named-content>
        </funding-source>
        <award-id>BO-26.03-002-001</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <named-content content-type="funder-name">Novel genetic and genomic tools for polyploid crops</named-content>
        </funding-source>
        <award-id>BO-26.03-009-004</award-id>
        <award-id>BO-50-002-022</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="7"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>In recent years there has been an acceleration of progress in the understanding of the genetics underlying important traits in autopolyploid species. This has been to a large extent due to developments in high-density genotyping platforms for single nucleotide polymorphism (SNP) markers, which have found increasing application in polyploids. For example, high-density SNP arrays have been developed in potato (<xref rid="bty371-B9" ref-type="bibr">Felcher <italic>et al.</italic>, 2012</xref>; <xref rid="bty371-B34" ref-type="bibr">Vos <italic>et al.</italic>, 2015</xref>), rose (<xref rid="bty371-B17" ref-type="bibr">Koning-Boucoiran <italic>et al.</italic>, 2015</xref>), alfalfa (<xref rid="bty371-B18" ref-type="bibr">Li <italic>et al.</italic>, 2014</xref>) and chrysanthemum (<xref rid="bty371-B28" ref-type="bibr">van Geest <italic>et al.</italic>, 2017a</xref>), enhancing the scope for genetic studies in these species.</p>
    <p>In polyploid species, as opposed to diploids, co-dominantly scored markers can possess multiple classes in the heterozygous condition, usually termed marker ‘dosage’. In a tetraploid there are five possible dosage classes of a bi-allelic SNP marker, namely nulliplex with a dosage 0 for one of the alleles, simplex with dosage 1, duplex with dosage 2, triplex with dosage 3, and quadruplex with dosage 4. In a hexaploid, the number of dosage classes at a bi-allelic locus rises to seven. Various software have been developed to convert the signal from SNP arrays into these discrete dosage calls for polyploids, such as fitTetra (<xref rid="bty371-B32" ref-type="bibr">Voorrips <italic>et al.</italic>, 2011</xref>) or ClusterCall (<xref rid="bty371-B25" ref-type="bibr">Schmitz Carley <italic>et al.</italic>, 2017</xref>). Dosage estimation from read-counts of sequencing data will also in time likely become available.</p>
    <p>Genetic linkage maps have traditionally been used for both exploratory trait mapping (often termed quantitative trait locus (QTL) analysis) and the subsequent fine mapping of traits, as well as for assisting genome assembly efforts by guiding the integration and orientation of contigs. High-density linkage maps may also improve our understanding of the chromosomal composition and genetics of polyploid species, uncovering such phenomena as double reduction or partially-preferential chromosome pairing. In many polyploid species which lack reference genome sequences, linkage maps are also a (vital) first genomic description of that species.</p>
    <p>Despite the importance of both linkage maps and polyploid species, there are still relatively few software tools available for polyploid linkage map construction. Allopolyploid species showing disomic inheritance can be treated (genetically speaking) as diploids, with a wide range of software options available. In the case of polysomic polyploids (autopolyploids and segmental allopolyploids), the options available to the research community are limited. Probably the most well-known autopolyploid mapping software is TetraploidMap (<xref rid="bty371-B12" ref-type="bibr">Hackett and Luo, 2003</xref>; <xref rid="bty371-B15" ref-type="bibr">Hackett <italic>et al.</italic>, 2007</xref>), which has been used in studies of various autotetraploid species such as potato, alfalfa, rose and blueberry (e.g. <xref rid="bty371-B6" ref-type="bibr">Bradshaw <italic>et al.</italic>, 2008</xref>; <xref rid="bty371-B10" ref-type="bibr">Gar <italic>et al.</italic>, 2011</xref>; <xref rid="bty371-B19" ref-type="bibr">McCallum <italic>et al.</italic>, 2016</xref>; <xref rid="bty371-B23" ref-type="bibr">Robins <italic>et al.</italic>, 2008</xref>). Recently, its successor TetraploidSNPMap (TSNPM) has been released to accommodate high-density marker data from SNP arrays (<xref rid="bty371-B13" ref-type="bibr">Hackett <italic>et al.</italic>, 2017</xref>). However, it can only handle autotetraploid datasets and provides a graphical user interface for the Windows platform only. Linkage studies in species exhibiting strong preferential chromosomal pairing or other ploidy levels are not currently possible using this software. An alternative polyploid mapping software is the PERGOLA package in R (<xref rid="bty371-B11" ref-type="bibr">Grandke <italic>et al.</italic>, 2017</xref>). However, this software has been developed for use with F<sub>2</sub> or backcross populations from homozygous parents only. In many cases, either due to inbreeding depression or the difficulties imposed by polysomic inheritance, F<sub>1</sub> populations from two heterozygous parents are typically used instead.</p>
    <p>In short, there is currently no software which can perform linkage mapping at various ploidy levels under a variety of inheritance models for outcrossing species using dosage-scored marker data. Here we present polymapR, an R package (<xref rid="bty371-B22" ref-type="bibr">R Core Team, 2016</xref>) for linkage mapping in outcrossing polyploid species which can generate linkage maps for polysomic triploids, tetraploids and hexaploids, accommodating either fully tetrasomic or mixed meiotic pairing behaviour (segmental allopolyploidy) at the tetraploid level. Its modularity will facilitate its adaption to other marker genotyping technologies or ploidy levels in the future.</p>
  </sec>
  <sec>
    <title>2 Materials and methods</title>
    <p>The polymapR pipeline consists of four parts—data inspection, linkage analysis, linkage group assignment and marker ordering, which are detailed below. A description of the functions within polymapR is described in the vignette which accompanies the package, going through all the steps in a typical mapping project. For consistency and simplicity, all examples mentioned here describe a tetraploid cross.</p>
    <sec>
      <title>2.1 Data inspection, filtering and preparation for linkage analysis</title>
      <p>The input data for polymapR is dosage-scored marker data, available from a number of packages such as fitTetra (<xref rid="bty371-B32" ref-type="bibr">Voorrips <italic>et al.</italic>, 2011</xref>) or ClusterCall (<xref rid="bty371-B25" ref-type="bibr">Schmitz Carley <italic>et al.</italic>, 2017</xref>). Both fitTetra and ClusterCall are limited to tetraploid data; fitTetra has recently been upgraded to fitPoly (<ext-link ext-link-type="uri" xlink:href="https://CRAN.R-project.org/package=fitPoly">https://CRAN.R-project.org/package=fitPoly</ext-link>) and can accommodate any ploidy level. Regardless of how it is generated, the input dosage-scored marker data should consist of a column of marker dosages for the mother, one for the father followed by a column for each of the offspring of the F<sub>1</sub> cross. Checks for marker skewness (segregation distortion) and shifted markers (when dosage scores are shifted by a fixed amount) are currently provided in polymapR from a suite of tools developed for the fitPoly package (<xref rid="bty371-B32" ref-type="bibr">Voorrips <italic>et al.</italic>, 2011</xref>).</p>
      <p>The next step in data preparation is the conversion of marker dosages to their simplest form, such that the sum of the parental dosage scores is minimized (e.g. 3×0, 3×4 and 1×4 markers can be recoded as 1×0 in a tetraploid). There are two possible conversions—a relabelling of the reference and alternative allele in both parents and a single-parent relabelling if the other parent is homozygous. Marker conversions are performed to reduce the number of marker segregation classes for the linkage analysis (which is directed according to the parental dosages), but have no effect on the pairwise results. In a tetraploid there are nine fundamental segregation types (i.e. 1×0, 0×1, 2×0, 0×2, 1×1, 1×2, 2×1, 1×3 and 2×2), rising to nineteen for a hexaploid. Identifiable double reduction scores are preserved during conversion [e.g. a dosage of 0 from a triplex × nulliplex (3×0) marker becomes a dosage of 2 in its converted form as a simplex × nulliplex (1×0) marker], allowing an investigation of double reduction post-mapping. Any impossible scores (like a dosage of 3 or 4 from a 1×0 marker) are made missing.</p>
      <p>High-quality data facilitates the generation of high-quality maps. polymapR assumes the dosage scores are accurate and error-free, but incorporates some controls to screen out problematic markers. One indication of poor data quality is a high proportion of missing values. The user may choose to screen out markers or individuals with more than a desired rate of missing values (by default up to 10% is tolerated), or duplicate individuals. Identical markers, which often occur in high-density marker datasets with limited population sizes and hence a limited number of recombination events, can be identified and reduced to one representative marker for the mapping steps, and reintegrated later. A principal component analysis can also be performed and visualized, which may highlight some unwanted structure in the population (for example due to pollination from an unknown external pollen parent or from self-pollination) or outlying individuals (for example because of admixture).</p>
    </sec>
    <sec>
      <title>2.2 Linkage analysis</title>
      <sec>
        <title>2.2.1 Linkage analysis under a polysomic model</title>
        <p>In autopolyploid species with polysomic inheritance, it is possible to model meiotic pairing structures as random bivalents or multivalents. In practice, both pairing structures tend to occur, with a relatively low frequency of multivalents in stable autopolyploids (<xref rid="bty371-B2" ref-type="bibr">Bomblies <italic>et al.</italic>, 2016</xref>; <xref rid="bty371-B24" ref-type="bibr">Santos <italic>et al.</italic>, 2003</xref>). The main consequence of multivalent formation from a genetic perspective is the phenomenon of double reduction, where two segments of a particular homologue can end up in the same gamete and become transmitted together to F<sub>1</sub> offspring. It has been demonstrated that double reduction introduces some bias in recombination frequency estimates under a random bivalent model. This can be safely ignored if the rate of quadrivalent pairing is low (<xref rid="bty371-B5" ref-type="bibr">Bourke <italic>et al.</italic>, 2015</xref><xref rid="bty371-B4" ref-type="bibr">, 2016</xref>).</p>
        <p>Under a random bivalent model, there are three possible bivalent pairing conformations in a tetraploid. In general, for any even ploidy <italic>p</italic> = 2<italic>n</italic> there are <inline-formula id="IE1"><mml:math id="IM1"><mml:mi>c</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mfenced separators="|"><mml:mrow><mml:mn>2</mml:mn><mml:mi>n</mml:mi></mml:mrow></mml:mfenced><mml:mo>!</mml:mo></mml:mrow><mml:mrow><mml:mfenced separators="|"><mml:mrow><mml:msup><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mfenced><mml:mo>.</mml:mo><mml:mi>n</mml:mi><mml:mo>!</mml:mo></mml:mrow></mml:mfrac></mml:math></inline-formula> possible bivalent pairing conformations to be considered. Given any pair of marker loci with unknown recombination frequency <italic>r</italic>, we consider the contribution of recombinant homologues with a within-bivalent probability of <inline-formula id="IE2"><mml:math id="IM2"><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac><mml:mi>r</mml:mi></mml:math></inline-formula> and non-recombinant homologues with a within-bivalent probability of <inline-formula id="IE3"><mml:math id="IM3"><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac><mml:mo stretchy="true">(</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>r</mml:mi><mml:mo>)</mml:mo></mml:math></inline-formula>. In cases where recombinants and non-recombinations cannot be distinguished, both are assigned a probability of <inline-formula id="IE4"><mml:math id="IM4"><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac></mml:math></inline-formula>. Assuming random pairing, the probability of any particular pairing configuration is 1/c (in the case of preferential pairing, we introduce a preferential pairing factor to model deviations from randomness here).</p>
        <p>The expected frequency of each offspring class <inline-formula id="IE6"><mml:math id="IM5"><mml:mi>n</mml:mi></mml:math></inline-formula> (<inline-formula id="IE7"><mml:math id="IM6"><mml:mn>0</mml:mn><mml:mo>≤</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>≤</mml:mo><mml:mn>2</mml:mn><mml:mi>n</mml:mi></mml:math></inline-formula>) is first summed over all <italic>c</italic> bivalent conformations:
<disp-formula id="E1"><mml:math id="M1"><mml:mi>E</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mrow><mml:munderover><mml:mo stretchy="true">∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:munderover><mml:mrow><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:mrow><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>r</mml:mi><mml:mo>)</mml:mo></mml:math></disp-formula>
where <inline-formula id="IE8"><mml:math id="IM7"><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal"> </mml:mi><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>r</mml:mi><mml:mo>)</mml:mo></mml:math></inline-formula> denotes a function of <inline-formula id="IE9"><mml:math id="IM8"><mml:mi>r</mml:mi></mml:math></inline-formula> and <inline-formula id="IE10"><mml:math id="IM9"><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>r</mml:mi></mml:math></inline-formula>, dependant on the marker combination considered. Given these expected frequencies, we relate them to the observed counts of individuals in each class <inline-formula id="IE11"><mml:math id="IM10"><mml:mrow><mml:mi>O</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:math></inline-formula> to yield the likelihood function <inline-formula id="IE12"><mml:math id="IM11"><mml:mi mathvariant="script">L</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:mfenced></mml:math></inline-formula>:
<disp-formula id="E2"><mml:math id="M2"><mml:mi mathvariant="script">L</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:mfenced><mml:mo>∝</mml:mo><mml:mi mathvariant="normal"> </mml:mi><mml:mrow><mml:munderover><mml:mo stretchy="true">∏</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mi>n</mml:mi></mml:mrow></mml:munderover><mml:mrow><mml:msup><mml:mrow><mml:mi>E</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mi>O</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:math></disp-formula>
The likelihood equation is found by equating the first derivative of the log of the likelihood function (differentiated with respect to <italic>r</italic>) with zero:
<disp-formula id="E3"><mml:math id="M3"><mml:mrow><mml:munderover><mml:mo stretchy="true">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mi>n</mml:mi></mml:mrow></mml:munderover><mml:mrow><mml:mfenced separators="|"><mml:mrow><mml:mi>O</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mi mathvariant="normal"> </mml:mi><mml:mo>.</mml:mo><mml:mi mathvariant="normal"> </mml:mi><mml:mrow><mml:munderover><mml:mo stretchy="true">∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:munderover><mml:mrow><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:mrow><mml:mfrac><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:mfrac><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mo>⁡</mml:mo><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mfenced separators="|"><mml:mrow><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>r</mml:mi></mml:mrow></mml:mfenced><mml:mo>)</mml:mo></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mrow></mml:math></disp-formula></p>
        <p>In cases where no analytical solution exists, we use Brent’s algorithm (<xref rid="bty371-B7" ref-type="bibr">Brent, 1973</xref>) to numerically maximize the log likelihood function in the bounded interval <inline-formula id="IE13"><mml:math id="IM12"><mml:mn>0</mml:mn><mml:mo>≤</mml:mo><mml:mi>r</mml:mi><mml:mo>&lt;</mml:mo><mml:mn>0.5</mml:mn></mml:math></inline-formula>. For any pair of markers there are a number of possible phases between these markers to consider, which describe the physical linkage between marker alleles. In the case of a pair of duplex × nulliplex (2×0) markers, these phases are termed ‘coupling’, ‘mixed’ and ‘repulsion’ (<xref ref-type="fig" rid="bty371-F1">Fig. 1a</xref>). As the phase between markers is initially unknown, we must compute expressions for each of the possible phases, and select the most likely as the phase for which <inline-formula id="IE14"><mml:math id="IM13"><mml:mn>0</mml:mn><mml:mo>≤</mml:mo><mml:mi>r</mml:mi><mml:mo>&lt;</mml:mo><mml:mn>0.5</mml:mn></mml:math></inline-formula> and which maximizes the log of the likelihood (<xref rid="bty371-B14" ref-type="bibr">Hackett <italic>et al.</italic>, 2013</xref>).
</p>
        <fig id="bty371-F1" orientation="portrait" position="float">
          <label>Fig. 1.</label>
          <caption>
            <p>Phase considerations and clustering strategy in a tetraploid. (<bold>a</bold>) The three phases considered for a pair of 2 × 0 markers, from left to right, ‘coupling’, ‘mixed’ and ‘repulsion’; (<bold>b</bold>) In the case of preferential pairing between homologues 1–2 and 3–4, we must consider two separate types of coupling phase, either coupling within preferential bivalents (left) or coupling between preferential bivalents (right). In the extreme case of an allotetraploid, this distinction could also be termed ‘subgenome-specific’ versus ‘subgenome-straddling’; (<bold>c</bold>) Simplex × nulliplex (1 × 0) markers (solid black dots) uniquely define homologous chromosomes and are initially clustered together. Higher-dosage marker types such as duplex × nulliplex (2 × 0) markers (dark grey) provide linkage associations between simplex × nulliplex homologues, helping to identify chromosomal linkage groups. Cross-parental markers such as simplex × simplex (1 × 1, light grey) can also link these groups together, leading to consistent linkage group numbering across parents</p>
          </caption>
          <graphic xlink:href="bty371f1"/>
        </fig>
        <p>Finally, we also compute the logarithm of odds (LOD) score, which provides a useful measure of the confidence in the estimate and is used for both marker clustering and marker ordering:
<disp-formula id="E4"><mml:math id="M4"><mml:mi mathvariant="normal">L</mml:mi><mml:mi mathvariant="normal">O</mml:mi><mml:mi mathvariant="normal">D</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">g</mml:mi></mml:mrow><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:msub><mml:mfenced separators="|"><mml:mrow><mml:mfrac><mml:mrow><mml:mi mathvariant="script">L</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="normal"> </mml:mi><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mi mathvariant="script">L</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="normal"> </mml:mi><mml:mn>0.5</mml:mn></mml:mrow></mml:mfenced></mml:mrow></mml:mfrac></mml:mrow></mml:mfenced></mml:math></disp-formula>
where <inline-formula id="IE15"><mml:math id="IM14"><mml:mover accent="true"><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:math></inline-formula> is the maximum likelihood estimate of <italic>r</italic>.</p>
      </sec>
      <sec>
        <title>2.2.2 Linkage analysis in the presence of preferential chromosomal pairing</title>
        <p>In certain polyploid species the meiotic pairing is neither fully random nor fully partitioned into exclusively pairing subgenomes, a situation described as segmental allopolyploidy (<xref rid="bty371-B27" ref-type="bibr">Stebbins, 1947</xref>). Regardless of the underlying mechanism, the result of preferential pairing is that both the segregation ratios and the co-inheritance of marker alleles are affected. In the example of a 2×0 marker introduced earlier, the expected segregation ratio in a polysomic autotetraploid is 1:4:1. With increasing preferential pairing, this ratio will approach 1:2:1 in the case of subgenome-straddling markers (<xref ref-type="fig" rid="bty371-F1">Fig. 1b</xref>, right), or approach non-segregation in the case of subgenome-specific markers (<xref ref-type="fig" rid="bty371-F1">Fig. 1b</xref>, left).</p>
        <p>In order to model this behaviour, we introduce a preferential pairing parameter <italic>ρ</italic>, such that (in the case of a tetraploid) the probability of the chromosome pairing configuration 1–2/3–4 is <inline-formula id="IE16"><mml:math id="IM15"><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mo>ρ</mml:mo></mml:math></inline-formula> and the probability of pairing configurations 1–3/2–4 and 1–4/2–3 is <inline-formula id="IE17"><mml:math id="IM16"><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:mfrac><mml:mo>-</mml:mo><mml:mfrac><mml:mrow><mml:mo>ρ</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac></mml:math></inline-formula>. Attempting to model preferential pairing at higher ploidy levels introduces further complications; <xref rid="bty371-B38" ref-type="bibr">Zhu <italic>et al.</italic> (2016)</xref> have proposed a solution for hexaploids by introducing three preferential pairing parameters <italic>θ<sub>1</sub></italic>, <italic>θ<sub>2</sub></italic> and <italic>θ<sub>3</sub></italic> to model deviations in bivalent configuration 1–2, 3–4 and 5–6, respectively, with all other configurations having a probability of <inline-formula id="IE18"><mml:math id="IM17"><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>15</mml:mn></mml:mrow></mml:mfrac><mml:mo>-</mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>12</mml:mn></mml:mrow></mml:mfrac><mml:mo stretchy="true">(</mml:mo><mml:msub><mml:mrow><mml:mo>θ</mml:mo></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mo>θ</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mo>θ</mml:mo></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:math></inline-formula>. In our software, we have not yet attempted to model segmental allohexaploidy, and confine our attention to the tetraploid level for now.</p>
        <p>We do not simultaneously estimate <italic>ρ</italic> and <italic>r</italic>, which can lead to an over-estimation of the preferential pairing parameter (<xref rid="bty371-B36" ref-type="bibr">Wu <italic>et al.</italic>, 2002</xref>). Instead, we estimate the chromosome-wide strength of preferential pairing after map construction and thereafter include it as a (parent and chromosome-specific) constant in the likelihood framework to correct the pairwise recombination frequency estimates. A robust method of preferential pairing detection and estimation is to use inheritance probability estimates such as those provided by TetraOrigin (<xref rid="bty371-B37" ref-type="bibr">Zheng <italic>et al.</italic>, 2016</xref>); in polymapR we offer a simpler likelihood-based approach which uses closely-linked repulsion marker pairs to test for deviations from random pairing and simultaneously estimate the strength of this deviation. As described in <xref rid="bty371-B3" ref-type="bibr">Bourke <italic>et al.</italic> (2017)</xref>, tightly-linked pairs of SxN markers in repulsion phase identified as being on preferentially-pairing homologues can be used to estimate <italic>ρ</italic>. The expected frequency of offspring classes n<sub>00</sub>, n<sub>01</sub>, n<sub>10</sub> and n<sub>11</sub> (where n<sub>01</sub> is the number of offspring with a dosage of 0 at marker A and 1 at marker B etc.) are given by <inline-formula id="IE19"><mml:math id="IM18"><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>6</mml:mn></mml:mrow></mml:mfrac><mml:mo>-</mml:mo><mml:mfrac><mml:mrow><mml:mo>ρ</mml:mo></mml:mrow><mml:mrow><mml:mn>4</mml:mn></mml:mrow></mml:mfrac></mml:math></inline-formula>, <inline-formula id="IE20"><mml:math id="IM19"><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mo>ρ</mml:mo></mml:mrow><mml:mrow><mml:mn>4</mml:mn></mml:mrow></mml:mfrac></mml:math></inline-formula>, <inline-formula id="IE21"><mml:math id="IM20"><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mo>ρ</mml:mo></mml:mrow><mml:mrow><mml:mn>4</mml:mn></mml:mrow></mml:mfrac></mml:math></inline-formula> and <inline-formula id="IE22"><mml:math id="IM21"><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>6</mml:mn></mml:mrow></mml:mfrac><mml:mo>-</mml:mo><mml:mfrac><mml:mrow><mml:mo>ρ</mml:mo></mml:mrow><mml:mrow><mml:mn>4</mml:mn></mml:mrow></mml:mfrac></mml:math></inline-formula>, respectively. This gives rise to the likelihood function <inline-formula id="IE23"><mml:math id="IM22"><mml:mi mathvariant="script">L</mml:mi><mml:mo>(</mml:mo><mml:mo>ρ</mml:mo><mml:mo>)</mml:mo><mml:mo>∝</mml:mo><mml:msup><mml:mrow><mml:mfenced separators="|"><mml:mrow><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>6</mml:mn></mml:mrow></mml:mfrac><mml:mo>-</mml:mo><mml:mfrac><mml:mrow><mml:mo>ρ</mml:mo></mml:mrow><mml:mrow><mml:mn>4</mml:mn></mml:mrow></mml:mfrac></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mn>00</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mn>11</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msup><mml:mo>.</mml:mo><mml:msup><mml:mrow><mml:mfenced separators="|"><mml:mrow><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mo>ρ</mml:mo></mml:mrow><mml:mrow><mml:mn>4</mml:mn></mml:mrow></mml:mfrac></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mn>01</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msup></mml:math></inline-formula>, which when solved leads to the following maximum-likelihood estimate for <inline-formula id="IE24"><mml:math id="IM23"><mml:mo>ρ</mml:mo></mml:math></inline-formula>:
<disp-formula id="E5"><mml:math id="M5"><mml:mo>ρ</mml:mo><mml:mo>=</mml:mo><mml:mi mathvariant="normal"> </mml:mi><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:mfenced separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mn>01</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>-</mml:mo><mml:mn>4</mml:mn><mml:mfenced separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mn>00</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mn>11</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mi mathvariant="normal"> </mml:mi></mml:mrow><mml:mrow><mml:mn>3</mml:mn><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mn>00</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mn>01</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mn>11</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mfrac></mml:math></disp-formula></p>
        <p>Given a parent- and chromosome-specific estimate for the preferential pairing factor <italic>ρ</italic>, we modify the expression for the expected frequency of individuals in marker class <inline-formula id="IE25"><mml:math id="IM24"><mml:mi>n</mml:mi></mml:math></inline-formula> of a tetraploid as follows:
<disp-formula id="E6"><mml:math id="M6"><mml:mi>E</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mfenced separators="|"><mml:mrow><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mo>ρ</mml:mo></mml:mrow></mml:mfenced><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mfenced separators="|"><mml:mrow><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>r</mml:mi></mml:mrow></mml:mfenced><mml:mo>+</mml:mo><mml:mfenced separators="|"><mml:mrow><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:mfrac><mml:mo>-</mml:mo><mml:mfrac><mml:mrow><mml:mo>ρ</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac></mml:mrow></mml:mfenced><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mfenced separators="|"><mml:mrow><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>r</mml:mi></mml:mrow></mml:mfenced><mml:mo>+</mml:mo><mml:mi mathvariant="normal"> </mml:mi><mml:mfenced separators="|"><mml:mrow><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:mfrac><mml:mo>-</mml:mo><mml:mfrac><mml:mrow><mml:mo>ρ</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac></mml:mrow></mml:mfenced><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:mfenced separators="|"><mml:mrow><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>r</mml:mi></mml:mrow></mml:mfenced></mml:math></disp-formula>
Due to the lack of symmetry, we must consider all possible conformations <italic>within</italic> each phase, an example of which is shown in <xref ref-type="fig" rid="bty371-F1">Figure 1b</xref>. The procedure for estimating <italic>r</italic> and LOD remain otherwise the same. The inclusion of preferential pairing imposes an extra computational burden as each phase can have up to four sub-phase conformations, all of which are calculated prior to selection of the most likely phase and its associated <italic>r</italic> and LOD score.</p>
        <p>Finally, in both the case of random and preferential pairing, linkage calculations can be run in parallel using doParallel (<xref rid="bty371-B20" ref-type="bibr">Microsoft Corporation and Weston, 2017</xref>) on any Windows or Unix-like multi-core desktop computer, resulting in significant time-savings. High-density marker datasets with tens of thousands of markers can be processed in a few hours.</p>
      </sec>
    </sec>
    <sec>
      <title>2.3 Linkage group assignment</title>
      <p>In diploid studies, the term linkage group is loosely synonymous with the term chromosome. In autopolyploids two levels of linkage group exist—homologue groups and integrated chromosomal groups. The first step in linkage group assignment is to cluster the 1×0 linkage data into homologue groups, for which we currently use the R package igraph (<xref rid="bty371-B8" ref-type="bibr">Csardi and Nepusz, 2006</xref>). Clustering is performed using the pairwise linkage LOD scores, although the LOD for independence can be used if desired, which may be more robust with skewed marker data (<xref rid="bty371-B31" ref-type="bibr">Van Ooijen and Jansen, 2013</xref>).</p>
      <p>A number of visual aids are provided to assist in clustering (<xref ref-type="fig" rid="bty371-F2">Fig. 2</xref>). In general, clustering should be performed over a suitable range of LOD thresholds (e.g. from LOD 3–10) in order to inform the choice of LOD score to partition the data into both homologues and chromosomes (<xref ref-type="fig" rid="bty371-F2">Fig. 2a and b</xref>). If chromosome and homologue clusters cannot be readily identified using 1×0 markers alone, coupling-phase homologue clusters are first identified at a high LOD and later re-connected into chromosomal clusters using a higher-dose marker type (<xref ref-type="fig" rid="bty371-F1">Fig. 1c</xref>). Visualizations help display the strength of associations between homologues (<xref ref-type="fig" rid="bty371-F2">Fig. 2c</xref>). Occasionally complete homologue clusters might be broken up in the clustering step (perhaps due to uneven marker distribution or noisy data); various approaches to merge these fragments into complete homologues are provided (<xref ref-type="fig" rid="bty371-F2">Fig. 2d–f</xref>).
</p>
      <fig id="bty371-F2" orientation="portrait" position="float">
        <label>Fig. 2.</label>
        <caption>
          <p>Example visualizations produced by polymapR to facilitate linkage group identification and marker clustering. (<bold>a</bold>) As LOD score is increased, the number of 1 × 0 clusters increases, as does the number of single-marker clusters (unlinked markers). For a given ploidy and chromosome base number, the expected number of (homologue) clusters is also shown; (<bold>b</bold>) Alternative representation of (<bold>a</bold>) which shows the splitting of each cluster as the LOD score is increased. In this example, five chromosomal clusters are identified at LOD 3.5, which split into four homologue clusters between LOD 4.5 and 7; (<bold>c</bold>) Using linkage to other marker segregation types such as 2 × 0 markers, homologue clusters can be associated into chromosomal clusters, if this was not achieved using 1 × 0 data alone. Here, five chromosomes are represented; (<bold>d</bold>) If homologues fragment, cross-homologue phase information can help determine which fragments to merge. Here, homologues 4 and 5 show only coupling-phase linkage and should therefore be joined as a single homologue; (<bold>e</bold>) Alternative approach to merge fragments showing network of linkages over a range of LOD scores. Here, four homologues were successfully identified and merged directly; (<bold>f</bold>) Alternative representation of (e), showing these connections in a circular format instead</p>
        </caption>
        <graphic xlink:href="bty371f2"/>
      </fig>
      <p>In the case of triploid populations, the phasing approach differs between the diploid and tetraploid parents: for the diploid parent, phasing can be achieved directly using the phase assignment from the linkage analysis. Following the definition of the chromosome and homologue structure using the 1×0 markers, all other marker segregation classes are assigned to both homologues and chromosomes using their linkage to these markers, generating the final phase assignment of all marker types.</p>
    </sec>
    <sec>
      <title>2.4 Marker ordering</title>
      <p>One of the challenges of marker ordering and map construction in autopolyploid species using marker dosages is the variable accuracy of recombination frequency estimates which must be integrated somehow. Ordering algorithms which only use unweighted recombination frequency estimates are unlikely to find an optimal map order, as there is no distinction between equal estimates of <italic>r</italic> from situations with vastly different information contents and variances. A thorough description of this issue is provided in <xref rid="bty371-B21" ref-type="bibr">Preedy and Hackett (2016)</xref>. Within the polymapR package, marker ordering can be achieved in two ways—either using the weighted regression algorithm as originally developed by <xref rid="bty371-B26" ref-type="bibr">Stam (1993)</xref> and implemented in JoinMap (<xref rid="bty371-B30" ref-type="bibr">Van Ooijen, 2006</xref>) and now also in polymapR, or to use the multi-dimensional scaling algorithm as implemented in the MDSMap package (<xref rid="bty371-B21" ref-type="bibr">Preedy and Hackett, 2016</xref>). Given the computation efficiency of the MDS algorithm, in almost all circumstances this will be the preferred choice. Identical markers that were originally set aside can be added back to the final maps after marker ordering is complete. Marker positions (in centiMorgans) are also calculated by MDSMap, by default using the projected positions of markers on a fitted Principal Curve (more details are provided by the authors <xref rid="bty371-B21" ref-type="bibr">Preedy and Hackett, 2016</xref>).</p>
    </sec>
  </sec>
  <sec>
    <title>3 Results</title>
    <sec>
      <title>3.1 Software output—final linkage maps</title>
      <p>The final output of the polymapR package is a phased integrated map. Maps can either be generated per homologue or per chromosome, facilitating the definition of haplotypes within a population. A record is kept in a log file of any markers that were removed at any stage during the procedure, as well as logging the function calls that generated each step, improving project reproducibility and later reporting. Visualizations are provided throughout the mapping procedure, facilitating the diagnosis of issues as well as summarizing the results. An example of an integrated map with five chromosomes, generated using the sample data provided with the package, is shown in <xref ref-type="fig" rid="bty371-F3">Figure 3a</xref>. Phased linkage maps, giving the position of the SNP alleles on each parental homologue are also generated, as visualized in <xref ref-type="fig" rid="bty371-F3">Figure 3b</xref> for a triploid species. For tetraploid datasets polymapR can generate input files for TetraOrigin (<xref rid="bty371-B37" ref-type="bibr">Zheng <italic>et al.</italic>, 2016</xref>) which can calculate IBD probabilities for the population, useful for QTL analysis. Alternatively, input files for TetraploidSNPMap (<xref rid="bty371-B13" ref-type="bibr">Hackett <italic>et al.</italic>, 2017</xref>) can be generated with which QTL analysis can be directly performed.
</p>
      <fig id="bty371-F3" orientation="portrait" position="float">
        <label>Fig. 3.</label>
        <caption>
          <p>Linkage map visualizations of polymapR. (<bold>a</bold>) Integrated chromosomal linkage maps generated using the sample tetraploid dataset provided with the package, with each marker segregation type highlighted; (<bold>b</bold>) Phased homologue-specific maps of a single chromosomal linkage group from a triploid dataset (simulated with PedigreeSim; <xref rid="bty371-B33" ref-type="bibr">Voorrips and Maliepaard, 2012</xref>). Maternal homologue maps (h1–h4) from the tetraploid parent are shown on the left, and paternal homologue maps (h5–h6) from the diploid parent are shown on the right, with the integrated chromosomal map in the middle</p>
        </caption>
        <graphic xlink:href="bty371f3"/>
      </fig>
    </sec>
    <sec>
      <title>3.2 Application of polymapR to real data</title>
      <p>Various developmental versions of the polymapR package have been used for linkage map construction in potato, rose and chrysanthemum (<xref rid="bty371-B4" ref-type="bibr">Bourke <italic>et al.</italic>, 2016</xref><xref rid="bty371-B3" ref-type="bibr">, 2017</xref>; <xref rid="bty371-B35" ref-type="bibr">Vukosavljev <italic>et al.</italic>, 2016</xref>; <xref rid="bty371-B29" ref-type="bibr">van Geest <italic>et al.</italic>, 2017b</xref>). The current version brings together all the capacities developed previously, while extending the algorithm to triploid populations as well (produced in a tetraploid × diploid cross). Cross-ploidy hybrids are commonly produced in ornamental breeding, as well as in certain fruit species such as banana (<italic>Musa</italic> spp.), watermelon (<italic>Citrullus lanatus</italic> var. <italic>lanatus</italic>) or grape (<italic>Vitis vinifera</italic>) to generate seedless fruit (<xref rid="bty371-B1" ref-type="bibr">Acquaah, 2012</xref>). polymapR is applicable to a wide range of commercially-important crop species such as potato, leek, alfalfa, blueberry, chrysanthemum, sweet potato and kiwifruit, as well as the myriad of cross-ploidy populations developed in ornamental and fruit breeding programmes.</p>
    </sec>
  </sec>
  <sec>
    <title>4 Discussion</title>
    <sec>
      <title>4.1 Comparison with other polyploid mapping software</title>
      <p>The range of options for linkage mapping in autopolyploid species is quite limited. We compared the performance and applicability of polymapR with two alternative softwares (TetraploidSNPMap (TSNPM) and PERGOLA).</p>
      <sec>
        <title>4.1.1 TetraploidSNPMap</title>
        <p>TSNPM possesses a graphical user interface for Windows, uses optimized routines for marker clustering and offers interactive cluster plots for linkage group assignment. It goes beyond linkage map construction to compute IBD probabilities and perform QTL interval mapping as well. Given that polymapR uses the same random bivalent pairing assumption and the same ordering algorithm (MDSMap; <xref rid="bty371-B21" ref-type="bibr">Preedy and Hackett, 2016</xref>), we did not expect much difference in output. Using the sample tetraploid dataset provided with polymapR (with 3000 markers over five chromosomes and 207 F<sub>1</sub> individuals, including seven pairs of duplicate individuals), polymapR produced phased maps within 24 min on an Intel i7 desktop with 16 Gb RAM; TSNPM took 5 min, but took another 10 minutes to phase (so a total of 15 min were needed). However, the phased output of TSNPM is more difficult to interpret than that of polymapR and would likely require extra time for curation. The maps themselves were remarkably similar in terms of numbers of mapped markers map length and marker order (<xref ref-type="supplementary-material" rid="sup1">Supplementary Fig. S1</xref>).</p>
        <p>Marker phasing in polymapR is automatic, by selecting phase based on the counts of significant linkages to 1×0 homologue clusters and ignoring any spurious linkages that go against the general trend. On the other hand, phase assignment seems to (generally) require manual intervention in the TSNPM pipeline. Despite its computational efficiency, TSNPM has also set an upper limit of 8000 SNP markers, and the maximum mapping population size is currently 300 F<sub>1</sub> individuals. polymapR sets no limits on marker numbers or population sizes, employing parallel processing to help speed up calculations for large datasets. Duplicated markers are initially binned (also possible in TSNPM) and identical individuals are merged (this feature was missing from TSNPM) to avoid needless calculations. Overall, the main difference between TSNPM and polymapR appears to be in applicability: polymapR can analyse autotriploid, autotetraploid, autohexaploid as well as segmental allotetraploid data, whereas TSNPM is currently confined to autotetraploid data. polymapR is also cross-platform given that it is written in R (<xref rid="bty371-B22" ref-type="bibr">R Core Team, 2016</xref>).</p>
      </sec>
      <sec>
        <title>4.1.2 PERGOLA</title>
        <p>The PERGOLA package in R has been developed for F<sub>2</sub> or backcross populations from an initial cross between homozygous parents. Such a situation is highly unusual for most polysomic polyploids, since inbreeding requires many more generations before homozygosity is reached compared to a diploid or disomic polyploid. In a polysomic hexaploid for example, it would take 25 generations of selfing an F<sub>1</sub> individual before 90% homozygosity is reached (ignoring the effects of double reduction; <xref rid="bty371-B16" ref-type="bibr">Haldane, 1930</xref>). The applicability of the PERGOLA software to real populations in polysomic polyploids is therefore limited.</p>
        <p>Despite the highly unusual type of population, we simulated a small F<sub>2</sub> dataset of selfed F<sub>1</sub> individuals randomly chosen from a cross between two inbred parental lines using PedigreeSim (<xref rid="bty371-B33" ref-type="bibr">Voorrips and Maliepaard, 2012</xref>), leading to a marker dataset of 500 duplex × duplex markers over five chromosomes. The calculation of recombination frequencies took a mere 3.54 s in PERGOLA, in comparison to 28 min using polymapR (on a single core; using 6 cores this step took 8 min). However, for polymapR this particular marker combination is complex, with nine possible phase combinations in the parents to be separately calculated per marker pair, and with extremely complicated likelihood functions for each phase (all 25 dosage combinations are possible in a tetraploid, from <italic>n<sub>00</sub></italic> to <italic>n<sub>44</sub></italic>). It is therefore a somewhat unfair comparison, as PERGOLA labours under no such ‘generalist’ difficulties. Phase considerations are trivial and therefore ignored by PERGOLA because of their simplistic population assumptions. If such populations could be generated, PERGOLA would produce excellent maps. In our test, PERGOLA identified all five chromosomes, with near perfect marker order in each, although the map lengths were inflated—from 200 cm using the Kosambi mapping function to 400 cm using Haldane’s (when 100 cm was expected). polymapR also produced near-perfect maps with map-lengths of ∼90 cm using Haldane’s mapping function. The polymapR package can handle data from both cross-pollinating <italic>and</italic> inbred populations whereas PERGOLA cannot, but given the performance difference, PERGOLA would appear to be the software of choice for inbred polyploid populations, should they be developed.</p>
      </sec>
    </sec>
    <sec>
      <title>4.2 Robustness against genotyping errors</title>
      <p>Of potential concern is the effect of genotyping errors on the mapping pipeline. We ran a small simulation study using the previously-mapped potato chromosome 10 (<xref rid="bty371-B4" ref-type="bibr">Bourke <italic>et al.</italic>, 2016</xref>) and five F<sub>1</sub> populations (<italic>n</italic> = 200) simulated in PedigreeSim (<xref rid="bty371-B33" ref-type="bibr">Voorrips and Maliepaard, 2012</xref>) with randomized errors in the offspring dosages (error rates of 0, 2, 5, 10, 20 and 50%). At the higher rates of error (&gt;20%) many markers would (by default) be filtered out due to skewness or poor concordance between parents and offspring scores (<xref ref-type="supplementary-material" rid="sup1">Supplementary Fig. S2</xref>). In general, error rates of up to 10% appear to be acceptable in terms of marker order, while higher rates will likely lead to map inflation and poorer marker orders.</p>
    </sec>
    <sec>
      <title>4.3 Concluding remarks</title>
      <p>The development and release of polymapR comes at a time when there is increasing need for tools to perform genetic analysis in polyploids. Understanding the genetic control of important biological traits in polyploid species will have a large impact on plant breeding (or in the case of certain salmonid fish, animal breeding as well), facilitating the adoption of genomics-driven breeding decisions such as marker-assisted selection or genomic prediction into breeding programmes. For these advances to take place, high-density and accurate maps showing the relative position of markers on chromosomal groups are needed—which is precisely what polymapR delivers.</p>
    </sec>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material content-type="local-data" id="sup1">
      <label>Supplementary Data</label>
      <media xlink:href="bty371_supplementary_figures.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <title>Acknowledgements</title>
    <p>The authors wish to thank Dr Katherine Preedy and Dr Christine A. Hackett (Biomathematics Scotland, Dundee, Scotland) for providing a developmental version of the MDSMap scripts before their package became publicly available, and to Dr Johan van Ooijen (Kyazma B.V. Wageningen, The Netherlands) for helpful comments. The polyploid project partners are gratefully acknowledged for their feedback and contributions in the development of this software. The authors also wish to thank the three anonymous reviewers and editor for their comments, which improved the final article.</p>
    <sec>
      <title>Funding</title>
      <p>This work was supported by the TKI projects ‘A genetic analysis pipeline for polyploid crops’ [grant number BO-26.03-002-001] and ‘Novel genetic and genomic tools for polyploid crops’ [grant numbers BO-26.03-009-004, BO-50-002-022].</p>
      <p><italic>Conflict of Interest</italic>: none declared.</p>
    </sec>
  </ack>
  <ref-list>
    <title>References</title>
    <ref id="bty371-B1">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name name-style="western"><surname>Acquaah</surname><given-names>G.</given-names></name></person-group> (<year>2012</year>). <source>Principles of Plant Genetics and Breeding</source>. 
<publisher-name>Wiley-Blackwell</publisher-name> , West Sussex, UK.</mixed-citation>
    </ref>
    <ref id="bty371-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Bomblies</surname><given-names>K.</given-names></name></person-group><etal>et al</etal> (<year>2016</year>) 
<article-title>The challenge of evolving stable polyploidy: could an increase in “crossover interference distance” play a central role?</article-title><source>Chromosoma</source>, <volume>125</volume>, <fpage>287</fpage>–<lpage>300</lpage>.<pub-id pub-id-type="pmid">26753761</pub-id></mixed-citation>
    </ref>
    <ref id="bty371-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Bourke</surname><given-names>P.M.</given-names></name></person-group><etal>et al</etal> (<year>2017</year>) 
<article-title>Partial preferential chromosome pairing is genotype dependent in tetraploid rose</article-title>. <source>Plant J</source>., <volume>90</volume>, <fpage>330</fpage>–<lpage>343</lpage>.<pub-id pub-id-type="pmid">28142191</pub-id></mixed-citation>
    </ref>
    <ref id="bty371-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Bourke</surname><given-names>P.M.</given-names></name></person-group><etal>et al</etal> (<year>2016</year>) 
<article-title>Integrating haplotype-specific linkage maps in tetraploid species using SNP markers</article-title>. <source>Theor. Appl. Genet</source>., <volume>129</volume>, <fpage>2211</fpage>–<lpage>2226</lpage>.<pub-id pub-id-type="pmid">27561740</pub-id></mixed-citation>
    </ref>
    <ref id="bty371-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Bourke</surname><given-names>P.M.</given-names></name></person-group><etal>et al</etal> (<year>2015</year>) 
<article-title>The double reduction landscape in tetraploid potato as revealed by a high-density linkage map</article-title>. <source>Genetics</source>, <volume>201</volume>, <fpage>853</fpage>–<lpage>863</lpage>.<pub-id pub-id-type="pmid">26377683</pub-id></mixed-citation>
    </ref>
    <ref id="bty371-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Bradshaw</surname><given-names>J.E.</given-names></name></person-group><etal>et al</etal> (<year>2008</year>) 
<article-title>QTL mapping of yield, agronomic and quality traits in tetraploid potato (<italic>Solanum tuberosum</italic> subsp. <italic>tuberosum</italic>)</article-title>. <source>Theor. Appl. Genet</source>., <volume>116</volume>, <fpage>193</fpage>–<lpage>211</lpage>.<pub-id pub-id-type="pmid">17938877</pub-id></mixed-citation>
    </ref>
    <ref id="bty371-B7">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name name-style="western"><surname>Brent</surname><given-names>R.</given-names></name></person-group> (<year>1973</year>). <source>Algorithms for Minimizing Without Derivatives</source>. 
<publisher-name>Prentice-Hall</publisher-name>, 
<publisher-loc>Englewood Cliffs, NJ</publisher-loc>.</mixed-citation>
    </ref>
    <ref id="bty371-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Csardi</surname><given-names>G.</given-names></name>, <name name-style="western"><surname>Nepusz</surname><given-names>T.</given-names></name></person-group> (<year>2006</year>) 
<article-title>The igraph software package for complex network research</article-title>. <source>InterJ. Complex Syst</source>., <volume>1695</volume>, <fpage>1</fpage>–<lpage>9</lpage>.</mixed-citation>
    </ref>
    <ref id="bty371-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Felcher</surname><given-names>K.J.</given-names></name></person-group><etal>et al</etal> (<year>2012</year>) 
<article-title>Integration of two diploid potato linkage maps with the potato genome sequence</article-title>. <source>PLoS One</source>, <volume>7</volume>, <fpage>e36347</fpage>.<pub-id pub-id-type="pmid">22558443</pub-id></mixed-citation>
    </ref>
    <ref id="bty371-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Gar</surname><given-names>O.</given-names></name></person-group><etal>et al</etal> (<year>2011</year>) 
<article-title>An autotetraploid linkage map of rose (<italic>Rosa hybrida</italic>) validated using the strawberry (<italic>Fragaria vesca</italic>) genome sequence</article-title>. <source>PLoS One</source>, <volume>6</volume>, <fpage>e20463</fpage>.<pub-id pub-id-type="pmid">21647382</pub-id></mixed-citation>
    </ref>
    <ref id="bty371-B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Grandke</surname><given-names>F.</given-names></name></person-group><etal>et al</etal> (<year>2017</year>) 
<article-title>PERGOLA: fast and deterministic linkage mapping of polyploids</article-title>. <source>BMC Bioinformatics</source>, <volume>18</volume>, <fpage>12.</fpage><pub-id pub-id-type="pmid">28049428</pub-id></mixed-citation>
    </ref>
    <ref id="bty371-B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Hackett</surname><given-names>C.</given-names></name>, <name name-style="western"><surname>Luo</surname><given-names>Z.</given-names></name></person-group> (<year>2003</year>) 
<article-title>TetraploidMap: construction of a linkage map in autotetraploid species</article-title>. <source>J. Hered</source>., <volume>94</volume>, <fpage>358</fpage>–<lpage>359</lpage>.<pub-id pub-id-type="pmid">12920109</pub-id></mixed-citation>
    </ref>
    <ref id="bty371-B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Hackett</surname><given-names>C.A.</given-names></name></person-group><etal>et al</etal> (<year>2017</year>) 
<article-title>TetraploidSNPMap: software for linkage analysis and QTL mapping in autotetraploid populations using SNP dosage data</article-title>. <source>J. Hered</source>., <volume>108</volume>, <fpage>438</fpage>–<lpage>442</lpage>.</mixed-citation>
    </ref>
    <ref id="bty371-B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Hackett</surname><given-names>C.A.</given-names></name></person-group><etal>et al</etal> (<year>2013</year>) 
<article-title>Linkage analysis and QTL mapping using SNP dosage data in a tetraploid potato mapping population</article-title>. <source>PLoS One</source>, <volume>8</volume>, <fpage>e63939.</fpage><pub-id pub-id-type="pmid">23704960</pub-id></mixed-citation>
    </ref>
    <ref id="bty371-B15">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Hackett</surname><given-names>C.A.</given-names></name></person-group><etal>et al</etal> (<year>2007</year>) 
<article-title>TetraploidMap for Windows: linkage map construction and QTL mapping in autotetraploid species</article-title>. <source>J. Hered</source>., <volume>98</volume>, <fpage>727</fpage>–<lpage>729</lpage>.<pub-id pub-id-type="pmid">17965198</pub-id></mixed-citation>
    </ref>
    <ref id="bty371-B16">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Haldane</surname><given-names>J.B.</given-names></name></person-group> (<year>1930</year>) 
<article-title>Theoretical genetics of autopolyploids</article-title>. <source>J. Genet</source>., <volume>22</volume>, <fpage>359</fpage>–<lpage>372</lpage>.</mixed-citation>
    </ref>
    <ref id="bty371-B17">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Koning-Boucoiran</surname><given-names>C.F.S.</given-names></name></person-group><etal>et al</etal> (<year>2015</year>) 
<article-title>Using RNA-Seq to assemble a rose transcriptome with more than 13, 000 full-length expressed genes and to develop the WagRhSNP 68k Axiom SNP array for rose (<italic>Rosa</italic> L.)</article-title>. <source>Front. Plant. Sci</source>., <volume>6</volume>, <fpage>249</fpage>.<pub-id pub-id-type="pmid">25954285</pub-id></mixed-citation>
    </ref>
    <ref id="bty371-B18">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Li</surname><given-names>X.</given-names></name></person-group><etal>et al</etal> (<year>2014</year>) 
<article-title>Development of an alfalfa SNP array and its use to evaluate patterns of population structure and linkage disequilibrium</article-title>. <source>PLoS One</source>, <volume>9</volume>, <fpage>e84329.</fpage><pub-id pub-id-type="pmid">24416217</pub-id></mixed-citation>
    </ref>
    <ref id="bty371-B19">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Mccallum</surname><given-names>S.</given-names></name></person-group><etal>et al</etal> (<year>2016</year>) 
<article-title>Construction of a SNP and SSR linkage map in autotetraploid blueberry using genotyping by sequencing</article-title>. <source>Mol. Breeding</source>, <volume>36</volume>, <fpage>41</fpage>.</mixed-citation>
    </ref>
    <ref id="bty371-B20">
      <mixed-citation publication-type="other"><collab>Microsoft Corporation</collab> and <person-group person-group-type="author"><name name-style="western"><surname>Weston</surname><given-names>S.</given-names></name></person-group> (<year>2017</year>). doParallel: Foreach parallel adaptor for the ‘parallel’ package. <italic>R package version</italic><bold>1.0.11</bold>.</mixed-citation>
    </ref>
    <ref id="bty371-B21">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Preedy</surname><given-names>K.F.</given-names></name>, <name name-style="western"><surname>Hackett</surname><given-names>C.A.</given-names></name></person-group> (<year>2016</year>) 
<article-title>A rapid marker ordering approach for high-density genetic linkage maps in experimental autotetraploid populations using multidimensional scaling</article-title>. <source>Theor. Appl. Genet</source>., <volume>129</volume>, <fpage>2117</fpage>–<lpage>2132</lpage>.<pub-id pub-id-type="pmid">27502200</pub-id></mixed-citation>
    </ref>
    <ref id="bty371-B22">
      <mixed-citation publication-type="other"><collab>R Core Team</collab>. (<year>2016</year>). <italic>R: A Language and Environment for Statistical Computing</italic> R Foundation for Statistical Computing, Vienna, Austria. <bold>R version 3.3.2</bold>.</mixed-citation>
    </ref>
    <ref id="bty371-B23">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Robins</surname><given-names>J.G.</given-names></name></person-group><etal>et al</etal> (<year>2008</year>) 
<article-title>Genetic mapping of persistence in tetraploid alfalfa</article-title>. <source>Crop Sci</source>., <volume>48</volume>, <fpage>1780</fpage>–<lpage>1786</lpage>.</mixed-citation>
    </ref>
    <ref id="bty371-B24">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Santos</surname><given-names>J.</given-names></name></person-group><etal>et al</etal> (<year>2003</year>) 
<article-title>Partial diploidization of meiosis in autotetraploid Arabidopsis thaliana</article-title>. <source>Genetics</source>, <volume>165</volume>, <fpage>1533</fpage>–<lpage>1540</lpage>.<pub-id pub-id-type="pmid">14668400</pub-id></mixed-citation>
    </ref>
    <ref id="bty371-B25">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Schmitz Carley</surname><given-names>C.A.</given-names></name></person-group><etal>et al</etal> (<year>2017</year>) 
<article-title>Automated tetraploid genotype calling by hierarchical clustering</article-title>. <source>Theor. Appl. Genet</source>., <volume>130</volume>, <fpage>717</fpage>–<lpage>726</lpage>.<pub-id pub-id-type="pmid">28070610</pub-id></mixed-citation>
    </ref>
    <ref id="bty371-B26">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Stam</surname><given-names>P.</given-names></name></person-group> (<year>1993</year>) 
<article-title>Construction of integrated genetic linkage maps by means of a new computer package: join Map</article-title>. <source>Plant J</source>., <volume>3</volume>, <fpage>739</fpage>–<lpage>744</lpage>.</mixed-citation>
    </ref>
    <ref id="bty371-B27">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Stebbins</surname><given-names>G.L.</given-names></name></person-group> (<year>1947</year>) 
<article-title>Types of polyploids: their classification and significance</article-title>. <source>Adv. Genet</source>., <volume>1</volume>, <fpage>403</fpage>–<lpage>429</lpage>.<pub-id pub-id-type="pmid">20259289</pub-id></mixed-citation>
    </ref>
    <ref id="bty371-B28">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Van Geest</surname><given-names>G.</given-names></name></person-group><etal>et al</etal> (<year>2017a</year>) 
<article-title>An ultra-dense integrated linkage map for hexaploid chrysanthemum enables multi-allelic QTL analysis</article-title>. <source>Theor. Appl. Genet</source>., <volume>130</volume>, <fpage>2527</fpage>–<lpage>2541</lpage>.<pub-id pub-id-type="pmid">28852802</pub-id></mixed-citation>
    </ref>
    <ref id="bty371-B29">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Van Geest</surname><given-names>G.</given-names></name></person-group><etal>et al</etal> (<year>2017b</year>) 
<article-title>Conclusive evidence for hexasomic inheritance in chrysanthemum based on analysis of a 183 k SNP array</article-title>. <source>BMC Genomics</source>, <volume>18</volume>, <fpage>585.</fpage><pub-id pub-id-type="pmid">28784083</pub-id></mixed-citation>
    </ref>
    <ref id="bty371-B30">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><name name-style="western"><surname>Van Ooijen</surname><given-names>J.W.</given-names></name></person-group> (<year>2006</year>). <italic>JoinMap<sup>®</sup> 4, Software for the calculation of genetic linkage maps in experimental population</italic>s. Kyazma B.V., Wageningen, The Netherlands.</mixed-citation>
    </ref>
    <ref id="bty371-B31">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name name-style="western"><surname>Van Ooijen</surname><given-names>J.W.</given-names></name>, <name name-style="western"><surname>Jansen</surname><given-names>J.</given-names></name></person-group> (<year>2013</year>). <source>Genetic Mapping in Experimental Populations</source>. 
<publisher-name>Cambridge University Press</publisher-name>, Cambridge, UK.</mixed-citation>
    </ref>
    <ref id="bty371-B32">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Voorrips</surname><given-names>R.E.</given-names></name></person-group><etal>et al</etal> (<year>2011</year>) 
<article-title>Genotype calling in tetraploid species from bi-allelic marker data using mixture models</article-title>. <source>BMC Bioinformatics</source>, <volume>12</volume>, <fpage>172</fpage>.<pub-id pub-id-type="pmid">21595880</pub-id></mixed-citation>
    </ref>
    <ref id="bty371-B33">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Voorrips</surname><given-names>R.E.</given-names></name>, <name name-style="western"><surname>Maliepaard</surname><given-names>C.A.</given-names></name></person-group> (<year>2012</year>) 
<article-title>The simulation of meiosis in diploid and tetraploid organisms using various genetic models</article-title>. <source>BMC Bioinformatics</source>, <volume>13</volume>, <fpage>248.</fpage><pub-id pub-id-type="pmid">23013469</pub-id></mixed-citation>
    </ref>
    <ref id="bty371-B34">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Vos</surname><given-names>P.G.</given-names></name></person-group><etal>et al</etal> (<year>2015</year>) 
<article-title>Development and analysis of a 20K SNP array for potato (<italic>Solanum tuberosum</italic>): an insight into the breeding history</article-title>. <source>Theor. Appl. Genet</source>., <volume>128</volume>, <fpage>2387</fpage>–<lpage>2401</lpage>.<pub-id pub-id-type="pmid">26263902</pub-id></mixed-citation>
    </ref>
    <ref id="bty371-B35">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Vukosavljev</surname><given-names>M.</given-names></name></person-group><etal>et al</etal> (<year>2016</year>) 
<article-title>High-density SNP-based genetic maps for the parents of an outcrossed and a selfed tetraploid garden rose cross, inferred from admixed progeny using the 68k rose SNP array</article-title>. <source>Hortic Res</source>., <volume>3</volume>, <fpage>16052</fpage>.<pub-id pub-id-type="pmid">27818777</pub-id></mixed-citation>
    </ref>
    <ref id="bty371-B36">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Wu</surname><given-names>R.</given-names></name></person-group><etal>et al</etal> (<year>2002</year>) 
<article-title>A bivalent polyploid model for linkage analysis in outcrossing tetraploids</article-title>. <source>Theor. Popul. Biol</source>., <volume>62</volume>, <fpage>129</fpage>–<lpage>151</lpage>.<pub-id pub-id-type="pmid">12167353</pub-id></mixed-citation>
    </ref>
    <ref id="bty371-B37">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Zheng</surname><given-names>C.</given-names></name></person-group><etal>et al</etal> (<year>2016</year>) 
<article-title>Probabilistic multilocus haplotype reconstruction in outcrossing tetraploids</article-title>. <source>Genetics</source>, <volume>203</volume>, <fpage>119</fpage>–<lpage>131</lpage>.<pub-id pub-id-type="pmid">26920758</pub-id></mixed-citation>
    </ref>
    <ref id="bty371-B38">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Zhu</surname><given-names>X.</given-names></name></person-group><etal>et al</etal> (<year>2016</year>) 
<article-title>AlloMap6: an R package for genetic linkage analysis in allohexaploids</article-title>. <source>Brief Bioinformatics</source>, <volume>18</volume>, <fpage>919</fpage>–<lpage>927</lpage>.</mixed-citation>
    </ref>
  </ref-list>
</back>
