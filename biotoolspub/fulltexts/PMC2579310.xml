<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-title>BMC Bioinformatics</journal-title>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">2579310</article-id>
    <article-id pub-id-type="publisher-id">1471-2105-9-452</article-id>
    <article-id pub-id-type="pmid">18947404</article-id>
    <article-id pub-id-type="doi">10.1186/1471-2105-9-452</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Methodology Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Background correction using dinucleotide affinities improves the performance of GCRMA</article-title>
    </title-group>
    <contrib-group>
      <contrib id="A1" contrib-type="author">
        <name>
          <surname>Gharaibeh</surname>
          <given-names>Raad Z</given-names>
        </name>
        <xref ref-type="aff" rid="I1">1</xref>
        <email>rgharaib@uncc.edu</email>
      </contrib>
      <contrib id="A2" contrib-type="author">
        <name>
          <surname>Fodor</surname>
          <given-names>Anthony A</given-names>
        </name>
        <xref ref-type="aff" rid="I1">1</xref>
        <email>afodor@uncc.edu</email>
      </contrib>
      <contrib id="A3" corresp="yes" contrib-type="author">
        <name>
          <surname>Gibas</surname>
          <given-names>Cynthia J</given-names>
        </name>
        <xref ref-type="aff" rid="I1">1</xref>
        <email>cgibas@uncc.edu</email>
      </contrib>
    </contrib-group>
    <aff id="I1"><label>1</label>Department of Bioinformatics and Genomics, University of North Carolina at Charlotte, Charlotte, NC, 28223, USA</aff>
    <pub-date pub-type="collection">
      <year>2008</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>23</day>
      <month>10</month>
      <year>2008</year>
    </pub-date>
    <volume>9</volume>
    <fpage>452</fpage>
    <lpage>452</lpage>
    <ext-link ext-link-type="uri" xlink:href="http://www.biomedcentral.com/1471-2105/9/452"/>
    <history>
      <date date-type="received">
        <day>27</day>
        <month>3</month>
        <year>2008</year>
      </date>
      <date date-type="accepted">
        <day>23</day>
        <month>10</month>
        <year>2008</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>Copyright © 2008 Gharaibeh et al; licensee BioMed Central Ltd.</copyright-statement>
      <copyright-year>2008</copyright-year>
      <copyright-holder>Gharaibeh et al; licensee BioMed Central Ltd.</copyright-holder>
      <license license-type="open-access" xlink:href="http://creativecommons.org/licenses/by/2.0">
        <p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/2.0"/>), which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly cited.</p>
        <!--<rdf xmlns="http://web.resource.org/cc/" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:dc="http://purl.org/dc/elements/1.1" xmlns:dcterms="http://purl.org/dc/terms"><Work xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:dcterms="http://purl.org/dc/terms/" rdf:about=""><license rdf:resource="http://creativecommons.org/licenses/by/2.0"/><dc:type rdf:resource="http://purl.org/dc/dcmitype/Text"/><dc:author>
               Gharaibeh
               Z
               Raad
               
               rgharaib@uncc.edu
            </dc:author><dc:title>
            Background correction using dinucleotide affinities improves the performance of GCRMA
         </dc:title><dc:date>2008</dc:date><dcterms:bibliographicCitation>BMC Bioinformatics 9(1): 452-. (2008)</dcterms:bibliographicCitation><dc:identifier type="sici">1471-2105(2008)9:1&#x0003c;452&#x0003e;</dc:identifier><dcterms:isPartOf>urn:ISSN:1471-2105</dcterms:isPartOf><License rdf:about="http://creativecommons.org/licenses/by/2.0"><permits rdf:resource="http://web.resource.org/cc/Reproduction" xmlns=""/><permits rdf:resource="http://web.resource.org/cc/Distribution" xmlns=""/><requires rdf:resource="http://web.resource.org/cc/Notice" xmlns=""/><requires rdf:resource="http://web.resource.org/cc/Attribution" xmlns=""/><permits rdf:resource="http://web.resource.org/cc/DerivativeWorks" xmlns=""/></License></Work></rdf>-->
      </license>
    </permissions>
    <abstract>
      <sec>
        <title>Background</title>
        <p>High-density short oligonucleotide microarrays are a primary research tool for assessing global gene expression. Background noise on microarrays comprises a significant portion of the measured raw data, which can have serious implications for the interpretation of the generated data if not estimated correctly.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p>We introduce an approach to calculate probe affinity based on sequence composition, incorporating nearest-neighbor (NN) information. Our model uses position-specific dinucleotide information, instead of the original single nucleotide approach, and adds up to 10% to the total variance explained (R<sup>2</sup>) when compared to the previously published model. We demonstrate that correcting for background noise using this approach enhances the performance of the GCRMA preprocessing algorithm when applied to control datasets, especially for detecting low intensity targets.</p>
      </sec>
      <sec>
        <title>Conclusion</title>
        <p>Modifying the previously published position-dependent affinity model to incorporate dinucleotide information significantly improves the performance of the model. The dinucleotide affinity model enhances the detection of differentially expressed genes when implemented as a background correction procedure in GeneChip preprocessing algorithms. This is conceptually consistent with physical models of binding affinity, which depend on the nearest-neighbor stacking interactions in addition to base-pairing.</p>
      </sec>
    </abstract>
  </article-meta>
</front>
<body>
  <sec>
    <title>Background</title>
    <p>Affymetrix GeneChip arrays are one of the most popular gene expression array systems used by researchers worldwide [<xref ref-type="bibr" rid="B1">1</xref>]. The purpose of an expression microarray experiment is to measure the abundance of each known transcript in the sample under investigation. Abundance is inferred from the signal generated by a set of 11–20 probe pairs. Each pair is composed of a perfect match probe (PM), which exactly complements a region on the transcript, and a mismatch probe (MM), which is identical to the PM probe except at the 13<sup>th </sup>base, where the reverse complement nucleotide is introduced [<xref ref-type="bibr" rid="B2">2</xref>]. The fluorescent signal from each probe, however, includes <italic>background noise </italic>that not only measures the transcript abundance, but also non-specific binding (NSB) and autofluorescence of the chip surface. MM probes were originally introduced by Affymetrix to measure background noise. It has been shown by many groups that MM probes contain significant amount of the PM signal and are therefore unreliable as estimators of background noise [<xref ref-type="bibr" rid="B3">3</xref>-<xref ref-type="bibr" rid="B5">5</xref>].</p>
    <p>A gene expression experiment using the Affymetrix GeneChip system usually involves a design step, a preprocessing step, an inference step and finally, a validation step [<xref ref-type="bibr" rid="B6">6</xref>]. The preprocessing step is of special importance; preprocessing transforms the raw fluorescence signals from each probe in a probeset into a composite gene expression value. The main goal of the preprocessing step is to remove non-biological variation from the raw data [<xref ref-type="bibr" rid="B6">6</xref>]. Usually, the preprocessing step in Affymetrix GeneChip array analysis includes three main treatments of the raw data. A background adjustment step separates the specific signal from the non-specific signal. A probe-level normalization step then removes non-biological variation between arrays. Finally, a summarization step generates a single expression value for each gene from its corresponding probeset. The method described in this manuscript is an implicit physical model that modifies the background adjustment step.</p>
    <p>Background noise and non-biological variation of the signal generated from each probe are common phenomena in GeneChip microarray experiments [<xref ref-type="bibr" rid="B7">7</xref>,<xref ref-type="bibr" rid="B8">8</xref>]. The differences in the signal produced can be attributed to many sources: optical noise, cross-hybridization, dye-related contributions and probe sequence composition. Many preprocessing algorithms have been developed in an attempt to correct for these artifacts [<xref ref-type="bibr" rid="B9">9</xref>]. According to Allison et al. [<xref ref-type="bibr" rid="B6">6</xref>] there is no clear winner among the available preprocessing algorithms. However, GCRMA [<xref ref-type="bibr" rid="B10">10</xref>], a modification of RMA [<xref ref-type="bibr" rid="B11">11</xref>], often performs as well as or better than other algorithms [<xref ref-type="bibr" rid="B9">9</xref>,<xref ref-type="bibr" rid="B12">12</xref>-<xref ref-type="bibr" rid="B14">14</xref>]. GCRMA incorporates probe sequence composition into background adjustment, following the physical model of Naef and Magnasco [<xref ref-type="bibr" rid="B15">15</xref>]. The model describes a probe affinity that is dependent on its base composition and the position of each base along the probe and suggests that probe sequence can significantly affect the intensity of the signal generated from that probe, independent of the concentration of its target.</p>
    <p>Performance assessment of GCRMA has been done using both spike-in [<xref ref-type="bibr" rid="B13">13</xref>,<xref ref-type="bibr" rid="B16">16</xref>,<xref ref-type="bibr" rid="B17">17</xref>] and real [<xref ref-type="bibr" rid="B14">14</xref>] datasets followed by quantitative real time PCR confirmation [<xref ref-type="bibr" rid="B12">12</xref>]. So far, a number of reports have been published recommending the use of GCRMA for detecting differentially expressed genes and estimating relative expression, emphasizing its outstanding performance in detecting low-intensity, differentially expressed genes [<xref ref-type="bibr" rid="B13">13</xref>,<xref ref-type="bibr" rid="B17">17</xref>]. When comparing microarray analysis algorithms, Irizarry et al. [<xref ref-type="bibr" rid="B9">9</xref>] have argued for an approach that balances accuracy and precision. Irizarry et al., define <italic>accuracy </italic>as the ability of the algorithm to detect the relative expression of a transcript without bias to its abundance (concentration). They define <italic>precision </italic>as low variance; this is characterized by a steady performance on replicates of the same sample. GCRMA is among the few preprocessing algorithms that scores well in both accuracy and precision [<xref ref-type="bibr" rid="B13">13</xref>].</p>
    <p>In this study, we modified the portion of GCRMA derived from the model of Naef and Magnasco [<xref ref-type="bibr" rid="B15">15</xref>] to calculate probe affinity using position-specific dinucleotide information. The dinucleotide is a fundamental chemical unit that contributes a well-understood component to nucleic acid duplex stability and to the free energy of duplex formation during hybridization [<xref ref-type="bibr" rid="B18">18</xref>,<xref ref-type="bibr" rid="B19">19</xref>]. We applied the new model to different datasets, and achieved an improved fit to microarray data with R<sup>2 </sup>increasing by 5–10%. Then, we tested the downstream effect of our modified background model on the performance of GCRMA in detecting differentially expressed genes, when used to analyze two publicly available control datasets: the human genome U133 Latin Square dataset [<xref ref-type="bibr" rid="B20">20</xref>] and the golden spikein dataset [<xref ref-type="bibr" rid="B16">16</xref>]. In both data sets, application of the dinucleotide model in background correction improved the detection of differentially expressed genes. Therefore, we propose that probe affinity be modeled based on dinucleotide composition of the probe instead of the original single nucleotide approach.</p>
  </sec>
  <sec>
    <title>Results</title>
    <sec>
      <title>Dinucleotide affinity model</title>
      <p>Naef and Magnasco [<xref ref-type="bibr" rid="B15">15</xref>] model <italic>probe affinity </italic>(probe hybridization effect) based on sequence composition as follows:</p>
      <p>
        <disp-formula id="bmcM1">
          <label>(1)</label>
          <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M1" name="1471-2105-9-452-i1" overflow="scroll">
            <mml:semantics>
              <mml:mrow>
                <mml:mi>ln</mml:mi>
                <mml:mo>⁡</mml:mo>
                <mml:mrow>
                  <mml:mo>〈</mml:mo>
                  <mml:mrow>
                    <mml:mi>B</mml:mi>
                    <mml:mo>/</mml:mo>
                    <mml:mi>M</mml:mi>
                  </mml:mrow>
                  <mml:mo>〉</mml:mo>
                </mml:mrow>
                <mml:mo>=</mml:mo>
                <mml:mstyle displaystyle="true">
                  <mml:munderover>
                    <mml:mo>∑</mml:mo>
                    <mml:mrow>
                      <mml:mi>k</mml:mi>
                      <mml:mo>=</mml:mo>
                      <mml:mn>1</mml:mn>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mn>25</mml:mn>
                    </mml:mrow>
                  </mml:munderover>
                  <mml:mrow>
                    <mml:mstyle displaystyle="true">
                      <mml:munder>
                        <mml:mo>∑</mml:mo>
                        <mml:mrow>
                          <mml:mi>l</mml:mi>
                          <mml:mo>∈</mml:mo>
                          <mml:mo stretchy="false">(</mml:mo>
                          <mml:mi>A</mml:mi>
                          <mml:mo>,</mml:mo>
                          <mml:mi>T</mml:mi>
                          <mml:mo>,</mml:mo>
                          <mml:mi>C</mml:mi>
                          <mml:mo>,</mml:mo>
                          <mml:mi>G</mml:mi>
                          <mml:mo stretchy="false">)</mml:mo>
                        </mml:mrow>
                      </mml:munder>
                      <mml:mrow>
                        <mml:msub>
                          <mml:mi>S</mml:mi>
                          <mml:mrow>
                            <mml:mi>l</mml:mi>
                            <mml:mi>k</mml:mi>
                          </mml:mrow>
                        </mml:msub>
                        <mml:msub>
                          <mml:mi>A</mml:mi>
                          <mml:mrow>
                            <mml:mi>l</mml:mi>
                            <mml:mi>k</mml:mi>
                          </mml:mrow>
                        </mml:msub>
                      </mml:mrow>
                    </mml:mstyle>
                  </mml:mrow>
                </mml:mstyle>
              </mml:mrow>
            </mml:semantics>
          </mml:math>
        </disp-formula>
      </p>
      <p>where <italic>B </italic>is the raw probe intensity, <italic>M </italic>is the median intensity of the array, <italic>l </italic>is the nucleotide index (A, C, G or T), <italic>k </italic>is the position of <italic>l </italic>along the probe (note that <italic>k </italic>has a range of 1 to sequence length, that is 25 for GeneChip probes), <italic>S </italic>is a Boolean variable equal to 1 if the probe sequence has <italic>l </italic>at <italic>k </italic>and zero otherwise, and <italic>A </italic>is the per-site-per- nucleotide affinity. As an example, consider the following sequence: CGAC, for which equation 1 reads:</p>
      <p>
        <disp-formula>
          <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M2" name="1471-2105-9-452-i2" overflow="scroll">
            <mml:semantics>
              <mml:mrow>
                <mml:mtable columnalign="left">
                  <mml:mtr columnalign="left">
                    <mml:mtd columnalign="left">
                      <mml:mrow>
                        <mml:mi>ln</mml:mi>
                        <mml:mo>⁡</mml:mo>
                        <mml:mrow>
                          <mml:mo>〈</mml:mo>
                          <mml:mrow>
                            <mml:mi>B</mml:mi>
                            <mml:mo>/</mml:mo>
                            <mml:mi>M</mml:mi>
                          </mml:mrow>
                          <mml:mo>〉</mml:mo>
                        </mml:mrow>
                        <mml:mo>=</mml:mo>
                      </mml:mrow>
                    </mml:mtd>
                  </mml:mtr>
                  <mml:mtr columnalign="left">
                    <mml:mtd columnalign="left">
                      <mml:mrow>
                        <mml:mrow>
                          <mml:mo>(</mml:mo>
                          <mml:mrow>
                            <mml:msub>
                              <mml:mi>S</mml:mi>
                              <mml:mrow>
                                <mml:mn>1</mml:mn>
                                <mml:mi>G</mml:mi>
                              </mml:mrow>
                            </mml:msub>
                            <mml:mo>×</mml:mo>
                            <mml:msub>
                              <mml:mi>A</mml:mi>
                              <mml:mrow>
                                <mml:mn>1</mml:mn>
                                <mml:mi>G</mml:mi>
                              </mml:mrow>
                            </mml:msub>
                          </mml:mrow>
                          <mml:mo>)</mml:mo>
                        </mml:mrow>
                        <mml:mo>+</mml:mo>
                        <mml:mrow>
                          <mml:mo>(</mml:mo>
                          <mml:mrow>
                            <mml:msub>
                              <mml:mi>S</mml:mi>
                              <mml:mrow>
                                <mml:mn>1</mml:mn>
                                <mml:mi>A</mml:mi>
                              </mml:mrow>
                            </mml:msub>
                            <mml:mo>×</mml:mo>
                            <mml:msub>
                              <mml:mi>A</mml:mi>
                              <mml:mrow>
                                <mml:mn>1</mml:mn>
                                <mml:mi>A</mml:mi>
                              </mml:mrow>
                            </mml:msub>
                          </mml:mrow>
                          <mml:mo>)</mml:mo>
                        </mml:mrow>
                        <mml:mo>+</mml:mo>
                        <mml:mrow>
                          <mml:mo>(</mml:mo>
                          <mml:mrow>
                            <mml:msub>
                              <mml:mi>S</mml:mi>
                              <mml:mrow>
                                <mml:mn>1</mml:mn>
                                <mml:mi>T</mml:mi>
                              </mml:mrow>
                            </mml:msub>
                            <mml:mo>×</mml:mo>
                            <mml:msub>
                              <mml:mi>A</mml:mi>
                              <mml:mrow>
                                <mml:mn>1</mml:mn>
                                <mml:mi>T</mml:mi>
                              </mml:mrow>
                            </mml:msub>
                          </mml:mrow>
                          <mml:mo>)</mml:mo>
                        </mml:mrow>
                        <mml:mo>+</mml:mo>
                        <mml:mrow>
                          <mml:mo>(</mml:mo>
                          <mml:mrow>
                            <mml:msub>
                              <mml:mi>S</mml:mi>
                              <mml:mrow>
                                <mml:mn>1</mml:mn>
                                <mml:mi>C</mml:mi>
                              </mml:mrow>
                            </mml:msub>
                            <mml:mo>×</mml:mo>
                            <mml:msub>
                              <mml:mi>A</mml:mi>
                              <mml:mrow>
                                <mml:mn>1</mml:mn>
                                <mml:mi>C</mml:mi>
                              </mml:mrow>
                            </mml:msub>
                          </mml:mrow>
                          <mml:mo>)</mml:mo>
                        </mml:mrow>
                        <mml:mo>+</mml:mo>
                      </mml:mrow>
                    </mml:mtd>
                  </mml:mtr>
                  <mml:mtr columnalign="left">
                    <mml:mtd columnalign="left">
                      <mml:mrow>
                        <mml:mrow>
                          <mml:mo>(</mml:mo>
                          <mml:mrow>
                            <mml:msub>
                              <mml:mi>S</mml:mi>
                              <mml:mrow>
                                <mml:mn>2</mml:mn>
                                <mml:mi>G</mml:mi>
                              </mml:mrow>
                            </mml:msub>
                            <mml:mo>×</mml:mo>
                            <mml:msub>
                              <mml:mi>A</mml:mi>
                              <mml:mrow>
                                <mml:mn>2</mml:mn>
                                <mml:mi>G</mml:mi>
                              </mml:mrow>
                            </mml:msub>
                          </mml:mrow>
                          <mml:mo>)</mml:mo>
                        </mml:mrow>
                        <mml:mo>+</mml:mo>
                        <mml:mrow>
                          <mml:mo>(</mml:mo>
                          <mml:mrow>
                            <mml:msub>
                              <mml:mi>S</mml:mi>
                              <mml:mrow>
                                <mml:mn>2</mml:mn>
                                <mml:mi>A</mml:mi>
                              </mml:mrow>
                            </mml:msub>
                            <mml:mo>×</mml:mo>
                            <mml:msub>
                              <mml:mi>A</mml:mi>
                              <mml:mrow>
                                <mml:mn>2</mml:mn>
                                <mml:mi>A</mml:mi>
                              </mml:mrow>
                            </mml:msub>
                          </mml:mrow>
                          <mml:mo>)</mml:mo>
                        </mml:mrow>
                        <mml:mo>+</mml:mo>
                        <mml:mrow>
                          <mml:mo>(</mml:mo>
                          <mml:mrow>
                            <mml:msub>
                              <mml:mi>S</mml:mi>
                              <mml:mrow>
                                <mml:mn>2</mml:mn>
                                <mml:mi>T</mml:mi>
                              </mml:mrow>
                            </mml:msub>
                            <mml:mo>×</mml:mo>
                            <mml:msub>
                              <mml:mi>A</mml:mi>
                              <mml:mrow>
                                <mml:mn>2</mml:mn>
                                <mml:mi>T</mml:mi>
                              </mml:mrow>
                            </mml:msub>
                          </mml:mrow>
                          <mml:mo>)</mml:mo>
                        </mml:mrow>
                        <mml:mo>+</mml:mo>
                        <mml:mrow>
                          <mml:mo>(</mml:mo>
                          <mml:mrow>
                            <mml:msub>
                              <mml:mi>S</mml:mi>
                              <mml:mrow>
                                <mml:mn>2</mml:mn>
                                <mml:mi>C</mml:mi>
                              </mml:mrow>
                            </mml:msub>
                            <mml:mo>×</mml:mo>
                            <mml:msub>
                              <mml:mi>A</mml:mi>
                              <mml:mrow>
                                <mml:mn>2</mml:mn>
                                <mml:mi>C</mml:mi>
                              </mml:mrow>
                            </mml:msub>
                          </mml:mrow>
                          <mml:mo>)</mml:mo>
                        </mml:mrow>
                        <mml:mo>+</mml:mo>
                      </mml:mrow>
                    </mml:mtd>
                  </mml:mtr>
                  <mml:mtr columnalign="left">
                    <mml:mtd columnalign="left">
                      <mml:mrow>
                        <mml:mrow>
                          <mml:mo>(</mml:mo>
                          <mml:mrow>
                            <mml:msub>
                              <mml:mi>S</mml:mi>
                              <mml:mrow>
                                <mml:mn>3</mml:mn>
                                <mml:mi>G</mml:mi>
                              </mml:mrow>
                            </mml:msub>
                            <mml:mo>×</mml:mo>
                            <mml:msub>
                              <mml:mi>A</mml:mi>
                              <mml:mrow>
                                <mml:mn>3</mml:mn>
                                <mml:mi>G</mml:mi>
                              </mml:mrow>
                            </mml:msub>
                          </mml:mrow>
                          <mml:mo>)</mml:mo>
                        </mml:mrow>
                        <mml:mo>+</mml:mo>
                        <mml:mrow>
                          <mml:mo>(</mml:mo>
                          <mml:mrow>
                            <mml:msub>
                              <mml:mi>S</mml:mi>
                              <mml:mrow>
                                <mml:mn>3</mml:mn>
                                <mml:mi>A</mml:mi>
                              </mml:mrow>
                            </mml:msub>
                            <mml:mo>×</mml:mo>
                            <mml:msub>
                              <mml:mi>A</mml:mi>
                              <mml:mrow>
                                <mml:mn>3</mml:mn>
                                <mml:mi>A</mml:mi>
                              </mml:mrow>
                            </mml:msub>
                          </mml:mrow>
                          <mml:mo>)</mml:mo>
                        </mml:mrow>
                        <mml:mo>+</mml:mo>
                        <mml:mrow>
                          <mml:mo>(</mml:mo>
                          <mml:mrow>
                            <mml:msub>
                              <mml:mi>S</mml:mi>
                              <mml:mrow>
                                <mml:mn>3</mml:mn>
                                <mml:mi>T</mml:mi>
                              </mml:mrow>
                            </mml:msub>
                            <mml:mo>×</mml:mo>
                            <mml:msub>
                              <mml:mi>A</mml:mi>
                              <mml:mrow>
                                <mml:mn>3</mml:mn>
                                <mml:mi>T</mml:mi>
                              </mml:mrow>
                            </mml:msub>
                          </mml:mrow>
                          <mml:mo>)</mml:mo>
                        </mml:mrow>
                        <mml:mo>+</mml:mo>
                        <mml:mrow>
                          <mml:mo>(</mml:mo>
                          <mml:mrow>
                            <mml:msub>
                              <mml:mi>S</mml:mi>
                              <mml:mrow>
                                <mml:mn>3</mml:mn>
                                <mml:mi>C</mml:mi>
                              </mml:mrow>
                            </mml:msub>
                            <mml:mo>×</mml:mo>
                            <mml:msub>
                              <mml:mi>A</mml:mi>
                              <mml:mrow>
                                <mml:mn>3</mml:mn>
                                <mml:mi>C</mml:mi>
                              </mml:mrow>
                            </mml:msub>
                          </mml:mrow>
                          <mml:mo>)</mml:mo>
                        </mml:mrow>
                        <mml:mo>+</mml:mo>
                      </mml:mrow>
                    </mml:mtd>
                  </mml:mtr>
                  <mml:mtr columnalign="left">
                    <mml:mtd columnalign="left">
                      <mml:mrow>
                        <mml:mrow>
                          <mml:mo>(</mml:mo>
                          <mml:mrow>
                            <mml:msub>
                              <mml:mi>S</mml:mi>
                              <mml:mrow>
                                <mml:mn>4</mml:mn>
                                <mml:mi>G</mml:mi>
                              </mml:mrow>
                            </mml:msub>
                            <mml:mo>×</mml:mo>
                            <mml:msub>
                              <mml:mi>A</mml:mi>
                              <mml:mrow>
                                <mml:mn>4</mml:mn>
                                <mml:mi>G</mml:mi>
                              </mml:mrow>
                            </mml:msub>
                          </mml:mrow>
                          <mml:mo>)</mml:mo>
                        </mml:mrow>
                        <mml:mo>+</mml:mo>
                        <mml:mrow>
                          <mml:mo>(</mml:mo>
                          <mml:mrow>
                            <mml:msub>
                              <mml:mi>S</mml:mi>
                              <mml:mrow>
                                <mml:mn>4</mml:mn>
                                <mml:mi>A</mml:mi>
                              </mml:mrow>
                            </mml:msub>
                            <mml:mo>×</mml:mo>
                            <mml:msub>
                              <mml:mi>A</mml:mi>
                              <mml:mrow>
                                <mml:mn>4</mml:mn>
                                <mml:mi>A</mml:mi>
                              </mml:mrow>
                            </mml:msub>
                          </mml:mrow>
                          <mml:mo>)</mml:mo>
                        </mml:mrow>
                        <mml:mo>+</mml:mo>
                        <mml:mrow>
                          <mml:mo>(</mml:mo>
                          <mml:mrow>
                            <mml:msub>
                              <mml:mi>S</mml:mi>
                              <mml:mrow>
                                <mml:mn>4</mml:mn>
                                <mml:mi>T</mml:mi>
                              </mml:mrow>
                            </mml:msub>
                            <mml:mo>×</mml:mo>
                            <mml:msub>
                              <mml:mi>A</mml:mi>
                              <mml:mrow>
                                <mml:mn>4</mml:mn>
                                <mml:mi>T</mml:mi>
                              </mml:mrow>
                            </mml:msub>
                          </mml:mrow>
                          <mml:mo>)</mml:mo>
                        </mml:mrow>
                        <mml:mo>+</mml:mo>
                        <mml:mrow>
                          <mml:mo>(</mml:mo>
                          <mml:mrow>
                            <mml:msub>
                              <mml:mi>S</mml:mi>
                              <mml:mrow>
                                <mml:mn>4</mml:mn>
                                <mml:mi>C</mml:mi>
                              </mml:mrow>
                            </mml:msub>
                            <mml:mo>×</mml:mo>
                            <mml:msub>
                              <mml:mi>A</mml:mi>
                              <mml:mrow>
                                <mml:mn>4</mml:mn>
                                <mml:mi>C</mml:mi>
                              </mml:mrow>
                            </mml:msub>
                          </mml:mrow>
                          <mml:mo>)</mml:mo>
                        </mml:mrow>
                      </mml:mrow>
                    </mml:mtd>
                  </mml:mtr>
                  <mml:mtr columnalign="left">
                    <mml:mtd columnalign="left">
                      <mml:mrow/>
                    </mml:mtd>
                  </mml:mtr>
                  <mml:mtr columnalign="left">
                    <mml:mtd columnalign="left">
                      <mml:mrow>
                        <mml:mi>ln</mml:mi>
                        <mml:mo>⁡</mml:mo>
                        <mml:mrow>
                          <mml:mo>〈</mml:mo>
                          <mml:mrow>
                            <mml:mi>B</mml:mi>
                            <mml:mo>/</mml:mo>
                            <mml:mi>M</mml:mi>
                          </mml:mrow>
                          <mml:mo>〉</mml:mo>
                        </mml:mrow>
                        <mml:mo>=</mml:mo>
                        <mml:msub>
                          <mml:mi>A</mml:mi>
                          <mml:mrow>
                            <mml:mn>1</mml:mn>
                            <mml:mi>C</mml:mi>
                          </mml:mrow>
                        </mml:msub>
                        <mml:mo>+</mml:mo>
                        <mml:msub>
                          <mml:mi>A</mml:mi>
                          <mml:mrow>
                            <mml:mn>2</mml:mn>
                            <mml:mi>G</mml:mi>
                          </mml:mrow>
                        </mml:msub>
                        <mml:mo>+</mml:mo>
                        <mml:msub>
                          <mml:mi>A</mml:mi>
                          <mml:mrow>
                            <mml:mn>3</mml:mn>
                            <mml:mi>A</mml:mi>
                          </mml:mrow>
                        </mml:msub>
                        <mml:mo>+</mml:mo>
                        <mml:msub>
                          <mml:mi>A</mml:mi>
                          <mml:mrow>
                            <mml:mn>4</mml:mn>
                            <mml:mi>C</mml:mi>
                          </mml:mrow>
                        </mml:msub>
                      </mml:mrow>
                    </mml:mtd>
                  </mml:mtr>
                </mml:mtable>
              </mml:mrow>
            </mml:semantics>
          </mml:math>
        </disp-formula>
      </p>
      <p>Equation 1 is a simple model that has four free parameters for each probe base (100 free parameters for a 25-base probe). The values of these 100 free parameters are generated by linear least squares fit. Given the large number of probes on each chip (about half a million for the human genome U133 chip, for example) over-fitting is not a concern.</p>
      <p>Figure <xref ref-type="fig" rid="F1">1</xref> shows the 25 parameters (term <italic>A </italic>in equation 1) of the four nucleotides as a function of their position along the probe for the U133 Latin square dataset (parameters derived from a single chip are shown in panel A and an average of the parameters across all the 42 chips is shown in panel B). A similar pattern of parameters have been obtained fitting equation 1 to other Affymetrix datasets (data not shown and [<xref ref-type="bibr" rid="B15">15</xref>]). These fitted per-site-per-nucleotide affinities imply that the signal generated from each probe will be affected by the probe sequence. Consider two probes interrogating two transcripts, which are present in identical concentration. In such a case, a probe containing many adenines (A) will produce a lower signal intensity than the probe with many cytosines (C), especially if the As or Cs are concentrated at or near the center of the probe (position 13).</p>
      <fig position="float" id="F1">
        <label>Figure 1</label>
        <caption>
          <p><bold>Affinity parameters calculated using single nucleotide model</bold>. Affinity parameters calculated using equation 1 for the human genome U133 Latin Square. Panel A is for Experiment 11 Replica 2 and panel B shows an average of the parameters across all the 42 chips. K represents the position of each nucleotide along the probe length. Affinity parameters calculated using equation 2 are shown as solid lines. Higher affinity (Y-axis) indicates brighter signal.</p>
        </caption>
        <graphic xlink:href="1471-2105-9-452-1"/>
      </fig>
      <p>The model defined in equation 1 can also be expressed as a polynomial of degree 3, thus reducing the free parameters from 100 to 16 as shown below:</p>
      <p>
        <disp-formula id="bmcM2">
          <label>(2)</label>
          <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M3" name="1471-2105-9-452-i3" overflow="scroll">
            <mml:semantics>
              <mml:mrow>
                <mml:mi>ln</mml:mi>
                <mml:mo>⁡</mml:mo>
                <mml:mrow>
                  <mml:mo>〈</mml:mo>
                  <mml:mrow>
                    <mml:mi>B</mml:mi>
                    <mml:mo>/</mml:mo>
                    <mml:mi>M</mml:mi>
                  </mml:mrow>
                  <mml:mo>〉</mml:mo>
                </mml:mrow>
                <mml:mo>=</mml:mo>
                <mml:mstyle displaystyle="true">
                  <mml:munderover>
                    <mml:mo>∑</mml:mo>
                    <mml:mrow>
                      <mml:mi>k</mml:mi>
                      <mml:mo>=</mml:mo>
                      <mml:mn>1</mml:mn>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mn>25</mml:mn>
                    </mml:mrow>
                  </mml:munderover>
                  <mml:mrow>
                    <mml:mstyle displaystyle="true">
                      <mml:munder>
                        <mml:mo>∑</mml:mo>
                        <mml:mrow>
                          <mml:mi>l</mml:mi>
                          <mml:mo>∈</mml:mo>
                          <mml:mo stretchy="false">(</mml:mo>
                          <mml:mi>A</mml:mi>
                          <mml:mo>,</mml:mo>
                          <mml:mi>T</mml:mi>
                          <mml:mo>,</mml:mo>
                          <mml:mi>C</mml:mi>
                          <mml:mo>,</mml:mo>
                          <mml:mi>G</mml:mi>
                          <mml:mo stretchy="false">)</mml:mo>
                        </mml:mrow>
                      </mml:munder>
                      <mml:mrow>
                        <mml:mstyle displaystyle="true">
                          <mml:munderover>
                            <mml:mo>∑</mml:mo>
                            <mml:mrow>
                              <mml:mi>t</mml:mi>
                              <mml:mo>=</mml:mo>
                              <mml:mn>0</mml:mn>
                            </mml:mrow>
                            <mml:mn>3</mml:mn>
                          </mml:munderover>
                          <mml:mrow>
                            <mml:msub>
                              <mml:mi>S</mml:mi>
                              <mml:mrow>
                                <mml:mi>l</mml:mi>
                                <mml:mi>k</mml:mi>
                              </mml:mrow>
                            </mml:msub>
                            <mml:msub>
                              <mml:mi>A</mml:mi>
                              <mml:mrow>
                                <mml:mi>l</mml:mi>
                                <mml:mi>t</mml:mi>
                              </mml:mrow>
                            </mml:msub>
                            <mml:msup>
                              <mml:mi>k</mml:mi>
                              <mml:mi>t</mml:mi>
                            </mml:msup>
                          </mml:mrow>
                        </mml:mstyle>
                      </mml:mrow>
                    </mml:mstyle>
                  </mml:mrow>
                </mml:mstyle>
              </mml:mrow>
            </mml:semantics>
          </mml:math>
        </disp-formula>
      </p>
      <p>By assuming the affinities can be modeled as a third order polynomial function of position, the number of free parameters in the model can be reduced from 100 to 16 with little loss of predictive accuracy as the polynomial generated with 16 parameters (Fig. <xref ref-type="fig" rid="F1">1</xref> solid lines) closely matches the 100 independently estimated parameters (Fig. <xref ref-type="fig" rid="F1">1</xref> symbols) and the R<sup>2 </sup>of both models are similar (additional file <xref ref-type="supplementary-material" rid="S1">1</xref>).</p>
      <p>In the dinucleotide model, we follow a similar strategy to the above, but we model composition-biased probe affinity using dinucleotides (pairs of adjacent bases), which are a fundamental chemical unit in physical models of nucleic acid folding and hybridization rather than single nucleotides. The dinucleotide model is as follows:</p>
      <p>
        <disp-formula id="bmcM3">
          <label>(3)</label>
          <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M4" name="1471-2105-9-452-i4" overflow="scroll">
            <mml:semantics>
              <mml:mrow>
                <mml:mi>ln</mml:mi>
                <mml:mo>⁡</mml:mo>
                <mml:mrow>
                  <mml:mo>〈</mml:mo>
                  <mml:mrow>
                    <mml:mi>B</mml:mi>
                    <mml:mo>/</mml:mo>
                    <mml:mi>M</mml:mi>
                  </mml:mrow>
                  <mml:mo>〉</mml:mo>
                </mml:mrow>
                <mml:mo>=</mml:mo>
                <mml:mstyle displaystyle="true">
                  <mml:munderover>
                    <mml:mo>∑</mml:mo>
                    <mml:mrow>
                      <mml:mi>k</mml:mi>
                      <mml:mo>=</mml:mo>
                      <mml:mn>1</mml:mn>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mn>25</mml:mn>
                    </mml:mrow>
                  </mml:munderover>
                  <mml:mrow>
                    <mml:mstyle displaystyle="true">
                      <mml:munder>
                        <mml:mo>∑</mml:mo>
                        <mml:mrow>
                          <mml:mi>l</mml:mi>
                          <mml:mo>∈</mml:mo>
                          <mml:mi>N</mml:mi>
                          <mml:mi>N</mml:mi>
                        </mml:mrow>
                      </mml:munder>
                      <mml:mrow>
                        <mml:msub>
                          <mml:mi>S</mml:mi>
                          <mml:mrow>
                            <mml:mi>l</mml:mi>
                            <mml:mi>k</mml:mi>
                          </mml:mrow>
                        </mml:msub>
                        <mml:msub>
                          <mml:mi>A</mml:mi>
                          <mml:mrow>
                            <mml:mi>l</mml:mi>
                            <mml:mi>k</mml:mi>
                          </mml:mrow>
                        </mml:msub>
                      </mml:mrow>
                    </mml:mstyle>
                  </mml:mrow>
                </mml:mstyle>
              </mml:mrow>
            </mml:semantics>
          </mml:math>
        </disp-formula>
      </p>
      <p>where <italic>B </italic>is the raw probe intensity, <italic>M </italic>is the median intensity of the array, <italic>l </italic>is the NN nucleotide pair (AA, AC AG, AT, CA, CC, CG, CT, GA, GC, GG, GT, TA, TC, TG or TT), <italic>k </italic>is the position of <italic>l </italic>along the probe (note that <italic>k </italic>has a range of 1 to sequence length minus one, that is 24 for GeneChip probes), <italic>S </italic>is a Boolean variable equal to 1 if the probe sequence has <italic>l </italic>at <italic>k </italic>and zero otherwise, and <italic>A </italic>is the per-site-per-dinucleotide affinity. We then again assume that the per-site-per-dinucleotide affinity follows a polynomial of degree 3 as a function of the position <italic>k </italic>as outlined in equation 4:</p>
      <p>
        <disp-formula id="bmcM4">
          <label>(4)</label>
          <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M5" name="1471-2105-9-452-i5" overflow="scroll">
            <mml:semantics>
              <mml:mrow>
                <mml:mi>ln</mml:mi>
                <mml:mo>⁡</mml:mo>
                <mml:mrow>
                  <mml:mo>〈</mml:mo>
                  <mml:mrow>
                    <mml:mi>B</mml:mi>
                    <mml:mo>/</mml:mo>
                    <mml:mi>M</mml:mi>
                  </mml:mrow>
                  <mml:mo>〉</mml:mo>
                </mml:mrow>
                <mml:mo>=</mml:mo>
                <mml:mstyle displaystyle="true">
                  <mml:munderover>
                    <mml:mo>∑</mml:mo>
                    <mml:mrow>
                      <mml:mi>k</mml:mi>
                      <mml:mo>=</mml:mo>
                      <mml:mn>1</mml:mn>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mn>25</mml:mn>
                    </mml:mrow>
                  </mml:munderover>
                  <mml:mrow>
                    <mml:mstyle displaystyle="true">
                      <mml:munder>
                        <mml:mo>∑</mml:mo>
                        <mml:mrow>
                          <mml:mi>l</mml:mi>
                          <mml:mo>∈</mml:mo>
                          <mml:mi>N</mml:mi>
                          <mml:mi>N</mml:mi>
                        </mml:mrow>
                      </mml:munder>
                      <mml:mrow>
                        <mml:mstyle displaystyle="true">
                          <mml:munderover>
                            <mml:mo>∑</mml:mo>
                            <mml:mrow>
                              <mml:mi>t</mml:mi>
                              <mml:mo>=</mml:mo>
                              <mml:mn>0</mml:mn>
                            </mml:mrow>
                            <mml:mn>3</mml:mn>
                          </mml:munderover>
                          <mml:mrow>
                            <mml:msub>
                              <mml:mi>S</mml:mi>
                              <mml:mrow>
                                <mml:mi>l</mml:mi>
                                <mml:mi>k</mml:mi>
                              </mml:mrow>
                            </mml:msub>
                            <mml:msub>
                              <mml:mi>A</mml:mi>
                              <mml:mrow>
                                <mml:mi>l</mml:mi>
                                <mml:mi>t</mml:mi>
                              </mml:mrow>
                            </mml:msub>
                            <mml:msup>
                              <mml:mi>k</mml:mi>
                              <mml:mi>t</mml:mi>
                            </mml:msup>
                          </mml:mrow>
                        </mml:mstyle>
                      </mml:mrow>
                    </mml:mstyle>
                  </mml:mrow>
                </mml:mstyle>
              </mml:mrow>
            </mml:semantics>
          </mml:math>
        </disp-formula>
      </p>
      <p>This reduces the number of free parameters from 384 (16 dinucleotides × 24 nucleotide positions, equation 3) to 64 (16 dinucleotides × 4 parameters, equation 4), which makes this approach computationally feasible. As an example, consider the following sequence: CGAC (three dinucleotides: CG for <italic>k </italic>= 1, GA for <italic>k </italic>= 2, and AC for <italic>k </italic>= 3), for which equation 4 reads:</p>
      <p>
        <disp-formula>
          <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M6" name="1471-2105-9-452-i6" overflow="scroll">
            <mml:semantics>
              <mml:mrow>
                <mml:mtable columnalign="left">
                  <mml:mtr columnalign="left">
                    <mml:mtd columnalign="left">
                      <mml:mrow>
                        <mml:mi>ln</mml:mi>
                        <mml:mo>⁡</mml:mo>
                        <mml:mrow>
                          <mml:mo>〈</mml:mo>
                          <mml:mrow>
                            <mml:mi>B</mml:mi>
                            <mml:mo>/</mml:mo>
                            <mml:mi>M</mml:mi>
                          </mml:mrow>
                          <mml:mo>〉</mml:mo>
                        </mml:mrow>
                        <mml:mo>=</mml:mo>
                      </mml:mrow>
                    </mml:mtd>
                  </mml:mtr>
                  <mml:mtr columnalign="left">
                    <mml:mtd columnalign="left">
                      <mml:mrow>
                        <mml:mo stretchy="false">(</mml:mo>
                        <mml:msub>
                          <mml:mi>A</mml:mi>
                          <mml:mrow>
                            <mml:mi>C</mml:mi>
                            <mml:mi>G</mml:mi>
                            <mml:mn>0</mml:mn>
                          </mml:mrow>
                        </mml:msub>
                        <mml:mo stretchy="false">)</mml:mo>
                        <mml:mo>+</mml:mo>
                        <mml:mo stretchy="false">(</mml:mo>
                        <mml:msub>
                          <mml:mi>A</mml:mi>
                          <mml:mrow>
                            <mml:mi>C</mml:mi>
                            <mml:mi>G</mml:mi>
                            <mml:mn>1</mml:mn>
                          </mml:mrow>
                        </mml:msub>
                        <mml:mo>×</mml:mo>
                        <mml:mn>1</mml:mn>
                        <mml:mo stretchy="false">)</mml:mo>
                        <mml:mo>+</mml:mo>
                        <mml:mo stretchy="false">(</mml:mo>
                        <mml:msub>
                          <mml:mi>A</mml:mi>
                          <mml:mrow>
                            <mml:mi>C</mml:mi>
                            <mml:mi>G</mml:mi>
                            <mml:mn>2</mml:mn>
                          </mml:mrow>
                        </mml:msub>
                        <mml:mo>×</mml:mo>
                        <mml:msup>
                          <mml:mn>1</mml:mn>
                          <mml:mn>2</mml:mn>
                        </mml:msup>
                        <mml:mo stretchy="false">)</mml:mo>
                        <mml:mo>+</mml:mo>
                        <mml:mo stretchy="false">(</mml:mo>
                        <mml:msub>
                          <mml:mi>A</mml:mi>
                          <mml:mrow>
                            <mml:mi>C</mml:mi>
                            <mml:mi>G</mml:mi>
                            <mml:mn>3</mml:mn>
                          </mml:mrow>
                        </mml:msub>
                        <mml:mo>×</mml:mo>
                        <mml:msup>
                          <mml:mn>1</mml:mn>
                          <mml:mn>3</mml:mn>
                        </mml:msup>
                        <mml:mo stretchy="false">)</mml:mo>
                        <mml:mo>+</mml:mo>
                      </mml:mrow>
                    </mml:mtd>
                  </mml:mtr>
                  <mml:mtr columnalign="left">
                    <mml:mtd columnalign="left">
                      <mml:mrow>
                        <mml:mo stretchy="false">(</mml:mo>
                        <mml:msub>
                          <mml:mi>A</mml:mi>
                          <mml:mrow>
                            <mml:mi>G</mml:mi>
                            <mml:mi>A</mml:mi>
                            <mml:mn>0</mml:mn>
                          </mml:mrow>
                        </mml:msub>
                        <mml:mo stretchy="false">)</mml:mo>
                        <mml:mo>+</mml:mo>
                        <mml:mo stretchy="false">(</mml:mo>
                        <mml:msub>
                          <mml:mi>A</mml:mi>
                          <mml:mrow>
                            <mml:mi>G</mml:mi>
                            <mml:mi>A</mml:mi>
                            <mml:mn>1</mml:mn>
                          </mml:mrow>
                        </mml:msub>
                        <mml:mo>×</mml:mo>
                        <mml:mn>2</mml:mn>
                        <mml:mo stretchy="false">)</mml:mo>
                        <mml:mo>+</mml:mo>
                        <mml:mo stretchy="false">(</mml:mo>
                        <mml:msub>
                          <mml:mi>A</mml:mi>
                          <mml:mrow>
                            <mml:mi>G</mml:mi>
                            <mml:mi>A</mml:mi>
                            <mml:mn>2</mml:mn>
                          </mml:mrow>
                        </mml:msub>
                        <mml:mo>×</mml:mo>
                        <mml:msup>
                          <mml:mn>2</mml:mn>
                          <mml:mn>2</mml:mn>
                        </mml:msup>
                        <mml:mo stretchy="false">)</mml:mo>
                        <mml:mo>+</mml:mo>
                        <mml:mo stretchy="false">(</mml:mo>
                        <mml:msub>
                          <mml:mi>A</mml:mi>
                          <mml:mrow>
                            <mml:mi>G</mml:mi>
                            <mml:mi>A</mml:mi>
                            <mml:mn>3</mml:mn>
                          </mml:mrow>
                        </mml:msub>
                        <mml:mo>×</mml:mo>
                        <mml:msup>
                          <mml:mn>2</mml:mn>
                          <mml:mn>3</mml:mn>
                        </mml:msup>
                        <mml:mo stretchy="false">)</mml:mo>
                        <mml:mo>+</mml:mo>
                      </mml:mrow>
                    </mml:mtd>
                  </mml:mtr>
                  <mml:mtr columnalign="left">
                    <mml:mtd columnalign="left">
                      <mml:mrow>
                        <mml:mo stretchy="false">(</mml:mo>
                        <mml:msub>
                          <mml:mi>A</mml:mi>
                          <mml:mrow>
                            <mml:mi>A</mml:mi>
                            <mml:mi>C</mml:mi>
                            <mml:mn>0</mml:mn>
                          </mml:mrow>
                        </mml:msub>
                        <mml:mo stretchy="false">)</mml:mo>
                        <mml:mo>+</mml:mo>
                        <mml:mo stretchy="false">(</mml:mo>
                        <mml:msub>
                          <mml:mi>A</mml:mi>
                          <mml:mrow>
                            <mml:mi>A</mml:mi>
                            <mml:mi>C</mml:mi>
                            <mml:mn>1</mml:mn>
                          </mml:mrow>
                        </mml:msub>
                        <mml:mo>×</mml:mo>
                        <mml:mn>3</mml:mn>
                        <mml:mo stretchy="false">)</mml:mo>
                        <mml:mo>+</mml:mo>
                        <mml:mo stretchy="false">(</mml:mo>
                        <mml:msub>
                          <mml:mi>A</mml:mi>
                          <mml:mrow>
                            <mml:mi>A</mml:mi>
                            <mml:mi>C</mml:mi>
                            <mml:mn>2</mml:mn>
                          </mml:mrow>
                        </mml:msub>
                        <mml:mo>×</mml:mo>
                        <mml:msup>
                          <mml:mn>3</mml:mn>
                          <mml:mn>2</mml:mn>
                        </mml:msup>
                        <mml:mo stretchy="false">)</mml:mo>
                        <mml:mo>+</mml:mo>
                        <mml:mo stretchy="false">(</mml:mo>
                        <mml:msub>
                          <mml:mi>A</mml:mi>
                          <mml:mrow>
                            <mml:mi>A</mml:mi>
                            <mml:mi>C</mml:mi>
                            <mml:mn>3</mml:mn>
                          </mml:mrow>
                        </mml:msub>
                        <mml:mo>×</mml:mo>
                        <mml:msup>
                          <mml:mn>3</mml:mn>
                          <mml:mn>3</mml:mn>
                        </mml:msup>
                        <mml:mo stretchy="false">)</mml:mo>
                        <mml:mo>+</mml:mo>
                      </mml:mrow>
                    </mml:mtd>
                  </mml:mtr>
                  <mml:mtr columnalign="left">
                    <mml:mtd columnalign="left">
                      <mml:mrow/>
                    </mml:mtd>
                  </mml:mtr>
                  <mml:mtr columnalign="left">
                    <mml:mtd columnalign="left">
                      <mml:mrow>
                        <mml:mi>ln</mml:mi>
                        <mml:mo>⁡</mml:mo>
                        <mml:mrow>
                          <mml:mo>〈</mml:mo>
                          <mml:mrow>
                            <mml:mi>B</mml:mi>
                            <mml:mo>/</mml:mo>
                            <mml:mi>M</mml:mi>
                          </mml:mrow>
                          <mml:mo>〉</mml:mo>
                        </mml:mrow>
                        <mml:mo>=</mml:mo>
                        <mml:mn>4</mml:mn>
                        <mml:msub>
                          <mml:mi>A</mml:mi>
                          <mml:mrow>
                            <mml:mi>C</mml:mi>
                            <mml:mi>G</mml:mi>
                          </mml:mrow>
                        </mml:msub>
                        <mml:mo>+</mml:mo>
                        <mml:mn>15</mml:mn>
                        <mml:msub>
                          <mml:mi>A</mml:mi>
                          <mml:mrow>
                            <mml:mi>G</mml:mi>
                            <mml:mi>A</mml:mi>
                          </mml:mrow>
                        </mml:msub>
                        <mml:mo>+</mml:mo>
                        <mml:mn>40</mml:mn>
                        <mml:msub>
                          <mml:mi>A</mml:mi>
                          <mml:mrow>
                            <mml:mi>A</mml:mi>
                            <mml:mi>C</mml:mi>
                          </mml:mrow>
                        </mml:msub>
                      </mml:mrow>
                    </mml:mtd>
                  </mml:mtr>
                </mml:mtable>
              </mml:mrow>
            </mml:semantics>
          </mml:math>
        </disp-formula>
      </p>
      <p>Note that we do not explicitly fit the stacking energies of the NN pairs; rather we explicitly fit the NN pairs' affinities along the probe sequence position.</p>
      <p>The fitted per-site-per-dinucleotide affinities are shown in Fig. <xref ref-type="fig" rid="F2">2</xref> for the Latin square dataset. Parameters obtained from other datasets are similar to the Latin square dataset parameters (data not shown). The figure shows that a probe with many AN (N = A, C, G, T) pairs (Fig <xref ref-type="fig" rid="F2">2A</xref>) tends to have much lower intensity than a probe with many CN pairs (Fig <xref ref-type="fig" rid="F2">2B</xref>) especially when those pairs are located at or near the probe center. This is broadly what we expect from the single nucleotide model. However, examining the effect caused by second nucleotide in each NN pair shows a pronounced effect for certain dinucleotides, which cannot be captured in the single nucleotide model. This can be seen in Fig. <xref ref-type="fig" rid="F2">2C</xref> and <xref ref-type="fig" rid="F2">2D</xref>. GA and GT rich probes are significantly brighter than GC rich probes, and TA rich probes are brighter than TC and TG rich probes.</p>
      <fig position="float" id="F2">
        <label>Figure 2</label>
        <caption>
          <p><bold>Affinity parameters calculated using dinucleotide model</bold>. Affinity parameters calculated using equation 4 for the human genome U133 Latin Square. Affinity parameters are averaged across all the 42 chips; parameters for any single chip resemble those shown here. The first letter of each dinucleotide is indicated at the top of the figure, the second letter is indicated on the connected lines. K represents the position of each dinucleotide along the probe length. Higher affinity (Y-axis) indicates brighter signal.</p>
        </caption>
        <graphic xlink:href="1471-2105-9-452-2"/>
      </fig>
      <p>The model defined in equation 4 was fitted to a number of datasets (see Methods). Fitting was performed on the PM and MM probes separately. Table <xref ref-type="table" rid="T1">1</xref> shows a comparison between the native Naef and Magnasco [<xref ref-type="bibr" rid="B15">15</xref>] affinity model (single nucleotide model, equation 1) and our dinucleotide affinity model (equation 4). We see that the dinucleotide model gives a better fit to microarray data by 5–10% on average (Table <xref ref-type="table" rid="T1">1</xref> and additional file <xref ref-type="supplementary-material" rid="S1">1</xref>), depending on the chip and probe type. Note that both models perform better on the MM probes due to the higher background noise present in the MM signal.</p>
      <table-wrap position="float" id="T1">
        <label>Table 1</label>
        <caption>
          <p>Dinucleotide model performance on different datasets</p>
        </caption>
        <table frame="hsides" rules="groups">
          <thead>
            <tr>
              <td align="left">Data set</td>
              <td align="center">
                <italic>nc</italic>
                <sup>a</sup>
              </td>
              <td align="center">
                <italic>np</italic>
                <sup>b</sup>
              </td>
              <td/>
              <td align="center">Single nucleotide model (eq. 1)</td>
              <td align="center">Dinucleotide model (eq. 4)<sup>c</sup></td>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left">Latin Square [<xref ref-type="bibr" rid="B20">20</xref>]</td>
              <td align="center">42</td>
              <td align="center">248152</td>
              <td align="center">
                <italic>PM</italic>
              </td>
              <td align="center">0.17 ± 0.01</td>
              <td align="center">0.22 ± 0.01</td>
            </tr>
            <tr>
              <td/>
              <td/>
              <td align="center">248152</td>
              <td align="center">
                <italic>MM</italic>
              </td>
              <td align="center">0.40 ± 0.01</td>
              <td align="center">0.50 ± 0.01</td>
            </tr>
            <tr>
              <td/>
              <td/>
              <td/>
              <td/>
              <td/>
              <td/>
            </tr>
            <tr>
              <td align="left">Golden spikein [<xref ref-type="bibr" rid="B16">16</xref>]</td>
              <td align="center">6</td>
              <td align="center">195994</td>
              <td align="center">
                <italic>PM</italic>
              </td>
              <td align="center">0.20 ± 0.02</td>
              <td align="center">0.22 ± 0.02</td>
            </tr>
            <tr>
              <td/>
              <td/>
              <td align="center">195994</td>
              <td align="center">
                <italic>MM</italic>
              </td>
              <td align="center">0.46 ± 0.02</td>
              <td align="center">0.51 ± 0.02</td>
            </tr>
            <tr>
              <td/>
              <td/>
              <td/>
              <td/>
              <td/>
              <td/>
            </tr>
            <tr>
              <td align="left">Leukemia [<xref ref-type="bibr" rid="B35">35</xref>]</td>
              <td align="center">72</td>
              <td align="center">201800</td>
              <td align="center">
                <italic>PM</italic>
              </td>
              <td align="center">0.49 ± 0.06</td>
              <td align="center">0.55 ± 0.07</td>
            </tr>
            <tr>
              <td/>
              <td/>
              <td align="center">201800</td>
              <td align="center">
                <italic>MM</italic>
              </td>
              <td align="center">0.60 ± 0.04</td>
              <td align="center">0.69 ± 0.04</td>
            </tr>
            <tr>
              <td/>
              <td/>
              <td/>
              <td/>
              <td/>
              <td/>
            </tr>
            <tr>
              <td align="left">Etoposide response [<xref ref-type="bibr" rid="B34">34</xref>]</td>
              <td align="center">60</td>
              <td align="center">496468</td>
              <td align="center">
                <italic>PM</italic>
              </td>
              <td align="center">0.05 ± 0.04</td>
              <td align="center">0.08 ± 0.06</td>
            </tr>
            <tr>
              <td/>
              <td/>
              <td/>
              <td/>
              <td/>
              <td/>
            </tr>
            <tr>
              <td/>
              <td/>
              <td align="center">496468</td>
              <td align="center">
                <italic>MM</italic>
              </td>
              <td align="center">0.11 ± 0.06</td>
              <td align="center">0.16 ± 0.08</td>
            </tr>
            <tr>
              <td align="left">BK knockout [<xref ref-type="bibr" rid="B36">36</xref>,<xref ref-type="bibr" rid="B37">37</xref>]</td>
              <td align="center">20</td>
              <td align="center">496468</td>
              <td align="center">
                <italic>PM</italic>
              </td>
              <td align="center">0.09 ± 0.04</td>
              <td align="center">0.13 ± 0.04</td>
            </tr>
            <tr>
              <td/>
              <td/>
              <td align="center">496468</td>
              <td align="center">
                <italic>MM</italic>
              </td>
              <td align="center">0.29 ± 0.050</td>
              <td align="center">0.36 ± 0.06</td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <p>R2 of Naef and Magnasco [<xref ref-type="bibr" rid="B15">15</xref>] model (Single nucleotide) and the dinucleotide model for the five data sets used in this study. Results presented as average R2 ± SD.</p>
          <p><sup>a</sup><italic>nc</italic>: number of chips.</p>
          <p><sup>b</sup><italic>np</italic>: number of probes.</p>
          <p><sup>c </sup>The differences in R<sup>2 </sup>between single nucleotide model and dinucleotide model are all statistically significant (<italic>p </italic>&lt; 10<sup>-3</sup>) using paired one-sided Wilcoxon and <italic>t </italic>tests.</p>
        </table-wrap-foot>
      </table-wrap>
      <p>Given that our fits contain between 195,994 and 496,468 data points (Table <xref ref-type="table" rid="T1">1</xref>), it seems unlikely that the improvements in performance of our model could be explained by the additional free parameters (64 for our model vs. 16 for the original Naef and Magnasco model). Nonetheless, to rule out this possibility, we fitted both the single nucleotide model (N) (using the 100 free parameters and 16 free parameter version of the Naef and Magnasco model, equation 1 and 2, respectively) and the dinucleotide model (NN) with 64 free parameters (equation 4) to the Latin Square dataset using completely random probe sequences (generated with an equal probability of A, C, G and T). We also performed the same test on shuffled probe sequences in which the probe's base composition is not affected, but the position of each base has been changed due to the shuffling process. The results of this analysis are shown in additional file <xref ref-type="supplementary-material" rid="S1">1</xref>. We see that the R<sup>2 </sup>of the shuffled and random probe sequences are nearly identical, no matter which method is used. The presence of additional free parameters in our model, therefore, cannot by itself explain the improved performance over the Naef and Magnasco model. This strongly supports our argument that the gain in the r-squared values of the NN model comes from including dinucleotide information and does not arise trivially from the addition of free parameters.</p>
    </sec>
    <sec>
      <title>Background adjustment using dinucleotide affinity model</title>
      <p>Using a more accurate estimate of background noise should improve the quality of Affymetrix GeneChip data. Given the better fits observed using the dinucleotide affinity model, we expected it to improve the analysis results to some degree when applied to control datasets. We tested the downstream effects of using this model on the quality of microarray data. We chose to implement the model within GCRMA [<xref ref-type="bibr" rid="B10">10</xref>], since it already has the single nucleotide model implemented in its background correction procedure, and therefore the two models could be directly compared.</p>
      <p>In GCRMA, Wu et al. [<xref ref-type="bibr" rid="B10">10</xref>] model the signal intensity generated from each probe as:</p>
      <p>
        <disp-formula id="bmcM5">
          <label>(5)</label>
          <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M7" name="1471-2105-9-452-i7" overflow="scroll">
            <mml:semantics>
              <mml:mrow>
                <mml:mtable columnalign="left">
                  <mml:mtr columnalign="left">
                    <mml:mtd columnalign="left">
                      <mml:mrow>
                        <mml:mi>P</mml:mi>
                        <mml:mi>M</mml:mi>
                        <mml:mo>=</mml:mo>
                        <mml:msub>
                          <mml:mi>O</mml:mi>
                          <mml:mrow>
                            <mml:mi>P</mml:mi>
                            <mml:mi>M</mml:mi>
                          </mml:mrow>
                        </mml:msub>
                        <mml:mo>+</mml:mo>
                        <mml:msub>
                          <mml:mi>N</mml:mi>
                          <mml:mrow>
                            <mml:mi>P</mml:mi>
                            <mml:mi>M</mml:mi>
                          </mml:mrow>
                        </mml:msub>
                        <mml:mo>+</mml:mo>
                        <mml:mi>S</mml:mi>
                        <mml:mo>,</mml:mo>
                      </mml:mrow>
                    </mml:mtd>
                  </mml:mtr>
                  <mml:mtr columnalign="left">
                    <mml:mtd columnalign="left">
                      <mml:mrow>
                        <mml:mi>M</mml:mi>
                        <mml:mi>M</mml:mi>
                        <mml:mo>=</mml:mo>
                        <mml:msub>
                          <mml:mi>O</mml:mi>
                          <mml:mrow>
                            <mml:mi>M</mml:mi>
                            <mml:mi>M</mml:mi>
                          </mml:mrow>
                        </mml:msub>
                        <mml:mo>+</mml:mo>
                        <mml:msub>
                          <mml:mi>N</mml:mi>
                          <mml:mrow>
                            <mml:mi>M</mml:mi>
                            <mml:mi>M</mml:mi>
                          </mml:mrow>
                        </mml:msub>
                        <mml:mo>+</mml:mo>
                        <mml:mi>ϕ</mml:mi>
                        <mml:mi>S</mml:mi>
                      </mml:mrow>
                    </mml:mtd>
                  </mml:mtr>
                </mml:mtable>
              </mml:mrow>
            </mml:semantics>
          </mml:math>
        </disp-formula>
      </p>
      <p>where <italic>O </italic>is the optical noise, <italic>N </italic>is the background noise of non-specific binding, and <italic>S </italic>is the signal generated from specific binding between the probe and its intended target. The parameter φ reflects the fact that for some probe pairs, the MM signal may contain specific signal. The background components log(<italic>N</italic><sub><italic>PM</italic></sub>) and log(<italic>N</italic><sub><italic>MM</italic></sub>) are assumed to follow a bivariate distribution with means of μ<sub><italic>pm </italic></sub>= <italic>h</italic>(α<sub><italic>PM</italic></sub>) and μ<sub><italic>mm </italic></sub>= <italic>h</italic>(α<sub><italic>MM</italic></sub>), where <italic>h </italic>is a smoothing function and α (probe affinity) is defined by equation 1. In this paper, we make these same assumptions, but we derive α using equation 4.</p>
      <p>We reasoned that GCRMA with background correction using the dinucleotide model, which we will subsequently refer to as GCRMA-NN in this paper, would perform better than the native GCRMA model. It is important to clarify that GCRMA offers two options for background correction, the first of which uses a precomputed α (called reference affinity) from the authors' own non-specific binding (NSB) experiments, while the second computes α directly from the data (called local affinity). In the following figures, we compare GCRMA-NN (where α is computed directly from the data using equation 4) to GCRMA-L (GCRMA with local affinity) and GCRMA-R (GCRMA with reference affinity).</p>
    </sec>
    <sec>
      <title>Latin square dataset</title>
      <p>We obtained expression measures for the Human Genome U133 Latin square dataset after processing it with GCRMA-R, GCRMA-L and GCRMA-NN. The three expression measures were evaluated using two approaches. The first approach is based on AffyComp [<xref ref-type="bibr" rid="B21">21</xref>], a performance evaluation tool for preprocessing algorithms (see below). The second approach is based on the number of true positives captured for all the 14 2× comparisons of the Latin square dataset at a cutoff of four false positives after using the cyber <italic>t </italic>test [<xref ref-type="bibr" rid="B22">22</xref>]. Cyber <italic>t </italic>is a popular variant of the <italic>t </italic>test, in which a weighted standard deviation replaces the conventional standard deviation and an adjusted number of degrees of freedom is used instead of the conventional degrees of freedom.</p>
      <p>Performance of GCRMA-R, GCRMA-L and GCRMA-NN as reported by AffyComp based on 14 metrics is shown in Table <xref ref-type="table" rid="T2">2</xref>. One notable performance enhancement of GCRMA-NN over GCRMA-L and GCRMA-R is a 3–4% increase in the weighted average area under the curve (AUC) (Table <xref ref-type="table" rid="T2">2</xref>). This is a receiver operator characteristics (ROC) based metric, in which the absolute log-ratios for the expression summaries, for every comparison of any two pairs of the 14 arrays (92 comparisons), are sorted. After that, the number of true and false positives is found, and then the number of true positives at 100 false positives is determined for each pair of arrays. Finally, the resulting values are averaged over the three concentration groups (low, med and high), weighted by the number of probesets in each group and a score is recorded. Note that a perfect algorithm will have a score of 1, where all the true positives are captured before any false positive is recorded.</p>
      <table-wrap position="float" id="T2">
        <label>Table 2</label>
        <caption>
          <p>AffyComp scores for GCRMA-L, GCRMA-R and GCRMA-NN</p>
        </caption>
        <table frame="hsides" rules="groups">
          <thead>
            <tr>
              <td align="center">Metric</td>
              <td align="center">GCRMA-L</td>
              <td align="center">GCRMA-R</td>
              <td align="center">GCRMA-NN</td>
              <td align="center">Perfect score</td>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="center">Median SD</td>
              <td align="center">0.06</td>
              <td align="center">0.06</td>
              <td align="center">0.07</td>
              <td align="center">0</td>
            </tr>
            <tr>
              <td align="center">null log-fc IQR</td>
              <td align="center">0.05</td>
              <td align="center">0.03</td>
              <td align="center">0.08</td>
              <td align="center">0</td>
            </tr>
            <tr>
              <td align="center">null log-fc 99.9%</td>
              <td align="center">0.62</td>
              <td align="center">0.61</td>
              <td align="center">0.64</td>
              <td align="center">0</td>
            </tr>
            <tr>
              <td align="center">Signal detect slope</td>
              <td align="center">0.99</td>
              <td align="center">1</td>
              <td align="center">0.98</td>
              <td align="center">1</td>
            </tr>
            <tr>
              <td align="center">Signal detect R<sup>2</sup></td>
              <td align="center">0.89</td>
              <td align="center">0.91</td>
              <td align="center">0.91</td>
              <td align="center">1</td>
            </tr>
            <tr>
              <td align="center">low.slope</td>
              <td align="center">0.49</td>
              <td align="center">0.48</td>
              <td align="center">0.55</td>
              <td align="center">1</td>
            </tr>
            <tr>
              <td align="center">med.slope</td>
              <td align="center">1.05</td>
              <td align="center">1.06</td>
              <td align="center">1.02</td>
              <td align="center">1</td>
            </tr>
            <tr>
              <td align="center">high.slope</td>
              <td align="center">0.97</td>
              <td align="center">0.97</td>
              <td align="center">0.96</td>
              <td align="center">1</td>
            </tr>
            <tr>
              <td align="center">Obs-intended-fc slope</td>
              <td align="center">0.99</td>
              <td align="center">1</td>
              <td align="center">0.98</td>
              <td align="center">1</td>
            </tr>
            <tr>
              <td align="center">Obs-(low)int-fc slope</td>
              <td align="center">0.48</td>
              <td align="center">0.47</td>
              <td align="center">0.53</td>
              <td align="center">1</td>
            </tr>
            <tr>
              <td align="center">low AUC</td>
              <td align="center">0.44</td>
              <td align="center">0.45</td>
              <td align="center">0.50</td>
              <td align="center">1</td>
            </tr>
            <tr>
              <td align="center">med AUC</td>
              <td align="center">0.87</td>
              <td align="center">0.87</td>
              <td align="center">0.86</td>
              <td align="center">1</td>
            </tr>
            <tr>
              <td align="center">high AUC</td>
              <td align="center">0.85</td>
              <td align="center">0.86</td>
              <td align="center">0.83</td>
              <td align="center">1</td>
            </tr>
            <tr>
              <td align="center">weighted avg AUC</td>
              <td align="center">0.55</td>
              <td align="center">0.56</td>
              <td align="center">0.59</td>
              <td align="center">1</td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <p>Fourteen AffyComp metrics for the U133 Latin square dataset rounded to two decimal points.</p>
          <p>A brief description of each metric is provided under the Methods section.</p>
        </table-wrap-foot>
      </table-wrap>
      <p>Examining Table <xref ref-type="table" rid="T2">2</xref> shows that the increase comes mainly from the AUC for low intensity targets (low AUC entry in Table <xref ref-type="table" rid="T2">2</xref>). The low intensity genes make up most of the genes in a typical Affymetrix experiment [<xref ref-type="bibr" rid="B13">13</xref>] and are also the hardest to detect. Algorithms that perform inference generally can detect large changes involving highly expressed genes. It is much more difficult to detect changes in the more frequently observed genes that produce low intensities on the array. GCRMA-NN enhanced the detection of low intensity targets, while maintaining similar values for the medium and high intensity ones. The enhancement in detecting low intensity targets is also evident in the form of an increase in the low detection slope (low.slope entry in Table <xref ref-type="table" rid="T2">2</xref>).</p>
      <p>In the crucial category of low intensity genes, we argue that our algorithm outperforms most of the algorithms submitted to AffyComp, including GCRMA-R and GCRMA-L. The AffyComp webpage currently contains data for 88 algorithms for analyzing Affymetrix microarrays. For each of these algorithms, AffyComp defines accuracy as the slope obtained from regressing expression values on nominal concentration. An algorithm with a perfect accuracy would have a slope of 1, reflecting a perfect correspondence between nucleotide concentration and signal. AffyComp defines precision as the 99.9% percentile of the log fold changes of null (true negative) probesets across arrays. A perfect algorithm would have a precision of 0 reflecting a fold change of 1 (i.e. no change). Figure <xref ref-type="fig" rid="F3">3</xref> is a plot of precision vs. accuracy for the Latin Square dataset for the 88 algorithms submitted to the AffyComp webpage. In Figure <xref ref-type="fig" rid="F3">3A</xref>, we see that when looking at overall accuracy vs. precision, the GCRMA-NN algorithm (blue dot) performs about as well as GCRMA-R (green dot) and GCRMA-L (red dot). However, for the crucial low intensity genes, for which inference is the most difficult, GCRMA-NN provides a better accuracy with no loss of precision (Fig. <xref ref-type="fig" rid="F3">3B</xref>).</p>
      <fig position="float" id="F3">
        <label>Figure 3</label>
        <caption>
          <p><bold>GCRMA-NN accuracy and precision</bold>. A) Accuracy and precision of GCRMA-R (green dot), GCRMA-L (red dot) and GCRMA-NN (blue dot) compared to other preprocessing algorithms (black dots) submitted to AffyComp [<xref ref-type="bibr" rid="B33">33</xref>], information retrieved from AffyComp on November, 14<sup>th </sup>2007. B) As A but for low expressed genes. A perfect score is shown as an (×) on both panels. See Results for explanation.</p>
        </caption>
        <graphic xlink:href="1471-2105-9-452-3"/>
      </fig>
      <p>Since the results of AffyComp suggest an improvement for the low intensity, hard to detect spikeins, we reasoned that inference performed with GCRMA-NN would be more successful than inference with GCRMA-R or GCRMA-L. We therefore applied GCRMA-NN, GCRMA-R and GCRMA-L to the U133 Latin square dataset. We considered only the 14 2× comparisons, in which the ratio of each spikein, between any two consecutive pair of arrays, is 2. Then we used the cyber <italic>t </italic>statistic [<xref ref-type="bibr" rid="B22">22</xref>] to generate a list of <italic>P </italic>values for the null hypothesis that the mean signal intensity in each comparison is the same. The lists were ordered, and for each of the 14 comparisons we generated an ROC curve. Figure <xref ref-type="fig" rid="F4">4A</xref> shows the average of these 14 ROC curves. For each ROC curve, we determined the number of true positives captured at an arbitrary cutoff of four false positives (vertical dashed line in Fig. <xref ref-type="fig" rid="F4">4A</xref>). The result of this analysis is summarized in Figure <xref ref-type="fig" rid="F4">4B</xref>. We see that GCRMA-NN outperforms GCRMA-R and GCRMA-L with a small but significant improvement. One-sided Wilcoxon and <italic>t </italic>tests reject the null hypothesis that GCRMA-NN is the same as GCRMA-R and GCRMA-L with all tests <italic>p </italic>&lt; 0.005. These are consistent with the results we would have expected based on the AffyComp comparison (Table <xref ref-type="table" rid="T2">2</xref>).</p>
      <fig position="float" id="F4">
        <label>Figure 4</label>
        <caption>
          <p><bold>Performance of GCRMA-R, GCRMA-L and GCRMA-NN on the Latin square dataset</bold>. A) ROC curves showing the average true positives and false positives across the 14 2× Latin square experiments following application of the cyber <italic>t </italic>test. B) The number of true positives captured for all the 14 2× Latin square experiments at a cutoff value of four false positives (dashed vertical line in panel A). The differences in panel B between GCRMA-R, GCRMA-L and GCRMA-NN are statistically significant (<italic>p </italic>&lt; 0.005) using paired one-sided Wilcoxon and <italic>t </italic>tests.</p>
        </caption>
        <graphic xlink:href="1471-2105-9-452-4"/>
      </fig>
    </sec>
    <sec>
      <title>Golden spikein dataset</title>
      <p>In order to ensure that our data were valid for more than one control data set, we next applied GCRMA-R, GCRMA-L and GCRMA-NN to the "golden spikein dataset" [<xref ref-type="bibr" rid="B16">16</xref>], which is not included in AffyComp. Figure <xref ref-type="fig" rid="F5">5</xref> shows a ROC graph for the differentially expressed genes between the S and the C "golden spike" samples (see Methods) detected by GCRMA-R, GCRMA-L and GCRMA-NN. As in the Latin Square data, the graph shows that GCRMA-NN is capable of capturing more true positives at lower false positive rate than both GCRMA-R and GCRMA-L. This supports our assertion that an improved background correction algorithm can have a noticeable effect on downstream analyses.</p>
      <fig position="float" id="F5">
        <label>Figure 5</label>
        <caption>
          <p><bold>Performance of GCRMA-R, GCRMA-L and GCRMA-NN on the Golden spikein dataset</bold>. ROC curves for the Golden spikein experiments C versus S after application of the cyber <italic>t </italic>test.</p>
        </caption>
        <graphic xlink:href="1471-2105-9-452-5"/>
      </fig>
    </sec>
  </sec>
  <sec>
    <title>Discussion</title>
    <p>Background estimation and correction are important steps in analyzing the data generated by GeneChip arrays. Improving algorithms for these steps increases the amount of true "signal" that we can detect from microarrays. Understanding background noise on GeneChip arrays, especially the part contributed by NSB signal, requires a deeper understanding of the behavior of on-chip hybridization. Given that we lack a detailed physical model of on-chip hybridization derived from first principles, an empirical model that estimates the specific and non-specific signal based on the data on the array and probe sequence is a useful tool for understanding the on-chip hybridization process.</p>
    <p>Nucleic acid hybridization in solution is well approximated by the nearest neighbor model [<xref ref-type="bibr" rid="B23">23</xref>], which describes duplex formation as a function of the two adjacent nucleotides and their stacking orientation. This approach was used by Zhang et al. [<xref ref-type="bibr" rid="B24">24</xref>] to model the on-chip specific and nonspecific hybridization using the free energy formation for the adjacent nucleotides. Zhang et al. concluded that the on-chip hybridization parameters are different than the solution ones. Using a different approach to background correction, Naef and Magnasco [<xref ref-type="bibr" rid="B15">15</xref>] used single nucleotides to assign an overall affinity score for a probe based on its sequence away from the energy contributions of the dinucleotide pairs. This approach was used to perform background correction for the GCMRA algorithm [<xref ref-type="bibr" rid="B10">10</xref>] while the Zhang et al approach was used to create the algorithm PerfectMatch [<xref ref-type="bibr" rid="B24">24</xref>]. PerfectMatch estimates the signal and the background at the same step while GCRMA estimates background noise first then proceed to signal estimation. PerfectMatch is, therefore, much more computationally demanding than GCRMA as the parameter space searched by PerfectMatch is vast and is sampled with Monte Carlo methods. Direct comparison of GCRMA and PerfectMatch has proven controversial. Such a comparison is beyond the scope of this report, and can be found elsewhere [<xref ref-type="bibr" rid="B9">9</xref>,<xref ref-type="bibr" rid="B13">13</xref>,<xref ref-type="bibr" rid="B25">25</xref>].</p>
    <p>In this report we combine some elements of GCRMA and PerfectMatch. We replace the single nucleotide model of Naef and Magnasco with a model in which the affinity of each probe is a function of its <italic>dinucleotide </italic>composition. Because we use GCRMA's approach of separating estimates of background and signal, we can use a linear model and avoid the Monte Carlo simulation approach of PerfectMatch [<xref ref-type="bibr" rid="B24">24</xref>]. Our approach is therefore both computationally more efficient and guarantees the best fit to the data. This approach enables us to examine the contribution of different dinucleotides at different positions to the raw probe signal (Fig. <xref ref-type="fig" rid="F2">2</xref>), rather than assigning one weight function to all the dinucleotides, as is done with PerfectMatch [<xref ref-type="bibr" rid="B24">24</xref>]. This allows our model to capture several important features of the background data such as the effect of the first versus the second nucleotide on probe affinity (e.g. CA vs. CG), and the effect of the stacking orientation (AC vs. CA). In general, we find that the dinucleotide approach has more power than the single nucleotide approach over a wide range of datasets (Table <xref ref-type="table" rid="T1">1</xref>).</p>
    <p>The mechanism that determines why particular dinucleotides affect probe affinities the way they do is, in some cases, unclear. However, we observe that the NN model bears some similarities to the models of both Naef and Magnasco and Zhang et al. All three models emphasize the importance of the probe middle region; this is probably due to the surface attachment, as well as to the relative instability of the free end in RNA-DNA hybridization. The effect of the stacking orientation is in agreement with the findings of Zhang et al. [<xref ref-type="bibr" rid="B24">24</xref>]. The AN versus CN (where N refers to any of the four nucleotides: A, C, G, T; AN for example means AA, AC, AG and AT) asymmetry (Fig. <xref ref-type="fig" rid="F2">2A</xref> and <xref ref-type="fig" rid="F2">2B</xref>) is in agreement with Naef and Magnasco [<xref ref-type="bibr" rid="B15">15</xref>]. When comparing these affinity curves to the original Naef and Magnasco result, it is important to recognize that the NN model considers the affinity of dinucleotides rather than single nucleotides. Therefore, we do not necessarily expect to see the same asymmetry within CN or AN, i.e. there will be no asymmetry between CA and CC (Fig. <xref ref-type="fig" rid="F2">2B</xref>), or between AA and AC (Fig. <xref ref-type="fig" rid="F2">2A</xref>). The NN model, however, does show unexpected behavior for the GN and TN dinucleotides. While both G and T show slight asymmetry in the Naef and Magnasco model, the effect of these two nucleotides is magnified in the NN model. GN contributes positively to the signal but not when the second nucleotide is C (Fig. <xref ref-type="fig" rid="F2">2C</xref>). TN contributes negatively but not when the second nucleotide is A (Fig. <xref ref-type="fig" rid="F2">2D</xref>). This trend is partially explained by the fact that T forms fewer hydrogen bonds than G, therefore contributing negatively, while the G has stronger binding, thus contributing positively. This trend is not consistent, and appears to be dependent on the adjacent nucleotide. It could also be due to the biotin label present on the RNA target sequence.</p>
    <p>When applied to two control datasets, GCRMA-NN showed improved performance (Figs. <xref ref-type="fig" rid="F4">4</xref>, <xref ref-type="fig" rid="F5">5</xref>) especially on low intensity targets (Table <xref ref-type="table" rid="T2">2</xref>; Fig. <xref ref-type="fig" rid="F3">3</xref>). We argue that this is due to better background correction for these targets; a higher percentage of low intensity signal will be made up of background, so it is therefore not surprising that better background correction will make more of a difference on low intensity targets. The detection of low intensity targets represent the most significant challenge to microarray analysis algorithms, which makes any enhancement in the detection of these targets significant.</p>
  </sec>
  <sec>
    <title>Conclusion</title>
    <p>Incorporating dinucleotide information into a previously described probe affinity model increases the fit of the model by 5–10%. The dinucleotide affinities highlight the importance of the stacking orientation on probe behavior. This is in agreement with the physical models that describe hybridization binding affinities.</p>
    <p>The results presented here show that the affinity of any single nucleotide is affected by its neighbor, in addition to its location along the probe. Considering the second nucleotide offers more insights into the on-chip behavior of the four bases in relation to each other. Such insights are important to develop a better understanding of the on-chip hybridization process and therefore better analysis procedures. The model described here enhances the performance of an existing widely-used preprocessing algorithm for GeneChip data. We expect the same model to enhance the performance of preprocessing algorithm for other types of arrays, in particular those used for SNP analysis.</p>
  </sec>
  <sec sec-type="methods">
    <title>Methods</title>
    <sec>
      <title>Datasets</title>
      <sec>
        <title>The U133 Latin square dataset</title>
        <p>This dataset is composed of 14 experiments (three technical replicates for each experiment) in which 42 transcripts are spiked at a concentration range of 0.125–512 pM following a Latin square design. The dataset files were downloaded from Affymetrix web site [<xref ref-type="bibr" rid="B20">20</xref>]. For AffyComp analysis, all probesets were included. For the 14 2× comparisons the following probesets were excluded following Affymetrix recommendations: 209374_s_at, 205397_x_at, 208010_s_at. In addition, we excluded any probesets with a name starting with AFFX- that was not included in the 42 true positive spikeins.</p>
      </sec>
      <sec>
        <title>The Golden spikein dataset</title>
        <p>This dataset has more spikein genes than the Latin Square dataset, but consists of only six microarrays, 3 C (control) and three S (spikein) [<xref ref-type="bibr" rid="B16">16</xref>]. The S pool contains cRNA at concentration equal to or higher than the C pool [<xref ref-type="bibr" rid="B16">16</xref>]. Each pool was hybridized to the Affymetrix <italic>Drosophila </italic>array (three technical replicates for each hybridization). Probesets measuring spikein transcripts were determined based on the analysis of [<xref ref-type="bibr" rid="B17">17</xref>]. We considered all probeset that measure differentially expressed genes to be true positives (a total of 1353 probesets).</p>
        <p>Several issues have been raised concerning the use of the Golden spikein dataset in validating GeneChip preprocessing algorithms [<xref ref-type="bibr" rid="B26">26</xref>-<xref ref-type="bibr" rid="B28">28</xref>]. However, the analysis of Pearson [<xref ref-type="bibr" rid="B29">29</xref>] shows clearly that the Golden spikein dataset can be used to validate and compare the performance of GeneChip preprocessing algorithms.</p>
      </sec>
    </sec>
    <sec>
      <title>Model implementation</title>
      <p>The single nucleotide model was implemented in Perl [<xref ref-type="bibr" rid="B30">30</xref>], the dinucleotide model was implemented in Java. All the models were fitted using the least squares method. The fitted parameters for the dinucleotide model for each of the two datasets were used to generate an affinity.info matrix for that dataset. This affinity.info matrix was used in GCRMA analysis later on. Affinity.info matrix generation was done using a local R script following the steps found in GCRMA source code (see <ext-link ext-link-type="uri" xlink:href="http://webpages.uncc.edu/~rgharaib/nnfit"/>). The Java code for the dinucleotide model is provided at <ext-link ext-link-type="uri" xlink:href="http://webpages.uncc.edu/~rgharaib/nnfit/FitNN.zip"/>.</p>
    </sec>
    <sec>
      <title>Data analysis</title>
      <p>All analysis steps were performed using R [<xref ref-type="bibr" rid="B31">31</xref>] version 2.5.0 and Bioconductor [<xref ref-type="bibr" rid="B32">32</xref>] unless otherwise indicated.</p>
      <sec>
        <title>Expression summaries</title>
        <p>Expression summaries were generated using the full model of GCRMA version 2.8.1. The commands used to generate the summaries for GCRMA-NN, GCRMA-L and GCRMA-R can be found at <ext-link ext-link-type="uri" xlink:href="http://webpages.uncc.edu/~rgharaib/nnfit"/>. The affinity.info matrix for the U133 Latin square dataset is provided as <ext-link ext-link-type="uri" xlink:href="http://webpages.uncc.edu/~rgharaib/nnfit/U133NNAffinity.RData"/>, and the Golden spikein dataset affinity.info matrix is provided as <ext-link ext-link-type="uri" xlink:href="http://webpages.uncc.edu/~rgharaib/nnfit/GoldenSpikeinNNAffinity.RData"/>.</p>
      </sec>
      <sec>
        <title>AffyComp analysis</title>
        <p>Affyomp analysis was done using a locally installed AffyComp 1.14.0 package. All expression summaries were converted back from the log scale to the original scale and formatted to a comma-delimited text files using a local Perl script. Metrics generation for the expression summaries was done using a local R script following the directions of the package maintainers. The following metrics were used to evaluate the performance of each algorithm (definitions are according to Affycomp website [<xref ref-type="bibr" rid="B33">33</xref>]): <bold>Median SD </bold>is the median standard deviation across replicates. It measures the consistency of the algorithm; the lower the median SD the more consistent the algorithm. <bold>Null log-fc IQR and null log-fc 99.9% </bold>are the interquartile range and the 99.9<sup>th </sup>percentile of the log fold changes from probesets, for genes that should not change. A perfect score is 0 for both metrics. <bold>Signal detect slope </bold>is the slope obtained from regressing expression values on nominal concentrations in the spikein data. <bold>Signal detect R</bold><sup>2 </sup>is the R squared obtained from regressing expression values on nominal concentrations in the spikein data. <bold>Low.slope, med.slope and high.slope </bold>are as in signal detect slope, but for probesets targeting low, medium and high spikeins, respectively. <bold>Obs-intended-fc and Obs-(low)int-fc slopes </bold>are slopes obtained from regressing observed log fold changes against nominal log fold changes for all probesets, and for those with nominal concentration less than 2 pM, respectively. <bold>Low, med and high AUC </bold>reflect the area under the ROC curve (with up to 100 false positives) for spikeins with low, medium and high intensities, standardized so that optimum is 1, respectively. <bold>Weighted avg AUC </bold>is the weighted average of the previous three ROC curves with weights related to amount of data in each class (low, medium and high).</p>
      </sec>
      <sec>
        <title>ROC curve and cyber t analysis</title>
        <p>ROC curve generation was implemented in Java and cyber <italic>t </italic>analysis was done in R. Detailed description of the implementation and the analysis can be found here [<xref ref-type="bibr" rid="B34">34</xref>].</p>
      </sec>
    </sec>
  </sec>
  <sec>
    <title>Authors' contributions</title>
    <p>RZG participated in the design of the study, coded the single nucleotide model (equation 1) and dinucleotide model (equation 3), carried out the analysis, and drafted the manuscript. AAF implemented the single nucleotide model (equation 2) and the analysis pipeline for Cyber <italic>t </italic>test and ROC curve generation. AAF, RZG and CJG conceived of the study, participated in its design, coordinated the research and analysis, and drafted the manuscript.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material content-type="local-data" id="S1">
      <caption>
        <title>Additional File 1</title>
        <p><bold>Boxplots showing the R<sup>2 </sup>of the single nucleotide model (N) (using the 100 free parameters (N100), equation 1, and the 16 free parameters (N16), equation 2) and the dinucleotide model with 64 free parameters (NN 64), equation 4 on the 42 Latin square chips.</bold> PM indicates the fit was done on the perfect match probes, MM indicates the fit was done on the mismatch probes, shuffled indicates the fit was done on the shuffled probe sequences and random indicates the fit was done on randomly generated probe sequences.</p>
      </caption>
      <media xlink:href="1471-2105-9-452-S1.pdf" mimetype="application" mime-subtype="pdf">
        <caption>
          <p>Click here for file</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <sec>
      <title>Acknowledgements</title>
      <p>This research was supported in part by NIH 1R01GM072619-01 (C.J.G.) and by the UNC-Charlotte GASP program (R.Z.G.).</p>
    </sec>
  </ack>
  <ref-list>
    <ref id="B1">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lockhart</surname>
            <given-names>DJ</given-names>
          </name>
          <name>
            <surname>Dong</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Byrne</surname>
            <given-names>MC</given-names>
          </name>
          <name>
            <surname>Follettie</surname>
            <given-names>MT</given-names>
          </name>
          <name>
            <surname>Gallo</surname>
            <given-names>MV</given-names>
          </name>
          <name>
            <surname>Chee</surname>
            <given-names>MS</given-names>
          </name>
          <name>
            <surname>Mittmann</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Kobayashi</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Horton</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Brown</surname>
            <given-names>EL</given-names>
          </name>
        </person-group>
        <article-title>Expression monitoring by hybridization to high-density oligonucleotide arrays</article-title>
        <source>Nat Biotechnol</source>
        <year>1996</year>
        <volume>14</volume>
        <fpage>1675</fpage>
        <lpage>1680</lpage>
        <pub-id pub-id-type="pmid">9634850</pub-id>
        <pub-id pub-id-type="doi">10.1038/nbt1296-1675</pub-id>
      </citation>
    </ref>
    <ref id="B2">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dalma-Weiszhausz</surname>
            <given-names>DD</given-names>
          </name>
          <name>
            <surname>Warrington</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Tanimoto</surname>
            <given-names>EY</given-names>
          </name>
          <name>
            <surname>Miyada</surname>
            <given-names>CG</given-names>
          </name>
        </person-group>
        <article-title>The affymetrix GeneChip platform: an overview</article-title>
        <source>Methods in enzymology</source>
        <year>2006</year>
        <volume>410</volume>
        <fpage>3</fpage>
        <lpage>28</lpage>
        <pub-id pub-id-type="pmid">16938544</pub-id>
        <pub-id pub-id-type="doi">10.1016/S0076-6879(06)10001-4</pub-id>
      </citation>
    </ref>
    <ref id="B3">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chudin</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Walker</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Kosaka</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Rabert</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Chang</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Kreder</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>Assessment of the relationship between signal intensities and transcript concentration for Affymetrix GeneChip(R) arrays</article-title>
        <source>Genome Biol</source>
        <year>2001</year>
        <volume>3</volume>
        <fpage>research0005.0001</fpage>
        <lpage>research0005.0010</lpage>
        <pub-id pub-id-type="pmid">11806828</pub-id>
        <pub-id pub-id-type="doi">10.1186/gb-2001-3-1-research0005</pub-id>
      </citation>
    </ref>
    <ref id="B4">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Forman</surname>
            <given-names>JE</given-names>
          </name>
          <name>
            <surname>Walton</surname>
            <given-names>ID</given-names>
          </name>
          <name>
            <surname>Stern</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Rava</surname>
            <given-names>RP</given-names>
          </name>
          <name>
            <surname>Trulson</surname>
            <given-names>MO</given-names>
          </name>
        </person-group>
        <article-title>Thermodynamics of duplex formation and mismatch discrimination on photolithographically synthesized oligonucleotide arrays</article-title>
        <source>ACS Symp Ser</source>
        <year>1998</year>
        <volume>682</volume>
        <fpage>206</fpage>
        <lpage>228</lpage>
      </citation>
    </ref>
    <ref id="B5">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Irizarry</surname>
            <given-names>RA</given-names>
          </name>
          <name>
            <surname>Hobbs</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Collin</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Beazer-Barclay</surname>
            <given-names>YD</given-names>
          </name>
          <name>
            <surname>Antonellis</surname>
            <given-names>KJ</given-names>
          </name>
          <name>
            <surname>Scherf</surname>
            <given-names>U</given-names>
          </name>
          <name>
            <surname>Speed</surname>
            <given-names>TP</given-names>
          </name>
        </person-group>
        <article-title>Exploration, normalization, and summaries of high density oligonucleotide array probe level data</article-title>
        <source>Biostat</source>
        <year>2003</year>
        <volume>4</volume>
        <fpage>249</fpage>
        <lpage>264</lpage>
        <pub-id pub-id-type="pmid">12925520</pub-id>
        <pub-id pub-id-type="doi">10.1093/biostatistics/4.2.249</pub-id>
      </citation>
    </ref>
    <ref id="B6">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Allison</surname>
            <given-names>DB</given-names>
          </name>
          <name>
            <surname>Cui</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Page</surname>
            <given-names>GP</given-names>
          </name>
          <name>
            <surname>Sabripour</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Microarray data analysis: from disarray to consolidation and consensus</article-title>
        <source>Nat Rev Genet</source>
        <year>2006</year>
        <volume>7</volume>
        <fpage>55</fpage>
        <lpage>65</lpage>
        <pub-id pub-id-type="pmid">16369572</pub-id>
        <pub-id pub-id-type="doi">10.1038/nrg1749</pub-id>
      </citation>
    </ref>
    <ref id="B7">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nielsen</surname>
            <given-names>HB</given-names>
          </name>
          <name>
            <surname>Gautier</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Knudsen</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Implementation of a gene expression index calculation method based on the PDNN model</article-title>
        <source>Bioinformatics</source>
        <year>2005</year>
        <volume>21</volume>
        <fpage>687</fpage>
        <lpage>688</lpage>
        <pub-id pub-id-type="pmid">15509605</pub-id>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bti078</pub-id>
      </citation>
    </ref>
    <ref id="B8">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Wong</surname>
            <given-names>WH</given-names>
          </name>
        </person-group>
        <article-title>Model-based analysis of oligonucleotide arrays: expression index computation and outlier detection</article-title>
        <source>Proc Natl Acad Sci USA</source>
        <year>2001</year>
        <volume>98</volume>
        <fpage>31</fpage>
        <lpage>36</lpage>
        <pub-id pub-id-type="pmid">11134512</pub-id>
        <pub-id pub-id-type="doi">10.1073/pnas.011404098</pub-id>
      </citation>
    </ref>
    <ref id="B9">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Irizarry</surname>
            <given-names>RA</given-names>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Jaffee</surname>
            <given-names>HA</given-names>
          </name>
        </person-group>
        <article-title>Comparison of Affymetrix GeneChip expression measures</article-title>
        <source>Bioinformatics</source>
        <year>2006</year>
        <volume>22</volume>
        <fpage>789</fpage>
        <lpage>794</lpage>
        <pub-id pub-id-type="pmid">16410320</pub-id>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btk046</pub-id>
      </citation>
    </ref>
    <ref id="B10">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wu</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Irizarry</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Gentleman</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Murillo</surname>
            <given-names>FM</given-names>
          </name>
          <name>
            <surname>Spencer</surname>
            <given-names>F</given-names>
          </name>
        </person-group>
        <article-title>A Model-Based Background Adjustment for Oligonucleotide Expression Arrays</article-title>
        <source>Journal of the American Statistical Association</source>
        <year>2004</year>
        <volume>99</volume>
        <fpage>909</fpage>
        <lpage>917</lpage>
        <pub-id pub-id-type="doi">10.1198/016214504000000683</pub-id>
      </citation>
    </ref>
    <ref id="B11">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Irizarry</surname>
            <given-names>RA</given-names>
          </name>
          <name>
            <surname>Bolstad</surname>
            <given-names>BM</given-names>
          </name>
          <name>
            <surname>Collin</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Cope</surname>
            <given-names>LM</given-names>
          </name>
          <name>
            <surname>Hobbs</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Speed</surname>
            <given-names>TP</given-names>
          </name>
        </person-group>
        <article-title>Summaries of Affymetrix GeneChip probe level data</article-title>
        <source>Nucleic Acids Res</source>
        <year>2003</year>
        <volume>31</volume>
        <fpage>e15</fpage>
        <pub-id pub-id-type="pmid">12582260</pub-id>
        <pub-id pub-id-type="doi">10.1093/nar/gng015</pub-id>
      </citation>
    </ref>
    <ref id="B12">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Qin</surname>
            <given-names>LX</given-names>
          </name>
          <name>
            <surname>Beyer</surname>
            <given-names>RP</given-names>
          </name>
          <name>
            <surname>Hudson</surname>
            <given-names>FN</given-names>
          </name>
          <name>
            <surname>Linford</surname>
            <given-names>NJ</given-names>
          </name>
          <name>
            <surname>Morris</surname>
            <given-names>DE</given-names>
          </name>
          <name>
            <surname>Kerr</surname>
            <given-names>KF</given-names>
          </name>
        </person-group>
        <article-title>Evaluation of methods for oligonucleotide array data via quantitative real-time PCR</article-title>
        <source>BMC bioinformatics</source>
        <year>2006</year>
        <volume>7</volume>
        <fpage>23</fpage>
        <pub-id pub-id-type="pmid">16417622</pub-id>
        <pub-id pub-id-type="doi">10.1186/1471-2105-7-23</pub-id>
      </citation>
    </ref>
    <ref id="B13">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wu</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Irizarry</surname>
            <given-names>RA</given-names>
          </name>
        </person-group>
        <article-title>Preprocessing of oligonucleotide array data</article-title>
        <source>Nat Biotechnol</source>
        <year>2004</year>
        <volume>22</volume>
        <fpage>656</fpage>
        <lpage>658</lpage>
        <comment>author reply 658.</comment>
        <pub-id pub-id-type="pmid">15175677</pub-id>
        <pub-id pub-id-type="doi">10.1038/nbt0604-656b</pub-id>
      </citation>
    </ref>
    <ref id="B14">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Vardhanabhuti</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Blakemore</surname>
            <given-names>SJ</given-names>
          </name>
          <name>
            <surname>Clark</surname>
            <given-names>SM</given-names>
          </name>
          <name>
            <surname>Ghosh</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Stephens</surname>
            <given-names>RJ</given-names>
          </name>
          <name>
            <surname>Rajagopalan</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>A comparison of statistical tests for detecting differential expression using Affymetrix oligonucleotide microarrays</article-title>
        <source>Omics</source>
        <year>2006</year>
        <volume>10</volume>
        <fpage>555</fpage>
        <lpage>566</lpage>
        <pub-id pub-id-type="pmid">17233564</pub-id>
        <pub-id pub-id-type="doi">10.1089/omi.2006.10.555</pub-id>
      </citation>
    </ref>
    <ref id="B15">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Naef</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Magnasco</surname>
            <given-names>MO</given-names>
          </name>
        </person-group>
        <article-title>Solving the riddle of the bright mismatches: labeling and effective binding in oligonucleotide arrays</article-title>
        <source>Phys Rev E Stat Nonlin Soft Matter Phys</source>
        <year>2003</year>
        <volume>68</volume>
        <fpage>011906</fpage>
        <pub-id pub-id-type="pmid">12935175</pub-id>
      </citation>
    </ref>
    <ref id="B16">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Choe</surname>
            <given-names>SE</given-names>
          </name>
          <name>
            <surname>Boutros</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Michelson</surname>
            <given-names>AM</given-names>
          </name>
          <name>
            <surname>Church</surname>
            <given-names>GM</given-names>
          </name>
          <name>
            <surname>Halfon</surname>
            <given-names>MS</given-names>
          </name>
        </person-group>
        <article-title>Preferred analysis methods for Affymetrix GeneChips revealed by a wholly defined control dataset</article-title>
        <source>Genome Biol</source>
        <year>2005</year>
        <volume>6</volume>
        <fpage>R16</fpage>
        <pub-id pub-id-type="pmid">15693945</pub-id>
        <pub-id pub-id-type="doi">10.1186/gb-2005-6-2-r16</pub-id>
      </citation>
    </ref>
    <ref id="B17">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schuster</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Blanc</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Partridge</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Thornton</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Estimation and correction of non-specific binding in a large-scale spike-in experiment</article-title>
        <source>Genome Biology</source>
        <year>2007</year>
        <volume>8</volume>
        <fpage>R126</fpage>
        <pub-id pub-id-type="pmid">17594493</pub-id>
        <pub-id pub-id-type="doi">10.1186/gb-2007-8-6-r126</pub-id>
      </citation>
    </ref>
    <ref id="B18">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>SantaLucia</surname>
            <given-names>J</given-names>
            <suffix>Jr</suffix>
          </name>
        </person-group>
        <article-title>A unified view of polymer, dumbbell, and oligonucleotide DNA nearest-neighbor thermodynamics</article-title>
        <source>Proc Natl Acad Sci USA</source>
        <year>1998</year>
        <volume>95</volume>
        <fpage>1460</fpage>
        <lpage>1465</lpage>
        <pub-id pub-id-type="pmid">9465037</pub-id>
        <pub-id pub-id-type="doi">10.1073/pnas.95.4.1460</pub-id>
      </citation>
    </ref>
    <ref id="B19">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>SantaLucia</surname>
            <given-names>J</given-names>
            <suffix>Jr</suffix>
          </name>
          <name>
            <surname>Hicks</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>The thermodynamics of DNA structural motifs</article-title>
        <source>Annu Rev Biophys Biomol Struct</source>
        <year>2004</year>
        <volume>33</volume>
        <fpage>415</fpage>
        <lpage>440</lpage>
        <pub-id pub-id-type="pmid">15139820</pub-id>
        <pub-id pub-id-type="doi">10.1146/annurev.biophys.32.110601.141800</pub-id>
      </citation>
    </ref>
    <ref id="B20">
      <citation citation-type="other">
        <article-title>The human genome U133 Latin Square dataset</article-title>
        <ext-link ext-link-type="uri" xlink:href="http://www.affymetrix.com/support/technical/sample_data/datasets.affx"/>
      </citation>
    </ref>
    <ref id="B21">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cope</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Irizarry</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Jafee</surname>
            <given-names>HW</given-names>
          </name>
          <name>
            <surname>Speed</surname>
            <given-names>TP</given-names>
          </name>
        </person-group>
        <article-title>A benchmark for Affymetrix GeneChip expression measures</article-title>
        <source>Bioinformatics</source>
        <year>2003</year>
        <volume>1</volume>
        <fpage>1</fpage>
        <lpage>13</lpage>
      </citation>
    </ref>
    <ref id="B22">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Baldi</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Long</surname>
            <given-names>AD</given-names>
          </name>
        </person-group>
        <article-title>A Bayesian framework for the analysis of microarray expression data: regularized t-test and statistical inferences of gene changes</article-title>
        <source>Bioinformatics</source>
        <year>2001</year>
        <volume>17</volume>
        <fpage>509</fpage>
        <lpage>519</lpage>
        <pub-id pub-id-type="pmid">11395427</pub-id>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/17.6.509</pub-id>
      </citation>
    </ref>
    <ref id="B23">
      <citation citation-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Bloomfield</surname>
            <given-names>VA</given-names>
          </name>
          <name>
            <surname>Crothers</surname>
            <given-names>DM</given-names>
          </name>
          <name>
            <surname>Tinoco</surname>
            <given-names>I</given-names>
          </name>
        </person-group>
        <source>Nucleic acids : structures, properties, and functions</source>
        <year>2000</year>
        <publisher-name>Sausalito, Calif.: University Science Books</publisher-name>
      </citation>
    </ref>
    <ref id="B24">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhang</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Miles</surname>
            <given-names>MF</given-names>
          </name>
          <name>
            <surname>Aldape</surname>
            <given-names>KD</given-names>
          </name>
        </person-group>
        <article-title>A model of molecular interactions on short oligonucleotide microarrays</article-title>
        <source>Nat Biotechnol</source>
        <year>2003</year>
        <volume>21</volume>
        <fpage>818</fpage>
        <lpage>821</lpage>
        <pub-id pub-id-type="pmid">12794640</pub-id>
        <pub-id pub-id-type="doi">10.1038/nbt836</pub-id>
      </citation>
    </ref>
    <ref id="B25">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhang</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Carta</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Baggerly</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Coombes</surname>
            <given-names>KR</given-names>
          </name>
        </person-group>
        <article-title>Response to Preprocessing of oligonucleotide array data</article-title>
        <source>Nat Biotechnol</source>
        <year>2004</year>
        <volume>22</volume>
        <fpage>658</fpage>
        <pub-id pub-id-type="pmid">15175679</pub-id>
        <pub-id pub-id-type="doi">10.1038/nbt0604-658</pub-id>
      </citation>
    </ref>
    <ref id="B26">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Irizarry</surname>
            <given-names>RA</given-names>
          </name>
          <name>
            <surname>Cope</surname>
            <given-names>LM</given-names>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>Z</given-names>
          </name>
        </person-group>
        <article-title>Feature-level exploration of a published Affymetrix GeneChip control dataset</article-title>
        <source>Genome Biol</source>
        <year>2006</year>
        <volume>7</volume>
        <fpage>404</fpage>
        <pub-id pub-id-type="pmid">16953902</pub-id>
        <pub-id pub-id-type="doi">10.1186/gb-2006-7-8-404</pub-id>
      </citation>
    </ref>
    <ref id="B27">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dabney</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Storey</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>A reanalysis of a published Affymetrix GeneChip control dataset</article-title>
        <source>Genome Biol</source>
        <year>2006</year>
        <volume>7</volume>
        <fpage>401</fpage>
        <pub-id pub-id-type="pmid">16563185</pub-id>
        <pub-id pub-id-type="doi">10.1186/gb-2006-7-3-401</pub-id>
      </citation>
    </ref>
    <ref id="B28">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gaile</surname>
            <given-names>DP</given-names>
          </name>
          <name>
            <surname>Miecznikowski</surname>
            <given-names>JC</given-names>
          </name>
        </person-group>
        <article-title>Putative null distributions corresponding to tests of differential expression in the Golden Spike dataset are intensity dependent</article-title>
        <source>BMC Genomics</source>
        <year>2007</year>
        <volume>8</volume>
        <fpage>105</fpage>
        <pub-id pub-id-type="pmid">17445265</pub-id>
        <pub-id pub-id-type="doi">10.1186/1471-2164-8-105</pub-id>
      </citation>
    </ref>
    <ref id="B29">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pearson</surname>
            <given-names>RD</given-names>
          </name>
        </person-group>
        <article-title>A comprehensive re-analysis of the Golden Spike data: towards a benchmark for differential expression methods</article-title>
        <source>BMC Bioinformatics</source>
        <year>2008</year>
        <volume>9</volume>
        <fpage>164</fpage>
        <pub-id pub-id-type="pmid">18366762</pub-id>
        <pub-id pub-id-type="doi">10.1186/1471-2105-9-164</pub-id>
      </citation>
    </ref>
    <ref id="B30">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gharaibeh</surname>
            <given-names>RZ</given-names>
          </name>
          <name>
            <surname>Fodor</surname>
            <given-names>AA</given-names>
          </name>
          <name>
            <surname>Gibas</surname>
            <given-names>CJ</given-names>
          </name>
        </person-group>
        <article-title>Software note: using probe secondary structure information to enhance Affymetrix GeneChip background estimates</article-title>
        <source>Comput Biol Chem</source>
        <year>2007</year>
        <volume>31</volume>
        <fpage>92</fpage>
        <lpage>98</lpage>
        <pub-id pub-id-type="pmid">17387043</pub-id>
        <pub-id pub-id-type="doi">10.1016/j.compbiolchem.2007.02.008</pub-id>
      </citation>
    </ref>
    <ref id="B31">
      <citation citation-type="book">
        <person-group person-group-type="author">
          <collab>R Development Core Team</collab>
        </person-group>
        <source>R: A Language and Environment for Statistical Computing</source>
        <year>2006</year>
        <publisher-name>Vienna, Austria: R Foundation for Statistical Computing</publisher-name>
      </citation>
    </ref>
    <ref id="B32">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gentleman</surname>
            <given-names>RC</given-names>
          </name>
          <name>
            <surname>Carey</surname>
            <given-names>VJ</given-names>
          </name>
          <name>
            <surname>Bates</surname>
            <given-names>DM</given-names>
          </name>
          <name>
            <surname>Bolstad</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Dettling</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Dudoit</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Ellis</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Gautier</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Ge</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Gentry</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Bioconductor: open software development for computational biology and bioinformatics</article-title>
        <source>Genome Biol</source>
        <year>2004</year>
        <volume>5</volume>
        <fpage>R80</fpage>
        <pub-id pub-id-type="pmid">15461798</pub-id>
        <pub-id pub-id-type="doi">10.1186/gb-2004-5-10-r80</pub-id>
      </citation>
    </ref>
    <ref id="B33">
      <citation citation-type="other">
        <article-title>Affycomp</article-title>
        <ext-link ext-link-type="uri" xlink:href="http://affycomp.biostat.jhsph.edu"/>
      </citation>
    </ref>
    <ref id="B34">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Fodor</surname>
            <given-names>AA</given-names>
          </name>
          <name>
            <surname>Tickle</surname>
            <given-names>TL</given-names>
          </name>
          <name>
            <surname>Richardson</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>Towards the uniform distribution of null P values on Affymetrix microarrays</article-title>
        <source>Genome Biol</source>
        <year>2007</year>
        <volume>8</volume>
        <fpage>R69</fpage>
        <pub-id pub-id-type="pmid">17472745</pub-id>
        <pub-id pub-id-type="doi">10.1186/gb-2007-8-5-r69</pub-id>
      </citation>
    </ref>
    <ref id="B35">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Armstrong</surname>
            <given-names>SA</given-names>
          </name>
          <name>
            <surname>Staunton</surname>
            <given-names>JE</given-names>
          </name>
          <name>
            <surname>Silverman</surname>
            <given-names>LB</given-names>
          </name>
          <name>
            <surname>Pieters</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>den Boer</surname>
            <given-names>ML</given-names>
          </name>
          <name>
            <surname>Minden</surname>
            <given-names>MD</given-names>
          </name>
          <name>
            <surname>Sallan</surname>
            <given-names>SE</given-names>
          </name>
          <name>
            <surname>Lander</surname>
            <given-names>ES</given-names>
          </name>
          <name>
            <surname>Golub</surname>
            <given-names>TR</given-names>
          </name>
          <name>
            <surname>Korsmeyer</surname>
            <given-names>SJ</given-names>
          </name>
        </person-group>
        <article-title>MLL translocations specify a distinct gene expression profile that distinguishes a unique leukemia</article-title>
        <source>Nat Genet</source>
        <year>2002</year>
        <volume>30</volume>
        <fpage>41</fpage>
        <lpage>47</lpage>
        <pub-id pub-id-type="pmid">11731795</pub-id>
        <pub-id pub-id-type="doi">10.1038/ng765</pub-id>
      </citation>
    </ref>
    <ref id="B36">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Meredith</surname>
            <given-names>AL</given-names>
          </name>
          <name>
            <surname>Wiler</surname>
            <given-names>SW</given-names>
          </name>
          <name>
            <surname>Miller</surname>
            <given-names>BH</given-names>
          </name>
          <name>
            <surname>Takahashi</surname>
            <given-names>JS</given-names>
          </name>
          <name>
            <surname>Fodor</surname>
            <given-names>AA</given-names>
          </name>
          <name>
            <surname>Ruby</surname>
            <given-names>NF</given-names>
          </name>
          <name>
            <surname>Aldrich</surname>
            <given-names>RW</given-names>
          </name>
        </person-group>
        <article-title>BK calcium-activated potassium channels regulate circadian behavioral rhythms and pacemaker output</article-title>
        <source>Nat Neurosci</source>
        <year>2006</year>
        <volume>9</volume>
        <fpage>1041</fpage>
        <lpage>1049</lpage>
        <pub-id pub-id-type="pmid">16845385</pub-id>
        <pub-id pub-id-type="doi">10.1038/nn1740</pub-id>
      </citation>
    </ref>
    <ref id="B37">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pyott</surname>
            <given-names>SJ</given-names>
          </name>
          <name>
            <surname>Meredith</surname>
            <given-names>AL</given-names>
          </name>
          <name>
            <surname>Fodor</surname>
            <given-names>AA</given-names>
          </name>
          <name>
            <surname>Vazquez</surname>
            <given-names>AE</given-names>
          </name>
          <name>
            <surname>Yamoah</surname>
            <given-names>EN</given-names>
          </name>
          <name>
            <surname>Aldrich</surname>
            <given-names>RW</given-names>
          </name>
        </person-group>
        <article-title>Cochlear function in mice lacking the BK channel alpha, beta1, or beta4 subunits</article-title>
        <source>J Biol Chem</source>
        <year>2007</year>
        <volume>282</volume>
        <fpage>3312</fpage>
        <lpage>3324</lpage>
        <pub-id pub-id-type="pmid">17135251</pub-id>
        <pub-id pub-id-type="doi">10.1074/jbc.M608726200</pub-id>
      </citation>
    </ref>
  </ref-list>
</back>
