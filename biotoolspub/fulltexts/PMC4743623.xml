<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d1 20130915//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 39.96?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 2?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-id journal-id-type="hwp">bioinfo</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">4743623</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btv568</article-id>
    <article-id pub-id-type="publisher-id">btv568</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Original Papers</subject>
        <subj-group subj-group-type="heading">
          <subject>Gene Expression</subject>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>MT-HESS: an efficient Bayesian approach for simultaneous association detection in OMICS datasets, with application to eQTL mapping in multiple tissues</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Lewin</surname>
          <given-names>Alex</given-names>
        </name>
        <xref ref-type="aff" rid="btv568-AFF1">
          <sup>1</sup>
        </xref>
        <xref ref-type="author-notes" rid="btv568-FN2">
          <sup>2</sup>
        </xref>
        <xref ref-type="author-notes" rid="btv568-FN1">
          <sup>†</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Saadi</surname>
          <given-names>Habib</given-names>
        </name>
        <xref ref-type="aff" rid="btv568-AFF2">
          <sup>2</sup>
        </xref>
        <xref ref-type="author-notes" rid="btv568-FN1">
          <sup>†</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Peters</surname>
          <given-names>James E.</given-names>
        </name>
        <xref ref-type="aff" rid="btv568-AFF3">
          <sup>3</sup>
        </xref>
        <xref ref-type="aff" rid="btv568-AFF4">
          <sup>4</sup>
        </xref>
        <xref ref-type="author-notes" rid="btv568-FN2">
          <sup>‡</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Moreno-Moral</surname>
          <given-names>Aida</given-names>
        </name>
        <xref ref-type="aff" rid="btv568-AFF5">
          <sup>5</sup>
        </xref>
        <xref ref-type="author-notes" rid="btv568-FN2">
          <sup>‡</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Lee</surname>
          <given-names>James C.</given-names>
        </name>
        <xref ref-type="aff" rid="btv568-AFF3">
          <sup>3</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Smith</surname>
          <given-names>Kenneth G. C.</given-names>
        </name>
        <xref ref-type="aff" rid="btv568-AFF3">
          <sup>3</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Petretto</surname>
          <given-names>Enrico</given-names>
        </name>
        <xref ref-type="aff" rid="btv568-AFF5">
          <sup>5</sup>
        </xref>
        <xref ref-type="aff" rid="btv568-AFF6">
          <sup>6</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Bottolo</surname>
          <given-names>Leonardo</given-names>
        </name>
        <xref ref-type="aff" rid="btv568-AFF7">
          <sup>7</sup>
        </xref>
        <xref ref-type="aff" rid="btv568-AFF8">
          <sup>8</sup>
        </xref>
        <xref ref-type="corresp" rid="btv568-COR1">*</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Richardson</surname>
          <given-names>Sylvia</given-names>
        </name>
        <xref ref-type="aff" rid="btv568-AFF4">
          <sup>4</sup>
        </xref>
        <xref ref-type="corresp" rid="btv568-COR1">*</xref>
      </contrib>
      <aff id="btv568-AFF1"><sup>1</sup>Department of Mathematics, Brunel University London, </aff>
      <aff id="btv568-AFF2"><sup>2</sup>Department of Epidemiology and Biostatistics, Imperial College London, London,</aff>
      <aff id="btv568-AFF3"><sup>3</sup>Cambridge Institute for Medical Research, University of Cambridge, Cambridge,</aff>
      <aff id="btv568-AFF4"><sup>4</sup>MRC Biostatistics Unit, Cambridge Institute of Public Health, Cambridge, </aff>
      <aff id="btv568-AFF5"><sup>5</sup>MRC Clinical Sciences Centre, Imperial College London, London, UK, </aff>
      <aff id="btv568-AFF6"><sup>6</sup>Duke-NUS Graduate Medical School, Singapore, Singapore,</aff>
      <aff id="btv568-AFF7"><sup>7</sup>Department of Mathematics, Imperial College London, London, UK and</aff>
      <aff id="btv568-AFF8"><sup>8</sup>Department of Medical Genetics, University of Cambridge</aff>
    </contrib-group>
    <author-notes>
      <corresp id="btv568-COR1"><sup>*</sup>To whom correspondence should be addressed.</corresp>
      <fn id="btv568-FN1">
        <p><sup>†</sup>The authors wish it to be known that, in their opinion, these authors should be regarded as Joint First Authors.</p>
      </fn>
      <fn id="btv568-FN2">
        <p><sup>‡</sup>The authors wish it to be known that, in their opinion, these authors should be regarded as Joint Second Authors.</p>
      </fn>
      <fn id="FN1">
        <p>Associate Editor: Janet Kelso</p>
      </fn>
    </author-notes>
    <pub-date pub-type="ppub">
      <day>15</day>
      <month>2</month>
      <year>2016</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>26</day>
      <month>10</month>
      <year>2015</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>26</day>
      <month>10</month>
      <year>2015</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the
							<pub-date pub-type="epub"/>. -->
    <volume>32</volume>
    <issue>4</issue>
    <fpage>523</fpage>
    <lpage>532</lpage>
    <history>
      <date date-type="received">
        <day>5</day>
        <month>12</month>
        <year>2014</year>
      </date>
      <date date-type="rev-recd">
        <day>26</day>
        <month>6</month>
        <year>2015</year>
      </date>
      <date date-type="accepted">
        <day>3</day>
        <month>9</month>
        <year>2015</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author 2015. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2015</copyright-year>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/" license-type="creative-commons">
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <abstract>
      <p><bold>Motivation:</bold> Analysing the joint association between a large set of responses and predictors is a fundamental statistical task in integrative genomics, exemplified by numerous expression Quantitative Trait Loci (eQTL) studies. Of particular interest are the so-called <bold>‘</bold>hotspots<bold>’</bold>, important genetic variants that regulate the expression of many genes. Recently, attention has focussed on whether eQTLs are common to several tissues, cell-types or, more generally, conditions or whether they are specific to a particular condition.</p>
      <p><bold>Results:</bold> We have implemented MT-HESS, a Bayesian hierarchical model that analyses the association between a large set of predictors, e.g. SNPs, and many responses, e.g. gene expression, in multiple tissues, cells or conditions. Our Bayesian sparse regression algorithm goes beyond <bold>‘</bold>one-at-a-time<bold>’</bold> association tests between SNPs and responses and uses a fully multivariate model search across all linear combinations of SNPs, coupled with a model of the correlation between condition/tissue-specific responses. In addition, we use a hierarchical structure to leverage shared information across different genes, thus improving the detection of hotspots. We show the increase of power resulting from our new approach in an extensive simulation study. Our analysis of two case studies highlights new hotspots that would remain undetected by standard approaches and shows how greater prediction power can be achieved when several tissues are jointly considered.</p>
      <p><bold>Availability and implementation:</bold> C<inline-formula><mml:math id="MM1"><mml:mrow><mml:mo>+</mml:mo><mml:mo>+</mml:mo></mml:mrow></mml:math></inline-formula> source code and documentation including compilation instructions are available under GNU licence at <ext-link ext-link-type="uri" xlink:href="http://www.mrc-bsu.cam.ac.uk/software/">http://www.mrc-bsu.cam.ac.uk/software/</ext-link><bold>.</bold></p>
      <p><bold>Contact:</bold><email>sylvia.richardson@mrc-bsu.cam.ac.uk</email> or <email>lb664@cam.ac.uk</email></p>
      <p><bold>Supplementary information:</bold><ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btv568/-/DC1">Supplementary data</ext-link> are available at <italic>Bioinformatics</italic> online.</p>
    </abstract>
    <counts>
      <page-count count="10"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>Integrating different layers of genomic information is essential to improve our understanding of the genetic basis of complex diseases. The development of integrative analysis strategies has become an important part of experimental design in the era of next-generation genomics (<xref rid="btv568-B12" ref-type="bibr">Hawkins <italic>et</italic>
<italic>al.</italic>, 2010</xref>). A fundamental task faced by many integrative strategies in genomics is to study the associations between two high-dimensional datasets. The study of such associations and the related biological questions can be naturally built within a regression framework, which exploits prior biological knowledge on the direction of the relationships between the different layers of genomics data.</p>
    <p>One prime example is expression quantitative trait loci (eQTL) analysis, which links DNA polymorphisms to gene expression levels on a genome-wide basis. Typically, such analyses would involve testing for association of all transcript-SNP pairs. When eQTL studies involve large numbers of variants and genes, performing millions of such tests can become slow and it has been necessary to develop fast implementations (<xref rid="btv568-B32" ref-type="bibr">Shabalin, 2012</xref>). To go beyond such ‘one at-a-time’ strategies, eQTL mapping can be performed using high-dimensional regression models with expression measurements modelled as responses and genetic variants as predictors (<xref rid="btv568-B3" ref-type="bibr">Bottolo <italic>et</italic>
<italic>al.</italic>, 2011</xref>; <xref rid="btv568-B10" ref-type="bibr">Fusi <italic>et al.</italic>, 2012</xref>; <xref rid="btv568-B31" ref-type="bibr">Scott-Boyer <italic>et</italic>
<italic>al.</italic>, 2012</xref>). The high-dimensional regression framework leverages information across the set of responses that are related to the same predictor, increasing the probability of detecting hotspots, i.e. genomic loci that regulate several genes at once.</p>
    <p>There is currently much interest in dissecting tissue, cell type or condition specificity of eQTLs (<xref rid="btv568-B8" ref-type="bibr">Fairfax <italic>et</italic>
<italic>al.</italic>, 2012</xref>; <xref rid="btv568-B16" ref-type="bibr">Lee <italic>et</italic>
<italic>al.</italic>, 2014</xref>; <xref rid="btv568-B22" ref-type="bibr">Melé <italic>et</italic>
<italic>al.</italic>, 2015</xref>; <xref rid="btv568-B27" ref-type="bibr">Raj <italic>et al.</italic>, 2014</xref>; <xref rid="btv568-B35" ref-type="bibr">Westra <italic>et</italic>
<italic>al.</italic>, 2013</xref>). The multiple tissues or cell types add an extra dimension to the data. For instance, analysis of eQTLs across multiple tissues or cell types can inform to which extent eQTLs are shared (or conserved) between different systems, therefore elucidating fundamental genetic regulatory mechanisms. So far these questions have been addressed using one of two alternative approaches. The first uses separate analysis for each tissue, and intersects the resulting lists of genetic variants (<xref rid="btv568-B8" ref-type="bibr">Fairfax <italic>et</italic>
<italic>al.</italic>, 2012</xref>). The second approach (<xref rid="btv568-B9" ref-type="bibr">Flutre <italic>et</italic>
<italic>al.</italic>, 2013</xref>; <xref rid="btv568-B26" ref-type="bibr">Petretto <italic>et</italic>
<italic>al.</italic>, 2010</xref>) combines tissues but performs a separate analysis for each predictor (genetic variant) and response (gene expression level). Neither approach fully exploits the data available, nor both can result in a loss of power to detect small effect eQTLs that are shared across conditions. To the best of our knowledge, there is currently no alternative method that goes beyond ‘one-at-a-time’ association tests and models <italic>simultaneously</italic> the expression of multiple genes under multiple conditions in a multivariate way.</p>
    <p>In this article, we propose a generic Bayesian variable selection approach and an associated evolutionary stochastic search algorithm to tackle the challenging integrative task of linking parallel high-dimensional multivariate regressions in a computationally efficient way. The specificity of our approach is: (i) to move away from single feature at-a-time analysis and account for the correlated nature of the predictors by implementing a fully multivariate model search over the space of predictors (ii) to allow the analysis of multi-dimensional responses, and (iii) to exploit the <italic>relatedness</italic> of multiple responses through a Bayesian hierarchical model. Hierarchical modelling of expression responses allows us to exploit the potential functional relationships (e.g. co-regulation relationship, mRNA–mRNA interactions, protein–protein interactions, etc.) between multiple genes, thus increasing the power to detect hotspots. We build on our previous work (<xref rid="btv568-B3" ref-type="bibr">Bottolo <italic>et al.</italic>, 2011</xref>; <xref rid="btv568-B26" ref-type="bibr">Petretto <italic>et</italic>
<italic>al.</italic>, 2010</xref>), demonstrate the power of our new efficient hierarchical implementation in an extensive simulation study when compared with MANOVA or the intersection of condition/tissue-specific results. We also illustrate the benefits of our approach in two case studies related to eQTLs in multiple conditions (tissues or cell types), where we recapitulate previously validated hotspots and uncover new hotspots. In one case study, we also show that when several tissues are jointly considered the prediction error is substantially reduced compared with separate single-tissue analysis.</p>
    <p>Even though our case studies relate to eQTL analyses, the model and algorithm that we present are generic and can be used for a large range of integrative genomics analyses that can be formulated within a parallel regression framework, such as finding targets for miRNAs by regressing gene expression levels on miRNA levels (<xref rid="btv568-B34" ref-type="bibr">Stingo <italic>et</italic>
<italic>al.</italic>, 2010</xref>), linking DNA variation and metabolites levels, the so-called mQTL analyses (<xref rid="btv568-B21" ref-type="bibr">Marttinen <italic>et</italic>
<italic>al.</italic>, 2014</xref>), or linking copy number alterations and tumour gene expression (<xref rid="btv568-B15" ref-type="bibr">Kristensen <italic>et</italic>
<italic>al.</italic>, 2014</xref>).</p>
  </sec>
  <sec>
    <title>2 Modelling approach</title>
    <p>We describe here in a non-technical fashion how we model the association between multiple responses, here the expression of genes in different conditions (e.g. tissues, cell-types, disease states, etc.), and many predictors, here the SNPs. We present a Bayesian variable selection method that acts simultaneously on three levels:
<list list-type="order"><list-item><p>Each response in each tissue is sparse-regressed on all the predictors.</p></list-item><list-item><p>The sparse regressions from all tissues for the same response are performed <italic>jointly</italic> as a multi-variate regression, modelling the correlation between tissues, with the same predictors selected for controlling the response in all tissues.</p></list-item><list-item><p>The multi-tissue regressions across all responses are influenced by shared prior parameters that encourage borrowing of information.</p></list-item></list>Combining information between tissues allows us to boost signal in a robust way because the residual correlation is modelled accurately by latent covariance matrices.</p>
    <p>The first level is the key driver of the method. This single response variable selection is accurately described in <xref rid="btv568-B2" ref-type="bibr">Bottolo and Richardson (2010)</xref>. Building on a sparse formulation, this level of analysis eliminates all predictors for which the signal is not strong enough. The model takes into account the correlation between predictors to better identify the best supported combination of predictors. The performance of this method is illustrated in <xref rid="btv568-B2" ref-type="bibr">Bottolo and Richardson (2010)</xref> and <xref rid="btv568-B4" ref-type="bibr">Bottolo <italic>et</italic>
<italic>al.</italic> (2013)</xref>, and it shows a major improvement over univariate and commonly used penalized regression methods used in the ‘large <italic>p</italic>, small <italic>n</italic>’ framework in terms of separation between signal and background noise, and in terms of genetic resolution as it can handle the highly correlated predictors that result from linkage disequilibrium (LD).</p>
    <p>The second level is built on top of this variable selection, in the sense that evidence from all the tissues influences the probability for a predictor to be selected. This strong assumption is reasonable only when considering a small number of correlated traits for which evidence of <italic>joint control</italic> is interesting to quantify. Note that once a predictor is selected, tissue-specific regression coefficients can be estimated from the posterior distribution.</p>
    <p>The third level pools information across all responses in order to enhance the detection of hotspots. It also has the great benefit of eliminating many false positives. The performance of this choice of prior was explored in <xref rid="btv568-B3" ref-type="bibr">Bottolo <italic>et</italic>
<italic>al.</italic> (2011)</xref>.</p>
  </sec>
  <sec>
    <title>3 Methods</title>
    <sec>
      <title>3.1 Bayesian hierarchical sparse regressions</title>
      <p>Our model is an extension of HESS algorithm (<xref rid="btv568-B3" ref-type="bibr">Bottolo <italic>et al.</italic>, 2011</xref>; <xref rid="btv568-B28" ref-type="bibr">Richardson <italic>et</italic>
<italic>al.</italic>, 2010</xref>) to the case where the response variables are observed in multiple conditions, e.g. in different tissues, cell types or time points.</p>
      <p>We consider <italic>q</italic> response variables observed in <italic>r</italic> different conditions. In the following, we will use upper-case letters for matrices and lower-case letters for vectors and scalars. For <inline-formula><mml:math id="MM2"><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>q</mml:mi></mml:mrow></mml:math></inline-formula>, let <italic>Y<sub>k</sub></italic> be an <inline-formula><mml:math id="MM3"><mml:mrow><mml:mi>n</mml:mi><mml:mo>×</mml:mo><mml:mi>r</mml:mi></mml:mrow></mml:math></inline-formula> matrix, whose entry <inline-formula><mml:math id="MM4"><mml:mrow><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>k</mml:mi><mml:mi>ℓ</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> is the response <italic>k</italic> measured in condition <inline-formula><mml:math id="MM5"><mml:mi>ℓ</mml:mi></mml:math></inline-formula> for individual <italic>i.</italic> The explanatory variables are stored in an <italic>n</italic> × <italic>p</italic> matrix <italic>X</italic> such that <inline-formula><mml:math id="MM6"><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> is the <italic>j</italic>th explanatory variable measured in individual <italic>i.</italic> The association between the explanatory variables and the responses is modelled through <italic>q</italic> linear regressions linked by a hierarchical model. Each of the <italic>q</italic> regression equations is given by
<disp-formula><mml:math id="MM7"><mml:mrow><mml:msub><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mi>X</mml:mi><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>∼</mml:mo><mml:mi mathvariant="script" class="calligraphy">N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>Σ</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>
where the matrix of regression coefficients <italic>B<sub>k</sub></italic> is of size <inline-formula><mml:math id="MM8"><mml:mrow><mml:mi>p</mml:mi><mml:mo>×</mml:mo><mml:mi>r</mml:mi></mml:mrow></mml:math></inline-formula>, whose generic element <inline-formula><mml:math id="MM9"><mml:mrow><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mi>j</mml:mi><mml:mi>ℓ</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> is the regression coefficient relating <italic>x<sub>j</sub></italic> to <italic>y<sub>k</sub></italic> in condition <inline-formula><mml:math id="MM10"><mml:mi>ℓ</mml:mi></mml:math></inline-formula>. Finally, <inline-formula><mml:math id="MM11"><mml:mrow><mml:mi mathvariant="script" class="calligraphy">N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>Σ</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> is the matrix normal distribution with independent rows, and columns correlated according to the <italic>r</italic> × <italic>r</italic> covariance matrix Σ<italic><sub>k</sub></italic> (<xref rid="btv568-B6" ref-type="bibr">Brown <italic>et</italic>
<italic>al.</italic>, 1998</xref>). The intercept <italic>A<sub>k</sub></italic> and the between-conditions covariance matrix Σ<italic><sub>k</sub></italic> are specific to each response <italic>k.</italic> To perform variable selection, we introduce a binary matrix Γ of size <italic>q</italic> × <italic>p</italic> such that <inline-formula><mml:math id="MM12"><mml:mrow><mml:msub><mml:mrow><mml:mi>γ</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> implies <inline-formula><mml:math id="MM13"><mml:mrow><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mi>j</mml:mi><mml:mi>ℓ</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> for all <inline-formula><mml:math id="MM14"><mml:mi>ℓ</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="MM15"><mml:mrow><mml:msub><mml:mrow><mml:mi>γ</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> implies <inline-formula><mml:math id="MM16"><mml:mrow><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mi>j</mml:mi><mml:mi>ℓ</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo>≠</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> for for all <inline-formula><mml:math id="MM17"><mml:mi>ℓ</mml:mi></mml:math></inline-formula>. For a given <italic>k</italic>, we denote by <italic>γ<sub>k</sub></italic> the row binary vector <inline-formula><mml:math id="MM18"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>γ</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>γ</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> with the number of its non-zero entries given by <inline-formula><mml:math id="MM19"><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mrow><mml:mi>γ</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:math></inline-formula>. The matrix <inline-formula><mml:math id="MM20"><mml:mrow><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>γ</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> of size <inline-formula><mml:math id="MM21"><mml:mrow><mml:mi>n</mml:mi><mml:mo>×</mml:mo><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mrow><mml:mi>γ</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:math></inline-formula> is obtained by selecting from the matrix <italic>X</italic> all the columns <italic>j</italic> such that <inline-formula><mml:math id="MM22"><mml:mrow><mml:msub><mml:mrow><mml:mi>γ</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>. Similarly, we define <inline-formula><mml:math id="MM23"><mml:mrow><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>γ</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> to be the matrix of non-zero coefficients of dimension <inline-formula><mml:math id="MM24"><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mrow><mml:mi>γ</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:mo>×</mml:mo><mml:mi>r</mml:mi></mml:mrow></mml:math></inline-formula> obtained by selecting from the matrix <italic>B<sub>k</sub></italic> all the rows <italic>j</italic> such that <inline-formula><mml:math id="MM25"><mml:mrow><mml:msub><mml:mrow><mml:mi>γ</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>.</p>
      <p>Conditionally on Γ, <inline-formula><mml:math id="MM26"><mml:mrow><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>q</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi>q</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="MM27"><mml:mrow><mml:msub><mml:mrow><mml:mi>Σ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>Σ</mml:mi></mml:mrow><mml:mrow><mml:mi>q</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>, the <italic>q</italic> sparse regressions
<disp-formula><mml:math id="MM28"><mml:mrow><mml:msub><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>γ</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>γ</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:msub><mml:mo>∼</mml:mo><mml:mi mathvariant="script" class="calligraphy">N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>Σ</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></disp-formula>
are independent, and their joint likelihood is given by
<disp-formula><mml:math id="MM29"><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∏</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>q</mml:mi></mml:munderover><mml:mo stretchy="false">(</mml:mo></mml:mstyle><mml:msup><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>2</mml:mn><mml:mi>π</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mrow><mml:mi>Σ</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mi>n</mml:mi><mml:mo>/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:mrow></mml:msup><mml:mi>exp</mml:mi><mml:mo>{</mml:mo><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac><mml:mtext>tr</mml:mtext><mml:mo stretchy="false">[</mml:mo><mml:msubsup><mml:mrow><mml:mi>Σ</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mrow></mml:msubsup><mml:mo>×</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>γ</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>γ</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mtext>T</mml:mtext></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>γ</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>γ</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mo>}</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula>
</p>
    </sec>
    <sec>
      <title>3.2 Prior settings</title>
      <p>The prior distribution for the regression coefficients for the <italic>k</italic>th response is the matrix–variate normal
<disp-formula><mml:math id="MM30"><mml:mrow><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>γ</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:msub><mml:mo> </mml:mo><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mrow><mml:mi>γ</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>Σ</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo> </mml:mo><mml:mo>∼</mml:mo><mml:mo> </mml:mo><mml:mi mathvariant="script" class="calligraphy">N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo> </mml:mo><mml:mi>g</mml:mi><mml:msup><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>γ</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msubsup><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>γ</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>Σ</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo> </mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>
centred in the <inline-formula><mml:math id="MM31"><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mrow><mml:mi>γ</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:mo>×</mml:mo><mml:mi>r</mml:mi></mml:mrow></mml:math></inline-formula> matrix of 0 s, where the prior covariance of the regression coefficients follows a <italic>g</italic>-prior (<xref rid="btv568-B2" ref-type="bibr">Bottolo and Richardson, 2010</xref>). We choose for the constant <italic>A<sub>k</sub></italic> the non-informative prior <inline-formula><mml:math id="MM32"><mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>∝</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>. To gain flexibility in fitting the correct amount of shrinkage, the parameter <italic>g</italic> is learned from the data, and its prior distribution is given by <inline-formula><mml:math id="MM33"><mml:mrow><mml:mi>g</mml:mi><mml:mo>∼</mml:mo><mml:mtext>InvGamma</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>.</p>
      <p>For the binary matrix Γ, we introduce a <italic>q</italic> × <italic>p</italic> matrix Ω such that <inline-formula><mml:math id="MM34"><mml:mrow><mml:mtext>P</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>γ</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo> </mml:mo><mml:mo stretchy="false">|</mml:mo><mml:mo> </mml:mo><mml:mi>Ω</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>ω</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>. To favour hotspot detection while maintaining a sparsity prior Γ, we decompose each cell of the matrix <italic>ω</italic> as <inline-formula><mml:math id="MM35"><mml:mrow><mml:msub><mml:mrow><mml:mi>ω</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>ω</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>×</mml:mo><mml:msub><mml:mrow><mml:mi>ρ</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>, where the row effect <italic>ω<sub>k</sub></italic> accounts for the sparsity, and the column effect <italic>ρ<sub>j</sub></italic> accounts for the propensity of predictor <italic>j</italic> to be a hotspot, that is to be associated to a significant proportion of the responses (see the following section for hotspots definition in practical applications). The sparsity prior is given by <inline-formula><mml:math id="MM36"><mml:mrow><mml:msub><mml:mrow><mml:mi>ω</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>∼</mml:mo><mml:mtext>Beta</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>ω</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>ω</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="MM37"><mml:mrow><mml:msub><mml:mrow><mml:mi>ρ</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>∼</mml:mo><mml:mtext>Gamma</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>ρ</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>ρ</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, where <inline-formula><mml:math id="MM38"><mml:mrow><mml:msub><mml:mrow><mml:mi>ω</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>ω</mml:mi></mml:mrow><mml:mrow><mml:mi>q</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="MM39"><mml:mrow><mml:msub><mml:mrow><mml:mi>ρ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>ρ</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> are all <italic>a priori</italic> independent. To enforce that <italic>ω<sub>kj</sub></italic> is a probability, we impose the constraint <inline-formula><mml:math id="MM40"><mml:mrow><mml:mn>0</mml:mn><mml:mo>≤</mml:mo><mml:msub><mml:mrow><mml:mi>ω</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>×</mml:mo><mml:msub><mml:mrow><mml:mi>ρ</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>≤</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>. The interested reader is referred to <xref rid="btv568-B3" ref-type="bibr">Bottolo <italic>et</italic>
<italic>al.</italic> (2011)</xref> for further information about the multiplicative decomposition of <italic>ω<sub>kj</sub></italic> and the sparsity priors assigned to its components. Finally, the prior for the cross-tissue error covariance matrix Σ<italic><sub>k</sub></italic> is an Inverse Wishart distribution, <inline-formula><mml:math id="MM41"><mml:mrow><mml:msub><mml:mrow><mml:mi>Σ</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>∼</mml:mo><mml:mtext>IW</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi>d</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>.</p>
      <p>The priors we have chosen allow to integrate out the regression coefficients <italic>B<sub>k</sub></italic>, the intercepts <italic>A<sub>k</sub></italic> and the residual cross conditions covariances Σ<italic><sub>k</sub>.</italic> For each response <italic>k</italic>, <inline-formula><mml:math id="MM42"><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>q</mml:mi></mml:mrow></mml:math></inline-formula>, the conditional marginal likelihood is given by
<disp-formula><mml:math id="MM43"><mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:mi>X</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>γ</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>g</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>∝</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi>g</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mrow><mml:mi>γ</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:mo>/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:mrow></mml:msup><mml:mo>×</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi>g</mml:mi></mml:mrow></mml:mrow></mml:mfrac><mml:msubsup><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msubsup><mml:msub><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi>g</mml:mi></mml:mrow></mml:mrow></mml:mfrac><mml:mi>R</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>γ</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>d</mml:mi><mml:mo>+</mml:mo><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mi>r</mml:mi><mml:mo>−</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:mrow></mml:msup><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>
where
<disp-formula><mml:math id="MM44"><mml:mrow><mml:mi>R</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>γ</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mtext>T</mml:mtext></mml:mrow></mml:msubsup><mml:msub><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msubsup><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mtext>T</mml:mtext></mml:mrow></mml:msubsup><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>γ</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:msub><mml:msup><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>γ</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow><mml:mrow><mml:mtext>T</mml:mtext></mml:mrow></mml:msubsup><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>γ</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mrow></mml:msup><mml:msubsup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>γ</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow><mml:mrow><mml:mtext>T</mml:mtext></mml:mrow></mml:msubsup><mml:msub><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula>
The joint distribution of the Bayesian model factorizes as
<disp-formula id="btv568-M1"><label>(1)</label><mml:math id="MM45"><mml:mrow><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∏</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>q</mml:mi></mml:munderover><mml:mi>p</mml:mi></mml:mstyle><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo> </mml:mo><mml:mo stretchy="false">|</mml:mo><mml:mo> </mml:mo><mml:mi>X</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>γ</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>g</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>γ</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo> </mml:mo><mml:mo stretchy="false">|</mml:mo><mml:mo> </mml:mo><mml:msub><mml:mrow><mml:mi>ω</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>ρ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>ρ</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo> </mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>ω</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>}</mml:mo></mml:mrow><mml:mo>×</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>g</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>ρ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>ρ</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></disp-formula>
To complete the specification of the model, we need to discuss the hyperparameters setting for the priors. Regarding the shrinkage parameter <italic>g</italic>, a popular choice is the Zellner–Siow prior <inline-formula><mml:math id="MM46"><mml:mrow><mml:mi>g</mml:mi><mml:mo>∼</mml:mo><mml:mtext>InvGamma</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mi>n</mml:mi><mml:mo>/</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, which allows to learn the amount of shrinkage from the data. Theoretical results show good properties of this prior in model selection (<xref rid="btv568-B20" ref-type="bibr">Liang <italic>et</italic>
<italic>al.</italic>, 2008</xref>), but little is known when the Zellner prior is used in <italic>q</italic> related (multiple conditions/tissues) regressions with an exchangeable shrinkage prior on <italic>g.</italic> In our set-up we have found empirically that when <italic>q</italic> is large the level of shrinkage is too low. We adapted the Zellner–Siow prior to related multiple responses by taking <inline-formula><mml:math id="MM47"><mml:mrow><mml:mi>g</mml:mi><mml:mo>∼</mml:mo><mml:mtext>InvGamma</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi>q</mml:mi><mml:mo>/</mml:mo><mml:mn>2</mml:mn><mml:mo>+</mml:mo><mml:mi>q</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>n</mml:mi><mml:mi>q</mml:mi><mml:mo>/</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>. This corresponds to keep the same prior mode for <italic>g</italic> as in <italic>q</italic> = 1, and at the same time increasing the precision of the prior proportionally to the number of responses. In our experiments, this improved the performance.</p>
      <p>We fix <inline-formula><mml:math id="MM48"><mml:mrow><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>ρ</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1.2</mml:mn></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="MM49"><mml:mrow><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>ρ</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1.2</mml:mn></mml:mrow></mml:math></inline-formula> for all <italic>j</italic>, in order to centre <italic>ρ<sub>j</sub></italic> on average around 1. This choice of parameters for the Gamma distribution ensures a finite mode while allowing a large coefficient of variation, thus providing necessary shrinkage for most <italic>ρ<sub>j</sub></italic>s towards 1 but also supporting some large <italic>ρ<sub>j</sub></italic>s to enhance hot-spot detection. Alternative parameterizations cannot achieve these two competing goals simultaneously. See <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btv568/-/DC1">Supplementary Material, Section S.4</ext-link>, for a sensitivity analysis on a simulated and real dataset. We let the parameters <inline-formula><mml:math id="MM50"><mml:mrow><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>ω</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="MM51"><mml:mrow><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>ω</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> to be chosen according to the specific dataset to be analysed. These hyperparamters are determined by back calculation once, for each <italic>k</italic>, <inline-formula><mml:math id="MM52"><mml:mrow><mml:mtext>E</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mrow><mml:mi>γ</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:math></inline-formula>) and <inline-formula><mml:math id="MM53"><mml:mrow><mml:mtext>Var</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mrow><mml:mi>γ</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:math></inline-formula>) (respectively, the <italic>a priori</italic> expected number of predictors and its variance for each response <italic>k</italic>) are specified.</p>
      <p>Finally, for the covariance matrices Σ<italic><sub>k</sub></italic>, we choose the convenient value <italic>d</italic> = 3, which brings <inline-formula><mml:math id="MM54"><mml:mrow><mml:mtext>E</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>Σ</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mi>I</mml:mi></mml:mrow></mml:math></inline-formula>. The choice for <italic>h<sub>k</sub></italic> is more complicated, as it should be comparable in size with the likely error variance. We use the same empirical Bayes approach as in <xref rid="btv568-B26" ref-type="bibr">Petretto <italic>et</italic>
<italic>al.</italic> (2010)</xref>, that is, for a given response <italic>k</italic>, we run a stepwise regression for each condition <inline-formula><mml:math id="MM55"><mml:mrow><mml:mi>ℓ</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>r</mml:mi></mml:mrow></mml:math></inline-formula>. Then we set <italic>h<sub>k</sub></italic> as the median of the condition-specific estimates of the error variance.</p>
    </sec>
    <sec>
      <title>3.3 MCMC algorithm</title>
      <p>The inference on this high-dimensional model is performed using a specifically designed MCMC algorithm. This algorithm has already been presented in great detail in <xref rid="btv568-B2" ref-type="bibr">Bottolo and Richardson (2010)</xref>, <xref rid="btv568-B28" ref-type="bibr">Richardson <italic>et</italic>
<italic>al.</italic> (2010)</xref> and <xref rid="btv568-B3" ref-type="bibr">Bottolo <italic>et</italic>
<italic>al.</italic> (2011)</xref>, so we are simply sketching its structure, and we refer to the relevant sources for all the technical details.</p>
      <p>The variables sampled are those that appear in the posterior density (<xref ref-type="disp-formula" rid="btv568-M1">1</xref>), that is the <italic>q</italic> × <italic>p</italic> matrix <inline-formula><mml:math id="MM56"><mml:mrow><mml:mi>Γ</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>γ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>γ</mml:mi></mml:mrow><mml:mrow><mml:mi>q</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mtext>T</mml:mtext></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>, the vectors <inline-formula><mml:math id="MM57"><mml:mrow><mml:msub><mml:mrow><mml:mi>ω</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>ω</mml:mi></mml:mrow><mml:mrow><mml:mi>q</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="MM58"><mml:mrow><mml:msub><mml:mrow><mml:mi>ρ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>ρ</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>, and the parameter <italic>g.</italic> The challenging part is the sampling of the matrices Γ, and this problem is solved by relying on an Evolutionary Monte Carlo (EMC) structure as introduced in <xref rid="btv568-B19" ref-type="bibr">Liang and Wong (2000)</xref>. To avoid being trapped in a local mode, EMC samples several chains, each with its own temperature, and allows them to exchange information. At each step, the chains are updated by local moves which act on a single chain (i.e. traditional MCMC moves), as well by global moves, which use a selection step inspired from genetic algorithms.</p>
      <p>In our setting, if we run the MCMC algorithm for <italic>T</italic> sweeps and <italic>C</italic> chains, its output is given by <inline-formula><mml:math id="MM59"><mml:mrow><mml:msup><mml:mrow><mml:mi>Γ</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:msubsup><mml:mrow><mml:mi>ω</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>ω</mml:mi></mml:mrow><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:msubsup><mml:mrow><mml:mi>ρ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>ρ</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="MM60"><mml:mrow><mml:msup><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> with <inline-formula><mml:math id="MM61"><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>...</mml:mn><mml:mo>,</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="MM62"><mml:mrow><mml:mi>c</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>...</mml:mn><mml:mo>,</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:math></inline-formula>. The parameter <italic>g</italic> has been kept in a single chain because this setting allowed for a faster convergence of our algorithm (see <xref rid="btv568-B3" ref-type="bibr">Bottolo <italic>et</italic>
<italic>al</italic><italic>.</italic>, 2011</xref>). All the details regarding the local moves and the global moves, as well as the tuning of the temperature parameters, can be found in <xref rid="btv568-B2" ref-type="bibr">Bottolo and Richardson (2010)</xref> and <xref rid="btv568-B3" ref-type="bibr">Bottolo <italic>et</italic>
<italic>al.</italic> (2011)</xref>.</p>
      <p>The following pseudo-algorithm shows the various moves performed at each iteration. <boxed-text position="float" orientation="portrait"><caption><p>Algorithm 1. MCMC algorithm iteration</p></caption><p><list list-type="order"><list-item><p> Sample uniformly the responses to update.</p></list-item><list-item><p> For each response <italic>k</italic> to update:
<list list-type="simple"><list-item><p>   2.1 For each chain <italic>c</italic>, update the <italic>k</italic>th row of <inline-formula><mml:math id="MM63"><mml:mrow><mml:msup><mml:mrow><mml:mi>Γ</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> by using a local move.</p></list-item><list-item><p>   2.2 Update the <italic>k</italic>th row of <inline-formula><mml:math id="MM64"><mml:mrow><mml:msup><mml:mrow><mml:mi>Γ</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi>Γ</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>C</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> by using a global move.</p></list-item><list-item><p>   2.3 Update <inline-formula><mml:math id="MM65"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>ω</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>ω</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>C</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula>.</p></list-item></list></p></list-item><list-item><p> Update <inline-formula><mml:math id="MM66"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>ρ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>ρ</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>ρ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>C</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>ρ</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>C</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula>.</p></list-item><list-item><p> Update the global shrinkage parameter <italic>g.</italic></p></list-item></list></p></boxed-text></p>
    </sec>
    <sec>
      <title>3.4 Post-processing</title>
      <sec>
        <title>3.4.1 Declaration of associations and hotspots</title>
        <p>The posterior distribution of any function of any subset of model parameters can be calculated straightforwardly in the MCMC estimation of the model. Since the model includes explicit variable selection parameters (<italic>γ<sub>kj</sub></italic>), we focus on functions of those parameters in order to summarize the evidence of association between predictors and responses.</p>
        <p>Pairwise association between response <italic>k</italic> and predictor <italic>j</italic> is thus quantified by the marginal posterior probability of inclusion (MPPI)
<disp-formula><mml:math id="MM67"><mml:mrow><mml:msub><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mtext>P</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>γ</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mi>q</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>X</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula>
</p>
        <p>This quantity summarizes the evidence brought by all the data regarding whether the predictor <italic>x<sub>j</sub></italic> is associated with the <inline-formula><mml:math id="MM68"><mml:mrow><mml:mi>n</mml:mi><mml:mo>×</mml:mo><mml:mi>r</mml:mi></mml:mrow></mml:math></inline-formula> response <italic>Y<sub>k</sub>.</italic> It is straightforwardly estimated by the average number of times <inline-formula><mml:math id="MM69"><mml:mrow><mml:msub><mml:mrow><mml:mi>γ</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> during the MCMC run. In order to obtain a list of associations of interest, we need a decision rule. The simplest choice is to threshold on the MPPI: declare an association if <italic>π<sub>kj</sub></italic> is greater than some threshold value <italic>c.</italic> The threshold is set according to the user’s required balance between false positives and false negatives. An alternative approach is to calculate the so-called Bayesian FDR (<xref rid="btv568-B5" ref-type="bibr">Broët <italic>et</italic>
<italic>al.</italic>, 2004</xref>; <xref rid="btv568-B23" ref-type="bibr">Muller <italic>et</italic>
<italic>al.</italic>, 2006</xref>). For a given threshold <italic>c</italic>, this is defined as
<disp-formula><mml:math id="MM70"><mml:mrow><mml:mi>b</mml:mi><mml:mi>F</mml:mi><mml:mi>D</mml:mi><mml:mi>R</mml:mi><mml:mo>≡</mml:mo><mml:mfrac><mml:mrow><mml:mrow><mml:mstyle displaystyle="false"><mml:msub><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mi>I</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo>&gt;</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mstyle></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:mstyle displaystyle="false"><mml:msub><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mi>I</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo>&gt;</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mstyle><mml:mo>.</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mrow></mml:math></disp-formula>
Users can either calculate the <italic>bFDR</italic> for a given threshold on the <italic>π<sub>kj</sub></italic>, or can set a required level of <italic>bFDR</italic> and use that to find a threshold on the <italic>π<sub>kj</sub>.</italic> Either way, the declared pairwise associations are those with the largest values of <italic>π<sub>kj</sub>.</italic></p>
        <p>In the <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btv568/-/DC1">Supplementary Material, Section S.3</ext-link>, we give the true FDR values for our simulation datasets for the decision rule defined by setting a threshold on <italic>bFDR.</italic> We find that on average the method is conservative, i.e. the <italic>bFDR</italic> overestimates the true FDR value in line with the strong shrinkage of the <italic>π<sub>kj</sub></italic> resulting from our sparsity assumptions. Thus, reported hotspots using <italic>bFDR</italic> cut-offs carry a higher level of support than their nominal level.</p>
        <p>For the results in this article, we use the <italic>π<sub>kj</sub></italic> to declare hotspots as well as pairwise associations. We use a target value of the <italic>bFDR</italic> to find a threshold on the <italic>π<sub>kj</sub></italic> to declare pairwise associations, and subsequently count the number of associations for each predictor. Other options would be to consider directly the number of associations <inline-formula><mml:math id="MM71"><mml:mrow><mml:mstyle displaystyle="false"><mml:munder><mml:mo>∑</mml:mo><mml:mi>k</mml:mi></mml:munder><mml:mrow><mml:msub><mml:mrow><mml:mi>γ</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:mrow></mml:math></inline-formula> for predictor <italic>j</italic>, and use the posterior mean or posterior probability of reaching a given level to declare hotspots.</p>
        <p>Focussing on a particular response <italic>k</italic>, it can also be of interest to look at the whole set of predictors found to be associated with that response. For this we consider the whole vector <italic>γ<sub>k</sub>.</italic> We calculate a ‘re-normalized’ estimate of posterior model probabilities for each response, see <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btv568/-/DC1">Supplementary Material, Section S.2</ext-link>, for details.</p>
      </sec>
      <sec>
        <title>3.4.2. Model adequacy</title>
        <p>In this section, we describe the Bayesian implementation of leave-one-out prediction error and model adequacy (<xref rid="btv568-B11" ref-type="bibr">Gelfand <italic>et</italic>
<italic>al.</italic>, 1992</xref>). For ease of notation, in the following we bypass the subscript <inline-formula><mml:math id="MM72"><mml:mi>ℓ</mml:mi></mml:math></inline-formula> that indicates the condition/tissue under investigation. Let <inline-formula><mml:math id="MM73"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>γ</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>B</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mo>{</mml:mo><mml:msubsup><mml:mrow><mml:mi>γ</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>B</mml:mi></mml:mrow></mml:msubsup><mml:mo>:</mml:mo><mml:mi>B</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mrow><mml:mi>max</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mrow><mml:mi>γ</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:msubsup><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>X</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula> be the vector of the best model visited during the MCMC for response <italic>k.</italic> For each response <italic>k</italic>, given the best model visited <inline-formula><mml:math id="MM74"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>γ</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>B</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> and after integrating out the parameter <italic>g</italic> numerically, we generate observations <inline-formula><mml:math id="MM75"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mi>f</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> from the predictive density <inline-formula><mml:math id="MM76"><mml:mrow><mml:mi>f</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mi>f</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>γ</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>B</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, where <inline-formula><mml:math id="MM77"><mml:mrow><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> denote the <inline-formula><mml:math id="MM78"><mml:mrow><mml:mi>n</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo> </mml:mo></mml:mrow></mml:math></inline-formula> data vector with <italic>y<sub>ik</sub></italic> deleted. Under model adequacy, <italic>y<sub>ik</sub></italic> is then checked against <inline-formula><mml:math id="MM79"><mml:mrow><mml:mi>f</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mi>f</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>γ</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>B</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>. Since, if the model holds, <italic>Y<sub>ik</sub></italic> is a random realization of <inline-formula><mml:math id="MM80"><mml:mrow><mml:mi>f</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mi>f</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>γ</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>B</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, we use
<disp-formula id="btv568-M2"><label>(2)</label><mml:math id="MM81"><mml:mrow><mml:mi>g</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mi>f</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mover accent="true"><mml:mtext>E</mml:mtext><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mi>f</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>γ</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>B</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:msqrt><mml:mrow><mml:mover accent="true"><mml:mtext>Var</mml:mtext><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mi>f</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>γ</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>B</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msqrt></mml:mrow></mml:mrow></mml:mfrac></mml:mrow></mml:math></disp-formula>
as checking function where <inline-formula><mml:math id="MM82"><mml:mrow><mml:mover accent="true"><mml:mtext>E</mml:mtext><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mi>f</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>γ</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>B</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="MM83"><mml:mrow><mml:mover accent="true"><mml:mtext>Var</mml:mtext><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mi>f</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>γ</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>B</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> are the empirical mean and variance calculated from the MCMC iterations. For each response, squared prediction error is summed over the sample and the quantity <inline-formula><mml:math id="MM84"><mml:mrow><mml:mstyle displaystyle="false"><mml:munder><mml:mo>∑</mml:mo><mml:mi>i</mml:mi></mml:munder><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>g</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mi>f</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:mrow></mml:math></inline-formula> is then used as a measure of model adequacy with large values indicating that the model performs poorly. This quantity resembles the widely adopted mean-square error with the notably modification that now the differences between the predicted and observed values are standardized.</p>
      </sec>
    </sec>
    <sec>
      <title>3.5 Simulation study</title>
      <p>In order to investigate the performance of our multi-tissue method, we construct an artificial dataset with three tissues and 150 responses. As in <xref rid="btv568-B3" ref-type="bibr">Bottolo <italic>et</italic>
<italic>al.</italic> (2011)</xref>, we use the whole genome data of rat Recombinant Inbred (RI) strains derived from a cross between the Spontaneously Hypertensive Rat (SHR) and the Brown Norway (BN) strains, which we have used previously to identify eQTLs across multiple tissues (<xref rid="btv568-B13" ref-type="bibr">Heinig <italic>et al.</italic>, 2010</xref>; <xref rid="btv568-B14" ref-type="bibr">Hubner <italic>et</italic>
<italic>al.</italic>, 2005</xref>; <xref rid="btv568-B25" ref-type="bibr">Petretto <italic>et</italic>
<italic>al.</italic>, 2006</xref>). This choice allows us to test the performance of our algorithm and compare it with alternatives methods when complex patterns of correlation between markers depends on genetic forces that shape the structure of LD. After removing redundant variables, the genome-wide number of SNPs is reduced to 1304, giving a <inline-formula><mml:math id="MM85"><mml:mrow><mml:mn>29</mml:mn><mml:mo>×</mml:mo><mml:mn>1304</mml:mn></mml:mrow></mml:math></inline-formula>
<italic>X</italic> matrix.</p>
      <p>Conditionally on the SNP matrix <italic>X</italic>, we generate responses for each tissue from a linear model. For each tissue <inline-formula><mml:math id="MM86"><mml:mrow><mml:mi>ℓ</mml:mi><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mn>1</mml:mn><mml:mo>≤</mml:mo><mml:mi>ℓ</mml:mi><mml:mo>≤</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:math></inline-formula>, the <italic>n</italic> × <italic>q</italic> matrix <inline-formula><mml:math id="MM87"><mml:mrow><mml:msub><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mi>ℓ</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> gathering the observations of the 150 responses is given by the regression
<disp-formula><mml:math id="MM88"><mml:mrow><mml:msub><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mi>ℓ</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>X</mml:mi><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi>ℓ</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mi>ℓ</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mtext>shared</mml:mtext></mml:mrow></mml:mrow></mml:msup><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>
where <inline-formula><mml:math id="MM89"><mml:mrow><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi>ℓ</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> is the <italic>p</italic> × <italic>q</italic> matrix of regression coefficients, <inline-formula><mml:math id="MM90"><mml:mrow><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mi>ℓ</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> is the <italic>n</italic> × <italic>q</italic> matrix of residuals for tissue <inline-formula><mml:math id="MM91"><mml:mi>ℓ</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="MM92"><mml:mrow><mml:msup><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mtext>shared</mml:mtext></mml:mrow></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> is a <italic>n</italic> × <italic>q</italic> matrix of residuals shared by all tissues. The residuals are given by <inline-formula><mml:math id="MM93"><mml:mrow><mml:msub><mml:mrow><mml:mo>ϵ</mml:mo></mml:mrow><mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>k</mml:mi><mml:mi>ℓ</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo>∼</mml:mo><mml:mi>N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>ℓ</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="MM94"><mml:mrow><mml:msubsup><mml:mrow><mml:mo>ϵ</mml:mo></mml:mrow><mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:mtext>shared</mml:mtext></mml:mrow></mml:mrow></mml:msubsup><mml:mo>∼</mml:mo><mml:mi>N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mtext>shared</mml:mtext></mml:mrow></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>.</p>
      <p>The matrix <inline-formula><mml:math id="MM95"><mml:mrow><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi>ℓ</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> controls the pattern and strength of signal between each responses and predictors in tissue <inline-formula><mml:math id="MM96"><mml:mi>ℓ</mml:mi></mml:math></inline-formula>. For the simulations we keep <inline-formula><mml:math id="MM97"><mml:mrow><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi>ℓ</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> constant across tissues (<inline-formula><mml:math id="MM98"><mml:mrow><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mi>j</mml:mi><mml:mi>ℓ</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo>×</mml:mo><mml:msub><mml:mrow><mml:mi>γ</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>) and control the signal-to-noise patterns through the noise variance parameters. The pattern of non-zero associations between responses and predictors is encoded by the matrix Γ of 0 s and 1 s. Because, our method is aimed at detecting a signal that is present in different conditions, we use the same association pattern Γ in all conditions. This configuration can be seen in <xref ref-type="fig" rid="btv568-F1">Figure 1</xref> where six hotspots (vertical bars) with a varying number of associations per hotspot are simulated. The exact specification is given in the <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btv568/-/DC1">Supplementary Material, Section S.1.1</ext-link>. The signal strength is parameterized by <italic>μ</italic>, with <inline-formula><mml:math id="MM99"><mml:mrow><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo>∼</mml:mo><mml:mi>N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>μ</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mn>0.001</mml:mn></mml:mrow></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>.
<fig id="btv568-F1" orientation="portrait" position="float"><label>Fig. 1.</label><caption><p>Matrix Γ for the pattern of associations common to the three tissues. The entry (<italic>k</italic>, <italic>j</italic>) of the matrix Γ indicates the presence of an association between SNP <italic>j</italic> and response <italic>k</italic> in all tissues. (<bold>a</bold>) Main simulation study. (<bold>b</bold>) Study for distinguishing <italic>cis</italic>- and <italic>trans</italic>-associations</p></caption><graphic xlink:href="btv568f1p"/></fig>
</p>
      <p>The signal-to-noise ratio in each tissue is tuned thorough the tissue-specific noise standard deviation <inline-formula><mml:math id="MM100"><mml:mrow><mml:msub><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>ℓ</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> and the ‘shared’ noise standard deviation <inline-formula><mml:math id="MM101"><mml:mrow><mml:msub><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mtext>shared</mml:mtext></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>. Assuming without loss of generality independence of the noise variances, the total noise standard deviation for tissue <inline-formula><mml:math id="MM102"><mml:mi>ℓ</mml:mi></mml:math></inline-formula> is given by <inline-formula><mml:math id="MM103"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>ℓ</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mtext>total</mml:mtext></mml:mrow></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msqrt><mml:mrow><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>ℓ</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mtext>shared</mml:mtext></mml:mrow></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:msqrt></mml:mrow></mml:math></inline-formula>. The correlation between tissues is proportional to the ‘shared’ noise variance and also depends on the noise variances of the two tissues considered (see <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btv568/-/DC1">Supplementary Material, Section S.1.2</ext-link>).</p>
      <p>We have conducted an extensive investigation into the effect of the signal-to-noise ratio imbalance across tissues and here we show the output of the simulations for independent residuals (<inline-formula><mml:math id="MM104"><mml:mrow><mml:msub><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mtext>shared</mml:mtext></mml:mrow></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>) and correlated residuals (<inline-formula><mml:math id="MM105"><mml:mrow><mml:msub><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mtext>shared</mml:mtext></mml:mrow></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0.04</mml:mn></mml:mrow></mml:math></inline-formula>). In each case, we consider a balanced case with <inline-formula><mml:math id="MM106"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>ℓ</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mtext>total</mml:mtext></mml:mrow></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mn>0.1</mml:mn><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mn>1</mml:mn><mml:mo>≤</mml:mo><mml:mi>ℓ</mml:mi><mml:mo>≤</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:math></inline-formula>, and an unbalanced case with <inline-formula><mml:math id="MM107"><mml:mrow><mml:mo>{</mml:mo><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mrow><mml:mtext>total</mml:mtext></mml:mrow></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mn>0.1</mml:mn><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mrow><mml:mtext>total</mml:mtext></mml:mrow></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mn>0.2</mml:mn><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow><mml:mrow><mml:mrow><mml:mtext>total</mml:mtext></mml:mrow></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mn>0.4</mml:mn><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula>. We also ran the simulations with several levels of the signal strength <italic>μ.</italic> For the plots presented here we chose <inline-formula><mml:math id="MM108"><mml:mrow><mml:mi>μ</mml:mi><mml:mo>=</mml:mo><mml:mn>0.15</mml:mn></mml:mrow></mml:math></inline-formula>.</p>
      <p>For each simulation set-up we generated nine replicates, and for each of the datasets simulated, we ran MT-HESS analysing the three tissues jointly and a MANOVA test (<xref rid="btv568-B24" ref-type="bibr">Nath and Pavur, 1985</xref>) for each multiple tissue response–SNP pair separately. We also include the receiver operating characteristic (ROC) curves intersecting the results from the single-tissue version of HESS run on each separate tissue (following <xref rid="btv568-B8" ref-type="bibr">Fairfax <italic>et</italic>
<italic>al</italic><italic>.</italic>, 2012</xref>). We call these analyses iST-HESS, intersection of single tissue HESS, to distinguish it from MT-HESS, multi-tissue HESS. Associations were declared by thresholding MPPI values for MT-HESS and ST-HESS and <italic>P</italic>-values for MANOVA. For the intersection iST-HESS, associations are declared positive for a given threshold if the single-tissue MPPIs exceed the threshold in all three tissues.</p>
      <p><xref ref-type="fig" rid="btv568-F2">Figure 2</xref> shows ROC curves for each of the four combination of balanced/unbalanced noise across tissues and independent/correlated residuals between tissues. We see that MT-HESS clearly outperforms MANOVA in all scenarios, which confirms what has already been shown in the literature, that is penalization methods outperform ‘one-at-a-time’ methods (<xref rid="btv568-B4" ref-type="bibr">Bottolo <italic>et</italic>
<italic>al.</italic>, 2013</xref>), and that borrowing information across responses improves even further the performance (<xref rid="btv568-B28" ref-type="bibr">Richardson <italic>et</italic>
<italic>al.</italic>, 2010</xref>; <xref rid="btv568-B31" ref-type="bibr">Scott-Boyer <italic>et</italic>
<italic>al.</italic>, 2012</xref>).
<fig id="btv568-F2" orientation="portrait" position="float"><label>Fig. 2.</label><caption><p>ROC curves comparing results of MT-HESS, MANOVA and iST-HESS. Top row plots have balanced across tissues total noise standard deviation <inline-formula><mml:math id="MM109"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>ℓ</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mtext>total</mml:mtext></mml:mrow></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mn>0.1</mml:mn><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mn>1</mml:mn><mml:mo>≤</mml:mo><mml:mi>ℓ</mml:mi><mml:mo>≤</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:math></inline-formula>, bottom row are unbalanced with total noise standard deviation <inline-formula><mml:math id="MM110"><mml:mrow><mml:mo>{</mml:mo><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mrow><mml:mtext>total</mml:mtext></mml:mrow></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mn>0.1</mml:mn><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mrow><mml:mtext>total</mml:mtext></mml:mrow></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mn>0.2</mml:mn><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow><mml:mrow><mml:mrow><mml:mtext>total</mml:mtext></mml:mrow></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mn>0.4</mml:mn><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula>. Left hand column plots have uncorrelated residuals between tissues with <inline-formula><mml:math id="MM111"><mml:mrow><mml:msub><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mtext>shared</mml:mtext></mml:mrow></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>, right hand column have <inline-formula><mml:math id="MM112"><mml:mrow><mml:msub><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mtext>shared</mml:mtext></mml:mrow></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0.04</mml:mn></mml:mrow></mml:math></inline-formula></p></caption><graphic xlink:href="btv568f2p"/></fig>
</p>
      <p>Comparison between MT-HESS versus iST-HESS also confirms previous results (<xref rid="btv568-B25" ref-type="bibr">Petretto <italic>et</italic>
<italic>al.</italic>, 2006</xref>, <xref rid="btv568-B26" ref-type="bibr">2010</xref>) that the intersection of tissue-specific findings is likely to be a conservative approach and is potentially affected by variability between tissues. Specifically in the unbalanced case, MT-HESS strongly outperforms the intersection of separate single-tissue results. This is still evident, although less pronounced, in the balanced case with independent noise. As expected, correlated noise lower slightly the ROC curves for the multi-tissue methods (MT-HESS and MANOVA) since it encourages propagation of false positives across all the tissues. Obviously, this does not affect iST-HESS. Note that the balanced cases have higher signal-to-noise ratio than the unbalanced ones, and so ROC curves for all methods are higher.</p>
      <p><ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btv568/-/DC1">Supplementary Material, Section S.1</ext-link>, shows a greater range of simulation set-ups and detailed findings for all the methods compared here, i.e. MT-HESS, MANOVA and iST-HESS. In particular, we provide further results obtained by specifying different levels of the signal strength <italic>μ.</italic> We illustrate how MT-HESS achieves a better separation between noise and signal and how it allows to identify more hotspots than traditional methods.</p>
      <p>We now investigate the ability of the model to detect different types of association patterns. Since the model is designed to borrow information across responses, it is of interest to see whether the model can also detect predictors associated with a single response, for instance, if we can still detect <italic>cis</italic>-eQTLs. To look at this, we use a different pattern of associations, with six markers designated as hotspots (two each with 10, 20 and 30 responses associated) and 10 <italic>cis</italic> markers. Half the <italic>cis</italic>-associations are completely isolated, for the other half the response is also associated with other (<italic>trans</italic>) markers. The pattern is shown in <xref ref-type="fig" rid="btv568-F1">Figure 1</xref>b. We allow the <italic>cis</italic>-associations to be stronger than those in the hotspots, as <italic>trans</italic>-associations are expected to be weaker, thus we now have two parameters for signal strength <inline-formula><mml:math id="MM113"><mml:mrow><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mtext>cis</mml:mtext></mml:mrow></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0.6</mml:mn></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="MM114"><mml:mrow><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mtext>trans</mml:mtext></mml:mrow></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0.15</mml:mn></mml:mrow></mml:math></inline-formula> with independent residuals (<inline-formula><mml:math id="MM115"><mml:mrow><mml:msub><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mtext>shared</mml:mtext></mml:mrow></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>) and balanced total noise standard deviation <inline-formula><mml:math id="MM116"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>ℓ</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mtext>total</mml:mtext></mml:mrow></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mn>0.1</mml:mn><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mn>1</mml:mn><mml:mo>≤</mml:mo><mml:mi>ℓ</mml:mi><mml:mo>≤</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:math></inline-formula>. ROC curves for these associations are very similar to the case shown in <xref ref-type="fig" rid="btv568-F2">Figure 2</xref>a (data not shown). The overall performance for all methods considered here is slightly lower for the new <italic>cis</italic>- and <italic>trans</italic>-association pattern, due to the lower proportion of associations contained in hotspots.</p>
      <p>To compare in detail <italic>cis</italic>- and <italic>trans</italic>-results, we classify the response–predictor pairs as ‘true negative’, ‘true <italic>cis</italic> isolated’, ‘true <italic>cis</italic> other’ and ‘true <italic>trans</italic>’ (part of hotspot). <xref ref-type="table" rid="btv568-T1">Table 1</xref> shows the cross-classification of ‘true’ and ‘called’ status for the three approaches considered here. Thresholds for calling pairwise associations were determined by fixing the true FDR level at 10%. We see that while both MT-HESS and iST-HESS are able to detect the <italic>cis</italic>-associations very well, the multiple tissue model is able to pick up more of the associations that are contained in hotspots, thus showing the benefit of combining the tissues in a fully Bayesian way. The MANOVA misses all hotspot associations in this example. Looking directly at the hotspots, <xref ref-type="table" rid="btv568-T2">Table 2</xref> shows the average estimated size of each true hotspot (defined as number of responses called marginally): it is clear that MT-HESS has more power to detect hotspots than iST-HESS.
<table-wrap id="btv568-T1" orientation="portrait" position="float"><label>Table 1.</label><caption><p>Classification table for marginal pairwise associations at a true FDR level of 10%</p></caption><table frame="hsides" rules="groups"><thead align="left"><tr><th rowspan="1" colspan="1"/><th rowspan="1" colspan="1">True negative</th><th rowspan="1" colspan="1">True <italic>cis</italic> isolated</th><th rowspan="1" colspan="1">True <italic>cis</italic> other</th><th rowspan="1" colspan="1">True <italic>trans</italic></th></tr></thead><tbody align="left"><tr><td colspan="5" rowspan="1">MT-HESS</td></tr><tr><td rowspan="1" colspan="1"> Negative call</td><td align="char" char="." rowspan="1" colspan="1">195 458.2</td><td align="char" char="." rowspan="1" colspan="1">0.0</td><td align="char" char="." rowspan="1" colspan="1">0.0</td><td align="char" char="." rowspan="1" colspan="1">28.2</td></tr><tr><td rowspan="1" colspan="1"> Positive call</td><td align="char" char="." rowspan="1" colspan="1">11.8</td><td align="char" char="." rowspan="1" colspan="1">5.0</td><td align="char" char="." rowspan="1" colspan="1">5.0</td><td align="char" char="." rowspan="1" colspan="1">91.8</td></tr><tr><td colspan="5" rowspan="1">MANOVA</td></tr><tr><td rowspan="1" colspan="1"> Negative call</td><td align="char" char="." rowspan="1" colspan="1">195 469.0</td><td align="char" char="." rowspan="1" colspan="1">0.6</td><td align="char" char="." rowspan="1" colspan="1">4.4</td><td align="char" char="." rowspan="1" colspan="1">120.0</td></tr><tr><td rowspan="1" colspan="1"> Positive call</td><td align="char" char="." rowspan="1" colspan="1">1.0</td><td align="char" char="." rowspan="1" colspan="1">4.4</td><td align="char" char="." rowspan="1" colspan="1">0.6</td><td align="char" char="." rowspan="1" colspan="1">0.0</td></tr><tr><td colspan="5" rowspan="1">iST-HESS</td></tr><tr><td rowspan="1" colspan="1"> Negative call</td><td align="char" char="." rowspan="1" colspan="1">195 462.3</td><td align="char" char="." rowspan="1" colspan="1">0.0</td><td align="char" char="." rowspan="1" colspan="1">0.0</td><td align="char" char="." rowspan="1" colspan="1">63.2</td></tr><tr><td rowspan="1" colspan="1"> Positive call</td><td align="char" char="." rowspan="1" colspan="1">7.7</td><td align="char" char="." rowspan="1" colspan="1">5.0</td><td align="char" char="." rowspan="1" colspan="1">5.0</td><td align="char" char="." rowspan="1" colspan="1">56.8</td></tr></tbody></table><table-wrap-foot><fn id="btv568-TF1"><p>True positives are split into ‘true <italic>cis</italic> isolated’, ‘true <italic>cis</italic> other’ and ‘true <italic>trans</italic>’ associations. Numbers are averages over nine replications</p></fn></table-wrap-foot></table-wrap>
<table-wrap id="btv568-T2" orientation="portrait" position="float"><label>Table 2.</label><caption><p>Average size of hotspots declared at a true FDR level of 10% on pairwise associations of 10%</p></caption><table frame="hsides" rules="groups"><thead align="left"><tr><th rowspan="1" colspan="1">True size</th><th rowspan="1" colspan="1">10</th><th rowspan="1" colspan="1">20</th><th rowspan="1" colspan="1">30</th></tr></thead><tbody align="left"><tr><td rowspan="1" colspan="1">MT-HESS</td><td align="char" char="." rowspan="1" colspan="1">5.8</td><td align="char" char="." rowspan="1" colspan="1">17.3</td><td align="char" char="." rowspan="1" colspan="1">24.3</td></tr><tr><td rowspan="1" colspan="1">MANOVA</td><td align="char" char="." rowspan="1" colspan="1">0.0</td><td align="char" char="." rowspan="1" colspan="1">0.0</td><td align="char" char="." rowspan="1" colspan="1">0.0</td></tr><tr><td rowspan="1" colspan="1">iST-HESS</td><td align="char" char="." rowspan="1" colspan="1">1.4</td><td align="char" char="." rowspan="1" colspan="1">10.7</td><td align="char" char="." rowspan="1" colspan="1">16.3</td></tr></tbody></table><table-wrap-foot><fn id="btv568-TF2"><p>Numbers are averages over nine replications</p></fn></table-wrap-foot></table-wrap>
</p>
    </sec>
  </sec>
  <sec>
    <title>4 Results</title>
    <sec>
      <title>4.1 Rat data</title>
      <p>The rat dataset consists of multiple tissue expression and genome-wide genotype data (∼1400 SNPs) in a panel of 29 RI rat strains (<xref rid="btv568-B25" ref-type="bibr">Petretto <italic>et</italic>
<italic>al.</italic>, 2006</xref>). Here, we focus on the multi-tissue eQTL mapping of a previously reported Interferon regulatory factor 7 <italic>IRF7</italic>-driven inflammatory network (IDIN) found to be associated with immune response and increased risk of type 1 diabetes in humans (<xref rid="btv568-B13" ref-type="bibr">Heinig <italic>et</italic>
<italic>al.</italic>, 2010</xref>).</p>
      <p>We used HESS to re-analyse a sub-set of the IDIN network in three rat tissues (left ventricle, aorta and liver) focusing on 146 probe sets (corresponding to 143 protein coding genes), which are both robustly expressed and varying in expression across the three tissues. See <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btv568/-/DC1">Supplementary Material, Section S.5</ext-link>, for details of how these genes were chosen. We ran ST-HESS separately in each tissue and MT-HESS simultaneously across the three tissues, as well as a MANOVA (<xref rid="btv568-B24" ref-type="bibr">Nath and Pavur, 1985</xref>) analysis.</p>
      <p>We ran HESS on a 2.90-GHz Intel(R) Xeon(R) CPU computer with 130 GB of memory for 15 000 sweeps of which 5000 as burn-in and the same hyper-parameters as in the simulation studies. Computational time was 70 and 114 min for ST-HESS (average across tissues) and MT-HESS, respectively. Visual inspection of the trace of the parameters <italic>w<sub>k</sub></italic> and <italic>ρ<sub>j</sub></italic> and <italic>g</italic> show no erratic behaviour. Convergence is reached after few iterations due to the combined effect of the automatic tuning of the proposal density in the Metropolis–Hastings algorithms and the parallel chains implementation which allow good mixing. Focusing on probe set-marker associations significant when using a Bayes FDR (bFDR) of 5% (which corresponds to a MPPI &gt; 0.8), MT-HSSS identified three loci controlling more than 30% of the probe sets under analysis (<xref ref-type="fig" rid="btv568-F3">Fig. 3</xref>). In addition to the regulatory hotspot in rat chromosome 15q25, which was previously identified and experimentally validated (<xref rid="btv568-B13" ref-type="bibr">Heinig <italic>et</italic>
<italic>al.</italic>, 2010</xref>), joint analysis of the three tissues revealed two new regulatory hotspots for the IDIN, located at marker J343641 on rat chromosome 10, and at marker SHRSPc66a05_r1_451 on rat chromosome 1, respectively. We also investigated the associations of IDIN network in each single tissue. ST-HESS analysis uncovered a signal for the rat chromosome 15q25 locus in left ventricle tissue, as previously shown (<xref rid="btv568-B13" ref-type="bibr">Heinig <italic>et</italic>
<italic>al.</italic>, 2010</xref>), but failed to identify the new regulatory loci in chromosome 10 and 1, see <xref ref-type="fig" rid="btv568-F3">Figure 3</xref>. In view of the variability of ST-HESS between the three tissues shown in <xref ref-type="fig" rid="btv568-F3">Figure 3</xref>, we did not consider iST-HESS further as it lacks power in unbalanced cases.
<fig id="btv568-F3" orientation="portrait" position="float"><label>Fig. 3.</label><caption><p>Genome-wide Manhattan-like plots for the rat analysis showing the number of probe sets in the IDIN network associated with each SNP according to genomic location. The <italic>x</italic>-axis depicts chromosome number and position. The <italic>y</italic>-axis shows the number of probe sets significantly associated with each SNP (bFDR <inline-formula><mml:math id="MM117"><mml:mo>≤</mml:mo></mml:math></inline-formula>0.05). From top to bottom: results for MT-HESS, and for ST-HESS in aorta, left ventricle and liver</p></caption><graphic xlink:href="btv568f3p"/></fig>
</p>
      <p>Note that with the same 5% FDR threshold on <italic>P</italic>-values for declaring associations, the MANOVA analysis does not return any SNPs associated with five or more genes. In order to see if a MANOVA analysis shows some of the evidence for the hotspots discovered by MT-HESS, we also computed for each locus the sum over all transcripts of the negative log <italic>P</italic>-values for the MANOVA test (<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btv568/-/DC1">Supplementary Figure S16</ext-link>). This plot is very noisy, but it is clear that the <italic>P</italic>-values contain evidence for the hotspots on chromosomes 10 and 15.</p>
      <p>Given the different output produced by MT-HESS and ST-HESS, we have also investigated their model adequacy (<xref rid="btv568-B11" ref-type="bibr">Gelfand <italic>et</italic>
<italic>al.</italic>, 1992</xref>). We compared the two models on the basis of their leave-one-out prediction accuracy by removing one observation at a time and using the remaining observation for calculating the prediction error. Following <xref rid="btv568-B11" ref-type="bibr">Gelfand <italic>et</italic>
<italic>al.</italic> (1992)</xref> we took a fully Bayesian perspective employing predictive distributions to evaluate model performance by comparing model prediction with what has been observed. To be precise, we use standardized prediction error as checking function, as shown in <xref ref-type="disp-formula" rid="btv568-M2">Equation (2)</xref>, with squared prediction error summed over the sample as model adequacy.</p>
      <p><xref ref-type="table" rid="btv568-T3">Table 3</xref> shows the value of model adequacy averaged across probe sets. The best (shared across tissues) models <inline-formula><mml:math id="MM118"><mml:mrow><mml:mo>{</mml:mo><mml:msubsup><mml:mrow><mml:mi>γ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>B</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>γ</mml:mi></mml:mrow><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:mi>B</mml:mi></mml:mrow></mml:msubsup><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula> obtained by MT-HESS have on overage smaller prediction error than the best models identified by ST-HESS in each tissue separately. In particular MT-HESS is able to predict better than ST-HESS in aorta and liver tissues where ST-HESS was unable to identify any hostpost. In the left ventricle tissue, the additional two hotspots detected by MT-HESS permit a more accurate prediction than the single ST-HESS hotspot. Altogether, the vast majority of probe sets are better predicted by MT-HESS: among the 32 (22%) probe sets better predicted by ST-HESS only two were declared associated at 5% bFDR with the hotspots found by MT-HESS, showing that almost all probe sets (51/53) controlled by MT-HESS multiple hotspots are better predicted than by single-tissue analysis. Overall, we conclude that the model that comprises the experimentally validated and previously undiscovered putative hotspots is a more adequate model to explain the joint variation of the transcripts across tissues.
<table-wrap id="btv568-T3" orientation="portrait" position="float"><label>Table 3.</label><caption><p>Leave-one-out prediction error of MT-HESS and ST-HESS conditionally on their best models visited</p></caption><table frame="hsides" rules="groups"><thead align="left"><tr><th rowspan="1" colspan="1"/><th rowspan="1" colspan="1">MT-HESS</th><th rowspan="1" colspan="1">ST-HESS</th><th rowspan="1" colspan="1">MT-HESS &lt; ST-HESS</th></tr></thead><tbody align="left"><tr><td rowspan="1" colspan="1">Aorta</td><td align="char" char="." rowspan="1" colspan="1">22.85 (3.18)</td><td align="char" char="." rowspan="1" colspan="1">33.06 (4.49)</td><td align="char" char="." rowspan="1" colspan="1">143 (98%)</td></tr><tr><td rowspan="1" colspan="1">Left ventricle</td><td align="char" char="." rowspan="1" colspan="1">35.22 (20.31)</td><td align="char" char="." rowspan="1" colspan="1">40.86 (15.80)</td><td align="char" char="." rowspan="1" colspan="1">114 (78%)</td></tr><tr><td rowspan="1" colspan="1">Liver</td><td align="char" char="." rowspan="1" colspan="1">23.97 (4.34)</td><td align="char" char="." rowspan="1" colspan="1">36.88 (5.67)</td><td align="char" char="." rowspan="1" colspan="1">143 (98%)</td></tr></tbody></table><table-wrap-foot><fn id="btv568-TF3"><p>For each tissue, average model adequacy measure across probe sets is reported with standard deviation in brackets. Out of 146 transcripts analysed in the IDIN network, the number of times ST-HESS model adequacy measure is greater than the MT-HESS one is reported in the last column with % in brackets</p></fn></table-wrap-foot></table-wrap>
</p>
      <p>We comment in more details on the regulatory hotspot located in rat chromosome 10 (rat marker J343641), which showed association with 53 probe sets (MPPI &gt; 0.8), representing 53 protein coding distinct genes. Enrichment analysis of transcription factor binding sites (TFBSs) in the putative promoter of the corresponding human orthologous genes using PASTAA (<xref rid="btv568-B30" ref-type="bibr">Roider <italic>et</italic>
<italic>al.</italic>, 2009</xref>) revealed over-representation of TFBS motifs for <italic>IRF7</italic> (adjusted <italic>P</italic>
<inline-formula><mml:math id="MM119"><mml:mrow><mml:mo>=</mml:mo><mml:mn>3.75</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>), <italic>IRF2</italic> (adjusted <italic>P</italic>
<inline-formula><mml:math id="MM120"><mml:mrow><mml:mo>=</mml:mo><mml:mn>2.60</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>) and <italic>NFKB</italic> (adjusted <italic>P</italic>
<inline-formula><mml:math id="MM121"><mml:mrow><mml:mo>=</mml:mo><mml:mn>3.19</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>) and <italic>IRF1</italic> or <italic>IRF10</italic> (adjusted <italic>P</italic>
<inline-formula><mml:math id="MM122"><mml:mrow><mml:mo>=</mml:mo><mml:mn>3.20</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>), in keeping with the known IRF-driven regulation of IDIN network genes (<xref rid="btv568-B13" ref-type="bibr">Heinig <italic>et</italic>
<italic>al.</italic>, 2010</xref>).</p>
      <p>Examination of the genes in the LD block around the regulatory locus on rat chromosome 10 (<inline-formula><mml:math id="MM123"><mml:mrow><mml:msup><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>&gt;</mml:mo><mml:mn>0.8</mml:mn></mml:mrow></mml:math></inline-formula>), revealed only one annotated protein coding gene, <italic>Foxk2</italic>, with deletion of an exon and an intron in the Spontaneous Hypertensive Rat compared with the BN rat (<xref rid="btv568-B1" ref-type="bibr">Atanur <italic>et</italic>
<italic>al.</italic>, 2010</xref>). <italic>Foxk2</italic> encodes the transcription factor forkhead box protein K2. The human orthologue <italic>FOXK2</italic> gene is an inhibitor of the Sendai virus-induced IFN-<italic>β</italic> production and, at the protein level, it forms complexes with two known interferon transcriptional repressors, <italic>IRF2</italic> (one of the transcription factors whose binding motifs were enriched as described above) and <italic>IRF4</italic> (<xref rid="btv568-B17" ref-type="bibr">Li <italic>et</italic>
<italic>al.</italic>, 2011a</xref>). In view of this, we propose <italic>Foxk2</italic> as a candidate master regulator of the subset of the IDIN network genes whose expression is associated with the regulatory loci located in rat chromosome 10.</p>
    </sec>
    <sec>
      <title>4.2 Human data</title>
      <p>The human dataset comprised genotype and corresponding expression data from three purified leukocyte subsets (monocytes, and CD4 and CD8 T cells) isolated from the peripheral blood of 59 patients with inflammatory bowel disease (see <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btv568/-/DC1">Supplementary Methods</ext-link> for full details of the cohort). Note that CD4 and CD8 T cells are both T lymphocyte subsets, whereas monocytes are from the myeloid lineage. We ran HESS separately on each cell type, and simultaneously on the joint dataset. The analysis was restricted to 21 788 SNPs on chromosome 5 and 3248 probesets selected by highest variance (see <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btv568/-/DC1">Supplementary Material, Section S.6.1</ext-link>) for computational feasibility. HESS was run using a burn-in of 4000 sweeps and values recorded for 8000 sweeps. MT-HESS took 110 h on a 2.80-GHz Intel(R) Xeon(R) computer.</p>
      <p>In the single cell type analysis, hotspots were most frequently detected in CD4 T cells, followed by CD8 T cells, whereas in monocytes we found a paucity of hotspot SNPs (<xref ref-type="fig" rid="btv568-F4">Fig. 4</xref>). Using a 5% bFDR, the maximum number of genes associated with a SNP in monocytes was 6, versus 78 in CD4 T cells. There was less gene–gene correlation in the monocyte expression data (<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btv568/-/DC1">Supplementary Fig. S.17a–c</ext-link>), and this may account for the lack of hotspot detection in this cell type.
<fig id="btv568-F4" orientation="portrait" position="float"><label>Fig. 4.</label><caption><p>Manhattan plot for hotspot SNPs. The plot shows the number of genes significantly associated with each SNP according to position on chromosome 5 using an MPPI threshold corresponding to a 5% Bayes FDR. Vertical purple lines indicates results from the joint analysis. Red circles, blue diamonds and black crosses indicate single tissue analysis in CD4 T cells, CD8 T cells and monocytes, respectively</p></caption><graphic xlink:href="btv568f4p"/></fig>
</p>
      <p>In the joint MT-HESS analysis 28 SNPs were associated with expression of five or more genes at a 5% bFDR significance threshold, with four of these SNPs associated with 20 or more genes (<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btv568/-/DC1">Supplementary Fig. S.18</ext-link>). The signal in the joint analysis appears to be driven predominantly by signal in either the CD4 T cells or the CD8 T cells (<xref ref-type="fig" rid="btv568-F4">Fig. 4</xref>). Unlike in the analysis of the rat data, we did not observe any hotspots that were not detected in the single tissue analysis. However, the number of genes associated with hotspots in the MT-HESS analysis was not substantially diminished despite the hotspots being highlighted mostly in one of the three cell-types (<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btv568/-/DC1">Supplementary Fig. S.18</ext-link>).</p>
      <p>We identified a putative <italic>trans</italic> master regulator SNP, rs11745891, associated with the highest number of genes in both the CD4 T cell and the joint analysis (78 and 71 genes, respectively). The SNP lies in an intergenic region, ∼143 kB downstream from the end of the nearest gene, <italic>PIK3R1</italic> (phosphoinositide-3-kinase, regulatory subunit 1 (alpha)). Histone marks from ENCODE (<xref rid="btv568-B7" ref-type="bibr">Dunham <italic>et</italic>
<italic>al.</italic>, 2012</xref>) suggest the SNP lies near a regulatory locus (<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btv568/-/DC1">Supplementary Fig. S.19</ext-link>). Interestingly, this hotspot SNP lies 10.7 kb from the start site of a long intergenic non-coding (linc) RNA (Ensembl transcript <italic>ENST00000507733</italic>). Emerging evidence suggests that long non-coding RNAs play an important role in orchestrating transcriptional programmes through a variety of mechanisms, commonly involving ribonucleic acid–protein interactions (<xref rid="btv568-B29" ref-type="bibr">Rinn and Chang, 2012</xref>). We hypothesize that our SNP acts in <italic>cis</italic> on the lincRNA, and thus exerts its <italic>trans</italic> effects through differential expression of the lincRNA according to genotype.</p>
      <p>The 78 genes whose expression in CD4 T cells was associated with rs11745891 genotype are located on 21 chromosomes, most frequently chromosome 1 (nine genes) (<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btv568/-/DC1">Supplementary Fig. S.20</ext-link>). <italic>P</italic>-values from simple univariate regression of the expression of these genes on rs11745891 were skewed towards zero (range from <inline-formula><mml:math id="MM124"><mml:mrow><mml:mn>1.23</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> to <inline-formula><mml:math id="MM125"><mml:mrow><mml:mn>1.57</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>8</mml:mn></mml:mrow></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>, see <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btv568/-/DC1">Supplementary Fig. S.21</ext-link>). However, after multiple-testing of <inline-formula><mml:math id="MM126"><mml:mrow><mml:mn>3248</mml:mn><mml:mo>×</mml:mo><mml:mn>217</mml:mn><mml:mo> </mml:mo><mml:mn>888</mml:mn><mml:mo>=</mml:mo><mml:mn>70</mml:mn><mml:mo> </mml:mo><mml:mn>767</mml:mn><mml:mo> </mml:mo><mml:mn>424</mml:mn></mml:mrow></mml:math></inline-formula> SNPgene pairs, using a 5% FDR threshold (Benjamini–Hochberg procedure), none remained statistically significant, demonstrating the strength of HESS in high-dimensional omics analysis.</p>
      <p>The expression levels of these 78 genes were very highly correlated (<xref ref-type="fig" rid="btv568-F5">Fig. 5</xref>a). Strong correlation persisted in the residuals from the simple regression of expression of these genes on rs11745891 genotype (<xref ref-type="fig" rid="btv568-F5">Fig. 5</xref>b). A strength of HESS over traditional one SNP at-a-time methods is its multivariate approach combined with variable selection, allowing us to ask what <italic>combination of SNPs</italic> best explain gene expression. Using this information, we next performed regression of expression of each gene on its best combination of SNP(s). The resulting residuals were substantially less correlated than the residuals from regression on just the hotspot SNP alone (<xref ref-type="fig" rid="btv568-F5">Fig. 5</xref>c). Thus, we see that including multiple SNPs in the model accounts for a substantial fraction of the correlation in gene expression. This highlights a major advantage of our approach.
<fig id="btv568-F5" orientation="portrait" position="float"><label>Fig. 5.</label><caption><p>(<bold>a</bold>) Correlation matrix of expression of the 78 genes associated with hotspot SNP rs11745891 in CD4 T cells. (<bold>b</bold>) Correlation matrix of the residuals after simple regression of expression of each gene on rs11745891 genotype. (<bold>c</bold>) Correlation matrix of the residuals after regression of each gene on the SNPs in its best model. All three correlation matrices have been hierarchically clustered. Colour key and distribution of Pearson correlation coefficients are shown in the upper panels</p></caption><graphic xlink:href="btv568f5p"/></fig>
</p>
      <p>Additional discussion of the human results is given in the <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btv568/-/DC1">Supplementary Material</ext-link>.</p>
    </sec>
  </sec>
  <sec>
    <title>5 Discussion</title>
    <p>The availability of data collected over multiple tissues or conditions is becoming increasingly common given the decreasing cost of generating transcriptomic, metabolic and epigenetic phenotypes over large cohorts of individuals (<xref rid="btv568-B18" ref-type="bibr">Li <italic>et</italic>
<italic>al.</italic>, 2011b</xref>).</p>
    <p>In this article we present a new model that exploits the multidimensional nature of these data and extends ST-HESS presented in <xref rid="btv568-B3" ref-type="bibr">Bottolo <italic>et</italic>
<italic>al.</italic> (2011)</xref>: our new hierarchical model and C<inline-formula><mml:math id="MM127"><mml:mrow><mml:mo>+</mml:mo><mml:mo>+</mml:mo></mml:mrow></mml:math></inline-formula> algorithm, MT-HESS is able to analyse a large number of responses collected over dependent multiple tissues or conditions and regress them on a large set of correlated predictors. Similar to its parent version, MT-HESS retains the ability to perform hotspot discovery in -omics experiments. To the best of our knowledge, MT-HESS is the first tool able to unravel whether a genetic marker has a systemic role and influences several OMICS traits in multiple related conditions at the same time.</p>
    <p>This is demonstrated in the complex multiple tissue scenario of our real rat data analysis. The increased power of MT-HESS allowed the detection of both experimentally validated and previously undiscovered putative hotspots for the IDIN network across left ventricle, aorta and liver tissues. Prediction error analysis confirms the importance of the new detected hotspots. Model adequacy measure shows the superiority of MT-HESS model over ST-HESS and the benefit of the integrated analysis. While in the rats dataset it is possible to perform a leave-one-out cross-validation approach, in larger datasets out-of-sample prediction error can be performed by taking a random split of the data, for instance 50/50, and reserving the remaining data for calculating the average prediction error.</p>
    <p>Due to a lack of competing algorithms that can analyse multiple layers of correlated responses in a fully multivariate fashion, we have compared MT-HESS with a MANOVA test, which is extensively used when multiple outcomes are present. Recall that such MANOVA test is performed for each pair of (SNP × response vector) at a time, where the vector of responses correspond to the expression in multiple tissues or conditions. We see that MT-HESS outperforms MANOVA, demonstrating that our hierarchical modelling approach is more powerful than pairwise methods.</p>
    <p>When faced with an eQTL analysis task which involves multiple tissues, a natural alternative to MANOVA test is to compare results from the intersection of single-tissue model (iST-HESS) with those from the multiple-tissue one (MT-HSSS). Our extensive simulation study show that when there is a similar pattern of association but varying levels of signal-to-noise ratio across tissues, MT-HESS clearly outperforms iST-HESS. This is well in keeping with the construction of the model underlying MT-HESS, which performs a statistically sound evidence synthesis for detecting hotspots between the set of conditions or tissues. When signal-to-noise ratio is constant across conditions/tissues MT-HESS results become closer to those of iST-HESS pointing to the benefit of adjusting for external sources of correlated noise prior to MT-HESS analysis, for example by using a latent factor approach as in <xref rid="btv568-B33" ref-type="bibr">Stegle <italic>et</italic>
<italic>al.</italic> (2012)</xref>.</p>
    <p>In our simulation study we show a substantial gain of power of MT-HESS when the association in each tissue were too weak to be detected by ST-HESS, a situation also illustrated in our first case study where two new hotspots were highlighted by MT-HESS, whereas they were not detected in the single tissue analyses. Here the ST-HESS signal is relatively noisy and the ability of MT-HESS to borrow and synthesize information between different layers of the responses results in higher power for MT-HESS.</p>
    <p>Our new C++ implementation of the complex hierarchical structure in MT-HESS (comprising ST-HESS as a special case) permits efficient analysis of very large datasets. It made feasible an MT-HESS analysis of our human dataset, where a multivariate analysis and variable selection between 3000 responses in three cell types and nearly 22 000 SNPs was carried out. The putative novel <italic>trans</italic> master regulator situated near a long intergenic non-coding (linc) RNA (Ensembl transcript <italic>ENST00000507733</italic>) (see Section 4.2) is a good example of the power of our approach for generating hypotheses which can be validated by follow-up experiments. The clear separation between noise and signal offered by our sparse regression approach is paramount for successfully prioritizing such further validation.</p>
    <p>In conclusion, our new algorithm MT-HESS with its efficient C++ architecture is tailored to jointly analyse realistic case studies that comprise a large number of responses collected over dependent multiple tissues or conditions and a large set of potentially collinear predictors.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="PMC_1" content-type="local-data">
      <caption>
        <title>Supplementary Data</title>
      </caption>
      <media mimetype="text" mime-subtype="html" xlink:href="supp_32_4_523__index.html"/>
      <media xlink:role="associated-file" mimetype="application" mime-subtype="pdf" xlink:href="supp_btv568_HESS_SUPPL_RESUBMIT.pdf"/>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <title>Acknowledgements</title>
    <p>We thank the patients who kindly volunteered for this study, and Dr. Miles Parkes, Consultant Gastroenterologist at Addenbrooke Hospital, Cambridge, for helping to identify suitable patients. We are also grateful to the editor and three anonymous referees for valuable comments that greatly improved the presentation of the paper. We acknowledge the NIHR Cambridge Biomedical Research Centre.</p>
  </ack>
  <sec>
    <title>Funding</title>
    <p>This research was funded by <funding-source>Medical Research Council</funding-source> Grant <award-id>G1002319</award-id> (A.L., H.S., L.B., S.R.), a Wellcome Trust Clinical PhD Programme Fellowship (J.E.P.), <funding-source>Wellcome Trust</funding-source> Grant <award-id>083650/Z/07/Z</award-id> and <funding-source>Medical Research Council</funding-source> Grant <award-id>MR/L19027/1</award-id> (K.G.C.S.), <funding-source>British Heart Foundation PhD Studentship</funding-source> Grant <award-id>FS/11/25/28740</award-id> (A.M., E.P.) and <funding-source>Engineering and Physical Sciences Research Council</funding-source> Grant <funding-source>EP/K030760/1</funding-source> (L.B.).</p>
    <p><italic>Conflict of Interest</italic>: none declared.</p>
  </sec>
  <ref-list>
    <title>References</title>
    <ref id="btv568-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Atanur</surname><given-names>S.S.</given-names></name><etal/></person-group> (<year>2010</year>) <article-title>The genome sequence of the spontaneously hypertensive rat: analysis and functional significance</article-title>. <source>Genome Res.</source>, <volume>20</volume>, <fpage>791</fpage>–<lpage>803</lpage>.<pub-id pub-id-type="pmid">20430781</pub-id></mixed-citation>
    </ref>
    <ref id="btv568-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bottolo</surname><given-names>L.</given-names></name><name><surname>Richardson</surname><given-names>S.</given-names></name></person-group> (<year>2010</year>) <article-title>Evolutionary Stochastic search for Bayesian model exploration</article-title>. <source>Bayesian Anal.</source>, <volume>5</volume>, <fpage>583</fpage>–<lpage>618</lpage>.</mixed-citation>
    </ref>
    <ref id="btv568-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bottolo</surname><given-names>L.</given-names></name><etal/></person-group> (<year>2011</year>) <article-title>Bayesian detection of expression quantitative trait loci hot spots</article-title>. <source>Genetics</source>, <volume>189</volume>, <fpage>1449</fpage>–<lpage>1459</lpage>.<pub-id pub-id-type="pmid">21926303</pub-id></mixed-citation>
    </ref>
    <ref id="btv568-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bottolo</surname><given-names>L.</given-names></name><etal/></person-group> (<year>2013</year>) <article-title>GUESS-ing polygenic associations with multiple phenotypes using a GPU-based evolutionary stochastic search algorithm</article-title>. <source>PLoS Genet.</source>, <volume>9</volume>, <fpage>e1003657</fpage>.<pub-id pub-id-type="pmid">23950726</pub-id></mixed-citation>
    </ref>
    <ref id="btv568-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Broët</surname><given-names>P.</given-names></name><etal/></person-group> (<year>2004</year>) <article-title>A mixture model-based strategy for selecting sets of genes in multiclass response microarray experiments</article-title>. <source>Bioinformatics</source>, <volume>20</volume>, <fpage>2562</fpage>–<lpage>2571</lpage>.<pub-id pub-id-type="pmid">15117756</pub-id></mixed-citation>
    </ref>
    <ref id="btv568-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Brown</surname><given-names>P.J.</given-names></name><etal/></person-group> (<year>1998</year>) <article-title>Multivariate Bayesian variable selection and prediction</article-title>. <source>J. R. Stat. Soc. B</source>, <volume>60</volume>, <fpage>627</fpage>–<lpage>641</lpage>.</mixed-citation>
    </ref>
    <ref id="btv568-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dunham</surname><given-names>I.</given-names></name><etal/></person-group> (<year>2012</year>) <article-title>An integrated encyclopedia of DNA elements in the human genome</article-title>. <source>Nature</source>, <volume>489</volume>, <fpage>57</fpage>–<lpage>74</lpage>.<pub-id pub-id-type="pmid">22955616</pub-id></mixed-citation>
    </ref>
    <ref id="btv568-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fairfax</surname><given-names>B.P.</given-names></name><etal/></person-group> (<year>2012</year>) <article-title>Genetics of gene expression in primary immune cells identifies cell type-specific master regulators and roles of HLA alleles</article-title>. <source>Nat. Genet.</source>, <volume>44</volume>, <fpage>502</fpage>–<lpage>510</lpage>.<pub-id pub-id-type="pmid">22446964</pub-id></mixed-citation>
    </ref>
    <ref id="btv568-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Flutre</surname><given-names>T.</given-names></name><etal/></person-group> (<year>2013</year>) <article-title>A statistical framework for joint eQTL analysis in multiple tissues</article-title>. <source>PLoS Genet.</source>, <volume>9</volume>, <fpage>e1003486</fpage>.<pub-id pub-id-type="pmid">23671422</pub-id></mixed-citation>
    </ref>
    <ref id="btv568-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fusi</surname><given-names>N.</given-names></name><etal/></person-group> (<year>2012</year>) <article-title>Joint modelling of confounding factors and prominent genetic regulators provides increased accuracy in genetical genomics studies</article-title>. <source>PLoS Comput. Biol.</source>, <volume>8</volume>, <fpage>e1002330</fpage>.<pub-id pub-id-type="pmid">22241974</pub-id></mixed-citation>
    </ref>
    <ref id="btv568-B11">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name><surname>Gelfand</surname><given-names>A.</given-names></name><etal/></person-group> (<year>1992</year>) <article-title>Model determination using predictive distributions with implementation via sampling-based-methods (with discussion)</article-title>. In: <person-group person-group-type="editor"><name><surname>Bernardo</surname><given-names>J.</given-names></name></person-group> (eds.), <source>Bayesian Statistics</source>, <volume>vol. 4</volume>, <publisher-loc>Oxford</publisher-loc>: <publisher-name>Oxford University Press</publisher-name>, pp. <fpage>147</fpage>–<lpage>167</lpage>.</mixed-citation>
    </ref>
    <ref id="btv568-B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hawkins</surname><given-names>R.D.</given-names></name><etal/></person-group> (<year>2010</year>) <article-title>Next-generation genomics: an integrative approach</article-title>. <source>Nat. Rev. Genet.</source>, <volume>11</volume>, <fpage>476</fpage>–<lpage>486</lpage>.<pub-id pub-id-type="pmid">20531367</pub-id></mixed-citation>
    </ref>
    <ref id="btv568-B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Heinig</surname><given-names>M.</given-names></name><etal/></person-group> (<year>2010</year>) <article-title>A trans-acting locus regulates an anti-viral expression network and type 1 diabetes risk</article-title>. <source>Nature</source>, <volume>467</volume>, <fpage>460</fpage>–<lpage>464</lpage>.<pub-id pub-id-type="pmid">20827270</pub-id></mixed-citation>
    </ref>
    <ref id="btv568-B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hubner</surname><given-names>N.</given-names></name><etal/></person-group> (<year>2005</year>) <article-title>Integrated transcriptional profiling and linkage analysis for identification of genes underlying disease</article-title>. <source>Nat. Genet.</source>, <volume>37</volume>, <fpage>243</fpage>–<lpage>253</lpage>.<pub-id pub-id-type="pmid">15711544</pub-id></mixed-citation>
    </ref>
    <ref id="btv568-B15">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kristensen</surname><given-names>V.N.</given-names></name><etal/></person-group> (<year>2014</year>) <article-title>Principles and methods of integrative genomic analyses in cancer</article-title>. <source>Nat. Rev. Cancer</source>, <volume>14</volume>, <fpage>299</fpage>–<lpage>313</lpage>.<pub-id pub-id-type="pmid">24759209</pub-id></mixed-citation>
    </ref>
    <ref id="btv568-B16">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lee</surname><given-names>M.N.</given-names></name><etal/></person-group> (<year>2014</year>) <article-title>Common genetic variants modulate pathogen-sensing responses in human dendritic cells</article-title>. <source>Science</source>, <volume>343</volume>, <fpage>1246980</fpage>.<pub-id pub-id-type="pmid">24604203</pub-id></mixed-citation>
    </ref>
    <ref id="btv568-B17">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Li</surname><given-names>S.</given-names></name><etal/></person-group> (<year>2011a</year>) <article-title>Mapping a dynamic innate immunity protein interaction network regulating type I interferon production</article-title>. <source>Immunity</source>, <volume>35</volume>, <fpage>426</fpage>–<lpage>440</lpage>.<pub-id pub-id-type="pmid">21903422</pub-id></mixed-citation>
    </ref>
    <ref id="btv568-B18">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Li</surname><given-names>W.</given-names></name><etal/></person-group> (<year>2011b</year>) <article-title>Integrative analysis of many weighted co-expression networks using tensor computation</article-title>. <source>PLoS Comput. Biol.</source>, <volume>7</volume>, <fpage>e1001106</fpage>.<pub-id pub-id-type="pmid">21698123</pub-id></mixed-citation>
    </ref>
    <ref id="btv568-B19">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Liang</surname><given-names>F.</given-names></name><name><surname>Wong</surname><given-names>W.H.</given-names></name></person-group> (<year>2000</year>) <article-title>Evolutionary Monte Carlo: applications to cp model sampling and change point problem</article-title>. <source>Stat. Sin.</source>, <volume>10</volume>, <fpage>317</fpage>–<lpage>342</lpage>.</mixed-citation>
    </ref>
    <ref id="btv568-B20">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Liang</surname><given-names>F.</given-names></name><etal/></person-group> (<year>2008</year>) <article-title>Mixtures of g priors for Bayesian variable selection</article-title>. <source>J. Am. Stat. Assoc.</source>, <volume>103</volume>, <fpage>410</fpage>–<lpage>423</lpage>.</mixed-citation>
    </ref>
    <ref id="btv568-B21">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Marttinen</surname><given-names>P.</given-names></name><etal/></person-group> (<year>2014</year>) <article-title>Assessing multivariate gene-metabolome associations with rare variants using Bayesian reduced rank regression</article-title>. <source>Bioinformatics</source>, <volume>30</volume>, <fpage>2026</fpage>–<lpage>2034</lpage>.<pub-id pub-id-type="pmid">24665129</pub-id></mixed-citation>
    </ref>
    <ref id="btv568-B22">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Melé</surname><given-names>M.</given-names></name><etal/></person-group> (<year>2015</year>) <article-title>The human transcriptome across tissues and individuals</article-title>. <source>Science</source>, <volume>348</volume>, <fpage>660</fpage>–<lpage>665</lpage>.<pub-id pub-id-type="pmid">25954002</pub-id></mixed-citation>
    </ref>
    <ref id="btv568-B23">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name><surname>Muller</surname><given-names>P.</given-names></name><etal/></person-group> (<year>2006</year>) <article-title>Fdr and Bayesian multiple comparisons rules</article-title>. In: <person-group person-group-type="editor"><name><surname>Bernardo</surname><given-names>J.</given-names></name></person-group> (eds) <source>Bayesian Statistics</source>, <volume>vol. 8</volume>
<publisher-name>Oxford University Press</publisher-name>, <publisher-loc>Oxford</publisher-loc>.</mixed-citation>
    </ref>
    <ref id="btv568-B24">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Nath</surname><given-names>R.</given-names></name><name><surname>Pavur</surname><given-names>R.</given-names></name></person-group> (<year>1985</year>) <article-title>A new statistic in the one-way multivariate analysis of variance</article-title>. <source>Comput. Stat. Data Anal.</source>, <volume>2</volume>, <fpage>297</fpage>–<lpage>315</lpage>.</mixed-citation>
    </ref>
    <ref id="btv568-B25">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Petretto</surname><given-names>E.</given-names></name><etal/></person-group> (<year>2006</year>) <article-title>Heritability and tissue specificity of expression quantitative trait loci</article-title>. <source>PLoS Genet.</source>, <volume>2</volume>, <fpage>e172</fpage>.<pub-id pub-id-type="pmid">17054398</pub-id></mixed-citation>
    </ref>
    <ref id="btv568-B26">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Petretto</surname><given-names>E.</given-names></name><etal/></person-group> (<year>2010</year>) <article-title>New insights into the genetic control of gene expression using a Bayesian multi-tissue Approach</article-title>. <source>PLoS Comput. Biol.</source>, <volume>6</volume>, <fpage>587</fpage>–<lpage>588</lpage>.</mixed-citation>
    </ref>
    <ref id="btv568-B27">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Raj</surname><given-names>T.</given-names></name><etal/></person-group> (<year>2014</year>) <article-title>Polarization of the effects of autoimmune and neurodegenerative risk alleles in leukocytes</article-title>. <source>Science</source>, <volume>344</volume>, <fpage>519</fpage>–<lpage>523</lpage>.<pub-id pub-id-type="pmid">24786080</pub-id></mixed-citation>
    </ref>
    <ref id="btv568-B28">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name><surname>Richardson</surname><given-names>S.</given-names></name><etal/></person-group> (<year>2010</year>) <article-title>Bayesian models for sparse regression analysis of high dimensional data</article-title>. In: <person-group person-group-type="editor"><name><surname>Bernardo</surname><given-names>J.</given-names></name></person-group> (eds) <source>Bayesian Statistics 9</source>, <volume>volume 9</volume>
<publisher-name>Oxford University Press</publisher-name>, <publisher-loc>Oxford</publisher-loc>, pp. <fpage>539</fpage>–<lpage>569</lpage></mixed-citation>
    </ref>
    <ref id="btv568-B29">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rinn</surname><given-names>J.L.</given-names></name><name><surname>Chang</surname><given-names>H.Y.</given-names></name></person-group> (<year>2012</year>) <article-title>Genome regulation by long noncoding RNAs</article-title>. <source>Annu. Rev. Biochem.</source>, <volume>81</volume>, <fpage>145</fpage>–<lpage>166</lpage>.<pub-id pub-id-type="pmid">22663078</pub-id></mixed-citation>
    </ref>
    <ref id="btv568-B30">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Roider</surname><given-names>H.G.</given-names></name><etal/></person-group> (<year>2009</year>) <article-title>PASTAA: identifying transcription factors associated with sets of co-regulated genes</article-title>. <source>Bioinformatics</source>, <volume>25</volume>, <fpage>435</fpage>–<lpage>442</lpage>.<pub-id pub-id-type="pmid">19073590</pub-id></mixed-citation>
    </ref>
    <ref id="btv568-B31">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Scott-Boyer</surname><given-names>M.P.</given-names></name><etal/></person-group> (<year>2012</year>) <article-title>An integrated hierarchical Bayesian model for multivariate eQTL mapping</article-title>. <source>Stat. Appl. Genet. Mol. Biol.</source>, <volume>11</volume>.</mixed-citation>
    </ref>
    <ref id="btv568-B32">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Shabalin</surname><given-names>A.A.</given-names></name></person-group> (<year>2012</year>) <article-title>Matrix eQTL: ultra fast eQTL analysis via large matrix operations</article-title>. <source>Bioinformatics</source>, <volume>28</volume>, <fpage>1353</fpage>–<lpage>1358</lpage>.<pub-id pub-id-type="pmid">22492648</pub-id></mixed-citation>
    </ref>
    <ref id="btv568-B33">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Stegle</surname><given-names>O.</given-names></name><etal/></person-group> (<year>2012</year>) <article-title>Using probabilistic estimation of expression residuals (PEER) to obtain increased power and interpretability of gene expression analyses</article-title>. <source>Nat. Protoc.</source>, <volume>7</volume>, <fpage>500</fpage>–<lpage>507</lpage>.<pub-id pub-id-type="pmid">22343431</pub-id></mixed-citation>
    </ref>
    <ref id="btv568-B34">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Stingo</surname><given-names>F.C.</given-names></name><etal/></person-group> (<year>2010</year>) <article-title>A Bayesian graphical modeling approach to microRNA regulatory network inference</article-title>. <source>Ann. Appl. Stat.</source>, <volume>4</volume>, <fpage>20242048</fpage>.</mixed-citation>
    </ref>
    <ref id="btv568-B35">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Westra</surname><given-names>H.-J.</given-names></name><etal/></person-group> (<year>2013</year>) <article-title>Systematic identification of trans eQTLs as putative drivers of known disease associations</article-title>. <source>Nat. Genet.</source>, <volume>45</volume>, <fpage>1238</fpage>–<lpage>1243</lpage>.<pub-id pub-id-type="pmid">24013639</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
