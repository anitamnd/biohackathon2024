<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">J Cheminform</journal-id>
    <journal-id journal-id-type="iso-abbrev">J Cheminform</journal-id>
    <journal-title-group>
      <journal-title>Journal of Cheminformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1758-2946</issn>
    <publisher>
      <publisher-name>Springer International Publishing</publisher-name>
      <publisher-loc>Cham</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">9985203</article-id>
    <article-id pub-id-type="publisher-id">695</article-id>
    <article-id pub-id-type="doi">10.1186/s13321-023-00695-y</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>MAW: the reproducible <underline>M</underline>etabolome <underline>A</underline>nnotation <underline>W</underline>orkflow for untargeted tandem mass spectrometry</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Zulfiqar</surname>
          <given-names>Mahnoor</given-names>
        </name>
        <address>
          <email>mahnoor.zulfiqar@uni-jena.de</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Gadelha</surname>
          <given-names>Luiz</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Steinbeck</surname>
          <given-names>Christoph</given-names>
        </name>
        <address>
          <email>christoph.steinbeck@uni-jena.de</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Sorokina</surname>
          <given-names>Maria</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Peters</surname>
          <given-names>Kristian</given-names>
        </name>
        <address>
          <email>kristian.peters@ipb-halle.de</email>
        </address>
        <xref ref-type="aff" rid="Aff3">3</xref>
        <xref ref-type="aff" rid="Aff4">4</xref>
        <xref ref-type="aff" rid="Aff5">5</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="GRID">grid.9613.d</institution-id><institution-id institution-id-type="ISNI">0000 0001 1939 2794</institution-id><institution>Institute for Inorganic and Analytical Chemistry, </institution><institution>Friedrich Schiller University, </institution></institution-wrap>07743 Jena, Germany </aff>
      <aff id="Aff2"><label>2</label>Data Science and Artificial Intelligence, Research and Development, Bayer Pharmaceuticals, 13353 Berlin, Germany </aff>
      <aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="GRID">grid.9647.c</institution-id><institution-id institution-id-type="ISNI">0000 0004 7669 9786</institution-id><institution>iDiv - German Centre for Integrative Biodiversity Research, Halle-Jena-Leipzig, </institution></institution-wrap>Leipzig, 04103 Germany </aff>
      <aff id="Aff4"><label>4</label><institution-wrap><institution-id institution-id-type="GRID">grid.9018.0</institution-id><institution-id institution-id-type="ISNI">0000 0001 0679 2801</institution-id><institution>Geobotany and Botanical Gardens, </institution><institution>Martin-Luther University of Halle-Wittenberg, </institution></institution-wrap>06108 Halle, Germany </aff>
      <aff id="Aff5"><label>5</label><institution-wrap><institution-id institution-id-type="GRID">grid.425084.f</institution-id><institution-id institution-id-type="ISNI">0000 0004 0493 728X</institution-id><institution>Leibniz Institute of Plant Biochemistry, </institution></institution-wrap>06120 Halle, Germany </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>4</day>
      <month>3</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>4</day>
      <month>3</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2023</year>
    </pub-date>
    <volume>15</volume>
    <elocation-id>32</elocation-id>
    <history>
      <date date-type="received">
        <day>18</day>
        <month>11</month>
        <year>2022</year>
      </date>
      <date date-type="accepted">
        <day>6</day>
        <month>2</month>
        <year>2023</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2023</copyright-statement>
      <license>
        <ali:license_ref specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p><bold>Open Access</bold>This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article's Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article's Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated in a credit line to the data.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <p id="Par1">Mapping the chemical space of compounds to chemical structures remains a challenge in metabolomics. Despite the advancements in untargeted liquid chromatography-mass spectrometry (LC–MS) to achieve a high-throughput profile of metabolites from complex biological resources, only a small fraction of these metabolites can be annotated with confidence. Many novel computational methods and tools have been developed to enable chemical structure annotation to known and unknown compounds such as in silico generated spectra and molecular networking. Here, we present an automated and reproducible <underline>M</underline>etabolome <underline>A</underline>nnotation <underline>W</underline>orkflow (MAW) for untargeted metabolomics data to further facilitate and automate the complex annotation by combining tandem mass spectrometry (MS<sup>2</sup>) input data pre-processing, spectral and compound database matching with computational classification, and in silico annotation. MAW takes the LC-MS<sup>2</sup> spectra as input and generates a list of putative candidates from spectral and compound databases. The databases are integrated via the R package Spectra and the metabolite annotation tool SIRIUS as part of the R segment of the workflow (MAW-R). The final candidate selection is performed using the cheminformatics tool RDKit in the Python segment (MAW-Py). Furthermore, each feature is assigned a chemical structure and can be imported to a chemical structure similarity network. MAW is following the FAIR (Findable, Accessible, Interoperable, Reusable) principles and has been made available as the docker images, maw-r and maw-py. The source code and documentation are available on GitHub (<ext-link ext-link-type="uri" xlink:href="https://github.com/zmahnoor14/MAW">https://github.com/zmahnoor14/MAW</ext-link>). The performance of MAW is evaluated on two case studies. MAW can improve candidate ranking by integrating spectral databases with annotation tools like SIRIUS which contributes to an efficient candidate selection procedure. The results from MAW are also reproducible and traceable, compliant with the FAIR guidelines. Taken together, MAW could greatly facilitate automated metabolite characterization in diverse fields such as clinical metabolomics and natural product discovery.</p>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Untargeted metabolomics</kwd>
      <kwd>Workflow</kwd>
      <kwd>Tandem mass spectrometry</kwd>
      <kwd>FAIR</kwd>
      <kwd>Metabolite annotation</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100001659</institution-id>
            <institution>Deutsche Forschungsgemeinschaft</institution>
          </institution-wrap>
        </funding-source>
        <award-id>390713860</award-id>
        <award-id>390713860</award-id>
        <award-id>390713860</award-id>
        <award-id>239748522–SFB 1127</award-id>
        <principal-award-recipient>
          <name>
            <surname>Zulfiqar</surname>
            <given-names>Mahnoor</given-names>
          </name>
          <name>
            <surname>Gadelha</surname>
            <given-names>Luiz</given-names>
          </name>
          <name>
            <surname>Steinbeck</surname>
            <given-names>Christoph</given-names>
          </name>
          <name>
            <surname>Sorokina</surname>
            <given-names>Maria</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>Friedrich-Schiller-Universität Jena (1010)</institution>
        </funding-source>
      </award-group>
      <open-access>
        <p>Open Access funding enabled and organized by Projekt DEAL.</p>
      </open-access>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2023</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Introduction</title>
    <p id="Par19">Over the last few decades, omics technologies have gained importance in the biological domain. One of the recent developments in omics science is metabolomics, which is a collection of high-throughput analytical methods to assess the metabolic profiles of biological samples [<xref ref-type="bibr" rid="CR1">1</xref>]. Among metabolomics approaches, liquid chromatography coupled to mass spectrometry (LC–MS) is the most often-used technique for the identification of lower molecular weight (typically below 1000 Da) molecules. LC–MS also provides broad coverage of biologically relevant metabolites [<xref ref-type="bibr" rid="CR2">2</xref>] or natural products [<xref ref-type="bibr" rid="CR3">3</xref>]. However, as metabolomics data can be complex and convoluted, chemical heterogeneity poses a challenge to the number of metabolites that can be identified with metabolomics [<xref ref-type="bibr" rid="CR4">4</xref>]. Untargeted metabolomics data, which represents global metabolic features in a sample, results in a large number of files containing spectral information from thousands of metabolite features [<xref ref-type="bibr" rid="CR5">5</xref>]. Unlike genomics where there are only 4 nucleotides and finite possible combinations, chemical structures are made up of many constituents leading to an almost infinite chemical space. In addition, it is also difficult to reproduce the same metabolic features between different instruments, which makes the structural identification of the metabolic features difficult [<xref ref-type="bibr" rid="CR6">6</xref>].</p>
    <p id="Par20">Typically, an LC–MS metabolomics pipeline involves the following steps: (1) conversion of RAW spectral data to an open-source machine-readable format such as.mzML, (2) peak detection, (3) peak alignment, (4) retention time correction, (5) isotope detection, (6) adduct annotation, (7) peak annotation, and (8) data analysis [<xref ref-type="bibr" rid="CR7">7</xref>–<xref ref-type="bibr" rid="CR9">9</xref>]. To acquire more structural information about the samples, tandem mass spectrometry is performed, where two (MS<sup>2</sup>) or more (MS<sup>n</sup>) analyzers are combined with a collision chamber which performs fragmentation of the peaks picked in MS<sup>1</sup> [<xref ref-type="bibr" rid="CR10">10</xref>]. The fragmentation spectra from MS<sup>2</sup> are then used to perform metabolite annotation. To provide a distinction between different levels of confidence for these annotations, the Metabolomics Standards Initiative (MSI), in 2007, proposed four levels of identifications [<xref ref-type="bibr" rid="CR11">11</xref>] which were later expanded [<xref ref-type="bibr" rid="CR12">12</xref>] to five levels. The terms annotation and identification are used interchangeably. However, the term annotation refers to the putative association of a compound to a structure, as compared to the term identification, where the identity of a compound is confirmed with a given metabolic standard. These levels of identifications are described in Table <xref rid="Tab1" ref-type="table">1</xref> in the results section.
</p>
    <p id="Par21">To support metabolomics identification, different data sources such as spectral, compound, and pathway databases have been integrated into metabolomics data processing pipelines and routines [<xref ref-type="bibr" rid="CR13">13</xref>]. To this end, many software tools and programmatic approaches such as R packages have been developed for metabolite annotation that use LC-MS<sup>2</sup> as input data. A few of the most popular examples are SIRIUS [<xref ref-type="bibr" rid="CR14">14</xref>], and MetFrag [<xref ref-type="bibr" rid="CR15">15</xref>]. Some other relatively new tools are MetaboAnnotatoR [<xref ref-type="bibr" rid="CR16">16</xref>], CFM-ID 4.0 [<xref ref-type="bibr" rid="CR17">17</xref>], DEREPLICATOR(+) [<xref ref-type="bibr" rid="CR18">18</xref>], molDiscovery [<xref ref-type="bibr" rid="CR19">19</xref>], CluMSID [<xref ref-type="bibr" rid="CR20">20</xref>], and MS2Query [<xref ref-type="bibr" rid="CR21">21</xref>]. These tools are termed annotation tools. They generally annotate compounds based on spectral and compound libraries and databases. However, many tools currently only partly support the FAIR [<xref ref-type="bibr" rid="CR22">22</xref>] criteria, specifically, the reusability guidelines. Some of these tools have already been integrated into computational metabolomics workflows such as PhenoMeNal [<xref ref-type="bibr" rid="CR23">23</xref>], Workflow4Metabolomics (W4M) [<xref ref-type="bibr" rid="CR24">24</xref>], and GNPS (Global Natural Products Social Molecular Networking) [<xref ref-type="bibr" rid="CR25">25</xref>]. These tools utilize workflow management systems, such as Galaxy [<xref ref-type="bibr" rid="CR26">26</xref>], KNIME [<xref ref-type="bibr" rid="CR27">27</xref>], TidyMass [<xref ref-type="bibr" rid="CR28">28</xref>], or work as independent software such as MS-Dial [<xref ref-type="bibr" rid="CR29">29</xref>], or mzMine [<xref ref-type="bibr" rid="CR30">30</xref>] which can be integrated into any metabolomics pipeline or workflow.</p>
    <p id="Par22">Customization is a very important aspect of these metabolomics workflows due to the variations in the experimental designs and samples. Annotation, for instance, is also usually a manual process to select the best candidate by going through the candidate list provided by different annotation tools, which takes effort and time, specifically in the case of untargeted metabolomics, which is a comprehensive analysis of all measured compounds in a sample. Untargeted metabolomics studies, and phenome centers, where large amounts of data are generated repeatedly, result in large-scale data where workflows can greatly automate and facilitate the analysis [<xref ref-type="bibr" rid="CR31">31</xref>, <xref ref-type="bibr" rid="CR32">32</xref>]. For such large datasets, reproducibility [<xref ref-type="bibr" rid="CR33">33</xref>] can be another issue where the intermediate results should be tracked to check the final outcome. In other words, the provenance [<xref ref-type="bibr" rid="CR34">34</xref>] should be recorded. In addition to reproducibility, best practices defined in the FAIR principles [<xref ref-type="bibr" rid="CR22">22</xref>, <xref ref-type="bibr" rid="CR35">35</xref>] should be employed within workflow systems to improve the Findability, Accessibility, Interoperability, and Reusability of the research objects.</p>
    <p id="Par23">Here, we introduce the reproducible and automated <underline>M</underline>etabolome <underline>A</underline>nnotation <underline>W</underline>orkflow (MAW) for untargeted metabolomics data. MAW is a computational workflow which can automate execution in e.g., cloud environments and can greatly speed up the analysis of high-throughput data. MAW performs (1) MS<sup>2</sup> data preprocessing, (2) spectral database dereplication, (3) compound database dereplication, (4) candidate selection, and (5) chemical compound classification using various tools integrated into the workflow. It provides a list of top-scoring candidates as a network and also prioritizes a final candidate from the list, for each feature. MAW follows the FAIR guiding principles [<xref ref-type="bibr" rid="CR35">35</xref>]. It uses public databases and open-source software tools. The complete MAW source code is available on GitHub [<xref ref-type="bibr" rid="CR36">36</xref>]. It is developed in the languages R and Python and can be executed with all its functionalities and dependencies as two docker images for MAW-R and MAW-Py from DockerHub [<xref ref-type="bibr" rid="CR37">37</xref>, <xref ref-type="bibr" rid="CR38">38</xref>].</p>
  </sec>
  <sec id="Sec2">
    <title>Methods</title>
    <sec id="Sec3">
      <title>Input data prerequisites</title>
      <p id="Par24">The objective of this workflow is metabolome annotation from the data acquired from liquid chromatography-tandem mass spectrometry (LC-MS<sup>2</sup>) with data-dependent acquisition (DDA) mode [<xref ref-type="bibr" rid="CR39">39</xref>]. MAW takes .mzML files as input containing both MS<sup>1</sup> features and MS<sup>2</sup> spectra. The LC–MS features should be pre-selected, as MAW directly starts with the pre-processing of MS<sup>2</sup> spectra for annotation. The RAW files after data acquisition can be converted to. mzML format [<xref ref-type="bibr" rid="CR7">7</xref>] using the MS-Convertor from the ProteoWizard suite [<xref ref-type="bibr" rid="CR40">40</xref>] or the mass spectrometry file conversion tool on GNPS. The profile peak data should be converted to centroid peak data during the conversion.</p>
      <p id="Par25">We used two reference datasets to assess the performance of MAW. The first dataset consists of standards from a study on hypersalinity in diatoms [<xref ref-type="bibr" rid="CR41">41</xref>]: betaine, pipecolinic acid, cysteinolic acid, methionine sulfoxide, <italic>N</italic>,<italic>N</italic>-dimethylarginine, <italic>O</italic>-acetyl-<sc>l</sc>-carnitine, <italic>O</italic>-propanoyl-<sc>l</sc>-carnitine, <italic>O</italic>-butanoyl-<sc>l</sc>-carnitine, and isovalerylcarnitine. The second dataset is from a study on nine different Bryophyte species [<xref ref-type="bibr" rid="CR42">42</xref>]. The .mzML files of the entire study on Bryophytes are available in MetaboLights under the accession MTBLS709. Both datasets were obtained using LC-MS<sup>2</sup> in DDA mode. The mzML files used in this study have been made available on Zenodo [<xref ref-type="bibr" rid="CR43">43</xref>, <xref ref-type="bibr" rid="CR44">44</xref>].</p>
      <p id="Par26">To use MS<sup>2</sup> spectral databases in MAW, we downloaded GNPS, HMDB (Human Metabolome Database) [<xref ref-type="bibr" rid="CR45">45</xref>], and MassBank [<xref ref-type="bibr" rid="CR46">46</xref>]. These databases were stored as an R object using MsBackend, which is a virtual class defined in the R package Spectra [<xref ref-type="bibr" rid="CR47">47</xref>] to store and retrieve the mass spectrometry data. The database dumps have been made available on Zenodo [<xref ref-type="bibr" rid="CR48">48</xref>].</p>
    </sec>
    <sec id="Sec4">
      <title>Metabolome Annotation Workflow</title>
      <p id="Par27">The Metabolome Annotation Workflow (MAW) is executed as a computational workflow which provides different executable modules: (1) Spectral database dereplication, (2) Compound database dereplication, and (3) Candidate selection. MAW is written in R for metabolomics data handling and Python for cheminformatics analysis. Figure <xref rid="Fig1" ref-type="fig">1</xref> illustrates the overview of the workflow.<fig id="Fig1"><label>Fig. 1</label><caption><p>Overview of MAW. MAW-R executes dereplication. It starts with the input data files and searches the spectra in spectral and compound databases with the R package Spectra and SIRIUS respectively. Once the dereplication is completed and each file and precursor mass [m/z] has some candidates from different databases, MAW-Py performs candidate selection from these sources, generates classes, and creates a table for the chemical similarity network, which can be visualized in Cytoscape [<xref ref-type="bibr" rid="CR49">49</xref>]</p></caption><graphic xlink:href="13321_2023_695_Fig1_HTML" id="MO1"/></fig></p>
      <sec id="Sec5">
        <title>MAW-R segment</title>
        <p id="Par28">The workflow starts with preprocessing MS<sup>2</sup> spectra using the package Spectra. The function spec_Processing in MAW-R, reads the .mzML files and extracts all precursor masses [m/z]. This step is common for both spectral and compound database dereplication. Figure <xref rid="Fig2" ref-type="fig">2</xref> describes the MAW-R segment in a stepwise manner.<fig id="Fig2"><label>Fig. 2</label><caption><p>Overview of spectral and compound database dereplication performed in MAW-R. Spectral database dereplication utilizes HMDB, MassBank, and GNPS for each precursor mass [m/z]. The spectral databases are stored as Rdata objects, available on Zenodo. The spectra from input queries and databases with precursor mass [m/z] of interest are extracted. These spectra are compared with cosine similarity scores between the query and database spectra. Individual peaks are also compared to remove any false positive candidates with high overall similarity but lower individual peak similarity. The second part of MAW-R is the compound database dereplication with SIRIUS CLI. To prepare the input files for SIRIUS, MS<sup>2</sup> peaks and isotopic peaks are extracted. This information is written into SIRIUS input files (.ms), which are used to run SIRIUS</p></caption><graphic xlink:href="13321_2023_695_Fig2_HTML" id="MO2"/></fig></p>
        <sec id="Sec6">
          <title>Spectral database dereplication</title>
          <p id="Par29">To start spectral database dereplication, the spec_dereplication_file function is used. This module requires GNPS, HMDB (in silico and experimental spectra), and MassBank spectra stored as R objects. The first function within this module is the spec2_Processing function which extracts all spectra with a given precursor mass [m/z] value, normalizes the intensity, and removes low-intensity peaks (&lt; 5%). This function is applied to both query and database candidate spectra so that they are comparable.</p>
          <p id="Par30">GNPS uses different scoring as compared to HMDB and MassBank. In order to integrate both types of scoring, we implemented the following approach. For GNPS, the fragment peaks of query and candidate spectra are defined as matching peaks, if the difference between their fragment mass [m/z] values and the difference between these adjusted fragment mass [m/z] values is less than the given tolerance (15 ppm by default). This scoring parameter is set to 0.85 (maximum = 1.0) as the threshold. For HMDB and MassBank, a comparison of the two spectra with the dot product is used to determine matching peaks. The default is set to 0.70. The top candidates are also given a normalized score of similarity between fragment masses [m/z] of individual matching peaks and the intensity of these peaks by function peakdf. The ratio of matching peaks by the total peaks in query spectra is also weighed within these scores.<disp-formula id="Equ1"><label>1</label><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\text{mz\_score = }}\frac{{{\text{mz}}_{\text{q}} \cap {\text{mz}}_{\text{d}}}}{{{{\text{n}}_{\text{q}}}{ + }{{\text{n}}_{\text{d}}}}}$$\end{document}</tex-math><mml:math id="M2" display="block"><mml:mrow><mml:mrow><mml:mtext>mz\_score =</mml:mtext><mml:mspace width="0.333333em"/></mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mtext>mz</mml:mtext><mml:mtext>q</mml:mtext></mml:msub><mml:mo>∩</mml:mo><mml:msub><mml:mtext>mz</mml:mtext><mml:mtext>d</mml:mtext></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mtext>n</mml:mtext><mml:mtext>q</mml:mtext></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mtext>n</mml:mtext><mml:mtext>d</mml:mtext></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:math><graphic xlink:href="13321_2023_695_Article_Equ1.gif" position="anchor"/></alternatives></disp-formula></p>
          <p id="Par31">The mz_score is the intersection of the matching peaks between two comparing spectra. mz<sub>q</sub> ∩ mz<sub>d</sub> expression defines the number of matching peaks. n<sub>q</sub> is the total number of peaks in the query spectrum and n<sub>d</sub> is the total number of matching peaks in the database spectrum.<disp-formula id="Equ2"><label>2</label><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\text{int} \_{\text{score}} = \frac{{\sum\nolimits_{{\text{i}} = 1}^{{{\text{n}}_{{\text{qd}}}}} {1 - ({\text{dif}}{{\text{f}}_{{\text{qdi}}}}/100)} }}{{{\text{n}}_{{\text{qd}}}}}$$\end{document}</tex-math><mml:math id="M4" display="block"><mml:mrow><mml:mtext>int</mml:mtext><mml:mi>_</mml:mi><mml:mtext>score</mml:mtext><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mtext>i</mml:mtext><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:msub><mml:mtext>n</mml:mtext><mml:mtext>qd</mml:mtext></mml:msub></mml:msubsup><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mtext>dif</mml:mtext><mml:msub><mml:mtext>f</mml:mtext><mml:mtext>qdi</mml:mtext></mml:msub><mml:mo stretchy="false">/</mml:mo><mml:mn>100</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:msub><mml:mtext>n</mml:mtext><mml:mtext>qd</mml:mtext></mml:msub></mml:mfrac></mml:mrow></mml:math><graphic xlink:href="13321_2023_695_Article_Equ2.gif" position="anchor"/></alternatives></disp-formula></p>
          <p id="Par32">The int_score is the average summation of the difference between individual matching peaks defined by diff<sub>qdi</sub>. Since the score is normalized to 1, the diff<sub>qdi</sub> values are divided by 100 and then subtracted from 1 to give more weightage to peaks with a lesser difference in intensity.</p>
        </sec>
        <sec id="Sec7">
          <title>Compound database dereplication</title>
          <p id="Par33">To utilize the Command Line Interface (CLI) of SIRIUS (version 4.9.12), a parameter file is required as an input for each precursor mass [m/z]. The sirius_param function is used to generate these parameter files in SIRIUS readable.ms format. The parameter file contains the id of the feature, precursor mass [m/z], charge, the median of retention time [s], isotopic peaks if present, and the MS<sup>1</sup> and MS<sup>2</sup> peaks. In order to extract this information, ms2_peaks and ms1_peaks functions are required. ms2_peaks extracts and combines the fragment peak lists for each precursor mass [m/z]. The R package CAMERA is used to extract MS<sup>1</sup> peaks and perform isotope annotation. To run SIRIUS, the run_sirius function is applied based on the isotopic peak annotation. Here, the user can define the database to be used within SIRIUS. For the standards dataset, the “all” database was used, which is a combination of many databases such as PubChem, HMDB, and COCONUT (COlleCtion of Open Natural ProdUcTs). The “all” database is also the default setting. For the bryophytes dataset, the “bio” database was used, which is a collection of different chemical databases reserved for biological sources. Another database used for annotating the bryophytes dataset is the COCONUT database [<xref ref-type="bibr" rid="CR50">50</xref>]. For compound classification, CANOPUS is used [<xref ref-type="bibr" rid="CR51">51</xref>]. Figure <xref rid="Fig2" ref-type="fig">2</xref> describes the step-wise functions in the compound database dereplication module, using SIRIUS.</p>
        </sec>
      </sec>
      <sec id="Sec8">
        <title>MAW-Py segment</title>
        <sec id="Sec9">
          <title>Post-processing</title>
          <p id="Par34">To resolve missing SMILES (Simplified Molecular Input Line Entry Specification) and non-conventional compound names from GNPS, the function spec_postproc removes any naming anomalies and adds SMILES using PubChemPy [<xref ref-type="bibr" rid="CR52">52</xref>]. For HMDB, the results only contain the HMDB database ID. To obtain the names, formulae, and SMILES, the structures.sdf file is downloaded from HMDB. Using the same function, any spectral match with mz_score, int_score, and the ratio of matching peaks below 0.50 are discarded. To post-process the results from SIRIUS, the function sirius_postproc adds the top-scoring candidates from SIRIUS. If there are no structure candidates predicted, then the function adds the top-ranking formulae as the candidates.</p>
        </sec>
        <sec id="Sec10">
          <title>Candidate selection</title>
          <p id="Par35">The candidate selection is performed by the function CandidateSelection_SimilarityandIdentity, which uses RDKit [<xref ref-type="bibr" rid="CR53">53</xref>] to perform the calculations, takes results from spectral and compound databases and runs the Tanimoto similarity score (keeping a threshold of &gt;  = 0.85) to search for common structures or substructures among the top predicted candidates from all these sources. The results can be visualized in chemical similarity networks. This provides the most probable candidate structure. To select one candidate among these top candidates, without manually visualizing the network or going through the list of top candidates, further calculations are performed, with a Tanimoto similarity score of &gt;  = 0.99. This calculation selects one candidate that is present among the top candidates from all or most of the sources. In case of a disagreement among the sources, we provide a prioritization scheme with results from GNPS given higher priority, as compared to SIRIUS, MassBank, and HMDB (see result section "<xref rid="Sec16" ref-type="sec">Comparison of MAW with integrated annotation tools using the standards dataset</xref>"). The result is represented by a list of features and corresponding candidates with MSI confidence levels of identification. Figure <xref rid="Fig3" ref-type="fig">3</xref> explains the step-wise processing of the candidate selection. To visualize the 2D structures, CDK-Depict [<xref ref-type="bibr" rid="CR54">54</xref>, <xref ref-type="bibr" rid="CR55">55</xref>] can be used, as was used in the depiction of structures in Tables <xref rid="Tab2" ref-type="table">2</xref>, <xref rid="Tab3" ref-type="table">3</xref> and <xref rid="Tab5" ref-type="table">5</xref>.<fig id="Fig3"><label>Fig. 3</label><caption><p>Overview of the candidate selection performed within MAW-Py. The workflow takes the results of top-scoring candidates from all sources and merges the list of top-scoring SMILES from these sources in a single CSV file. These SMILES are then searched for structural similarity. For the pairwise “Candidate Similarity” calculation part, the SMILES of candidate compounds with Tanimoto similarity scores of &lt; 0.85 when compared with other SMILES in the list of top scoring candidates, are discarded. For the rest of the SMILES, a Maximum Common Substructure (MCSS) is calculated for each pair of SMILES in the list. Based on this MCSS calculation, a TSV file is generated which can be used in Cytoscape to visualize the chemical similarity among the candidates. Candidates that belong to a cluster with the most number of candidates from top ranks should be considered as the most probable structures and substructures for the particular feature. For the “Candidate Identity” part, the threshold is &gt;  = 0.99. The candidate identity among SMILES leads to a single structure as the top-ranking candidate for each feature. If there is no identity, or the sources provide different top-ranking structures, a prioritization is performed. In total, there are four sources (SIRIUS, GNPS, HMDB, and MassBank). The scheme is—three sources with the same candidate &gt; two sources with the same candidate &gt; single source (GNPS) &gt; single source (SIRIUS) &gt; single source (MassBank or HMDB). The scheme is defined from the results obtained with known compounds from the standards dataset from diatoms</p></caption><graphic xlink:href="13321_2023_695_Fig3_HTML" id="MO3"/></fig></p>
        </sec>
        <sec id="Sec11">
          <title>Compound classification</title>
          <p id="Par36">Annotation for compound classes can be achieved by a function called classification. CANOPUS is a chemical classification prediction tool, integrated in SIRIUS and annotates a chemical class using the LC-MS<sup>2</sup> spectra. To provide classification to annotations that have an annotation source other than SIRIUS (such as GNPS, HMDB, or MassBank), ClassyFire [<xref ref-type="bibr" rid="CR56">56</xref>] is also integrated into the workflow which takes SMILES as input. Both CANOPUS and ClassyFire are based on the ChemOnt ontology [<xref ref-type="bibr" rid="CR56">56</xref>]. To use ClassyFire in Python, the pybatchclassyfire [<xref ref-type="bibr" rid="CR57">57</xref>] package is used.</p>
        </sec>
      </sec>
    </sec>
    <sec id="Sec12">
      <title>Towards a FAIR and reproducible MAW</title>
      <p id="Par37">Computational workflows like MAW can be described as digital research objects in their own right [<xref ref-type="bibr" rid="CR58">58</xref>]. As a result, the FAIR (Findable, Accessible, Interoperable, and Reusable) principles can be applied to these workflows. For good scientific practice, in MAW, we implemented the recommended FAIR principles. To enable Findability and Accessibility, the source code of MAW has been made available in the GitHub repository zmahnoor14/MAW. In addition, MAW has been versioned through Zenodo-DOIs generated from the GitHub repository. To enable Interoperability and Reusability, separate Docker images are available on DockerHub for MAW-R and MAW-Py. In <italic>Future Developments</italic> in the discussion subsection, we detail additional practices that will be implemented to further support reproducibility and the FAIR principles.</p>
    </sec>
  </sec>
  <sec id="Sec13">
    <title>Results</title>
    <sec id="Sec14">
      <title>Annotations from tandem mass spectrometry data</title>
      <p id="Par38">To evaluate the performance of MAW, we utilized two datasets, a list of standard molecules from the diatoms (further called the standards dataset), and untargeted LC-MS<sup>2</sup> spectra from the bryophytes dataset (further called the bryophytes dataset). Each high-scoring candidate is given MSI-level of confidence [<xref ref-type="bibr" rid="CR12">12</xref>]. A detailed overview of these MSI-levels is presented in Table <xref rid="Tab1" ref-type="table">1</xref>.<table-wrap id="Tab1"><label>Table 1</label><caption><p>MAW operates on MSI-levels [<xref ref-type="bibr" rid="CR12">12</xref>] and categorizes annotations based on the levels</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Annotation level</th><th align="left">MSI-level</th></tr></thead><tbody><tr><td align="left">Standard is given (information provided by the user)</td><td align="left">1</td></tr><tr><td align="left">Candidate present in either spectral databases or in more than one annotation source</td><td align="left">2</td></tr><tr><td align="left">Candidate only suggested by SIRIUS, and/or has a chemical class prediction</td><td align="left">3</td></tr><tr><td align="left">Molecular formula predicted</td><td align="left">4</td></tr><tr><td align="left">Only features measured with MS<sup>2</sup></td><td align="left">5</td></tr></tbody></table></table-wrap></p>
      <p id="Par39">The MSI-levels 1 and 2 represent known compounds that are present in spectral databases (see Table <xref rid="Tab1" ref-type="table">1</xref>). In the case of MSI-level 1, an analytical standard is utilized to confirm their identification. Hence, results from the standards dataset are used to validate the results from MAW. Out of 9 standard metabolites, 6 were correctly identified as the top first candidates with MAW as shown in Table <xref rid="Tab2" ref-type="table">2</xref>. Three particular cases with second or third ranks are: (a) the reduced form of betaine was annotated as the top candidate (trimethylglycine). (b) Cysteinolic acid wasn’t detected in spectral databases, rather 1-chlorobenzotriazole was annotated by both GNPS and MassBank. Only SIRIUS identified cysteinolic acid as the top candidate. According to our current annotation source prioritization scheme (described in Fig. <xref rid="Fig3" ref-type="fig">3</xref>), 1-chlorobenzotriazole from GNPS and MassBank is at the top two ranks, and cysteinolic acid from SIRIUS received an overall rank of 3 in MAW. (c) Valeryl <sc>l</sc>-carnitine was detected as the top candidate by GNPS and MassBank. In contrast, the correct compound isoveleryl-<sc>l</sc>-carnitine was detected as the top candidate from SIRIUS and the second top candidate from GNPS. Some correct matches might have been discarded due to the scoring threshold. For example, butanoyl carnitine search in MassBank had no results because the threshold set for MassBank score is 0.70. The correct annotation for this compound within MassBank had a score of 0.44, which is lower than the set threshold.<table-wrap id="Tab2"><label>Table 2</label><caption><p>List of molecules from the standards dataset and top candidates from MAW</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Precursor mass [m/z]</th><th align="left">Retention time [s]</th><th align="left">Molecular formula</th><th align="left">Molecular structure</th><th align="left">Chemical class</th><th align="left">Name of the compound</th><th align="left">Rank</th></tr></thead><tbody><tr><td align="left">204.123</td><td char="." align="char">148.99</td><td align="left">C<sub>9</sub>H<sub>17</sub>NO<sub>4</sub></td><td align="left"><inline-graphic xlink:href="13321_2023_695_Figa_HTML.gif" id="d32e1123"/></td><td align="left">Fatty acyls</td><td align="left">Acetyl-<sc>l</sc>-Carnitine</td><td align="left">1</td></tr><tr><td align="left">232.154</td><td char="." align="char">102.83</td><td align="left">C<sub>11</sub>H<sub>21</sub>NO<sub>4</sub></td><td align="left"><inline-graphic xlink:href="13321_2023_695_Figb_HTML.gif" id="d32e1157"/></td><td align="left">Fatty acyls</td><td align="left">Butanoyl-<sc>l</sc>-Carnitine</td><td align="left">1</td></tr><tr><td align="left">166.053</td><td char="." align="char">203.69</td><td align="left">C<sub>5</sub>H<sub>11</sub>NO<sub>3</sub>S</td><td align="left"><inline-graphic xlink:href="13321_2023_695_Figc_HTML.gif" id="d32e1192"/></td><td align="left">Carboxylic acids and derivatives</td><td align="left">Methionine Sulfoxide</td><td align="left">1</td></tr><tr><td align="left">130.086</td><td char="." align="char">131.48</td><td align="left">C<sub>6</sub>H<sub>11</sub>NO<sub>2</sub></td><td align="left"><inline-graphic xlink:href="13321_2023_695_Figd_HTML.gif" id="d32e1223"/></td><td align="left">Carboxylic acids and derivatives</td><td align="left">Pipecolic Acid</td><td align="left">1</td></tr><tr><td align="left">246.170</td><td char="." align="char">87.76</td><td align="left">C<sub>12</sub>H<sub>23</sub>NO<sub>4</sub></td><td align="left"><inline-graphic xlink:href="13321_2023_695_Fige_HTML.gif" id="d32e1254"/></td><td align="left">Fatty acyls</td><td align="left">Isovaleryl-<sc>l</sc>-Carnitine</td><td align="left">2</td></tr><tr><td align="left">218.138</td><td char="." align="char">123.34</td><td align="left">C<sub>10</sub>H<sub>20</sub>NO<sub>4</sub> + </td><td align="left"><inline-graphic xlink:href="13321_2023_695_Figf_HTML.gif" id="d32e1289"/></td><td align="left">Fatty acyls</td><td align="left">Propanoyl-<sc>l</sc>-Carnitine</td><td align="left">1</td></tr><tr><td align="left">118.085</td><td char="." align="char">145.57</td><td align="left">C<sub>5</sub>H<sub>11</sub>NO<sub>2</sub></td><td align="left"><inline-graphic xlink:href="13321_2023_695_Figg_HTML.gif" id="d32e1323"/></td><td align="left">Carboxylic acids and derivatives</td><td align="left">Betaine (annotated: Trimethylglycine)</td><td align="left">1</td></tr><tr><td align="left">154.018</td><td char="." align="char">155.28</td><td align="left">C<sub>3</sub>H<sub>9</sub>NO<sub>4</sub>S</td><td align="left"><inline-graphic xlink:href="13321_2023_695_Figh_HTML.gif" id="d32e1355"/></td><td align="left">Organic sulfonic acids and derivatives</td><td align="left">Cysteinolic acid</td><td align="left">3</td></tr><tr><td align="left">203.150</td><td char="." align="char">348.67</td><td align="left">C<sub>8</sub>H<sub>18</sub>N<sub>4</sub>O<sub>2</sub></td><td align="left"><inline-graphic xlink:href="13321_2023_695_Figi_HTML.gif" id="d32e1389"/></td><td align="left">Carboxylic acids and derivatives</td><td align="left"><italic>N</italic>,<italic>N</italic>-dimethyl arginine</td><td align="left">1</td></tr></tbody></table><table-wrap-foot><p>The precursor mass [m/z] and retention time [s] represent the mass of the precursor ions given in mass-to-charge ratio and the median retention time of the precursor ion given in seconds, respectively. The given ranks are from MAW</p></table-wrap-foot></table-wrap></p>
      <p id="Par40">In the bryophyte dataset, 48 features were originally annotated with chemical structures, and 604 features were originally assigned with chemical classes using the MetFamily classifier [<xref ref-type="bibr" rid="CR59">59</xref>]. Using MAW, when choosing the “bio” and COCONUT databases for structural annotation in SIRIUS, we confirmed a total of 8 compounds similar to the original study (see Table <xref rid="Tab3" ref-type="table">3</xref>). Using the COCONUT database in SIRIUS, gave slightly better ranks than the “bio” database. In total, using MAW, 881 out of 933 features were annotated with chemical structures when compared to 48 structurally annotated features of the original study. For 92 features, MAW provided only a compound class and a formula, and for 18 features only a formula. These results are observed with default settings in MAW.<table-wrap id="Tab3"><label>Table 3</label><caption><p>Features that were confirmed using MAW and the original study on the bryophytes data</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Precursor mass [m/z]</th><th align="left">Retention time [s]</th><th align="left">Molecular formula</th><th align="left">Molecular structure</th><th align="left">Chemical class</th><th align="left">Name of the compound</th><th align="left">MSI-level</th><th align="left">Rank</th></tr></thead><tbody><tr><td align="left">425.176</td><td align="left">607.49</td><td align="left">C<sub>28</sub>H<sub>26</sub>O<sub>4</sub></td><td align="left"><inline-graphic xlink:href="13321_2023_695_Figj_HTML.gif" id="d32e1479"/></td><td align="left">Lignans, neolignans and related compounds</td><td align="left">Perrottetin E</td><td align="left">3</td><td align="left">10</td></tr><tr><td align="left">182.081</td><td align="left">47.16</td><td align="left">C<sub>9</sub>H<sub>11</sub>NO<sub>3</sub></td><td align="left"><inline-graphic xlink:href="13321_2023_695_Figk_HTML.gif" id="d32e1513"/></td><td align="left">Carboxylic acids and derivatives</td><td align="left">Tyrosine</td><td align="left">2</td><td align="left">2</td></tr><tr><td align="left">455.155</td><td align="left">220.91</td><td align="left">C<sub>28</sub>H<sub>24</sub>O<sub>6</sub></td><td align="left"><inline-graphic xlink:href="13321_2023_695_Figl_HTML.gif" id="d32e1547"/></td><td align="left">Lignans, neolignans and related compounds</td><td align="left">Marchantin D</td><td align="left">3</td><td align="left">23</td></tr><tr><td align="left">287.056</td><td align="left">318.26</td><td align="left">C<sub>15</sub>H<sub>10</sub>O<sub>6</sub></td><td align="left"><inline-graphic xlink:href="13321_2023_695_Figm_HTML.gif" id="d32e1581"/></td><td align="left">Flavonoids</td><td align="left">Kaempferol</td><td align="left">2</td><td align="left">8</td></tr><tr><td align="left">165.055</td><td align="left">484.08</td><td align="left">C<sub>9</sub>H<sub>8</sub>O<sub>3</sub></td><td align="left"><inline-graphic xlink:href="13321_2023_695_Fign_HTML.gif" id="d32e1615"/></td><td align="left">Cinnamic acids and derivatives</td><td align="left">4-Hydroxycinnamic acid</td><td align="left">2</td><td align="left">6</td></tr><tr><td align="left">291.231</td><td align="left">773.87</td><td align="left">C<sub>18</sub>H<sub>32</sub>O<sub>2</sub></td><td align="left"><inline-graphic xlink:href="13321_2023_695_Figo_HTML.gif" id="d32e1649"/></td><td align="left">Fatty acyls</td><td align="left">Linoleate</td><td align="left">3</td><td align="left">6</td></tr><tr><td align="left">379.283</td><td align="left">702.51</td><td align="left">C<sub>21</sub>H<sub>38</sub>O<sub>4</sub></td><td align="left"><inline-graphic xlink:href="13321_2023_695_Figp_HTML.gif" id="d32e1683"/></td><td align="left">Fatty acyls</td><td align="left">Glyceryl monolinoleate</td><td align="left">3</td><td align="left">4</td></tr><tr><td align="left">255.231</td><td align="left">859.92</td><td align="left">C<sub>16</sub>H<sub>32</sub>O<sub>2</sub></td><td align="left"><inline-graphic xlink:href="13321_2023_695_Figq_HTML.gif" id="d32e1717"/></td><td align="left">Fatty acyls</td><td align="left">Palmitate</td><td align="left">3</td><td align="left">1</td></tr></tbody></table><table-wrap-foot><p>The precursor mass [m/z] and retention time [s] represent the mass of the precursor ions given in mass-to-charge ratio and the median retention time of the precursor ion given in seconds, respectively. The molecular formula and name of the compound are extracted using PubChemPy or SIRIUS, depending on the annotation source. The chemical classes of the compounds are either extracted from ClassyFire or CANOPUS. All the molecular structures are generated via CDK-Depict. The MSI-levels are in accordance with the rules described in Table <xref rid="Tab1" ref-type="table">1</xref>. The given ranks are from MAW, using the database COCONUT in the compound dereplication module</p></table-wrap-foot></table-wrap></p>
      <p id="Par41">To classify MS<sup>2</sup> spectra into compound classes, MAW used CANOPUS and ClassyFire (ChemONT ver 2.1). We found the most prevalent superclasses to be Lipids and lipid-like molecules, Organic acids and derivatives, Benzenoids, and Phenylpropanoids and polyketides. The original study found the superclasses Lipids and lipid-like molecules, Phenylpropanoids and polyketides, Lignans, neolignans and related compounds, and Organic oxygen compounds to be the most diverse but the authors used a different classifier. Figure <xref rid="Fig4" ref-type="fig">4</xref> shows a sunburst plot providing an overview of the annotated superclasses, classes, and subclasses identified in MAW.<fig id="Fig4"><label>Fig. 4</label><caption><p>The sunburst plot showing the chemical diversity of the classified top-ranking annotations. Each shown compound class is represented by the counts of classified compounds belonging to the respective class. In the center, the most general superclasses are shown. The further to the outside, the more specific compound classes are shown. MAW uses CANOPUS and ClassyFire to annotate chemical classes to features. MAW found the subclasses Lipids (33.92%), Organic acids (17.02%), Benzenoids (13.94%), and Phenylpropanoid and polyketides (11.34%) to be most abundant</p></caption><graphic xlink:href="13321_2023_695_Fig4_HTML" id="MO4"/></fig></p>
    </sec>
    <sec id="Sec15">
      <title>Comparison of MAW with integrated annotation tools using the standards dataset</title>
      <p id="Par42">We evaluated MAW’s performance with regard to the integrated annotation tools SIRIUS, and Spectra (GNPS, Massbank, and HMDB) using the standards dataset. MAW identified 8 out of 9 compounds correctly except for Betaine (where the annotated compound is the reduced form of Betaine). Isovaleryl carnitine ranked second and cysteinolic acid ranked third, as shown in Table <xref rid="Tab2" ref-type="table">2</xref>. In the case of using SIRIUS without spectral databases, fatty acyls (except for Butanoyl Carnitine) were annotated as isomers or similar structures instead of the actual compounds. SIRIUS correctly annotated methionine sulphoxide, <italic>N</italic>,<italic>N</italic>-dimethylarginine, and carboxylic acid and its derivatives. GNPS correctly annotated all compounds except for betaine and cysteinolic acid. MassBank and HMDB showed the lowest performances. MassBank only annotated <italic>N</italic>,<italic>N</italic>-dimethyl arginine, and acetylcarnitine with a score threshold of 0.70, and HMDB failed to annotate any correct compound with the same score threshold. We also performed annotations for standards with MetFrag CLI version 2.5.0 and PubChem [<xref ref-type="bibr" rid="CR60">60</xref>] as the search database. Table <xref rid="Tab4" ref-type="table">4</xref> gives an overview of the annotations obtained by MAW, Spectra, SIRIUS, and MetFrag.<table-wrap id="Tab4"><label>Table 4</label><caption><p>Overview on the annotated features in MAW, SIRIUS, Spectra, and MetFrag, using the standards dataset, which had in total 37 features (and 9 standards)</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Annotation level</th><th align="left">MAW</th><th align="left">Spectra (GNPS, HMDB, MassBank)</th><th align="left">SIRIUS</th><th align="left">MetFrag<break/>(PubChem)</th></tr></thead><tbody><tr><td align="left">Total structural annotations</td><td align="left">100% (37)</td><td align="left"><p>75.7% (28)</p><p>(within MAW)</p></td><td align="left">70.2% (26) (within MAW)</td><td align="left">32.4%(12)</td></tr><tr><td align="left">Chemical class prediction</td><td align="left">97.3% (36)</td><td align="left">–</td><td align="left">100% (37)</td><td align="left">–</td></tr><tr><td align="left">Formula prediction</td><td align="left">100% (37)</td><td align="left">–</td><td align="left">100% (37)</td><td align="left">–</td></tr></tbody></table><table-wrap-foot><p>Total structural annotations refer to the percentage of annotated compounds that are the same in MAW, Spectra, and SIRIUS. Thus, 75.7% of the annotation in MAW were observed in Spectra and 70.2% of the annotations were observed in SIRIUS while some of the features had annotation sources from both Spectra and SIRIUS. We additionally ran MetFrag and among the top 100 candidates from each feature, 12 features had the same correct annotation. For the chemical classification, MAW annotated 97.3% of the features with a chemical class and all features had a molecular formula prediction. SIRIUS identified the chemical class (with CANOPUS) and molecular formula for all features, while Spectra and MetFrag did not provide these functionalities</p></table-wrap-foot></table-wrap></p>
    </sec>
    <sec id="Sec16">
      <title>Case study with the bryophytes dataset</title>
      <sec id="Sec17">
        <title>Marchantin compounds with the COCONUT database</title>
        <p id="Par43">MAW was used to annotate chemical structures from the spectra obtained from nine different species of the bryophyte dataset. As the species <italic>Marchantia polymorpha</italic> (group Marchantiophyta) is known to produce very specific cyclic bis-bibenzyls such as Marchantins and semi-cyclic Perrottetins which provide a challenge for computational annotation tools due to their cyclic structures, these compounds were chosen to evaluate the performance of MAW. In the ChemONT ontology, these compounds are represented by the compound superclasses Lignans, neolignans and related compounds or Stilbenes [<xref ref-type="bibr" rid="CR61">61</xref>]. In the original study, three compounds were annotated as Marchantin compounds (Marchantin G, K, D). MAW annotated 4 Marchantin compounds and 1 Perrottetin compound within the top 25 candidates. Table <xref rid="Tab5" ref-type="table">5</xref> gives an overview of the annotated cyclic bis-bibenzyls in the <italic>Marchantia polymorpha</italic> samples.<table-wrap id="Tab5"><label>Table 5</label><caption><p>List of annotated cyclic bis-bibenzyls using MAW</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Precursor mass [m/z]</th><th align="left">Retention time [s]</th><th align="left">Molecular formula</th><th align="left">Molecular structure</th><th align="left">Name of the compound</th><th align="left">Rank</th></tr></thead><tbody><tr><td align="left">425.176</td><td char="." align="char">607.49</td><td align="left">C<sub>28</sub>H<sub>26</sub>O<sub>4</sub></td><td align="left"><inline-graphic xlink:href="13321_2023_695_Figr_HTML.gif" id="d32e1942"/></td><td align="left">Perrottetin E</td><td align="left">10</td></tr><tr><td align="left">439.155</td><td char="." align="char">585.88</td><td align="left">C<sub>28</sub>H<sub>24</sub>O<sub>5</sub></td><td align="left"><inline-graphic xlink:href="13321_2023_695_Figs_HTML.gif" id="d32e1970"/></td><td align="left">Marchantin H</td><td align="left">10</td></tr><tr><td align="left">453.167</td><td char="." align="char">595.92</td><td align="left">C<sub>29</sub>H<sub>26</sub>O<sub>5</sub></td><td align="left"><inline-graphic xlink:href="13321_2023_695_Figt_HTML.gif" id="d32e1998"/></td><td align="left">Marchantin M</td><td align="left">2</td></tr><tr><td align="left">455.155</td><td char="." align="char">220.91</td><td align="left">C<sub>28</sub>H<sub>24</sub>O<sub>6</sub></td><td align="left"><inline-graphic xlink:href="13321_2023_695_Figu_HTML.gif" id="d32e2026"/></td><td align="left">Marchantin D</td><td align="left">23</td></tr><tr><td align="left">471.150</td><td char="." align="char">233.23</td><td align="left">C<sub>28</sub>H<sub>24</sub>O<sub>7</sub></td><td align="left"><inline-graphic xlink:href="13321_2023_695_Figv_HTML.gif" id="d32e2054"/></td><td align="left">Marchantin F</td><td align="left">8</td></tr></tbody></table><table-wrap-foot><p>The precursor mass [m/z] and retention time [s] represent the mass of the precursor ions given in mass-to-charge ratio and the median retention time of the precursor ion given in seconds, respectively. The molecular formula and name of the compound are extracted using SIRIUS. The chemical classes of the compounds are extracted from CANOPUS. All the molecular structures are generated via CDK-Depict. The given ranks are from MAW, using the database COCONUT in the compound dereplication module</p></table-wrap-foot></table-wrap></p>
      </sec>
      <sec id="Sec18">
        <title>Flavonoid “Nicotiflorin” as a highly probable annotation with spectral databases</title>
        <p id="Par44">Here, we describe the annotation and evaluation of the flavonoid Nicotiflorin using MAW. This compound was annotated by MAW in all of the bryophyte samples. The feature ID is file_1M287R318ID319 where File_1 is the file ID, M287 represents the precursor mass [m/z] and R318 represents the median retention time [s]. ID is an individual number assigned to the features in File_1. For ease of understanding, we will refer to this feature as M287R318. The detailed features are provided in Table <xref rid="Tab6" ref-type="table">6</xref>.<table-wrap id="Tab6"><label>Table 6</label><caption><p>Features and annotations for feature ID M287R318 with MSI-levels</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Feature</th><th align="left">Annotation</th><th align="left">MSI-level</th></tr></thead><tbody><tr><td align="left">Precursor mass [m/z]</td><td align="left">287.06</td><td align="left">5</td></tr><tr><td align="left">Retention time [s]</td><td align="left">318.26</td><td align="left">5</td></tr><tr><td align="left">Polarity</td><td align="left">negative</td><td align="left">5</td></tr><tr><td align="left">Molecular formula</td><td align="left">C<sub>27</sub>H<sub>30</sub>O<sub>15</sub></td><td align="left">4</td></tr><tr><td align="left">Chemical class</td><td align="left">Flavonoids (CHEMONTID:0,000,334)</td><td align="left">3</td></tr><tr><td align="left">Candidate SMILES</td><td align="left">c(c5)(O)cc(c(c51)C(C(O[C@H](O3)[C@@H]([C@H]([C@@H]([C@H]3CO[C@@H]([C@@H]4O)O[C@H]([C@@H]([C@H]4O)O)C)O)O)O) = C(c(c2)ccc(O)c2)O1) = O)O</td><td align="left">2</td></tr><tr><td align="left">Sources</td><td align="left">GNPS, HMDB, MassBank</td><td align="left">2</td></tr></tbody></table><table-wrap-foot><p>The measured precursor ion for Nicotiflorin has a mass [m/z] of 287.056. The retention time is given in seconds. This precursor ion was measured in negative mode during LC–MS. The molecular formula is extracted from PubChemPy and the class is annotated using ClassyFire. SMILES represent the structure of Nicotiflorin which was the same structure annotated with GNPS, HMDB, and MassBank</p></table-wrap-foot></table-wrap></p>
        <p id="Par45">MAW provides annotation results in two ways: (1) to generate a chemical similarity network between all top-scoring candidates, and (2) to select only one highly probable candidate for each feature.</p>
        <p id="Par46">For (1), MAW generates a TSV file, for each feature, that contains the nodes as candidates and Tanimoto similarity scores as edges. Figure <xref rid="Fig5" ref-type="fig">5</xref> shows the chemical similarity network of candidates for M287R318 created with Cytoscape, importing the TSV file as a network in Cytoscape. The TSV file defines the start and end nodes (candidates) and their structural similarity represented by the Tanimoto similarity score. This visual representation helps in candidate selection by choosing the cluster with the highest number of annotation sources (GNPS, MassBank, HMDB, SIRIUS) and the highest-ranking candidate from these sources.<fig id="Fig5"><label>Fig. 5</label><caption><p>Chemical similarity network depicting the structural similarities among the top candidates from GNPS, MassBank, and HMDB (no annotations from SIRIUS are recorded for this feature). The nodes represent a chemical structure (as candidates). The edges represent the Tanimoto similarity score (tn) between the two nodes. The asterisk (*) shows the top-ranking candidate from each source that is present in the network. The network with the most nodes is zoomed in to visualize that G_15 (15th rank candidate from GNPS), H_12 (12th rank candidate from HMDB), M_2, and M_13 (2nd and 13th rank candidates from MassBank) have a structure with a Tanimoto similarity score equal to 1 and hence it is most probable to consider this structure to be annotated to the feature M287R318</p></caption><graphic xlink:href="13321_2023_695_Fig5_HTML" id="MO5"/></fig></p>
        <p id="Par47">For (2), the chemical similarity network selects the most probable cluster which in this case is presented in Fig. <xref rid="Fig5" ref-type="fig">5</xref>. The cluster represents three sources (spectral databases). This gives a higher probability to the structure in that cluster and can be assigned as the final candidate, in this case, Nicotiflorin. Using the package Spectra, a mirror image of MS<sup>2</sup> spectra, both from the query and the top candidate from either of the spectral databases, can be created.</p>
      </sec>
    </sec>
  </sec>
  <sec id="Sec19">
    <title>Discussion</title>
    <p id="Par48">Our Metabolite Annotation Workflow (MAW) facilitates and automates the complex and often cumbersome annotation of untargeted tandem mass spectrometry data in large metabolomics studies. To this end, MAW also improves candidate selection by integrating spectral and compound libraries and databases with computational annotation tools such as SIRIUS. It is also among the first tools that provide whole metabolome annotation and assess the chemical diversity of the biological samples.</p>
    <sec id="Sec20">
      <title>Evaluation of MAW</title>
      <p id="Par49">Many software suites and R packages have been developed in the last years to solve the metabolomics annotation challenge, but it still remains the “bottleneck” in metabolomics due to an “infinite chemical dark space” [<xref ref-type="bibr" rid="CR62">62</xref>]. The Metabolome Annotation Workflow (MAW) is specifically developed to aid the annotation process by automation of candidate selection within this space.</p>
      <p id="Par50">Computational tools such as MetFrag, SIRIUS (CSI:FingerID), and CFM-ID (Competitive Fragmentation Modeling for Metabolite Identification), generate in silico spectra of chemical structures from different compound databases based on their specified algorithms. This in silico spectral matching provides an annotation of up to MSI-level 3 [<xref ref-type="bibr" rid="CR12">12</xref>], which refers to a tentative structure, not yet confirmed with a spectral library match or a standard (see Table <xref rid="Tab1" ref-type="table">1</xref>). To provide more confidence in the annotation, the input spectra should be screened against actual experimental spectra. For this purpose, some tools and R packages have been developed such as Spectra, matchms [<xref ref-type="bibr" rid="CR63">63</xref>], MS2Query (specifically for Analogues), or GNPS MASST, which use modified cosine similarity score or deep learning-based scores to match the MS<sup>2</sup> query spectra against spectral databases. However, in general, there is a huge mismatch between submitted experimental spectra to spectral databases and chemical structures present in compound databases. This leads to a low number of annotated features. As MAW combines both in silico generated spectral matching and experimental spectral matching to increase the number of confident annotated metabolites, the percentage of annotated metabolites with MAW is higher than with using spectral or compound databases alone (see Table <xref rid="Tab4" ref-type="table">4</xref>).</p>
      <p id="Par51">Another advantage of MAW is the automated candidate selection which allows one to choose the most optimal results. Generally, annotation tools provide a list of ranked molecules based on the associated scoring schemes and the user has to manually go through these candidates or just take the first candidate. This requires a lot of time and effort with big datasets. MAW not only provides these ranked lists but also provides a concise list of highly probable candidates from different databases automatically. The structural similarity between these candidates can be visualized in a chemical similarity network. A function to get only one candidate per feature is also provided. All the intermediate results are kept in an efficiently designed directory system, so the user can always refer back to the origin of the candidate. This way provenance records are stored for a given dataset, as the workflow is executed.</p>
      <p id="Par52">A major component behind the candidate selection is the scoring scheme followed throughout the workflow. We used the scoring schemes provided by Spectra and SIRIUS (CSI:FingerID), and the Tanimoto similarity score for the structural matching. Spectra uses the most common spectral matching metric which is the cosine similarity score that calculates how much overlap is observed between two spectra [<xref ref-type="bibr" rid="CR64">64</xref>]. For HMDB and MassBank, this metric is used unaltered. Some good candidates are missed due to lower scores with high spectral matching as in the case of butanoyl carnitine and MassBank. For GNPS, this similarity score is altered as described in the method section and the spectral matching with GNPS gives better results as compared to the other two spectral databases. We conclude that spectral matching needs better metrics. The possible cases where cosine similarity metrics fail could be due to different fragmentation patterns under different experimental setups, or if there is a shift in the fragmentation peaks, the overlap between matching spectra would also be shifted [<xref ref-type="bibr" rid="CR65">65</xref>]. To deal with this problem in a better way, we also consider the individual fragment mass [m/z] and intensity overlap, also counting in the number of matching peaks. All of these MAW-defined metrics should at least have a 0.5 matching score in addition to a high cosine similarity score. In this way, we could lower the possibility of getting any false positives but could end up missing candidates with low cosine similarity scores as false negative candidates. This could be solved by integrating Spec2Vec into MAW. Spec2Vec is a deep learning-based spectral matching score and has shown better spectral matching results as compared to simple or modified cosine similarity scores [<xref ref-type="bibr" rid="CR65">65</xref>]. In addition, the public spectral databases are not completely standardized and hence can only annotate spectra present in the databases such as in the case of betaine, where reduced state trimethylglycine is annotated.</p>
      <p id="Par53">To further reduce the false negative results from spectral database screening is to use compound databases to compensate for all the known compounds which were not assigned a candidate from spectral databases. Here, MetFrag would be a good option when using a more concise library of molecules. Larger databases such as PubChem can lead to a larger list of candidates with the actual structure being at a lower rank (e.g.: top 100th candidate), such as seen with candidates from the standards dataset, explained in Table <xref rid="Tab4" ref-type="table">4</xref>. For the first version of MAW, we have only integrated SIRIUS (CSI:FingerID) for compound databases, a state-of-the-art annotation tool [<xref ref-type="bibr" rid="CR66">66</xref>] into MAW. For features with no structural annotations, SIRIUS and CANOPUS provide a molecular formula and a chemical class. Thresholds for ranking SIRIUS candidates were considered, but SIRIUS CLI doesn't provide a deterministic probability score, as a result, providing a threshold would differ from case to case, and hence the idea was discarded. In addition, the annotation of lipid classes using SIRIUS can lead to false positives due to the complex nature of lipids, and many lipid isomers co-elute in mass spectrometry, making it a challenge to annotate lipids using in silico libraries [<xref ref-type="bibr" rid="CR67">67</xref>].</p>
      <p id="Par54">The annotation result evaluation for MAW has been accomplished via the standards dataset and the LC-MS<sup>2</sup> data from the bryophytes datasets. MAW performed better for the standards dataset, keeping the actual compounds within the top three candidates. These standards are usually acquired with the LC-MS<sup>2</sup> technique and have been submitted to the spectral databases. As a result, the experimental spectral matching led to the true positive as the top first annotation in most cases. For the annotation results from the bryophytes dataset, we could only annotate 8 compounds that were the same as in the original study. All the annotations from the original study were performed manually and most of the annotations were not within the top-ranked candidates. The main objective of the study was to identify the chemical classes and the annotation of natural products from different bryophytes species. Despite the fact that bryophytic organisms received much attention regarding their unique diversity of natural products, many features remain without an annotated chemical structure. Additionally, some classes of natural products from these organisms are experimentally challenging to acquire with tandem mass spectrometry [<xref ref-type="bibr" rid="CR68">68</xref>]. Using databases specifically focusing on natural products like COCONUT and GNPS can increase the probability of finding the compound of interest within the top-ranked candidates. We observed that using the “bio” database from SIRIUS, the actual compounds were ranked lower as compared to using the COCONUT database. Hence, it is important to have an objective for any annotation experiment, whether it is to perform targeted LC–MS to confirm the presence of known compounds, or it is to annotate novel natural products. The usage of different databases can lead to different results for less-studied species and compounds. As seen during the annotation for the chemical compounds from the Marchantin group, these compounds were ranked low due to their macrocyclic structures; the spectra for such structures are already challenging to obtain due to complex fragmentation patterns [<xref ref-type="bibr" rid="CR69">69</xref>]. In such cases, it helps to have a pre-defined suspect list even in the case of an untargeted study.</p>
      <p id="Par55">The implemented functionalities enable MAW to provide an overview of the chemical diversity present in any dataset. MAW also can generate graphs to visualize the chemical similarities in a network or the chemical classification. All the steps in MAW are customized specifically for the annotation step of the metabolomics workflow. MAW also complies with the FAIR guidelines, making it Findable and Accessible on GitHub as an open-source code repository, and access to all the datasets, and libraries used for the development of MAW is provided via Zenodo. MAW is made interoperable as it is executed inside docker containers on any system. It also follows the Reusability principle by tracking all the intermediate results and collecting the provenance of the workflow execution.</p>
    </sec>
    <sec id="Sec21">
      <title>Future developments</title>
      <p id="Par56">To enhance spectral database matching, we recommend MAW to be integrated with Spec2Vec and matchms, along with MS2Query for providing structurally similar analogs. To avoid wrong predictions with candidates that don’t have a natural product like structure, a functionality that removes any rare natural product elements can be added. To enhance the automated candidate selection, we are also aiming to add MetFrag with PubChemLite and COCONUT. We are also planning for the support of a wider database selection using SIRIUS version 5. The spectral similarity-based classical molecular network (MN) is another important aspect for the annotation of metabolites, among single-condition datasets or between two conditions, and linking these MNs to pathway annotations. To further support the FAIR principles, our idea is to extend the specification of the workflow in the Common Workflow Language (CWL) [<xref ref-type="bibr" rid="CR70">70</xref>], gathering detailed provenance of workflow executions, and adding rich metadata about the workflow, its components, and the data used and produced by it.</p>
    </sec>
  </sec>
  <sec id="Sec22">
    <title>Conclusion</title>
    <p id="Par57">Structural annotation remains a complicated and time-consuming process. MAW is an automated metabolite annotation workflow. Using both spectral and compound databases, MAW helps to annotate the query spectral data to a corresponding experimental tandem mass spectra or to an in silico generated corresponding spectra in case there are no associated spectra present in spectral databases. Results of annotated metabolites from MAW can be further functionally mapped to metabolic pathways to aid in the structure prediction of compounds and can be integrated with other omics data to understand the biological and ecological significance of these metabolites. This could support the chemical characterization in diverse fields such as biomarker discovery in clinical metabolomics, and defining the chemical diversity of ecosystems, leading to the identification of novel natural products.</p>
  </sec>
</body>
<back>
  <glossary>
    <title>Abbreviations</title>
    <def-list>
      <def-item>
        <term>CFM-ID</term>
        <def>
          <p id="Par2">Competitive Fragmentation Modeling for Metabolite Identification</p>
        </def>
      </def-item>
      <def-item>
        <term>CLI</term>
        <def>
          <p id="Par3">Command Line interface</p>
        </def>
      </def-item>
      <def-item>
        <term>COCONUT</term>
        <def>
          <p id="Par4">COlleCtion of Open Natural ProdUcTs</p>
        </def>
      </def-item>
      <def-item>
        <term>CWL</term>
        <def>
          <p id="Par5">Common Workflow Language</p>
        </def>
      </def-item>
      <def-item>
        <term>DDA</term>
        <def>
          <p id="Par6">Data Dependent Acquisition</p>
        </def>
      </def-item>
      <def-item>
        <term>FAIR</term>
        <def>
          <p id="Par7">Findable, Accessible, Interoperable, Reusable</p>
        </def>
      </def-item>
      <def-item>
        <term>GNPS</term>
        <def>
          <p id="Par8">Global Natural Products Social Molecular Networking</p>
        </def>
      </def-item>
      <def-item>
        <term>HMDB</term>
        <def>
          <p id="Par9">Human Metabolome Database</p>
        </def>
      </def-item>
      <def-item>
        <term>LC–MS</term>
        <def>
          <p id="Par10">Liquid Chromatography Mass Spectrometry</p>
        </def>
      </def-item>
      <def-item>
        <term>LC-MS<sup>2</sup></term>
        <def>
          <p id="Par11">Liquid Chromatography-Tandem Mass Spectrometry</p>
        </def>
      </def-item>
      <def-item>
        <term>MAW</term>
        <def>
          <p id="Par12">Metabolome Annotation Workflow</p>
        </def>
      </def-item>
      <def-item>
        <term>MAW-Py</term>
        <def>
          <p id="Par13">Metabolome Annotation Workflow-Python Segment</p>
        </def>
      </def-item>
      <def-item>
        <term>MAW-R</term>
        <def>
          <p id="Par14">Metabolome Annotation Workflow-R Segment</p>
        </def>
      </def-item>
      <def-item>
        <term>MCSS</term>
        <def>
          <p id="Par15">Maximum Common Substructure</p>
        </def>
      </def-item>
      <def-item>
        <term>MSI</term>
        <def>
          <p id="Par16">Metabolomics Standards Initiative</p>
        </def>
      </def-item>
      <def-item>
        <term>SMILES</term>
        <def>
          <p id="Par17">Simplified Molecular Input Line Entry Specification</p>
        </def>
      </def-item>
      <def-item>
        <term>W4M</term>
        <def>
          <p id="Par18">Workflow4Metabolomics</p>
        </def>
      </def-item>
    </def-list>
  </glossary>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher's Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <ack>
    <title>Acknowledgements</title>
    <p>The authors would like to acknowledge: Georg Pohnert (ORCID: 0000-0003-2351-6336) Lab (Friedrich Schiller University Jena) for providing the data for the standards dataset, especially Vera Nikitashina (Friedrich Schiller University Jena). Ivo Große Lab (Martin-Luther-Universität Halle-Wittenberg) for initiating the idea for candidate selection. Kohulan Rajan (ORCID: 0000-0003-1066-7792) (Friedrich Schiller University Jena) for the MAW logo, cleaning code, and helping with setting up the GitHub repository. Adelene Lai (ORCID: 0000-0002-2985-6473) (University of Luxembourg, and Friedrich Schiller University Jena) and Jonas Schaub (ORCID: 0000-0003-1554-6666) (Friedrich Schiller University Jena) for ideas on candidate selection function.</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Author contributions</title>
    <p>MZ developed Metabolome Annotation Workflow (MAW), wrote the manuscript, made MAW and relevant data findable, accessible, and reproducible, and modified Docker images. LG conceptualized and made MAW FAIR, made Docker images, parallelized R functions, and revised the draft. CS supervised the project, obtained the funds, and revised the draft. MS conceptualized the project, supervised, and revised the draft. KP provided the bryophytes dataset, supervised the project, and revised the draft. All authors reviewed the manuscript. All authors read and approved the final manuscript.</p>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>Open Access funding enabled and organized by Projekt DEAL. This work was funded by the Deutsche Forschungsgemeinschaft (DFG, German Research Foundation) under Germany's Excellence Strategy - EXC 2051 - Project-ID 390713860, and by the DFG - Project-ID 239748522–SFB 1127.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and materials</title>
    <p>MAW: MAW can be installed with all its functions and dependencies via two docker images submitted to DockerHub [<xref ref-type="bibr" rid="CR37">37</xref>, <xref ref-type="bibr" rid="CR38">38</xref>]; Detailed Tutorial for MAW is available on GitHub Wiki, with associated Jupyter Notebooks present on GitHub [<xref ref-type="bibr" rid="CR36">36</xref>]; The Source Code is available on GitHub and MAW 1.0.0 version is available on Zenodo with the <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.5281/zenodo.7148450">https://doi.org/10.5281/zenodo.7148450</ext-link>. An updated version (MAW 1.0.1) is present with the <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.5281/zenodo.7215518">https://doi.org/10.5281/zenodo.7215518</ext-link>; All the scripts used to run MAW on diatom and bryophyte datasets and scripts used to download databases are available on MAW-Bechmark repository (<ext-link ext-link-type="uri" xlink:href="https://github.com/zmahnoor14/MAW-Benchmark">https://github.com/zmahnoor14/MAW-Benchmark</ext-link>) [<xref ref-type="bibr" rid="CR71">71</xref>]. MS Datasets: Standards: The LC-MS<sup>2</sup> standards data generated by Vera Nikitashina are present on the MetaboLights repository under accession MTBLS3177(still under curation). These standards are also uploaded to Zenodo as mzML files with <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.5281/zenodo.7106205">https://doi.org/10.5281/zenodo.7106205</ext-link>, which were used in MAW; Bryophytes: The bryophytes dataset is also available on MetaboLights under accession MTBLS709. The MS<sup>2</sup> data file used in this study is available on Zenodo with <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.5281/zenodo.7107096">https://doi.org/10.5281/zenodo.7107096</ext-link>; Spectral Databases as Rdata: The currently available versions of the GNPS, HMDB, and MassBank are present on Zenodo with <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.5281/zenodo.6528931">https://doi.org/10.5281/zenodo.6528931</ext-link>. Programming language: R 4.2.0 and Python 3.10.7. Requirements: Docker.</p>
  </notes>
  <notes>
    <title>Declarations</title>
    <notes id="FPar1" notes-type="COI-statement">
      <title>Competing interests</title>
      <p id="Par58">The authors have no competing interests to declare.</p>
    </notes>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pinu</surname>
            <given-names>FR</given-names>
          </name>
          <name>
            <surname>Goldansaz</surname>
            <given-names>SA</given-names>
          </name>
          <name>
            <surname>Jaine</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Translational metabolomics: current challenges and future opportunities</article-title>
        <source>Metabolites</source>
        <year>2019</year>
        <volume>9</volume>
        <fpage>108</fpage>
        <pub-id pub-id-type="doi">10.3390/metabo9060108</pub-id>
        <?supplied-pmid 31174372?>
        <pub-id pub-id-type="pmid">31174372</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Creek</surname>
            <given-names>DJ</given-names>
          </name>
          <name>
            <surname>Dunn</surname>
            <given-names>WB</given-names>
          </name>
          <name>
            <surname>Fiehn</surname>
            <given-names>O</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Metabolite identification: are you sure? And how do your peers gauge your confidence?</article-title>
        <source>Metabolomics</source>
        <year>2014</year>
        <volume>10</volume>
        <fpage>350</fpage>
        <lpage>353</lpage>
        <pub-id pub-id-type="doi">10.1007/s11306-014-0656-8</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Demarque</surname>
            <given-names>DP</given-names>
          </name>
          <name>
            <surname>Dusi</surname>
            <given-names>RG</given-names>
          </name>
          <name>
            <surname>de Sousa</surname>
            <given-names>FDM</given-names>
          </name>
          <name>
            <surname>Grossi</surname>
            <given-names>SM</given-names>
          </name>
          <name>
            <surname>Silvério</surname>
            <given-names>MRS</given-names>
          </name>
          <name>
            <surname>Lopes</surname>
            <given-names>NP</given-names>
          </name>
          <name>
            <surname>Espindola</surname>
            <given-names>LS</given-names>
          </name>
        </person-group>
        <article-title>Mass spectrometry-based metabolomics approach in the isolation of bioactive natural products</article-title>
        <source>Sci Rep</source>
        <year>2020</year>
        <volume>10</volume>
        <fpage>1051</fpage>
        <pub-id pub-id-type="doi">10.1038/s41598-020-58046-y</pub-id>
        <?supplied-pmid 31974423?>
        <pub-id pub-id-type="pmid">31974423</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Alseekh</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Aharoni</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Brotman</surname>
            <given-names>Y</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Mass spectrometry-based metabolomics: a guide for annotation, quantification and best reporting practices</article-title>
        <source>Nat Methods</source>
        <year>2021</year>
        <volume>18</volume>
        <fpage>747</fpage>
        <lpage>756</lpage>
        <pub-id pub-id-type="doi">10.1038/s41592-021-01197-1</pub-id>
        <?supplied-pmid 34239102?>
        <pub-id pub-id-type="pmid">34239102</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schrimpe-Rutledge</surname>
            <given-names>AC</given-names>
          </name>
          <name>
            <surname>Codreanu</surname>
            <given-names>SG</given-names>
          </name>
          <name>
            <surname>Sherrod</surname>
            <given-names>SD</given-names>
          </name>
          <name>
            <surname>McLean</surname>
            <given-names>JA</given-names>
          </name>
        </person-group>
        <article-title>Untargeted metabolomics strategies—challenges and emerging directions</article-title>
        <source>J Am Soc Mass Spectrom</source>
        <year>2016</year>
        <volume>27</volume>
        <fpage>1897</fpage>
        <lpage>1905</lpage>
        <pub-id pub-id-type="doi">10.1007/s13361-016-1469-y</pub-id>
        <?supplied-pmid 27624161?>
        <pub-id pub-id-type="pmid">27624161</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>Q</given-names>
          </name>
          <name>
            <surname>Brown</surname>
            <given-names>JB</given-names>
          </name>
          <name>
            <surname>Huang</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Bickel</surname>
            <given-names>PJ</given-names>
          </name>
        </person-group>
        <article-title>Measuring reproducibility of high-throughput experiments</article-title>
        <source>Ann Appl Stat</source>
        <year>2011</year>
        <volume>5</volume>
        <fpage>1752</fpage>
        <lpage>1779</lpage>
        <pub-id pub-id-type="doi">10.1214/11-AOAS466</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Martens</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Chambers</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Sturm</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>mzML—a community standard for mass spectrometry data</article-title>
        <source>Mol Cell Proteomics</source>
        <year>2011</year>
        <volume>10</volume>
        <issue>R110</issue>
        <fpage>000133</fpage>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Castillo</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Gopalacharyulu</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Yetukuri</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Orešič</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Algorithms and tools for the preprocessing of LC–MS metabolomics data</article-title>
        <source>Chemom Intell Lab Syst</source>
        <year>2011</year>
        <volume>108</volume>
        <fpage>23</fpage>
        <lpage>32</lpage>
        <pub-id pub-id-type="doi">10.1016/j.chemolab.2011.03.010</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <mixed-citation publication-type="other">Uthe H, van Dam NM, Hervé MR, Sorokina M, Peters K, Weinhold A (2021) A practical guide to implementing metabolomics in plant ecology and biodiversity research. In: Pétriacq P, Bouchereau A (eds) Adv. Bot. Res. Academic Press, pp 163–203</mixed-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Niessen</surname>
            <given-names>WMA</given-names>
          </name>
        </person-group>
        <person-group person-group-type="editor">
          <name>
            <surname>Lindon</surname>
            <given-names>JC</given-names>
          </name>
          <name>
            <surname>Tranter</surname>
            <given-names>GE</given-names>
          </name>
          <name>
            <surname>Koppenaal</surname>
            <given-names>DW</given-names>
          </name>
        </person-group>
        <article-title>MS–MS and MSn☆</article-title>
        <source>Encycl Spectrosc Spectrom</source>
        <year>2017</year>
        <edition>3</edition>
        <publisher-loc>Oxford</publisher-loc>
        <publisher-name>Academic Press</publisher-name>
        <fpage>936</fpage>
        <lpage>941</lpage>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sumner</surname>
            <given-names>LW</given-names>
          </name>
          <name>
            <surname>Amberg</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Barrett</surname>
            <given-names>D</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Proposed minimum reporting standards for chemical analysis</article-title>
        <source>Metabolomics</source>
        <year>2007</year>
        <volume>3</volume>
        <fpage>211</fpage>
        <lpage>221</lpage>
        <pub-id pub-id-type="doi">10.1007/s11306-007-0082-2</pub-id>
        <?supplied-pmid 24039616?>
        <pub-id pub-id-type="pmid">24039616</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schymanski</surname>
            <given-names>EL</given-names>
          </name>
          <name>
            <surname>Jeon</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Gulde</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Fenner</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Ruff</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Singer</surname>
            <given-names>HP</given-names>
          </name>
          <name>
            <surname>Hollender</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Identifying small molecules via high resolution mass spectrometry: communicating confidence</article-title>
        <source>Environ Sci Technol</source>
        <year>2014</year>
        <volume>48</volume>
        <fpage>2097</fpage>
        <lpage>2098</lpage>
        <pub-id pub-id-type="doi">10.1021/es5002105</pub-id>
        <?supplied-pmid 24476540?>
        <pub-id pub-id-type="pmid">24476540</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Verhoeven</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Giera</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Mayboroda</surname>
            <given-names>OA</given-names>
          </name>
        </person-group>
        <article-title>Scientific workflow managers in metabolomics: an overview</article-title>
        <source>Analyst</source>
        <year>2020</year>
        <volume>145</volume>
        <fpage>3801</fpage>
        <lpage>3808</lpage>
        <pub-id pub-id-type="doi">10.1039/D0AN00272K</pub-id>
        <?supplied-pmid 32374793?>
        <pub-id pub-id-type="pmid">32374793</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dührkop</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Fleischauer</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Ludwig</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Aksenov</surname>
            <given-names>AA</given-names>
          </name>
          <name>
            <surname>Melnik</surname>
            <given-names>AV</given-names>
          </name>
          <name>
            <surname>Meusel</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Dorrestein</surname>
            <given-names>PC</given-names>
          </name>
          <name>
            <surname>Rousu</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Böcker</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>SIRIUS 4: a rapid tool for turning tandem mass spectra into metabolite structure information</article-title>
        <source>Nat Methods</source>
        <year>2019</year>
        <volume>16</volume>
        <fpage>299</fpage>
        <lpage>302</lpage>
        <pub-id pub-id-type="doi">10.1038/s41592-019-0344-8</pub-id>
        <?supplied-pmid 30886413?>
        <pub-id pub-id-type="pmid">30886413</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ruttkies</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Schymanski</surname>
            <given-names>EL</given-names>
          </name>
          <name>
            <surname>Wolf</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Hollender</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Neumann</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>MetFrag relaunched: incorporating strategies beyond in silico fragmentation</article-title>
        <source>J Cheminform</source>
        <year>2016</year>
        <volume>8</volume>
        <fpage>3</fpage>
        <pub-id pub-id-type="doi">10.1186/s13321-016-0115-9</pub-id>
        <?supplied-pmid 26834843?>
        <pub-id pub-id-type="pmid">26834843</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Graça</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Cai</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Lau</surname>
            <given-names>C-HE</given-names>
          </name>
          <name>
            <surname>Vorkas</surname>
            <given-names>PA</given-names>
          </name>
          <name>
            <surname>Lewis</surname>
            <given-names>MR</given-names>
          </name>
          <name>
            <surname>Want</surname>
            <given-names>EJ</given-names>
          </name>
          <name>
            <surname>Herrington</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Ebbels</surname>
            <given-names>TMD</given-names>
          </name>
        </person-group>
        <article-title>Automated annotation of untargeted all-ion fragmentation LC–MS metabolomics data with MetaboAnnotatoR</article-title>
        <source>Anal Chem</source>
        <year>2022</year>
        <volume>94</volume>
        <fpage>3446</fpage>
        <lpage>3455</lpage>
        <pub-id pub-id-type="doi">10.1021/acs.analchem.1c03032</pub-id>
        <?supplied-pmid 35180347?>
        <pub-id pub-id-type="pmid">35180347</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Liigand</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Tian</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Arndt</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Greiner</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Wishart</surname>
            <given-names>DS</given-names>
          </name>
        </person-group>
        <article-title>CFM-ID 4.0: more accurate ESI-MS/MS spectral prediction and compound identification</article-title>
        <source>Anal Chem</source>
        <year>2021</year>
        <volume>93(34)</volume>
        <fpage>11692</fpage>
        <lpage>11700</lpage>
        <pub-id pub-id-type="doi">10.1021/acs.analchem.1c01465</pub-id>
        <pub-id pub-id-type="pmid">34403256</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mohimani</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Gurevich</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Shlemov</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Mikheenko</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Korobeynikov</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Cao</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Shcherbin</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Nothias</surname>
            <given-names>L-F</given-names>
          </name>
          <name>
            <surname>Dorrestein</surname>
            <given-names>PC</given-names>
          </name>
          <name>
            <surname>Pevzner</surname>
            <given-names>PA</given-names>
          </name>
        </person-group>
        <article-title>Dereplication of microbial metabolites through database search of mass spectra</article-title>
        <source>Nat Commun</source>
        <year>2018</year>
        <volume>9</volume>
        <fpage>4035</fpage>
        <pub-id pub-id-type="doi">10.1038/s41467-018-06082-8</pub-id>
        <?supplied-pmid 30279420?>
        <pub-id pub-id-type="pmid">30279420</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cao</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Guler</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Tagirdzhanov</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>Y-Y</given-names>
          </name>
          <name>
            <surname>Gurevich</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Mohimani</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>MolDiscovery: learning mass spectrometry fragmentation of small molecules</article-title>
        <source>Nat Commun</source>
        <year>2021</year>
        <volume>12</volume>
        <fpage>3718</fpage>
        <pub-id pub-id-type="doi">10.1038/s41467-021-23986-0</pub-id>
        <?supplied-pmid 34140479?>
        <pub-id pub-id-type="pmid">34140479</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Depke</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Franke</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Brönstrup</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>CluMSID: an R package for similarity-based clustering of tandem mass spectra to aid feature annotation in metabolomics</article-title>
        <source>Bioinformatics</source>
        <year>2019</year>
        <volume>35</volume>
        <fpage>3196</fpage>
        <lpage>3198</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btz005</pub-id>
        <?supplied-pmid 30649189?>
        <pub-id pub-id-type="pmid">30649189</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <mixed-citation publication-type="other">Jonge NF de, Louwen JR, Chekmeneva E, Camuzeaux S, Vermeir FJ, Jansen RS, Huber F, Hooft JJJ van der (2022) MS2Query: Reliable and Scalable MS2 Mass Spectral-based Analogue Search. bioRxiv. [Preprint.] Accessed 02 August 2022 10.1101/2022.07.22.501125https://doi.org/10.1101/2022.07.22.501125</mixed-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wilkinson</surname>
            <given-names>MD</given-names>
          </name>
          <name>
            <surname>Dumontier</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>IjJ</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The FAIR Guiding Principles for scientific data management and stewardship</article-title>
        <source>Sci Data</source>
        <year>2016</year>
        <volume>3</volume>
        <fpage>160018</fpage>
        <pub-id pub-id-type="doi">10.1038/sdata.2016.18</pub-id>
        <?supplied-pmid 26978244?>
        <pub-id pub-id-type="pmid">26978244</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <mixed-citation publication-type="other">Peters K, Bradbury J, Bergmann S et al (2019) PhenoMeNal: processing and analysis of metabolomics data in the cloud. GigaSci 8(2) 10.1093/gigascience/giy149</mixed-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Giacomoni</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Le Corguillé</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Monsoor</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Workflow4Metabolomics: a collaborative research infrastructure for computational metabolomics</article-title>
        <source>Bioinformatics</source>
        <year>2015</year>
        <volume>31</volume>
        <fpage>1493</fpage>
        <lpage>1495</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btu813</pub-id>
        <?supplied-pmid 25527831?>
        <pub-id pub-id-type="pmid">25527831</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Carver</surname>
            <given-names>JJ</given-names>
          </name>
          <name>
            <surname>Phelan</surname>
            <given-names>VV</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Sharing and community curation of mass spectrometry data with global natural products social molecular networking</article-title>
        <source>Nat Biotechnol</source>
        <year>2016</year>
        <volume>34</volume>
        <fpage>828</fpage>
        <lpage>837</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.3597</pub-id>
        <?supplied-pmid 27504778?>
        <pub-id pub-id-type="pmid">27504778</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Afgan</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Baker</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Batut</surname>
            <given-names>B</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The Galaxy platform for accessible, reproducible and collaborative biomedical analyses: 2018 update</article-title>
        <source>Nucleic Acids Res</source>
        <year>2018</year>
        <volume>46</volume>
        <fpage>W537</fpage>
        <lpage>W544</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gky379</pub-id>
        <?supplied-pmid 29790989?>
        <pub-id pub-id-type="pmid">29790989</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Berthold</surname>
            <given-names>MR</given-names>
          </name>
          <name>
            <surname>Cebron</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Dill</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Gabriel</surname>
            <given-names>TR</given-names>
          </name>
          <name>
            <surname>Kötter</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Meinl</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Ohl</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Thiel</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Wiswedel</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <article-title>KNIME—the Konstanz information miner: version 2.0 and beyond</article-title>
        <source>ACM SIGKDD Explor Newsl</source>
        <year>2009</year>
        <volume>11</volume>
        <fpage>26</fpage>
        <lpage>31</lpage>
        <pub-id pub-id-type="doi">10.1145/1656274.1656280</pub-id>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Shen</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Yan</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Gao</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Johnson</surname>
            <given-names>CH</given-names>
          </name>
          <name>
            <surname>Snyder</surname>
            <given-names>MP</given-names>
          </name>
        </person-group>
        <article-title>TidyMass an object-oriented reproducible analysis framework for LC–MS data</article-title>
        <source>Nat Commun</source>
        <year>2022</year>
        <volume>13</volume>
        <fpage>4365</fpage>
        <pub-id pub-id-type="doi">10.1038/s41467-022-32155-w</pub-id>
        <?supplied-pmid 35902589?>
        <pub-id pub-id-type="pmid">35902589</pub-id>
      </element-citation>
    </ref>
    <ref id="CR29">
      <label>29.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tsugawa</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Cajka</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Kind</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Ma</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Higgins</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Ikeda</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Kanazawa</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>VanderGheynst</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Fiehn</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Arita</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>MS-DIAL: data-independent MS/MS deconvolution for comprehensive metabolome analysis</article-title>
        <source>Nat Methods</source>
        <year>2015</year>
        <volume>12</volume>
        <fpage>523</fpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.3393</pub-id>
        <?supplied-pmid 25938372?>
        <pub-id pub-id-type="pmid">25938372</pub-id>
      </element-citation>
    </ref>
    <ref id="CR30">
      <label>30.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pluskal</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Castillo</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Villar-Briones</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Orešič</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>MZmine 2: modular framework for processing, visualizing, and analyzing mass spectrometry-based molecular profile data</article-title>
        <source>BMC Bioinform</source>
        <year>2010</year>
        <volume>11</volume>
        <fpage>395</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-11-395</pub-id>
      </element-citation>
    </ref>
    <ref id="CR31">
      <label>31.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cohen-Boulakia</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Belhajjame</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Collin</surname>
            <given-names>O</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Scientific workflows for computational reproducibility in the life sciences: status, challenges and opportunities</article-title>
        <source>Future Gener Comput Syst</source>
        <year>2017</year>
        <volume>75</volume>
        <fpage>284</fpage>
        <lpage>298</lpage>
        <pub-id pub-id-type="doi">10.1016/j.future.2017.01.012</pub-id>
      </element-citation>
    </ref>
    <ref id="CR32">
      <label>32.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wratten</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Wilm</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Göke</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Reproducible, scalable, and shareable analysis pipelines with bioinformatics workflow managers</article-title>
        <source>Nat Methods</source>
        <year>2021</year>
        <volume>18</volume>
        <fpage>1161</fpage>
        <lpage>1168</lpage>
        <pub-id pub-id-type="doi">10.1038/s41592-021-01254-9</pub-id>
        <?supplied-pmid 34556866?>
        <pub-id pub-id-type="pmid">34556866</pub-id>
      </element-citation>
    </ref>
    <ref id="CR33">
      <label>33.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schloss</surname>
            <given-names>PD</given-names>
          </name>
        </person-group>
        <article-title>Identifying and overcoming threats to reproducibility, replicability, robustness, and generalizability in microbiome research</article-title>
        <source>MBio</source>
        <year>2018</year>
        <volume>9</volume>
        <fpage>e00525</fpage>
        <lpage>e618</lpage>
        <pub-id pub-id-type="doi">10.1128/mBio.00525-18</pub-id>
        <?supplied-pmid 29871915?>
        <pub-id pub-id-type="pmid">29871915</pub-id>
      </element-citation>
    </ref>
    <ref id="CR34">
      <label>34.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Herschel</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Diestelkämper</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Ben Lahmar</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>A survey on provenance: What for? What form? What from?</article-title>
        <source>VLDB J</source>
        <year>2017</year>
        <volume>26</volume>
        <fpage>881</fpage>
        <lpage>906</lpage>
        <pub-id pub-id-type="doi">10.1007/s00778-017-0486-1</pub-id>
      </element-citation>
    </ref>
    <ref id="CR35">
      <label>35.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Goble</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Cohen-Boulakia</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Soiland-Reyes</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Garijo</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Gil</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Crusoe</surname>
            <given-names>MR</given-names>
          </name>
          <name>
            <surname>Peters</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Schober</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>FAIR computational workflows</article-title>
        <source>Data Intell</source>
        <year>2020</year>
        <volume>2</volume>
        <fpage>108</fpage>
        <lpage>121</lpage>
        <pub-id pub-id-type="doi">10.1162/dint_a_00033</pub-id>
      </element-citation>
    </ref>
    <ref id="CR36">
      <label>36.</label>
      <mixed-citation publication-type="other">Zulfiqar M (2022) Metabolome Annotation Workflow. Accessed 2 September 2022. Available from: <ext-link ext-link-type="uri" xlink:href="https://github.com/zmahnoor14/MAW">https://github.com/zmahnoor14/MAW</ext-link></mixed-citation>
    </ref>
    <ref id="CR37">
      <label>37.</label>
      <mixed-citation publication-type="other">Zulfiqar M (2022) Docker Image for Metabolome Annotation Workflow R segment (MAW-R). Accessed 22 Sep 2022. Available from: <ext-link ext-link-type="uri" xlink:href="https://hub.docker.com/r/zmahnoor/maw-r">https://hub.docker.com/r/zmahnoor/maw-r</ext-link></mixed-citation>
    </ref>
    <ref id="CR38">
      <label>38.</label>
      <mixed-citation publication-type="other">Zulfiqar M (2022) Docker Image for Metabolome Annotation Workflow Python segment (MAW-Py). Accessed 22 Sep 2022. Available from: <ext-link ext-link-type="uri" xlink:href="https://hub.docker.com/r/zmahnoor/maw-py">https://hub.docker.com/r/zmahnoor/maw-py</ext-link></mixed-citation>
    </ref>
    <ref id="CR39">
      <label>39.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Stahl</surname>
            <given-names>DC</given-names>
          </name>
          <name>
            <surname>Swiderek</surname>
            <given-names>KM</given-names>
          </name>
          <name>
            <surname>Davis</surname>
            <given-names>MT</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>TD</given-names>
          </name>
        </person-group>
        <article-title>Data-controlled automation of liquid chromatography/tandem mass spectrometry analysis of peptide mixtures</article-title>
        <source>J Am Soc Mass Spectrom</source>
        <year>1996</year>
        <volume>7</volume>
        <fpage>532</fpage>
        <lpage>540</lpage>
        <pub-id pub-id-type="doi">10.1016/1044-0305(96)00057-8</pub-id>
        <?supplied-pmid 24203425?>
        <pub-id pub-id-type="pmid">24203425</pub-id>
      </element-citation>
    </ref>
    <ref id="CR40">
      <label>40.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chambers</surname>
            <given-names>MC</given-names>
          </name>
          <name>
            <surname>Maclean</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Burke</surname>
            <given-names>R</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A cross-platform toolkit for mass spectrometry and proteomics</article-title>
        <source>Nat Biotechnol</source>
        <year>2012</year>
        <volume>30</volume>
        <fpage>918</fpage>
        <lpage>920</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.2377</pub-id>
        <?supplied-pmid 23051804?>
        <pub-id pub-id-type="pmid">23051804</pub-id>
      </element-citation>
    </ref>
    <ref id="CR41">
      <label>41.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nikitashina</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Stettin</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Pohnert</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>Metabolic adaptation of diatoms to hypersalinity</article-title>
        <source>Phytochemistry</source>
        <year>2022</year>
        <volume>201</volume>
        <fpage>113267</fpage>
        <pub-id pub-id-type="doi">10.1016/j.phytochem.2022.113267</pub-id>
        <?supplied-pmid 35671808?>
        <pub-id pub-id-type="pmid">35671808</pub-id>
      </element-citation>
    </ref>
    <ref id="CR42">
      <label>42.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Peters</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Balcke</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Kleinenkuhnen</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Treutler</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Neumann</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Untargeted In silico compound classification—a novel metabolomics method to assess the chemodiversity in bryophytes</article-title>
        <source>Int J Mol Sci</source>
        <year>2021</year>
        <volume>22</volume>
        <fpage>3251</fpage>
        <pub-id pub-id-type="doi">10.3390/ijms22063251</pub-id>
        <?supplied-pmid 33806786?>
        <pub-id pub-id-type="pmid">33806786</pub-id>
      </element-citation>
    </ref>
    <ref id="CR43">
      <label>43.</label>
      <mixed-citation publication-type="other">Zenodo.org (2022) mzML Standard files from a diatom. In: MzML Stand. Files Diatom. 10.5281/zenodo.7106205</mixed-citation>
    </ref>
    <ref id="CR44">
      <label>44.</label>
      <mixed-citation publication-type="other">Zenodo.org (2022) LCMS2 Spectra from bryophytes dataset for metabolome Annotation Workflow (MAW). In: LCMS2 Spectra Bryophyt. Dataset. 10.5281/zenodo.7107096</mixed-citation>
    </ref>
    <ref id="CR45">
      <label>45.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wishart</surname>
            <given-names>DS</given-names>
          </name>
          <name>
            <surname>Tzur</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Knox</surname>
            <given-names>C</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>HMDB: the human metabolome database</article-title>
        <source>Nucleic Acids Res</source>
        <year>2007</year>
        <volume>35</volume>
        <fpage>D521</fpage>
        <lpage>526</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkl923</pub-id>
        <?supplied-pmid 17202168?>
        <pub-id pub-id-type="pmid">17202168</pub-id>
      </element-citation>
    </ref>
    <ref id="CR46">
      <label>46.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Horai</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Arita</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Kanaya</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>MassBank: a public repository for sharing mass spectral data for life sciences</article-title>
        <source>J Mass Spectrom</source>
        <year>2010</year>
        <volume>45</volume>
        <fpage>703</fpage>
        <lpage>714</lpage>
        <pub-id pub-id-type="doi">10.1002/jms.1777</pub-id>
        <?supplied-pmid 20623627?>
        <pub-id pub-id-type="pmid">20623627</pub-id>
      </element-citation>
    </ref>
    <ref id="CR47">
      <label>47.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rainer</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Vicini</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Salzer</surname>
            <given-names>L</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A modular and expandable ecosystem for metabolomics data annotation in R</article-title>
        <source>Metabolites</source>
        <year>2022</year>
        <volume>12</volume>
        <fpage>173</fpage>
        <pub-id pub-id-type="doi">10.3390/metabo12020173</pub-id>
        <?supplied-pmid 35208247?>
        <pub-id pub-id-type="pmid">35208247</pub-id>
      </element-citation>
    </ref>
    <ref id="CR48">
      <label>48.</label>
      <mixed-citation publication-type="other">Zenodo.org (2022) Spectral Libraries for MAW. In: MAW Database Download. 10.5281/zenodo.6528931</mixed-citation>
    </ref>
    <ref id="CR49">
      <label>49.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Shannon</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Markiel</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Ozier</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Baliga</surname>
            <given-names>NS</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>JT</given-names>
          </name>
          <name>
            <surname>Ramage</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Amin</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Schwikowski</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Ideker</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>Cytoscape: a software environment for integrated models of biomolecular interaction networks</article-title>
        <source>Genome Res</source>
        <year>2003</year>
        <volume>13</volume>
        <fpage>2498</fpage>
        <lpage>2504</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.1239303</pub-id>
        <?supplied-pmid 14597658?>
        <pub-id pub-id-type="pmid">14597658</pub-id>
      </element-citation>
    </ref>
    <ref id="CR50">
      <label>50.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sorokina</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Merseburger</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Rajan</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Yirik</surname>
            <given-names>MA</given-names>
          </name>
          <name>
            <surname>Steinbeck</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>COCONUT online: collection of open natural products database</article-title>
        <source>J Cheminform</source>
        <year>2021</year>
        <volume>13</volume>
        <fpage>2</fpage>
        <pub-id pub-id-type="doi">10.1186/s13321-020-00478-9</pub-id>
        <?supplied-pmid 33423696?>
        <pub-id pub-id-type="pmid">33423696</pub-id>
      </element-citation>
    </ref>
    <ref id="CR51">
      <label>51.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dührkop</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Nothias</surname>
            <given-names>L-F</given-names>
          </name>
          <name>
            <surname>Fleischauer</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Systematic classification of unknown metabolites using high-resolution fragmentation mass spectra</article-title>
        <source>Nat Biotechnol</source>
        <year>2021</year>
        <volume>39</volume>
        <fpage>462</fpage>
        <lpage>471</lpage>
        <pub-id pub-id-type="doi">10.1038/s41587-020-0740-8</pub-id>
        <?supplied-pmid 33230292?>
        <pub-id pub-id-type="pmid">33230292</pub-id>
      </element-citation>
    </ref>
    <ref id="CR52">
      <label>52.</label>
      <mixed-citation publication-type="other">Swain M. Introduction — PubChemPy 1.0.4 documentation. Accessed 18 Nov 2022. Available from: <ext-link ext-link-type="uri" xlink:href="https://pubchempy.readthedocs.io/en/latest/">https://pubchempy.readthedocs.io/en/latest/</ext-link></mixed-citation>
    </ref>
    <ref id="CR53">
      <label>53.</label>
      <mixed-citation publication-type="other">Landrum G (2016) RDKit: Open-Source Cheminformatics Software. Available from: <ext-link ext-link-type="uri" xlink:href="http://www.rdkit.org">http://www.rdkit.org</ext-link></mixed-citation>
    </ref>
    <ref id="CR54">
      <label>54.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Steinbeck</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Han</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Kuhn</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Horlacher</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Luttmann</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Willighagen</surname>
            <given-names>E</given-names>
          </name>
        </person-group>
        <article-title>The Chemistry Development Kit (CDK): an open-source Java Library for chemo- and bioinformatics</article-title>
        <source>J Chem Inf Comput Sci</source>
        <year>2003</year>
        <volume>43</volume>
        <fpage>493</fpage>
        <lpage>500</lpage>
        <pub-id pub-id-type="doi">10.1021/ci025584y</pub-id>
        <?supplied-pmid 12653513?>
        <pub-id pub-id-type="pmid">12653513</pub-id>
      </element-citation>
    </ref>
    <ref id="CR55">
      <label>55.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Willighagen</surname>
            <given-names>EL</given-names>
          </name>
          <name>
            <surname>Mayfield</surname>
            <given-names>JW</given-names>
          </name>
          <name>
            <surname>Alvarsson</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The Chemistry Development Kit (CDK) v20: atom typing, depiction, molecular formulas, and substructure searching</article-title>
        <source>J Cheminform</source>
        <year>2017</year>
        <volume>9</volume>
        <fpage>33</fpage>
        <pub-id pub-id-type="doi">10.1186/s13321-017-0220-4</pub-id>
        <?supplied-pmid 29086040?>
        <pub-id pub-id-type="pmid">29086040</pub-id>
      </element-citation>
    </ref>
    <ref id="CR56">
      <label>56.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Djoumbou Feunang</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Eisner</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Knox</surname>
            <given-names>C</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>ClassyFire: automated chemical classification with a comprehensive, computable taxonomy</article-title>
        <source>J Cheminform</source>
        <year>2016</year>
        <volume>8</volume>
        <fpage>61</fpage>
        <pub-id pub-id-type="doi">10.1186/s13321-016-0174-y</pub-id>
        <?supplied-pmid 27867422?>
        <pub-id pub-id-type="pmid">27867422</pub-id>
      </element-citation>
    </ref>
    <ref id="CR57">
      <label>57.</label>
      <mixed-citation publication-type="other">Allard P-M (2020) pybatchclassyfire. In: GitLab. Accessed 22 Sep 2022. Available from: <ext-link ext-link-type="uri" xlink:href="https://gitlab.unige.ch/Pierre-Marie.Allard/pybatchclassyfire">https://gitlab.unige.ch/Pierre-Marie.Allard/pybatchclassyfire</ext-link></mixed-citation>
    </ref>
    <ref id="CR58">
      <label>58.</label>
      <mixed-citation publication-type="other">Bechhofer S, De Roure D, Gamble M, Goble C, Buchan I (2010) Research Objects: Towards Exchange and Reuse of Digital Knowledge. Nat Preced 1–1</mixed-citation>
    </ref>
    <ref id="CR59">
      <label>59.</label>
      <mixed-citation publication-type="other">Treutler H, Neumann S, Ulpinnis C (2021) MetFamily. Accessed 22 February 2023. Available from: <ext-link ext-link-type="uri" xlink:href="http://msbi.ipb-halle.de/MetFamily/">http://msbi.ipb-halle.de/MetFamily/</ext-link></mixed-citation>
    </ref>
    <ref id="CR60">
      <label>60.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kim</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Cheng</surname>
            <given-names>T</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>PubChem in 2021: new data content and improved web interfaces</article-title>
        <source>Nucleic Acids Res</source>
        <year>2021</year>
        <volume>49</volume>
        <fpage>D1388</fpage>
        <lpage>D1395</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkaa971</pub-id>
        <?supplied-pmid 33151290?>
        <pub-id pub-id-type="pmid">33151290</pub-id>
      </element-citation>
    </ref>
    <ref id="CR61">
      <label>61.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Son</surname>
            <given-names>NCT</given-names>
          </name>
          <name>
            <surname>Tan</surname>
            <given-names>TQ</given-names>
          </name>
          <name>
            <surname>Lien</surname>
            <given-names>DTM</given-names>
          </name>
          <name>
            <surname>Huong</surname>
            <given-names>NTM</given-names>
          </name>
          <name>
            <surname>Tuyen</surname>
            <given-names>PNK</given-names>
          </name>
          <name>
            <surname>Phung</surname>
            <given-names>NKP</given-names>
          </name>
          <name>
            <surname>Phuong</surname>
            <given-names>QND</given-names>
          </name>
          <name>
            <surname>Thu</surname>
            <given-names>NTH</given-names>
          </name>
        </person-group>
        <article-title>Five phenolic compounds from <italic>Marchantia polymorpha</italic> L. and their in vitro antibacterial, antioxidant and cytotoxic activities</article-title>
        <source>Vietnam J Chem</source>
        <year>2020</year>
        <volume>58</volume>
        <fpage>810</fpage>
        <lpage>814</lpage>
      </element-citation>
    </ref>
    <ref id="CR62">
      <label>62.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>da Silva</surname>
            <given-names>RR</given-names>
          </name>
          <name>
            <surname>Dorrestein</surname>
            <given-names>PC</given-names>
          </name>
          <name>
            <surname>Quinn</surname>
            <given-names>RA</given-names>
          </name>
        </person-group>
        <article-title>Illuminating the dark matter in metabolomics</article-title>
        <source>Proc Natl Acad Sci</source>
        <year>2015</year>
        <volume>112</volume>
        <fpage>12549</fpage>
        <lpage>12550</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.1516878112</pub-id>
        <?supplied-pmid 26430243?>
        <pub-id pub-id-type="pmid">26430243</pub-id>
      </element-citation>
    </ref>
    <ref id="CR63">
      <label>63.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Huber</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Verhoeven</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Meijer</surname>
            <given-names>C</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>matchms - processing and similarity evaluation of mass spectrometry data</article-title>
        <source>J Open Source Softw</source>
        <year>2020</year>
        <volume>5</volume>
        <fpage>2411</fpage>
        <pub-id pub-id-type="doi">10.21105/joss.02411</pub-id>
      </element-citation>
    </ref>
    <ref id="CR64">
      <label>64.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kim</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Kato</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>X</given-names>
          </name>
        </person-group>
        <article-title>Comparative analysis of binary similarity measures for compound identification in mass spectrometry-based metabolomics</article-title>
        <source>Metabolites</source>
        <year>2022</year>
        <volume>12</volume>
        <fpage>694</fpage>
        <pub-id pub-id-type="doi">10.3390/metabo12080694</pub-id>
        <?supplied-pmid 35893261?>
        <pub-id pub-id-type="pmid">35893261</pub-id>
      </element-citation>
    </ref>
    <ref id="CR65">
      <label>65.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Huber</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Ridder</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Verhoeven</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Spaaks</surname>
            <given-names>JH</given-names>
          </name>
          <name>
            <surname>Diblen</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Rogers</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>van der Hooft</surname>
            <given-names>JJJ</given-names>
          </name>
        </person-group>
        <article-title>Spec2Vec: improved mass spectral similarity scoring through learning of structural relationships</article-title>
        <source>PLOS Comput Biol</source>
        <year>2021</year>
        <volume>17</volume>
        <fpage>e1008724</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pcbi.1008724</pub-id>
        <?supplied-pmid 33591968?>
        <pub-id pub-id-type="pmid">33591968</pub-id>
      </element-citation>
    </ref>
    <ref id="CR66">
      <label>66.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Stravs</surname>
            <given-names>MA</given-names>
          </name>
          <name>
            <surname>Dührkop</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Böcker</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Zamboni</surname>
            <given-names>N</given-names>
          </name>
        </person-group>
        <article-title>MSNovelist: de novo structure generation from mass spectra</article-title>
        <source>Nat Methods</source>
        <year>2022</year>
        <volume>19</volume>
        <fpage>865</fpage>
        <lpage>870</lpage>
        <pub-id pub-id-type="doi">10.1038/s41592-022-01486-3</pub-id>
        <?supplied-pmid 35637304?>
        <pub-id pub-id-type="pmid">35637304</pub-id>
      </element-citation>
    </ref>
    <ref id="CR67">
      <label>67.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Koelmel</surname>
            <given-names>JP</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Stow</surname>
            <given-names>SM</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Lipid annotator: towards accurate annotation in non-targeted liquid chromatography high-resolution tandem mass spectrometry (LC-HRMS/MS) lipidomics using a rapid and user-friendly software</article-title>
        <source>Metabolites</source>
        <year>2020</year>
        <volume>10</volume>
        <fpage>101</fpage>
        <pub-id pub-id-type="doi">10.3390/metabo10030101</pub-id>
        <?supplied-pmid 32178227?>
        <pub-id pub-id-type="pmid">32178227</pub-id>
      </element-citation>
    </ref>
    <ref id="CR68">
      <label>68.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Atanasov</surname>
            <given-names>AG</given-names>
          </name>
          <name>
            <surname>Zotchev</surname>
            <given-names>SB</given-names>
          </name>
          <name>
            <surname>Dirsch</surname>
            <given-names>VM</given-names>
          </name>
          <name>
            <surname>Supuran</surname>
            <given-names>CT</given-names>
          </name>
        </person-group>
        <article-title>Natural products in drug discovery: advances and opportunities</article-title>
        <source>Nat Rev Drug Discov</source>
        <year>2021</year>
        <volume>20</volume>
        <fpage>200</fpage>
        <lpage>216</lpage>
        <pub-id pub-id-type="doi">10.1038/s41573-020-00114-z</pub-id>
        <?supplied-pmid 33510482?>
        <pub-id pub-id-type="pmid">33510482</pub-id>
      </element-citation>
    </ref>
    <ref id="CR69">
      <label>69.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Niedermeyer</surname>
            <given-names>THJ</given-names>
          </name>
          <name>
            <surname>Strohalm</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>mMass as a software tool for the annotation of cyclic peptide tandem mass spectra</article-title>
        <source>PLoS ONE</source>
        <year>2012</year>
        <volume>7</volume>
        <fpage>e44913</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0044913</pub-id>
        <?supplied-pmid 23028676?>
        <pub-id pub-id-type="pmid">23028676</pub-id>
      </element-citation>
    </ref>
    <ref id="CR70">
      <label>70.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Crusoe</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Abeln</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Iosup</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Methods included: standardizing computational reuse and portability with the common workflow language</article-title>
        <source>Commun ACM</source>
        <year>2021</year>
        <volume>65</volume>
        <issue>6</issue>
        <fpage>54</fpage>
        <lpage>63</lpage>
        <pub-id pub-id-type="doi">10.1145/3486897</pub-id>
      </element-citation>
    </ref>
    <ref id="CR71">
      <label>71.</label>
      <mixed-citation publication-type="other">Zulfiqar M (2022) R and Python Scripts to run Metabolome annotation Workflow Benchmark datasets. Accessed 2 Sep 2022. Available from: <ext-link ext-link-type="uri" xlink:href="https://github.com/zmahnoor14/MAW-Benchmark">https://github.com/zmahnoor14/MAW-Benchmark</ext-link></mixed-citation>
    </ref>
  </ref-list>
</back>
