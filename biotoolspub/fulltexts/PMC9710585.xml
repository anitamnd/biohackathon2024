<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinform Adv</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinform Adv</journal-id>
    <journal-id journal-id-type="publisher-id">bioadv</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics Advances</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2635-0041</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">9710585</article-id>
    <article-id pub-id-type="doi">10.1093/bioadv/vbac015</article-id>
    <article-id pub-id-type="publisher-id">vbac015</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Original Paper</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Structural Bioinformatics</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01060</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>AbAdapt: an adaptive approach to predicting antibody–antigen complex structures from sequence</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-2076-6842</contrib-id>
        <name>
          <surname>Davila</surname>
          <given-names>Ana</given-names>
        </name>
        <xref rid="vbac015-aff1" ref-type="aff">1</xref>
        <xref rid="vbac015-FM1" ref-type="author-notes"/>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0003-1940-6898</contrib-id>
        <name>
          <surname>Xu</surname>
          <given-names>Zichang</given-names>
        </name>
        <xref rid="vbac015-aff1" ref-type="aff">1</xref>
        <xref rid="vbac015-FM1" ref-type="author-notes"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Li</surname>
          <given-names>Songling</given-names>
        </name>
        <xref rid="vbac015-aff1" ref-type="aff">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Rozewicki</surname>
          <given-names>John</given-names>
        </name>
        <xref rid="vbac015-aff1" ref-type="aff">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Wilamowski</surname>
          <given-names>Jan</given-names>
        </name>
        <xref rid="vbac015-aff1" ref-type="aff">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0001-9400-101X</contrib-id>
        <name>
          <surname>Kotelnikov</surname>
          <given-names>Sergei</given-names>
        </name>
        <xref rid="vbac015-aff2" ref-type="aff">2</xref>
        <xref rid="vbac015-aff3" ref-type="aff">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Kozakov</surname>
          <given-names>Dima</given-names>
        </name>
        <xref rid="vbac015-aff2" ref-type="aff">2</xref>
        <xref rid="vbac015-aff3" ref-type="aff">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Teraguchi</surname>
          <given-names>Shunsuke</given-names>
        </name>
        <xref rid="vbac015-aff1" ref-type="aff">1</xref>
        <xref rid="vbac015-aff4" ref-type="aff">4</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0003-4078-0817</contrib-id>
        <name>
          <surname>Standley</surname>
          <given-names>Daron M</given-names>
        </name>
        <xref rid="vbac015-aff1" ref-type="aff">1</xref>
        <xref rid="vbac015-aff5" ref-type="aff">5</xref>
        <xref rid="vbac015-cor1" ref-type="corresp"/>
        <!--standley@biken.osaka-u.ac.jp-->
      </contrib>
    </contrib-group>
    <aff id="vbac015-aff1"><label>1</label><institution>Research Institute for Microbial Diseases, Department of Genome Informatics, Osaka University</institution>, Suita 565-0871, <country country="JP">Japan</country></aff>
    <aff id="vbac015-aff2"><label>2</label><institution>Department of Applied Mathematics and Statistics, Stony Brook University</institution>, Stony Brook, NY 11794-5252, <country country="US">USA</country></aff>
    <aff id="vbac015-aff3"><label>3</label><institution>Laufer Center for Physical and Quantitative Biology, Stony Brook University</institution>, Stony Brook, NY 11794-5252, <country country="US">USA</country></aff>
    <aff id="vbac015-aff4"><label>4</label><institution>Faculty of Data Science, Shiga University</institution>, Hikone 522-8522, <country country="JP">Japan</country></aff>
    <aff id="vbac015-aff5"><label>5</label><institution>Immunology Frontier Research Center, Department of Systems Immunology, Osaka University</institution>, Suita 565-0871, <country country="JP">Japan</country></aff>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Gromiha</surname>
          <given-names>Michael</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <author-notes>
      <fn id="vbac015-FM1">
        <p>The authors wish it to be known that, in their opinion, the first two authors should be regarded as Joint First Authors.</p>
      </fn>
      <corresp id="vbac015-cor1">To whom correspondence should be addressed. <email>standley@biken.osaka-u.ac.jp</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2022-03-07">
      <day>07</day>
      <month>3</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>07</day>
      <month>3</month>
      <year>2022</year>
    </pub-date>
    <volume>2</volume>
    <issue>1</issue>
    <elocation-id>vbac015</elocation-id>
    <history>
      <date date-type="received">
        <day>09</day>
        <month>2</month>
        <year>2022</year>
      </date>
      <date date-type="rev-recd">
        <day>15</day>
        <month>2</month>
        <year>2022</year>
      </date>
      <date date-type="editorial-decision">
        <day>16</day>
        <month>2</month>
        <year>2022</year>
      </date>
      <date date-type="accepted">
        <day>03</day>
        <month>3</month>
        <year>2022</year>
      </date>
      <date date-type="corrected-typeset">
        <day>11</day>
        <month>4</month>
        <year>2022</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2022. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2022</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="vbac015.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Motivation</title>
        <p>The scoring of antibody–antigen docked poses starting from unbound homology models has not been systematically optimized for a large and diverse set of input sequences.</p>
      </sec>
      <sec id="s2">
        <title>Results</title>
        <p>To address this need, we have developed AbAdapt, a webserver that accepts antibody and antigen sequences, models their 3D structures, predicts epitope and paratope, and then docks the modeled structures using two established docking engines (Piper and Hex). Each of the key steps has been optimized by developing and training new machine-learning models. The sequences from a diverse set of 622 antibody–antigen pairs with known structure were used as inputs for leave-one-out cross-validation. The final set of cluster representatives included at least one ‘Adequate’ pose for 550/622 (88.4%) of the queries. The median (interquartile range) ranks of these ‘Adequate’ poses were 22 (5–77). Similar results were obtained on a holdout set of 100 unrelated antibody–antigen pairs. When epitopes were repredicted using docking-derived features for specific antibodies, the median ROC AUC increased from 0.679 to 0.720 in cross-validation and from 0.694 to 0.730 in the holdout set.</p>
      </sec>
      <sec id="s3">
        <title>Availability and implementation</title>
        <p>AbAdapt and related data are available at <ext-link xlink:href="https://sysimm.org/abadapt/" ext-link-type="uri">https://sysimm.org/abadapt/</ext-link>.</p>
      </sec>
      <sec id="s4">
        <title>Supplementary information</title>
        <p><xref rid="sup1" ref-type="supplementary-material">Supplementary data</xref> are available at <italic toggle="yes">Bioinformatics Advances</italic> online.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Japan Society for the Promotion of Science (JSPS)</institution>
          </institution-wrap>
        </funding-source>
        <award-id>JP20K06610</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Platform Project for Supporting Drug Discovery and Life Science Research [Basis for supporting Innovative Drug Discovery and Life Science Research (BINDS)] from AMED</institution>
          </institution-wrap>
        </funding-source>
        <award-id>P20am0101108</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="10"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>One of the hallmarks of the adaptive immune system is its ability to quickly mount a defense against any ‘non-self’ molecule (antigen). A robust immune response requires continuous generation of a vast repertoire of lymphocyte receptors. Among these, the B-cell receptors (BCRs), and their soluble form, antibodies, play a critical role in host defense. BCRs are initially generated from randomly selected V, (D) and J germline gene segments that code for one of two polypeptide chains (heavy or light). The vast majority of such candidate BCR sequences are eliminated as a result of binding to endogenous proteins. Those that survive and recognize nonself antigens can further develop by a process of rapid mutation and affinity-driven selection known as <italic toggle="yes">maturation</italic>. In this way, mature antibodies acquire binding sites (paratopes) that are optimized, both in terms of sequence and structure, to recognize specific antigen-binding sites (epitopes). Recent single-cell resolution sequencing technologies, which allow large numbers of paired (heavy–light) antibody sequences to be obtained in a single experiment, make it possible to quickly sample antibody repertoires from disease cohorts. In the recent COVID-19 pandemic, for example, a number of researchers reported human antibody sequences against the SARS-CoV-2 S protein within months of the outbreak (<xref rid="vbac015-B11" ref-type="bibr">Brouwer <italic toggle="yes">et al.</italic>, 2020</xref>; <xref rid="vbac015-B12" ref-type="bibr">Cao <italic toggle="yes">et al.</italic>, 2020</xref>; <xref rid="vbac015-B14" ref-type="bibr">Chi <italic toggle="yes">et al.</italic>, 2020</xref>).</p>
    <p>In order to functionally characterize such antibodies, we generally need to know their binding modes. Traditionally, experimental methods such as X-ray crystallography have been used for this purpose. However, because these experimental methods are low throughput, there are far more antibody sequences of interest than there are antibody–antigen complex structures. There is, therefore, a need for computational methods that can leverage existing structural data to predict novel antibody–antigen complexes from emerging antibody sequence data.</p>
    <p>To a first approximation, the prediction of antibody–antigen complex structures can be separated into two problems: paratope prediction and epitope prediction. Of the two, epitope prediction is the more difficult. This can be understood by examining the frequency of paratope residues in all known antibody–antigen complexes and comparing this distribution to that of the known epitope residues for even a single antigen. Virtually all known paratopes lie within or near the three ‘complementarity-determining regions’ (CDRs), as shown in <xref rid="vbac015-F1" ref-type="fig">Figure 1A</xref>. In contrast, as illustrated using Influenza hemagglutinin as a typical antigen, epitopes can be comprised of almost any surface-exposed residue (<xref rid="vbac015-F1" ref-type="fig">Fig. 1B</xref>). It is for this reason that the epitope prediction problem is considered incomplete without specification of the antibody of interest (<xref rid="vbac015-B45" ref-type="bibr">Sela-Culang <italic toggle="yes">et al.</italic>, 2015</xref>). Many epitope prediction methods have been proposed; however, most do not make use of antibody information.</p>
    <fig position="float" id="vbac015-F1">
      <label>Fig. 1.</label>
      <caption>
        <p>Comparison between paratopes and epitopes. (<bold>A</bold>) The observed paratopes in known antibody–antigen complexes are indicated by a histogram of contacts (orange). The CDR boundaries are indicated by vertical gray lines. The light blue areas indicate RSA. (<bold>B</bold>) Influenza hemagglutinin epitopes in known antibody–hemagglutinin complexes are indicated in orange, while light blue areas indicate RSA</p>
      </caption>
      <graphic xlink:href="vbac015f1" position="float"/>
    </fig>
    <p>One natural way of making use of antibody information in epitope prediction is through molecular docking. Numerous docking engines exist, of which several—ClusPro (<xref rid="vbac015-B28" ref-type="bibr">Kozakov <italic toggle="yes">et al.</italic>, 2017</xref>), PatchDock (<xref rid="vbac015-B43" ref-type="bibr">Schneidman-Duhovny <italic toggle="yes">et al.</italic>, 2005</xref>), FRODOCK (<xref rid="vbac015-B41" ref-type="bibr">Ramírez-Aportela <italic toggle="yes">et al.</italic>, 2016</xref>) and SnugDock (<xref rid="vbac015-B46" ref-type="bibr">Sircar and Gray, 2010</xref>)—provide antibody-specific modes in which CDRs are masked and, in the case of ClusPro, antibody-specific scoring functions are employed. Docking-derived features can then be used in the prediction of antibody-specific epitopes. An early example of work in this direction is EpiPred, which utilized docking scores and geometric constraints to infer epitopes (<xref rid="vbac015-B29" ref-type="bibr">Krawczyk <italic toggle="yes">et al.</italic>, 2014</xref>). In related works, <xref rid="vbac015-B23" ref-type="bibr">Jespersen <italic toggle="yes">et al.</italic> (2019)</xref> developed a machine-learning method to distinguish true antibody–antigen interfaces from false ones, and <xref rid="vbac015-B39" ref-type="bibr">Pittala and Bailey-Kellogg (2020)</xref> used an attention-based deep-learning framework to capture the context of the target protein, paratope or epitope.</p>
    <p>In a complementary study, <xref rid="vbac015-B3" ref-type="bibr">Ambrosetti <italic toggle="yes">et al.</italic> (2020a)</xref> demonstrated that a rough approximation of the epitope significantly improved docking accuracy using the program HADDOCK (<xref rid="vbac015-B15" ref-type="bibr">Dominguez <italic toggle="yes">et al.</italic>, 2003</xref>). Since docking can assist in epitope/paratope prediction and vice versa, it is natural to try to integrate these two approaches along with antigen/antibody 3D modeling. However, while such integration is conceptually straightforward, docking methods are typically very sensitive to structural modeling errors in practice (<xref rid="vbac015-B5" ref-type="bibr">Anishchenko <italic toggle="yes">et al.</italic>, 2017</xref>). Because paratopes tend to occur in or near CDRs, which are precisely the most difficult regions in antibodies to model accurately (<xref rid="vbac015-B2" ref-type="bibr">Almagro <italic toggle="yes">et al.</italic>, 2014</xref>), automated antibody modeling and docking from sequence remains a challenging problem.</p>
    <p>Here, we describe a webserver, AbAdapt (<ext-link xlink:href="https://sysimm.org/abadapt/" ext-link-type="uri">https://sysimm.org/abadapt/</ext-link>), that employs established methods for antigen/antibody modeling and docking, and couples these methods using machine learning at key decision points. The basic workflow used by AbAdapt is illustrated in <xref rid="vbac015-F2" ref-type="fig">Figure 2</xref>. The key points are as follows: Automated antibody and antigen structural modeling pipelines have been built in order to allow direct input of sequences. Methods for epitope and paratope prediction were developed and trained using sequence and structural features derived from the antibody and antigen models. Two docking engines—Piper (<xref rid="vbac015-B27" ref-type="bibr">Kozakov <italic toggle="yes">et al.</italic>, 2006</xref>) and Hex (<xref rid="vbac015-B37" ref-type="bibr">Macindoe <italic toggle="yes">et al.</italic>, 2010</xref>)—were employed in order to perform both global and local docking, respectively, consistent with epitope predictions. Scoring functions were developed for raw Piper poses, raw Hex poses, and also for coclustered Piper and Hex poses. Epitope residues were finally re-predicted based on top-scoring docked poses. To test AbAdapt, we attempted to simulate a situation where the antibody and antigen sequence were known, but the epitope was not. For the antibodies, we employed template blacklisting in the structural modeling step in order to introduce realistic noise expected when modeling new antibody sequences. For the antigen, we only blacklisted templates that shared an epitope with the query, as would be the case for most well-studied antigens (e.g. Influenza hemagglutinin or SARS-CoV-2 spike protein), for which the unbound structure is known. We performed leave-one-out cross-validation (LOOCV) using 622 nonredundant antibody–antigen sequence pairs with known structure. We further evaluated the performance on an independent holdout set comprised of 100 randomly chosen, sequence-unique antibody–antigen pairs.</p>
    <fig position="float" id="vbac015-F2">
      <label>Fig. 2.</label>
      <caption>
        <p>Flowchart of AbAdapt pipeline. The pipeline transforms an antibody–antigen sequence pair in order to produce a set of top-scoring poses, which are then used to repredict the epitope</p>
      </caption>
      <graphic xlink:href="vbac015f2" position="float"/>
    </fig>
  </sec>
  <sec>
    <title>2 Methods</title>
    <sec>
      <title>2.1 Datasets</title>
      <p>The datasets for training and testing were prepared from Protein Data Bank (PDB) entries (<xref rid="vbac015-B9" ref-type="bibr">Berman, 2000</xref>) containing crystal structures of antibody–antigen complexes (downloaded May 2021). Redundant complexes were filtered according to the following criteria: Resolution better than 4 Å and complete heavy and light variable chains and antigen length greater than or equal to 60 amino acids. This filtering resulted in 1862 Ab–Ag complexes, which were further filtered, as described below.</p>
    </sec>
    <sec>
      <title>2.2 Antibody and antigen 3D models</title>
      <p>Antibody variable regions were modeled using Repertoire Builder (<xref rid="vbac015-B44" ref-type="bibr">Schritt <italic toggle="yes">et al.</italic>, 2019</xref>). In order to introduce a realistic level of noise, templates with a sequence identity of 90% or higher were blacklisted from the modeling procedure. Antigen templates were restricted to PDB entries that either did not have a bound antibody or whose bound antibody overlapped &lt;50% with the residues of the native epitope. Template alignments were computed by Forte (<xref rid="vbac015-B48" ref-type="bibr">Tomii and Akiyama, 2004</xref>), rendered in 3D using Spanner (<xref rid="vbac015-B36" ref-type="bibr">Lis, 2011</xref>) followed by side chain replacement by SCWRL4 (<xref rid="vbac015-B30" ref-type="bibr">Krivov <italic toggle="yes">et al.</italic>, 2009</xref>). We excluded 290 Ab–Ag pairs because the Root Mean Square Deviation (RMSD) of either the paratope or epitope were higher than 6 Å.</p>
    </sec>
    <sec>
      <title>2.3 Redundancy filtering</title>
      <p>The antibody–antigen pairs were redundancy filtered as follows: a pseudosequence composed of antibody heavy and light chain variable domains was constructed; the sequences were clustered using CD-HIT (<xref rid="vbac015-B18" ref-type="bibr">Fu <italic toggle="yes">et al.</italic>, 2012</xref>) at an 85% identity threshold. Antigens that were themselves antibodies (5) or that caused any of the third-party software to fail (1) were removed. This filtering resulted in 722 nonredundant antibody–antigen model pairs.</p>
    </sec>
    <sec>
      <title>2.4 Paratope and epitope prediction</title>
      <p>In order to generate input for the paratope prediction model, antibody CDR sequences were annotated with the AHo numbering scheme (<xref rid="vbac015-B20" ref-type="bibr">Honegger and Plückthun, 2001</xref>) using the ANARCI program (<xref rid="vbac015-B16" ref-type="bibr">Dunbar and Deane, 2016</xref>), ±2 flanking amino acid residues to capture potential non-CDR residues involved in the binding. For training, a binding residue in the antigen (antibody) was defined as True if it contained an atom that was within 5 Å of any antibody (antigen) atom. The paratope feature vector consisted of three sequence-based terms (amino acid, physico-chemical properties and conservation) and two structure-based terms [accessible surface area (ASA) and surface shape]. The epitope feature vector consisted of only the amino acid, conservation, ASA and surface shape terms. The feature vector of each residue of interest was concatenated over a window of ±5 amino acids.</p>
      <p>The individual features were defined as follows: The residue types for 20 standard amino acids were defined using one-hot encoding; A histogram of nine states (Tiny, Small, Aliphatic, Aromatic, Nonpolar, Polar, Charged, Basic and Acidic), along with the overall isoelectric point for the sequence window of interest, as defined by the R package SeqinR (<xref rid="vbac015-B13" ref-type="bibr">Charif and Lobry, 2007</xref>); A position-specific scoring matrix based on HHBlits (version 2.0.15) as calculated by SPBuild (<xref rid="vbac015-B50" ref-type="bibr">Yamada and Kinoshita, 2018</xref>); the ASA for each amino acid residue, as computed using DMS (<xref rid="vbac015-B42" ref-type="bibr">Richards, 1977</xref>); deformation of the protein surface using the Laplacian Norm (LN), a measure of curvature at five levels of resolution (<xref rid="vbac015-B10" ref-type="bibr">Bonnel and Marteau, 2012</xref>), as described in <xref rid="vbac015-B34" ref-type="bibr">Li <italic toggle="yes">et al.</italic> (2014)</xref>.</p>
      <p>The ML models for paratope (<italic toggle="yes">Initial_Paratope_ML</italic>) and initial epitope (<italic toggle="yes">Initial_Epitope_ML</italic>) are summarized in <xref rid="sup1" ref-type="supplementary-material">Supplementary Tables S1 and S2</xref>. For paratope and epitope prediction, a deep neural network (DNN) was designed with fully connected (dense) layers using the TensorFlow (<xref rid="vbac015-B1" ref-type="bibr">Abadi <italic toggle="yes">et al.</italic>, 2016</xref>) python API. The input layer received the feature vector. Subsequent 7 (11) hidden layers for the paratope (epitope) predictor transformed the inputs nonlinearly using Rectified Linear Unit (ReLU) activation functions. We adopted batch normalization (<xref rid="vbac015-B22" ref-type="bibr">Ioffe and Szegedy, 2015</xref>) right after each hidden layer and before the activation function, starting from the second hidden layer. The network ends with a sigmoid activation function to output epitope or paratope probabilities. The DNN performed binary classification (0, 1) representing nonbinding or binding for each residue of interest. The DNN was trained with the binary cross-entropy loss function and optimized using Adam, a stochastic gradient-based minimizer for the loss function (<xref rid="vbac015-B25" ref-type="bibr">Kingma and Ba, 2014</xref>). Overfitting was prevented by randomly dropping units from the hidden layers during training (<xref rid="vbac015-B47" ref-type="bibr">Srivastava <italic toggle="yes">et al.</italic>, 2014</xref>; the dropout rates were tuned separately for each layer); and stopping training when the loss no longer decreased (<xref rid="vbac015-B40" ref-type="bibr">Prechelt, 1998</xref>). The class-imbalance issue was addressed by setting the class weight equal to one-half of the ratio of the antigen length to the residues in the class (binding or nonbinding). Hyperparameter tuning and model selection were performed using the RandomSearch algorithm (<xref rid="vbac015-B8" ref-type="bibr">Bergstra and Bengio, 2012</xref>) from the Keras Tuner library; <ext-link xlink:href="https://github.com/keras-team/keras-tuner/" ext-link-type="uri">https://github.com/keras-team/keras-tuner/</ext-link>) through 10-fold nested cross-validation. Unless otherwise specified, precision and Recall were evaluated at a binary cutoff of 0.5.</p>
    </sec>
    <sec>
      <title>2.5 Docking</title>
      <p>Two established docking engines, Piper and Hex, were used in this study. Piper, the docking engine used by ClusPro, has consistently ranked at the top in the CAPRI (Critical Assessment of PRedicted Interactions) docking assessment and utilizes Fast Fourier Transformation (FFT) in Cartesian coordinate space in order to globally sample translations (<xref rid="vbac015-B27" ref-type="bibr">Kozakov <italic toggle="yes">et al.</italic>, 2006</xref>). Piper version 1.2 was run using default settings for global antibody–antigen docking. All 70 000 poses were evaluated by converting the transformations to Cartesian coordinates and scoring, as described below.</p>
      <p>Hex (<xref rid="vbac015-B37" ref-type="bibr">Macindoe <italic toggle="yes">et al.</italic>, 2010</xref>), which utilizes FFT in spherical coordinates, was used for local antibody–antigen docking at specific epitope patches. First, residues were sorted by decreasing epitope probability and subsequently clustered into nonidentical patches of radius 20 Å. The patch center was set to the residue with the highest epitope probability, with distance between patch centers at least 10 Å. Only patches with summed probability at least half the value of the highest-scoring patch were retained. Each patch was used for an independent Hex antibody–antigen docking calculation centered on the epitope patch of interest, with antibody–antigen orientations constrained to ±30° from their intermolecular axis.</p>
      <p>Piper and Hex Poses were scored by the <italic toggle="yes">Piper_Docking_ML</italic> or the <italic toggle="yes">Hex_Docking_ML</italic>, respectively, as summarized in <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S1</xref>. Each Hex or Piper pose was described by a rotationally invariant, compact feature vector containing the following terms: the ratio of observed to expected contacts for each of the 20 standard amino acids (assumed to be proportional to the total relative surface area; <xref rid="vbac015-B21" ref-type="bibr">Hubbard and Thornton, 1993</xref>) on the antibody; the analogous 20 ratios for the antigen; number of interatomic clashes; the joint-frequencies contacts/noncontacts in agreement/disagreement with paratope and epitope predictions.</p>
      <p>With regard to the joint frequency features, we considered antigen and antibody residue contacts separately and analogously. Using the antigen as an example, we first defined the joint frequency of two variables: observed (contact and noncontact) and predicted (epitope and nonepitope), where a binary cutoff of 0.5 was used for both paratope and epitope. These frequencies were normalized by the total number of residue contacts. We then discarded the large noncontact/nonepitope term and retained the three others. Together, the joint frequency features thus consisted of three antigen and three antibody terms.</p>
      <p>Poses were labeled as ‘True’ or ‘False’ by comparing them to an ideal pose that had been built by superimposing the antibody and antigen models on the native using paratope and epitope residues, respectively. True poses had to meet three criteria: the backbone RMSD of the interface residues (IRMSD), as defined by <xref rid="vbac015-B28" ref-type="bibr">Kozakov <italic toggle="yes">et al.</italic> (2017)</xref>, had to be less than a threshold (<italic toggle="yes">rmsdTrue</italic>); the fraction of antibody contacts that were true had to be greater than a threshold (<italic toggle="yes">parTrue</italic>); and, the fraction of antigen contacts that were true had to be greater than a threshold (<italic toggle="yes">epTrue</italic>). If one or more of these criteria were not met, the pose was deemed False.</p>
      <p>The docking score was trained using the XGBoost Python module XGBClassifier with true features scaled by the ratio of the numbers of True to False poses. Poses were randomly downsampled to 10 000 in training.</p>
    </sec>
    <sec>
      <title>2.6 Coclustering and rescoring Piper and Hex poses</title>
      <p>The top 10 000 poses, <inline-formula id="IE1"><mml:math id="IM1" display="inline" overflow="scroll"><mml:mrow><mml:mn>10</mml:mn><mml:mo> </mml:mo><mml:mn>000</mml:mn><mml:mo>×</mml:mo><mml:mi mathvariant="italic">fPiper</mml:mi></mml:mrow></mml:math></inline-formula> from Piper and <inline-formula id="IE2"><mml:math id="IM2" display="inline" overflow="scroll"><mml:mrow><mml:mn>10</mml:mn><mml:mo> </mml:mo><mml:mn>000</mml:mn><mml:mo>×</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi mathvariant="italic">fPiper</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> from Hex, were selected according to the scores described above. In order to assess the poses on a common scale, they were coclustered progressively by IRMSD. Cluster representatives were defined as the member with the most neighbors within the IRMSD clustering cutoff (10 Å). For each cluster representative, a feature vector consisting of the following terms was constructed: AbAdapt Hex or Piper score; number of interatomic clashes; Hex or Piper raw energy; fraction of Piper poses in the cluster; total size of cluster. The final docking score (<italic toggle="yes">Piper_Hex_Docking_ML</italic>) was trained using the XGBoost Python module XGBRegressor, with the target function given by: <inline-formula id="IE3"><mml:math id="IM3" display="inline" overflow="scroll"><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mi mathvariant="italic">IRMS</mml:mi><mml:msup><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac></mml:mrow></mml:math></inline-formula>. We assessed the quality of the top-scoring poses by first labeling each cluster representative as True or False, sorting the poses by their final score, and, if a True poses existed, computing the rank of the top-ranked True cluster representative (True Rank). In this scheme, a True Rank of 1 would be perfect. A failure would be when no True pose exists among cluster representatives. An intermediate result would be when a True cluster representative exists, but has a rank greater than 1. The upper limit on the rank in such a case would be defined by the number of clusters.</p>
    </sec>
    <sec>
      <title>2.7 Antibody-specific epitope prediction</title>
      <p>In order to include information from antibody–antigen docking in the final epitope prediction, a new feature vector was constructed that made use of the conservation, ASA and surface shape terms along with additional docking-derived features. The additional features describe the distribution of combined Piper–Hex scores associated with a given antigen residue. Specifically, we computed the joint frequency <italic toggle="yes">f</italic>(<italic toggle="yes">i</italic>, <italic toggle="yes">s</italic>) of a given antigen residue <italic toggle="yes">i</italic> being in contact with the antibody and having a <italic toggle="yes">Piper_Hex_Docking_ML</italic> score <italic toggle="yes">s</italic>. This joint frequency feature should not be confused with that used in Section 2.5, in which the initial epitope and paratope predictions were used; rather the epitope and paratope in <italic toggle="yes">f</italic>(<italic toggle="yes">i</italic>, <italic toggle="yes">s</italic>) come from the structure of the pose. Here, <italic toggle="yes">s</italic> was discretized into one of 10 equally spaced bins. The final predictor model (<italic toggle="yes">Final_Epitope_ML</italic>) was a DNN designed with seven fully connected (dense) hidden layers using the ReLU activation function, and sigmoid activation function for the output layer. The network used the Adam optimizer (<xref rid="vbac015-B25" ref-type="bibr">Kingma and Ba, 2014</xref>), and regularization methods batch normalization, Dropout (<xref rid="vbac015-B47" ref-type="bibr">Srivastava <italic toggle="yes">et al.</italic>, 2014</xref>) and early stopping. <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S2</xref> summarizes the architecture.</p>
    </sec>
    <sec>
      <title>2.8 Restraints</title>
      <p>In order to allow the incorporation of additional information on the binding site, epitope restraints (not used in the present study) were implemented as follows. First, the epitope probability for any antigen residue can be set manually, and this probability will override the initial epitope prediction. Second, a global parameter (<italic toggle="yes">rrest</italic>) can be provided such that the epitope probability of any residue whose C-alpha atom is more than <italic toggle="yes">rrest</italic> from any restrained epitope residue will be set to zero. The epitope probabilities of residues not outside this distance and not manually restrained will be determined by the initial epitope prediction (<italic toggle="yes">Initial_Epitope_ML</italic>), as above. The restraints thus work purely at the level of the initial epitope prediction, and act to remove docked poses that are far from restrained residues. There is no additional restraint term in the final scoring function. If the binding site is actually known with a high degree of confidence, we recommend using a data-driven docking method like HADDOCK (<xref rid="vbac015-B15" ref-type="bibr">Dominguez <italic toggle="yes">et al.</italic>, 2003</xref>).</p>
    </sec>
  </sec>
  <sec>
    <title>3 Results</title>
    <sec>
      <title>3.1 Antibody and antigen modeling</title>
      <p>Separate structural models for antibody and antigen sequences were constructed, as described in Section 2. In brief, we used blacklisting of antibody templates with 90% or more sequence identity to the query sequences, and excluded any antigen templates with a bound antibody sharing the same epitope. In order to simplify the downstream pose assessment, a reference complex was constructed by superimposing the paratope and epitope residues of these models onto those of the native structure. We used the reference, rather than the actual native, in all RMSD calculations of docked poses. Generally, RMSDs to the reference will be lower than to the actual native, and a pose can have zero RMSD even if the antibody model is imperfect. The mean and median C-alpha RMSDs of paratope residues upon superposition were 2.71 Å and 2.46 Å, while those of the epitope residues were 1.18 Å and 0.794 Å, respectively. The fact that epitope RMSDs were generally lower than paratope RMSDs was a consequence of the modeling procedure, which did not disallow sequence-identical antigen templates, so long as they were not solved with an antibody bound to the epitope in question.</p>
    </sec>
    <sec>
      <title>3.2 Abadapt leave-one-out cross-validation</title>
      <p>LOOCV was performed on the entire AbAdapt pipeline using the 622 separate antibody and antigen models. That is, for each machine-learning step, 622 models were constructed for each query using the remaining 621 queries as training data. The actual docking calculations were performed only once, as pose generation was independent of scoring. Several global parameters (defined in Section 2) were fixed in the results below: <italic toggle="yes">rmsdTrue</italic> = 15 Å; <italic toggle="yes">epTrue</italic>= <italic toggle="yes">parTrue</italic> = 0.5; <italic toggle="yes">fPiper</italic> = 0.9. In the following, we break down the performance of each of the main steps of the AbAdapt pipeline in LOOCV.</p>
      <sec>
        <title>3.2.1 Initial paratope prediction</title>
        <p>The Receiver Operating Characteristic (ROC) Area Under the Curve (AUC) and Precision-Recall (PR) AUC for the <italic toggle="yes">Initial_Paratope_ML</italic> in LOOCV were assessed (<xref rid="vbac015-F3" ref-type="fig">Fig. 3A and B</xref>; <xref rid="vbac015-T1" ref-type="table">Table 1</xref>). The mean ROC AUCs for the training (92.5%) and test (89.8%) were close, consistent with the observation that paratopes tend to be located in predictable regions.</p>
        <fig position="float" id="vbac015-F3">
          <label>Fig. 3.</label>
          <caption>
            <p>Paratope and initial epitope predictions in LOOCV and holdout. The ROC (<bold>A</bold>, <bold>C</bold>) and PR (<bold>B</bold>, <bold>D</bold>) AUCs are shown for paratope, epitope and antigen-specific epitope predictions</p>
          </caption>
          <graphic xlink:href="vbac015f3" position="float"/>
        </fig>
        <table-wrap position="float" id="vbac015-T1">
          <label>Table 1.</label>
          <caption>
            <p>LOOCV initial paratope and epitope predictions</p>
          </caption>
          <table frame="hsides" rules="groups">
            <colgroup span="1">
              <col valign="top" align="left" span="1"/>
              <col valign="top" align="char" char="." span="1"/>
              <col valign="top" align="char" char="." span="1"/>
              <col valign="top" align="char" char="." span="1"/>
            </colgroup>
            <thead>
              <tr>
                <th rowspan="1" colspan="1">Prediction</th>
                <th rowspan="1" colspan="1">Median</th>
                <th rowspan="1" colspan="1">Mean</th>
                <th rowspan="1" colspan="1">Stdev</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td rowspan="1" colspan="1">Paratope TRAIN ROC AUC</td>
                <td rowspan="1" colspan="1">0.925</td>
                <td rowspan="1" colspan="1">0.925</td>
                <td rowspan="1" colspan="1">0.011</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">Paratope TEST ROC AUC</td>
                <td rowspan="1" colspan="1">0.910</td>
                <td rowspan="1" colspan="1">0.898</td>
                <td rowspan="1" colspan="1">0.064</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">Paratope TEST PR AUC</td>
                <td rowspan="1" colspan="1">0.741</td>
                <td rowspan="1" colspan="1">0.707</td>
                <td rowspan="1" colspan="1">0.184</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">Paratope TEST recall</td>
                <td rowspan="1" colspan="1">0.816</td>
                <td rowspan="1" colspan="1">0.797</td>
                <td rowspan="1" colspan="1">0.135</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">Paratope TEST precision</td>
                <td rowspan="1" colspan="1">0.621</td>
                <td rowspan="1" colspan="1">0.591</td>
                <td rowspan="1" colspan="1">0.178</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">Paratope TEST positive rate</td>
                <td rowspan="1" colspan="1">0.239</td>
                <td rowspan="1" colspan="1">0.232</td>
                <td rowspan="1" colspan="1">0.066</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">Epitope TRAIN ROC AUC</td>
                <td rowspan="1" colspan="1">0.861</td>
                <td rowspan="1" colspan="1">0.853</td>
                <td rowspan="1" colspan="1">0.050</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">Epitope TEST ROC AUC</td>
                <td rowspan="1" colspan="1">0.679</td>
                <td rowspan="1" colspan="1">0.683</td>
                <td rowspan="1" colspan="1">0.147</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">Epitope TEST PR AUC</td>
                <td rowspan="1" colspan="1">0.161</td>
                <td rowspan="1" colspan="1">0.196</td>
                <td rowspan="1" colspan="1">0.134</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">Epitope TEST recall</td>
                <td rowspan="1" colspan="1">0.625</td>
                <td rowspan="1" colspan="1">0.599</td>
                <td rowspan="1" colspan="1">0.240</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">Epitope TEST precision</td>
                <td rowspan="1" colspan="1">0.146</td>
                <td rowspan="1" colspan="1">0.156</td>
                <td rowspan="1" colspan="1">0.087</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">Epitope TEST positive rate</td>
                <td rowspan="1" colspan="1">0.086</td>
                <td rowspan="1" colspan="1">0.100</td>
                <td rowspan="1" colspan="1">0.069</td>
              </tr>
            </tbody>
          </table>
        </table-wrap>
      </sec>
      <sec>
        <title>3.2.2 Initial epitope prediction</title>
        <p>The ROC and PR AUCs for the <italic toggle="yes">Initial_Epitope_ML</italic> in LOOCV were computed (<xref rid="vbac015-F3" ref-type="fig">Fig. 3A and B</xref>; <xref rid="vbac015-T1" ref-type="table">Table 1</xref>). All measures were lower than their corresponding values in paratope prediction, consistent with the inherent limitation in predicting epitope residues without specification of the antibody. In particular, the mean PR AUC for epitope prediction (19.6%) was much lower than in the paratope prediction (70.7%). Though this is partially explained by the difference of the positive rates, which gives the baseline of the PR AUC, the reduction is much more severe than what is expected from the positive rate alone. This highlights the fundamental difficulty of epitope prediction. We note also that the gap between mean test and training ROC AUCs was significant (<italic toggle="yes">P</italic> &lt; 0.0001, one-tailed <italic toggle="yes">t</italic>-test), implying that the current epitope predictor does not generalize well to unseen data. In spite of the fundamental difficulty of epitope prediction using only antigen features, the performance of AbAdapt’s initial epitope prediction dropped further if a simplified feature vector, consisting only of the antigen relative solvent accessibility (RSA) of each residue, was used. Here, the mean ROC AUCs dropped from 0.683 to 0.637 and mean PR AUC dropped from 0.196 to 0.142. We concluded that a natural direction to address this difficult problem is to include antibody features in the epitope prediction model, an idea that we explore below.</p>
      </sec>
      <sec>
        <title>3.2.3 Piper docking</title>
        <p>The number of Piper runs that produced at least one True pose out of the 70 000 poses generated per query was 596/622 (95.8%). The mean ROC AUCs for the <italic toggle="yes">Piper_Docking_ML</italic> for these 596 queries was 0.692 (±0.151). When raw piper energies were used instead of <italic toggle="yes">Piper_Docking_ML</italic>, the mean ROC AUC dropped to 0.538 (±0.147). The AbAdapt features thus had a significant effect on the scoring. Nevertheless, the proportion of True poses, as illustrated in <xref rid="vbac015-F4" ref-type="fig">Figure 4A</xref>, made up only a tiny proportion (2.5% on average) of the Piper poses initially. We defined the True Rank as the rank of the highest-scoring pose that is classified as True. The median [interquartile range (IQR)] True Rank was 5988 (2423–12 931). Below, we attempt to reduce the True Rank by merging with Hex poses, clustering and rescoring.</p>
        <fig position="float" id="vbac015-F4">
          <label>Fig. 4.</label>
          <caption>
            <p>Distribution of True poses in LOOCV. The distribution of True and All poses are shown for five stages of the AbAdapt pipeline. (<bold>A</bold>) Piper raw docking (upper left) and selected poses (upper middle); Hex raw docking (lower left) and selected poses (lower middle); (<bold>B</bold>) Final cluster representatives (right). A histogram of True Ranks of cluster representative in the final set of poses is also shown (blue bars)</p>
          </caption>
          <graphic xlink:href="vbac015f4" position="float"/>
        </fig>
      </sec>
      <sec>
        <title>3.2.4 Hex docking</title>
        <p>The number of Hex runs that produced at least one True pose out of all poses was 583/622 (93.7%). The total number of poses depended on the number of high-scoring epitope patches, with median (IQR) values of 472 087 (327 281–681 936; <xref rid="vbac015-F4" ref-type="fig">Fig. 4B</xref>). The mean ROC AUCs for the <italic toggle="yes">Hex_Docking_ML</italic> for the 583 queries that produced at least one True pose was 0.599 (±0.156). When we removed epitope and paratope patch information from the Hex docking protocol, the query coverage dropped to 104/622 (16.7%), indicating the need for such patch-directed local docking in the case of Hex. When we utilized the AbAdapt Hex docking protocol but used raw Hex scores, the mean ROC AUC dropped to 0.528 (±0.085). Taken together, both AbAdapt sampling and scoring had a positive effect on overall Hex docking performance. Nevertheless, as observed with Piper, True poses made up a tiny proportion (3.1% on average) of the Hex poses initially. The median (IQR) True Rank was 5639 (1208–25 757), which, again, we aimed to reduce by merging with Piper poses, clustering and rescoring.</p>
      </sec>
      <sec>
        <title>3.2.5 Combined Piper–Hex clustering and scoring</title>
        <p>The top Piper and Hex poses were next coclustered and rescored. As illustrated in <xref rid="vbac015-F4" ref-type="fig">Figure 4A</xref>, the first step involved selection of Piper and Hex poses. In the first selection of 9000 from 70 000 Piper poses, the mean True pose frequency increased from 2.4% to 4.8%. For Hex, the True poses frequency increased from 3.1% to 5.4% among the top 1000 selected poses. The second step involved rescoring the mixed Piper and Hex poses using regression against a target function given by <inline-formula id="IE4"><mml:math id="IM4" display="inline" overflow="scroll"><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mi mathvariant="italic">IRMS</mml:mi><mml:msup><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac></mml:mrow></mml:math></inline-formula>, and then clustering the poses (<xref rid="vbac015-F4" ref-type="fig">Fig. 4B</xref>). Here, we actually observed a drop in the enrichment of True poses to 3.9% for cluster representatives. The <italic toggle="yes">Piper_Hex_Docking_ML</italic> was assessed for cluster representatives by computing the overall coverage and True Rank for each query. The overall query coverage of cluster representatives, was 550/622 (88.4%). The True Rank histogram (<xref rid="vbac015-F4" ref-type="fig">Fig. 4B</xref>), had a very long tail, with a median (IQR) value of 22 (5–77). Thus, the loss in overall True pose enrichment was compensated by an overall improvement in True Rank. The mean ROC AUC for the combined <italic toggle="yes">Piper_Hex_Docking_ML</italic> was 0.533 (±0.156). This value was lower than that obtained if we had simply inherited the <italic toggle="yes">Piper_Docking_ML</italic> or <italic toggle="yes">Hex_Docking_ML</italic> scores (0.554 ± 0.198). However, the regression provided at least two benefits: first, it provided a single score for poses from either Piper or Hex; second, it allowed poses with IRMSD values well below the cutoff of 15 Å to influence the score, since lower IRMSD values are always preferred in <inline-formula id="IE5"><mml:math id="IM5" display="inline" overflow="scroll"><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mi mathvariant="italic">IRMS</mml:mi><mml:msup><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac></mml:mrow></mml:math></inline-formula> regression. For example, if we considered a stricter IRMSD cutoff of 8 Å, we found that the mean ROC AUC increased to 0.608 (±0.241) when the regression score was used but only 0.570 (±0.235) when <italic toggle="yes">Piper_Docking_ML</italic>/<italic toggle="yes">Hex_Docking_ML</italic> was used. The query coverage using the 8 Å cutoff was, as expect, lower: 368/622 (59%).</p>
        <p>As a reference, we also constructed two alternative pipelines, in which only-Piper (<italic toggle="yes">fPiper</italic> = 1) or only-Hex (<italic toggle="yes">fPiper</italic> = 0) were used. For the only-Piper pipeline, the query coverage was 549/622 (88.26%) and the median (IQR) True pose ranks were 19 (6–70). For the only-Hex pipeline, the query coverage was 459/622 (73.79%) and the median (IQR) True pose ranks were 20 (6–71.5). From these results, including Hex did not appear to have obvious advantages over the only-Piper pipeline in terms of query coverage or True Rank. However, if we again look below the 15 Å IRMSD threshold, we found that the query coverage of the Piper–Hex pipeline (368) was much better than that of the only-Piper pipeline (340). Therefore, the best value of (<italic toggle="yes">fPiper</italic>) depends on both the inputs and the desired output.</p>
        <p>In order to put these results into a more familiar context, we evaluated DockQ scores (<xref rid="vbac015-B7" ref-type="bibr">Basu and Wallner, 2016</xref>), which map to the four categories (‘Incorrect’, ‘Acceptable’, ‘Medium’ or ‘High’) used in the CAPRI community (<xref rid="vbac015-B33" ref-type="bibr">Lensink and Wodak, 2013</xref>). We summarized the DockQ results by plotting the frequency of queries resulting in at least one Acceptable, Medium or High model within the top 1, 5, 10, 50 or 100 cluster representatives (<xref rid="vbac015-F5" ref-type="fig">Fig. 5A</xref>). We also computed DockQ results for the two alternative pipelines in which only-Piper or only-Hex were used (<xref rid="vbac015-F5" ref-type="fig">Fig. 5B and C</xref>, respectively). For all three pipelines, no models deemed High were observed, and even Medium models were very rare, which indicates the limits of our current pipeline. Only two of the categories had frequencies above 10%: Acceptable models in the top 50 or top 100 poses, which is consistent with the True Ranks computed in <xref rid="vbac015-F4" ref-type="fig">Figure 4</xref>. In the top 50 poses, the only-Hex, only-Piper and combined Piper–Hex docking pipelines achieved query frequencies of 16%, 21% and 22%, respectively. Within the top 100 poses, the frequencies were 24.1%, 28.6% and 30.9%, respectively. Taken together, the combined pipeline appeared to out-perform the only-Hex or only-Piper pipelines in LOOCV.</p>
        <fig position="float" id="vbac015-F5">
          <label>Fig. 5.</label>
          <caption>
            <p>DockQ scores in LOOCV and holdout. (<bold>A</bold>, <bold>D</bold>) The total number of Acceptable, Medium and High models for the 622 (100) antibody–antigen pairs used in cross-validation (Holdout) are shown. (<bold>B</bold>, <bold>C</bold>) The corresponding values are shown for a reference pipeline in which only-Piper was used. (<bold>C</bold>, <bold>E</bold>) The corresponding values are shown for a reference pipeline in which only-Hex was used</p>
          </caption>
          <graphic xlink:href="vbac015f5" position="float"/>
        </fig>
        <p>One of the goals of this work was to develop a docking pipeline that was robust against errors in the initial models. Due to our use of blacklisting in the antibody modeling process, most of the errors in initial models came from the paratopes. We examined sensitivity of AbAdapt to antibody model quality in several ways. First, we considered the ability to generate at least one True pose (query coverage) for queries whose paratope RMSDs fell into three ranges: ‘Low’ 0–2 Å (201 cases), ‘Medium’ 2–4 Å (332 cases) and ‘High’ 4–6 Å (89 cases). <italic toggle="yes">P-</italic>values were calculated by Fisher’s exact test under the null hypothesis that the ability to produce at least one True pose in the final set of cluster representatives and paratope RMSD bin were independent of each other (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table S3</xref>). We found that, while the ‘Low’ and ‘Medium’ success rates were not significantly different, the ‘High’ RMSD models failed significantly more than the ‘Low’ (<italic toggle="yes">P</italic> = 0.0025) or ‘Medium’ (<italic toggle="yes">P</italic> = 0.0039) models. Since our definition of a True pose was admittedly very liberal, we next considered the stricter definition of Acceptable according to the DockQ score for models within the top 10, 50 or 100 poses. Here again, we observed significant differences in success rates, depending on paratope RMSD, in particular between ‘Low’ and ‘High’ RMSD models in the top 100 poses (<italic toggle="yes">P</italic> = 0.00038). Taken together, AbAdapt was sensitive to model quality, consistent with previous reports (<xref rid="vbac015-B31" ref-type="bibr">Kundrotas <italic toggle="yes">et al.</italic>, 2018</xref>).</p>
      </sec>
    </sec>
    <sec>
      <title>3.3 Abadapt performance on holdout set</title>
      <p>The 100 antibody–antigen holdout queries were modeled in an analogous manner to those of the cross-validation set. Here, all machine-learning models were trained on the entire 622 training cases. The paratope and epitope prediction performances are plotted in <xref rid="vbac015-F3" ref-type="fig">Figure 3C and D</xref> and summarized in <xref rid="vbac015-T2" ref-type="table">Table 2</xref>. Overall, these values are very close to those in the cross-validation tests, indicating that the LOOCV results were a fair representation of how well the models generalized to new data. We summarized the main docking performance indicators in <xref rid="vbac015-T3" ref-type="table">Table 3</xref> and illustrated the distributions of True poses in <xref rid="vbac015-F6" ref-type="fig">Figure 6</xref>.</p>
      <fig position="float" id="vbac015-F6">
        <label>Fig. 6.</label>
        <caption>
          <p>Distribution of True Poses in holdout set. The distribution of True and All poses are shown for five stages of the AbAdapt pipeline. (<bold>A</bold>) Piper raw docking (upper left) and selected poses (upper middle); Hex raw docking (lower left) and selected poses (lower middle); (<bold>B</bold>) Final cluster representatives (right). A histogram of True Ranks of cluster representative in the final set of poses is also shown (blue bars)</p>
        </caption>
        <graphic xlink:href="vbac015f6" position="float"/>
      </fig>
      <table-wrap position="float" id="vbac015-T2">
        <label>Table 2.</label>
        <caption>
          <p>Holdout initial paratope and epitope predictions</p>
        </caption>
        <table frame="hsides" rules="groups">
          <colgroup span="1">
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="char" char="." span="1"/>
            <col valign="top" align="char" char="." span="1"/>
            <col valign="top" align="char" char="." span="1"/>
          </colgroup>
          <thead>
            <tr>
              <th rowspan="1" colspan="1">Prediction</th>
              <th rowspan="1" colspan="1">Median</th>
              <th rowspan="1" colspan="1">Mean</th>
              <th rowspan="1" colspan="1">Stdev</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td rowspan="1" colspan="1">Paratope TEST ROC AUC</td>
              <td rowspan="1" colspan="1">0.905</td>
              <td rowspan="1" colspan="1">0.890</td>
              <td rowspan="1" colspan="1">0.066</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Paratope TEST PR AUC</td>
              <td rowspan="1" colspan="1">0.719</td>
              <td rowspan="1" colspan="1">0.683</td>
              <td rowspan="1" colspan="1">0.183</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Paratope TEST recall</td>
              <td rowspan="1" colspan="1">0.815</td>
              <td rowspan="1" colspan="1">0.788</td>
              <td rowspan="1" colspan="1">0.141</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Paratope TEST precision</td>
              <td rowspan="1" colspan="1">0.613</td>
              <td rowspan="1" colspan="1">0.574</td>
              <td rowspan="1" colspan="1">0.173</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Paratope TEST positive rate</td>
              <td rowspan="1" colspan="1">0.239</td>
              <td rowspan="1" colspan="1">0.225</td>
              <td rowspan="1" colspan="1">0.065</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Epitope TEST ROC AUC</td>
              <td rowspan="1" colspan="1">0.694</td>
              <td rowspan="1" colspan="1">0.675</td>
              <td rowspan="1" colspan="1">0.152</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Epitope TEST PR AUC</td>
              <td rowspan="1" colspan="1">0.166</td>
              <td rowspan="1" colspan="1">0.194</td>
              <td rowspan="1" colspan="1">0.134</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Epitope TEST recall</td>
              <td rowspan="1" colspan="1">0.625</td>
              <td rowspan="1" colspan="1">0.572</td>
              <td rowspan="1" colspan="1">0.252</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Epitope TEST precision</td>
              <td rowspan="1" colspan="1">0.151</td>
              <td rowspan="1" colspan="1">0.151</td>
              <td rowspan="1" colspan="1">0.090</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Epitope TEST positive rate</td>
              <td rowspan="1" colspan="1">0.086</td>
              <td rowspan="1" colspan="1">0.093</td>
              <td rowspan="1" colspan="1">0.054</td>
            </tr>
          </tbody>
        </table>
      </table-wrap>
      <table-wrap position="float" id="vbac015-T3">
        <label>Table 3.</label>
        <caption>
          <p>Comparison between cross-validation, holdout and ZDOCK</p>
        </caption>
        <table frame="hsides" rules="groups">
          <colgroup span="1">
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="char" char="." span="1"/>
            <col valign="top" align="char" char="." span="1"/>
            <col valign="top" align="char" char="." span="1"/>
          </colgroup>
          <thead>
            <tr>
              <th rowspan="1" colspan="1"/>
              <th rowspan="1" colspan="1">LOOCV</th>
              <th rowspan="1" colspan="1">Holdout</th>
              <th rowspan="1" colspan="1">ZDOCK</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td rowspan="1" colspan="1">Number of queries</td>
              <td align="center" rowspan="1" colspan="1">622</td>
              <td align="center" rowspan="1" colspan="1">100</td>
              <td align="center" rowspan="1" colspan="1">43</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Mean paratope RMSD (Å)</td>
              <td rowspan="1" colspan="1">2.69</td>
              <td rowspan="1" colspan="1">2.83</td>
              <td rowspan="1" colspan="1">2.15</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Median paratope RMSD (Å)</td>
              <td rowspan="1" colspan="1">2.44</td>
              <td rowspan="1" colspan="1">2.585</td>
              <td rowspan="1" colspan="1">2.065</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Mean epitope RMSD (Å)</td>
              <td rowspan="1" colspan="1">1.20</td>
              <td rowspan="1" colspan="1">1.03</td>
              <td rowspan="1" colspan="1">1.021</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Median epitope RMSD (Å)</td>
              <td rowspan="1" colspan="1">0.795</td>
              <td rowspan="1" colspan="1">0.732</td>
              <td rowspan="1" colspan="1">0.726</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Only-Piper query coverage</td>
              <td rowspan="1" colspan="1">0.883</td>
              <td rowspan="1" colspan="1">0.83</td>
              <td rowspan="1" colspan="1">0.93</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Only-Hex query coverage</td>
              <td rowspan="1" colspan="1">0.738</td>
              <td rowspan="1" colspan="1">0.72</td>
              <td rowspan="1" colspan="1">0.93</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Combined query coverage</td>
              <td rowspan="1" colspan="1">0.884</td>
              <td rowspan="1" colspan="1">0.83</td>
              <td rowspan="1" colspan="1">0.93</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Combined mean True Rank</td>
              <td rowspan="1" colspan="1">61.3</td>
              <td rowspan="1" colspan="1">66.3</td>
              <td rowspan="1" colspan="1">29.6</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Combined median true Rank</td>
              <td align="center" rowspan="1" colspan="1">22</td>
              <td align="center" rowspan="1" colspan="1">19</td>
              <td align="center" rowspan="1" colspan="1">12</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Combined mean ROC AUC</td>
              <td rowspan="1" colspan="1">0.618</td>
              <td rowspan="1" colspan="1">0.602</td>
              <td rowspan="1" colspan="1">0.552</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Combined median ROC AUC</td>
              <td rowspan="1" colspan="1">0.554</td>
              <td rowspan="1" colspan="1">0.537</td>
              <td rowspan="1" colspan="1">0.544</td>
            </tr>
          </tbody>
        </table>
      </table-wrap>
      <p>As with the cross-validation runs, we assessed the final holdout poses using the DockQ score (<xref rid="vbac015-F5" ref-type="fig">Fig. 5</xref>). Overall, a similar trend was observed, in which both the combined Piper–Hex and Piper-only pipelines produced greater numbers of Acceptable models at each of the rank thresholds than the Hex-only pipeline.</p>
    </sec>
    <sec>
      <title>3.4 Performance on ZDOCK benchmark</title>
      <p>We next assessed AbAdapt’s performance on the subset of 43 antibody–antigen pairs in the ZDOCK Benchmark (<xref rid="vbac015-B49" ref-type="bibr">Vreven <italic toggle="yes">et al.</italic>, 2015</xref>). The ZDOCK benchmark provides structures for the separate antibody and antigen, as well as for the bound complex. We assessed AbAdapt on the ZDOCK Benchmark under three conditions: (i) using bound structures; (ii) using unbound structures; and (iii) using models prepared in a manner identical to the way models were prepared for LOOCV and holdout runs. We summarize the results using models in <xref rid="vbac015-T3" ref-type="table">Table 3</xref>. The AbAdapt coverage and True Rank were higher than for the LOOCV or holdout runs, although the quality of input structures was similar. We also computed DockQ results for the three conditions, as shown in <xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S3</xref>. As expected, the numbers of high- and medium-quality models were greatest for the bound scenario, followed by the unbound PDB files, followed by the models.</p>
    </sec>
    <sec>
      <title>3.5 Antibody-specific epitope predictions</title>
      <p>In order to include antibody information in the epitope prediction, additional postdocking epitope features were derived from docked complexes. The additional features described the joint-frequencies of residue-level antibody–antigen contacts and docking scores. The addition of these postdocking features resulted in an improvement in median ROC AUC from 0.679 to 0.718 in LOOCV, as shown in the ‘Epitope (Ab)’ plot in <xref rid="vbac015-F3" ref-type="fig">Figure 3A</xref> and summarized in <xref rid="vbac015-T4" ref-type="table">Table 4</xref>. When the postdocking features were applied to the holdout set, the median test ROC AUC for epitope prediction improved from 0.694 to 0.722, as shown in <xref rid="vbac015-F3" ref-type="fig">Figure 3C</xref> and summarized in <xref rid="vbac015-T4" ref-type="table">Table 4</xref>.</p>
      <table-wrap position="float" id="vbac015-T4">
        <label>Table 4.</label>
        <caption>
          <p>LOOCV and holdout for antibody-specific epitope predictions</p>
        </caption>
        <table frame="hsides" rules="groups">
          <colgroup span="1">
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="char" char="." span="1"/>
            <col valign="top" align="char" char="." span="1"/>
            <col valign="top" align="char" char="." span="1"/>
          </colgroup>
          <thead>
            <tr>
              <th rowspan="1" colspan="1">Prediction</th>
              <th rowspan="1" colspan="1">Median</th>
              <th rowspan="1" colspan="1">Mean</th>
              <th rowspan="1" colspan="1">Stdev</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td rowspan="1" colspan="1">LOOCV TRAIN ROC AUC</td>
              <td rowspan="1" colspan="1">0.796</td>
              <td rowspan="1" colspan="1">0.798</td>
              <td rowspan="1" colspan="1">0.018</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">LOOCV TEST ROC AUC</td>
              <td rowspan="1" colspan="1">0.720</td>
              <td rowspan="1" colspan="1">0.709</td>
              <td rowspan="1" colspan="1">0.170</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">LOOCV TEST PR AUC</td>
              <td rowspan="1" colspan="1">0.193</td>
              <td rowspan="1" colspan="1">0.250</td>
              <td rowspan="1" colspan="1">0.193</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">LOOCV TEST precision</td>
              <td rowspan="1" colspan="1">0.154</td>
              <td rowspan="1" colspan="1">0.161</td>
              <td rowspan="1" colspan="1">0.098</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">LOOCV TEST recall</td>
              <td rowspan="1" colspan="1">0.750</td>
              <td rowspan="1" colspan="1">0.668</td>
              <td rowspan="1" colspan="1">0.295</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Holdout TEST ROC AUC</td>
              <td rowspan="1" colspan="1">0.730</td>
              <td rowspan="1" colspan="1">0.706</td>
              <td rowspan="1" colspan="1">0.170</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Holdout TEST PR AUC</td>
              <td rowspan="1" colspan="1">0.178</td>
              <td rowspan="1" colspan="1">0.244</td>
              <td rowspan="1" colspan="1">0.185</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Holdout TEST precision</td>
              <td rowspan="1" colspan="1">0.155</td>
              <td rowspan="1" colspan="1">0.158</td>
              <td rowspan="1" colspan="1">0.087</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Holdout TEST recall</td>
              <td rowspan="1" colspan="1">0.726</td>
              <td rowspan="1" colspan="1">0.656</td>
              <td rowspan="1" colspan="1">0.268</td>
            </tr>
          </tbody>
        </table>
      </table-wrap>
      <p>In addition to the benchmarks above, we summarize the antibody-specific epitope prediction performance for AbAdapt along with EpiPred (<xref rid="vbac015-B29" ref-type="bibr">Krawczyk <italic toggle="yes">et al.</italic>, 2014</xref>) and PECAN (<xref rid="vbac015-B39" ref-type="bibr">Pittala and Bailey-Kellogg, 2020</xref>). Predictions from the EpiPred webserver for the holdout set were performed, and precision and recall were computed (<xref rid="vbac015-T5" ref-type="table">Table 5</xref>; <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S4</xref> and <xref rid="sup1" ref-type="supplementary-material">Fig. S1</xref>). EpiPred, which sets its epitope overlap cutoff at 30%, was unable to return predictions (EpiPred 3) for one of the smallest proteins. The predicted residues by AbAdapt were deemed epitope if their probabilities were above 0.5. AbAdapt achieved higher precision and recall than EpiPred, and the mean recall (0.662) was considerably higher than that of EpiPred (0.171). We also present representative epitope predictions for several holdout cases (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S4</xref>). As a reference, we also include native epitopes and predictions from the EpiPred webserver. There appear to be advantages to both EpiPred and AbAdapt. For example, for one of the worst AbAdapt case (4YDJ), there are elements of EpiPred’s first prediction, which captures some native epitope but also contains significant false-positive regions. At the other extreme, for one of AbAdapt’s better predictions (6II8), EpiPred’s top-three predictions appear to miss the epitope. In a typical case shown (4XAK), EpiPred’s first prediction overlapped with the native. One advantageous feature of EpiPred is its speed: results are returned in approximately 1 min, in comparison with AbAdapt’s multihour runtime.</p>
      <table-wrap position="float" id="vbac015-T5">
        <label>Table 5.</label>
        <caption>
          <p>Comparison with EpiPred in holdout set (98)</p>
        </caption>
        <table frame="hsides" rules="groups">
          <colgroup span="1">
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="char" char="." span="1"/>
            <col valign="top" align="char" char="." span="1"/>
            <col valign="top" align="char" char="." span="1"/>
            <col valign="top" align="char" char="." span="1"/>
          </colgroup>
          <thead>
            <tr>
              <th rowspan="1" colspan="1"/>
              <th rowspan="1" colspan="1">AbAdapt</th>
              <th rowspan="1" colspan="1">EpiPred 1</th>
              <th rowspan="1" colspan="1">EpiPred 2</th>
              <th rowspan="1" colspan="1">EpiPred 3</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td rowspan="1" colspan="1">Mean precision</td>
              <td rowspan="1" colspan="1">0.160</td>
              <td rowspan="1" colspan="1">0.098</td>
              <td rowspan="1" colspan="1">0.107</td>
              <td rowspan="1" colspan="1">0.102</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Stdev precision</td>
              <td rowspan="1" colspan="1">0.087</td>
              <td rowspan="1" colspan="1">0.142</td>
              <td rowspan="1" colspan="1">0.164</td>
              <td rowspan="1" colspan="1">0.155</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Mean recall</td>
              <td rowspan="1" colspan="1">0.662</td>
              <td rowspan="1" colspan="1">0.171</td>
              <td rowspan="1" colspan="1">0.149</td>
              <td rowspan="1" colspan="1">0.128</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Stdev recall</td>
              <td rowspan="1" colspan="1">0.267</td>
              <td rowspan="1" colspan="1">0.249</td>
              <td rowspan="1" colspan="1">0.226</td>
              <td rowspan="1" colspan="1">0.200</td>
            </tr>
          </tbody>
        </table>
      </table-wrap>
      <p>The performance of AbAdapt epitope prediction was also evaluated using the PECAN benchmark (<xref rid="vbac015-B39" ref-type="bibr">Pittala and Bailey-Kellogg, 2020</xref>), with the training and test set comprising 130 and 30 antibody–antigen crystal structure pairs, respectively, and the binding residue defined as any antigen (antibody) residue whose atom is within 4.5 Å of any antibody (antigen) atom. In order to compare with the published PECAN results, we reported the performance of Precision and Recall under a probability threshold of 0.5 and 0.379 the latter obtained maximizing Youden’s index (<xref rid="vbac015-B51" ref-type="bibr">Youden, 1950</xref>), for five repetitions of the training process. There was a trade-off between precision and recall, as expected. Although the PR AUC values for PECAN were not reported, we estimated that antibody-specific AbAdapt AUCs (24%) were similar while antibody-agnostic AUCs (14%) were lower than those of PECAN, as summarized in <xref rid="vbac015-T6" ref-type="table">Table 6</xref>.</p>
      <table-wrap position="float" id="vbac015-T6">
        <label>Table 6.</label>
        <caption>
          <p>Comparison with PECAN antibody-specific epitope predictions</p>
        </caption>
        <table frame="hsides" rules="groups">
          <colgroup span="1">
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="char" char="." span="1"/>
            <col valign="top" align="char" char="." span="1"/>
            <col valign="top" align="char" char="." span="1"/>
          </colgroup>
          <thead>
            <tr>
              <th rowspan="1" colspan="1">Prediction</th>
              <th rowspan="1" colspan="1">Method</th>
              <th rowspan="1" colspan="1">Precision Mean</th>
              <th rowspan="1" colspan="1">Recall Mean</th>
              <th rowspan="1" colspan="1">PR AUC Mean</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td rowspan="1" colspan="1">AbAdapt</td>
              <td rowspan="1" colspan="1">Antibody-specific</td>
              <td rowspan="1" colspan="1">0.189</td>
              <td rowspan="1" colspan="1">0.451</td>
              <td rowspan="1" colspan="1">0.243</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">AbAdapt</td>
              <td rowspan="1" colspan="1">Antibody-specific (0.379)</td>
              <td rowspan="1" colspan="1">0.156</td>
              <td rowspan="1" colspan="1">0.676</td>
              <td rowspan="1" colspan="1">0.243</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">EpiPred</td>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">0.136</td>
              <td rowspan="1" colspan="1">0.436</td>
              <td rowspan="1" colspan="1"/>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">PECAN</td>
              <td rowspan="1" colspan="1">Conv2-Layer+Attn</td>
              <td rowspan="1" colspan="1">0.154</td>
              <td rowspan="1" colspan="1">0.672</td>
              <td rowspan="1" colspan="1">&lt;0.23</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">PECAN</td>
              <td rowspan="1" colspan="1">Conv2-Layer+TL</td>
              <td rowspan="1" colspan="1">0.157</td>
              <td rowspan="1" colspan="1">0.730</td>
              <td rowspan="1" colspan="1">&lt;0.24</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">PECAN</td>
              <td rowspan="1" colspan="1">Conv2-Layer+Attn+TL</td>
              <td rowspan="1" colspan="1">0.158</td>
              <td rowspan="1" colspan="1">0.628</td>
              <td rowspan="1" colspan="1">&lt;0.25</td>
            </tr>
          </tbody>
        </table>
      </table-wrap>
      <p>The AbAdapt paratope prediction performance was compared with the state-of-the-art predictor ProABC2 (<xref rid="vbac015-B4" ref-type="bibr">Ambrosetti <italic toggle="yes">et al.</italic>, 2020b</xref>) and Parapred (<xref rid="vbac015-B35" ref-type="bibr">Liberis <italic toggle="yes">et al.</italic>, 2018</xref>), as shown in <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S5</xref>. The comparison was performed using two methods. We first evaluated the performance with our holdout set comprising 98 pairs by using their software (method 1). The statistics were calculated using the reported thresholds based on Youden’s index: 0.488 (Parapred) and 0.4 (ProABC-2); for AbAdapt, we used the calculated value of 0.395. Here, an improvement of AbAdapt paratope predictions over Parapred and ProABC-2 predictions could be observed. A second evaluation was performed with the Parapred benchmark (method 2) following the Parapred training procedure of 10 times 10-fold cross-validation. The set consisted of 277 crystal structures whose CDRs were defined according to the Chothia numbering scheme with two lateral residues at each end, and a paratope residue was defined as True if at least one atom was no greater than 4.5 Å from the antigen atom. The AbAdapt paratope predictions were binary labeled by maximizing Youden’s index, yielding thresholds of 0.439 for the Parapred benchmark. For this comparison, we show the prediction statistics for the thresholds 0.488 and 0.37 reported in Parapred and ProABC-2, respectively. AbAdapt performance for method 2 was lower than that of ProABC-2 or Parapred. These results indicate the sensitivity of all three methods to the training and testing methodology.</p>
    </sec>
    <sec>
      <title>3.6 Webserver</title>
      <p>The entire AbAdapt pipeline has been implemented as a webserver (<ext-link xlink:href="https://sysimm.org/abadapt/" ext-link-type="uri">https://sysimm.org/abadapt/</ext-link>). Example input and results pages are shown in <xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S5</xref>. The epitope and paratope predictions are available for download as text files and can also be visualized as heatmaps in a molecular viewer. All inputs used in the LOOCV and holdout tests can be downloaded here as well.</p>
    </sec>
  </sec>
  <sec>
    <title>4 Discussion</title>
    <p>The development of AbAdapt was motivated, in part, by the recent emergence of various tools for repertoire-based analyses of immune responses. One can now obtain large numbers of paired antibody sequences from a routine blood sample, very often in situations where likely target antigens are known (i.e. infection or vaccination). One can, in addition, produce structural models of these antibodies in a high-throughput manner from such sequence data. Currently, available tools such as Lyra (<xref rid="vbac015-B26" ref-type="bibr">Klausen <italic toggle="yes">et al.</italic>, 2015</xref>), AbodyBuilder (<xref rid="vbac015-B32" ref-type="bibr">Leem <italic toggle="yes">et al.</italic>, 2016</xref>) and Repertoire Builder (<xref rid="vbac015-B44" ref-type="bibr">Schritt <italic toggle="yes">et al.</italic>, 2019</xref>) all run on the seconds per model timescale, and more accurate high-throughput antibody modeling tools are likely on the way.</p>
    <p>The emergence of high-throughput repertoire analysis technology presents a new challenge: to further extend antibody structures in order to characterize the target antigens and binding modes of antibodies of interest. Binding information could be used to understand the mechanism of action (e.g. neutralization activity) and to map out the landscape of binding modes for antibodies in disease cohorts with a well-defined and limited set of target antigens.</p>
    <p>Here, we have attempted to build a working pipeline out of available tools, assess what worked and what did not, and suggest directions for future improvement. Our efforts were generally encouraging, as indicated by the query coverage and improvement in True Ranks across a large and diverse test set, along with the general agreement between LOOCV and holdout benchmarks. Although questions remain about the best balance between Piper and Hex poses, both the only-Piper and Piper–Hex AbAdapt pipelines produced better results than could be obtained by Piper alone. Also, the improvement in epitope prediction performance upon addition of antibody-specific features suggests a way of addressing this long-standing and important problem.</p>
    <p>Areas where AbAdapt did not perform particularly well include: the quality of top-scoring poses and speed. The DockQ scores indicate that, by CAPRI standards, AbAdapt is not sampling very near-native complex models. The sensitivity of DockQ scores to antibody modeling errors indicates that this is likely a result of the combined effects of errors in the paratope residues of starting structures and the use of rigid docking. The most straightforward approach to addressing this issue is to use better antibody models. The release of highly accurate deep learning-based protein modeling methods (<xref rid="vbac015-B6" ref-type="bibr">Baek <italic toggle="yes">et al.</italic>, 2021</xref>; <xref rid="vbac015-B24" ref-type="bibr">Jumper <italic toggle="yes">et al.</italic>, 2021</xref>), along with the fact that AbAdapt can accept structures as well as sequences as input, makes this a realistic possibility. This is a direction we plan to explore in the near future. More recently, deep learning-based protein modeling methods have been applied successfully to multimer modeling, suggesting that protein docking may soon be subsumed by protein folding (<xref rid="vbac015-B17" ref-type="bibr">Evans <italic toggle="yes">et al.</italic>, 2021</xref>). However, antibody–antigen docking still presents a significant challenge. In a recent benchmark of where AlphaFold and ClusPro were used in combination (<xref rid="vbac015-B19" ref-type="bibr">Ghani <italic toggle="yes">et al.</italic>, 2021</xref>), the performance on antibody–antigen pairs was substantially lower than that for other targets. For example, for the best combination of methods (AlphaFold refined ClusPro plus AlphaFold models), no models deemed ‘Medium’ or ‘High’ by DockQ were generated by any of the tested methods, whereas for other targets, the frequency of ‘Medium’ models was similar to that of ‘High’ models. A speculative explanation for the AlphaFold/ClusPro results is that the methods used to generate multiple sequence alignment-based features in AlphaFold are not as appropriate for antibody–antigen pairs as they are for generic protein complexes (for which orthologous complexes exist in public databases, and a true interface signal can be seen in the MSA).</p>
    <p>Although speed was not a primary focus of the current study, the fact that a typical antibody–antigen pair consumes multiple hours of CPU time (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S2</xref>), represents a limitation in the analysis of large numbers of sequences. To overcome this constraint, the wall-clock time was substantially reduced by using computational parallelism. However, if we assume that most high-throughput docking studies would be performed on a limited set of antigens using numerous antibodies, we can envision a scenario where a handful of representative antibodies are used to map ‘immunodominant’ epitope patches. Existing poses could then be recycled for local docking by new antibodies. We intend to explore this idea in the future. Taken together, AbAdapt represents a step toward integration of sequence and structural information that can be derived from antibody repertoires.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="sup1" position="float" content-type="local-data">
      <label>vbac015_Supplementary_Data</label>
      <media xlink:href="vbac015_supplementary_data.docx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack id="ack1">
    <title>Acknowledgements</title>
    <p>We would like to thank all members of the Systems Immunology Lab, the Kozakov Lab and the late David Ritchie (author of Hex) for very helpful discussions.</p>
    <sec>
      <title>Funding</title>
      <p>This research was supported by a Grand-in-Aid for Scientific Research by the Japan Society for the Promotion of Science (JSPS) under Grant Number JP20K06610 and by the Platform Project for Supporting Drug Discovery and Life Science Research [Basis for supporting Innovative Drug Discovery and Life Science Research (BINDS)] from AMED under Grant Number P20am0101108.</p>
      <p><italic toggle="yes">Conflict of Interest</italic>: none declared.</p>
    </sec>
  </ack>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="vbac015-B1">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Abadi</surname><given-names>M.</given-names></string-name></person-group><etal>et al</etal> (<year>2016</year>) TensorFlow: large-scale machine learning on heterogeneous distributed systems. <italic toggle="yes">arXiv</italic>. doi:<pub-id pub-id-type="doi">10.48550/arXiv.1603.04467</pub-id>.</mixed-citation>
    </ref>
    <ref id="vbac015-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Almagro</surname><given-names>J.C.</given-names></string-name></person-group><etal>et al</etal> (<year>2014</year>) <article-title>Second antibody modeling assessment (AMA-II)</article-title>. <source>Proteins</source>, <volume>82</volume>, <fpage>1553</fpage>–<lpage>1562</lpage>.<pub-id pub-id-type="pmid">24668560</pub-id></mixed-citation>
    </ref>
    <ref id="vbac015-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ambrosetti</surname><given-names>F.</given-names></string-name></person-group><etal>et al</etal> (<year>2020a</year>) <article-title>Modeling antibody-antigen complexes by information-driven docking</article-title>. <source>Structure</source>, <volume>28</volume>, <fpage>119</fpage>–<lpage>129</lpage>.<pub-id pub-id-type="pmid">31727476</pub-id></mixed-citation>
    </ref>
    <ref id="vbac015-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ambrosetti</surname><given-names>F.</given-names></string-name></person-group><etal>et al</etal> (<year>2020b</year>) <article-title>proABC-2: PRediction Of AntiBody Contacts v2 and its application to information-driven docking</article-title>. <source>Bioinformatics</source>, <volume>36</volume>, <fpage>5107</fpage>–<lpage>5108</lpage>.<pub-id pub-id-type="pmid">32683441</pub-id></mixed-citation>
    </ref>
    <ref id="vbac015-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Anishchenko</surname><given-names>I.</given-names></string-name></person-group><etal>et al</etal> (<year>2017</year>) <article-title>Modeling complexes of modeled proteins</article-title>. <source>Proteins</source>, <volume>85</volume>, <fpage>470</fpage>–<lpage>478</lpage>.<pub-id pub-id-type="pmid">27701777</pub-id></mixed-citation>
    </ref>
    <ref id="vbac015-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Baek</surname><given-names>M.</given-names></string-name></person-group><etal>et al</etal> (<year>2021</year>) <article-title>Accurate prediction of protein structures and interactions using a three-track neural network</article-title>. <source>Science</source>, <volume>373</volume>, <fpage>871</fpage>–<lpage>876</lpage>.<pub-id pub-id-type="pmid">34282049</pub-id></mixed-citation>
    </ref>
    <ref id="vbac015-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Basu</surname><given-names>S.</given-names></string-name>, <string-name><surname>Wallner</surname><given-names>B.</given-names></string-name></person-group> (<year>2016</year>) <article-title>DockQ: a quality measure for protein-protein docking models</article-title>. <source>PLoS One</source>, <volume>11</volume>, <fpage>e0161879</fpage>.<pub-id pub-id-type="pmid">27560519</pub-id></mixed-citation>
    </ref>
    <ref id="vbac015-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Bergstra</surname><given-names>J.</given-names></string-name>, <string-name><surname>Bengio</surname><given-names>Y.</given-names></string-name></person-group> (<year>2012</year>) <article-title>Random search for hyper-parameter optimization</article-title>. <source>J. Mach. Learn. Res</source>., <volume>13</volume>, <fpage>281</fpage>–<lpage>305</lpage>.</mixed-citation>
    </ref>
    <ref id="vbac015-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Berman</surname><given-names>H.M.</given-names></string-name></person-group> (<year>2000</year>) <article-title>The Protein Data Bank</article-title>. <source>Nucleic Acids Res</source>., <volume>28</volume>, <fpage>235</fpage>–<lpage>242</lpage>.<pub-id pub-id-type="pmid">10592235</pub-id></mixed-citation>
    </ref>
    <ref id="vbac015-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Bonnel</surname><given-names>N.</given-names></string-name>, <string-name><surname>Marteau</surname><given-names>P.F.</given-names></string-name></person-group> (<year>2012</year>) <article-title>LNA: fast protein structural comparison using a Laplacian characterization of tertiary structure</article-title>. <source>IEEE/ACM Trans. Comput. Biol. Bioinf</source>., <volume>9</volume>, <fpage>1451</fpage>–<lpage>1458</lpage>.</mixed-citation>
    </ref>
    <ref id="vbac015-B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Brouwer</surname><given-names>P.J.M.</given-names></string-name></person-group><etal>et al</etal> (<year>2020</year>) <article-title>Potent neutralizing antibodies from COVID-19 patients define multiple targets of vulnerability</article-title>. <source>Science</source>, <volume>369</volume>, <fpage>643</fpage>–<lpage>650</lpage>.<pub-id pub-id-type="pmid">32540902</pub-id></mixed-citation>
    </ref>
    <ref id="vbac015-B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Cao</surname><given-names>Y.</given-names></string-name></person-group><etal>et al</etal> (<year>2020</year>) <article-title>Potent neutralizing antibodies against SARS-CoV-2 identified by high-throughput single-cell sequencing of convalescent patients’ B cells</article-title>. <source>Cell</source>, <volume>182</volume>, <fpage>73</fpage>–<lpage>84</lpage>.<pub-id pub-id-type="pmid">32425270</pub-id></mixed-citation>
    </ref>
    <ref id="vbac015-B13">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Charif</surname><given-names>D.</given-names></string-name>, <string-name><surname>Lobry</surname><given-names>J.R.</given-names></string-name></person-group> (<year>2007</year>) <part-title>SeqinR 1.0-2: a contributed package to the R project for statistical computing devoted to biological sequences retrieval and analysis</part-title>. In: <person-group person-group-type="editor"><string-name><surname>Bastolla</surname><given-names>U.</given-names></string-name></person-group><etal>et al</etal> (eds.) <source>Structural Approaches to Sequence Evolution: Molecules, Networks, Populations</source>. <publisher-name>Springer</publisher-name>, <publisher-loc>Berlin, Heidelberg</publisher-loc>, pp. <fpage>207</fpage>–<lpage>232</lpage>.</mixed-citation>
    </ref>
    <ref id="vbac015-B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Chi</surname><given-names>X.</given-names></string-name></person-group><etal>et al</etal> (<year>2020</year>) <article-title>A neutralizing human antibody binds to the N-terminal domain of the Spike protein of SARS-CoV-2</article-title>. <source>Science</source>, <volume>369</volume>, <fpage>650</fpage>–<lpage>655</lpage>.<pub-id pub-id-type="pmid">32571838</pub-id></mixed-citation>
    </ref>
    <ref id="vbac015-B15">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Dominguez</surname><given-names>C.</given-names></string-name></person-group><etal>et al</etal> (<year>2003</year>) <article-title>HADDOCK: a protein-protein docking approach based on biochemical or biophysical information</article-title>. <source>J. Am. Chem. Soc</source>., <volume>125</volume>, <fpage>1731</fpage>–<lpage>1737</lpage>.<pub-id pub-id-type="pmid">12580598</pub-id></mixed-citation>
    </ref>
    <ref id="vbac015-B16">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Dunbar</surname><given-names>J.</given-names></string-name>, <string-name><surname>Deane</surname><given-names>C.M.</given-names></string-name></person-group> (<year>2016</year>) <article-title>ANARCI: antigen receptor numbering and receptor classification</article-title>. <source>Bioinformatics</source>, <volume>32</volume>, <fpage>298</fpage>–<lpage>300</lpage>.<pub-id pub-id-type="pmid">26424857</pub-id></mixed-citation>
    </ref>
    <ref id="vbac015-B17">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Evans</surname><given-names>R.</given-names></string-name></person-group><etal>et al</etal> (<year>2021</year>) Protein complex prediction with AlphaFold-Multimer. <italic toggle="yes">bioRxiv.</italic> doi:<pub-id pub-id-type="doi">10.1101/2021.10.04.463034</pub-id>.</mixed-citation>
    </ref>
    <ref id="vbac015-B18">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Fu</surname><given-names>L.</given-names></string-name></person-group><etal>et al</etal> (<year>2012</year>) <article-title>CD-HIT: accelerated for clustering the next-generation sequencing data</article-title>. <source>Bioinformatics</source>, <volume>28</volume>, <fpage>3150</fpage>–<lpage>3152</lpage>.<pub-id pub-id-type="pmid">23060610</pub-id></mixed-citation>
    </ref>
    <ref id="vbac015-B19">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Ghani</surname><given-names>U.</given-names></string-name></person-group><etal>et al</etal> (<year>2021</year>) Improved Docking of Protein Models by a Combination of Alphafold2 and ClusPro. <italic toggle="yes">bioRxiv</italic>. doi:<pub-id pub-id-type="doi">10.1101/2021.09.07.459290</pub-id>.</mixed-citation>
    </ref>
    <ref id="vbac015-B20">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Honegger</surname><given-names>A.</given-names></string-name>, <string-name><surname>Plückthun</surname><given-names>A.</given-names></string-name></person-group> (<year>2001</year>) <article-title>Yet another numbering scheme for immunoglobulin variable domains: an automatic modeling and analysis tool</article-title>. <source>J. Mol. Biol</source>., <volume>309</volume>, <fpage>657</fpage>–<lpage>670</lpage>.<pub-id pub-id-type="pmid">11397087</pub-id></mixed-citation>
    </ref>
    <ref id="vbac015-B21">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Hubbard</surname><given-names>S.J</given-names></string-name> and <string-name><surname>Thornton</surname><given-names>J.M.</given-names></string-name></person-group> (<year>1993</year>) <source>NACCESS <italic toggle="yes">Department of Biochemistry and Molecular Biology</italic></source>, <publisher-name>University College London</publisher-name>, <publisher-loc>London</publisher-loc>.</mixed-citation>
    </ref>
    <ref id="vbac015-B22">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Ioffe</surname><given-names>S.</given-names></string-name>, <string-name><surname>Szegedy</surname><given-names>C.</given-names></string-name></person-group> (<year>2015</year>) <source>Batch normalization: accelerating deep network training by reducing internal covariate shift</source>. <italic toggle="yes">arXiv.</italic> doi:<pub-id pub-id-type="doi">10.48550/arXiv.1502.03167</pub-id>.</mixed-citation>
    </ref>
    <ref id="vbac015-B23">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Jespersen</surname><given-names>M.C.</given-names></string-name></person-group><etal>et al</etal> (<year>2019</year>) <article-title>Antibody specific B-cell epitope predictions: leveraging information from antibody-antigen protein complexes</article-title>. <source>Front. Immunol</source>., <volume>10</volume>, <fpage>298</fpage>.<pub-id pub-id-type="pmid">30863406</pub-id></mixed-citation>
    </ref>
    <ref id="vbac015-B24">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Jumper</surname><given-names>J.</given-names></string-name></person-group><etal>et al</etal> (<year>2021</year>) <article-title>Highly accurate protein structure prediction with AlphaFold</article-title>. <source>Nature</source>, <volume>596</volume>, <fpage>583</fpage>–<lpage>889</lpage>.<pub-id pub-id-type="pmid">34265844</pub-id></mixed-citation>
    </ref>
    <ref id="vbac015-B25">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Kingma</surname><given-names>D.P.</given-names></string-name>, <string-name><surname>Ba</surname><given-names>J.</given-names></string-name></person-group> (<year>2014</year>) Adam: a method for stochastic optimization. <italic toggle="yes">arXiv.</italic> doi:<pub-id pub-id-type="doi">10.48550/arXiv.1412.6980</pub-id>.</mixed-citation>
    </ref>
    <ref id="vbac015-B26">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Klausen</surname><given-names>M.S.</given-names></string-name></person-group><etal>et al</etal> (<year>2015</year>) <article-title>LYRA, a webserver for lymphocyte receptor structural modeling</article-title>. <source>Nucleic Acids Res</source>., <volume>43</volume>, <fpage>W349</fpage>–<lpage>W355</lpage>.<pub-id pub-id-type="pmid">26007650</pub-id></mixed-citation>
    </ref>
    <ref id="vbac015-B27">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kozakov</surname><given-names>D.</given-names></string-name></person-group><etal>et al</etal> (<year>2006</year>) <article-title>PIPER: an FFT-based protein docking program with pairwise potentials</article-title>. <source>Proteins</source>, <volume>65</volume>, <fpage>392</fpage>–<lpage>406</lpage>.<pub-id pub-id-type="pmid">16933295</pub-id></mixed-citation>
    </ref>
    <ref id="vbac015-B28">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kozakov</surname><given-names>D.</given-names></string-name></person-group><etal>et al</etal> (<year>2017</year>) <article-title>The ClusPro web server for protein-protein docking</article-title>. <source>Nat. Protoc</source>., <volume>12</volume>, <fpage>255</fpage>–<lpage>278</lpage>.<pub-id pub-id-type="pmid">28079879</pub-id></mixed-citation>
    </ref>
    <ref id="vbac015-B29">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Krawczyk</surname><given-names>K.</given-names></string-name></person-group><etal>et al</etal> (<year>2014</year>) <article-title>Improving B-cell epitope prediction and its application to global antibody-antigen docking</article-title>. <source>Bioinformatics</source>, <volume>30</volume>, <fpage>2288</fpage>–<lpage>2294</lpage>.<pub-id pub-id-type="pmid">24753488</pub-id></mixed-citation>
    </ref>
    <ref id="vbac015-B30">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Krivov</surname><given-names>G.G.</given-names></string-name></person-group><etal>et al</etal> (<year>2009</year>) <article-title>Improved prediction of protein side-chain conformations with SCWRL4</article-title>. <source>Proteins</source>, <volume>77</volume>, <fpage>778</fpage>–<lpage>795</lpage>.<pub-id pub-id-type="pmid">19603484</pub-id></mixed-citation>
    </ref>
    <ref id="vbac015-B31">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kundrotas</surname><given-names>P.J.</given-names></string-name></person-group><etal>et al</etal> (<year>2018</year>) <article-title>Modeling CAPRI targets 110–120 by template-based and free docking using contact potential and combined scoring function</article-title>. <source>Proteins</source>, <volume>86</volume>, <fpage>302</fpage>–<lpage>310</lpage>.<pub-id pub-id-type="pmid">28905425</pub-id></mixed-citation>
    </ref>
    <ref id="vbac015-B32">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Leem</surname><given-names>J.</given-names></string-name></person-group><etal>et al</etal> (<year>2016</year>) <article-title>ABodyBuilder: automated antibody structure prediction with data-driven accuracy estimation</article-title>. <source>MAbs</source>, <volume>8</volume>, <fpage>1259</fpage>–<lpage>1268</lpage>.<pub-id pub-id-type="pmid">27392298</pub-id></mixed-citation>
    </ref>
    <ref id="vbac015-B33">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lensink</surname><given-names>M.F.</given-names></string-name>, <string-name><surname>Wodak</surname><given-names>S.J.</given-names></string-name></person-group> (<year>2013</year>) <article-title>Docking, scoring, and affinity prediction in CAPRI</article-title>. <source>Proteins</source>, <volume>81</volume>, <fpage>2082</fpage>–<lpage>2095</lpage>.<pub-id pub-id-type="pmid">24115211</pub-id></mixed-citation>
    </ref>
    <ref id="vbac015-B34">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Li</surname><given-names>S.</given-names></string-name></person-group><etal>et al</etal> (<year>2014</year>) <article-title>Quantifying sequence and structural features of protein–RNA interactions</article-title>. <source>Nucleic Acids Res</source>., <volume>42</volume>, <fpage>10086</fpage>–<lpage>10098</lpage>.<pub-id pub-id-type="pmid">25063293</pub-id></mixed-citation>
    </ref>
    <ref id="vbac015-B35">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Liberis</surname><given-names>E.</given-names></string-name></person-group><etal>et al</etal> (<year>2018</year>) <article-title>Parapred: antibody paratope prediction using convolutional and recurrent neural networks</article-title>. <source>Bioinformatics</source>, <volume>34</volume>, <fpage>2944</fpage>–<lpage>2950</lpage>.<pub-id pub-id-type="pmid">29672675</pub-id></mixed-citation>
    </ref>
    <ref id="vbac015-B36">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lis</surname><given-names>M.</given-names></string-name></person-group> (<year>2011</year>) <article-title>Bridging the gap between single-template and fragment based protein structure modeling using Spanner</article-title>. <source>Immunome Res</source>., <volume>7</volume>, <fpage>1</fpage>–<lpage>8</lpage>.</mixed-citation>
    </ref>
    <ref id="vbac015-B37">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Macindoe</surname><given-names>G.</given-names></string-name></person-group><etal>et al</etal> (<year>2010</year>) <article-title>HexServer: an FFT-based protein docking server powered by graphics processors</article-title>. <source>Nucleic Acids Res</source>., <volume>38</volume>, <fpage>W445</fpage>–<lpage>W449</lpage>.<pub-id pub-id-type="pmid">20444869</pub-id></mixed-citation>
    </ref>
    <ref id="vbac015-B39">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Pittala</surname><given-names>S.</given-names></string-name>, <string-name><surname>Bailey-Kellogg</surname><given-names>C.</given-names></string-name></person-group> (<year>2020</year>) <article-title>Learning context-aware structural representations to predict antigen and antibody binding interfaces</article-title>. <source>Bioinformatics</source>, <volume>36</volume>, <fpage>3996</fpage>–<lpage>4003</lpage>.<pub-id pub-id-type="pmid">32321157</pub-id></mixed-citation>
    </ref>
    <ref id="vbac015-B40">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Prechelt</surname><given-names>L.</given-names></string-name></person-group> (<year>1998</year>) <article-title>Automatic early stopping using cross validation: quantifying the criteria</article-title>. <source>Neural Netw</source>., <volume>11</volume>, <fpage>761</fpage>–<lpage>767</lpage>.<pub-id pub-id-type="pmid">12662814</pub-id></mixed-citation>
    </ref>
    <ref id="vbac015-B41">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ramírez-Aportela</surname><given-names>E.</given-names></string-name></person-group><etal>et al</etal> (<year>2016</year>) <article-title>FRODOCK 2.0: fast protein-protein docking server</article-title>. <source>Bioinformatics</source>, <volume>32</volume>, <fpage>2386</fpage>–<lpage>2388</lpage>.<pub-id pub-id-type="pmid">27153583</pub-id></mixed-citation>
    </ref>
    <ref id="vbac015-B42">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Richards</surname><given-names>F.M.</given-names></string-name></person-group> (<year>1977</year>) <article-title>Areas, volumes, packing, and protein structure</article-title>. <source>Annu. Rev. Biophys. Bioeng</source>., <volume>6</volume>, <fpage>151</fpage>–<lpage>176</lpage>.<pub-id pub-id-type="pmid">326146</pub-id></mixed-citation>
    </ref>
    <ref id="vbac015-B43">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Schneidman-Duhovny</surname><given-names>D.</given-names></string-name></person-group><etal>et al</etal> (<year>2005</year>) <article-title>PatchDock and SymmDock: servers for rigid and symmetric docking</article-title>. <source>Nucleic Acids Res</source>., <volume>33</volume>, <fpage>W363</fpage>–<lpage>W367</lpage>.<pub-id pub-id-type="pmid">15980490</pub-id></mixed-citation>
    </ref>
    <ref id="vbac015-B44">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Schritt</surname><given-names>D.</given-names></string-name></person-group><etal>et al</etal> (<year>2019</year>) <article-title>Repertoire Builder: high-throughput structural modeling of B and T cell receptors</article-title>. <source>Mol. Syst. Des. Eng</source>., <volume>4</volume>, <fpage>761</fpage>–<lpage>768</lpage>.</mixed-citation>
    </ref>
    <ref id="vbac015-B45">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Sela-Culang</surname><given-names>I.</given-names></string-name></person-group><etal>et al</etal> (<year>2015</year>) <article-title>Antibody specific epitope prediction-emergence of a new paradigm</article-title>. <source>Curr. Opin. Virol</source>., <volume>11</volume>, <fpage>98</fpage>–<lpage>102</lpage>.<pub-id pub-id-type="pmid">25837466</pub-id></mixed-citation>
    </ref>
    <ref id="vbac015-B46">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Sircar</surname><given-names>A.</given-names></string-name>, <string-name><surname>Gray</surname><given-names>J.J.</given-names></string-name></person-group> (<year>2010</year>) <article-title>SnugDock: paratope structural optimization during antibody-antigen docking compensates for errors in antibody homology models</article-title>. <source>PLoS Comput. Biol</source>., <volume>6</volume>, <fpage>e1000644</fpage>.<pub-id pub-id-type="pmid">20098500</pub-id></mixed-citation>
    </ref>
    <ref id="vbac015-B47">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Srivastava</surname><given-names>N.</given-names></string-name></person-group><etal>et al</etal> (<year>2014</year>) <article-title>Dropout: a simple way to prevent neural networks from overfitting</article-title>. <source>J. Mach. Learn. Res</source>., <volume>15</volume>, <fpage>1929</fpage>–<lpage>1958</lpage>.</mixed-citation>
    </ref>
    <ref id="vbac015-B48">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Tomii</surname><given-names>K.</given-names></string-name>, <string-name><surname>Akiyama</surname><given-names>Y.</given-names></string-name></person-group> (<year>2004</year>) <article-title>FORTE: a profile-profile comparison tool for protein fold recognition</article-title>. <source>Bioinformatics</source>, <volume>20</volume>, <fpage>594</fpage>–<lpage>595</lpage>.<pub-id pub-id-type="pmid">14764565</pub-id></mixed-citation>
    </ref>
    <ref id="vbac015-B49">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Vreven</surname><given-names>T.</given-names></string-name></person-group><etal>et al</etal> (<year>2015</year>) <article-title>Updates to the integrated protein–protein interaction benchmarks: docking benchmark version 5 and affinity benchmark version 2</article-title>. <source>J. Mol. Biol</source>., <volume>427</volume>, <fpage>3031</fpage>–<lpage>3041</lpage>.<pub-id pub-id-type="pmid">26231283</pub-id></mixed-citation>
    </ref>
    <ref id="vbac015-B50">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Yamada</surname><given-names>K.D.</given-names></string-name>, <string-name><surname>Kinoshita</surname><given-names>K.</given-names></string-name></person-group> (<year>2018</year>) <article-title>De novo profile generation based on sequence context specificity with the long short-term memory network</article-title>. <source>BMC Bioinformatics</source>, <volume>19</volume>, <fpage>271</fpage>.<pub-id pub-id-type="pmid">30016933</pub-id></mixed-citation>
    </ref>
    <ref id="vbac015-B51">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Youden</surname><given-names>W.J.</given-names></string-name></person-group> (<year>1950</year>) <article-title>Index for rating diagnostic tests</article-title>. <source>Cancer</source>, <volume>3</volume>, <fpage>32</fpage>–<lpage>35</lpage>.<pub-id pub-id-type="pmid">15405679</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
