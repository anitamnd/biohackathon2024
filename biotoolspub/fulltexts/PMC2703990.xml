<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD Journal Publishing DTD v2.3 20070202//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName journalpublishing.dtd?>
<?SourceDTD.Version 2.3?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 2?>
<front>
  <?epub June-3-2009?>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Nucleic Acids Res</journal-id>
    <journal-id journal-id-type="iso-abbrev">Nucleic Acids Res</journal-id>
    <journal-id journal-id-type="publisher-id">nar</journal-id>
    <journal-id journal-id-type="hwp">nar</journal-id>
    <journal-title-group>
      <journal-title>Nucleic Acids Research</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">0305-1048</issn>
    <issn pub-type="epub">1362-4962</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">2703990</article-id>
    <article-id pub-id-type="pmid">19494180</article-id>
    <article-id pub-id-type="doi">10.1093/nar/gkp479</article-id>
    <article-id pub-id-type="publisher-id">gkp479</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Articles</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title><italic>mGene.web</italic>: a web service for accurate computational gene finding</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Schweikert</surname>
          <given-names>Gabriele</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="AFF1">
          <sup>2</sup>
        </xref>
        <xref ref-type="aff" rid="AFF1">
          <sup>3</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Behr</surname>
          <given-names>Jonas</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Zien</surname>
          <given-names>Alexander</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="AFF1">
          <sup>4</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Zeller</surname>
          <given-names>Georg</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="AFF1">
          <sup>3</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Ong</surname>
          <given-names>Cheng Soon</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="AFF1">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Sonnenburg</surname>
          <given-names>Sören</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Rätsch</surname>
          <given-names>Gunnar</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">
          <sup>1</sup>
        </xref>
        <xref ref-type="corresp" rid="COR1">*</xref>
      </contrib>
    </contrib-group>
    <aff id="AFF1"><sup>1</sup>Friedrich Miescher Laboratory, Max Planck Society, <sup>2</sup>Department for Empirical Inference, Max Planck Institute for Biological Cybernetics, <sup>3</sup>Department for Molecular Biology, Max Planck Institute for Developmental Biology Tübingen, Germany and <sup>4</sup>Department for Intelligent Data Analysis, Fraunhofer Institute FIRST, Berlin, Germany</aff>
    <author-notes>
      <corresp id="COR1">*To whom correspondence should be addressed. Tel: <phone>+49 7071 601 820</phone>; Fax: <fax>+49 7071 601 801</fax>; Email: <email>gunnar.raetsch@tuebingen.mpg.de</email></corresp>
    </author-notes>
    <pub-date pub-type="ppub">
      <day>1</day>
      <month>7</month>
      <year>2009</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>3</day>
      <month>6</month>
      <year>2009</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>3</day>
      <month>6</month>
      <year>2009</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the
							<pub-date pub-type="epub"/>. -->
    <volume>37</volume>
    <issue>Web Server issue</issue>
    <fpage>W312</fpage>
    <lpage>W316</lpage>
    <history>
      <date date-type="received">
        <day>5</day>
        <month>3</month>
        <year>2009</year>
      </date>
      <date date-type="rev-recd">
        <day>7</day>
        <month>5</month>
        <year>2009</year>
      </date>
      <date date-type="accepted">
        <day>17</day>
        <month>5</month>
        <year>2009</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© 2009 The Author(s)</copyright-statement>
      <copyright-year>2009</copyright-year>
      <license license-type="creative-commons" xlink:href="http://creativecommons.org/licenses/by-nc/2.0/uk/">
        <license-p><!--CREATIVE COMMONS-->This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by-nc/2.0/uk/">http://creativecommons.org/licenses/by-nc/2.0/uk/</ext-link>) which permits unrestricted non-commercial use, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <abstract>
      <p>We describe mGene.web, a web service for the genome-wide prediction of protein coding genes from eukaryotic DNA sequences. It offers pre-trained models for the recognition of gene structures including untranslated regions in an increasing number of organisms. With mGene.web, users have the additional possibility to train the system with their own data for other organisms on the push of a button, a functionality that will greatly accelerate the annotation of newly sequenced genomes. The system is built in a highly modular way, such that individual components of the framework, like the promoter prediction tool or the splice site predictor, can be used autonomously. The underlying gene finding system mGene is based on discriminative machine learning techniques and its high accuracy has been demonstrated in an international competition on nematode genomes. mGene.web is available at <ext-link ext-link-type="uri" xlink:href="http://www.mgene.org/web">http://www.mgene.org/web</ext-link>, it is free of charge and can be used for eukaryotic genomes of small to moderate size (several hundred Mbp).</p>
    </abstract>
  </article-meta>
</front>
<body>
  <sec>
    <title>INTRODUCTION</title>
    <p>In recent years, the biological community has started to see the dramatic impact of new sequencing technologies on the number of sequenced genomes, and it is expected that this influx of data will continue to escalate in the near future. The demand for efficient, highly automated DNA sequence analysis tools is therefore greater than ever. In particular, we expect that the task of genome annotation will increasingly be performed by individual labs rather than large sequencing centers with dedicated resources and specialized expertise. One of the most important sub-tasks in such an annotation pipeline is the identification of protein coding genes. It requires a computational gene finding system that (i) is highly accurate, (ii) produces genome-wide predictions within a reasonable time, (iii) is easy to use even for researchers with no programming experience and (iv) is applicable to a large variety of newly sequenced organisms. Since computational gene finding has a long tradition in bioinformatics research, there have been constant advancements toward this goal. In particular, the accuracy of computational gene finding systems has steadily been improved, most recently by the introduction of discriminative machine learning techniques (<xref ref-type="bibr" rid="B1">1</xref>). However, for this new generation of algorithms, such as mSplicer (14), Craig (<xref ref-type="bibr" rid="B2">2</xref>), Conrad (<xref ref-type="bibr" rid="B3">3</xref>), Contrast (<xref ref-type="bibr" rid="B4">4</xref>), and mGene (Schweikert <italic>et al.</italic>, under review), there is no easy-to-use web application available. To employ these tools, the respective packages have to be downloaded and installed, which in some cases requires substantial programming knowledge as well as the accessibility of sufficient computational power for each user. On the other hand, some of the conventional state-of-the-art gene finders that use generative models, such as Fgenesh (<xref ref-type="bibr" rid="B5">5</xref>) and Augustus (<xref ref-type="bibr" rid="B6">6</xref>) offer web services, however, without the functionality of training on data provided by the user. Yet, this is essential for accurate annotation of newly sequenced organisms, as models trained on sequences derived from other organisms may produce highly incorrect predictions (<xref ref-type="bibr" rid="B7">7</xref>). In 2008, Ter-Hovhannisyan <italic>et al.</italic> introduced a new <italic>ab initio</italic> algorithm, GeneMark-ES, that performs unsupervised self-training on anonymous eukaryotic sequences (<xref ref-type="bibr" rid="B8">8</xref>). Currently, there is no web service available for GeneMark-ES, in contrast to their self-training prediction program for prokaryotic genomes, GeneMark-S (<xref ref-type="bibr" rid="B9">9</xref>). Therefore, to the best of our knowledge, to date no system completely satisfies all the above criteria. We help to close this gap by providing the web service mGene.web that produces highly accurate predictions, is easy to use and allows comfortable training on new data. The high performance of the underlying system mGene (G. Schweikert, under review) has been demonstrated in the international nGASP competition on nematode genomes [<xref ref-type="table" rid="T1">Table 1</xref> and (<xref ref-type="bibr" rid="B10">10</xref>)]. When considering the average of sensitivity and specificity the evaluated developmental version of mGene exhibited the best prediction performance on nucleotide, exon and transcript level for the <italic>ab initio</italic> task, and was only slightly worse than Augustus on the gene level. While we have little knowledge on subsequent developments of other participants, we have continued to improve our system after the competition. The fully developed version shows the best performance on all four levels compared with the submitted predictions (<xref ref-type="table" rid="T1">Table 1</xref>). Additionally, we have verified mGene's high accuracy by biological validation experiments (G. Schweikert, under review).
<table-wrap id="T1" position="float"><label>Table 1.</label><caption><p>Comparison of the top-performing gene finding systems in the <italic>ab initio</italic> setting of the nGASP challenge (<xref ref-type="bibr" rid="B10">10</xref>)</p></caption><table frame="hsides" rules="groups"><thead align="left"><tr><th rowspan="1" colspan="1">Method</th><th colspan="3" align="center" rowspan="1">Nucleotide<hr/></th><th colspan="3" align="center" rowspan="1">Exon<hr/></th><th colspan="3" align="center" rowspan="1">Transcript<hr/></th><th colspan="3" align="center" rowspan="1">Gene<hr/></th></tr><tr><th rowspan="1" colspan="1"/><th align="center" rowspan="1" colspan="1">Sn</th><th align="center" rowspan="1" colspan="1">Sp</th><th align="center" rowspan="1" colspan="1"><inline-graphic xlink:href="gkp479i1.jpg"/></th><th align="center" rowspan="1" colspan="1">Sn</th><th align="center" rowspan="1" colspan="1">Sp</th><th align="center" rowspan="1" colspan="1"><inline-graphic xlink:href="gkp479i1.jpg"/></th><th align="center" rowspan="1" colspan="1">Sn</th><th align="center" rowspan="1" colspan="1">Sp</th><th align="center" rowspan="1" colspan="1"><inline-graphic xlink:href="gkp479i1.jpg"/></th><th align="center" rowspan="1" colspan="1">Sn</th><th align="center" rowspan="1" colspan="1">Sp</th><th align="center" rowspan="1" colspan="1"><inline-graphic xlink:href="gkp479i1.jpg"/></th></tr></thead><tbody align="left"><tr><td rowspan="1" colspan="1">mGene.init</td><td align="center" rowspan="1" colspan="1">96.8</td><td align="center" rowspan="1" colspan="1">90.9</td><td align="center" rowspan="1" colspan="1">93.8</td><td align="center" rowspan="1" colspan="1">85.1</td><td align="center" rowspan="1" colspan="1">80.2</td><td align="center" rowspan="1" colspan="1"><bold>82.6</bold></td><td align="center" rowspan="1" colspan="1">49.6</td><td align="center" rowspan="1" colspan="1">42.3</td><td align="center" rowspan="1" colspan="1"><bold>45.9</bold></td><td align="center" rowspan="1" colspan="1">60.7</td><td align="center" rowspan="1" colspan="1">42.3</td><td align="center" rowspan="1" colspan="1"><bold>51.5</bold></td></tr><tr><td rowspan="1" colspan="1">mGene.init (dev)</td><td align="center" rowspan="1" colspan="1">96.9</td><td align="center" rowspan="1" colspan="1">91.6</td><td align="center" rowspan="1" colspan="1"><bold>94.2</bold></td><td align="center" rowspan="1" colspan="1">84.2</td><td align="center" rowspan="1" colspan="1">78.6</td><td align="center" rowspan="1" colspan="1">81.4</td><td align="center" rowspan="1" colspan="1">44.3</td><td align="center" rowspan="1" colspan="1">38.7</td><td align="center" rowspan="1" colspan="1">41.5</td><td align="center" rowspan="1" colspan="1">54.3</td><td align="center" rowspan="1" colspan="1">40.1</td><td align="center" rowspan="1" colspan="1">47.2</td></tr><tr><td rowspan="1" colspan="1">Craig</td><td align="center" rowspan="1" colspan="1">95.5</td><td align="center" rowspan="1" colspan="1">90.9</td><td align="center" rowspan="1" colspan="1">93.2</td><td align="center" rowspan="1" colspan="1">80.3</td><td align="center" rowspan="1" colspan="1">78.2</td><td align="center" rowspan="1" colspan="1">79.2</td><td align="center" rowspan="1" colspan="1">35.7</td><td align="center" rowspan="1" colspan="1">35.4</td><td align="center" rowspan="1" colspan="1">35.6</td><td align="center" rowspan="1" colspan="1">43.7</td><td align="center" rowspan="1" colspan="1">35.4</td><td align="center" rowspan="1" colspan="1">39.6</td></tr><tr><td rowspan="1" colspan="1">Fgenesh</td><td align="center" rowspan="1" colspan="1">98.2</td><td align="center" rowspan="1" colspan="1">87.1</td><td align="center" rowspan="1" colspan="1">92.7</td><td align="center" rowspan="1" colspan="1">86.4</td><td align="center" rowspan="1" colspan="1">73.6</td><td align="center" rowspan="1" colspan="1">80.0</td><td align="center" rowspan="1" colspan="1">47.1</td><td align="center" rowspan="1" colspan="1">34.1</td><td align="center" rowspan="1" colspan="1">40.6</td><td align="center" rowspan="1" colspan="1">57.7</td><td align="center" rowspan="1" colspan="1">34.1</td><td align="center" rowspan="1" colspan="1">45.9</td></tr><tr><td rowspan="1" colspan="1">Augustus</td><td align="center" rowspan="1" colspan="1">97.0</td><td align="center" rowspan="1" colspan="1">89.0</td><td align="center" rowspan="1" colspan="1">93.0</td><td align="center" rowspan="1" colspan="1">86.1</td><td align="center" rowspan="1" colspan="1">72.6</td><td align="center" rowspan="1" colspan="1">79.3</td><td align="center" rowspan="1" colspan="1">52.9</td><td align="center" rowspan="1" colspan="1">28.6</td><td align="center" rowspan="1" colspan="1">40.8</td><td align="center" rowspan="1" colspan="1">64.4</td><td align="center" rowspan="1" colspan="1">34.5</td><td align="center" rowspan="1" colspan="1">49.4</td></tr></tbody></table><table-wrap-foot><fn><p>Shown are sensitivity (Sn), specificity (Sp) and their average (each in percent) on nucleotide, exon, transcript and gene levels (if several submissions were made for one method, we chose the version with the best gene level average of sensitivity and specificity). The predictions of mGene.init were prepared after the deadline but strictly adhering to the rules and conditions of the nGASP challenge. The result of the best-performing method according to each of the evaluation levels is set in bold face. The evaluation is based on the submitted sets of the participants and performed with our own routine. The numbers slightly deviate from the official nGASP evaluation on the transcript and gene level due to minor differences in the evaluation criteria. These differences, however, do not change the ranking.</p></fn></table-wrap-foot></table-wrap></p>
    <p>Our web server mGene.web provides a convenient interface to mGene for use within the Galaxy framework (<xref ref-type="bibr" rid="B11">11</xref>), which also offers handy access to existing genome annotation databases as well as other computational tools. In contrast to most other systems, mGene.web easily allows users to train the prediction model for new genomes. Furthermore, due to the modular structure of mGene.web, the individual sub-tools can be employed independently to predict signals on the DNA, for example transcription starts or splice sites. These predictors are themselves carefully crafted and highly accurate (<xref ref-type="bibr" rid="B12">12</xref>,<xref ref-type="bibr" rid="B13">13</xref>). However, in combination with Galaxy workflows, the individual units can also easily be replaced by the user when other, possibly more advanced tools for a given sub-task become available. We expect that this particular feature may guide the systematic exploration of further improvements in the complex process of computational gene finding, thereby ultimately leading to more accurate gene predictions.</p>
  </sec>
  <sec>
    <title>METHODS: mGene</title>
    <p>The precise method for computing accurate gene segmentations employed in mGene is described in detail in (G. Schweikert, under review). Here, we only give a short sketch of the underlying technique, which will help to understand how mGene.web works.</p>
    <p>Gene finding can be viewed as a segmentation task, where a piece of genomic DNA has to be properly segmented into genic components, e.g. intergenic regions, UTRs, exons and introns. Such a segmentation is characterized by <italic>signals</italic> on the genomic DNA that demarcate individual segment boundaries, for instance, splice sites that delineate introns. Each segment type further exhibits a characteristic sequence <italic>content</italic>, e.g. nucleotide triplets characteristic of coding sequence.</p>
    <p>We have taken a two-layered approach and subdivided the problem of gene finding into several sub-tasks that can be solved independently of each other. These tasks include the detection of sequence signals and segment contents. We provide six signal sensors for the detection of transcription start and stop sites, translation initiation and termination sites, as well as donor and acceptor splice sites (<xref ref-type="bibr" rid="B12 B13 B14 B15">12–15</xref>). In addition to the signal sensors, we have devised content sensors, which use the sequence of complete segments as input to predict the segment type, i.e. intergenic, 5′-UTR, coding exon, intron or 3′-UTR. Each of these prediction problems is approached with a large-scale implementation of support vector machines using string kernels (as implemented in the Shogun toolbox) that are specifically designed to accurately identify signals and content types [<xref ref-type="bibr" rid="B16">16</xref>, and references therein].</p>
    <p>In the second layer, the individual signal and content predictions are reconciled according to a model for gene structures (<xref ref-type="fig" rid="F1">Figure 1</xref>), thereby solving the segmentation task. For this we employ hidden semi-Markov support vector machines (HSM-SVMs) (<xref ref-type="bibr" rid="B17">17</xref>), an approach that is conceptually similar to generalized hidden Markov models (gHMMs) (<xref ref-type="bibr" rid="B18">18</xref>) in that they are both based on a state-transition model which explicitly parameterizes segment lengths. However, in contrast to generative gHMMs, HSM-SVMs are trained discriminatively. For prediction we use dynamic programming to determine the highest scoring segmentation according to the trained model parameters, thereby predicting accurate gene structures even for new sequences [see for details (<xref ref-type="bibr" rid="B15">15</xref>,<xref ref-type="bibr" rid="B17">17</xref>) and (G. Schweikert, under review)].
<fig id="F1" position="float"><label>Figure 1.</label><caption><p>Simplified gene model underlying mGene: the vertices correspond to recognizable signals on the DNA, i.e. transcription start sites (TSSs), translation initiation sites (TISs), acceptor splice sites (Acc<sub>5′</sub>, Acc<sub><italic>cds</italic></sub> and Acc<sub>3′</sub>), donor splice sites (Don<sub>5′</sub>, Don<sub><italic>cds</italic></sub> and Don<sub>3′</sub>), translation termination sites (Stop) and cleavage sites (cleave). The edges correspond to segments associated with the content types for 5′-UTR, coding (CDS) exon, intron, 3′-UTR and intergenic sequences.</p></caption><graphic xlink:href="gkp479f1"/></fig></p>
  </sec>
  <sec>
    <title>WEB SERVER</title>
    <p>Essentially, there are two possibilities to use mGene.web for gene predictions: the simplest way is to use the monolithic tools mGenePredict and mGeneTrain. However, for a more flexible use and a more detailed output, one can also use the individual modules together with workflows. In this case, the user has the advantage of accessing intermediate results of the gene prediction task; for example, the outputs of the signal and content sensors can be monitored. Additionally, the progress can be easily observed as the individual tasks are completed. If only sub-tasks should be performed, e.g. the prediction of splice sites, the individual tools can be applied independently. Each option will be described below, and more instructions are provided at <ext-link ext-link-type="uri" xlink:href="http://www.mgene.org/web">http://www.mgene.org/web</ext-link>.</p>
    <sec>
      <title>mGene.web monoliths</title>
      <p>For organisms that are already in the list of pre-trained models, the simplest way to annotate a genome sequence with mGene.web is to use mGenePredict. This function only requires a FASTA file with the DNA sequence as input and it outputs the GFF3 file containing gene predictions. In case one wishes to annotate a genome for which no suitable pre-trained model exists, mGeneTrain can be used to train a new model. This tool takes a FASTA file with the DNA and a GFF3 file with a set of known genes as input and returns a trained mGene predictor (TmGP) object that can be used together with mGenePredict in order to predict genes on given DNA sequences. The predictor and the predictions can be easily shared with other users via Galaxy's ‘share history’ functionality. We also offer the tool mGeneEval to compare two GFF3 files, presumable one containing the ground truth (an annotation file) and another one containing the predictions. The resulting performance report includes sensitivity and specificity values on nucleotide, exon, transcript and gene level as well as for several signals (like transcription start and stop site) and enables a convenient quality control. For instructions and example runs go to mGene.web → <italic>Examples and Instructions</italic> and <ext-link ext-link-type="uri" xlink:href="http://www.mgene.org/web/examples">http://www.mgene.org/web/examples</ext-link>.</p>
    </sec>
    <sec>
      <title>mGene.web workflows</title>
      <p>Recently, Galaxy has started to support workflows that allow pre-defining the order in which tools are applied to data files (including original inputs or interim results) in order to achieve a certain goal. These workflows can be edited by, and shared among users. Workflows can help to simplify the relatively complex process of creating a gene finding system which involves many different steps. In order to run a workflow, one only needs to specify a few input arguments. As a result one obtains, for instance, the gene predictions as well as intermediate results allowing detailed inspection. Analogous to the simple black-box versions, we provide two workflows (The monolithic workflows described above are equivalent to the modular versions. They show less internal details and are slightly more efficient): mGenePredict and mGeneTrain. For more information go to mGene.web workflows → <italic>Examples and Instructions</italic> or <ext-link ext-link-type="uri" xlink:href="http://www.mgene.org/web/workflows">http://www.mgene.org/web/workflows</ext-link>. There, you will also find instructions on how to built new workflows, in which individual tools are replaced by other, potentially improved ones.</p>
    </sec>
    <sec>
      <title>mGene.web modules</title>
      <p>The web service currently provides 14 core modules. They can be grouped into four groups: data preparation; signal training and prediction; content training and prediction; and gene structure training and prediction. Each tool requires a set of inputs and provides at least one output. They are managed by the Galaxy system according to their data types. We use the following data types for data exchange between the modules: FASTA (genomic DNA), GFF3 (genome annotation and gene prediction), SPF (signal prediction format) and CPF (content prediction format). Files in these formats can either be provided by uploading or by running one of the tools. Additionally, we have some data formats representing internal data structures, including the Genome Information Object (GIO) to describe a genome-wide sequence with all its contigs or chromosomes, the Annotation Gene Structure (AGS), as an efficient internal representation of genes, the Trained Signal Predictor (TSP), the Trained Content Predictor (TCP) and the Trained Gene Predictor (TGP) that include all learnt parameters necessary to predict a given signal, content or gene structure, respectively. Eventually, the trained mGene predictor (TmGP) contains all above-mentioned parameters and can be used to predict genes from scratch when given a DNA sequence. (Note that the TGP object contains the parameters learnt during training layer 2 only, while the TmGP contains <italic>all</italic> parameters necessary to predict genes.) In the following, the individual modules are explained in more detail (see also mGene.web modules → <italic>Examples and Instructions</italic> and <ext-link ext-link-type="uri" xlink:href="http://www.mgene.org/web/modules">http://www.mgene.org/web/modules</ext-link>.</p>
    </sec>
    <sec>
      <title>Data preparation</title>
      <p>GenomeTool needs a file in FASTA format containing genomic sequences as input that allows it to create a genome object, stored in a GIO, to be used by other mGene modules. Additionally, one may create a GIO from an internal database of more than 50 genomes.</p>
      <p>GFF2Anno reads an annotation file in GFF3 or GTF format and uses it to generate an AGS. It provides predefined settings for commonly used GFF-encoding conventions, but also permits specific settings needed for less common encoding choices.</p>
    </sec>
    <sec>
      <title>Signal prediction</title>
      <p>Anno2SignalLabel uses an AGS to collect labeled genomic positions for the selected genomic signal. Possible signals include transcription start and stop sites, translation initiation and termination sites, as well as donor and acceptor splice sites. It uses the regions covered by annotated features to generate negative examples at all consensus positions unless they were annotated as true sites. The output is a file in SPF providing chromosome/contig name, position, strand and the label of the example.</p>
      <p>SignalTrain trains a signal predictor using SVMs with pre-selected kernels for each signal. Input is a GIO and an SPF file with labeled genomic positions. The output is a TSP that can be used with SignalPredict to perform predictions on genomic sequences.</p>
      <p>SignalPredict uses a GIO and TSP to predict signals on the given DNA sequences. The output is given in SPF.</p>
      <p>SignalEval takes a label file and a prediction file (both SPF files) as input and computes several accuracy measures for the predictions, including the areas under the Receiver Operator Curve (ROC) and the Precision Recall Curve (PRC). This tool is useful for prediction quality monitoring.</p>
    </sec>
    <sec>
      <title>Content prediction</title>
      <p>Anno2ContentLabel collects labeled genomic segments for the selected content types, analogous to Anno2SignalLabel. Possible content types include 5′-UTR, exonic, intronic, 3′-UTR and intergenic. Any segment included that is not of the specified type is used as a negative example. The output is a file in CPF providing chromosome/contig name, start position, end position, strand and the label of the example.</p>
      <p>ContentTrain is analogous to SignalTrain, with a GIO and an SPF file as inputs and a TCP object as output.</p>
      <p>ContentPredict is analogous to SignalPredict, with a GIO and a TCP as input and an SPF file as output.</p>
      <p>ContentEval, analogous to SignalEval, takes a CPF and SPF file as input and performs the performance evaluation.</p>
    </sec>
    <sec>
      <title>Gene prediction</title>
      <p>GeneTrain trains the second layer of mGene.web. Based on the GIO, genome-wide predictions for all relevant signals and content types, and a set of annotated genes, GeneTrain learns to predict gene structures from genomic DNA. The output is an internal data structure containing the TGP that can be used with GenePredict to predict genes.</p>
      <p>GenePredict uses the TGP (either from the current history or from a list of pre-trained predictors) as well as genome-wide signal and content predictions to predict genes from the provided DNA sequences. The output is provided as a GFF3 file.</p>
      <p>GeneEval takes two GFF3 files, one containing an annotation, the other the genome-wide gene predictions, and evaluates the prediction performance by comparing the two annotations. Note that the annotated genes should be distinct from the annotated genes used for training, otherwise the training error will be reported. Evaluation criteria include sensitivity and specificity on nucleotide, exon and gene levels [(<xref ref-type="bibr" rid="B10">10</xref>) and (G. Schweikert, under review) for further details].</p>
      <p>ComposeMGenePredictor bundles all necessary trained signal, content and gene predictor objects into a TmGP that can be used with mGenePredict to predict genes.</p>
    </sec>
  </sec>
  <sec>
    <title>COMPUTING TIME AND RESOURCES</title>
    <p>The web service is running on a cluster with 84 AMD Opteron CPUs (2.2 GHz) with 8 GB of RAM per four CPUs which is shared with other web services. Training and prediction is split into several parallel sub-tasks in order to reduce the waiting time for users. Depending on the load of the cluster, whole-genome prediction of all six signals for the <italic>Caenorhabditis elegans</italic> genome (100 Mbp) takes ∼24 h (about ≈500 kbp/min), the prediction of the five content types also takes about 2 h (about ≈1 Mbp/min), and gene prediction using these signals takes ∼6 h (∼300 kbp/min). The time for training the predictors strongly depends on the amount of available training data. While signal or content sensor training can typically be completed for a genome like that of <italic>C. elegans</italic> within a few hours, training the second layer of mGene.web may take 48 h (depending on the size of the training set).</p>
    <p>For well-annotated genomes, extensive annotations exist. In these cases, we have to limit the amount of data used for training the system (due to the relatively high memory and computing time demand). In these cases, we sub-sample the data and may therefore obtain sub-optimal results compared with including all data. mGene.web currently works best for a few well-annotated regions of a genome with chromosomes/contigs of size &lt;20 Mb, including at least a few hundred and at most a few thousand genes. Currently, the speed of the system is severely influenced by the number of chromosomes/contigs, as each one is processed separately. Moreover, there are a few built-in settings that are more suitable for organisms with compact genomes, for instance, that introns have to be shorter than 20 kb. We intend to make these options configurable in the near future.</p>
  </sec>
  <sec>
    <title>DISCUSSION AND OUTLOOK</title>
    <p>To the best of our knowledge, with mGene.web we currently provide the only web service that offers both prediction and complete training of a gene finding system for eukaryotic genomes. The underlying Galaxy framework greatly facilitates the data acquisition and supports workflows that appear very useful for the rather complex processes needed for genome annotations. In particular, it follows simple and standardized interfaces for data processing, training, prediction and evaluation. Advanced users may take advantage of the modular nature of mGene.web and compose their own Galaxy workflows. This should facilitate the incorporation of new developments and improvements of individual modules and will therefore be of great value for the advancement of gene finding systems.</p>
    <p>In addition to the existing features, we will soon extend our web service in several respects. First, we will allow the utilization of additional data sources, such as EST or whole-genome alignments, as implemented in mGene.seq and mGene.multi (G. Schweikert, under review). Another line of improvements will aim at providing more advanced tools for the alignment of sequences of mRNA and orthologous proteins, thereby generating initial gene annotations for training. This will be an important step toward our next goal, to offer accurate gene prediction services for new genomes requiring no or considerably fewer known genes for training an accurate predictor.</p>
  </sec>
  <sec>
    <title>FUNDING</title>
    <p>Funding for open access charge: Friedrich Miescher Laboratory of the Max Planck Society.</p>
    <p><italic>Conflict of interest statement</italic>. None declared.</p>
  </sec>
</body>
<back>
  <ack>
    <title>ACKNOWLEDGEMENTS</title>
    <p>We gratefully acknowledge the great support we received from the Galaxy development team at Penn State University, in particular James Taylor. Moreover, we would like to thank Fabio De Bona for developing an Octave interface to the MOSEK optimization toolbox as well as Peter Niermann and Zhiqin Huang for integrating new genomes and testing the system.</p>
  </ack>
  <fn-group>
    <fn>
      <p>Present address: Cheng Soon Ong, Department of Computer Science, ETH, Zürich, Switzerland.</p>
    </fn>
    <fn>
      <p>The authors wish it to be known that, in their opinion, the first two authors should be regarded as joint First Authors.</p>
    </fn>
  </fn-group>
  <ref-list>
    <title>REFERENCES</title>
    <ref id="B1">
      <label>1</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Brent</surname>
            <given-names>MR</given-names>
          </name>
        </person-group>
        <article-title>Steady progress and recent breakthroughs in the accuracy of automated genome annotation</article-title>
        <source>Nat. Rev. Genet.</source>
        <year>2008</year>
        <volume>9</volume>
        <fpage>62</fpage>
        <lpage>73</lpage>
        <pub-id pub-id-type="pmid">18087260</pub-id>
      </element-citation>
    </ref>
    <ref id="B2">
      <label>2</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bernal</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Crammer</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Hatzigeorgiou</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Pereira</surname>
            <given-names>F</given-names>
          </name>
        </person-group>
        <article-title>Global discriminative learning for higher-accuracy computational gene prediction</article-title>
        <source>PLoS Comput. Biol.</source>
        <year>2007</year>
        <volume>3</volume>
        <fpage>e54</fpage>
        <pub-id pub-id-type="pmid">17367206</pub-id>
      </element-citation>
    </ref>
    <ref id="B3">
      <label>3</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>DeCaprio</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Vinson</surname>
            <given-names>JP</given-names>
          </name>
          <name>
            <surname>Pearson</surname>
            <given-names>MD</given-names>
          </name>
          <name>
            <surname>Montgomery</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Doherty</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Galagan</surname>
            <given-names>JE</given-names>
          </name>
        </person-group>
        <article-title>Conrad: gene prediction using conditional random fields</article-title>
        <source>Genome Res.</source>
        <year>2007</year>
        <volume>17</volume>
        <fpage>1389</fpage>
        <lpage>1398</lpage>
        <pub-id pub-id-type="pmid">17690204</pub-id>
      </element-citation>
    </ref>
    <ref id="B4">
      <label>4</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gross</surname>
            <given-names>SS</given-names>
          </name>
          <name>
            <surname>Brent</surname>
            <given-names>MR</given-names>
          </name>
        </person-group>
        <article-title>Using multiple alignments to improve gene prediction</article-title>
        <source>Comput. Biol.</source>
        <year>2006</year>
        <volume>13</volume>
        <fpage>379</fpage>
        <lpage>393</lpage>
      </element-citation>
    </ref>
    <ref id="B5">
      <label>5</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Salamov</surname>
            <given-names>AA</given-names>
          </name>
          <name>
            <surname>Solovyev</surname>
            <given-names>VV</given-names>
          </name>
        </person-group>
        <article-title>Ab initio gene finding in Drosophila genomic DNA</article-title>
        <source>Genome Res.</source>
        <year>2000</year>
        <volume>10</volume>
        <fpage>516</fpage>
        <lpage>522</lpage>
        <pub-id pub-id-type="pmid">10779491</pub-id>
      </element-citation>
    </ref>
    <ref id="B6">
      <label>6</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Stanke</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Schoffmann</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Morgenstern</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Waack</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Gene prediction in eukaryotes with a generalized hidden Markov model that uses hints from external sources</article-title>
        <source>BMC Bioinf.</source>
        <year>2006</year>
        <volume>7</volume>
        <fpage>62</fpage>
      </element-citation>
    </ref>
    <ref id="B7">
      <label>7</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Korf</surname>
            <given-names>I</given-names>
          </name>
        </person-group>
        <article-title>Gene finding in novel genomes</article-title>
        <source>BMC Bioinf.</source>
        <year>2004</year>
        <volume>5</volume>
        <fpage>S7</fpage>
      </element-citation>
    </ref>
    <ref id="B8">
      <label>8</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ter-Hovhannisyan</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Lomsadze</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Chernoff</surname>
            <given-names>YO</given-names>
          </name>
          <name>
            <surname>Borodovsky</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Gene prediction in novel fungal genomes using an ab initio algorithm with unsupervised training</article-title>
        <source>Genome Res.</source>
        <year>2008</year>
        <volume>12</volume>
        <fpage>1979</fpage>
        <lpage>1990</lpage>
        <pub-id pub-id-type="pmid">18757608</pub-id>
      </element-citation>
    </ref>
    <ref id="B9">
      <label>9</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Besemer</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Borodovsky</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>GeneMark: web software for gene finding in prokaryotes eukaryotes and viruses</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2005</year>
        <volume>33</volume>
        <fpage>W451</fpage>
        <lpage>W454</lpage>
        <pub-id pub-id-type="pmid">15980510</pub-id>
      </element-citation>
    </ref>
    <ref id="B10">
      <label>10</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Coghlan</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Fiedler</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>McKay</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Flicek</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Harris</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Blasiar</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>The nGASP Consortium</surname>
          </name>
          <name>
            <surname>Stein</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <article-title>nGASP: the nematode genome annotation assessment project</article-title>
        <source>BMC Bioinf.</source>
        <year>2008</year>
        <volume>9</volume>
        <fpage>549</fpage>
      </element-citation>
    </ref>
    <ref id="B11">
      <label>11</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Giardine</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Riemer</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Hardison</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Burhans</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Elnitski</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Shah</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Blankenberg</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Albert</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Taylor</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Galaxy: a platform for interactive large-scale genome analysis</article-title>
        <source>Genome Res.</source>
        <year>2005</year>
        <volume>15</volume>
        <fpage>1451</fpage>
        <lpage>1455</lpage>
        <pub-id pub-id-type="pmid">16169926</pub-id>
      </element-citation>
    </ref>
    <ref id="B12">
      <label>12</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sonnenburg</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Zien</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Rätsch</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>Accurate recognition of transcription starts in human</article-title>
        <source>Bioinf.</source>
        <year>2006</year>
        <volume>22</volume>
        <fpage>e472</fpage>
      </element-citation>
    </ref>
    <ref id="B13">
      <label>13</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sonnenburg</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Schweikert</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Philips</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Behr</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Rätsch</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>Accurate splice site prediction using support vector machines</article-title>
        <source>BMC Bioinf.</source>
        <year>2007</year>
        <volume>8</volume>
        <issue>Suppl 10</issue>
        <fpage>S7</fpage>
      </element-citation>
    </ref>
    <ref id="B14">
      <label>14</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rätsch</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Sonnenburg</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Srinivasan</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Witte</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Müller</surname>
            <given-names>K.-R</given-names>
          </name>
          <name>
            <surname>Sommer</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Schölkopf</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <article-title>Improving the <italic>C. elegans</italic> genome annotation using machine learning</article-title>
        <source>PLoS Com. Biol.</source>
        <year>2007</year>
        <volume>3</volume>
        <fpage>e20</fpage>
      </element-citation>
    </ref>
    <ref id="B15">
      <label>15</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Sonnenburg</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Rätsch</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Rieck</surname>
            <given-names>K</given-names>
          </name>
        </person-group>
        <person-group person-group-type="editor">
          <name>
            <surname>Bottou</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Chapelle</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>DeCoste</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Weston</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Large-scale learning with string kernels</article-title>
        <source>Large-Scale Kernel Machines<italic>, Ch. 4</italic>.</source>
        <year>2007</year>
        <publisher-loc>Cambridge, MA</publisher-loc>
        <publisher-name>MIT Press</publisher-name>
        <fpage>73</fpage>
        <lpage>104</lpage>
      </element-citation>
    </ref>
    <ref id="B16">
      <label>16</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ben-Hur</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Ong</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Sonnenburg</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Schölkopf</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Rätsch</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>Support vector machines and kernels for computational biology</article-title>
        <source>PLoS Com. Biol.</source>
        <year>2008</year>
        <volume>4</volume>
        <fpage>e1000173</fpage>
      </element-citation>
    </ref>
    <ref id="B17">
      <label>17</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Rätsch</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Sonnenburg</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <person-group person-group-type="editor">
          <name>
            <surname>Schölkopf</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Platt</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Hoffman</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>Large-scale hidden semi-Markov SVMs</article-title>
        <source>Advances in Neural Information Processing Systems (NIPS'06).</source>
        <year>2007</year>
        <volume>19</volume>
        <publisher-loc>Cambridge, MA</publisher-loc>
        <publisher-name>MIT Press</publisher-name>
        <fpage>1161</fpage>
        <lpage>1168</lpage>
      </element-citation>
    </ref>
    <ref id="B18">
      <label>18</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kulp</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Haussler</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Reese</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Eeckman</surname>
            <given-names>F</given-names>
          </name>
        </person-group>
        <article-title>A generalized hidden Markov model for the recognition of human genes in DNA</article-title>
        <source>ISMB</source>
        <year>1996</year>
        <volume>4</volume>
        <fpage>134</fpage>
        <lpage>141</lpage>
        <pub-id pub-id-type="pmid">8877513</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
