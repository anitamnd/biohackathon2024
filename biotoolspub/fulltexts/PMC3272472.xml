<?properties open_access?>
<?properties manuscript?>
<?iso-abbr Nat. Genet.?>
<?submitter-system ukmss?>
<?submitter-canonical-name Nature Publishing Group?>
<?submitter-canonical-id NATURE-STRUCTUR?>
<?submitter-userid 1005?>
<?submitter-authority publisher?>
<?submitter-login NPG?>
<?submitter-name Nature Publishing Group?>
<?origin ukpmcpa?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-journal-id">9216904</journal-id>
    <journal-id journal-id-type="pubmed-jr-id">2419</journal-id>
    <journal-id journal-id-type="nlm-ta">Nat Genet</journal-id>
    <journal-id journal-id-type="iso-abbrev">Nat. Genet.</journal-id>
    <journal-title-group>
      <journal-title>Nature genetics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1061-4036</issn>
    <issn pub-type="epub">1546-1718</issn>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">3272472</article-id>
    <article-id pub-id-type="pmid">22231483</article-id>
    <article-id pub-id-type="doi">10.1038/ng.1028</article-id>
    <article-id pub-id-type="manuscript">wtpa37901</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>De novo assembly and genotyping of variants using colored de Bruijn graphs</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Iqbal</surname>
          <given-names>Zamin</given-names>
        </name>
        <xref ref-type="aff" rid="A1">1</xref>
        <xref ref-type="aff" rid="A3">3</xref>
        <xref ref-type="author-notes" rid="FN0">+</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Caccamo</surname>
          <given-names>Mario</given-names>
        </name>
        <xref ref-type="aff" rid="A2">2</xref>
        <xref ref-type="author-notes" rid="FN0">+</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Turner</surname>
          <given-names>Isaac</given-names>
        </name>
        <xref ref-type="aff" rid="A1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Flicek</surname>
          <given-names>Paul</given-names>
        </name>
        <xref ref-type="aff" rid="A3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>McVean</surname>
          <given-names>Gil</given-names>
        </name>
        <xref ref-type="aff" rid="A1">1</xref>
        <xref ref-type="aff" rid="A4">4</xref>
        <xref ref-type="corresp" rid="CR1">*</xref>
      </contrib>
    </contrib-group>
    <aff id="A1"><label>1</label>Wellcome Trust Centre for Human Genetics, Roosevelt Drive, Oxford OX3 7BN, UK
</aff>
    <aff id="A2"><label>2</label>The Genome Analysis Centre, Norwich Research Park, Norwich, NR4 7UH, UK
</aff>
    <aff id="A3"><label>3</label>European Bioinformatics Institute, Wellcome Trust Genome Campus, Hinxton CB10 1SD, UK
</aff>
    <aff id="A4"><label>4</label>Department of Statistics, 1 South Parks Road, Oxford OX1 3TG, UK
</aff>
    <author-notes>
      <corresp id="CR1"><label>*</label>Corresponding author: <email>mcvean@well.ox.ac.uk</email></corresp>
      <fn fn-type="equal" id="FN0">
        <label>+</label>
        <p>These authors contributed equally to this work.</p>
      </fn>
      <fn id="FN1">
        <p id="P35">
          <bold>Author contributions</bold>
        </p>
        <p id="P36">ZI, GM designed the study, developed the mathematical models, and wrote the paper; MC, ZI developed the variant discovery algorithms, designed the multi-color graph data structures, and implemented software; ZI performed simulations, and analyses for Cases 1,3,4; IT, ZI performed analyses for Case 2; PF contributed to early plans for Cortex.</p>
      </fn>
    </author-notes>
    <pub-date pub-type="nihms-submitted">
      <day>22</day>
      <month>11</month>
      <year>2011</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>08</day>
      <month>1</month>
      <year>2012</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>01</day>
      <month>8</month>
      <year>2012</year>
    </pub-date>
    <volume>44</volume>
    <issue>2</issue>
    <fpage>226</fpage>
    <lpage>232</lpage>
    <permissions>
      <license>
        <license-p>Users may view, print, copy, download and text and data- mine the content in such documents, for the purposes of academic research, subject always to the full Conditions of use:
<uri xlink:type="simple" xlink:href="http://www.nature.com/authors/editorial_policies/license.html#terms">http://www.nature.com/authors/editorial_policies/license.html#terms</uri></license-p>
      </license>
    </permissions>
    <abstract>
      <p id="P1">Detecting genetic variants that are highly divergent from a reference sequence remains a major challenge in genome sequencing. We introduce de novo assembly algorithms using colored de Bruijn graphs for detecting and genotyping simple and complex genetic variants in an individual or population. We provide an efficient software implementation, Cortex; the first de novo assembler capable of assembling multiple eukaryote genomes simultaneously. Four applications of Cortex are presented. First, we detect and validate both simple and complex structural variation in a high coverage human genome. Second, we identify over 3Mb of novel sequence in pooled low-coverage population sequence data from the 1000 Genomes Project. Third, we show how population information from 10 chimpanzees enables accurate variant calls without a reference sequence. Finally, we estimate classical HLA genotypes at <italic>HLA-B</italic>, the most variable gene in the human genome.</p>
    </abstract>
    <funding-group>
      <award-group>
        <funding-source country="United Kingdom">Wellcome Trust : </funding-source>
        <award-id>090532 || WT</award-id>
      </award-group>
      <award-group>
        <funding-source country="United Kingdom">Wellcome Trust : </funding-source>
        <award-id>086084 || WT</award-id>
      </award-group>
    </funding-group>
  </article-meta>
</front>
<body>
  <sec sec-type="intro" id="S1">
    <title>Introduction</title>
    <p id="P2">Characterization of genetic variants present in an individual, population or ecological sample has been transformed by the development of high throughput sequencing (HTS) technologies. The standard approach to variant discovery and genotyping from HTS data is to map reads to a reference genome<sup><xref ref-type="bibr" rid="R1">1</xref>-<xref ref-type="bibr" rid="R5">5</xref></sup>, so identifying positions where the sample contains simple variant sequences. This approach has proved powerful in the study of single nucleotide polymorphisms<sup><xref ref-type="bibr" rid="R6">6</xref></sup> (SNPs), short insertion-deletion (indel) polymorphisms<sup><xref ref-type="bibr" rid="R3">3</xref>,<xref ref-type="bibr" rid="R5">5</xref>,<xref ref-type="bibr" rid="R7">7</xref>,<xref ref-type="bibr" rid="R8">8</xref></sup> and larger structural variation<sup><xref ref-type="bibr" rid="R9">9</xref>-<xref ref-type="bibr" rid="R14">14</xref></sup> in well-characterised genomes, such as human<sup><xref ref-type="bibr" rid="R15">15</xref>-<xref ref-type="bibr" rid="R17">17</xref></sup>.</p>
    <p id="P3">However, the mapping approach has limitations. First, the sample may contain sequence absent or divergent from the reference, for example through horizontal transfer events in microbial genomes<sup><xref ref-type="bibr" rid="R18">18</xref>,<xref ref-type="bibr" rid="R19">19</xref></sup> or at highly diverse loci, such as the classical HLA genes<sup><xref ref-type="bibr" rid="R20">20</xref></sup>. In such cases, short reads either cannot or are unlikely to map correctly to the reference. Second, reference sequences, particularly of higher eukaryotes, are incomplete, notably in telomeric and pericentromeric regions. Reads from missing regions will often map, sometimes with apparently high certainty, to paralogous regions, potentially leading to false variant calls. Third, samples under study may either have no available reference sequence or it may not be possible to define a single suitable reference, as in ecological sequencing<sup><xref ref-type="bibr" rid="R21">21</xref></sup>. Fourth, methods for variant calling from mapped reads typically focus on a single variant type. However, where variants of different types cluster, focus on a single type can lead to errors, for example through incorrect alignment around indel polymorphisms<sup><xref ref-type="bibr" rid="R6">6</xref>,<xref ref-type="bibr" rid="R7">7</xref></sup>. Fifth, although there are methods for detecting large structural variants, using array CGH <sup><xref ref-type="bibr" rid="R22">22</xref>-<xref ref-type="bibr" rid="R25">25</xref></sup> and mapped reads<sup><xref ref-type="bibr" rid="R11">11</xref>,<xref ref-type="bibr" rid="R12">12</xref>,<xref ref-type="bibr" rid="R14">14</xref>,<xref ref-type="bibr" rid="R26">26</xref></sup>, these cannot determine the exact location, size or allelic sequence of variants. Finally, mapping approaches typically ignore prior information about genetic variation within the species.</p>
    <p id="P4">Several of these limitations can potentially be solved through de novo assembly, which is agnostic with regards to variant type and divergence from any reference. However, while there are established algorithms for de novo assembly from HTS shotgun data, based on overlap<sup><xref ref-type="bibr" rid="R27">27</xref>-<xref ref-type="bibr" rid="R29">29</xref></sup> or de Bruijn graphs<sup><xref ref-type="bibr" rid="R30">30</xref>-<xref ref-type="bibr" rid="R32">32</xref></sup>, current approaches have limitations. Notably, they focus on consensus assembly, treating the sequence as if derived from a monomorphic sample (e.g. haploid genome, inbred line or clonal population). Consequently, variation is ignored (processed in the same way as sequencing artefacts) and can lead to assembly errors. Some variation-aware de novo assembly algorithms have been developed<sup><xref ref-type="bibr" rid="R31">31</xref>,<xref ref-type="bibr" rid="R33">33</xref>-<xref ref-type="bibr" rid="R36">36</xref></sup>, but these do not represent a general solution to sequencing experiments where genetic variation is either the primary concern or unavoidable (outbred diploid samples, pooled data or ecological samples).</p>
    <p id="P5">Current assembly methods also typically ignore pre-existing information, such as a reference sequence or known variants. Although variant discovery should not be biased by such information, nor should it be discarded. For example, in a single outbred diploid sample it is hard to distinguish paralogous from orthologous variation. However, if variation is also observed in the reference haploid genome it is most likely driven by paralogy. Finally, current implementations of de novo assembly algorithms for HTS data have very substantial computational requirements, which make them impractical for large-scale studies on eukaryote genomes.</p>
    <p id="P6">Here, we introduce de novo assembly algorithms focused on detecting and characterising genetic variation in one or more individuals. These algorithms extend classical de Bruijn graphs<sup><xref ref-type="bibr" rid="R37">37</xref>,<xref ref-type="bibr" rid="R38">38</xref></sup> by colouring the nodes and edges in the graph by the samples in which they are observed. This approach accommodates information from multiple samples, including one or more reference sequences and known variants. We show how the method can detect variation in species without a reference, combine information across multiple individuals to improve accuracy, and genotype known variants. Cortex has already contributed to public datasets as part of the 1000 Genomes Project<sup><xref ref-type="bibr" rid="R17">17</xref></sup>.</p>
  </sec>
  <sec id="S2">
    <title>Colored de Bruijn graph algorithms for variant discovery and genotyping</title>
    <p id="P7">De Bruijn graphs, which represent overlap information within a set of DNA sequences, are widely used in genome assembly and underlie many popular algorithms, including AllPaths-LG <sup><xref ref-type="bibr" rid="R31">31</xref></sup>, SOAPdenovo <sup><xref ref-type="bibr" rid="R32">32</xref></sup>, Abyss<sup><xref ref-type="bibr" rid="R39">39</xref></sup> and Velvet <sup><xref ref-type="bibr" rid="R30">30</xref>,<xref ref-type="bibr" rid="R40">40</xref></sup>. The graph consists of a set of nodes, representing words of length <italic>k</italic> (k-mers). Directed edges join k-mers seen consecutively in the input. Variation between genomes generates new nodes and edges. In the simplest case polymorphisms appear as bubbles within unique contigs. However, more complex structures also arise, for example where a variant generates a k-mer found in a paralogous location (<xref ref-type="supplementary-material" rid="SD1">Supplementary Figure 1</xref>).</p>
    <p id="P8">A colored de Bruijn graph generalises the original formulation to multiple samples embedded in a union graph, where the identity of each sample is retained by colouring those nodes present in a sample. The samples may reflect HTS data from multiple samples, experiments, reference sequences, known variant sequences or any combination. Below we outline four algorithms for variant discovery and genotyping that make use of the colored de Bruijn graph structure (<xref ref-type="app" rid="APP1">Methods Section 1-4</xref>).</p>
    <sec id="S3">
      <title>Bubble-calling</title>
      <p id="P9">The simplest use of colored de Bruijn graphs is to identify variant bubbles in a single diploid individual. This approach may have a high false positive rate because of the difficulty of separating repeat-induced and variant-induced bubbles. However, inclusion of a haploid reference genome improves the reliability of the algorithm because most repeat structures will be present in the reference and any bubble in the reference colour must be a repeat (<xref ref-type="fig" rid="F1">Figure 1a</xref>). A reference genome also aids the detection of variants because only the variant allele contig need be assembled, and is essential for detecting homozygous variant sites. All types of variant can induce bubbles, hence the process of bubble detection is influenced by variant type only through the graph complexity of the variants and the probability of assembling both sides of the bubble given the sequence coverage, k-mer size and error rate (see <xref ref-type="app" rid="APP1">Methods Section 1</xref> for details of a model for predicting power). Haplotypes arising from variants within <italic>k</italic> bases of each other will naturally be assembled as single compound variants. Our implementation is referred to as the ‘bubble-calling’ (BC) algorithm (<xref ref-type="app" rid="APP1">Methods Section 2</xref>).</p>
    </sec>
    <sec id="S4">
      <title>Path divergence</title>
      <p id="P10">The bubble-calling algorithm relies on the detection of clean bubbles. However, for complex variants (e.g. novel sequence insertions, large deletions and inversions), the path of at least one allele is unlikely to generate a clean contig. Nevertheless, in some cases, particularly deletions, path complexity is restricted to the reference allele. Such cases can be identified by following the (known) reference path through the joint graph and detecting where it diverges from the sample graph (<xref ref-type="fig" rid="F1">Figure 1b</xref>; <xref ref-type="app" rid="APP1">Methods Section 2</xref> and <xref ref-type="supplementary-material" rid="SD1">Supplementary Figure 2</xref>). This ‘path-divergence’ (PD) algorithm typically only identifies homozygous variants and is biased towards identifying deletions. Nevertheless, the algorithm can substantially increase power to detect some variant types and potentially identifies events of arbitrary size, irrespective of read-length.</p>
    </sec>
    <sec id="S5">
      <title>Multiple-sample analysis</title>
      <p id="P11">The joint analysis of HTS data from multiple samples can improve the power and false discovery rate (FDR) of variant detection substantially. In the simplest case, samples are combined in a single colour (for example, in a pooling experiment) and the data can be analysed as above. However, by maintaining separate colours for each sample there is additional information about whether a bubble is likely to be induced by repeats (where many or all samples show coverage of both paths in the bubble; <xref ref-type="fig" rid="F1">Figure 1c</xref>) or errors (where the error-carrying side of bubble will typically have low coverage). This observation leads to an approach to variant discovery even in species where there is no suitable reference. We have devised statistical methods that enable probabilistic classification of bubble structures into those arising from errors, repeat structures or variants (<xref ref-type="app" rid="APP1">Methods Section 3</xref>). When a reference genome is available, this approach can still help distinguish true variants from errors and repeat structures absent from the reference.</p>
    </sec>
    <sec id="S6">
      <title>Genotyping</title>
      <p id="P12">Colored de Bruijn graphs can be used to genotype samples at known loci even when coverage is insufficient to enable variant assembly (<xref ref-type="fig" rid="F1">Figure 1d</xref>). We construct a colored de Bruijn graph of the reference sequence, known allelic variants (which may include those discovered using the above methods) and data from the sample. The likelihood of each possible genotype is calculated accounting for the graph structure of both local and genome-wide sequence (<xref ref-type="app" rid="APP1">Methods Section 4</xref>). The approach generalises to multiple allelic types and, because the algorithm does not require variants to form simple bubble structures, it is possible to genotype complex and compound variants such as those at classical HLA loci.</p>
    </sec>
  </sec>
  <sec id="S7">
    <title>Graph building and cleaning</title>
    <p id="P13">We have developed Cortex, a memory-efficient assembler for building and representing colored de Bruijn graphs and to perform variant calling and genotyping from HTS data (<ext-link ext-link-type="uri" xlink:href="http://cortexassembler.sourceforge.net">cortexassembler.sourceforge.net</ext-link>; <xref ref-type="app" rid="APP1">Methods Section 5</xref>). The implementation uses an efficient hash table that implicitly encodes the graph; memory use is specified in advance according to a simple formula, and many standard operations have linear or better algorithmic complexity (<xref ref-type="app" rid="APP1">Methods Sections 2, 5</xref>). Novel cleaning methods are used to increase sensitivity (<xref ref-type="app" rid="APP1">Methods Section 6</xref> and <xref ref-type="supplementary-material" rid="SD1">Supplementary Figure 3</xref>). Cortex is the only assembler able to handle multiple eukaryotes simultaneously, for example 1000 <italic>S. cerevisiae</italic> samples in under 64Gb of RAM, or 10 humans in under 256Gb of RAM.</p>
  </sec>
  <sec id="S8">
    <title>Assessing the power and false discovery rate of Cortex through simulation</title>
    <sec id="S9">
      <title>A single high coverage diploid genome</title>
      <p id="P14">We simulated high coverage (10-50x) sequencing data from a diploid human sample that carries SNPs, indels and structural variants (<xref ref-type="app" rid="APP1">Methods Section 7</xref>). Data was analysed by both the BC and PD methods.</p>
      <p id="P15">For a variant to be identified successfully, the bubble must both be assembled without gaps and be identifiable within the wider graph. Genome complexity, sequencing depth, read-length, k-mer size and error rate interact to influence both factors. As k-mer size increases, the fraction of SNP sites with unconfounded bubbles ranges from 51% with <italic>k</italic>=21 to 85% with <italic>k</italic>=75 in humans (<xref ref-type="supplementary-material" rid="SD1">Supplementary Figure 4</xref>). Increasing k-mer size reduces the risk of error-induced contigs confounding the graph, but also increases the probability of a k-mer containing an error. Furthermore, for a fixed per-base depth and read-length, as k-mer-size increases, the effective depth of each k-mer decreases leading to an increased probability of gaps in the assembly (<xref ref-type="fig" rid="F2">Figure 2a</xref>, and <xref ref-type="app" rid="APP1">Methods Section 1</xref>). Consequently, the k-mer size that maximises the sensitivity of the BC algorithm within the simulation varies with coverage and read-length; approximately 55 for 30x, 55 for 40x and 65 for 50x with 100bp reads. The loss in power relative to the theoretical maximum is, however, small. For example, with 50x coverage (<italic>k</italic>=65, 100bp reads) we identify 86% of heterozygous SNPs compared to the maximum possible of 92%. Simulation-based estimates of power closely track predictions (<xref ref-type="fig" rid="F2">Figure 2a</xref>, <xref ref-type="supplementary-material" rid="SD1">Supplementary Figures 5, 6</xref>).</p>
      <p id="P16">To assess the power of Cortex to detect a range of variants of different types and sizes we applied the BC and PD algorithms at a single point (30x, read length 100, <italic>k</italic>=55; see <xref ref-type="app" rid="APP1">Methods Section 7</xref>). For isolated SNPs, short indels (1-100bp) and small complex combinations of SNPs and indels (1-100bp) we have 80% power to detect heterozygous sites and 90% power to detect homozygous variant sites (<xref ref-type="fig" rid="F2">Figure 2b</xref>). For moderate size (100-1000bp) indels and complex variants, power is 50% and 75-80% for heterozygous and homozygous sites respectively. For large variants (1-50kb) we only have power to detect homozygous variant sites (c. 35%), entirely through PD. These sensitivity estimates are attained with an FDR of 2%.</p>
    </sec>
    <sec id="S10">
      <title>Population-based variant calling and bubble classification</title>
      <p id="P17">We simulated sequence data from ten diploid individuals based on human chromosome 22 (100bp reads, 10x per individual; <xref ref-type="app" rid="APP1">Methods Section 8</xref>). Data were analysed at the level of individual haplotypes, error-free reads and error-containing reads (<italic>k</italic>=55) under two cleaning thresholds (relaxed and stringent). Two filtering approaches were compared. First, we remove bubbles that are present in the reference. Second, we use a probabilistic model to classify bubbles as arising through errors, repeats or true variants (<xref ref-type="app" rid="APP1">Methods Section 3</xref>).</p>
      <p id="P18">At <italic>k</italic>=55, 10% of SNPs fail to make clean bubble structures (<xref ref-type="supplementary-material" rid="SD1">Supplementary Figure 4</xref>), however, coverage is sufficient that only for rare variants (count &lt; 3) is there substantial loss of power (<xref ref-type="fig" rid="F2">Figure 2c</xref>). With realistic levels of sequence error, power drops by an additional 10% under the relaxed cleaning threshold, but recovers under the more stringent cleaning threshold because confounding error contigs are removed. FDR with relaxed cleaning is 29%, but probabilistic classification reduces this to 1.5% with only a 1.7% loss in power (<xref ref-type="fig" rid="F2">Figure 2d</xref>). The more stringent cleaning approach has an FDR of 2.3% before classification and 1.6% after, with a 1.0% loss in power. In contrast, removal of bubbles present in the reference has only a marginal effect on FDR (29.0% and 2.3% for the two cleaning thresholds respectively), as the majority of false calls are read-error driven.</p>
    </sec>
  </sec>
  <sec sec-type="cases" id="S11">
    <title>Case 1: Variant calling in a high coverage human genome</title>
    <p id="P19">We analysed high coverage data (26x with 100bp reads analysed at <italic>k</italic>=55; <xref ref-type="app" rid="APP1">Methods Section 9</xref>) from a single individual of European ancestry (NA12878 from the CEU) for whom independent validation data are available through 3 Mb of fosmid sequence (median length 40kb), selected to contain structural variation<sup><xref ref-type="bibr" rid="R41">41</xref></sup>. This sample has been analysed using mapping-based strategies in the 1000 Genomes Project<sup><xref ref-type="bibr" rid="R17">17</xref></sup> (63x of mostly 36bp paired-end reads), thus enabling comparison of Cortex with alternative strategies. The fosmid data enables us to estimate an upper-bound for FDR for variants of different types from the fraction of sites called as homozygous variant where the fosmid sequence contains only the reference allele. A detailed discussion of the validation results can be found in the <xref ref-type="supplementary-material" rid="SM">Supplementary Methods</xref>.</p>
    <p id="P20">After cleaning, the de Bruijn graph for NA12878 has 2,777,352,792 nodes (unique k-mers) compared to 2,691,115,653 in the reference sequence (cleaning reduces the initial number of nodes by 23%). The bubble-calling (BC) algorithm identifies 2,686,963 bubbles, of which 5.6% are removed because both sides of the bubble are also present in the reference. The path-divergence (PD) algorithm identifies 528,651 deviations from the reference, of which 39.8% were not identified by BC. The union of the BC and PD call-sets includes 2,245,279 SNPs, 361,531 short indels (insertion to deletion ratio in the 5-30bp range of 1:1.3 for BC and 1:1.7 for PD, compared with 1:3.7 for the 1000 Genomes calls) and 1,100 larger or more complex variants.</p>
    <p id="P21">The Cortex and 1000 Genomes call sets have different properties arising from differences in experimental design and analysis approach. Only 80% of the genome is accessible to the 1000 Genomes SNP calls<sup><xref ref-type="bibr" rid="R17">17</xref></sup>, but power within these regions is high. In contrast, at <italic>k</italic>=55, over 85% of the genome is accessible to Cortex, but power is reduced (by approximately 40% at heterozygous, and &lt;5% at homozygous, sites) due to fluctuations in coverage. Thus while the call set sizes for homozygous SNPs and short indels within the fosmid footprint are similar, Cortex calls only half the number of heterozygous sites (<xref ref-type="table" rid="T1">Table 1</xref>). Across the genome, Cortex detects variation at 87% of sites called as homozygous alternative by the 1000 Genomes Project and 67% of sites called as heterozygous (comparison to HapMap 2 sites gives equivalent figures, <xref ref-type="supplementary-material" rid="SD1">Supplementary Table 7</xref>).</p>
    <p id="P22">SNP variants identified by Cortex have diagnostic properties such as transition-transversion ratio (Cortex = 2.02 (BC) / 2.1 (PD), 1000 Genomes = 2.07) and dbSNP rate (Cortex = 92.7% (BC) / 95.6% (PD), 1000 Genomes = 92.1%, dbSNP 129) that are comparable to the 1000 Genomes calls<sup><xref ref-type="bibr" rid="R17">17</xref></sup>.</p>
    <p id="P23">Overall FDR for Cortex SNP calls is 4%, reduced to 1.5% by applying a homopolymer filter and selecting high confidence calls (25% reduction in call set; <xref ref-type="table" rid="T1">Table 1</xref> and <xref ref-type="app" rid="APP1">Methods Section 9</xref>). None of the 1000 Genomes homozygous SNP calls invalidates (<xref ref-type="table" rid="T1">Table 1</xref>). Of the 43 invalidated homozygous SNP calls from Cortex, 35 were called as heterozygous sites by the 1000 Genomes Project, hence the FDR for Cortex is probably &lt;1%. Short indels (1-100 bp) have similar FDR (0% for high confidence set), but whereas the 1000 Genomes calls are restricted to variants under 30bp in length, both the BC and PD approaches identify indels over 100bp (<xref ref-type="fig" rid="F3">Figure 3a</xref>).</p>
    <p id="P24">Across the genome, Cortex identifies 138,262 complex variants, consisting of phased SNPs (74%), closely-sited SNPs and indels (25%) and complexes of insertions, deletions and local rearrangements (1%). FDR for complex variants is low (2.7% for BC and 1.7% for PD; <xref ref-type="supplementary-material" rid="SD1">Supplementary Table 1</xref>). While mapping-based approaches can call closely-sited variants of different types, these are often filtered out. However, our results indicate that Cortex can identify complex variants with FDR comparable to simple variants. <xref ref-type="fig" rid="F3">Figure 3b</xref> shows examples of complex variants validated in the fosmid data.</p>
  </sec>
  <sec sec-type="cases" id="S12">
    <title>Case 2. Detection of novel sequence from population graphs of low-coverage samples</title>
    <p id="P25">We constructed three pooled population graphs for 164 humans (CEU, YRI and CHB/JPT) sequenced at low coverage (2-4x) in the 1000 Genomes Project<sup><xref ref-type="bibr" rid="R17">17</xref></sup> (<xref ref-type="app" rid="APP1">Methods</xref>). By including the reference sequence as a fourth colour, we identified 21,281 novel contigs of ≥100bp (&lt;90% homology to any reference sequence), totalling 3.2Mb. The novel unique sequence load carried by a typical individual is 1.4Mb for CEU, 1.5Mb for YRI and 1.5Mb for CHB/JPT respectively. Of this, 93% is estimated to be allelic, and copy-number estimates for other sequences range up to 6.3 (<xref ref-type="fig" rid="F4">Figure 4a</xref>). On average, 45kb per individual is homologous to a known gene and we see strong over-representation for matches to variants at classical HLA and KIR loci, both known to be highly variable in sequence, structure and copy-number. Some sequences show very strong differentiation between populations. For example, we find three contigs in YRI, homologous to olfactory receptor genes, that are absent from other populations (<xref ref-type="fig" rid="F4">Figure 4a</xref>).</p>
    <p id="P26">There are practical implications of these results. First, the novel sequences, particularly those matching genes or strongly differentiated between populations are candidates for functionally-relevant polymorphism. Second, the combined population graphs provide a summary of human genome diversity against which it is possible to map sequence data from future studies. We have released the novel sequence contigs, population estimates of the per-genome copy number, the combined population graph and tools for aligning reads to the graph (<xref ref-type="app" rid="APP1">Methods Sections 10, 14</xref>).</p>
  </sec>
  <sec sec-type="cases" id="S13">
    <title>Case 3: Using population information to classify bubble structures</title>
    <p id="P27">We applied Cortex to data from 10 Western Chimpanzees (50 bp reads, average coverage 6x; <xref ref-type="app" rid="APP1">Methods Section 11</xref>). Bubbles were identified after using the relaxed cleaning threshold and classified probabilistically. Power was estimated by comparison to previous SNP genotype data on the same samples<sup><xref ref-type="bibr" rid="R42">42</xref></sup>.</p>
    <p id="P28">Across the genome we identify 3.5 million variants, of which 2.7 million are single nucleotide variants. The probabilistic filter classified 153,921 of these as repeats, of which 69% were bubbles in the reference. For bubbles classified as SNPs we estimate FDR from the fraction of sites that are also bubbles in the reference, here 3.5% (compared to 6.5% before classification). This estimate is substantially greater than that predicted from simulations. However, manual inspection revealed that many of these sites are segregating in the sample and therefore are either polymorphic segmental duplications (not currently considered in the classification process) or allelic variants mis-assembled as paralogous in the reference. Power compared to the SNP genotype data is 55% before classification and 54% after. Thus probabilistic classification results in a data set with low FDR at a small cost to power and can be applied to any species, regardless of reference availability. The relationship between allele count and detection rate closely follows the theoretical predictions (<xref ref-type="fig" rid="F4">Figure 4b</xref>).</p>
  </sec>
  <sec sec-type="cases" id="S14">
    <title>Case 4: Genotyping simple and complex variants</title>
    <p id="P29">We applied the genotyping algorithm to both simple variants, here HapMap2 SNPs<sup><xref ref-type="bibr" rid="R43">43</xref></sup>, and complex variants, specifically HLA-B genotype, using the sequencing data from NA12878 described above and high coverage sequence data from an individual of African origin (NA19240). Both individuals have classical HLA alleles typed from a previous project<sup><xref ref-type="bibr" rid="R44">44</xref></sup>. At HapMap2 sites, we find discordance of less than 1% at high confidence sites (<xref ref-type="app" rid="APP1">Methods Sections 9.4 and 12</xref>, <xref ref-type="supplementary-material" rid="SD1">Supplementary Tables 4, 5</xref>). Discrepancies are driven by sites called as homozygous variant by the BC algorithm and heterozygous by HapMap2; a result of stochastic loss of coverage of k-mers spanning the reference allele.</p>
    <p id="P30">Classical HLA allele genotyping, of importance in many areas of medical genetics, is laborious and expensive. Although DNA-sequencing represents the gold-standard quality, most genotyping is performed through a mix of PCR amplification and oligo hybridisation. HTS genome-wide data has the potential to provide classical HLA sequence information, but sequence diversity, structural variation and extensive paralogy within the region currently restricts mapping-based approaches. To evaluate the performance of Cortex for genotyping <italic>HLA-B</italic> we constructed a graph containing the reference genome, all 1429 known <italic>HLA-B</italic> alleles and data from each high coverage sample as separate colours (<xref ref-type="app" rid="APP1">Methods Section 12</xref>). We calculated the likelihood of all 1,021,735 possible genotypes. For NA19240, the most likely genotype (B*57:03:01, B*35:01:01) agrees at 4-digit resolution with previous data obtained using classical typing methods<sup><xref ref-type="bibr" rid="R44">44</xref></sup> and is very strongly supported (likelihood ratio ~10<sup>23</sup>; <xref ref-type="fig" rid="F5">Figure 5a</xref>). For NA12878 the most likely genotype contains B*56:01 and cannot distinguish between B*08:03, B*08:15, B*08:36, B*08:47 and B*08:13 for the second allele (<xref ref-type="fig" rid="F5">Figure 5b</xref>). The lab-based genotype is B*56:01/B*08:01 which differs from the maximum likelihood estimate by 3.2 units of log-likelihood and agrees at the 2-digit level with the graph-based estimate. We note that lab-typing was based on primer amplication and oligo hybridisation, which can often lead to minor ambiguities at the 4-digit level. By sub-sampling NA12878 to generate graphs at between 2x and 20x we find that 16x coverage was required to attain 2-digit agreement with lab-based typing (<xref ref-type="fig" rid="F5">Figure 5b</xref>).</p>
  </sec>
  <sec sec-type="discussion" id="S15">
    <title>Discussion</title>
    <p id="P31">We have introduced a new approach to combining de novo assembly with variant detection and genotyping from HTS data. We use colored de Bruijn graphs to represent information from multiple sources and a mixture of graph-analytic and statistical approaches to detect variants of different types and subsequently genotype. Our method is the first de novo assembly-based variant caller, although previous work has made steps towards reference-free variant calling<sup><xref ref-type="bibr" rid="R45">45</xref>,<xref ref-type="bibr" rid="R46">46</xref></sup>. Technically, the key advance is the development of a highly efficient de Bruijn graph implementation. This efficiency enables data from multiple samples, as well as reference sequences and known variants to be included within a single graph structure that preserves sample identity through the use of colours. For single high coverage genomes the algorithms provide power to detect and genotype simple and complex variants. However, the major strength of the approach lies in the simultaneous analysis of multiple genomes, which enables powerful and accurate approaches to variant detection without any need of a reference genome. This makes possible HTS analysis of genetic variation in any species. It could also provide an approach for detecting changes between highly related genomes, as in tumour-normal pairs in cancer genomics<sup><xref ref-type="bibr" rid="R47">47</xref></sup> or bacteria in within transmission chains<sup><xref ref-type="bibr" rid="R48">48</xref></sup>.</p>
    <p id="P32">We have also developed a simple mathematical model to describe de Bruijn graph assembly from HTS data, which has two practical benefits. First, the model has predictive power both in simulated and empirical data, hence can guide experimental design. Second, the model can be used to calculate the likelihood of any particular genome sequence given HTS data and an estimate of error rates; one application of which is genotyping complex variants, such as the classical HLA loci.</p>
    <p id="P33">Finally, the Cortex algorithms have several limitations. Most notably, we do not use read-pair information to improve local assembly, which can be of substantial value around repeat sequence. However, there are established algorithms for using read-pair information to disambiguate de Bruijn graphs<sup><xref ref-type="bibr" rid="R30">30</xref>,<xref ref-type="bibr" rid="R31">31</xref>,<xref ref-type="bibr" rid="R39">39</xref>,<xref ref-type="bibr" rid="R40">40</xref>,<xref ref-type="bibr" rid="R49">49</xref>,<xref ref-type="bibr" rid="R50">50</xref></sup>. There is also the potential for error correction<sup><xref ref-type="bibr" rid="R51">51</xref></sup>, which can compensate for the loss of coverage caused by errors. There are, however, more fundamental challenges in using de Bruijn graphs, including the greater need for error-correction as the k-mer size increases, the lack of any natural way of encoding read-pair information and the potential for graph explosion as more individuals are included in the graph. Nevertheless, multi-colored graphs provide one solution to the obvious inadequacy of representing the genetic composition of a species by a single haploid reference.</p>
  </sec>
  <sec sec-type="supplementary-material" id="SM">
    <title>Supplementary Material</title>
    <supplementary-material content-type="local-data" id="SD1">
      <label>1</label>
      <media xlink:href="NIHMS37901-supplement-1.pdf" orientation="portrait" xlink:type="simple" id="d35e686" position="anchor" mimetype="application" mime-subtype="pdf"/>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack id="S16">
    <title>Acknowledgements</title>
    <p>We would like to thank the members of the 1000 Genomes Project Consortium for discussion, suggestions and sequencing data. We thank Bartu Ahiska, Adam Auton, Ewan Birney, Richard Durbin, Gerton Lunter, Jon Woolf, Daniel Zerbino for discussion, two anonymous reviewers for their comments, and members of the PanMap Project and the Genomics Core at the Wellcome Trust Centre for Human Genetics for access to sequence data. ZI is funded by a grant from the Wellcome Trust (WT086084/Z/08/Z) to GM. The sequencing of NA12878 was done by the Wellcome Trust Sequencing Core at Oxford, under a grant from the Wellcome Trust (090532/Z/09/Z).</p>
  </ack>
  <app-group>
    <app id="APP1">
      <title>Appendix</title>
      <sec id="S17">
        <title>Methods</title>
        <p id="P34">Full details of the methods used in this paper can be found in the <xref ref-type="supplementary-material" rid="SM">Supplementary Methods</xref>. These include definitions of terminology, followed by the sections: (1) Mathematical model for power to detect variants. (2)Variant calling algorithms (Bubble Caller and Path Divergence Caller). (3) Probabilistic Classification of graph structures as repeat-, error- or variant-induced. (4) Genotyping of simple and complex variants in a de Bruijn graph. (5) Description of Cortex software implementation. (6) Error-cleaning algorithms for high coverage samples and low coverage populations. (7) Single genome simulations. (8) Population simulations. (9) Case 1 - Analysis of high coverage human sample NA12878. (10) Case 2 – Pooled assembly of 164 samples from 1000 Genomes Pilot. (11) Case 3 – using probabilistic classification of bubbles on 10 chimpanzees. (12) Case 4 – Genotyping of simple and complex variants. (13) Making appropriate choice of parameters for experimental design. (14) Release of source code and 1000 Genomes population graph. Cortex is available from <ext-link ext-link-type="uri" xlink:href="http://cortexassembler.sourceforge.net/">http://cortexassembler.sourceforge.net/</ext-link>.</p>
      </sec>
    </app>
  </app-group>
  <ref-list>
    <title>References</title>
    <ref id="R1">
      <label>1</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Langmead</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Trapnell</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Pop</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Salzberg</surname>
            <given-names>SL</given-names>
          </name>
        </person-group>
        <article-title>Ultrafast and memory-efficient alignment of short DNA sequences to the human genome</article-title>
        <source>Genome Biol</source>
        <year>2009</year>
        <volume>10</volume>
        <fpage>R25</fpage>
        <pub-id pub-id-type="pmid">19261174</pub-id>
      </element-citation>
    </ref>
    <ref id="R2">
      <label>2</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Durbin</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Fast and accurate long-read alignment with Burrows-Wheeler transform</article-title>
        <source>Bioinformatics</source>
        <year>2010</year>
        <volume>26</volume>
        <fpage>589</fpage>
        <lpage>95</lpage>
        <pub-id pub-id-type="pmid">20080505</pub-id>
      </element-citation>
    </ref>
    <ref id="R3">
      <label>3</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Ruan</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Durbin</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Mapping short DNA sequencing reads and calling variants using mapping quality scores</article-title>
        <source>Genome Res</source>
        <year>2008</year>
        <volume>18</volume>
        <fpage>1851</fpage>
        <lpage>8</lpage>
        <pub-id pub-id-type="pmid">18714091</pub-id>
      </element-citation>
    </ref>
    <ref id="R4">
      <label>4</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Kristiansen</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>SOAP: short oligonucleotide alignment program</article-title>
        <source>Bioinformatics</source>
        <year>2008</year>
        <volume>24</volume>
        <fpage>713</fpage>
        <lpage>4</lpage>
        <pub-id pub-id-type="pmid">18227114</pub-id>
      </element-citation>
    </ref>
    <ref id="R5">
      <label>5</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lunter</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Goodson</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Stampy: A statistical algorithm for sensitive and fast mapping of Illumina sequence reads</article-title>
        <source>Genome Res</source>
        <year>2010</year>
      </element-citation>
    </ref>
    <ref id="R6">
      <label>6</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>McKenna</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The Genome Analysis Toolkit: a MapReduce framework for analyzing next-generation DNA sequencing data</article-title>
        <source>Genome Res</source>
        <year>2010</year>
        <volume>20</volume>
        <fpage>1297</fpage>
        <lpage>303</lpage>
        <pub-id pub-id-type="pmid">20644199</pub-id>
      </element-citation>
    </ref>
    <ref id="R7">
      <label>7</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Albers</surname>
            <given-names>CA</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Dindel: Accurate indel calls from short-read data</article-title>
        <source>Genome Res</source>
        <year>2010</year>
      </element-citation>
    </ref>
    <ref id="R8">
      <label>8</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lee</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Hormozdiari</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Alkan</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Brudno</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>MoDIL: detecting small indels from clone-end sequencing with mixtures of distributions</article-title>
        <source>Nat Methods</source>
        <year>2009</year>
        <volume>6</volume>
        <fpage>473</fpage>
        <lpage>4</lpage>
        <pub-id pub-id-type="pmid">19483690</pub-id>
      </element-citation>
    </ref>
    <ref id="R9">
      <label>9</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hajirasouliha</surname>
            <given-names>I</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Detection and characterization of novel sequence insertions using paired-end next-generation sequencing</article-title>
        <source>Bioinformatics</source>
        <year>2010</year>
        <volume>26</volume>
        <fpage>1277</fpage>
        <lpage>83</lpage>
        <pub-id pub-id-type="pmid">20385726</pub-id>
      </element-citation>
    </ref>
    <ref id="R10">
      <label>10</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Handsaker</surname>
            <given-names>RE</given-names>
          </name>
          <name>
            <surname>Korn</surname>
            <given-names>JM</given-names>
          </name>
          <name>
            <surname>Nemesh</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>McCarroll</surname>
            <given-names>SA</given-names>
          </name>
        </person-group>
        <article-title>Discovery and genotyping of genome structural polymorphism by sequencing on a population scale</article-title>
        <source>Nat Genet</source>
        <year>2011</year>
        <volume>43</volume>
        <fpage>269</fpage>
        <lpage>76</lpage>
        <pub-id pub-id-type="pmid">21317889</pub-id>
      </element-citation>
    </ref>
    <ref id="R11">
      <label>11</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Korbel</surname>
            <given-names>JO</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>PEMer: a computational framework with simulation-based error models for inferring genomic structural variants from massive paired-end sequencing data</article-title>
        <source>Genome Biol</source>
        <year>2009</year>
        <volume>10</volume>
        <fpage>R23</fpage>
        <pub-id pub-id-type="pmid">19236709</pub-id>
      </element-citation>
    </ref>
    <ref id="R12">
      <label>12</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Korbel</surname>
            <given-names>JO</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Paired-end mapping reveals extensive structural variation in the human genome</article-title>
        <source>Science</source>
        <year>2007</year>
        <volume>318</volume>
        <fpage>420</fpage>
        <lpage>6</lpage>
        <pub-id pub-id-type="pmid">17901297</pub-id>
      </element-citation>
    </ref>
    <ref id="R13">
      <label>13</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mills</surname>
            <given-names>RE</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Mapping copy number variation by population-scale genome sequencing</article-title>
        <source>Nature</source>
        <year>2011</year>
        <volume>470</volume>
        <fpage>59</fpage>
        <lpage>65</lpage>
        <pub-id pub-id-type="pmid">21293372</pub-id>
      </element-citation>
    </ref>
    <ref id="R14">
      <label>14</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tuzun</surname>
            <given-names>E</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Fine-scale structural variation of the human genome</article-title>
        <source>Nat Genet</source>
        <year>2005</year>
        <volume>37</volume>
        <fpage>727</fpage>
        <lpage>32</lpage>
        <pub-id pub-id-type="pmid">15895083</pub-id>
      </element-citation>
    </ref>
    <ref id="R15">
      <label>15</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bentley</surname>
            <given-names>DR</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Accurate whole human genome sequencing using reversible terminator chemistry</article-title>
        <source>Nature</source>
        <year>2008</year>
        <volume>456</volume>
        <fpage>53</fpage>
        <lpage>9</lpage>
        <pub-id pub-id-type="pmid">18987734</pub-id>
      </element-citation>
    </ref>
    <ref id="R16">
      <label>16</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The diploid genome sequence of an Asian individual</article-title>
        <source>Nature</source>
        <year>2008</year>
        <volume>456</volume>
        <fpage>60</fpage>
        <lpage>5</lpage>
        <pub-id pub-id-type="pmid">18987735</pub-id>
      </element-citation>
    </ref>
    <ref id="R17">
      <label>17</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <collab>The 1000 Genomes Project Consortium</collab>
        </person-group>
        <article-title>A map of human genome variation from population-scale sequencing</article-title>
        <source>Nature</source>
        <year>2010</year>
        <volume>467</volume>
        <fpage>1061</fpage>
        <lpage>73</lpage>
        <pub-id pub-id-type="pmid">20981092</pub-id>
      </element-citation>
    </ref>
    <ref id="R18">
      <label>18</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ge</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>LS</given-names>
          </name>
          <name>
            <surname>Kim</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>The cobweb of life revealed by genome-scale estimates of horizontal gene transfer</article-title>
        <source>PLoS Biol</source>
        <year>2005</year>
        <volume>3</volume>
        <fpage>e316</fpage>
        <pub-id pub-id-type="pmid">16122348</pub-id>
      </element-citation>
    </ref>
    <ref id="R19">
      <label>19</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Beiko</surname>
            <given-names>RG</given-names>
          </name>
          <name>
            <surname>Harlow</surname>
            <given-names>TJ</given-names>
          </name>
          <name>
            <surname>Ragan</surname>
            <given-names>MA</given-names>
          </name>
        </person-group>
        <article-title>Highways of gene sharing in prokaryotes</article-title>
        <source>Proc Natl Acad Sci U S A</source>
        <year>2005</year>
        <volume>102</volume>
        <fpage>14332</fpage>
        <lpage>7</lpage>
        <pub-id pub-id-type="pmid">16176988</pub-id>
      </element-citation>
    </ref>
    <ref id="R20">
      <label>20</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Holcomb</surname>
            <given-names>CL</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A multi-site study using high-resolution HLA genotyping by next generation sequencing</article-title>
        <source>Tissue Antigens</source>
        <year>2011</year>
        <volume>77</volume>
        <fpage>206</fpage>
        <lpage>217</lpage>
        <pub-id pub-id-type="pmid">21299525</pub-id>
      </element-citation>
    </ref>
    <ref id="R21">
      <label>21</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Fonseca</surname>
            <given-names>VG</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Second-generation environmental sequencing unmasks marine metazoan biodiversity</article-title>
        <source>Nat Commun</source>
        <year>2010</year>
        <volume>1</volume>
        <fpage>98</fpage>
        <pub-id pub-id-type="pmid">20981026</pub-id>
      </element-citation>
    </ref>
    <ref id="R22">
      <label>22</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Iafrate</surname>
            <given-names>AJ</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Detection of large-scale variation in the human genome</article-title>
        <source>Nat Genet</source>
        <year>2004</year>
        <volume>36</volume>
        <fpage>949</fpage>
        <lpage>51</lpage>
        <pub-id pub-id-type="pmid">15286789</pub-id>
      </element-citation>
    </ref>
    <ref id="R23">
      <label>23</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Redon</surname>
            <given-names>R</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Global variation in copy number in the human genome</article-title>
        <source>Nature</source>
        <year>2006</year>
        <volume>444</volume>
        <fpage>444</fpage>
        <lpage>54</lpage>
        <pub-id pub-id-type="pmid">17122850</pub-id>
      </element-citation>
    </ref>
    <ref id="R24">
      <label>24</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sebat</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Large-scale copy number polymorphism in the human genome</article-title>
        <source>Science</source>
        <year>2004</year>
        <volume>305</volume>
        <fpage>525</fpage>
        <lpage>8</lpage>
        <pub-id pub-id-type="pmid">15273396</pub-id>
      </element-citation>
    </ref>
    <ref id="R25">
      <label>25</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sharp</surname>
            <given-names>AJ</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Segmental duplications and copy-number variation in the human genome</article-title>
        <source>Am J Hum Genet</source>
        <year>2005</year>
        <volume>77</volume>
        <fpage>78</fpage>
        <lpage>88</lpage>
        <pub-id pub-id-type="pmid">15918152</pub-id>
      </element-citation>
    </ref>
    <ref id="R26">
      <label>26</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kidd</surname>
            <given-names>JM</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Mapping and sequencing of structural variation from eight human genomes</article-title>
        <source>Nature</source>
        <year>2008</year>
        <volume>453</volume>
        <fpage>56</fpage>
        <lpage>64</lpage>
        <pub-id pub-id-type="pmid">18451855</pub-id>
      </element-citation>
    </ref>
    <ref id="R27">
      <label>27</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Myers</surname>
            <given-names>EW</given-names>
          </name>
        </person-group>
        <article-title>Toward simplifying and accurately formulating fragment assembly</article-title>
        <source>J Comput Biol</source>
        <year>1995</year>
        <volume>2</volume>
        <fpage>275</fpage>
        <lpage>90</lpage>
        <pub-id pub-id-type="pmid">7497129</pub-id>
      </element-citation>
    </ref>
    <ref id="R28">
      <label>28</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Myers</surname>
            <given-names>EW</given-names>
          </name>
        </person-group>
        <article-title>The fragment assembly string graph</article-title>
        <source>Bioinformatics</source>
        <year>2005</year>
        <volume>21</volume>
        <issue>Suppl 2</issue>
        <fpage>ii79</fpage>
        <lpage>85</lpage>
        <pub-id pub-id-type="pmid">16204131</pub-id>
      </element-citation>
    </ref>
    <ref id="R29">
      <label>29</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Simpson</surname>
            <given-names>JT</given-names>
          </name>
          <name>
            <surname>Durbin</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Efficient construction of an assembly string graph using the FM-index</article-title>
        <source>Bioinformatics</source>
        <year>2010</year>
        <volume>26</volume>
        <fpage>i367</fpage>
        <lpage>73</lpage>
        <pub-id pub-id-type="pmid">20529929</pub-id>
      </element-citation>
    </ref>
    <ref id="R30">
      <label>30</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zerbino</surname>
            <given-names>DR</given-names>
          </name>
          <name>
            <surname>Birney</surname>
            <given-names>E</given-names>
          </name>
        </person-group>
        <article-title>Velvet: algorithms for de novo short read assembly using de Bruijn graphs</article-title>
        <source>Genome Res</source>
        <year>2008</year>
        <volume>18</volume>
        <fpage>821</fpage>
        <lpage>9</lpage>
        <pub-id pub-id-type="pmid">18349386</pub-id>
      </element-citation>
    </ref>
    <ref id="R31">
      <label>31</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gnerre</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>High-quality draft assemblies of mammalian genomes from massively parallel sequence data</article-title>
        <source>Proc Natl Acad Sci U S A</source>
        <year>2011</year>
        <volume>108</volume>
        <fpage>1513</fpage>
        <lpage>8</lpage>
        <pub-id pub-id-type="pmid">21187386</pub-id>
      </element-citation>
    </ref>
    <ref id="R32">
      <label>32</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>R</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>De novo assembly of human genomes with massively parallel short read sequencing</article-title>
        <source>Genome Res</source>
        <year>2010</year>
        <volume>20</volume>
        <fpage>265</fpage>
        <lpage>72</lpage>
        <pub-id pub-id-type="pmid">20019144</pub-id>
      </element-citation>
    </ref>
    <ref id="R33">
      <label>33</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jones</surname>
            <given-names>T</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The diploid genome sequence of Candida albicans</article-title>
        <source>Proc Natl Acad Sci USA</source>
        <year>2004</year>
        <volume>101</volume>
        <fpage>7329</fpage>
        <lpage>34</lpage>
        <pub-id pub-id-type="pmid">15123810</pub-id>
      </element-citation>
    </ref>
    <ref id="R34">
      <label>34</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Vinson</surname>
            <given-names>JP</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Assembly of polymorphic genomes: algorithms and application to Ciona savignyi</article-title>
        <source>Genome Res</source>
        <year>2005</year>
        <volume>15</volume>
        <fpage>1127</fpage>
        <lpage>35</lpage>
        <pub-id pub-id-type="pmid">16077012</pub-id>
      </element-citation>
    </ref>
    <ref id="R35">
      <label>35</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kim</surname>
            <given-names>JH</given-names>
          </name>
          <name>
            <surname>Waterman</surname>
            <given-names>MS</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>LM</given-names>
          </name>
        </person-group>
        <article-title>Diploid genome reconstruction of Ciona intestinalis and comparative analysis with Ciona savignyi</article-title>
        <source>Genome Res</source>
        <year>2007</year>
        <volume>17</volume>
        <fpage>1101</fpage>
        <lpage>10</lpage>
        <pub-id pub-id-type="pmid">17567986</pub-id>
      </element-citation>
    </ref>
    <ref id="R36">
      <label>36</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Donmez</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Brudno</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Hapsembler: An assembler for highly polymorphic genomes</article-title>
        <source>Research in Computational Molecular Biology, Lecture Notes in Computer Science</source>
        <year>2011</year>
        <volume>6577</volume>
        <fpage>38</fpage>
        <publisher-name>Springer</publisher-name>
        <publisher-loc>Berlin</publisher-loc>
      </element-citation>
    </ref>
    <ref id="R37">
      <label>37</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pevzner</surname>
            <given-names>PA</given-names>
          </name>
          <name>
            <surname>Tang</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Waterman</surname>
            <given-names>MS</given-names>
          </name>
        </person-group>
        <article-title>An Eulerian path approach to DNA fragment assembly</article-title>
        <source>Proc Natl Acad Sci U S A</source>
        <year>2001</year>
        <volume>98</volume>
        <fpage>9748</fpage>
        <lpage>53</lpage>
        <pub-id pub-id-type="pmid">11504945</pub-id>
      </element-citation>
    </ref>
    <ref id="R38">
      <label>38</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Idury</surname>
            <given-names>RM</given-names>
          </name>
          <name>
            <surname>Waterman</surname>
            <given-names>MS</given-names>
          </name>
        </person-group>
        <article-title>A new algorithm for DNA sequence assembly</article-title>
        <source>J Comput Biol</source>
        <year>1995</year>
        <volume>2</volume>
        <fpage>291</fpage>
        <lpage>306</lpage>
        <pub-id pub-id-type="pmid">7497130</pub-id>
      </element-citation>
    </ref>
    <ref id="R39">
      <label>39</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Simpson</surname>
            <given-names>JT</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>ABySS: a parallel assembler for short read sequence data</article-title>
        <source>Genome Res</source>
        <year>2009</year>
        <volume>19</volume>
        <fpage>1117</fpage>
        <lpage>23</lpage>
        <pub-id pub-id-type="pmid">19251739</pub-id>
      </element-citation>
    </ref>
    <ref id="R40">
      <label>40</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zerbino</surname>
            <given-names>DR</given-names>
          </name>
          <name>
            <surname>McEwen</surname>
            <given-names>GK</given-names>
          </name>
          <name>
            <surname>Margulies</surname>
            <given-names>EH</given-names>
          </name>
          <name>
            <surname>Birney</surname>
            <given-names>E</given-names>
          </name>
        </person-group>
        <article-title>Pebble and rock band: heuristic resolution of repeats and scaffolding in the velvet short-read de novo assembler</article-title>
        <source>PLoS ONE</source>
        <year>2009</year>
        <volume>4</volume>
        <fpage>e8407</fpage>
        <pub-id pub-id-type="pmid">20027311</pub-id>
      </element-citation>
    </ref>
    <ref id="R41">
      <label>41</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kidd</surname>
            <given-names>JM</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A human genome structural variation sequencing resource reveals insights into mutational mechanisms</article-title>
        <source>Cell</source>
        <year>2010</year>
        <volume>143</volume>
        <fpage>837</fpage>
        <lpage>47</lpage>
        <pub-id pub-id-type="pmid">21111241</pub-id>
      </element-citation>
    </ref>
    <ref id="R42">
      <label>42</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Myers</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Drive against hotspot motifs in primates implicates the PRDM9 gene in meiotic recombination</article-title>
        <source>Science</source>
        <year>2010</year>
        <volume>327</volume>
        <fpage>876</fpage>
        <lpage>9</lpage>
        <pub-id pub-id-type="pmid">20044541</pub-id>
      </element-citation>
    </ref>
    <ref id="R43">
      <label>43</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <collab>The International HapMap Consortium</collab>
        </person-group>
        <article-title>A second generation human haplotype map of over 3.1 million SNPs</article-title>
        <source>Nature</source>
        <year>2007</year>
        <volume>449</volume>
        <fpage>851</fpage>
        <lpage>61</lpage>
        <pub-id pub-id-type="pmid">17943122</pub-id>
      </element-citation>
    </ref>
    <ref id="R44">
      <label>44</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>de Bakker</surname>
            <given-names>PI</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A high-resolution HLA and SNP haplotype map for disease association studies in the extended human MHC</article-title>
        <source>Nat Genet</source>
        <year>2006</year>
        <volume>38</volume>
        <fpage>1166</fpage>
        <lpage>72</lpage>
        <pub-id pub-id-type="pmid">16998491</pub-id>
      </element-citation>
    </ref>
    <ref id="R45">
      <label>45</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ratan</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Yu</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Hayes</surname>
            <given-names>VM</given-names>
          </name>
          <name>
            <surname>Schuster</surname>
            <given-names>SC</given-names>
          </name>
          <name>
            <surname>Miller</surname>
            <given-names>W</given-names>
          </name>
        </person-group>
        <article-title>Calling SNPs without a reference sequence</article-title>
        <source>BMC Bioinformatics</source>
        <year>2010</year>
        <volume>11</volume>
        <pub-id pub-id-type="pmid">20230626</pub-id>
      </element-citation>
    </ref>
    <ref id="R46">
      <label>46</label>
      <element-citation publication-type="confproc">
        <person-group person-group-type="author">
          <name>
            <surname>Peterlongo</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Schnel</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Pisanti</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Sagot</surname>
            <given-names>M-F</given-names>
          </name>
          <name>
            <surname>Lacroix</surname>
            <given-names>V</given-names>
          </name>
        </person-group>
        <person-group person-group-type="editor">
          <name>
            <surname>Chavez</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Lonardi</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Identifying SNPs without a reference genome by comparing raw reads</article-title>
        <volume>2010</volume>
        <fpage>147</fpage>
        <lpage>158</lpage>
        <conf-name>String Processing and Information Retrieval - 17th International Symposium</conf-name>
        <conf-loc>Los Cabos, Mexico</conf-loc>
        <conf-date>2010</conf-date>
      </element-citation>
    </ref>
    <ref id="R47">
      <label>47</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ding</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Wendl</surname>
            <given-names>MC</given-names>
          </name>
          <name>
            <surname>Koboldt</surname>
            <given-names>DC</given-names>
          </name>
          <name>
            <surname>Mardis</surname>
            <given-names>ER</given-names>
          </name>
        </person-group>
        <article-title>Analysis of next-generation genomic data in cancer: accomplishments and challenges</article-title>
        <source>Hum Mol Genet</source>
        <year>2010</year>
        <volume>19</volume>
        <fpage>R188</fpage>
        <lpage>96</lpage>
        <pub-id pub-id-type="pmid">20843826</pub-id>
      </element-citation>
    </ref>
    <ref id="R48">
      <label>48</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Harris</surname>
            <given-names>SR</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Evolution of MRSA during hospital transmission and intercontinental spread</article-title>
        <source>Science</source>
        <year>2010</year>
        <volume>327</volume>
        <fpage>469</fpage>
        <lpage>74</lpage>
        <pub-id pub-id-type="pmid">20093474</pub-id>
      </element-citation>
    </ref>
    <ref id="R49">
      <label>49</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Butler</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>ALLPATHS: de novo assembly of whole-genome shotgun microreads</article-title>
        <source>Genome Res</source>
        <year>2008</year>
        <volume>18</volume>
        <fpage>810</fpage>
        <lpage>20</lpage>
        <pub-id pub-id-type="pmid">18340039</pub-id>
      </element-citation>
    </ref>
    <ref id="R50">
      <label>50</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chaisson</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>Brinza</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Pevzner</surname>
            <given-names>PA</given-names>
          </name>
        </person-group>
        <article-title>De novo fragment assembly with short mate-paired reads: Does the read length matter?</article-title>
        <source>Genome Res</source>
        <year>2009</year>
        <volume>19</volume>
        <fpage>336</fpage>
        <lpage>46</lpage>
        <pub-id pub-id-type="pmid">19056694</pub-id>
      </element-citation>
    </ref>
    <ref id="R51">
      <label>51</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kelley</surname>
            <given-names>DR</given-names>
          </name>
          <name>
            <surname>Schatz</surname>
            <given-names>MC</given-names>
          </name>
          <name>
            <surname>Salzberg</surname>
            <given-names>SL</given-names>
          </name>
        </person-group>
        <article-title>Quake: quality-aware detection and correction of sequencing errors</article-title>
        <source>Genome Biol</source>
        <year>2010</year>
        <volume>11</volume>
        <fpage>R116</fpage>
        <pub-id pub-id-type="pmid">21114842</pub-id>
      </element-citation>
    </ref>
    <ref id="R52">
      <label>52</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Allsopp</surname>
            <given-names>CE</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Sequence analysis of HLA-Bw53, a common West African allele, suggests an origin by gene conversion of HLA-B35</article-title>
        <source>Hum Immunol</source>
        <year>1991</year>
        <volume>30</volume>
        <fpage>105</fpage>
        <lpage>9</lpage>
        <pub-id pub-id-type="pmid">2022493</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
<floats-group>
  <fig id="F1" orientation="portrait" position="float">
    <label>Figure 1</label>
    <caption>
      <p>Schematic representation of four methods of variation analysis using colored de Bruijn graphs; line width represents coverage. (<bold>a</bold>) Discovery of variants in a single outbred diploid individual (blue) with a reference sequence (red). True polymorphisms generate bubbles that diverge from the reference, while repeat structures lead to bubbles also observed in the reference. (<bold>b</bold>) Even when the reference allele (red) does not form a clean bubble, we can identify homozygous variant sites by tracking the divergence of the reference path from that of the sample. On finding a breakpoint, we take the longest contig in the sample (i.e. the path as far as the next junction) and ask whether the reference path returns before this point (green circle = anchoring sequence). The algorithm (path divergence) is not affected by repeat sequence within the reference allele present elsewhere in the genome of the sample (blue dotted). (<bold>c</bold>) When many samples (each in a different colour) are combined it is possible to distinguish repeat-induced bubbles (in which both sides of the bubble are present in all samples) from true variant sites (in which bubble coverage varies with genotypes and genotypes are in Hardy-Weinberg equilibrium). (<bold>d</bold>) The likelihood of any given genotype can be calculated from the coverage (blue) of each allele (green, red), accounting for contributions from other parts of the genome. In this example, the sample is heterozygous thus has coverage of both alleles, though not sufficient to enable full assembly.</p>
    </caption>
    <graphic xlink:href="ukmss-37901-f0001"/>
  </fig>
  <fig id="F2" orientation="portrait" position="float">
    <label>Figure 2</label>
    <caption>
      <p>Simulation-based evaluation of Cortex. (<bold>a</bold>) Power of the Bubble-calling (BC) algorithm to detect heterozygous SNPs in a single individual, as a function of k-mer size. Genome repeat content dictates an upper limit to power (black dashed line), while finite sequence coverage reduces power for large k-mer size (solid lines, circles) in a predictable manner (dashed lines). Increased coverage reduces power at lower k-mer sizes due to recurrent errors that evade error-cleaning. At high <italic>k</italic> (e.g. <italic>k</italic>=55, 50x) power is close to the upper limit. (<bold>b</bold>) Power to detect different variant types in homozygous and heterozygous states using the BC and Path divergence (PD) algorithms with 30x coverage (100bp reads, <italic>k</italic>=55). For simple variant types power is 80-85%. For medium-sized variants power remains high at homozygous sites, but is ≤50% at heterozygous sites. For large events, there is only power for homozygous sites and this only through PD. (<bold>c</bold>) Power to detect SNP variants using BC in population data (10 individuals, 10x coverage, 100bp reads, <italic>k</italic>=55). Fluctuations in coverage reduce power for low frequency variants. More stringent cleaning increases power because bubbles are less confounded by errors. (<bold>d</bold>) FDR for call sets in panel (c) before and after classifying bubbles as error-, repeat- or variant-induced. The probabilistic filter reduces FDR under relaxed cleaning from 29% to 1.5% with 1.7% loss in power and from 2.3% to 1.6% with 1% loss in power for the stringent cleaning.</p>
    </caption>
    <graphic xlink:href="ukmss-37901-f0002"/>
  </fig>
  <fig id="F3" orientation="portrait" position="float">
    <label>Figure 3</label>
    <caption>
      <p>Structural and complex variants identified in a single high coverage genome. (<bold>a</bold>) Size distribution of short indels discovered in NA12878 from 26x coverage of 100bp reads analysed using the BC (black) and PD (blue) algorithms. Also shown is the number of indels of different sizes called by mapping-based approaches from 63x coverage on the same sample within the 1000 Genomes Project<sup><xref ref-type="bibr" rid="R17">17</xref></sup> (red). While the 1000 Genomes Project calls more small variants, only the two Cortex algorithms can detect longer variants, which are typically too short to be detected by larger structural variation discovery methods. The PD caller exhibits bias towards calling deletions for larger variant sizes. (<bold>b</bold>) Two examples of complex variants identified in NA12878 using Cortex and validated in the independent fosmid data. In the top example, the PD algorithm assembles a haplotype over 1.7kb containing a number of phased SNPs (red) and a complex insertion/deletion event (inserted material is blue). In the bottom example, the BC algorithm assembles two haplotypes containing four phased SNPs and an insertion.</p>
    </caption>
    <graphic xlink:href="ukmss-37901-f0003"/>
  </fig>
  <fig id="F4" orientation="portrait" position="float">
    <label>Figure 4</label>
    <caption>
      <p>Population analysis with Cortex. (<bold>a</bold>) Estimates of mean copy number per genome in CEU and YRI for novel sequence contigs identified from analysis of pooled population graphs for 164 humans sequenced to low depth (2-4x) with the 1000 Genomes Project. Contigs are all at least 100bp long and have &lt;90% homology to the reference genome (determined by BLAST). Allelic variation lies in the interval (0,1), while copy-number variable sequence can be present up to 6.3 times. Variants are annotated by whether they show significant homology to known transcripts, including HLA, KIR and olfactory receptor (OR) genes as specific categories, which are clearly enriched. We note the presence of several OR matches that are approximately 20% frequency in YRI but apparently absent from CEU. (<bold>b</bold>) Power to detect SNP variants previously analysed through SNP genotyping in HTS data from 10 chimpanzees (6x coverage, 50bp reads analysed at <italic>k</italic>=31). Empirical estimates (red, with normal approximation to binomial confidence intervals shown dotted) closely track predictions (black) from the theoretical model.</p>
    </caption>
    <graphic xlink:href="ukmss-37901-f0004"/>
  </fig>
  <fig id="F5" orientation="portrait" position="float">
    <label>Figure 5</label>
    <caption>
      <p><italic>HLA-B</italic> genotyping from HTS data using Cortex. (<bold>a</bold>) Heat-plot showing the likelihood surface for HLA-B genotypes for NA19240 (the child of the Yoruban trio from the 1000 Genomes Project<sup><xref ref-type="bibr" rid="R17">17</xref></sup>). The lower part shows the likelihood surface at 2-digit resolution (represented by the most likely genotype among all compatible alleles) and the top shows a blow-up for the most-likely 2-digit genotype (B*57/B*35). The maximum likelihood genotype is B*57:03:01/B*35:01:01 which agrees with the 4-digit resolution data generated previously using standard experimental methods<sup><xref ref-type="bibr" rid="R44">44</xref></sup> (MLE shown by dotted line; difference in log-likelihood from MLE shown for selected genotypes). Other alleles identified as possible at the 2-digit level (HLA-B*15, B*53 and B*58) are closely related to those present in the sample. B*53 is known to be a product of gene conversion from B*35<sup><xref ref-type="bibr" rid="R52">52</xref></sup>, and B*58 is a split antigen from B*15 with sister serotype B*57. (<bold>b</bold>) Heat plot showing the likelihood surface at 2-digit resolution for selected HLA-B genotypes for NA12878 (top) as a function of sequence depth. The blow-up shows 4-digit level resolution at 20x. At low coverage there is no consistent most likely genotype; from 10-14x the most likely is B*08/B*35, which switches to B*56:01/B*08:xx (where xx = 03, 13, 15, 36 and 47; all have log likelihood within 0.03 units) at 16x. Lab-based typing gives B*56:01/B*08:01, which is 3.2 units in log-likelihood less than the MLE.</p>
    </caption>
    <graphic xlink:href="ukmss-37901-f0005"/>
  </fig>
  <table-wrap id="T1" position="float" orientation="landscape">
    <label>Table 1</label>
    <caption>
      <title>Comparison of 1000 Genomes and Cortex calls to fosmid data</title>
    </caption>
    <table frame="hsides" rules="groups">
      <thead>
        <tr>
          <th align="left" valign="top" rowspan="1" colspan="1">Variant type</th>
          <th align="center" valign="top" rowspan="1" colspan="1">1000<break/>Genomes<break/><sup><xref ref-type="table-fn" rid="TFN1">a</xref></sup></th>
          <th colspan="2" align="center" valign="top" rowspan="1">Cortex</th>
          <th colspan="2" align="center" valign="top" rowspan="1">Bubble Caller</th>
          <th colspan="2" align="center" valign="top" rowspan="1">Path Divergence</th>
        </tr>
        <tr>
          <th align="left" valign="top" rowspan="1" colspan="1"/>
          <th align="center" valign="top" rowspan="1" colspan="1"/>
          <th align="center" valign="top" rowspan="1" colspan="1">All</th>
          <th align="center" valign="top" rowspan="1" colspan="1"><break/>High<break/>confidence<sup><xref ref-type="table-fn" rid="TFN2">b</xref></sup></th>
          <th align="center" valign="top" rowspan="1" colspan="1">All</th>
          <th align="center" valign="top" rowspan="1" colspan="1"><break/>High<break/>confidence</th>
          <th align="center" valign="top" rowspan="1" colspan="1">All</th>
          <th align="center" valign="top" rowspan="1" colspan="1"><break/>High<break/>confidence</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td align="left" valign="top" rowspan="1" colspan="1">SNP (Hom)</td>
          <td align="center" valign="top" rowspan="1" colspan="1">1085 (0)</td>
          <td align="center" valign="top" rowspan="1" colspan="1">1071 (4.0)</td>
          <td align="center" valign="top" rowspan="1" colspan="1">605 (0.5)</td>
          <td align="center" valign="top" rowspan="1" colspan="1">1057 (3.9)</td>
          <td align="center" valign="top" rowspan="1" colspan="1">591 (0.5)</td>
          <td align="center" valign="top" rowspan="1" colspan="1">340(8.5)</td>
          <td align="center" valign="top" rowspan="1" colspan="1">144 (1.4)</td>
        </tr>
        <tr>
          <td align="left" valign="top" rowspan="1" colspan="1">SNP (Het)</td>
          <td align="center" valign="top" rowspan="1" colspan="1">2350 (28)</td>
          <td align="center" valign="top" rowspan="1" colspan="1">1155 (32)</td>
          <td align="center" valign="top" rowspan="1" colspan="1">1029 (32)</td>
          <td align="center" valign="top" rowspan="1" colspan="1">1155 (32)</td>
          <td align="center" valign="top" rowspan="1" colspan="1">1029 (32)</td>
          <td align="center" valign="top" rowspan="1" colspan="1">0 (−)</td>
          <td align="center" valign="top" rowspan="1" colspan="1">0 (−)</td>
        </tr>
        <tr>
          <td align="left" valign="top" rowspan="1" colspan="1">Indel (Hom)</td>
          <td align="center" valign="top" rowspan="1" colspan="1">64 (0)</td>
          <td align="center" valign="top" rowspan="1" colspan="1">96 (6.3)</td>
          <td align="center" valign="top" rowspan="1" colspan="1">20 (0)</td>
          <td align="center" valign="top" rowspan="1" colspan="1">79 (6.3)</td>
          <td align="center" valign="top" rowspan="1" colspan="1">16 (0)</td>
          <td align="center" valign="top" rowspan="1" colspan="1">37 (5.4)</td>
          <td align="center" valign="top" rowspan="1" colspan="1">5 (0)</td>
        </tr>
        <tr>
          <td align="left" valign="top" rowspan="1" colspan="1">Indel (Het)</td>
          <td align="center" valign="top" rowspan="1" colspan="1">127 (29)</td>
          <td align="center" valign="top" rowspan="1" colspan="1">67 (40)</td>
          <td align="center" valign="top" rowspan="1" colspan="1">43 (30)</td>
          <td align="center" valign="top" rowspan="1" colspan="1">67 (40)</td>
          <td align="center" valign="top" rowspan="1" colspan="1">43 (30)</td>
          <td align="center" valign="top" rowspan="1" colspan="1">0 (−)</td>
          <td align="center" valign="top" rowspan="1" colspan="1">0 (−)</td>
        </tr>
        <tr>
          <td align="left" valign="middle" rowspan="1" colspan="1">Complex<break/>(Hom)</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">-</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">258 (1.9)</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">202 (1.5)</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">112 (2.7)</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">77 (1.3)</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">174 (1.7)</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">139 (2.2)</td>
        </tr>
        <tr>
          <td align="left" valign="top" rowspan="1" colspan="1">Complex (Het)</td>
          <td align="center" valign="top" rowspan="1" colspan="1">-</td>
          <td align="center" valign="top" rowspan="1" colspan="1">161 (26)</td>
          <td align="center" valign="top" rowspan="1" colspan="1">137 (25)</td>
          <td align="center" valign="top" rowspan="1" colspan="1">161 (26)</td>
          <td align="center" valign="top" rowspan="1" colspan="1">137 (25)</td>
          <td align="center" valign="top" rowspan="1" colspan="1">0 (−)</td>
          <td align="center" valign="top" rowspan="1" colspan="1">0 (−)</td>
        </tr>
      </tbody>
    </table>
    <table-wrap-foot>
      <fn id="TFN1">
        <label>a</label>
        <p id="P37">Values reported are the number of each variant/genotype combination called and in parentheses the percentage of cases where only the reference allele was observed in the fosmid sequence data.</p>
      </fn>
      <fn id="TFN2">
        <label>b</label>
        <p id="P38">High confidence call set requires log<sub>10</sub>(Bayes factor) for the reported genotype to be at least 4.</p>
      </fn>
    </table-wrap-foot>
  </table-wrap>
</floats-group>
