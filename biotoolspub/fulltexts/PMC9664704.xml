<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>BMC Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">9664704</article-id>
    <article-id pub-id-type="publisher-id">5005</article-id>
    <article-id pub-id-type="doi">10.1186/s12859-022-05005-1</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Single sample pathway analysis in metabolomics: performance evaluation and application</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Wieder</surname>
          <given-names>Cecilia</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Lai</surname>
          <given-names>Rachel P. J.</given-names>
        </name>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Ebbels</surname>
          <given-names>Timothy M. D.</given-names>
        </name>
        <address>
          <email>t.ebbels@imperial.ac.uk</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="GRID">grid.7445.2</institution-id><institution-id institution-id-type="ISNI">0000 0001 2113 8111</institution-id><institution>Section of Bioinformatics, Division of Systems Medicine, Department of Metabolism, Digestion, and Reproduction, Faculty of Medicine, </institution><institution>Imperial College London, </institution></institution-wrap>London, UK </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="GRID">grid.7445.2</institution-id><institution-id institution-id-type="ISNI">0000 0001 2113 8111</institution-id><institution>Department of Infectious Disease, Faculty of Medicine, </institution><institution>Imperial College London, </institution></institution-wrap>London, UK </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>14</day>
      <month>11</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>14</day>
      <month>11</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2022</year>
    </pub-date>
    <volume>23</volume>
    <elocation-id>481</elocation-id>
    <history>
      <date date-type="received">
        <day>22</day>
        <month>7</month>
        <year>2022</year>
      </date>
      <date date-type="accepted">
        <day>25</day>
        <month>10</month>
        <year>2022</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2022</copyright-statement>
      <license>
        <ali:license_ref specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p><bold>Open Access</bold>This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article's Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article's Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated in a credit line to the data.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p id="Par1">Single sample pathway analysis (ssPA) transforms molecular level omics data to the pathway level, enabling the discovery of patient-specific pathway signatures. Compared to conventional pathway analysis, ssPA overcomes the limitations by enabling multi-group comparisons, alongside facilitating numerous downstream analyses such as pathway-based machine learning. While in transcriptomics ssPA is a widely used technique, there is little literature evaluating its suitability for metabolomics. Here we provide a benchmark of established ssPA methods (ssGSEA, GSVA, SVD (PLAGE), and z-score) alongside the evaluation of two novel methods we propose: ssClustPA and kPCA, using semi-synthetic metabolomics data. We then demonstrate how ssPA can facilitate pathway-based interpretation of metabolomics data by performing a case-study on inflammatory bowel disease mass spectrometry data, using clustering to determine subtype-specific pathway signatures.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p id="Par2">While GSEA-based and z-score methods outperformed the others in terms of recall, clustering/dimensionality reduction-based methods provided higher precision at moderate-to-high effect sizes. A case study applying ssPA to inflammatory bowel disease data demonstrates how these methods yield a much richer depth of interpretation than conventional approaches, for example by clustering pathway scores to visualise a pathway-based patient subtype-specific correlation network. We also developed the sspa python package (freely available at <ext-link ext-link-type="uri" xlink:href="https://pypi.org/project/sspa/">https://pypi.org/project/sspa/</ext-link>), providing implementations of all the methods benchmarked in this study.</p>
      </sec>
      <sec>
        <title>Conclusion</title>
        <p id="Par3">This work underscores the value ssPA methods can add to metabolomic studies and provides a useful reference for those wishing to apply ssPA methods to metabolomics data.</p>
      </sec>
      <sec>
        <title>Supplementary Information</title>
        <p>The online version contains supplementary material available at 10.1186/s12859-022-05005-1.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Single-sample pathway analysis</kwd>
      <kwd>Metabolomics pathway analysis</kwd>
      <kwd>Enrichment analysis</kwd>
      <kwd>Benchmarking</kwd>
      <kwd>Simulation</kwd>
      <kwd>Pathway visualisation</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100010269</institution-id>
            <institution>Wellcome Trust</institution>
          </institution-wrap>
        </funding-source>
        <award-id>222837/Z/21/Z</award-id>
        <principal-award-recipient>
          <name>
            <surname>Wieder</surname>
            <given-names>Cecilia</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100000265</institution-id>
            <institution>Medical Research Council</institution>
          </institution-wrap>
        </funding-source>
        <award-id>MR/R008922/1</award-id>
        <principal-award-recipient>
          <name>
            <surname>Lai</surname>
            <given-names>Rachel P. J.</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100000268</institution-id>
            <institution>Biotechnology and Biological Sciences Research Council</institution>
          </institution-wrap>
        </funding-source>
        <award-id>BB/T007974/1</award-id>
        <principal-award-recipient>
          <name>
            <surname>Ebbels</surname>
            <given-names>Timothy M. D.</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000002</institution-id>
            <institution>National Institutes of Health</institution>
          </institution-wrap>
        </funding-source>
        <award-id>1 R01 HL133932-01</award-id>
        <principal-award-recipient>
          <name>
            <surname>Ebbels</surname>
            <given-names>Timothy M. D.</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2022</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Introduction</title>
    <p id="Par4">As metabolomics continues to emerge as a powerful platform for profiling small molecules in various areas of research [<xref ref-type="bibr" rid="CR1">1</xref>–<xref ref-type="bibr" rid="CR3">3</xref>], interpretation of the results of such studies remains of paramount importance. This is particularly critical in untargeted experiments, in which as many metabolites as possible are assayed in order to build a comprehensive metabolic profile of the phenotype under study [<xref ref-type="bibr" rid="CR4">4</xref>]. Such a study does not usually begin with a specific hypothesis, but seeks to develop and refine hypotheses through downstream analysis of the data. A typical metabolomics analysis workflow usually involves identifying a subset of metabolites of interest in relation to the study objective, which can be achieved in various ways not limited to statistical association testing, multivariate statistical approaches, and machine learning (classification and regression) [<xref ref-type="bibr" rid="CR5">5</xref>]. Once metabolites of interest are identified, the next step often involves placing these in a biological context. Pathway analysis (PA) is perhaps the most well-known computational approach for doing so, typically providing users with a list of pathways considered enriched in the condition of interest (e.g. disease vs. healthy) [<xref ref-type="bibr" rid="CR6">6</xref>–<xref ref-type="bibr" rid="CR9">9</xref>]. These pathways are curated using both manual and computational approaches and deposited in databases, representing sets of biochemical reactions that collectively perform a specific function [<xref ref-type="bibr" rid="CR10">10</xref>].</p>
    <p id="Par5">Conventional PA approaches widely used across omics data types (genomics, transcriptomics, proteomics, and metabolomics, etc.) commonly focus on a two-group analysis, seeking to identify significantly impacted pathways between the study groups. These methods can be broadly classified into three main categories: over-representation analysis (ORA) [<xref ref-type="bibr" rid="CR11">11</xref>], functional class scoring approaches such as GSEA [<xref ref-type="bibr" rid="CR12">12</xref>], and network topology-based approaches [<xref ref-type="bibr" rid="CR13">13</xref>]. While there exists a wealth of literature describing and evaluating these approaches in transcriptomics [<xref ref-type="bibr" rid="CR6">6</xref>, <xref ref-type="bibr" rid="CR9">9</xref>, <xref ref-type="bibr" rid="CR13">13</xref>], the development and application of these methods is only at the early exploration phase in the metabolomics context [<xref ref-type="bibr" rid="CR14">14</xref>–<xref ref-type="bibr" rid="CR16">16</xref>]. Despite the popularity and success of these methods, there are several use cases in which they are unsuitable: i) studies in which there is more than a single contrast (or continuous outcome) to be analysed, and ii) when the aim is to estimate the importance of a pathway at an individual sample level, rather than across experimental groups as a whole.</p>
    <p id="Par6">Single-sample PA (ssPA) refers to methods used to compute a score representing the enrichment level of each pathway for each individual sample in a study [<xref ref-type="bibr" rid="CR17">17</xref>]. Another way to conceptualise ssPA is that it can be used to transform individual molecular-level data to the pathway level (Fig. <xref rid="Fig1" ref-type="fig">1</xref>a). For example, the metabolite abundance matrix <inline-formula id="IEq1"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${X}_{n\times m}$$\end{document}</tex-math><mml:math id="M2"><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>×</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_5005_Article_IEq1.gif"/></alternatives></inline-formula>, with <italic>n</italic> rows representing samples and <italic>m</italic> columns representing metabolites, could be transformed to the matrix <inline-formula id="IEq2"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${Y}_{n\times p}$$\end{document}</tex-math><mml:math id="M4"><mml:msub><mml:mi>Y</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>×</mml:mo><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_5005_Article_IEq2.gif"/></alternatives></inline-formula> with rows representing identical samples but columns instead representing pathways (Fig. <xref rid="Fig1" ref-type="fig">1</xref>b). This metabolite to pathway-level transformation is achieved using ssPA algorithms, which utilise existing knowledge from pathway databases [<xref ref-type="bibr" rid="CR18">18</xref>–<xref ref-type="bibr" rid="CR21">21</xref>] to combine metabolite-level measurements into pathway scores. This principle of transforming a data matrix from the individual molecular measurements to the pathway space is generalisable to any type of omics data, including metabolomics. By calculating pathway scores for each sample within a dataset, the concept of ssPA overcomes the limitations of conventional PA methods, allowing for multi-group PA and enabling PA at the individual sample level.<fig id="Fig1"><label>Fig. 1</label><caption><p>Schematic representation of single sample pathway analysis. <bold>a</bold> Transformation of omics data from the metabolite space (left) to the pathway space (right). Data point colours represent sample groups. <bold>b</bold> Left represents original omics data matrix (metabolomics) <inline-formula id="IEq113"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${X}_{n\times m}$$\end{document}</tex-math><mml:math id="M6"><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>×</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_5005_Article_IEq113.gif"/></alternatives></inline-formula>, and right represents ssPA-transformed pathway level omics data matrix <inline-formula id="IEq114"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${Y}_{n\times p}$$\end{document}</tex-math><mml:math id="M8"><mml:msub><mml:mi>Y</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>×</mml:mo><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_5005_Article_IEq114.gif"/></alternatives></inline-formula>. Both matrices contain rows representing the same samples, but ssPA transforms the columns of the original matrix representing individual molecular measurements (in this example metabolites) into pathways. An ssPA algorithm is used to perform the pathway transformation, taking the input metabolomics matrix (left) alongside a set of pathways as input. Pathway logos shown correspond to KEGG, Reactome, and MetaCyc databases, which are examples of where pathway sets can be obtained</p></caption><graphic xlink:href="12859_2022_5005_Fig1_HTML" id="MO1"/></fig></p>
    <p id="Par7">Current ssPA methods can be broadly categorised into three main groups: dimensionality reduction (DR)-based [<xref ref-type="bibr" rid="CR22">22</xref>, <xref ref-type="bibr" rid="CR23">23</xref>], GSEA-based [<xref ref-type="bibr" rid="CR24">24</xref>, <xref ref-type="bibr" rid="CR25">25</xref>], and z-score-based [<xref ref-type="bibr" rid="CR26">26</xref>]. The earliest example of ssPA can be attributed to Tomfohr et al. [<xref ref-type="bibr" rid="CR22">22</xref>], who developed the PLAGE method for calculating pathway scores using singular value decomposition (SVD). ssGSEA and GSVA are two similar ssPA methods based on the Kolmogorov–Smirnov like random walk statistic proposed by Subramanian et al. [<xref ref-type="bibr" rid="CR12">12</xref>] for conventional GSEA. The z-score method developed by Lee et al. [<xref ref-type="bibr" rid="CR26">26</xref>] calculates pathway scores based on a normalised z-score across all molecules in a pathway. Full details of these methods can be found in the original articles [<xref ref-type="bibr" rid="CR22">22</xref>, <xref ref-type="bibr" rid="CR24">24</xref>–<xref ref-type="bibr" rid="CR26">26</xref>].</p>
    <p id="Par8">By generating sample-wise pathway scores, ssPA enables numerous downstream analyses to be performed that cannot be achieved using conventional PA approaches. At the most basic level, multi-group comparisons can be made using the pathway scores, for example using statistical association testing to determine pathways which differ significantly between groups [<xref ref-type="bibr" rid="CR25">25</xref>]. This can be useful in studies where there are more than two treatment groups or disease subtypes. Another prominent example of the utility of ssPA methods is that they enable application of machine learning or multivariate statistical methods to pathway level data [<xref ref-type="bibr" rid="CR27">27</xref>]. Patients can be classified based on their pathway scores, rather than metabolite-level measurements, which in some cases has been demonstrated to improve classification performance [<xref ref-type="bibr" rid="CR26">26</xref>]. Predictive models built in the pathway space have also shown to be more robust to noise than those constructed from individual molecular measurements [<xref ref-type="bibr" rid="CR28">28</xref>]. Pathway scores further enable a number of pathway-based visualisation options, such as plotting the scores of two pathways against each other to discriminate between disease subtypes [<xref ref-type="bibr" rid="CR29">29</xref>], or using them to generate hierarchical clustering heatmaps [<xref ref-type="bibr" rid="CR22">22</xref>]. An emerging use-case of ssPA is in multi-omics data integration, in which pathway scores calculated for each omics layer can be combined and analysed concurrently [<xref ref-type="bibr" rid="CR30">30</xref>].</p>
    <p id="Par9">Although most ssPA methods are applicable to most omics datatypes, this will not necessarily equate to their consistent performance across omics. Indeed, the most well-known ssPA methods have all been developed for transcriptomic data analysis. Other omics datatypes such as metabolomics differ greatly in composition and statistical properties from transcriptomic data. The most obvious difference lies in the number of metabolites versus the number of genes/transcripts profiled in metabolomics and transcriptomics respectively, which has a direct effect on pathway coverage (the proportion of entities in a given pathway that have been assayed). Another key difference is the uncertainty in metabolite identification in metabolomics which remains one of the field’s greatest challenges [<xref ref-type="bibr" rid="CR31">31</xref>], an issue that is far less prominent in transcriptomics and proteomics. There is a growing body of literature focused on benchmarking PA methods across various omics datatypes [<xref ref-type="bibr" rid="CR13">13</xref>, <xref ref-type="bibr" rid="CR15">15</xref>, <xref ref-type="bibr" rid="CR17">17</xref>, <xref ref-type="bibr" rid="CR32">32</xref>–<xref ref-type="bibr" rid="CR37">37</xref>], but to date there have been no studies investigating the efficacy of ssPA methods applied to metabolomics datasets.</p>
    <p id="Par10">The purpose of the present research, therefore, is twofold: we begin by performing a benchmark of widely used and established ssPA methods using semi-synthetic metabolomics datasets, after which we demonstrate how ssPA methods can aid in the interpretation of metabolomics data by performing an application case study using publicly available inflammatory bowel disease (IBD) data. Specifically, in the benchmarking portion of this manuscript, we compare the performance of four well-known ssPA methods, namely SVD (PLAGE) [<xref ref-type="bibr" rid="CR22">22</xref>], ssGSEA [<xref ref-type="bibr" rid="CR24">24</xref>], GSVA [<xref ref-type="bibr" rid="CR25">25</xref>], and z-score[<xref ref-type="bibr" rid="CR26">26</xref>] as well as two ssPA methods we propose, based on k-means clustering (ssClustPA) and kernel principal component analysis (kPCA). We also introduce the sspa Python package which provides user-friendly implementations of all methods benchmarked, alongside a tutorial, specifically designed for application to metabolomics data. In the second part of this manuscript we demonstrate using experimental IBD data how ssPA generates pathway scores which can be used to cluster and discriminate samples based on their IBD subtype, facilitating interpretation of the data at the pathway-level. To summarise, this is the first study to benchmark ssPA methods on metabolomics data, offering important insights into their suitability and potential applications in metabolomics research.</p>
  </sec>
  <sec id="Sec2">
    <title>Methods</title>
    <sec id="Sec3">
      <title>Datasets used</title>
      <p id="Par11">In the benchmarking section of this work, the Su et al. [<xref ref-type="bibr" rid="CR38">38</xref>] COVID19 metabolomics mass spectrometry (MS) dataset has been used, serving as a basis for semi-synthetic simulated data creation. This data is part of a multi-omics study of COVID severity, and contains patients from two groups: COVID (of varying levels of severity) (n = 130) and non-COVID (n = 133), from which blood plasma samples were obtained during the first week of infection after diagnosis.</p>
      <p id="Par12">For the application section, we used inflammatory bowel disease (IBD) MS metabolomics data from Lloyd-Price et al. [<xref ref-type="bibr" rid="CR39">39</xref>]. This data derives from a longitudinal multi-omics study of IBD, where metabolomics analysis was performed on stool samples collected over a 1-year period. We used samples obtained across all timepoints (weeks 0–52). The study contains two experimental groups: IBD (Crohn’s disease (CD, n = 265) and ulcerative colitis (UC, n = 146)) and non-IBD (n = 135).</p>
      <p id="Par13">Both datasets are publicly available (see Availability of data and materials for repository identifiers) and are derived from untargeted mass spectrometry, see Table <xref rid="Tab1" ref-type="table">1</xref> for further details. Datasets were post-processed in the same manner: missing value imputation using iterative SVD [<xref ref-type="bibr" rid="CR40">40</xref>], probabilistic quotient normalisation, <inline-formula id="IEq3"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$lo{g}_{2}$$\end{document}</tex-math><mml:math id="M10"><mml:mrow><mml:mi>l</mml:mi><mml:mi>o</mml:mi><mml:msub><mml:mi>g</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_5005_Article_IEq3.gif"/></alternatives></inline-formula> transformation, and standardisation of each variable (<inline-formula id="IEq4"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mu =0$$\end{document}</tex-math><mml:math id="M12"><mml:mrow><mml:mi>μ</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_5005_Article_IEq4.gif"/></alternatives></inline-formula> and <inline-formula id="IEq5"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sigma =1$$\end{document}</tex-math><mml:math id="M14"><mml:mrow><mml:mi>σ</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_5005_Article_IEq5.gif"/></alternatives></inline-formula>). Metabolite names were mapped to ChEBI identifiers using the MetaboAnalyst [<xref ref-type="bibr" rid="CR41">41</xref>] identifier conversion tool (<ext-link ext-link-type="uri" xlink:href="https://www.metaboanalyst.ca/MetaboAnalyst/upload/ConvertView.xhtml">https://www.metaboanalyst.ca/MetaboAnalyst/upload/ConvertView.xhtml</ext-link>).<table-wrap id="Tab1"><label>Table 1</label><caption><p>Summary of datasets used</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Dataset</th><th align="left">Samples</th><th align="left">Sample source</th><th align="left">Assay</th><th align="left">Number of metabolites mapping to ChEBI</th><th align="left">Number of Reactome pathways accessible<sup>a</sup></th></tr></thead><tbody><tr><td align="left">Su et al. [<xref ref-type="bibr" rid="CR38">38</xref>]</td><td align="left"><p>COVID19</p><p>(n = 130),</p><p>Non-COVID19</p><p>(n = 133)</p></td><td align="left">Blood plasma</td><td align="left">UHPLC/MS/MS (Metabolon)</td><td align="left">335</td><td align="left">255</td></tr><tr><td align="left">Lloyd-Price et al. [<xref ref-type="bibr" rid="CR39">39</xref>]</td><td align="left"><p>CD (n = 265),</p><p>UC (n = 146),</p><p>Non-IBD</p><p>(n = 135)</p></td><td align="left">Stool</td><td align="left">LC–MS HILIC-pos, LC–MS HILIC-neg, LC–MS C18-neg, LC–MS C8-pos</td><td align="left">329</td><td align="left">228</td></tr></tbody></table><table-wrap-foot><p><sup>a</sup>Number of Reactome pathways accessible corresponds to the number of pathways in each dataset which contained at least two metabolites assayed in the metabolomics data</p></table-wrap-foot></table-wrap></p>
    </sec>
    <sec id="Sec4">
      <title>Pathway definitions and non-redundant pathway set</title>
      <p id="Par14">Reactome pathways (release 76) were downloaded from <ext-link ext-link-type="uri" xlink:href="https://reactome.org/download-data">https://reactome.org/download-data</ext-link>. The ChEBI2Reactome_All_Levels.txt file was used and filtered for Homo sapiens pathways only. The metabolite coverage of the Reactome human pathways using the COVID dataset ranged from 2 to 39 metabolites per pathway. KEGG human pathways (release 101) were downloaded using the KEGG REST API (<ext-link ext-link-type="uri" xlink:href="https://www.kegg.jp/kegg/rest/keggapi.html">https://www.kegg.jp/kegg/rest/keggapi.html</ext-link>).</p>
      <p id="Par15">We describe a pathway by the set of metabolites annotated to it: <inline-formula id="IEq6"><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p=\{{m}_{1},{m}_{2},\dots {m}_{L}\}$$\end{document}</tex-math><mml:math id="M16"><mml:mrow><mml:mi>p</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mi>L</mml:mi></mml:msub><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_5005_Article_IEq6.gif"/></alternatives></inline-formula> for a pathway of size <italic>L.</italic> As part of the benchmarking procedure a non-redundant set of Reactome pathways <inline-formula id="IEq7"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N=\{{p}_{1},{p}_{2},...,{p}_{N}\}$$\end{document}</tex-math><mml:math id="M18"><mml:mrow><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi>N</mml:mi></mml:msub><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_5005_Article_IEq7.gif"/></alternatives></inline-formula> was created along with the associated set of all metabolites in these pathways <inline-formula id="IEq8"><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$M=\{{m}_{1},{m}_{2},...{m}_{M}\}={p}_{1}\cup {p}_{2}\cup ...\cup {p}_{N}$$\end{document}</tex-math><mml:math id="M20"><mml:mrow><mml:mi>M</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mi>M</mml:mi></mml:msub><mml:mo stretchy="false">}</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>∪</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>∪</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>∪</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi>N</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_5005_Article_IEq8.gif"/></alternatives></inline-formula>. <inline-formula id="IEq9"><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N$$\end{document}</tex-math><mml:math id="M22"><mml:mi>N</mml:mi></mml:math><inline-graphic xlink:href="12859_2022_5005_Article_IEq9.gif"/></alternatives></inline-formula> and <inline-formula id="IEq10"><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$M$$\end{document}</tex-math><mml:math id="M24"><mml:mi>M</mml:mi></mml:math><inline-graphic xlink:href="12859_2022_5005_Article_IEq10.gif"/></alternatives></inline-formula> were obtained by iterating through the list of pathways <inline-formula id="IEq11"><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$P$$\end{document}</tex-math><mml:math id="M26"><mml:mi>P</mml:mi></mml:math><inline-graphic xlink:href="12859_2022_5005_Article_IEq11.gif"/></alternatives></inline-formula> (<inline-formula id="IEq12"><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k$$\end{document}</tex-math><mml:math id="M28"><mml:mi>k</mml:mi></mml:math><inline-graphic xlink:href="12859_2022_5005_Article_IEq12.gif"/></alternatives></inline-formula>= 255 with at least 2 metabolites present profiled in the COVID dataset, in original order) and adding pathway <inline-formula id="IEq13"><alternatives><tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${p}_{i}$$\end{document}</tex-math><mml:math id="M30"><mml:msub><mml:mi>p</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_5005_Article_IEq13.gif"/></alternatives></inline-formula> to <inline-formula id="IEq14"><alternatives><tex-math id="M31">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N$$\end{document}</tex-math><mml:math id="M32"><mml:mi>N</mml:mi></mml:math><inline-graphic xlink:href="12859_2022_5005_Article_IEq14.gif"/></alternatives></inline-formula> if there was no overlap with the current non-redundant set, <inline-formula id="IEq15"><alternatives><tex-math id="M33">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$|{p}_{i}\cap M|=0$$\end{document}</tex-math><mml:math id="M34"><mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo>∩</mml:mo><mml:mi>M</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_5005_Article_IEq15.gif"/></alternatives></inline-formula>. The resulting set contained a total of 18 pathways with no overlapping metabolites, with coverage ranging from 2 to 6 metabolites per pathway. We note that other non-redundant pathway sets are possible but do not expect results to be strongly dependent on the exact set used.</p>
    </sec>
    <sec id="Sec5">
      <title>Creation of semi-synthetic metabolomics data</title>
      <p id="Par16">The simulations in this work are based on semi-synthetic datasets created using the COVID dataset. The use of a “permutation and spike" procedure allows the original signal in the dataset to be erased and replaced with known pathway signals, while preserving the underlying distributions (both joint and marginal) and heterogeneity of the experimental data. This is advantageous compared to generating fully synthetic data such as by random sampling from a Gaussian distribution, as it preserves the complex biological relationships occurring in omics data, which will influence method performance. A limitation of our approach is that the underlying distribution of a particular dataset may differ from that of other datasets. Despite this limitation, we believe this approach reflects more accurately the level of complexity found in real data compared to fully-synthetic simulation approaches.</p>
      <p id="Par17">The semi-synthetic metabolomics data generation process is illustrated schematically in Fig. <xref rid="Fig2" ref-type="fig">2</xref> and outlined as follows.<fig id="Fig2"><label>Fig. 2</label><caption><p>Schematic outlining the benchmarking process used in this work. <bold>a</bold> Sample group labels are randomly permuted. <bold>b</bold> An artificial signal is added (α) to all metabolites in M<sub>k</sub> (set of all metabolites within the k = 3 randomly selected pathways (E)) only to samples in group B. <bold>c</bold> Single-sample pathway analysis is performed on the semi-synthetic data matrix generated in step b) using the various methods benchmarked. <bold>d</bold> Independent two-sample t-tests are performed for each pathway (p) analysed using ssPA, to provide <italic>p</italic>-values for the significance of the different in pathway score means between samples in group A and group B. <bold>e</bold> Benjamini–Hochberg adjusted q-values for each pathway p are used to compute performance metrics, taking account of the level of overlap between the pathway p and M<sub>k</sub>, as well as whether p is a member of the set E (enriched pathways). Considering the q-value and overlap threshold, each pathway can be classed as a true positive, false positive, false negative, or true negative, and used to compute the performance metrics: precision, recall, and area under the curve (AUC)</p></caption><graphic xlink:href="12859_2022_5005_Fig2_HTML" id="MO2"/></fig></p>
      <p id="Par18">Let <inline-formula id="IEq16"><alternatives><tex-math id="M35">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${X}_{i,j}$$\end{document}</tex-math><mml:math id="M36"><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_5005_Article_IEq16.gif"/></alternatives></inline-formula> denote the original <inline-formula id="IEq17"><alternatives><tex-math id="M37">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$lo{g}_{2}$$\end{document}</tex-math><mml:math id="M38"><mml:mrow><mml:mi>l</mml:mi><mml:mi>o</mml:mi><mml:msub><mml:mi>g</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_5005_Article_IEq17.gif"/></alternatives></inline-formula>-transformed data matrix composed of <inline-formula id="IEq18"><alternatives><tex-math id="M39">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n$$\end{document}</tex-math><mml:math id="M40"><mml:mi>n</mml:mi></mml:math><inline-graphic xlink:href="12859_2022_5005_Article_IEq18.gif"/></alternatives></inline-formula> samples and <inline-formula id="IEq19"><alternatives><tex-math id="M41">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$m$$\end{document}</tex-math><mml:math id="M42"><mml:mi>m</mml:mi></mml:math><inline-graphic xlink:href="12859_2022_5005_Article_IEq19.gif"/></alternatives></inline-formula> metabolites. <inline-formula id="IEq20"><alternatives><tex-math id="M43">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$X$$\end{document}</tex-math><mml:math id="M44"><mml:mi>X</mml:mi></mml:math><inline-graphic xlink:href="12859_2022_5005_Article_IEq20.gif"/></alternatives></inline-formula> contains two groups of samples, <inline-formula id="IEq21"><alternatives><tex-math id="M45">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i\in A$$\end{document}</tex-math><mml:math id="M46"><mml:mrow><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:mi>A</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_5005_Article_IEq21.gif"/></alternatives></inline-formula>, representing the control group and <inline-formula id="IEq22"><alternatives><tex-math id="M47">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i\in B$$\end{document}</tex-math><mml:math id="M48"><mml:mrow><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:mi>B</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_5005_Article_IEq22.gif"/></alternatives></inline-formula>, representing the disease group. For simplicity we have simulated a two-group design, but this simulation setup can be extended to multiple groups, continuous outcomes or more complex experimental designs. To remove the original signal in the data, the class labels of each sample <inline-formula id="IEq23"><alternatives><tex-math id="M49">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$A$$\end{document}</tex-math><mml:math id="M50"><mml:mi>A</mml:mi></mml:math><inline-graphic xlink:href="12859_2022_5005_Article_IEq23.gif"/></alternatives></inline-formula> or <inline-formula id="IEq24"><alternatives><tex-math id="M51">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$B$$\end{document}</tex-math><mml:math id="M52"><mml:mi>B</mml:mi></mml:math><inline-graphic xlink:href="12859_2022_5005_Article_IEq24.gif"/></alternatives></inline-formula> were randomly shuffled at each realisation of the simulated data (Fig. <xref rid="Fig2" ref-type="fig">2</xref>a).</p>
      <p id="Par19">A pathway collection is required, consisting of <inline-formula id="IEq25"><alternatives><tex-math id="M53">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$P=\{{p}_{1},{p}_{2},...,{p}_{i}\}$$\end{document}</tex-math><mml:math id="M54"><mml:mrow><mml:mi>P</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_5005_Article_IEq25.gif"/></alternatives></inline-formula> Reactome or KEGG pathways and the associated set of all metabolites in these pathways <inline-formula id="IEq26"><alternatives><tex-math id="M55">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$M=\{{m}_{1},{m}_{2},...{m}_{M}\}={p}_{1}\cup {p}_{2}\cup ...\cup {p}_{i}$$\end{document}</tex-math><mml:math id="M56"><mml:mrow><mml:mi>M</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mi>M</mml:mi></mml:msub><mml:mo stretchy="false">}</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>∪</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>∪</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>∪</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_5005_Article_IEq26.gif"/></alternatives></inline-formula>. Following the sample class label permutation, <inline-formula id="IEq27"><alternatives><tex-math id="M57">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k=3$$\end{document}</tex-math><mml:math id="M58"><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_5005_Article_IEq27.gif"/></alternatives></inline-formula> pathways <inline-formula id="IEq28"><alternatives><tex-math id="M59">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$E=\{{p}_{1},{p}_{2},...,{p}_{k}\}$$\end{document}</tex-math><mml:math id="M60"><mml:mrow><mml:mi>E</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_5005_Article_IEq28.gif"/></alternatives></inline-formula> were chosen at random from P to be “enriched", corresponding to metabolites <inline-formula id="IEq29"><alternatives><tex-math id="M61">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${M}_{k}={p}_{1}\cup {p}_{2}\cup ...\cup {p}_{k}$$\end{document}</tex-math><mml:math id="M62"><mml:mrow><mml:msub><mml:mi>M</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>∪</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>∪</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>∪</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_5005_Article_IEq29.gif"/></alternatives></inline-formula>. The abundance values samples in group <inline-formula id="IEq30"><alternatives><tex-math id="M63">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$B$$\end{document}</tex-math><mml:math id="M64"><mml:mi>B</mml:mi></mml:math><inline-graphic xlink:href="12859_2022_5005_Article_IEq30.gif"/></alternatives></inline-formula> were altered (by adding a constant <inline-formula id="IEq31"><alternatives><tex-math id="M65">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha$$\end{document}</tex-math><mml:math id="M66"><mml:mi>α</mml:mi></mml:math><inline-graphic xlink:href="12859_2022_5005_Article_IEq31.gif"/></alternatives></inline-formula> to the original log space values) for metabolites in set <inline-formula id="IEq32"><alternatives><tex-math id="M67">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${M}_{k}$$\end{document}</tex-math><mml:math id="M68"><mml:msub><mml:mi>M</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_5005_Article_IEq32.gif"/></alternatives></inline-formula> (Fig. <xref rid="Fig2" ref-type="fig">2</xref>b). Note this represents a multiplicative (fold change) effect in the original non-log space. The values for group <inline-formula id="IEq33"><alternatives><tex-math id="M69">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$A$$\end{document}</tex-math><mml:math id="M70"><mml:mi>A</mml:mi></mml:math><inline-graphic xlink:href="12859_2022_5005_Article_IEq33.gif"/></alternatives></inline-formula> were left unchanged. The value of <inline-formula id="IEq34"><alternatives><tex-math id="M71">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha$$\end{document}</tex-math><mml:math id="M72"><mml:mi>α</mml:mi></mml:math><inline-graphic xlink:href="12859_2022_5005_Article_IEq34.gif"/></alternatives></inline-formula> represents the strength of the enrichment of the metabolites within <inline-formula id="IEq35"><alternatives><tex-math id="M73">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${p}_{i}$$\end{document}</tex-math><mml:math id="M74"><mml:msub><mml:mi>p</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_5005_Article_IEq35.gif"/></alternatives></inline-formula>. In our experiments we enriched <inline-formula id="IEq36"><alternatives><tex-math id="M75">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k=3$$\end{document}</tex-math><mml:math id="M76"><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_5005_Article_IEq36.gif"/></alternatives></inline-formula> pathways. The simulated data matrix <italic>Y</italic> can thus be expressed as:<disp-formula id="Equ1"><label>1</label><alternatives><tex-math id="M77">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Y_{i,j} = X_{i,j} ,\quad i \in A$$\end{document}</tex-math><mml:math id="M78" display="block"><mml:mrow><mml:msub><mml:mi>Y</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mspace width="1em"/><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:mi>A</mml:mi></mml:mrow></mml:math><graphic xlink:href="12859_2022_5005_Article_Equ1.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ2"><label>2</label><alternatives><tex-math id="M79">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Y_{i,j} = X_{i,j} + \alpha ,\quad i \in B$$\end{document}</tex-math><mml:math id="M80" display="block"><mml:mrow><mml:msub><mml:mi>Y</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>α</mml:mi><mml:mo>,</mml:mo><mml:mspace width="1em"/><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:mi>B</mml:mi></mml:mrow></mml:math><graphic xlink:href="12859_2022_5005_Article_Equ2.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq37"><alternatives><tex-math id="M81">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$j\in {M}_{k}$$\end{document}</tex-math><mml:math id="M82"><mml:mrow><mml:mi>j</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mi>M</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_5005_Article_IEq37.gif"/></alternatives></inline-formula> and <inline-formula id="IEq38"><alternatives><tex-math id="M83">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha \in [0,1]$$\end{document}</tex-math><mml:math id="M84"><mml:mrow><mml:mi>α</mml:mi><mml:mo>∈</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_5005_Article_IEq38.gif"/></alternatives></inline-formula>.</p>
    </sec>
    <sec id="Sec6">
      <title>ssPA implementation details</title>
      <p id="Par20">Details of the Python/R packages used for each of the methods benchmarked in this work are given in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S1. The ssPA package is available to download from the Python Package Index at <ext-link ext-link-type="uri" xlink:href="https://pypi.org/project/sspa/">https://pypi.org/project/sspa/</ext-link>, and the source code is freely available at <ext-link ext-link-type="uri" xlink:href="https://github.com/cwieder/py-ssPA">https://github.com/cwieder/py-ssPA</ext-link>.</p>
    </sec>
    <sec id="Sec7">
      <title>ssClustPA method</title>
      <p id="Par21">Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S1 shows an overview of ssClustPA and kPCA methods. The ssClustPA method is appropriate when we expect two clusters in the data (e.g. case and control). ssClustPA projects each sample onto the vector separating the two clusters, and is outlined as follows:<list list-type="order"><list-item><p id="Par22">For each of the <inline-formula id="IEq39"><alternatives><tex-math id="M85">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$P$$\end{document}</tex-math><mml:math id="M86"><mml:mi>P</mml:mi></mml:math><inline-graphic xlink:href="12859_2022_5005_Article_IEq39.gif"/></alternatives></inline-formula> pathways <inline-formula id="IEq40"><alternatives><tex-math id="M87">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${p}_{k}=\{{m}_{1},{m}_{2},...,{m}_{p}\}$$\end{document}</tex-math><mml:math id="M88"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_5005_Article_IEq40.gif"/></alternatives></inline-formula>, create a pathway matrix <inline-formula id="IEq41"><alternatives><tex-math id="M89">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${Z}_{k}$$\end{document}</tex-math><mml:math id="M90"><mml:msub><mml:mi>Z</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_5005_Article_IEq41.gif"/></alternatives></inline-formula> composed of the abundance data corresponding to the pathway, <inline-formula id="IEq42"><alternatives><tex-math id="M91">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${Z}_{ijk}={X}_{ij}$$\end{document}</tex-math><mml:math id="M92"><mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mi mathvariant="italic">ijk</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_5005_Article_IEq42.gif"/></alternatives></inline-formula> where <inline-formula id="IEq43"><alternatives><tex-math id="M93">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${m}_{j}\in {p}_{k}$$\end{document}</tex-math><mml:math id="M94"><mml:mrow><mml:msub><mml:mi>m</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_5005_Article_IEq43.gif"/></alternatives></inline-formula>. Here there are <italic>M</italic><sub><italic>k</italic></sub> metabolites in pathway <italic>k.</italic></p></list-item><list-item><p id="Par23">On each pathway matrix <inline-formula id="IEq44"><alternatives><tex-math id="M95">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${Z}_{k}$$\end{document}</tex-math><mml:math id="M96"><mml:msub><mml:mi>Z</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_5005_Article_IEq44.gif"/></alternatives></inline-formula>, perform k-means clustering based on Euclidean distance with k = 2 clusters.</p></list-item><list-item><p id="Par24">Obtain the coordinates of the cluster centroids <inline-formula id="IEq45"><alternatives><tex-math id="M97">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${c}_{1} \&amp; {c}_{2}$$\end{document}</tex-math><mml:math id="M98"><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>&amp;</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_5005_Article_IEq45.gif"/></alternatives></inline-formula> in the <italic>m</italic>-dimensional space defined by <inline-formula id="IEq46"><alternatives><tex-math id="M99">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${Z}_{k}$$\end{document}</tex-math><mml:math id="M100"><mml:msub><mml:mi>Z</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_5005_Article_IEq46.gif"/></alternatives></inline-formula>.</p></list-item><list-item><p id="Par25">For each pathway obtain the unit column vector between the two cluster centroids <inline-formula id="IEq47"><alternatives><tex-math id="M101">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$u= {c}_{1}-{c}_{2}$$\end{document}</tex-math><mml:math id="M102"><mml:mrow><mml:mi>u</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_5005_Article_IEq47.gif"/></alternatives></inline-formula>. The dimension of <inline-formula id="IEq48"><alternatives><tex-math id="M103">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$u$$\end{document}</tex-math><mml:math id="M104"><mml:mi>u</mml:mi></mml:math><inline-graphic xlink:href="12859_2022_5005_Article_IEq48.gif"/></alternatives></inline-formula> will correspond to the number of metabolites in the dataset mapping to that pathway, <italic>M</italic><sub><italic>k</italic></sub>.</p></list-item><list-item><p id="Par26">Project the pathway matrix <inline-formula id="IEq49"><alternatives><tex-math id="M105">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${Z}_{k}$$\end{document}</tex-math><mml:math id="M106"><mml:msub><mml:mi>Z</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_5005_Article_IEq49.gif"/></alternatives></inline-formula> (dimension n × M<sub>k</sub>) onto <inline-formula id="IEq50"><alternatives><tex-math id="M107">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$u$$\end{document}</tex-math><mml:math id="M108"><mml:mi>u</mml:mi></mml:math><inline-graphic xlink:href="12859_2022_5005_Article_IEq50.gif"/></alternatives></inline-formula> (dimension M<sub>k</sub> × 1). The projected values can be used as pathway scores <inline-formula id="IEq51"><alternatives><tex-math id="M109">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${A}_{k}$$\end{document}</tex-math><mml:math id="M110"><mml:msub><mml:mi>A</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_5005_Article_IEq51.gif"/></alternatives></inline-formula> (Eq. (<xref rid="Equ3" ref-type="">3</xref>)).<disp-formula id="Equ3"><label>3</label><alternatives><tex-math id="M111">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$A_{k} = Z_{k} u$$\end{document}</tex-math><mml:math id="M112" display="block"><mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>Z</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mi>u</mml:mi></mml:mrow></mml:math><graphic xlink:href="12859_2022_5005_Article_Equ3.gif" position="anchor"/></alternatives></disp-formula></p></list-item><list-item><p id="Par27">Repeat steps 4–5 for each pathway matrix <inline-formula id="IEq52"><alternatives><tex-math id="M113">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${Z}_{k}$$\end{document}</tex-math><mml:math id="M114"><mml:msub><mml:mi>Z</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_5005_Article_IEq52.gif"/></alternatives></inline-formula> and concatenate the resulting vectors <inline-formula id="IEq53"><alternatives><tex-math id="M115">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${A}_{k}$$\end{document}</tex-math><mml:math id="M116"><mml:msub><mml:mi>A</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_5005_Article_IEq53.gif"/></alternatives></inline-formula> horizontally to produce the pathway score matrix <inline-formula id="IEq54"><alternatives><tex-math id="M117">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${A}_{n\times P}$$\end{document}</tex-math><mml:math id="M118"><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>×</mml:mo><mml:mi>P</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_5005_Article_IEq54.gif"/></alternatives></inline-formula>.</p></list-item></list></p>
      <p id="Par28">The projection of each pathway matrix <inline-formula id="IEq55"><alternatives><tex-math id="M119">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${Z}_{k}$$\end{document}</tex-math><mml:math id="M120"><mml:msub><mml:mi>Z</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_5005_Article_IEq55.gif"/></alternatives></inline-formula> onto the vector <inline-formula id="IEq56"><alternatives><tex-math id="M121">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$u$$\end{document}</tex-math><mml:math id="M122"><mml:mi>u</mml:mi></mml:math><inline-graphic xlink:href="12859_2022_5005_Article_IEq56.gif"/></alternatives></inline-formula> will capture the alignment of the samples with the clustering in the pathway space with more accuracy than simply using Euclidean distances to a single cluster centroid. The latter would be unable to distinguish a sample datapoint’s proximity to the first cluster centroid relative to the second centroid. The vector <inline-formula id="IEq57"><alternatives><tex-math id="M123">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$u$$\end{document}</tex-math><mml:math id="M124"><mml:mi>u</mml:mi></mml:math><inline-graphic xlink:href="12859_2022_5005_Article_IEq57.gif"/></alternatives></inline-formula> represents the direction between the two cluster centroids, capturing the main difference between the two clusters. By projecting the pathway matrix onto <inline-formula id="IEq58"><alternatives><tex-math id="M125">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$u$$\end{document}</tex-math><mml:math id="M126"><mml:mi>u</mml:mi></mml:math><inline-graphic xlink:href="12859_2022_5005_Article_IEq58.gif"/></alternatives></inline-formula> we capture variation related to the difference between clusters, and ignore variation which is orthogonal (uncorrelated) to this difference, thus providing a score which is more relevant to the contrast studied.</p>
    </sec>
    <sec id="Sec8">
      <title>kPCA method</title>
      <p id="Par29">The kPCA method is outlined as follows:<list list-type="order"><list-item><p id="Par30">For each of the <inline-formula id="IEq59"><alternatives><tex-math id="M127">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$P$$\end{document}</tex-math><mml:math id="M128"><mml:mi>P</mml:mi></mml:math><inline-graphic xlink:href="12859_2022_5005_Article_IEq59.gif"/></alternatives></inline-formula> pathways <inline-formula id="IEq60"><alternatives><tex-math id="M129">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${p}_{k}=\{{m}_{1},{m}_{2},...,{m}_{p}\}$$\end{document}</tex-math><mml:math id="M130"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_5005_Article_IEq60.gif"/></alternatives></inline-formula>, create a pathway matrix <inline-formula id="IEq61"><alternatives><tex-math id="M131">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${Z}_{k}$$\end{document}</tex-math><mml:math id="M132"><mml:msub><mml:mi>Z</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_5005_Article_IEq61.gif"/></alternatives></inline-formula> composed of the abundance data corresponding to the pathway, <inline-formula id="IEq62"><alternatives><tex-math id="M133">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${Z}_{ijk}={X}_{ij}$$\end{document}</tex-math><mml:math id="M134"><mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mi mathvariant="italic">ijk</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_5005_Article_IEq62.gif"/></alternatives></inline-formula> where <inline-formula id="IEq63"><alternatives><tex-math id="M135">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${m}_{j}\in {p}_{k}$$\end{document}</tex-math><mml:math id="M136"><mml:mrow><mml:msub><mml:mi>m</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_5005_Article_IEq63.gif"/></alternatives></inline-formula>.</p></list-item><list-item><p id="Par31">For each pathway matrix <inline-formula id="IEq64"><alternatives><tex-math id="M137">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${Z}_{k}$$\end{document}</tex-math><mml:math id="M138"><mml:msub><mml:mi>Z</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_5005_Article_IEq64.gif"/></alternatives></inline-formula>, perform kernel PCA [<xref ref-type="bibr" rid="CR42">42</xref>] with a radial basis function (RBF) kernel. The kernel width parameter <inline-formula id="IEq65"><alternatives><tex-math id="M139">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\gamma$$\end{document}</tex-math><mml:math id="M140"><mml:mi>γ</mml:mi></mml:math><inline-graphic xlink:href="12859_2022_5005_Article_IEq65.gif"/></alternatives></inline-formula> is set to a default of <inline-formula id="IEq66"><alternatives><tex-math id="M141">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\frac{1}{n}$$\end{document}</tex-math><mml:math id="M142"><mml:mfrac><mml:mn>1</mml:mn><mml:mi>n</mml:mi></mml:mfrac></mml:math><inline-graphic xlink:href="12859_2022_5005_Article_IEq66.gif"/></alternatives></inline-formula>.</p></list-item><list-item><p id="Par32">The scores of the first principal component (PC1) can directly be used as scores <inline-formula id="IEq67"><alternatives><tex-math id="M143">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${A}_{k}$$\end{document}</tex-math><mml:math id="M144"><mml:msub><mml:mi>A</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_5005_Article_IEq67.gif"/></alternatives></inline-formula>.</p></list-item><list-item><p id="Par33">Repeat step 2 for each pathway matrix <inline-formula id="IEq68"><alternatives><tex-math id="M145">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${Z}_{k}$$\end{document}</tex-math><mml:math id="M146"><mml:msub><mml:mi>Z</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_5005_Article_IEq68.gif"/></alternatives></inline-formula> and concatenate the resulting vectors <inline-formula id="IEq69"><alternatives><tex-math id="M147">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${A}_{k}$$\end{document}</tex-math><mml:math id="M148"><mml:msub><mml:mi>A</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_5005_Article_IEq69.gif"/></alternatives></inline-formula> horizontally to produce the pathway score matrix <inline-formula id="IEq70"><alternatives><tex-math id="M149">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${A}_{n\times P}$$\end{document}</tex-math><mml:math id="M150"><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>×</mml:mo><mml:mi>P</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_5005_Article_IEq70.gif"/></alternatives></inline-formula>.</p></list-item></list></p>
    </sec>
    <sec id="Sec9">
      <title>Benchmarking details</title>
      <sec id="Sec10">
        <title>Pathway overlap</title>
        <p id="Par34">Overlap between pathway metabolites was calculated using the Szymkiewicz-Simpson Overlap Coefficient (OC) (Eq. <xref rid="Equ4" ref-type="">4</xref>). An OC of 0 indicates there is no overlap between set A and set B, whereas an overlap of 1 indicates that the smaller set is a subset of the larger set.<disp-formula id="Equ4"><label>4</label><alternatives><tex-math id="M151">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$OC\left( {A,B} \right) = \frac{{\left| {A \cap B} \right|}}{{min\left( {\left| A \right|,\left| B \right|} \right)}}$$\end{document}</tex-math><mml:math id="M152" display="block"><mml:mrow><mml:mi>O</mml:mi><mml:mi>C</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mfrac><mml:mfenced close="|" open="|"><mml:mrow><mml:mi>A</mml:mi><mml:mo>∩</mml:mo><mml:mi>B</mml:mi></mml:mrow></mml:mfenced><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mfenced close="|" open="|"><mml:mi>A</mml:mi></mml:mfenced><mml:mo>,</mml:mo><mml:mfenced close="|" open="|"><mml:mi>B</mml:mi></mml:mfenced></mml:mrow></mml:mfenced></mml:mrow></mml:mfrac></mml:mrow></mml:math><graphic xlink:href="12859_2022_5005_Article_Equ4.gif" position="anchor"/></alternatives></disp-formula></p>
        <p id="Par35">We used the OC as an alternative to the Jaccard Index (JI) as it is more sensitive to overlapping metabolites, i.e., the OC will return a value of 1 when the metabolites in a pathway are all present in a larger pathway (irrespective of the size of the larger pathway), whereas the JI will only equal 1 if two sets are identical.</p>
      </sec>
      <sec id="Sec11">
        <title>Performance metrics</title>
        <p id="Par36">As outlined in the section ‘<xref rid="Sec5" ref-type="sec">Creation of semi-synthetic metabolomics data</xref>’, in each of the simulations in this work, <inline-formula id="IEq71"><alternatives><tex-math id="M153">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k$$\end{document}</tex-math><mml:math id="M154"><mml:mi>k</mml:mi></mml:math><inline-graphic xlink:href="12859_2022_5005_Article_IEq71.gif"/></alternatives></inline-formula>=<italic>3</italic> randomly selected pathways <inline-formula id="IEq72"><alternatives><tex-math id="M155">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$E=\left\{{p}_{1},{p}_{2},{p}_{3}\right\}$$\end{document}</tex-math><mml:math id="M156"><mml:mrow><mml:mi>E</mml:mi><mml:mo>=</mml:mo><mml:mfenced close="}" open="{"><mml:msub><mml:mi>p</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_5005_Article_IEq72.gif"/></alternatives></inline-formula> were defined as enriched (Fig. <xref rid="Fig2" ref-type="fig">2</xref>b). In the effect size simulations, all metabolites <inline-formula id="IEq73"><alternatives><tex-math id="M157">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${M}_{k}$$\end{document}</tex-math><mml:math id="M158"><mml:msub><mml:mi>M</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_5005_Article_IEq73.gif"/></alternatives></inline-formula> in the set <inline-formula id="IEq74"><alternatives><tex-math id="M159">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$E$$\end{document}</tex-math><mml:math id="M160"><mml:mi>E</mml:mi></mml:math><inline-graphic xlink:href="12859_2022_5005_Article_IEq74.gif"/></alternatives></inline-formula> had a constant <inline-formula id="IEq75"><alternatives><tex-math id="M161">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha \in \left[\mathrm{0,1}\right]$$\end{document}</tex-math><mml:math id="M162"><mml:mrow><mml:mi>α</mml:mi><mml:mo>∈</mml:mo><mml:mfenced close="]" open="["><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_5005_Article_IEq75.gif"/></alternatives></inline-formula> added to the value of those metabolites in group B, representing the disease class. Adding a constant of 1 to a metabolite in the log space changes its abundance value by a fold change (FC) of 2 (<inline-formula id="IEq76"><alternatives><tex-math id="M163">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$lo{g}_{2}FC=1$$\end{document}</tex-math><mml:math id="M164"><mml:mrow><mml:mi>l</mml:mi><mml:mi>o</mml:mi><mml:msub><mml:mi>g</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mi>F</mml:mi><mml:mi>C</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_5005_Article_IEq76.gif"/></alternatives></inline-formula>). In the signal strength simulation, varying percentages <inline-formula id="IEq77"><alternatives><tex-math id="M165">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$s\in [\mathrm{0,100}]$$\end{document}</tex-math><mml:math id="M166"><mml:mrow><mml:mi>s</mml:mi><mml:mo>∈</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>100</mml:mn></mml:mrow><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_5005_Article_IEq77.gif"/></alternatives></inline-formula> of randomly selected metabolites in <inline-formula id="IEq78"><alternatives><tex-math id="M167">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$E$$\end{document}</tex-math><mml:math id="M168"><mml:mi>E</mml:mi></mml:math><inline-graphic xlink:href="12859_2022_5005_Article_IEq78.gif"/></alternatives></inline-formula> had a constant <inline-formula id="IEq79"><alternatives><tex-math id="M169">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha =1$$\end{document}</tex-math><mml:math id="M170"><mml:mrow><mml:mi>α</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_5005_Article_IEq79.gif"/></alternatives></inline-formula> added to them, again only in group B.</p>
        <p id="Par37">Pathway scoring using ssPA was performed on the simulated data abundance matrix (Fig. <xref rid="Fig2" ref-type="fig">2</xref>c), and a series of independent two-sample t-tests between simulated disease and control groups were used to determine the significance of each pathway (Fig. <xref rid="Fig2" ref-type="fig">2</xref>d). The Benjamini Hochberg false discovery rate correction was applied and pathways with q <inline-formula id="IEq80"><alternatives><tex-math id="M171">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\le$$\end{document}</tex-math><mml:math id="M172"><mml:mo>≤</mml:mo></mml:math><inline-graphic xlink:href="12859_2022_5005_Article_IEq80.gif"/></alternatives></inline-formula> 0.05 were considered significantly enriched. Of these pathways, those that were members of <inline-formula id="IEq81"><alternatives><tex-math id="M173">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$E$$\end{document}</tex-math><mml:math id="M174"><mml:mi>E</mml:mi></mml:math><inline-graphic xlink:href="12859_2022_5005_Article_IEq81.gif"/></alternatives></inline-formula> or those with an OC <inline-formula id="IEq82"><alternatives><tex-math id="M175">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\ge$$\end{document}</tex-math><mml:math id="M176"><mml:mo>≥</mml:mo></mml:math><inline-graphic xlink:href="12859_2022_5005_Article_IEq82.gif"/></alternatives></inline-formula>
<inline-formula id="IEq83"><alternatives><tex-math id="M177">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\theta$$\end{document}</tex-math><mml:math id="M178"><mml:mi>θ</mml:mi></mml:math><inline-graphic xlink:href="12859_2022_5005_Article_IEq83.gif"/></alternatives></inline-formula> between a pathway <inline-formula id="IEq84"><alternatives><tex-math id="M179">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${p}_{i}$$\end{document}</tex-math><mml:math id="M180"><mml:msub><mml:mi>p</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_5005_Article_IEq84.gif"/></alternatives></inline-formula> and the set <inline-formula id="IEq85"><alternatives><tex-math id="M181">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${M}_{k}$$\end{document}</tex-math><mml:math id="M182"><mml:msub><mml:mi>M</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_5005_Article_IEq85.gif"/></alternatives></inline-formula> (the set of all metabolites in <italic>E</italic>) were considered positives (Fig. <xref rid="Fig2" ref-type="fig">2</xref>e, Eq. <xref rid="Equ5" ref-type="">5</xref>). We use the OC to define positives, as pathways sufficiently overlapping with the artificially enriched ones can also be considered to be truly enriched. We tested two OC thresholds of <inline-formula id="IEq86"><alternatives><tex-math id="M183">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\theta \in \{0.25,0.5\}$$\end{document}</tex-math><mml:math id="M184"><mml:mrow><mml:mi>θ</mml:mi><mml:mo>∈</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:mn>0.25</mml:mn><mml:mo>,</mml:mo><mml:mn>0.5</mml:mn><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_5005_Article_IEq86.gif"/></alternatives></inline-formula>. Pathways with q <inline-formula id="IEq87"><alternatives><tex-math id="M185">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$&gt;$$\end{document}</tex-math><mml:math id="M186"><mml:mo>&gt;</mml:mo></mml:math><inline-graphic xlink:href="12859_2022_5005_Article_IEq87.gif"/></alternatives></inline-formula> 0.05 were considered true negatives if the pathway is not a member of <inline-formula id="IEq88"><alternatives><tex-math id="M187">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$E$$\end{document}</tex-math><mml:math id="M188"><mml:mi>E</mml:mi></mml:math><inline-graphic xlink:href="12859_2022_5005_Article_IEq88.gif"/></alternatives></inline-formula> and has OC <inline-formula id="IEq89"><alternatives><tex-math id="M189">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$&lt;$$\end{document}</tex-math><mml:math id="M190"><mml:mo>&lt;</mml:mo></mml:math><inline-graphic xlink:href="12859_2022_5005_Article_IEq89.gif"/></alternatives></inline-formula>
<inline-formula id="IEq90"><alternatives><tex-math id="M191">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\theta$$\end{document}</tex-math><mml:math id="M192"><mml:mi>θ</mml:mi></mml:math><inline-graphic xlink:href="12859_2022_5005_Article_IEq90.gif"/></alternatives></inline-formula> (Eq. <xref rid="Equ5" ref-type="">5</xref>). Those pathways with q <inline-formula id="IEq91"><alternatives><tex-math id="M193">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$&gt;$$\end{document}</tex-math><mml:math id="M194"><mml:mo>&gt;</mml:mo></mml:math><inline-graphic xlink:href="12859_2022_5005_Article_IEq91.gif"/></alternatives></inline-formula> 0.05 that are members of <inline-formula id="IEq92"><alternatives><tex-math id="M195">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$E$$\end{document}</tex-math><mml:math id="M196"><mml:mi>E</mml:mi></mml:math><inline-graphic xlink:href="12859_2022_5005_Article_IEq92.gif"/></alternatives></inline-formula> or have OC <inline-formula id="IEq93"><alternatives><tex-math id="M197">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\ge$$\end{document}</tex-math><mml:math id="M198"><mml:mo>≥</mml:mo></mml:math><inline-graphic xlink:href="12859_2022_5005_Article_IEq93.gif"/></alternatives></inline-formula>
<inline-formula id="IEq94"><alternatives><tex-math id="M199">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\theta$$\end{document}</tex-math><mml:math id="M200"><mml:mi>θ</mml:mi></mml:math><inline-graphic xlink:href="12859_2022_5005_Article_IEq94.gif"/></alternatives></inline-formula> are considered false negatives (Eq. <xref rid="Equ5" ref-type="">5</xref>).<disp-formula id="Equ5"><label>5</label><alternatives><tex-math id="M201">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{array}{*{20}l} {{\text{For}}\,{\text{a}}\,{\text{given}}\,{\text{pathway}}\,p:} \hfill \\ {p\,{\text{is}}\,{\text{a}}\,{\text{true}}\,{\text{positive}}\,({\text{TP}})\,\,{\text{if}} [p\, \in \,E\,{\text{or}}\,{\text{OC}}(M_{k} , \, p) \ge \theta ],\,{\text{and}}\,q \le 0.05} \hfill \\ {p\,{\text{is}}\,{\text{a}}\,{\text{true}}\,{\text{negative}}\,({\text{TN}})\,\,{\text{if}} [p\, \notin \,E\,{\text{and}}\,{\text{OC}}(M_{k} , \, p) &lt; \theta ],\,{\text{and}}\,q &gt; 0.05} \hfill \\ {p\,{\text{is}}\,{\text{a}}\,{\text{false}}\,{\text{positive}}\,({\text{FP}})\,\,{\text{if}} [p\, \notin \,E\,{\text{and}}\,{\text{OC}}(M_{k} , \, p) &lt; \theta ],\,{\text{and}}\,q \le 0.05} \hfill \\ {p\,{\text{is}}\,{\text{a}}\,{\text{false}}\,{\text{negative}}\,({\text{FN}})\,\,{\text{if}} [p\, \in \,E\,{\text{o}}r\,{\text{OC}}(M_{k} , \, p) \ge \theta ],\,{\text{and}}\,q &gt; 0.05} \hfill \\ \end{array}$$\end{document}</tex-math><mml:math id="M202" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mtext>For</mml:mtext><mml:mspace width="0.166667em"/><mml:mtext>a</mml:mtext><mml:mspace width="0.166667em"/><mml:mtext>given</mml:mtext><mml:mspace width="0.166667em"/><mml:mtext>pathway</mml:mtext><mml:mspace width="0.166667em"/><mml:mi>p</mml:mi><mml:mo>:</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mrow><mml:mi>p</mml:mi><mml:mspace width="0.166667em"/><mml:mtext>is</mml:mtext><mml:mspace width="0.166667em"/><mml:mtext>a</mml:mtext><mml:mspace width="0.166667em"/><mml:mtext>true</mml:mtext><mml:mspace width="0.166667em"/><mml:mtext>positive</mml:mtext><mml:mspace width="0.166667em"/><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext>TP</mml:mtext><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mspace width="0.166667em"/><mml:mspace width="0.166667em"/><mml:mtext>if</mml:mtext><mml:mo stretchy="false">[</mml:mo><mml:mi>p</mml:mi><mml:mspace width="0.166667em"/><mml:mo>∈</mml:mo><mml:mspace width="0.166667em"/><mml:mi>E</mml:mi><mml:mspace width="0.166667em"/><mml:mtext>or</mml:mtext><mml:mspace width="0.166667em"/><mml:mtext>OC</mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>M</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.166667em"/><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>≥</mml:mo><mml:mi>θ</mml:mi><mml:mo stretchy="false">]</mml:mo><mml:mo>,</mml:mo><mml:mspace width="0.166667em"/><mml:mtext>and</mml:mtext><mml:mspace width="0.166667em"/><mml:mi>q</mml:mi><mml:mo>≤</mml:mo><mml:mn>0.05</mml:mn></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mrow><mml:mi>p</mml:mi><mml:mspace width="0.166667em"/><mml:mtext>is</mml:mtext><mml:mspace width="0.166667em"/><mml:mtext>a</mml:mtext><mml:mspace width="0.166667em"/><mml:mtext>true</mml:mtext><mml:mspace width="0.166667em"/><mml:mtext>negative</mml:mtext><mml:mspace width="0.166667em"/><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext>TN</mml:mtext><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mspace width="0.166667em"/><mml:mspace width="0.166667em"/><mml:mtext>if</mml:mtext><mml:mo stretchy="false">[</mml:mo><mml:mi>p</mml:mi><mml:mspace width="0.166667em"/><mml:mo>∉</mml:mo><mml:mspace width="0.166667em"/><mml:mi>E</mml:mi><mml:mspace width="0.166667em"/><mml:mtext>and</mml:mtext><mml:mspace width="0.166667em"/><mml:mtext>OC</mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>M</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.166667em"/><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>&lt;</mml:mo><mml:mi>θ</mml:mi><mml:mo stretchy="false">]</mml:mo><mml:mo>,</mml:mo><mml:mspace width="0.166667em"/><mml:mtext>and</mml:mtext><mml:mspace width="0.166667em"/><mml:mi>q</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>0.05</mml:mn></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mrow><mml:mi>p</mml:mi><mml:mspace width="0.166667em"/><mml:mtext>is</mml:mtext><mml:mspace width="0.166667em"/><mml:mtext>a</mml:mtext><mml:mspace width="0.166667em"/><mml:mtext>false</mml:mtext><mml:mspace width="0.166667em"/><mml:mtext>positive</mml:mtext><mml:mspace width="0.166667em"/><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext>FP</mml:mtext><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mspace width="0.166667em"/><mml:mspace width="0.166667em"/><mml:mtext>if</mml:mtext><mml:mo stretchy="false">[</mml:mo><mml:mi>p</mml:mi><mml:mspace width="0.166667em"/><mml:mo>∉</mml:mo><mml:mspace width="0.166667em"/><mml:mi>E</mml:mi><mml:mspace width="0.166667em"/><mml:mtext>and</mml:mtext><mml:mspace width="0.166667em"/><mml:mtext>OC</mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>M</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.166667em"/><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>&lt;</mml:mo><mml:mi>θ</mml:mi><mml:mo stretchy="false">]</mml:mo><mml:mo>,</mml:mo><mml:mspace width="0.166667em"/><mml:mtext>and</mml:mtext><mml:mspace width="0.166667em"/><mml:mi>q</mml:mi><mml:mo>≤</mml:mo><mml:mn>0.05</mml:mn></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mrow><mml:mi>p</mml:mi><mml:mspace width="0.166667em"/><mml:mtext>is</mml:mtext><mml:mspace width="0.166667em"/><mml:mtext>a</mml:mtext><mml:mspace width="0.166667em"/><mml:mtext>false</mml:mtext><mml:mspace width="0.166667em"/><mml:mtext>negative</mml:mtext><mml:mspace width="0.166667em"/><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext>FN</mml:mtext><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mspace width="0.166667em"/><mml:mspace width="0.166667em"/><mml:mtext>if</mml:mtext><mml:mo stretchy="false">[</mml:mo><mml:mi>p</mml:mi><mml:mspace width="0.166667em"/><mml:mo>∈</mml:mo><mml:mspace width="0.166667em"/><mml:mi>E</mml:mi><mml:mspace width="0.166667em"/><mml:mtext>o</mml:mtext><mml:mi>r</mml:mi><mml:mspace width="0.166667em"/><mml:mtext>OC</mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>M</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.166667em"/><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>≥</mml:mo><mml:mi>θ</mml:mi><mml:mo stretchy="false">]</mml:mo><mml:mo>,</mml:mo><mml:mspace width="0.166667em"/><mml:mtext>and</mml:mtext><mml:mspace width="0.166667em"/><mml:mi>q</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>0.05</mml:mn></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2022_5005_Article_Equ5.gif" position="anchor"/></alternatives></disp-formula></p>
        <p id="Par38">The sklearn.metrics functions were used to calculate recall, precision, and area under the receiver-operating curve (AUC). All simulations were repeated 200 times, with randomly selected enriched pathways and semi-synthetic data randomly permuted at each realisation.</p>
      </sec>
      <sec id="Sec12">
        <title>Method runtime profiling</title>
        <p id="Par39">Runtime profiling was repeated 10 times for each method and average results are reported. The Python libraries cProfiler and line-profiler were used to determine the wall time of each method.</p>
      </sec>
    </sec>
    <sec id="Sec13">
      <title>IBD application</title>
      <p id="Par40">The kPCA method was used to demonstrate ssPA applied to the IBD metabolomics dataset.</p>
      <sec id="Sec14">
        <title>Hierarchical clustering</title>
        <p id="Par41">kPCA pathway scores were standardised prior to clustering (<inline-formula id="IEq95"><alternatives><tex-math id="M203">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mu =0$$\end{document}</tex-math><mml:math id="M204"><mml:mrow><mml:mi>μ</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_5005_Article_IEq95.gif"/></alternatives></inline-formula> and <inline-formula id="IEq96"><alternatives><tex-math id="M205">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sigma =1$$\end{document}</tex-math><mml:math id="M206"><mml:mrow><mml:mi>σ</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_5005_Article_IEq96.gif"/></alternatives></inline-formula>). Hierarchical clustering was performed using the scipy cluster.hierarchy function with Euclidean distance and Ward linkage parameters. The maxclust parameter was set to 2 in order to cut the tree at a depth of 2 branches. The adjusted Rand index [<xref ref-type="bibr" rid="CR43">43</xref>]was calculated using the metrics.adjusted_rand_score function, with the original and predicted cluster sample labels as input.</p>
      </sec>
      <sec id="Sec15">
        <title>Pathway score correlation network</title>
        <p id="Par42">kPCA pathway scores derived from the IBD dataset were ranked by t-test <italic>p</italic>-values (testing for differences between IBD and non-IBD groups) and the top 50 pathways were used to produce a hierarchical clustering as detailed above. Pathway IDs from the resulting clusters were extracted and used to build the network. A Spearman rank correlation matrix was produced from the pathway scores. The NetworkX Python package was used to create a pathway-pathway network, with nodes representing pathways and edges representing correlation between the pathway scores. Cytoscape was used to visualise the network using an edge-weighted spring embedded layout.</p>
        <p id="Par43">The COVID pathway correlation network was created in the same way as the IBD network, using the top 30 pathways (ranked by t-test <italic>p</italic>-values) for visual clarity. Each node is coloured by the average pathway score of samples in each COVID WHO severity level (0, 1–2, 3–4, 5–7).</p>
      </sec>
    </sec>
  </sec>
  <sec id="Sec16">
    <title>Results</title>
    <sec id="Sec17">
      <title>Performance evaluation of ssPA methods</title>
      <p id="Par44">We first carried out a comprehensive benchmarking of ssPA methods applied to semi-synthetic metabolomics datasets generated based on the Su et al. COVID dataset [<xref ref-type="bibr" rid="CR38">38</xref>], see Methods. The Reactome pathway database was used as the main source of pathways throughout this work, with key simulations reproduced using the KEGG database. Where applicable, we also compared ssPA results to those obtainable using conventional PA methods ORA and GSEA.</p>
      <sec id="Sec18">
        <title>Outline of simulation procedure</title>
        <p id="Par45">In order to calculate various performance metrics (i.e. precision and recall), it is essential to know the identity of truly perturbed “enriched" pathways. Here we use the terms “positively enriched" or “negatively enriched" to refer to pathways that are significantly perturbed with respect to the control group, depending on the directionality of the effect. In experimental datasets it remains challenging to distinguish between true and false positive enriched pathways, so instead we used semi-synthetic data to accomplish this task. As detailed in the methods, we removed the original signal from an experimental untargeted metabolomics dataset of COVID patients and replaced it with artificial known pathway signals (enriched pathways) in one of two study groups. Using this simulation procedure, we can vary the strength of the enrichment of a pathway, the number of differentially abundant metabolites in the pathway, and the coverage level.</p>
      </sec>
      <sec id="Sec19">
        <title>ssClustPA and kPCA: pathway scoring approaches based on unsupervised learning</title>
        <p id="Par46">We propose two novel ssPA methods based on unsupervised machine learning concepts for generating pathway scores (see Methods for further details). ssClustPA makes use of k-means clustering and for each pathway projects the original datapoints onto the unit vector between two cluster centroids to yield pathway scores. ssClustPA is best suited to two-group study designs due to the two-cluster centroid constraint; for designs with two or more study groups, we developed the kPCA ssPA method. The kPCA ssPA method uses kernel PCA [<xref ref-type="bibr" rid="CR42">42</xref>] with a radial basis function kernel to model the distribution of data for the pathway and is particularly advantageous when the underlying manifold of the data is non-linear. The first principal component scores are used as pathway scores. Both methods are applicable to any omics datatype.</p>
      </sec>
      <sec id="Sec20">
        <title>The importance of pathway overlap in method evaluation</title>
        <p id="Par47">Biological pathways represented as lists of molecules can be seen as an arbitrary way of partitioning a network and defining precise pathway boundaries remains a challenge in pathway curation. It is therefore expected that all pathway databases will contain some degree of redundancy, meaning that not all molecules will be unique to a single pathway. If a pathway <inline-formula id="IEq97"><alternatives><tex-math id="M207">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p$$\end{document}</tex-math><mml:math id="M208"><mml:mi>p</mml:mi></mml:math><inline-graphic xlink:href="12859_2022_5005_Article_IEq97.gif"/></alternatives></inline-formula> is significantly enriched, it is likely that other pathways that contain overlapping molecules with <inline-formula id="IEq98"><alternatives><tex-math id="M209">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p$$\end{document}</tex-math><mml:math id="M210"><mml:mi>p</mml:mi></mml:math><inline-graphic xlink:href="12859_2022_5005_Article_IEq98.gif"/></alternatives></inline-formula> will also be considered enriched to varying degrees. When performing benchmarking on redundant pathway sets, one must therefore decide the level of pathway overlap that constitutes a true positive pathway.</p>
        <p id="Par48">A simple example of the effect of pathway overlap is demonstrated in Fig. <xref rid="Fig2" ref-type="fig">2</xref>. Here we performed a simulation in which a single randomly selected pathway “R-HSA-1483206" (Glycerophospholipid biosynthesis) was enriched at effect size <inline-formula id="IEq99"><alternatives><tex-math id="M211">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha =1$$\end{document}</tex-math><mml:math id="M212"><mml:mrow><mml:mi>α</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_5005_Article_IEq99.gif"/></alternatives></inline-formula>. Using the pathway scores derived from each ssPA method, a series of independent two-sided t-tests were performed for each of the 255 Reactome pathways, testing for significant differences in mean pathway scores between the two study groups. The resulting pathway <italic>p</italic>-values are compared to the overlap coefficient (OC) of each pathway with pathway R-HSA-1483206 in Fig. <xref rid="Fig3" ref-type="fig">3</xref>. We observe that regardless of the ssPA method, there is a clear correlation between pathway overlap and <italic>p</italic>-value, with pathways with higher overlap tending to have lower <italic>p</italic>-values. Importantly, if an arbitrary <italic>p</italic>-value threshold e.g. <italic>p</italic>
<inline-formula id="IEq100"><alternatives><tex-math id="M213">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\le$$\end{document}</tex-math><mml:math id="M214"><mml:mo>≤</mml:mo></mml:math><inline-graphic xlink:href="12859_2022_5005_Article_IEq100.gif"/></alternatives></inline-formula> 0.05 was used to select significant pathways in this manner, R-HSA-1483206 and a number of additional pathways would be considered enriched. It is important to note this effect is not only observed with ssPA methods, but also in conventional methods such as GSEA (Fig. <xref rid="Fig3" ref-type="fig">3</xref>).<fig id="Fig3"><label>Fig. 3</label><caption><p>The relationship between pathway overlap and significance. The artificially enriched pathway (R-HSA-1483206) is represented by a red cross. Overlap coefficient values of each pathway with R-HSA-1483206 are shown on the x-axis. t-test <italic>p</italic>-values of pathway scores (testing for significant difference in mean pathway score between disease and control group) for each pathway are shown on the y-axis (-log10 scale). Note, for GSEA the <italic>p</italic>-values are calculated using the original GSEA permutation procedure, and for ORA, <italic>p</italic>-values are calculated using the Fisher’s exact test. A LOWESS regression line is shown in black. Point size corresponds to the coverage of each pathway (i.e. the number of metabolites in the pathway which were present in the dataset)</p></caption><graphic xlink:href="12859_2022_5005_Fig3_HTML" id="MO3"/></fig></p>
        <p id="Par49">Due to this overlap effect, and to simplify the procedure, we first performed benchmarking on a small subset of non-redundant pathways from the Reactome pathway database (<inline-formula id="IEq101"><alternatives><tex-math id="M215">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k$$\end{document}</tex-math><mml:math id="M216"><mml:mi>k</mml:mi></mml:math><inline-graphic xlink:href="12859_2022_5005_Article_IEq101.gif"/></alternatives></inline-formula>=18). The key motivation for using this non-redundant pathway set was to introduce readers to our benchmarking strategy prior to taking into account the effect of pathway overlap. Furthermore, the utility of non-redundant pathway sets has been previously demonstrated [<xref ref-type="bibr" rid="CR44">44</xref>, <xref ref-type="bibr" rid="CR45">45</xref>] and the results of benchmarking on such sets may be of interest in themselves to some readers. We then repeated the performance evaluation on the full set of redundant Reactome pathways (<inline-formula id="IEq102"><alternatives><tex-math id="M217">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k$$\end{document}</tex-math><mml:math id="M218"><mml:mi>k</mml:mi></mml:math><inline-graphic xlink:href="12859_2022_5005_Article_IEq102.gif"/></alternatives></inline-formula>=255 with sufficient coverage in the COVID dataset), which although containing overlapping pathways, is a more realistic and complex scenario. To summarise, we make use of the level of overlap between the enriched pathways and the rest of the pathways to define the set of true positive enriched pathways (see Methods for formal definition), which aims to take into account the arbitrary separation of the metabolic network into pathway sets.</p>
      </sec>
      <sec id="Sec21">
        <title>Performance evaluation of ssPA methods</title>
        <p id="Par50">In this section we evaluated the performance of the SVD (PLAGE), ssGSEA, GSVA, z-score, ssClustPA, and kPCA methods using semi-synthetic data. These are categorised as GSEA-based (ssGSEA and GSVA) and dimensionality reduction (DR)/clustering-based (SVD, ssClustPA, and kPCA). We also included comparison to non-ssPA methods ORA and GSEA where possible.</p>
        <p id="Par51">Beginning with the non-redundant pathway set, in which each of the pathways contains unique metabolites, three random pathways were artificially enriched, and performance metrics were computed and averaged over 200 iterations (Fig. <xref rid="Fig4" ref-type="fig">4</xref>) across a range of increasing effect sizes. The GSEA-based methods GSVA and ssGSEA appear to outperform the other methods in terms of recall and AUC at low to moderate effect sizes (0.2–0.6). At higher effect sizes of 0.8–1 (corresponding to <inline-formula id="IEq103"><alternatives><tex-math id="M219">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$FC\approx$$\end{document}</tex-math><mml:math id="M220"><mml:mrow><mml:mi>F</mml:mi><mml:mi>C</mml:mi><mml:mo>≈</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_5005_Article_IEq103.gif"/></alternatives></inline-formula> 2), all methods appear to perform equally well with average recall, precision and AUC values &gt; 0.9.<fig id="Fig4"><label>Fig. 4</label><caption><p>Performance of ssPA methods using a non-redundant pathway set based on 3 randomly selected enriched pathways. For each panel Recall, Precision, and AUC, the x-axis represents the effect size of the simulated pathway enrichment. Points represent the mean performance metric over 200 iterations. Note for AUC, y-axis values range from 0.5 to 1. Shaded intervals indicate the standard error of the mean. Dotted lines represent conventional pathway analysis methods, and dashed lines represent clustering/dimensionality-reduction based methods</p></caption><graphic xlink:href="12859_2022_5005_Fig4_HTML" id="MO4"/></fig></p>
        <p id="Par52">We then used the full set of 255 Reactome pathways (containing redundancy) with the same simulation setup to evaluate performance (Fig. <xref rid="Fig5" ref-type="fig">5</xref>). Again, three random pathways are artificially enriched. As mentioned previously, when calculating performance metrics using overlapping pathways, one must define a threshold for true positive pathways. In this case, we pooled all metabolites from the simulated enriched pathways together and calculated an OC between this set and each pathway tested. Figure <xref rid="Fig5" ref-type="fig">5</xref>a shows the performance metrics where a positive corresponds to OC <inline-formula id="IEq104"><alternatives><tex-math id="M221">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\uptheta \ge$$\end{document}</tex-math><mml:math id="M222"><mml:mrow><mml:mi mathvariant="normal">θ</mml:mi><mml:mo>≥</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_5005_Article_IEq104.gif"/></alternatives></inline-formula> 0.25, whereas Fig. <xref rid="Fig5" ref-type="fig">5</xref>b shows the performance metrics where a positive corresponds to OC <inline-formula id="IEq105"><alternatives><tex-math id="M223">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\uptheta \ge$$\end{document}</tex-math><mml:math id="M224"><mml:mrow><mml:mi mathvariant="normal">θ</mml:mi><mml:mo>≥</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_5005_Article_IEq105.gif"/></alternatives></inline-formula> 0.5. For all effect sizes in Fig, 5, we computed pairwise Mann–Whitney U tests across methods (Bonferroni corrected) to determine the statistical significance of the differences in performance metrics (Additional file <xref rid="MOESM2" ref-type="media">2</xref>). In both Figs. <xref rid="Fig5" ref-type="fig">5</xref>a and 5b, the GSEA-based methods (ssGSEA and GSVA) and z-score have the highest recall across all effect sizes (<italic>p</italic> &lt; 0.05). In terms of precision, regardless of the overlap threshold, conventional pathway analysis methods ORA and GSEA outperform ssPA methods at moderate-high effect sizes (0.6–1.0) (<italic>p</italic> &lt; 0.05). Following this, DR/clustering-based methods (kPCA, ssClustPA, and SVD respectively) provide the highest precision values amongst the ssPA methods, with GSEA-based methods ssGSEA and GSVA as well as the z-score yielding the lowest precision values (<italic>p</italic> &lt; 0.05 at effect sizes 0.8–1 for OC θ &gt; 0.25, <italic>p</italic> &lt; 0.05 at effect sizes 0.4–1 for OC θ &gt; 0.5). Similar observations can be made in terms of AUC at an overlap threshold of ≥ 0.5 (Fig. <xref rid="Fig5" ref-type="fig">5</xref>b). The GSEA-based methods and z-score yield the highest AUC at lower effect sizes (0.2–0.4), but at higher effect sizes (0.8–1), ORA and GSEA outperform all ssPA methods, followed by the clustering/DR-based methods, and finally GSEA/z-score-based methods which have the lowest AUC values (<italic>p</italic> &lt; 0.05). At an overlap threshold ≥ 0.25 (Fig. <xref rid="Fig5" ref-type="fig">5</xref>a), these trends are more subtle in terms of AUC, but as effect sizes become larger there is a shift in performance from GSEA-based/z-score methods to clustering/DR-based methods.<fig id="Fig5"><label>Fig. 5</label><caption><p>Performance of ssPA methods on the full pathway set (including redundancy) based on 3 randomly enriched pathways. <bold>a</bold> Top panel OC <inline-formula id="IEq115"><alternatives><tex-math id="M225">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\ge$$\end{document}</tex-math><mml:math id="M226"><mml:mo>≥</mml:mo></mml:math><inline-graphic xlink:href="12859_2022_5005_Article_IEq115.gif"/></alternatives></inline-formula> 0.25, <bold>b</bold> bottom panel OC <inline-formula id="IEq116"><alternatives><tex-math id="M227">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\ge$$\end{document}</tex-math><mml:math id="M228"><mml:mo>≥</mml:mo></mml:math><inline-graphic xlink:href="12859_2022_5005_Article_IEq116.gif"/></alternatives></inline-formula> 0.5. All metabolites in enriched pathways have identical effect size. Points show performance metrics averaged across 200 iterations. Shaded intervals represent average SEM. Dotted lines represent conventional pathway analysis methods, and dashed lines represent clustering/dimensionality-reduction based methods</p></caption><graphic xlink:href="12859_2022_5005_Fig5_HTML" id="MO5"/></fig></p>
        <p id="Par53">GSEA-based methods, as well as the z-score, are the poorest performers in terms of precision. The drop in precision from effect size 0.2 onwards is likely due to an increase in the number of false positives resulting from the stronger effect size which do not reach the overlap threshold to be considered true positives. There is a larger probability that overlapping pathways are detected as significantly enriched. This drop in precision is less evident when the OC for identifying true positive pathways is lower, such as in Fig. <xref rid="Fig5" ref-type="fig">5</xref>a, as a higher proportion of the overlapping pathways are considered true positives, resulting in fewer false positives. Compared to conventional PA methods, ssPA methods generally have improved recall, particularly at larger effect sizes. However, conventional methods tend to have a higher precision than ssPA methods, regardless of effect size. At higher effect sizes, ORA generally appears to have higher power to detect significant pathways than GSEA. Additionally, we reproduced very similar results using a different semi-synthetic dataset based on IBD data from Lloyd-Price et al. [<xref ref-type="bibr" rid="CR39">39</xref>] (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S2). The sole difference was that kPCA had higher precision than all other methods at the higher OC threshold, regardless of effect size.</p>
        <p id="Par54">Finally, we ran the same set of simulations using the KEGG human pathway database rather than the Reactome database (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S3). Despite there being subtle changes in the performance metric results, which are to be expected due to varying pathway composition and size, the ranking of the methods across metrics remained consistent with that observed in the Reactome simulations.</p>
      </sec>
      <sec id="Sec22">
        <title>The effect of pathway signal strength on ssPA performance</title>
        <p id="Par55">In the previous simulations, we varied the effect size of the pathway enrichment, with the abundance of all metabolites in the pathway modified to the same extent. In a real-world scenario, it is highly unlikely that all metabolites in a differentially active pathway would have the same effect size. We therefore performed another simulation in which the abundance of varying proportions of randomly selected metabolites in a pathway was modified while keeping the effect size at a constant of 1.0. In this scenario, we consider pathways with q ≤ 0.05 and OC <inline-formula id="IEq106"><alternatives><tex-math id="M229">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\ge$$\end{document}</tex-math><mml:math id="M230"><mml:mo>≥</mml:mo></mml:math><inline-graphic xlink:href="12859_2022_5005_Article_IEq106.gif"/></alternatives></inline-formula> 0.5 true positives and randomly enriched 3 pathways in each iteration.</p>
        <p id="Par56">As expected the performance of all methods improves as the signal strength increases (Fig. <xref rid="Fig6" ref-type="fig">6</xref>), aside from a small drop in precision which is caused by the increase in signal strength rendering overlapping pathways more significant, as highlighted in the previous simulation (Fig. <xref rid="Fig5" ref-type="fig">5</xref>). In terms of recall, all ssPA methods perform very similarly across signal strength sizes, and clearly outperform the conventional PA methods ORA and GSEA. In contrast, the conventional methods slightly outperform the rest of the ssPA methods in terms of precision, of which the dimensionality-reduction based methods (SVD, ssClustPA, and kPCA) have higher precision than GSEA/z-score-based methods. Overall, when taking into account varying levels of signal strength, and that not all molecules in an enriched pathway are likely to be significantly differentially abundant, clustering/DR-based methods appear to offer the best overall performance in terms of ssPA, particularly at moderate to high effect sizes (FC ≈ ≥ 1.5).<fig id="Fig6"><label>Fig. 6</label><caption><p>Effect of varying signal strength on ssPA method performance. Points show mean performance over 200 iterations with 3 randomly enriched pathways on the full Reactome pathway set (true positive pathways are those with an OC <inline-formula id="IEq117"><alternatives><tex-math id="M231">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\ge$$\end{document}</tex-math><mml:math id="M232"><mml:mo>≥</mml:mo></mml:math><inline-graphic xlink:href="12859_2022_5005_Article_IEq117.gif"/></alternatives></inline-formula> 0.5). Shaded intervals represent average SEM. Dotted lines represent conventional pathway analysis methods, and dashed lines represent clustering/dimensionality-reduction based methods</p></caption><graphic xlink:href="12859_2022_5005_Fig6_HTML" id="MO6"/></fig></p>
      </sec>
      <sec id="Sec23">
        <title>ssPA method ability to rank enriched pathways highly</title>
        <p id="Par57">The ability of the ssPA methods to rank enriched pathways highly was investigated, again using the semi-synthetic COVID data. Briefly, t-tests were performed on the ssPA scores for each pathway (testing for a difference between mean scores in disease and control groups) and the resulting <italic>p</italic>-values were used to rank them in ascending order. The full set of 255 Reactome pathways was used. In order to account for the fact that ORA generally tests fewer pathways than the other methods (as it only calculates <italic>p</italic>-values for pathways with at least one differentially abundant metabolite), the ranks were normalised by the total number of pathways tested using each method.</p>
        <p id="Par58">In concordance with the performance metrics calculated in the previous section, at lower effect sizes, the GSEA/z-score-based methods rank the truly enriched pathways the highest (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S4). At higher effect sizes (0.8–1.0), there is very little difference in the rankings of the enriched pathways by all ssPA methods, with all methods being able to rank the 3 enriched pathways within the top 10% of pathways.</p>
      </sec>
      <sec id="Sec24">
        <title>The effect of pathway coverage on method performance</title>
        <p id="Par59">It is well established that metabolomics assays generally profile a smaller fraction of the total metabolome than the fraction of the genome/transcriptome captured by sequencing technologies. We compared the level of Reactome human pathway coverage in metabolomics and transcriptomics datasets from the same study [<xref ref-type="bibr" rid="CR39">39</xref>] (Fig. <xref rid="Fig7" ref-type="fig">7</xref>), and as expected there were far fewer metabolites mapping to pathways than transcripts. This well-known issue motivated us to examine how the ssPA methods performed in response to varying levels of pathway coverage. Two Reactome human pathways were selected as exemplars (‘SLC-mediated transmembrane transport’ and ‘Biological oxidations’), for their high coverage in the original COVID dataset (39 and 26 metabolites respectively) and different metabolite composition (OC = 0.27). For each pathway we randomly selected varying proportions of metabolites in each pathway to remove from the data. Doing so, we simulate reduced coverage in these pathways, from 100% relative coverage (all of the original metabolites present) to 20% relative coverage (80% original metabolites deleted).<fig id="Fig7"><label>Fig. 7</label><caption><p>Comparison of Reactome human pathway coverage in metabolomics versus transcriptomics data from the same study (IBD data, Lloyd-Price et al. [<xref ref-type="bibr" rid="CR39">39</xref>]). Violin plots show log<sub>10</sub> transformed distributions of the number of metabolites/genes mapping to each Reactome pathway</p></caption><graphic xlink:href="12859_2022_5005_Fig7_HTML" id="MO7"/></fig></p>
        <p id="Par60">We calculated performance metrics as in the previous simulations, keeping the minimum overlap coefficient threshold to declare true positive pathways fixed at OC = 0.5, and demonstrating two effect size scenarios (low effect at α = 0.25 and moderate effect at α = 0.75). For both pathways (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figs S5 and S6), we observed similar rankings in PA methods across all three performance metrics as in the effect size simulations (Fig. <xref rid="Fig5" ref-type="fig">5</xref>). As expected, both recall and precision gradually increased as relative coverage of the pathway increased. While AUC appears to decline with increased coverage (particularly at the higher effect size), which may seem counterintuitive, this can be attributed to an increase in the false positive rate. As coverage increases, more pathways share an overlap with the simulated enriched pathway and therefore attain significant <italic>p</italic>-values, but do not have a high enough OC to be considered true positives, hence resulting in a rise in false positives and a decreased AUC. Importantly, we found that higher coverage generally improves method performance, but does not have profound effects on the rankings of method performance, which recapitulate those observed in the previous simulations investigating effect size and signal strength.</p>
      </sec>
      <sec id="Sec25">
        <title>Method runtimes</title>
        <p id="Par61">Each ssPA method was run 10 times on a laptop with standard hardware and 16 GB of RAM using the COVID dataset, which contained 263 samples (rows) and 335 metabolites (columns), as well as Reactome pathways with sufficient coverage in the dataset (<inline-formula id="IEq107"><alternatives><tex-math id="M233">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k$$\end{document}</tex-math><mml:math id="M234"><mml:mi>k</mml:mi></mml:math><inline-graphic xlink:href="12859_2022_5005_Article_IEq107.gif"/></alternatives></inline-formula>=255). In terms of runtime, the fastest method was the z-score, followed by SVD (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S2).</p>
      </sec>
    </sec>
    <sec id="Sec26">
      <title>Application of ssPA in metabolomics: a case-study of inflammatory bowel disease</title>
      <p id="Par62">We then focused on the application and interpretation of ssPA in typical metabolomics data, using real experimental datasets. In order to simplify our presentation, we demonstrated the use of a single method, kPCA, to showcase one of our newly proposed methods, although the following application is generalisable to any ssPA method.</p>
      <p id="Par63">In order to demonstrate some of the potential use cases of ssPA methods applied to metabolomics data, we selected a different dataset to that used in the benchmarking portion of this work and made use of ssPA to help detect and interpret complex biological patterns within the data. The untargeted metabolomics data used in this case study was derived from a multi-omics study of inflammatory bowel disease (IBD) by Lloyd-Price et al. [<xref ref-type="bibr" rid="CR39">39</xref>]. It is important to note that the group termed “non-IBD" are not necessarily healthy individuals and may still exhibit symptoms of IBD. Further details of this dataset can be found in the Methods and the original article [<xref ref-type="bibr" rid="CR39">39</xref>].</p>
      <p id="Par64">To obtain an exploratory perspective on the strength of the biological signals in the dataset, PCA was used to visualise the data at both the metabolite and pathway level. We transformed the metabolite-level data to pathway scores using the kPCA method described earlier and compared the PCA results obtained. No strong separation between the sample classes was observed using either approach, with most samples appearing amalgamated together in a central cluster (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S7). This is consistent with findings from the original work, in which intra-individual variation in the IBD metabolome was greater than inter-individual variation [<xref ref-type="bibr" rid="CR39">39</xref>]. However, the percentage variance explained in the first two principal components of the data was higher using pathway scores than individual metabolites (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S7).</p>
      <p id="Par65">In order to more rigorously quantify the clustering performance achieved using metabolites (only those present in pathways) vs. pathway scores, we ranked each of the metabolites/pathways using BH-FDR corrected t-test q-values (testing for differences between the IBD and non-IBD groups) and performed clustering after progressively adding each entity significant at q <inline-formula id="IEq108"><alternatives><tex-math id="M235">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\le$$\end{document}</tex-math><mml:math id="M236"><mml:mo>≤</mml:mo></mml:math><inline-graphic xlink:href="12859_2022_5005_Article_IEq108.gif"/></alternatives></inline-formula> 0.05 (Fig. <xref rid="Fig8" ref-type="fig">8</xref>). Hierarchical clustering was used to partition the samples into groups based on the two main branches of the tree, which were compared to the original sample labels (IBD or non-IBD) using the Adjusted Rand Index (ARI) [<xref ref-type="bibr" rid="CR43">43</xref>]. Note that negative ARI values can be obtained if the RI is less than expected by chance. This heuristic method suggested that for this particular dataset, using pathway scores for clustering generally achieves higher ARI across a range of different cut-off thresholds, as well as improved robustness to the threshold used for clustering, than by using metabolites alone. Consequently, we made use of the clustering applied to the top 50 sets of pathway scores to identify clusters of pathways that could discriminate between the IBD sample classes. Two distinct pathway clusters were evident (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S8), which we visualised using Cytoscape in Fig. <xref rid="Fig9" ref-type="fig">9</xref>.<fig id="Fig8"><label>Fig. 8</label><caption><p>Clustering performance at the metabolite and pathway levels (kPCA method) for different selection thresholds. Clustering performance is quantified using the Adjusted Rand Index (y-axis). The number of entities used to perform the clustering are shown on the x-axis, and only entities significant at q <inline-formula id="IEq118"><alternatives><tex-math id="M237">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\le$$\end{document}</tex-math><mml:math id="M238"><mml:mo>≤</mml:mo></mml:math><inline-graphic xlink:href="12859_2022_5005_Article_IEq118.gif"/></alternatives></inline-formula> 0.05 were included in the analysis. A total of 69 metabolites and 116 pathways were significant and are shown in the violin plots. Entities were ranked by q-value and only those within each selection threshold are used for each comparison. Violin plots show the distribution of ARI values achieved using the cumulative thresholds (e.g. the top 10 pathways). Solid lines represent the median ARI, whereas dashed lines represent the upper and lower quartiles. The violin plot range is truncated to the range of the data</p></caption><graphic xlink:href="12859_2022_5005_Fig8_HTML" id="MO8"/></fig><fig id="Fig9"><label>Fig. 9</label><caption><p>Pathway cluster network derived using hierarchical clustering on IBD pathway scores (kPCA, top 50 pathways). Coloured bands in each node represent mean pathway score within each subtype (from top to bottom: non-IBD, CD, UC). Edge weight represents Spearman correlation between pathway scores. Only edges with Spearman’s rank correlation coefficient (<inline-formula id="IEq119"><alternatives><tex-math id="M239">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\uprho$$\end{document}</tex-math><mml:math id="M240"><mml:mi mathvariant="normal">ρ</mml:mi></mml:math><inline-graphic xlink:href="12859_2022_5005_Article_IEq119.gif"/></alternatives></inline-formula>) <inline-formula id="IEq120"><alternatives><tex-math id="M241">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\ge$$\end{document}</tex-math><mml:math id="M242"><mml:mo>≥</mml:mo></mml:math><inline-graphic xlink:href="12859_2022_5005_Article_IEq120.gif"/></alternatives></inline-formula> 0.4 are displayed. Shaded sub-clusters depict pathways consistent with current IBD literature and are discussed in the text. Shading of subclusters corresponds to Reactome pathway parent category</p></caption><graphic xlink:href="12859_2022_5005_Fig9_HTML" id="MO9"/></fig></p>
      <p id="Par66">The networks shown in Fig. <xref rid="Fig9" ref-type="fig">9</xref> represent two distinct groups of pathways that discriminate between IBD and non-IBD samples. An edge-weighted spring-embedded layout was applied to the network to visually group nodes by pathway score Spearman correlation. The network nodes are coloured by the average pathway score across the samples in each subtype (from top to bottom: non-IBD, CD, UC). Using the kPCA approach (or clustering/DR-based approaches in general), it is not possible to make a direct link between the sign of the pathway scores obtained and the direction of the pathway enrichment. However, GSEA-based ssPA approaches can be used to determine this, if desired. GSVA was used to determine that cluster 1 of Fig. <xref rid="Fig9" ref-type="fig">9</xref> represents pathways whose metabolites are upregulated in IBD relative to the non-IBD group, whereas cluster 2 represents pathways with metabolites depleted in IBD relative to the non-IBD group.</p>
      <p id="Par67">IBD encompasses a group of diseases broadly characterised by chronic inflammation of the gut, and is widely attributed to a complex interplay of immune dysregulation, dysbiosis of the gut microbiome, and genetic and environmental factors. A sub-cluster of immune-related pathways can be seen in cluster 1 (Fig. <xref rid="Fig9" ref-type="fig">9</xref>a), highlighting the role of phospholipids and Fc-gamma receptors in phagocytosis, which is concordant with findings in current literature [<xref ref-type="bibr" rid="CR46">46</xref>, <xref ref-type="bibr" rid="CR47">47</xref>]. Changes in phospholipid metabolism are strongly implicated in IBD pathology, particularly in degradation of the intestinal epithelial mucus layer [<xref ref-type="bibr" rid="CR47">47</xref>]. Another pathway associated with maintaining the integrity of the gut mucosal barrier highlighted in this cluster is ‘Metabolism of polyamines’ (Fig. <xref rid="Fig9" ref-type="fig">9</xref>b), which corroborates the work of Weiss et al. [<xref ref-type="bibr" rid="CR48">48</xref>], who found increased levels of the polyamine spermidine alongside decreased levels of spermine in IBD patients. One major benefit of ssPA is that it enables comparison of pathway scores across multiple study groups. Using the ‘Metabolism of polyamines’ pathway as an example, we note that enrichment of the pathway is greater in CD patients than it is in UC patients, relative to non-IBD patients. A large sub-cluster of differentially active pathways relates to bile acid and salt metabolism (Fig. <xref rid="Fig9" ref-type="fig">9</xref>c), consistent with alterations in primary (e.g. cholate) and secondary bile acid metabolism in IBD observed by Lloyd-Price et al. [<xref ref-type="bibr" rid="CR39">39</xref>], likely attributable to changes in gut microbial composition, as microbes directly modulate bile acids [<xref ref-type="bibr" rid="CR49">49</xref>]. Other notable pathways enriched in cluster 1 (particularly in CD patients) include ‘Glycosphingolipid metabolism’ and ‘ABC transporters in lipid homeostasis’ (Fig. <xref rid="Fig9" ref-type="fig">9</xref>d), which are congruous with the known dysregulation of lipid metabolism in IBD coupled with inflammation [<xref ref-type="bibr" rid="CR50">50</xref>–<xref ref-type="bibr" rid="CR52">52</xref>].</p>
      <p id="Par68">In the second cluster, which consists of pathways whose metabolites are depleted in IBD, a prominent sub-cluster containing pathways related to platelet homeostasis, VEGF, and nitric oxide (NO) signalling is visible (Fig. <xref rid="Fig9" ref-type="fig">9</xref>e). It is widely recognised that platelet abnormalities are associated with IBD, alongside complications such as microvascular thrombosis and thromboembolism [<xref ref-type="bibr" rid="CR53">53</xref>]. The reduction in NO signalling is consistent with findings of reduced NO-mediated vasodilation found in IBD patients [<xref ref-type="bibr" rid="CR54">54</xref>], which could further contribute to thrombosis. This cluster of pathways focused on VEGF signalling is one example that was not detected as significantly enriched using ORA, but was detected amongst the top pathways using ssPA (see Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S3 for ORA results).</p>
      <p id="Par69">Another large sub-cluster within cluster 2 focuses on DNA repair processes, including base-excision repair (Fig. <xref rid="Fig9" ref-type="fig">9</xref>f). This subcluster can be linked to another significant pathway, ‘ROS and RNS production in phagocytes’ (Fig. <xref rid="Fig9" ref-type="fig">9</xref>g), as reactive oxygen species (ROS) contribute to DNA damage, which in turn induce DNA repair mechanisms [<xref ref-type="bibr" rid="CR55">55</xref>, <xref ref-type="bibr" rid="CR56">56</xref>]. The negative enrichment of these pathways may allude to potential defects or reduction in DNA repair processes in IBD.</p>
      <p id="Par70">We also trained a random forest (RF) classifier on the IBD dataset, which based on fivefold repeated stratified cross-validation achieved comparable AUC using kPCA scores (<inline-formula id="IEq109"><alternatives><tex-math id="M243">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mu =0.861$$\end{document}</tex-math><mml:math id="M244"><mml:mrow><mml:mi>μ</mml:mi><mml:mo>=</mml:mo><mml:mn>0.861</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_5005_Article_IEq109.gif"/></alternatives></inline-formula>, <inline-formula id="IEq110"><alternatives><tex-math id="M245">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sigma =0.042$$\end{document}</tex-math><mml:math id="M246"><mml:mrow><mml:mi>σ</mml:mi><mml:mo>=</mml:mo><mml:mn>0.042</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_5005_Article_IEq110.gif"/></alternatives></inline-formula>) as did the classifier trained on the pathway-annotated metabolites (<inline-formula id="IEq111"><alternatives><tex-math id="M247">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mu =0.865$$\end{document}</tex-math><mml:math id="M248"><mml:mrow><mml:mi>μ</mml:mi><mml:mo>=</mml:mo><mml:mn>0.865</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_5005_Article_IEq111.gif"/></alternatives></inline-formula>, <inline-formula id="IEq112"><alternatives><tex-math id="M249">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sigma =0.040$$\end{document}</tex-math><mml:math id="M250"><mml:mrow><mml:mi>σ</mml:mi><mml:mo>=</mml:mo><mml:mn>0.040</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_5005_Article_IEq112.gif"/></alternatives></inline-formula>). Pathway importances were calculated by permuting each of the features individually, and ranked by the mean decrease in AUC. Many of the top 50 pathways ranked by the RF classifier are shared with those in the networks in Fig. <xref rid="Fig9" ref-type="fig">9</xref> (see Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S4).</p>
      <p id="Par71">Using the same approach, a pathway-based correlation network was created using the COVID dataset (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S9). The use of ssPA shows a clear correlation between the WHO status of the samples, corresponding to COVID severity, and the enrichment level of the top 30 pathways shown in the network. Both case studies highlight the value of ssPA methods in quantifying pathway enrichment at an individual sample level, enabling direct comparison of multiple sample sub-groups, as well as in the case of the IBD network, identifying a cluster of enriched pathways related to VEGF/NO signalling that were not identified by the conventional method ORA. Taken together, these case studies demonstrate a small subset of the downstream analyses possible using pathway scores, but highlight the benefits in interpretability and predictive robustness they can achieve.</p>
    </sec>
  </sec>
  <sec id="Sec27">
    <title>Discussion</title>
    <p id="Par72">Single-sample PA methods have continued to gain popularity in recent literature as a way to examine pathway signatures at an individual sample level [<xref ref-type="bibr" rid="CR29">29</xref>, <xref ref-type="bibr" rid="CR30">30</xref>, <xref ref-type="bibr" rid="CR57">57</xref>, <xref ref-type="bibr" rid="CR58">58</xref>]. Unlike conventional PA approaches, which usually compare two groups of samples, ssPA approaches enable researchers to dissect the heterogeneity of complex diseases or response to treatments at an individual level, facilitating advances in precision medicine. Within the transcriptomics field, continuous advances to ssPA methodologies are being proposed, alongside demonstrated applications on gene-expression data [<xref ref-type="bibr" rid="CR29">29</xref>, <xref ref-type="bibr" rid="CR57">57</xref>–<xref ref-type="bibr" rid="CR59">59</xref>]. Despite the importance of metabolic pathways in disease and drug-response, there exists very little literature surveying the applicability of ssPA approaches to metabolomics data [<xref ref-type="bibr" rid="CR60">60</xref>]. The present study was designed to address this gap by providing a critical evaluation of the most widely used ssPA methods and their performance, robustness, and applicability to metabolomics data.</p>
    <p id="Par73">Using semi-synthetic metabolomics data, our benchmarking procedure evaluated several properties of ssPA methods: recall, precision, AUC, and the ability to rank enriched pathways highly. By varying simulation parameters such as effect size and signal strength, we were able to ascertain how the methods performed under these more realistic scenarios. Applied to transcriptomics data, GSVA is often a top performer, particularly in gene-set recall [<xref ref-type="bibr" rid="CR25">25</xref>, <xref ref-type="bibr" rid="CR29">29</xref>]. This finding is consistent with our results, where GSVA was found to have higher recall than all other ssPA methods across lower effect sizes, and at higher effect sizes had similar recall to ssGSEA. GSEA-based methods may provide more power at lower effect sizes as they calculate scores as a function of the metabolites inside and outside of the pathway, testing a competitive null hypothesis, whereas all other methods benchmarked (besides z-score) calculate scores based only on the metabolites within a pathway itself. When effect sizes become larger however, the recall of GSVA was found to be very similar to that of ssGSEA and z-score. In contrast, when identifying correctly the enriched pathways (precision), GSVA was one of the lowest performing methods, as opposed to clustering and DR-based methods ssClustPA, kPCA and SVD. In general, it can be inferred that GSEA/z-score-based methods offer higher recall (most evident at lower effect sizes), whereas clustering/DR-based methods offer improvements in precision, particularly at higher effect sizes, for metabolomics data. In general, we suggest the use of clustering/DR-based methods for datasets with moderate-high effect sizes, and GSVA for datasets with lower effect sizes.</p>
    <p id="Par74">We offer two novel methods for ssPA: ssClustPA and kPCA, which can theoretically be applied to any omics datatype. Leveraging fundamental machine learning concepts of clustering and kernels respectively, both ssClustPA and kPCA have been designed to make use of these unsupervised approaches to discriminate between samples at the pathway level. ssClustPA is particularly advantageous when there is clear structure to the underlying data, exploiting this to provide more precise pathway scores. The RBF kernel used in the kPCA method allows complex non-linear structure within the data to be modelled and projected into a subspace where datapoints become more linearly separable, and hence more likely to provide precise pathway scores, which would otherwise not be feasible using linear separation methods such as PCA or SVD. Applied to metabolomics data, these methods have been shown to offer advances in precision compared to established ssPA methods. Using metabolomics data from IBD samples [<xref ref-type="bibr" rid="CR39">39</xref>] we employed kPCA to generate pathway scores, and created an IBD subtype-specific pathway network using this data.</p>
    <p id="Par75">Although the objective of this work was not to ascertain whether metabolite or pathway level data yields better performance in downstream analyses, a key question we were able to partially address was whether pathway-level data exhibits greater predictive robustness than its metabolite-level counterpart [<xref ref-type="bibr" rid="CR28">28</xref>]. Using the IBD dataset, improved clustering performance was observed when using kPCA pathway scores as opposed to individual metabolites. Not only was the maximum ARI achievable higher using the pathway scores, but the range of ARI scores obtained using a variety of different thresholds used to select which entities to include in the clustering was consistently higher using pathway scores than metabolites. This observation supports the hypothesis that in some cases pathway scores can provide improved robustness to noise, one example of which is the number of pathways used as features in downstream analyses.</p>
    <p id="Par76">We have undertaken the first benchmark into ssPA methods for metabolomics data. The insights gained from this study may provide guidance to practitioners in the field for selecting an appropriate ssPA method, as well as highlighting the broad range of applications for downstream analyses using pathway scores. The semi-synthetic simulation approach we have outlined is not only applicable to metabolomics data, but can be generalised to evaluate a multitude of PA methods across various omics datatypes. Although we used the Reactome and KEGG pathway databases within this work, our approach is easily extensible to other databases e.g. WikiPathways [<xref ref-type="bibr" rid="CR61">61</xref>]or MetaCyc [<xref ref-type="bibr" rid="CR21">21</xref>] and we do not expect our results to be highly dependent on the pathway database used. Furthermore, it is common knowledge that the results of metabolomics analysis vary greatly in response to the sample source, assay(s) used, etc. Pathway coverage as well as assay chemical bias remain amongst the key challenges in metabolomics, though advancements in metabolic profiling technologies will undoubtedly ameliorate these in the coming years. Although it was out of the scope of the current work to test ssPA methods on all possible assay types and sample matrices, we found the performance rankings of all methods tested remained robust regardless of the sample source (plasma vs. stool), as well as to changes in pathway coverage.</p>
    <p id="Par77">We aimed to include a range of ssPA methods in our benchmark that are well established in the literature, suitable for use on metabolomics data, while also having programmatic implementations available, however we acknowledge there are additional important ssPA algorithms that have not been included but are highly relevant to the present work [<xref ref-type="bibr" rid="CR23">23</xref>, <xref ref-type="bibr" rid="CR29">29</xref>, <xref ref-type="bibr" rid="CR62">62</xref>–<xref ref-type="bibr" rid="CR64">64</xref>]. Pathifier [<xref ref-type="bibr" rid="CR23">23</xref>] is one such approach that uses nonlinear principal curve modelling applied to gene expression data to calculate pathway scores by computing the distance from the centroid of control samples to case samples along the curve. The kPCA ssPA approach we developed uses a similar nonlinear dimensionality-reduction based approach, but requires fewer computational resources (wall time and memory) than principal curve modelling. iPath [<xref ref-type="bibr" rid="CR63">63</xref>] is similar to Pathifier in that it is developed for ssPA analysis of transcriptomic case–control cancer datasets, but instead computes z-scores based on a ‘transcriptomic homeostasis’ expression profile derived from normal samples which is then used to rank samples as input to an ssGSEA-like algorithm to generate ssPA scores. SLEA [<xref ref-type="bibr" rid="CR62">62</xref>] also uses z-scores to produce ssPA scores, comparing the mean expression profile of samples within a pathway to that of a null distribution derived from randomised pathway definitions. Furthermore, a class of methods we have not included in this work are topology-based ssPA methods [<xref ref-type="bibr" rid="CR13">13</xref>]. Further work is required to determine how such methods compare to non-topology-based alternatives, and whether the inclusion of topological information improves performance notwithstanding the low coverage of pathways observed in metabolomics data. Overall, ssPA methods show a great deal of promise both for analysing and interpreting metabolomics data, in addition to the prospect of integrating metabolomics with other omics datatypes.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Information</title>
    <sec id="Sec28">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="12859_2022_5005_MOESM1_ESM.docx">
            <caption>
              <p><bold>Additional file 1: Table S1.</bold> Method implementation details.<bold> Fig. S1.</bold> Overview of novel methods ssClustPA and kPCA for a single pathway example using simulated data based on the COVID dataset.<bold> Fig. S2.</bold> Performance of ssPA methods using the full pathway set (including redundancy) based on 3 randomly enriched pathways, derived using semi-synthetic data based on the IBD dataset.<bold> Fig. S3.</bold> Performance of ssPA methods using the full KEGG human pathway set (including redundancy) based on 3 randomly enriched pathways, derived using semi-synthetic data based on the COVID dataset.<bold> Fig. S4.</bold> ssPA method ability to rank highly the 3 randomly enriched pathways using the full set of Reactome pathways.<bold> Fig. S5.</bold> ssPA method performance in response to varying levels of pathway coverage.<bold> Fig. S6.</bold> ssPA method performance in response to varying levels of pathway coverage.<bold> Fig. S7.</bold> PCA scatter plots and density plots of PC1 scores obtained using the IBD data at the metabolite (upper panels) and pathway level using kPCA (lower panels).<bold> Fig. S8.</bold> Clustered heatmap of IBD data transformed to pathway scores using the kPCA method.<bold> Fig. S9.</bold> Pathway clusters derived using hierarchical clustering on COVID dataset transformed to pathway scores using kPCA (top 30 pathways).<bold> Table S2.</bold> Runtimes of ssPA methods, alongside GSEA* for comparison to conventional PA methods (average across 10 iterations).<bold> Table S3.</bold> Over-representation analysis results from IBD dataset.<bold> Table S4.</bold> Top 50 features in random forest model based on IBD data.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM2">
          <media xlink:href="12859_2022_5005_MOESM2_ESM.xlsx">
            <caption>
              <p><bold>Additional file 2.</bold> Excel spreadsheet containing results of statistical testing of benchmarking results. Mann Whitney U tests were performed for each pairwise combination of methods tested in the effect size simulation (corresponds to Fig. <xref rid="Fig5" ref-type="fig">5</xref> in the main text). <italic>P</italic>-values were adjusted using Bonferroni FWER correction.</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher's Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <ack>
    <title>Acknowledgements</title>
    <p>The authors gratefully acknowledge Fabien Jourdan, Nathalie Poupin, Clément Frainay, and Juliette Cooke for insightful and stimulating discussions regarding this work and for critical reading of the manuscript. We also thank Nathalie Poupin for extensive testing of the sspa Python package.</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Author contributions</title>
    <p>CW, RPJL, and TE designed the study. CW performed the data analysis and developed the sspa Python package. RPJL and TE supervised the project. CW produced the initial manuscript draft. All authors edited and approved the manuscript.</p>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>This research was funded in whole, or in part, by the Wellcome Trust [222837/Z/21/Z]. For the purpose of open access, the author has applied a CC BY public copyright licence to any Author Accepted Manuscript version arising from this submission. CW is supported by a Wellcome Trust PhD Studentship [222837/Z/21/Z]. TE gratefully acknowledges partial support from UKRI BBSRC grants BB/T007974/1 and BB/W002345/1, NIH grant 1 R01 HL133932-01. RPJL is funded by the MRC (MR/R008922/1). The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Data availability</title>
    <p>The COVID19 dataset from [<xref ref-type="bibr" rid="CR38">38</xref>] is available to download from <ext-link ext-link-type="uri" xlink:href="https://data.mendeley.com/datasets/tzydswhhb5/5">https://data.mendeley.com/datasets/tzydswhhb5/5</ext-link> (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S1). The IBD dataset from [<xref ref-type="bibr" rid="CR39">39</xref>] is available to download from <ext-link ext-link-type="uri" xlink:href="https://www.hmpdacc.org/ihmp">https://www.hmpdacc.org/ihmp</ext-link> or at MetabolomicsWorkbench (PR000639).</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Code availability</title>
    <p>Python scripts used to produce the results of this work are publicly available at <ext-link ext-link-type="uri" xlink:href="https://github.com/cwieder/sspa-in-metabolomics">https://github.com/cwieder/sspa-in-metabolomics</ext-link>. The sspa Python package is available to download from <ext-link ext-link-type="uri" xlink:href="https://pypi.org/project/sspa/">https://pypi.org/project/sspa/</ext-link> and the source code as well as documentation is available at <ext-link ext-link-type="uri" xlink:href="https://github.com/cwieder/py-ssPA">https://github.com/cwieder/py-ssPA</ext-link>.</p>
  </notes>
  <notes>
    <title>Declarations</title>
    <notes id="FPar1">
      <title>Ethics approval and consent to participate</title>
      <p id="Par78">Not applicable.</p>
    </notes>
    <notes id="FPar2">
      <title>Consent for publication</title>
      <p id="Par79">Not applicable.</p>
    </notes>
    <notes id="FPar3" notes-type="COI-statement">
      <title>Competing interests</title>
      <p id="Par80">The authors declare that they have no competing interests.</p>
    </notes>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Salem</surname>
            <given-names>MA</given-names>
          </name>
          <name>
            <surname>de Souza</surname>
            <given-names>LP</given-names>
          </name>
          <name>
            <surname>Serag</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Fernie</surname>
            <given-names>AR</given-names>
          </name>
          <name>
            <surname>Farag</surname>
            <given-names>MA</given-names>
          </name>
          <name>
            <surname>Ezzat</surname>
            <given-names>SM</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Metabolomics in the context of plant natural products research: from sample preparation to metabolite analysis</article-title>
        <source>Metabolites</source>
        <year>2020</year>
        <pub-id pub-id-type="doi">10.3390/METABO10010037</pub-id>
        <?supplied-pmid 31952212?>
        <pub-id pub-id-type="pmid">31952212</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Odom</surname>
            <given-names>JD</given-names>
          </name>
          <name>
            <surname>Sutton</surname>
            <given-names>VR</given-names>
          </name>
        </person-group>
        <article-title>Metabolomics in clinical practice: improving diagnosis and informing management</article-title>
        <source>Clin Chem</source>
        <year>2021</year>
        <volume>67</volume>
        <fpage>1606</fpage>
        <lpage>1617</lpage>
        <pub-id pub-id-type="doi">10.1093/CLINCHEM/HVAB184</pub-id>
        <?supplied-pmid 34633032?>
        <pub-id pub-id-type="pmid">34633032</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Reinke</surname>
            <given-names>SN</given-names>
          </name>
          <name>
            <surname>Chaleckis</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Wheelock</surname>
            <given-names>CE</given-names>
          </name>
        </person-group>
        <article-title>Metabolomics in pulmonary medicine: extracting the most from your data</article-title>
        <source>Eur Respir J</source>
        <year>2022</year>
        <volume>60</volume>
        <fpage>2200102</fpage>
        <pub-id pub-id-type="doi">10.1183/13993003.00102-2022</pub-id>
        <?supplied-pmid 35618271?>
        <pub-id pub-id-type="pmid">35618271</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Johnson</surname>
            <given-names>CH</given-names>
          </name>
          <name>
            <surname>Ivanisevic</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Siuzdak</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>Metabolomics: beyond biomarkers and towards mechanisms</article-title>
        <source>Nat Rev Mol Cell Biol</source>
        <year>2016</year>
        <volume>17</volume>
        <fpage>451</fpage>
        <lpage>459</lpage>
        <pub-id pub-id-type="doi">10.1038/nrm.2016.25</pub-id>
        <?supplied-pmid 26979502?>
        <pub-id pub-id-type="pmid">26979502</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Blaise</surname>
            <given-names>BJ</given-names>
          </name>
          <name>
            <surname>Correia</surname>
            <given-names>GDS</given-names>
          </name>
          <name>
            <surname>Haggart</surname>
            <given-names>GA</given-names>
          </name>
          <name>
            <surname>Surowiec</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Sands</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Lewis</surname>
            <given-names>MR</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Statistical analysis in metabolic phenotyping</article-title>
        <source>Nat Protoc</source>
        <year>2021</year>
        <volume>2021</volume>
        <fpage>1</fpage>
        <lpage>28</lpage>
        <pub-id pub-id-type="doi">10.1038/s41596-021-00579-1</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nguyen</surname>
            <given-names>TM</given-names>
          </name>
          <name>
            <surname>Shafi</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Nguyen</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Draghici</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Identifying significantly impacted pathways: a comprehensive review and assessment</article-title>
        <source>Genome Biol</source>
        <year>2019</year>
        <pub-id pub-id-type="doi">10.1186/s13059-019-1790-4</pub-id>
        <?supplied-pmid 31856883?>
        <pub-id pub-id-type="pmid">31856883</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>la Ferlita</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Alaimo</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Ferro</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Pulvirenti</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Pathway analysis for cancer research and precision oncology applications</article-title>
        <source>Adv Exp Med Biol</source>
        <year>2022</year>
        <volume>1361</volume>
        <fpage>143</fpage>
        <lpage>161</lpage>
        <pub-id pub-id-type="doi">10.1007/978-3-030-91836-1_8/TABLES/6</pub-id>
        <?supplied-pmid 35230687?>
        <pub-id pub-id-type="pmid">35230687</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>García-Campos</surname>
            <given-names>MA</given-names>
          </name>
          <name>
            <surname>Espinal-Enríquez</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Hernández-Lemus</surname>
            <given-names>E</given-names>
          </name>
        </person-group>
        <article-title>Pathway analysis: state of the art</article-title>
        <source>Front Physiol</source>
        <year>2015</year>
        <pub-id pub-id-type="doi">10.3389/fphys.2015.00383</pub-id>
        <?supplied-pmid 26733877?>
        <pub-id pub-id-type="pmid">26733877</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Khatri</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Sirota</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Butte</surname>
            <given-names>AJ</given-names>
          </name>
        </person-group>
        <article-title>Ten years of pathway analysis: Current approaches and outstanding challenges. Ouzounis CA, editor</article-title>
        <source>PLoS Comput Biol</source>
        <year>2012</year>
        <pub-id pub-id-type="doi">10.1371/journal.pcbi.1002375</pub-id>
        <?supplied-pmid 22383865?>
        <pub-id pub-id-type="pmid">22383865</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Labena</surname>
            <given-names>AA</given-names>
          </name>
          <name>
            <surname>Gao</surname>
            <given-names>YZ</given-names>
          </name>
          <name>
            <surname>Dong</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Hua</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Guo</surname>
            <given-names>FB</given-names>
          </name>
        </person-group>
        <article-title>Metabolic pathway databases and model repositories</article-title>
        <source>Quant Biol</source>
        <year>2018</year>
        <pub-id pub-id-type="doi">10.1007/s40484-017-0108-3</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tavazoie</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Hughes</surname>
            <given-names>JD</given-names>
          </name>
          <name>
            <surname>Campbell</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>Cho</surname>
            <given-names>RJ</given-names>
          </name>
          <name>
            <surname>Church</surname>
            <given-names>GM</given-names>
          </name>
        </person-group>
        <article-title>Systematic determination of genetic network architecture</article-title>
        <source>Nat Genet</source>
        <year>1999</year>
        <volume>22</volume>
        <fpage>281</fpage>
        <lpage>285</lpage>
        <pub-id pub-id-type="doi">10.1038/10343</pub-id>
        <?supplied-pmid 10391217?>
        <pub-id pub-id-type="pmid">10391217</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Subramanian</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Tamayo</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Mootha</surname>
            <given-names>VK</given-names>
          </name>
          <name>
            <surname>Mukherjee</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Ebert</surname>
            <given-names>BL</given-names>
          </name>
          <name>
            <surname>Gillette</surname>
            <given-names>MA</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Gene set enrichment analysis: a knowledge-based approach for interpreting genome-wide expression profiles</article-title>
        <source>Proc Natl Acad Sci U S A</source>
        <year>2005</year>
        <volume>102</volume>
        <fpage>15545</fpage>
        <lpage>15550</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.0506580102</pub-id>
        <?supplied-pmid 16199517?>
        <pub-id pub-id-type="pmid">16199517</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ihnatova</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Popovici</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Budinska</surname>
            <given-names>E</given-names>
          </name>
        </person-group>
        <article-title>A critical comparison of topology-based pathway analysis methods</article-title>
        <source>PLoS ONE</source>
        <year>2018</year>
        <volume>13</volume>
        <fpage>e0191154</fpage>
        <pub-id pub-id-type="doi">10.1371/JOURNAL.PONE.0191154</pub-id>
        <?supplied-pmid 29370226?>
        <pub-id pub-id-type="pmid">29370226</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Marco-Ramell</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Palau-Rodriguez</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Alay</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Tulipani</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Urpi-Sarda</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Sanchez-Pla</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Evaluation and comparison of bioinformatic tools for the enrichment analysis of metabolomics data</article-title>
        <source>BMC Bioinform</source>
        <year>2018</year>
        <volume>19</volume>
        <fpage>1</fpage>
        <pub-id pub-id-type="doi">10.1186/s12859-017-2006-0</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wieder</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Frainay</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Poupin</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Rodríguez-Mier</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Vinson</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Cooke</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Pathway analysis in metabolomics: recommendations for the use of over-representation analysis. Patil KR, editor</article-title>
        <source>PLoS Comput Biol</source>
        <year>2021</year>
        <volume>17</volume>
        <fpage>e1009105</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pcbi.1009105</pub-id>
        <?supplied-pmid 34492007?>
        <pub-id pub-id-type="pmid">34492007</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Karnovsky</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <person-group person-group-type="editor">
          <name>
            <surname>Li</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Pathway analysis for targeted and untargeted metabolomics</article-title>
        <source>Methods in molecular biology</source>
        <year>2020</year>
        <publisher-loc>New York, NY</publisher-loc>
        <publisher-name>Humana Press Inc.</publisher-name>
        <fpage>387</fpage>
        <lpage>400</lpage>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhang</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Ma</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Huang</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Jiang</surname>
            <given-names>Q</given-names>
          </name>
          <name>
            <surname>Zhou</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Benchmarking algorithms for pathway activity transformation of single-cell RNA-seq data</article-title>
        <source>Comput Struct Biotechnol J</source>
        <year>2020</year>
        <volume>18</volume>
        <fpage>2953</fpage>
        <lpage>2961</lpage>
        <pub-id pub-id-type="doi">10.1016/j.csbj.2020.10.007</pub-id>
        <?supplied-pmid 33209207?>
        <pub-id pub-id-type="pmid">33209207</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kanehisa</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Furumichi</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Tanabe</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Sato</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Morishima</surname>
            <given-names>K</given-names>
          </name>
        </person-group>
        <article-title>KEGG: new perspectives on genomes, pathways, diseases and drugs</article-title>
        <source>Nucleic Acids Res</source>
        <year>2017</year>
        <volume>45</volume>
        <fpage>D353</fpage>
        <pub-id pub-id-type="doi">10.1093/NAR/GKW1092</pub-id>
        <?supplied-pmid 27899662?>
        <pub-id pub-id-type="pmid">27899662</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jewison</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Su</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Disfany</surname>
            <given-names>FM</given-names>
          </name>
          <name>
            <surname>Liang</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Knox</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>MacIejewski</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>SMPDB 2.0: big improvements to the Small Molecule Pathway Database</article-title>
        <source>Nucleic Acids Res</source>
        <year>2014</year>
        <pub-id pub-id-type="doi">10.1093/NAR/GKT1067</pub-id>
        <?supplied-pmid 24203711?>
        <pub-id pub-id-type="pmid">24203711</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gillespie</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Jassal</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Stephan</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Milacic</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Rothfels</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Senff-Ribeiro</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The reactome pathway knowledgebase 2022</article-title>
        <source>Nucleic Acids Res</source>
        <year>2021</year>
        <pub-id pub-id-type="doi">10.1093/NAR/GKAB1028</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Caspi</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Altman</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Billington</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Dreher</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Foerster</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Fulcher</surname>
            <given-names>CA</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The MetaCyc database of metabolic pathways and enzymes and the BioCyc collection of Pathway/Genome Databases</article-title>
        <source>Nucleic Acids Res</source>
        <year>2014</year>
        <volume>42</volume>
        <fpage>D459</fpage>
        <lpage>D471</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkt1103</pub-id>
        <?supplied-pmid 24225315?>
        <pub-id pub-id-type="pmid">24225315</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tomfohr</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Lu</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Kepler</surname>
            <given-names>TB</given-names>
          </name>
        </person-group>
        <article-title>Pathway level analysis of gene expression using singular value decomposition</article-title>
        <source>BMC Bioinform</source>
        <year>2005</year>
        <volume>6</volume>
        <fpage>225</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-6-225</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Drier</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Sheffer</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Domany</surname>
            <given-names>E</given-names>
          </name>
        </person-group>
        <article-title>Pathway-based personalized analysis of cancer</article-title>
        <source>Proc Natl Acad Sci U S A</source>
        <year>2013</year>
        <volume>110</volume>
        <fpage>6388</fpage>
        <lpage>6393</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.1219651110</pub-id>
        <?supplied-pmid 23547110?>
        <pub-id pub-id-type="pmid">23547110</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Barbie</surname>
            <given-names>DA</given-names>
          </name>
          <name>
            <surname>Tamayo</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Boehm</surname>
            <given-names>JS</given-names>
          </name>
          <name>
            <surname>Kim</surname>
            <given-names>SY</given-names>
          </name>
          <name>
            <surname>Moody</surname>
            <given-names>SE</given-names>
          </name>
          <name>
            <surname>Dunn</surname>
            <given-names>IF</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Systematic RNA interference reveals that oncogenic KRAS-driven cancers require TBK1</article-title>
        <source>Nature</source>
        <year>2009</year>
        <volume>462</volume>
        <fpage>108</fpage>
        <lpage>112</lpage>
        <pub-id pub-id-type="doi">10.1038/nature08460</pub-id>
        <?supplied-pmid 19847166?>
        <pub-id pub-id-type="pmid">19847166</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hänzelmann</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Castelo</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Guinney</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>GSVA: gene set variation analysis for microarray and RNA-Seq data</article-title>
        <source>BMC Bioinform</source>
        <year>2013</year>
        <volume>14</volume>
        <fpage>7</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-14-7</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lee</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Chuang</surname>
            <given-names>HY</given-names>
          </name>
          <name>
            <surname>Kim</surname>
            <given-names>JW</given-names>
          </name>
          <name>
            <surname>Ideker</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>Inferring pathway activity toward precise disease classification. Tucker-Kellogg G, editor</article-title>
        <source>PLoS Comput Biol</source>
        <year>2008</year>
        <volume>4</volume>
        <fpage>e1000217</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pcbi.1000217</pub-id>
        <?supplied-pmid 18989396?>
        <pub-id pub-id-type="pmid">18989396</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Sun</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Zimmermann</surname>
            <given-names>MT</given-names>
          </name>
          <name>
            <surname>Bugrim</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Kocher</surname>
            <given-names>J-P</given-names>
          </name>
        </person-group>
        <article-title>Predict drug sensitivity of cancer cells with pathway activity inference</article-title>
        <source>BMC Med Genom</source>
        <year>2019</year>
        <volume>12</volume>
        <fpage>5</fpage>
        <lpage>13</lpage>
        <pub-id pub-id-type="doi">10.1186/S12920-018-0449-4</pub-id>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Segura-Lepe</surname>
            <given-names>MP</given-names>
          </name>
          <name>
            <surname>Keun</surname>
            <given-names>HC</given-names>
          </name>
          <name>
            <surname>Ebbels</surname>
            <given-names>TMD</given-names>
          </name>
        </person-group>
        <article-title>Predictive modelling using pathway scores: robustness and significance of pathway collections</article-title>
        <source>BMC Bioinform</source>
        <year>2019</year>
        <volume>20</volume>
        <fpage>543</fpage>
        <pub-id pub-id-type="doi">10.1186/s12859-019-3163-0</pub-id>
      </element-citation>
    </ref>
    <ref id="CR29">
      <label>29.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Foroutan</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Bhuva</surname>
            <given-names>DD</given-names>
          </name>
          <name>
            <surname>Lyu</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Horan</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Cursons</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Davis</surname>
            <given-names>MJ</given-names>
          </name>
        </person-group>
        <article-title>Single sample scoring of molecular phenotypes</article-title>
        <source>BMC Bioinform</source>
        <year>2018</year>
        <volume>19</volume>
        <fpage>404</fpage>
        <pub-id pub-id-type="doi">10.1186/s12859-018-2435-4</pub-id>
      </element-citation>
    </ref>
    <ref id="CR30">
      <label>30.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Meng</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Basunia</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Peters</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Gholami</surname>
            <given-names>AM</given-names>
          </name>
          <name>
            <surname>Kuster</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Culhane</surname>
            <given-names>AC</given-names>
          </name>
        </person-group>
        <article-title>MOGSA: integrative single sample gene-set analysis of multiple omics data</article-title>
        <source>Mol Cell Proteom</source>
        <year>2019</year>
        <volume>18</volume>
        <fpage>S153</fpage>
        <lpage>S168</lpage>
        <pub-id pub-id-type="doi">10.1074/mcp.TIR118.001251</pub-id>
      </element-citation>
    </ref>
    <ref id="CR31">
      <label>31.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chaleckis</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Meister</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Wheelock</surname>
            <given-names>CE</given-names>
          </name>
        </person-group>
        <article-title>Challenges, progress and promises of metabolite annotation for LC–MS-based metabolomics</article-title>
        <source>Curr Opin Biotechnol</source>
        <year>2019</year>
        <volume>55</volume>
        <fpage>44</fpage>
        <lpage>50</lpage>
        <pub-id pub-id-type="doi">10.1016/J.COPBIO.2018.07.010</pub-id>
        <?supplied-pmid 30138778?>
        <pub-id pub-id-type="pmid">30138778</pub-id>
      </element-citation>
    </ref>
    <ref id="CR32">
      <label>32.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Geistlinger</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Csaba</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Santarelli</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Ramos</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Schiffer</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Turaga</surname>
            <given-names>N</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Toward a gold standard for benchmarking gene set enrichment analysis</article-title>
        <source>Brief Bioinform</source>
        <year>2021</year>
        <volume>22</volume>
        <fpage>545</fpage>
        <lpage>556</lpage>
        <pub-id pub-id-type="doi">10.1093/bib/bbz158</pub-id>
        <?supplied-pmid 32026945?>
        <pub-id pub-id-type="pmid">32026945</pub-id>
      </element-citation>
    </ref>
    <ref id="CR33">
      <label>33.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nguyen</surname>
            <given-names>TM</given-names>
          </name>
          <name>
            <surname>Shafi</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Nguyen</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Draghici</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Identifying significantly impacted pathways: a comprehensive review and assessment</article-title>
        <source>Genome Biol</source>
        <year>2019</year>
        <volume>20</volume>
        <fpage>203</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-019-1790-4</pub-id>
        <?supplied-pmid 31597578?>
        <pub-id pub-id-type="pmid">31597578</pub-id>
      </element-citation>
    </ref>
    <ref id="CR34">
      <label>34.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Evangelou</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Rendon</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Ouwehand</surname>
            <given-names>WH</given-names>
          </name>
          <name>
            <surname>Wernisch</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Dudbridge</surname>
            <given-names>F</given-names>
          </name>
        </person-group>
        <article-title>Comparison of methods for competitive tests of pathway analysis</article-title>
        <source>PLoS ONE</source>
        <year>2012</year>
        <volume>7</volume>
        <fpage>e41018</fpage>
        <pub-id pub-id-type="doi">10.1371/JOURNAL.PONE.0041018</pub-id>
        <?supplied-pmid 22859961?>
        <pub-id pub-id-type="pmid">22859961</pub-id>
      </element-citation>
    </ref>
    <ref id="CR35">
      <label>35.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Alhamdoosh</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Ng</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Wilson</surname>
            <given-names>NJ</given-names>
          </name>
          <name>
            <surname>Sheridan</surname>
            <given-names>JM</given-names>
          </name>
          <name>
            <surname>Huynh</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Wilson</surname>
            <given-names>MJ</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Combining multiple tools outperforms individual methods in gene set enrichment analyses</article-title>
        <source>Bioinformatics</source>
        <year>2017</year>
        <volume>33</volume>
        <fpage>414</fpage>
        <lpage>424</lpage>
        <pub-id pub-id-type="doi">10.1093/BIOINFORMATICS/BTW623</pub-id>
        <?supplied-pmid 27694195?>
        <pub-id pub-id-type="pmid">27694195</pub-id>
      </element-citation>
    </ref>
    <ref id="CR36">
      <label>36.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hung</surname>
            <given-names>JH</given-names>
          </name>
          <name>
            <surname>Yang</surname>
            <given-names>TH</given-names>
          </name>
          <name>
            <surname>Hu</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Weng</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>DeLisi</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>Gene set enrichment analysis: performance evaluation and usage guidelines</article-title>
        <source>Brief Bioinform</source>
        <year>2012</year>
        <volume>13</volume>
        <fpage>281</fpage>
        <lpage>291</lpage>
        <pub-id pub-id-type="doi">10.1093/BIB/BBR049</pub-id>
        <?supplied-pmid 21900207?>
        <pub-id pub-id-type="pmid">21900207</pub-id>
      </element-citation>
    </ref>
    <ref id="CR37">
      <label>37.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Väremo</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Nielsen</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Nookaew</surname>
            <given-names>I</given-names>
          </name>
        </person-group>
        <article-title>Enriching the gene set analysis of genome-wide data by incorporating directionality of gene expression and combining statistical hypotheses and methods</article-title>
        <source>Nucleic Acids Res</source>
        <year>2013</year>
        <volume>41</volume>
        <fpage>4378</fpage>
        <lpage>4391</lpage>
        <pub-id pub-id-type="doi">10.1093/NAR/GKT111</pub-id>
        <?supplied-pmid 23444143?>
        <pub-id pub-id-type="pmid">23444143</pub-id>
      </element-citation>
    </ref>
    <ref id="CR38">
      <label>38.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Su</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Yuan</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Lausted</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Choi</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Dai</surname>
            <given-names>CL</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Multi-omics resolves a sharp disease-state shift between mild and moderate COVID-19</article-title>
        <source>Cell</source>
        <year>2020</year>
        <volume>183</volume>
        <fpage>1479</fpage>
        <lpage>1495.e20</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2020.10.037</pub-id>
        <?supplied-pmid 33171100?>
        <pub-id pub-id-type="pmid">33171100</pub-id>
      </element-citation>
    </ref>
    <ref id="CR39">
      <label>39.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lloyd-Price</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Arze</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Ananthakrishnan</surname>
            <given-names>AN</given-names>
          </name>
          <name>
            <surname>Schirmer</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Avila-Pacheco</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Poon</surname>
            <given-names>TW</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Multi-omics of the gut microbial ecosystem in inflammatory bowel diseases</article-title>
        <source>Nature</source>
        <year>2019</year>
        <volume>569</volume>
        <fpage>655</fpage>
        <lpage>662</lpage>
        <pub-id pub-id-type="doi">10.1038/s41586-019-1237-9</pub-id>
        <?supplied-pmid 31142855?>
        <pub-id pub-id-type="pmid">31142855</pub-id>
      </element-citation>
    </ref>
    <ref id="CR40">
      <label>40.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wei</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Su</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Jia</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>T</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Missing value imputation approach for mass spectrometry-based metabolomics data</article-title>
        <source>Sci Rep</source>
        <year>2018</year>
        <volume>8</volume>
        <fpage>1</fpage>
        <lpage>10</lpage>
        <pub-id pub-id-type="doi">10.1038/s41598-017-19120-0</pub-id>
        <pub-id pub-id-type="pmid">29311619</pub-id>
      </element-citation>
    </ref>
    <ref id="CR41">
      <label>41.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pang</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Chong</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Zhou</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>de Lima Morais</surname>
            <given-names>DA</given-names>
          </name>
          <name>
            <surname>Chang</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Barrette</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>MetaboAnalyst 5.0: narrowing the gap between raw spectra and functional insights</article-title>
        <source>Nucleic Acids Res</source>
        <year>2021</year>
        <pub-id pub-id-type="doi">10.1093/nar/gkab382</pub-id>
        <?supplied-pmid 34581805?>
        <pub-id pub-id-type="pmid">34581805</pub-id>
      </element-citation>
    </ref>
    <ref id="CR42">
      <label>42.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Schölkopf</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Smola</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Müller</surname>
            <given-names>KR</given-names>
          </name>
        </person-group>
        <person-group person-group-type="editor">
          <name>
            <surname>Gerstner</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Germond</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Hasler</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Nicoud</surname>
            <given-names>JD</given-names>
          </name>
        </person-group>
        <article-title>Kernel principal component analysis</article-title>
        <source>Lecture notes in computer science (including subseries lecture notes in artificial intelligence and lecture notes in bioinformatics)</source>
        <year>1997</year>
        <publisher-loc>Berlin</publisher-loc>
        <publisher-name>Springer</publisher-name>
        <fpage>583</fpage>
        <lpage>588</lpage>
      </element-citation>
    </ref>
    <ref id="CR43">
      <label>43.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hubert</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Arabie</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>Comparing partitions</article-title>
        <source>J Classif</source>
        <year>1985</year>
        <volume>2</volume>
        <fpage>193</fpage>
        <lpage>218</lpage>
        <pub-id pub-id-type="doi">10.1007/BF01908075</pub-id>
      </element-citation>
    </ref>
    <ref id="CR44">
      <label>44.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Stoney</surname>
            <given-names>RA</given-names>
          </name>
          <name>
            <surname>Schwartz</surname>
            <given-names>JM</given-names>
          </name>
          <name>
            <surname>Robertson</surname>
            <given-names>DL</given-names>
          </name>
          <name>
            <surname>Nenadic</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>Using set theory to reduce redundancy in pathway sets</article-title>
        <source>BMC Bioinform</source>
        <year>2018</year>
        <volume>19</volume>
        <fpage>386</fpage>
        <pub-id pub-id-type="doi">10.1186/s12859-018-2355-3</pub-id>
      </element-citation>
    </ref>
    <ref id="CR45">
      <label>45.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bayerlová</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Jung</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Kramer</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Klemm</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Bleckmann</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Beißbarth</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>Comparative study on gene set and pathway topology-based enrichment methods</article-title>
        <source>BMC Bioinform</source>
        <year>2015</year>
        <volume>16</volume>
        <fpage>1</fpage>
        <lpage>15</lpage>
        <pub-id pub-id-type="doi">10.1186/s12859-015-0751-5</pub-id>
      </element-citation>
    </ref>
    <ref id="CR46">
      <label>46.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Castro-Dopico</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Clatworthy</surname>
            <given-names>MR</given-names>
          </name>
        </person-group>
        <article-title>IgG and Fcγ receptors in intestinal immunity and inflammation</article-title>
        <source>Front Immunol</source>
        <year>2019</year>
        <volume>10</volume>
        <fpage>805</fpage>
        <pub-id pub-id-type="doi">10.3389/FIMMU.2019.00805/BIBTEX</pub-id>
        <?supplied-pmid 31031776?>
        <pub-id pub-id-type="pmid">31031776</pub-id>
      </element-citation>
    </ref>
    <ref id="CR47">
      <label>47.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Boldyreva</surname>
            <given-names>LV</given-names>
          </name>
          <name>
            <surname>Morozova</surname>
            <given-names>MV</given-names>
          </name>
          <name>
            <surname>Saydakova</surname>
            <given-names>SS</given-names>
          </name>
          <name>
            <surname>Kozhevnikova</surname>
            <given-names>EN</given-names>
          </name>
        </person-group>
        <article-title>Fat of the gut: epithelial phospholipids in inflammatory bowel diseases</article-title>
        <source>Int J Mol Sci</source>
        <year>2021</year>
        <volume>22</volume>
        <fpage>11682</fpage>
        <pub-id pub-id-type="doi">10.3390/IJMS222111682</pub-id>
        <?supplied-pmid 34769112?>
        <pub-id pub-id-type="pmid">34769112</pub-id>
      </element-citation>
    </ref>
    <ref id="CR48">
      <label>48.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Weiss</surname>
            <given-names>TS</given-names>
          </name>
          <name>
            <surname>Herfarth</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Obermeier</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Ouart</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Vogl</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Schölmerich</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Intracellular polyamine levels of intestinal epithelial cells in inflammatory bowel disease</article-title>
        <source>Inflamm Bowel Dis</source>
        <year>2004</year>
        <volume>10</volume>
        <fpage>529</fpage>
        <lpage>535</lpage>
        <pub-id pub-id-type="doi">10.1097/00054725-200409000-00006</pub-id>
        <?supplied-pmid 15472512?>
        <pub-id pub-id-type="pmid">15472512</pub-id>
      </element-citation>
    </ref>
    <ref id="CR49">
      <label>49.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Guzior</surname>
            <given-names>DV</given-names>
          </name>
          <name>
            <surname>Quinn</surname>
            <given-names>RA</given-names>
          </name>
        </person-group>
        <article-title>Review: microbial transformations of human bile acids</article-title>
        <source>Microbiome</source>
        <year>2021</year>
        <pub-id pub-id-type="doi">10.1186/s40168-021-01101-1</pub-id>
        <?supplied-pmid 34127070?>
        <pub-id pub-id-type="pmid">34127070</pub-id>
      </element-citation>
    </ref>
    <ref id="CR50">
      <label>50.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hubler</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>Kennedy</surname>
            <given-names>AJ</given-names>
          </name>
        </person-group>
        <article-title>Role of lipids in the metabolism and activation of immune cells</article-title>
        <source>J Nutr Biochem</source>
        <year>2016</year>
        <volume>34</volume>
        <fpage>1</fpage>
        <pub-id pub-id-type="doi">10.1016/J.JNUTBIO.2015.11.002</pub-id>
        <?supplied-pmid 27424223?>
        <pub-id pub-id-type="pmid">27424223</pub-id>
      </element-citation>
    </ref>
    <ref id="CR51">
      <label>51.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Fan</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Mundra</surname>
            <given-names>PA</given-names>
          </name>
          <name>
            <surname>Fang</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Galvin</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Moore</surname>
            <given-names>XL</given-names>
          </name>
          <name>
            <surname>Weir</surname>
            <given-names>JM</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Lipidomic profiling in inflammatory bowel disease: comparison between ulcerative colitis and Crohn’s disease</article-title>
        <source>Inflamm Bowel Dis</source>
        <year>2015</year>
        <volume>21</volume>
        <fpage>1511</fpage>
        <lpage>1518</lpage>
        <pub-id pub-id-type="doi">10.1097/MIB.0000000000000394</pub-id>
        <?supplied-pmid 25895111?>
        <pub-id pub-id-type="pmid">25895111</pub-id>
      </element-citation>
    </ref>
    <ref id="CR52">
      <label>52.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Abdel Hadi</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>di Vito</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Riboni</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <article-title>Fostering inflammatory bowel disease: sphingolipid strategies to join forces</article-title>
        <source>Mediat Inflamm</source>
        <year>2016</year>
        <pub-id pub-id-type="doi">10.1155/2016/3827684</pub-id>
      </element-citation>
    </ref>
    <ref id="CR53">
      <label>53.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Giannotta</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Tapete</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Emmi</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Silvestri</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Milla</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Thrombosis in inflammatory bowel diseases: what’s the link?</article-title>
        <source>Thromb J</source>
        <year>2015</year>
        <volume>13</volume>
        <fpage>1</fpage>
        <lpage>9</lpage>
        <pub-id pub-id-type="doi">10.1186/S12959-015-0044-2/FIGURES/2</pub-id>
        <pub-id pub-id-type="pmid">25937820</pub-id>
      </element-citation>
    </ref>
    <ref id="CR54">
      <label>54.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hatoum</surname>
            <given-names>OA</given-names>
          </name>
          <name>
            <surname>Binion</surname>
            <given-names>DG</given-names>
          </name>
          <name>
            <surname>Otterson</surname>
            <given-names>MF</given-names>
          </name>
          <name>
            <surname>Gutterman</surname>
            <given-names>DD</given-names>
          </name>
        </person-group>
        <article-title>Acquired microvascular dysfunction in inflammatory bowel disease: loss of nitric oxide-mediated vasodilation</article-title>
        <source>Gastroenterology</source>
        <year>2003</year>
        <volume>125</volume>
        <fpage>58</fpage>
        <lpage>69</lpage>
        <pub-id pub-id-type="doi">10.1016/S0016-5085(03)00699-1</pub-id>
        <?supplied-pmid 12851871?>
        <pub-id pub-id-type="pmid">12851871</pub-id>
      </element-citation>
    </ref>
    <ref id="CR55">
      <label>55.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Aviello</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Knaus</surname>
            <given-names>UG</given-names>
          </name>
        </person-group>
        <article-title>ROS in gastrointestinal inflammation: rescue or sabotage?</article-title>
        <source>Br J Pharmacol</source>
        <year>2017</year>
        <volume>174</volume>
        <fpage>1704</fpage>
        <pub-id pub-id-type="doi">10.1111/BPH.13428</pub-id>
        <?supplied-pmid 26758851?>
        <pub-id pub-id-type="pmid">26758851</pub-id>
      </element-citation>
    </ref>
    <ref id="CR56">
      <label>56.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pereira</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Grácio</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Teixeira</surname>
            <given-names>JP</given-names>
          </name>
          <name>
            <surname>Magro</surname>
            <given-names>F</given-names>
          </name>
        </person-group>
        <article-title>Oxidative stress and DNA damage: implications in inflammatory bowel disease</article-title>
        <source>Inflamm Bowel Dis</source>
        <year>2015</year>
        <volume>21</volume>
        <fpage>2403</fpage>
        <lpage>2417</lpage>
        <pub-id pub-id-type="doi">10.1097/MIB.0000000000000506</pub-id>
        <?supplied-pmid 26193347?>
        <pub-id pub-id-type="pmid">26193347</pub-id>
      </element-citation>
    </ref>
    <ref id="CR57">
      <label>57.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Liu</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Lehtonen</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Hautaniemi</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>PerPAS: topology-based single sample pathway analysis method</article-title>
        <source>IEEE/ACM Trans Comput Biol Bioinform</source>
        <year>2018</year>
        <volume>15</volume>
        <fpage>1022</fpage>
        <lpage>1027</lpage>
        <pub-id pub-id-type="doi">10.1109/TCBB.2017.2679745</pub-id>
        <?supplied-pmid 28287981?>
        <pub-id pub-id-type="pmid">28287981</pub-id>
      </element-citation>
    </ref>
    <ref id="CR58">
      <label>58.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Zheng</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Xiang</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>F-X</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Evaluation of pathway activation for a single sample toward inflammatory bowel disease classification</article-title>
        <source>Front Genet</source>
        <year>2020</year>
        <volume>10</volume>
        <fpage>1401</fpage>
        <pub-id pub-id-type="doi">10.3389/fgene.2019.01401</pub-id>
        <?supplied-pmid 32117426?>
        <pub-id pub-id-type="pmid">32117426</pub-id>
      </element-citation>
    </ref>
    <ref id="CR59">
      <label>59.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yi</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Nissley</surname>
            <given-names>DV</given-names>
          </name>
          <name>
            <surname>McCormick</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Stephens</surname>
            <given-names>RM</given-names>
          </name>
        </person-group>
        <article-title>ssGSEA score-based Ras dependency indexes derived from gene expression data reveal potential Ras addiction mechanisms with possible clinical implications</article-title>
        <source>Sci Rep</source>
        <year>2020</year>
        <volume>10</volume>
        <fpage>1</fpage>
        <lpage>16</lpage>
        <pub-id pub-id-type="doi">10.1038/s41598-020-66986-8</pub-id>
        <pub-id pub-id-type="pmid">31913322</pub-id>
      </element-citation>
    </ref>
    <ref id="CR60">
      <label>60.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>McLuskey</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Wandy</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Vincent</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>van der Hooft</surname>
            <given-names>JJJ</given-names>
          </name>
          <name>
            <surname>Rogers</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Burgess</surname>
            <given-names>K</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Ranking metabolite sets by their activity levels</article-title>
        <source>Metabolites</source>
        <year>2021</year>
        <volume>11</volume>
        <fpage>103</fpage>
        <pub-id pub-id-type="doi">10.3390/metabo11020103</pub-id>
        <?supplied-pmid 33670102?>
        <pub-id pub-id-type="pmid">33670102</pub-id>
      </element-citation>
    </ref>
    <ref id="CR61">
      <label>61.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Martens</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Ammar</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Riutta</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Waagmeester</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Slenter</surname>
            <given-names>DN</given-names>
          </name>
          <name>
            <surname>Hanspers</surname>
            <given-names>K</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>WikiPathways: connecting communities</article-title>
        <source>Nucleic Acids Res</source>
        <year>2021</year>
        <volume>49</volume>
        <fpage>D613</fpage>
        <lpage>D621</lpage>
        <pub-id pub-id-type="doi">10.1093/NAR/GKAA1024</pub-id>
        <?supplied-pmid 33211851?>
        <pub-id pub-id-type="pmid">33211851</pub-id>
      </element-citation>
    </ref>
    <ref id="CR62">
      <label>62.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gundem</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Lopez-Bigas</surname>
            <given-names>N</given-names>
          </name>
        </person-group>
        <article-title>Sample-level enrichment analysis unravels shared stress phenotypes among multiple cancer types</article-title>
        <source>Genome Med</source>
        <year>2012</year>
        <volume>4</volume>
        <fpage>28</fpage>
        <pub-id pub-id-type="doi">10.1186/GM327</pub-id>
        <?supplied-pmid 22458606?>
        <pub-id pub-id-type="pmid">22458606</pub-id>
      </element-citation>
    </ref>
    <ref id="CR63">
      <label>63.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Su</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Yu</surname>
            <given-names>Q</given-names>
          </name>
          <name>
            <surname>Shen</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Sun</surname>
            <given-names>S-Y</given-names>
          </name>
          <name>
            <surname>Moreno</surname>
            <given-names>CS</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>X</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Pan-cancer analysis of pathway-based gene expression pattern at the individual level reveals biomarkers of clinical prognosis</article-title>
        <source>Cell Rep Methods</source>
        <year>2021</year>
        <volume>1</volume>
        <fpage>100050</fpage>
        <pub-id pub-id-type="doi">10.1016/j.crmeth.2021.100050</pub-id>
        <?supplied-pmid 34671755?>
        <pub-id pub-id-type="pmid">34671755</pub-id>
      </element-citation>
    </ref>
    <ref id="CR64">
      <label>64.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schubert</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Klinger</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Klünemann</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Sieber</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Uhlitz</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Sauer</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Perturbation-response genes reveal signaling footprints in cancer gene expression</article-title>
        <source>Nat Commun</source>
        <year>2018</year>
        <pub-id pub-id-type="doi">10.1038/S41467-017-02391-6</pub-id>
        <?supplied-pmid 30446665?>
        <pub-id pub-id-type="pmid">30446665</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
