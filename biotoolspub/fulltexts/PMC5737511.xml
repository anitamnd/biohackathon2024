<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1 20151215//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.1?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Gigascience</journal-id>
    <journal-id journal-id-type="iso-abbrev">Gigascience</journal-id>
    <journal-id journal-id-type="publisher-id">gigascience</journal-id>
    <journal-title-group>
      <journal-title>GigaScience</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2047-217X</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">5737511</article-id>
    <article-id pub-id-type="doi">10.1093/gigascience/gix090</article-id>
    <article-id pub-id-type="publisher-id">gix090</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Technical Note</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title><italic>Indexcov</italic>: fast coverage quality control for whole-genome sequencing</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Pedersen</surname>
          <given-names>Brent S</given-names>
        </name>
        <!--<email>bpederse@gmail.com</email>-->
        <xref ref-type="aff" rid="aff1">1</xref>
        <xref ref-type="aff" rid="aff3">3</xref>
        <xref ref-type="corresp" rid="cor1"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Collins</surname>
          <given-names>Ryan L</given-names>
        </name>
        <xref ref-type="aff" rid="aff4">4</xref>
        <xref ref-type="aff" rid="aff6">6</xref>
        <xref ref-type="aff" rid="aff7">7</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Talkowski</surname>
          <given-names>Michael E</given-names>
        </name>
        <xref ref-type="aff" rid="aff4">4</xref>
        <xref ref-type="aff" rid="aff5">5</xref>
        <xref ref-type="aff" rid="aff6">6</xref>
        <xref ref-type="aff" rid="aff7">7</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Quinlan</surname>
          <given-names>Aaron R</given-names>
        </name>
        <!--<email>aaronquinlan@gmail.com</email>-->
        <xref ref-type="aff" rid="aff1">1</xref>
        <xref ref-type="aff" rid="aff2">2</xref>
        <xref ref-type="aff" rid="aff3">3</xref>
        <xref ref-type="corresp" rid="cor1"/>
      </contrib>
    </contrib-group>
    <aff id="aff1"><label>1</label>Department of Human Genetics, University of Utah, 15 S 2030 E, Salt Lake City, UT 84112, USA</aff>
    <aff id="aff2"><label>2</label>Department of Biomedical Informatics, University of Utah, 421 Wakara Way #140, Salt Lake City, UT 84108, USA</aff>
    <aff id="aff3"><label>3</label>USTAR Center for Genetic Discovery, University of Utah, 15 S 2030 E, Salt Lake City, UT 84112, USA</aff>
    <aff id="aff4"><label>4</label>Center for Genomic Medicine, Massachusetts General Hospital, 55 Fruit St, Boston, MA 02114, USA</aff>
    <aff id="aff5"><label>5</label>Department of Neurology, Harvard Medical School, A-111, 25 Shattuck St, Boston, MA 02115, USA</aff>
    <aff id="aff6"><label>6</label>Program in Medical and Population Genetics and Stanley Center for Psychiatric Research, Broad Institute, 415 Main St, Cambridge, MA 02142, USA</aff>
    <aff id="aff7"><label>7</label>Program in Bioinformatics and Integrative Genomics, Division of Medical Sciences, Harvard Medical School, A-111, 25 Shattuck St, Boston, MA 02115, USA</aff>
    <author-notes>
      <corresp id="cor1"><label>*</label><bold>Correspondence address.</bold> Aaron R. Quinlan, Department of Human Genetics, University of Utah, 15 S 2030 E, Salt Lake City, UT 84112, USA. Tel: 801-585-7574; Fax: 801-581-7796; E-mail: <email>aaronquinlan@gmail.com</email>; or Brent S. Pedersen, Department of Human Genetics, University of Utah, 15 S 2030 E, Salt Lake City, UT 84112, USA; E-mail: <email>bpederse@gmail.com</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <month>11</month>
      <year>2017</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2017-09-18">
      <day>18</day>
      <month>9</month>
      <year>2017</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>18</day>
      <month>9</month>
      <year>2017</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the <pub-date pub-type="epub"/>. -->
    <volume>6</volume>
    <issue>11</issue>
    <fpage>1</fpage>
    <lpage>6</lpage>
    <history>
      <date date-type="accepted">
        <day>11</day>
        <month>9</month>
        <year>2017</year>
      </date>
      <date date-type="received">
        <day>29</day>
        <month>6</month>
        <year>2017</year>
      </date>
      <date date-type="rev-recd">
        <day>22</day>
        <month>8</month>
        <year>2017</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Authors 2017. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2017</copyright-year>
      <license license-type="cc-by" xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<uri xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</uri>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="gix090.pdf"/>
    <abstract>
      <title>Abstract</title>
      <p>The BAM and CRAM formats provide a supplementary linear index that facilitates rapid access to sequence alignments in arbitrary genomic regions. Comparing consecutive entries in a BAM or CRAM index allows one to infer the number of alignment records per genomic region for use as an effective proxy of sequence depth in each genomic region. Based on these properties, we have developed <italic>indexcov</italic>, an efficient estimator of whole-genome sequencing coverage to rapidly identify samples with aberrant coverage profiles, reveal large-scale chromosomal anomalies, recognize potential batch effects, and infer the sex of a sample. <italic>Indexcov</italic> is available at <ext-link ext-link-type="uri" xlink:href="https://github.com/brentp/goleft">https://github.com/brentp/goleft</ext-link> under the MIT license.</p>
    </abstract>
    <counts>
      <page-count count="6"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec sec-type="intro" id="sec1">
    <title>Introduction</title>
    <p>Whole-genome sequencing (WGS) studies produce massive data sets that cost thousands of dollars per sample and often require hundreds or thousands of hours to analyze with intense computational requirements. While verifying the integrity and quality of the resulting sequence data is crucial, it remains difficult owing to the size of the data. For example, a single aligned BAM file from 30× WGS typically results in hundreds of millions of alignment records, requiring at least 100 gigabytes of storage in BAM format [<xref rid="bib1" ref-type="bibr">1</xref>]. The simple act of iterating through every alignment record (without any analysis or computation) can consume hours of processing time. Assessing the depth and breadth of DNA sequence coverage in a WGS sample is a necessary precursor to variant discovery as depth of coverage drives the power to detect genetic variation, especially in the case of heterozygous sites [<xref rid="bib2" ref-type="bibr">2</xref>, <xref rid="bib3" ref-type="bibr">3</xref>]. Coverage information is critical when detecting copy number variation (CNV) and structural variation (SV), as greater sequencing depth increases power to detect smaller CNVs and increases the probability that an SV breakpoint will be captured by multiple independent sequence fragments [<xref rid="bib4" ref-type="bibr">4</xref>, <xref rid="bib5" ref-type="bibr">5</xref>]. However, existing quality control (QC) tools [<xref rid="bib1" ref-type="bibr">1</xref>, <xref rid="bib6" ref-type="bibr">6</xref>, <xref rid="bib7" ref-type="bibr">7</xref>] do not provide rapid visualizations of genome-wide or targeted estimates of sequence coverage for multiple samples, which, if aberrant, can confound downstream analyses. As a result, when studying large cohorts, a problematic sample may remain undetected until after these steps are completed. Therefore, it is critical to assess coverage profiles in a cohort as early as possible to identify problematic samples before proceeding with further analyses.</p>
    <p>In addition to single-sample problems such as missing data, it is important to look for batch effects and systematic artefacts in sequencing projects [<xref rid="bib8" ref-type="bibr">8</xref>]. The ability to rapidly summarize coverage across all samples after sequencing and alignment can identify problematic samples that require additional sequencing or that should be excluded from subsequent analysis. In an effort to address the quality control needs of WGS studies, we introduce <italic>indexcov</italic> as a new software package to quickly estimate the depth and consistency of sequence coverage in a BAM or CRAM file. By leveraging <italic>biogo/hts</italic> [<xref rid="bib9" ref-type="bibr">9</xref>], <italic>indexcov</italic> interrogates the entire genome of a sequenced sample using either a linear BAM index (default resolution: 16 384 bp) or a CRAM index (variable default resolution) to generate rapid estimates of coverage depth across each chromosome. Using this efficient approach, <italic>indexcov</italic> is able to infer sample sex, perform a principal components analysis to identify batch effects, and reveal coverage anomalies much more quickly (∼seconds per genome) than existing methods. In addition, <italic>indexcov</italic> produces interactive, web-based plots that permit users to visualize and investigate the coverage profiles and related QC metrics for each sample, both in a targeted fashion (e.g., individual chromosomes) and summarized across the whole genome.</p>
  </sec>
  <sec id="sec2">
    <title>Findings</title>
    <sec id="sec2-1">
      <title>Estimating WGS sequence depth from alignment indexes</title>
      <p>The BAM index enables random access in a coordinate-sorted BAM file, facilitating rapid interrogation of sequence reads aligned to arbitrary genomic regions in a reference genome. It provides a linear index that saves the file and block offset of the first alignment to start in each consecutive 16 384-bp “tile” of the genome. <italic>Indexcov</italic> iterates over all tiles per chromosome, recording the number of bytes that exist in each tile; the median of these proxy coverage values is used to establish a baseline coverage level for the average tile per chromosome. For example, imagine the median of all genome-wide tiles consumes ∼32 kilobytes. If we then identify a large stretch of adjacent tiles that consume ∼16 kilobytes (i.e., half the median), this may be evidence of a hemizygous deletion in a diploid organism. While the CRAM index does not have fixed-width tiles in terms of genomic bases, it can be used in a similar fashion. Since each sample will have different regions for each container (chunk) in the CRAM index, <italic>indexcov</italic> divides the CRAM chunks into 16-kb bins to normalize across samples. This results in a loss of resolution, but this approach still enables the detection of large coverage anomalies.</p>
    </sec>
    <sec id="sec2-2">
      <title>Comparison of coverage inferred by <italic>indexcov</italic> to empirical per-base sequencing depth</title>
      <p>A potential complication with the <italic>indexcov</italic>’s coverage estimation approach is that individual tiles may differ from the median value in a number of ways that are not due to bona fide changes in the depth of coverage or DNA dosage in that sample. For example, tiles with apparently high coverage may reflect situations where there are many split reads, which have more SAM tags, thereby increasing the number of bytes required by each alignment. Nonetheless, we found that the coverage estimated by <italic>indexcov</italic> is well correlated with the actual depth calculated by aggregating per-base depth calls from the <italic>samtools</italic> [<xref rid="bib1" ref-type="bibr">1</xref>] “depth” command into 16 384-bp tiles (Fig. <xref ref-type="fig" rid="fig1">1</xref>). We conducted this analysis on chromosome 1 for a single human BAM file aligned to reference assembly GRCh37 (NA12878) [<xref rid="bib10" ref-type="bibr">10</xref>], and, for the purpose of comparing the depth reported by <italic>samtools</italic> with the scaled value in <italic>indexcov</italic>, we divided the depth from <italic>samtools</italic> in each window by the overall median.</p>
      <fig id="fig1" orientation="portrait" position="float">
        <label>Figure 1:</label>
        <caption>
          <p>Difference between median-scaled sequencing depth in 16 384-bp bins from <italic>samtools</italic>, which recovers per-base depth from the BAM file, and <italic>indexcov</italic>, which estimates coverage from the BAM index. <italic>Samtools</italic> required ∼61 minutes to compute the depth in 16.4-kb bins of the genome, whereas <italic>indexcov</italic> estimated the depth of these regions in about 2 seconds. Pictured here is a summary from NA12878 chromosome 1. The x-axis values indicate the relative difference in normalized coverage estimates between <italic>samtools</italic> and <italic>indexcov</italic> in 16.4-kb bins for chromosome 1. Of the 15 196 bins measured, only 2.76% (420) have a difference in depth estimate outside the range of the plot (greater than 0.5). The Pearson correlation coefficient between the <italic>samtools</italic> and <italic>indexcov</italic> depths is 0.81.</p>
        </caption>
        <graphic xlink:href="gix090fig1"/>
      </fig>
      <p>Whereas the full-genome analysis required ∼61 minutes and ∼104 minutes of CPU time for <italic>samtools</italic> and <italic>bedtools</italic> [<xref rid="bib7" ref-type="bibr">7</xref>], respectively, <italic>indexcov</italic> completed the analysis in about 2 seconds. Indeed, less than 3% of the 15 196 tiles (each 16 384 bp in size) on chromosome 1 differed between <italic>indexcov</italic> and <italic>samtools</italic> by more than 5% of the normalized coverage values. This number was further reduced when we limited to bins that did not overlap low-complexity regions [<xref rid="bib11" ref-type="bibr">11</xref>]. Despite some differences, the overall correspondence between normalized coverage values from <italic>indexcov</italic> and <italic>samtools</italic> suggests that <italic>indexcov</italic> is an effective proxy for quickly estimating large-scale coverage values across an entire aligned WGS sample stored in BAM or CRAM format. Given its speed, <italic>indexcov</italic> complements these more accurate, yet more computationally expensive, approaches to exactly measuring coverage base by base.</p>
    </sec>
    <sec id="sec2-3">
      <title>Analysis of genome-wide coverage with <italic>indexcov</italic></title>
      <p>The most intuitive output created by <italic>indexcov</italic> is an estimate of genome-wide coverage, which can be run on individual samples or simultaneously across large batches of samples for cohort-wide QC and coverage analyses. <italic>Indexcov</italic> produces 1 coverage plot for each chromosome via an interactive plot contained in an HTML file (details below), as well as a BED file containing the scaled coverage values for each sample at each 16-kb tile, thereby enabling custom visualizations if desired. An example coverage plot is shown in Fig. <xref ref-type="fig" rid="fig2">2</xref>A for chromosome 15, reflecting coverage profiles for 45 human WGS samples from an ongoing study at the University of Utah. Since chromosome 15 is acrocentric and its centromere is N-masked in the human reference genome assembly, we see no reads aligned to the first ∼20 Mb (far left) of the plot. Aside from a highly repetitive region downstream of the centromere, most of the coverage values for the majority of samples are centered at a scaled coverage of 1, which corresponds to a diploid copy state for chromosome 15. However, a single sample (highlighted in green) has a scaled coverage value of ∼0.5 across a 10-megabase region (23–33 Mb), which is consistent with a large deletion that resulted in a genetic diagnosis of Angelman syndrome for this individual. While <italic>indexcov</italic> is not intended as a general purpose CNV detection tool, it serves as an effective method for visual identification of large anomalies such as this Angelman syndrome deletion. Fig. <xref ref-type="fig" rid="fig2">2</xref>B shows this same coverage information as a reverse cumulative density function (CDF). Like the first coverage plot, this view also clearly highlights the aberrant sample with the Angelman syndrome deletion, as evinced by ∼10% of chr15 being covered at a lower scaled coverage value than the other 44 samples. Most samples have a steep slope at a scaled coverage value of ∼1, reflecting the fact that the majority of genome tiles for these samples are very close to a scaled coverage of 1. However, when a sample has much greater variability in scaled coverage (e.g., sample in red), the slope when passing through a scaled coverage of 1 will be far less steep. Chromosomes with high GC content (such as 19, 22, 17, 16 in humans) will vary more widely in slope consistent with GC-correlated biases in sequencing depth introduced by polymerase chain reaction (PCR) [<xref rid="bib12" ref-type="bibr">12</xref>].</p>
      <fig id="fig2" orientation="portrait" position="float">
        <label>Figure 2:</label>
        <caption>
          <p>Coverage profiles for 45 human WGS samples on chromosome 15. The estimated coverage along the chromosome is shown in (<bold>A</bold>), and an alternative representation showing the proportion of tiles covered at a certain depth and as the lower path is shown in (<bold>B</bold>). The sample highlighted with a green line has a ∼10-MB deletion just after the (acrocentric) centromere that has been previously associated with Angelman syndrome. The crimson line tracks a sample with a large variability in coverage; samples like this one will have many spurious CNV calls. These plots are interactive in the <italic>indexcov</italic> output, allowing users to hover and identify samples of interest.</p>
        </caption>
        <graphic xlink:href="gix090fig2"/>
      </fig>
    </sec>
    <sec id="sec2-4">
      <title>Sex inference</title>
      <p>Sequencing depth is an especially effective metric for ploidy and sex inference since human males typically have only 1 X chromosome and human females lack Y chromosomes. Using these expectations, and as a demonstration of the utility of <italic>indexcov</italic> to rapidly facilitate useful cohort-wide QC in WGS studies, we used <italic>indexcov</italic> to infer the ploidy of the sex chromosomes in a cohort of 2076 from 519 “quartet” (proband, unaffected sibling, and two parents) samples as part of a recent analysis of autism spectrum disorder (ASD) simplex families (Fig. <xref ref-type="fig" rid="fig3">3</xref>) [<xref rid="bib13" ref-type="bibr">13</xref>]. Most samples cluster as either male (XY genotype; X = 1, Y = 1) or female (XX genotype; X = 2, Y = 0). However, 5 samples cluster in 2 non-canonical locations, 1 at XYY inferred genotype (X = 1, Y = 2) and a second cluster at inferred genotype XXY (X = 2, Y = 1). These non-canonical clusters of samples indicate the presence of rare supernumerary sex aneuploidies, some of which have been previously suggested as pathogenic in ASD [<xref rid="bib14" ref-type="bibr">14</xref>]. Notably, although these <italic>indexcov</italic> analyses were performed blind to all prior genetic knowledge for these samples, all of the sex aneuploidies discovered by <italic>indexcov</italic> had been previously discovered by an earlier analysis of these samples using SNP microarray [<xref rid="bib15" ref-type="bibr">15</xref>], thereby demonstrating that <italic>indexcov</italic> can accurately detect sex chromosome anomalies also corroborated by preexisting methods. Finally, a single sample appears just below X = 0, Y = 0, which was the result of a truncated BAM index. While this sample issue was easily resolved by re-indexing the original BAM file, it serves as a valuable example of technical problems that can be identified by <italic>indexcov</italic>. While <italic>indexcov</italic> natively assumes that the sex chromosomes are X and Y, the user can also override these defaults when necessary, such as for non-human organisms or alternative reference assemblies.</p>
      <fig id="fig3" orientation="portrait" position="float">
        <label>Figure 3:</label>
        <caption>
          <p>Sex inference plot for a cohort of 2076 human WGS samples analyzed with <italic>indexcov</italic>. Samples projected on this plot represent ∼30–40× human WGS from 519 “quartet” families recently analyzed as a study of simplex autism [<xref rid="bib13" ref-type="bibr">13</xref>]. The x-axis shows the copy number for chrX, and the y-axis shows the copy number for chrY inferred by <italic>indexcov</italic>. Sex is inferred from the copy number of X. As expected, we see 2 dominant clusters of samples, 1 of males (X = 1 and Y = 1) and 1 of females (X = 2 and Y = 0). Notably, <italic>indexcov</italic> further identifies samples with supernumerary sex chromosome aneuploidies (XXY and XYY), which had previously been identified by SNP microarray analysis [<xref rid="bib15" ref-type="bibr">15</xref>]. The green point in the lower left just below the origin represents a sample with no apparent coverage on chromosomes X or Y due to a truncated BAM index file, which can be rapidly corrected once identified by <italic>indexcov</italic> QC.</p>
        </caption>
        <graphic xlink:href="gix090fig3"/>
      </fig>
    </sec>
    <sec id="sec2-5">
      <title>Sequencing batch effect detection with principal component analysis</title>
      <p><italic>Indexcov</italic> uses principal component analysis (PCA) to identify batch effects or other major discrepancies among groups of WGS samples. As <italic>indexcov</italic> creates the coverage plots for each chromosome, it simultaneously appends a large array for each sample that contains the scaled coverage values for the entire genome. Once all chromosomes are completed, <italic>indexcov</italic> performs PCA on the scaled coverage values and projects all samples onto the first 5 principal components, finally outputting 2 PCA plots: the first and second principal components, and the first and third principal components. PCA visualization enables the detection of fundamental differences in sets of samples, such as WGS samples that were sequenced with or without PCR amplification (<xref ref-type="supplementary-material" rid="sup7">Supplemental Fig. S1</xref>).</p>
    </sec>
    <sec id="sec2-6">
      <title>Identifying aberrant genome-wide coverage profiles</title>
      <p>While calculating scaled coverage for each chromosome, <italic>indexcov</italic> tallies several other informative metrics. First, it measures the proportion of 16-kb tiles that had a scaled coverage between 0.85 and 1.15, as well as scaled coverage &lt;0.15 or &gt;1.15. In our experience, these simple cutoffs work well to differentiate samples with highly aberrant coverage anomalies from normal, uniformly covered samples, although we have also found that the results are quite stable even when the cutoffs are changed moderately (data not shown). The resulting “tile plots” convey the proportion of low values (&lt;0.15) vs the proportion of tiles with values outside of 0.85–1.15. An example application of this approach is illustrated in Fig. <xref ref-type="fig" rid="fig4">4</xref> for the same cohort of 2076 WGS samples shown in Fig. <xref ref-type="fig" rid="fig3">3</xref>. This method highlights a single sample with a very large value on the x-axis, indicating that it is missing data for many tiles. In fact, this plot led us to realize that the BAM index for that sample had been truncated.</p>
      <fig id="fig4" orientation="portrait" position="float">
        <label>Figure 4:</label>
        <caption>
          <p>Proportion of 16 384-bp bins where the estimated coverage is less than 0.15 on the x-axis and outside of (0.85–1.15) on the y-axis among 2076 human WGS samples. High values on the x-axis indicate large areas with low or no coverage. Values on the y-axis indicate samples with a large bias—with high variance in coverage values. Note that the samples that were PCR-amplified (red) as part of the sample-preparation are generally more likely to have a higher proportion of bins outside of the expected (0.85–1.15) range.</p>
        </caption>
        <graphic xlink:href="gix090fig4"/>
      </fig>
    </sec>
    <sec id="sec2-7">
      <title>Interactive visualization</title>
      <p>To facilitate visualization and rapid sample quality control, <italic>indexcov</italic> aggregates all of the output plots into a single, integrated HTML file. Because web browsers struggle to plot highly complex data sets, <italic>indexcov</italic> also generates an overview page that contains static thumbnail images of per-chromosome data. When a user clicks on a thumbnail of interest, she is taken to the full, interactive version of that chromosome plot. In most cases, it will be clear from the thumbnail that there is nothing of interest in that chromosome, so more detailed exploration will not be needed.</p>
      <p>The overview page is laid out such that the “sex plot” (e.g., Fig. <xref ref-type="fig" rid="fig3">3</xref>) and the “tile plot” (e.g., Fig. <xref ref-type="fig" rid="fig4">4</xref>) are at the top, since these visualizations have the highest information density and are therefore most likely to be immediately useful to the user. If there are major problems with the coverage profiles across an entire cohort, it will be immediately visible from these plots. Subsequently, the PCA plots for batch effects are displayed along with hyperlinks to download the tab-delimited text files reflecting the raw output of <italic>indexcov</italic>. These raw data files include a BGZIP’ed [<xref rid="bib16" ref-type="bibr">16</xref>] BED file containing the scaled coverage for each sample for each 16 384-base tile, as well as a pedigree (PED) file that contains each sample, its inferred sex, the estimated copy number for the sex chromosomes, the first 5 principal components, and the tile statistics described above.</p>
      <p>Finally, the overview page displays sample coverage profiles across the genome. For each chromosome, we display a static image of the coverage distribution plot (e.g., Fig. <xref ref-type="fig" rid="fig2">2</xref>B), as well as a static image of relative depth along the chromosome (e.g., Fig. <xref ref-type="fig" rid="fig2">2</xref>A). When a user clicks on either static image for a given chromosome, they are taken to the interactive version of that plot so that they can hover to see outliers or features of interest. A live, interactive example of the resulting HTML output of <italic>indexcov</italic> is available at [<xref rid="bib17" ref-type="bibr">17</xref>]. Each section in the page includes a link to a help document describing the plot type in that section.</p>
    </sec>
    <sec id="sec2-8">
      <title>Speed and scaling</title>
      <p>Since <italic>indexcov</italic> must keep each index in memory, memory use scales linearly with the number of sample files and the reference genome size. On a standard server, <italic>indexcov</italic> completed an analysis of 45 human WGS BAM files at 60× coverage in about 45 seconds. We have run <italic>indexcov</italic> on cohorts as large as 2076 samples, and <italic>indexcov</italic> users have reported similar performance in analyses of cohorts at least twice this size. We have made attempts to reduce the memory usage as much as possible. For example, we use only 1 byte per scaled coverage value for each sample that we accumulate for cohort-wide PCA. Since we are focused on large deviations, the memory reduction afforded by using a single byte instead of 4 or 8 is worth the loss in precision. For ∼2000 samples, <italic>indexcov</italic> will require about 30 minutes and about 60 gb of memory. We present the speed as an approximation since it will largely be determined by the I/O speed of the storage disk. In addition, the memory use will also vary depending on the collection characteristics of the Go programming language's memory garbage collector.</p>
    </sec>
    <sec id="sec2-9">
      <title>Installation and invocation</title>
      <p><italic>Indexcov</italic> is available for download as a static binary executable for all major platforms [<xref rid="bib18" ref-type="bibr">18</xref>]. It is extremely simple to use, as its sole inputs are a list of BAM files for the relevant samples (from which it automatically locates the associated indexes), as well as the directory to which the BED and HTML output should be written. An example usage for a set of BAMs would look like:
<disp-quote><p>goleft indexcov -d output-dir/ inputs/*.bam</p></disp-quote>and for CRAMs:
<disp-quote><p>goleft indexcov -fai $fasta.fai -d output-dir/ inputs/*.crai</p></disp-quote></p>
    </sec>
  </sec>
  <sec sec-type="conclusions" id="sec3">
    <title>Conclusion</title>
    <p><italic>Indexcov</italic> enables coverage profiling at low computational cost, provides an interactive output that facilitates the detection of coverage anomalies such as aneuploidies, megabase-scale deletions and duplications, and sex chromosome anomalies. We demonstrate that it is very effective for typical WGS data sets generated by short-read DNA sequencing technologies. The lower throughput of long-read sequencing technologies will result in fewer alignments per 16-kb bin, and therefore sampling error will confound accurate depth estimates. However, we anticipate that improved throughput and future method development will address this limitation. We emphasize that this approach is amenable to whole-genome sequencing data sets from any species, and as such, while it does not replace the need for accurate coverage calculated by parsing the actual alignments, it represents an important and simple-to-use quality control step.</p>
  </sec>
  <sec id="sec4">
    <title>Availability of supporting source code and requirements</title>
    <p>Project name: <italic>indexcov</italic></p>
    <p>Project home page: <ext-link ext-link-type="uri" xlink:href="https://github.com/brentp/goleft/tree/master/indexcov">https://github.com/brentp/goleft/tree/master/indexcov</ext-link></p>
    <p>Operating system(s): platform independent</p>
    <p>Programming language: Go</p>
    <p>Other requirements: none</p>
    <p>License: MIT</p>
    <p>An archival copy of the code is also available via the <italic>GigaScience</italic> repository, <italic>Giga</italic>DB [<xref rid="bib19" ref-type="bibr">19</xref>].</p>
  </sec>
  <sec id="sec5">
    <title>Additional file</title>
    <p>Supplemental Figure 1: For the 2076 samples from the Simons Simplex Autism cohort, we plot the first 2 principal components. Samples that were prepared with a PCR-free method are shown in red, with the remaining samples in gray. We see that the samples that had a PCR step have a much greater spread in the principal component values due to the greater variation in genomic coverage resulting from PCR amplification prior to sequencing [<xref rid="bib11" ref-type="bibr">11</xref>].</p>
  </sec>
  <sec id="sec6">
    <title>Abbreviations</title>
    <p>bp: base-pairs; CNV: copy number variation; Mb: megabase; PCA: principal component analysis; QC: quality-control; SNP: single-nucleotide polymorphism; SV: structural variation; WGS: Whole-genome sequencing.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material content-type="local-data" id="sup1">
      <label>GIGA-D-17-00162_Original-Submission.pdf</label>
      <media xlink:href="gix090_giga-d-17-00162_original-submission.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="sup2">
      <label>GIGA-D-17-00162_Revision-1.pdf</label>
      <media xlink:href="gix090_giga-d-17-00162_revision-1.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="sup3">
      <label>Response-to-Reviewer-Comments_Original-Submission.pdf</label>
      <media xlink:href="gix090_response-to-reviewer-comments_original-submission.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="sup4">
      <label>Reviewer-1-Report-(Original-Submission).pdf</label>
      <media xlink:href="gix090_reviewer-1-report-(original-submission).pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="sup5">
      <label>Reviewer-2-Report-(Original-Submission).pdf</label>
      <media xlink:href="gix090_reviewer-2-report-(original-submission).pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="sup6">
      <label>Reviewer-2-Report-(Revision-1).pdf</label>
      <media xlink:href="gix090_reviewer-2-report-(revision-1).pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="sup7">
      <label>Supplementary Figure</label>
      <media xlink:href="gix090_supp.docx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <title>Acknowledgements</title>
    <p>We thank the Autism Sequencing Consortium's Whole Genome Sequencing Working Group for their contributions in processing the WGS data from the Simons Simplex Autism cohort. This research was supported by US National Institute of Health awards to A.Q. (NIH R01HG006693, NIH U24CA209999).</p>
  </ack>
  <ref-list>
    <title>References</title>
    <ref id="bib1">
      <label>1.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Li</surname><given-names>H</given-names></name>, <name name-style="western"><surname>Handsaker</surname><given-names>B</given-names></name>, <name name-style="western"><surname>Wysoker</surname><given-names>A</given-names></name><etal/></person-group><article-title>The Sequence Alignment/Map format and SAMtools</article-title>. <source>Bioinformatics</source><year>2009</year>;<volume>25</volume>:<fpage>2078</fpage>–<lpage>9</lpage>.<pub-id pub-id-type="pmid">19505943</pub-id></mixed-citation>
    </ref>
    <ref id="bib2">
      <label>2.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><collab>Samtools</collab></person-group><comment><ext-link ext-link-type="uri" xlink:href="https://samtools.github.io/hts-specs/CRAMv3.pdf">https://samtools.github.io/hts-specs/CRAMv3.pdf</ext-link>. Accessed 27 May 2017</comment>.</mixed-citation>
    </ref>
    <ref id="bib3">
      <label>3.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Meynert</surname><given-names>AM</given-names></name>, <name name-style="western"><surname>Bicknell</surname><given-names>LS</given-names></name>, <name name-style="western"><surname>Hurles</surname><given-names>ME</given-names></name><etal/></person-group><article-title>Quantifying single nucleotide variant detection sensitivity in exome sequencing</article-title>. <source>BMC Bioinformatics</source><year>2013</year>;<volume>14</volume>:<fpage>195</fpage>.<pub-id pub-id-type="pmid">23773188</pub-id></mixed-citation>
    </ref>
    <ref id="bib4">
      <label>4.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Layer</surname><given-names>RM</given-names></name>, <name name-style="western"><surname>Chiang</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Quinlan</surname><given-names>AR</given-names></name><etal/></person-group><article-title>LUMPY: a probabilistic framework for structural variant discovery</article-title>. <source>Genome Biol</source><year>2014</year>;<volume>15</volume>:<fpage>R84</fpage>.<pub-id pub-id-type="pmid">24970577</pub-id></mixed-citation>
    </ref>
    <ref id="bib5">
      <label>5.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Alkan</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Coe</surname><given-names>BP</given-names></name>, <name name-style="western"><surname>Eichler</surname><given-names>EE</given-names></name></person-group><article-title>Genome structural variation discovery and genotyping</article-title>. <source>Nat Rev Genet</source><year>2011</year>;<volume>12</volume>:<fpage>363</fpage>–<lpage>76</lpage>.<pub-id pub-id-type="pmid">21358748</pub-id></mixed-citation>
    </ref>
    <ref id="bib6">
      <label>6.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Miller</surname><given-names>CA</given-names></name>, <name name-style="western"><surname>Qiao</surname><given-names>Y</given-names></name>, <name name-style="western"><surname>Disera</surname><given-names>T</given-names></name><etal/></person-group><article-title>bam.iobio: a web-based, real-time, sequence alignment file inspector</article-title>. <source>Nat Methods</source><year>2014</year>;<volume>11</volume>:<fpage>1189</fpage>.<pub-id pub-id-type="pmid">25423016</pub-id></mixed-citation>
    </ref>
    <ref id="bib7">
      <label>7.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Quinlan</surname><given-names>AR</given-names></name>, <name name-style="western"><surname>Hall</surname><given-names>IM</given-names></name></person-group><article-title>BEDTools: a flexible suite of utilities for comparing genomic features</article-title>. <source>Bioinformatics</source><year>2010</year>;<volume>26</volume>:<fpage>841</fpage>–<lpage>2</lpage>.<pub-id pub-id-type="pmid">20110278</pub-id></mixed-citation>
    </ref>
    <ref id="bib8">
      <label>8.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Leek</surname><given-names>JT</given-names></name>, <name name-style="western"><surname>Scharpf</surname><given-names>RB</given-names></name>, <name name-style="western"><surname>Bravo</surname><given-names>HC</given-names></name><etal/></person-group><article-title>Tackling the widespread and critical impact of batch effects in high-throughput data</article-title>. <source>Nat Rev Genet</source><year>2010</year>;<volume>11</volume>:<fpage>733</fpage>–<lpage>9</lpage>.<pub-id pub-id-type="pmid">20838408</pub-id></mixed-citation>
    </ref>
    <ref id="bib9">
      <label>9.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Kortschak</surname><given-names>RD</given-names></name>, <name name-style="western"><surname>Pedersen</surname><given-names>BS</given-names></name>, <name name-style="western"><surname>Adelson</surname><given-names>DL</given-names></name></person-group><article-title>bíogo/hts: high throughput sequence handling for the Go language</article-title>. <source>J Open Source Softw</source><year>2017</year><comment><ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.21105/joss.00168">http://dx.doi.org/10.21105/joss.00168</ext-link></comment>.</mixed-citation>
    </ref>
    <ref id="bib10">
      <label>10.</label>
      <mixed-citation publication-type="journal"><comment><ext-link ext-link-type="ftp" xlink:href="ftp://ftp.sra.ebi.ac.uk/vol1/ERA172/ERA172924/bam/NA12878_S1.bam">ftp://ftp.sra.ebi.ac.uk/vol1/ERA172/ERA172924/bam/NA12878_S1.bam</ext-link>. Accessed August 2017</comment>.</mixed-citation>
    </ref>
    <ref id="bib11">
      <label>11.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Li</surname><given-names>H</given-names></name></person-group><article-title>Toward better understanding of artifacts in variant calling from high-coverage samples</article-title>. <source>Bioinformatics</source><year>2014</year>;<volume>30</volume>:<fpage>2843</fpage>–<lpage>51</lpage>.<pub-id pub-id-type="pmid">24974202</pub-id></mixed-citation>
    </ref>
    <ref id="bib12">
      <label>12.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Benjamini</surname><given-names>Y</given-names></name>, <name name-style="western"><surname>Speed</surname><given-names>TP</given-names></name></person-group><article-title>Summarizing and correcting the GC content bias in high-throughput sequencing</article-title>. <source>Nucleic Acids Res</source><year>2012</year>;<volume>40</volume>:<fpage>e72</fpage>.<pub-id pub-id-type="pmid">22323520</pub-id></mixed-citation>
    </ref>
    <ref id="bib13">
      <label>13.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Werling</surname><given-names>DM.</given-names></name></person-group><article-title>Limited contribution of rare, noncoding variation to autism spectrum disorder from sequencing of 2076 genomes in quartet families</article-title>. <source>bioRxiv</source><year>2017</year>;<fpage>127043</fpage><comment>doi:10.1101/127043.</comment></mixed-citation>
    </ref>
    <ref id="bib14">
      <label>14.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Lee</surname><given-names>NR</given-names></name>, <name name-style="western"><surname>Wallace</surname><given-names>GL</given-names></name>, <name name-style="western"><surname>Adeyemi</surname><given-names>EI</given-names></name><etal/></person-group><article-title>Dosage effects of X and Y chromosomes on language and social functioning in children with supernumerary sex chromosome aneuploidies: implications for idiopathic language impairment and autism spectrum disorders</article-title>. <source>J Child Psychol Psychiatry</source><year>2012</year>;<volume>53</volume>:<fpage>1072</fpage>–<lpage>81</lpage>.<pub-id pub-id-type="pmid">22827287</pub-id></mixed-citation>
    </ref>
    <ref id="bib15">
      <label>15.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Sanders</surname><given-names>SJ</given-names></name>, <name name-style="western"><surname>He</surname><given-names>X</given-names></name>, <name name-style="western"><surname>Willsey</surname><given-names>AJ</given-names></name><etal/></person-group><article-title>Insights into autism spectrum disorder genomic architecture and biology from 71 risk loci</article-title>. <source>Neuron</source><year>2015</year>;<volume>87</volume>:<fpage>1215</fpage>–<lpage>33</lpage>.<pub-id pub-id-type="pmid">26402605</pub-id></mixed-citation>
    </ref>
    <ref id="bib16">
      <label>16.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Li</surname><given-names>H</given-names></name></person-group><article-title>Tabix: fast retrieval of sequence features from generic TAB-delimited files</article-title>. <source>Bioinformatics</source><year>2011</year>;<volume>27</volume>:<fpage>718</fpage>–<lpage>9</lpage>.<pub-id pub-id-type="pmid">21208982</pub-id></mixed-citation>
    </ref>
    <ref id="bib17">
      <label>17.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Brent S</surname><given-names>Pedersen</given-names></name></person-group><comment><ext-link ext-link-type="uri" xlink:href="http://bit.ly/indexcov-example">http://bit.ly/indexcov-example</ext-link>, Accessed August 2017</comment>.</mixed-citation>
    </ref>
    <ref id="bib18">
      <label>18.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Brent S</surname><given-names>Pedersen</given-names></name></person-group><comment><ext-link ext-link-type="uri" xlink:href="https://github.com/brentp/goleft">https://github.com/brentp/goleft</ext-link>. Accessed August 2017</comment>.</mixed-citation>
    </ref>
    <ref id="bib19">
      <label>19.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Pedersen</surname><given-names>BS</given-names></name>, <name name-style="western"><surname>Collins</surname><given-names>RL</given-names></name>, <name name-style="western"><surname>Talkowski</surname><given-names>ME</given-names></name><etal/></person-group><article-title>Supporting software for “Indexcov: fast coverage quality control for whole-genome sequencing.”</article-title><source>GigaScience</source><comment>Database</comment><year>2017</year><comment><ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.5524/100349">http://dx.doi.org/10.5524/100349</ext-link></comment>.</mixed-citation>
    </ref>
  </ref-list>
</back>
