<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Nat Commun</journal-id>
    <journal-id journal-id-type="iso-abbrev">Nat Commun</journal-id>
    <journal-title-group>
      <journal-title>Nature Communications</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2041-1723</issn>
    <publisher>
      <publisher-name>Nature Publishing Group UK</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10202958</article-id>
    <article-id pub-id-type="pmid">37217540</article-id>
    <article-id pub-id-type="publisher-id">38553</article-id>
    <article-id pub-id-type="doi">10.1038/s41467-023-38553-y</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Reference-free assembly of long-read transcriptome sequencing data with RNA-Bloom2</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-1574-3363</contrib-id>
        <name>
          <surname>Nip</surname>
          <given-names>Ka Ming</given-names>
        </name>
        <address>
          <email>kmnip@bcgsc.ca</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0003-0553-9227</contrib-id>
        <name>
          <surname>Hafezqorani</surname>
          <given-names>Saber</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-5975-0805</contrib-id>
        <name>
          <surname>Gagalova</surname>
          <given-names>Kristina K.</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-2215-5535</contrib-id>
        <name>
          <surname>Chiu</surname>
          <given-names>Readman</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-5144-7748</contrib-id>
        <name>
          <surname>Yang</surname>
          <given-names>Chen</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-9890-2293</contrib-id>
        <name>
          <surname>Warren</surname>
          <given-names>René L.</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0003-0950-7839</contrib-id>
        <name>
          <surname>Birol</surname>
          <given-names>Inanc</given-names>
        </name>
        <address>
          <email>ibirol@bcgsc.ca</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="GRID">grid.434706.2</institution-id><institution-id institution-id-type="ISNI">0000 0004 0410 5424</institution-id><institution>Canada’s Michael Smith Genome Sciences Centre, BC Cancer, </institution></institution-wrap>Vancouver, BC V5Z 4S6 Canada </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="GRID">grid.17091.3e</institution-id><institution-id institution-id-type="ISNI">0000 0001 2288 9830</institution-id><institution>Bioinformatics Graduate Program, </institution><institution>University of British Columbia, </institution></institution-wrap>Vancouver, BC V5Z 4S6 Canada </aff>
      <aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="GRID">grid.17091.3e</institution-id><institution-id institution-id-type="ISNI">0000 0001 2288 9830</institution-id><institution>Department of Medical Genetics, </institution><institution>University of British Columbia, </institution></institution-wrap>Vancouver, BC V6T 1Z3 Canada </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>22</day>
      <month>5</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>22</day>
      <month>5</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2023</year>
    </pub-date>
    <volume>14</volume>
    <elocation-id>2940</elocation-id>
    <history>
      <date date-type="received">
        <day>7</day>
        <month>8</month>
        <year>2022</year>
      </date>
      <date date-type="accepted">
        <day>8</day>
        <month>5</month>
        <year>2023</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2023</copyright-statement>
      <license>
        <ali:license_ref specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p><bold>Open Access</bold> This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The images or other third party material in this article are included in the article’s Creative Commons license, unless indicated otherwise in a credit line to the material. If material is not included in the article’s Creative Commons license and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this license, visit <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <p id="Par1">Long-read sequencing technologies have improved significantly since their emergence. Their read lengths, potentially spanning entire transcripts, is advantageous for reconstructing transcriptomes. Existing long-read transcriptome assembly methods are primarily reference-based and to date, there is little focus on reference-free transcriptome assembly. We introduce “RNA-Bloom2 [<ext-link ext-link-type="uri" xlink:href="https://github.com/bcgsc/RNA-Bloom">https://github.com/bcgsc/RNA-Bloom</ext-link>]”, a reference-free assembly method for long-read transcriptome sequencing data. Using simulated datasets and spike-in control data, we show that the transcriptome assembly quality of RNA-Bloom2 is competitive to those of reference-based methods. Furthermore, we find that RNA-Bloom2 requires 27.0 to 80.6% of the peak memory and 3.6 to 10.8% of the total wall-clock runtime of a competing reference-free method. Finally, we showcase RNA-Bloom2 in assembling a transcriptome sample of <italic>Picea sitchensis</italic> (Sitka spruce). Since our method does not rely on a reference, it further sets the groundwork for large-scale comparative transcriptomics where high-quality draft genome assemblies are not readily available.</p>
    </abstract>
    <abstract id="Abs2" abstract-type="web-summary">
      <p id="Par2">Most existing long-read transcriptome assembly methods rely on reference genomes and transcript annotations, while reference-free methods remain scarce. Here, Nip et al. introduce RNA-Bloom2, a reference-free method that requires substantially less memory and runtime than other reference-free methods.</p>
    </abstract>
    <kwd-group kwd-group-type="npg-subject">
      <title>Subject terms</title>
      <kwd>Software</kwd>
      <kwd>Genome informatics</kwd>
      <kwd>Data processing</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">https://doi.org/10.13039/501100000038</institution-id>
            <institution>Gouvernement du Canada | Natural Sciences and Engineering Research Council of Canada (Conseil de Recherches en Sciences Naturelles et en Génie du Canada)</institution>
          </institution-wrap>
        </funding-source>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">https://doi.org/10.13039/501100000233</institution-id>
            <institution>Genome British Columbia</institution>
          </institution-wrap>
        </funding-source>
        <award-id>(243FOR</award-id>
        <principal-award-recipient>
          <name>
            <surname>Birol</surname>
            <given-names>Inanc</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">https://doi.org/10.13039/100008762</institution-id>
            <institution>Genome Canada (Génome Canada)</institution>
          </institution-wrap>
        </funding-source>
        <award-id>(243FOR</award-id>
        <principal-award-recipient>
          <name>
            <surname>Birol</surname>
            <given-names>Inanc</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">https://doi.org/10.13039/501100000024</institution-id>
            <institution>Gouvernement du Canada | Canadian Institutes of Health Research (Instituts de Recherche en Santé du Canada)</institution>
          </institution-wrap>
        </funding-source>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">https://doi.org/10.13039/100000002</institution-id>
            <institution>U.S. Department of Health &amp; Human Services | National Institutes of Health (NIH)</institution>
          </institution-wrap>
        </funding-source>
        <award-id>2R01HG007182-04A1</award-id>
        <principal-award-recipient>
          <name>
            <surname>Birol</surname>
            <given-names>Inanc</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© Springer Nature Limited 2023</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1" sec-type="introduction">
    <title>Introduction</title>
    <p id="Par3">RNA sequencing (RNA-seq) has become the standard method for gene/transcript discovery, transcriptome profiling, and isoform expression quantification. Since the dawn of high-throughput short-read sequencing technologies, transcriptome assemblies have enabled the discovery of novel isoforms<sup><xref ref-type="bibr" rid="CR1">1</xref></sup>, identification of foreign RNAs<sup><xref ref-type="bibr" rid="CR2">2</xref></sup>, intra-species gene-fusion transcripts<sup><xref ref-type="bibr" rid="CR3">3</xref></sup> and inter-species chimeric transcripts<sup><xref ref-type="bibr" rid="CR4">4</xref>,<xref ref-type="bibr" rid="CR5">5</xref></sup>, and guided scaffolding<sup><xref ref-type="bibr" rid="CR6">6</xref></sup> and annotation of draft genome assemblies. Such applications have been key in enhancing our understanding of genome biology and the etiology and progression of various diseases.</p>
    <p id="Par4">Pacific Biosciences of California, Inc. (PacBio, Menlo Park, CA) and Oxford Nanopore Technologies PLC (ONT, Oxford, UK) have been offering long-read sequencing technologies commercially since 2011 and 2014, respectively. Both sequencing technologies have improved significantly since their emergence to yield increased read length, base accuracy, and throughput<sup><xref ref-type="bibr" rid="CR7">7</xref></sup>. In particular, ONT’s MinION devices are small and portable, thus having the potential to allow rapid sequencing and downstream analyses<sup><xref ref-type="bibr" rid="CR8">8</xref></sup>. Moreover, nanopore sequencing enables direct RNA (dRNA) sequencing without the need to generate complementary DNA (cDNA) libraries<sup><xref ref-type="bibr" rid="CR9">9</xref></sup>. On the other hand, PacBio’s single-molecule-real-time (SMRT) sequencing provides circular consensus sequencing (CCS) to produce reads that have a lower base error rate than that of ONT reads<sup><xref ref-type="bibr" rid="CR10">10</xref></sup>. As a result, the number of computational methods designed for processing and analyzing long-read sequencing data is growing rapidly<sup><xref ref-type="bibr" rid="CR7">7</xref></sup>.</p>
    <p id="Par5">Compared to Illumina short-read sequencing technologies, long reads are noisier but are several orders of magnitude longer, making them able to span through multiple exons and even capture full-length transcripts in some instances, thus simplifying the transcriptome assembly problem. However, existing transcriptome assemblers, such as StringTie2<sup><xref ref-type="bibr" rid="CR11">11</xref></sup>, are predominantly reference-based where transcripts are derived from spliced-alignment of reads against the reference genome. Genome annotations contain rich information about gene structures that may be utilized for guiding reference-based transcriptome assembly; some examples include: refinement of spliced-alignment based on known splice junctions, inference of transcript strand based on annotated gene orientation, and resolution for antisense transcripts based on known transcription start and end sites. Consequently, a subclass of reference-based assemblers, such as FLAIR<sup><xref ref-type="bibr" rid="CR12">12</xref></sup>, require a genome annotation in addition to the reference genome for accurate isoform reconstruction. Similarly, StringTie2 has the option of incorporating transcriptome annotation to aid its assembly process.</p>
    <p id="Par6">Reference-free assembly of transcriptomes is especially valuable when there is no available reference genome or the reference genome is still at the draft stage, which may not fully support the reference-based assembly of all transcripts in a given transcriptome sequencing sample. In general, long-read reference-free genome assembly algorithms such as wtdbg2<sup><xref ref-type="bibr" rid="CR13">13</xref></sup> (also known as Redbean) are not suitable for transcriptome data because they cannot reconstruct alternative isoforms and they typically assume a uniform sequencing depth, which is practically nonexistent in transcriptomic data due to varying transcript expression levels. Reference-free assembly methods typically rely on read-to-read mapping, whereas reference-based methods rely on read-to-reference alignments. Since read-to-read mapping is much more resource-intensive than read-to-reference alignment, reference-free methods tend to have a much higher computational cost than reference-based methods. To find wider applications, reference-free assembly algorithms need to overcome the challenges in managing computational resources.</p>
    <p id="Par7">Sequence clustering-based assembly follows the divide-and-conquer paradigm and thus it requires less resources than methods that align all reads against each other. RATTLE<sup><xref ref-type="bibr" rid="CR14">14</xref></sup> is an example of such a method, and to the best of our knowledge, it is the only reference-free transcriptome assembler that can assemble transcripts solely from long-read sequencing data. RATTLE clusters input reads into isoform-based (or gene-based) groupings and derives consensus sequences from each read cluster to reconstruct full-length transcripts. Nevertheless, clustering accuracy is an important factor in assembly quality and computational performance. A lenient clustering criterion would create few but large read clusters, resulting in slow runtime, high peak memory, and aggregation of reads from too many genes. A stringent clustering criterion, on the other hand, would create many small clusters, potentially resulting in insufficient aggregation of reads and incomplete transcript reconstruction.</p>
    <p id="Par8">Digital normalization<sup><xref ref-type="bibr" rid="CR15">15</xref></sup>, also known as in silico read normalization, is a simple but effective method to improve the computational performance of reference-free assemblers by reducing the number of overrepresented reads, such as those of high-expressed transcripts, based on the saturation of <italic>k</italic>-mers in the reads. In contrast to naive subsampling, digital normalization is better at preserving low-expression transcripts. However, it has been primarily utilized for the assembly of short-read RNA-seq data<sup><xref ref-type="bibr" rid="CR16">16</xref>,<xref ref-type="bibr" rid="CR17">17</xref></sup>. With the introduction of strobemers<sup><xref ref-type="bibr" rid="CR18">18</xref></sup> as a mismatch and indel tolerant alternative to <italic>k</italic>-mers, digital normalization with strobemers should be highly applicable to transcriptome assembly of noisy long reads.</p>
    <p id="Par9">Here we present RNA-Bloom2, the successor to our short-read transcriptome assembly tool, RNA-Bloom<sup><xref ref-type="bibr" rid="CR19">19</xref></sup>, that extends support for reference-free transcriptome assembly of bulk RNA long sequencing reads. RNA-Bloom2 offers both memory- and time-efficient assembly by utilizing digital normalization of long reads with strobemers. Our benchmarking shows that RNA-Bloom2 requires 27.0–80.6% of the peak memory and 3.6–10.8% of the total wall-clock runtime of RATTLE. In simulated datasets, RNA-Bloom2 has 1.5–7.3% higher recall and 0.3–1.5% lower false discovery rates than RATTLE. In the spike-in datasets, RNA-Bloom2 has 5.7–17.6% higher recall than RATTLE. Finally, we showcase RNA-Bloom2 in assembling a transcriptome sample of <italic>Picea sitchensis</italic> (Sitka spruce), without using a genomic reference.</p>
  </sec>
  <sec id="Sec2" sec-type="results">
    <title>Results</title>
    <sec id="Sec3">
      <title>Reference-free transcriptome assembly with RNA-Bloom2</title>
      <p id="Par10">RNA-Bloom2’s six-stage workflow for the reference-free transcriptome assembly of long reads is summarized in Fig. <xref rid="Fig1" ref-type="fig">1</xref>. In stage one, long reads are corrected for errors in an alignment-free approach based on a Bloom filter de Bruijn graph of <italic>k</italic>-mers derived from input reads. Short reads can be optionally provided to aid in the error correction of long reads. In stage two, the set of corrected reads is digitally normalized with strobemers, such that overrepresented reads are removed to yield a target read depth. Stages one and two are highly integrated to reduce input-output operations. Since only a portion of corrected reads would be retained by digital normalization, stage one is not meant to exhaustively correct all errors in the reads and is instead intended to be fast and memory-efficient. In stage three, reads in the normalized set are overlapped against each other to identify low-depth regions in the reads to be trimmed or split. In stage four, trimmed reads are overlapped against each other to generate an overlap graph where reads on each unambiguous path are assembled into a “unitig”. In stage five, the unitigs, which may still contain errors, are polished using the alignments of corrected reads from stage one. In stage six, the polished unitigs are aligned against each other to generate an overlap graph where transcripts are derived based on the length-normalized read depth of the unitigs. If the reads are produced by the cDNA sequencing protocol, sequences containing potential poly(A) tails are identified in order to prune the overlap graphs in stages four and six. A more detailed description of each stage is provided in the Methods section. It is important to note that all-versus-all sequence comparisons in RNA-Bloom2 are performed after digital normalization, as opposed to after sequence clustering as in RATTLE. Since the number of sequences retained after digital normalization is expected to be much lower than the number of raw input reads, sequence clustering is not necessary for RNA-Bloom2.<fig id="Fig1"><label>Fig. 1</label><caption><title>RNA-Bloom2 assembly workflow overview.</title><p>The long-read assembly workflow of RNA-Bloom2 consists of six stages. In stage 1, input long reads are corrected for errors using a de Bruijn graph, where erroneous <italic>k</italic>-mers (red circles) are replaced with <italic>k</italic>-mers of higher multiplicities (blue circles). The de Bruijn graph can optionally include <italic>k</italic>-mers from short reads if provided. In stage 2, corrected reads are digitally normalized to select a subset of reads (blue rectangles). In stage 3, normalized reads are trimmed and splitted at regions of low read depth (red rectangles). In stage 4, an overlap graph of trimmed reads is generated to assemble unambiguous paths into unitigs (blue paths). In stage 5, residual errors (red squares) in unitigs are polished using alignments of corrected reads from stage 1. In stage 6, an overlap graph of polished unitigs is generated to assemble alternative transcripts (orange and green paths).</p></caption><graphic xlink:href="41467_2023_38553_Fig1_HTML" id="d32e455"/></fig></p>
    </sec>
    <sec id="Sec4">
      <title>Evaluation of error correction and digital normalization</title>
      <p id="Par11">We evaluated the effectiveness of the error correction and digital normalization stages of RNA-Bloom2 using experimental data. We selected one mouse dataset from the Long-read RNA-Seq Genome Annotation Assessment Project (LRGASP) Consortium<sup><xref ref-type="bibr" rid="CR20">20</xref></sup> containing the matching sequencing data for ONT cDNA, ONT dRNA, PacBio CCS, and Illumina reads of the same biological sample (Supplementary Table <xref rid="MOESM1" ref-type="media">1</xref>). ONT dRNA and PacBio CCS reads do not contain adapters, but ONT cDNA reads and Illumina reads are trimmed for adapters with Pychopper<sup><xref ref-type="bibr" rid="CR21">21</xref></sup> and Trimmomatic<sup><xref ref-type="bibr" rid="CR22">22</xref></sup>, respectively (Supplementary Method <xref rid="MOESM1" ref-type="media">1</xref>). Out of the three long-read samples, the ONT cDNA sample has the largest number of sequencing reads (13,127,667 reads) but the lowest read alignment rate (78.66%) against the combined reference genome for mouse GRCm39 and Lexogen’s Spike-In RNA Variant (SIRV) transcripts<sup><xref ref-type="bibr" rid="CR23">23</xref></sup> from the LRGASP consortium (Synapse accession “<ext-link ext-link-type="uri" xlink:href="https://www.synapse.org/#!Synapse:syn25683365">syn25683365</ext-link>”). Compared to the ONT cDNA sample, the ONT dRNA and PacBio CCS samples have only one-sixth of the reads (2,153,439 reads and 2,144,172 reads, respectively) but higher read alignment rates (95.58% and 95.49%, respectively) against the reference genome. The Illumina sample has 40,225,298 read pairs (2 × 100 nucleotides (nt)) and is only used for the hybrid error correction of the long reads in RNA-Bloom2.</p>
      <p id="Par12">We first assess both methods of alignment-free error correction in RNA-Bloom2: (i) using only long reads, and (ii) using a hybrid of long and short reads. We investigated the nucleotide base error rates of the reads before and after error correction (Supplementary Table <xref rid="MOESM1" ref-type="media">2</xref>); error rates are measured by Trans-NanoSim<sup><xref ref-type="bibr" rid="CR24">24</xref></sup> (Supplementary Method <xref rid="MOESM1" ref-type="media">2</xref>). The error rates of the reads before error correction in the ONT dRNA, ONT cDNA, and PacBio CCS samples are 12.17%, 7.18%, and 1.96%, respectively. Long-read-only error correction has reduced the error rates to 10.28%, 4.03%, and 1.35% for the ONT dRNA, ONT cDNA, and PacBio CCS samples, respectively. As expected, hybrid error correction has resulted in even lower error rates of 6.55%, 3.51%, and 1.34% for the ONT dRNA, ONT cDNA, and PacBio CCS samples, respectively. Long-read-only error correction has the largest reduction (−3.15%) in the error rate in the ONT cDNA sample, whereas hybrid error correction has the largest reduction (−5.62%) in the error rate in the ONT dRNA sample.</p>
      <p id="Par13">We next investigated the percentage of reads remaining after digital normalization and the percentage of input reads aligned to the final assembly (Supplementary Table <xref rid="MOESM1" ref-type="media">3</xref>, Supplementary Method <xref rid="MOESM1" ref-type="media">3</xref>). For assemblies with long-read-only error correction, 48.15%, 3.76%, and 11.66% of reads remained after digital normalization in the ONT dRNA, ONT cDNA, and PacBio CCS samples, respectively. For assemblies with hybrid error correction, 38.80%, 3.53%, and 11.63% of reads remained after digital normalization in the ONT dRNA, ONT cDNA, and PacBio CCS samples, respectively. The ONT dRNA assemblies have the highest percentages of reads remaining after digital normalization. This is likely due to the much higher error rate in the reads, which limits the number of matching strobemers among the reads. Despite the fact that a substantial proportion of reads are removed by digital normalization, 97.44–97.54% and 95.04–95.16% of input reads are still able to align to the final assemblies for the ONT dRNA and PacBio CCS samples, respectively. Although 73.52–74.02% of input reads aligned the final assembly for the ONT cDNA sample, it is important to note that only 78.66% of reads in the sample were aligned against the reference genome. These results confirm that digital normalization in RNA-Bloom2 is effective in removing overrepresented reads from long-read transcriptome sequencing data.</p>
      <p id="Par14">Finally, we assess how well digital normalization preserves the number of genes represented in reads, using the same experimental samples as before. For a given set of reads, the number of represented genes is defined as the number of genes with expression levels above zero (Supplementary Method <xref rid="MOESM1" ref-type="media">9</xref>). The results are summarized in Supplementary Table <xref rid="MOESM1" ref-type="media">4</xref>. Overall, the number of genes represented in the digitally normalized reads is 95.6–98.3% of those in the raw reads. It is important to note that error correction already lowers the gene representation (due to filtering of reads with low <italic>k</italic>-mer multiplicities) prior to digital normalization. In general, the majority of genes discarded are very lowly expressed, and their expression levels are predominantly lower than those of genes retained (See Supplementary Table <xref rid="MOESM1" ref-type="media">13</xref>). Since only a small proportion of reads remains after digital normalization, the 1.7–4.4% reduction in gene representation is within our expectations.</p>
    </sec>
    <sec id="Sec5">
      <title>Assembly benchmarking with simulated datasets</title>
      <p id="Par15">We benchmarked the assembly quality and the computational performance of RNA-Bloom2 on simulated data. Assembly quality is measured based on the metrics described in Table <xref rid="Tab1" ref-type="table">1</xref>. The assembly evaluation procedure is described in the Methods section. We prepared two mouse-simulated datasets with Trans-NanoSim<sup><xref ref-type="bibr" rid="CR24">24</xref></sup> for the cDNA and dRNA sequencing protocols modeled on experimental ONT data (See Methods). To investigate the effect of sequencing depth, we subsampled each dataset to 2, 10, and 18 million reads, resulting in a total of six sets of reads for our benchmarking experiments. The features of the simulated datasets are presented in Supplementary Table <xref rid="MOESM1" ref-type="media">5</xref>. Compared to the cDNA dataset, the dRNA dataset has a higher error rate, longer N50 read length, and fewer simulated transcripts.<table-wrap id="Tab1"><label>Table 1</label><caption><p>Transcriptome assembly quality assessment metrics</p></caption><table frame="hsides" rules="groups"><thead><tr><th>Metric</th><th>Definition</th></tr></thead><tbody><tr><td>Complete reconstruction</td><td>Truth set transcript reconstructed at least 95% in length</td></tr><tr><td>Partial reconstruction</td><td>Truth set transcript reconstructed between 0 and 95% in length</td></tr><tr><td>Missing reconstruction or false negative (FN)</td><td>Truth set transcript with no detectable reconstruction</td></tr><tr><td>True positive (TP)</td><td>Truth set transcript with complete or partial reconstruction</td></tr><tr><td>False positive (FP)</td><td>Reference transcript not in the truth set</td></tr><tr><td>Misassembly (MA)</td><td>Incorrectly assembled contig with segments from one or more reference transcripts. It can be intragenic or intergenic.</td></tr><tr><td>Intragenic misassembly</td><td>Incorrectly assembled contig with segments from reference transcripts of the same gene</td></tr><tr><td>Intergenic misassembly</td><td>Incorrectly assembled contig with segments from reference transcripts of different genes</td></tr><tr><td>Large indel (LI)</td><td>Contigs with at least one large indel (&gt; 70 nt) compared to the best-aligning reference transcript. Large indels can arise from sequencing errors, alternative donors/acceptors, skipped exons, and retained introns.</td></tr><tr><td>Unclassified (UC)</td><td>Contigs with no alignments against reference transcripts. These contigs can arise from noise or incorrect error correction.</td></tr><tr><td>Recall</td><td>Percentage of truth set transcripts reconstructed.</td></tr><tr><td>False discoveries (FD)</td><td>= FP + MA + LI + UC</td></tr><tr><td>False discovery rate (FDR)</td><td>= FD / (FD + TP)</td></tr><tr><td>F1</td><td>= TP / [TP + 0.5 * (FD + FN)]</td></tr><tr><td>Redundancy</td><td>= (contigs representing TP) / TP</td></tr></tbody></table><table-wrap-foot><p>These metrics are intended for sequencing data with a known ground truth where true-positives and false-positives can be easily discerned. The truth set transcripts are either the set of simulated transcripts or the set of spike-in transcripts in real data.</p></table-wrap-foot></table-wrap></p>
      <p id="Par16">Using the two-million simulated read sets, we illustrate the value of reference-free transcriptome assembly by comparing RNA-Bloom2 against isONcorrect<sup><xref ref-type="bibr" rid="CR25">25</xref></sup>, which is an error-correction tool designed for ONT transcriptome data. Commands for running both tools are described in Supplementary Method <xref rid="MOESM1" ref-type="media">10</xref>. We evaluated the number of complete transcripts and false discoveries detected for both tools (Supplementary Fig. <xref rid="MOESM1" ref-type="media">1</xref>). For cDNA data, output reads of isONcorrect have 7104 complete transcripts and 4852 false discoveries, whereas the RNA-Bloom2 assembly has 8929 complete transcripts and 4028 false discoveries. For dDNA data, output reads of isONcorrect have 7646 complete transcripts and 2606 false discoveries, whereas the RNA-Bloom2 assembly has 11,157 complete transcripts and 2559 false discoveries. Overall, RNA-Bloom2 offers 25.7–45.9% increase in complete transcripts and 1.8–17.0% reduction in false discoveries compared to isONcorrect. Although long reads often span multiple exons, our results show that transcriptome assembly is valuable to reference-free analysis of long-read transcriptome data.</p>
      <p id="Par17">We then compared RNA-Bloom2 against three other transcriptome assembly tools designed for long reads: RATTLE, StringTie2, and FLAIR. RATTLE is the only other reference-free method, whereas StringTie2 and FLAIR are entirely reference-based. In addition, all FLAIR assemblies were guided by the reference transcriptome annotation in conjunction with the associated reference genome. StringTie2 was run in two different modes: with and without the transcriptome annotation, which are denoted as “StringTie2_GTF” and “StringTie2” from hereon. Since reference-based methods are expected to perform better than reference-free methods, StringTie2, StringTie2_GTF, and FLAIR serve as the baseline for evaluating the performance of RNA-Bloom2 and RATTLE. All assembly methods were run with 48 threads using the same compute nodes with the exception of FLAIR and RATTLE for the assemblies of the 18 million-read sets, which were reprocessed on a high-memory machine after failing the initial runs. The assembly evaluation procedure is described in the Methods section. Commands for all methods and computing hardware are documented in Supplementary Method <xref rid="MOESM1" ref-type="media">6</xref>.</p>
      <p id="Par18">The computational performance of all five assembly methods is summarized in Fig. <xref rid="Fig2" ref-type="fig">2</xref> and Supplementary Tables <xref rid="MOESM1" ref-type="media">6</xref> and <xref rid="MOESM1" ref-type="media">7</xref>. StringTie2 and StringTie2_GTF performed similarly and they have the fastest runtimes and consistently low peak-memory usage for all datasets. FLAIR has the worst peak-memory usages and RATTLE has the worst total runtimes. As expected, reference-based assemblers are faster than reference-free assemblers. RNA-Bloom2 has the lowest memory usage for the 2 million-read cDNA dataset. The peak memory usage and total runtimes of RATTLE are 1.24–3.70 and 9.22–28.12 times of those of RNA-Bloom2, respectively. Both RNA-Bloom2 and RATTLE require a higher peak-memory usage in assembling the dRNA datasets than the cDNA datasets, possibly due to the higher error rate and higher N50 read length of the dRNA datasets. However, the peak memory of RNA-Bloom2 for the dRNA datasets did not increase exponentially with respect to the number of input reads. This suggests that the digital normalization stage in RNA-Bloom2 is effective in reducing the number of reads because the number of transcripts in the 10 million-read set and the 18 million-read set only differs by 210 (Supplementary Table <xref rid="MOESM1" ref-type="media">5</xref>).<fig id="Fig2"><label>Fig. 2</label><caption><title>Computational performance on simulated datasets.</title><p>All assemblers were run with 48 threads and assemblies were generated for 2, 10, and 18 million simulated reads of cDNA and dRNA samples. Peak memory usage was measured in gigabytes (GB), and runtime was measured in wall-clock hours. Both axes are in logarithmic scale. For StringTie2, StringTie2_GTF, and FLAIR, performance figures include read alignment and generation of indexed BAM files. Source data are provided as a Source Data file.</p></caption><graphic xlink:href="41467_2023_38553_Fig2_HTML" id="d32e707"/></fig></p>
      <p id="Par19">The benchmarking results for simulated data are presented in Fig. <xref rid="Fig3" ref-type="fig">3</xref>. The trends for recall are similar for both simulated cDNA and dRNA datasets (Fig. <xref rid="Fig3" ref-type="fig">3a</xref>). RNA-Bloom2 has higher percentages (+1.5 to +7.3%) of complete reconstruction than RATTLE in all simulated samples. The largest difference is observed in the 18 million-read cDNA sample, whereas the smallest difference is observed in the 2 million-read cDNA sample. RNA-Bloom2 also has lower percentages (–9.2 to –11.9%) of missing transcripts than RATTLE in all samples. Behind StringTie2_GTF and FLAIR, RNA-Bloom2 has the third smallest percentages of missing transcripts (41.3–57.0% for cDNA sets and 24.5–49.5% for dRNA sets). For both cDNA and dRNA datasets, StringTie2_GTF has the highest percentages of complete reconstruction (46.2–79.9%) and the smallest percentages of partial reconstruction (4.3–11.4%). However, StringTie2 has the highest percentage of missing transcripts in all cDNA (57.4–68.5%) and dRNA (41.8–56.8%) samples.<fig id="Fig3"><label>Fig. 3</label><caption><title>Assembly quality evaluation of simulated datasets.</title><p><bold>a</bold> Recall is measured with respect to transcription reconstruction levels. <bold>b</bold> False discovery rate is measured based on the numbers of intragene and intergene misassemblies, false positive reference transcripts, contigs with large indels, and unclassified contigs. <bold>c</bold> F1 scores. <bold>d</bold> Redundancy is defined as the number of contigs representing true-positive transcripts with complete or partial reconstruction divided by true-positive transcripts with complete or partial reconstruction. Source data are provided as a Source Data file.</p></caption><graphic xlink:href="41467_2023_38553_Fig3_HTML" id="d32e737"/></fig></p>
      <p id="Par20">We further investigated assembly recall with respect to transcript expression levels. We assigned simulated transcripts to expression quartiles: low, medium-low, medium-high, and high. The expression-stratified assembly recall results for simulated cDNA and dRNA datasets are presented in Supplementary Figs. <xref rid="MOESM1" ref-type="media">2</xref> and <xref rid="MOESM1" ref-type="media">3</xref>, respectively. StringTie2_GTF has the most complete reconstruction in all four expression quartiles for both cDNA and dRNA datasets. RNA-Bloom2 has higher percentages of complete reconstruction than RATTLE in the high and medium-expression expression quartiles, with the exception of the 2 million-read cDNA sample. However, the opposite was observed in the low quartiles. In the high expression quartile, FLAIR has the lowest percentage of complete reconstruction except for the 2 million-read cDNA sample, but it has the second-lowest percentage of missing reconstruction. In the low expression quartiles, RNA-Bloom2 has the lowest percentages of complete reconstruction, but both annotation-guided approaches, StringTie2_GTF and FLAIR, are the two best-performing methods.</p>
      <p id="Par21">We also evaluated false-discovery rates (FDR), F1, and redundancy (Fig. <xref rid="Fig3" ref-type="fig">3b–d</xref>) for the five methods. RNA-Bloom2 has lower FDR (–1.3 to –1.5% for cDNA sets, –0.3 to –1.0% for dRNA sets) compared to RATTLE across all samples. StringTie2 has the highest FDR (9.6 to 14.2% for cDNA sets, 8.9 to 12.9% for dRNA sets), but the FDR of StringTie2_GTF are much lower (2.7–3.5% for cDNA sets, 3.1 to 6.5% for dRNA sets). While StringTie_GTF has much reduced misassemblies and large indel contigs compared to StringTie2, its false discoveries are primarily contributed by false positive reference transcripts. FLAIR has the lowest FDR in all simulated samples (0.2–0.6%). The F1 scores of RNA-Bloom2 are higher (+9.2 to +10.0% for cDNA sets, +7.5 to +10.5 for dRNA sets) than those of RATTLE. StringTie2_GTF has the highest F1 scores (72.3–83.6% for cDNA sets, 81.3–88.4% for dRNA sets), whereas StringTie2 has the lowest F1 scores (46.6–56.5% for cDNA sets, 58.4–68.8% for dRNA sets). RNA-Bloom2 has lower redundancy (−0.2 to −0.7 for cDNA sets, −0.1 to −0.4 for dRNA sets) than RATTLE.</p>
      <p id="Par22">StringTie2_GTF and StringTie2 have the lowest redundancy (1.0–1.1 and 1.1–1.3, respectively), while FLAIR and RATTLE have the highest redundancy (1.3–1.8 and 1.2–1.9, respectively). The high redundancy of FLAIR and RATTLE is potentially a result of larger numbers of contigs assembled (Supplementary Table <xref rid="MOESM1" ref-type="media">11</xref>). However, the number of contigs per gene is similar to the number of transcripts per gene in the ground truth for multi-transcript genes (Supplementary Fig. <xref rid="MOESM1" ref-type="media">9</xref>).</p>
      <p id="Par23">Finally, we assess the isoform assembly precision based on the transcript models in the simulated data. The precision metric is calculated using the isoform classification from SQANTI3<sup><xref ref-type="bibr" rid="CR26">26</xref></sup> (see Methods for details). Our results are summarized in Supplementary Fig. <xref rid="MOESM1" ref-type="media">8</xref>. StringTie2_GTF and FLAIR have the highest isoform assembly precision (87.1–93.6% and 84.7–92.4%, respectively). RNA-Bloom2 has the lowest precision (75.9%) in the 18 M dRNA sample while RATTLE has the lowest precision (76.6–81.0%) in all other samples, where RNA-Bloom2’s precisions are +2.1 to +9.2% higher.</p>
    </sec>
    <sec id="Sec6">
      <title>Assembly benchmarking with spike-in control data</title>
      <p id="Par24">In addition to simulated data, we also benchmarked the four assembly methods on experimental sequencing data of known sequences. We selected one mouse dataset from the LRGASP Consortium containing the matching sequencing data for ONT cDNA, ONT dRNA, and PacBio CCS of the same biological sample. The sequencing samples for this dataset were spiked with Lexogen’s Spike-In RNA Variant (SIRV) transcripts<sup><xref ref-type="bibr" rid="CR23">23</xref></sup> containing 92 External RNA Control Consortium (ERCC) spike-ins, 69 SIRV isoforms, and 15 long SIRVs. We extracted the reads corresponding to the spike-ins (See Methods) for assembly benchmarking and the features of the spike-in datasets are summarized in Supplementary Table <xref rid="MOESM1" ref-type="media">8</xref>. The PacBio CCS sample has the longest N50 read length (2,460 nt) and the lowest error rate (2.03%). The ONT cDNA sample has the shortest N50 read length (712 nt) but the highest number of reads (<italic>n</italic> = 404,783). The ONT dRNA sample has the fewest reads (<italic>n</italic> = 26,814) and the highest error rate (11.01%).</p>
      <p id="Par25">We evaluated the assembly quality of the spike-in samples based on the metrics described in Table <xref rid="Tab1" ref-type="table">1</xref>, and the benchmarking results are presented in Fig. <xref rid="Fig4" ref-type="fig">4</xref>. The trends for recall are similar across platforms (Fig. <xref rid="Fig4" ref-type="fig">4a</xref>). In all three samples, StringTie2_GTF has the highest percentages of complete reconstruction (55.1–76.1%). RNA-Bloom2 has higher percentages of complete reconstruction (+5.7 to +17.6%) than RATTLE in all three samples; RNA-Bloom2 ranks the second highest in both ONT samples. RNA-Bloom2 has the smallest percentage of missing reconstruction in the ONT cDNA sample (25.6%) while StringTie2_GTF has the smallest percentages of missing reconstruction in the ONT dRNA and PacBio CCS samples (42.0% and 23.9%, respectively).<fig id="Fig4"><label>Fig. 4</label><caption><title>Assembly quality evaluation of spike-in control datasets.</title><p><bold>a</bold> Recall, <bold>b</bold> false discovery rates, <bold>c</bold> F1 scores, and <bold>d</bold> redundancy were evaluated for each assembly method on spike-in control data generated from three sequencing technologies: ONT direct RNA, ONT cDNA, and PacBio CCS. The spike-in control data were extracted from a mouse dataset from the LRGASP Consortium. Source data are provided as a Source Data file.</p></caption><graphic xlink:href="41467_2023_38553_Fig4_HTML" id="d32e818"/></fig></p>
      <p id="Par26">Overall, false discoveries (Fig.  <xref rid="Fig4" ref-type="fig">4b</xref>) are predominantly attributed to intragenic misassemblies and large indel contigs. RNA-Bloom2 assemblies contain unclassified contigs that cannot be aligned to the reference spike-in transcripts. Unlike the simulated datasets, there are no false-positive reference transcripts because all reference spike-in transcripts are true positives. StringTie2_GTF has the lowest false-discovery rates (FDR) in all three samples (0–4.3%). StringTie2 has the highest FDR in the ONT dRNA and cDNA samples (25.6% and 20.6%, respectively) while RATTLE has the highest FDR in the PacBio CCS sample (16.3%). RNA-Bloom2 has the second highest FDR in the ONT cDNA sample (20.4%). Both FLAIR and RNA-Bloom2 have over seven times higher FDR in the ONT cDNA sample than in the ONT dRNA and PacBio CCS samples. StringTie2_GTF has the highest F1 scores in all samples (73.4–86.5%). RNA-Bloom2 has the second highest F1 scores in ONT dRNA and PacBio CCS samples (64.2% and 80.3%, respectively), but it has the lowest F1 score in the ONT cDNA sample (51.4%). RATTLE has the lowest F1 score in the PacBio CCS samples (65.5%) and StringTie2 has the lowest F1 score in the ONT dRNA sample (46.5%).</p>
      <p id="Par27">StringTie2_GTF and StringTie2 have the lowest redundancy in all samples (1.1–1.2). RNA-Bloom2 has the highest redundancy in all three samples (2.1, 3.6, 1.6 in ONT dRNA, ONT cDNA, and PacBio CCS, respectively), +0.5 to +1.7 higher than RATTLE. In particular, RNA-Bloom2’s redundancy is predominantly contributed by partially reconstructed transcripts in the ONT cDNA sample, but its redundancy is predominantly contributed by completely reconstructed transcripts in the ONT dRNA and PacBio CCs samples. The high redundancy of RNA-Bloom2 assemblies is potentially due to the substantially higher number of contigs assembled (Supplementary Table <xref rid="MOESM1" ref-type="media">12</xref>). Although the degree of redundancy varies from one method to another, all assembly methods do not follow the number of transcripts per gene in the ground truth (Supplementary Fig. <xref rid="MOESM1" ref-type="media">10</xref>). This is different from what was observed in the simulated data, and we speculate that this is a result of the small number of the spike-ins.</p>
    </sec>
    <sec id="Sec7">
      <title>Assembly evaluation in mouse experimental sample replicates</title>
      <p id="Par28">Using each assembly method, we have assembled individual replicates of mouse experimental samples from the LRGASP consortium for ONT cDNA, ONT dRNA, and PacBio CCS platforms. These are the same samples where the spike-in control dataset was extracted (Supplementary Method <xref rid="MOESM1" ref-type="media">5</xref>). For PacBio replicates, RATTLE performed gene-based clustering instead of isoform-based clustering, which did not run to completion in our initial attempts. We assess the assemblies with SQANTI3 (Supplementary Method <xref rid="MOESM1" ref-type="media">11</xref>) and our results are summarized in Supplementary Figs. <xref rid="MOESM1" ref-type="media">11</xref>–<xref rid="MOESM1" ref-type="media">13</xref>. RNA-Bloom2 recovered a higher number of annotated genes compared to RATTLE in all three platforms. Compared to reference-free methods, reference-based methods have substantially higher numbers of novel genes in ONT cDNA and PacBio CCS platforms. FLAIR has the highest number of known canonical splice junctions in all three platforms; RNA-Bloom2 is a close second in the PacBio CCS platform. Compared to reference-based methods, reference-free methods have substantially higher numbers of non-canonical splice junctions; RNA-Bloom2 has the highest in the ONT cDNA platform. The proportion of non-canonical splice junctions in RNA-Bloom2 is particularly higher than other categories in the ONT cDNA platform (Supplementary Fig. <xref rid="MOESM1" ref-type="media">14</xref>). RNA-Bloom2 has the most full-splice match isoforms and incomplete-splice match isoforms. FLAIR has the most novel in-catalog isoforms. RNA-Bloom2 has the most novel not-in-catalog isoforms and genic-genomic isoforms. All methods have few antisense isoforms. StringTie2 has the most antisense isoforms in the ONT cDNA platform, while RNA-Bloom2 has the most antisense isoforms in the other two platforms. Compared to reference-free methods, reference-based methods have substantially higher numbers of intergenic isoforms in ONT cDNA and PacBio CCS platforms. All methods have relatively low numbers genic-intron isoforms; StringTie2 and StringTie2_GTF have the most in all three platforms.</p>
    </sec>
    <sec id="Sec8">
      <title>Reference-free assembly of a Sitka spruce transcriptome</title>
      <p id="Par29">The Sitka spruce (<italic>Picea sitchensis</italic>) is a large, evergreen, and long-living conifer species native to the Pacific Northwest in North America. Although a 20 Gbp draft genome assembly is publicly available<sup><xref ref-type="bibr" rid="CR27">27</xref></sup>, its scaffold N50 length is 56.8 kbp, which reflects the draft stage of this short-read genome assembly. In particular, the Sitka spruce’s alternative splicing pattern has not been fully investigated. Since conifers are known for their long introns<sup><xref ref-type="bibr" rid="CR28">28</xref>,<xref ref-type="bibr" rid="CR29">29</xref></sup>, the fragmented draft genome would highly limit the effectiveness of reference-based transcriptome assembly methods. Thus, it is a valuable use case to illustrate the utility of reference-free transcriptome assembly methods. Using RNA-Bloom2 and RATTLE, we assembled RNA-seq data from mixed tissue (young needle, bark, xylem, and mature needle) cDNA sampled from a Sitka spruce Q903 spruce weevil-susceptible individual, originated from Haida Gwaii, British Columbia, Canada (53.917, −132.083). The cDNA sample was sequenced on a ONT MinION device (R9.4 flow cell) and the reads are basecalled with Guppy (See Methods and Supplementary Method <xref rid="MOESM1" ref-type="media">7</xref>). A total of 1,323,043 ONT reads with N50 read length of 1,543 nt remained after adapter-trimming with Porechop<sup><xref ref-type="bibr" rid="CR30">30</xref></sup>. We also performed an additional RNA-Bloom2 assembly with hybrid error correction using Illumina paired-end RNA-seq data from a previous study<sup><xref ref-type="bibr" rid="CR31">31</xref></sup>.</p>
      <p id="Par30">First, we measured the completeness of single-copy orthologs with BUSCO<sup><xref ref-type="bibr" rid="CR32">32</xref></sup> for the adapter-trimmed ONT reads, the two RNA-Bloom2 assemblies, and the RATTLE assembly (Supplementary Method <xref rid="MOESM1" ref-type="media">7</xref>). BUSCO provides a quantitative assessment of expected gene content for each set of transcript sequences, and the results are summarized in Supplementary Table <xref rid="MOESM1" ref-type="media">9</xref>. The RNA-Bloom2 assembly with hybrid error correction has the highest percentage of complete BUSCO and the lowest percentages of fragmented and missing BUSCO. Specifically, the complete BUSCO has improved from 73.4% in the adapter-trimmed reads to 87.6% in the RNA-Bloom2 assembly, whereas the percentages of fragmented and missing BUSCO in the reads (7.7% and 18.9%) have reduced by half after assembly with RNA-Bloom2 (3.4% and 9.0%). On the other hand, the RNA-Bloom2 assembly with long-read-only error correction has a higher percentage of complete BUSCO and lower percentages of fragmented and missing BUSCO than the input reads and the RATTLE assembly. Compared to the reads, the RATTLE assembly has a lower percentage of complete BUSCO and higher percentages fragmented and missing BUSCO.</p>
      <p id="Par31">We have selected the RNA-Bloom2 assembly with hybrid error correction for further analyses. This transcriptome assembly has a total of 68,514 transcripts, where 98.95% of adapter-trimmed reads were aligned to the transcriptome assembly with minimap2<sup><xref ref-type="bibr" rid="CR33">33</xref></sup> (Supplementary Method <xref rid="MOESM1" ref-type="media">3</xref>). We also aligned the assembled transcripts against the draft genome with minimap2 (Supplementary Table <xref rid="MOESM1" ref-type="media">10</xref>). A total of 66,866 (97.59%) assembled transcripts were aligned to the draft genome. Of these aligned transcripts, 21,423 (32.04%) transcripts have at least one split-alignments. Since split-alignments on a high-quality genomic reference typically indicate incorrectly assembled transcripts, we compared these split-alignments of assembled transcripts to STAR<sup><xref ref-type="bibr" rid="CR34">34</xref></sup> alignments of the Illumina paired-end RNA-seq data against the draft genome. We found that 13,376 (62.44%) transcripts with split-alignments contain at least one split supported by at least one STAR alignment (Supplementary Method <xref rid="MOESM1" ref-type="media">7</xref>). This suggests that these transcripts were correctly assembled and the majority of split-alignments is likely a result of fragmented genic regions in the draft genome.</p>
      <p id="Par32">To understand the gene structure of transcripts contained in the genomic scaffolds, we supplied the RNA-Bloom2 assembly with hybrid error correction as full-length RNA sequences to PASA<sup><xref ref-type="bibr" rid="CR35">35</xref></sup> to create a transcript structure annotation based on the draft genome. It is important to note that this annotation produced by PASA is only a partial representation of the Sitka spruce transcriptome due to fragmented genic regions. PASA generated an annotation consisting of 15,222 genes, 18,991 transcripts, 58,049 unique exons, 37,090 unique introns, and 19,079 poly(A) tails (Fig. <xref rid="Fig5" ref-type="fig">5a</xref>). There are more poly(A) tails than transcripts because PASA collapses transcripts with alternative polyadenylation. Overall, 95.7% of splice junctions from the PASA annotation overlaps with splice junctions in the Illumina paired-end RNA-seq data reported by STAR. We also tallied the frequencies of unique exons, introns, and transcripts per gene (Fig. <xref rid="Fig5" ref-type="fig">5b</xref>). On average, each gene has 3.8 exons, 2.4 introns, 1.2 transcripts. 59.12% genes contain 2 or more exons, and 16.1% genes contain at least 2 expressed transcripts. A maximum of 55 exons, 53 introns, 13 transcripts are observed per gene.<fig id="Fig5"><label>Fig. 5</label><caption><title>Distributions of feature lengths and feature counts per gene for the Sitka spruce transcriptome.</title><p><bold>a</bold> Total counts of exons, introns, transcripts, gene, and poly(A) tails. <bold>b</bold> The frequency of per-gene counts of exons, introns, and transcripts. The vertical “Frequency” axis is presented in logarithmic scale. <bold>c</bold> The length distributions of exons, introns, transcripts, genes, and poly(A) tails. The horizontal “Length” axis is presented in logarithmic scale. The vertical axis is scaled to the maximum value for each feature. The minimum and maximum values are indicated at both tails of the distributions. Peak values on the distributions are superimposed on the vertical dotted lines. Source data are provided as a Source Data file.</p></caption><graphic xlink:href="41467_2023_38553_Fig5_HTML" id="d32e944"/></fig></p>
      <p id="Par33">We calculated the length distributions of exons, introns, transcripts, genes, and poly(A) tails based on the output files from PASA (Fig. <xref rid="Fig5" ref-type="fig">5c</xref>). Exon lengths range from 10 to 18,115 nt with a primary peak at 116 nt and a slightly shorter secondary peak at 518 nt. Intron lengths range from 21 to 206,268 nt with a primary peak at 113 nt and a much shorter secondary peak at 25,474 nt. 10.3% of introns are longer than 10,000 bp, which is in congruence with the long intron characteristic of conifers. Likely as a result of long introns, gene lengths range from 115 to 364,125 nt with a primary peak at 1865 nt and a secondary peak at 45,120 nt. Transcript lengths range from 115 to 18,115 nt with a peak at 1863 nt, which is nearly identical to the peak gene length. Poly(A) tail length ranges between 10 to 104 nt long with a primary peak at 21 nt and a shorter secondary peak at 50 nt. The bimodal poly(A) tail length distribution is also observed in <italic>Arabidopsis</italic> seeding transcriptomes<sup><xref ref-type="bibr" rid="CR36">36</xref></sup>.</p>
      <p id="Par34">We also investigated alternative transcript processing events in the assembled transcripts. PASA reports nine types of events (Fig. <xref rid="Fig6" ref-type="fig">6</xref>): spliced intron, retained intron, alternate acceptor, alternate donor, alternate exon, retain exon, skipped exon, starts in intron, and ends in intron. Spliced intron is the most common event (27.5%), followed by retained intron (24.3%). Retained intron and spliced intron are the most frequently co-occurring event types. Transcripts involving 3 or more event types are detected but are much rarer.<fig id="Fig6"><label>Fig. 6</label><caption><title>Alternative transcript processing events in the Sitka spruce transcriptome.</title><p><bold>a</bold> Nine types of alternative transcript processing events are presented as they are defined in PASA and depicted by connected grey and orange rectangles. The exons, introns, or splice-junctions involved in each event type are highlighted in orange. <bold>b</bold> The vertical bar chart in the UpSet plot shows the number of transcripts containing single event types and co-occurring event types, which are indicated by single dots and connected dots in the matrix, respectively. The horizontal bar chart in the UpSet plot shows the total number of transcripts containing each event type. <bold>c</bold> Relative proportions of all event types in the PASA annotation. Source data are provided as a Source Data file.</p></caption><graphic xlink:href="41467_2023_38553_Fig6_HTML" id="d32e980"/></fig></p>
      <p id="Par35">Finally, we applied the EnTAP pipeline<sup><xref ref-type="bibr" rid="CR37">37</xref></sup> to produce protein sequence translation and functional annotation for the RNA-Bloom2 assembly (Supplementary Method <xref rid="MOESM1" ref-type="media">7</xref>). Using the functional annotation and similarity search to known spruce protein sequences, we have identified the following putative peptides: 15 terpene synthases (TPS), including 10 monoterpene synthases and seven diterpene synthases, 100 cytochrome P450 (CYP) peptides from 55 different subfamilies, and 17 NAM/ATAF/CUC (NAC) transcription factors from six different subfamilies. TPS, CYP, and NAC are gene families known for their contribution to constitutive and induced resistance to damage by the spruce weevils<sup><xref ref-type="bibr" rid="CR31">31</xref>,<xref ref-type="bibr" rid="CR38">38</xref>,<xref ref-type="bibr" rid="CR39">39</xref></sup>.</p>
    </sec>
  </sec>
  <sec id="Sec9" sec-type="discussion">
    <title>Discussion</title>
    <p id="Par36">The rapid improvements to long-read sequencing technologies present a significant challenge to reference-free transcriptome assembly methods. As the throughput of long-read sequencers continues to increase, larger sequencing datasets are produced and thereby increasing the sequence assembly and analysis computational challenge. RNA-Bloom2 addresses this by digital normalization with strobemers. In our benchmarking with simulated data and spike-in control data, we showed that the computational performance and the assembly quality of RNA-Bloom2 significantly surpasses those of RATTLE, a previous reference-free transcriptome assembler that relies on the clustering of long reads. In particular, RATTLE has total wall-clock runtimes over nine times that of RNA-Bloom2. Therefore, digital normalization with strobemers, within the RNA-Bloom2 assembly workflow, was a successful application of the concept in the assembly of long-read sequencing data, and it was a superior alternative to clustering-based reference-free assembly. However, we note that digital normalization has somewhat detrimental effects on low-expressed isoforms as we have shown in our benchmarking experiment.</p>
    <p id="Par37">We note that reference-based assembly methods tend to run much faster than reference-free methods, but their overall assembly quality varies depending on the metric used and whether or not a transcriptome annotation is included. In simulated data, StringTie2_GTF has better recall than reference-free methods, but StringTie2 has lower recall and higher FDR than reference-free methods. FLAIR has the lowest FDR in the simulated data, but StringTie2_GTF has the lowest FDR in the spike-in data. It is important to note that StringTie2 does not strictly require a reference annotation in addition to the reference genome, but FLAIR requires both a reference annotation and the reference genome. Therefore, the application of FLAIR is mainly limited to the discovery of novel isoforms while StringTie2 only requires a good-quality reference genome.</p>
    <p id="Par38">With the experimental mouse data, annotation-guided methods tend to generate less novel not-in-catalog (as defined by SQANTI3) isoforms and novel non-canonical junctions compared to reference-free methods. This is expected because the reference annotation is used to filter or correct inaccurate splice junctions in read alignments. On the contrary, reference-free methods do not use the reference annotation and the reference genome; they do not have this a priori information to correct inaccurate splice junctions. Although this suggests that annotation-guided assembly may be more accurate than reference-free assembly, these novel isoforms and splice junctions remain to be verified. Nevertheless, RNA-Bloom2 and annotation-based methods recovered similar amounts of annotated genes. Compared to reference-free methods, all reference-based approaches have reconstructed substantially more novel genes and intergenic isoforms in ONT cDNA and PacBio CCS replicates. This suggests that reference-based methods may still produce false positives when the reference annotation does not contain sufficient information.</p>
    <p id="Par39">As good quality reference annotations are not always readily available, transcriptome assembly methods must manage the lack of known transcription start and end sites, which are crucial in distinguishing the orientation of transcripts and discerning transcripts from antisense overlapping genes. Unlike direct RNA-sequencing, this is a major challenge for cDNA sequencing data, where the strand of reads cannot always be safely assumed. RNA-Bloom2 overcomes this problem by identifying potential poly(A) tail-containing reads. In addition, RNA-Bloom2 filters edges in its overlap graph based on read counts of each edge and its incident nodes, thus removing false overlaps between sequences. The positive effects of these solutions in RNA-Bloom2 are supported by the relatively low false discovery rates of RNA-Bloom2 in our benchmarking experiments for simulated data. When using the mouse data with replicates, we note that RNA-Bloom2 has reconstructed more FSM, ISM, NNC, and antisense isoforms than other methods. These metrics may be inflated by RNA-Bloom2’s high redundancy – an aspect we observed when analyzing experimental but not simulated data. We, therefore, conclude that RNA-Bloom2 has room for improvement in recognizing noise and reducing the number of redundant transcripts in experimental data.</p>
    <p id="Par40">In our analyses of the Sitka spruce transcriptome, we illustrated that RNA-Bloom2 assemblies have higher BUSCO completeness than input reads and a RATTLE assembly. We note that a portion of our assembled transcripts have split-alignments across genome scaffolds, but the majority of them are supported by paired-end short reads. We expect that a transcript-informed targeted gene reconstruction<sup><xref ref-type="bibr" rid="CR40">40</xref></sup>, using a long-read reference-free transcriptome assembly by RNA-Bloom2, may significantly improve the discovery of new splice isoforms and the annotation of genes.</p>
    <p id="Par41">In summary, we illustrated the performance of RNA-Bloom2 with respect to state-of-the-art long-read transcriptome assembly methods, highlighting the strengths and weaknesses of each. We showed that RNA-Bloom2 is suitable for both ONT and PacBio sequencing technologies and it is competitive with reference-based methods. We expect RNA-Bloom2 to be scalable to increasing volumes of long-read data, and we anticipate RNA-Bloom2 will facilitate the gene annotation and transcriptome analyses of many species to be investigated.</p>
  </sec>
  <sec id="Sec10">
    <title>Methods</title>
    <sec id="Sec11">
      <title>Alignment-free error correction</title>
      <p id="Par42">We have modified the error correction routine for short reads in RNA-Bloom to support error correction in long reads. RNA-Bloom2 uses a <italic>k</italic>-mer size of 25 by default unless specified otherwise by the user. First, <italic>k</italic>-mers and their multiplicities in the input reads are stored in a Bloom filter de Bruijn graph, which uses the same memory-efficient data structure introduced in our previous work<sup><xref ref-type="bibr" rid="CR19">19</xref></sup>. However, paired <italic>k</italic>-mers that were utilized in the short-read assembly algorithm are not used due to higher error rates of long reads. Reads are then split into fixed-length tiles (default: 500 nt) that are evaluated independently of each other. To account for varying transcript expression levels, a multiplicity threshold is dynamically determined (See Supplementary Fig. <xref rid="MOESM1" ref-type="media">4</xref> for more details about this procedure) within each tile to identify “weak” and “solid” <italic>k</italic>-mers, which have multiplicities lower and higher than or equal to the threshold, respectively. Weak <italic>k</italic>-mers represent potentially erroneous regions in the read while solid <italic>k</italic>-mers represent error-free regions in the read. To avoid introducing incorrect edits to the read, weak <italic>k</italic>-mers are replaced with an alternative path of solid <italic>k</italic>-mers in the de Bruijn graph only if this path shares a high sequence identity (default: 70%) as the target region spanned by the weak <italic>k</italic>-mers. The tiling nature of this routine ensures that more refined multiplicity thresholds are set for sub-regions in the read. The error correction process for each read may be repeated for additional iterations if at least one tile was modified in the previous iteration. In each successive iteration, the tiling positions are shifted by half a tile length to allow errors at tile boundaries in the previous iteration to be corrected. After error correction is completed for the read, <italic>k</italic>-mers from all neighboring tiles are joined together and are assembled into an edited read sequence.</p>
    </sec>
    <sec id="Sec12">
      <title>Digital normalization with strobemers</title>
      <p id="Par43">Digital normalization is intended to reduce the overall read depth to a much lower target depth (default: 3) by identifying the minimal longest reads set (MLRS) supporting the target depth. Digital normalization reduces the computational resource requirements of subsequent stages, and it is most effective in reducing the number of reads for high-expressed transcripts, which are the main culprit for long runtimes and high memory usage in read-to-read alignments. The read depths represented by the MLRS are approximated by multiplicities of strobemers, which is an error-tolerant alternative to <italic>k</italic>-mers for sequence comparison. Three variants of strobemers have been introduced in previous work<sup><xref ref-type="bibr" rid="CR18">18</xref></sup>: minstrobes, randstrobes, and hybridstrobes. In RNA-Bloom2, we used randstrobes of order three because it was shown to perform favorably on transcriptome data. Strobemer multiplicities are tracked by a counting Bloom filter, which is populated as reads are added to the MLRS.</p>
      <p id="Par44">Digital normalization begins by first sorting the input reads by their length in descending order. Only one read is evaluated at a time to maintain proper tracking of read depth in the MLRS. A read is designated as represented by the MLRS if nearly the entire read (default threshold of 50 nt from the read extremities) contains overlapping strobemers with multiplicities at or above the target depth (Supplementary Fig. <xref rid="MOESM1" ref-type="media">5</xref>). A read is designated as not represented by the MLRS if it has a region not containing any strobemers with multiplicities at or above the target depth. Each non-represented read is added to the MLRS and its strobemer multiplicities (that are lower than the target depth) would be incremented by one before the next read is evaluated. Represented reads are not included in the MLRS and their strobemer multiplicities are not incremented.</p>
    </sec>
    <sec id="Sec13">
      <title>Read trimming and splitting</title>
      <p id="Par45">RNA-Bloom2 relies on minimap2 for overlapping reads against each other to identify sufficiently covered regions of each read. By default, the minimum required read depth for long-read assembly is set to three in RNA-Bloom2; a sufficiently covered region of a read must overlap with at least two other reads. Insufficiently covered head and tail regions of the reads are trimmed. Reads containing insufficiently covered internal region(s) are potentially chimera artifacts. Therefore, reads are also split at these internal regions into shorter segments that are still sufficiently supported by other reads (See Supplementary Fig. <xref rid="MOESM1" ref-type="media">6</xref> for more details). Completely contained reads are removed.</p>
    </sec>
    <sec id="Sec14">
      <title>Unitig assembly</title>
      <p id="Par46">Trimmed reads are overlapped against each other with minimap2 to construct an overlap graph where the vertices and edges are reads and their overlaps, respectively. As was done in the read trimming stage, contained reads are removed. If the input data is strand-specific (e.g. ONT dRNA), only alignments on the same strand are retained and the overlap graph would only contain vertices for the forward strand. If the input data is not strand-specific (e.g. ONT cDNA), then vertices for both strands are created in the overlap graph and the overlap graph is pruned based on whether each read contains poly(A) tail or poly(T) head (Supplementary Fig. <xref rid="MOESM1" ref-type="media">7</xref>). The overlap graph is simplified by removing transitive edges. Unitigs are derived by assembling reads along unambiguous paths in the overlap graph.</p>
    </sec>
    <sec id="Sec15">
      <title>Unitig polishing</title>
      <p id="Par47">Although alignment-free error correction has been performed on the reads that were used to generate unitigs, there are still residual base errors that can be polished using an alignment-based approach. Output reads from the error correction stage are aligned to the unitigs with minimap2. To avoid unintentional removal of short alternatively spliced exons during polishing, only alignments with large indels (default: &gt; 50 nt) or low sequence identity (default: &lt;70%) are removed. The filtered alignments are passed to Racon<sup><xref ref-type="bibr" rid="CR41">41</xref></sup> for polishing the unitigs.</p>
    </sec>
    <sec id="Sec16">
      <title>Transcript assembly</title>
      <p id="Par48">An overlap graph of polished unitigs is constructed based on minimap2 overlaps between polished unitigs. Reusing the read alignments from the unitig polishing stage, the overlap graph is annotated with: (i) length-normalized read counts for the unitigs, and (ii) the number of reads spanning across the unitig overlaps. The length-normalized read counts for unitigs are measured as the number of aligned bases divided by the total length of the unitig. The length normalization is primarily intended to account for reads that align partially to more than one unitig, where a higher count is attributed to the unitig with more aligned bases. Without length normalization, read counts tallied from reads aligned to unitig overlaps would be double-counted, which is particularly detrimental when reads align to false-overlaps between unitigs. Therefore, the normalized read counts provide a means to discern false overlaps between unitigs that belong to transcripts with different expression level magnitudes.</p>
      <p id="Par49">If the input data is not strand-specific, then the overlap graph is pruned as it was done in unitig assembly, and the read alignments are also examined for poly-A tail reads that are aligned to the unitigs. The unitigs are reoriented based on the poly-A tail read alignment orientations and the overlap graph is filtered accordingly (Supplementary Fig. <xref rid="MOESM1" ref-type="media">7</xref>). This procedure is crucial in discerning transcripts originating from overlapping genes on opposite strands of the chromosome. In addition, edges in the overlap graph are filtered by applying a binomial test on the number of reads supporting the edge with respect to the normalized read counts of the incident vertices (Supplementary Method <xref rid="MOESM1" ref-type="media">8</xref>).</p>
      <p id="Par50">After all filtering on the overlap graph has been performed, vertices are sorted by their read counts in descending order. Each vertex serves as the seed for a bidirectional greedy extension path with each extension choosing the neighbor vertex with the highest read count. Greedy extension terminates upon reaching either a dead-end, a cycle, or a vertex with a read count of zero. The reads along this path are assembled into a transcript. All vertices along this path would be flagged from seeding new extension paths, and their read counts are decremented by the minimum read count in the path. Transcript assembly is complete when all vertices have been visited.</p>
    </sec>
    <sec id="Sec17">
      <title>Benchmark dataset simulation</title>
      <p id="Par51">We used Trans-NanoSim v3.1.0 to simulate ONT cDNA and dRNA datasets based on the mouse annotation for GRCm39 from LRGASP (Synapse accession “<ext-link ext-link-type="uri" xlink:href="https://www.synapse.org/#!Synapse:syn25683629">syn25683629</ext-link>”). Two mouse samples from the LRGASP Consortium (accessions “<ext-link ext-link-type="uri" xlink:href="https://www.encodeproject.org/files/ENCFF232YSU/">ENCFF232YSU</ext-link>” and “<ext-link ext-link-type="uri" xlink:href="https://www.encodeproject.org/files/ENCFF349BIN/">ENCFF349BIN</ext-link>”) were selected for training Trans-NanoSim sequencing profiles for cDNA and dRNA data, respectively. Sequencing adapters were trimmed from raw reads using Pychopper v2.5.0<sup><xref ref-type="bibr" rid="CR21">21</xref></sup> (Supplementary Method <xref rid="MOESM1" ref-type="media">1</xref>). Since no adapters were detected in the dRNA data, the raw reads were supplied to Trans-NanoSim for training the dRNA profile. On the contrary, adapters were found in the cDNA data; the adapter-trimmed “full-length” and “rescued” reads, as defined by Pychopper, were supplied to Trans-NanoSim for training the cDNA profile. We discarded all simulated reads defined as “unaligned” by Trans-NanoSim and we subsample the “aligned” simulated reads to 2, 10, and 18 million reads using seqtk<sup><xref ref-type="bibr" rid="CR42">42</xref></sup>. All software command parameters are documented in Supplementary Method <xref rid="MOESM1" ref-type="media">4</xref>.</p>
    </sec>
    <sec id="Sec18">
      <title>Spike-in control reads extraction</title>
      <p id="Par52">For the ONT cDNA samples, we only used the adapter-trimmed “full-length” and “rescued” reads, as defined by Pychopper. Using minimap2 2.24-r1122, reads from three replicates for each platform were aligned against the hybrid reference genome of mouse and spike-ins provided by LRGASP. Only reads that are aligned uniquely to ERCC and SIRV sequences are kept (Supplementary Method <xref rid="MOESM1" ref-type="media">5</xref>).</p>
    </sec>
    <sec id="Sec19">
      <title>Transcriptome assembly benchmarking</title>
      <p id="Par53">The command parameters for each assembler are documented in Supplementary Method <xref rid="MOESM1" ref-type="media">6</xref>. For the simulated datasets, transcriptome assemblies are aligned against the mouse reference transcriptome from LRGASP with minimap2. The output alignment PAF files are processed with our in-house Python script ‘tns_eval.py‘, which is available at <ext-link ext-link-type="uri" xlink:href="https://github.com/bcgsc/rnaseq_utils">https://github.com/bcgsc/rnaseq_utils</ext-link>. Only alignment segments of at least 100 nt in length, at least 95% sequence identity, and indels smaller than 70 nt in length are considered. The ground truth transcript set is determined using the transcript identifiers in the simulated read names. Since not all known transcripts were simulated, the truth set is a subset of the annotation. Any transcripts that are not in the truth set are designated as false positives. If an assembled sequence aligns equally well with both a truth set transcript and a false-positive transcript, the assembled sequence would be assigned to the truth set instead of the false-positive. Any assembled sequences that have split alignments to more than one transcript are designated as misassemblies.</p>
      <p id="Par54">For the spike-in datasets, transcriptome assemblies are aligned against the ERCC and SIRV sequences with minimap2. Since the ground truth transcript set is identical to the spike-in annotated transcripts, there are no false-positives. However, misassemblies are still detected as it was done for the simulated datasets.</p>
    </sec>
    <sec id="Sec20">
      <title>Calculating isoform assembly precision</title>
      <p id="Par55">The isoform assembly precision metric is calculated based on SQANTI3’s isoform classification. The command parameters for SQANTI3 are documented in Supplementary Method <xref rid="MOESM1" ref-type="media">11</xref>. SQANTI3 classifies assembly contigs into different categories according to how they match the reference transcript models. Full splice match (FSM) and incomplete splice match (ISM) are the only two categories that correspond to reference isoform with matching splice junctions. To determine isoform assembly precision for simulated data, the transcriptome annotation is filtered to include only isoforms that were simulated. Note that a total of six filtered transcriptome annotations were generated for the simulated data (two protocols, three read set sizes). When SQANTI3 is run with the filtered transcriptome annotation, any incorrect assemblies would be assigned to categories other than FSM or ISM. Therefore, isoform assembly precision is calculated as (FSM + ISM)/(FSM + ISM + other categories).</p>
    </sec>
    <sec id="Sec21">
      <title>Sitka spruce transcriptome analysis</title>
      <p id="Par56">All software command parameters are documented in Supplementary Method <xref rid="MOESM1" ref-type="media">7</xref>. The ONT cDNA reads were base called with Guppy v5.0.15. Since there are non-standard adapter and primer sequences, we used Porechop instead of Pychopper. We assembled the adapter-trimmed reads with RNA-Bloom2 v2.0.0 and short-read RNA-seq data (See Data Availability statement) from previous work<sup><xref ref-type="bibr" rid="CR31">31</xref></sup> were also included only for error correction of the ONT reads. The transcriptome completeness was benchmarked with BUSCO v5.3.2<sup><xref ref-type="bibr" rid="CR32">32</xref></sup> and the embryophyte core gene set (odb10). The resulting RNA-Bloom2 assembly was supplied to PASA v2.5.2<sup><xref ref-type="bibr" rid="CR35">35</xref></sup> for gene structure annotation, using minimap2 for transcriptome alignments against the draft genome. The figure for alternative splicing was generated with UpSetR<sup><xref ref-type="bibr" rid="CR43">43</xref></sup>. The transcriptome assembly was annotated with EnTAP v0.10.8-beta<sup><xref ref-type="bibr" rid="CR37">37</xref></sup> using TransDecoder v5.3.0<sup><xref ref-type="bibr" rid="CR44">44</xref></sup> for protein sequence translation. Functional annotation was assigned based on Swiss-prot plant proteins<sup><xref ref-type="bibr" rid="CR45">45</xref></sup>, UniRef90 gene clusters<sup><xref ref-type="bibr" rid="CR46">46</xref></sup>, embryophyte orthologs from OrthoDB10<sup><xref ref-type="bibr" rid="CR47">47</xref></sup>, and high-quality proteins derived from NCBI RefSeq 99<sup><xref ref-type="bibr" rid="CR48">48</xref></sup>. We performed the annotation of TPS, CYP and NAC through a BLASTP search against target spruce protein sequences reported previously<sup><xref ref-type="bibr" rid="CR31">31</xref>,<xref ref-type="bibr" rid="CR38">38</xref>,<xref ref-type="bibr" rid="CR39">39</xref></sup>, with minimum match of 95% identity and 90% query coverage.</p>
    </sec>
    <sec id="Sec22">
      <title>Statistics and reproducibility</title>
      <p id="Par57">No biological sample collection was performed in this study. Therefore, no statistical method was used to predetermine sample size and there were no randomized experiments. Blinding of data is also not relevant. Sequencing reads were only excluded if they are deemed as poor quality by the adapter-trimming softwares. For reproducibility of analyses in this study, exact software commands are provided in Supplementary Information.</p>
    </sec>
    <sec id="Sec23">
      <title>Reporting summary</title>
      <p id="Par58">Further information on research design is available in the <xref rid="MOESM3" ref-type="media">Nature Portfolio Reporting Summary</xref> linked to this article.</p>
    </sec>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary information</title>
    <sec id="Sec24">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="41467_2023_38553_MOESM1_ESM.pdf">
            <caption>
              <p>Supplementary Information</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM2">
          <media xlink:href="41467_2023_38553_MOESM2_ESM.pdf">
            <caption>
              <p>Peer Review File</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM3">
          <media xlink:href="41467_2023_38553_MOESM3_ESM.pdf">
            <caption>
              <p>Reporting Summary</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <app-group>
    <app id="App1">
      <sec id="Sec25">
        <title>Source data</title>
        <p id="Par62">
          <media position="anchor" xlink:href="41467_2023_38553_MOESM4_ESM.xlsx" id="MOESM4">
            <caption>
              <p>Source Data</p>
            </caption>
          </media>
        </p>
      </sec>
    </app>
  </app-group>
  <fn-group>
    <fn>
      <p><bold>Publisher’s note</bold> Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <sec>
    <title>Supplementary information</title>
    <p>The online version contains supplementary material available at 10.1038/s41467-023-38553-y.</p>
  </sec>
  <ack>
    <title>Acknowledgements</title>
    <p>The authors would like to thank Dr. Steven Jones and Dr. Marco Marra at Canada’s Michael Smith Genome Sciences Centre (GSC) for graciously providing their nanopore sequencing data to test an earlier version of RNA-Bloom2, Dr. Kieran O’Neil and Vanessa Porter at GSC for evaluating the performance of an earlier version of RNA-Bloom2, Dr. Justin Whitehill at North Carolina State University and Mack Yuen at Dr. Joerg Bohlmann’s Lab for providing the sequences and annotations of Sitka spruce short-read transcriptome assemblies, Young Cheng at GSC for submitting the Sitka spruce nanopore sequencing data to the SRA, and the organizers of the LRGASP Consortium for making their sequencing data publicly available and sharing their evaluation results on an earlier version of RNA-Bloom2. This work was supported by Genome Canada and Genome British Columbia (grant number 243FOR to all authors); the National Institutes of Health (grant number 2R01HG007182-04A1 to all authors); the Natural Sciences and Engineering Research Council of Canada (NSERC); and the Canadian Institutes of Health Research (CIHR). The content of this work is solely the responsibility of the authors and does not necessarily represent the official views of the National Institutes of Health or other funding organizations.</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Author contributions</title>
    <p>K.M.N. and I.B. conceived the study. K.M.N. designed and developed RNA-Bloom2 under the supervision of I.B. K.M.N., S.H., and C.Y. generated the simulated datasets and analyzed the LRGASP Consortium dataset. S.H., R.C., R.L.W., and I.B. advised on the benchmarking design. K.M.N., K.K.G., and R.C. analyzed the Sitka spruce dataset. All authors contributed to the interpretation of the results. KMN took the lead in writing the manuscript with input from all authors.</p>
  </notes>
  <notes notes-type="peer-review">
    <title>Peer review</title>
    <sec id="FPar1">
      <title>Peer review information</title>
      <p id="Par59"><italic>Nature Communications</italic> thanks the other, anonymous, reviewer(s) for their contribution to the peer review of this work. A peer review file is available.</p>
    </sec>
  </notes>
  <notes notes-type="data-availability">
    <title>Data availability</title>
    <p>The source data for generating all figures in this study are provided in the Source Data file. The simulated data generated in this study has been deposited in Dryad at 10.5061/dryad.cc2fqz68w (ref. <sup><xref ref-type="bibr" rid="CR49">49</xref></sup>). The rebasecalled Nanopore sequencing data for the Sitka spruce cDNA sample has been deposited in the Sequence Read Archive (SRA) with run accession “<ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/sra/?term=SRR19510936">SRR19510936</ext-link>”. The GRCm39-based mouse reference genome from the LRGASP is available on Synapse with accession “<ext-link ext-link-type="uri" xlink:href="https://www.synapse.org/#!Synapse:syn25683365">syn25683365</ext-link>”. The GENCODE VM27-based mouse transcriptome annotation set from the LRGASP is available on Synapse with accession “<ext-link ext-link-type="uri" xlink:href="https://www.synapse.org/#!Synapse:syn25683629">syn25683629</ext-link>”. The sequencing data from the LRGASP are available in the ENCODE Project repository with accessions: “<ext-link ext-link-type="uri" xlink:href="https://www.encodeproject.org/files/ENCFF349BIN/">ENCFF349BIN</ext-link>”, “<ext-link ext-link-type="uri" xlink:href="https://www.encodeproject.org/files/ENCFF412NKJ/">ENCFF412NKJ</ext-link>”, “<ext-link ext-link-type="uri" xlink:href="https://www.encodeproject.org/files/ENCFF765AEC/">ENCFF765AEC</ext-link>”, “<ext-link ext-link-type="uri" xlink:href="https://www.encodeproject.org/files/ENCFF232YSU/">ENCFF232YSU</ext-link>”, “<ext-link ext-link-type="uri" xlink:href="https://www.encodeproject.org/files/ENCFF288PBL/">ENCFF288PBL</ext-link>”, “<ext-link ext-link-type="uri" xlink:href="https://www.encodeproject.org/files/ENCFF683TBO/">ENCFF683TBO</ext-link>”, “<ext-link ext-link-type="uri" xlink:href="https://www.encodeproject.org/files/ENCFF313VYZ/">ENCFF313VYZ</ext-link>”, “<ext-link ext-link-type="uri" xlink:href="https://www.encodeproject.org/files/ENCFF667VXS/">ENCFF667VXS</ext-link>”, “<ext-link ext-link-type="uri" xlink:href="https://www.encodeproject.org/files/ENCFF874VSI/">ENCFF874VSI</ext-link>”, “<ext-link ext-link-type="uri" xlink:href="https://www.encodeproject.org/files/ENCFF696TCH/">ENCFF696TCH</ext-link>”, and “<ext-link ext-link-type="uri" xlink:href="https://www.encodeproject.org/files/ENCFF751FTE/">ENCFF751FTE</ext-link>”. The Illumina sequencing data for Sitka spruce from a previous study<sup><xref ref-type="bibr" rid="CR31">31</xref></sup> is available on SRA with accessions: “<ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/sra/?term=SRR5949081">SRR5949081</ext-link>”, “<ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/sra/?term=SRR5949082">SRR5949082</ext-link>”, “<ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/sra/?term=SRR5949083">SRR5949083</ext-link>”, “<ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/sra/?term=SRR5949084">SRR5949084</ext-link>”, “<ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/sra/?term=SRR5949085">SRR5949085</ext-link>”, “<ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/sra/?term=SRR5949086">SRR5949086</ext-link>”, “<ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/sra/?term=SRR5949087">SRR5949087</ext-link>”, “<ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/sra/?term=SRR5949088">SRR5949088</ext-link>”, “<ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/sra/?term=SRR5949089">SRR5949089</ext-link>”, “<ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/sra/?term=SRR5949090">SRR5949090</ext-link>”, “<ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/sra/?term=SRR5949091">SRR5949091</ext-link>”, and “<ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/sra/?term=SRR5949092">SRR5949092</ext-link>”. All other relevant data supporting the key findings of this study are available within the article and its Supplementary Information files or from the corresponding author upon reasonable request. <xref rid="Sec25" ref-type="sec">Source data</xref> are provided with this paper.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Code availability</title>
    <p>RNA-Bloom2 (v2.0.0) is implemented in Java, and it is publicly available under GPLv3 license on GitHub at <ext-link ext-link-type="uri" xlink:href="https://github.com/bcgsc/RNA-Bloom">https://github.com/bcgsc/RNA-Bloom</ext-link> (ref. <sup><xref ref-type="bibr" rid="CR50">50</xref></sup>). The scripts we wrote to produce and analyze our results are also publicly available on GitHub at <ext-link ext-link-type="uri" xlink:href="https://github.com/bcgsc/rnaseq_utils">https://github.com/bcgsc/rnaseq_utils</ext-link> and <ext-link ext-link-type="uri" xlink:href="https://github.com/bcgsc/rnabloom2_manuscript">https://github.com/bcgsc/rnabloom2_manuscript</ext-link>.</p>
  </notes>
  <notes id="FPar2" notes-type="COI-statement">
    <title>Competing interests</title>
    <p id="Par60">The authors declare no competing interests.</p>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Moreno-Santillán</surname>
            <given-names>DD</given-names>
          </name>
          <name>
            <surname>Machain-Williams</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Hernández-Montes</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Ortega</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>De novo transcriptome assembly and functional annotation in five species of bats</article-title>
        <source>Sci. Rep.</source>
        <year>2019</year>
        <volume>9</volume>
        <fpage>1</fpage>
        <lpage>12</lpage>
        <pub-id pub-id-type="pmid">30626917</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jo</surname>
            <given-names>Y</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Integrated analyses using RNA-Seq data reveal viral genomes, single nucleotide variations, the phylogenetic relationship, and recombination for Apple stem grooving virus</article-title>
        <source>BMC Genomics</source>
        <year>2016</year>
        <volume>17</volume>
        <fpage>1</fpage>
        <lpage>12</lpage>
        <pub-id pub-id-type="pmid">26818753</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mittal</surname>
            <given-names>VK</given-names>
          </name>
          <name>
            <surname>McDonald</surname>
            <given-names>JF</given-names>
          </name>
        </person-group>
        <article-title>De novo assembly and characterization of breast cancer transcriptomes identifies large numbers of novel fusion-gene transcripts of potential functional significance</article-title>
        <source>BMC Med. Genomics</source>
        <year>2017</year>
        <volume>10</volume>
        <fpage>1</fpage>
        <lpage>20</lpage>
        <pub-id pub-id-type="pmid">28057009</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schelhorn</surname>
            <given-names>S-E</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Sensitive detection of viral transcripts in human tumor transcriptomes</article-title>
        <source>PLoS Comput. Biol.</source>
        <year>2013</year>
        <volume>9</volume>
        <fpage>e1003228</fpage>
        <pub-id pub-id-type="pmid">24098097</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lau</surname>
            <given-names>C-C</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Viral-human chimeric transcript predisposes risk to liver cancer development and progression</article-title>
        <source>Cancer Cell</source>
        <year>2014</year>
        <volume>25</volume>
        <fpage>335</fpage>
        <lpage>349</lpage>
        <pub-id pub-id-type="pmid">24582836</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Xue</surname>
            <given-names>W</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>L_RNA_scaffolder: scaffolding genomes with transcripts</article-title>
        <source>BMC Genomics</source>
        <year>2013</year>
        <volume>14</volume>
        <fpage>1</fpage>
        <lpage>14</lpage>
        <pub-id pub-id-type="pmid">23323973</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Amarasinghe</surname>
            <given-names>SL</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Opportunities and challenges in long-read sequencing data analysis</article-title>
        <source>Genome Biol.</source>
        <year>2020</year>
        <volume>21</volume>
        <fpage>1</fpage>
        <lpage>16</lpage>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jain</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Olsen</surname>
            <given-names>HE</given-names>
          </name>
          <name>
            <surname>Paten</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Akeson</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>The oxford nanopore minION: delivery of nanopore sequencing to the genomics community</article-title>
        <source>Genome Biol.</source>
        <year>2016</year>
        <volume>17</volume>
        <fpage>1</fpage>
        <lpage>11</lpage>
        <pub-id pub-id-type="pmid">26753840</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Garalde</surname>
            <given-names>DR</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Highly parallel direct RNA sequencing on an array of nanopores</article-title>
        <source>Nat. Methods</source>
        <year>2018</year>
        <volume>15</volume>
        <fpage>201</fpage>
        <lpage>206</lpage>
        <pub-id pub-id-type="pmid">29334379</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Weirather</surname>
            <given-names>JL</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Comprehensive comparison of Pacific Biosciences and Oxford Nanopore Technologies and their applications to transcriptome analysis</article-title>
        <source>F1000Res.</source>
        <year>2017</year>
        <volume>6</volume>
        <fpage>100</fpage>
        <pub-id pub-id-type="pmid">28868132</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kovaka</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Transcriptome assembly from long-read RNA-seq alignments with StringTie2</article-title>
        <source>Genome Biol.</source>
        <year>2019</year>
        <volume>20</volume>
        <fpage>1</fpage>
        <lpage>13</lpage>
        <pub-id pub-id-type="pmid">30606230</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tang</surname>
            <given-names>AD</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Full-length transcript characterization of SF3B1 mutation in chronic lymphocytic leukemia reveals downregulation of retained introns</article-title>
        <source>Nat. Commun.</source>
        <year>2020</year>
        <volume>11</volume>
        <fpage>1</fpage>
        <lpage>12</lpage>
        <pub-id pub-id-type="pmid">31911652</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ruan</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>Fast and accurate long-read assembly with wtdbg2</article-title>
        <source>Nat. Methods</source>
        <year>2019</year>
        <volume>17</volume>
        <fpage>155</fpage>
        <lpage>158</lpage>
        <pub-id pub-id-type="pmid">31819265</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>de la Rubia</surname>
            <given-names>I</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>RATTLE: reference-free reconstruction and quantification of transcriptomes from Nanopore sequencing</article-title>
        <source>Genome Biol.</source>
        <year>2022</year>
        <volume>23</volume>
        <fpage>1</fpage>
        <lpage>21</lpage>
        <pub-id pub-id-type="pmid">34980209</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <mixed-citation publication-type="other">Brown, C. T., Howe, A., Zhang, Q., Pyrkosz, A. B. &amp; Brom, T. H. A reference-free algorithm for computational normalization of shotgun sequencing data. 10.48550/arXiv.1203.4802 (2012).</mixed-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Haas</surname>
            <given-names>BJ</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>De novo transcript sequence reconstruction from RNA-seq using the Trinity platform for reference generation and analysis</article-title>
        <source>Nat. Protoc.</source>
        <year>2013</year>
        <volume>8</volume>
        <fpage>1494</fpage>
        <lpage>1512</lpage>
        <pub-id pub-id-type="pmid">23845962</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Durai</surname>
            <given-names>DA</given-names>
          </name>
          <name>
            <surname>Schulz</surname>
            <given-names>MH</given-names>
          </name>
        </person-group>
        <article-title>Improving in-silico normalization using read weights</article-title>
        <source>Sci. Rep.</source>
        <year>2019</year>
        <volume>9</volume>
        <fpage>1</fpage>
        <lpage>10</lpage>
        <pub-id pub-id-type="pmid">30626917</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sahlin</surname>
            <given-names>K</given-names>
          </name>
        </person-group>
        <article-title>Effective sequence similarity detection with strobemers</article-title>
        <source>Genome Res</source>
        <year>2021</year>
        <volume>31</volume>
        <fpage>2080</fpage>
        <lpage>2094</lpage>
        <pub-id pub-id-type="pmid">34667119</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nip</surname>
            <given-names>KM</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>RNA-Bloom enables reference-free and reference-guided sequence assembly for single-cell transcriptomes</article-title>
        <source>Genome Res</source>
        <year>2020</year>
        <volume>30</volume>
        <fpage>1191</fpage>
        <lpage>1200</lpage>
        <pub-id pub-id-type="pmid">32817073</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <mixed-citation publication-type="other">Pardo-Palacios, F. et al. Systematic assessment of long-read RNA-seq methods for transcript identification and quantification. <italic>Res. Square</italic>10.21203/rs.3.rs-777702/v1 (2021).</mixed-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <mixed-citation publication-type="other">GitHub - nanoporetech/pychopper: A tool to identify, orient, trim and rescue full length cDNA reads. <italic>GitHub</italic><ext-link ext-link-type="uri" xlink:href="https://github.com/nanoporetech/pychopper">https://github.com/nanoporetech/pychopper</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bolger</surname>
            <given-names>AM</given-names>
          </name>
          <name>
            <surname>Lohse</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Usadel</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <article-title>Trimmomatic: a flexible trimmer for Illumina sequence data</article-title>
        <source>Bioinformatics</source>
        <year>2014</year>
        <volume>30</volume>
        <fpage>2114</fpage>
        <lpage>2120</lpage>
        <pub-id pub-id-type="pmid">24695404</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <mixed-citation publication-type="other">Paul, L. <italic>et al</italic>. SIRVs: Spike-In RNA Variants as External Isoform Controls in RNA-Sequencing. Preprint at <italic>bioRxiv</italic> 080747 10.1101/080747 (2016).</mixed-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <mixed-citation publication-type="other">Hafezqorani, S. et al. Trans-NanoSim characterizes and simulates nanopore RNA-sequencing data. <italic>Gigascience</italic><bold>9</bold>, giaa061 (2020).</mixed-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sahlin</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Medvedev</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>Error correction enables use of Oxford Nanopore technology for reference-free transcriptome analysis</article-title>
        <source>Nat. Commun.</source>
        <year>2021</year>
        <volume>12</volume>
        <fpage>2</fpage>
        <pub-id pub-id-type="pmid">33397972</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tardaguila</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>SQANTI: extensive characterization of long-read transcript sequences for quality control in full-length transcriptome identification and quantification</article-title>
        <source>Genome Res</source>
        <year>2018</year>
        <volume>28</volume>
        <fpage>396</fpage>
        <lpage>411</lpage>
        <pub-id pub-id-type="pmid">29440222</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <mixed-citation publication-type="other">Gagalova, K. K. et al. Spruce giga-genomes: structurally similar yet distinctive with differentially expanding gene families and rapidly evolving genes. <italic>Plant J</italic>. 10.1111/tpj.15889 (2022).</mixed-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Stival Sena</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Evolution of gene structure in the conifer Picea glauca: a comparative analysis of the impact of intron size</article-title>
        <source>BMC Plant Biol.</source>
        <year>2014</year>
        <volume>14</volume>
        <fpage>1</fpage>
        <lpage>16</lpage>
      </element-citation>
    </ref>
    <ref id="CR29">
      <label>29.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Niu</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The Chinese pine genome and methylome unveil key features of conifer evolution</article-title>
        <source>Cell</source>
        <year>2022</year>
        <volume>185</volume>
        <fpage>204</fpage>
        <lpage>217.e14</lpage>
        <pub-id pub-id-type="pmid">34965378</pub-id>
      </element-citation>
    </ref>
    <ref id="CR30">
      <label>30.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wick</surname>
            <given-names>RR</given-names>
          </name>
          <name>
            <surname>Judd</surname>
            <given-names>LM</given-names>
          </name>
          <name>
            <surname>Gorrie</surname>
            <given-names>CL</given-names>
          </name>
          <name>
            <surname>Holt</surname>
            <given-names>KE</given-names>
          </name>
        </person-group>
        <article-title>Completing bacterial genome assemblies with multiplex MinION sequencing</article-title>
        <source>Microb. Genomics</source>
        <year>2017</year>
        <volume>3</volume>
        <fpage>e000132</fpage>
      </element-citation>
    </ref>
    <ref id="CR31">
      <label>31.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Whitehill</surname>
            <given-names>JGA</given-names>
          </name>
          <name>
            <surname>Yuen</surname>
            <given-names>MMS</given-names>
          </name>
          <name>
            <surname>Bohlmann</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Constitutive and insect‐induced transcriptomes of weevil‐resistant and susceptible Sitka spruce</article-title>
        <source>Plant-Environ. Interact.</source>
        <year>2021</year>
        <volume>2</volume>
        <fpage>137</fpage>
        <lpage>147</lpage>
      </element-citation>
    </ref>
    <ref id="CR32">
      <label>32.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Manni</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Berkeley</surname>
            <given-names>MR</given-names>
          </name>
          <name>
            <surname>Seppey</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Simão</surname>
            <given-names>FA</given-names>
          </name>
          <name>
            <surname>Zdobnov</surname>
            <given-names>EM</given-names>
          </name>
        </person-group>
        <article-title>BUSCO update: novel and streamlined workflows along with broader and deeper phylogenetic coverage for scoring of eukaryotic, prokaryotic, and viral genomes</article-title>
        <source>Mol. Biol. Evol.</source>
        <year>2021</year>
        <volume>38</volume>
        <fpage>4647</fpage>
        <lpage>4654</lpage>
        <pub-id pub-id-type="pmid">34320186</pub-id>
      </element-citation>
    </ref>
    <ref id="CR33">
      <label>33.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>Minimap2: pairwise alignment for nucleotide sequences</article-title>
        <source>Bioinformatics</source>
        <year>2018</year>
        <volume>34</volume>
        <fpage>3094</fpage>
        <lpage>3100</lpage>
        <pub-id pub-id-type="pmid">29750242</pub-id>
      </element-citation>
    </ref>
    <ref id="CR34">
      <label>34.</label>
      <mixed-citation publication-type="other">Dobin, A. et al. STAR: ultrafast universal RNA-seq aligner. <italic>Bioinformatics</italic><bold>29</bold>, 15–21 (2012).</mixed-citation>
    </ref>
    <ref id="CR35">
      <label>35.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Haas</surname>
            <given-names>BJ</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Automated eukaryotic gene structure annotation using EVidenceModeler and the Program to Assemble Spliced Alignments</article-title>
        <source>Genome Biol.</source>
        <year>2008</year>
        <volume>9</volume>
        <fpage>1</fpage>
        <lpage>22</lpage>
      </element-citation>
    </ref>
    <ref id="CR36">
      <label>36.</label>
      <mixed-citation publication-type="other">Jia, J., Lu, W., Liu, B. et al. An atlas of plant full-length RNA reveals tissue-specific and monocots–dicots conserved regulation of poly(A) tail length. <italic>Nat. Plants</italic><bold>8</bold>, 1118–1126 (2022).</mixed-citation>
    </ref>
    <ref id="CR37">
      <label>37.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hart</surname>
            <given-names>AJ</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>EnTAP: Bringing faster and smarter functional annotation to non-model eukaryotic transcriptomes</article-title>
        <source>Mol. Ecol. Resour.</source>
        <year>2020</year>
        <volume>20</volume>
        <fpage>591</fpage>
        <lpage>604</lpage>
        <pub-id pub-id-type="pmid">31628884</pub-id>
      </element-citation>
    </ref>
    <ref id="CR38">
      <label>38.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Warren</surname>
            <given-names>RL</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Improved white spruce (Picea glauca) genome assemblies and annotation of large gene families of conifer terpenoid and phenolic defense metabolism</article-title>
        <source>Plant J.</source>
        <year>2015</year>
        <volume>83</volume>
        <fpage>189</fpage>
        <lpage>212</lpage>
        <pub-id pub-id-type="pmid">26017574</pub-id>
      </element-citation>
    </ref>
    <ref id="CR39">
      <label>39.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Whitehill</surname>
            <given-names>JGA</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Functions of stone cells and oleoresin terpenes in the conifer defense syndrome</article-title>
        <source>N. Phytol.</source>
        <year>2019</year>
        <volume>221</volume>
        <fpage>1503</fpage>
        <lpage>1517</lpage>
      </element-citation>
    </ref>
    <ref id="CR40">
      <label>40.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kucuk</surname>
            <given-names>E</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Kollector: transcript-informed, targeted de novo assembly of gene loci</article-title>
        <source>Bioinformatics</source>
        <year>2017</year>
        <volume>33</volume>
        <fpage>1782</fpage>
        <lpage>1788</lpage>
        <pub-id pub-id-type="pmid">28186221</pub-id>
      </element-citation>
    </ref>
    <ref id="CR41">
      <label>41.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Vaser</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Sović</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Nagarajan</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Šikić</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Fast and accurate de novo genome assembly from long uncorrected reads</article-title>
        <source>Genome Res</source>
        <year>2017</year>
        <volume>27</volume>
        <fpage>737</fpage>
        <lpage>746</lpage>
        <pub-id pub-id-type="pmid">28100585</pub-id>
      </element-citation>
    </ref>
    <ref id="CR42">
      <label>42.</label>
      <mixed-citation publication-type="other">lh3/seqtk. <italic>GitHub</italic><ext-link ext-link-type="uri" xlink:href="https://github.com/lh3/seqtk">https://github.com/lh3/seqtk</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR43">
      <label>43.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Conway</surname>
            <given-names>JR</given-names>
          </name>
          <name>
            <surname>Lex</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Gehlenborg</surname>
            <given-names>N</given-names>
          </name>
        </person-group>
        <article-title>UpSetR: an R package for the visualization of intersecting sets and their properties</article-title>
        <source>Bioinformatics</source>
        <year>2017</year>
        <volume>33</volume>
        <fpage>2938</fpage>
        <lpage>2940</lpage>
        <pub-id pub-id-type="pmid">28645171</pub-id>
      </element-citation>
    </ref>
    <ref id="CR44">
      <label>44.</label>
      <mixed-citation publication-type="other">GitHub - TransDecoder/TransDecoder: TransDecoder source. <italic>GitHub</italic><ext-link ext-link-type="uri" xlink:href="https://github.com/TransDecoder/TransDecoder">https://github.com/TransDecoder/TransDecoder</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR45">
      <label>45.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <collab>The UniProt Consortium.</collab>
          <etal/>
        </person-group>
        <article-title>UniProt: the universal protein knowledgebase in 2021</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2020</year>
        <volume>49</volume>
        <fpage>D480</fpage>
        <lpage>D489</lpage>
      </element-citation>
    </ref>
    <ref id="CR46">
      <label>46.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Suzek</surname>
            <given-names>BE</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Huang</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>McGarvey</surname>
            <given-names>PB</given-names>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>CH</given-names>
          </name>
        </person-group>
        <article-title>UniRef clusters: a comprehensive and scalable alternative for improving sequence similarity searches</article-title>
        <source>Bioinformatics</source>
        <year>2014</year>
        <volume>31</volume>
        <fpage>926</fpage>
        <lpage>932</lpage>
        <pub-id pub-id-type="pmid">25398609</pub-id>
      </element-citation>
    </ref>
    <ref id="CR47">
      <label>47.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kriventseva</surname>
            <given-names>EV</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>OrthoDB v10: sampling the diversity of animal, plant, fungal, protist, bacterial and viral genomes for evolutionary and functional annotations of orthologs</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2018</year>
        <volume>47</volume>
        <fpage>D807</fpage>
        <lpage>D811</lpage>
      </element-citation>
    </ref>
    <ref id="CR48">
      <label>48.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pruitt</surname>
            <given-names>KD</given-names>
          </name>
          <name>
            <surname>Tatusova</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Brown</surname>
            <given-names>GR</given-names>
          </name>
          <name>
            <surname>Maglott</surname>
            <given-names>DR</given-names>
          </name>
        </person-group>
        <article-title>NCBI Reference Sequences (RefSeq): current status, new features and genome annotation policy</article-title>
        <source>Nucleic Acids Res</source>
        <year>2011</year>
        <volume>40</volume>
        <fpage>D130</fpage>
        <lpage>D135</lpage>
        <pub-id pub-id-type="pmid">22121212</pub-id>
      </element-citation>
    </ref>
    <ref id="CR49">
      <label>49.</label>
      <mixed-citation publication-type="other">Nip, K. M. Simulated data from: Reference-free assembly of long-read transcriptome sequencing data with RNA-Bloom2. Dryad. 10.5061/dryad.cc2fqz68w (2022).</mixed-citation>
    </ref>
    <ref id="CR50">
      <label>50.</label>
      <mixed-citation publication-type="other">Nip, K. M. bcgsc/RNA-Bloom: RNA-Bloom v2.0.0. Zenodo. 10.5281/zenodo.7824726 (2022).</mixed-citation>
    </ref>
  </ref-list>
</back>
<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Nat Commun</journal-id>
    <journal-id journal-id-type="iso-abbrev">Nat Commun</journal-id>
    <journal-title-group>
      <journal-title>Nature Communications</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2041-1723</issn>
    <publisher>
      <publisher-name>Nature Publishing Group UK</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10202958</article-id>
    <article-id pub-id-type="pmid">37217540</article-id>
    <article-id pub-id-type="publisher-id">38553</article-id>
    <article-id pub-id-type="doi">10.1038/s41467-023-38553-y</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Reference-free assembly of long-read transcriptome sequencing data with RNA-Bloom2</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-1574-3363</contrib-id>
        <name>
          <surname>Nip</surname>
          <given-names>Ka Ming</given-names>
        </name>
        <address>
          <email>kmnip@bcgsc.ca</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0003-0553-9227</contrib-id>
        <name>
          <surname>Hafezqorani</surname>
          <given-names>Saber</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-5975-0805</contrib-id>
        <name>
          <surname>Gagalova</surname>
          <given-names>Kristina K.</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-2215-5535</contrib-id>
        <name>
          <surname>Chiu</surname>
          <given-names>Readman</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-5144-7748</contrib-id>
        <name>
          <surname>Yang</surname>
          <given-names>Chen</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-9890-2293</contrib-id>
        <name>
          <surname>Warren</surname>
          <given-names>René L.</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0003-0950-7839</contrib-id>
        <name>
          <surname>Birol</surname>
          <given-names>Inanc</given-names>
        </name>
        <address>
          <email>ibirol@bcgsc.ca</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="GRID">grid.434706.2</institution-id><institution-id institution-id-type="ISNI">0000 0004 0410 5424</institution-id><institution>Canada’s Michael Smith Genome Sciences Centre, BC Cancer, </institution></institution-wrap>Vancouver, BC V5Z 4S6 Canada </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="GRID">grid.17091.3e</institution-id><institution-id institution-id-type="ISNI">0000 0001 2288 9830</institution-id><institution>Bioinformatics Graduate Program, </institution><institution>University of British Columbia, </institution></institution-wrap>Vancouver, BC V5Z 4S6 Canada </aff>
      <aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="GRID">grid.17091.3e</institution-id><institution-id institution-id-type="ISNI">0000 0001 2288 9830</institution-id><institution>Department of Medical Genetics, </institution><institution>University of British Columbia, </institution></institution-wrap>Vancouver, BC V6T 1Z3 Canada </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>22</day>
      <month>5</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>22</day>
      <month>5</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2023</year>
    </pub-date>
    <volume>14</volume>
    <elocation-id>2940</elocation-id>
    <history>
      <date date-type="received">
        <day>7</day>
        <month>8</month>
        <year>2022</year>
      </date>
      <date date-type="accepted">
        <day>8</day>
        <month>5</month>
        <year>2023</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2023</copyright-statement>
      <license>
        <ali:license_ref specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p><bold>Open Access</bold> This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The images or other third party material in this article are included in the article’s Creative Commons license, unless indicated otherwise in a credit line to the material. If material is not included in the article’s Creative Commons license and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this license, visit <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <p id="Par1">Long-read sequencing technologies have improved significantly since their emergence. Their read lengths, potentially spanning entire transcripts, is advantageous for reconstructing transcriptomes. Existing long-read transcriptome assembly methods are primarily reference-based and to date, there is little focus on reference-free transcriptome assembly. We introduce “RNA-Bloom2 [<ext-link ext-link-type="uri" xlink:href="https://github.com/bcgsc/RNA-Bloom">https://github.com/bcgsc/RNA-Bloom</ext-link>]”, a reference-free assembly method for long-read transcriptome sequencing data. Using simulated datasets and spike-in control data, we show that the transcriptome assembly quality of RNA-Bloom2 is competitive to those of reference-based methods. Furthermore, we find that RNA-Bloom2 requires 27.0 to 80.6% of the peak memory and 3.6 to 10.8% of the total wall-clock runtime of a competing reference-free method. Finally, we showcase RNA-Bloom2 in assembling a transcriptome sample of <italic>Picea sitchensis</italic> (Sitka spruce). Since our method does not rely on a reference, it further sets the groundwork for large-scale comparative transcriptomics where high-quality draft genome assemblies are not readily available.</p>
    </abstract>
    <abstract id="Abs2" abstract-type="web-summary">
      <p id="Par2">Most existing long-read transcriptome assembly methods rely on reference genomes and transcript annotations, while reference-free methods remain scarce. Here, Nip et al. introduce RNA-Bloom2, a reference-free method that requires substantially less memory and runtime than other reference-free methods.</p>
    </abstract>
    <kwd-group kwd-group-type="npg-subject">
      <title>Subject terms</title>
      <kwd>Software</kwd>
      <kwd>Genome informatics</kwd>
      <kwd>Data processing</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">https://doi.org/10.13039/501100000038</institution-id>
            <institution>Gouvernement du Canada | Natural Sciences and Engineering Research Council of Canada (Conseil de Recherches en Sciences Naturelles et en Génie du Canada)</institution>
          </institution-wrap>
        </funding-source>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">https://doi.org/10.13039/501100000233</institution-id>
            <institution>Genome British Columbia</institution>
          </institution-wrap>
        </funding-source>
        <award-id>(243FOR</award-id>
        <principal-award-recipient>
          <name>
            <surname>Birol</surname>
            <given-names>Inanc</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">https://doi.org/10.13039/100008762</institution-id>
            <institution>Genome Canada (Génome Canada)</institution>
          </institution-wrap>
        </funding-source>
        <award-id>(243FOR</award-id>
        <principal-award-recipient>
          <name>
            <surname>Birol</surname>
            <given-names>Inanc</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">https://doi.org/10.13039/501100000024</institution-id>
            <institution>Gouvernement du Canada | Canadian Institutes of Health Research (Instituts de Recherche en Santé du Canada)</institution>
          </institution-wrap>
        </funding-source>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">https://doi.org/10.13039/100000002</institution-id>
            <institution>U.S. Department of Health &amp; Human Services | National Institutes of Health (NIH)</institution>
          </institution-wrap>
        </funding-source>
        <award-id>2R01HG007182-04A1</award-id>
        <principal-award-recipient>
          <name>
            <surname>Birol</surname>
            <given-names>Inanc</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© Springer Nature Limited 2023</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1" sec-type="introduction">
    <title>Introduction</title>
    <p id="Par3">RNA sequencing (RNA-seq) has become the standard method for gene/transcript discovery, transcriptome profiling, and isoform expression quantification. Since the dawn of high-throughput short-read sequencing technologies, transcriptome assemblies have enabled the discovery of novel isoforms<sup><xref ref-type="bibr" rid="CR1">1</xref></sup>, identification of foreign RNAs<sup><xref ref-type="bibr" rid="CR2">2</xref></sup>, intra-species gene-fusion transcripts<sup><xref ref-type="bibr" rid="CR3">3</xref></sup> and inter-species chimeric transcripts<sup><xref ref-type="bibr" rid="CR4">4</xref>,<xref ref-type="bibr" rid="CR5">5</xref></sup>, and guided scaffolding<sup><xref ref-type="bibr" rid="CR6">6</xref></sup> and annotation of draft genome assemblies. Such applications have been key in enhancing our understanding of genome biology and the etiology and progression of various diseases.</p>
    <p id="Par4">Pacific Biosciences of California, Inc. (PacBio, Menlo Park, CA) and Oxford Nanopore Technologies PLC (ONT, Oxford, UK) have been offering long-read sequencing technologies commercially since 2011 and 2014, respectively. Both sequencing technologies have improved significantly since their emergence to yield increased read length, base accuracy, and throughput<sup><xref ref-type="bibr" rid="CR7">7</xref></sup>. In particular, ONT’s MinION devices are small and portable, thus having the potential to allow rapid sequencing and downstream analyses<sup><xref ref-type="bibr" rid="CR8">8</xref></sup>. Moreover, nanopore sequencing enables direct RNA (dRNA) sequencing without the need to generate complementary DNA (cDNA) libraries<sup><xref ref-type="bibr" rid="CR9">9</xref></sup>. On the other hand, PacBio’s single-molecule-real-time (SMRT) sequencing provides circular consensus sequencing (CCS) to produce reads that have a lower base error rate than that of ONT reads<sup><xref ref-type="bibr" rid="CR10">10</xref></sup>. As a result, the number of computational methods designed for processing and analyzing long-read sequencing data is growing rapidly<sup><xref ref-type="bibr" rid="CR7">7</xref></sup>.</p>
    <p id="Par5">Compared to Illumina short-read sequencing technologies, long reads are noisier but are several orders of magnitude longer, making them able to span through multiple exons and even capture full-length transcripts in some instances, thus simplifying the transcriptome assembly problem. However, existing transcriptome assemblers, such as StringTie2<sup><xref ref-type="bibr" rid="CR11">11</xref></sup>, are predominantly reference-based where transcripts are derived from spliced-alignment of reads against the reference genome. Genome annotations contain rich information about gene structures that may be utilized for guiding reference-based transcriptome assembly; some examples include: refinement of spliced-alignment based on known splice junctions, inference of transcript strand based on annotated gene orientation, and resolution for antisense transcripts based on known transcription start and end sites. Consequently, a subclass of reference-based assemblers, such as FLAIR<sup><xref ref-type="bibr" rid="CR12">12</xref></sup>, require a genome annotation in addition to the reference genome for accurate isoform reconstruction. Similarly, StringTie2 has the option of incorporating transcriptome annotation to aid its assembly process.</p>
    <p id="Par6">Reference-free assembly of transcriptomes is especially valuable when there is no available reference genome or the reference genome is still at the draft stage, which may not fully support the reference-based assembly of all transcripts in a given transcriptome sequencing sample. In general, long-read reference-free genome assembly algorithms such as wtdbg2<sup><xref ref-type="bibr" rid="CR13">13</xref></sup> (also known as Redbean) are not suitable for transcriptome data because they cannot reconstruct alternative isoforms and they typically assume a uniform sequencing depth, which is practically nonexistent in transcriptomic data due to varying transcript expression levels. Reference-free assembly methods typically rely on read-to-read mapping, whereas reference-based methods rely on read-to-reference alignments. Since read-to-read mapping is much more resource-intensive than read-to-reference alignment, reference-free methods tend to have a much higher computational cost than reference-based methods. To find wider applications, reference-free assembly algorithms need to overcome the challenges in managing computational resources.</p>
    <p id="Par7">Sequence clustering-based assembly follows the divide-and-conquer paradigm and thus it requires less resources than methods that align all reads against each other. RATTLE<sup><xref ref-type="bibr" rid="CR14">14</xref></sup> is an example of such a method, and to the best of our knowledge, it is the only reference-free transcriptome assembler that can assemble transcripts solely from long-read sequencing data. RATTLE clusters input reads into isoform-based (or gene-based) groupings and derives consensus sequences from each read cluster to reconstruct full-length transcripts. Nevertheless, clustering accuracy is an important factor in assembly quality and computational performance. A lenient clustering criterion would create few but large read clusters, resulting in slow runtime, high peak memory, and aggregation of reads from too many genes. A stringent clustering criterion, on the other hand, would create many small clusters, potentially resulting in insufficient aggregation of reads and incomplete transcript reconstruction.</p>
    <p id="Par8">Digital normalization<sup><xref ref-type="bibr" rid="CR15">15</xref></sup>, also known as in silico read normalization, is a simple but effective method to improve the computational performance of reference-free assemblers by reducing the number of overrepresented reads, such as those of high-expressed transcripts, based on the saturation of <italic>k</italic>-mers in the reads. In contrast to naive subsampling, digital normalization is better at preserving low-expression transcripts. However, it has been primarily utilized for the assembly of short-read RNA-seq data<sup><xref ref-type="bibr" rid="CR16">16</xref>,<xref ref-type="bibr" rid="CR17">17</xref></sup>. With the introduction of strobemers<sup><xref ref-type="bibr" rid="CR18">18</xref></sup> as a mismatch and indel tolerant alternative to <italic>k</italic>-mers, digital normalization with strobemers should be highly applicable to transcriptome assembly of noisy long reads.</p>
    <p id="Par9">Here we present RNA-Bloom2, the successor to our short-read transcriptome assembly tool, RNA-Bloom<sup><xref ref-type="bibr" rid="CR19">19</xref></sup>, that extends support for reference-free transcriptome assembly of bulk RNA long sequencing reads. RNA-Bloom2 offers both memory- and time-efficient assembly by utilizing digital normalization of long reads with strobemers. Our benchmarking shows that RNA-Bloom2 requires 27.0–80.6% of the peak memory and 3.6–10.8% of the total wall-clock runtime of RATTLE. In simulated datasets, RNA-Bloom2 has 1.5–7.3% higher recall and 0.3–1.5% lower false discovery rates than RATTLE. In the spike-in datasets, RNA-Bloom2 has 5.7–17.6% higher recall than RATTLE. Finally, we showcase RNA-Bloom2 in assembling a transcriptome sample of <italic>Picea sitchensis</italic> (Sitka spruce), without using a genomic reference.</p>
  </sec>
  <sec id="Sec2" sec-type="results">
    <title>Results</title>
    <sec id="Sec3">
      <title>Reference-free transcriptome assembly with RNA-Bloom2</title>
      <p id="Par10">RNA-Bloom2’s six-stage workflow for the reference-free transcriptome assembly of long reads is summarized in Fig. <xref rid="Fig1" ref-type="fig">1</xref>. In stage one, long reads are corrected for errors in an alignment-free approach based on a Bloom filter de Bruijn graph of <italic>k</italic>-mers derived from input reads. Short reads can be optionally provided to aid in the error correction of long reads. In stage two, the set of corrected reads is digitally normalized with strobemers, such that overrepresented reads are removed to yield a target read depth. Stages one and two are highly integrated to reduce input-output operations. Since only a portion of corrected reads would be retained by digital normalization, stage one is not meant to exhaustively correct all errors in the reads and is instead intended to be fast and memory-efficient. In stage three, reads in the normalized set are overlapped against each other to identify low-depth regions in the reads to be trimmed or split. In stage four, trimmed reads are overlapped against each other to generate an overlap graph where reads on each unambiguous path are assembled into a “unitig”. In stage five, the unitigs, which may still contain errors, are polished using the alignments of corrected reads from stage one. In stage six, the polished unitigs are aligned against each other to generate an overlap graph where transcripts are derived based on the length-normalized read depth of the unitigs. If the reads are produced by the cDNA sequencing protocol, sequences containing potential poly(A) tails are identified in order to prune the overlap graphs in stages four and six. A more detailed description of each stage is provided in the Methods section. It is important to note that all-versus-all sequence comparisons in RNA-Bloom2 are performed after digital normalization, as opposed to after sequence clustering as in RATTLE. Since the number of sequences retained after digital normalization is expected to be much lower than the number of raw input reads, sequence clustering is not necessary for RNA-Bloom2.<fig id="Fig1"><label>Fig. 1</label><caption><title>RNA-Bloom2 assembly workflow overview.</title><p>The long-read assembly workflow of RNA-Bloom2 consists of six stages. In stage 1, input long reads are corrected for errors using a de Bruijn graph, where erroneous <italic>k</italic>-mers (red circles) are replaced with <italic>k</italic>-mers of higher multiplicities (blue circles). The de Bruijn graph can optionally include <italic>k</italic>-mers from short reads if provided. In stage 2, corrected reads are digitally normalized to select a subset of reads (blue rectangles). In stage 3, normalized reads are trimmed and splitted at regions of low read depth (red rectangles). In stage 4, an overlap graph of trimmed reads is generated to assemble unambiguous paths into unitigs (blue paths). In stage 5, residual errors (red squares) in unitigs are polished using alignments of corrected reads from stage 1. In stage 6, an overlap graph of polished unitigs is generated to assemble alternative transcripts (orange and green paths).</p></caption><graphic xlink:href="41467_2023_38553_Fig1_HTML" id="d32e455"/></fig></p>
    </sec>
    <sec id="Sec4">
      <title>Evaluation of error correction and digital normalization</title>
      <p id="Par11">We evaluated the effectiveness of the error correction and digital normalization stages of RNA-Bloom2 using experimental data. We selected one mouse dataset from the Long-read RNA-Seq Genome Annotation Assessment Project (LRGASP) Consortium<sup><xref ref-type="bibr" rid="CR20">20</xref></sup> containing the matching sequencing data for ONT cDNA, ONT dRNA, PacBio CCS, and Illumina reads of the same biological sample (Supplementary Table <xref rid="MOESM1" ref-type="media">1</xref>). ONT dRNA and PacBio CCS reads do not contain adapters, but ONT cDNA reads and Illumina reads are trimmed for adapters with Pychopper<sup><xref ref-type="bibr" rid="CR21">21</xref></sup> and Trimmomatic<sup><xref ref-type="bibr" rid="CR22">22</xref></sup>, respectively (Supplementary Method <xref rid="MOESM1" ref-type="media">1</xref>). Out of the three long-read samples, the ONT cDNA sample has the largest number of sequencing reads (13,127,667 reads) but the lowest read alignment rate (78.66%) against the combined reference genome for mouse GRCm39 and Lexogen’s Spike-In RNA Variant (SIRV) transcripts<sup><xref ref-type="bibr" rid="CR23">23</xref></sup> from the LRGASP consortium (Synapse accession “<ext-link ext-link-type="uri" xlink:href="https://www.synapse.org/#!Synapse:syn25683365">syn25683365</ext-link>”). Compared to the ONT cDNA sample, the ONT dRNA and PacBio CCS samples have only one-sixth of the reads (2,153,439 reads and 2,144,172 reads, respectively) but higher read alignment rates (95.58% and 95.49%, respectively) against the reference genome. The Illumina sample has 40,225,298 read pairs (2 × 100 nucleotides (nt)) and is only used for the hybrid error correction of the long reads in RNA-Bloom2.</p>
      <p id="Par12">We first assess both methods of alignment-free error correction in RNA-Bloom2: (i) using only long reads, and (ii) using a hybrid of long and short reads. We investigated the nucleotide base error rates of the reads before and after error correction (Supplementary Table <xref rid="MOESM1" ref-type="media">2</xref>); error rates are measured by Trans-NanoSim<sup><xref ref-type="bibr" rid="CR24">24</xref></sup> (Supplementary Method <xref rid="MOESM1" ref-type="media">2</xref>). The error rates of the reads before error correction in the ONT dRNA, ONT cDNA, and PacBio CCS samples are 12.17%, 7.18%, and 1.96%, respectively. Long-read-only error correction has reduced the error rates to 10.28%, 4.03%, and 1.35% for the ONT dRNA, ONT cDNA, and PacBio CCS samples, respectively. As expected, hybrid error correction has resulted in even lower error rates of 6.55%, 3.51%, and 1.34% for the ONT dRNA, ONT cDNA, and PacBio CCS samples, respectively. Long-read-only error correction has the largest reduction (−3.15%) in the error rate in the ONT cDNA sample, whereas hybrid error correction has the largest reduction (−5.62%) in the error rate in the ONT dRNA sample.</p>
      <p id="Par13">We next investigated the percentage of reads remaining after digital normalization and the percentage of input reads aligned to the final assembly (Supplementary Table <xref rid="MOESM1" ref-type="media">3</xref>, Supplementary Method <xref rid="MOESM1" ref-type="media">3</xref>). For assemblies with long-read-only error correction, 48.15%, 3.76%, and 11.66% of reads remained after digital normalization in the ONT dRNA, ONT cDNA, and PacBio CCS samples, respectively. For assemblies with hybrid error correction, 38.80%, 3.53%, and 11.63% of reads remained after digital normalization in the ONT dRNA, ONT cDNA, and PacBio CCS samples, respectively. The ONT dRNA assemblies have the highest percentages of reads remaining after digital normalization. This is likely due to the much higher error rate in the reads, which limits the number of matching strobemers among the reads. Despite the fact that a substantial proportion of reads are removed by digital normalization, 97.44–97.54% and 95.04–95.16% of input reads are still able to align to the final assemblies for the ONT dRNA and PacBio CCS samples, respectively. Although 73.52–74.02% of input reads aligned the final assembly for the ONT cDNA sample, it is important to note that only 78.66% of reads in the sample were aligned against the reference genome. These results confirm that digital normalization in RNA-Bloom2 is effective in removing overrepresented reads from long-read transcriptome sequencing data.</p>
      <p id="Par14">Finally, we assess how well digital normalization preserves the number of genes represented in reads, using the same experimental samples as before. For a given set of reads, the number of represented genes is defined as the number of genes with expression levels above zero (Supplementary Method <xref rid="MOESM1" ref-type="media">9</xref>). The results are summarized in Supplementary Table <xref rid="MOESM1" ref-type="media">4</xref>. Overall, the number of genes represented in the digitally normalized reads is 95.6–98.3% of those in the raw reads. It is important to note that error correction already lowers the gene representation (due to filtering of reads with low <italic>k</italic>-mer multiplicities) prior to digital normalization. In general, the majority of genes discarded are very lowly expressed, and their expression levels are predominantly lower than those of genes retained (See Supplementary Table <xref rid="MOESM1" ref-type="media">13</xref>). Since only a small proportion of reads remains after digital normalization, the 1.7–4.4% reduction in gene representation is within our expectations.</p>
    </sec>
    <sec id="Sec5">
      <title>Assembly benchmarking with simulated datasets</title>
      <p id="Par15">We benchmarked the assembly quality and the computational performance of RNA-Bloom2 on simulated data. Assembly quality is measured based on the metrics described in Table <xref rid="Tab1" ref-type="table">1</xref>. The assembly evaluation procedure is described in the Methods section. We prepared two mouse-simulated datasets with Trans-NanoSim<sup><xref ref-type="bibr" rid="CR24">24</xref></sup> for the cDNA and dRNA sequencing protocols modeled on experimental ONT data (See Methods). To investigate the effect of sequencing depth, we subsampled each dataset to 2, 10, and 18 million reads, resulting in a total of six sets of reads for our benchmarking experiments. The features of the simulated datasets are presented in Supplementary Table <xref rid="MOESM1" ref-type="media">5</xref>. Compared to the cDNA dataset, the dRNA dataset has a higher error rate, longer N50 read length, and fewer simulated transcripts.<table-wrap id="Tab1"><label>Table 1</label><caption><p>Transcriptome assembly quality assessment metrics</p></caption><table frame="hsides" rules="groups"><thead><tr><th>Metric</th><th>Definition</th></tr></thead><tbody><tr><td>Complete reconstruction</td><td>Truth set transcript reconstructed at least 95% in length</td></tr><tr><td>Partial reconstruction</td><td>Truth set transcript reconstructed between 0 and 95% in length</td></tr><tr><td>Missing reconstruction or false negative (FN)</td><td>Truth set transcript with no detectable reconstruction</td></tr><tr><td>True positive (TP)</td><td>Truth set transcript with complete or partial reconstruction</td></tr><tr><td>False positive (FP)</td><td>Reference transcript not in the truth set</td></tr><tr><td>Misassembly (MA)</td><td>Incorrectly assembled contig with segments from one or more reference transcripts. It can be intragenic or intergenic.</td></tr><tr><td>Intragenic misassembly</td><td>Incorrectly assembled contig with segments from reference transcripts of the same gene</td></tr><tr><td>Intergenic misassembly</td><td>Incorrectly assembled contig with segments from reference transcripts of different genes</td></tr><tr><td>Large indel (LI)</td><td>Contigs with at least one large indel (&gt; 70 nt) compared to the best-aligning reference transcript. Large indels can arise from sequencing errors, alternative donors/acceptors, skipped exons, and retained introns.</td></tr><tr><td>Unclassified (UC)</td><td>Contigs with no alignments against reference transcripts. These contigs can arise from noise or incorrect error correction.</td></tr><tr><td>Recall</td><td>Percentage of truth set transcripts reconstructed.</td></tr><tr><td>False discoveries (FD)</td><td>= FP + MA + LI + UC</td></tr><tr><td>False discovery rate (FDR)</td><td>= FD / (FD + TP)</td></tr><tr><td>F1</td><td>= TP / [TP + 0.5 * (FD + FN)]</td></tr><tr><td>Redundancy</td><td>= (contigs representing TP) / TP</td></tr></tbody></table><table-wrap-foot><p>These metrics are intended for sequencing data with a known ground truth where true-positives and false-positives can be easily discerned. The truth set transcripts are either the set of simulated transcripts or the set of spike-in transcripts in real data.</p></table-wrap-foot></table-wrap></p>
      <p id="Par16">Using the two-million simulated read sets, we illustrate the value of reference-free transcriptome assembly by comparing RNA-Bloom2 against isONcorrect<sup><xref ref-type="bibr" rid="CR25">25</xref></sup>, which is an error-correction tool designed for ONT transcriptome data. Commands for running both tools are described in Supplementary Method <xref rid="MOESM1" ref-type="media">10</xref>. We evaluated the number of complete transcripts and false discoveries detected for both tools (Supplementary Fig. <xref rid="MOESM1" ref-type="media">1</xref>). For cDNA data, output reads of isONcorrect have 7104 complete transcripts and 4852 false discoveries, whereas the RNA-Bloom2 assembly has 8929 complete transcripts and 4028 false discoveries. For dDNA data, output reads of isONcorrect have 7646 complete transcripts and 2606 false discoveries, whereas the RNA-Bloom2 assembly has 11,157 complete transcripts and 2559 false discoveries. Overall, RNA-Bloom2 offers 25.7–45.9% increase in complete transcripts and 1.8–17.0% reduction in false discoveries compared to isONcorrect. Although long reads often span multiple exons, our results show that transcriptome assembly is valuable to reference-free analysis of long-read transcriptome data.</p>
      <p id="Par17">We then compared RNA-Bloom2 against three other transcriptome assembly tools designed for long reads: RATTLE, StringTie2, and FLAIR. RATTLE is the only other reference-free method, whereas StringTie2 and FLAIR are entirely reference-based. In addition, all FLAIR assemblies were guided by the reference transcriptome annotation in conjunction with the associated reference genome. StringTie2 was run in two different modes: with and without the transcriptome annotation, which are denoted as “StringTie2_GTF” and “StringTie2” from hereon. Since reference-based methods are expected to perform better than reference-free methods, StringTie2, StringTie2_GTF, and FLAIR serve as the baseline for evaluating the performance of RNA-Bloom2 and RATTLE. All assembly methods were run with 48 threads using the same compute nodes with the exception of FLAIR and RATTLE for the assemblies of the 18 million-read sets, which were reprocessed on a high-memory machine after failing the initial runs. The assembly evaluation procedure is described in the Methods section. Commands for all methods and computing hardware are documented in Supplementary Method <xref rid="MOESM1" ref-type="media">6</xref>.</p>
      <p id="Par18">The computational performance of all five assembly methods is summarized in Fig. <xref rid="Fig2" ref-type="fig">2</xref> and Supplementary Tables <xref rid="MOESM1" ref-type="media">6</xref> and <xref rid="MOESM1" ref-type="media">7</xref>. StringTie2 and StringTie2_GTF performed similarly and they have the fastest runtimes and consistently low peak-memory usage for all datasets. FLAIR has the worst peak-memory usages and RATTLE has the worst total runtimes. As expected, reference-based assemblers are faster than reference-free assemblers. RNA-Bloom2 has the lowest memory usage for the 2 million-read cDNA dataset. The peak memory usage and total runtimes of RATTLE are 1.24–3.70 and 9.22–28.12 times of those of RNA-Bloom2, respectively. Both RNA-Bloom2 and RATTLE require a higher peak-memory usage in assembling the dRNA datasets than the cDNA datasets, possibly due to the higher error rate and higher N50 read length of the dRNA datasets. However, the peak memory of RNA-Bloom2 for the dRNA datasets did not increase exponentially with respect to the number of input reads. This suggests that the digital normalization stage in RNA-Bloom2 is effective in reducing the number of reads because the number of transcripts in the 10 million-read set and the 18 million-read set only differs by 210 (Supplementary Table <xref rid="MOESM1" ref-type="media">5</xref>).<fig id="Fig2"><label>Fig. 2</label><caption><title>Computational performance on simulated datasets.</title><p>All assemblers were run with 48 threads and assemblies were generated for 2, 10, and 18 million simulated reads of cDNA and dRNA samples. Peak memory usage was measured in gigabytes (GB), and runtime was measured in wall-clock hours. Both axes are in logarithmic scale. For StringTie2, StringTie2_GTF, and FLAIR, performance figures include read alignment and generation of indexed BAM files. Source data are provided as a Source Data file.</p></caption><graphic xlink:href="41467_2023_38553_Fig2_HTML" id="d32e707"/></fig></p>
      <p id="Par19">The benchmarking results for simulated data are presented in Fig. <xref rid="Fig3" ref-type="fig">3</xref>. The trends for recall are similar for both simulated cDNA and dRNA datasets (Fig. <xref rid="Fig3" ref-type="fig">3a</xref>). RNA-Bloom2 has higher percentages (+1.5 to +7.3%) of complete reconstruction than RATTLE in all simulated samples. The largest difference is observed in the 18 million-read cDNA sample, whereas the smallest difference is observed in the 2 million-read cDNA sample. RNA-Bloom2 also has lower percentages (–9.2 to –11.9%) of missing transcripts than RATTLE in all samples. Behind StringTie2_GTF and FLAIR, RNA-Bloom2 has the third smallest percentages of missing transcripts (41.3–57.0% for cDNA sets and 24.5–49.5% for dRNA sets). For both cDNA and dRNA datasets, StringTie2_GTF has the highest percentages of complete reconstruction (46.2–79.9%) and the smallest percentages of partial reconstruction (4.3–11.4%). However, StringTie2 has the highest percentage of missing transcripts in all cDNA (57.4–68.5%) and dRNA (41.8–56.8%) samples.<fig id="Fig3"><label>Fig. 3</label><caption><title>Assembly quality evaluation of simulated datasets.</title><p><bold>a</bold> Recall is measured with respect to transcription reconstruction levels. <bold>b</bold> False discovery rate is measured based on the numbers of intragene and intergene misassemblies, false positive reference transcripts, contigs with large indels, and unclassified contigs. <bold>c</bold> F1 scores. <bold>d</bold> Redundancy is defined as the number of contigs representing true-positive transcripts with complete or partial reconstruction divided by true-positive transcripts with complete or partial reconstruction. Source data are provided as a Source Data file.</p></caption><graphic xlink:href="41467_2023_38553_Fig3_HTML" id="d32e737"/></fig></p>
      <p id="Par20">We further investigated assembly recall with respect to transcript expression levels. We assigned simulated transcripts to expression quartiles: low, medium-low, medium-high, and high. The expression-stratified assembly recall results for simulated cDNA and dRNA datasets are presented in Supplementary Figs. <xref rid="MOESM1" ref-type="media">2</xref> and <xref rid="MOESM1" ref-type="media">3</xref>, respectively. StringTie2_GTF has the most complete reconstruction in all four expression quartiles for both cDNA and dRNA datasets. RNA-Bloom2 has higher percentages of complete reconstruction than RATTLE in the high and medium-expression expression quartiles, with the exception of the 2 million-read cDNA sample. However, the opposite was observed in the low quartiles. In the high expression quartile, FLAIR has the lowest percentage of complete reconstruction except for the 2 million-read cDNA sample, but it has the second-lowest percentage of missing reconstruction. In the low expression quartiles, RNA-Bloom2 has the lowest percentages of complete reconstruction, but both annotation-guided approaches, StringTie2_GTF and FLAIR, are the two best-performing methods.</p>
      <p id="Par21">We also evaluated false-discovery rates (FDR), F1, and redundancy (Fig. <xref rid="Fig3" ref-type="fig">3b–d</xref>) for the five methods. RNA-Bloom2 has lower FDR (–1.3 to –1.5% for cDNA sets, –0.3 to –1.0% for dRNA sets) compared to RATTLE across all samples. StringTie2 has the highest FDR (9.6 to 14.2% for cDNA sets, 8.9 to 12.9% for dRNA sets), but the FDR of StringTie2_GTF are much lower (2.7–3.5% for cDNA sets, 3.1 to 6.5% for dRNA sets). While StringTie_GTF has much reduced misassemblies and large indel contigs compared to StringTie2, its false discoveries are primarily contributed by false positive reference transcripts. FLAIR has the lowest FDR in all simulated samples (0.2–0.6%). The F1 scores of RNA-Bloom2 are higher (+9.2 to +10.0% for cDNA sets, +7.5 to +10.5 for dRNA sets) than those of RATTLE. StringTie2_GTF has the highest F1 scores (72.3–83.6% for cDNA sets, 81.3–88.4% for dRNA sets), whereas StringTie2 has the lowest F1 scores (46.6–56.5% for cDNA sets, 58.4–68.8% for dRNA sets). RNA-Bloom2 has lower redundancy (−0.2 to −0.7 for cDNA sets, −0.1 to −0.4 for dRNA sets) than RATTLE.</p>
      <p id="Par22">StringTie2_GTF and StringTie2 have the lowest redundancy (1.0–1.1 and 1.1–1.3, respectively), while FLAIR and RATTLE have the highest redundancy (1.3–1.8 and 1.2–1.9, respectively). The high redundancy of FLAIR and RATTLE is potentially a result of larger numbers of contigs assembled (Supplementary Table <xref rid="MOESM1" ref-type="media">11</xref>). However, the number of contigs per gene is similar to the number of transcripts per gene in the ground truth for multi-transcript genes (Supplementary Fig. <xref rid="MOESM1" ref-type="media">9</xref>).</p>
      <p id="Par23">Finally, we assess the isoform assembly precision based on the transcript models in the simulated data. The precision metric is calculated using the isoform classification from SQANTI3<sup><xref ref-type="bibr" rid="CR26">26</xref></sup> (see Methods for details). Our results are summarized in Supplementary Fig. <xref rid="MOESM1" ref-type="media">8</xref>. StringTie2_GTF and FLAIR have the highest isoform assembly precision (87.1–93.6% and 84.7–92.4%, respectively). RNA-Bloom2 has the lowest precision (75.9%) in the 18 M dRNA sample while RATTLE has the lowest precision (76.6–81.0%) in all other samples, where RNA-Bloom2’s precisions are +2.1 to +9.2% higher.</p>
    </sec>
    <sec id="Sec6">
      <title>Assembly benchmarking with spike-in control data</title>
      <p id="Par24">In addition to simulated data, we also benchmarked the four assembly methods on experimental sequencing data of known sequences. We selected one mouse dataset from the LRGASP Consortium containing the matching sequencing data for ONT cDNA, ONT dRNA, and PacBio CCS of the same biological sample. The sequencing samples for this dataset were spiked with Lexogen’s Spike-In RNA Variant (SIRV) transcripts<sup><xref ref-type="bibr" rid="CR23">23</xref></sup> containing 92 External RNA Control Consortium (ERCC) spike-ins, 69 SIRV isoforms, and 15 long SIRVs. We extracted the reads corresponding to the spike-ins (See Methods) for assembly benchmarking and the features of the spike-in datasets are summarized in Supplementary Table <xref rid="MOESM1" ref-type="media">8</xref>. The PacBio CCS sample has the longest N50 read length (2,460 nt) and the lowest error rate (2.03%). The ONT cDNA sample has the shortest N50 read length (712 nt) but the highest number of reads (<italic>n</italic> = 404,783). The ONT dRNA sample has the fewest reads (<italic>n</italic> = 26,814) and the highest error rate (11.01%).</p>
      <p id="Par25">We evaluated the assembly quality of the spike-in samples based on the metrics described in Table <xref rid="Tab1" ref-type="table">1</xref>, and the benchmarking results are presented in Fig. <xref rid="Fig4" ref-type="fig">4</xref>. The trends for recall are similar across platforms (Fig. <xref rid="Fig4" ref-type="fig">4a</xref>). In all three samples, StringTie2_GTF has the highest percentages of complete reconstruction (55.1–76.1%). RNA-Bloom2 has higher percentages of complete reconstruction (+5.7 to +17.6%) than RATTLE in all three samples; RNA-Bloom2 ranks the second highest in both ONT samples. RNA-Bloom2 has the smallest percentage of missing reconstruction in the ONT cDNA sample (25.6%) while StringTie2_GTF has the smallest percentages of missing reconstruction in the ONT dRNA and PacBio CCS samples (42.0% and 23.9%, respectively).<fig id="Fig4"><label>Fig. 4</label><caption><title>Assembly quality evaluation of spike-in control datasets.</title><p><bold>a</bold> Recall, <bold>b</bold> false discovery rates, <bold>c</bold> F1 scores, and <bold>d</bold> redundancy were evaluated for each assembly method on spike-in control data generated from three sequencing technologies: ONT direct RNA, ONT cDNA, and PacBio CCS. The spike-in control data were extracted from a mouse dataset from the LRGASP Consortium. Source data are provided as a Source Data file.</p></caption><graphic xlink:href="41467_2023_38553_Fig4_HTML" id="d32e818"/></fig></p>
      <p id="Par26">Overall, false discoveries (Fig.  <xref rid="Fig4" ref-type="fig">4b</xref>) are predominantly attributed to intragenic misassemblies and large indel contigs. RNA-Bloom2 assemblies contain unclassified contigs that cannot be aligned to the reference spike-in transcripts. Unlike the simulated datasets, there are no false-positive reference transcripts because all reference spike-in transcripts are true positives. StringTie2_GTF has the lowest false-discovery rates (FDR) in all three samples (0–4.3%). StringTie2 has the highest FDR in the ONT dRNA and cDNA samples (25.6% and 20.6%, respectively) while RATTLE has the highest FDR in the PacBio CCS sample (16.3%). RNA-Bloom2 has the second highest FDR in the ONT cDNA sample (20.4%). Both FLAIR and RNA-Bloom2 have over seven times higher FDR in the ONT cDNA sample than in the ONT dRNA and PacBio CCS samples. StringTie2_GTF has the highest F1 scores in all samples (73.4–86.5%). RNA-Bloom2 has the second highest F1 scores in ONT dRNA and PacBio CCS samples (64.2% and 80.3%, respectively), but it has the lowest F1 score in the ONT cDNA sample (51.4%). RATTLE has the lowest F1 score in the PacBio CCS samples (65.5%) and StringTie2 has the lowest F1 score in the ONT dRNA sample (46.5%).</p>
      <p id="Par27">StringTie2_GTF and StringTie2 have the lowest redundancy in all samples (1.1–1.2). RNA-Bloom2 has the highest redundancy in all three samples (2.1, 3.6, 1.6 in ONT dRNA, ONT cDNA, and PacBio CCS, respectively), +0.5 to +1.7 higher than RATTLE. In particular, RNA-Bloom2’s redundancy is predominantly contributed by partially reconstructed transcripts in the ONT cDNA sample, but its redundancy is predominantly contributed by completely reconstructed transcripts in the ONT dRNA and PacBio CCs samples. The high redundancy of RNA-Bloom2 assemblies is potentially due to the substantially higher number of contigs assembled (Supplementary Table <xref rid="MOESM1" ref-type="media">12</xref>). Although the degree of redundancy varies from one method to another, all assembly methods do not follow the number of transcripts per gene in the ground truth (Supplementary Fig. <xref rid="MOESM1" ref-type="media">10</xref>). This is different from what was observed in the simulated data, and we speculate that this is a result of the small number of the spike-ins.</p>
    </sec>
    <sec id="Sec7">
      <title>Assembly evaluation in mouse experimental sample replicates</title>
      <p id="Par28">Using each assembly method, we have assembled individual replicates of mouse experimental samples from the LRGASP consortium for ONT cDNA, ONT dRNA, and PacBio CCS platforms. These are the same samples where the spike-in control dataset was extracted (Supplementary Method <xref rid="MOESM1" ref-type="media">5</xref>). For PacBio replicates, RATTLE performed gene-based clustering instead of isoform-based clustering, which did not run to completion in our initial attempts. We assess the assemblies with SQANTI3 (Supplementary Method <xref rid="MOESM1" ref-type="media">11</xref>) and our results are summarized in Supplementary Figs. <xref rid="MOESM1" ref-type="media">11</xref>–<xref rid="MOESM1" ref-type="media">13</xref>. RNA-Bloom2 recovered a higher number of annotated genes compared to RATTLE in all three platforms. Compared to reference-free methods, reference-based methods have substantially higher numbers of novel genes in ONT cDNA and PacBio CCS platforms. FLAIR has the highest number of known canonical splice junctions in all three platforms; RNA-Bloom2 is a close second in the PacBio CCS platform. Compared to reference-based methods, reference-free methods have substantially higher numbers of non-canonical splice junctions; RNA-Bloom2 has the highest in the ONT cDNA platform. The proportion of non-canonical splice junctions in RNA-Bloom2 is particularly higher than other categories in the ONT cDNA platform (Supplementary Fig. <xref rid="MOESM1" ref-type="media">14</xref>). RNA-Bloom2 has the most full-splice match isoforms and incomplete-splice match isoforms. FLAIR has the most novel in-catalog isoforms. RNA-Bloom2 has the most novel not-in-catalog isoforms and genic-genomic isoforms. All methods have few antisense isoforms. StringTie2 has the most antisense isoforms in the ONT cDNA platform, while RNA-Bloom2 has the most antisense isoforms in the other two platforms. Compared to reference-free methods, reference-based methods have substantially higher numbers of intergenic isoforms in ONT cDNA and PacBio CCS platforms. All methods have relatively low numbers genic-intron isoforms; StringTie2 and StringTie2_GTF have the most in all three platforms.</p>
    </sec>
    <sec id="Sec8">
      <title>Reference-free assembly of a Sitka spruce transcriptome</title>
      <p id="Par29">The Sitka spruce (<italic>Picea sitchensis</italic>) is a large, evergreen, and long-living conifer species native to the Pacific Northwest in North America. Although a 20 Gbp draft genome assembly is publicly available<sup><xref ref-type="bibr" rid="CR27">27</xref></sup>, its scaffold N50 length is 56.8 kbp, which reflects the draft stage of this short-read genome assembly. In particular, the Sitka spruce’s alternative splicing pattern has not been fully investigated. Since conifers are known for their long introns<sup><xref ref-type="bibr" rid="CR28">28</xref>,<xref ref-type="bibr" rid="CR29">29</xref></sup>, the fragmented draft genome would highly limit the effectiveness of reference-based transcriptome assembly methods. Thus, it is a valuable use case to illustrate the utility of reference-free transcriptome assembly methods. Using RNA-Bloom2 and RATTLE, we assembled RNA-seq data from mixed tissue (young needle, bark, xylem, and mature needle) cDNA sampled from a Sitka spruce Q903 spruce weevil-susceptible individual, originated from Haida Gwaii, British Columbia, Canada (53.917, −132.083). The cDNA sample was sequenced on a ONT MinION device (R9.4 flow cell) and the reads are basecalled with Guppy (See Methods and Supplementary Method <xref rid="MOESM1" ref-type="media">7</xref>). A total of 1,323,043 ONT reads with N50 read length of 1,543 nt remained after adapter-trimming with Porechop<sup><xref ref-type="bibr" rid="CR30">30</xref></sup>. We also performed an additional RNA-Bloom2 assembly with hybrid error correction using Illumina paired-end RNA-seq data from a previous study<sup><xref ref-type="bibr" rid="CR31">31</xref></sup>.</p>
      <p id="Par30">First, we measured the completeness of single-copy orthologs with BUSCO<sup><xref ref-type="bibr" rid="CR32">32</xref></sup> for the adapter-trimmed ONT reads, the two RNA-Bloom2 assemblies, and the RATTLE assembly (Supplementary Method <xref rid="MOESM1" ref-type="media">7</xref>). BUSCO provides a quantitative assessment of expected gene content for each set of transcript sequences, and the results are summarized in Supplementary Table <xref rid="MOESM1" ref-type="media">9</xref>. The RNA-Bloom2 assembly with hybrid error correction has the highest percentage of complete BUSCO and the lowest percentages of fragmented and missing BUSCO. Specifically, the complete BUSCO has improved from 73.4% in the adapter-trimmed reads to 87.6% in the RNA-Bloom2 assembly, whereas the percentages of fragmented and missing BUSCO in the reads (7.7% and 18.9%) have reduced by half after assembly with RNA-Bloom2 (3.4% and 9.0%). On the other hand, the RNA-Bloom2 assembly with long-read-only error correction has a higher percentage of complete BUSCO and lower percentages of fragmented and missing BUSCO than the input reads and the RATTLE assembly. Compared to the reads, the RATTLE assembly has a lower percentage of complete BUSCO and higher percentages fragmented and missing BUSCO.</p>
      <p id="Par31">We have selected the RNA-Bloom2 assembly with hybrid error correction for further analyses. This transcriptome assembly has a total of 68,514 transcripts, where 98.95% of adapter-trimmed reads were aligned to the transcriptome assembly with minimap2<sup><xref ref-type="bibr" rid="CR33">33</xref></sup> (Supplementary Method <xref rid="MOESM1" ref-type="media">3</xref>). We also aligned the assembled transcripts against the draft genome with minimap2 (Supplementary Table <xref rid="MOESM1" ref-type="media">10</xref>). A total of 66,866 (97.59%) assembled transcripts were aligned to the draft genome. Of these aligned transcripts, 21,423 (32.04%) transcripts have at least one split-alignments. Since split-alignments on a high-quality genomic reference typically indicate incorrectly assembled transcripts, we compared these split-alignments of assembled transcripts to STAR<sup><xref ref-type="bibr" rid="CR34">34</xref></sup> alignments of the Illumina paired-end RNA-seq data against the draft genome. We found that 13,376 (62.44%) transcripts with split-alignments contain at least one split supported by at least one STAR alignment (Supplementary Method <xref rid="MOESM1" ref-type="media">7</xref>). This suggests that these transcripts were correctly assembled and the majority of split-alignments is likely a result of fragmented genic regions in the draft genome.</p>
      <p id="Par32">To understand the gene structure of transcripts contained in the genomic scaffolds, we supplied the RNA-Bloom2 assembly with hybrid error correction as full-length RNA sequences to PASA<sup><xref ref-type="bibr" rid="CR35">35</xref></sup> to create a transcript structure annotation based on the draft genome. It is important to note that this annotation produced by PASA is only a partial representation of the Sitka spruce transcriptome due to fragmented genic regions. PASA generated an annotation consisting of 15,222 genes, 18,991 transcripts, 58,049 unique exons, 37,090 unique introns, and 19,079 poly(A) tails (Fig. <xref rid="Fig5" ref-type="fig">5a</xref>). There are more poly(A) tails than transcripts because PASA collapses transcripts with alternative polyadenylation. Overall, 95.7% of splice junctions from the PASA annotation overlaps with splice junctions in the Illumina paired-end RNA-seq data reported by STAR. We also tallied the frequencies of unique exons, introns, and transcripts per gene (Fig. <xref rid="Fig5" ref-type="fig">5b</xref>). On average, each gene has 3.8 exons, 2.4 introns, 1.2 transcripts. 59.12% genes contain 2 or more exons, and 16.1% genes contain at least 2 expressed transcripts. A maximum of 55 exons, 53 introns, 13 transcripts are observed per gene.<fig id="Fig5"><label>Fig. 5</label><caption><title>Distributions of feature lengths and feature counts per gene for the Sitka spruce transcriptome.</title><p><bold>a</bold> Total counts of exons, introns, transcripts, gene, and poly(A) tails. <bold>b</bold> The frequency of per-gene counts of exons, introns, and transcripts. The vertical “Frequency” axis is presented in logarithmic scale. <bold>c</bold> The length distributions of exons, introns, transcripts, genes, and poly(A) tails. The horizontal “Length” axis is presented in logarithmic scale. The vertical axis is scaled to the maximum value for each feature. The minimum and maximum values are indicated at both tails of the distributions. Peak values on the distributions are superimposed on the vertical dotted lines. Source data are provided as a Source Data file.</p></caption><graphic xlink:href="41467_2023_38553_Fig5_HTML" id="d32e944"/></fig></p>
      <p id="Par33">We calculated the length distributions of exons, introns, transcripts, genes, and poly(A) tails based on the output files from PASA (Fig. <xref rid="Fig5" ref-type="fig">5c</xref>). Exon lengths range from 10 to 18,115 nt with a primary peak at 116 nt and a slightly shorter secondary peak at 518 nt. Intron lengths range from 21 to 206,268 nt with a primary peak at 113 nt and a much shorter secondary peak at 25,474 nt. 10.3% of introns are longer than 10,000 bp, which is in congruence with the long intron characteristic of conifers. Likely as a result of long introns, gene lengths range from 115 to 364,125 nt with a primary peak at 1865 nt and a secondary peak at 45,120 nt. Transcript lengths range from 115 to 18,115 nt with a peak at 1863 nt, which is nearly identical to the peak gene length. Poly(A) tail length ranges between 10 to 104 nt long with a primary peak at 21 nt and a shorter secondary peak at 50 nt. The bimodal poly(A) tail length distribution is also observed in <italic>Arabidopsis</italic> seeding transcriptomes<sup><xref ref-type="bibr" rid="CR36">36</xref></sup>.</p>
      <p id="Par34">We also investigated alternative transcript processing events in the assembled transcripts. PASA reports nine types of events (Fig. <xref rid="Fig6" ref-type="fig">6</xref>): spliced intron, retained intron, alternate acceptor, alternate donor, alternate exon, retain exon, skipped exon, starts in intron, and ends in intron. Spliced intron is the most common event (27.5%), followed by retained intron (24.3%). Retained intron and spliced intron are the most frequently co-occurring event types. Transcripts involving 3 or more event types are detected but are much rarer.<fig id="Fig6"><label>Fig. 6</label><caption><title>Alternative transcript processing events in the Sitka spruce transcriptome.</title><p><bold>a</bold> Nine types of alternative transcript processing events are presented as they are defined in PASA and depicted by connected grey and orange rectangles. The exons, introns, or splice-junctions involved in each event type are highlighted in orange. <bold>b</bold> The vertical bar chart in the UpSet plot shows the number of transcripts containing single event types and co-occurring event types, which are indicated by single dots and connected dots in the matrix, respectively. The horizontal bar chart in the UpSet plot shows the total number of transcripts containing each event type. <bold>c</bold> Relative proportions of all event types in the PASA annotation. Source data are provided as a Source Data file.</p></caption><graphic xlink:href="41467_2023_38553_Fig6_HTML" id="d32e980"/></fig></p>
      <p id="Par35">Finally, we applied the EnTAP pipeline<sup><xref ref-type="bibr" rid="CR37">37</xref></sup> to produce protein sequence translation and functional annotation for the RNA-Bloom2 assembly (Supplementary Method <xref rid="MOESM1" ref-type="media">7</xref>). Using the functional annotation and similarity search to known spruce protein sequences, we have identified the following putative peptides: 15 terpene synthases (TPS), including 10 monoterpene synthases and seven diterpene synthases, 100 cytochrome P450 (CYP) peptides from 55 different subfamilies, and 17 NAM/ATAF/CUC (NAC) transcription factors from six different subfamilies. TPS, CYP, and NAC are gene families known for their contribution to constitutive and induced resistance to damage by the spruce weevils<sup><xref ref-type="bibr" rid="CR31">31</xref>,<xref ref-type="bibr" rid="CR38">38</xref>,<xref ref-type="bibr" rid="CR39">39</xref></sup>.</p>
    </sec>
  </sec>
  <sec id="Sec9" sec-type="discussion">
    <title>Discussion</title>
    <p id="Par36">The rapid improvements to long-read sequencing technologies present a significant challenge to reference-free transcriptome assembly methods. As the throughput of long-read sequencers continues to increase, larger sequencing datasets are produced and thereby increasing the sequence assembly and analysis computational challenge. RNA-Bloom2 addresses this by digital normalization with strobemers. In our benchmarking with simulated data and spike-in control data, we showed that the computational performance and the assembly quality of RNA-Bloom2 significantly surpasses those of RATTLE, a previous reference-free transcriptome assembler that relies on the clustering of long reads. In particular, RATTLE has total wall-clock runtimes over nine times that of RNA-Bloom2. Therefore, digital normalization with strobemers, within the RNA-Bloom2 assembly workflow, was a successful application of the concept in the assembly of long-read sequencing data, and it was a superior alternative to clustering-based reference-free assembly. However, we note that digital normalization has somewhat detrimental effects on low-expressed isoforms as we have shown in our benchmarking experiment.</p>
    <p id="Par37">We note that reference-based assembly methods tend to run much faster than reference-free methods, but their overall assembly quality varies depending on the metric used and whether or not a transcriptome annotation is included. In simulated data, StringTie2_GTF has better recall than reference-free methods, but StringTie2 has lower recall and higher FDR than reference-free methods. FLAIR has the lowest FDR in the simulated data, but StringTie2_GTF has the lowest FDR in the spike-in data. It is important to note that StringTie2 does not strictly require a reference annotation in addition to the reference genome, but FLAIR requires both a reference annotation and the reference genome. Therefore, the application of FLAIR is mainly limited to the discovery of novel isoforms while StringTie2 only requires a good-quality reference genome.</p>
    <p id="Par38">With the experimental mouse data, annotation-guided methods tend to generate less novel not-in-catalog (as defined by SQANTI3) isoforms and novel non-canonical junctions compared to reference-free methods. This is expected because the reference annotation is used to filter or correct inaccurate splice junctions in read alignments. On the contrary, reference-free methods do not use the reference annotation and the reference genome; they do not have this a priori information to correct inaccurate splice junctions. Although this suggests that annotation-guided assembly may be more accurate than reference-free assembly, these novel isoforms and splice junctions remain to be verified. Nevertheless, RNA-Bloom2 and annotation-based methods recovered similar amounts of annotated genes. Compared to reference-free methods, all reference-based approaches have reconstructed substantially more novel genes and intergenic isoforms in ONT cDNA and PacBio CCS replicates. This suggests that reference-based methods may still produce false positives when the reference annotation does not contain sufficient information.</p>
    <p id="Par39">As good quality reference annotations are not always readily available, transcriptome assembly methods must manage the lack of known transcription start and end sites, which are crucial in distinguishing the orientation of transcripts and discerning transcripts from antisense overlapping genes. Unlike direct RNA-sequencing, this is a major challenge for cDNA sequencing data, where the strand of reads cannot always be safely assumed. RNA-Bloom2 overcomes this problem by identifying potential poly(A) tail-containing reads. In addition, RNA-Bloom2 filters edges in its overlap graph based on read counts of each edge and its incident nodes, thus removing false overlaps between sequences. The positive effects of these solutions in RNA-Bloom2 are supported by the relatively low false discovery rates of RNA-Bloom2 in our benchmarking experiments for simulated data. When using the mouse data with replicates, we note that RNA-Bloom2 has reconstructed more FSM, ISM, NNC, and antisense isoforms than other methods. These metrics may be inflated by RNA-Bloom2’s high redundancy – an aspect we observed when analyzing experimental but not simulated data. We, therefore, conclude that RNA-Bloom2 has room for improvement in recognizing noise and reducing the number of redundant transcripts in experimental data.</p>
    <p id="Par40">In our analyses of the Sitka spruce transcriptome, we illustrated that RNA-Bloom2 assemblies have higher BUSCO completeness than input reads and a RATTLE assembly. We note that a portion of our assembled transcripts have split-alignments across genome scaffolds, but the majority of them are supported by paired-end short reads. We expect that a transcript-informed targeted gene reconstruction<sup><xref ref-type="bibr" rid="CR40">40</xref></sup>, using a long-read reference-free transcriptome assembly by RNA-Bloom2, may significantly improve the discovery of new splice isoforms and the annotation of genes.</p>
    <p id="Par41">In summary, we illustrated the performance of RNA-Bloom2 with respect to state-of-the-art long-read transcriptome assembly methods, highlighting the strengths and weaknesses of each. We showed that RNA-Bloom2 is suitable for both ONT and PacBio sequencing technologies and it is competitive with reference-based methods. We expect RNA-Bloom2 to be scalable to increasing volumes of long-read data, and we anticipate RNA-Bloom2 will facilitate the gene annotation and transcriptome analyses of many species to be investigated.</p>
  </sec>
  <sec id="Sec10">
    <title>Methods</title>
    <sec id="Sec11">
      <title>Alignment-free error correction</title>
      <p id="Par42">We have modified the error correction routine for short reads in RNA-Bloom to support error correction in long reads. RNA-Bloom2 uses a <italic>k</italic>-mer size of 25 by default unless specified otherwise by the user. First, <italic>k</italic>-mers and their multiplicities in the input reads are stored in a Bloom filter de Bruijn graph, which uses the same memory-efficient data structure introduced in our previous work<sup><xref ref-type="bibr" rid="CR19">19</xref></sup>. However, paired <italic>k</italic>-mers that were utilized in the short-read assembly algorithm are not used due to higher error rates of long reads. Reads are then split into fixed-length tiles (default: 500 nt) that are evaluated independently of each other. To account for varying transcript expression levels, a multiplicity threshold is dynamically determined (See Supplementary Fig. <xref rid="MOESM1" ref-type="media">4</xref> for more details about this procedure) within each tile to identify “weak” and “solid” <italic>k</italic>-mers, which have multiplicities lower and higher than or equal to the threshold, respectively. Weak <italic>k</italic>-mers represent potentially erroneous regions in the read while solid <italic>k</italic>-mers represent error-free regions in the read. To avoid introducing incorrect edits to the read, weak <italic>k</italic>-mers are replaced with an alternative path of solid <italic>k</italic>-mers in the de Bruijn graph only if this path shares a high sequence identity (default: 70%) as the target region spanned by the weak <italic>k</italic>-mers. The tiling nature of this routine ensures that more refined multiplicity thresholds are set for sub-regions in the read. The error correction process for each read may be repeated for additional iterations if at least one tile was modified in the previous iteration. In each successive iteration, the tiling positions are shifted by half a tile length to allow errors at tile boundaries in the previous iteration to be corrected. After error correction is completed for the read, <italic>k</italic>-mers from all neighboring tiles are joined together and are assembled into an edited read sequence.</p>
    </sec>
    <sec id="Sec12">
      <title>Digital normalization with strobemers</title>
      <p id="Par43">Digital normalization is intended to reduce the overall read depth to a much lower target depth (default: 3) by identifying the minimal longest reads set (MLRS) supporting the target depth. Digital normalization reduces the computational resource requirements of subsequent stages, and it is most effective in reducing the number of reads for high-expressed transcripts, which are the main culprit for long runtimes and high memory usage in read-to-read alignments. The read depths represented by the MLRS are approximated by multiplicities of strobemers, which is an error-tolerant alternative to <italic>k</italic>-mers for sequence comparison. Three variants of strobemers have been introduced in previous work<sup><xref ref-type="bibr" rid="CR18">18</xref></sup>: minstrobes, randstrobes, and hybridstrobes. In RNA-Bloom2, we used randstrobes of order three because it was shown to perform favorably on transcriptome data. Strobemer multiplicities are tracked by a counting Bloom filter, which is populated as reads are added to the MLRS.</p>
      <p id="Par44">Digital normalization begins by first sorting the input reads by their length in descending order. Only one read is evaluated at a time to maintain proper tracking of read depth in the MLRS. A read is designated as represented by the MLRS if nearly the entire read (default threshold of 50 nt from the read extremities) contains overlapping strobemers with multiplicities at or above the target depth (Supplementary Fig. <xref rid="MOESM1" ref-type="media">5</xref>). A read is designated as not represented by the MLRS if it has a region not containing any strobemers with multiplicities at or above the target depth. Each non-represented read is added to the MLRS and its strobemer multiplicities (that are lower than the target depth) would be incremented by one before the next read is evaluated. Represented reads are not included in the MLRS and their strobemer multiplicities are not incremented.</p>
    </sec>
    <sec id="Sec13">
      <title>Read trimming and splitting</title>
      <p id="Par45">RNA-Bloom2 relies on minimap2 for overlapping reads against each other to identify sufficiently covered regions of each read. By default, the minimum required read depth for long-read assembly is set to three in RNA-Bloom2; a sufficiently covered region of a read must overlap with at least two other reads. Insufficiently covered head and tail regions of the reads are trimmed. Reads containing insufficiently covered internal region(s) are potentially chimera artifacts. Therefore, reads are also split at these internal regions into shorter segments that are still sufficiently supported by other reads (See Supplementary Fig. <xref rid="MOESM1" ref-type="media">6</xref> for more details). Completely contained reads are removed.</p>
    </sec>
    <sec id="Sec14">
      <title>Unitig assembly</title>
      <p id="Par46">Trimmed reads are overlapped against each other with minimap2 to construct an overlap graph where the vertices and edges are reads and their overlaps, respectively. As was done in the read trimming stage, contained reads are removed. If the input data is strand-specific (e.g. ONT dRNA), only alignments on the same strand are retained and the overlap graph would only contain vertices for the forward strand. If the input data is not strand-specific (e.g. ONT cDNA), then vertices for both strands are created in the overlap graph and the overlap graph is pruned based on whether each read contains poly(A) tail or poly(T) head (Supplementary Fig. <xref rid="MOESM1" ref-type="media">7</xref>). The overlap graph is simplified by removing transitive edges. Unitigs are derived by assembling reads along unambiguous paths in the overlap graph.</p>
    </sec>
    <sec id="Sec15">
      <title>Unitig polishing</title>
      <p id="Par47">Although alignment-free error correction has been performed on the reads that were used to generate unitigs, there are still residual base errors that can be polished using an alignment-based approach. Output reads from the error correction stage are aligned to the unitigs with minimap2. To avoid unintentional removal of short alternatively spliced exons during polishing, only alignments with large indels (default: &gt; 50 nt) or low sequence identity (default: &lt;70%) are removed. The filtered alignments are passed to Racon<sup><xref ref-type="bibr" rid="CR41">41</xref></sup> for polishing the unitigs.</p>
    </sec>
    <sec id="Sec16">
      <title>Transcript assembly</title>
      <p id="Par48">An overlap graph of polished unitigs is constructed based on minimap2 overlaps between polished unitigs. Reusing the read alignments from the unitig polishing stage, the overlap graph is annotated with: (i) length-normalized read counts for the unitigs, and (ii) the number of reads spanning across the unitig overlaps. The length-normalized read counts for unitigs are measured as the number of aligned bases divided by the total length of the unitig. The length normalization is primarily intended to account for reads that align partially to more than one unitig, where a higher count is attributed to the unitig with more aligned bases. Without length normalization, read counts tallied from reads aligned to unitig overlaps would be double-counted, which is particularly detrimental when reads align to false-overlaps between unitigs. Therefore, the normalized read counts provide a means to discern false overlaps between unitigs that belong to transcripts with different expression level magnitudes.</p>
      <p id="Par49">If the input data is not strand-specific, then the overlap graph is pruned as it was done in unitig assembly, and the read alignments are also examined for poly-A tail reads that are aligned to the unitigs. The unitigs are reoriented based on the poly-A tail read alignment orientations and the overlap graph is filtered accordingly (Supplementary Fig. <xref rid="MOESM1" ref-type="media">7</xref>). This procedure is crucial in discerning transcripts originating from overlapping genes on opposite strands of the chromosome. In addition, edges in the overlap graph are filtered by applying a binomial test on the number of reads supporting the edge with respect to the normalized read counts of the incident vertices (Supplementary Method <xref rid="MOESM1" ref-type="media">8</xref>).</p>
      <p id="Par50">After all filtering on the overlap graph has been performed, vertices are sorted by their read counts in descending order. Each vertex serves as the seed for a bidirectional greedy extension path with each extension choosing the neighbor vertex with the highest read count. Greedy extension terminates upon reaching either a dead-end, a cycle, or a vertex with a read count of zero. The reads along this path are assembled into a transcript. All vertices along this path would be flagged from seeding new extension paths, and their read counts are decremented by the minimum read count in the path. Transcript assembly is complete when all vertices have been visited.</p>
    </sec>
    <sec id="Sec17">
      <title>Benchmark dataset simulation</title>
      <p id="Par51">We used Trans-NanoSim v3.1.0 to simulate ONT cDNA and dRNA datasets based on the mouse annotation for GRCm39 from LRGASP (Synapse accession “<ext-link ext-link-type="uri" xlink:href="https://www.synapse.org/#!Synapse:syn25683629">syn25683629</ext-link>”). Two mouse samples from the LRGASP Consortium (accessions “<ext-link ext-link-type="uri" xlink:href="https://www.encodeproject.org/files/ENCFF232YSU/">ENCFF232YSU</ext-link>” and “<ext-link ext-link-type="uri" xlink:href="https://www.encodeproject.org/files/ENCFF349BIN/">ENCFF349BIN</ext-link>”) were selected for training Trans-NanoSim sequencing profiles for cDNA and dRNA data, respectively. Sequencing adapters were trimmed from raw reads using Pychopper v2.5.0<sup><xref ref-type="bibr" rid="CR21">21</xref></sup> (Supplementary Method <xref rid="MOESM1" ref-type="media">1</xref>). Since no adapters were detected in the dRNA data, the raw reads were supplied to Trans-NanoSim for training the dRNA profile. On the contrary, adapters were found in the cDNA data; the adapter-trimmed “full-length” and “rescued” reads, as defined by Pychopper, were supplied to Trans-NanoSim for training the cDNA profile. We discarded all simulated reads defined as “unaligned” by Trans-NanoSim and we subsample the “aligned” simulated reads to 2, 10, and 18 million reads using seqtk<sup><xref ref-type="bibr" rid="CR42">42</xref></sup>. All software command parameters are documented in Supplementary Method <xref rid="MOESM1" ref-type="media">4</xref>.</p>
    </sec>
    <sec id="Sec18">
      <title>Spike-in control reads extraction</title>
      <p id="Par52">For the ONT cDNA samples, we only used the adapter-trimmed “full-length” and “rescued” reads, as defined by Pychopper. Using minimap2 2.24-r1122, reads from three replicates for each platform were aligned against the hybrid reference genome of mouse and spike-ins provided by LRGASP. Only reads that are aligned uniquely to ERCC and SIRV sequences are kept (Supplementary Method <xref rid="MOESM1" ref-type="media">5</xref>).</p>
    </sec>
    <sec id="Sec19">
      <title>Transcriptome assembly benchmarking</title>
      <p id="Par53">The command parameters for each assembler are documented in Supplementary Method <xref rid="MOESM1" ref-type="media">6</xref>. For the simulated datasets, transcriptome assemblies are aligned against the mouse reference transcriptome from LRGASP with minimap2. The output alignment PAF files are processed with our in-house Python script ‘tns_eval.py‘, which is available at <ext-link ext-link-type="uri" xlink:href="https://github.com/bcgsc/rnaseq_utils">https://github.com/bcgsc/rnaseq_utils</ext-link>. Only alignment segments of at least 100 nt in length, at least 95% sequence identity, and indels smaller than 70 nt in length are considered. The ground truth transcript set is determined using the transcript identifiers in the simulated read names. Since not all known transcripts were simulated, the truth set is a subset of the annotation. Any transcripts that are not in the truth set are designated as false positives. If an assembled sequence aligns equally well with both a truth set transcript and a false-positive transcript, the assembled sequence would be assigned to the truth set instead of the false-positive. Any assembled sequences that have split alignments to more than one transcript are designated as misassemblies.</p>
      <p id="Par54">For the spike-in datasets, transcriptome assemblies are aligned against the ERCC and SIRV sequences with minimap2. Since the ground truth transcript set is identical to the spike-in annotated transcripts, there are no false-positives. However, misassemblies are still detected as it was done for the simulated datasets.</p>
    </sec>
    <sec id="Sec20">
      <title>Calculating isoform assembly precision</title>
      <p id="Par55">The isoform assembly precision metric is calculated based on SQANTI3’s isoform classification. The command parameters for SQANTI3 are documented in Supplementary Method <xref rid="MOESM1" ref-type="media">11</xref>. SQANTI3 classifies assembly contigs into different categories according to how they match the reference transcript models. Full splice match (FSM) and incomplete splice match (ISM) are the only two categories that correspond to reference isoform with matching splice junctions. To determine isoform assembly precision for simulated data, the transcriptome annotation is filtered to include only isoforms that were simulated. Note that a total of six filtered transcriptome annotations were generated for the simulated data (two protocols, three read set sizes). When SQANTI3 is run with the filtered transcriptome annotation, any incorrect assemblies would be assigned to categories other than FSM or ISM. Therefore, isoform assembly precision is calculated as (FSM + ISM)/(FSM + ISM + other categories).</p>
    </sec>
    <sec id="Sec21">
      <title>Sitka spruce transcriptome analysis</title>
      <p id="Par56">All software command parameters are documented in Supplementary Method <xref rid="MOESM1" ref-type="media">7</xref>. The ONT cDNA reads were base called with Guppy v5.0.15. Since there are non-standard adapter and primer sequences, we used Porechop instead of Pychopper. We assembled the adapter-trimmed reads with RNA-Bloom2 v2.0.0 and short-read RNA-seq data (See Data Availability statement) from previous work<sup><xref ref-type="bibr" rid="CR31">31</xref></sup> were also included only for error correction of the ONT reads. The transcriptome completeness was benchmarked with BUSCO v5.3.2<sup><xref ref-type="bibr" rid="CR32">32</xref></sup> and the embryophyte core gene set (odb10). The resulting RNA-Bloom2 assembly was supplied to PASA v2.5.2<sup><xref ref-type="bibr" rid="CR35">35</xref></sup> for gene structure annotation, using minimap2 for transcriptome alignments against the draft genome. The figure for alternative splicing was generated with UpSetR<sup><xref ref-type="bibr" rid="CR43">43</xref></sup>. The transcriptome assembly was annotated with EnTAP v0.10.8-beta<sup><xref ref-type="bibr" rid="CR37">37</xref></sup> using TransDecoder v5.3.0<sup><xref ref-type="bibr" rid="CR44">44</xref></sup> for protein sequence translation. Functional annotation was assigned based on Swiss-prot plant proteins<sup><xref ref-type="bibr" rid="CR45">45</xref></sup>, UniRef90 gene clusters<sup><xref ref-type="bibr" rid="CR46">46</xref></sup>, embryophyte orthologs from OrthoDB10<sup><xref ref-type="bibr" rid="CR47">47</xref></sup>, and high-quality proteins derived from NCBI RefSeq 99<sup><xref ref-type="bibr" rid="CR48">48</xref></sup>. We performed the annotation of TPS, CYP and NAC through a BLASTP search against target spruce protein sequences reported previously<sup><xref ref-type="bibr" rid="CR31">31</xref>,<xref ref-type="bibr" rid="CR38">38</xref>,<xref ref-type="bibr" rid="CR39">39</xref></sup>, with minimum match of 95% identity and 90% query coverage.</p>
    </sec>
    <sec id="Sec22">
      <title>Statistics and reproducibility</title>
      <p id="Par57">No biological sample collection was performed in this study. Therefore, no statistical method was used to predetermine sample size and there were no randomized experiments. Blinding of data is also not relevant. Sequencing reads were only excluded if they are deemed as poor quality by the adapter-trimming softwares. For reproducibility of analyses in this study, exact software commands are provided in Supplementary Information.</p>
    </sec>
    <sec id="Sec23">
      <title>Reporting summary</title>
      <p id="Par58">Further information on research design is available in the <xref rid="MOESM3" ref-type="media">Nature Portfolio Reporting Summary</xref> linked to this article.</p>
    </sec>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary information</title>
    <sec id="Sec24">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="41467_2023_38553_MOESM1_ESM.pdf">
            <caption>
              <p>Supplementary Information</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM2">
          <media xlink:href="41467_2023_38553_MOESM2_ESM.pdf">
            <caption>
              <p>Peer Review File</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM3">
          <media xlink:href="41467_2023_38553_MOESM3_ESM.pdf">
            <caption>
              <p>Reporting Summary</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <app-group>
    <app id="App1">
      <sec id="Sec25">
        <title>Source data</title>
        <p id="Par62">
          <media position="anchor" xlink:href="41467_2023_38553_MOESM4_ESM.xlsx" id="MOESM4">
            <caption>
              <p>Source Data</p>
            </caption>
          </media>
        </p>
      </sec>
    </app>
  </app-group>
  <fn-group>
    <fn>
      <p><bold>Publisher’s note</bold> Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <sec>
    <title>Supplementary information</title>
    <p>The online version contains supplementary material available at 10.1038/s41467-023-38553-y.</p>
  </sec>
  <ack>
    <title>Acknowledgements</title>
    <p>The authors would like to thank Dr. Steven Jones and Dr. Marco Marra at Canada’s Michael Smith Genome Sciences Centre (GSC) for graciously providing their nanopore sequencing data to test an earlier version of RNA-Bloom2, Dr. Kieran O’Neil and Vanessa Porter at GSC for evaluating the performance of an earlier version of RNA-Bloom2, Dr. Justin Whitehill at North Carolina State University and Mack Yuen at Dr. Joerg Bohlmann’s Lab for providing the sequences and annotations of Sitka spruce short-read transcriptome assemblies, Young Cheng at GSC for submitting the Sitka spruce nanopore sequencing data to the SRA, and the organizers of the LRGASP Consortium for making their sequencing data publicly available and sharing their evaluation results on an earlier version of RNA-Bloom2. This work was supported by Genome Canada and Genome British Columbia (grant number 243FOR to all authors); the National Institutes of Health (grant number 2R01HG007182-04A1 to all authors); the Natural Sciences and Engineering Research Council of Canada (NSERC); and the Canadian Institutes of Health Research (CIHR). The content of this work is solely the responsibility of the authors and does not necessarily represent the official views of the National Institutes of Health or other funding organizations.</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Author contributions</title>
    <p>K.M.N. and I.B. conceived the study. K.M.N. designed and developed RNA-Bloom2 under the supervision of I.B. K.M.N., S.H., and C.Y. generated the simulated datasets and analyzed the LRGASP Consortium dataset. S.H., R.C., R.L.W., and I.B. advised on the benchmarking design. K.M.N., K.K.G., and R.C. analyzed the Sitka spruce dataset. All authors contributed to the interpretation of the results. KMN took the lead in writing the manuscript with input from all authors.</p>
  </notes>
  <notes notes-type="peer-review">
    <title>Peer review</title>
    <sec id="FPar1">
      <title>Peer review information</title>
      <p id="Par59"><italic>Nature Communications</italic> thanks the other, anonymous, reviewer(s) for their contribution to the peer review of this work. A peer review file is available.</p>
    </sec>
  </notes>
  <notes notes-type="data-availability">
    <title>Data availability</title>
    <p>The source data for generating all figures in this study are provided in the Source Data file. The simulated data generated in this study has been deposited in Dryad at 10.5061/dryad.cc2fqz68w (ref. <sup><xref ref-type="bibr" rid="CR49">49</xref></sup>). The rebasecalled Nanopore sequencing data for the Sitka spruce cDNA sample has been deposited in the Sequence Read Archive (SRA) with run accession “<ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/sra/?term=SRR19510936">SRR19510936</ext-link>”. The GRCm39-based mouse reference genome from the LRGASP is available on Synapse with accession “<ext-link ext-link-type="uri" xlink:href="https://www.synapse.org/#!Synapse:syn25683365">syn25683365</ext-link>”. The GENCODE VM27-based mouse transcriptome annotation set from the LRGASP is available on Synapse with accession “<ext-link ext-link-type="uri" xlink:href="https://www.synapse.org/#!Synapse:syn25683629">syn25683629</ext-link>”. The sequencing data from the LRGASP are available in the ENCODE Project repository with accessions: “<ext-link ext-link-type="uri" xlink:href="https://www.encodeproject.org/files/ENCFF349BIN/">ENCFF349BIN</ext-link>”, “<ext-link ext-link-type="uri" xlink:href="https://www.encodeproject.org/files/ENCFF412NKJ/">ENCFF412NKJ</ext-link>”, “<ext-link ext-link-type="uri" xlink:href="https://www.encodeproject.org/files/ENCFF765AEC/">ENCFF765AEC</ext-link>”, “<ext-link ext-link-type="uri" xlink:href="https://www.encodeproject.org/files/ENCFF232YSU/">ENCFF232YSU</ext-link>”, “<ext-link ext-link-type="uri" xlink:href="https://www.encodeproject.org/files/ENCFF288PBL/">ENCFF288PBL</ext-link>”, “<ext-link ext-link-type="uri" xlink:href="https://www.encodeproject.org/files/ENCFF683TBO/">ENCFF683TBO</ext-link>”, “<ext-link ext-link-type="uri" xlink:href="https://www.encodeproject.org/files/ENCFF313VYZ/">ENCFF313VYZ</ext-link>”, “<ext-link ext-link-type="uri" xlink:href="https://www.encodeproject.org/files/ENCFF667VXS/">ENCFF667VXS</ext-link>”, “<ext-link ext-link-type="uri" xlink:href="https://www.encodeproject.org/files/ENCFF874VSI/">ENCFF874VSI</ext-link>”, “<ext-link ext-link-type="uri" xlink:href="https://www.encodeproject.org/files/ENCFF696TCH/">ENCFF696TCH</ext-link>”, and “<ext-link ext-link-type="uri" xlink:href="https://www.encodeproject.org/files/ENCFF751FTE/">ENCFF751FTE</ext-link>”. The Illumina sequencing data for Sitka spruce from a previous study<sup><xref ref-type="bibr" rid="CR31">31</xref></sup> is available on SRA with accessions: “<ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/sra/?term=SRR5949081">SRR5949081</ext-link>”, “<ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/sra/?term=SRR5949082">SRR5949082</ext-link>”, “<ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/sra/?term=SRR5949083">SRR5949083</ext-link>”, “<ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/sra/?term=SRR5949084">SRR5949084</ext-link>”, “<ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/sra/?term=SRR5949085">SRR5949085</ext-link>”, “<ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/sra/?term=SRR5949086">SRR5949086</ext-link>”, “<ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/sra/?term=SRR5949087">SRR5949087</ext-link>”, “<ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/sra/?term=SRR5949088">SRR5949088</ext-link>”, “<ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/sra/?term=SRR5949089">SRR5949089</ext-link>”, “<ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/sra/?term=SRR5949090">SRR5949090</ext-link>”, “<ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/sra/?term=SRR5949091">SRR5949091</ext-link>”, and “<ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/sra/?term=SRR5949092">SRR5949092</ext-link>”. All other relevant data supporting the key findings of this study are available within the article and its Supplementary Information files or from the corresponding author upon reasonable request. <xref rid="Sec25" ref-type="sec">Source data</xref> are provided with this paper.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Code availability</title>
    <p>RNA-Bloom2 (v2.0.0) is implemented in Java, and it is publicly available under GPLv3 license on GitHub at <ext-link ext-link-type="uri" xlink:href="https://github.com/bcgsc/RNA-Bloom">https://github.com/bcgsc/RNA-Bloom</ext-link> (ref. <sup><xref ref-type="bibr" rid="CR50">50</xref></sup>). The scripts we wrote to produce and analyze our results are also publicly available on GitHub at <ext-link ext-link-type="uri" xlink:href="https://github.com/bcgsc/rnaseq_utils">https://github.com/bcgsc/rnaseq_utils</ext-link> and <ext-link ext-link-type="uri" xlink:href="https://github.com/bcgsc/rnabloom2_manuscript">https://github.com/bcgsc/rnabloom2_manuscript</ext-link>.</p>
  </notes>
  <notes id="FPar2" notes-type="COI-statement">
    <title>Competing interests</title>
    <p id="Par60">The authors declare no competing interests.</p>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Moreno-Santillán</surname>
            <given-names>DD</given-names>
          </name>
          <name>
            <surname>Machain-Williams</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Hernández-Montes</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Ortega</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>De novo transcriptome assembly and functional annotation in five species of bats</article-title>
        <source>Sci. Rep.</source>
        <year>2019</year>
        <volume>9</volume>
        <fpage>1</fpage>
        <lpage>12</lpage>
        <pub-id pub-id-type="pmid">30626917</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jo</surname>
            <given-names>Y</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Integrated analyses using RNA-Seq data reveal viral genomes, single nucleotide variations, the phylogenetic relationship, and recombination for Apple stem grooving virus</article-title>
        <source>BMC Genomics</source>
        <year>2016</year>
        <volume>17</volume>
        <fpage>1</fpage>
        <lpage>12</lpage>
        <pub-id pub-id-type="pmid">26818753</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mittal</surname>
            <given-names>VK</given-names>
          </name>
          <name>
            <surname>McDonald</surname>
            <given-names>JF</given-names>
          </name>
        </person-group>
        <article-title>De novo assembly and characterization of breast cancer transcriptomes identifies large numbers of novel fusion-gene transcripts of potential functional significance</article-title>
        <source>BMC Med. Genomics</source>
        <year>2017</year>
        <volume>10</volume>
        <fpage>1</fpage>
        <lpage>20</lpage>
        <pub-id pub-id-type="pmid">28057009</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schelhorn</surname>
            <given-names>S-E</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Sensitive detection of viral transcripts in human tumor transcriptomes</article-title>
        <source>PLoS Comput. Biol.</source>
        <year>2013</year>
        <volume>9</volume>
        <fpage>e1003228</fpage>
        <pub-id pub-id-type="pmid">24098097</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lau</surname>
            <given-names>C-C</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Viral-human chimeric transcript predisposes risk to liver cancer development and progression</article-title>
        <source>Cancer Cell</source>
        <year>2014</year>
        <volume>25</volume>
        <fpage>335</fpage>
        <lpage>349</lpage>
        <pub-id pub-id-type="pmid">24582836</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Xue</surname>
            <given-names>W</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>L_RNA_scaffolder: scaffolding genomes with transcripts</article-title>
        <source>BMC Genomics</source>
        <year>2013</year>
        <volume>14</volume>
        <fpage>1</fpage>
        <lpage>14</lpage>
        <pub-id pub-id-type="pmid">23323973</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Amarasinghe</surname>
            <given-names>SL</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Opportunities and challenges in long-read sequencing data analysis</article-title>
        <source>Genome Biol.</source>
        <year>2020</year>
        <volume>21</volume>
        <fpage>1</fpage>
        <lpage>16</lpage>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jain</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Olsen</surname>
            <given-names>HE</given-names>
          </name>
          <name>
            <surname>Paten</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Akeson</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>The oxford nanopore minION: delivery of nanopore sequencing to the genomics community</article-title>
        <source>Genome Biol.</source>
        <year>2016</year>
        <volume>17</volume>
        <fpage>1</fpage>
        <lpage>11</lpage>
        <pub-id pub-id-type="pmid">26753840</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Garalde</surname>
            <given-names>DR</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Highly parallel direct RNA sequencing on an array of nanopores</article-title>
        <source>Nat. Methods</source>
        <year>2018</year>
        <volume>15</volume>
        <fpage>201</fpage>
        <lpage>206</lpage>
        <pub-id pub-id-type="pmid">29334379</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Weirather</surname>
            <given-names>JL</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Comprehensive comparison of Pacific Biosciences and Oxford Nanopore Technologies and their applications to transcriptome analysis</article-title>
        <source>F1000Res.</source>
        <year>2017</year>
        <volume>6</volume>
        <fpage>100</fpage>
        <pub-id pub-id-type="pmid">28868132</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kovaka</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Transcriptome assembly from long-read RNA-seq alignments with StringTie2</article-title>
        <source>Genome Biol.</source>
        <year>2019</year>
        <volume>20</volume>
        <fpage>1</fpage>
        <lpage>13</lpage>
        <pub-id pub-id-type="pmid">30606230</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tang</surname>
            <given-names>AD</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Full-length transcript characterization of SF3B1 mutation in chronic lymphocytic leukemia reveals downregulation of retained introns</article-title>
        <source>Nat. Commun.</source>
        <year>2020</year>
        <volume>11</volume>
        <fpage>1</fpage>
        <lpage>12</lpage>
        <pub-id pub-id-type="pmid">31911652</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ruan</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>Fast and accurate long-read assembly with wtdbg2</article-title>
        <source>Nat. Methods</source>
        <year>2019</year>
        <volume>17</volume>
        <fpage>155</fpage>
        <lpage>158</lpage>
        <pub-id pub-id-type="pmid">31819265</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>de la Rubia</surname>
            <given-names>I</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>RATTLE: reference-free reconstruction and quantification of transcriptomes from Nanopore sequencing</article-title>
        <source>Genome Biol.</source>
        <year>2022</year>
        <volume>23</volume>
        <fpage>1</fpage>
        <lpage>21</lpage>
        <pub-id pub-id-type="pmid">34980209</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <mixed-citation publication-type="other">Brown, C. T., Howe, A., Zhang, Q., Pyrkosz, A. B. &amp; Brom, T. H. A reference-free algorithm for computational normalization of shotgun sequencing data. 10.48550/arXiv.1203.4802 (2012).</mixed-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Haas</surname>
            <given-names>BJ</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>De novo transcript sequence reconstruction from RNA-seq using the Trinity platform for reference generation and analysis</article-title>
        <source>Nat. Protoc.</source>
        <year>2013</year>
        <volume>8</volume>
        <fpage>1494</fpage>
        <lpage>1512</lpage>
        <pub-id pub-id-type="pmid">23845962</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Durai</surname>
            <given-names>DA</given-names>
          </name>
          <name>
            <surname>Schulz</surname>
            <given-names>MH</given-names>
          </name>
        </person-group>
        <article-title>Improving in-silico normalization using read weights</article-title>
        <source>Sci. Rep.</source>
        <year>2019</year>
        <volume>9</volume>
        <fpage>1</fpage>
        <lpage>10</lpage>
        <pub-id pub-id-type="pmid">30626917</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sahlin</surname>
            <given-names>K</given-names>
          </name>
        </person-group>
        <article-title>Effective sequence similarity detection with strobemers</article-title>
        <source>Genome Res</source>
        <year>2021</year>
        <volume>31</volume>
        <fpage>2080</fpage>
        <lpage>2094</lpage>
        <pub-id pub-id-type="pmid">34667119</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nip</surname>
            <given-names>KM</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>RNA-Bloom enables reference-free and reference-guided sequence assembly for single-cell transcriptomes</article-title>
        <source>Genome Res</source>
        <year>2020</year>
        <volume>30</volume>
        <fpage>1191</fpage>
        <lpage>1200</lpage>
        <pub-id pub-id-type="pmid">32817073</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <mixed-citation publication-type="other">Pardo-Palacios, F. et al. Systematic assessment of long-read RNA-seq methods for transcript identification and quantification. <italic>Res. Square</italic>10.21203/rs.3.rs-777702/v1 (2021).</mixed-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <mixed-citation publication-type="other">GitHub - nanoporetech/pychopper: A tool to identify, orient, trim and rescue full length cDNA reads. <italic>GitHub</italic><ext-link ext-link-type="uri" xlink:href="https://github.com/nanoporetech/pychopper">https://github.com/nanoporetech/pychopper</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bolger</surname>
            <given-names>AM</given-names>
          </name>
          <name>
            <surname>Lohse</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Usadel</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <article-title>Trimmomatic: a flexible trimmer for Illumina sequence data</article-title>
        <source>Bioinformatics</source>
        <year>2014</year>
        <volume>30</volume>
        <fpage>2114</fpage>
        <lpage>2120</lpage>
        <pub-id pub-id-type="pmid">24695404</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <mixed-citation publication-type="other">Paul, L. <italic>et al</italic>. SIRVs: Spike-In RNA Variants as External Isoform Controls in RNA-Sequencing. Preprint at <italic>bioRxiv</italic> 080747 10.1101/080747 (2016).</mixed-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <mixed-citation publication-type="other">Hafezqorani, S. et al. Trans-NanoSim characterizes and simulates nanopore RNA-sequencing data. <italic>Gigascience</italic><bold>9</bold>, giaa061 (2020).</mixed-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sahlin</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Medvedev</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>Error correction enables use of Oxford Nanopore technology for reference-free transcriptome analysis</article-title>
        <source>Nat. Commun.</source>
        <year>2021</year>
        <volume>12</volume>
        <fpage>2</fpage>
        <pub-id pub-id-type="pmid">33397972</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tardaguila</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>SQANTI: extensive characterization of long-read transcript sequences for quality control in full-length transcriptome identification and quantification</article-title>
        <source>Genome Res</source>
        <year>2018</year>
        <volume>28</volume>
        <fpage>396</fpage>
        <lpage>411</lpage>
        <pub-id pub-id-type="pmid">29440222</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <mixed-citation publication-type="other">Gagalova, K. K. et al. Spruce giga-genomes: structurally similar yet distinctive with differentially expanding gene families and rapidly evolving genes. <italic>Plant J</italic>. 10.1111/tpj.15889 (2022).</mixed-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Stival Sena</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Evolution of gene structure in the conifer Picea glauca: a comparative analysis of the impact of intron size</article-title>
        <source>BMC Plant Biol.</source>
        <year>2014</year>
        <volume>14</volume>
        <fpage>1</fpage>
        <lpage>16</lpage>
      </element-citation>
    </ref>
    <ref id="CR29">
      <label>29.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Niu</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The Chinese pine genome and methylome unveil key features of conifer evolution</article-title>
        <source>Cell</source>
        <year>2022</year>
        <volume>185</volume>
        <fpage>204</fpage>
        <lpage>217.e14</lpage>
        <pub-id pub-id-type="pmid">34965378</pub-id>
      </element-citation>
    </ref>
    <ref id="CR30">
      <label>30.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wick</surname>
            <given-names>RR</given-names>
          </name>
          <name>
            <surname>Judd</surname>
            <given-names>LM</given-names>
          </name>
          <name>
            <surname>Gorrie</surname>
            <given-names>CL</given-names>
          </name>
          <name>
            <surname>Holt</surname>
            <given-names>KE</given-names>
          </name>
        </person-group>
        <article-title>Completing bacterial genome assemblies with multiplex MinION sequencing</article-title>
        <source>Microb. Genomics</source>
        <year>2017</year>
        <volume>3</volume>
        <fpage>e000132</fpage>
      </element-citation>
    </ref>
    <ref id="CR31">
      <label>31.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Whitehill</surname>
            <given-names>JGA</given-names>
          </name>
          <name>
            <surname>Yuen</surname>
            <given-names>MMS</given-names>
          </name>
          <name>
            <surname>Bohlmann</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Constitutive and insect‐induced transcriptomes of weevil‐resistant and susceptible Sitka spruce</article-title>
        <source>Plant-Environ. Interact.</source>
        <year>2021</year>
        <volume>2</volume>
        <fpage>137</fpage>
        <lpage>147</lpage>
      </element-citation>
    </ref>
    <ref id="CR32">
      <label>32.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Manni</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Berkeley</surname>
            <given-names>MR</given-names>
          </name>
          <name>
            <surname>Seppey</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Simão</surname>
            <given-names>FA</given-names>
          </name>
          <name>
            <surname>Zdobnov</surname>
            <given-names>EM</given-names>
          </name>
        </person-group>
        <article-title>BUSCO update: novel and streamlined workflows along with broader and deeper phylogenetic coverage for scoring of eukaryotic, prokaryotic, and viral genomes</article-title>
        <source>Mol. Biol. Evol.</source>
        <year>2021</year>
        <volume>38</volume>
        <fpage>4647</fpage>
        <lpage>4654</lpage>
        <pub-id pub-id-type="pmid">34320186</pub-id>
      </element-citation>
    </ref>
    <ref id="CR33">
      <label>33.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>Minimap2: pairwise alignment for nucleotide sequences</article-title>
        <source>Bioinformatics</source>
        <year>2018</year>
        <volume>34</volume>
        <fpage>3094</fpage>
        <lpage>3100</lpage>
        <pub-id pub-id-type="pmid">29750242</pub-id>
      </element-citation>
    </ref>
    <ref id="CR34">
      <label>34.</label>
      <mixed-citation publication-type="other">Dobin, A. et al. STAR: ultrafast universal RNA-seq aligner. <italic>Bioinformatics</italic><bold>29</bold>, 15–21 (2012).</mixed-citation>
    </ref>
    <ref id="CR35">
      <label>35.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Haas</surname>
            <given-names>BJ</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Automated eukaryotic gene structure annotation using EVidenceModeler and the Program to Assemble Spliced Alignments</article-title>
        <source>Genome Biol.</source>
        <year>2008</year>
        <volume>9</volume>
        <fpage>1</fpage>
        <lpage>22</lpage>
      </element-citation>
    </ref>
    <ref id="CR36">
      <label>36.</label>
      <mixed-citation publication-type="other">Jia, J., Lu, W., Liu, B. et al. An atlas of plant full-length RNA reveals tissue-specific and monocots–dicots conserved regulation of poly(A) tail length. <italic>Nat. Plants</italic><bold>8</bold>, 1118–1126 (2022).</mixed-citation>
    </ref>
    <ref id="CR37">
      <label>37.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hart</surname>
            <given-names>AJ</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>EnTAP: Bringing faster and smarter functional annotation to non-model eukaryotic transcriptomes</article-title>
        <source>Mol. Ecol. Resour.</source>
        <year>2020</year>
        <volume>20</volume>
        <fpage>591</fpage>
        <lpage>604</lpage>
        <pub-id pub-id-type="pmid">31628884</pub-id>
      </element-citation>
    </ref>
    <ref id="CR38">
      <label>38.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Warren</surname>
            <given-names>RL</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Improved white spruce (Picea glauca) genome assemblies and annotation of large gene families of conifer terpenoid and phenolic defense metabolism</article-title>
        <source>Plant J.</source>
        <year>2015</year>
        <volume>83</volume>
        <fpage>189</fpage>
        <lpage>212</lpage>
        <pub-id pub-id-type="pmid">26017574</pub-id>
      </element-citation>
    </ref>
    <ref id="CR39">
      <label>39.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Whitehill</surname>
            <given-names>JGA</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Functions of stone cells and oleoresin terpenes in the conifer defense syndrome</article-title>
        <source>N. Phytol.</source>
        <year>2019</year>
        <volume>221</volume>
        <fpage>1503</fpage>
        <lpage>1517</lpage>
      </element-citation>
    </ref>
    <ref id="CR40">
      <label>40.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kucuk</surname>
            <given-names>E</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Kollector: transcript-informed, targeted de novo assembly of gene loci</article-title>
        <source>Bioinformatics</source>
        <year>2017</year>
        <volume>33</volume>
        <fpage>1782</fpage>
        <lpage>1788</lpage>
        <pub-id pub-id-type="pmid">28186221</pub-id>
      </element-citation>
    </ref>
    <ref id="CR41">
      <label>41.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Vaser</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Sović</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Nagarajan</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Šikić</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Fast and accurate de novo genome assembly from long uncorrected reads</article-title>
        <source>Genome Res</source>
        <year>2017</year>
        <volume>27</volume>
        <fpage>737</fpage>
        <lpage>746</lpage>
        <pub-id pub-id-type="pmid">28100585</pub-id>
      </element-citation>
    </ref>
    <ref id="CR42">
      <label>42.</label>
      <mixed-citation publication-type="other">lh3/seqtk. <italic>GitHub</italic><ext-link ext-link-type="uri" xlink:href="https://github.com/lh3/seqtk">https://github.com/lh3/seqtk</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR43">
      <label>43.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Conway</surname>
            <given-names>JR</given-names>
          </name>
          <name>
            <surname>Lex</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Gehlenborg</surname>
            <given-names>N</given-names>
          </name>
        </person-group>
        <article-title>UpSetR: an R package for the visualization of intersecting sets and their properties</article-title>
        <source>Bioinformatics</source>
        <year>2017</year>
        <volume>33</volume>
        <fpage>2938</fpage>
        <lpage>2940</lpage>
        <pub-id pub-id-type="pmid">28645171</pub-id>
      </element-citation>
    </ref>
    <ref id="CR44">
      <label>44.</label>
      <mixed-citation publication-type="other">GitHub - TransDecoder/TransDecoder: TransDecoder source. <italic>GitHub</italic><ext-link ext-link-type="uri" xlink:href="https://github.com/TransDecoder/TransDecoder">https://github.com/TransDecoder/TransDecoder</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR45">
      <label>45.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <collab>The UniProt Consortium.</collab>
          <etal/>
        </person-group>
        <article-title>UniProt: the universal protein knowledgebase in 2021</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2020</year>
        <volume>49</volume>
        <fpage>D480</fpage>
        <lpage>D489</lpage>
      </element-citation>
    </ref>
    <ref id="CR46">
      <label>46.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Suzek</surname>
            <given-names>BE</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Huang</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>McGarvey</surname>
            <given-names>PB</given-names>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>CH</given-names>
          </name>
        </person-group>
        <article-title>UniRef clusters: a comprehensive and scalable alternative for improving sequence similarity searches</article-title>
        <source>Bioinformatics</source>
        <year>2014</year>
        <volume>31</volume>
        <fpage>926</fpage>
        <lpage>932</lpage>
        <pub-id pub-id-type="pmid">25398609</pub-id>
      </element-citation>
    </ref>
    <ref id="CR47">
      <label>47.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kriventseva</surname>
            <given-names>EV</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>OrthoDB v10: sampling the diversity of animal, plant, fungal, protist, bacterial and viral genomes for evolutionary and functional annotations of orthologs</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2018</year>
        <volume>47</volume>
        <fpage>D807</fpage>
        <lpage>D811</lpage>
      </element-citation>
    </ref>
    <ref id="CR48">
      <label>48.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pruitt</surname>
            <given-names>KD</given-names>
          </name>
          <name>
            <surname>Tatusova</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Brown</surname>
            <given-names>GR</given-names>
          </name>
          <name>
            <surname>Maglott</surname>
            <given-names>DR</given-names>
          </name>
        </person-group>
        <article-title>NCBI Reference Sequences (RefSeq): current status, new features and genome annotation policy</article-title>
        <source>Nucleic Acids Res</source>
        <year>2011</year>
        <volume>40</volume>
        <fpage>D130</fpage>
        <lpage>D135</lpage>
        <pub-id pub-id-type="pmid">22121212</pub-id>
      </element-citation>
    </ref>
    <ref id="CR49">
      <label>49.</label>
      <mixed-citation publication-type="other">Nip, K. M. Simulated data from: Reference-free assembly of long-read transcriptome sequencing data with RNA-Bloom2. Dryad. 10.5061/dryad.cc2fqz68w (2022).</mixed-citation>
    </ref>
    <ref id="CR50">
      <label>50.</label>
      <mixed-citation publication-type="other">Nip, K. M. bcgsc/RNA-Bloom: RNA-Bloom v2.0.0. Zenodo. 10.5281/zenodo.7824726 (2022).</mixed-citation>
    </ref>
  </ref-list>
</back>
