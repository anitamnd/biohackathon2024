<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d3 20150301//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 39.96?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?subarticle pone.0263882.r001?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">PLoS One</journal-id>
    <journal-id journal-id-type="iso-abbrev">PLoS One</journal-id>
    <journal-id journal-id-type="publisher-id">plos</journal-id>
    <journal-title-group>
      <journal-title>PLoS ONE</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1932-6203</issn>
    <publisher>
      <publisher-name>Public Library of Science</publisher-name>
      <publisher-loc>San Francisco, CA USA</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">8896705</article-id>
    <article-id pub-id-type="publisher-id">PONE-D-21-15766</article-id>
    <article-id pub-id-type="doi">10.1371/journal.pone.0263882</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research Article</subject>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Physical Sciences</subject>
        <subj-group>
          <subject>Astronomical Sciences</subject>
          <subj-group>
            <subject>Space Exploration</subject>
            <subj-group>
              <subject>Spaceflight</subject>
              <subj-group>
                <subject>Spacecraft</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Physical Sciences</subject>
        <subj-group>
          <subject>Astronomical Sciences</subject>
          <subj-group>
            <subject>Celestial Objects</subject>
            <subj-group>
              <subject>Comets</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Physical Sciences</subject>
        <subj-group>
          <subject>Mathematics</subject>
          <subj-group>
            <subject>Applied Mathematics</subject>
            <subj-group>
              <subject>Algorithms</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and Analysis Methods</subject>
        <subj-group>
          <subject>Simulation and Modeling</subject>
          <subj-group>
            <subject>Algorithms</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Engineering and Technology</subject>
        <subj-group>
          <subject>Equipment</subject>
          <subj-group>
            <subject>Optical Equipment</subject>
            <subj-group>
              <subject>Cameras</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Physical Sciences</subject>
        <subj-group>
          <subject>Astronomical Sciences</subject>
          <subj-group>
            <subject>Celestial Objects</subject>
            <subj-group>
              <subject>Moons</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Physical Sciences</subject>
        <subj-group>
          <subject>Astronomical Sciences</subject>
          <subj-group>
            <subject>Planetary Sciences</subject>
            <subj-group>
              <subject>Moons</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Earth Sciences</subject>
        <subj-group>
          <subject>Geomorphology</subject>
          <subj-group>
            <subject>Terrain</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Physical Sciences</subject>
        <subj-group>
          <subject>Materials Science</subject>
          <subj-group>
            <subject>Materials</subject>
            <subj-group>
              <subject>Dust</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Physical Sciences</subject>
        <subj-group>
          <subject>Astronomical Sciences</subject>
          <subj-group>
            <subject>Planetary Sciences</subject>
            <subj-group>
              <subject>Solar System</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>SISPO: Space Imaging Simulator for Proximity Operations</article-title>
      <alt-title alt-title-type="running-head">SISPO</alt-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" equal-contrib="yes">
        <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0003-3500-2770</contrib-id>
        <name>
          <surname>Pajusalu</surname>
          <given-names>Mihkel</given-names>
        </name>
        <role content-type="http://credit.niso.org/contributor-roles/conceptualization/">Conceptualization</role>
        <role content-type="http://credit.niso.org/contributor-roles/data-curation/">Data curation</role>
        <role content-type="http://credit.niso.org/contributor-roles/funding-acquisition/">Funding acquisition</role>
        <role content-type="http://credit.niso.org/contributor-roles/methodology/">Methodology</role>
        <role content-type="http://credit.niso.org/contributor-roles/software/">Software</role>
        <role content-type="http://credit.niso.org/contributor-roles/supervision/">Supervision</role>
        <role content-type="http://credit.niso.org/contributor-roles/writing-review-editing/">Writing – review &amp; editing</role>
        <xref rid="aff001" ref-type="aff">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes" equal-contrib="yes">
        <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0003-0744-2357</contrib-id>
        <name>
          <surname>Iakubivskyi</surname>
          <given-names>Iaroslav</given-names>
        </name>
        <role content-type="http://credit.niso.org/contributor-roles/data-curation/">Data curation</role>
        <role content-type="http://credit.niso.org/contributor-roles/investigation/">Investigation</role>
        <role content-type="http://credit.niso.org/contributor-roles/methodology/">Methodology</role>
        <role content-type="http://credit.niso.org/contributor-roles/software/">Software</role>
        <role content-type="http://credit.niso.org/contributor-roles/validation/">Validation</role>
        <role content-type="http://credit.niso.org/contributor-roles/visualization/">Visualization</role>
        <role content-type="http://credit.niso.org/contributor-roles/writing-original-draft/">Writing – original draft</role>
        <role content-type="http://credit.niso.org/contributor-roles/writing-review-editing/">Writing – review &amp; editing</role>
        <xref rid="aff001" ref-type="aff">
          <sup>1</sup>
        </xref>
        <xref rid="cor001" ref-type="corresp">*</xref>
      </contrib>
      <contrib contrib-type="author" equal-contrib="yes">
        <name>
          <surname>Schwarzkopf</surname>
          <given-names>Gabriel Jörg</given-names>
        </name>
        <role content-type="http://credit.niso.org/contributor-roles/formal-analysis/">Formal analysis</role>
        <role content-type="http://credit.niso.org/contributor-roles/investigation/">Investigation</role>
        <role content-type="http://credit.niso.org/contributor-roles/methodology/">Methodology</role>
        <role content-type="http://credit.niso.org/contributor-roles/software/">Software</role>
        <xref rid="aff002" ref-type="aff">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author" equal-contrib="yes">
        <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-5767-5872</contrib-id>
        <name>
          <surname>Knuuttila</surname>
          <given-names>Olli</given-names>
        </name>
        <role content-type="http://credit.niso.org/contributor-roles/data-curation/">Data curation</role>
        <role content-type="http://credit.niso.org/contributor-roles/investigation/">Investigation</role>
        <role content-type="http://credit.niso.org/contributor-roles/software/">Software</role>
        <role content-type="http://credit.niso.org/contributor-roles/validation/">Validation</role>
        <role content-type="http://credit.niso.org/contributor-roles/visualization/">Visualization</role>
        <role content-type="http://credit.niso.org/contributor-roles/writing-review-editing/">Writing – review &amp; editing</role>
        <xref rid="aff002" ref-type="aff">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author" equal-contrib="yes">
        <name>
          <surname>Väisänen</surname>
          <given-names>Timo</given-names>
        </name>
        <role content-type="http://credit.niso.org/contributor-roles/methodology/">Methodology</role>
        <role content-type="http://credit.niso.org/contributor-roles/software/">Software</role>
        <role content-type="http://credit.niso.org/contributor-roles/visualization/">Visualization</role>
        <xref rid="aff002" ref-type="aff">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author" equal-contrib="yes">
        <name>
          <surname>Bührer</surname>
          <given-names>Maximilian</given-names>
        </name>
        <role content-type="http://credit.niso.org/contributor-roles/investigation/">Investigation</role>
        <role content-type="http://credit.niso.org/contributor-roles/methodology/">Methodology</role>
        <role content-type="http://credit.niso.org/contributor-roles/software/">Software</role>
        <role content-type="http://credit.niso.org/contributor-roles/visualization/">Visualization</role>
        <xref rid="aff002" ref-type="aff">
          <sup>2</sup>
        </xref>
        <xref rid="aff003" ref-type="aff">
          <sup>3</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author" equal-contrib="yes">
        <name>
          <surname>Palos</surname>
          <given-names>Mario F.</given-names>
        </name>
        <role content-type="http://credit.niso.org/contributor-roles/investigation/">Investigation</role>
        <role content-type="http://credit.niso.org/contributor-roles/software/">Software</role>
        <role content-type="http://credit.niso.org/contributor-roles/visualization/">Visualization</role>
        <xref rid="aff002" ref-type="aff">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Teras</surname>
          <given-names>Hans</given-names>
        </name>
        <role content-type="http://credit.niso.org/contributor-roles/investigation/">Investigation</role>
        <role content-type="http://credit.niso.org/contributor-roles/methodology/">Methodology</role>
        <role content-type="http://credit.niso.org/contributor-roles/software/">Software</role>
        <xref rid="aff001" ref-type="aff">
          <sup>1</sup>
        </xref>
        <xref rid="econtrib001" ref-type="author-notes">
          <sup>‡</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-8430-1788</contrib-id>
        <name>
          <surname>Le Bonhomme</surname>
          <given-names>Guillaume</given-names>
        </name>
        <role content-type="http://credit.niso.org/contributor-roles/validation/">Validation</role>
        <role content-type="http://credit.niso.org/contributor-roles/visualization/">Visualization</role>
        <xref rid="aff001" ref-type="aff">
          <sup>1</sup>
        </xref>
        <xref rid="econtrib001" ref-type="author-notes">
          <sup>‡</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Praks</surname>
          <given-names>Jaan</given-names>
        </name>
        <role content-type="http://credit.niso.org/contributor-roles/supervision/">Supervision</role>
        <role content-type="http://credit.niso.org/contributor-roles/validation/">Validation</role>
        <xref rid="aff002" ref-type="aff">
          <sup>2</sup>
        </xref>
        <xref rid="econtrib001" ref-type="author-notes">
          <sup>‡</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0001-7310-7608</contrib-id>
        <name>
          <surname>Slavinskis</surname>
          <given-names>Andris</given-names>
        </name>
        <role content-type="http://credit.niso.org/contributor-roles/investigation/">Investigation</role>
        <role content-type="http://credit.niso.org/contributor-roles/project-administration/">Project administration</role>
        <role content-type="http://credit.niso.org/contributor-roles/supervision/">Supervision</role>
        <role content-type="http://credit.niso.org/contributor-roles/validation/">Validation</role>
        <xref rid="aff001" ref-type="aff">
          <sup>1</sup>
        </xref>
        <xref rid="econtrib001" ref-type="author-notes">
          <sup>‡</sup>
        </xref>
      </contrib>
    </contrib-group>
    <aff id="aff001">
      <label>1</label>
      <addr-line>Space Technology Department, Tartu Observatory, University of Tartu, Tõravere, Estonia</addr-line>
    </aff>
    <aff id="aff002">
      <label>2</label>
      <addr-line>Department of Electronics and Nanoengineering, School of Electrical Engineering, Aalto University, Espoo, Finland</addr-line>
    </aff>
    <aff id="aff003">
      <label>3</label>
      <addr-line>School of Aerospace, Transport and Manufacturing, Cranfield University, Cranfield, Bedfordshire, United Kingdom</addr-line>
    </aff>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Agudo</surname>
          <given-names>Antonio</given-names>
        </name>
        <role>Editor</role>
        <xref rid="edit1" ref-type="aff"/>
      </contrib>
    </contrib-group>
    <aff id="edit1">
      <addr-line>Institut de Robotica i Informatica Industrial, SPAIN</addr-line>
    </aff>
    <author-notes>
      <fn fn-type="COI-statement" id="coi001">
        <p><bold>Competing Interests: </bold>The authors have declared that no competing interests exist.</p>
      </fn>
      <fn fn-type="other" id="econtrib001">
        <p>‡ HT, GLB, JP and AS also contributed equally to this work.</p>
      </fn>
      <corresp id="cor001">* E-mail: <email>iaroslav.iakubivskyi@ut.ee</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>4</day>
      <month>3</month>
      <year>2022</year>
    </pub-date>
    <volume>17</volume>
    <issue>3</issue>
    <elocation-id>e0263882</elocation-id>
    <history>
      <date date-type="received">
        <day>12</day>
        <month>5</month>
        <year>2021</year>
      </date>
      <date date-type="accepted">
        <day>28</day>
        <month>1</month>
        <year>2022</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© 2022 Pajusalu et al</copyright-statement>
      <copyright-year>2022</copyright-year>
      <copyright-holder>Pajusalu et al</copyright-holder>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <self-uri content-type="pdf" xlink:href="pone.0263882.pdf"/>
    <abstract>
      <p>This paper describes the architecture and demonstrates the capabilities of a newly developed, physically-based imaging simulator environment called SISPO, developed for small solar system body fly-by and terrestrial planet surface mission simulations. The image simulator utilises the open-source 3-D visualisation system Blender and its Cycles rendering engine, which supports physically based rendering capabilities and procedural micropolygon displacement texture generation. The simulator concentrates on realistic surface rendering and has supplementary models to produce realistic dust- and gas-environment optical models for comets and active asteroids. The framework also includes tools to simulate the most common image aberrations, such as tangential and sagittal astigmatism, internal and external comatic aberration, and simple geometric distortions. The model framework’s primary objective is to support small-body space mission design by allowing better simulations for characterisation of imaging instrument performance, assisting mission planning, and developing computer-vision algorithms. SISPO allows the simulation of trajectories, light parameters and camera’s intrinsic parameters.</p>
    </abstract>
    <funding-group>
      <award-group id="award001">
        <funding-source>
          <institution>Eesti Teadusagentuur (EE)</institution>
        </funding-source>
        <award-id>PUTJD601</award-id>
        <principal-award-recipient>
          <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0003-3500-2770</contrib-id>
          <name>
            <surname>Pajusalu</surname>
            <given-names>Mihkel</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group id="award002">
        <funding-source>
          <institution>Archimedes Foundation (https://archimedes.ee, UT ASTRA project</institution>
        </funding-source>
        <award-id>2014--2020.4.01.16-0029 KOMEET</award-id>
      </award-group>
      <award-group id="award003">
        <funding-source>
          <institution>Eesti Teadusagentuur (EE)</institution>
        </funding-source>
        <award-id>MOBTP151</award-id>
        <principal-award-recipient>
          <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0003-3500-2770</contrib-id>
          <name>
            <surname>Pajusalu</surname>
            <given-names>Mihkel</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group id="award004">
        <funding-source>
          <institution>ESA Contract No. 4000131003/20/NL/IB/ig with the University of Tartu</institution>
        </funding-source>
        <principal-award-recipient>
          <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0003-3500-2770</contrib-id>
          <name>
            <surname>Pajusalu</surname>
            <given-names>Mihkel</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group id="award005">
        <funding-source>
          <institution>Tartu Observatory</institution>
        </funding-source>
      </award-group>
      <funding-statement>This work was funded by the ESA Contract No. 4000131003/20/NL/IB/ig with the University of Tartu ("Comet Interceptor (EE-1): OPIC Engineering Model Development", PI is MP; the salary was paid to: MP, II, GLB, HT, and hardware acquisition), the Archimedes Foundation (<ext-link xlink:href="https://archimedes.ee" ext-link-type="uri">https://archimedes.ee</ext-link>, UT ASTRA project 2014–2020.4.01.16-0029 KOMEET “Benefits for Estonian Society from Space Research and Application” in the form of travel supports), the Eesti Teadusagentuur (EE) (MOBTP151 and PUTJD601, awarded to MP), and the base funding of Tartu Observatory (registration number 74001073). The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
    </funding-group>
    <counts>
      <fig-count count="17"/>
      <table-count count="2"/>
      <page-count count="23"/>
    </counts>
    <custom-meta-group>
      <custom-meta id="data-availability">
        <meta-name>Data Availability</meta-name>
        <meta-value>All SISPO algorithm files are available from the GitHub (<ext-link xlink:href="https://github.com/SISPO-developers" ext-link-type="uri">https://github.com/SISPO-developers</ext-link>).</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
  <notes>
    <title>Data Availability</title>
    <p>All SISPO algorithm files are available from the GitHub (<ext-link xlink:href="https://github.com/SISPO-developers" ext-link-type="uri">https://github.com/SISPO-developers</ext-link>).</p>
  </notes>
</front>
<body>
  <sec sec-type="intro" id="sec001">
    <title>Introduction</title>
    <p>A versatile image-simulation environment is required in order to design advanced deep-space missions, to simulate large sets of mission scenarios in parallel, and to develop and validate algorithms for semi-autonomous operations, visual navigation, localisation and image processing. This is especially true in the case of Small Solar System Body (SSSB) mission scenarios, where the mission has to be designed with either very limited information about the target (i.e., precise size, shape, exact composition and activity) or the targets can remain a near-complete mystery before their close encounter (i.e., as in the case of interstellar objects [<xref rid="pone.0263882.ref001" ref-type="bibr">1</xref>, <xref rid="pone.0263882.ref002" ref-type="bibr">2</xref>]). Some publicly known cosmic-synthetic-image generators for space missions are available, and they are briefly described in the next paragraph.</p>
    <p>Airbus Defence and Space has developed SurRender, which renders realistic images with a high level of representativeness for space scenes [<xref rid="pone.0263882.ref003" ref-type="bibr">3</xref>]. It uses ray tracing to simulate views of scenes composed of planets, satellites, asteroids and stars, taking into account the illumination conditions and the characteristics of the imaging camera through a user-defined Point Spread Function (PSF). The textures are accessed in a large virtual file, or procedural texture generation can be used. SurRender uses the different models for Bidirectional Reflectance Distribution Function (BRDF), for example Lambertian [<xref rid="pone.0263882.ref004" ref-type="bibr">4</xref>] or [<xref rid="pone.0263882.ref005" ref-type="bibr">5</xref>–<xref rid="pone.0263882.ref007" ref-type="bibr">7</xref>] for the Moon and asteroids, [<xref rid="pone.0263882.ref008" ref-type="bibr">8</xref>] for the Jovian moons. The University of Dundee, UK has developed the Planet and Asteroid Natural Scene Generation Utility (PANGU), which generates realistic, high-quality, synthetic images of planets and asteroids using a custom graphics-processing-unit-based renderer, which includes a parameterisable camera model [<xref rid="pone.0263882.ref009" ref-type="bibr">9</xref>]; it also has a graphical user interface, which makes it more intuitive to use. PANGU implements a Spacecraft Planet Instrument Camera-matrix Events (SPICE) interface, which provides historical and future ephemerides of the Solar System and selected spacecraft. The standard Lambertian diffuse reflectivity model is included as well as Hapke, Oren–Nayar, Blinn–Phong and Cook–Torrance BRDFs. NASA’s Navigation and Ancillary Information Facility developed the internationally recognised Spacecraft Planet Instrument Camera-matrix Events (SPICE) tool, which provides the fundamental observation geometry needed to perform photogrammetry, map making and other kinds of planetary science data analysis [<xref rid="pone.0263882.ref010" ref-type="bibr">10</xref>]. It is a numerical tool that provides position and orientation ephemerides of spacecraft and target bodies (including their size and shape), instrument-mounting alignment and field-of-view geometry, reference frame specifications, and underlying time-system conversions; however, it does not have surface-rendering capabilities, and it is limited to shape rendering by implementing the digital shape kernel system (tessellated plate data and digital elevation models). SPICE has the three-dimensional (3-D) visualisation application Cosmographia [<xref rid="pone.0263882.ref011" ref-type="bibr">11</xref>], and has been recently implemented in the toolkit with rendering capabilities for spacecraft orbit visualisation and depictions of observations by probe instruments in Blender [<xref rid="pone.0263882.ref012" ref-type="bibr">12</xref>]. Hapke model also has been used with Blender previously [<xref rid="pone.0263882.ref013" ref-type="bibr">13</xref>].</p>
    <p>The comparison between various simulators that are capable of SSSB synthetic image generation is summarised in <xref rid="pone.0263882.g001" ref-type="fig">Fig 1</xref> (camera, orientation and exact light parameters may differ between simulator set-ups). The 25143 Itokawa asteroid model by the [<xref rid="pone.0263882.ref014" ref-type="bibr">14</xref>] was used.</p>
    <fig position="float" id="pone.0263882.g001">
      <object-id pub-id-type="doi">10.1371/journal.pone.0263882.g001</object-id>
      <label>Fig 1</label>
      <caption>
        <title>The comparison of available simulators for space-scene image rendering.</title>
        <p>The rendered example for each simulator is asteroid 25143 Itokawa. (A) SurRender image generator by Airbus; it uses backward ray tracing or image generation with Open Graphics Library (OpenGL). (B) PANGU image generator by University of Dundee, UK and ESA; it uses fractal terrain generation using OpenGL. (C) SISPO by the University of Tartu, Estonia and Aalto University, Finland; it uses Blender Cycles physically based path tracer (the same model as above with a simple diffuse shader); (D) SISPO with Blender Cycles physically based path tracer (with procedural displacement with new surface features and reflectance textures for extra detail).</p>
      </caption>
      <graphic xlink:href="pone.0263882.g001" position="float"/>
    </fig>
    <p>The Space Imaging Simulator for Proximity Operations (SISPO) has been developed to provide a full pipeline from simulated imagery to final data products (e.g., 3-D models); to include photorealistic, physically based rendering; to support automatic surface generation with <bold>procedural displacement textures</bold>; to allow the implementation of spacecraft, instrument and environmental models (e.g., imaging distortions, gas and dust environment, attitude dynamics); and to avoid legacy software. SISPO uses Cycles rendering with the Blender software package, which allows for programming procedures in Python [<xref rid="pone.0263882.ref015" ref-type="bibr">15</xref>]. The preliminary results of 3-D reconstruction and localisation using SISPO, without providing details for simulated imagery and near environment (i.e., gas and dust), were published by [<xref rid="pone.0263882.ref016" ref-type="bibr">16</xref>]. SISPO works on large scales and could simulate a variety of objects at the Solar System scale. It could also be used to generate realistic videos from individual frames, either for visualisation purposes or public outreach.</p>
    <p>This article demonstrates the synthetic image simulation capabilities of SISPO, and 3-D reconstruction as a case study showing how such images can be utilised. It also discusses SISPO application to actual space missions, architecture, rendering system and supplementary models.</p>
    <sec id="sec002">
      <title>Application to space mission designs</title>
      <p>An increasing number of missions and mission concepts for studying SSSBs require advanced and autonomous operations. For instance, Hera’s Asteroid Prospection Explorer daughter-craft (previously called ASPECT) has to navigate autonomously within the proximity of Didymos and its natural satellite [<xref rid="pone.0263882.ref017" ref-type="bibr">17</xref>]; The M-ARGO might be the first-ever standalone nanospacecraft to rendezvous with an asteroid [<xref rid="pone.0263882.ref018" ref-type="bibr">18</xref>]; CASTAway is a mission concept to fly by and explore 10–20 main-belt asteroids and use optical navigation in their proximity [<xref rid="pone.0263882.ref019" ref-type="bibr">19</xref>]; a proposed mission, Castalia, to the main-belt comet 133P/Elst–Pizarro would reveal much that is currently unknown about it and detect water <italic toggle="yes">in situ</italic> in the main belt [<xref rid="pone.0263882.ref020" ref-type="bibr">20</xref>]; Caroline was proposed in 2010 to also fly by a main-belt comet [<xref rid="pone.0263882.ref021" ref-type="bibr">21</xref>]; Titius–Bode is a mission concept to investigate a sequence of asteroids by orbiting its targets for about six months and dispose the Bode lander on the surface [<xref rid="pone.0263882.ref022" ref-type="bibr">22</xref>]; The Martian moons Deimos and Phobos were also targeted by DePhine [<xref rid="pone.0263882.ref023" ref-type="bibr">23</xref>] and Phobos Sample Return [<xref rid="pone.0263882.ref024" ref-type="bibr">24</xref>]. Development and planning of these missions and similar ones require a sophisticated and realistic simulator.</p>
      <p>The initial SISPO package was developed to assist in the Multi-Asteroid Touring (MAT) mission, where a fleet of nanospacecraft, propelled by electric sails, flys by a large number of main-belt asteroids [<xref rid="pone.0263882.ref025" ref-type="bibr">25</xref>, <xref rid="pone.0263882.ref026" ref-type="bibr">26</xref>]. The MAT concept cannot rely on typical deep-space-network-based solutions to operate and navigate the fleet; it requires most of the operations to be performed autonomously. The case study of MAT performing a Didymos fly-by has been evaluated using SISPO; the set of images was generated for the reconstruction and basic localisation for fly-by distances of 33–300 km [<xref rid="pone.0263882.ref016" ref-type="bibr">16</xref>]. The MAT mission was proposed to the European Space Agency (ESA) announcement of opportunity for “New Science Ideas” [<xref rid="pone.0263882.ref027" ref-type="bibr">27</xref>] and it was not chosen despite reaching the final three [<xref rid="pone.0263882.ref028" ref-type="bibr">28</xref>].</p>
      <p>Currently, the SISPO simulator is actively used for Optical Periscopic Imager for Comets (OPIC) development [<xref rid="pone.0263882.ref029" ref-type="bibr">29</xref>], which will be hosted on one of three spacecraft making up the Comet Interceptor mission (<ext-link xlink:href="https://www.cometinterceptor.space" ext-link-type="uri">https://www.cometinterceptor.space</ext-link>). Comet Interceptor is ESA’s first F-class mission (in cooperation with Japan Aerospace Exploration Agency (JAXA)) to fly by either a dynamically new comet approaching the Sun for the first time from the Öpik—Oort cloud, an interstellar object, or a long-period comet as a backup target [<xref rid="pone.0263882.ref030" ref-type="bibr">30</xref>]. OPIC will use automatic image capturing—algorithms will be developed and tested using photorealistic 3-D renderings and a reconstruction pipeline of SISPO using a set of possible encounter velocities and geometries, as well as cometary and camera properties. From a scientific point of view, the simulator will also be used to develop image-prioritisation algorithms, which are required due to the limited data budget, short fly-by timeline and the possibility of the probe being damaged by high-velocity dust impact. The EnVisS coma mapper [<xref rid="pone.0263882.ref031" ref-type="bibr">31</xref>] of the Comet Interceptor mission also uses SISPO for algorithm development.</p>
    </sec>
  </sec>
  <sec id="sec003">
    <title>General architecture</title>
    <p>The general structure of SISPO comprises the following parts:</p>
    <list list-type="order">
      <list-item>
        <p>Core features:
<list list-type="alpha-lower"><list-item><p>Image rendering using Blender Cycles (see Subsection: Rendering in Blender Cycles) or OpenGL (see Subsection: Lightweight OpenGL-based rendering);</p></list-item><list-item><p>Simulation of on-board image processing. Currently the image processing is primarily related to compression; however, inclusion of both cropping and image prioritisation is planned;</p></list-item><list-item><p>3-D reconstruction (see Section: Usability of images produced for 3D reconstruction).</p></list-item></list></p>
      </list-item>
      <list-item>
        <p>Additional models:
<list list-type="alpha-lower"><list-item><p>Gas and dust environment (see Subsection: Gas and dust);</p></list-item><list-item><p>Camera distortions (see Subsection: Camera);</p></list-item><list-item><p>Attitude dynamics in the initial stage.</p></list-item></list></p>
      </list-item>
    </list>
    <p>The core functionalities are split into three subpackages. The first subpackage uses Keplerian orbit data for an SSSB and a simplified definition of the encounter geometry so the spacecraft can propagate realistic trajectories using the Orekit library [<xref rid="pone.0263882.ref032" ref-type="bibr">32</xref>] and render an image series of the encounter. The second subpackage provides various algorithms for image compression and decompression. The third subpackage uses images to reconstruct a textured 3-D model using the Structure from Motion (SfM) technique. The three subpackages combined provide a processing pipeline from an initial 3-D model to a reconstructed 3-D model via rendered and compressed images. SISPO is a Python software package that is hosted on a public <italic toggle="yes">GitHub</italic> repository under a <italic toggle="yes">GPL v3.0</italic> licence and is maintained by the authors [<xref rid="pone.0263882.ref033" ref-type="bibr">33</xref>] among other contributors (e.g., authors of this paper). A description of the core functionality and the additional models is provided in <xref rid="pone.0263882.g002" ref-type="fig">Fig 2</xref>.</p>
    <fig position="float" id="pone.0263882.g002">
      <object-id pub-id-type="doi">10.1371/journal.pone.0263882.g002</object-id>
      <label>Fig 2</label>
      <caption>
        <title>Program flow of SISPO.</title>
      </caption>
      <graphic xlink:href="pone.0263882.g002" position="float"/>
    </fig>
  </sec>
  <sec id="sec004">
    <title>Rendering system</title>
    <p>The most crucial part of SISPO is image synthesis. Two separate rendering modes are implemented: Blender Cycles and OpenGL.</p>
    <sec id="sec005">
      <title>Rendering in Blender Cycles</title>
      <p>Blender Cycles uses path tracing, which is a type of ray tracing. In classic ray tracing [<xref rid="pone.0263882.ref034" ref-type="bibr">34</xref>], each camera’s pixel shoots one or multiple rays, which interact with a surface and then encounters light sources directly or interacts with other surfaces before reaching the light. For realistic reproduction, various optimisations can be used. The ray-surface and ray-volume interactions can be modelled by shaders, which model or approximate the interacting objects’ properties.</p>
      <p>The Cycles rendering engine supports various shaders, the most relevant of those for this paper being: (i) diffuse bidirectional scattering distribution function, which provides access to Lambertian and Oren–Nayal shaders based on surface roughness; (ii) emission shader that allows surfaces or volumes to emit light; (iii) subsurface scattering that supports cubic, Gaussian and Christensen–Burley models; (iii) glossy shader that supports Sharp, Beckmann, <italic toggle="yes">GGX</italic>, Asikhmin–Shirley and multi-scatter <italic toggle="yes">GGX</italic> models; (iv) volume scattering shader that allows simulating light scattering in volumes [<xref rid="pone.0263882.ref015" ref-type="bibr">15</xref>]. These shaders can be combined with both procedurally generated or pre-existing texture maps to change their parameters and mix various shaders on and within the scene models. Cycles also supports Open Shading Language, which allows the use of arbitrarily defined shaders.</p>
      <p>Path tracing is, in some way, an improvement on ray tracing; it produces multiple rays from the same pixel in random directions, then each ray keeps bouncing (without producing new rays) until it reaches the light source or user-defined bounce limit. In Blender Cycles, one can limit the following bounce limits (ideally it should be infinite; however, typically, a limited amount is sufficient): total, diffuse, glossy, transparency, transmission and volume scattering. Then, the amount of light per pixel is calculated for each ray along with surface colour properties; afterwards, the value is averaged and assigned to that specific pixel. Moreover, Blender has a branched path tracer, which can be used for volumetric scattering (see Subsection: Case 2: volumetric particle effects). The branched path tracer is similar to path tracing, but at the first ray interaction it will split the path for different surface components, and for shading, it will take all lighting parameters into account instead of just one [<xref rid="pone.0263882.ref015" ref-type="bibr">15</xref>]. The branched path tracer can also be useful for solving light-related problems such as caustics.</p>
      <p>All the surface features can be generated procedurally (e.g., by applying mathematical equations instead of externally-captured image texture) inside the Blender software [<xref rid="pone.0263882.ref035" ref-type="bibr">35</xref>]. The SISPO surface model includes sand flats, rock formations and craters. The size of these features, their number and their distribution can be adjusted by modifying the corresponding parameters.</p>
      <p>The elevation details are simulated by using height maps for craters, rocks and sand inside the rendering engine (<xref rid="pone.0263882.g003" ref-type="fig">Fig 3</xref>). These consist of textures converted into surface displacement distances and are used to displace parts of the model mesh and provide surface normal changes.</p>
      <fig position="float" id="pone.0263882.g003">
        <object-id pub-id-type="doi">10.1371/journal.pone.0263882.g003</object-id>
        <label>Fig 3</label>
        <caption>
          <title>Procedurally generated height maps.</title>
          <p>For craters (left), rocks (centre) and sand (right).</p>
        </caption>
        <graphic xlink:href="pone.0263882.g003" position="float"/>
      </fig>
      <p>Height maps can be mixed together to simulate different types of terrestrial bodies (see Section: Simulations of realistic asteroid imagery). Each map’s weight in the mix can be modified, or even obliterated, and they can be made to affect only specific areas of the mesh by using masks. The shader adds a texture whose albedo corresponds to the albedo measured in real asteroids in addition to the procedural elevation. The final procedural shader example is shown in <xref rid="pone.0263882.g004" ref-type="fig">Fig 4</xref>.</p>
      <fig position="float" id="pone.0263882.g004">
        <object-id pub-id-type="doi">10.1371/journal.pone.0263882.g004</object-id>
        <label>Fig 4</label>
        <caption>
          <title>Final procedural shader applied to a subdivided plane.</title>
        </caption>
        <graphic xlink:href="pone.0263882.g004" position="float"/>
      </fig>
    </sec>
    <sec id="sec006">
      <title>Lightweight OpenGL-based rendering</title>
      <p>There is an option to use a custom OpenGL-based renderer instead of Cycles and Blender. It was added because it is desirable to generate images fast in certain situations even though some fidelity (e.g., softer shadows or procedurally generated details) might be lost. For instance, during the development of image-processing algorithms, it is useful to generate large datasets for training data in a relatively short time. Validation data can be generated with Cycles to give better confidence in the characterised algorithm performance. Fast image generation also enables a closed-loop simulation of a guidance, navigation and control system that depends on the navigation camera input.</p>
      <p>Three different BRDFs have been implemented as OpenGL shaders: Lambertian [<xref rid="pone.0263882.ref004" ref-type="bibr">4</xref>], Lunar-Lambertian [<xref rid="pone.0263882.ref036" ref-type="bibr">36</xref>] and Hapke [<xref rid="pone.0263882.ref037" ref-type="bibr">37</xref>]. Textures are supported and correspond to the single scattering albedo of the corresponding shape model region.</p>
      <p>Efficient shadowing is achieved by shadow mapping [<xref rid="pone.0263882.ref038" ref-type="bibr">38</xref>]. Shadow mapping works by first rendering the scene orthographically from the direction of the Sun. The resulting depth buffer contents are imported to the actual rendering pass as a texture. The object vertices are again projected orthographically towards the Sun; the corresponding fragment is considered to be in the shadow if the depth of that projection is greater what is in the shadow texture.</p>
      <p>The output of the OpenGL render is a floating-point value giving the irradiance [W ⋅ m<sup>−2</sup>] incident on each theoretical pixel. This “irradiance image” can be further passed to the default camera model used by SISPO, which then applies appropriate imaging effects to get the final synthetic image. There is currently no procedural shape or texture generation due to the simplified nature of the OpenGL renderer. Dust and gas coma rendering is not fully integrated with the OpenGL renderer. Instead, emission-based rendering of a previously generated coma is done separately in Python after OpenGL rendering (see Subsection: Case 2: volumetric particle effects), and it does not take into account shadows cast by objects in the scene. One fundamental limitation to OpenGL-based rendering is that it does not support extended light sources. Thus, for instance, earthshine in low Earth orbit—or in the case of a binary asteroid, the reflected light from the primary body to the secondary body—cannot be reasonably modelled. As the light from reflecting surfaces is not considered, the shadow of rocks, cliffs and other geological formations will be darker than in reality.</p>
      <p>The OpenGL rendering engine was used for a preliminary guidance, navigation and control analysis done for the preliminary design review of the now-defunct Asteroid Prospection Explorer project. For this purpose, the rendering engine was interfaced from a Simulink model designed to handle the system dynamics. The same model then forwarded the generated images to the visual navigation algorithms for position estimates. The generation of one image took around 0.7–1.0 seconds. The simulation time for one mission week was around 12 hours on a laptop with an Intel i7–7700HQ (2.8 GHz) processor, with most of the processing time spent on executing the visual navigation algorithms.</p>
      <p><xref rid="pone.0263882.g005" ref-type="fig">Fig 5</xref> demonstrates the comparison between the image taken by the AMICA instrument of the Hayabusa spacecraft and rendered image using OpenGL. The main rendering discrepancies are induced by the inaccuracy of the 3D model [<xref rid="pone.0263882.ref014" ref-type="bibr">14</xref>] and local variations of albedo and roughness.</p>
      <fig position="float" id="pone.0263882.g005">
        <object-id pub-id-type="doi">10.1371/journal.pone.0263882.g005</object-id>
        <label>Fig 5</label>
        <caption>
          <title>The pixel-by-pixel comparison of the original AMICA image on the left and generated OpenGL image in the middle.</title>
          <p>The scale indicates percent error. The AMICA image is published under Public Domain 1.0.</p>
        </caption>
        <graphic xlink:href="pone.0263882.g005" position="float"/>
      </fig>
    </sec>
  </sec>
  <sec id="sec007">
    <title>Supplementary SISPO models</title>
    <sec id="sec008">
      <title>Gas and dust</title>
      <p>In the inner Solar System, the solar radiation heats nuclei of comets, which causes them to release gas together with dust. This gas and dust surround a comet forming a coma, which is blown by the solar wind resulting in ion and dust tails that can extend over 100 million kilometres and might be visible from Earth. Sometimes the comet releases strong outbursts of these gasses and dust to produce distinctive coma-derived features called jets [<xref rid="pone.0263882.ref039" ref-type="bibr">39</xref>]. The gas and dust environment is visible to the camera instrumentation, and hence, in order to provide realistic space-scene simulation, the visible effects should be included in modelling.</p>
      <p>The dust and gas environment causes noise that can affect the 3-D shape reconstruction. SISPO offers models for comae, jets and tails with various details. The problem can be divided into two parts: modelling the environment and rendering it. The modelling parts can contain, for instance, the description of the environment, such as jets represented as geometric cones from the surface of the comet, mathematical models from [<xref rid="pone.0263882.ref040" ref-type="bibr">40</xref>], or gas and dust simulations such as those from [<xref rid="pone.0263882.ref041" ref-type="bibr">41</xref>, <xref rid="pone.0263882.ref042" ref-type="bibr">42</xref>].</p>
      <p>The rendering problem comes down to the level of desired details and accuracy, but on the other hand, to reasonable computing time. In reality, the volume is a mixture of gas and dust, which are composed of different particle sizes with different densities, and this produces various scattering characteristics [<xref rid="pone.0263882.ref043" ref-type="bibr">43</xref>]. Realistic and accurate representation of the effects mentioned above in the rendering pipeline, which is not specialised in volume scattering, is a challenge; a visually realistic approximation should be sought. In the current version of SISPO, volume-scattering effects from the coma and jets are computed using a simple volume-scattering shader from Cycle that uses the voxel presentation of the comet’s surroundings as an input for the density.</p>
    </sec>
    <sec id="sec009">
      <title>Camera</title>
      <p>The Optical Aberrations for Still Images Simulator (OASIS) provides simulation tools for optical aberrations that are usually not implemented in popular 3-D software (e.g., Blender). Since it uses two-dimensional images as input, motion blur effects, which require spatial awareness of a scene, are not modelled. Optical Aberrations for Still Images Simulator (OASIS) is used in a complementary manner with SISPO to further enhance rendered two-dimensional output images.</p>
      <p>Tangential and sagittal astigmatism, as well as an internal and external comatic aberration, are modelled with distinct PSFs, which vary with the field height and orientation of the sensor centre—image point vector. By default, aberration intensity increases with the field height. However, a custom lens file can be provided to model any desired lens array.</p>
      <p>Lateral chromatic aberration is modelled by rescaling individual colour channels and simulating wavelength-dependent refraction of light rays. While wavelengths are continuous in the real world, the digital Red, Green and Blue (RGB) triplet only distinguishes between three discrete primitive colours, which introduces sharp edges at the boundaries of colour separation. These can be avoided by blending chromatic aberration with tangential astigmatism (more information with an example can be found in Section 5.7 in [<xref rid="pone.0263882.ref044" ref-type="bibr">44</xref>]).</p>
      <p>Dark-current noise is currently drawn from a folded normal distribution with a zero mean and user-defined standard deviation. Readout noise is modelled by the addition and subtraction of random values at the subpixel level, governed by a Gaussian custom standard deviation process. The projection of light rays with random origin positions generates realistic shot noise and follows the user-defined average sample size per pixel.</p>
      <p>Lens distortion is simulated with a sophisticated Brown–Conrady model [<xref rid="pone.0263882.ref045" ref-type="bibr">45</xref>], that corrects for both radial and tangential distortion. It is implemented in the computer-vision library OpenCV [<xref rid="pone.0263882.ref046" ref-type="bibr">46</xref>] and supports up to six radial distortion coefficients—<italic toggle="yes">k</italic><sub>1</sub> to <italic toggle="yes">k</italic><sub>6</sub>—and two tangential distortion coefficients—<italic toggle="yes">p</italic><sub>1</sub> and <italic toggle="yes">p</italic><sub>2</sub>.</p>
      <p>Monochrome sensors are modelled by averaging an RGB colour triplet of a virtual light ray. Additionally, a weighted-average model can be selected that reflects the indeed perceived luminosity. The generation of dark current and readout noise is adjusted accordingly to maintain a specified standard deviation on monochromatic detectors. The simulation of sagittal astigmatism, coma, chromatic aberration, shot noise and readout noise is demonstrated in more detail in [<xref rid="pone.0263882.ref044" ref-type="bibr">44</xref>] (Section 5.7).</p>
      <p>Currently, OASIS is limited to simulating one type of PSF at a time, as a realistic convolution of multiple PSFs is not yet provided, with the exception of small aberrations. Also, the generation of dark noise, which should follow a Poisson distribution, is subject to change once physical units are implemented for photon flux and for the conversion between light-ray energy and digital-sensor value.</p>
    </sec>
    <sec id="sec010">
      <title>Orbital simulation</title>
      <p>The trajectory simulation within SISPO is handled by the Orekit library [<xref rid="pone.0263882.ref032" ref-type="bibr">32</xref>]. A simple Keplerian orbit propagator is used to propagate both the SSSB and the spacecraft. Additionally, it is possible to rotate the SSSB around a single axis at a constant spin rate.</p>
      <p>The implemented Orekit Python bindings run a virtual machine to execute the underlying Java code. During propagation, Orekit determines state information of the SSSB and the spacecraft for each sample along the trajectory. The state information includes the date, position and the rotation angles of the SSSB.</p>
      <p>In SISPO, the spacecraft trajectory is normally defined by its Keplerian elements, but the user does not explicitly enter these elements. Instead, the elements are calculated from the target body’s Keplerian elements and the expected encounter geometry relative to the SSSB at the closest approach. The parameters presented in <xref rid="pone.0263882.t001" ref-type="table">Table 1</xref> are used to calculate the state vector of the spacecraft at the encounter, which defines the spacecraft trajectory. The <italic toggle="yes">sssb_state</italic> is calculated based on the SSSB input data and the encounter data.</p>
      <table-wrap position="float" id="pone.0263882.t001">
        <object-id pub-id-type="doi">10.1371/journal.pone.0263882.t001</object-id>
        <label>Table 1</label>
        <caption>
          <title>Parameters defining the encounter state of the spacecraft in SISPO.</title>
          <p>The first five parameters are required as input.</p>
        </caption>
        <alternatives>
          <graphic xlink:href="pone.0263882.t001" id="pone.0263882.t001g" position="float"/>
          <table frame="box" rules="all" border="0">
            <colgroup span="1">
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <th align="left" rowspan="1" colspan="1">Parameter</th>
                <th align="left" rowspan="1" colspan="1">Unit</th>
                <th align="left" rowspan="1" colspan="1">Type</th>
                <th align="left" rowspan="1" colspan="1">Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="left" rowspan="1" colspan="1">encounter_distance</td>
                <td align="left" rowspan="1" colspan="1">m</td>
                <td align="left" rowspan="1" colspan="1">
                  <italic toggle="yes">float</italic>
                </td>
                <td align="left" rowspan="1" colspan="1">Minimum distance between SSSB and spacecraft.</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">with_terminator</td>
                <td align="left" rowspan="1" colspan="1">–</td>
                <td align="left" rowspan="1" colspan="1">
                  <italic toggle="yes">bool</italic>
                </td>
                <td align="left" rowspan="1" colspan="1">Determines whether the terminator is visible at the closest approach.</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">with_sunnyside</td>
                <td align="left" rowspan="1" colspan="1">–</td>
                <td align="left" rowspan="1" colspan="1">
                  <italic toggle="yes">bool</italic>
                </td>
                <td align="left" rowspan="1" colspan="1">Determines whether the spacecraft passes the SSSB on the Sun-facing side or the side facing away from the Sun.</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">relative_velocity</td>
                <td align="left" rowspan="1" colspan="1">m s<sup>-1</sup></td>
                <td align="left" rowspan="1" colspan="1">
                  <italic toggle="yes">float</italic>
                </td>
                <td align="left" rowspan="1" colspan="1">Relative velocity of the spacecraft to the SSSB at the encounter.</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">encounter_date</td>
                <td align="left" rowspan="1" colspan="1">–</td>
                <td align="left" rowspan="1" colspan="1">
                  <italic toggle="yes">dict</italic>
                </td>
                <td align="left" rowspan="1" colspan="1">Date of the closest approach of the spacecraft and SSSB. The type is a Python dictionary with an <italic toggle="yes">int</italic> for year, month, day, hour, minute, and <italic toggle="yes">float</italic> for second.</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">sssb_state</td>
                <td align="left" rowspan="1" colspan="1">m, m s<sup>-1</sup></td>
                <td align="left" rowspan="1" colspan="1">
                  <italic toggle="yes">tuple</italic>
                </td>
                <td align="left" rowspan="1" colspan="1">SSSB state vector containing three position and three velocity components at the encounter. The spacecraft encounter state is calculated relative to this state vector. The SSSB state is not required as input since it is calculated based on the SSSB trajectory and encounter date.</td>
              </tr>
            </tbody>
          </table>
        </alternatives>
      </table-wrap>
      <p>The propagation process is defined by the duration of a fly-by, the number of frames to be rendered, <italic toggle="yes">timesampler</italic> mode and a <italic toggle="yes">slowmotion</italic> factor as presented in <xref rid="pone.0263882.t002" ref-type="table">Table 2</xref>. The <italic toggle="yes">timesampler</italic> mode determines whether the steps are distributed linearly in time (mode 1, default) or whether an exponential model (mode 2) is used, which increases the number of frames around the encounter. The number of additional samples can be controlled with the <italic toggle="yes">slowmotion</italic> factor. Mode 2 is especially helpful when simulating a long fly-by, since, when the spacecraft is far from the SSSB nucleus, only minor changes are visible in rendered images.</p>
      <table-wrap position="float" id="pone.0263882.t002">
        <object-id pub-id-type="doi">10.1371/journal.pone.0263882.t002</object-id>
        <label>Table 2</label>
        <caption>
          <title>Input parameters that define the propagation step in SISPO.</title>
        </caption>
        <alternatives>
          <graphic xlink:href="pone.0263882.t002" id="pone.0263882.t002g" position="float"/>
          <table frame="box" rules="all" border="0">
            <colgroup span="1">
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <th align="left" rowspan="1" colspan="1">Parameter</th>
                <th align="left" rowspan="1" colspan="1">Unit</th>
                <th align="left" rowspan="1" colspan="1">Type</th>
                <th align="left" rowspan="1" colspan="1">Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="left" rowspan="1" colspan="1">duration</td>
                <td align="left" rowspan="1" colspan="1">s</td>
                <td align="left" rowspan="1" colspan="1">
                  <italic toggle="yes">float</italic>
                </td>
                <td align="left" rowspan="1" colspan="1">Total length of the simulation. The encounter date is reached after half of the duration.</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">frame</td>
                <td align="left" rowspan="1" colspan="1">–</td>
                <td align="left" rowspan="1" colspan="1">
                  <italic toggle="yes">int</italic>
                </td>
                <td align="left" rowspan="1" colspan="1">Number of frames (samples) taken during the encounter.</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">timesampler_mode</td>
                <td align="left" rowspan="1" colspan="1">–</td>
                <td align="left" rowspan="1" colspan="1">
                  <italic toggle="yes">int</italic>
                </td>
                <td align="left" rowspan="1" colspan="1">Mode 1 is linear and mode 2 is exponential sampling.</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">slowmotion_factor</td>
                <td align="left" rowspan="1" colspan="1">–</td>
                <td align="left" rowspan="1" colspan="1">
                  <italic toggle="yes">float</italic>
                </td>
                <td align="left" rowspan="1" colspan="1">Determines how many more state samples are taken around the encounter. Only applies if timesampler_mode is exponential.</td>
              </tr>
            </tbody>
          </table>
        </alternatives>
      </table-wrap>
    </sec>
    <sec id="sec011">
      <title>Attitude dynamics</title>
      <p>Along with the orbital simulation, a simplified attitude dynamics portion is already built into the Orekit framework, also accessible via the SISPO library. Attitude information in Orekit is handled essentially as another frame transformation. It contains the rotation from the reference frame to the satellite frame, and then the angular velocity (i.e., spin) and angular acceleration (i.e., rotation acceleration) of the spacecraft in its frame. This makes Orekit’s <italic toggle="yes">spacecraft_state</italic> a great construct to hold attitude-related and orbital data, which can then successfully be propagated in time. The Orekit library also allows SISPO to build user-defined “attitude law”. This attitude law can be selected from several pre-existing and common attitude modes (e.g., pointing, spin stabilised) or recompiled entirely in a way necessary for the mission simulation.</p>
      <p>It is, however, essential to note that the Orekit library mainly focuses on orbital mechanics and propagation. The attitude model, and any attitude laws it follows, presumes the existence of a “perfect attitude control system” without necessarily considering the physical limitations or perturbations of the satellite attitude by external forces. The Orekit library lacks the necessary constructs to convey and utilise the moments of inertia of the satellite. Since this information is crucial for the inclusion of external forces and their effect on the spacecraft’s attitude or other celestial bodies, this will be implemented as a secondary layer into the current framework; this is explained in Section: Discussion and future work.</p>
    </sec>
  </sec>
  <sec id="sec012">
    <title>Simulations of realistic asteroid imagery</title>
    <p>This section demonstrates five different use cases of the SISPO software.</p>
    <sec id="sec013">
      <title>Case 1: Asteroid 25143 Itokawa</title>
      <p><xref rid="pone.0263882.g006" ref-type="fig">Fig 6</xref> demonstrates the comparison between the image taken by the AMICA instrument of the Hayabusa spacecraft and rendered image using Cycles on the plain model using a simple diffuse shader. The main discrepancies in the rendering are due to the inaccuracy of the 3D model [<xref rid="pone.0263882.ref014" ref-type="bibr">14</xref>]. The higher error spots are caused mainly by the local variations of albedo and roughness. The biggest advantage of the procedural texturing, which introduces new surface features, is demonstrated in <xref rid="pone.0263882.g007" ref-type="fig">Fig 7</xref>. The fragmented zoomed view in <xref rid="pone.0263882.g008" ref-type="fig">Fig 8</xref> demonstrates how surface features are added procedurally and the level of details that can be achieved in comparison with the plain mesh.</p>
      <fig position="float" id="pone.0263882.g006">
        <object-id pub-id-type="doi">10.1371/journal.pone.0263882.g006</object-id>
        <label>Fig 6</label>
        <caption>
          <title>The pixel-by-pixel comparison of the original AMICA image on the left and generated Cycles image in the middle.</title>
          <p>The scale indicates percent error. The AMICA image is published under Public Domain 1.0.</p>
        </caption>
        <graphic xlink:href="pone.0263882.g006" position="float"/>
      </fig>
      <fig position="float" id="pone.0263882.g007">
        <object-id pub-id-type="doi">10.1371/journal.pone.0263882.g007</object-id>
        <label>Fig 7</label>
        <caption>
          <title>Surface mesh of asteroid 25143 Itokawa.</title>
          <p>Created by the AMICA imaging team [<xref rid="pone.0263882.ref014" ref-type="bibr">14</xref>] and rendered by authors in Blender Cycles. (A) plain mesh and (B) smooth mesh with procedural shader.</p>
        </caption>
        <graphic xlink:href="pone.0263882.g007" position="float"/>
      </fig>
      <fig position="float" id="pone.0263882.g008">
        <object-id pub-id-type="doi">10.1371/journal.pone.0263882.g008</object-id>
        <label>Fig 8</label>
        <caption>
          <title>Close view of the 25143 Itokawa surface.</title>
          <p>Zoomed-in region. (A) OpenGL render and (B) Cycles render.</p>
        </caption>
        <graphic xlink:href="pone.0263882.g008" position="float"/>
      </fig>
      <p><xref rid="pone.0263882.g007" ref-type="fig">Fig 7</xref> shows a comparison between a plain mesh of the asteroid 25143 Itokawa and a mesh recreation using the procedural shader in Blender. The initial mesh is a 3-D reconstruction of the actual asteroid as described in [<xref rid="pone.0263882.ref047" ref-type="bibr">47</xref>]. The shader then adds procedural surface features on top.</p>
      <p>A small area of the model mesh was rendered using OpenGL and Cycles to show the ultimate advantage of procedural texturing. Both renders are shown in <xref rid="pone.0263882.g008" ref-type="fig">Fig 8</xref>, and the one with procedural texturing indicates the capability to generate almost arbitrary level of detail. This feature would be required, for example, to train probes that can land on the surface.</p>
    </sec>
    <sec id="sec014">
      <title>Case 2: Volumetric particle effects</title>
      <p>Coma and dust jets are produced by particles emanating from the surface, and these are used to produce a volumetric density distribution. For the preliminary proof of concept, the jets were modelled using simplified versions of the gas and dust models from [<xref rid="pone.0263882.ref041" ref-type="bibr">41</xref>, <xref rid="pone.0263882.ref042" ref-type="bibr">42</xref>]. First, the gas source strengths and gas velocities are generated for each face of the mesh from the noise function. The gas source data are then used as input for the gas model [<xref rid="pone.0263882.ref041" ref-type="bibr">41</xref>], which computes the gas field densities and velocities around the comet. This data is then used in a particle simulation following [<xref rid="pone.0263882.ref042" ref-type="bibr">42</xref>] from which the particle position data is further processed into a three-dimensional number-density map around the comet, which is encoded to a single OpenEXR file [<xref rid="pone.0263882.ref048" ref-type="bibr">48</xref>]. Before the render, the number-density map is smoothed with tricubic interpolation [<xref rid="pone.0263882.ref049" ref-type="bibr">49</xref>]. It can then be loaded by Cycles and rendered using either volumetric scattering or emission (volumetric emission, although less accurate, is orders of magnitude faster).</p>
      <sec id="sec015">
        <title>Volumetric particle effects on the comet 67P/C–G</title>
        <p>In <xref rid="pone.0263882.g009" ref-type="fig">Fig 9</xref> (the coma might appear differently to the article’s viewer depending on the monitor or the print quality), the dust environment capabilities of SISPO are presented by simulating and rendering images of the comet 67P/C–G. This image is then compared to the actual image, and with an OpenGL rendered image. All the shader features (rocks, craters and sand flats) can be used simultaneously for complex SSSBs if needed. The masks that separate the “sand flats” from the rest of the surface features are created with procedural noise, but they could be painted by hand if necessary.</p>
        <fig position="float" id="pone.0263882.g009">
          <object-id pub-id-type="doi">10.1371/journal.pone.0263882.g009</object-id>
          <label>Fig 9</label>
          <caption>
            <title>Comet 67P/C-G with coma.</title>
            <p>(A) OpenGL, (B) Cycles and (C) Real image. The brightness was enhanced at the post-processing stage in order to better visualise coma.</p>
          </caption>
          <graphic xlink:href="pone.0263882.g009" position="float"/>
        </fig>
      </sec>
    </sec>
    <sec id="sec016">
      <title>Case 3: Larger bodies</title>
      <p>The reproduction of larger terrestrial bodies in SISPO is demonstrated in <xref rid="pone.0263882.g010" ref-type="fig">Fig 10</xref>, which is based on the narrow-angle-camera digital terrain model of the Apollo 15 landing site and operations area [<xref rid="pone.0263882.ref050" ref-type="bibr">50</xref>], obtained by Lunar Reconnaissance Orbiter Narrow Angle Camera (<ext-link xlink:href="http://wms.lroc.asu.edu/lroc/view_rdr_product/NAC_DTM_APOLLO15_M111571816_50CM" ext-link-type="uri">http://wms.lroc.asu.edu/lroc/view_rdr_product/NAC_DTM_APOLLO15_M111571816_50CM</ext-link>, accessed 28.01.2021). The original terrain model has a 2 m resolution for elevation maps and 0.5 m resolution for orthographic photos, which is not enough to produce images from the surface that would be useful for navigation testing. This case demonstrates the image scalability produced in SISPO. The lunar rendering was made by implementing a digital terrain model and procedural texturing over the whole 5.1 × 28.6 km<sup>2</sup> area; the farthest point visible on the render is roughly 11 km away from the camera.</p>
      <fig position="float" id="pone.0263882.g010">
        <object-id pub-id-type="doi">10.1371/journal.pone.0263882.g010</object-id>
        <label>Fig 10</label>
        <caption>
          <title>Application of procedural texturing on the scale of a larger airless body.</title>
          <p>(A) using a digital terrain model and applying orthographic photos as a texture. (B) using a digital terrain model and procedural terrain generation with Blender Cycles on the same digital terrain model. (C) image taken during the Apollo 15 mission from roughly the same location.</p>
        </caption>
        <graphic xlink:href="pone.0263882.g010" position="float"/>
      </fig>
    </sec>
    <sec id="sec017">
      <title>Case 4: Subsurface exploration</title>
      <p>Lava caves, the isolated underground environments, exist on Moon [<xref rid="pone.0263882.ref051" ref-type="bibr">51</xref>] and Mars [<xref rid="pone.0263882.ref052" ref-type="bibr">52</xref>]. These caves have been studied by remote sensing and have not been explored by dedicated missions, although some were proposed and developed, such as Moon Diver [<xref rid="pone.0263882.ref053" ref-type="bibr">53</xref>] and rock climber Lemur [<xref rid="pone.0263882.ref054" ref-type="bibr">54</xref>]. Lava tubes have been morphologically related to ones formed on Earth in volcanic rock by a volcanic eruption [<xref rid="pone.0263882.ref055" ref-type="bibr">55</xref>]. SISPO could be utilised for synthesising versatile sets of lava-caves images for (i) developing navigation algorithms and sampling spots detection by image processing (e.g., biological mats or their preserved remains on the geological substrate) or (ii) mapping the caves by photogrammetry for potential human settlements. An example of SISPO cave rendering is demonstrated in <xref rid="pone.0263882.g011" ref-type="fig">Fig 11</xref>.</p>
      <fig position="float" id="pone.0263882.g011">
        <object-id pub-id-type="doi">10.1371/journal.pone.0263882.g011</object-id>
        <label>Fig 11</label>
        <caption>
          <title>An example of a cave rendering.</title>
          <p>Colour, specularity and normal maps were applied. Colour maps are used from the walls of the Hillingdur and Blámi lava caves in Iceland obtained by Iakubivskyi. White spots indicate possible biological mats or secondary mineral precipitation; the red areas simulate iron oxide.</p>
        </caption>
        <graphic xlink:href="pone.0263882.g011" position="float"/>
      </fig>
    </sec>
    <sec id="sec018">
      <title>Case 5: Fly-by of a spacecraft</title>
      <p>The SISPO environment is suitable for spacecraft fly-by rendering. This can be useful for multi-spacecraft missions, in-orbit servicing and fleets. The Cycles rendering of the spacecraft fly-by is demonstrated in <xref rid="pone.0263882.g012" ref-type="fig">Fig 12</xref>. The model uses a <italic toggle="yes">principled bidirectional scattering distribution function</italic> shader including multiple layers to create spacecraft materials. The set of produced images can be used for developing and training formation-flying proximity algorithms demanded by attitude control and orbit determination subsystem.</p>
      <fig position="float" id="pone.0263882.g012">
        <object-id pub-id-type="doi">10.1371/journal.pone.0263882.g012</object-id>
        <label>Fig 12</label>
        <caption>
          <title>Rendering of a spacecraft fly-by.</title>
        </caption>
        <graphic xlink:href="pone.0263882.g012" position="float"/>
      </fig>
    </sec>
  </sec>
  <sec id="sec019">
    <title>Usability of images produced for 3D reconstruction</title>
    <p>A set of synthetically generated images can be used for photogrammetry-based 3-D surface reconstruction within the SISPO environment. The steps executed in the reconstruction pipeline are described in [<xref rid="pone.0263882.ref016" ref-type="bibr">16</xref>]. The reconstruction uses two libraries:</p>
    <list list-type="order">
      <list-item>
        <p>Open Multiple View Geometry (OpenMVG) C++ library [<xref rid="pone.0263882.ref056" ref-type="bibr">56</xref>], which creates a sparse point cloud based on two different SfM techniques:
<list list-type="alpha-lower"><list-item><p>Global SfM [<xref rid="pone.0263882.ref057" ref-type="bibr">57</xref>].</p></list-item><list-item><p>Incremental SfM [<xref rid="pone.0263882.ref058" ref-type="bibr">58</xref>], which is much more suitable for SISPO applications [<xref rid="pone.0263882.ref016" ref-type="bibr">16</xref>].</p></list-item></list></p>
      </list-item>
      <list-item>
        <p>Open Multiple View Stereo Reconstruction (OpenMVS), which uses input from OpenMVG, creates a dense point cloud, a faceted surface (mesh) or a set of planes [<xref rid="pone.0263882.ref059" ref-type="bibr">59</xref>].</p>
      </list-item>
    </list>
    <sec id="sec020">
      <title>Case 1: SSSB fly-by</title>
      <p>A set of 25 images was generated in SISPO and then used to reconstruct the 3-D model using the pipeline. The images were generated using a pinhole camera (i.e., no optical aberrations, which would decrease the reconstructed accuracy; however, they can be implemented as discussed in Subsection: Camera). The two furthest points and the closest approach are shown in <xref rid="pone.0263882.g013" ref-type="fig">Fig 13</xref>.</p>
      <fig position="float" id="pone.0263882.g013">
        <object-id pub-id-type="doi">10.1371/journal.pone.0263882.g013</object-id>
        <label>Fig 13</label>
        <caption>
          <title>Three out of 25 frames used for the reconstruction.</title>
          <p>Images rendered in SISPO. Furthest approaching frame, closest approach and furthest leaving frame.</p>
        </caption>
        <graphic xlink:href="pone.0263882.g013" position="float"/>
      </fig>
      <p>The result of reconstruction is shown in <xref rid="pone.0263882.g014" ref-type="fig">Fig 14</xref>, which visualises vertices and the triangular mesh via the inclusion of normals and applied texture in the reconstructed model.</p>
      <fig position="float" id="pone.0263882.g014">
        <object-id pub-id-type="doi">10.1371/journal.pone.0263882.g014</object-id>
        <label>Fig 14</label>
        <caption>
          <title>Final reconstruction of the visible part of the target without post-production.</title>
          <p>(A) Synthetically generated image (input). (B) Vertices of reconstruction. (C) Mesh with normals. (D) Triangular mesh with texture.</p>
        </caption>
        <graphic xlink:href="pone.0263882.g014" position="float"/>
      </fig>
      <p>As a result, two 3-D models are obtained: the input model for SISPO and the reconstructed model from images. Only the visible part of the comet was obtained because of the nature of the fly-by (i.e., during the fly-by only one illuminated part of the target is visible). The reconstructed model was compared with the input 3-D model externally using the <italic toggle="yes">CloudCompare</italic> software [<xref rid="pone.0263882.ref060" ref-type="bibr">60</xref>]. Generally, the reconstructed model is close to the input model, except for the edges (e.g., the black area in <xref rid="pone.0263882.g015" ref-type="fig">Fig 15</xref>), where the error deviation was very high (up to 600 m). These highly deviated parts could be removed in the point cloud or mesh post-processing, but have not been done in this analysis. The Gaussian distribution mean error is 14.7 m and the standard deviation is 63.9 m. The visualisation of deviation and the error analysis are shown in <xref rid="pone.0263882.g015" ref-type="fig">Fig 15</xref>.</p>
      <fig position="float" id="pone.0263882.g015">
        <object-id pub-id-type="doi">10.1371/journal.pone.0263882.g015</object-id>
        <label>Fig 15</label>
        <caption>
          <title>Deviation analysis of the reconstructed partial mesh and input 3-D model for image synthesis.</title>
          <p>Visualisation of deviation (left); errors and Gaussian distribution (right).</p>
        </caption>
        <graphic xlink:href="pone.0263882.g015" position="float"/>
      </fig>
    </sec>
    <sec id="sec021">
      <title>Case 2: SSSB orbiting</title>
      <p>During SSSB orbiting, it is possible to observe every side of the target because as the target spins, each part will be illuminated at a certain point. Three different input-image views (out of 53 used in total) and a fully reconstructed 3-D model are shown in <xref rid="pone.0263882.g016" ref-type="fig">Fig 16</xref>. Fifty-three images were generated from different angles using a pinhole camera.</p>
      <fig position="float" id="pone.0263882.g016">
        <object-id pub-id-type="doi">10.1371/journal.pone.0263882.g016</object-id>
        <label>Fig 16</label>
        <caption>
          <title>Full reconstruction of the comet during orbiting.</title>
          <p>The first column shows actual synthetic images, the second column is the textured view of the 3-D reconstruction, and the third column shows the meshed view of the reconstruction.</p>
        </caption>
        <graphic xlink:href="pone.0263882.g016" position="float"/>
      </fig>
      <p>The input and reconstructed 3-D model were compared using the same method as in the fly-by case. Because of the larger set of observational angles, the deviation is decreased in the orbiting case and reaches 60–89.7 m at some crater spots, but most of the surface is aligned with the input model as shown in <xref rid="pone.0263882.g017" ref-type="fig">Fig 17</xref>. The Gaussian mean error distribution is 1.2 m and the standard deviation is 6.6 m. The accuracy can be increased by using a more significant set of images and higher resolution.</p>
      <fig position="float" id="pone.0263882.g017">
        <object-id pub-id-type="doi">10.1371/journal.pone.0263882.g017</object-id>
        <label>Fig 17</label>
        <caption>
          <title>Deviation analysis of the entire reconstructed mesh and input 3-D model for image synthesis.</title>
          <p>Visualisation of deviation (left); errors and Gaussian distribution (right).</p>
        </caption>
        <graphic xlink:href="pone.0263882.g017" position="float"/>
      </fig>
    </sec>
  </sec>
  <sec id="sec022">
    <title>Discussion and future work</title>
    <p>SISPO is a sophisticated tool for terrestrial-cosmic-scenery rendering. Its most significant advantage is the physically based, high-quality, realistic renderings, which can reproduce submillimeter surface resolution and beyond for SSSBs and other terrestrial bodies thanks to micropolygon procedural texturing and Blender’s Cycles path-tracing rendering engine. The produced renderings are mature for deep-space mission design and algorithm development for semi-autonomous operations, visual navigation, localisation and image processing. There are a few more functions that are considered for future implementation:</p>
    <list list-type="bullet">
      <list-item>
        <p>Attitude dynamics auxiliary package (see below);</p>
      </list-item>
      <list-item>
        <p>Image compression algorithms for efficient data storage and transmission evaluation, which was preliminarily assessed by [<xref rid="pone.0263882.ref061" ref-type="bibr">61</xref>];</p>
      </list-item>
      <list-item>
        <p>Reconstruction of various scenery;</p>
      </list-item>
      <list-item>
        <p>Algorithms for spacecraft photogrammetry-based localisation;</p>
      </list-item>
      <list-item>
        <p>Capability to simulate measurements of the target spectral reflectance in certain wavelength channels;</p>
      </list-item>
      <list-item>
        <p>Improved shader and user-defined parameterisation of Cycles in order to minimise the approximation;</p>
      </list-item>
      <list-item>
        <p>Solar System ephemeris integration for historical and upcoming events. This can include both terrestrial bodies and spacecraft via the possible adaptation of Spacecraft Planet Instrument Camera-matrix Events (SPICE) data.</p>
      </list-item>
    </list>
    <sec id="sec023">
      <title>Attitude dynamics auxiliary package</title>
      <p>The SISPO simulation environment will include optional packages for calculating the effects of external forces such as dust particle impacts, atmospheric drag, gravity gradient and various other effects necessary to account for. Each of these functionalities will be built as an add-on to the current Orekit-based attitude framework. This is done by adding an optional extra calculation step between the propagations of the spacecraft state through time by Orekit to account for the perturbations. With the addition of the second layer on top of Orekit orbital simulations, for accurately simulating the attitude dynamics of the spacecraft or a celestial body, the SISPO environment will have the necessary groundwork for later expansions into different active and passive attitude control systems present in any future mission simulations.</p>
    </sec>
    <sec id="sec024">
      <title>GitHub algorithm repository</title>
      <p>The open-source algorithm is stored in the public GitHub repository (<ext-link xlink:href="https://github.com/SISPO-developers" ext-link-type="uri">https://github.com/SISPO-developers</ext-link>), and everyone is welcome to use and modify it. The algorithm is updated, and new functionalities are managed and added by authors. The instruction and comments can also be found in the repository. It contains following subrepositories: main SISPO (<ext-link xlink:href="https://github.com/SISPO-developers/sispo" ext-link-type="uri">https://github.com/SISPO-developers/sispo</ext-link>), dust and gas environment generator for SSSBs (<ext-link xlink:href="https://github.com/SISPO-developers/ComaCreator" ext-link-type="uri">https://github.com/SISPO-developers/ComaCreator</ext-link>), comatic aberration and astigmatism simulator (<ext-link xlink:href="https://github.com/SISPO-developers/OASIS" ext-link-type="uri">https://github.com/SISPO-developers/OASIS</ext-link>) and docker image (<ext-link xlink:href="https://github.com/SISPO-developers/sispo_docker" ext-link-type="uri">https://github.com/SISPO-developers/sispo_docker</ext-link>) for fast SISPO deployment. Additional information about the algorithm can be found in [<xref rid="pone.0263882.ref044" ref-type="bibr">44</xref>, <xref rid="pone.0263882.ref061" ref-type="bibr">61</xref>].</p>
    </sec>
  </sec>
  <sec sec-type="conclusions" id="sec025">
    <title>Conclusions</title>
    <p>In this paper, the Space Imaging Simulator for Proximity Operations (SISPO) architecture and capabilities were described and several features demonstrated by case simulations. The tool generates physically based, photorealistic images from an input 3-D model using Blender’s Cycles path-tracing rendering engine. For regolith surface reconstruction it uses procedural texturing. SISPO has supplementary models for optical aberrations as well as for gas and dust of small bodies. The description and usage of these models were discussed in this paper. Other use cases have demonstrated renderings of the Moon and a spacecraft. The set of produced images can be implemented for 3-D surface reconstruction. The tool is open access and currently requires basic programming skills to be used [<xref rid="pone.0263882.ref033" ref-type="bibr">33</xref>]. The level of detail currently produced by SISPO is suitable for the design of advanced deep-space missions, the simulation of large sets of scenarios, and the development and validation of algorithms for (semi-)autonomous operations, vision-based navigation, localisation and image processing. SISPO has already supported the development of deep-space mission concepts and is currently being used for the ESA–JAXA Comet Interceptor mission (more details in Section: Application to space mission designs).</p>
    <p>Some further improvements have been considered and are listed in Section: Discussion and future work. Other teams are welcome to use SISPO, implement new functions and contact the authors of this paper.</p>
  </sec>
  <sec id="sec026" sec-type="supplementary-material">
    <title>Supporting information</title>
    <supplementary-material id="pone.0263882.s001" position="float" content-type="local-data">
      <label>S1 Script</label>
      <caption>
        <title>Image comparison.</title>
        <p>The file contains python algorithm used to compare images in this manuscript.</p>
        <p>(ZIP)</p>
      </caption>
      <media xlink:href="pone.0263882.s001.zip">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <p>We thank Mattias Malmer for allowing us to use his shape model of the comet 67P/Churyumov–Gerasimenko. Thanks to Hayabusa’s AMICA imaging team for publishing the shape model of 25143 Itokawa. We would like to express our gratitude to Airbus Defence and Space for developing and providing the SurRender software; to Jérémy Lebreton and Christine Pelsener-Scamaroni in particular for providing and accommodating changes to the licence agreement. Thanks to the University of Dundee and Martin Dunstan for developing and providing PANGU software and helping to set it up. A special mention goes to the Blender community, thanks to whom the open-source software exists and improves. Thanks to Tomas Kohout (University of Helsinki) for helping to arrange Timo Väisänen’s civilian service (a.k.a. semi postdoc) at Aalto University.</p>
  </ack>
  <glossary>
    <title>Abbreviations</title>
    <def-list>
      <def-item>
        <term>
3-D
</term>
        <def>
          <p>three-dimensional</p>
        </def>
      </def-item>
      <def-item>
        <term>
BRDF
</term>
        <def>
          <p>Bidirectional Reflectance Distribution Function</p>
        </def>
      </def-item>
      <def-item>
        <term>
ESA
</term>
        <def>
          <p>European Space Agency</p>
        </def>
      </def-item>
      <def-item>
        <term>
JAXA
</term>
        <def>
          <p>Japan Aerospace Exploration Agency</p>
        </def>
      </def-item>
      <def-item>
        <term>
MAT
</term>
        <def>
          <p>Multi-Asteroid Touring</p>
        </def>
      </def-item>
      <def-item>
        <term>
OASIS
</term>
        <def>
          <p>Optical Aberrations for Still Images Simulator</p>
        </def>
      </def-item>
      <def-item>
        <term>
OpenGL
</term>
        <def>
          <p>Open Graphics Library</p>
        </def>
      </def-item>
      <def-item>
        <term>
OpenMVG
</term>
        <def>
          <p>Open Multiple View Geometry</p>
        </def>
      </def-item>
      <def-item>
        <term>
OpenMVS
</term>
        <def>
          <p>Open Multiple View Stereo Reconstruction</p>
        </def>
      </def-item>
      <def-item>
        <term>
OPIC
</term>
        <def>
          <p>Optical Periscopic Imager for Comets</p>
        </def>
      </def-item>
      <def-item>
        <term>
PANGU
</term>
        <def>
          <p>Planet and Asteroid Natural Scene Generation Utility</p>
        </def>
      </def-item>
      <def-item>
        <term>
PSF
</term>
        <def>
          <p>Point Spread Function</p>
        </def>
      </def-item>
      <def-item>
        <term>
RGB
</term>
        <def>
          <p>Red, Green and Blue</p>
        </def>
      </def-item>
      <def-item>
        <term>
SfM
</term>
        <def>
          <p>Structure from Motion</p>
        </def>
      </def-item>
      <def-item>
        <term>
SISPO
</term>
        <def>
          <p>Space Imaging Simulator for Proximity Operations</p>
        </def>
      </def-item>
      <def-item>
        <term>
SPICE
</term>
        <def>
          <p>Spacecraft Planet Instrument Camera-matrix Events</p>
        </def>
      </def-item>
      <def-item>
        <term>
SSSB
</term>
        <def>
          <p>Small Solar System Body</p>
        </def>
      </def-item>
    </def-list>
  </glossary>
  <ref-list>
    <title>References</title>
    <ref id="pone.0263882.ref001">
      <label>1</label>
      <mixed-citation publication-type="journal"><name><surname>Fitzsimmons</surname><given-names>A</given-names></name>, <name><surname>Snodgrass</surname><given-names>C</given-names></name>, <name><surname>Rozitis</surname><given-names>B</given-names></name>, <name><surname>Yang</surname><given-names>B</given-names></name>, <name><surname>Hyland</surname><given-names>M</given-names></name>, <name><surname>Seccull</surname><given-names>T</given-names></name>, <etal>et al</etal>. <article-title>Spectroscopy and thermal modelling of the first interstellar object 1I/2017 U1 ‘Oumuamua</article-title>. <source>Nature Astronomy</source>. <year>2018</year>;<volume>2</volume>(<issue>2</issue>):<fpage>133</fpage>–<lpage>137</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/s41550-017-0361-4</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0263882.ref002">
      <label>2</label>
      <mixed-citation publication-type="journal"><name><surname>Fitzsimmons</surname><given-names>A</given-names></name>, <name><surname>Hainaut</surname><given-names>O</given-names></name>, <name><surname>Meech</surname><given-names>KJ</given-names></name>, <name><surname>Jehin</surname><given-names>E</given-names></name>, <name><surname>Moulane</surname><given-names>Y</given-names></name>, <name><surname>Opitom</surname><given-names>C</given-names></name>, <etal>et al</etal>. <article-title>Detection of CN Gas in Interstellar Object 2I/Borisov</article-title>. <source>The Astrophysical Journal</source>. <year>2019</year>;<volume>885</volume>(<issue>1</issue>):<fpage>L9</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.3847/2041-8213/ab49fc</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0263882.ref003">
      <label>3</label>
      <mixed-citation publication-type="other">Brochard R, Lebreton J, Robin C, Kanani K, Jonniaux G, Masson A, et al. Scientific image rendering for space scenes with the SurRender software. In: 69<sup>th</sup> International Astronautical Congress (IAC). Bremen, Germany: IAF; 2018. p. 1–11. Available from: <ext-link xlink:href="https://arxiv.org/abs/1810.01423" ext-link-type="uri">https://arxiv.org/abs/1810.01423</ext-link>.</mixed-citation>
    </ref>
    <ref id="pone.0263882.ref004">
      <label>4</label>
      <mixed-citation publication-type="other">Lambert JH. Photometria sive de mensura et gradibus luminis, colorum et umbrae. Klett; 1760. Available from: <ext-link xlink:href="https://archive.org/details/bub_gb_zmpJAAAAYAAJ" ext-link-type="uri">https://archive.org/details/bub_gb_zmpJAAAAYAAJ</ext-link>.</mixed-citation>
    </ref>
    <ref id="pone.0263882.ref005">
      <label>5</label>
      <mixed-citation publication-type="journal"><name><surname>Hapke</surname><given-names>B</given-names></name>. <article-title>Bidirectional reflectance spectroscopy: 1. Theory</article-title>. <source>Journal of Geophysical Research: Solid Earth</source>. <year>1981</year>;<volume>86</volume>(<issue>B4</issue>):<fpage>3039</fpage>–<lpage>3054</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1029/JB086iB04p03055</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0263882.ref006">
      <label>6</label>
      <mixed-citation publication-type="journal"><name><surname>Hapke</surname><given-names>B</given-names></name>. <article-title>Bidirectional reflectance spectroscopy: 3. Correction for macroscopic roughness</article-title>. <source>Icarus</source>. <year>1984</year>;<volume>59</volume>(<issue>1</issue>):<fpage>41</fpage>—<lpage>59</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1016/0019-1035(84)90054-X</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0263882.ref007">
      <label>7</label>
      <mixed-citation publication-type="journal"><name><surname>Hapke</surname><given-names>B</given-names></name>. <article-title>Bidirectional Reflectance Spectroscopy: 5. The Coherent Backscatter Opposition Effect and Anisotropic Scattering</article-title>. <source>Icarus</source>. <year>2002</year>;<volume>157</volume>(<issue>2</issue>):<fpage>523</fpage>—<lpage>534</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1006/icar.2002.6853</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0263882.ref008">
      <label>8</label>
      <mixed-citation publication-type="journal"><name><surname>Oren</surname><given-names>M</given-names></name>, <name><surname>Nayar</surname><given-names>SK</given-names></name>. <article-title>Generalization of the Lambertian model and implications for machine vision</article-title>. <source>International Journal of Computer Vision</source>. <year>1995</year>;<volume>14</volume>(<issue>3</issue>):<fpage>227</fpage>–<lpage>251</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1007/BF01679684</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0263882.ref009">
      <label>9</label>
      <mixed-citation publication-type="other">Martin I, Dunstan M, Gestido MS. Planetary Surface Image Generation for Testing Future Space Missions with PANGU. In: 2<sup>nd</sup> RPI Space Imaging Workshop. Saratoga Springs, NY, USA; 2019. p. 1–13. Available from: <ext-link xlink:href="https://pangu.software/wp-content/pangu_uploads/pdfs/SpaceImagingWorkshop_2019_paper_pangu_final.pdf" ext-link-type="uri">https://pangu.software/wp-content/pangu_uploads/pdfs/SpaceImagingWorkshop_2019_paper_pangu_final.pdf</ext-link>.</mixed-citation>
    </ref>
    <ref id="pone.0263882.ref010">
      <label>10</label>
      <mixed-citation publication-type="journal"><name><surname>Acton</surname><given-names>C</given-names></name>, <name><surname>Bachman</surname><given-names>N</given-names></name>, <name><surname>Semenov</surname><given-names>B</given-names></name>, <name><surname>Wright</surname><given-names>E</given-names></name>. <article-title>SPICE TOOLS SUPPORTING PLANETARY REMOTE SENSING</article-title>. <source>International Archives of the Photogrammetry, Remote Sensing and Spatial Information Sciences</source>. <year>2016</year>;<volume>XLI-B4</volume>:<fpage>357</fpage>–<lpage>359</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.5194/isprs-archives-XLI-B4-357-2016</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0263882.ref011">
      <label>11</label>
      <mixed-citation publication-type="other">Semenov B. WebGeocalc and Cosmographia: Modern Tools to Access OPS SPICE data. In: 2018 SpaceOps Conference. Marseille, France; 2018. p. 2366. Available from: <pub-id pub-id-type="doi">10.2514/6.2018-2366</pub-id>.</mixed-citation>
    </ref>
    <ref id="pone.0263882.ref012">
      <label>12</label>
      <mixed-citation publication-type="other">Garreta Piñol B. Study: Visualization of spacecraft trajectories with NASA SPICE and Blender [B.S. thesis]. Universitat Politècnica de Catalunya; 2020. Available from: <ext-link xlink:href="https://upcommons.upc.edu/handle/2117/330122" ext-link-type="uri">https://upcommons.upc.edu/handle/2117/330122</ext-link>.</mixed-citation>
    </ref>
    <ref id="pone.0263882.ref013">
      <label>13</label>
      <mixed-citation publication-type="other">Aiazzi C, Quadrelli MB, Gaut A, Jain A. Physics-based rendering of irregular planetary bodies. In: The International Symposium on Artificial Intelligence, Robotics and Automation in Space (i-SAIRAS). Virtual: LPI contribution No.2358; 2020.Available from: <ext-link xlink:href="https://www.hou.usra.edu/meetings/isairas2020fullpapers/pdf/4009.pdf" ext-link-type="uri">https://www.hou.usra.edu/meetings/isairas2020fullpapers/pdf/4009.pdf</ext-link>.</mixed-citation>
    </ref>
    <ref id="pone.0263882.ref014">
      <label>14</label>
      <mixed-citation publication-type="other">AMICA imaging team. Shape models of 25143 Itokawa, the target of the HAYABUSA mission; 2007. Available from: <ext-link xlink:href="https://darts.isas.jaxa.jp/planet/project/hayabusa/shape.pl" ext-link-type="uri">https://darts.isas.jaxa.jp/planet/project/hayabusa/shape.pl</ext-link>.</mixed-citation>
    </ref>
    <ref id="pone.0263882.ref015">
      <label>15</label>
      <mixed-citation publication-type="other">Blender Online Community. Blender—a 3D modelling and rendering package; 2020. Available from: <ext-link xlink:href="http://www.blender.org" ext-link-type="uri">http://www.blender.org</ext-link>.</mixed-citation>
    </ref>
    <ref id="pone.0263882.ref016">
      <label>16</label>
      <mixed-citation publication-type="other">Pajusalu M, Slavinskis A. Characterization of Asteroids Using Nanospacecraft Flybys and Simultaneous Localization and Mapping. In: 2019 IEEE Aerospace Conference; 2019. p. 1–9. Available from: <pub-id pub-id-type="doi">10.1109/AERO.2019.8741921</pub-id>.</mixed-citation>
    </ref>
    <ref id="pone.0263882.ref017">
      <label>17</label>
      <mixed-citation publication-type="journal"><name><surname>Kohout</surname><given-names>T</given-names></name>, <name><surname>Näsilä</surname><given-names>A</given-names></name>, <name><surname>Tikka</surname><given-names>T</given-names></name>, <name><surname>Granvik</surname><given-names>M</given-names></name>, <name><surname>Kestilä</surname><given-names>A</given-names></name>, <name><surname>Penttilä</surname><given-names>A</given-names></name>, <etal>et al</etal>. <article-title>Feasibility of asteroid exploration using CubeSats—ASPECT case study</article-title>. <source>Advances in Space Research</source>. <year>2018</year>;<volume>62</volume>(<issue>8</issue>):<fpage>2239</fpage>—<lpage>2244</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1016/j.asr.2017.07.036</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0263882.ref018">
      <label>18</label>
      <mixed-citation publication-type="journal"><name><surname>Walker</surname><given-names>R</given-names></name>, <name><surname>Binns</surname><given-names>D</given-names></name>, <name><surname>Bramanti</surname><given-names>C</given-names></name>, <name><surname>Casasco</surname><given-names>M</given-names></name>, <name><surname>Concari</surname><given-names>P</given-names></name>, <name><surname>Izzo</surname><given-names>D</given-names></name>, <etal>et al</etal>. <article-title>Deep-space CubeSats: thinking inside the box</article-title>. <source>Astronomy &amp; Geophysics</source>. <year>2018</year>;<volume>59</volume>:<fpage>24</fpage>–<lpage>30</lpage>.</mixed-citation>
    </ref>
    <ref id="pone.0263882.ref019">
      <label>19</label>
      <mixed-citation publication-type="journal"><name><surname>Bowles</surname><given-names>NE</given-names></name>, <name><surname>Snodgrass</surname><given-names>C</given-names></name>, <name><surname>Gibbings</surname><given-names>A</given-names></name>, <name><surname>Sanchez</surname><given-names>JP</given-names></name>, <name><surname>Arnold</surname><given-names>JA</given-names></name>, <name><surname>Eccleston</surname><given-names>P</given-names></name>, <etal>et al</etal>. <article-title>CASTAway: An asteroid main belt tour and survey</article-title>. <source>Advances in Space Research</source>. <year>2018</year>;<volume>62</volume>(<issue>8</issue>):<fpage>1998</fpage>—<lpage>2025</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1016/j.asr.2017.10.021</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0263882.ref020">
      <label>20</label>
      <mixed-citation publication-type="journal"><name><surname>Snodgrass</surname><given-names>C</given-names></name>, <name><surname>Jones</surname><given-names>GH</given-names></name>, <name><surname>Boehnhardt</surname><given-names>H</given-names></name>, <name><surname>Gibbings</surname><given-names>A</given-names></name>, <name><surname>Homeister</surname><given-names>M</given-names></name>, <name><surname>Andre</surname><given-names>N</given-names></name>, <etal>et al</etal>. <article-title>The Castalia mission to Main Belt Comet 133P/Elst-Pizarro</article-title>. <source>Advances in Space Research</source>. <year>2018</year>;<volume>62</volume>(<issue>8</issue>):<fpage>1947</fpage>—<lpage>1976</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1016/j.asr.2017.09.011</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0263882.ref021">
      <label>21</label>
      <mixed-citation publication-type="journal"><name><surname>Jones</surname><given-names>GH</given-names></name>, <name><surname>Agarwal</surname><given-names>J</given-names></name>, <name><surname>Bowles</surname><given-names>N</given-names></name>, <name><surname>Burchell</surname><given-names>M</given-names></name>, <name><surname>Coates</surname><given-names>AJ</given-names></name>, <name><surname>Fitzsimmons</surname><given-names>A</given-names></name>, <etal>et al</etal>. <article-title>The proposed Caroline ESA M3 mission to a Main Belt Comet</article-title>. <source>Advances in Space Research</source>. <year>2018</year>;<volume>62</volume>(<issue>8</issue>):<fpage>1921</fpage>—<lpage>1946</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1016/j.asr.2018.02.032</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0263882.ref022">
      <label>22</label>
      <mixed-citation publication-type="journal"><name><surname>Probst</surname><given-names>A</given-names></name>, <name><surname>Förstner</surname><given-names>R</given-names></name>. <article-title>Spacecraft design of a multiple asteroid orbiter with re-docking lander</article-title>. <source>Advances in Space Research</source>. <year>2018</year>;<volume>62</volume>(<issue>8</issue>):<fpage>2125</fpage>—<lpage>2140</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1016/j.asr.2017.07.041</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0263882.ref023">
      <label>23</label>
      <mixed-citation publication-type="journal"><name><surname>Oberst</surname><given-names>J</given-names></name>, <name><surname>Wickhusen</surname><given-names>K</given-names></name>, <name><surname>Willner</surname><given-names>K</given-names></name>, <name><surname>Gwinner</surname><given-names>K</given-names></name>, <name><surname>Spiridonova</surname><given-names>S</given-names></name>, <name><surname>Kahle</surname><given-names>R</given-names></name>, <etal>et al</etal>. <article-title>DePhine—The Deimos and Phobos Interior Explorer</article-title>. <source>Advances in Space Research</source>. <year>2018</year>;<volume>62</volume>(<issue>8</issue>):<fpage>2220</fpage>—<lpage>2238</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1016/j.asr.2017.12.028</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0263882.ref024">
      <label>24</label>
      <mixed-citation publication-type="journal"><name><surname>Ferri</surname><given-names>A</given-names></name>, <name><surname>Pelle</surname><given-names>S</given-names></name>, <name><surname>Belluco</surname><given-names>M</given-names></name>, <name><surname>Voirin</surname><given-names>T</given-names></name>, <name><surname>Gelmi</surname><given-names>R</given-names></name>. <article-title>The exploration of PHOBOS: Design of a Sample Return mission</article-title>. <source>Advances in Space Research</source>. <year>2018</year>;<volume>62</volume>(<issue>8</issue>):<fpage>2163</fpage>—<lpage>2173</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1016/j.asr.2018.06.014</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0263882.ref025">
      <label>25</label>
      <mixed-citation publication-type="other">Slavinskis A, Janhunen P, Toivanen P, Muinonen K, Penttilä A, Granvik M, et al. Nanospacecraft fleet for multi-asteroid touring with electric solar wind sails. In: 2018 IEEE Aerospace Conference. IEEE; 2018. p. 1–20. Available from: <pub-id pub-id-type="doi">10.1109/AERO.2018.8396670</pub-id>.</mixed-citation>
    </ref>
    <ref id="pone.0263882.ref026">
      <label>26</label>
      <mixed-citation publication-type="other">Iakubivskyi I, Mačiulis L, Janhunen P, Dalbins J, Noorma M, Slavinskis A. Aspects of Nanospacecraft Design for Main-Belt Sailing Voyage. Advances in Space Research (in press). 2020;.</mixed-citation>
    </ref>
    <ref id="pone.0263882.ref027">
      <label>27</label>
      <mixed-citation publication-type="other">ESA. Announcement of opportunity for new science ideas in ESA’s science programme, viewed 08 April 2020; open call 2016. <ext-link xlink:href="https://www.cosmos.esa.int/web/new-scientific-ideas" ext-link-type="uri">https://www.cosmos.esa.int/web/new-scientific-ideas</ext-link>.</mixed-citation>
    </ref>
    <ref id="pone.0263882.ref028">
      <label>28</label>
      <mixed-citation publication-type="other">ESA. CDF–178(C) study report: Small Planetary Platforms (SPP) in NEO and MAB (study manager: Bayon, S.), pp. 81–100, viewed 08 April 2020. European Space Agency; technical report 2018. Available from: <ext-link xlink:href="https://sci.esa.int/web/future-missions-department/-/60411-cdf-study-report-small-planetary-platforms-spp" ext-link-type="uri">https://sci.esa.int/web/future-missions-department/-/60411-cdf-study-report-small-planetary-platforms-spp</ext-link>.</mixed-citation>
    </ref>
    <ref id="pone.0263882.ref029">
      <label>29</label>
      <mixed-citation publication-type="other">Pajusalu M, Kivastik J, Iakubivskyi I, Slavinskis A. Developing autonomous image capturing systems for maximum science yield for high fly-by velocity small solar system body exploration. In: 71<sup>st</sup> International Astronautical Congress, IAC-20-A3.4B.4. Cyber Space: IAF; 2020. p. 1–8. Available from: <ext-link xlink:href="https://dl.iafastro.directory/event/IAC-2020/paper/61048/" ext-link-type="uri">https://dl.iafastro.directory/event/IAC-2020/paper/61048/</ext-link>.</mixed-citation>
    </ref>
    <ref id="pone.0263882.ref030">
      <label>30</label>
      <mixed-citation publication-type="journal"><name><surname>Snodgrass</surname><given-names>C</given-names></name>, <name><surname>Jones</surname><given-names>GH</given-names></name>. <article-title>The European Space Agency’s Comet Interceptor lies in wait</article-title>. <source>Nature communications</source>. <year>2019</year>;<volume>10</volume>(<issue>1</issue>):<fpage>1</fpage>–<lpage>4</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/s41467-019-13470-1</pub-id><?supplied-pmid 31780664?><pub-id pub-id-type="pmid">31780664</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0263882.ref031">
      <label>31</label>
      <mixed-citation publication-type="other">Pernechele C, Deppo VD, Brydon G, Jones GH, Lara L, Michaelis H. Comet interceptor’s EnVisS camera sky mapping function. In: Ellis SC, d’Orgeville C, editors. Advances in Optical Astronomical Instrumentation 2019. vol. 11203. International Society for Optics and Photonics. SPIE; 2020. p. 115—118. Available from: <pub-id pub-id-type="doi">10.1117/12.2539239</pub-id>.</mixed-citation>
    </ref>
    <ref id="pone.0263882.ref032">
      <label>32</label>
      <mixed-citation publication-type="other">Maisonobe L, Pommier V, Parraud P. Orekit: An open source library for operational flight dynamics applications. In: 4th International Conference on Astrodynamics Tools and Techniques. ESAC, Madrid, Spain; 2010.</mixed-citation>
    </ref>
    <ref id="pone.0263882.ref033">
      <label>33</label>
      <mixed-citation publication-type="other">Schwarzkopf GJ, Pajusalu M. Space Imaging Simulator for Proximity Operations; 2020. Available from: <pub-id pub-id-type="doi">10.5281/zenodo.3661054</pub-id>.</mixed-citation>
    </ref>
    <ref id="pone.0263882.ref034">
      <label>34</label>
      <mixed-citation publication-type="journal"><name><surname>Whitted</surname><given-names>T</given-names></name>. <article-title>An Improved Illumination Model for Shaded Display</article-title>. <source>Communications of the ACM</source>. <year>1980</year>;<volume>23</volume>(<issue>6</issue>):<fpage>343</fpage>–<lpage>349</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1145/358876.358882</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0263882.ref035">
      <label>35</label>
      <mixed-citation publication-type="book"><name><surname>Flavell</surname><given-names>L</given-names></name>. <part-title>Chapter 4: Lighting and Procedural Textures</part-title>. In: <source>Beginning Blender: Open Source 3D Modeling, Animation, and Game Design</source>. <publisher-loc>New York</publisher-loc>: <publisher-name>Apress</publisher-name>; <year>2011</year>. p. <fpage>69</fpage>–<lpage>96</lpage>.</mixed-citation>
    </ref>
    <ref id="pone.0263882.ref036">
      <label>36</label>
      <mixed-citation publication-type="journal"><name><surname>McEwen</surname><given-names>AS</given-names></name>. <article-title>Photometric functions for photoclinometry and other applications</article-title>. <source>Icarus</source>. <year>1991</year>;<volume>92</volume>(<issue>2</issue>):<fpage>298</fpage>–<lpage>311</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1016/0019-1035(91)90053-V</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0263882.ref037">
      <label>37</label>
      <mixed-citation publication-type="book"><name><surname>Hapke</surname><given-names>B</given-names></name>. <source>Theory of Reflectance and Emittance Spectroscopy</source>. <edition designator="2">2nd ed</edition>. <publisher-loc>Cambridge</publisher-loc>: <publisher-name>Cambridge University Press</publisher-name>; <year>2012</year>. Available from: <pub-id pub-id-type="doi">10.1017/CBO9781139025683</pub-id>.</mixed-citation>
    </ref>
    <ref id="pone.0263882.ref038">
      <label>38</label>
      <mixed-citation publication-type="book"><name><surname>Williams</surname><given-names>L</given-names></name>. <part-title>Casting Curved Shadows on Curved Surfaces</part-title>. In: <source>Seminal Graphics: Pioneering Efforts That Shaped the Field</source>. <publisher-loc>New York, NY, USA</publisher-loc>: <publisher-name>Association for Computing Machinery</publisher-name>; <year>1998</year>. p. <fpage>51</fpage>–<lpage>55</lpage>. Available from: <pub-id pub-id-type="doi">10.1145/280811.280975</pub-id>.</mixed-citation>
    </ref>
    <ref id="pone.0263882.ref039">
      <label>39</label>
      <mixed-citation publication-type="journal"><name><surname>Schmitt</surname><given-names>MI</given-names></name>, <name><surname>Tubiana</surname><given-names>C</given-names></name>, <name><surname>Güttler</surname><given-names>C</given-names></name>, <name><surname>Sierks</surname><given-names>H</given-names></name>, <name><surname>Vincent</surname><given-names>JB</given-names></name>, <name><surname>El-Maarry</surname><given-names>MR</given-names></name>, <etal>et al</etal>. <article-title>Long-term monitoring of comet 67P/Churyumov–Gerasimenko’s jets with OSIRIS onboard Rosetta</article-title>. <source>Monthly Notices of the Royal Astronomical Society</source>. <year>2017</year>;<volume>469</volume>:<fpage>S380</fpage>–<lpage>S385</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/mnras/stx1780</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0263882.ref040">
      <label>40</label>
      <mixed-citation publication-type="journal"><name><surname>Finson</surname><given-names>M</given-names></name>, <name><surname>Probstein</surname><given-names>R</given-names></name>. <article-title>A theory of dust comets. I. Model and equations</article-title>. <source>The Astrophysical Journal</source>. <year>1968</year>;<volume>154</volume>:<fpage>327</fpage>–<lpage>352</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1086/149762</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0263882.ref041">
      <label>41</label>
      <mixed-citation publication-type="journal"><name><surname>Kramer</surname><given-names>T</given-names></name>, <name><surname>Läuter</surname><given-names>M</given-names></name>, <name><surname>Rubin</surname><given-names>M</given-names></name>, <name><surname>Altwegg</surname><given-names>K</given-names></name>. <article-title>Seasonal changes of the volatile density in the coma and on the surface of comet 67P/Churyumov–Gerasimenko</article-title>. <source>Monthly Notices of the Royal Astronomical Society</source>. <year>2017</year>;<volume>469</volume>(<issue>Suppl_2</issue>):<fpage>S20</fpage>–<lpage>S28</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/mnras/stx866</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0263882.ref042">
      <label>42</label>
      <mixed-citation publication-type="journal"><name><surname>Kramer</surname><given-names>T</given-names></name>, <name><surname>Noack</surname><given-names>M</given-names></name>, <name><surname>Baum</surname><given-names>D</given-names></name>, <name><surname>Hege</surname><given-names>HC</given-names></name>, <name><surname>Heller</surname><given-names>EJ</given-names></name>. <article-title>Dust and gas emission from cometary nuclei: the case of comet 67P/Churyumov–Gerasimenko</article-title>. <source>Advances in Physics: X</source>. <year>2018</year>;<volume>3</volume>(<issue>1</issue>):<fpage>1404436</fpage>.</mixed-citation>
    </ref>
    <ref id="pone.0263882.ref043">
      <label>43</label>
      <mixed-citation publication-type="journal"><name><surname>Levasseur-Regourd</surname><given-names>AC</given-names></name>, <name><surname>Renard</surname><given-names>JB</given-names></name>, <name><surname>Hadamcik</surname><given-names>E</given-names></name>, <name><surname>Lasue</surname><given-names>J</given-names></name>, <name><surname>Bertini</surname><given-names>I</given-names></name>, <name><surname>Fulle</surname><given-names>M</given-names></name>. <article-title>Interpretation through experimental simulations of phase functions revealed by Rosetta in 67P/Churyumov-Gerasimenko dust coma</article-title>. <source>Astronomy and Astrophysics</source>. <year>2019</year>;<volume>630</volume>:<fpage>A20</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1051/0004-6361/201834894</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0263882.ref044">
      <label>44</label>
      <mixed-citation publication-type="other">Bührer M. Simulation of Optical Aberrations for Comet Interceptor’s OPIC Instrument [M.Sc. thesis]. Luleå University of Technology and Cranfield University; 2020. Available from: <ext-link xlink:href="http://urn.kb.se/resolve?urn=urn:nbn:se:ltu:diva-81638" ext-link-type="uri">http://urn.kb.se/resolve?urn=urn:nbn:se:ltu:diva-81638</ext-link>.</mixed-citation>
    </ref>
    <ref id="pone.0263882.ref045">
      <label>45</label>
      <mixed-citation publication-type="journal"><name><surname>Brown</surname><given-names>DC</given-names></name>. <article-title>Close-range camera calibration</article-title>. <source>Photogrammetric Engineering</source>. <year>1971</year>;<volume>37</volume>(<issue>8</issue>):<fpage>855</fpage>–<lpage>866</lpage>.</mixed-citation>
    </ref>
    <ref id="pone.0263882.ref046">
      <label>46</label>
      <mixed-citation publication-type="other">Culjak I, Abram D, Pribanic T, Dzapo H, Cifrek M. A brief introduction to OpenCV. In: 2012 Proceedings of the 35th International Convention MIPRO. Opatija, Croatia; 2012. p. 1725–1730. Available from: <ext-link xlink:href="https://ieeexplore.ieee.org/document/6240859" ext-link-type="uri">https://ieeexplore.ieee.org/document/6240859</ext-link>.</mixed-citation>
    </ref>
    <ref id="pone.0263882.ref047">
      <label>47</label>
      <mixed-citation publication-type="journal"><name><surname>Gaskell</surname><given-names>R</given-names></name>, <name><surname>Barnouin-Jha</surname><given-names>O</given-names></name>, <name><surname>Scheeres</surname><given-names>DJ</given-names></name>, <name><surname>Konopliv</surname><given-names>A</given-names></name>, <name><surname>Mukai</surname><given-names>T</given-names></name>, <name><surname>Abe</surname><given-names>S</given-names></name>, <etal>et al</etal>. <article-title>Characterizing and navigating small bodies with imaging data</article-title>. <source>Meteoritics &amp; Planetary Science</source>. <year>2008</year>;<volume>43</volume>(<issue>6</issue>):<fpage>1049</fpage>–<lpage>1061</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1111/j.1945-5100.2008.tb00692.x</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0263882.ref048">
      <label>48</label>
      <mixed-citation publication-type="other">Kainz F, Bogart R, Hess D. The OpenEXR image file format. In: ACM SIGGRAPH Technical Sketches; 2003. Available from: <ext-link xlink:href="https://developer.nvidia.com/gpugems/gpugems/part-iv-image-processing/chapter-26-openexr-image-file-format" ext-link-type="uri">https://developer.nvidia.com/gpugems/gpugems/part-iv-image-processing/chapter-26-openexr-image-file-format</ext-link>.</mixed-citation>
    </ref>
    <ref id="pone.0263882.ref049">
      <label>49</label>
      <mixed-citation publication-type="journal"><name><surname>Lekien</surname><given-names>F</given-names></name>, <name><surname>Marsden</surname><given-names>J</given-names></name>. <article-title>Tricubic interpolation in three dimensions</article-title>. <source>International Journal for Numerical Methods in Engineering</source>. <year>2005</year>;<volume>63</volume>(<issue>3</issue>):<fpage>455</fpage>–<lpage>471</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1002/nme.1296</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0263882.ref050">
      <label>50</label>
      <mixed-citation publication-type="journal"><name><surname>Spudis</surname><given-names>PD</given-names></name>, <name><surname>Ryder</surname><given-names>G</given-names></name>. <article-title>Geology and petrology of the Apollo 15 landing site: Past, present, and future understanding</article-title>. <source>Eos, Transactions American Geophysical Union</source>. <year>1985</year>;<volume>66</volume>(<issue>43</issue>):<fpage>721</fpage>–<lpage>726</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1029/EO066i043p00721</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0263882.ref051">
      <label>51</label>
      <mixed-citation publication-type="journal"><name><surname>Robinson</surname><given-names>MS</given-names></name>, <name><surname>Ashley</surname><given-names>JW</given-names></name>, <name><surname>Boyd</surname><given-names>AK</given-names></name>, <name><surname>Wagner</surname><given-names>RV</given-names></name>, <name><surname>Speyerer</surname><given-names>EJ</given-names></name>, <name><surname>Ray Hawke</surname><given-names>B</given-names></name>, <etal>et al</etal>. <article-title>Confirmation of sublunarean voids and thin layering in mare deposits</article-title>. <source>Planetary and Space Science</source>. <year>2012</year>;<volume>69</volume>(<issue>1</issue>):<fpage>18</fpage>–<lpage>27</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1016/j.pss.2012.05.008</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0263882.ref052">
      <label>52</label>
      <mixed-citation publication-type="journal"><name><surname>Cushing</surname><given-names>GE</given-names></name>, <name><surname>Titus</surname><given-names>TN</given-names></name>, <name><surname>Wynne</surname><given-names>JJ</given-names></name>, <name><surname>Christensen</surname><given-names>PR</given-names></name>. <article-title>THEMIS observes possible cave skylights on Mars</article-title>. <source>Geophysical Research Letters</source>. <year>2007</year>;<volume>34</volume>(<issue>17</issue>):<fpage>L17201</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1029/2007GL030709</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0263882.ref053">
      <label>53</label>
      <mixed-citation publication-type="other">Nesnas IA, Kerber L, Parness A, Kornfeld R, Sellar G, McGarey P, et al. Moon Diver: A Discovery Mission Concept for Understanding the History of Secondary Crusts through the Exploration of a Lunar Mare Pit. In: 2019 IEEE Aerospace Conference; 2019. p. 1–23. Available from: <pub-id pub-id-type="doi">10.1109/AERO.2019.8741788</pub-id>.</mixed-citation>
    </ref>
    <ref id="pone.0263882.ref054">
      <label>54</label>
      <mixed-citation publication-type="journal"><name><surname>Uckert</surname><given-names>K</given-names></name>, <name><surname>Parness</surname><given-names>A</given-names></name>, <name><surname>Chanover</surname><given-names>N</given-names></name>, <name><surname>Eshelman</surname><given-names>EJ</given-names></name>, <name><surname>Abcouwer</surname><given-names>N</given-names></name>, <name><surname>Nash</surname><given-names>J</given-names></name>, <etal>et al</etal>. <article-title>Investigating Habitability with an Integrated Rock-Climbing Robot and Astrobiology Instrument Suite</article-title>. <source>Astrobiology</source>. <year>2020</year>;<volume>20</volume>(<issue>12</issue>):<fpage>1427</fpage>–<lpage>1449</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1089/ast.2019.2177</pub-id><?supplied-pmid 33052709?><pub-id pub-id-type="pmid">33052709</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0263882.ref055">
      <label>55</label>
      <mixed-citation publication-type="journal"><name><surname>Sauro</surname><given-names>F</given-names></name>, <name><surname>Pozzobon</surname><given-names>R</given-names></name>, <name><surname>Massironi</surname><given-names>M</given-names></name>, <name><surname>De Berardinis</surname><given-names>P</given-names></name>, <name><surname>Santagata</surname><given-names>T</given-names></name>, <name><surname>De Waele</surname><given-names>J</given-names></name>. <article-title>Lava tubes on Earth, Moon and Mars: A review on their size and morphology revealed by comparative planetology</article-title>. <source>Earth-Science Reviews</source>. <year>2020</year>;<volume>209</volume>:<fpage>103288</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1016/j.earscirev.2020.103288</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0263882.ref056">
      <label>56</label>
      <mixed-citation publication-type="book"><name><surname>Moulon</surname><given-names>P</given-names></name>, <name><surname>Monasse</surname><given-names>P</given-names></name>, <name><surname>Perrot</surname><given-names>R</given-names></name>, <name><surname>Marlet</surname><given-names>R</given-names></name>. <part-title>OpenMVG: Open Multiple View Geometry</part-title>. In: <name><surname>Kerautret</surname><given-names>B</given-names></name>, <name><surname>Colom</surname><given-names>M</given-names></name>, <name><surname>Monasse</surname><given-names>P</given-names></name>, editors. <source>Reproducible Research in Pattern Recognition</source>. <publisher-loc>Cham</publisher-loc>: <publisher-name>Springer International Publishing</publisher-name>; <year>2017</year>. p. <fpage>60</fpage>–<lpage>74</lpage>. Available from: <ext-link xlink:href="https://link.springer.com/chapter/10.1007/978-3-319-56414-2_5" ext-link-type="uri">https://link.springer.com/chapter/10.1007/978-3-319-56414-2_5</ext-link>.</mixed-citation>
    </ref>
    <ref id="pone.0263882.ref057">
      <label>57</label>
      <mixed-citation publication-type="other">Moulon P, Duisit B, Monasse P. Global Multiple-View Color Consistency. In: Proceedings of CVMP 2013. Londres, United Kingdom; 2013. Available from: <ext-link xlink:href="https://hal-enpc.archives-ouvertes.fr/hal-00873517/" ext-link-type="uri">https://hal-enpc.archives-ouvertes.fr/hal-00873517/</ext-link>.</mixed-citation>
    </ref>
    <ref id="pone.0263882.ref058">
      <label>58</label>
      <mixed-citation publication-type="other">Liu Z, Marlet R. Virtual line descriptor and semi-local matching method for reliable feature correspondence. In: Proceedings of British Machine Vision Conference 2012. Surrey, United Kingdom; 2012. p. 16.1–16.11. Available from: <ext-link xlink:href="https://hal.archives-ouvertes.fr/hal-00743323" ext-link-type="uri">https://hal.archives-ouvertes.fr/hal-00743323</ext-link>.</mixed-citation>
    </ref>
    <ref id="pone.0263882.ref059">
      <label>59</label>
      <mixed-citation publication-type="other">Cernea D. OpenMVS: Multi-View Stereo Reconstruction Library; 2021. Available from: <ext-link xlink:href="https://cdcseacave.github.io/openMVS" ext-link-type="uri">https://cdcseacave.github.io/openMVS</ext-link>.</mixed-citation>
    </ref>
    <ref id="pone.0263882.ref060">
      <label>60</label>
      <mixed-citation publication-type="other">Girardeau-Montaut D. Cloudcompare—open source project; 2011. Available from: <ext-link xlink:href="https://www.cloudcompare.org" ext-link-type="uri">https://www.cloudcompare.org</ext-link>.</mixed-citation>
    </ref>
    <ref id="pone.0263882.ref061">
      <label>61</label>
      <mixed-citation publication-type="other">Schwarzkopf GJ. 3D Reconstruction of Small Solar System Bodies using Rendered and Compressed Images [M.Sc. thesis]. Luleå University of Technology, Aalto University; 2020. Available from: <ext-link xlink:href="http://urn.kb.se/resolve?urn=urn:nbn:se:ltu:diva-77846" ext-link-type="uri">http://urn.kb.se/resolve?urn=urn:nbn:se:ltu:diva-77846</ext-link>.</mixed-citation>
    </ref>
  </ref-list>
</back>
<sub-article article-type="aggregated-review-documents" id="pone.0263882.r001" specific-use="decision-letter">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pone.0263882.r001</article-id>
    <title-group>
      <article-title>Decision Letter 0</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Agudo</surname>
          <given-names>Antonio</given-names>
        </name>
        <role>Academic Editor</role>
      </contrib>
    </contrib-group>
    <permissions>
      <copyright-statement>© 2022 Antonio Agudo</copyright-statement>
      <copyright-year>2022</copyright-year>
      <copyright-holder>Antonio Agudo</copyright-holder>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <related-article ext-link-type="doi" xlink:href="10.1371/journal.pone.0263882" id="rel-obj001" related-article-type="reviewed-article"/>
    <custom-meta-group>
      <custom-meta>
        <meta-name>Submission Version</meta-name>
        <meta-value>0</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>
      <named-content content-type="letter-date">11 Aug 2021</named-content>
    </p>
    <p>PONE-D-21-15766</p>
    <p>SISPO: Space Imaging Simulator for Proximity Operations</p>
    <p>PLOS ONE</p>
    <p>Dear Dr. Iakubivskyi,</p>
    <p>Thank you for submitting your manuscript to PLOS ONE. After careful consideration, we feel that it has merit but does not fully meet PLOS ONE’s publication criteria as it currently stands. Therefore, we invite you to submit a revised version of the manuscript that addresses the points raised during the review process.</p>
    <p>Please find below the reviews for your paper.</p>
    <p>Please submit your revised manuscript by Sep 25 2021 11:59PM. If you will need more time than this to complete your revisions, please reply to this message or contact the journal office at <email>plosone@plos.org</email>. When you're ready to submit your revision, log on to <ext-link xlink:href="https://www.editorialmanager.com/pone/" ext-link-type="uri">https://www.editorialmanager.com/pone/</ext-link> and select the 'Submissions Needing Revision' folder to locate your manuscript file.</p>
    <p>Please include the following items when submitting your revised manuscript:</p>
    <p>
      <list list-type="bullet">
        <list-item>
          <p>A rebuttal letter that responds to each point raised by the academic editor and reviewer(s). You should upload this letter as a separate file labeled 'Response to Reviewers'.</p>
        </list-item>
        <list-item>
          <p>A marked-up copy of your manuscript that highlights changes made to the original version. You should upload this as a separate file labeled 'Revised Manuscript with Track Changes'.</p>
        </list-item>
        <list-item>
          <p>An unmarked version of your revised paper without tracked changes. You should upload this as a separate file labeled 'Manuscript'.</p>
        </list-item>
      </list>
    </p>
    <p>If you would like to make changes to your financial disclosure, please include your updated statement in your cover letter. Guidelines for resubmitting your figure files are available below the reviewer comments at the end of this letter.</p>
    <p><!-- <span style="color: rgb(51, 51, 51); font-family: sans-serif, Arial, Verdana, "Trebuchet MS"; font-size: 13px; background-color: rgb(255, 255, 255);"> -->If applicable, we recommend that you deposit your laboratory protocols in protocols.io to enhance the reproducibility of your results. Protocols.io assigns your protocol its own identifier (DOI) so that it can be cited independently in the future. For instructions see: <!-- </span> --><ext-link xlink:href="http://journals.plos.org/plosone/s/submission-guidelines#loc-laboratory-protocols" ext-link-type="uri">http://journals.plos.org/plosone/s/submission-guidelines#loc-laboratory-protocols</ext-link><!-- <span style="color: rgb(51, 51, 51); font-family: sans-serif, Arial, Verdana, "Trebuchet MS"; font-size: 13px; background-color: rgb(255, 255, 255);"> -->. Additionally, PLOS ONE offers an option for publishing peer-reviewed Lab Protocol articles, which describe protocols hosted on protocols.io. Read more information on sharing protocols at <!-- </span> --><ext-link xlink:href="https://plos.org/protocols?utm_medium=editorial-email&amp;utm_source=authorletters&amp;utm_campaign=protocols" ext-link-type="uri">https://plos.org/protocols?utm_medium=editorial-email&amp;utm_source=authorletters&amp;utm_campaign=protocols</ext-link><!-- <span style="color: rgb(51, 51, 51); font-family: sans-serif, Arial, Verdana, "Trebuchet MS"; font-size: 13px; background-color: rgb(255, 255, 255);"> -->.<!-- </span> --></p>
    <p>We look forward to receiving your revised manuscript.</p>
    <p>Kind regards,</p>
    <p>Antonio Agudo</p>
    <p>Academic Editor</p>
    <p>PLOS ONE</p>
    <p>Journal Requirements:</p>
    <p>When submitting your revision, we need you to address these additional requirements.</p>
    <p>1. Please ensure that your manuscript meets PLOS ONE's style requirements, including those for file naming. The PLOS ONE style templates can be found at </p>
    <p><ext-link xlink:href="https://journals.plos.org/plosone/s/file?id=wjVg/PLOSOne_formatting_sample_main_body.pdf" ext-link-type="uri">https://journals.plos.org/plosone/s/file?id=wjVg/PLOSOne_formatting_sample_main_body.pdf</ext-link> and </p>
    <p>
      <ext-link xlink:href="https://journals.plos.org/plosone/s/file?id=ba62/PLOSOne_formatting_sample_title_authors_affiliations.pdf" ext-link-type="uri">https://journals.plos.org/plosone/s/file?id=ba62/PLOSOne_formatting_sample_title_authors_affiliations.pdf</ext-link>
    </p>
    <p>2. Thank you for stating the following in the Acknowledgments Section of your manuscript: </p>
    <p>The research for this article was partly supported by the University of Tartu ASTRA project 467</p>
    <p>2014–2020.4.01.16-0029 KOMEET “Benefits for Estonian Society from Space Research and 468</p>
    <p>Application”, financed by the EU European Regional Development Fund</p>
    <p>We note that you have provided additional information within the Acknowledgements Section that is not currently declared in your Funding Statement. Please note that funding information should not appear in the Acknowledgments section or other areas of your manuscript. We will only publish funding information present in the Funding Statement section of the online submission form. </p>
    <p>Please remove any funding-related text from the manuscript and let us know how you would like to update your Funding Statement. Currently, your Funding Statement reads as follows: </p>
    <p>1. Mihkel Pajusalu</p>
    <p>2. PUTJD601 and MOBTP151</p>
    <p>3. Estonian Research Council</p>
    <p>4. <ext-link xlink:href="https://www.etag.ee/en" ext-link-type="uri">https://www.etag.ee/en</ext-link></p>
    <p>5. he funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</p>
    <p>Please include your amended statements within your cover letter; we will change the online submission form on your behalf. </p>
    <p>3. Please ensure that you refer to Figure 1 in your text as, if accepted, production will need this reference to link the reader to the figure.</p>
    <p>4. We note that Figures 1, 4, 5, 6, 8, 12, 13 and 14 in your submission contain copyrighted images. All PLOS content is published under the Creative Commons Attribution License (CC BY 4.0), which means that the manuscript, images, and Supporting Information files will be freely available online, and any third party is permitted to access, download, copy, distribute, and use these materials in any way, even commercially, with proper attribution. For more information, see our copyright guidelines: <ext-link xlink:href="http://journals.plos.org/plosone/s/licenses-and-copyright" ext-link-type="uri">http://journals.plos.org/plosone/s/licenses-and-copyright</ext-link>.</p>
    <p>We require you to either (1) present written permission from the copyright holder to publish these figures specifically under the CC BY 4.0 license, or (2) remove the figures from your submission:</p>
    <p>a. You may seek permission from the original copyright holder of Figures 1, 4, 5, 6, 8, 12, 13 and 14 to publish the content specifically under the CC BY 4.0 license. </p>
    <p>We recommend that you contact the original copyright holder with the Content Permission Form (<ext-link xlink:href="http://journals.plos.org/plosone/s/file?id=7c09/content-permission-form.pdf" ext-link-type="uri">http://journals.plos.org/plosone/s/file?id=7c09/content-permission-form.pdf</ext-link>) and the following text:</p>
    <p>“I request permission for the open-access journal PLOS ONE to publish XXX under the Creative Commons Attribution License (CCAL) CC BY 4.0 (<ext-link xlink:href="http://creativecommons.org/licenses/by/4.0/" ext-link-type="uri">http://creativecommons.org/licenses/by/4.0/</ext-link>). Please be aware that this license allows unrestricted use and distribution, even commercially, by third parties. Please reply and provide explicit written permission to publish XXX under a CC BY license and complete the attached form.”</p>
    <p>Please upload the completed Content Permission Form or other proof of granted permissions as an "Other" file with your submission. </p>
    <p>In the figure caption of the copyrighted figure, please include the following text: “Reprinted from [ref] under a CC BY license, with permission from [name of publisher], original copyright [original copyright year].”</p>
    <p>b. If you are unable to obtain permission from the original copyright holder to publish these figures under the CC BY 4.0 license or if the copyright holder’s requirements are incompatible with the CC BY 4.0 license, please either i) remove the figure or ii) supply a replacement figure that complies with the CC BY 4.0 license. Please check copyright information on all replacement figures and update the figure caption with source information. If applicable, please specify in the figure caption text when a figure is similar but not identical to the original image and is therefore for illustrative purposes only.</p>
    <p>Additional Editor Comments:</p>
    <p>Dear authors,</p>
    <p>The submission was reviewed by two experts in the field. Both of them pointed out some issues with the current submission. For instance, a lack of a properly experimental evaluation (R1) after comparing the generated and rendered images with respect to ground truth. This is really relevant to validate the work, especially considering the other reviewer (R2) considers the paper is just a description of capabilities of the software. In addition to that, the real contribution (R2) should be clarified, and add some missing details in the document. Considering that, the authors should carefully improve the document following point by point all the reviewers’ comments, especially the provided by R1 regarding the comparison and validation of the method. Unfortunately, I cannot consider the paper for publication without before including all the previous improvements.</p>
    <p>Best</p>
    <p>[Note: HTML markup is below. Please do not edit.]</p>
    <p>Reviewers' comments:</p>
    <p>Reviewer's Responses to Questions</p>
    <p>
      <!-- <font color="black"> -->
      <bold>Comments to the Author</bold>
    </p>
    <p>1. Is the manuscript technically sound, and do the data support the conclusions?</p>
    <p>The manuscript must describe a technically sound piece of scientific research with data that supports the conclusions. Experiments must have been conducted rigorously, with appropriate controls, replication, and sample sizes. The conclusions must be drawn appropriately based on the data presented. <!-- </font> --></p>
    <p>Reviewer #1: Yes</p>
    <p>Reviewer #2: Yes</p>
    <p>**********</p>
    <p><!-- <font color="black"> -->2. Has the statistical analysis been performed appropriately and rigorously? <!-- </font> --></p>
    <p>Reviewer #1: No</p>
    <p>Reviewer #2: N/A</p>
    <p>**********</p>
    <p><!-- <font color="black"> -->3. Have the authors made all data underlying the findings in their manuscript fully available?</p>
    <p>The <ext-link xlink:href="http://www.plosone.org/static/policies.action#sharing" ext-link-type="uri">PLOS Data policy</ext-link> requires authors to make all data underlying the findings described in their manuscript fully available without restriction, with rare exception (please refer to the Data Availability Statement in the manuscript PDF file). The data should be provided as part of the manuscript or its supporting information, or deposited to a public repository. For example, in addition to summary statistics, the data points behind means, medians and variance measures should be available. If there are restrictions on publicly sharing data—e.g. participant privacy or use of data from a third party—those must be specified.<!-- </font> --></p>
    <p>Reviewer #1: Yes</p>
    <p>Reviewer #2: Yes</p>
    <p>**********</p>
    <p><!-- <font color="black"> -->4. Is the manuscript presented in an intelligible fashion and written in standard English?</p>
    <p>PLOS ONE does not copyedit accepted manuscripts, so the language in submitted articles must be clear, correct, and unambiguous. Any typographical or grammatical errors should be corrected at revision, so please note any specific errors here.<!-- </font> --></p>
    <p>Reviewer #1: Yes</p>
    <p>Reviewer #2: Yes</p>
    <p>**********</p>
    <p><!-- <font color="black"> -->5. Review Comments to the Author</p>
    <p>Please use the space provided to explain your answers to the questions above. You may also include additional comments for the author, including concerns about dual publication, research ethics, or publication ethics. (Please upload your review as an attachment if it exceeds 20,000 characters)<!-- </font> --></p>
    <p>Reviewer #1: My main comment is that when generating simulated images, it would be expected to perform image comparison with real images vs the simulations to present meaningful data on the accuracy of the simulations, hence why a revision is recommended. There are also some undeveloped features that appear to be "add ons" that detract from the interesting and more detailed work that has been presented, by this I mean partially developed concepts (not justified or evaluated), e.g. displacement craters, spacecraft images etc. Other comments include:</p>
    <p>Fig 1 compares four image simulators. This is misleading because the SurRender and PANGU images (A and B) appear to be from an unenhanced shape model, while (D) clearly has additional features added. You need to state the resolution of the shape model used for each (for any reasonable comparison) and whether additional features have been added (both SurRender and PANGU have this capability). Also, you should include comparison to a real Hayabusa image to show how they compare and then image statistical evaluations. This would show the unrealistic, flat-bottomed (???) small craters on image (D) which do not exist on the small rubble-pile type asteroid Itokawa.</p>
    <p>The additional of height-mapped displaced features needs some further qualification and comparison to real images showing these features, and a discussion to explain how and where they could be realistically added to a scene, giving examples of a real images showing comparable features. Otherwise, this is misleading as the paper does not explain in what scenarios these features can be reasonably added. For example, the craters are unrealistic in the context (flat bottomed craters are generally large (e.g. &gt;10km on the Moon, but this varies with gravity and surface density), the overlapping is also unrealistic in the context presented.</p>
    <p>For the camera model distortion, why are Earth images used? Have the properties of a real camera used in a space mission been modelled and simulated (e.g. the AMICA camera that took images of asteroid Itokawa, used in many of your examples).</p>
    <p>You compare simulated to real images in Fig 10 which is helpful, could you also do further statistical image analysis to evaluate how similar the images are to the real images from a computer vision perspective, i.e. running simple histogram analysis and other standard image-processing comparison techniques?</p>
    <p>The spacecraft rendering (Fig 13) is interesting but there are very little details give such as model material properties supported, comparison with real images etc. If this is to be included in this paper, then this section needs further details.</p>
    <p>The reconstruction section shown in Fig 14- Fig 18 is much better as it gives some information on the accuracy of the technique, but this approach is lacking in some of the earlier sections.</p>
    <p>Reviewer #2: SISPO: Space Imaging Simulator for Proximity Operations</p>
    <p>Authors present a framework to perform several tasks related to astrophysics field, such as asteroid orbit simulation, simulation of dust of comets, render the result images and corrections on camera optical aberrations. For most of the tasks, the authors use third party software that is wrapped and prepared to be used in a more easy manner.</p>
    <p>The article is just a description of the capabilities of the software. This is not a research paper.</p>
    <p>The software is publicly available with limited documentation, which makes it not so straightforward to use, but still more easy than use the third party software separately.</p>
    <p>In the current state:</p>
    <p>1. If journal only accepts research papers: Reject</p>
    <p>2. Otherwise: Minor revision</p>
    <p>The document needs to be improved. It is very strange to find all figures at the end of the document, making the reader constantly jump up and down.</p>
    <p>The contributions of the authors are not so clear as many of the capabilities come from a third party software, and these capabilities are not integrated into a single software but need to be run separately, but still can be useful software for the community.</p>
    <p>Minor comments:</p>
    <p>Table 1, mentioned in page 3, but appears in page 8. Table 1 page 3 should be different table, which I can't find.</p>
    <p>line 244, not sure what authors mean by the "the like"</p>
    <p>line 239 Cycle -&gt; Cycles</p>
    <p>**********</p>
    <p><!-- <font color="black"> -->6. PLOS authors have the option to publish the peer review history of their article (<ext-link xlink:href="https://journals.plos.org/plosone/s/editorial-and-peer-review-process#loc-peer-review-history" ext-link-type="uri">what does this mean?</ext-link>). If published, this will include your full peer review and any attached files.</p>
    <p>If you choose “no”, your identity will remain anonymous but your review may still be made public.</p>
    <p><bold>Do you want your identity to be public for this peer review?</bold> For information about this choice, including consent withdrawal, please see our <ext-link xlink:href="https://www.plos.org/privacy-policy" ext-link-type="uri">Privacy Policy</ext-link>.<!-- </font> --></p>
    <p>Reviewer #1: No</p>
    <p>Reviewer #2: No</p>
    <p>[NOTE: If reviewer comments were submitted as an attachment file, they will be attached to this email and accessible via the submission site. Please log into your account, locate the manuscript record, and check for the action link "View Attachments". If this link does not appear, there are no attachment files.]</p>
    <p>While revising your submission, please upload your figure files to the Preflight Analysis and Conversion Engine (PACE) digital diagnostic tool, <ext-link xlink:href="https://pacev2.apexcovantage.com/" ext-link-type="uri">https://pacev2.apexcovantage.com/</ext-link>. PACE helps ensure that figures meet PLOS requirements. To use PACE, you must first register as a user. Registration is free. Then, login and navigate to the UPLOAD tab, where you will find detailed instructions on how to use the tool. If you encounter any issues or have any questions when using PACE, please email PLOS at <email>figures@plos.org</email>. Please note that Supporting Information files do not need this step.</p>
  </body>
</sub-article>
<sub-article article-type="author-comment" id="pone.0263882.r002">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pone.0263882.r002</article-id>
    <title-group>
      <article-title>Author response to Decision Letter 0</article-title>
    </title-group>
    <related-article ext-link-type="doi" xlink:href="10.1371/journal.pone.0263882" id="rel-obj002" related-article-type="editor-report"/>
    <custom-meta-group>
      <custom-meta>
        <meta-name>Submission Version</meta-name>
        <meta-value>1</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>
      <named-content content-type="author-response-date">11 Oct 2021</named-content>
    </p>
    <p>Response to Reviewers PONE-D-21-15766</p>
    <p>SISPO: Space Imaging Simulator for Proximity Operations</p>
    <p>24.09.2021</p>
    <p>Dear all,</p>
    <p>Thank you for revising our manuscript and the excellent comments you have provided; this is precious information and helps us improve our paper. One general remark is that we developed this tool to simplify our work on the OPIC instrument development for the ESA Comet Interceptor mission (among other instruments we investigate). We found this tool very useful for the actual payload developed that will be launched with the Ariel telescope in 2029, and we thought to make this tool public for others to use with supporting paper describing it. According to the journal's statement: "PLOS ONE considers Research Article submissions that report new methods, software, databases and tools as the primary focus of the article". Please find responses to addressed issues below, as well as marked changes in the attached file.</p>
    <p>Reviewer #1: My main comment is that when generating simulated images, it would be expected to perform image comparison with real images vs the simulations to present meaningful data on the accuracy of the simulations, hence why a revision is recommended. There are also some undeveloped features that appear to be "add ons" that detract from the interesting and more detailed work that has been presented, by this I mean partially developed concepts (not justified or evaluated), e.g. displacement craters, spacecraft images etc. Other comments include:</p>
    <p>Thank you for the comment. Indeed it is valuable to include comparison for the produced images. We have included two new comparisons in (new) Figure 5 (OpenGL vs AMICA) and Figure 6 (Cycles plain vs AMICA). Cycles procedural texturing image is not reasonable to compare with the original image since it introduces new features and displaces the surfaces. It is not meant to reproduce the exact images that already exist but provides an opportunity to create a versatile set of new images using the same model: this is crucial for developing autonomous operations and training the algorithm to make the right decisions. </p>
    <p>Fig 1 compares four image simulators. This is misleading because the SurRender and PANGU images (A and B) appear to be from an unenhanced shape model, while (D) clearly has additional features added. You need to state the resolution of the shape model used for each (for any reasonable comparison) and whether additional features have been added (both SurRender and PANGU have this capability). Also, you should include comparison to a real Hayabusa image to show how they compare and then image statistical evaluations. This would show the unrealistic, flat-bottomed (???) small craters on image (D) which do not exist on the small rubble-pile type asteroid Itokawa.</p>
    <p>Thank you for the comment. The same input model is used in all of the simulators. This table demonstrates the overview of the SISPO and does not intend to show the SISPO advantages over other simulators; it affirms the capabilities of the same model: each simulator is useful but uses different approaches, and we wanted to introduce them and provided relevant references for the reader. We have clarified new features generations in the text and table; hopefully, it is clearer now.</p>
    <p>The additional of height-mapped displaced features needs some further qualification and comparison to real images showing these features, and a discussion to explain how and where they could be realistically added to a scene, giving examples of a real images showing comparable features. Otherwise, this is misleading as the paper does not explain in what scenarios these features can be reasonably added. For example, the craters are unrealistic in the context (flat bottomed craters are generally large (e.g. &gt;10km on the Moon, but this varies with gravity and surface density), the overlapping is also unrealistic in the context presented.</p>
    <p>Thank you for the comment. This is a user-defined decision and specific need. This tool has a particular set of capabilities that can be applied to different sizes of bodies, and we only show what is possible. While your comment about craters is valid based on the observed families of asteroids, the simulator user can adjust these sizes to their demands. For example, as you can see in Fig 8(B) these features are minimally used.</p>
    <p>For the camera model distortion, why are Earth images used? Have the properties of a real camera used in a space mission been modelled and simulated (e.g. the AMICA camera that took images of asteroid Itokawa, used in many of your examples).</p>
    <p>We have removed these images due to conflict with copyright as requested by the editor. The distortions of AMICA is so small that other errors become more significant in the analysis; therefore, we did not include them. The text provides a reference to the thesis that presents very detailed examples and capabilities of the SISPO's OASIS package in Bührer, 2020.</p>
    <p>You compare simulated to real images in Fig 10 which is helpful, could you also do further statistical image analysis to evaluate how similar the images are to the real images from a computer vision perspective, i.e. running simple histogram analysis and other standard image-processing comparison techniques?</p>
    <p>Thank you for the comment. We have included the comparison.</p>
    <p>The spacecraft rendering (Fig 13) is interesting but there are very little details give such as model material properties supported, comparison with real images etc. If this is to be included in this paper, then this section needs further details.</p>
    <p>Thank you for the comment. This article focuses mainly on small solar system bodies. As the use case, we have shown additional applications. A description of all underlying parameters and shaders would be misleading and occupy the big part of the paper with shifted focus. This example is listed because it can also be used for developing formation-flying algorithms and orbital proximity operations; we have added it to the text.</p>
    <p>The reconstruction section shown in Fig 14- Fig 18 is much better as it gives some information on the accuracy of the technique, but this approach is lacking in some of the earlier sections.</p>
    <p>Thank you, indeed this section is demanding numerical comparison.</p>
    <p>Reviewer #2: SISPO: Space Imaging Simulator for Proximity Operations</p>
    <p>Authors present a framework to perform several tasks related to astrophysics field, such as asteroid orbit simulation, simulation of dust of comets, render the result images and corrections on camera optical aberrations. For most of the tasks, the authors use third party software that is wrapped and prepared to be used in a more easy manner.</p>
    <p>The article is just a description of the capabilities of the software. This is not a research paper.</p>
    <p>The software is publicly available with limited documentation, which makes it not so straightforward to use, but still more easy than use the third party software separately.</p>
    <p>Thank you for your comment. According to the PLOS ONE statement "PLOS ONE considers Research Article submissions which report new methods, software, databases and tools as the primary focus of the article." Source: <ext-link xlink:href="https://journals.plos.org/plosone/s/what-we-publish" ext-link-type="uri">https://journals.plos.org/plosone/s/what-we-publish</ext-link></p>
    <p>In the current state:</p>
    <p>1. If journal only accepts research papers: Reject</p>
    <p>2. Otherwise: Minor revision</p>
    <p>The document needs to be improved. It is very strange to find all figures at the end of the document, making the reader constantly jump up and down.</p>
    <p>Thank you for the comment but that is the requirement of this journal. The PLOS ONE requirements: the figures are not embedded in the latex file and must be uploaded separately, which end up at the end of the automatically generated file.</p>
    <p>The contributions of the authors are not so clear as many of the capabilities come from a third party software, and these capabilities are not integrated into a single software but need to be run separately, but still can be useful software for the community.</p>
    <p>Thank you for the comment. All the packages are included in a single pipeline, as visualised in Fig 2. The authors wrote all the scripts and performed simulations and analyses of the software. </p>
    <p>Minor comments:</p>
    <p>Table 1, mentioned in page 3, but appears in page 8. Table 1 page 3 should be different table, which I can't find.</p>
    <p>Thank you for pointing it out. There was a table in the beginning but later was represented as Figure 1. I have changed it in the text, it should be Fig 1.</p>
    <p>line 244, not sure what authors mean by the "the like"</p>
    <p>It was removed.</p>
    <p>line 239 Cycle -&gt; Cycles</p>
    <p>It is corrected.</p>
  </body>
</sub-article>
<sub-article article-type="aggregated-review-documents" id="pone.0263882.r003" specific-use="decision-letter">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pone.0263882.r003</article-id>
    <title-group>
      <article-title>Decision Letter 1</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Agudo</surname>
          <given-names>Antonio</given-names>
        </name>
        <role>Academic Editor</role>
      </contrib>
    </contrib-group>
    <permissions>
      <copyright-statement>© 2022 Antonio Agudo</copyright-statement>
      <copyright-year>2022</copyright-year>
      <copyright-holder>Antonio Agudo</copyright-holder>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <related-article ext-link-type="doi" xlink:href="10.1371/journal.pone.0263882" id="rel-obj003" related-article-type="reviewed-article"/>
    <custom-meta-group>
      <custom-meta>
        <meta-name>Submission Version</meta-name>
        <meta-value>1</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>
      <named-content content-type="letter-date">31 Jan 2022</named-content>
    </p>
    <p>SISPO: Space Imaging Simulator for Proximity Operations</p>
    <p>PONE-D-21-15766R1</p>
    <p>Dear Dr. Iakubivskyi,</p>
    <p>We’re pleased to inform you that your manuscript has been judged scientifically suitable for publication and will be formally accepted for publication once it meets all outstanding technical requirements.</p>
    <p>Within one week, you’ll receive an e-mail detailing the required amendments. When these have been addressed, you’ll receive a formal acceptance letter and your manuscript will be scheduled for publication.</p>
    <p>An invoice for payment will follow shortly after the formal acceptance. To ensure an efficient process, please log into Editorial Manager at <ext-link xlink:href="http://www.editorialmanager.com/pone/" ext-link-type="uri">http://www.editorialmanager.com/pone/</ext-link>, click the 'Update My Information' link at the top of the page, and double check that your user information is up-to-date. If you have any billing related questions, please contact our Author Billing department directly at <email>authorbilling@plos.org</email>.</p>
    <p>If your institution or institutions have a press office, please notify them about your upcoming paper to help maximize its impact. If they’ll be preparing press materials, please inform our press team as soon as possible -- no later than 48 hours after receiving the formal acceptance. Your manuscript will remain under strict press embargo until 2 pm Eastern Time on the date of publication. For more information, please contact <email>onepress@plos.org</email>.</p>
    <p>Kind regards,</p>
    <p>Antonio Agudo</p>
    <p>Academic Editor</p>
    <p>PLOS ONE</p>
    <p>Additional Editor Comments (optional):</p>
    <p>Thank you for providing a review point by point. The paper is ready for publication.</p>
    <p>Reviewers' comments:</p>
    <p>Reviewer's Responses to Questions</p>
    <p>
      <!-- <font color="black"> -->
      <bold>Comments to the Author</bold>
    </p>
    <p>1. If the authors have adequately addressed your comments raised in a previous round of review and you feel that this manuscript is now acceptable for publication, you may indicate that here to bypass the “Comments to the Author” section, enter your conflict of interest statement in the “Confidential to Editor” section, and submit your "Accept" recommendation.<!-- </font> --></p>
    <p>Reviewer #2: All comments have been addressed</p>
    <p>Reviewer #3: All comments have been addressed</p>
    <p>**********</p>
    <p><!-- <font color="black"> -->2. Is the manuscript technically sound, and do the data support the conclusions?</p>
    <p>The manuscript must describe a technically sound piece of scientific research with data that supports the conclusions. Experiments must have been conducted rigorously, with appropriate controls, replication, and sample sizes. The conclusions must be drawn appropriately based on the data presented. <!-- </font> --></p>
    <p>Reviewer #2: Yes</p>
    <p>Reviewer #3: Yes</p>
    <p>**********</p>
    <p><!-- <font color="black"> -->3. Has the statistical analysis been performed appropriately and rigorously? <!-- </font> --></p>
    <p>Reviewer #2: N/A</p>
    <p>Reviewer #3: Yes</p>
    <p>**********</p>
    <p><!-- <font color="black"> -->4. Have the authors made all data underlying the findings in their manuscript fully available?</p>
    <p>The <ext-link xlink:href="http://www.plosone.org/static/policies.action#sharing" ext-link-type="uri">PLOS Data policy</ext-link> requires authors to make all data underlying the findings described in their manuscript fully available without restriction, with rare exception (please refer to the Data Availability Statement in the manuscript PDF file). The data should be provided as part of the manuscript or its supporting information, or deposited to a public repository. For example, in addition to summary statistics, the data points behind means, medians and variance measures should be available. If there are restrictions on publicly sharing data—e.g. participant privacy or use of data from a third party—those must be specified.<!-- </font> --></p>
    <p>Reviewer #2: Yes</p>
    <p>Reviewer #3: Yes</p>
    <p>**********</p>
    <p><!-- <font color="black"> -->5. Is the manuscript presented in an intelligible fashion and written in standard English?</p>
    <p>PLOS ONE does not copyedit accepted manuscripts, so the language in submitted articles must be clear, correct, and unambiguous. Any typographical or grammatical errors should be corrected at revision, so please note any specific errors here.<!-- </font> --></p>
    <p>Reviewer #2: Yes</p>
    <p>Reviewer #3: Yes</p>
    <p>**********</p>
    <p><!-- <font color="black"> -->6. Review Comments to the Author</p>
    <p>Please use the space provided to explain your answers to the questions above. You may also include additional comments for the author, including concerns about dual publication, research ethics, or publication ethics. (Please upload your review as an attachment if it exceeds 20,000 characters)<!-- </font> --></p>
    <p>Reviewer #2: Based on the comments of the authors regarding my main concerns about journal format and topic, I have no opposition to accept the paper.</p>
    <p>Also, authors have included comparisons between real/simulated images which makes the document more interesting for a general readers.</p>
    <p>Reviewer #3: Authors have addressed all the comments in the review. There are not more major concerns. Thank you very much.</p>
    <p>**********</p>
    <p><!-- <font color="black"> -->7. PLOS authors have the option to publish the peer review history of their article (<ext-link xlink:href="https://journals.plos.org/plosone/s/editorial-and-peer-review-process#loc-peer-review-history" ext-link-type="uri">what does this mean?</ext-link>). If published, this will include your full peer review and any attached files.</p>
    <p>If you choose “no”, your identity will remain anonymous but your review may still be made public.</p>
    <p><bold>Do you want your identity to be public for this peer review?</bold> For information about this choice, including consent withdrawal, please see our <ext-link xlink:href="https://www.plos.org/privacy-policy" ext-link-type="uri">Privacy Policy</ext-link>.<!-- </font> --></p>
    <p>Reviewer #2: No</p>
    <p>Reviewer #3: No</p>
  </body>
</sub-article>
<sub-article article-type="editor-report" id="pone.0263882.r004" specific-use="acceptance-letter">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pone.0263882.r004</article-id>
    <title-group>
      <article-title>Acceptance letter</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Agudo</surname>
          <given-names>Antonio</given-names>
        </name>
        <role>Academic Editor</role>
      </contrib>
    </contrib-group>
    <permissions>
      <copyright-statement>© 2022 Antonio Agudo</copyright-statement>
      <copyright-year>2022</copyright-year>
      <copyright-holder>Antonio Agudo</copyright-holder>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <related-article ext-link-type="doi" xlink:href="10.1371/journal.pone.0263882" id="rel-obj004" related-article-type="reviewed-article"/>
  </front-stub>
  <body>
    <p>
      <named-content content-type="letter-date">21 Feb 2022</named-content>
    </p>
    <p>PONE-D-21-15766R1 </p>
    <p>SISPO: Space Imaging Simulator for Proximity Operations </p>
    <p>Dear Dr. Iakubivskyi:</p>
    <p>I'm pleased to inform you that your manuscript has been deemed suitable for publication in PLOS ONE. Congratulations! Your manuscript is now with our production department. </p>
    <p>If your institution or institutions have a press office, please let them know about your upcoming paper now to help maximize its impact. If they'll be preparing press materials, please inform our press team within the next 48 hours. Your manuscript will remain under strict press embargo until 2 pm Eastern Time on the date of publication. For more information please contact <email>onepress@plos.org</email>.</p>
    <p>If we can help with anything else, please email us at <email>plosone@plos.org</email>. </p>
    <p>Thank you for submitting your work to PLOS ONE and supporting open access. </p>
    <p>Kind regards, </p>
    <p>PLOS ONE Editorial Office Staff</p>
    <p>on behalf of</p>
    <p>Dr. Antonio Agudo </p>
    <p>Academic Editor</p>
    <p>PLOS ONE</p>
  </body>
</sub-article>
