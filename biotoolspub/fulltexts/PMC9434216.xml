<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Genetics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Genetics</journal-id>
    <journal-id journal-id-type="publisher-id">genetics</journal-id>
    <journal-title-group>
      <journal-title>Genetics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">0016-6731</issn>
    <issn pub-type="epub">1943-2631</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">9434216</article-id>
    <article-id pub-id-type="pmid">35924977</article-id>
    <article-id pub-id-type="doi">10.1093/genetics/iyac112</article-id>
    <article-id pub-id-type="publisher-id">iyac112</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Investigation</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Computational Resources, Software, &amp; Databases</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01180</subject>
        <subject>AcademicSubjects/SCI01140</subject>
        <subject>AcademicSubjects/SCI00010</subject>
        <subject>AcademicSubjects/SCI00960</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Multitrait Bayesian shrinkage and variable selection models with the BGLR-R package</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-3202-1784</contrib-id>
        <name>
          <surname>Pérez-Rodríguez</surname>
          <given-names>Paulino</given-names>
        </name>
        <!--perpdgo@gmail.com-->
        <aff><institution>Colegio de Postgraduados</institution>, Montecillo, Estado de México 56230, <country country="MX">Mexico</country></aff>
        <aff><institution>Department of Epidemiology and Biostatistics, Michigan State University</institution>, East Lansing, MI 48824, <country country="US">USA</country></aff>
        <xref rid="iyac112-cor1" ref-type="corresp"/>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0001-5692-7129</contrib-id>
        <name>
          <surname>de los Campos</surname>
          <given-names>Gustavo</given-names>
        </name>
        <!--gustavoc@msu.edu-->
        <aff><institution>Department of Epidemiology and Biostatistics, Michigan State University</institution>, East Lansing, MI 48824, <country country="US">USA</country></aff>
        <aff><institution>Department of Statistics and Probability, Michigan State University</institution>, East Lansing, MI 48824, <country country="US">USA</country></aff>
        <aff><institution>Institute for Quantitative Health Science and Engineering, Michigan State University</institution>, East Lansing, MI 48824, <country country="US">USA</country></aff>
        <xref rid="iyac112-cor1" ref-type="corresp"/>
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Chesler</surname>
          <given-names>E</given-names>
        </name>
        <role>Editor</role>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="iyac112-cor1">Corresponding author: Colegio de Postgraduados, Montecillos, Estado de México 56230, Mexico. Email: <email>perpdgo@gmail.com</email>; *Corresponding author: Department of Epidemiology and Biostatistics, Michigan State University, East Lansing, MI 48824, USA. Email: <email>gustavoc@msu.edu</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <month>9</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2022-08-04">
      <day>04</day>
      <month>8</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>04</day>
      <month>8</month>
      <year>2022</year>
    </pub-date>
    <volume>222</volume>
    <issue>1</issue>
    <elocation-id>iyac112</elocation-id>
    <history>
      <date date-type="accepted">
        <day>14</day>
        <month>7</month>
        <year>2022</year>
      </date>
      <date date-type="received">
        <day>11</day>
        <month>5</month>
        <year>2022</year>
      </date>
      <date date-type="corrected-typeset">
        <day>10</day>
        <month>8</month>
        <year>2022</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2022. Published by Oxford University Press on behalf of Genetics Society of America.</copyright-statement>
      <copyright-year>2022</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbyncndlicense">https://creativecommons.org/licenses/by-nc-nd/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution-NonCommercial-NoDerivs licence (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by-nc-nd/4.0/">https://creativecommons.org/licenses/by-nc-nd/4.0/</ext-link>), which permits non-commercial reproduction and distribution of the work, in any medium, provided the original work is not altered or transformed in any way, and that the work is properly cited. For commercial re-use, please contact journals.permissions@oup.com</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="iyac112.pdf"/>
    <abstract>
      <title>Abstract</title>
      <p>The BGLR-R package implements various types of single-trait shrinkage/variable selection Bayesian regressions. The package was first released in 2014, since then it has become a software very often used in genomic studies. We recently develop functionality for multitrait models. The implementation allows users to include an arbitrary number of random-effects terms. For each set of predictors, users can choose diffuse, Gaussian, and Gaussian–spike–slab multivariate priors. Unlike other software packages for multitrait genomic regressions, BGLR offers many specifications for (co)variance parameters (unstructured, diagonal, factor analytic, and recursive). Samples from the posterior distribution of the models implemented in the multitrait function are generated using a Gibbs sampler, which is implemented by combining code written in the R and C programming languages. In this article, we provide an overview of the models and methods implemented BGLR’s multitrait function, present examples that illustrate the use of the package, and benchmark the performance of the software.</p>
    </abstract>
    <kwd-group>
      <kwd>Bayesian</kwd>
      <kwd>high-dimensional regression</kwd>
      <kwd>multivariate models</kwd>
      <kwd>multitrait models</kwd>
      <kwd>Gibbs sampling</kwd>
      <kwd>genomic regressions</kwd>
      <kwd>pedigree regressions</kwd>
      <kwd>Genomic Prediction</kwd>
      <kwd>GenPred</kwd>
      <kwd>Shared Data Resource</kwd>
    </kwd-group>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>NIH</institution>
            <institution-id institution-id-type="DOI">10.13039/100000002</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>GM R01 101219</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Michigan State University</institution>
            <institution-id institution-id-type="DOI">10.13039/100007709</institution-id>
          </institution-wrap>
        </funding-source>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="12"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec sec-type="intro">
    <title>Introduction</title>
    <p>High-dimensional regression problems are ubiquitous in many research areas. To confront the “curse” of dimensionality, a common approach is to use regularized regression procedures such as penalized, reduced rank, or Bayesian methods. In genetics, the continued development of genotyping and sequencing technologies has led to the development of large volumes of genomic data. Genomic prediction (GP) models have been adopted in plant and animal breeding for genomic selection (GS) (<xref rid="iyac112-B25" ref-type="bibr">Meuwissen <italic toggle="yes">et al.</italic> 2001</xref>) and are used for complex trait prediction in human as well (<xref rid="iyac112-B9" ref-type="bibr">de los Campos <italic toggle="yes">et al.</italic> 2010</xref>; <xref rid="iyac112-B33" ref-type="bibr">Yang <italic toggle="yes">et al.</italic> 2010</xref>). Several software packages offer implementations to fit Bayesian (<xref rid="iyac112-B11" ref-type="bibr">de los Campos <italic toggle="yes">et al.</italic> 2013</xref>; <xref rid="iyac112-B28" ref-type="bibr">Pérez and de los Campos 2014</xref>) and non-Bayesian (<xref rid="iyac112-B14" ref-type="bibr">Friedman <italic toggle="yes">et al.</italic> 2010</xref>; <xref rid="iyac112-B13" ref-type="bibr">Endelman 2011</xref>) models for single-trait genomic models.</p>
    <p>In most genomic data set, genotypes are evaluated for multiple traits; likewise, in experimental settings genotypes are often evaluated in multiple environments. Thus, soon after GS received attention, it becomes clear that extensions to multitrait/multienvironment settings were needed (<xref rid="iyac112-B1" ref-type="bibr">Burgueño <italic toggle="yes">et al.</italic> 2012</xref>). Several software packages implement multivariate mixed-effects Gaussian models using likelihood/restricted maximum likelihood (REML) methods (<xref rid="iyac112-B15" ref-type="bibr">Gilmour <italic toggle="yes">et al.</italic> 1995</xref>; <xref rid="iyac112-B26" ref-type="bibr">Meyer 2007</xref>; <xref rid="iyac112-B23" ref-type="bibr">Lippert <italic toggle="yes">et al.</italic> 2014</xref>; <xref rid="iyac112-B5" ref-type="bibr">Covarrubias-Pazaran 2016</xref>) or within a Bayesian setting (<xref rid="iyac112-B19" ref-type="bibr">Hadfield 2010</xref>; <xref rid="iyac112-B3" ref-type="bibr">Cheng <italic toggle="yes">et al.</italic> 2018</xref>; <xref rid="iyac112-B27" ref-type="bibr">Montesinos-López <italic toggle="yes">et al.</italic> 2019</xref>). However, the extension of GP to multitrait settings within the context of Bayesian variable selection models is more challenging; thus, the availability of multitrait Bayesian variable selection models is much more limited. Within the open-source domain, we are only aware of 1 software package that implements multitrait Bayesian variable selection and shrinkage methods for the Julia language (<xref rid="iyac112-B3" ref-type="bibr">Cheng <italic toggle="yes">et al.</italic> 2018</xref>).</p>
    <p>The BGLR-R package (<xref rid="iyac112-B28" ref-type="bibr">Pérez and de los Campos 2014</xref>) was originally developed for single-trait models; recently, we developed the multitrait function, which implements shrinkage and variable selection models for multitrait analysis. The software combines features of the single-trait “BGLR” function (a similar user interface, and similar programming strategies, and similar default rules for setting hyperparameters) with some of the features of the MTM R package, a software that we developed and maintained in GitHub (<ext-link xlink:href="https://github.com/QuantGen/MTM" ext-link-type="uri">https://github.com/QuantGen/MTM</ext-link>) since 2013 (<xref rid="iyac112-B10" ref-type="bibr">de los Campos and Grueneberg 2013</xref>). MTM implements Bayesian Gaussian multivariate models with structured and unstructured (co)variance matrix using the methods described in <xref rid="iyac112-B8" ref-type="bibr">de los Campos and Gianola (2007)</xref>. However, MTM was fully developed using the R language and, thus, it does not scale for problems involving large numbers of samples. Moreover, MTM does not implement variable selection methods.</p>
    <p>In the multitrait function of the BGLR-R package, users can specify models for an arbitrary number of random effects. For each random effect, users can choose between diffuse, Gaussian, and spike–slab priors. For (co)variance parameters, the software offers the possibility of using either structured (e.g. diagonal, factor analytic, or recursive structures) or completely unstructured specifications. Inputs for each of the random effects could be relationship matrices (aka kernels, e.g. pedigree- or SNP-derived genomic relationship matrices), eigenvectors and eigenvalue values from those matrices, or numeric matrices, which would be used to provide SNP genotypes, factorizations of relationship matrices (e.g. scaled eigenvectors or Cholesky factors), environmental covariates, and other quantitative predictors. Importantly, the trait matrix can have arbitrary patterns of missing values.</p>
    <p>In what remains of this article, we describe the statistical models and the algorithms implemented in the multitrait function, present examples that illustrate the use of the software, and provide an overview of the computational time required for analyses involving various sample sizes, number of predictors (e.g. number of SNPs), and number of traits.</p>
  </sec>
  <sec>
    <title>Materials and methods</title>
    <p>The data equation of the multitrait function can include various types of effects, in matrix form, and the data equation can be represented as follows:
<disp-formula id="E1"><label>(1)</label><mml:math id="M1" display="block" overflow="scroll"><mml:mi mathvariant="bold">Y</mml:mi><mml:mo>=</mml:mo><mml:mn mathvariant="bold">1</mml:mn><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">μ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">′</mml:mi></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">X</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi mathvariant="bold">B</mml:mi></mml:mrow><mml:mrow><mml:mn mathvariant="bold">1</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">X</mml:mi></mml:mrow><mml:mrow><mml:mn mathvariant="bold">2</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi mathvariant="bold">B</mml:mi></mml:mrow><mml:mrow><mml:mn mathvariant="bold">2</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mo>⋯</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">U</mml:mi></mml:mrow><mml:mrow><mml:mn mathvariant="bold">1</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">U</mml:mi></mml:mrow><mml:mrow><mml:mn mathvariant="bold">2</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mo>⋯</mml:mo><mml:mo>+</mml:mo><mml:mi mathvariant="bold">E</mml:mi><mml:mo>,</mml:mo></mml:math></disp-formula>
where <inline-formula id="IE1"><mml:math id="IM1" display="inline" overflow="scroll"><mml:mi mathvariant="bold">Y</mml:mi></mml:math></inline-formula> is an <italic toggle="yes">n</italic> × <italic toggle="yes">t</italic> matrix (individuals in rows, traits in columns) of phenotypes (missing values are allowed), <inline-formula id="IE2"><mml:math id="IM2" display="inline" overflow="scroll"><mml:mi mathvariant="bold-italic">μ</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mfenced open="(" close=")" separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="italic">μ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="italic">μ</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mi>′</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula> is a vector of trait-specific intercepts, <inline-formula id="IE3"><mml:math id="IM3" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi mathvariant="bold">X</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">*</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is an incidence matrix for effects of a set of predictors (e.g. SNPs in columns), <inline-formula id="IE4"><mml:math id="IM4" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi mathvariant="bold">B</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">*</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is a matrix of effects (predictors in rows, effects on each of the traits in columns), <inline-formula id="IE5"><mml:math id="IM5" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi mathvariant="bold">U</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">*</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is a matrix of random effects (individuals in rows, traits in columns), and <inline-formula id="IE6"><mml:math id="IM6" display="inline" overflow="scroll"><mml:mi mathvariant="bold">E</mml:mi></mml:math></inline-formula> is a matrix with error terms (individuals in rows, traits in columns). The error terms are assumed to be independent and identically distributed (IID), each row following a multivariate normal (MVN) distribution with zero mean and covariance matrix <inline-formula id="IE7"><mml:math id="IM7" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi mathvariant="bold">R</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula>; therefore, the conditional distribution of the data given the regression parameters and the error covariance matrix is
<disp-formula id="E2"><label>(2)</label><mml:math id="M2" display="block" overflow="scroll"><mml:mi>p</mml:mi><mml:mo>(</mml:mo><mml:mi mathvariant="bold">Y</mml:mi><mml:mfenced open="|" separators="|"><mml:mrow><mml:mi mathvariant="bold-italic">θ</mml:mi></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mrow><mml:msubsup><mml:mo stretchy="false">∏</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mi mathvariant="italic">MVN</mml:mi><mml:mfenced open="(" close=")" separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">y</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">η</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">R</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:math> </disp-formula>
where <inline-formula id="IE8"><mml:math id="IM8" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">η</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi mathvariant="bold-italic">μ</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">B</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">′</mml:mi></mml:mrow></mml:msubsup><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">B</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">′</mml:mi></mml:mrow></mml:msubsup><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mo>⋯</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">u</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">u</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mo>⋯</mml:mo></mml:math></inline-formula>, where <inline-formula id="IE9"><mml:math id="IM9" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">η</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is a <italic toggle="yes">t</italic>-dimensional vector containing the conditional mean of the <italic toggle="yes">i</italic>th observation for each of the <italic toggle="yes">t</italic> traits, <inline-formula id="IE10"><mml:math id="IM10" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mrow><mml:mo>*</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> and <inline-formula id="IE11"><mml:math id="IM11" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">u</mml:mi></mml:mrow><mml:mrow><mml:mo>*</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> are the <italic toggle="yes">i</italic>th rows of the corresponding <inline-formula id="IE12"><mml:math id="IM12" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi mathvariant="bold">X</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">*</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> and <inline-formula id="IE13"><mml:math id="IM13" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi mathvariant="bold">U</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">*</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> matrices, and <inline-formula id="IE14"><mml:math id="IM14" display="inline" overflow="scroll"><mml:mi mathvariant="bold-italic">θ</mml:mi><mml:mo>=</mml:mo><mml:mfenced open="{" close="}" separators="|"><mml:mrow><mml:mi mathvariant="bold-italic">μ</mml:mi><mml:mo>,</mml:mo><mml:mi> </mml:mi><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">B</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">B</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">U</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">U</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">R</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:math></inline-formula>.</p>
    <sec>
      <title>Prior distribution</title>
      <p>The software assumes independent priors for each set of predictors; therefore,
<disp-formula id="E3"><label>(3)</label><mml:math id="M3" display="block" overflow="scroll"><mml:mi>p</mml:mi><mml:mfenced open="(" close=")" separators="|"><mml:mrow><mml:mi mathvariant="bold-italic">θ</mml:mi></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mi>p</mml:mi><mml:mfenced open="(" close=")" separators="|"><mml:mrow><mml:mi mathvariant="bold-italic">μ</mml:mi></mml:mrow></mml:mfenced><mml:mo>×</mml:mo><mml:mi>p</mml:mi><mml:mfenced open="(" close=")" separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">B</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>×</mml:mo><mml:mi>p</mml:mi><mml:mfenced open="(" close=")" separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">B</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>×</mml:mo><mml:mo>⋯</mml:mo><mml:mo>×</mml:mo><mml:mi>p</mml:mi><mml:mfenced open="(" close=")" separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">U</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>×</mml:mo><mml:mi>p</mml:mi><mml:mfenced open="(" close=")" separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">U</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>×</mml:mo><mml:mo>⋯</mml:mo><mml:mo>×</mml:mo><mml:mi mathvariant="normal"> </mml:mi><mml:mi>p</mml:mi><mml:mfenced open="(" close=")" separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">R</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>.</mml:mo></mml:math> </disp-formula></p>
      <p><italic toggle="yes">Intercepts</italic> are assigned diffuse priors <inline-formula id="IE15"><mml:math id="IM15" display="inline" overflow="scroll"><mml:mi>p</mml:mi><mml:mfenced separators="|"><mml:mi mathvariant="bold-italic">μ</mml:mi></mml:mfenced><mml:mo>=</mml:mo><mml:mi>MVN</mml:mi><mml:mo>(</mml:mo><mml:mn mathvariant="bold">0</mml:mn><mml:mo>,</mml:mo><mml:mi mathvariant="bold">I</mml:mi><mml:mi>m</mml:mi><mml:mo>)</mml:mo></mml:math></inline-formula>, with <inline-formula id="IE16"><mml:math id="IM16" display="inline" overflow="scroll"><mml:mi>m</mml:mi></mml:math></inline-formula> equal to 1,000 times the maximum of the variance of each of the phenotypes.</p>
      <p>The <italic toggle="yes">random-effects matrices</italic> <inline-formula id="IE17"><mml:math id="IM17" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="bold">U</mml:mi></mml:mrow><mml:mrow><mml:mi>*</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:math></inline-formula> are each assigned MVN distributions of the form
<disp-formula id="E4"><label>(4)</label><mml:math id="M4" display="block" overflow="scroll"><mml:mi>p</mml:mi><mml:mfenced open="(" close=")" separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">u</mml:mi></mml:mrow><mml:mrow><mml:mi>*</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mi mathvariant="normal">MVN</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">u</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">*</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:mn mathvariant="bold">0</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">Ω</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">*</mml:mi></mml:mrow></mml:msub><mml:mo>⊗</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">K</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">*</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo><mml:mo>,</mml:mo></mml:math> </disp-formula>
where <inline-formula id="IE18"><mml:math id="IM18" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi mathvariant="bold">u</mml:mi></mml:mrow><mml:mrow><mml:mi>*</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi mathvariant="normal">vec</mml:mi><mml:mfenced open="(" close=")" separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">U</mml:mi></mml:mrow><mml:mrow><mml:mi>*</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:math></inline-formula> is a vector with the columns of <inline-formula id="IE19"><mml:math id="IM19" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">U</mml:mi></mml:mrow><mml:mrow><mml:mi>*</mml:mi></mml:mrow></mml:msub><mml:mi> </mml:mi></mml:math></inline-formula>stacked, <inline-formula id="IE20"><mml:math id="IM20" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi mathvariant="bold">Ω</mml:mi></mml:mrow><mml:mrow><mml:mo>*</mml:mo></mml:mrow></mml:msub></mml:math></inline-formula> is a <italic toggle="yes">t</italic> × <italic toggle="yes">t</italic> (unknown) covariance matrix, <inline-formula id="IE21"><mml:math id="IM21" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">K</mml:mi></mml:mrow><mml:mrow><mml:mo>*</mml:mo></mml:mrow></mml:msub></mml:math></inline-formula> is a <italic toggle="yes">n</italic> × <italic toggle="yes">n</italic> covariance structure (e.g. a genomic relationship matrix), and <inline-formula id="IE22"><mml:math id="IM22" display="inline" overflow="scroll"><mml:mo>⊗</mml:mo></mml:math></inline-formula> is the Kronecker product operator (more information about the prior on <inline-formula id="IE23"><mml:math id="IM23" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi mathvariant="bold">Ω</mml:mi></mml:mrow><mml:mrow><mml:mo>*</mml:mo></mml:mrow></mml:msub><mml:mo> </mml:mo></mml:math></inline-formula>is provided below).</p>
      <p><italic toggle="yes">Regression coefficients</italic> <inline-formula id="IE24"><mml:math id="IM24" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi mathvariant="bold">B</mml:mi></mml:mrow><mml:mrow><mml:mi>*</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> can be either assigned MVN priors or priors from the spike–slab family. In the MVN prior,
<disp-formula id="E5"><label>(5)</label><mml:math id="M5" display="block" overflow="scroll"><mml:mi>p</mml:mi><mml:mfenced separators="|"><mml:msub><mml:mi mathvariant="bold-italic">B</mml:mi><mml:mi>*</mml:mi></mml:msub></mml:mfenced><mml:mo>=</mml:mo><mml:msubsup><mml:mo>∏</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mo>*</mml:mo></mml:msub></mml:msubsup><mml:mrow><mml:mi>MVN</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">b</mml:mi><mml:mrow><mml:mo>*</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:mn mathvariant="bold">0</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="bold">Ω</mml:mi><mml:mo>*</mml:mo></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:math> </disp-formula>
where <inline-formula id="IE25"><mml:math id="IM25" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">b</mml:mi></mml:mrow><mml:mrow><mml:mi>*</mml:mi><mml:mi mathvariant="bold-italic">j</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is the <italic toggle="yes">j</italic>th row of <inline-formula id="IE26"><mml:math id="IM26" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi mathvariant="bold">B</mml:mi></mml:mrow><mml:mrow><mml:mi>*</mml:mi></mml:mrow></mml:msub><mml:mi> </mml:mi></mml:math></inline-formula>and <inline-formula id="IE27"><mml:math id="IM27" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi mathvariant="bold">Ω</mml:mi></mml:mrow><mml:mrow><mml:mo>*</mml:mo></mml:mrow></mml:msub></mml:math></inline-formula> is a <italic toggle="yes">t</italic> × <italic toggle="yes">t</italic> (unknown) covariance matrix describing covariance among the effects of the <italic toggle="yes">j</italic>th predictor on each of the traits.</p>
      <p>For variable selection models, users can choose a multivariate spike–slab priors with a point of mass at zero and an MVN slab (this is one possible multivariate extension of the model known as BayesC in the animal breeding literature, e.g. <xref rid="iyac112-B18" ref-type="bibr">Habier <italic toggle="yes">et al.</italic> 2011</xref>). For the spike–slab prior, we represent each of the entries of <inline-formula id="IE28"><mml:math id="IM28" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi mathvariant="bold">B</mml:mi></mml:mrow><mml:mrow><mml:mi>*</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mo>=</mml:mo><mml:mi mathvariant="bold-italic">A</mml:mi></mml:mrow><mml:mrow><mml:mi>*</mml:mi></mml:mrow></mml:msub><mml:mo>#</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">D</mml:mi></mml:mrow><mml:mrow><mml:mi>*</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfenced open="{" close="}" separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">b</mml:mi></mml:mrow><mml:mrow><mml:mi>*</mml:mi><mml:mi mathvariant="bold-italic">jk</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">α</mml:mi></mml:mrow><mml:mrow><mml:mi>*</mml:mi><mml:mi mathvariant="bold-italic">jk</mml:mi></mml:mrow></mml:msub><mml:mo>×</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">d</mml:mi></mml:mrow><mml:mrow><mml:mi>*</mml:mi><mml:mi mathvariant="bold-italic">jk</mml:mi></mml:mrow></mml:msub><mml:mi> </mml:mi></mml:mrow></mml:mfenced></mml:math></inline-formula> as the product of a normal random variable (<inline-formula id="IE29"><mml:math id="IM29" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mo>α</mml:mo></mml:mrow><mml:mrow><mml:mo>*</mml:mo><mml:mi>j</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>) and a dummy variable (<inline-formula id="IE30"><mml:math id="IM30" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mo>*</mml:mo><mml:mi>j</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>) which controls whether the <italic toggle="yes">j</italic>th predictor enters in the equation for the <italic toggle="yes">k</italic>th trait; thus,
<disp-formula id="E6"><label>(6)</label><mml:math id="M6" display="block" overflow="scroll"><mml:mi>p</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:msub><mml:mi mathvariant="bold">A</mml:mi><mml:mi>*</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="bold">D</mml:mi><mml:mi>*</mml:mi></mml:msub></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mfenced open="{" close="}" separators="|"><mml:mrow><mml:msubsup><mml:mo>∏</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mi>*</mml:mi></mml:msub></mml:msubsup><mml:mrow><mml:mi>MVN</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">α</mml:mi><mml:mrow><mml:mi>*</mml:mi><mml:mi mathvariant="bold-italic">j</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:mn mathvariant="bold">0</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="bold">Ω</mml:mi><mml:mi>*</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfenced><mml:mo>×</mml:mo><mml:mfenced open="{" close="}" separators="|"><mml:mrow><mml:msubsup><mml:mo>∏</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mi>*</mml:mi></mml:msub></mml:msubsup><mml:msubsup><mml:mo>∏</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>t</mml:mi></mml:msubsup><mml:msubsup><mml:mi>π</mml:mi><mml:mrow><mml:mi>*</mml:mi><mml:mi>k</mml:mi></mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:mi>*</mml:mi><mml:mi>j</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:msubsup><mml:msup><mml:mrow><mml:mi> </mml:mi><mml:mfenced separators="|"><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mi>π</mml:mi><mml:mrow><mml:mi>*</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:mi>*</mml:mi><mml:mi>j</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup></mml:mrow></mml:mfenced><mml:mo>.</mml:mo></mml:math></disp-formula></p>
      <p>Above <inline-formula id="IE31"><mml:math id="IM31" display="inline" overflow="scroll"><mml:mo>{</mml:mo><mml:msub><mml:mrow><mml:mo>π</mml:mo></mml:mrow><mml:mrow><mml:mo>*</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mo>π</mml:mo></mml:mrow><mml:mrow><mml:mo>*</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mo>π</mml:mo></mml:mrow><mml:mrow><mml:mo>*</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>}</mml:mo></mml:math></inline-formula> represent the proportion of nonzero effects in each of the traits. By default, each of these parameters are treated as unknown and they are assigned independent Beta priors, that is: <inline-formula id="IE32"><mml:math id="IM32" display="inline" overflow="scroll"><mml:mi>p</mml:mi><mml:mfenced open="(" close=")" separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mo>π</mml:mo></mml:mrow><mml:mrow><mml:mo>*</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mo>π</mml:mo></mml:mrow><mml:mrow><mml:mo>*</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mo>π</mml:mo></mml:mrow><mml:mrow><mml:mo>*</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>∝</mml:mo><mml:mrow><mml:msubsup><mml:mo stretchy="false">∏</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:msubsup><mml:mrow><mml:mo>π</mml:mo></mml:mrow><mml:mrow><mml:mo>*</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mo>α</mml:mo></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msubsup><mml:msup><mml:mrow><mml:mfenced open="(" close=")" separators="|"><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mo>π</mml:mo></mml:mrow><mml:mrow><mml:mo>*</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mo>α</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula>, where <inline-formula id="IE33"><mml:math id="IM33" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mo>α</mml:mo></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula> and <inline-formula id="IE34"><mml:math id="IM34" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mo>α</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula> are the prior shape1 and shape2 parameters for the <italic toggle="yes">k</italic>th trait.</p>
      <p><xref rid="iyac112-T1" ref-type="table">Table 1</xref> describes for each type of random effects (<inline-formula id="IE35"><mml:math id="IM35" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi mathvariant="bold">X</mml:mi></mml:mrow><mml:mrow><mml:mi>*</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi mathvariant="bold">B</mml:mi></mml:mrow><mml:mrow><mml:mi>*</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> and <inline-formula id="IE36"><mml:math id="IM36" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi mathvariant="bold">U</mml:mi></mml:mrow><mml:mrow><mml:mi>*</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>) the priors implemented and how to specify it.</p>
      <table-wrap position="float" id="iyac112-T1">
        <label>Table 1.</label>
        <caption>
          <p>Specification of regression terms in the linear predictor.</p>
        </caption>
        <table frame="hsides" rules="groups">
          <colgroup span="1">
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="left" span="1"/>
          </colgroup>
          <thead>
            <tr>
              <th rowspan="1" colspan="1">Component</th>
              <th rowspan="1" colspan="1">Options</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td rowspan="1" colspan="1">Regression functions (<inline-formula id="IE37"><mml:math id="IM37" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi mathvariant="bold">X</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">*</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi mathvariant="bold">B</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">*</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:math></inline-formula></td>
              <td rowspan="1" colspan="1">
                <list list-type="simple">
                  <list-item>
                    <p>Diffuse prior: <monospace>list(X=,model=“FIXED”)</monospace></p>
                  </list-item>
                  <list-item>
                    <p>Gaussian: <monospace>list(X=,model=“BRR”,Cov=)</monospace></p>
                  </list-item>
                  <list-item>
                    <p>Spike–slab:</p>
                  </list-item>
                  <list-item>
                    <p>
                      <monospace>list(X=,model=“SpikeSlab”,</monospace>
                    </p>
                  </list-item>
                  <list-item>
                    <p>   <monospace>Cov=,inclusionProb=)</monospace></p>
                  </list-item>
                </list>
              </td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Random-intercept matrices (<inline-formula id="IE38"><mml:math id="IM38" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi mathvariant="bold">U</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">*</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:math></inline-formula></td>
              <td rowspan="1" colspan="1">
                <list list-type="simple">
                  <list-item>
                    <p><monospace>list(K=,model=“RKHS”,Cov=)</monospace>, or</p>
                  </list-item>
                  <list-item>
                    <p>
                      <monospace>list(EVD=,model=“RKHS”,Cov=)</monospace>
                    </p>
                  </list-item>
                  <list-item>
                    <p>Above, <monospace>EVD</monospace> is a list that contains 2 components, <monospace>vectors</monospace> a square matrix with eigen vectors of <monospace>K</monospace> and <monospace>values</monospace> a vector containing the eigen values of <monospace>K</monospace></p>
                  </list-item>
                </list>
              </td>
            </tr>
          </tbody>
        </table>
      </table-wrap>
      <p>Finally, for each of the <italic toggle="yes">covariance matrices</italic> involved in the model (<inline-formula id="IE39"><mml:math id="IM39" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">R</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula> and each of the <inline-formula id="IE40"><mml:math id="IM40" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi mathvariant="bold">Ω</mml:mi></mml:mrow><mml:mrow><mml:mo>*</mml:mo></mml:mrow></mml:msub></mml:math></inline-formula>) the software offers the option to modeled it as unstructured [in which case and Inverse-Wishart (IW) prior is used], or structured (with 3 options in this case, see <xref rid="iyac112-T2" ref-type="table">Table 2</xref>). Covariance structures are specified using a list, the entry <monospace>$type</monospace> of the list specifies the type of the structure (unstructured, diagonal, factor analytic structure, or recursive model, see <xref rid="iyac112-T2" ref-type="table">Table 2</xref>), other arguments include the hyperparameters for the structure (e.g. scale and degree of freedom parameters). In the case of recursive and Factor Analytic (FA) structures, an entry labeled as <monospace>M</monospace> (logical matrix) is also needed. For <monospace>FA</monospace> models this matrix must have dimensions <inline-formula id="IE41"><mml:math id="IM41" display="inline" overflow="scroll"><mml:mi>t</mml:mi><mml:mo> </mml:mo><mml:mo>×</mml:mo></mml:math></inline-formula> number of factors and each cell (<monospace>TRUE</monospace>/<monospace>FALSE</monospace>) indicates whether the trait (row) loads on the corresponding factor (column). For recursive models, the matrix <monospace>M</monospace> has dimensions <inline-formula id="IE42"><mml:math id="IM42" display="inline" overflow="scroll"><mml:mi>t</mml:mi><mml:mo>×</mml:mo><mml:mi>t</mml:mi></mml:math></inline-formula>, and the cells (also <monospace>TRUE</monospace>/<monospace>FALSE</monospace>) indicate whether the trait in column enters for the equation of the trait in row, typically the diagonal entries of <monospace>M</monospace> will be <monospace>FALSE</monospace>, except for simultaneous equation models, but this requires fixed-effects exclusion restrictions (e.g. <xref rid="iyac112-B16" ref-type="bibr">Goldberger 1972</xref>). Fully recursive models (those with an <monospace>M</monospace> matrix with <monospace>TRUE</monospace> in all cells below the diagonal and <monospace>FALSE</monospace> everywhere else) lead to an <monospace>UN</monospace> covariance matrix.</p>
      <table-wrap position="float" id="iyac112-T2">
        <label>Table 2.</label>
        <caption>
          <p>Covariance structures.</p>
        </caption>
        <table frame="hsides" rules="groups">
          <colgroup span="1">
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="left" span="1"/>
          </colgroup>
          <thead>
            <tr>
              <th rowspan="1" colspan="1">Structure</th>
              <th rowspan="1" colspan="1">Prior and hyperparameters</th>
              <th rowspan="1" colspan="1">Specification</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td rowspan="1" colspan="1">Unstructured</td>
              <td rowspan="1" colspan="1">
                <list list-type="simple">
                  <list-item>
                    <p><inline-formula id="IE43"><mml:math id="IM43" display="inline" overflow="scroll"><mml:mi mathvariant="bold">Ω</mml:mi><mml:mo>∼</mml:mo><mml:mi>I</mml:mi><mml:mi>W</mml:mi><mml:mo>(</mml:mo><mml:mi mathvariant="bold">Ω</mml:mi><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">S</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>d</mml:mi><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:math></inline-formula>;</p>
                  </list-item>
                  <list-item>
                    <p><inline-formula id="IE44"><mml:math id="IM44" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi mathvariant="bold">S</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>:</mml:mo><mml:mo> </mml:mo></mml:math></inline-formula>prior scale matrix <inline-formula id="IE45"><mml:math id="IM45" display="inline" overflow="scroll"><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>×</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:math></inline-formula></p>
                  </list-item>
                  <list-item>
                    <p><inline-formula id="IE46"><mml:math id="IM46" display="inline" overflow="scroll"><mml:mi>d</mml:mi><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula>: prior degree of freedom</p>
                  </list-item>
                </list>
              </td>
              <td rowspan="1" colspan="1">
                <monospace>Cov=list(type=“UN”, df0=,S0=)</monospace>
              </td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Diagonal</td>
              <td rowspan="1" colspan="1">
                <list list-type="simple">
                  <list-item>
                    <p><inline-formula id="IE47"><mml:math id="IM47" display="inline" overflow="scroll"><mml:mi mathvariant="bold">Ω</mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="normal">diag</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">ω</mml:mi></mml:mrow><mml:mrow><mml:mn>11</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">ω</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">tt</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:math></inline-formula>,</p>
                  </list-item>
                  <list-item>
                    <p>
                      <inline-formula id="IE48">
                        <mml:math id="IM48" display="inline" overflow="scroll">
                          <mml:mi>p</mml:mi>
                          <mml:mfenced open="(" close=")" separators="|">
                            <mml:mrow>
                              <mml:mi mathvariant="bold-italic">ω</mml:mi>
                            </mml:mrow>
                          </mml:mfenced>
                          <mml:mo>=</mml:mo>
                          <mml:mrow>
                            <mml:msubsup>
                              <mml:mo stretchy="false">∏</mml:mo>
                              <mml:mrow>
                                <mml:mi>k</mml:mi>
                                <mml:mo>=</mml:mo>
                                <mml:mn>1</mml:mn>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mi>t</mml:mi>
                              </mml:mrow>
                            </mml:msubsup>
                            <mml:mrow>
                              <mml:msup>
                                <mml:mrow>
                                  <mml:mo>χ</mml:mo>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mo>-</mml:mo>
                                  <mml:mn>2</mml:mn>
                                </mml:mrow>
                              </mml:msup>
                              <mml:mfenced open="(" close=")" separators="|">
                                <mml:mrow>
                                  <mml:msub>
                                    <mml:mrow>
                                      <mml:msub>
                                        <mml:mrow>
                                          <mml:mo>ω</mml:mo>
                                        </mml:mrow>
                                        <mml:mrow>
                                          <mml:mi>k</mml:mi>
                                          <mml:mi>k</mml:mi>
                                        </mml:mrow>
                                      </mml:msub>
                                      <mml:mo>|</mml:mo>
                                      <mml:mi>S</mml:mi>
                                    </mml:mrow>
                                    <mml:mrow>
                                      <mml:mn>0</mml:mn>
                                      <mml:mi>k</mml:mi>
                                      <mml:mi>k</mml:mi>
                                    </mml:mrow>
                                  </mml:msub>
                                  <mml:mo>,</mml:mo>
                                  <mml:mi>d</mml:mi>
                                  <mml:msub>
                                    <mml:mrow>
                                      <mml:mi>f</mml:mi>
                                    </mml:mrow>
                                    <mml:mrow>
                                      <mml:mn>0</mml:mn>
                                      <mml:mi>k</mml:mi>
                                    </mml:mrow>
                                  </mml:msub>
                                </mml:mrow>
                              </mml:mfenced>
                            </mml:mrow>
                          </mml:mrow>
                        </mml:math>
                      </inline-formula>
                    </p>
                  </list-item>
                  <list-item>
                    <p><inline-formula id="IE49"><mml:math id="IM49" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula>: prior scale vector <inline-formula id="IE50"><mml:math id="IM50" display="inline" overflow="scroll"><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>×</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:math></inline-formula>,</p>
                  </list-item>
                  <list-item>
                    <p><inline-formula id="IE51"><mml:math id="IM51" display="inline" overflow="scroll"><mml:mi>d</mml:mi><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>:</mml:mo><mml:mo> </mml:mo></mml:math></inline-formula>prior <italic toggle="yes">df</italic> vector <inline-formula id="IE52"><mml:math id="IM52" display="inline" overflow="scroll"><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>×</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:math></inline-formula></p>
                  </list-item>
                </list>
              </td>
              <td rowspan="1" colspan="1">
                <monospace>Cov=list(type=“DIAG”, df0=,S0=)</monospace>
              </td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Factor analytic</td>
              <td rowspan="1" colspan="1">
                <list list-type="simple">
                  <list-item>
                    <p><inline-formula id="IE53"><mml:math id="IM53" display="inline" overflow="scroll"><mml:mi mathvariant="bold">Ω</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="bold">WW</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">'</mml:mi></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:mi mathvariant="bold">Ψ</mml:mi></mml:math></inline-formula>; <inline-formula id="IE54"><mml:math id="IM54" display="inline" overflow="scroll"><mml:mi mathvariant="bold">W</mml:mi><mml:mo>:</mml:mo></mml:math></inline-formula> factor loadings, <inline-formula id="IE55"><mml:math id="IM55" display="inline" overflow="scroll"><mml:mi mathvariant="bold">Ψ</mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="normal">diag</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mo>ψ</mml:mo></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:math></inline-formula></p>
                  </list-item>
                  <list-item>
                    <p><inline-formula id="IE56"><mml:math id="IM56" display="inline" overflow="scroll"><mml:mi>p</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:mi mathvariant="bold-italic">W</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">Ψ</mml:mi></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mi>MVN</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:mi>vec</mml:mi><mml:mfenced separators="|"><mml:mi mathvariant="bold-italic">W</mml:mi></mml:mfenced><mml:mo>|</mml:mo><mml:mn mathvariant="bold">0</mml:mn><mml:mo>,</mml:mo><mml:msup><mml:mo>σ</mml:mo><mml:mn>2</mml:mn></mml:msup><mml:mi mathvariant="bold-italic">I</mml:mi></mml:mrow></mml:mfenced><mml:mo>×</mml:mo><mml:msubsup><mml:mo>∏</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>t</mml:mi></mml:msubsup><mml:msup><mml:mo>χ</mml:mo><mml:mrow><mml:mo>-</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mfenced separators="|"><mml:mrow><mml:msub><mml:mrow><mml:msub><mml:mo>ψ</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn><mml:mi>k</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>d</mml:mi><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:math></inline-formula>.</p>
                  </list-item>
                  <list-item>
                    <p><inline-formula id="IE57"><mml:math id="IM57" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula>: prior scale vector <inline-formula id="IE58"><mml:math id="IM58" display="inline" overflow="scroll"><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>×</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:math></inline-formula>,</p>
                  </list-item>
                  <list-item>
                    <p><inline-formula id="IE59"><mml:math id="IM59" display="inline" overflow="scroll"><mml:mi>d</mml:mi><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>:</mml:mo><mml:mo> </mml:mo></mml:math></inline-formula>prior <italic toggle="yes">df</italic> vector <inline-formula id="IE60"><mml:math id="IM60" display="inline" overflow="scroll"><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>×</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:math></inline-formula>; <inline-formula id="IE61"><mml:math id="IM61" display="inline" overflow="scroll"><mml:msup><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:math></inline-formula>: prior variance</p>
                  </list-item>
                </list>
              </td>
              <td rowspan="1" colspan="1">
                <monospace>Cov=list(type=“FA”,df0=,S0=, M=, var=)</monospace>
              </td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Recursive</td>
              <td rowspan="1" colspan="1">
                <list list-type="simple">
                  <list-item>
                    <p><inline-formula id="IE62"><mml:math id="IM62" display="inline" overflow="scroll"><mml:mi mathvariant="bold">Ω</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mfenced open="(" close=")" separators="|"><mml:mrow><mml:mi mathvariant="bold-italic">I</mml:mi><mml:mo>-</mml:mo><mml:mi mathvariant="bold-italic">W</mml:mi></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mi mathvariant="bold">Ψ</mml:mi><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mfenced open="(" close=")" separators="|"><mml:mrow><mml:mi mathvariant="bold-italic">I</mml:mi><mml:mo>-</mml:mo><mml:mi mathvariant="bold-italic">W</mml:mi></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>)</mml:mo><mml:mi>′</mml:mi></mml:math></inline-formula>,<inline-formula id="IE63"><mml:math id="IM63" display="inline" overflow="scroll"><mml:mo> </mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">W</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">t</mml:mi><mml:mo>×</mml:mo><mml:mi mathvariant="bold-italic">t</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> regression coefficients; <inline-formula id="IE64"><mml:math id="IM64" display="inline" overflow="scroll"><mml:mi mathvariant="bold">Ψ</mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="normal">diag</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mo>ψ</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="normal">kk</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:math></inline-formula>.</p>
                  </list-item>
                  <list-item>
                    <p>
                      <inline-formula id="IE65">
                        <mml:math id="IM65" display="inline" overflow="scroll">
                          <mml:mi>p</mml:mi>
                          <mml:mfenced separators="|">
                            <mml:mrow>
                              <mml:mi mathvariant="bold-italic">W</mml:mi>
                              <mml:mo>,</mml:mo>
                              <mml:mi mathvariant="bold-italic">Ψ</mml:mi>
                            </mml:mrow>
                          </mml:mfenced>
                          <mml:mo>=</mml:mo>
                          <mml:mi>MVN</mml:mi>
                          <mml:mfenced separators="|">
                            <mml:mrow>
                              <mml:mi>vec</mml:mi>
                              <mml:mfenced separators="|">
                                <mml:mi mathvariant="bold-italic">W</mml:mi>
                              </mml:mfenced>
                              <mml:mo>|</mml:mo>
                              <mml:mn mathvariant="bold">0</mml:mn>
                              <mml:mo>,</mml:mo>
                              <mml:msup>
                                <mml:mo>σ</mml:mo>
                                <mml:mn>2</mml:mn>
                              </mml:msup>
                              <mml:mi mathvariant="bold-italic">I</mml:mi>
                            </mml:mrow>
                          </mml:mfenced>
                          <mml:mo>×</mml:mo>
                          <mml:msubsup>
                            <mml:mo>∏</mml:mo>
                            <mml:mrow>
                              <mml:mi>k</mml:mi>
                              <mml:mo>=</mml:mo>
                              <mml:mn>1</mml:mn>
                            </mml:mrow>
                            <mml:mi>t</mml:mi>
                          </mml:msubsup>
                          <mml:msup>
                            <mml:mo>χ</mml:mo>
                            <mml:mrow>
                              <mml:mo>-</mml:mo>
                              <mml:mn>2</mml:mn>
                            </mml:mrow>
                          </mml:msup>
                          <mml:mfenced separators="|">
                            <mml:mrow>
                              <mml:msub>
                                <mml:mrow>
                                  <mml:msub>
                                    <mml:mo>ψ</mml:mo>
                                    <mml:mrow>
                                      <mml:mi>k</mml:mi>
                                      <mml:mi>k</mml:mi>
                                    </mml:mrow>
                                  </mml:msub>
                                  <mml:mo>|</mml:mo>
                                  <mml:mi>S</mml:mi>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mn>0</mml:mn>
                                  <mml:mi>k</mml:mi>
                                  <mml:mi>k</mml:mi>
                                </mml:mrow>
                              </mml:msub>
                              <mml:mo>,</mml:mo>
                              <mml:mi>d</mml:mi>
                              <mml:msub>
                                <mml:mi>f</mml:mi>
                                <mml:mrow>
                                  <mml:mn>0</mml:mn>
                                  <mml:mi>k</mml:mi>
                                </mml:mrow>
                              </mml:msub>
                            </mml:mrow>
                          </mml:mfenced>
                        </mml:math>
                      </inline-formula>
                    </p>
                  </list-item>
                  <list-item>
                    <p><inline-formula id="IE66"><mml:math id="IM66" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula>: prior scale vector <inline-formula id="IE67"><mml:math id="IM67" display="inline" overflow="scroll"><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>×</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:math></inline-formula>,</p>
                  </list-item>
                  <list-item>
                    <p><inline-formula id="IE68"><mml:math id="IM68" display="inline" overflow="scroll"><mml:mi>d</mml:mi><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>:</mml:mo><mml:mo> </mml:mo></mml:math></inline-formula>prior <italic toggle="yes">df</italic> vector <inline-formula id="IE69"><mml:math id="IM69" display="inline" overflow="scroll"><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>×</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:math></inline-formula>; <inline-formula id="IE70"><mml:math id="IM70" display="inline" overflow="scroll"><mml:msup><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:math></inline-formula>: prior variance.</p>
                  </list-item>
                </list>
              </td>
              <td rowspan="1" colspan="1">
                <monospace>Cov=list(type=“REC”,df0=,S0=, M=, var=)</monospace>
              </td>
            </tr>
          </tbody>
        </table>
      </table-wrap>
    </sec>
    <sec>
      <title>Default rules for hyperparameters</title>
      <p>To simplify the use of the software we have implemented default rules to set these parameters; therefore, when the user does not specify 1 or several of the hyperparameters involved in the model, the rules described in <xref rid="s1" ref-type="supplementary-material">Supplementary File 1</xref> are used to set default values. The hyperparameter values selected using these rules always lead to proper priors with scale parameters chosen considering the variance of the phenotype, the number of terms in the linear predictor, and the number of covariates in each of them.</p>
    </sec>
    <sec>
      <title>Algorithms</title>
      <p>The <italic toggle="yes">joint prior</italic> distribution of the model defined by expressions (2)–(6) does not have a closed form; however, with the likelihood and prior specifications used, all the fully conditionals have closed form; therefore, the software generates samples from the joint posterior distribution using a Gibbs sampler (e.g. <xref rid="iyac112-B2" ref-type="bibr">Casella and George 1992</xref>).</p>
      <p>In our implementation, most of the model unknowns are updated sampling from univariate fully conditionals; the only exception are the unstructured covariance matrices for which a sample for the matrix is obtained from an IW fully conditional. Describing each of the fully conditionals in detail is beyond the scope of this article; for location parameters (intercepts and regression coefficients), most of the fully conditional distributions are standard and have been previously described for Gaussian multitrait models with conjugate priors (e.g. <xref rid="iyac112-B30" ref-type="bibr">Sorensen and Gianola 2002</xref>). The fully conditional distribution of the parameters involved in structured covariance matrices are borrowed from <xref rid="iyac112-B8" ref-type="bibr">de los Campos and Gianola (2007)</xref>, and from the implementation of the MTM software (<xref rid="iyac112-B10" ref-type="bibr">de los Campos and Grueneberg 2013</xref>).</p>
      <p>Sampling regression coefficients (and the dummy variables (<inline-formula id="IE71"><mml:math id="IM71" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mo>*</mml:mo><mml:mi>j</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>) in the case of the terms with spike–slab priors) is computationally the most demanding step. Therefore, we update all these unknowns using a routine implemented in the C programming language (<xref rid="iyac112-B20" ref-type="bibr">Kernighan and Ritchie 1988</xref>). For hyperparameters and for covariance matrices, we collect samples using code implemented in the R language (<xref rid="iyac112-B29" ref-type="bibr">R Core Team 2019</xref>).</p>
      <sec>
        <title>Missing values</title>
        <p>The phenotype matrix (<bold>Y</bold> in (1)) can contain missing values (<monospace>NAs</monospace>); when this is the case, at each iteration of the sampler, the missing values are “imputed” with samples from the fully conditional distribution (see <xref rid="iyac112-B30" ref-type="bibr">Sorensen and Gianola 2002</xref>). Missing values in the linear predictor (e.g. <bold>X</bold> or <bold>K</bold> matrices) are not allowed.</p>
      </sec>
    </sec>
    <sec>
      <title>User interface and outputs</title>
      <p>The main arguments of the multitrait function are the phenotype matrix (<monospace>y</monospace>: a matrix of dimensions <inline-formula id="IE72"><mml:math id="IM72" display="inline" overflow="scroll"><mml:mi>n</mml:mi><mml:mo>×</mml:mo><mml:mi>t</mml:mi></mml:math></inline-formula>, where <inline-formula id="IE73"><mml:math id="IM73" display="inline" overflow="scroll"><mml:mi>n</mml:mi></mml:math></inline-formula> is the number of individuals and <inline-formula id="IE74"><mml:math id="IM74" display="inline" overflow="scroll"><mml:mi>t</mml:mi></mml:math></inline-formula> is the number of traits), the linear predictor (<monospace>ETA</monospace>: a 2-level list, each elements of the regression function (1), either a regression term of the form <inline-formula id="IE75"><mml:math id="IM75" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi mathvariant="bold">X</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">*</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi mathvariant="bold">B</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">*</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, or random intercepts (<inline-formula id="IE76"><mml:math id="IM76" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi mathvariant="bold">U</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">*</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:math></inline-formula>, see <xref rid="iyac112-T1" ref-type="table">Table 1</xref>), and error covariance structure (<monospace>resCov</monospace>: A list that specifies the structure and the hyperparameters for <inline-formula id="IE77"><mml:math id="IM77" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi mathvariant="bold">R</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula>). A complete list of arguments can be found in the help included in the package.</p>
      <p>The software returns a <monospace>list</monospace> with the estimated posterior means, estimated posterior deviations, together with all the elements of model specification (priors and hyperparameters). In the case of covariance matrices, only lower-triangular elements are stored; the corresponding matrices can be recreated using the function “xpnd,” also included originally in the MCMCpack package (<xref rid="iyac112-B24" ref-type="bibr">Martin <italic toggle="yes">et al.</italic> 2011</xref>).</p>
    </sec>
    <sec>
      <title>Data sets</title>
      <p>The BGLR-R package includes 2 data sets (these data sets were also included in earlier versions of the package). The wheat data set (<monospace>data(wheat)</monospace>) was first made available by <xref rid="iyac112-B6" ref-type="bibr">Crossa <italic toggle="yes">et al.</italic> (2010)</xref>. This data set contains least-square means (average of 2 years) of grain yield (<monospace>wheat.Y</monospace>) for 599 wheat lines which were evaluated in 4 environments, a kinship matrix derived from a pedigree (<monospace>wheat.A</monospace>) and 1,279 Diversity Array Technology markers (<monospace>wheat.X</monospace>, since these are inbreed lines, genotypes are coded as 0/1). The mice data set (<monospace>data(mice)</monospace>) comes from mice experiments conducted by the Wellcome Trust (<xref rid="iyac112-B31" ref-type="bibr">Valdar, Solberg, Gauguier, Burnett, <italic toggle="yes">et al.</italic> 2006</xref>; <xref rid="iyac112-B32" ref-type="bibr">Valdar, Solberg, Gauguier, Cookson, <italic toggle="yes">et al.</italic> 2006</xref>). The phenotypes consist of traits related to diabetes and biochemistry for 1,814 mice (<monospace>mice.pheno</monospace>), a kinship matrix derived from pedigree (<monospace>mice.A</monospace>) and 10,346 SNP markers (<monospace>mice.X</monospace>).</p>
    </sec>
  </sec>
  <sec sec-type="results">
    <title>Results</title>
    <p>In this section, we introduce examples of various models that can be implemented with the multitrait function. We present in the article snippets with concise scripts that illustrate how to fit models and how to retrieve results. The complete set of scripts used to simulate and analyze data is provided in an R-Markdown as a <xref rid="s1" ref-type="supplementary-material">Supplementary material</xref> and is also available at BGLR’s GitHub repository.</p>
    <sec>
      <title>Gaussian (kernel) models</title>
      <p>The example in <xref rid="iyac112-BOX1" ref-type="boxed-text">Box 1</xref> illustrates how to fit a single-kernel multitrait (GBLUP) model with unstructured (co)variance matrices. Lines 13–18 show how to retrieve parameter estimates and the corresponding posterior SD. The code in line 20 shows how to retrieve the predicted genomic values. Samples from the posterior distribution of model parameters can be found in files <monospace>UN_mu.dat</monospace> (intercepts), <monospace>UN_R.dat</monospace> (residual covariance matrix), and <monospace>UN_Omega_1.dat</monospace> (genomic covariance matrix). <xref rid="s2" ref-type="supplementary-material">Supplementary Box 1 (File 2)</xref> provides scripts that illustrate how to create trace plots and posterior samples for genetic and residual dispersion parameters and the resulting plots are shown in <xref rid="s3" ref-type="supplementary-material">Supplementary Figs. 1 and 2 (File 3)</xref>.
<boxed-text id="iyac112-BOX1" position="float"><caption><p> Box 1: Multitrait GBLUP with unstructured and structured covariances.</p></caption><p><monospace>1</monospace><monospace> </monospace><monospace>library(BGLR)</monospace></p><p><monospace>2</monospace><monospace> </monospace><monospace>data(wheat)</monospace></p><p><monospace>3</monospace><monospace> </monospace><monospace>K&lt;-tcrossprod(scale(wheat.X, center=TRUE))</monospace></p><p><monospace>4</monospace><monospace> </monospace><monospace>K</monospace>&lt;-<monospace>K/mean(diag(K))</monospace></p><p><monospace>5</monospace><monospace> </monospace><monospace>Y&lt;-wheat.Y # 4 traits</monospace></p><p><monospace>6</monospace><monospace> </monospace><monospace> </monospace></p><p><monospace>7</monospace><monospace> </monospace><monospace># Fitting a GBLUP un-structured cov-matrices</monospace></p><p><monospace>8</monospace><monospace>  </monospace><monospace>LP&lt;-list(mar=list(K</monospace> <monospace>=</monospace> <monospace>K, model=“RKHS”))</monospace></p><p><monospace>9</monospace><monospace>  </monospace><monospace>set.seed(123)</monospace></p><p><monospace>10</monospace><monospace>  </monospace><monospace>fmUN&lt;-Multitrait(y</monospace> <monospace>=</monospace> <monospace>Y, ETA=LP, nIter</monospace> <monospace>=</monospace> <monospace>10000, burnIn</monospace> <monospace>=</monospace> <monospace>5000,</monospace></p><p><monospace>11</monospace><monospace>            </monospace><monospace>saveAt=“UN_”,verbose=FALSE)</monospace></p><p><monospace>12</monospace><monospace> </monospace><monospace> </monospace></p><p><monospace>13</monospace><monospace> </monospace><monospace># Retrieving estimates and posterior SD</monospace></p><p><monospace>14</monospace><monospace>  </monospace><monospace>fmUN$resCov$R</monospace><monospace>   </monospace><monospace># residual covariance matrix</monospace></p><p><monospace>15</monospace><monospace>  </monospace><monospace>fmUN$resCov$SD.R</monospace></p><p><monospace>16</monospace><monospace> </monospace><monospace> </monospace></p><p><monospace>17</monospace><monospace>  </monospace><monospace>fmUN$ETA$mar$Cov$Omega</monospace><monospace>  </monospace><monospace># genomic covariance matrix</monospace></p><p><monospace>18</monospace><monospace>  </monospace><monospace>fmUN$ETA$mar$Cov$SD.Omega</monospace></p><p><monospace>19</monospace><monospace> </monospace><monospace> </monospace></p><p><monospace>20</monospace><monospace>  </monospace><monospace>fmUN$ETA$mar$u</monospace><monospace>       </monospace><monospace># predicted random effects</monospace></p></boxed-text>By default, the software fits unstructured (co)variance matrices; the examples in <xref rid="iyac112-BOX2" ref-type="boxed-text">Box 2</xref> illustrate how to specify structured covariance matrices. The first model (<monospace>fmRD</monospace>) uses a fully recursive model for the genomic covariance matrix and a diagonal structure for the error terms. In the recursive structure, there are regressions of traits 3 and 4 on trait 2 and of trait 4 on trait 3. This is specified with the matrix <monospace>M</monospace> (logical), which is used to specify recursions between traits. In the example, <monospace>M</monospace> is specified in a way that makes the genetic values of trait 1 independent from the genetic values on the other 3 traits (i.e. the resulting structure is block diagonal). The second example uses a 1-factor model for the genomic covariance matrix and a diagonal structure for the error terms (<monospace>fmFD</monospace>). The parameter <monospace>M</monospace>, which in this case links traits with common factors, links traits 2–4 with a common factor, thus, also leading to a block diagonal structure. In models with structured covariance matrices, the covariance matrices are nonlinear functions of the model parameters. For instance, in a GBLUP model with a FA structure for the genetic covariance, <inline-formula id="IE78"><mml:math id="IM78" display="inline" overflow="scroll"><mml:mi mathvariant="bold">Ω</mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="bold">W</mml:mi><mml:msup><mml:mrow><mml:mi mathvariant="bold">W</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">'</mml:mi></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:mi mathvariant="bold">Ψ</mml:mi></mml:math></inline-formula>; likewise, for a recursive model, the covariance matrix is <inline-formula id="IE79"><mml:math id="IM79" display="inline" overflow="scroll"><mml:mi mathvariant="bold">Ω</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mfenced open="(" close=")" separators="|"><mml:mrow><mml:mi mathvariant="bold-italic">I</mml:mi><mml:mo>-</mml:mo><mml:mi mathvariant="bold-italic">W</mml:mi></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mi mathvariant="bold">Ψ</mml:mi><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mfenced open="(" close=")" separators="|"><mml:mrow><mml:mi mathvariant="bold-italic">I</mml:mi><mml:mo>-</mml:mo><mml:mi mathvariant="bold-italic">W</mml:mi></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>)</mml:mo><mml:mi>′</mml:mi></mml:math></inline-formula> (see <xref rid="iyac112-T2" ref-type="table">Table 2</xref>). At each iteration of the sampler, the software computes these covariances and returns not only the posterior means of the parameters involved in the covariance structure (<inline-formula id="IE80"><mml:math id="IM80" display="inline" overflow="scroll"><mml:mi mathvariant="bold">W</mml:mi></mml:math></inline-formula>, <inline-formula id="IE81"><mml:math id="IM81" display="inline" overflow="scroll"><mml:mi mathvariant="bold">Ψ</mml:mi></mml:math></inline-formula> in the preceding examples), but also the posterior means of the corresponding covariance matrix (<inline-formula id="IE82"><mml:math id="IM82" display="inline" overflow="scroll"><mml:mi mathvariant="bold">Ω</mml:mi></mml:math></inline-formula>) (see lines 17–21 and 34–38). <xref rid="s2" ref-type="supplementary-material">Supplementary Boxes 2a and 2b (File 2)</xref> provide code that can be used to produce posterior plots and summaries of the parameters of recursive and FA covariance structures, the resulting plots are shown in <xref rid="s3" ref-type="supplementary-material">Supplementary Figs. 3–5 (File 3)</xref>. In genetic models, upon appropriate scaling, parameters <inline-formula id="IE83"><mml:math id="IM83" display="inline" overflow="scroll"><mml:mi mathvariant="bold">Ω</mml:mi></mml:math></inline-formula> and <inline-formula id="IE84"><mml:math id="IM84" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">R</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula> can be interpreted as genetic and environmental (co)variance components. However, we will discuss later in the document approaches drawn from <xref rid="iyac112-B22" ref-type="bibr">Lehermeier <italic toggle="yes">et al.</italic> (2017)</xref>, which account for linkage disequilibrium and yield estimates, which often have smaller biases than those of the posterior means of <inline-formula id="IE85"><mml:math id="IM85" display="inline" overflow="scroll"><mml:mi mathvariant="bold">Ω</mml:mi></mml:math></inline-formula> and <inline-formula id="IE86"><mml:math id="IM86" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">R</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula>.</p>
      <boxed-text id="iyac112-BOX2" position="float">
        <caption>
          <p> Box 2: Multitrait GBLUP with structured covariance matrices.</p>
        </caption>
        <p><monospace>1</monospace><monospace> </monospace><monospace>#(continued from</monospace> Box 1<monospace>)</monospace></p>
        <p>
          <monospace>2</monospace>
          <monospace> </monospace>
          <monospace> </monospace>
        </p>
        <p>
          <monospace>3</monospace>
          <monospace> </monospace>
          <monospace># Omega-recursive, R-diagonal</monospace>
        </p>
        <p>
          <monospace>4</monospace>
          <monospace> </monospace>
          <monospace># Matrix specifying loadings among traits 2=&gt;3,2=&gt;4,3=&gt;4</monospace>
        </p>
        <p><monospace>5</monospace><monospace>  </monospace><monospace>M1&lt;-matrix(nrow</monospace> <monospace>=</monospace> <monospace>4, ncol</monospace> <monospace>=</monospace> <monospace>4, FALSE)</monospace></p>
        <p>
          <monospace>6</monospace>
          <monospace>  </monospace>
          <monospace>M1[3,2]&lt;-M1[4,2]&lt;-M1[4,3]&lt;-TRUE</monospace>
        </p>
        <p>
          <monospace>7</monospace>
          <monospace>  </monospace>
          <monospace>CovREC&lt;-list(type=“REC”,M=M1)</monospace>
        </p>
        <p><monospace>8</monospace><monospace>  </monospace><monospace>LP&lt;-list(mar=list(K</monospace> <monospace>=</monospace> <monospace>K, model=“RKHS”,Cov=CovREC))</monospace></p>
        <p>
          <monospace>9</monospace>
          <monospace> </monospace>
          <monospace> </monospace>
        </p>
        <p>
          <monospace>10</monospace>
          <monospace> </monospace>
          <monospace> </monospace>
          <monospace>CovDIAG&lt;-list(type=“DIAG”)</monospace>
        </p>
        <p>
          <monospace>11</monospace>
          <monospace> </monospace>
          <monospace> </monospace>
        </p>
        <p>
          <monospace>12</monospace>
          <monospace> </monospace>
          <monospace> </monospace>
          <monospace>set.seed(456)</monospace>
        </p>
        <p><monospace>13</monospace><monospace> </monospace><monospace> </monospace><monospace>fmRD&lt;-Multitrait(y</monospace> <monospace>=</monospace> <monospace>Y, ETA=LP, nIter</monospace> <monospace>=</monospace> <monospace>10000, burnIn</monospace> <monospace>=</monospace> <monospace>5000,</monospace></p>
        <p>
          <monospace>14</monospace>
          <monospace> </monospace>
          <monospace>          </monospace>
          <monospace>resCov=CovDIAG, saveAt= “REC_DIAG_”,</monospace>
        </p>
        <p>
          <monospace>15</monospace>
          <monospace> </monospace>
          <monospace>          </monospace>
          <monospace>verbose=FALSE)</monospace>
        </p>
        <p>
          <monospace>16</monospace>
          <monospace> </monospace>
          <monospace> </monospace>
        </p>
        <p>
          <monospace>17</monospace>
          <monospace> </monospace>
          <monospace> </monospace>
          <monospace>fmRD$resCov$R</monospace>
        </p>
        <p>
          <monospace>18</monospace>
          <monospace> </monospace>
          <monospace> </monospace>
          <monospace>fmRD$ETA$mar$Cov$Omega</monospace>
          <monospace> </monospace>
          <monospace># genomic covariance</monospace>
        </p>
        <p>
          <monospace>19</monospace>
          <monospace> </monospace>
          <monospace> </monospace>
          <monospace>fmRD$ETA$mar$Cov$W</monospace>
          <monospace>    </monospace>
          <monospace># recursive effects</monospace>
        </p>
        <p>
          <monospace>20</monospace>
          <monospace> </monospace>
          <monospace> </monospace>
          <monospace>fmRD$ETA$mar$u</monospace>
          <monospace>      </monospace>
          <monospace># predicted genetic effects</monospace>
        </p>
        <p>
          <monospace>21</monospace>
          <monospace> </monospace>
          <monospace> </monospace>
          <monospace>fmRD$ETA$mar$Cov$PSI</monospace>
          <monospace>   </monospace>
          <monospace># scaling factors</monospace>
        </p>
        <p>
          <monospace>22</monospace>
          <monospace> </monospace>
          <monospace> </monospace>
        </p>
        <p>
          <monospace>23</monospace>
          <monospace> </monospace>
        </p>
        <p>
          <monospace>24</monospace>
          <monospace> </monospace>
          <monospace># Omega-FA(2), R-diagonal</monospace>
        </p>
        <p><monospace>25</monospace><monospace> </monospace><monospace> </monospace><monospace>M2&lt;-matrix(nrow</monospace> <monospace>=</monospace> <monospace>4, ncol</monospace> <monospace>=</monospace> <monospace>1, FALSE)</monospace></p>
        <p>
          <monospace>26</monospace>
          <monospace> </monospace>
          <monospace> </monospace>
          <monospace>M2[2:4,1]&lt;-TRUE</monospace>
        </p>
        <p>
          <monospace>27</monospace>
          <monospace> </monospace>
          <monospace> </monospace>
          <monospace>CovFA&lt;-list(type=“FA”,M=M2)</monospace>
        </p>
        <p><monospace>28</monospace><monospace> </monospace><monospace> </monospace><monospace>LP&lt;-list(mar=list(K</monospace> <monospace>=</monospace> <monospace>K, model=“RKHS”,Cov=CovFA))</monospace></p>
        <p>
          <monospace>29</monospace>
          <monospace> </monospace>
          <monospace> </monospace>
        </p>
        <p>
          <monospace>30</monospace>
          <monospace> </monospace>
          <monospace> </monospace>
          <monospace>set.seed(789)</monospace>
        </p>
        <p><monospace>31</monospace><monospace> </monospace><monospace> </monospace><monospace>fmFAD&lt;-Multitrait(y</monospace> <monospace>=</monospace> <monospace>Y, ETA=LP, nIter</monospace> <monospace>=</monospace> <monospace>10000, burnIn</monospace> <monospace>=</monospace> <monospace>5000,</monospace></p>
        <p>
          <monospace>32</monospace>
          <monospace> </monospace>
          <monospace>            </monospace>
          <monospace>resCov=CovDIAG, saveAt= “FA_DIAG_”,</monospace>
        </p>
        <p>
          <monospace>33</monospace>
          <monospace>            </monospace>
          <monospace>verbose=FALSE)</monospace>
        </p>
        <p>
          <monospace>34</monospace>
          <monospace> </monospace>
          <monospace> </monospace>
          <monospace>fmFAD$resCov$R</monospace>
        </p>
        <p>
          <monospace>35</monospace>
          <monospace> </monospace>
          <monospace> </monospace>
          <monospace>fmFAD$ETA$mar$Cov$Omega</monospace>
          <monospace> </monospace>
          <monospace># genomic covariance</monospace>
        </p>
        <p>
          <monospace>36</monospace>
          <monospace> </monospace>
          <monospace> </monospace>
          <monospace>fmFAD$ETA$mar$Cov$W</monospace>
          <monospace>   </monospace>
          <monospace># recursive effects</monospace>
        </p>
        <p>
          <monospace>37</monospace>
          <monospace> </monospace>
          <monospace> </monospace>
          <monospace>fmFAD$ETA$mar$u</monospace>
          <monospace>     </monospace>
          <monospace># predicted genetic effects</monospace>
        </p>
        <p>
          <monospace>38</monospace>
          <monospace> </monospace>
          <monospace> </monospace>
          <monospace>fmFAD$ETA$mar$Cov$PSI</monospace>
          <monospace> </monospace>
          <monospace># scaling factors</monospace>
        </p>
      </boxed-text>
    </sec>
    <sec>
      <title>Multikernel models</title>
      <p>The Gaussian models described above can be extended by adding fixed effects and other random effects (e.g. pedigree + SNP models). The scripts in <xref rid="s2" ref-type="supplementary-material">Supplementary Boxes 3a and 3b (File 2)</xref> implements a model with a genomic and a pedigree relationship matrix for the wheat data set, the script implements the unstructured and structured (diagonal, recursive, and FA) covariance matrices.</p>
    </sec>
    <sec>
      <title>Bayesian variable selection models</title>
      <p>We turn now into models using priors that can perform variable selection. To illustrate the use of these models, we simulated 3 traits using the genomes available in the mice data set (<monospace>data(mice)</monospace>). The script used to simulate data is presented in <xref rid="s2" ref-type="supplementary-material">Supplementary Box 4a (File 2)</xref>. Briefly, the simulation has a sample size of <inline-formula id="IE87"><mml:math id="IM87" display="inline" overflow="scroll"><mml:mi>n</mml:mi><mml:mo>=</mml:mo></mml:math></inline-formula> 1,814, and 1,000 SNPs, 12 of which had nonzero effect. Each trait had 6 QTL. Traits 1 and 3 had 3 “private” QTL and 3 shared with trait 2. All the QTL affecting trait 2 were shared with either trait 1 or trait 2. The trait heritabilities were 0.1, 0.05, and 0.1 for traits 1, 2, and 3, respectively. For illustration purposes, we present results from a single Monte Carlo replicate; we emphasize that assessing mapping power and FDR would require running multiple replicates and more complex simulation settings.</p>
      <p><xref rid="iyac112-BOX3" ref-type="boxed-text">Box 3</xref> shows how to fit a multitrait Bayesian regression model with a spike–slab prior. As before, <monospace>Y</monospace> is a matrix with traits in columns and subjects in rows, and <monospace>X</monospace> is a matrix with subjects in rows and SNPs in columns. For regression models, the multitrait function supports 3 priors (see <xref rid="iyac112-T1" ref-type="table">Table 1</xref>). The argument <monospace>saveEffects=TRUE</monospace> can be used to save the samples of effects into a binary file.
<boxed-text id="iyac112-BOX3" position="float"><caption><p> Box 3: Fitting a multitrait spike–slab model.</p></caption><p><monospace>1</monospace><monospace> </monospace><monospace># Run the code in Box S4a before runing this code</monospace></p><p><monospace>2</monospace><monospace> </monospace><monospace>fmSS&lt;-Multitrait(y</monospace> <monospace>=</monospace> <monospace>Y, ETA=list(list(X</monospace> <monospace>=</monospace> <monospace>X, model=”SpikeSlab”,</monospace></p><p><monospace>3</monospace><monospace> </monospace><monospace>         </monospace><monospace>saveEffects=TRUE)),nIter</monospace> <monospace>=</monospace> <monospace>12000, burnIn</monospace> <monospace>=</monospace> <monospace>2000,</monospace></p><p><monospace>4</monospace><monospace> </monospace><monospace>          </monospace><monospace>verbose=FALSE)</monospace></p></boxed-text><xref rid="iyac112-F1" ref-type="fig">Figure 1</xref> shows the posterior probability of inclusion by SNP and trait (the code used to produce the plot are given in <xref rid="s2" ref-type="supplementary-material">Supplementary Box 4b, File 2</xref>). The model correctly identified 8 of the 12 QTL. Trait 2 had the lowest heritability and the lowest proportion of QTL detected. Some QTL are not individually detected because of high LD in the QTL region. This happened, for example, for QTL2, which was located (position 99) in a region with high LD. In this region, there were 3 SNPs (position 99, 100, and 101) with elevated probability of inclusion in the QTL region. The <italic toggle="yes">R</italic>-squared between the causal variant and SNP 100 and 101 is 0.999 and 0.937. Clearly, when SNPs are in high LD, variable selection algorithms cannot discern which SNP is associated with the phenotype—this also happens in single-trait models. When this situation happens, there are at least 2 possible remedies: (1) filter SNPs based on LD or (2) use all the SNPs and make inferences using credible sets (i.e. groups of SNPs). For example, in the region in question (positions 99–101) the joint posterior probability of inclusion (i.e. the proportion of times that at least one of the SNPs in the region was active) was 99.75 (see code in <xref rid="s2" ref-type="supplementary-material">Supplementary Box 4c, File 2</xref>). Thus, for this region, we can be confident that there is an association with the phenotype, but we are uncertain as to which SNP has an effect.</p>
      <fig position="float" id="iyac112-F1">
        <label>Fig. 1.</label>
        <caption>
          <p>Posterior probability of nonzero effect by SNP and trait. Each dot/circle represents an SNP, red circles had posterior probability of inclusion greater than 0.8, and the dashed vertical lines show the position of the causal variants.</p>
        </caption>
        <graphic xlink:href="iyac112f1" position="float"/>
      </fig>
      <p>A more general approach to identify credible sets is demonstrated in <xref rid="s2" ref-type="supplementary-material">Supplementary Box 4d (File 2)</xref>. The function “segments” of the BGData R package (<xref rid="iyac112-B17" ref-type="bibr">Grueneberg and de los Campos 2019</xref>) is used to identify segments with local FDR smaller than 0.7 (that is SNP inclusion probability greater than 0.3), and then we used the samples from the posterior distribution to estimate the joint probability of inclusion of each segment (i.e. the probability that at least 1 SNP in the segment is active in the model). The result is a table with discoveries, which includes both individual SNP and credible sets and their posterior probability of inclusion.</p>
      <p>For comparison with the multitrait model, we fitted 4 separate single-trait models using the BayesC implementation available in BGLR function (see <xref rid="s2" ref-type="supplementary-material">Supplementary Box 4e, File 2</xref>). The results are presented in <xref rid="s3" ref-type="supplementary-material">Supplementary Fig. 6 (File 3)</xref>. The single-trait analysis identified 2 QTL less than the corresponding multitrait model. In particular, the single-trait model did not identify (from left to right) the 3rd QTL of trait 1 and the first QTL of trait 2; the last 1 was shared between traits 1 and 2. This example illustrates some potential benefits of using a multitrait model for mapping variants with pleiotropic effects; however, as we will see below, in some cases, single-trait models may be more powerful.</p>
      <p>The previous example used a stylized simulation, to illustrate the application of multitrait variable selection models in a more complex scenario, we used the function multitrait to map risk loci for 6 blood biomarkers (glucose, total cholesterol, HDL and LDL cholesterol, creatinine, and triglycerides) using the mice data set. The results are presented in <xref rid="s3" ref-type="supplementary-material">Supplementary Fig. 7</xref> and <xref rid="s3" ref-type="supplementary-material">Supplementary Table 1 (File 3)</xref>. In this case, the combination of small effects, small sample size, and high LD leads to no individual variants with a probability of inclusion greater than 0.8. However, for each of the biomarkers there are multiple regions with clearly elevated inclusion probabilities. Using the function “segments” of the BGData R package (<xref rid="iyac112-B17" ref-type="bibr">Grueneberg and de los Campos 2019</xref>), we identified 25 regions with joint posterior probability greater than 0.8 (<xref rid="s3" ref-type="supplementary-material">Supplementary Fig. 7, File 3</xref>). We identified 5 of such regions for glucose and 5 for HDL cholesterol, 9 regions for LDL cholesterol, 1 for creatinine, 3 regions for triglycerides, and 2 regions for total cholesterol. Some of the regions identified for different traits overlap (e.g. chromosome 1, mbp 89–98, chromosome 4, mbp 62–67, and chromosome 12, mbp 0–3) suggesting pleiotropy. For completeness, we also analyzed the same traits using single-trait models (<xref rid="s3" ref-type="supplementary-material">Supplementary Fig. 8, File 3</xref>); most of the regions with elevated posterior probability of inclusion detected using with the multitrait model also showed elevated posterior probability of inclusion in the single-trait models.</p>
      <p>We repeated the analysis of mice blood biomarkers using a sequence of 5 single-trait analyses using BGLR with a variable selection prior (BayesC) prior. Interestingly, the number of regions that cleared a joint inclusion probability of 0.8 was similar for glucose but more significant for the other traits (<xref rid="s2" ref-type="supplementary-material">Supplementary Table 2</xref> and <xref rid="s3" ref-type="supplementary-material">Supplementary Fig. 8, File 3</xref>). Overall, there was a substantial overlap in findings between the single-trait and multitrait analyses. However, many regions identified by the single-trait models were not identified by the multitrait analysis. Conversely, the single-trait model did not identify a few regions discovered through a multitrait analysis (<xref rid="s3" ref-type="supplementary-material">Supplementary Table 3, File 3</xref>). Because these analyses are based on real data, we cannot discern which discoveries were true and which ones are false discoveries. However, the example illustrates that multitrait analyses, which borrow information between traits, may not always lead to a higher power and more discoveries.</p>
    </sec>
    <sec>
      <title>Estimation of variance components</title>
      <p>Dissecting the phenotypic (co)variance into genetic and nongenetic components is an important goal of many genetic studies. Maximum likelihood, REML, and Bayesian estimates of (co)variance parameters are not guaranteed to be unbiased. In our experience, environmental (co)variances are often estimated with relatively small biases using the estimated posterior mean of <inline-formula id="IE88"><mml:math id="IM88" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi mathvariant="bold">R</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula>. However, this is not always the case for genetic (co)variances. There is an extensive literature on biases that may emerge when using genomic models to estimate genetic variances (e.g. <xref rid="iyac112-B12" ref-type="bibr">de los Campos <italic toggle="yes">et al.</italic> 2015</xref>; <xref rid="iyac112-B21" ref-type="bibr">Krishna Kumar <italic toggle="yes">et al.</italic> 2016</xref>; <xref rid="iyac112-B22" ref-type="bibr">Lehermeier <italic toggle="yes">et al.</italic> 2017</xref>). The amount of information at the likelihood about covariances is often smaller than the information provided for variances; therefore, presumably, there may be also sizable biases in estimate of genetic covariances.</p>
      <p>The literature on genetic (co)variance estimates is largely focused on GBLUP-type models; however, at least in principle, those parameters should be estimable in variable selection models. In this section, we present a simulation study in which we assess the bias of (co)variance estimates derived from multitrait GBLUP and spike–slab models. For residual covariance matrix, we use as estimator the posterior mean of <inline-formula id="IE89"><mml:math id="IM89" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi mathvariant="bold">R</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula>.</p>
      <p>For estimating genetic covariances in models not involving variable selection (e.g. “RKHS” or “BRR”) we consider 2 estimation methods: the posterior mean of the (co)variance parameter (<inline-formula id="IE90"><mml:math id="IM90" display="inline" overflow="scroll"><mml:mi mathvariant="bold">Ω</mml:mi></mml:math></inline-formula>, method 1) and a second method (method 2) based on an approach described in <xref rid="iyac112-B22" ref-type="bibr">Lehermeier <italic toggle="yes">et al.</italic> (2017)</xref>, which account for covariances between predictors (e.g. LD between SNPs). Briefly, for method 2, at each iteration of the sampler, we compute for each trait the vectors of genomic values (i.e. the columns of <inline-formula id="IE91"><mml:math id="IM91" display="inline" overflow="scroll"><mml:mi mathvariant="bold">U</mml:mi></mml:math></inline-formula> in GBLUP models or in regression on SNPs, <inline-formula id="IE92"><mml:math id="IM92" display="inline" overflow="scroll"><mml:mi mathvariant="bold">U</mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="bold">XB</mml:mi></mml:math></inline-formula>) and compute the sample covariance between the columns of <inline-formula id="IE93"><mml:math id="IM93" display="inline" overflow="scroll"><mml:mi mathvariant="bold">U</mml:mi></mml:math></inline-formula>.</p>
      <p>In models involving variable selection (“SpikeSlab”), only a fraction of the SNPs are active in the equation of each trait. Therefore, the (co)variance matrix of effects, <inline-formula id="IE94"><mml:math id="IM94" display="inline" overflow="scroll"><mml:mi mathvariant="normal">Cov</mml:mi><mml:mfenced open="(" close=")" separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">α</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mi mathvariant="bold">Ω</mml:mi></mml:math></inline-formula>, cannot be directly used to estimate the contribution of the regression. Therefore, to estimate genetic covariances in these models we consider 3 methods: method 1, at each iteration of the Gibbs sampler, we compute <inline-formula id="IE95"><mml:math id="IM95" display="inline" overflow="scroll"><mml:mi mathvariant="bold">B</mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="bold">A</mml:mi><mml:mo>#</mml:mo><mml:mi mathvariant="bold">D</mml:mi></mml:math></inline-formula> and then compute the sample covariance between the columns <inline-formula id="IE96"><mml:math id="IM96" display="inline" overflow="scroll"><mml:mi mathvariant="bold">B</mml:mi></mml:math></inline-formula>; the estimate is then the posterior mean of cov(<bold>B</bold>). For method 2, we computed genomic values (<inline-formula id="IE97"><mml:math id="IM97" display="inline" overflow="scroll"><mml:mi mathvariant="bold">U</mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="bold">XB</mml:mi></mml:math></inline-formula>) at each iteration of the sampling process and form there we computed the sample variance–covariance matrix of the realized genomic values (var(<bold>U</bold>)). This approach, which accounts for LD between markers, extends the method described for single-trait models by <xref rid="iyac112-B22" ref-type="bibr">Lehermeier <italic toggle="yes">et al.</italic> (2017)</xref> to multitrait analyses. Finally, we consider a 3rd method, which was proposed by <xref rid="iyac112-B4" ref-type="bibr">Cheng <italic toggle="yes">et al.</italic> (2018)</xref>. In method 3, at each iteration of the Gibbs sampler, we compute the following variance–covariance parameters:
<disp-formula id="E7"><mml:math id="M7" display="block" overflow="scroll"><mml:mfenced open="{" close="" separators="|"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:msub><mml:mrow><mml:mi mathvariant="bold">G</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn><mml:mi>k</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">c</mml:mi><mml:mo>×</mml:mo><mml:mi mathvariant="bold">Ω</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>×</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mtd><mml:mtd><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mrow><mml:mi mathvariant="bold">G</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn><mml:mi>k</mml:mi><mml:msup><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">'</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">c</mml:mi><mml:mo>×</mml:mo><mml:mi mathvariant="bold">Ω</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:msup><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">'</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msub><mml:mo>×</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:msup><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">'</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msub></mml:mtd><mml:mtd><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">'</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>;</mml:mo><mml:mi mathvariant="normal"> </mml:mi><mml:mi>k</mml:mi><mml:mo>≠</mml:mo><mml:msup><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">'</mml:mi></mml:mrow></mml:msup></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced><mml:mo>,</mml:mo></mml:math></disp-formula>
where <inline-formula id="IE98"><mml:math id="IM98" display="inline" overflow="scroll"><mml:mi mathvariant="normal">c</mml:mi></mml:math></inline-formula> is the sum of the variances of the markers (<inline-formula id="IE99"><mml:math id="IM99" display="inline" overflow="scroll"><mml:mi>c</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:msubsup><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mi mathvariant="normal">Var</mml:mi><mml:mfenced open="(" close=")" separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:mrow></mml:math></inline-formula>), <inline-formula id="IE100"><mml:math id="IM100" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is the proportion of markers with non-null effect on trait <inline-formula id="IE101"><mml:math id="IM101" display="inline" overflow="scroll"><mml:mi>k</mml:mi></mml:math></inline-formula> and <inline-formula id="IE102"><mml:math id="IM102" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:msup><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msub></mml:math></inline-formula> is the proportion of markers with non-null effects for traits <inline-formula id="IE103"><mml:math id="IM103" display="inline" overflow="scroll"><mml:mi>k</mml:mi></mml:math></inline-formula> and <inline-formula id="IE104"><mml:math id="IM104" display="inline" overflow="scroll"><mml:mi>k</mml:mi><mml:mi>′</mml:mi></mml:math></inline-formula>.</p>
      <p>We evaluated the bias of each of the estimation methods above described using 200 MC replicates of the simulation described in the previous section (see <xref rid="s2" ref-type="supplementary-material">Supplementary Box 4a</xref> for the simulation code, <xref rid="s2" ref-type="supplementary-material">File 2</xref>). The code for estimating genetic covariance matrixes is given in <xref rid="s2" ref-type="supplementary-material">Supplementary Box 5 (File 2)</xref>.</p>
      <p>The error (co)variance parameters were estimated without any noticeable bias by both the GBLUP and spike–slab model (<xref rid="iyac112-F2" ref-type="fig">Fig. 2a</xref>). The genetic variances were estimated with small biases by the GBLUP, with method 2 having slightly smaller bias than method 1 (<xref rid="iyac112-F2" ref-type="fig">Fig. 2b</xref>, see <xref rid="s3" ref-type="supplementary-material">Supplementary Table 4, File 3</xref> for average estimates and SEs). The spike–slab model gave estimates with noticeable bias with methods 1 and 3; however, these biases were reduced when method 2 was used. In summary, at least for this specific data set and simulation setting, it seems that regardless of the prior used, the residual (co)variance parameters can be estimated with small biases, and estimation of genetic (co)variances seem to be better with method 2.</p>
      <fig position="float" id="iyac112-F2">
        <label>Fig. 2.</label>
        <caption>
          <p>Average Monte Carlo estimates of error (a) and genetic (b) (co)variance parameter, by model and estimation method. The horizontal line gives the true parameter value (for SEs see <xref rid="s3" ref-type="supplementary-material">Supplementary Table 4, File 3</xref>).</p>
        </caption>
        <graphic xlink:href="iyac112f2" position="float"/>
      </fig>
    </sec>
    <sec>
      <title>Prediction</title>
      <p>For the entries of the phenotype matrix containing missing values, at each iteration of the sampler, the software samples the missing phenotypes from the corresponding fully conditional distributions (which in the models implemented is MVN). This process leads to inferences that average over possible values of the missing phenotypes. To make the sampling of missing phenotypes more efficient, we identify missing value patterns and impute them (with samples) jointly (<monospace>missing_patterns</monospace> contain the patterns identified and labeled <monospace>missing_records</monospace> indicate the rows of Y, which map to each of the patterns).</p>
      <p>The multitrait function returns estimates of the posterior mean of the linear predictor (<inline-formula id="IE105"><mml:math id="IM105" display="inline" overflow="scroll"><mml:mi mathvariant="bold-italic">η</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">μ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">′</mml:mi></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">X</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi mathvariant="bold">B</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">X</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi mathvariant="bold">B</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mo>⋯</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">U</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">U</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mo>⋯</mml:mo><mml:mo>+</mml:mo></mml:math></inline-formula>, named <monospace>ETAHat</monospace> in the returned object), these are estimates of the expected value of the phenotypes given the predictors. <xref rid="iyac112-BOX4" ref-type="boxed-text">Box 4</xref> shows how to retrieve these predictions (the missing value patterns in <monospace>YNa</monospace> were generated using the script in <xref rid="s2" ref-type="supplementary-material">Supplementary Box 6, File 2</xref>). The plot in <xref rid="iyac112-F3" ref-type="fig">Fig. 3</xref> shows the simulated phenotype vs the posterior mean of for entries that were observed and missing, using trait 3 as an example (see <xref rid="s2" ref-type="supplementary-material">Supplementary Box 6, File 2</xref>).</p>
      <boxed-text id="iyac112-BOX4" position="float">
        <caption>
          <p> Box 4: Prediction.</p>
        </caption>
        <p>
          <monospace>1</monospace>
          <monospace> </monospace>
          <monospace> </monospace>
        </p>
        <p>
          <monospace>2</monospace>
          <monospace> </monospace>
          <monospace>K&lt;-tcrossprod(X)</monospace>
        </p>
        <p>
          <monospace>3</monospace>
          <monospace> </monospace>
          <monospace>K&lt;-K/mean(diag(K))</monospace>
        </p>
        <p>
          <monospace>4</monospace>
          <monospace> </monospace>
          <monospace> </monospace>
        </p>
        <p><monospace>5</monospace><monospace> </monospace><monospace>LP&lt;-list(list(K</monospace> <monospace>=</monospace> <monospace>K, model=“RKHS”))</monospace></p>
        <p>
          <monospace>6</monospace>
          <monospace> </monospace>
          <monospace> </monospace>
        </p>
        <p>
          <monospace>7</monospace>
          <monospace> </monospace>
          <monospace>#Fit multivariate GBLUP with UN-structured covariance matrixes</monospace>
        </p>
        <p><monospace>8</monospace><monospace> </monospace><monospace>fmG&lt;-Multitrait(y=YNa, ETA=LP, nIter</monospace> <monospace>=</monospace> <monospace>10000, burnIn</monospace> <monospace>=</monospace> <monospace>5000, thin</monospace> <monospace>=</monospace> <monospace>10,</monospace></p>
        <p>
          <monospace>9</monospace>
          <monospace>       </monospace>
          <monospace>verbose=FALSE)</monospace>
        </p>
        <p>
          <monospace>10</monospace>
          <monospace> </monospace>
          <monospace> </monospace>
        </p>
        <p>
          <monospace>11</monospace>
          <monospace> </monospace>
          <monospace>#Missing values for trait 3</monospace>
        </p>
        <p>
          <monospace>12</monospace>
          <monospace> </monospace>
          <monospace>whichNa3&lt;-fmG$missing_records[fmG$patterns[ , 3]]</monospace>
        </p>
        <p>
          <monospace>13</monospace>
          <monospace> </monospace>
          <monospace>Y[whichNa3,3]</monospace>
          <monospace>      </monospace>
          <monospace>#Observed values</monospace>
        </p>
        <p>
          <monospace>14</monospace>
          <monospace> </monospace>
          <monospace>fmG$ETAHat[whichNa3,3]</monospace>
          <monospace> </monospace>
          <monospace>#Predicted values</monospace>
        </p>
      </boxed-text>
      <fig position="float" id="iyac112-F3">
        <label>Fig. 3.</label>
        <caption>
          <p>Predicted (posterior mean of the linear predictor) vs observed phenotypes for trait 3 (see <xref rid="s2" ref-type="supplementary-material">Supplementary Box 6, File 2</xref>).</p>
        </caption>
        <graphic xlink:href="iyac112f3" position="float"/>
      </fig>
    </sec>
    <sec>
      <title>Benchmark</title>
      <p>We evaluated the computational time it takes for the multitrait function to generate 1,000 posterior samples for data sets with a sample size ranging from 10,000 to 500,000 individuals and with 5,000 to 50,000 SNPs. The data used for this benchmark were from the UK-Biobank; we fitted models to 2 and 4 traits (body mass index total cholesterol, glucose, and height, all adjusted by sex, age, center, and 10 SNP-derived PCs) using either Gaussian or spike–slab priors. The analyses were performed in MSU’s high-performance computing cluster using nodes equipped with Intel Xeon Gold 6148 processors at 2.40 GHz. We used R 4.2.0 compiled from source and the reference BLAS implementation was substituted with OpenBLAS version 0.3.17 (<ext-link xlink:href="https://www.openblas.net" ext-link-type="uri">https://www.openblas.net</ext-link>). Jobs were run using 4 computing threads. To benchmark our software, we compared the computational performance of BGLR’s multitrait function with that of Julia’s JWAS package (<xref rid="iyac112-B3" ref-type="bibr">Cheng <italic toggle="yes">et al.</italic> 2018</xref>), which also uses OpenBLAS for matrix operations. We provide the scripts to produce the benchmarks in the case of a Gaussian prior in <xref rid="s2" ref-type="supplementary-material">Supplementary Boxes 7 and 8 (File 2)</xref>.</p>
      <p><xref rid="iyac112-F4" ref-type="fig">Figure 4</xref> shows the time (in minutes) required to generate 1,000 Gibbs samples for models using variable selection priors. We found that JWAS performed slightly better using just 1 thread; therefore, the results in <xref rid="iyac112-F4" ref-type="fig">Fig. 4</xref> are for multitrait running with 4 threads and JWAS running with 1 thread (for results with both software using 4 threads, see <xref rid="s3" ref-type="supplementary-material">Supplementary Fig. 9, File 3</xref>). Both software scaled approximately linearly with sample size, but the slope of the lines representing computational time vs sample size was smaller for the multitrait function. Likewise, while in both packages, the computational time increased with the number of traits, the increase in computational time that occurred when increasing the number of traits from 2 to 4 was more important for JWAS. The results for models using a Gaussian prior are presented in <xref rid="s3" ref-type="supplementary-material">Supplementary Figs. 10 and 11 (File 3)</xref>. The overall trends were very similar to those obtained with the variable selection priors (<xref rid="iyac112-F4" ref-type="fig">Fig. 4</xref>).</p>
      <fig position="float" id="iyac112-F4">
        <label>Fig. 4.</label>
        <caption>
          <p>Average time (in minutes, ± SD) to collect 1,000 posterior samples for variable selection models, by the number of SNPs (panels), the number of traits (horizontal axis), and the software used. Results for Gaussian prior are presented in <xref rid="s3" ref-type="supplementary-material">Supplementary Figs. 10 and 11 (File 3)</xref>.</p>
        </caption>
        <graphic xlink:href="iyac112f4" position="float"/>
      </fig>
      <p>The computational time required for implementing a GBLUP (or any other kernel model) depends on sample size, this without considering the time it takes to compute the genomic relationship matrix. The BGLR and multitrait functions fit GBLUP model by first factorizing kernel matrices using an eigenvalue decomposition; then, the software runs a random regression (with Gaussian IID priors) on the scaled eigenvectors (<xref rid="iyac112-B7" ref-type="bibr">de los Campos <italic toggle="yes">et al.</italic> 2009</xref>). Therefore, the computational time it takes to collect samples for kernel models is the same as the computing time it takes for a Gaussian model with a sample size of <italic toggle="yes">n</italic> and <italic toggle="yes">n</italic> SNPs (which can be inferred from the results just presented), plus the time it takes to factorize the genomic relationship matrix. We present in <xref rid="s3" ref-type="supplementary-material">Supplementary Fig. 12 (File 3)</xref> the computational time required to perform eigenvalue decomposition. The computational time increases exponentially with the dimensions of the kernel matrix; for 30,000 subjects it took approximately 25 min to compute the eigenvalue decomposition. In general, the option of using a genomic relationship matrix is recommended (relative to an equivalent model implemented as a random regression on SNPs) only when <italic toggle="yes">n</italic> is not too large, and sample size is considerably smaller than the number of SNPs.</p>
    </sec>
  </sec>
  <sec sec-type="discussion">
    <title>Discussion</title>
    <p>We presented the newly developed multitrait function of the BGLR-R package. The software allows the user to include fixed effects (i.e. effects with a diffuse prior), shrinkage, and variable selection priors in multitrait models. These methods can be used to fit models commonly used in genomic analysis of complex traits, including parametric genomic and pedigree models, variable selection models, and semiparametric regressions (e.g. RKHS). The interface allows users to specify models with multiple terms, each having their own priors.</p>
    <p>The architecture of the software was designed to take advantage of interpreted code written in R and compiled code written in C. The MCMC algorithms (Metropolis and Gibbs sampler) implemented are computationally intensive. We make an effort to optimize computations without losing much flexibility in terms of the types of models that users can implement. As a result, the software can be used with a very large sample size, large numbers of SNPs, and multiple traits. However, users must be aware that the computational time grows linearly with sample size and with the number of SNPs; thus, fitting models to very large data sets and hundreds of thousands of SNPs will have a very high memory requirement and it will be time consuming. The programming strategy we adopted makes intensive use of level-1 BLAS functions “ddot” and “daxpy.” For large problems, we strongly recommend using an optimized version of BLAS for the hardware and running the software on multiple threads.</p>
    <p>The possibility of specifying structured (co)variance matrices for both Gaussian and variable selection priors is a distinctive feature of multitrait. Users should be aware that priors on (co)variance matrices can be influential; this is particularly the case of the IW prior, which can be highly influential if sample size is small, and the number of traits is large. To remediate this problem, we described in this study an approach (referred as to method 2 in <xref rid="iyac112-F2" ref-type="fig">Fig. 2</xref>) for estimating the variances and covariances that are less influenced by the prior; however, even with this approach, the IW prior can be influential. This method, which extend the ideas discussed in <xref rid="iyac112-B22" ref-type="bibr">Lehermeier <italic toggle="yes">et al.</italic> (2017)</xref> to multitrait models, accounts for the contribution of linkage disequilibrium to (co)variance and, importantly, can be used with any prior (including diffuse, Gaussian, and variable selection priors). Another approach that may be less influential is to use a fully recursive model which also leads to an unstructured (co)variance matrix. In this case, the prior specification involves defining priors over variances and over recursive effects. The priors on the recursive effects (which in the multitrait are by default Gaussian) can be made effectively diffuse and this may lead to less influence of the prior on inferences.</p>
    <p>Although the software was originally developed for genomic and pedigree model, like BGLR, the multitrait function can also be used to implement models for other omics (including metabolomic, microbiome, and gene expression data) and environmental information (e.g. models for environmental covariates). We look forward to continuing improving BGLR and welcome users’ feedback. Future updates will be shared in BGLR’s GitHub repository (<ext-link xlink:href="https://github.com/gdlc/BGLR-R" ext-link-type="uri">https://github.com/gdlc/BGLR-R</ext-link>) and in the CRAN (<ext-link xlink:href="https://cran.r-project.org/web/packages/BGLR/index.html" ext-link-type="uri">https://cran.r-project.org/web/packages/BGLR/index.html</ext-link>).</p>
    <p>The reader may wonder: For what problems, or under what conditions, is a multitrait analysis preferred relative to a sequence of single-trait analyses? Of course, the answer to that question is problem specific; however, some guidelines can be provided for parameter estimation, mapping, and prediction problems. Obviously, multitrait analyses are needed to estimate genetic and environmental correlations between traits (or environments).</p>
    <p>Depending on the problem, the multitrait model may offer higher or lower power than the single-trait analysis. Standard multitrait models assume a homogeneous covariance of effects across the genome. In regions of the genome where the correlation of effects aligns with the average correlation of effects of the genome, borrowing information between traits may increase power. However, in regions where the correlation of effects is markedly different than the average correlation of effects in the genome, the multitrait model may reduce power because multitrait models tend to shrink effects toward a common covariance pattern. Variable selection priors may mitigate this problem because the model, as implemented in the multitrait function, has separate variable selection dummy variables for each SNP-trait combination. This allows for an SNP to affect some traits but not others. However, even considering the flexibility that variable selection priors offer for mapping, we strongly encourage considering both the multitrait and the single-trait models.</p>
    <p>For GP, there is evidence showing that for some prediction problems (<xref rid="iyac112-B1" ref-type="bibr">Burgueño <italic toggle="yes">et al.</italic> 2012</xref>), the multitrait model can offer higher prediction accuracy than predictions derived from single-trait models. The superiority of the multitrait model over single-trait analyses occurs when the prediction problem enables borrowing of information within-subject between traits and environments. This happens, for example, when predicting genetic values for an unmeasured trait for individuals with records for other traits (or environments, this was labeled as CV2 in <xref rid="iyac112-B1" ref-type="bibr">Burgueño <italic toggle="yes">et al.</italic> 2012</xref>). On the other hand, for the prediction of genetic values for subjects that do not have any records (labeled as CV1 in <xref rid="iyac112-B1" ref-type="bibr">Burgueño <italic toggle="yes">et al.</italic> 2012</xref>), multitrait models do not consistently outperform predictions derived from single-trait models.</p>
  </sec>
  <sec sec-type="data-availability">
    <title>Data availability</title>
    <p>The data sets are included with the BGLR package, which is freely available in the CRAN website, <ext-link xlink:href="https://cran.r-project.org/web/packages/BGLR/index.html" ext-link-type="uri">https://cran.r-project.org/web/packages/BGLR/index.html</ext-link> and also in our GitHub web site, <ext-link xlink:href="https://github.com/gdlc/BGLR-R" ext-link-type="uri">https://github.com/gdlc/BGLR-R</ext-link>.</p>
    <p><xref rid="s1" ref-type="supplementary-material">Supplemental material</xref> is available at <italic toggle="yes">GENETICS</italic> online.</p>
  </sec>
  <sec>
    <title>Funding</title>
    <p>The development and maintenance of BGLR has been founded by NIH grant GM R01 101219. The authors also acknowledge financial support from Michigan State University.</p>
  </sec>
  <sec>
    <title>Conflicts of interest</title>
    <p>None declared.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="s1" position="float" content-type="local-data">
      <label>iyac112_Supplementary_Data_File_S1</label>
      <media xlink:href="iyac112_supplementary_data_file_s1.docx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="s2" position="float" content-type="local-data">
      <label>iyac112_Supplementary_Data_File_S2</label>
      <media xlink:href="iyac112_supplementary_data_file_s2.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="s3" position="float" content-type="local-data">
      <label>iyac112_Supplementary_Data_File_S3</label>
      <media xlink:href="iyac112_supplementary_data_file_s3.docx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ref-list id="ref1">
    <title>Literature cited</title>
    <ref id="iyac112-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Burgueño</surname><given-names>J</given-names></string-name>, <string-name><surname>de los Campos</surname><given-names>G</given-names></string-name>, <string-name><surname>Weigel</surname><given-names>K</given-names></string-name>, <string-name><surname>Crossa</surname><given-names>J.</given-names></string-name></person-group><article-title>Genomic prediction of breeding values when modeling genotype × environment interaction using pedigree and dense molecular markers</article-title>. <source>Crop Sci</source>. <year>2012</year>;<volume>52</volume>(<issue>2</issue>):<fpage>707</fpage>–<lpage>719</lpage>. <pub-id pub-id-type="doi">10.2135/cropsci2011.06.0299</pub-id>.</mixed-citation>
    </ref>
    <ref id="iyac112-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Casella</surname><given-names>G</given-names></string-name>, <string-name><surname>George</surname><given-names>EI.</given-names></string-name></person-group><article-title>Explaining the Gibbs sampler</article-title>. <source>Am Stat</source>. <year>1992</year>;<volume>46</volume>(<issue>3</issue>):<fpage>167</fpage>–<lpage>174</lpage>. <pub-id pub-id-type="doi">10.1080/00031305.1992.10475878</pub-id>.</mixed-citation>
    </ref>
    <ref id="iyac112-B3">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Cheng</surname><given-names>H</given-names></string-name>, <string-name><surname>Fernando</surname><given-names>R</given-names></string-name>, <string-name><surname>Garrick</surname><given-names>D.</given-names></string-name></person-group><year>2018</year>. JWAS: Julia implementation of whole-genome analyses software. Proceedings of the World Congress on Genetics Applied to Livestock Production Methods and Tools-Software. <fpage>859</fpage>.</mixed-citation>
    </ref>
    <ref id="iyac112-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Cheng</surname><given-names>H</given-names></string-name>, <string-name><surname>Kizilkaya</surname><given-names>K</given-names></string-name>, <string-name><surname>Zeng</surname><given-names>J</given-names></string-name>, <string-name><surname>Garrick</surname><given-names>D</given-names></string-name>, <string-name><surname>Fernando</surname><given-names>R.</given-names></string-name></person-group><article-title>Genomic prediction from multiple-trait Bayesian regression methods using mixture priors</article-title>. <source>Genetics</source>. <year>2018</year>;<volume>209</volume>(<issue>1</issue>):<fpage>89</fpage>–<lpage>103</lpage>. <pub-id pub-id-type="doi">10.1534/genetics.118.300650</pub-id>.<pub-id pub-id-type="pmid">29514861</pub-id></mixed-citation>
    </ref>
    <ref id="iyac112-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Covarrubias-Pazaran</surname><given-names>G.</given-names></string-name></person-group><article-title>Genome-assisted prediction of quantitative traits using the R Package Sommer</article-title>. <source>PLoS One</source>. <year>2016</year>;<volume>11</volume>(<issue>6</issue>):<fpage>e0156744</fpage>. <pub-id pub-id-type="doi">10.1371/journal.pone.0156744</pub-id>.<pub-id pub-id-type="pmid">27271781</pub-id></mixed-citation>
    </ref>
    <ref id="iyac112-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Crossa</surname><given-names>J</given-names></string-name>, <string-name><surname>Campos</surname><given-names>GdL</given-names></string-name>, <string-name><surname>Pérez</surname><given-names>P</given-names></string-name>, <string-name><surname>Gianola</surname><given-names>D</given-names></string-name>, <string-name><surname>Burgueño</surname><given-names>J</given-names></string-name>, <string-name><surname>Araus</surname><given-names>JL</given-names></string-name>, <string-name><surname>Makumbi</surname><given-names>D</given-names></string-name>, <string-name><surname>Singh</surname><given-names>RP</given-names></string-name>, <string-name><surname>Dreisigacker</surname><given-names>S</given-names></string-name>, <string-name><surname>Yan</surname><given-names>J</given-names></string-name></person-group>, <etal>et al</etal><article-title>Prediction of genetic values of quantitative traits in plant breeding using pedigree and molecular markers</article-title>. <source>Genetics</source>. <year>2010</year>;<volume>186</volume>(<issue>2</issue>):<fpage>713</fpage>–<lpage>724</lpage>. <pub-id pub-id-type="doi">10.1534/genetics.110.118521</pub-id>.<pub-id pub-id-type="pmid">20813882</pub-id></mixed-citation>
    </ref>
    <ref id="iyac112-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>de los Campos</surname><given-names>G</given-names></string-name>, <string-name><surname>Gianola</surname><given-names>D</given-names></string-name>, <string-name><surname>Rosa</surname><given-names>GJM.</given-names></string-name></person-group><article-title>Reproducing Kernel Hilbert spaces regression: a general framework for genetic evaluation</article-title>. <source>J Anim Sci</source>. <year>2009</year>;<volume>87</volume>(<issue>6</issue>):<fpage>1883</fpage>–<lpage>1887</lpage>. <pub-id pub-id-type="doi">10.2527/jas.2008-1259</pub-id>.<pub-id pub-id-type="pmid">19213705</pub-id></mixed-citation>
    </ref>
    <ref id="iyac112-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>de los Campos</surname><given-names>G</given-names></string-name>, <string-name><surname>Gianola</surname><given-names>D.</given-names></string-name></person-group><article-title>Factor analysis models for structuring covariance matrices of additive genetic effects: a Bayesian implementation</article-title>. <source>Genet Sel Evol</source>. <year>2007</year>;<volume>39</volume>(<issue>5</issue>):<fpage>481</fpage>–<lpage>494</lpage>. <pub-id pub-id-type="doi">10.1186/1297&amp;ndash;9686-39-5-481</pub-id>.<pub-id pub-id-type="pmid">17897592</pub-id></mixed-citation>
    </ref>
    <ref id="iyac112-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>de los Campos</surname><given-names>G</given-names></string-name>, <string-name><surname>Gianola</surname><given-names>D</given-names></string-name>, <string-name><surname>Allison</surname><given-names>DB.</given-names></string-name></person-group><article-title>Predicting genetic predisposition in humans: the promise of whole-genome markers</article-title>. <source>Nat Rev Genet</source>. <year>2010</year>;<volume>11</volume>(<issue>12</issue>):<fpage>880</fpage>–<lpage>886</lpage>. <pub-id pub-id-type="doi">10.1038/nrg2898</pub-id>.<pub-id pub-id-type="pmid">21045869</pub-id></mixed-citation>
    </ref>
    <ref id="iyac112-B10">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>de los Campos</surname><given-names>G</given-names></string-name>, <string-name><surname>Grueneberg</surname><given-names>A.</given-names></string-name></person-group> MTM: An R-Package for Genetic Multi-Trait Recursive and Factor Analyses Models (version 1.0); <year>2013</year>. https://github.com/QuantGen/MTM</mixed-citation>
    </ref>
    <ref id="iyac112-B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>de los Campos</surname><given-names>G</given-names></string-name>, <string-name><surname>Hickey</surname><given-names>JM</given-names></string-name>, <string-name><surname>Pong-Wong</surname><given-names>R</given-names></string-name>, <string-name><surname>Daetwyler</surname><given-names>HD</given-names></string-name>, <string-name><surname>Calus</surname><given-names>MPL.</given-names></string-name></person-group><article-title>Whole-genome regression and prediction methods applied to plant and animal breeding</article-title>. <source>Genetics</source>. <year>2013</year>;<volume>193</volume>(<issue>2</issue>):<fpage>327</fpage>–<lpage>345</lpage>. <pub-id pub-id-type="doi">10.1534/genetics.112.143313</pub-id>.<pub-id pub-id-type="pmid">22745228</pub-id></mixed-citation>
    </ref>
    <ref id="iyac112-B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>de Los Campos</surname><given-names>G</given-names></string-name>, <string-name><surname>Sorensen</surname><given-names>D</given-names></string-name>, <string-name><surname>Gianola</surname><given-names>D.</given-names></string-name></person-group><article-title>Genomic heritability: what is it?</article-title><source>PLoS Genet</source>. <year>2015</year>;<volume>11</volume>(<issue>5</issue>):<fpage>e1005048</fpage>. <pub-id pub-id-type="doi">10.1371/journal.pgen.1005048</pub-id>.<pub-id pub-id-type="pmid">25942577</pub-id></mixed-citation>
    </ref>
    <ref id="iyac112-B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Endelman</surname><given-names>JB.</given-names></string-name></person-group><article-title>Ridge regression and other kernels for genomic selection with R Package RrBLUP</article-title>. <source>Plant Genome</source>. <year>2011</year>;<volume>4</volume>(<issue>3</issue>):<fpage>250</fpage>–<lpage>255</lpage>. <pub-id pub-id-type="doi">10.3835/plantgenome2011.08.0024</pub-id>.</mixed-citation>
    </ref>
    <ref id="iyac112-B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Friedman</surname><given-names>J</given-names></string-name>, <string-name><surname>Hastie</surname><given-names>T</given-names></string-name>, <string-name><surname>Tibshirani</surname><given-names>R.</given-names></string-name></person-group><article-title>Regularization paths for generalized linear models via coordinate descent</article-title>. <source>J Stat Softw</source>. <year>2010</year>;<volume>33</volume>(<issue>1</issue>):<fpage>1</fpage>–<lpage>22</lpage>. <pub-id pub-id-type="doi">10.18637/jss.v033.i01</pub-id>.<pub-id pub-id-type="pmid">20808728</pub-id></mixed-citation>
    </ref>
    <ref id="iyac112-B15">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Gilmour</surname><given-names>AR</given-names></string-name>, <string-name><surname>Thompson</surname><given-names>R</given-names></string-name>, <string-name><surname>Cullis</surname><given-names>BR.</given-names></string-name></person-group><article-title>Average information REML: an efficient algorithm for variance parameter estimation in linear mixed models</article-title>. <source>Biometrics</source>. <year>1995</year>;<volume>51</volume>(<issue>4</issue>):<fpage>1440</fpage>. <pub-id pub-id-type="doi">10.2307/2533274</pub-id>.</mixed-citation>
    </ref>
    <ref id="iyac112-B16">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Goldberger</surname><given-names>AS.</given-names></string-name></person-group><article-title>Structural equation methods in the social sciences</article-title>. <source>Econometrica</source>. <year>1972</year>;<volume>40</volume>(<issue>6</issue>):<fpage>979</fpage>–<lpage>1001</lpage>.</mixed-citation>
    </ref>
    <ref id="iyac112-B17">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Grueneberg</surname><given-names>A</given-names></string-name>, <string-name><surname>de los Campos</surname><given-names>G.</given-names></string-name></person-group><article-title>BGData—a suite of R packages for genomic analysis with big data</article-title>. <source>G3 (Bethesda)</source>. <year>2019</year>;<volume>9</volume>(<issue>5</issue>):<fpage>1377</fpage>–<lpage>1383</lpage>. <pub-id pub-id-type="doi">10.1534/g3.119.400018</pub-id>.<pub-id pub-id-type="pmid">30894453</pub-id></mixed-citation>
    </ref>
    <ref id="iyac112-B18">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Habier</surname><given-names>D</given-names></string-name>, <string-name><surname>Fernando</surname><given-names>RL</given-names></string-name>, <string-name><surname>Kizilkaya</surname><given-names>K</given-names></string-name>, <string-name><surname>Garrick</surname><given-names>DJ.</given-names></string-name></person-group><article-title>Extension of the Bayesian alphabet for genomic selection</article-title>. <source>BMC Bioinformatics</source>. <year>2011</year>;<volume>12</volume>(<issue>1</issue>):<fpage>186</fpage>. <pub-id pub-id-type="doi">10.1186/1471&amp;ndash;2105-12&amp;ndash;186</pub-id>.<pub-id pub-id-type="pmid">21605355</pub-id></mixed-citation>
    </ref>
    <ref id="iyac112-B19">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hadfield</surname><given-names>JD.</given-names></string-name></person-group><article-title>MCMC methods for multi-response generalized linear mixed models: the MCMCglmm <italic toggle="yes">R</italic> package</article-title>. <source>J Stat Softw</source>. <year>2010</year>;<volume>33</volume>(<issue>2</issue>):<fpage>1</fpage>–<lpage>22</lpage>. <pub-id pub-id-type="doi">10.18637/jss.v033.i02</pub-id>.<pub-id pub-id-type="pmid">20808728</pub-id></mixed-citation>
    </ref>
    <ref id="iyac112-B20">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Kernighan</surname><given-names>BW</given-names></string-name>, <string-name><surname>Ritchie</surname><given-names>DM.</given-names></string-name></person-group><source>The C Programming Language</source>. <edition>2nd ed</edition>. <publisher-loc>Englewood Cliffs (NJ</publisher-loc>): <publisher-name>Prentice Hall</publisher-name>; <year>1988</year>.</mixed-citation>
    </ref>
    <ref id="iyac112-B21">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Krishna Kumar</surname><given-names>S</given-names></string-name>, <string-name><surname>Feldman</surname><given-names>MW</given-names></string-name>, <string-name><surname>Rehkopf</surname><given-names>DH</given-names></string-name>, <string-name><surname>Tuljapurkar</surname><given-names>S.</given-names></string-name></person-group><article-title>Limitations of GCTA as a solution to the missing heritability problem</article-title>. <source>Proc Natl Acad Sci U S A</source>. <year>2016</year>;<volume>113</volume>(<issue>1</issue>):<fpage>E61</fpage>–<lpage>70</lpage>. <pub-id pub-id-type="doi">10.1073/pnas.1520109113</pub-id>.<pub-id pub-id-type="pmid">26699465</pub-id></mixed-citation>
    </ref>
    <ref id="iyac112-B22">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lehermeier</surname><given-names>C</given-names></string-name>, <string-name><surname>de los Campos</surname><given-names>G</given-names></string-name>, <string-name><surname>Wimmer</surname><given-names>V</given-names></string-name>, <string-name><surname>Schön</surname><given-names>C-C.</given-names></string-name></person-group><article-title>Genomic variance estimates: with or without disequilibrium covariances?</article-title><source>J Anim Breed Genet</source>. <year>2017</year>;<volume>134</volume>(<issue>3</issue>):<fpage>232</fpage>–<lpage>241</lpage>. <pub-id pub-id-type="doi">10.1111/jbg.12268</pub-id>.<pub-id pub-id-type="pmid">28508483</pub-id></mixed-citation>
    </ref>
    <ref id="iyac112-B23">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Lippert</surname><given-names>C</given-names></string-name>, <string-name><surname>Paolo Casale</surname><given-names>F</given-names></string-name>, <string-name><surname>Rakitsch</surname><given-names>B</given-names></string-name>, <string-name><surname>Stegle</surname><given-names>O.</given-names></string-name></person-group> LIMIX: genetic analysis of multiple traits. <pub-id pub-id-type="doi">10.1101/003905</pub-id>, <year>2014</year>, preprint.</mixed-citation>
    </ref>
    <ref id="iyac112-B24">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Martin</surname><given-names>AD</given-names></string-name>, <string-name><surname>Quinn</surname><given-names>KM</given-names></string-name>, <string-name><surname>Park</surname><given-names>JH.</given-names></string-name></person-group><article-title>MCMCpack: Markov Chain Monte Carlo in R</article-title>. <source>J Stat Softw</source>. <year>2011</year>;<volume>42</volume>(<issue>9</issue>):<fpage>22</fpage>.</mixed-citation>
    </ref>
    <ref id="iyac112-B25">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Meuwissen</surname><given-names>THE</given-names></string-name>, <string-name><surname>Hayes</surname><given-names>BJB</given-names></string-name>, <string-name><surname>Goddard</surname><given-names>MEM.</given-names></string-name></person-group><article-title>Prediction of total genetic value using genome-wide dense marker maps</article-title>. <source>Genetics</source>. <year>2001</year>;<volume>157</volume>(<issue>4</issue>):<fpage>1819</fpage>–<lpage>1829</lpage>.<pub-id pub-id-type="pmid">11290733</pub-id></mixed-citation>
    </ref>
    <ref id="iyac112-B26">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Meyer</surname><given-names>K.</given-names></string-name></person-group><article-title>WOMBAT—a tool for mixed model analyses in quantitative genetics by Restricted Maximum Likelihood (REML)</article-title>. <source>J Zhejiang Univ Sci B</source>. <year>2007</year>;<volume>8</volume>(<issue>11</issue>):<fpage>815</fpage>–<lpage>821</lpage>. <pub-id pub-id-type="doi">10.1631/jzus.2007.B0815</pub-id>.<pub-id pub-id-type="pmid">17973343</pub-id></mixed-citation>
    </ref>
    <ref id="iyac112-B27">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Montesinos-López</surname><given-names>OA</given-names></string-name>, <string-name><surname>Montesinos-López</surname><given-names>A</given-names></string-name>, <string-name><surname>Luna-Vázquez</surname><given-names>FJ</given-names></string-name>, <string-name><surname>Toledo</surname><given-names>FH</given-names></string-name>, <string-name><surname>Pérez-Rodríguez</surname><given-names>P</given-names></string-name>, <string-name><surname>Lillemo</surname><given-names>M</given-names></string-name>, <string-name><surname>Crossa</surname><given-names>J.</given-names></string-name></person-group><article-title>An R package for Bayesian analysis of multi-environment and multi-trait multi-environment data for genome-based prediction</article-title>. <source>G3 (Bethesda)</source>. <year>2019</year>;<volume>9</volume>(<issue>5</issue>):<fpage>1355</fpage>–<lpage>1369</lpage>. <pub-id pub-id-type="doi">10.1534/g3.119.400126</pub-id>.<pub-id pub-id-type="pmid">30819822</pub-id></mixed-citation>
    </ref>
    <ref id="iyac112-B28">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Pérez</surname><given-names>P</given-names></string-name>, <string-name><surname>de los Campos</surname><given-names>G.</given-names></string-name></person-group><article-title>Genome-wide regression and prediction with the BGLR statistical package</article-title>. <source>Genetics</source>. <year>2014</year>;<volume>198</volume>(<issue>2</issue>):<fpage>483</fpage>–<lpage>495</lpage>. <pub-id pub-id-type="doi">10.1534/genetics.114.164442</pub-id>.<pub-id pub-id-type="pmid">25009151</pub-id></mixed-citation>
    </ref>
    <ref id="iyac112-B29">
      <mixed-citation publication-type="book">R Core Team. <source>R: A Language and Environment for Statistical Computing</source>. <publisher-loc>Vienna, Austria</publisher-loc>: <publisher-name>R Foundation for Statistical Computing</publisher-name>; <year>2019</year>. [accessed 2022 May 10]. <ext-link xlink:href="https://www.R-project.org/" ext-link-type="uri">https://www.R-project.org/</ext-link>.</mixed-citation>
    </ref>
    <ref id="iyac112-B30">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Sorensen</surname><given-names>D</given-names></string-name>, <string-name><surname>Gianola</surname><given-names>D.</given-names></string-name></person-group><source>Likelihood, Bayesian and MCMC Methods in Quantitative Genetics. Statistics for Biology and Health</source>. <publisher-loc>New York</publisher-loc>: <publisher-name>Springer-Verlag</publisher-name>; <year>2002</year>.</mixed-citation>
    </ref>
    <ref id="iyac112-B31">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Valdar</surname><given-names>W</given-names></string-name>, <string-name><surname>Solberg</surname><given-names>LC</given-names></string-name>, <string-name><surname>Gauguier</surname><given-names>D</given-names></string-name>, <string-name><surname>Burnett</surname><given-names>S</given-names></string-name>, <string-name><surname>Klenerman</surname><given-names>P</given-names></string-name>, <string-name><surname>Cookson</surname><given-names>WO</given-names></string-name>, <string-name><surname>Taylor</surname><given-names>MS</given-names></string-name>, <string-name><surname>Rawlins</surname><given-names>JNP</given-names></string-name>, <string-name><surname>Mott</surname><given-names>R</given-names></string-name>, <string-name><surname>Flint</surname><given-names>J.</given-names></string-name></person-group><article-title>Genome-wide genetic association of complex traits in heterogeneous stock mice</article-title>. <source>Nat Genet</source>. <year>2006</year>;<volume>38</volume>(<issue>8</issue>):<fpage>879</fpage>–<lpage>887</lpage>. <pub-id pub-id-type="doi">10.1038/ng1840</pub-id>.<pub-id pub-id-type="pmid">16832355</pub-id></mixed-citation>
    </ref>
    <ref id="iyac112-B32">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Valdar</surname><given-names>W</given-names></string-name>, <string-name><surname>Solberg</surname><given-names>LC</given-names></string-name>, <string-name><surname>Gauguier</surname><given-names>D</given-names></string-name>, <string-name><surname>Cookson</surname><given-names>WO</given-names></string-name>, <string-name><surname>Rawlins</surname><given-names>JNP</given-names></string-name>, <string-name><surname>Mott</surname><given-names>R</given-names></string-name>, <string-name><surname>Flint</surname><given-names>J.</given-names></string-name></person-group><article-title>Genetic and environmental effects on complex traits in mice</article-title>. <source>Genetics</source>. <year>2006</year>;<volume>174</volume>(<issue>2</issue>):<fpage>959</fpage>–<lpage>984</lpage>. <pub-id pub-id-type="doi">10.1534/genetics.106.060004</pub-id>.<pub-id pub-id-type="pmid">16888333</pub-id></mixed-citation>
    </ref>
    <ref id="iyac112-B33">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Yang</surname><given-names>J</given-names></string-name>, <string-name><surname>Benyamin</surname><given-names>B</given-names></string-name>, <string-name><surname>McEvoy</surname><given-names>BP</given-names></string-name>, <string-name><surname>Gordon</surname><given-names>S</given-names></string-name>, <string-name><surname>Henders</surname><given-names>AK</given-names></string-name>, <string-name><surname>Nyholt</surname><given-names>DR</given-names></string-name>, <string-name><surname>Madden</surname><given-names>PA</given-names></string-name>, <string-name><surname>Heath</surname><given-names>AC</given-names></string-name>, <string-name><surname>Martin</surname><given-names>NG</given-names></string-name>, <string-name><surname>Montgomery</surname><given-names>GW</given-names></string-name></person-group>, <etal>et al</etal><article-title>Common SNPs explain a large proportion of the heritability for human height</article-title>. <source>Nat Genet</source>. <year>2010</year>;<volume>42</volume>(<issue>7</issue>):<fpage>565</fpage>–<lpage>569</lpage>. <pub-id pub-id-type="doi">10.1038/ng.608</pub-id>.<pub-id pub-id-type="pmid">20562875</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
