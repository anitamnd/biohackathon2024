<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Evol Biol</journal-id>
    <journal-title>BMC Evolutionary Biology</journal-title>
    <issn pub-type="epub">1471-2148</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">1796606</article-id>
    <article-id pub-id-type="publisher-id">1471-2148-7-S1-S12</article-id>
    <article-id pub-id-type="doi">10.1186/1471-2148-7-S1-S12</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>FlowerPower: clustering proteins into domain architecture classes for phylogenomic inference of protein function</article-title>
    </title-group>
    <contrib-group>
      <contrib id="A1" contrib-type="author">
        <name>
          <surname>Krishnamurthy</surname>
          <given-names>Nandini</given-names>
        </name>
        <xref ref-type="aff" rid="I1">1</xref>
        <email>nandinik@berkeley.edu</email>
      </contrib>
      <contrib id="A2" contrib-type="author">
        <name>
          <surname>Brown</surname>
          <given-names>Duncan</given-names>
        </name>
        <xref ref-type="aff" rid="I1">1</xref>
        <xref ref-type="aff" rid="I2">2</xref>
        <email>duncanb@dnai.com</email>
      </contrib>
      <contrib id="A3" corresp="yes" contrib-type="author">
        <name>
          <surname>Sjölander</surname>
          <given-names>Kimmen</given-names>
        </name>
        <xref ref-type="aff" rid="I1">1</xref>
        <email>kimmen@berkeley.edu</email>
      </contrib>
    </contrib-group>
    <aff id="I1"><label>1</label>Department of BioEngineering, 473 Evans Hall #1762, University of California, Berkeley, CA, 94720-1762, USA</aff>
    <aff id="I2"><label>2</label>UC Berkeley and UCSF Joint Graduate Group in Bioengineering, University of California, CA, USA</aff>
    <pub-date pub-type="collection">
      <year>2007</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>8</day>
      <month>2</month>
      <year>2007</year>
    </pub-date>
    <volume>7</volume>
    <issue>Suppl 1</issue>
    <supplement>
      <named-content content-type="supplement-title">First International Conference on Phylogenomics</named-content>
      <named-content content-type="supplement-editor">Hervé Philippe, Mathieu Blanchette</named-content>
    </supplement>
    <fpage>S12</fpage>
    <lpage>S12</lpage>
    <permissions>
      <copyright-statement>Copyright © 2007 Krishnamurthy et al; licensee BioMed Central Ltd.</copyright-statement>
      <copyright-year>2007</copyright-year>
      <copyright-holder>Krishnamurthy et al; licensee BioMed Central Ltd.</copyright-holder>
      <license license-type="open-access" xlink:href="http://creativecommons.org/licenses/by/2.0">
        <p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/2.0"/>), which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly cited.</p>
        <!--<rdf xmlns="http://web.resource.org/cc/" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:dc="http://purl.org/dc/elements/1.1" xmlns:dcterms="http://purl.org/dc/terms"><Work xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:dcterms="http://purl.org/dc/terms/" rdf:about=""><license rdf:resource="http://creativecommons.org/licenses/by/2.0"/><dc:type rdf:resource="http://purl.org/dc/dcmitype/Text"/><dc:author>
               Krishnamurthy
               Nandini
               
               nandinik@berkeley.edu
            </dc:author><dc:title>
            FlowerPower: clustering proteins into domain architecture classes for phylogenomic inference of protein function
         </dc:title><dc:date>2007</dc:date><dcterms:bibliographicCitation>BMC Evolutionary Biology 7(Suppl 1): S12-. (2007)</dcterms:bibliographicCitation><dc:identifier type="sici">1471-2148(2007)7:Suppl 1&#x0003c;S12&#x0003e;</dc:identifier><dcterms:isPartOf>urn:ISSN:1471-2148</dcterms:isPartOf><License rdf:about="http://creativecommons.org/licenses/by/2.0"><permits rdf:resource="http://web.resource.org/cc/Reproduction" xmlns=""/><permits rdf:resource="http://web.resource.org/cc/Distribution" xmlns=""/><requires rdf:resource="http://web.resource.org/cc/Notice" xmlns=""/><requires rdf:resource="http://web.resource.org/cc/Attribution" xmlns=""/><permits rdf:resource="http://web.resource.org/cc/DerivativeWorks" xmlns=""/></License></Work></rdf>-->
      </license>
    </permissions>
    <abstract>
      <sec>
        <title>Background</title>
        <p>Function prediction by transfer of annotation from the top database hit in a homology search has been shown to be prone to systematic error. Phylogenomic analysis reduces these errors by inferring protein function within the evolutionary context of the entire family. However, accuracy of function prediction for multi-domain proteins depends on all members having the same overall domain structure. By contrast, most common homolog detection methods are optimized for retrieving local homologs, and do not address this requirement.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p>We present FlowerPower, a novel clustering algorithm designed for the identification of global homologs as a precursor to structural phylogenomic analysis. Similar to methods such as PSIBLAST, FlowerPower employs an iterative approach to clustering sequences. However, rather than using a single HMM or profile to expand the cluster, FlowerPower identifies subfamilies using the SCI-PHY algorithm and then selects and aligns new homologs using subfamily hidden Markov models. FlowerPower is shown to outperform BLAST, PSI-BLAST and the UCSC SAM-Target 2K methods at discrimination between proteins in the same domain architecture class and those having different overall domain structures.</p>
      </sec>
      <sec>
        <title>Conclusion</title>
        <p>Structural phylogenomic analysis enables biologists to avoid the systematic errors associated with annotation transfer; clustering sequences based on sharing the same domain architecture is a critical first step in this process. FlowerPower is shown to consistently identify homologous sequences having the same domain architecture as the query.</p>
      </sec>
      <sec>
        <title>Availability</title>
        <p>FlowerPower is available as a webserver at <ext-link ext-link-type="uri" xlink:href="http://phylogenomics.berkeley.edu/flowerpower/"/>.</p>
      </sec>
    </abstract>
    <conference>
      <conf-date>15–19 March 2006</conf-date>
      <conf-name>First International Conference on Phylogenomics</conf-name>
      <conf-loc>Sainte-Adèle, Québec, Canada</conf-loc>
    </conference>
  </article-meta>
</front>
<body>
  <sec>
    <title>Introduction</title>
    <p>Biological processes such as speciation, gene duplication, and domain shuffling produce families of related genes whose gene products can have vastly different molecular functions. Inference of protein function in these cases has been shown to be prone to systematic error [<xref ref-type="bibr" rid="B1">1</xref>-<xref ref-type="bibr" rid="B3">3</xref>]. Phylogenomic analysis – inferring the function of a protein in the larger context of a protein family based on evolutionary relationships – addresses these errors and improves the accuracy of functional classification [<xref ref-type="bibr" rid="B2">2</xref>,<xref ref-type="bibr" rid="B4">4</xref>]. In a phylogenomic approach, a phylogenetic tree is constructed from a multiple alignment of evolutionarily related sequences. The tree topology is analyzed to discriminate orthologs from paralogs, and is overlaid with existing experimental data for the members of the family. Functional inference can then be performed in an evolutionary context.</p>
    <p>Protein domains are independently folding structural units that often confer specific functions. Roughly 65% of eukaryotic proteins and 40% of prokaryotic proteins are composed of multiple domains [<xref ref-type="bibr" rid="B5">5</xref>,<xref ref-type="bibr" rid="B6">6</xref>]. Domain fusion and fission events produce "families" of proteins that may share only a single domain in common, and some domains are "promiscuous," in that they are present in many different domain architectures. In automated functional inference approaches, these "local" (partial) homologs are often retrieved using database search, and may, in fact, be the top hits; they may also be placed as siblings in a phylogenetic tree with proteins having entirely different domain structures. Since the function of a multi-domain protein is a composite of all its constituent domains, annotation transfer based on local homology – even in a phylogenomic context – can be misleading. This issue has received less attention than differentiation of orthologs and paralogs, but is the source of a significant number of annotation errors.</p>
    <p>The most commonly used methods for clustering homologous proteins are BLAST [<xref ref-type="bibr" rid="B7">7</xref>] and PSI-BLAST [<xref ref-type="bibr" rid="B8">8</xref>]. There are three primary problems with the use of these and similar tools in the context of phylogenomic inference of molecular function. First, these methods are optimized for homolog detection based on local similarity; clusters are not screened to remove proteins with different domain structure. Second, overly permissive parameterization of these tools – particularly iterative methods such as PSI-BLAST – can result in the inclusion of non-homologs. Third, it is possible for repeated iterations of the homolog identification process to result in <italic>profile drift</italic>, with the result that the seed sequence may not be included in the final cluster, or the profile may have drifted to include non-homologs in the set.</p>
    <p>Structural phylogenomics combines evolutionary and structural analysis to elucidate changes in molecular function and structure in protein superfamilies. This approach has several applications, one of which is predicting the molecular function of unknown proteins in an evolutionary context. Phylogenomic inference has been shown to reduce the systematic errors associated with function prediction by homology; integration of structural information (or prediction) improves the accuracy of this approach. Our recommended protocol for protein function prediction integrates structural considerations in the first step of a phylogenomic pipeline, i.e. gathering homologs that share the same domain architecture. For this task we present FlowerPower, a method that discriminates between local and global homologs with much higher precision than BLAST, PSIBLAST and the UCSC SAM Target-2K (T2K) hidden Markov model (HMM) method [<xref ref-type="bibr" rid="B9">9</xref>]. We also present examples of sequence annotation errors detected through the use of structural phylogenomics, which could have been avoided at the outset by adopting this approach.</p>
  </sec>
  <sec>
    <title>Results and discussion</title>
    <p>We compared FlowerPower, BLAST, PSI-BLAST and T2K on the task of discriminating between proteins sharing the same domain architecture (global homologs) and those having local similarity but different overall domain structures (local homologs). BLAST and PSI-BLAST are the most commonly used methods for clustering homologous sequences. The T2K method is less well known, but has been shown to outperform all other methods at remote homolog detection [<xref ref-type="bibr" rid="B10">10</xref>]. For these experiments, we selected nine sequences whose domain structures could be confidently predicted by PFAM [<xref ref-type="bibr" rid="B11">11</xref>]. Each method was allowed to select sequences from the SwissPFAM database [<xref ref-type="bibr" rid="B12">12</xref>]. Method parameters were varied to assess the impact on sensitivity (recall: fraction of global homologs selected) and precision (selectivity: fraction of selected sequences that were global homologs).</p>
    <p>These experiments underscored the classic tradeoff between sensitivity (or recall) and precision: restrictive cutoffs yield the fewest false positives, improving precision, but reducing the recall rate. When inclusion cutoffs are relaxed, or iterated methods are used, recall improves, but precision often degrades, including many sequences with only partial (local) homology to the query. For instance, the SAM T2K method had the highest sensitivity, at 97.9%, but the worst selectivity, at 19.5% (i.e., eight out of ten sequences retrieved had different overall domain structures). PSI-BLAST, using E-value inclusion cutoffs of 10<sup>-10</sup>, 10<sup>-5 </sup>and 10<sup>-3</sup>, had the next highest sensitivity (91.1%, 91.6% and 93.1% respectively) but poor precision (between 22.6% and 34%). A conservative parameterization of BLAST produced much higher precision than PSI-BLAST and T2K, but lower sensitivity: using an E-value cutoff of 10<sup>-20 </sup>(the most restrictive cutoff tested), BLAST had a precision of 86%, but retrieved only 71.1% of global homologs. At the most permissive cutoff – an E-value of 10<sup>-5 </sup>– BLAST precision dropped to 40% but retrieved 84% of global homologs. FlowerPower achieves the best precision of all methods tested – over 97%, regardless of method parameterization – and recovers between 82–85% of global homologs. Our recommended FlowerPower parameterization yields a recall of 85% and an average precision of 98%. See Figure <xref ref-type="fig" rid="F1">1</xref>.</p>
    <p>The structural and functional variability in protein families complicates every aspect of an automated structural phylogenomic pipeline. Restricting a set of sequences to global homologs can be particularly challenging in these circumstances, as local similarity can result in sequences with different domain architectures being included in a dataset. These partial homologs can introduce errors in function prediction based on homology, as illustrated below.</p>
    <sec>
      <title>Examples of database annotation errors</title>
      <p>We include here two examples of misannotated sequences which we discovered using structural phylogenomic inference of protein families in constructing our PhyloFacts phylogenomic resource [<xref ref-type="bibr" rid="B13">13</xref>]. The first sequence appears to have been annotated entirely by homology with a protein with strictly partial (local) similarity. The second, intriguingly, has been investigated experimentally, but neither the presumed species of origin (human) nor the assigned domain structure agree with that suggested by structural phylogenomic inference. While many annotation errors can also be detected through the use of domain structure analysis (e.g., through the use of PFAM or similar domain prediction webservers), the use of FlowerPower to cluster sequences sharing the same domain structure enables us to identify potentially erroneous annotations as anomalous in the context of the family as a whole.</p>
      <sec>
        <title>Rice protein XP_478746</title>
        <p><italic>Oryza sativa </italic>sequence XP_478746 is a 196-residue protein annotated as "TIR/P-loop/LRR disease resistance protein-like protein". Domain analysis using PFAM reveals that this protein contains only a TIR domain, which occupies almost the entire length of the sequence, leaving no room for either a P-loop or leucine-rich-repeat (LRR) region. We submitted this sequence to the BLAST server at NCBI, and analyzed the PFAM domain architecture of the top ten BLAST hits. Although each of the top ten BLAST hits had significant e-values (&lt;10<sup>-50</sup>), the majority had domain architectures quite different from the query. Of the top ten BLAST hits, only four matched the query in containing a TIR domain only and being roughly the same length, four contained obviously different domain structures (including NB-ARC or NB-ARC/LRR domains), and two contained a TIR domain and long (almost 200aa and &gt;700aa) undefined regions making them unlikely to share the same domain structure (see Figure <xref ref-type="fig" rid="F2">2</xref>). We expect the misannotation of XP_478746 was based on a database hit such as the 987-residue <italic>Pinus taeda </italic>sequence AAM28917 (one of the top BLAST hits), which contains a TIR domain, (P-loop containing) NB-ARC domain and LRR region.</p>
        <p>FlowerPower, on the other hand, had much higher precision in the 43 sequences it selected from the NR database. PFAM analysis of FlowerPower sequences, requiring global matches to PFAM domains (<italic>PFAM-ls</italic>), finds only TIR domains in each of the sequences selected by FlowerPower. Allowing partial matches (<italic>PFAM-fs</italic>) detects fragmentary matches to other domains in two sequences: one (GenBank accession <ext-link ext-link-type="gen" xlink:href="AAL07540">AAL07540</ext-link>) contains a fragmentary match to an NB-ARC domain, and the second (GenBank accession <ext-link ext-link-type="gen" xlink:href="BAD94633">BAD94633</ext-link>) has a short (43aa) partial match to a motile sperm domain. SMART [<xref ref-type="bibr" rid="B14">14</xref>] detects only TIR domains in the FlowerPower sequences.</p>
        <p>Details of these analyses are available in Supplementary Materials. A structural phylogenomic analysis of this protein, including the FlowerPower cluster, is available at [<xref ref-type="bibr" rid="B15">15</xref>].</p>
      </sec>
      <sec>
        <title>Putative human neutral sphingomyelinase (AAF19052)</title>
        <p>AAF19052 is annotated as a human neutral sphingomyelinase, and is reported to contain a DEATH domain at the C-terminus [<xref ref-type="bibr" rid="B16">16</xref>]. Structural phylogenomic analysis shows all close homologs are from bacteria, and identifies a C-terminal chorismate-binding domain, but no DEATH domain. In addition, translated BLAST against the human genome finds no matches. Structural phylogenomic analysis for this protein, using FlowerPower to gather homologs, suggests that AAF19052 is more likely to be a bacterial isochorismate synthase; see [<xref ref-type="bibr" rid="B17">17</xref>]. See Figure <xref ref-type="fig" rid="F3">3</xref>.</p>
      </sec>
    </sec>
  </sec>
  <sec>
    <title>Conclusion</title>
    <p>FlowerPower is designed for the first step in structural phylogenomic inference of protein function: selecting a dataset upon which functional inference will be based. For phylogenomic inference to be accurate, all sequences in the set must share the same domain architecture. FlowerPower has been shown to outperform BLAST, PSI-BLAST and the HMM-based SAM-T2K method at discriminating between proteins sharing the same domain structure and those having only local similarity. The precision of FlowerPower is much higher than the other methods tested, with an average false positive error rate under 3%, though PSI-BLAST and SAM-T2K have better sensitivity.</p>
    <p>We have presented two examples of sequences with errors in their domain structure annotations producing errors in function prediction, which would have been prevented had a structural phylogenomic inference protocol been adopted. In these two cases, errors could also have been prevented through domain-structure analyses of each individual sequence using resources such as PFAM. FlowerPower provides an independent means of both preventing such errors and <italic>post-hoc </italic>identification of existing errors, through <italic>anomaly detection</italic>. Clustering sequences using a method such as FlowerPower enables us to assume all (or at least, most) of the sequences in the set have the same domain structure. If such a set contains sequences labelled differently, as in the examples presented here, oddball annotations will stand out as anomalous, signalling a potential error. Phylogenetic tree construction of these global homology clusters for phylogenomic inference of protein function enhances the specificity of functional annotation possible.</p>
    <p>The FlowerPower method depends on two core methods to detect and align sequences: SCI-PHY subfamily identification and subfamily HMM construction. Subfamilies identified by SCI-PHY correspond closely to conserved clades found by phylogenetic analysis and to functional subtypes found by experts (<italic>submitted</italic>). Subfamily HMMs based on SCI-PHY subfamilies model the subtypes within a diverse protein family, accommodating lineage-specific structural and functional changes. Relative to the use of a single HMM for the family as a whole, subfamily HMMs have improved sensitivity at the same false positive rate: they identify dramatically more true positives under high significance cutoffs and provide greater separation between true and false positives. In addition, novel sequences can be classified to existing subfamily HMMs with very high accuracy [<xref ref-type="bibr" rid="B18">18</xref>].</p>
    <p>A web server for FlowerPower is available at [<xref ref-type="bibr" rid="B19">19</xref>]. The default parameters are designed to retrieve sequences sharing the same domain structure; users can override the parameters to retrieve sequences sharing local or global-local similarity. Results include the native FlowerPower subfamily-HMM based alignment and a realignment of the sequences using MUSCLE. Users also have the option of generating functional subfamily using SCI-PHY and constructing subfamily HMMs. Alignments and SCI-PHY tree can be viewed online or downloaded.</p>
    <sec>
      <title>Future work</title>
      <p>FlowerPower's high precision appears to be quite robust to different parameter settings, but there is clearly room for improvement in FlowerPower sensitivity. We plan to test the effect of other parameterizations of FlowerPower, including different ways to select the initial set for multiple sequence alignment, different SAM parameter settings for aligning sequences to subfamily HMMs, and score and alignment statistic requirements for inclusion of new sequences. Future experiments will also be performed on an expanded benchmark dataset, to ensure that method parameterization generalizes well to different protein architectures.</p>
      <p>Profile drift is another area where we expect FlowerPower to provide superior performance. The use of subfamily hidden Markov models in retrieving new sequences in each iteration ensures that the seed and its homologs are included in the next iteration. Since subfamily HMMs improve the separation between true homologs and non-homologs, FlowerPower should prevent the intrusion of false positives in the final cluster. We plan to test FlowerPower's performance at these tasks.</p>
    </sec>
  </sec>
  <sec sec-type="methods">
    <title>Methods</title>
    <sec>
      <title>The FlowerPower algorithm</title>
      <p>FlowerPower is an iterative clustering algorithm akin to PSI-BLAST that retrieves and aligns sequences using profile methods. However, instead of using a single profile for homolog detection, FlowerPower constructs and uses subfamily HMMs to detect and align sequences in the next iteration; this is designed to improve alignment accuracy and prevent profile drift. Automated alignment analysis and quality control at every step ensure that homologs selected meet user-specified criteria. When parameterized for functional inference, quality control measures of alignment overlap and sequence identity result in clusters composed of sequences with the same domain architecture.</p>
      <sec>
        <title>Selection of sequences for FlowerPower search</title>
        <p>The input to FlowerPower is a seed sequence, a specified database from which putative homologs will be selected, and user-selected alignment quality control criteria (coverage and percent identity cutoffs). Due to the computational complexity of HMM scoring, the first step in FlowerPower involves running PSI-BLAST to gather a set of potential homologs against which subfamily HMMs will search. When FlowerPower is used to select globally alignable matches, this set is filtered to remove sequences that are clearly too long or too short to share the same domain structure as the seed. The final set, <italic>S</italic>, is then used as the target database from which potential homologs are selected using HMM scoring.</p>
      </sec>
      <sec>
        <title>Creation of the initial multiple sequence alignment</title>
        <p>We select a set of sequences with high sequence similarity to the seed, as follows. We construct an HMM for the seed sequence using the SAM modelfromalign software. Sequences from <italic>S </italic>with a BLAST E-value &lt;= 10<sup>-10 </sup>to the seed are aligned to the HMM using the align2model software; using HMMs to align the sequence produces somewhat more global alignments than produced by BLAST. Sequence alignments are then examined; sequences having &gt;=25% pairwise identity to the seed and passing minimum fractional (length-dependent) bi-directional overlap between the database hit and the seed (termed the "coverage") are accepted. The "coverage" fraction varies between 0.60 for sequences of &lt;100aa and 0.85 for sequences of &gt;500aa. We then use MUSCLE [<xref ref-type="bibr" rid="B20">20</xref>] to realign the sequences. The MUSCLE alignment is submitted to SCI-PHY [<xref ref-type="bibr" rid="B21">21</xref>] for subfamily identification and subfamily HMM construction [<xref ref-type="bibr" rid="B18">18</xref>].</p>
      </sec>
      <sec>
        <title>Iterated sequence retrieval and alignment</title>
        <p>In subsequent stages, the sequences in <italic>S </italic>are scored with the subfamily HMMs using the SAM hmmscore program, selecting sequences for alignment based on score significance. At program commencement, the E-value cutoff for inclusion is fairly stringent (E-value &lt;= 10<sup>-10</sup>) and is gradually increased (made less stringent) in each iteration to reach a maximum of 10<sup>-5</sup>. E-values are computed based on local-local scoring (SAM parameter - sw 2) and an assumed database size of 100,000. Each sequence receiving a significant score is aligned to the subfamily HMM giving it the strongest score, to produce a multiple sequence alignment of all sequences passing the E-value cutoff. Alignment quality control for minimum percent identity and bi-directional coverage is then performed to remove sequences not meeting these criteria (these values are user-specifiable parameters of the algorithm). The new multiple sequence alignment is provided as input to SCI-PHY, subfamily HMMs are constructed, and the process is iterated until no new sequences match inclusion criteria, or the number of sequences or iterations reaches a pre-defined cutoff. Additional details on alignment quality control parameters, including coverage and percent identity, are available in Supplementary Materials. See Figure <xref ref-type="fig" rid="F4">4</xref>.</p>
      </sec>
    </sec>
    <sec>
      <title>Subfamily identification using SCI-PHY</title>
      <p>FlowerPower uses the SCI-PHY (Subfamily Classification In Phylogenomics) method to predict functional subfamilies in each iteration, based on the multiple sequence alignment of sequences retrieved at that stage. SCI-PHY constructs a hierarchical tree using agglomerative clustering, and cuts the tree into subtrees using a combination of information theoretic methods and Dirichlet mixture densities [<xref ref-type="bibr" rid="B22">22</xref>]. SCI-PHY uses an encoding cost measurement under a Dirichlet mixture density to determine an optimal cut of the tree into subtrees. SCI-PHY subfamily classification has been shown to correspond closely to phylogenetic clades and expert identified subtypes (<italic>submitted</italic>). A detailed description of the algorithm is published in [<xref ref-type="bibr" rid="B21">21</xref>].</p>
    </sec>
    <sec>
      <title>Subfamily HMM construction</title>
      <p>Subfamilies identified by SCI-PHY are used to construct subfamily hidden Markov models, which are used to score and align sequences for the next iteration of FlowerPower. Subfamily HMM parameters are estimated using an information-sharing protocol enabling statistics to be shared across subfamilies in a position- and subfamily-specific manner. Amino acid distributions at positions conserved across the family are fixed for each subfamily; this ensures that even very small subfamilies include information about positions defining the family as a whole. At other positions, subfamilies share statistics with subfamilies aligning similar residues, while keeping their statistics separate from subfamilies aligning very dissimilar residues. This protocol retains specificity at subfamily-defining regions or motifs, while generalizing well to more distant homologs. This provides high specificity of classification while simultaneously improving the sensitivity of the subfamily HMM to detect new members [<xref ref-type="bibr" rid="B18">18</xref>]. Recent experiments on a large representative dataset of 515 SCOP folds show that subfamily HMMs dramatically increase the separation between true homologs and non-homologous proteins with different folds (<italic>submitted</italic>).</p>
    </sec>
    <sec>
      <title>Comparison of FlowerPower with BLAST, PSI-BLAST and T2K</title>
      <p>BLAST was tested using three different e-value cut-offs: 10<sup>-20</sup>, 10<sup>-10 </sup>and 10<sup>-5</sup>. For PSI-BLAST, we varied the number of iterations (three and five) and e-value cut-offs (10<sup>-10</sup>, 10<sup>-5 </sup>and 10<sup>-3</sup>). The results from five iterations were almost indistinguishable to results obtained from using three iterations and are not shown. SAM-T2K was run using default parameters.</p>
      <p>Nine seed sequences for database search were selected from SwissPFAM [<xref ref-type="bibr" rid="B12">12</xref>] based on the following criteria: (1) a majority of the sequence matching PFAM domains, based on the PFAM gathering threshold, (2) no undefined regions of &gt;80 amino acids (i.e., a region with no PFAM match), and (3) each PFAM domain matched a solved protein structure classified by the Structural Classification of Proteins (SCOP) database [<xref ref-type="bibr" rid="B23">23</xref>]. Table <xref ref-type="table" rid="T1">1</xref> and Figure <xref ref-type="fig" rid="F5">5</xref> provide details of seed sequences used in these experiments.</p>
      <p>BLAST, PSI-BLAST, T2K and FlowerPower were then used to retrieve proteins from SwissPFAM version 15. Retrieved sequences were labelled as <italic>homologous</italic>, <italic>non-homologous</italic>, or <italic>indeterminate</italic>. To be called <italic>homologous</italic>, a database hit had to be clearly in the same domain architecture class as the seed sequence (i.e., the same or structurally equivalent PFAM domains (based on SCOP analysis) in the same order), with any unlabelled region restricted to less than 80 amino acids. PFAM domains are considered equivalent if they match at the level of SCOP superfamily. For instance, the PFAM CARD, DEATH and DED domains are all members of the SCOP DEATH domain superfamily, and would be considered structurally equivalent in our analysis. The set of proteins in SwissPFAM matching these criteria form the full set of global homologs; methods identifying all the global homologs would therefore have perfect sensitivity. Proteins were defined as <italic>non-homologs </italic>if they were much longer than the seed (i.e., hit length &gt; seed length + 500), contained a PFAM domain not homologous to any domain in the seed (based on disagreement at the level of SCOP fold), contained an unequal number of homologous PFAM domains, or had a different ordering of PFAM domains than those in the seed. All other proteins were called <italic>indeterminate</italic>, as their global structural homology or lack thereof could not be rigorously determined on the basis of these analyses. For a given homolog-detection method, we then define True Positive hits (TP, global homologs correctly selected by that method), True Negatives (TN, non-global-homologs that are correctly rejected), False Positives (FP, non-global-homologs that are incorrectly accepted), and False Negatives (FN, true global homologs that are incorrectly rejected). Results of these experiments are shown in Figure <xref ref-type="fig" rid="F1">1</xref>.</p>
      <sec>
        <title>Phylogenetic tree construction and display</title>
        <p>The phylogenetic tree shown in Figure <xref ref-type="fig" rid="F3">3</xref> was estimated using Maximum Parsimony from the PAUP* software [<xref ref-type="bibr" rid="B24">24</xref>], and displayed using the ATV software [<xref ref-type="bibr" rid="B25">25</xref>].</p>
      </sec>
    </sec>
  </sec>
  <sec>
    <title>Accession numbers</title>
    <p>[GenBank:<ext-link ext-link-type="gen" xlink:href="XP_478746">XP_478746</ext-link>, GenBank:<ext-link ext-link-type="gen" xlink:href="CAC82811">CAC82811</ext-link>, GenBank:<ext-link ext-link-type="gen" xlink:href="ABB82024">ABB82024</ext-link>, GenBank:<ext-link ext-link-type="gen" xlink:href="AAN63807">AAN63807</ext-link>, GenBank:<ext-link ext-link-type="gen" xlink:href="AAM28910">AAM28910</ext-link>, GenBank:<ext-link ext-link-type="gen" xlink:href="AAM28917">AAM28917</ext-link>, GenBank:<ext-link ext-link-type="gen" xlink:href="AAM28914">AAM28914</ext-link>, GenBank:<ext-link ext-link-type="gen" xlink:href="NP_974060">NP_974060</ext-link>, GenBank:<ext-link ext-link-type="gen" xlink:href="AAB71484">AAB71484</ext-link>, GenBank:<ext-link ext-link-type="gen" xlink:href="NP_175698">NP_175698</ext-link>, GenBank:<ext-link ext-link-type="gen" xlink:href="AAM28917">AAM28917</ext-link>, GenBank:<ext-link ext-link-type="gen" xlink:href="AAL07540">AAL07540</ext-link>, GenBank:<ext-link ext-link-type="gen" xlink:href="BAD94633">BAD94633</ext-link>, GenBank:<ext-link ext-link-type="gen" xlink:href="AAF19052">AAF19052</ext-link>, SwissProt:<ext-link ext-link-type="sprot" xlink:href="ARGA_ECOLI">ARGA_ECOLI</ext-link>, SwissProt:<ext-link ext-link-type="sprot" xlink:href="BIR5_HUMAN">BIR5_HUMAN</ext-link>, SwissProt:<ext-link ext-link-type="sprot" xlink:href="BLK_MOUSE">BLK_MOUSE</ext-link>, SwissProt:<ext-link ext-link-type="sprot" xlink:href="CRKL_MOUSE">CRKL_MOUSE</ext-link>, SwissProt:<ext-link ext-link-type="sprot" xlink:href="I1BC_HUMAN">I1BC_HUMAN</ext-link>, SwissProt:<ext-link ext-link-type="sprot" xlink:href="MY88_MOUSE">MY88_MOUSE</ext-link>, SwissProt:<ext-link ext-link-type="sprot" xlink:href="NARL_ECOLI">NARL_ECOLI</ext-link>, SwissProt:<ext-link ext-link-type="sprot" xlink:href="PNP_ECOLI">PNP_ECOLI</ext-link>, SwissProt:<ext-link ext-link-type="sprot" xlink:href="SPOP_HUMAN">SPOP_HUMAN</ext-link>]</p>
  </sec>
  <sec>
    <title>Abbreviations</title>
    <p>FN: False Negative, FP: False Positive, HMM: Hidden Markov model, SCOP: Structural Classification of Proteins, T2K: SAM Target2K, TN: True Negative, TP: True Positive</p>
  </sec>
  <sec>
    <title>Authors' contributions</title>
    <p>KS conceived the work. NK and DB developed the required software, created the dataset and evaluated the methods. KS, NK and DB wrote the paper and created the figures.</p>
  </sec>
</body>
<back>
  <ack>
    <sec>
      <title>Acknowledgements</title>
      <p>This work was supported in part by a Presidential Early Career Award for Scientists and Engineers (PECASE) Grant #0238311 from the National Science Foundation, and by Grant #R01 HG002769-01 from the National Institutes of Health. We thank Jason Chan and Wayne Christopher for earlier development work on the software tools, and Dan Kirshner for maintaining the FlowerPower web server.</p>
      <p>This article has been published as part of <italic>BMC Evolutionary Biology </italic>Volume 7, Supplement 1, 2007: First International Conference on Phylogenomics. The full contents of the supplement are available online at <ext-link ext-link-type="uri" xlink:href="http://www.biomedcentral.com/bmcevolbiol/7?issue=S1"/>.</p>
    </sec>
  </ack>
  <ref-list>
    <ref id="B1">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bork</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Koonin</surname>
            <given-names>EV</given-names>
          </name>
        </person-group>
        <article-title>Predicting functions from protein sequences – where are the bottlenecks?</article-title>
        <source>Nat Genet</source>
        <year>1998</year>
        <volume>18</volume>
        <fpage>313</fpage>
        <lpage>318</lpage>
        <pub-id pub-id-type="pmid">9537411</pub-id>
        <pub-id pub-id-type="doi">10.1038/ng0498-313</pub-id>
      </citation>
    </ref>
    <ref id="B2">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Eisen</surname>
            <given-names>JA</given-names>
          </name>
        </person-group>
        <article-title>Phylogenomics: improving functional predictions for uncharacterized genes by evolutionary analysis</article-title>
        <source>Genome Res</source>
        <year>1998</year>
        <volume>8</volume>
        <fpage>163</fpage>
        <lpage>167</lpage>
        <pub-id pub-id-type="pmid">9521918</pub-id>
      </citation>
    </ref>
    <ref id="B3">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Galperin</surname>
            <given-names>MY</given-names>
          </name>
          <name>
            <surname>Koonin</surname>
            <given-names>EV</given-names>
          </name>
        </person-group>
        <article-title>Sources of systematic error in functional annotation of genomes: domain rearrangement, non-orthologous gene displacement and operon disruption</article-title>
        <source>In Silico Biol</source>
        <year>1998</year>
        <volume>1</volume>
        <fpage>55</fpage>
        <lpage>67</lpage>
        <pub-id pub-id-type="pmid">11471243</pub-id>
      </citation>
    </ref>
    <ref id="B4">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sjölander</surname>
            <given-names>K</given-names>
          </name>
        </person-group>
        <article-title>Phylogenomic inference of protein molecular function: advances and challenges</article-title>
        <source>Bioinformatics</source>
        <year>2004</year>
        <volume>20</volume>
        <fpage>170</fpage>
        <lpage>179</lpage>
        <pub-id pub-id-type="pmid">14734307</pub-id>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bth021</pub-id>
      </citation>
    </ref>
    <ref id="B5">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ekman</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Bjorklund</surname>
            <given-names>AK</given-names>
          </name>
          <name>
            <surname>Frey-Skott</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Elofsson</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Multi-domain proteins in the three kingdoms of life: orphan domains and other unassigned regions</article-title>
        <source>J Mol Biol</source>
        <year>2005</year>
        <volume>348</volume>
        <fpage>231</fpage>
        <lpage>243</lpage>
        <pub-id pub-id-type="pmid">15808866</pub-id>
        <pub-id pub-id-type="doi">10.1016/j.jmb.2005.02.007</pub-id>
      </citation>
    </ref>
    <ref id="B6">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Apic</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Gough</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Teichmann</surname>
            <given-names>SA</given-names>
          </name>
        </person-group>
        <article-title>Domain combinations in archaeal, eubacterial and eukaryotic proteomes</article-title>
        <source>J Mol Biol</source>
        <year>2001</year>
        <volume>310</volume>
        <fpage>311</fpage>
        <lpage>325</lpage>
        <pub-id pub-id-type="pmid">11428892</pub-id>
        <pub-id pub-id-type="doi">10.1006/jmbi.2001.4776</pub-id>
      </citation>
    </ref>
    <ref id="B7">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Altschul</surname>
            <given-names>SF</given-names>
          </name>
          <name>
            <surname>Gish</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Miller</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Myers</surname>
            <given-names>EW</given-names>
          </name>
          <name>
            <surname>Lipman</surname>
            <given-names>DJ</given-names>
          </name>
        </person-group>
        <article-title>Basic local alignment search tool</article-title>
        <source>J Mol Biol</source>
        <year>1990</year>
        <volume>215</volume>
        <fpage>403</fpage>
        <lpage>410</lpage>
        <pub-id pub-id-type="pmid">2231712</pub-id>
        <pub-id pub-id-type="doi">10.1006/jmbi.1990.9999</pub-id>
      </citation>
    </ref>
    <ref id="B8">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Altschul</surname>
            <given-names>SF</given-names>
          </name>
          <name>
            <surname>Madden</surname>
            <given-names>TL</given-names>
          </name>
          <name>
            <surname>Schaffer</surname>
            <given-names>AA</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Miller</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Lipman</surname>
            <given-names>DJ</given-names>
          </name>
        </person-group>
        <article-title>Gapped BLAST and PSI-BLAST: a new generation of protein database search programs</article-title>
        <source>Nucleic Acids Res</source>
        <year>1997</year>
        <volume>25</volume>
        <fpage>3389</fpage>
        <lpage>3402</lpage>
        <pub-id pub-id-type="pmid">9254694</pub-id>
        <pub-id pub-id-type="doi">10.1093/nar/25.17.3389</pub-id>
      </citation>
    </ref>
    <ref id="B9">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Karplus</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Karchin</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Barrett</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Tu</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Cline</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Diekhans</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Grate</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Casper</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Hughey</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>What is the value added by human intervention in protein structure prediction?</article-title>
        <source>Proteins</source>
        <year>2001</year>
        <volume>45</volume>
        <fpage>86</fpage>
        <lpage>91</lpage>
        <pub-id pub-id-type="pmid">11835485</pub-id>
        <pub-id pub-id-type="doi">10.1002/prot.10021</pub-id>
      </citation>
    </ref>
    <ref id="B10">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Park</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Karplus</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Barrett</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Hughey</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Haussler</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Hubbard</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Chothia</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>Sequence comparisons using multiple sequences detect three times as many remote homologues as pairwise methods</article-title>
        <source>J Mol Biol</source>
        <year>1998</year>
        <volume>284</volume>
        <fpage>1201</fpage>
        <lpage>1210</lpage>
        <pub-id pub-id-type="pmid">9837738</pub-id>
        <pub-id pub-id-type="doi">10.1006/jmbi.1998.2221</pub-id>
      </citation>
    </ref>
    <ref id="B11">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bateman</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Coin</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Durbin</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Finn</surname>
            <given-names>RD</given-names>
          </name>
          <name>
            <surname>Hollich</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Griffiths-Jones</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Khanna</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Marshall</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Moxon</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Sonnhammer</surname>
            <given-names>EL</given-names>
          </name>
          <name>
            <surname>Studholme</surname>
            <given-names>DJ</given-names>
          </name>
          <name>
            <surname>Yeats</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Eddy</surname>
            <given-names>SR</given-names>
          </name>
        </person-group>
        <article-title>The Pfam protein families database</article-title>
        <source>Nucleic Acids Res</source>
        <year>2004</year>
        <fpage>D138</fpage>
        <lpage>141</lpage>
        <pub-id pub-id-type="pmid">14681378</pub-id>
        <pub-id pub-id-type="doi">10.1093/nar/gkh121</pub-id>
      </citation>
    </ref>
    <ref id="B12">
      <citation citation-type="other">
        <article-title>SWISSPFAM database</article-title>
        <ext-link ext-link-type="uri" xlink:href="http://pfam.janelia.org/swisspfam.shtml"/>
      </citation>
    </ref>
    <ref id="B13">
      <citation citation-type="other">
        <article-title>PhyloFacts Universal Proteome Explorer</article-title>
        <ext-link ext-link-type="uri" xlink:href="http://phylogenomics.berkeley.edu/phylofacts/"/>
      </citation>
    </ref>
    <ref id="B14">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Letunic</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Copley</surname>
            <given-names>RR</given-names>
          </name>
          <name>
            <surname>Pils</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Pinkert</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Schultz</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Bork</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>SMART 5: domains in the context of genomes and networks</article-title>
        <source>Nucleic Acids Res</source>
        <year>2006</year>
        <fpage>D257</fpage>
        <lpage>260</lpage>
        <pub-id pub-id-type="pmid">16381859</pub-id>
        <pub-id pub-id-type="doi">10.1093/nar/gkj079</pub-id>
      </citation>
    </ref>
    <ref id="B15">
      <citation citation-type="other">
        <article-title>Structural phylogenomic analysis of rice protein XP_478746</article-title>
        <ext-link ext-link-type="uri" xlink:href="http://phylogenomics.berkeley.edu/book/book_info.php?book=bpg004945"/>
      </citation>
    </ref>
    <ref id="B16">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chatterjee</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Han</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Rollins</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Cleveland</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>Molecular cloning, characterization, and expression of a novel human neutral sphingomyelinase</article-title>
        <source>J Biol Chem</source>
        <year>1999</year>
        <volume>274</volume>
        <fpage>37407</fpage>
        <lpage>37412</lpage>
        <pub-id pub-id-type="pmid">10601312</pub-id>
        <pub-id pub-id-type="doi">10.1074/jbc.274.52.37407</pub-id>
      </citation>
    </ref>
    <ref id="B17">
      <citation citation-type="other">
        <article-title>Structural phylogenomic analysis of putative human neutral sphingomyelinase AAF19052</article-title>
        <ext-link ext-link-type="uri" xlink:href="http://phylogenomics.berkeley.edu/book/book_info.php?book=bpg004927"/>
      </citation>
    </ref>
    <ref id="B18">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Brown</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Krishnamurthy</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Dale</surname>
            <given-names>JM</given-names>
          </name>
          <name>
            <surname>Christopher</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Sjolander</surname>
            <given-names>K</given-names>
          </name>
        </person-group>
        <article-title>Subfamily hmms in functional genomics</article-title>
        <source>Pac Symp Biocomput</source>
        <year>2005</year>
        <fpage>322</fpage>
        <lpage>333</lpage>
        <pub-id pub-id-type="pmid">15759638</pub-id>
      </citation>
    </ref>
    <ref id="B19">
      <citation citation-type="other">
        <article-title>FlowerPower Online Server</article-title>
        <ext-link ext-link-type="uri" xlink:href="http://phylogenomics.berkeley.edu/flowerpower"/>
      </citation>
    </ref>
    <ref id="B20">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Edgar</surname>
            <given-names>RC</given-names>
          </name>
        </person-group>
        <article-title>MUSCLE: multiple sequence alignment with high accuracy and high throughput</article-title>
        <source>Nucleic Acids Res</source>
        <year>2004</year>
        <volume>32</volume>
        <fpage>1792</fpage>
        <lpage>1797</lpage>
        <pub-id pub-id-type="pmid">15034147</pub-id>
        <pub-id pub-id-type="doi">10.1093/nar/gkh340</pub-id>
      </citation>
    </ref>
    <ref id="B21">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sjölander</surname>
            <given-names>K</given-names>
          </name>
        </person-group>
        <article-title>Phylogenetic inference in protein superfamilies: analysis of SH2 domains</article-title>
        <source>Proc Int Conf Intell Syst Mol Biol</source>
        <year>1998</year>
        <volume>6</volume>
        <fpage>165</fpage>
        <lpage>174</lpage>
        <pub-id pub-id-type="pmid">9783222</pub-id>
      </citation>
    </ref>
    <ref id="B22">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sjölander</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Karplus</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Brown</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Hughey</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Krogh</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Mian</surname>
            <given-names>IS</given-names>
          </name>
          <name>
            <surname>Haussler</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>Dirichlet mixtures: a method for improved detection of weak but significant protein sequence homology</article-title>
        <source>Comput Appl Biosci</source>
        <year>1996</year>
        <volume>12</volume>
        <fpage>327</fpage>
        <lpage>345</lpage>
        <pub-id pub-id-type="pmid">8902360</pub-id>
      </citation>
    </ref>
    <ref id="B23">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Andreeva</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Howorth</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Brenner</surname>
            <given-names>SE</given-names>
          </name>
          <name>
            <surname>Hubbard</surname>
            <given-names>TJ</given-names>
          </name>
          <name>
            <surname>Chothia</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Murzin</surname>
            <given-names>AG</given-names>
          </name>
        </person-group>
        <article-title>SCOP database in 2004: refinements integrate structure and sequence family data</article-title>
        <source>Nucleic Acids Res</source>
        <year>2004</year>
        <fpage>D226</fpage>
        <lpage>229</lpage>
        <pub-id pub-id-type="pmid">14681400</pub-id>
        <pub-id pub-id-type="doi">10.1093/nar/gkh039</pub-id>
      </citation>
    </ref>
    <ref id="B24">
      <citation citation-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Swofford</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <source>PAUP*. Phylogenetic Analysis Using Parsimony (*and Other Methods). Version 4</source>
        <year>2002</year>
        <publisher-name>Sunderland, Massachusetts: Sinauer Associates</publisher-name>
        <pub-id pub-id-type="pmid">12504223</pub-id>
      </citation>
    </ref>
    <ref id="B25">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zmasek</surname>
            <given-names>CM</given-names>
          </name>
          <name>
            <surname>Eddy</surname>
            <given-names>SR</given-names>
          </name>
        </person-group>
        <article-title>ATV: display and manipulation of annotated phylogenetic trees</article-title>
        <source>Bioinformatics</source>
        <year>2001</year>
        <volume>17</volume>
        <fpage>383</fpage>
        <lpage>384</lpage>
        <pub-id pub-id-type="pmid">11301314</pub-id>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/17.4.383</pub-id>
      </citation>
    </ref>
  </ref-list>
  <sec sec-type="display-objects">
    <title>Figures and Tables</title>
    <fig position="float" id="F1">
      <label>Figure 1</label>
      <caption>
        <p><bold>Comparison of performances of BLAST, PSIBLAST, T2K and FlowerPower in identifying global homologs</bold>. The X-axis refers to the average sensitivity (or recall) of each method across the dataset and the Y-axis refers to the average precision (or selectivity). Sensitivity is the fraction of the target homolog set identified by a method (i.e., TP/TP+FN). Precision is the fraction of the set selected by a method that belongs to the same domain architecture class (i.e., TP/TP+FP). Results of FlowerPower at varying parameterizations are presented including percent identity cutoffs for sequence selection (25%, 20% and 15%) and stringent ("str") and relaxed ("rel") query and hit coverage cutoffs, based on sequence length. The BLAST parameters refer to e-value cutoffs of 10<sup>-20</sup>, 10<sup>-10 </sup>and 10<sup>-5</sup>. For PSI-BLAST the e-value cut-off used were 10<sup>-10</sup>, 10<sup>-5 </sup>and 10<sup>-3</sup>, using three iterations. T2K was run using default parameters. The inset displays FlowerPower results using different parameterizations.</p>
      </caption>
      <graphic xlink:href="1471-2148-7-S1-S12-1"/>
    </fig>
    <fig position="float" id="F2">
      <label>Figure 2</label>
      <caption>
        <p><bold>Analysis of rice protein XP_478746 and BLAST hits</bold>. The PFAM domain architectures of XP_478746, annotated as a "TIR/P-loop/LRR disease resistance protein-like protien" (sic) from <italic>Oryza sativa</italic>, and its closest BLAST homologs are shown. XP_478746 contains a TIR domain only with no room for the P-loop and LRR regions; the sequence is therefore misannotated. We expect XP_478746 was annotated based on local similarity to a sequence such as AAM28917 (annotated as a "putative TIR/NBS/LRR disease resistance protein" from <italic>Pinus taeda</italic>), which does contain the NB-ARC and LRR domains. See text for details.</p>
      </caption>
      <graphic xlink:href="1471-2148-7-S1-S12-2"/>
    </fig>
    <fig position="float" id="F3">
      <label>Figure 3</label>
      <caption>
        <p><bold>Human sphingomyelinase or bacterial isochorismate synthase? </bold>The sequence AAF19052 is reported to be a human neutral sphingomyelinase, containing a DEATH domain at the C-terminus. The top panel shows the PFAM domain architecture, which reveals the presence of a chorismate-binding domain at the C-terminus and the absence of a DEATH domain. The lower panel displays a structural phylogenomic analysis, resulting from clustering the sequence homologs to AAF19052 using FlowerPower and construction of a Maximum Parsimony tree. Examination of the phylogenetic tree suggests that AAF19052 (red box) is more likely an isochorismate synthase of bacterial origin. Each node in the tree is labeled with the species of origin, SCI-PHY subfamily label (see Methods), and sequence identifier and definition line.</p>
      </caption>
      <graphic xlink:href="1471-2148-7-S1-S12-3"/>
    </fig>
    <fig position="float" id="F4">
      <label>Figure 4</label>
      <caption>
        <p><bold>The FlowerPower algorithm</bold>. "Q" indicates the query (or seed) sequence. Sequences sharing the same domain structure are indicated as blue stars; all other sequences are indicated as brown triangles. SCI-PHY subfamilies are indicated by black ovals. <bold>1</bold>. Identify a set of potential homologs <italic>S </italic>using PSI-BLAST; filter to remove much longer or much shorter sequences. <bold>2</bold>. Select a core set for initial alignment. <bold>3</bold>. Identify subfamilies using SCI-PHY and construct subfamily HMMs (SHMMs). <bold>4</bold>. Score <italic>S </italic>with the SHMMs, and identify those sequences receiving scores with E-values below cutoff. Align each sequence to its closest SHMM. Evaluate the alignment with user-specified criteria; remove sequences that do not meet these criteria. <bold>5</bold>. Run SCI-PHY on the new alignment to identify subfamilies and construct SHMMs. <bold>6</bold>. Repeat steps 1–5 until convergence.</p>
      </caption>
      <graphic xlink:href="1471-2148-7-S1-S12-4"/>
    </fig>
    <fig position="float" id="F5">
      <label>Figure 5</label>
      <caption>
        <p><bold>PFAM domain architecture of the seed dataset used to evaluate BLAST, PSI-BLAST, T2K and FlowerPower</bold>. Sequences were selected based on the following criteria: each sequence had to contain recognizable PFAM domains (based on the PFAM gathering threshold), no undefined regions of &gt;80 amino acids (i.e., a region with no PFAM match), and each PFAM domain was required to match a 3D structure classified by the SCOP database. For details of the seed sequence domain architectures see Table 1.</p>
      </caption>
      <graphic xlink:href="1471-2148-7-S1-S12-5"/>
    </fig>
    <table-wrap position="float" id="T1">
      <label>Table 1</label>
      <caption>
        <p>Details of FlowerPower validation dataset.</p>
      </caption>
      <table frame="hsides" rules="groups">
        <thead>
          <tr>
            <td align="center">
              <bold>Seed ID</bold>
            </td>
            <td align="center">
              <bold>Seed length</bold>
            </td>
            <td align="center">
              <bold>Domain Architecture</bold>
            </td>
            <td align="center">
              <bold>Total GH</bold>
            </td>
            <td align="center">
              <bold>Total NH</bold>
            </td>
            <td align="center">
              <bold>Total IND</bold>
            </td>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td align="center">ARGA_ECOLI</td>
            <td align="center">443</td>
            <td align="left">AA_kinase (26–269); Acetyltransf_1 (338–414)</td>
            <td align="center">26</td>
            <td align="center">898420</td>
            <td align="center">3559</td>
          </tr>
          <tr>
            <td align="center">BIR5_HUMAN</td>
            <td align="center">142</td>
            <td align="left">BIR (18–88)</td>
            <td align="center">23</td>
            <td align="center">901954</td>
            <td align="center">28</td>
          </tr>
          <tr>
            <td align="center">BLK_MOUSE</td>
            <td align="center">498</td>
            <td align="left">SH3_1 (54–109); SH2 (117–198); Pkinase (234–486)</td>
            <td align="center">76</td>
            <td align="center">893470</td>
            <td align="center">8459</td>
          </tr>
          <tr>
            <td align="center">CRKL_MOUSE</td>
            <td align="center">303</td>
            <td align="left">SH2 (14–88); SH3_1 (126–181); SH3_2 (239–294)</td>
            <td align="center">15</td>
            <td align="center">900640</td>
            <td align="center">1350</td>
          </tr>
          <tr>
            <td align="center">I1BC_HUMAN</td>
            <td align="center">404</td>
            <td align="left">CARD (2–91); Peptidase_C14 (163–401)</td>
            <td align="center">33</td>
            <td align="center">901717</td>
            <td align="center">255</td>
          </tr>
          <tr>
            <td align="center">MY88_MOUSE</td>
            <td align="center">296</td>
            <td align="left">Death (31–109); TIR(163–292)</td>
            <td align="center">4</td>
            <td align="center">897880</td>
            <td align="center">4121</td>
          </tr>
          <tr>
            <td align="center">NARL_ECOLI</td>
            <td align="center">216</td>
            <td align="left">Response_reg (7–128); GerE (153–210)</td>
            <td align="center">1757</td>
            <td align="center">884810</td>
            <td align="center">15438</td>
          </tr>
          <tr>
            <td align="center">PNP_ECOLI</td>
            <td align="center">711</td>
            <td align="left">RNase_PH (12–144); RNase_PH_C (147–211); PNPase (242–320); RNase_PH (323–456); RNase_PH_C (459–529); KH_1 (555–612); S1 (618–690)</td>
            <td align="center">121</td>
            <td align="center">885592</td>
            <td align="center">16292</td>
          </tr>
          <tr>
            <td align="center">SPOP_HUMAN</td>
            <td align="center">374</td>
            <td align="left">MATH (38–163); BTB (190–297)</td>
            <td align="center">68</td>
            <td align="center">901237</td>
            <td align="center">700</td>
          </tr>
        </tbody>
      </table>
      <table-wrap-foot>
        <p>SwissProt identifiers are shown in the first column. The number of global homologs (GH; proteins sharing the same domain structure) for a seed was determined by the total number of proteins in the SwissPFAM dataset that shared the same domain structure as the seed. Non-homologs (NH) are those having an obviously different domain structure. Indeterminate sequences (IND) are those whose global homology to the seed or lack thereof could not be rigorously determined. See Methods for details.</p>
      </table-wrap-foot>
    </table-wrap>
  </sec>
</back>
