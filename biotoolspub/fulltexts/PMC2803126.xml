<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD Journal Publishing DTD v2.3 20070202//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName journalpublishing.dtd?>
<?SourceDTD.Version 2.3?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 2?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Acta Crystallogr D Biol Crystallogr</journal-id>
    <journal-id journal-id-type="publisher-id">Acta Cryst. D</journal-id>
    <journal-title-group>
      <journal-title>Acta Crystallographica Section D: Biological Crystallography</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">0907-4449</issn>
    <issn pub-type="epub">1399-0047</issn>
    <publisher>
      <publisher-name>International Union of Crystallography</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">2803126</article-id>
    <article-id pub-id-type="publisher-id">dz5180</article-id>
    <article-id pub-id-type="doi">10.1107/S0907444909042073</article-id>
    <article-id pub-id-type="coden">ABCRE6</article-id>
    <article-id pub-id-type="pii">S0907444909042073</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research Papers</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title><italic>MolProbity</italic>: all-atom structure validation for macromolecular crystallography</article-title>
      <alt-title>
        <italic>MolProbity</italic>
      </alt-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Chen</surname>
          <given-names>Vincent B.</given-names>
        </name>
        <xref ref-type="aff" rid="a">a</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Arendall</surname>
          <given-names>W. Bryan</given-names>
          <suffix>III</suffix>
        </name>
        <xref ref-type="aff" rid="a">a</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Headd</surname>
          <given-names>Jeffrey J.</given-names>
        </name>
        <xref ref-type="aff" rid="a">a</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Keedy</surname>
          <given-names>Daniel A.</given-names>
        </name>
        <xref ref-type="aff" rid="a">a</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Immormino</surname>
          <given-names>Robert M.</given-names>
        </name>
        <xref ref-type="aff" rid="a">a</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Kapral</surname>
          <given-names>Gary J.</given-names>
        </name>
        <xref ref-type="aff" rid="a">a</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Murray</surname>
          <given-names>Laura W.</given-names>
        </name>
        <xref ref-type="aff" rid="a">a</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Richardson</surname>
          <given-names>Jane S.</given-names>
        </name>
        <xref ref-type="aff" rid="a">a</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Richardson</surname>
          <given-names>David C.</given-names>
        </name>
        <xref ref-type="aff" rid="a">a</xref>
        <xref ref-type="corresp" rid="cor">*</xref>
      </contrib>
      <aff id="a"><label>a</label>Department of Biochemistry, Duke University, Durham, NC 27710, <country>USA</country></aff>
    </contrib-group>
    <author-notes>
      <corresp id="cor">Correspondence e-mail: <email>dcr@kinemage.biochem.duke.edu</email></corresp>
    </author-notes>
    <pub-date pub-type="ppub">
      <day>01</day>
      <month>1</month>
      <year>2010</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>21</day>
      <month>12</month>
      <year>2009</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>21</day>
      <month>12</month>
      <year>2009</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the
							<pub-date pub-type="epub"/>. -->
    <volume>66</volume>
    <issue>Pt 1</issue>
    <issue-id pub-id-type="publisher-id">d100100</issue-id>
    <fpage>12</fpage>
    <lpage>21</lpage>
    <history>
      <date date-type="received">
        <day>21</day>
        <month>8</month>
        <year>2009</year>
      </date>
      <date date-type="accepted">
        <day>13</day>
        <month>10</month>
        <year>2009</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© Chen et al. 2010</copyright-statement>
      <copyright-year>2010</copyright-year>
      <license license-type="open-access" xlink:href="http://creativecommons.org/licenses/by/2.0/uk/">
        <license-p>This is an open-access article distributed under the terms of the Creative Commons Attribution Licence, which permits unrestricted use, distribution, and reproduction in any medium, provided the original authors and source are cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:type="simple" xlink:href="http://dx.doi.org/10.1107/S0907444909042073">A full version of this article is available from Crystallography Journals Online.</self-uri>
    <abstract abstract-type="toc">
      <p><italic>MolProbity</italic> structure validation will diagnose most local errors in macromolecular crystal structures and help to guide their correction.</p>
    </abstract>
    <abstract>
      <p><italic>MolProbity</italic> is a structure-validation web service that provides broad-spectrum solidly based evaluation of model quality at both the global and local levels for both proteins and nucleic acids. It relies heavily on the power and sensitivity provided by optimized hydrogen placement and all-atom contact analysis, complemented by updated versions of covalent-geometry and torsion-angle criteria. Some of the local corrections can be performed automatically in <italic>MolProbity</italic> and all of the diagnostics are presented in chart and graphical forms that help guide manual rebuilding. X-ray crystallography provides a wealth of biologically important molecular data in the form of atomic three-dimensional structures of proteins, nucleic acids and increasingly large complexes in multiple forms and states. Advances in automation, in everything from crystallization to data collection to phasing to model building to refinement, have made solving a structure using crystallo­graphy easier than ever. However, despite these improvements, local errors that can affect biological interpretation are widespread at low resolution and even high-resolution structures nearly all contain at least a few local errors such as Ramachandran outliers, flipped branched protein side chains and incorrect sugar puckers. It is critical both for the crystallographer and for the end user that there are easy and reliable methods to diagnose and correct these sorts of errors in structures. <italic>MolProbity</italic> is the authors’ contribution to helping solve this problem and this article reviews its general capabilities, reports on recent enhancements and usage, and presents evidence that the resulting improvements are now beneficially affecting the global database.</p>
    </abstract>
    <kwd-group>
      <kwd>all-atom contacts</kwd>
      <kwd>clashscore</kwd>
      <kwd>automated correction</kwd>
      <kwd>
        <italic>KiNG</italic>
      </kwd>
      <kwd>ribose pucker</kwd>
      <kwd>Ramachandran plots</kwd>
      <kwd>side-chain rotamers</kwd>
      <kwd>model quality</kwd>
      <kwd>systematic errors</kwd>
      <kwd>database improvement</kwd>
    </kwd-group>
  </article-meta>
</front>
<body>
  <sec id="sec1">
    <label>1.</label>
    <title>Summary of <italic>MolProbity</italic> flow and user interactions</title>
    <p>The usual interaction with <italic>MolProbity</italic> (Davis <italic>et al.</italic>, 2007<xref ref-type="bibr" rid="bb9"> ▶</xref>) is through the internet at <ext-link ext-link-type="uri" xlink:href="http://molprobity.biochem.duke.edu">http://molprobity.biochem.duke.edu</ext-link> or as a main menu item on our general laboratory website at <ext-link ext-link-type="uri" xlink:href="http://kinemage.biochem.duke.edu">http://kinemage.biochem.duke.edu</ext-link>. [For bulk users, it is also possible to set up your own local <italic>MolProbity</italic> server or to use the individual programs in command-line mode.] Tutorial exercises for the whole process of diagnosing and fixing errors can be found on the kinemage site under Teaching/MolProbity.</p>
    <p>A typical <italic>MolProbity</italic> session starts with the user uploading a coordinate file of their own or fetching one from the PDB or NDB databases (Berman <italic>et al.</italic>, 1992<xref ref-type="bibr" rid="bb4"> ▶</xref>, 2000<xref ref-type="bibr" rid="bb5"> ▶</xref>) in new or old PDB format or in mmCIF format. After checking the thumbnail image and listed characteristics of the input file and editing or reloading if needed, H atoms are added and optimized, with automated correction of Asn/Gln/His 180° flips if needed (Word, Lovell, Richardson <italic>et al.</italic>, 1999<xref ref-type="bibr" rid="bb27"> ▶</xref>).</p>
    <p>The user then chooses which validation analyses to run and what reports and output files to generate. The <italic>MolProbity</italic> interface adjusts the defaults and options presented and even the page flow depending on user choices and on the properties of the file being worked on. These adjustments make <italic>MolProbity</italic> simple for novice users, while at the same time allowing advanced users to have great control over their runs. The core ‘glue’ that generates the HMTL code controlling the main user interface and programmatic interactions of <italic>MolProbity</italic> is implemented in the PHP programming language. Underlying the PHP core, the majority of the analysis tasks in <italic>MolProbity</italic> are performed by individual programs written in a range of languages, including C, C++, Java and Perl. It uses <italic>REDUCE</italic> and <italic>PROBE</italic> for all-atom contact analysis, <italic>RAMALYZE</italic>, <italic>ROTALYZE</italic>, <italic>DANGLE</italic>, <italic>SILK</italic> and <italic>SUITENAME</italic> for other criteria and <italic>KiNG</italic> for three-dimensional visualization of the structure and its validation markers directly in the browser. Fig. 1<xref ref-type="fig" rid="fig1"> ▶</xref> shows a key to <italic>MolProbity</italic>’s graphical markers for validation outliers. Further details are provided below on the specific analyses that <italic>MolProbity</italic> can perform. The validation results are reported in the form of summaries, charts, two-dimensional and three-dimensional graphics and output files for download.</p>
    <p>The crucial final step in the <italic>MolProbity</italic> process is for the crystallographer to download the result files and work off-line to correct as many of the diagnosed problems as feasible. Rebuilding with consideration of the validation outliers, the electron density and the surrounding model is usually per­formed either in <italic>Coot</italic> (Emsley &amp; Cowtan, 2004<xref ref-type="bibr" rid="bb10"> ▶</xref>) or in <italic>KiNG</italic> (Chen <italic>et al.</italic>, 2009<xref ref-type="bibr" rid="bb7"> ▶</xref>). At resolutions of about 2.5 Å or better it is possible to correct the great majority of outliers (Arendall <italic>et al.</italic>, 2005<xref ref-type="bibr" rid="bb3"> ▶</xref>), with an order-of-magnitude improvement in the various <italic>MolProbity</italic> scores and some improvement in geometry, map quality, <italic>R</italic> factor and <italic>R</italic>
            <sub>free</sub>. An example is shown in Fig. 2<xref ref-type="fig" rid="fig2"> ▶</xref> with before-and-after multi-criterion kinemages.</p>
  </sec>
  <sec id="sec2">
    <label>2.</label>
    <title>Validation analyses</title>
    <sec id="sec2.1">
      <label>2.1.</label>
      <title>Addition of H atoms</title>
      <p>The presence of H atoms (both nonpolar and polar) is a critical pre­requisite for all-atom contact analysis. Although refinement using H atoms is becoming more common, most crystal structures are still deposited without H atoms. Once a PDB structure file has been uploaded, <italic>MolProbity</italic> detects whether the file contains a suitable number of H atoms; if not, then the ‘Add H atoms’ option is presented to users first. <italic>MolProbity</italic> uses the software <italic>REDUCE</italic> (Word, Lovell, Richardson <italic>et al.</italic>, 1999<xref ref-type="bibr" rid="bb27"> ▶</xref>) to add and optimize hydrogen positions in both protein and nucleic acid structures, including ligands, but does not add explicit H atoms to waters. OH, SH and NH<sub>3</sub> groups (but not methyl groups) are rotationally optimized and His protonation is chosen within each local hydrogen-bond network, including interactions with the first shell of explicit waters.</p>
      <p>A common problem is that the side-chain ends of Asn, Gln and His are easily fitted 180° backwards, since the electron density alone cannot usually distinguish the correct choice of orientation. <italic>REDUCE</italic> can automatically diagnose and correct these types of systematic errors by considering all-atom steric overlaps as well as hydrogen bonding within each local network. Automatic correction of Asn/Gln/His flips is the default option in <italic>MolProbity</italic> during addition of H atoms. <italic>MolProbity</italic> presents each potential flip correction to the user in kinemage view so they have the option of inspecting the before-and-after effects of each flip and approving (or rejecting) each correction. Fig. 3<xref ref-type="fig" rid="fig3"> ▶</xref> shows an example of a simple Gln flip that is unquestionably correct but that could not have been decided on the basis of hydrogen bonding alone. Other examples can be much more complex, with rotatable OH positions, large hydrogen-bond net­works and multiple com­peting inter­actions evaluated exhaustively.</p>
      <p>Users can also choose to add H atoms without Asn/Gln/His flips, which is useful in evaluating the atomic coordinates as they were deposited, but which rejects the easiest and most robustly correct improvement that can be made in a crystallo­graphic model (Word, Lovell, Richardson <italic>et al.</italic>, 1999<xref ref-type="bibr" rid="bb27"> ▶</xref>; Higman <italic>et al.</italic>, 2004<xref ref-type="bibr" rid="bb13"> ▶</xref>). If flips are performed, the user needs to download and use the corrected PDB file (either with or without the H atoms) in order to benefit.</p>
    </sec>
    <sec id="sec2.2">
      <label>2.2.</label>
      <title>All-atom contact analysis</title>
      <p>Once H atoms have been added to (or detected in) a structure, then the complete ‘Analyze all-atom contacts and geometry’ option is enabled. A main feature of this option is the all-atom contact analysis, which is performed by the program <italic>PROBE</italic> (Word, Lovell, LaBean <italic>et al.</italic>, 1999<xref ref-type="bibr" rid="bb26"> ▶</xref>). <italic>PROBE</italic> operates by, in effect, rolling a 0.5 Å diameter ball around the van der Waals surfaces of atoms to measure the amount of overlap between pairs of nonbonded atoms. When non-donor–acceptor atoms overlap by more than 0.4 Å, <italic>PROBE</italic> denotes the contact as a serious clash, which is included in the reported clashscore and is shown in kinemage format as a cluster of hot-pink spikes in the overlap region (Fig. 1<xref ref-type="fig" rid="fig1"> ▶</xref>). Such large overlaps cannot occur in the actual molecule, but mean that at least one of the two atoms is modeled incorrectly. <italic>MolProbity</italic> allows users to select any combination of clashes, hydrogen bonds and van der Waals contacts to calculate and display on the structure. By default, all three are enabled for structures that are not excessively large; for large structures, van der Waals contacts are deselected.</p>
      <p>The ‘clashscore’ is the number of serious clashes per 1000 atoms. It is reported in the <italic>MolProbity</italic> summary (top of Fig. 4<xref ref-type="fig" rid="fig4"> ▶</xref>), with a red/yellow/green color coding for absolute quality. The structure’s percentile rank for clashscore value within the relevant resolution range is also given. In the detailed sortable ‘multi-chart’ (an extract is shown below the summary in Fig. 4<xref ref-type="fig" rid="fig4"> ▶</xref>), the worst clash ≥0.4 Å is listed for each residue and highlighted in pink.</p>
    </sec>
    <sec id="sec2.3">
      <label>2.3.</label>
      <title>Torsion-angle combinations: updated Ramachandran and rotamer analyses</title>
      <p>Also included in the ‘Analyze all-atom contacts and geometry’ option is an evaluation of where residues fall in the multi-dimensional distributions of Ramachandran backbone ϕ, ψ angles and side-chain rotamer χ angles. The reference distributions are currently from 100 000 residues in 500 files, quality-filtered at both the file and the residue level. The Ramachandran plots are separated for Gly, Pro and pre-Pro residue types; the general plot has only one in 2000 residues outside the ‘allowed’ contour, which is the same probability as a 3.5σ outlier in a normal distribution. The three specific plots can be robustly contoured only down to excluding one in 500 residues (about 3σ) in the current reference data, but will soon be updated. By ‘robust’ we mean that the contour does not shift with further improvement in resolution or <italic>B</italic> or with different subselections of the data. When values plateau in this way we can define clear absolute goals for the measure, such as 98% for Ramachandran favored, &lt;0.2% for Ramachandran outliers, &lt;1% for poor rotamers and 0 for C<sup>β</sup> deviation outliers; other goal levels given in the summary are more arbitrary.</p>
      <p>However, Ramachandran outliers are of course not rare in general; they increase as a function of resolution (Arendall <italic>et al.</italic>, 2005<xref ref-type="bibr" rid="bb3"> ▶</xref>) and especially of <italic>B</italic> factor (Lovell <italic>et al.</italic>, 2003<xref ref-type="bibr" rid="bb18"> ▶</xref>). Fig. 5<xref ref-type="fig" rid="fig5"> ▶</xref>(<italic>a</italic>) shows the points for an above-average 2.5 Å resolution structure plotted on the smoothed contours of the reference distribution for favored (enclosing 98% of the good data) and allowed (enclosing 99.95% of the good data). The four Ramachandran plots are presented in kinemage and pdf form, scores are given in the multi-criterion chart (Fig. 4<xref ref-type="fig" rid="fig4"> ▶</xref>) and outliers are flagged in green on the multi-criterion kinemage (Figs. 1<xref ref-type="fig" rid="fig1"> ▶</xref> and 2<xref ref-type="fig" rid="fig2"> ▶</xref>).</p>
      <p>Multi-dimensional rotamer distributions for the individual side-chain types are currently contoured only down to excluding 1% of the high-quality data. [All such distributions used in <italic>MolProbity</italic> will be periodically updated to take advantage of the expanding reference data.] These are updates of the ‘penultimate rotamer library’ (Lovell <italic>et al.</italic>, 2000<xref ref-type="bibr" rid="bb19"> ▶</xref>), although certainly not yet ultimate. Above the 1% level sets of χ values are assigned to named rotamers; below 1% they are designated as poor rotamers, not outliers, since they are disfavored but quite possible if stabilized by tight packing or a couple of good hydrogen bonds. However, there is no justification for fitting poor rotamers on the protein surface with no interactions to hold them in an unfavorable conformation. Some bad rotamers result from systematic errors arising from fitting branched side chains (Thr/Val/Ile/Leu/Arg) backwards into ambiguous density. The two major systematic errors for Leu are described in Lovell <italic>et al.</italic> (2000<xref ref-type="bibr" rid="bb19"> ▶</xref>) and are given zero rotamer-quality scores in <italic>MolProbity</italic>; other cases are discussed in §<xref ref-type="sec" rid="sec3.2"/>3.2. Poor rotamers are scored in the multi-criterion chart and are represented by gold side chains in the multi-criterion kinemages (Figs. 1<xref ref-type="fig" rid="fig1"> ▶</xref> and 2<xref ref-type="fig" rid="fig2"> ▶</xref>). The <italic>Mol­Probity</italic> summary (top of Fig. 4<xref ref-type="fig" rid="fig4"> ▶</xref>) reports the percentage of residues with poor rotamers, Ramachandran outliers and Ramachandran favored conformations.</p>
    </sec>
    <sec id="sec2.4">
      <label>2.4.</label>
      <title>Covalent-geometry analyses</title>
      <p><italic>MolProbity</italic> now evaluates backbone bond-length and bond-angle outliers. Mean overall deviations in geometrical parameters are a measure of correct procedures and weights in refinement, but not of structural accuracy. Local geometry outliers ≥4σ, however, are most often the indirect result of local misfitting and are thus very useful diagnostics, especially for bond angles. [Note that some such problems occur even at very high resolution, either at the ends of alternate conformations or in under-restrained regions with high <italic>B</italic> factor.] A major recent addition to <italic>MolProbity</italic> is the ability to assess the ideality of covalent backbone geometry for protein and RNA with the Java program <italic>DANGLE</italic>, which is also available for standalone command-line use from the software section at <ext-link ext-link-type="uri" xlink:href="http://kinemage.biochem.duke.edu">http://kinemage.biochem.duke.edu</ext-link>. New and more intuitive visualizations for backbone bond-length and angle deviations have been developed for display on the three-dimensional structure. For bond lengths, a ‘spring’ is drawn along the bond axis and scaled such that the ideal distance is equivalent to six turns and 4σ deviation corresponds to one turn of stretching or compaction (Fig. 1<xref ref-type="fig" rid="fig1"> ▶</xref>). For bond angles, bold lines are drawn to represent the ideal angle and a fan of increasingly thin lines fades out across the model <italic>versus</italic> ideal angle difference to highlight the extent of the deviation (Fig. 1<xref ref-type="fig" rid="fig1"> ▶</xref>). In each case model values greater (or less) than the corresponding ideal value by at least 4σ are displayed in red (or blue) and are listed on the multi-criterion chart. Protein backbone parameters were derived from Engh &amp; Huber (2001<xref ref-type="bibr" rid="bb11"> ▶</xref>) and nucleic acid backbone parameters from Parkinson <italic>et al.</italic> (1996<xref ref-type="bibr" rid="bb21"> ▶</xref>).</p>
      <p>The C<sup>α</sup> atom is where local problems with backbone or side-chain fitting must be reconciled. This affects the bond angles or improper dihedrals that define the C<sup>β</sup> position, but can be manifested in almost any combination of those individual parameters. Therefore, <italic>MolProbity</italic> evaluates the resulting overall distortion of the C<sup>β</sup> position from ideality, called the C<sup>β</sup> deviation (Lovell <italic>et al.</italic>, 2003<xref ref-type="bibr" rid="bb18"> ▶</xref>). Residues with a C<sup>β</sup> deviation of ≥0.25 Å are flagged in the chart and shown in the kinemage as a magenta ball centered on the ideal position (calculated from the backbone coordinates and allowing for changes in the τ angle) and tangent to the modeled position (Fig. 1<xref ref-type="fig" rid="fig1"> ▶</xref>), since we have found that values of ≥0.25 Å are very often correlated with some form of local misfitting. Fig. 5<xref ref-type="fig" rid="fig5"> ▶</xref>(<italic>b</italic>) shows a separate plot produced for all the C<sup>β</sup> deviation values in a structure, shown relative to the ideal C<sup>β</sup> position. The Leu and Trp C<sup>β</sup> outliers in each chain form a tight turn with a suspicious peptide orientation and eight other outliers and so must represent some form of misfitting.</p>
    </sec>
    <sec id="sec2.5">
      <label>2.5.</label>
      <title>Nucleic acid analyses</title>
      <p>Nucleic acids are treatable equivalently to proteins for all-atom contacts and clashscore and for bond-length and bond-angle analyses, as long as the correct parameter sets are used. Both DNA and RNA show more non-uniform distribution of local problems than do proteins, with the bases and phosphates located well and the rest of the sugar-phosphate backbone very prone to errors (Word, Lovell, Richardson <italic>et al.</italic>, 1999<xref ref-type="bibr" rid="bb27"> ▶</xref>; Murray <italic>et al.</italic>, 2003<xref ref-type="bibr" rid="bb20"> ▶</xref>), since it has many torsion variables and rather indistinct electron density at moderate resolutions. All-atom contacts are very helpful in diagnosing backbone misfitting, especially for RNA structures, which are rapidly gaining biological interest and structural attention.</p>
      <p>In addition, <italic>MolProbity</italic> now includes diagnosis of suspect ribose puckers and torsion-angle analysis of preferred RNA backbone conformers. We have found that the dominant C3′-­<italic>endo</italic> and C2′-<italic>endo</italic> sugar puckers are highly correlated to the perpendicular distance between the C1′–N1/9 glycosidic bond vector and the following (3′) phosphate: &gt;2.9 Å for C3′-­<italic>endo</italic> and &lt;2.9 Å for C2′-<italic>endo</italic>. <italic>MolProbity</italic> checks this distance against the modeled sugar pucker, as well as outliers in individual ∊ or δ values. All such outliers are listed in the multi-chart and ribose-pucker outliers are flagged in the kinemage (Fig. 1<xref ref-type="fig" rid="fig1"> ▶</xref>). An example is shown in Fig. 6<xref ref-type="fig" rid="fig6"> ▶</xref>, where what should have been a C2′-<italic>endo</italic> pucker (by the short perpendicular) was fitted as an intermediate unfavorable pucker close to the more common default C3′-<italic>endo</italic> pucker, also producing geometry and ∊ outliers.</p>
      <p>High-dimensional analysis of the combinations of backbone torsion angles within an RNA ‘suite’ (the unit from sugar to sugar) has shown that there are distinct ‘rotameric’ backbone conformers. The RNA Ontology Consortium has defined a two-character nomenclature and an initial set of 54 favorable RNA backbone conformers (Richardson <italic>et al.</italic>, 2008<xref ref-type="bibr" rid="bb22"> ▶</xref>). We created the <italic>SUITENAME</italic> program to identify either the named conformer or an outlier for each suite in an RNA structure. These conformers and their ‘suiteness’ quality score are listed in the <italic>MolProbity</italic> multi-chart.</p>
    </sec>
    <sec id="sec2.6">
      <label>2.6.</label>
      <title>The overall <italic>MolProbity</italic> score</title>
      <p>In response to user demand, the ‘<italic>MolProbity</italic> score’ provides a single number that represents the central <italic>Mol­Probity</italic> protein quality statistics. It is a log-weighted combination of the clashscore, percentage Ramachandran not favored and percentage bad side-chain rotamers, giving one number that reflects the crystallographic resolution at which those values would be expected. Therefore, a structure with a numerically lower <italic>MolProbity</italic> score than its actual crystallo­graphic resolution is, quality-wise, better than the average structure at that resolution. There is some distortion in the fit at very high or very low resolutions; for these ranges it is preferable to judge by the resolution-specific percentile score, which is also reported in the summary. Percentile scores are currently given for clashscore and for <italic>MolProbity</italic> score relative to the cohort of PDB structures within 0.25 Å of the file’s resolution.</p>
    </sec>
  </sec>
  <sec id="sec3">
    <label>3.</label>
    <title>Correction of outliers</title>
    <sec id="sec3.1">
      <label>3.1.</label>
      <title>Manual rebuilding</title>
      <p>Except for Asn/Gln/His flip corrections, <italic>MolProbity</italic> does not yet directly include the ability to correct the errors it finds in structures; it relies on users having access to standalone local software for rebuilding and refinement. The stand­alone version of <italic>KiNG</italic> has some rebuilding tools for modeling side chains and making small local ‘backrub’ adjustments to structures, with the help of electron-density display, interactive contact dots and rotamer evaluation (Davis <italic>et al.</italic>, 2006<xref ref-type="bibr" rid="bb8"> ▶</xref>; Chen <italic>et al.</italic>, 2009<xref ref-type="bibr" rid="bb7"> ▶</xref>). Fig. 7<xref ref-type="fig" rid="fig7"> ▶</xref> illustrates such a correction process in <italic>KiNG</italic>, rebuilding a backward-fitted leucine with a clash and a bad rotamer (one of the cases of a systematic error), resulting in an ideal geometry side chain with an excellent rotamer and well packed all-atom contacts. The top view shows that the original and rebuilt side chains fit the terminal methyls into the same rather ambiguous density, but move the C<sup>γ</sup> substantially. More recent versions of this DNA polymerase structure (<italic>e.g.</italic> PDB code <ext-link ext-link-type="uri" xlink:href="http://scripts.iucr.org/cgi-bin/cr.cgi?rm=pdb&amp;pdbId=2hhv">2hhv</ext-link> at 1.55 Å resolution; Warren <italic>et al.</italic>, 2006<xref ref-type="bibr" rid="bb25"> ▶</xref>) all use the new conformation. Manual rebuilding is facilitated by the fact that all-atom clashes are inherently directional, as are bond-angle distortions, while a good library of rotamer choices helps the user test all the alternatives.</p>
      <p>For more extensive refitting, a fully featured crystallo­graphic rebuilding program such as <italic>Coot</italic> (Emsley &amp; Cowtan, 2004<xref ref-type="bibr" rid="bb10"> ▶</xref>) is needed. <italic>MolProbity</italic> generates ‘to-do’ scripts that can be read into <italic>Coot</italic>, bringing up a button list, where each entry will zoom to a problem area. In combination with the ability of <italic>Coot</italic> to use <italic>REDUCE</italic> and <italic>PROBE</italic> interactively to generate all-atom contact dots, these features make it easier to address the problems diagnosed by <italic>MolProbity</italic>. Any rebuilding that moves atoms must of course then undergo further crystallo­graphic refinement. Our own laboratory tested the combined cycle of <italic>MolProbity</italic>, rebuilding and refinement on about 30 protein structures as part of the SouthEast Collaboratory for Structural Genomics (Arendall <italic>et al.</italic>, 2005<xref ref-type="bibr" rid="bb3"> ▶</xref>), finding that its early application led to a smoother structure-solution process and demonstrably better final structures. In addition to backward-fitted side chains, commonly corrected problems included peptide flips, switched backbone and side chain near chain ends, ‘waters’ that were really ions, noise peaks or unfit alternate conformations and occasionally a shift in sequence register. Many other crystallographic groups have since adopted these methods.</p>
    </sec>
    <sec id="sec3.2">
      <label>3.2.</label>
      <title>Automated corrections</title>
      <p>For correcting RNA-suite outliers, we have collaboratively developed the independent program <italic>RNABC</italic> (Wang <italic>et al.</italic>, 2008<xref ref-type="bibr" rid="bb24"> ▶</xref>), which performs an automated search for more suitable backbone conformations of an RNA suite diagnosed with a bad ribose pucker or serious clashes. It leaves the more accurately determined bases and P atoms fixed in place and performs a pruned but systematic search through the other parameters, outputting all acceptable alternatives found within user-set tolerance limits.</p>
      <p>Recently, we have developed and tested the <italic>AUTOFIX</italic> program for automated correction of diagnosed backward-fitted Thr, Val, Leu and Arg side chains (Headd <italic>et al.</italic>, 2009<xref ref-type="bibr" rid="bb12"> ▶</xref>). In contrast to Asn/Gln/His flips, which simply exchange atoms and do not change the agreement with the data, these more complex side chains require real-space refinement in order to determine the proper correction and crystallographic re-refinement after the approximate 180° flips have been made. The original version used <italic>Coot</italic> to perform rotamer selection and real-space refinement for the proposed corrections, with <italic>MolProbity</italic> diagnosis before and after. Results were checked by re-refinement. Run on a sample of 945 PDB files, <italic>AUTOFIX</italic> accepted corrections for over 40% of diagnosed bad Thr, Val and Leu side chains and 15% of bad Arg side chains, or 3679 corrected side chains. A second version is now in the testing stage that substitutes <italic>PHENIX</italic> real-space refinement, has a faster Python wrapper and also works on Ile. It will soon be incorporated into <italic>MolProbity</italic>. The most important of our requirements for <italic>AUTOFIX</italic> is that it does no harm; we are willing to miss some of the possible corrections in order to ensure that those we accept are essentially always true improvements. <italic>AUTOFIX</italic> should provide <italic>MolProbity</italic> users with an easy and reliable way of making an initial set of meaningful improvements to their protein structures. Thr and Arg, in particular, make hydrogen bonds that are often important at active sites or binding interfaces and since they are asymmetrical these interactions change drastically if the side chain is fitted backwards. Such improvements were often seen in the test set.</p>
    </sec>
  </sec>
  <sec id="sec4">
    <label>4.</label>
    <title>Other <italic>MolProbity</italic> utility functions</title>
    <sec id="sec4.1">
      <label>4.1.</label>
      <title>Interface analysis</title>
      <p><italic>PROBE</italic> can also be used to calculate the all-atom contacts at interfaces, <italic>e.g.</italic> between two chains of a structure or between a protein and a ligand. Access to this feature is provided in <italic>MolProbity</italic> by the ‘Visualize interface contacts’ analysis option after H atoms have been added. The user is required to choose the chains and/or the molecular types for which to calculate the contacts (<italic>e.g.</italic> protein <italic>versus</italic> protein or protein <italic>versus</italic> heteroatoms or RNA). This functionality creates both a kinemage with the resulting all-atom contacts displayed on the model and a text list of the atom pairs in contact.</p>
    </sec>
    <sec id="sec4.2">
      <label>4.2.</label>
      <title>Protein loop fitting</title>
      <p><italic>MolProbity</italic> includes the Java software <italic>JIFFILOOP</italic> for providing potential protein-fragment conformations that can fit within a gap in a protein structure. We have defined a seven-parameter system that describes the spatial relationship between any two peptides. Briefly, this system consists of the sequence separation, the distance between the two inner C<sup>α</sup> atoms, two pseudo-angles and three pseudo-dihedrals. We used this system to create a library of <italic>B</italic>-factor-filtered fragments from one to 15 peptides long from our Top5200 database of structures, a set of structures chosen from each 70% nonredundant group defined by the PDB, requiring an average of resolution and <italic>MolProbity</italic> score of ≤2.0. <italic>MolProbity</italic> runs <italic>JIFFILOOP</italic> to search this library for candidate fragments to fill gaps within a structure. Alternatively, users can enter beginning and ending residue numbers and <italic>MolProbity</italic> will search for fragments which can fit between those two residues. Because this process can be fairly time-intensive, <italic>JIFFILOOP</italic> is not listed under ‘Suggested Tools’ and is currently only accessible under ‘All Tools’ or at the Site map. Also, owing to the size of this package it must be added separately to the installation for a standalone <italic>MolProbity</italic> server.</p>
    </sec>
    <sec id="sec4.3">
      <label>4.3.</label>
      <title>Kinemage construction and viewing</title>
      <p><italic>MolProbity</italic> provides scripts (under the ‘Make simple kinemages’ option) for constructing a number of commonly used kinemage three-dimensional interactive visualization options such as ribbons and various types of stick figures. This functionality is useful for quick browsing of a structure or for initial creation of an illustration or presentation. The file-input page can also accept upload of pre-existing kinemage files for direct on-line viewing within the built-in kinemage viewer <italic>KiNG</italic>.</p>
    </sec>
    <sec id="sec4.4">
      <label>4.4.</label>
      <title>Other file types and functions</title>
      <p><italic>MolProbity</italic> uses a built-in PDB ‘het_dictionary’ for the information needed to add H atoms to small-molecule ligands. The user can construct and read in a custom dictionary if their file contains novel ligands. There is also provision for either uploading or fetching an electron-density map from the Electron Density Server (Kleywegt <italic>et al.</italic>, 2004<xref ref-type="bibr" rid="bb16"> ▶</xref>) in any of several formats to view on-line in <italic>KiNG</italic> together with the model and validation results. To investigate functional sites that span across asymmetric units, one can fetch a biological unit file from the PDB. In the file-editing feature, the user can specify whether multiple ‘models’ are alternatives (as in an NMR ensemble) or have been pressed into service for the extra chains in the biological unit. Some X-ray structures are now treated as ensembles. For such cases, <italic>MolProbity</italic> internally splits the models and analyzes them separately, but constructs an outlier summary strip-chart and a multi-model multi-criterion validation kinemage with both the models and their features under on/off button control. File editing also allows the deletion of chains either before or after hydrogen placement, specifying the resolution of the structure if not given in the file header or removing unwanted H atoms. These tools make it easier and faster to analyze particular parts of a structure using <italic>MolProbity</italic> and they help to maintain compatibility with other older software. These options are always available as separate utility functions, independent of validation or hydrogen content.</p>
    </sec>
    <sec id="sec4.5">
      <label>4.5.</label>
      <title>PDB-format interconversion</title>
      <p>The release of the remediated PDB version 3.0 format in August 2007 included a number of significant changes, particularly to H-atom names and to nucleic acid residue and atom names. In order to maintain compatibility with the PDB, we converted the entire <italic>MolProbity</italic> core to use the new format by default. This included updating <italic>REDUCE</italic>, <italic>PROBE</italic>, <italic>KiNG</italic> and <italic>PREKIN</italic>. However, we realised that users might need to analyze files that were still in the older PDB version 2.3 format. In order to maintain backwards compatibility, we created a Remediator script (available as a standalone Perl or Python script) that can interconvert between the old and the new PDB formats. Whenever a file is input, <italic>MolProbity</italic> will scan for the presence of old-format atom names and if it detects any then it will run the Remediator script to automatically convert the input file to the new format. After analysis there is then an option available to run the Remediator script and downgrade the output file back into the old version 2.3 format if needed. This allows use of the <italic>MolProbity</italic> analysis tools even together with older software that has not been updated to use the new format.</p>
    </sec>
  </sec>
  <sec id="sec5" sec-type="discussion|interpretation">
    <label>5.</label>
    <title>Discussion</title>
    <sec id="sec5.1">
      <label>5.1.</label>
      <title>Global <italic>versus</italic> local, absolute <italic>versus</italic> comparative</title>
      <p>There are three quite different purposes served by structure validation: a gatekeeper function on quality for reviewers or organizations, an aid to crystallographers for obtaining the most model accuracy from their data and a guide to end users for choosing appropriate structures and confidence levels for the conclusions they want to draw.</p>
      <p>Validation criteria also come in distinct flavors. Those based on the diffraction data are inherently global with respect to the model; for instance, resolution (which is still the most valuable single-factor estimate of model accuracy) and <italic>R</italic>
               <sub>free</sub> (Brünger, 1992<xref ref-type="bibr" rid="bb6"> ▶</xref>). On the data side, there are also gatekeeper checks for unusual problems such as twinning or gross data incompleteness. R.m.s.d. or r.m.s.<italic>Z</italic>. of deviations from geo­metrical target values are global, but they only evaluate procedural aspects of refinement and have little to do with model accuracy. Most other validation criteria are inherently local (at the residue or even atom level), including <italic>B</italic> factor, real-space measures such as RSR-<italic>Z</italic> (Kleywegt <italic>et al.</italic>, 2004<xref ref-type="bibr" rid="bb16"> ▶</xref>) and model-only measures such as the various <italic>MolProbity</italic> criteria described here. Any local measure becomes global when expressed in some normalized form across the entire structure, such as an average, a distribution match or a percentage occurrence of outliers.</p>
      <p>Strictly local measures are usually not resolution-dependent, but their globally defined versions often are. For some purposes, the desirable form of measure is a comparison (usually a percentile rank) with the cohort of PDB structures at similar resolution. <italic>MolProbity</italic> currently provides resolution-group percentiles for clashscore and for <italic>MolProbity</italic> score and will probably expand that to other criteria.</p>
      <p>Reviewer/gatekeepers are primarily interested in global relative measures such as resolution-dependent percentiles and to some extent in absolute local flags for judging the support behind specific claims. Crystallographers need global relative measures to judge how well they have made use of their data, but it is the local measures, especially specific outliers, that are crucial to helping them to achieve a more accurate structure and to avoid making any dubious claims in poor local regions (such as an invisible inhibitor). End users need absolute global measures to choose between structures and absolute local measures to judge the reliability of the particular features they find of interest.</p>
      <p>Because of the importance of improving and evaluating the accuracy of individual details of biological importance, both in each structure and in the database as a whole, we have chosen in <italic>MolProbity</italic> to emphasize calculation and user-friendly display of local indicators. We have also tried to minimize ‘false alarms’, so that a flagged outlier is almost always worth a close look.</p>
    </sec>
    <sec id="sec5.2">
      <label>5.2.</label>
      <title>Impact on database quality</title>
      <p>Since <italic>MolProbity</italic> was first made available in late 2002, serious user work sessions (performing some operation on an input coordinate file) have multiplied by a large factor each year, with a cumulative total that is now approaching 100 000 by thousands of distinct users. In addition, many companies and structural genomics centers run their own <italic>MolProbity</italic> servers internally and some aspects have been incorporated into other software or meta-servers. 80% of <italic>MolProbity</italic> input files are uploaded, presumably by working structural biologists, and the rest are fetched from databases, presumably by end users. Those end users also include students, since <italic>MolProbity</italic> is increasingly being used for instructional exercises in bio­chemistry classes from high school to graduate level.</p>
      <p><italic>MolProbity</italic>’s unique feature is clash analysis from all-atom contacts, which provides sensitive new evaluation independent of refinement targets. Not surprisingly, the average clashscore remained constant (either globally or by resolution) up to 2002, since there was then no feasible way of targeting or even measuring all-atom clashes. The percentage of incorrect Asn/Gln/His flips also remained level or rose slightly prior to 2003, despite the availability of a hydrogen-bond-based system in <italic>WHAT IF</italic> (Hooft <italic>et al.</italic>, 1996<xref ref-type="bibr" rid="bb14"> ▶</xref>), and even while refinement methods, automation and Ramachandran and rotamer quality all improved.</p>
      <p>To evaluate the contribution <italic>MolProbity</italic> has made to crystallographic model quality in general, we have therefore plotted clashscore and Asn/Gln/His flips as a function of time in Fig. 8<xref ref-type="fig" rid="fig8"> ▶</xref>, with separate linear fits before and after the end of 2002. Gratifyingly, in both cases there is a clear trend of improvement since 2003. Median values also improve very steadily over that period. Anecdotal evidence indicates that this trend is mainly a consequence of thorough adoption of <italic>MolProbity</italic>-based methods by a small but growing fraction of crystallographers and there is therefore still much scope for further improvement in the future.</p>
    </sec>
  </sec>
  <sec id="sec6">
    <label>6.</label>
    <title><italic>MolProbity</italic> availability</title>
    <p><italic>MolProbity</italic> is freely available for download from <ext-link ext-link-type="uri" xlink:href="http://molprobity.biochem.duke.edu">http://molprobity.biochem.duke.edu</ext-link> for use as a local server. This option requires either Linux or MacOSX, together with PHP and Apache. Instructions for installing <italic>MolProbity</italic> locally are included with the download. Having a local install allows users to access the <italic>MolProbity</italic> analysis tools without internet access, as well as allowing companies with privacy or confidentiality concerns to use <italic>MolProbity</italic>. However, one of the most significant advantages to having a local installation of <italic>Mol­Probity</italic> is access to command-line tools. These tools provide access to the major analysis tools in <italic>MolProbity</italic> without having to use the web interface. Also, several scripts are included which allow users to run <italic>MolProbity</italic> analysis on a set of files rather than just one at a time. Some of the more useful command-line scripts include the following: scripts for adding H atoms, with or without flips, a script for obtaining overall scores for a set of files and a script for calculating a residue-by-residue analysis of a structure.</p>
    <p>For users of the <italic>PHENIX</italic> crystallography system (Adams <italic>et al.</italic>, 2002<xref ref-type="bibr" rid="bb2"> ▶</xref>, 2009<xref ref-type="bibr" rid="bb1"> ▶</xref>), a number of the main <italic>MolProbity</italic> quality-analysis tools have been incorporated directly into <italic>PHENIX</italic> and are accessible through command-line tools or in the <italic>PHENIX</italic> GUI, including <italic>REDUCE</italic>, <italic>PROBE</italic>, <italic>RAMALYZE</italic>, <italic>ROTALYZE</italic>, <italic>CBETADEV</italic> and <italic>CLASHSCORE</italic>. Currently, only tabular results are provided; we are exploring the possibility of incorporating <italic>KiNG</italic> and validation visualizations into <italic>PHENIX</italic>.</p>
    <p>All of the individual programs called by <italic>MolProbity</italic> are also available, multi-platform and open source, from the software section at <ext-link ext-link-type="uri" xlink:href="http://kinemage.biochem.duke.edu">http://kinemage.biochem.duke.edu</ext-link>.</p>
  </sec>
</body>
<back>
  <ack>
    <p>Ian Davis is the initial developer of the <italic>MolProbity</italic> site, Xueyi Wang and Jack Snoeyink programmed RNABC, Jeremy Block developed <italic>MolProbity</italic> functions for NMR and the <italic>PHENIX</italic> development team at LBL were very helpful with <italic>AUTOFIX</italic> and with integration of <italic>MolProbity</italic> functions. <italic>MolProbity</italic> development is supported by <funding-source>NIH</funding-source> grant <award-id>GM73919</award-id>.</p>
  </ack>
  <ref-list>
    <title>References</title>
    <ref id="bb1">
      <mixed-citation publication-type="other">Adams, P. D., Afonine, P., Grosse-Kunstleve, R. W., Read, R. J., Richardson, J. S., Richardson, D. C. &amp; Terwilliger, T. C. (2009). <italic>Curr. Opin. Struct. Biol.</italic><bold>19</bold>, 1–7.</mixed-citation>
    </ref>
    <ref id="bb2">
      <mixed-citation publication-type="other">Adams, P. D., Grosse-Kunstleve, R. W., Hung, L.-W., Ioerger, T. R., McCoy, A. J., Moriarty, N. W., Read, R. J., Sacchettini, J. C., Sauter, N. K. &amp; Terwilliger, T. C. (2002).<italic> Acta Cryst.</italic> D<bold>58</bold>, 1948–1954.</mixed-citation>
    </ref>
    <ref id="bb3">
      <mixed-citation publication-type="other">Arendall, W. B. III, Tempel, W., Richardson, J. S., Zhou, W., Wang, S., Davis, I. W., Liu, Z.-J., Rose, J. P., Carson, W. M., Luo, M., Richardson, D. C. &amp; Wang, B.-C. (2005).<italic> J. Struct. Funct. Genomics</italic>, <bold>6</bold>, 1–11.</mixed-citation>
    </ref>
    <ref id="bb4">
      <mixed-citation publication-type="other">Berman, H. M., Olson, W. K., Beveridge, D. L., Westbrook, J., Gelbin, A., Demeny, T., Hsieh, S.-H., Srinivasan, A. R. &amp; Schneider, B. (1992). <italic>Biophys. J.</italic><bold>63</bold>, 751–759.</mixed-citation>
    </ref>
    <ref id="bb5">
      <mixed-citation publication-type="other">Berman, H. M., Westbrook, J., Feng, Z., Gilliland, G., Bhat, T. N., Weissig, H., Shindyalov, I. N. &amp; Bourne, P. E. (2000). <italic>Nucleic Acids Res.</italic><bold>28</bold>, 235–242.</mixed-citation>
    </ref>
    <ref id="bb6">
      <mixed-citation publication-type="other">Brünger, A. T. (1992). <italic>Nature (London)</italic>, <bold>355</bold>, 472–475.</mixed-citation>
    </ref>
    <ref id="bb7">
      <mixed-citation publication-type="other">Chen, V. B., Davis, I. W. &amp; Richardson, D. C. (2009). <italic>Protein Sci.</italic><bold>18</bold>, 2403–2409.</mixed-citation>
    </ref>
    <ref id="bb8">
      <mixed-citation publication-type="other">Davis, I. W., Arendall, W. B. III, Richardson, D. C. &amp; Richardson, J. S. (2006). <italic>Structure</italic>, <bold>14</bold>, 265–274.</mixed-citation>
    </ref>
    <ref id="bb9">
      <mixed-citation publication-type="other">Davis, I. W., Leaver-Fay, A., Chen, V. B., Block, J. N., Kapral, G. J., Wang, X., Murray, L. W., Arendall, W. B. III, Snoeyink, J., Richardson, J. S. &amp; Richardson, D. C. (2007). <italic>Nucleic Acids Res.</italic><bold>35</bold>, W375–W383.</mixed-citation>
    </ref>
    <ref id="bb10">
      <mixed-citation publication-type="other">Emsley, P. &amp; Cowtan, K. (2004). <italic>Acta Cryst.</italic> D<bold>60</bold>, 2126–2132.</mixed-citation>
    </ref>
    <ref id="bb11">
      <mixed-citation publication-type="other">Engh, R. A. &amp; Huber, R. (2001). <italic>International Tables for Crystallo­graphy</italic>, Vol. <italic>F</italic>, edited by M. G. Rossmann &amp; E. Arnold, pp. 382–392. Dordrecht: Kluwer Academic Publishers.</mixed-citation>
    </ref>
    <ref id="bb12">
      <mixed-citation publication-type="other">Headd, J. J., Immormino, R. M., Keedy, D. A., Emsley, P., Richardson, D. C. &amp; Richardson, J. S. (2009). <italic>J. Struct. Funct. Genomics</italic>, <bold>10</bold>, 83–93.</mixed-citation>
    </ref>
    <ref id="bb13">
      <mixed-citation publication-type="other">Higman, V. A., Boyd, J., Smith, L. J. &amp; Redfield, C. (2004). <italic>J. Biomol. NMR</italic>, <bold>30</bold>, 327–346.</mixed-citation>
    </ref>
    <ref id="bb14">
      <mixed-citation publication-type="other">Hooft, R. W. W., Sander, C. &amp; Vriend, G. (1996). <italic>Proteins</italic>, <bold>26</bold>, 363–376.</mixed-citation>
    </ref>
    <ref id="bb15">
      <mixed-citation publication-type="other">Kiefer, J. R., Mao, C., Hansen, C. J., Basehore, S. L., Hogrefe, H. H., Braman, J. C. &amp; Beese, L. S. (1997). <italic>Structure</italic>, <bold>5</bold>, 95–108.</mixed-citation>
    </ref>
    <ref id="bb16">
      <mixed-citation publication-type="other">Kleywegt, G. J., Harris, M. R., Zou, J., Taylor, T. C., Wählby, A. &amp; Jones, T. A. (2004). <italic>Acta Cryst.</italic> D<bold>60</bold>, 2240–2249.</mixed-citation>
    </ref>
    <ref id="bb17">
      <mixed-citation publication-type="other">Li, S. <italic>et al.</italic> (2002). <italic>J. Biol. Chem.</italic><bold>277</bold>, 48596–48601.</mixed-citation>
    </ref>
    <ref id="bb18">
      <mixed-citation publication-type="other">Lovell, S. C., Davis, I. W., Arendall, W. B. III, de Bakker, P. I. W., Word, J. M., Prisant, M. G., Richardson, J. S. &amp; Richardson, D. C. (2003). <italic>Proteins</italic>, <bold>50</bold>, 437–450.</mixed-citation>
    </ref>
    <ref id="bb19">
      <mixed-citation publication-type="other">Lovell, S. C., Word, J. M., Richardson, J. S. &amp; Richardson, D. C. (2000).<italic> Proteins</italic>, <bold>40</bold>, 389–408.</mixed-citation>
    </ref>
    <ref id="bb20">
      <mixed-citation publication-type="other">Murray, L. J. W., Arendall, W. B. III, Richardson, D. C. &amp; Richardson, J. S. (2003). <italic>Proc. Natl Acad. Sci. USA</italic>, <bold>100</bold>, 13904–13909.</mixed-citation>
    </ref>
    <ref id="bb21">
      <mixed-citation publication-type="other">Parkinson, G., Vojtechovsky, J., Clowney, L., Brünger, A. T. &amp; Berman, H. M. (1996). <italic>Acta Cryst.</italic> D<bold>52</bold>, 57–64.</mixed-citation>
    </ref>
    <ref id="bb22">
      <mixed-citation publication-type="other">Richardson, J. S., Schneider, B., Murray, L. W., Kapral, G. J., Immormino, R. M., Headd, J. J., Richardson, D. C., Ham, D., Hershkovits, E., Williams, L. D., Keating, K. S., Pyle, A. M., Micallef, D., Westbrook, J. &amp; Berman, H. M. (2008). <italic>RNA</italic>, <bold>14</bold>, 465–481.</mixed-citation>
    </ref>
    <ref id="bb23">
      <mixed-citation publication-type="other">Sekine, S., Nureki, O., Dubois, D. Y., Bernier, S., Chenevert, R., Lapointe, J., Vassylyev, D. G. &amp; Yokoyama, S. (2003). <italic>EMBO J.</italic><bold>22</bold>, 676–688.</mixed-citation>
    </ref>
    <ref id="bb24">
      <mixed-citation publication-type="other">Wang, X., Kapral, G., Murray, L., Richardson, D., Richardson, J. &amp; Snoeyink, J. (2008). <italic>J. Math. Biol.</italic><bold>56</bold>, 253–278.</mixed-citation>
    </ref>
    <ref id="bb25">
      <mixed-citation publication-type="other">Warren, J. J., Forsberg, L. J. &amp; Beese, L. S. (2006). <italic>Proc. Natl Acad. Sci. USA</italic>, <bold>103</bold>, 19701–19706.</mixed-citation>
    </ref>
    <ref id="bb26">
      <mixed-citation publication-type="other">Word, J. M., Lovell, S. C., LaBean, T. H., Taylor, H. C., Zalis, M. E., Presley, B. K., Richardson, J. S. &amp; Richardson, D. C. (1999). <italic>J. Mol. Biol.</italic><bold>285</bold>, 1711–1733.</mixed-citation>
    </ref>
    <ref id="bb27">
      <mixed-citation publication-type="other">Word, J. M., Lovell, S. C., Richardson, J. S. &amp; Richardson, D. C. (1999). <italic>J. Mol. Biol.</italic><bold>285</bold>, 1735–1747.</mixed-citation>
    </ref>
  </ref-list>
</back>
<floats-group>
  <fig id="fig1" position="float">
    <label>Figure 1</label>
    <caption>
      <p>An outlier legend, showing each symbol used in a <italic>MolProbity</italic> multi-criterion kinemage and illustrating the relationship of the three types of all-atom contact to the atomic van der Waals (vdW) surfaces (spheres of small gray dots). The symbols for favorable hydrogen bonds and vdW contacts are included for completeness, as well as the hot-pink spikes of a clash outlier. A C<sup>β</sup> deviation of ≥0.25 Å is shown as a magenta ball centered on the ideal C<sup>β</sup> position and tangent to the modeled position. Bad rotamers are shown as gold side chains and Ramachandran outliers as heavy green lines to the midpoints of the two peptides. Bond-angle outliers are indicated by a fan of lines from the ideal to the modeled bond (red if wide, blue if narrow). Bond-length outliers are indicated as stretched (red) or compressed (blue) springs. A suspicious ribose pucker is diagnosed by the perpendicular distance from the 3′ (following) phosphate to the line of the glycosidic C1′—N1/9 bond and is flagged by a representation of that construction (in magenta if too short, as here, and in purple if too long).</p>
    </caption>
    <graphic xlink:href="d-66-00012-fig1"/>
  </fig>
  <fig id="fig2" position="float">
    <label>Figure 2</label>
    <caption>
      <p>Two multi-criterion validation kinemages illustrating the successful outcome of an overall process of <italic>MolProbity</italic> diagnosis and structure improvement. (<italic>a</italic>) The original <ext-link ext-link-type="uri" xlink:href="http://scripts.iucr.org/cgi-bin/cr.cgi?rm=pdb&amp;pdbId=1lpl">1lpl</ext-link> Cap-Gly structure (Li <italic>et al.</italic>, 2002<xref ref-type="bibr" rid="bb17"> ▶</xref>) shows three major clusters of clash, rotamer and Ramachandran problems plus a few isolated outliers. (<italic>b</italic>) The corrected <ext-link ext-link-type="uri" xlink:href="http://scripts.iucr.org/cgi-bin/cr.cgi?rm=pdb&amp;pdbId=1tov">1tov</ext-link> structure (Arendall <italic>et al.</italic>, 2005<xref ref-type="bibr" rid="bb3"> ▶</xref>) has essentially no outliers, a 4% lower <italic>R</italic>
                  <sub>free</sub>, a bound sulfate and an additional turn of helix at the N-terminus.</p>
    </caption>
    <graphic xlink:href="d-66-00012-fig2"/>
  </fig>
  <fig id="fig3" position="float">
    <label>Figure 3</label>
    <caption>
      <p>The simple ‘flip’ correction of a Gln side-chain amide in the <ext-link ext-link-type="uri" xlink:href="http://scripts.iucr.org/cgi-bin/cr.cgi?rm=pdb&amp;pdbId=2dq4">2dq4</ext-link> threonine 3-dehydrogenase structure (R. Omi, T. Yao, M. Goto, I. Miyahara &amp; K. Hirotsu, unpublished work), a better-than-average 2.5 Å resolution structure. Both orientations make a hydrogen bond to the crystallographic water, but the original has a serious internal clash of the NH<sub>2</sub> group with its own C<sup>β</sup> hydrogen.</p>
    </caption>
    <graphic xlink:href="d-66-00012-fig3"/>
  </fig>
  <fig id="fig4" position="float">
    <label>Figure 4</label>
    <caption>
      <p>A <italic>MolProbity</italic> results summary and sortable multi-criterion chart for the <ext-link ext-link-type="uri" xlink:href="http://scripts.iucr.org/cgi-bin/cr.cgi?rm=pdb&amp;pdbId=1n78">1n78</ext-link> Glu tRNA-synthetase complex at 2.1 Å resolution (Sekine <italic>et al.</italic>, 2003<xref ref-type="bibr" rid="bb23"> ▶</xref>). The summary gives numerical values, goals and relative percentiles for clashscore, torsion angle and geometry criteria for both protein and nucleic acid components, with traffic light color-coding for good and bad values. Below the summary is a short extract from the detailed chart with values and specifics for each criterion on each residue. Notice that outliers (highlighted) tend to cluster.</p>
    </caption>
    <graphic xlink:href="d-66-00012-fig4"/>
  </fig>
  <fig id="fig5" position="float">
    <label>Figure 5</label>
    <caption>
      <p>The general case Ramachandran kinemage and the C<sup>β</sup> deviation kinemage for file <ext-link ext-link-type="uri" xlink:href="http://scripts.iucr.org/cgi-bin/cr.cgi?rm=pdb&amp;pdbId=2dq4">2dq4</ext-link>. In (<italic>a</italic>) the ϕ, ψ values for each residue are plotted on a background of the smoothed contours from high-quality data (see text). Over 98% lie inside the inner ‘favored’ 98% contour, but there are seven outliers outside the outer 99.95% contour. Gly, Pro and pre-Pro residues are on separate plots (not shown). In (<italic>b</italic>) the C<sup>β</sup> deviation kinemage shows each residue’s C<sup>β</sup> position relative to an ideal C<sup>β</sup> and its three bond vectors (gray lines). Circles mark the deviation distances, with the yellow circle at the 0.25 Å cutoff for outliers. Most of the distribution is good, but an adjacent Leu and Trp in each chain (labeled) are part of an outlier cluster and probably reflect distortions caused by a local fitting problem.</p>
    </caption>
    <graphic xlink:href="d-66-00012-fig5"/>
  </fig>
  <fig id="fig6" position="float">
    <label>Figure 6</label>
    <caption>
      <p>Close-up of a ribose-pucker outlier in the multi-criterion kinemage for <ext-link ext-link-type="uri" xlink:href="http://scripts.iucr.org/cgi-bin/cr.cgi?rm=pdb&amp;pdbId=1n78">1n78</ext-link>, with backbone and bases turned on. C574 has a short phosphate-to-glycosidic bond perpendicular (magenta line and cross), but was fitted with an intermediate pucker near C3′-<italic>endo</italic>. The bad pucker torques the connected groups strongly, probably causing the bond-angle outliers (red) and steric clashes (hot-pink spikes). Note that C574 is in the binding interface between RNA (white backbone) and enzyme (yellow backbone) close to the active site.</p>
    </caption>
    <graphic xlink:href="d-66-00012-fig6"/>
  </fig>
  <fig id="fig7" position="float">
    <label>Figure 7</label>
    <caption>
      <p>Rebuilding of a backward-fitted Leu side chain in <italic>KiNG</italic> off-line in the DNA polymerase <ext-link ext-link-type="uri" xlink:href="http://scripts.iucr.org/cgi-bin/cr.cgi?rm=pdb&amp;pdbId=1xwl">1xwl</ext-link> at 1.7 Å resolution (Kiefer <italic>et al.</italic>, 1997<xref ref-type="bibr" rid="bb15"> ▶</xref>). The original (left) fits the density fairly well but is a rotamer outlier with a clash. One of the two best Leu rotamers also fits the density well with good all-atom packing. The top view (right) shows the 180° relationship of the two conformations.</p>
    </caption>
    <graphic xlink:href="d-66-00012-fig7"/>
  </fig>
  <fig id="fig8" position="float">
    <label>Figure 8</label>
    <caption>
      <p><italic>MolProbity</italic>-relevant quality criteria as a function of time for all structures in the PDB at a middle range of resolution, separately fitted before and after introduction of the web site. (<italic>a</italic>) All-atom clashscore (see §<xref ref-type="sec" rid="sec2.2"/>2.2); (<italic>b</italic>) percentage of Asn/Gln/His flips (see §<xref ref-type="sec" rid="sec2.1"/>2.1).</p>
    </caption>
    <graphic xlink:href="d-66-00012-fig8"/>
  </fig>
</floats-group>
