<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Microbiome</journal-id>
    <journal-id journal-id-type="iso-abbrev">Microbiome</journal-id>
    <journal-title-group>
      <journal-title>Microbiome</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2049-2618</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">7871585</article-id>
    <article-id pub-id-type="publisher-id">1002</article-id>
    <article-id pub-id-type="doi">10.1186/s40168-021-01002-3</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Methodology</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>HMD-ARG: hierarchical multi-task deep learning for annotating antibiotic resistance genes</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" equal-contrib="yes">
        <name>
          <surname>Li</surname>
          <given-names>Yu</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author" equal-contrib="yes">
        <name>
          <surname>Xu</surname>
          <given-names>Zeling</given-names>
        </name>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author" equal-contrib="yes">
        <name>
          <surname>Han</surname>
          <given-names>Wenkai</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author" equal-contrib="yes">
        <name>
          <surname>Cao</surname>
          <given-names>Huiluo</given-names>
        </name>
        <xref ref-type="aff" rid="Aff4">4</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Umarov</surname>
          <given-names>Ramzan</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Yan</surname>
          <given-names>Aixin</given-names>
        </name>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Fan</surname>
          <given-names>Ming</given-names>
        </name>
        <xref ref-type="aff" rid="Aff5">5</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Chen</surname>
          <given-names>Huan</given-names>
        </name>
        <xref ref-type="aff" rid="Aff6">6</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Duarte</surname>
          <given-names>Carlos M.</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff7">7</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Li</surname>
          <given-names>Lihua</given-names>
        </name>
        <xref ref-type="aff" rid="Aff5">5</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Ho</surname>
          <given-names>Pak-Leung</given-names>
        </name>
        <xref ref-type="aff" rid="Aff4">4</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-7108-3574</contrib-id>
        <name>
          <surname>Gao</surname>
          <given-names>Xin</given-names>
        </name>
        <address>
          <email>xin.gao@kaust.edu.sa</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="GRID">grid.45672.32</institution-id><institution-id institution-id-type="ISNI">0000 0001 1926 5090</institution-id><institution>Computational Bioscience Research Center (CBRC), Computer, Electrical and Mathematical Sciences and Engineering (CEMSE) Division, </institution><institution>King Abdullah University of Science and Technology (KAUST), </institution></institution-wrap>Thuwal, 23955 Saudi Arabia </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="GRID">grid.10784.3a</institution-id><institution-id institution-id-type="ISNI">0000 0004 1937 0482</institution-id><institution>Department of Computer Science and Engineering (CSE), </institution><institution>The Chinese University of Hong Kong (CUHK), </institution></institution-wrap>Hong Kong, People’s Republic of China </aff>
      <aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="GRID">grid.194645.b</institution-id><institution-id institution-id-type="ISNI">0000000121742757</institution-id><institution>School of Biological Sciences, </institution><institution>The University of Hong Kong, </institution></institution-wrap>Hong Kong, People’s Republic of China </aff>
      <aff id="Aff4"><label>4</label><institution-wrap><institution-id institution-id-type="GRID">grid.194645.b</institution-id><institution-id institution-id-type="ISNI">0000000121742757</institution-id><institution>Carol Yu Center for Infection and Department of Microbiology, </institution><institution>The University of Hong Kong, </institution></institution-wrap>Hong Kong, People’s Republic of China </aff>
      <aff id="Aff5"><label>5</label><institution-wrap><institution-id institution-id-type="GRID">grid.411963.8</institution-id><institution-id institution-id-type="ISNI">0000 0000 9804 6672</institution-id><institution>Institute of Biomedical Engineering and Instrumentation, </institution><institution>Hangzhou Dianzi University, </institution></institution-wrap>Hangzhou, People’s Republic of China </aff>
      <aff id="Aff6"><label>6</label><institution-wrap><institution-id institution-id-type="GRID">grid.13402.34</institution-id><institution-id institution-id-type="ISNI">0000 0004 1759 700X</institution-id><institution>Key Laboratory of Microbial Technology and Bioinformatics of Zhejiang Province, </institution><institution>Zhejiang Institute of Microbiology, </institution></institution-wrap>Hangzhou, People’s Republic of China </aff>
      <aff id="Aff7"><label>7</label><institution-wrap><institution-id institution-id-type="GRID">grid.45672.32</institution-id><institution-id institution-id-type="ISNI">0000 0001 1926 5090</institution-id><institution>Biological and Environmental Sciences and Engineering (BESE) Division, </institution><institution>King Abdullah University of Science and Technology (KAUST), </institution></institution-wrap>Thuwal, 23955 Saudi Arabia </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>8</day>
      <month>2</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>8</day>
      <month>2</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2021</year>
    </pub-date>
    <volume>9</volume>
    <elocation-id>40</elocation-id>
    <history>
      <date date-type="received">
        <day>11</day>
        <month>11</month>
        <year>2020</year>
      </date>
      <date date-type="accepted">
        <day>8</day>
        <month>1</month>
        <year>2021</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2021</copyright-statement>
      <license license-type="OpenAccess">
        <license-p><bold>Open Access</bold>This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article's Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article's Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated in a credit line to the data.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p id="Par1">The spread of antibiotic resistance has become one of the most urgent threats to global health, which is estimated to cause 700,000 deaths each year globally. Its surrogates, antibiotic resistance genes (ARGs), are highly transmittable between food, water, animal, and human to mitigate the efficacy of antibiotics. Accurately identifying ARGs is thus an indispensable step to understanding the ecology, and transmission of ARGs between environmental and human-associated reservoirs. Unfortunately, the previous computational methods for identifying ARGs are mostly based on sequence alignment, which cannot identify novel ARGs, and their applications are limited by currently incomplete knowledge about ARGs.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p id="Par2">Here, we propose an end-to-end Hierarchical Multi-task Deep learning framework for ARG annotation (HMD-ARG). Taking raw sequence encoding as input, HMD-ARG can identify, without querying against existing sequence databases, multiple ARG properties simultaneously, including if the input protein sequence is an ARG, and if so, what antibiotic family it is resistant to, what resistant mechanism the ARG takes, and if the ARG is an intrinsic one or acquired one. In addition, if the predicted antibiotic family is beta-lactamase, HMD-ARG further predicts the subclass of beta-lactamase that the ARG is resistant to. Comprehensive experiments, including cross-fold validation, third-party dataset validation in human gut microbiota, wet-experimental functional validation, and structural investigation of predicted conserved sites, demonstrate not only the superior performance of our method over the state-of-art methods, but also the effectiveness and robustness of the proposed method.</p>
      </sec>
      <sec>
        <title>Conclusions</title>
        <p id="Par3">We propose a hierarchical multi-task method, HMD-ARG, which is based on deep learning and can provide detailed annotations of ARGs from three important aspects: resistant antibiotic class, resistant mechanism, and gene mobility. We believe that HMD-ARG can serve as a powerful tool to identify antibiotic resistance genes and, therefore mitigate their global threat. Our method and the constructed database are available at <ext-link ext-link-type="uri" xlink:href="http://www.cbrc.kaust.edu.sa/HMDARG/">http://www.cbrc.kaust.edu.sa/HMDARG/</ext-link>.</p>
        <p id="Par4">
          <media xlink:href="40168_2021_1002_MOESM1_ESM.mp4" id="MOESM1">
            <caption>
              <p>Video abstract (MP4 50984 kb)</p>
            </caption>
          </media>
        </p>
      </sec>
      <sec>
        <title>Supplementary Information</title>
        <p>The online version contains supplementary material available at 10.1186/s40168-021-01002-3.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Antibiotic resistance genes</kwd>
      <kwd>Deep learning</kwd>
      <kwd>Antibiotic class</kwd>
      <kwd>Resistant mechanism</kwd>
      <kwd>Gene mobility</kwd>
      <kwd>Multi-task learning</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100004052</institution-id>
            <institution>King Abdullah University of Science and Technology</institution>
          </institution-wrap>
        </funding-source>
        <award-id>FCC/1/1976-04, FCC/1/1976-06, FCC/1/1976-17, FCC/1/1976-18, FCC/1/1976-23, FCC/1/1976-25, FCC/1/1976-26, URF/1/3450-01, URF/1/4098-01-01, and REI/1/0018-01-01</award-id>
        <principal-award-recipient>
          <name>
            <surname>Gao</surname>
            <given-names>Xin</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>National Natural Science Foundation of China </institution>
        </funding-source>
        <award-id>61731008, 61871428</award-id>
        <principal-award-recipient>
          <name>
            <surname>Li</surname>
            <given-names>Lihua</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>Health and Medical Research Fund</institution>
        </funding-source>
        <award-id>CHP-PH-13</award-id>
        <principal-award-recipient>
          <name>
            <surname>Ho</surname>
            <given-names>Pak-Leung</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2021</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p id="Par5">The spread of antibiotic resistance has become one of the most pressing threats to global health, estimated to cause 700,000 deaths each year globally, with this number projected to increase to 10 million by 2050 if no action is taken [<xref ref-type="bibr" rid="CR1">1</xref>, <xref ref-type="bibr" rid="CR2">2</xref>]. Antibiotic resistance genes (ARGs) are highly transmittable between food, water, animal, and human to mitigate the efficacy of antibiotics [<xref ref-type="bibr" rid="CR3">3</xref>–<xref ref-type="bibr" rid="CR7">7</xref>]. Accurately identifying ARGs is thus an indispensable step to understanding the ecology and transmission of ARGs between environmental and human-associated reservoirs [<xref ref-type="bibr" rid="CR8">8</xref>].</p>
    <p id="Par6">Metagenomic high-throughput sequencing technologies have provided a quick and sensitive way to explore the ARGs in a single genome or metagenomic samples, and many bioinformatic tools were proposed to annotate genes from the metagenomic datasets. Most methods fall into two categories: assembly-based methods, those that assemble sequencing reads into contiguous fragments and then search against reference databases, and the read-based methods, those that align raw reads to reference alleles directly [<xref ref-type="bibr" rid="CR9">9</xref>]. The widely used AMRPlusPlus [<xref ref-type="bibr" rid="CR10">10</xref>] is a typical example of the read-based methods. It directly aligns short reads to a custom reference database using BWA [<xref ref-type="bibr" rid="CR11">11</xref>] to predict the presence of ARGs. Such methods scale well for complex metagenomic samples, but they may cause a large number of false positives due to local sequence similarity. On the other hand, the assembly-based methods require assemblers like SPAdes [<xref ref-type="bibr" rid="CR12">12</xref>], Velvet [<xref ref-type="bibr" rid="CR13">13</xref>], IDBA-UD [<xref ref-type="bibr" rid="CR14">14</xref>], MEGAHIT [<xref ref-type="bibr" rid="CR15">15</xref>], and then comparing predicted protein-coding regions against reference databases to identify ARGs. The assembler’s performance may influence the overall ARG prediction, but the upstream and downstream positional information from the assembly can compensate for the false-positive problem to some extent. The difference between these two kinds of approaches is in the pre-processing step, whereas their core ideas are similar. That is, they use the pairwise alignment or multi-sequence alignment algorithms to identify and annotate resistance genes.</p>
    <p id="Par7">As discussed above, the alignment-dependent methods are widely used, but they have the following disadvantages. Firstly, due to the pairwise alignment setting, the assembly-based methods are not sensitive to point mutations. Consequently, they may ignore novel ARGs and have limited power in mechanism analysis. Secondly, if the users want to obtain satisfactory results using those methods, they should have a clear understanding of how to set the parameters in those algorithms correctly, such as the similarity threshold. Such a domain knowledge requirement limits the real usage of the methods, which is one of the reasons that many people find the existing tools not that useful. Thirdly, because the alignment-based methods depend on the curated databases, such methods cannot identify novel ARGs, and their applications are limited by currently incomplete knowledge about ARGs [<xref ref-type="bibr" rid="CR16">16</xref>]. Machine learning methods can potentially learn the statistical patterns of ARGs and be able to predict novel ones [<xref ref-type="bibr" rid="CR17">17</xref>–<xref ref-type="bibr" rid="CR20">20</xref>]. In particular, deep learning may circumvent these obstacles because of its intrinsic superiority in feature extraction from raw data. Recently, building upon a multi-layer perceptron model, DeepARG [<xref ref-type="bibr" rid="CR21">21</xref>] was developed to identity ARGs using similarity features by comparing the query sequence to the existing ARG databases. Although similarity might extract effective features to identify ARGs, DeepARG still inherits the disadvantage of alignment-based methods. In addition, existing methods cannot predict the gene mobility, that is, whether the ARG is intrinsic [<xref ref-type="bibr" rid="CR22">22</xref>] or could be acquired [<xref ref-type="bibr" rid="CR23">23</xref>] via horizontal gene transfer [<xref ref-type="bibr" rid="CR24">24</xref>].</p>
    <p id="Par8">In this work, we propose a multi-task deep learning framework, called HMD-ARG (Fig. <xref rid="Fig1" ref-type="fig">1</xref>). With the raw sequence encoding as input and without querying against existing sequence databases, HMD-ARG predicts multiple ARG properties simultaneously, including resolving if the input protein sequence is an ARG, and if so, what antibiotic family it is resistant to, what resistant mechanism is involved in the ARG, and whether the ARG is intrinsic or acquired. In addition, if the predicted antibiotic family is beta-lactamase, HMD-ARG further predicts the subclass of beta-lactamase that the ARG is resistant to.
<fig id="Fig1"><label>Fig. 1</label><caption><p>Overview of HMD-ARG. Top panel: HMD-ARG is composed of three deep learning models, which are responsible for three level predictions. In level 0, one model is trained to predict whether an input sequence is an ARG or not. If it is an ARG, it will go through the second level prediction, in which a multi-task deep learning model (more details shown in the bottom panel) is trained to predict the resistant antibiotic family, resistant mechanism, and gene mobility information at the same time. If the sequence is predicted as beta-lactamase in level 1, it will be fed into the level 2 model to predict its beta-lactamase subclass. Bottom panel: In order to train those models, we built the most comprehensive ARG database to date by merging the sequences from seven existing databases, followed by a post-processing step to remove duplicates. Then, we used the existing tools and manual curation to assign the annotations from three aspects, i.e., resistant antibiotic family, resistant mechanism, and gene mobility, to each sequence in the database. Those sequences were then fed to deep learning models to train our models, as illustrated in the right part</p></caption><graphic xlink:href="40168_2021_1002_Fig1_HTML" id="MO1"/></fig></p>
  </sec>
  <sec id="Sec2">
    <title>Methods</title>
    <sec id="Sec3">
      <title>Database description</title>
      <p id="Par9">We curated a comprehensive multi-label ARG database, HMD-ARG-DB, with a high degree of confidence and extensively manual curations, which can serve as a valuable resource for the community. We collected and cleaned resistance gene sequences from seven published ARG databases: Comprehensive Antibiotic Resistance Database (CARD) [<xref ref-type="bibr" rid="CR25">25</xref>], AMRFinder [<xref ref-type="bibr" rid="CR26">26</xref>], ResFinder [<xref ref-type="bibr" rid="CR27">27</xref>], Antibiotic Resistance Gene-ANNOTation (ARG-ANNOT) [<xref ref-type="bibr" rid="CR28">28</xref>], DeepARG [<xref ref-type="bibr" rid="CR21">21</xref>], MEGARes [<xref ref-type="bibr" rid="CR10">10</xref>], and Resfams [<xref ref-type="bibr" rid="CR8">8</xref>]. Then, we labeled these sequences from three perspectives with manual check (Figs. <xref rid="Fig1" ref-type="fig">1</xref> and <xref rid="Fig2" ref-type="fig">2</xref>c), (1) the antibiotic class they confer to, (2) the mechanism of antibiotic resistance, (3) and transferable ability. We removed the identical and duplicate sequences from our database following the same procedure as DeepARG [<xref ref-type="bibr" rid="CR21">21</xref>].
<fig id="Fig2"><label>Fig. 2</label><caption><p>HMD-ARG database composition and the HMD-ARG database construction pipeline. <bold>a</bold> The statistics of the HMD-ARG database. The number of sequences belonging to each antibiotic family is different. Meanwhile, different genes can resist the same drug with different mechanisms, which are shown in different colors. <bold>b</bold> Different databases have various numbers of sequences as well as different labeling information. HMD-ARG database is currently the largest one. At the same time, it is the most comprehensive one, with resistant antibiotic class, resistant mechanism, and gene mobility labeled. <bold>c</bold> To construct the database, we merged the sequences from seven existing databases, followed by a post-processing step to remove duplicates. Then, we either used the existing tools or manual curation to assign the annotations from three aspects to each sequence in the database</p></caption><graphic xlink:href="40168_2021_1002_Fig2_HTML" id="MO2"/></fig></p>
      <p id="Par10">The resulting database, HMD-ARG-DB, is composed of 17,282 high-quality sequences, coupled with labels of 15 antibiotic classes, 6 underlying resistance mechanisms, and their mobility (Database construction in Supp, Fig. <xref rid="Fig2" ref-type="fig">2</xref>a). This type of multiple label database ensures the trained models to capture the most relevant features associated with ARGs automatically. Over 30 % of the genes belong to beta-lactam category (5921), most of which perform the resistance function through inactivating beta-lactams (5763). About 24% of the genes are assigned to bacitracin category (4219), and almost all of them perform antibiotic target alternation (4206) (Fig. <xref rid="Fig2" ref-type="fig">2</xref>a). HMD-ARG-DB is the largest database to date, including the most comprehensive annotations on the three different aspects targeted (Fig. <xref rid="Fig2" ref-type="fig">2</xref>b).</p>
    </sec>
    <sec id="Sec4">
      <title>Overview of HMD-ARG</title>
      <p id="Par11">HMD-ARG is a supervised machine learning framework for ARG annotation, consisting of three models (Fig. <xref rid="Fig1" ref-type="fig">1</xref> top panel), with a level-by-level prediction strategy. Given a protein sequence, HMD-ARG can annotate it from the following three aspects: antibiotic resistance type, mechanism, and gene mobility. More specifically, regarding the antibiotic resistance type, HMD-ARG predicts which of the 15 antibiotic families the predicted ARG is resistant to. As for the mechanism, HMD-ARG annotates the ARG based on the biochemical basis of its resistance, including antibiotic efflux, antibiotic inactivation, antibiotic target alternation, antibiotic target protection, antibiotic replacement, and others. In terms of gene mobility, HMD-ARG distinguishes the intrinsic genes from the acquired ones in plasmid.</p>
      <p id="Par12">To perform these predictions, HMD-ARG is designed to have three models with a level-by-level prediction strategy, which deploys the hierarchical structure of the ARG labeling space. For a given protein sequence, it first classifies the sequence into ARG or non-ARG; if the input sequence is an ARG, we predict its resistant antibiotic type; if the ARG is a beta-lactamase, we will further annotate it with the refined beta-lactamase subtype. Accordingly, given any sequence analyzed by the HMD-ARG framework, the first model (level 0) predicts whether it is ARG or non-ARG. If it is an ARG, the second multi-task model (level 1) predicts the resistant antibiotic type, the underlying mechanism of resistance, and gene mobility. Furthermore, if the ARG is predicted to resist to beta-lactam, the third model (level 2) predicts its molecular subclass [<xref ref-type="bibr" rid="CR29">29</xref>]. This hierarchical framework helps deal with data imbalance problem and reduces the computational complexity for non-ARG.</p>
      <p id="Par13">For each level of the prediction, the model is based on an end-to-end convolutional neural network (CNN) model, taking the raw representation of the sequence, i.e., one-hot encoding, as inputs. To increase the capacity, the model used in level 1 contains one additional layer before the final multi-task outputs. The structure of the multi-task learning model is illustrated in Fig. <xref rid="Fig1" ref-type="fig">1</xref> bottom panel. More details of the model structure could be referred to the “Deep learning model” and “Implementation details” sections below.</p>
    </sec>
    <sec id="Sec5">
      <title>Deep learning model</title>
      <p id="Par14">In each level of the prediction, the model is an end-to-end convolutional neural network (CNN) model. For these models, the inputs are protein sequences, which are strings composed of 23 characters representing different amino acids. To render the inputs suitable for the deep learning mathematical model, we used one-hot encoding to represent the input sequences. Then, the sequence encodings go through six convolutional layers and four pooling layers, which are designed to detect important motifs and aggregate both useful local and global information across the entire input sequence. The outputs of the last pooling layer are flattened and then fed into three fully-connected layers, which are designed to learn the functional mapping between the learned representation from the convolutional layers and the final labeling space. Since all of our tasks are classification ones, for the ARG/non-ARG and the beta-lactam subtype prediction, we used the standard cross-entropy loss. The multi-task learning loss function will be discussed in “Multi-task learning” section below. More details about the hyper-parameter setting are discussed in the “Implementation details” section and “Model hype-parameters” in Supp.</p>
    </sec>
    <sec id="Sec6">
      <title>Multi-task learning</title>
      <p id="Par15">Within the HMD-ARG framework, there is one model (level 1) performing multi-task learning for the coarse resistant antibiotic type, functional mechanism, and gene mobility prediction. The model architecture is roughly the same as that described in the “Deep learning model” section above. However, for the last layer of the model, instead of only having one fully-connected branch with a Softmax activation function, we have three fully-connected branches, which correspond to the three tasks, respectively. In other words, the model for multi-task learning is essentially composed of three models, while those models share the convolutional and pooling layers. One clear advantage of this multi-task learning framework is that the three tasks altogether force those layers to discover important features within the input sequences, which are useful for all the three tasks, and thus prevent the model from overfitting. On the other hand, the loss function is changed accordingly:
<disp-formula id="Equa"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {L}_{\mathrm{multi}-\mathrm{task}}=\alpha \ast {L}_{\mathrm{drug}}+\beta \ast {L}_{\mathrm{mechanism}}+\gamma \ast {L}_{\mathrm{source}}, $$\end{document}</tex-math><mml:math id="M2" display="block"><mml:msub><mml:mi>L</mml:mi><mml:mrow><mml:mtext>multi</mml:mtext><mml:mo>−</mml:mo><mml:mtext>task</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>α</mml:mi><mml:mo>∗</mml:mo><mml:msub><mml:mi>L</mml:mi><mml:mtext>drug</mml:mtext></mml:msub><mml:mo>+</mml:mo><mml:mi>β</mml:mi><mml:mo>∗</mml:mo><mml:msub><mml:mi>L</mml:mi><mml:mtext>mechanism</mml:mtext></mml:msub><mml:mo>+</mml:mo><mml:mi>γ</mml:mi><mml:mo>∗</mml:mo><mml:msub><mml:mi>L</mml:mi><mml:mtext>source</mml:mtext></mml:msub><mml:mo>,</mml:mo></mml:math><graphic xlink:href="40168_2021_1002_Article_Equa.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par16">where <italic>α</italic>, <italic>β</italic>, <italic>γ</italic> are the weights of the three tasks and are hyper-parameters; <italic>L</italic><sub>drug</sub>, <italic>L</italic><sub>mechanism</sub>, and <italic>L</italic><sub>source</sub> are the cross-entropy losses of the corresponding tasks, respectively. Essentially, we optimize over the weighted <italic>L</italic><sub>multi − task</sub>, instead of each cross-entropy loss alone, to take care of all the three tasks simultaneously. After training the above model, given an input sequence, we obtain the prediction results of the three tasks with one single forward-propagation.</p>
    </sec>
    <sec id="Sec7">
      <title>Implementation details</title>
      <p id="Par17">We collected 66k non-ARGs from UniProt [<xref ref-type="bibr" rid="CR30">30</xref>] with highest BLAST similarity scores against the ARGs in HMD-ARG-DB, used them as the negative set so that the negative set is as similar to the positive one as possible to force HMD-ARG to learn a more powerful model, and then trained the level 0 model on the combined dataset. The level 1 multi-task learning was performed with HMD-ARG-DB. For beta-lactamase subclass prediction, we trained our model on an up-to-date beta-lactamase database, Beta-Lactamase DataBase [<xref ref-type="bibr" rid="CR31">31</xref>] (BLDB). The database contains more than 4000 beta-lactamases sequences. Each of them has a molecular class label, indicating which subclass the sequence belongs to. In total, there are 6 subclasses, class A, B1, B2, B3, C, and D.</p>
      <p id="Par18">When training the models, we first converted each amino acid into a one-hot encoding vector. So, protein sequences are converted into a zero-padded numerical matrix with the dimension as 1576 by 23, where 1576 meets the length of the longest ARGs and non-ARGs in our dataset, and 23 stands for 20 standard amino acids, two infrequent amino acids (B, Z), and X for unknown ones. Such an encoded matrix is then fed into a deep learning model with six convolutional layers and four max-pooling layers. The model hyper-parameters are discussed in “Model hype-parameters” in Supp.</p>
    </sec>
    <sec id="Sec8">
      <title>Saliency map construction</title>
      <p id="Par19">The saliency map is constructed as follows. At each position of the protein sequence, we replaced the amino acid with a different amino acid, obtaining a mutated sequence, and fed the mutated sequence to the level 0 model, which outputs the predicted probability of the mutated sequence being an ARG. We performed this procedure for each amino acid replacement and each position. As a result, the saliency map has a dimension of <italic>L</italic> by 20, where <italic>L</italic> is the length of the sequence. When constructing the average saliency map, we first performed multiple sequence alignment for a specific sequence against our database, obtaining the alignment results. Then, we built a saliency map for each sequence that can be aligned to the query sequence. Finally, we aligned the saliency map based on the sequence alignment results and took the average of the maps to obtain the average saliency map. To compare our method against the sequence-alignment based methods, we built a position-specific scoring matrix [<xref ref-type="bibr" rid="CR32">32</xref>] (PSSM) with PSI-BLAST [<xref ref-type="bibr" rid="CR33">33</xref>], visualized the PSSM, and compared it with our saliency map.</p>
    </sec>
    <sec id="Sec9">
      <title>Wet experimental expression of predicted ARGs</title>
      <p id="Par20">Eight predicted ARGs in <italic>Pseudomonas aeruginosa</italic> strain PA150567 were selected for this purpose. The ORF regions of the predicted genes were amplified by PCR using the iProof™ High-Fidelity DNA Polymerase (Bio-Rad, USA) with the primers as listed in Table S<xref rid="MOESM2" ref-type="media">2</xref>. Purified DNA fragments and the pET28a vector were digested with <italic>BamH</italic>I and <italic>Xho</italic>I (NEB, USA). After ligation using the Quick Ligation<sup>TM</sup> Kit (NEB, USA) and verification by PCR and DNA sequencing (BGI, China), the resulting plasmids were transformed into <italic>E. coli</italic> BL21 for antibiotic sensitivity analysis. Overnight culture of <italic>E. coli</italic> BL21 strains containing the plasmids for overexpression of the predicted genes were 1:100 diluted and grown in LB medium supplemented with kanamycin (20 μg/ml) and Isopropyl β-D-1-thiogalactopyranoside (IPTG) (0.5 mM). After incubation at 37 °C with 220-rpm agitation for 90 min, bacterial cultures were transferred to a 24-well plate. After antibiotic was added with indicated concentration (ampicillin: 50 μg/ml, carbenicillin: 10 μg/ml; meropenem: 2 μg/ml; amikacin: 4 μg/ml), cell growth (OD600nm) was measured every 10 min at 37 °C in the Synergy HTX Plate Reader (BioTek, USA) with agitation. Assays were performed in duplicate.</p>
    </sec>
  </sec>
  <sec id="Sec10">
    <title>Results</title>
    <sec id="Sec11">
      <title>Overall performance of HMD-ARG</title>
      <p id="Par21">We first used 5-fold stratified cross-validation to evaluate the performance of HMD-ARG and compared it with the state-of-the-art methods [<xref ref-type="bibr" rid="CR21">21</xref>, <xref ref-type="bibr" rid="CR25">25</xref>, <xref ref-type="bibr" rid="CR34">34</xref>, <xref ref-type="bibr" rid="CR35">35</xref>]. In this experiment, we randomly divided HMD-ARG-DB into five folds. Each time, we chose four folds of the dataset for the model training and tested the trained model on the remaining one. To avoid data bias, average results were generated from repeating the above procedure for five times. In general, as shown in Tables <xref rid="Tab1" ref-type="table">1</xref>, <xref rid="Tab2" ref-type="table">2</xref>, <xref rid="Tab3" ref-type="table">3</xref>, <xref rid="Tab4" ref-type="table">4</xref>, and <xref rid="Tab5" ref-type="table">5</xref>, HMD-ARG achieves the state-of-the-art results on all the tasks (evaluation criteria definitions and the detailed steps of executing other methods provided in “Evaluation criteria” and “Protocols of other methods” in Supp). More specifically, for the most important task, antibiotic class prediction (Table <xref rid="Tab2" ref-type="table">2</xref>), HMD-ARG shows significantly higher accuracy (0.935), recall (0.847), and F1 score (0.893) with a promising precision (0.950) than the existing methods. It is not surprising that CARD has a slightly better precision score (0.981), because the database was curated based on sequence similarity search. However, similarity-based methods produce more false negatives, resulting in a low recall rate, e.g., in CARD (0.452), AMRPlusPlus (0.278), and Meta-MARC (0.782). By combining similarity features with a multi-layer perception, DeepARG improves the overall prediction results, compared with CARD, with the precision, recall, and F1 score being 0.914, 0.757, and 0.814, respectively, but it is still much lower than HMD-ARG. For the resistance mechanism prediction (Table <xref rid="Tab3" ref-type="table">3</xref>), HMD-ARG significantly outperforms CARD, especially on recall. As for the gene mobility prediction (Table <xref rid="Tab4" ref-type="table">4</xref>), our model can also achieve impressive results, while the other commonly used methods cannot perform this task. Although HMD-ARG is not designed specifically for beta-lactamase prediction (Table <xref rid="Tab5" ref-type="table">5</xref>), our method still achieves remarkably accurate results, which is similar to the state-of-the-art method that is trained specifically on this task, CNN-BLPred [<xref ref-type="bibr" rid="CR36">36</xref>].
<table-wrap id="Tab1"><label>Table 1</label><caption><p>The ARG/non-ARG classification results between different methods</p></caption><table frame="hsides" rules="groups"><thead><tr><th/><th>Accuracy</th><th>Precision<sup>a</sup></th><th>Recall</th><th>F1-score</th></tr></thead><tbody><tr><td>HMD-ARG</td><td>0.948</td><td>0.939</td><td><bold>0.971</bold></td><td>0.948</td></tr><tr><td>CARD</td><td>0.71</td><td><bold>0.999</bold></td><td>0.421</td><td>0.592</td></tr><tr><td>DeepARG</td><td><bold>0.965</bold></td><td>0.998</td><td>0.93</td><td><bold>0.963</bold></td></tr><tr><td>AMRPlusPlus<sup>b</sup></td><td>0.691</td><td>0.867</td><td>0.449</td><td>0.592</td></tr><tr><td>Meta-MARC<sup>c</sup></td><td>0.848</td><td>0.847</td><td>0.85</td><td>0.848</td></tr></tbody></table><table-wrap-foot><p><sup>a</sup>The precision, recall, and F1-score are only for ARG</p><p><sup>b</sup>AMR++ requires the input in a paired fastq format. So, we simulated the fastq data from our test protein dataset. Details can be seen in the supplementary</p><p><sup>c</sup>Meta-MARC can work with both assembly and raw data; we tested it with the assembled sequences (our test dataset)</p></table-wrap-foot></table-wrap><table-wrap id="Tab2"><label>Table 2</label><caption><p>The ARG antibiotic classes’ classification results between different methods</p></caption><table frame="hsides" rules="groups"><thead><tr><th/><th>Accuracy</th><th>Precision<sup>a</sup></th><th>Recall</th><th>F1-score</th></tr></thead><tbody><tr><td>HMD-ARG</td><td><bold>0.935</bold></td><td>0.950</td><td><bold>0.847</bold></td><td><bold>0.893</bold></td></tr><tr><td>CARD</td><td>0.418</td><td><bold>0.983</bold></td><td>0.452</td><td>0.585</td></tr><tr><td>DeepARG</td><td>0.887</td><td>0.914</td><td>0.757</td><td>0.814</td></tr><tr><td>AMRPlusPlus<sup>b</sup></td><td>0.675</td><td>0.574</td><td>0.278</td><td>0.283</td></tr><tr><td>Meta-MARC<sup>c</sup></td><td>0.909</td><td>0.750</td><td>0.782</td><td>0.745</td></tr></tbody></table><table-wrap-foot><p><sup>a</sup>The precision, recall, and F1-score are the macro average over the ARG antibiotic classes</p><p><sup>b</sup>AMR++ requires the input in a paired fastq format. So, we simulated the fastq data from our test protein dataset. Details can be seen in the supplementary</p><p><sup>c</sup>The drug class label system of AMR++ and Meta-MARC are different from ours, so we manually converted their labels into ours. Meta-MARC can work with both assembly and raw data; we tested it with the assembled sequences (our test dataset)</p></table-wrap-foot></table-wrap><table-wrap id="Tab3"><label>Table 3</label><caption><p>The ARG antibiotic mechanism classification results between different methods</p></caption><table frame="hsides" rules="groups"><thead><tr><th/><th>Accuracy</th><th>Precision<sup>a</sup></th><th>Recall</th><th>F1-score</th></tr></thead><tbody><tr><td>HMD-ARG</td><td><bold>0.936</bold></td><td><bold>0.867</bold></td><td><bold>0.768</bold></td><td><bold>0.795</bold></td></tr><tr><td>CARD</td><td>0.423</td><td>0.832</td><td>0.476</td><td>0.566</td></tr></tbody></table><table-wrap-foot><p><sup>a</sup>The precision, recall, and f1-score are the macro average over the ARG mechanism classes</p></table-wrap-foot></table-wrap><table-wrap id="Tab4"><label>Table 4</label><caption><p>The ARG antibiotic mobility classification results</p></caption><table frame="hsides" rules="groups"><thead><tr><th/><th>Accuracy</th><th>Precision<sup>a</sup></th><th>Recall</th><th>F1-score</th></tr></thead><tbody><tr><td>HMD-ARG</td><td>0.909</td><td>0.964</td><td>0.89</td><td>0.926</td></tr></tbody></table><table-wrap-foot><p><sup>a</sup>The precision, recall, and F1-score are the macro average over the ARG mobility classes</p></table-wrap-foot></table-wrap><table-wrap id="Tab5"><label>Table 5</label><caption><p>The beta-lactamases Ambler classification results between different methods</p></caption><table frame="hsides" rules="groups"><thead><tr><th/><th>Accuracy</th><th>Precision<sup>a</sup></th><th>Recall</th><th>F1-score</th></tr></thead><tbody><tr><td>HMD-ARG</td><td><bold>0.995</bold></td><td><bold>0.989</bold></td><td><bold>0.993</bold></td><td><bold>0.991</bold></td></tr><tr><td>CNN-Blpred</td><td>0.987</td><td>0.983</td><td>0.991</td><td>0.986</td></tr></tbody></table><table-wrap-foot><p><sup>a</sup>The precision, recall, and F1-score are the macro average over the beta-lactamases molecular type classes</p></table-wrap-foot></table-wrap></p>
    </sec>
    <sec id="Sec12">
      <title>Robustness of HMD-ARG</title>
      <p id="Par22">We further investigated the robustness of HMD-ARG, especially on the ARG/non-ARG prediction and antibiotic class prediction. HMD-ARG appears to be outperformed by DeepARG in discriminating ARGs from non-ARGs (Table <xref rid="Tab1" ref-type="table">1</xref>). DeepARG’s precision on identifying ARG is very high, but this should be attributed to its sequence similarity filtering process before feeding their model. There is no doubt that the pre-filtering used in DeepARG has inherited the disadvantage of similarity-based methods, resulting in a high false negative rate and thus low recall. Furthermore, the similarity threshold prerequisite might diminish the probabilistic model used in DeepARG, eventually attenuating the robustness of the method. On the contrary, taking the sequence one-hot encoding as input, without additional pre-processing, HMD-ARG remains as a genuine probabilistic model. This might explain the better robustness of HMD-ARG than DeepARG referring to the ROC curve (Fig. S<xref rid="MOESM2" ref-type="media">1</xref>). The ROC curve shows the smoothness in HMD-ARG’s prediction in contrast to a sharp changing point that is caused by the similarity threshold in DeepARG. Moreover, the area under ROC curve (AUROC) of HMD-ARG (0.99) is higher than that of DeepARG (0.97). Regarding the performance on each antibiotic class, HMD-ARG is quite stable across different classes, regardless of precision or recall (Fig. <xref rid="Fig3" ref-type="fig">3</xref>). On the other hand, DeepARG and CARD have a very diverse performance on different classes, especially in terms of recall. The robustness of HMD-ARG, on different levels and different classes, indicates that it is a reliable tool.
<fig id="Fig3"><label>Fig. 3</label><caption><p>Detailed prediction performance comparison. Detailed performance comparison of HMD-ARG, DeepARG, CARD, AMRPlusPlus, and Meta-MARC on each resistant antibiotic class. Meta-MARC can work with both assembly and raw data; we tested it with the assembled sequences</p></caption><graphic xlink:href="40168_2021_1002_Fig3_HTML" id="MO3"/></fig></p>
    </sec>
    <sec id="Sec13">
      <title>Predicting novel ARGs in human gut microbiota</title>
      <p id="Par23">Identification of ARGs in human gut metagenomes has a high clinical significance, because a large portion of bacteria are uncultured [<xref ref-type="bibr" rid="CR37">37</xref>, <xref ref-type="bibr" rid="CR38">38</xref>]. The resistome in the human gut is also expected to be quite different from ARGs in current databases since most known ARGs are from cultured pathogens [<xref ref-type="bibr" rid="CR37">37</xref>, <xref ref-type="bibr" rid="CR38">38</xref>]. Evaluating the proposed method on the new third-party human gut dataset shows the ability of HMD-ARG in identifying novel ARGs. We collected the human gut microbiota dataset, Mustard database, which contains 6095 predicted ARGs in 20 families, from the most recent work [<xref ref-type="bibr" rid="CR39">39</xref>]. These labeled ARGs were predicted from a 3.9 million human gut microbiome gene catalog, using a three-dimensional structure-based method, with a portion of the sequences being experimentally verified. Then, we compared the sequences in the Mustard database with the training sequences for HMD-ARG, ensuring that there is no overlap between the two. Finally, we applied HMD-ARG and DeepARG onto this third-party dataset. The numbers of novel ARGs belonging to different classes correctly recovered by HMD-ARG and DeepARG were used as surrogate measures for the prediction performance. Although DeepARG has better performance on two classes, HMD-ARG outperforms it in 15 out of the 20 classes, being able to identify more novel ARGs (Fig. S<xref rid="MOESM2" ref-type="media">2</xref>). Moreover, although HMD-ARG only utilizes sequence information, it can even achieve similar performance as the structured-based method on some classes. Compared with the structured-based method, HMD-ARG has a broader application scenario since it does not require structural information as the input.</p>
    </sec>
    <sec id="Sec14">
      <title>Experimental validation</title>
      <p id="Par24">To validate the performance of our model on predicting ARGs, five genes assigned to beta-lactamase and three genes predicted as the aminoglycode class from a clinical strain <italic>Pseudomonas aeruginosa</italic> PA150567 were randomly selected for wet lab experimental validation (Table S<xref rid="MOESM2" ref-type="media">1</xref> and Fig. <xref rid="Fig4" ref-type="fig">4</xref>a). Note that some of those randomly selected genes have a BLAST [<xref ref-type="bibr" rid="CR40">40</xref>] identity against the database lower than 50%, which means they cannot be detected by the similarity-based methods, including DeepARG. All of these genes were heterologously expressed in <italic>Escherichia coli</italic> BL21 host (Fig. <xref rid="Fig4" ref-type="fig">4</xref>a left). The growth was measured in presence of meropenem (Fig. <xref rid="Fig4" ref-type="fig">4</xref>a middle) and amikacin (Fig. <xref rid="Fig4" ref-type="fig">4</xref>a right) for each successful transformant with corresponding ARGs predicted in the present study. Results demonstrate the antibiotic resistance of all of these ARGs in <italic>E. coli</italic> transformants and confirm the good performance of our model. Although the lower activities of predicted ARGs to two beta-lactam antibiotics were observed than the one showing 100% identity with known ARGs (Fig. S<xref rid="MOESM2" ref-type="media">3</xref>), the activities were still higher than those without transformed ARGs. The lower functions are possibly attributed to the unclear regulatory systems in vivo or the genuine low enzyme activities of these predicted ARGs. Altogether, since we randomly selected these genes for validation, this might be applicable for all predicted ARGs, at least for those with mechanisms underlying inactivating antibiotics.
<fig id="Fig4"><label>Fig. 4</label><caption><p>Functional validation of the predicted ARGs and structural investigation of conserved sites detected by HMD-ARG. <bold>a</bold> Left figure: A diagram showing the procedure of heterologous expression and functional analysis of the predicted ARGs from PA150567 in <italic>E. coli</italic> BL21 host. Middle figure<bold>:</bold> Growth curves of <italic>E. coli</italic> hosts with expression of the predicted <italic>β</italic>-lactamases that inactivate <italic>β</italic>-lactam antibiotics in the presence of 2 μg/ml meropenem. Right figure<bold>:</bold> Growth curves of <italic>E. coli</italic> hosts with expression of the predicted acetyltransferases that inactivate aminoglycoside antibiotics in the presence of 4 μg/ml amikacin. <bold>b</bold> The HMD-ARG predicted conserved sites and the corresponding sequence logo from 319 to 393 in AXX01_04100. <bold>c</bold> After we mutated the conserved site (346) from T to N, the mutated protein’s (colored in red) local structure (predicted by RaptorX) changed significantly from the wild type (colored in light blue). Moreover, the binding affinity (predicted by AutoDock) between the mutated protein and the ligand (antibiotics) also reduced, as illustrated in the middle (wild type) and right (mutated protein) figures</p></caption><graphic xlink:href="40168_2021_1002_Fig4_HTML" id="MO4"/></fig></p>
    </sec>
    <sec id="Sec15">
      <title>Capturing evolutionary information</title>
      <p id="Par25">To further investigate the improved performance of HMD-ARG, we first performed a saliency map (mutation map) analysis [<xref ref-type="bibr" rid="CR41">41</xref>] on the HMD-ARG model. For each amino acid in an ARG sequence, we mutated it to a different amino acid and fed the mutated sequence to the trained HMD-ARG, obtaining the predicted probability of the mutated sequence being an ARG. Since each amino acid can be mutated to 20 amino acids (including itself), the saliency map for each ARG will have a dimension of <italic>L</italic> by 20, where <italic>L</italic> is the sequence length. From this mutation map analysis, we were able to obtain the conserved sites predicted by our model (Fig. <xref rid="Fig4" ref-type="fig">4</xref>b). Taking a beta-lactamase resistance gene, AFB78806 [<xref ref-type="bibr" rid="CR42">42</xref>] as an example, we built the saliency map for every sequence in HMD-ARG-DB that could be aligned to it. Then, based on the sequence alignment, we aligned the saliency map and obtained the averaged saliency map for the AFB78806 group. Meanwhile, we built the position-specific scoring matrix (PSSM) for AFB78806. The averaged saliency map and PSSM are shown in Fig. S<xref rid="MOESM2" ref-type="media">4</xref>. The overall Pearson correlation coefficient as 0.24 between the averaged saliency map and PSSM was observed. Particularly, the most distinct positions, such as column 226, were determined with a Pearson correlation coefficient higher than 0.5. PSSM can capture the evolutionary information for a specific sequence, with a high value in the matrix indicating a highly conserved position. On the other hand, the physical meaning of the averaged saliency map is that if there is a mutation with high resistant probability, this specific mutated gene is likely to survive. Considering that when building the HMD-ARG models, we only used the raw sequence information, without utilizing the evolutionary information or the alignment information, the correlation between the group saliency map and the PSSM indicates two things. Firstly, the prediction of HMD-ARG is robust and consistent within a group of ARGs; otherwise, the averaged saliency map would not show clear patterns. Secondly, HMD-ARG is able to detect the evolutionary information in an implicit way, capturing the conserved positions and mutations that are critical to the activity of enzymes. Thus HMD-ARG may serve as a tool for analyzing the evolution of ARGs.</p>
    </sec>
    <sec id="Sec16">
      <title>Predicted conserved sites validation</title>
      <p id="Par26">We validated the predicted conserved sites obtained from the model analysis above. We used the protein AXX01_04100, which was validated by bioassays, as an example. After performing the mutation map analysis, we obtained the conserved site sequence logo shown in Fig. <xref rid="Fig4" ref-type="fig">4</xref>b. As illustrated in the figure, we could recover some known conserved sequence motifs, such as KTG [<xref ref-type="bibr" rid="CR43">43</xref>] (342–344). For comparison, we also built a PSSM to check the ability of multiple sequence alignment-based methods in capturing the motifs. The results are shown in Fig. S<xref rid="MOESM2" ref-type="media">5</xref>. We found that the PSSM is powerful in capturing evolutionally conserved amino acids, but the KTG signal in the figure is not so clear compared with that in the saliency map of our method. In addition, we wanted to validate the previously unknown conserved sites, which were predicted by our analysis. We chose the most significant signal from the mutation map, i.e., 346 (T to N), and made such mutation on the protein sequence. Using RaptorX [<xref ref-type="bibr" rid="CR44">44</xref>], we obtained the predicted structure of the mutated protein, which was then aligned and compared with the wild type protein structure. The comparison results were illustrated in Fig. <xref rid="Fig4" ref-type="fig">4</xref>c left figure. Although we only mutated one single amino acid, the local structure and environment have changed significantly, which indicates the importance of such a conserved site. To further test the newly predicted conserved site, we performed docking experiments with AutoDock Vina [<xref ref-type="bibr" rid="CR45">45</xref>], using the beta-lactam antibiotic, to bind against both the wild type structure and the mutated one. As shown in Fig. <xref rid="Fig4" ref-type="fig">4</xref>c middle (wild) and right (mutated) figures, the binding affinity between the protein and the antibiotics has indeed decreased significantly from the wild type (− 7.8 kcal/mol) to the mutated protein (− 6.8 kcal/mol), although these in silico analyses demonstrate the applicability of HMD-ARG in recognizing the antibiotic conserved sites and motifs.</p>
    </sec>
  </sec>
  <sec id="Sec17">
    <title>Discussion and conclusions</title>
    <p id="Par27">We developed a hierarchical multi-task method, HMD-ARG, based on deep learning, to facilitate the detection and understanding of antibiotic resistance, providing detailed annotations of ARGs from three important aspects: resistant antibiotic class, resistant mechanism, and gene mobility. Comprehensive experiments, including cross-fold validation, third-party dataset validation, wet-experimental functional validation, and structural investigation of predicted conserved sites, demonstrate the effectiveness and robustness of the proposed method.</p>
    <p id="Par28">Most known ARGs were found from culturable bacteria, and people used sequence comparison to explore and identify those sequences. As a result, tools based on sequence alignment, like DeepARG and CARD, could achieve satisfactory precision. However, the performance of DeepARG on characterizing the ARGs from intestinal microbiota (which are generally not cultured and distantly related to known ARGs) is worse than that of our deep learning model, although both methods are trained on known ARGs from culturable bacteria. Indeed, currently, there is no consensus on the optimal approach to detect ARGs, and all the methods play the trade-off between precision and recall. Very recently, DeepARG pushed a new version. We also did the cross-validation experiments with the latest version, finding out that its performance is similar to the old one, with a slightly better precision but substantially lower recall.</p>
    <p id="Par29">Moreover, since the inputs of our model are assembled sequences, its application scenarios may be limited, and it cannot work on short reads directly unless heavy computational pre-processing steps are done. This should be considered as one limitation of our framework. Extending HMD-ARG to classify the metagenomics short reads without assembling is a very promising research direction, which is desirable in many application scenarios. In the future, we will combine our framework with the newest sequencing technology, such as the Nanopore sequencing [<xref ref-type="bibr" rid="CR46">46</xref>–<xref ref-type="bibr" rid="CR50">50</xref>], to develop a pipeline that works on the short reads level or even the sequencing signal level.</p>
    <p id="Par30">We believe that HMD-ARG can serve as a powerful tool to alleviate the global threat of the rising abundance and diversity of antibiotic resistant genes. In the future, we will incorporate other dimensions of information, such as 3D structural information [<xref ref-type="bibr" rid="CR39">39</xref>] and SNPs, into our framework to further improve our method’s performance and extend the application scenarios.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Information</title>
    <sec id="Sec18">
      <p>
        <supplementary-material content-type="local-data" id="MOESM2">
          <media xlink:href="40168_2021_1002_MOESM2_ESM.docx">
            <caption>
              <p><bold>Additional file 1: Figure S1</bold>: ROC curve comparison. For ARG/Non-ARG prediction, we set different thresholds for the last layer of the HMD-ARG model and different parameters for DeepARG, drawing the above ROC curves. The figure suggests that HMD-ARG is more robust than DeepARG. <bold>Figure S2</bold>: Human intestinal microbiota prediction. After removing overlaps between HMD-ARG training data and the Mustard database, we trained a new model and applied the model to this human gut dataset. In the figure, we show the number of correctly predicted ARGs, by HMD-ARG and DeepARG, across different classes in the Mustard dataset. Compared to DeepARG, HMD-ARG can recover much more correct ARGs in more diverse classes, which suggests the robustness and the sensitivity of the proposed method. <bold>Figure S3</bold>: Growth curves of <italic>E. coli</italic> host with the expression of the predicted novel ARGs that inactivate antibiotics in the presence of antibiotics. a. The growth curve of <italic>E. coli</italic> under the presence of Ampicillins (50 μg/ml) b. The same to a, while removes the AXX01_04100, which is a predicted novel ARGs shares high similarity compared with known ones. c. The growth curve of <italic>E. coli</italic> under the presence of Carbenicillin (10 μg/ml) d. The same to c, while removes the AXX01_04100, which is a predicted novel ARG that shares high similarity compared with known ones. <bold>Figure S4</bold>: Correlation between saliency map and PSSM. a. For each position in a sequence, which is shown as the columns, we mutated the amino acid to the other amino acids, which are shown as the rows, and fed the mutated sequence to HMD-ARG model, determining the probability of the sequence being an ARG and filling in the value into the corresponding position in the saliency map with the probability. The figure shows the averaged saliency map of those sequences, which can be aligned to AFB78806. b. The figure shows the position-specific scoring matrix (PSSM) of AFB78806, which indicates the evolutionary information of that ARG. We can find a clear correlation between a) and b), especially for row c (horizontal rectangle) and column 226 (vertical rectangle). This correlation suggests that although we only used the protein sequence as input, without resorting to sequence alignment, HMD-ARG can capture the evolutional information of ARG sequences, which demonstrates the effectiveness of the proposed method. <bold>Figure S5</bold>: The saliency map built with PSSM. The PSSM predicted conserved sites and the corresponding sequence logo from 319 to 393 in AXX01_04100. <bold>Table S1</bold>: The list of ARGs predicted in the study and validated using heterogenous expression in <italic>E. coli</italic> host. <bold>Table S2</bold>: Primers used for constructing overexpression plasmids.</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher’s Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
    <fn>
      <p>Yu Li, Zeling Xu, Wenkai Han and Huiluo Cao contributed equally to this work.</p>
    </fn>
  </fn-group>
  <ack>
    <title>Acknowledgements</title>
    <p>Figure <xref rid="Fig1" ref-type="fig">1</xref> was created by Heno Hwang, scientific illustrator at King Abdullah University of Science and Technology (KAUST). We thank the review greatly for the thorough and detailed comments, which have improved the quality of the manuscript significantly.</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Authors’ contributions</title>
    <p>X.G., Y.L., and H.C. conceived this study. H.C. and Y.L. initiated the study. H.C. built the database. Y.L. and W.H. implemented the deep learning model. W.H. and Y.L. performed the computational evaluation of the proposed method and computational analysis of its prediction. Z.X. and H.C. performed the wet experimental validation. R.U. and Y.L. designed the webserver. Y.L., W.H., and H.C. wrote the manuscript under the supervision of X.G. All authors are involved in the discussion and finalization of the manuscript. The authors read and approved the final manuscript.</p>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>The research reported in this publication was supported by the King Abdullah University of Science and Technology (KAUST) Office of Sponsored Research (OSR) under Award No. FCC/1/1976-04, FCC/1/1976-06, FCC/1/1976-17, FCC/1/1976-18, FCC/1/1976-23, FCC/1/1976-25, FCC/1/1976-26, URF/1/3450-01, URF/1/4098-01-01, and REI/1/0018-01-01; National Natural Science Foundation of China (61731008, 61871428); and the Natural Science Foundation of Zhejiang Province of China (LJ19H180001); and CHP-PH-13, Health and Medical Research Fund (HMRF), to Dr. Pak-Leung Ho.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and materials</title>
    <p>The database and the software server are available at <ext-link ext-link-type="uri" xlink:href="http://www.cbrc.kaust.edu.sa/HMDARG/">http://www.cbrc.kaust.edu.sa/HMDARG/</ext-link>.</p>
  </notes>
  <notes id="FPar1">
    <title>Ethics approval and consent to participate</title>
    <p id="Par31">Not applicable.</p>
  </notes>
  <notes id="FPar2">
    <title>Consent for publication</title>
    <p id="Par32">Not applicable.</p>
  </notes>
  <notes id="FPar3" notes-type="COI-statement">
    <title>Competing interests</title>
    <p id="Par33">The authors declare that they have no competing interests.</p>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lazar</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Kishony</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Transient antibiotic resistance calls for attention</article-title>
        <source>Nat Microbiol</source>
        <year>2019</year>
        <volume>4</volume>
        <fpage>1606</fpage>
        <lpage>1607</lpage>
        <pub-id pub-id-type="doi">10.1038/s41564-019-0571-x</pub-id>
        <?supplied-pmid 31541208?>
        <pub-id pub-id-type="pmid">31541208</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <mixed-citation publication-type="other">Tackling Drug-Resistant Infections Globally: Final Report and Recommendations. Review on Antimicrobial Resistance (2016). &lt;<ext-link ext-link-type="uri" xlink:href="http://amr-review.org/sites/default/files/160525_Final%20paper_with%20cover.pdf">http://amr-review.org/sites/default/files/160525_Final%20paper_with%20cover.pdf</ext-link>&gt;.</mixed-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Allen</surname>
            <given-names>HK</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Call of the wild: antibiotic resistance genes in natural environments</article-title>
        <source>Nature Reviews Microbiology</source>
        <year>2010</year>
        <volume>8</volume>
        <fpage>251</fpage>
        <lpage>259</lpage>
        <pub-id pub-id-type="doi">10.1038/nrmicro2312</pub-id>
        <?supplied-pmid 20190823?>
        <pub-id pub-id-type="pmid">20190823</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Karkman</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Do</surname>
            <given-names>TT</given-names>
          </name>
          <name>
            <surname>Walsh</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Virta</surname>
            <given-names>MP</given-names>
          </name>
        </person-group>
        <article-title>Antibiotic-resistance genes in waste water</article-title>
        <source>Trends in microbiology</source>
        <year>2018</year>
        <volume>26</volume>
        <fpage>220</fpage>
        <lpage>228</lpage>
        <pub-id pub-id-type="doi">10.1016/j.tim.2017.09.005</pub-id>
        <pub-id pub-id-type="pmid">29033338</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Founou</surname>
            <given-names>LL</given-names>
          </name>
          <name>
            <surname>Founou</surname>
            <given-names>RC</given-names>
          </name>
          <name>
            <surname>Essack</surname>
            <given-names>SY</given-names>
          </name>
        </person-group>
        <article-title>Antibiotic resistance in the food chain: a developing country-perspective</article-title>
        <source>Frontiers in microbiology</source>
        <year>2016</year>
        <volume>7</volume>
        <fpage>1881</fpage>
        <pub-id pub-id-type="doi">10.3389/fmicb.2016.01881</pub-id>
        <pub-id pub-id-type="pmid">27933044</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>Q</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Yang</surname>
            <given-names>Q</given-names>
          </name>
        </person-group>
        <article-title>Occurrence and diversity of antibiotic resistance in untreated hospital wastewater</article-title>
        <source>Science of the Total Environment</source>
        <year>2018</year>
        <volume>621</volume>
        <fpage>990</fpage>
        <lpage>999</lpage>
        <pub-id pub-id-type="doi">10.1016/j.scitotenv.2017.10.128</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Xie</surname>
            <given-names>WY</given-names>
          </name>
          <name>
            <surname>Shen</surname>
            <given-names>Q</given-names>
          </name>
          <name>
            <surname>Zhao</surname>
            <given-names>F</given-names>
          </name>
        </person-group>
        <article-title>Antibiotics and antibiotic resistance from animal manures to soil: a review</article-title>
        <source>European journal of soil science</source>
        <year>2018</year>
        <volume>69</volume>
        <fpage>181</fpage>
        <lpage>195</lpage>
        <pub-id pub-id-type="doi">10.1111/ejss.12494</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gibson</surname>
            <given-names>MK</given-names>
          </name>
          <name>
            <surname>Forsberg</surname>
            <given-names>KJ</given-names>
          </name>
          <name>
            <surname>Dantas</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>Improved annotation of antibiotic resistance determinants reveals microbial resistomes cluster by ecology</article-title>
        <source>ISME J</source>
        <year>2015</year>
        <volume>9</volume>
        <fpage>207</fpage>
        <lpage>216</lpage>
        <pub-id pub-id-type="doi">10.1038/ismej.2014.106</pub-id>
        <?supplied-pmid 25003965?>
        <pub-id pub-id-type="pmid">25003965</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <mixed-citation publication-type="other">Boolchandani M, D’Souza AW, Dantas G. Sequencing-based methods and resources to study antimicrobial resistance. Nature Reviews Genetics. y;1.</mixed-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lakin</surname>
            <given-names>SM</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>MEGARes: an antimicrobial resistance database for high throughput sequencing</article-title>
        <source>Nucleic acids research</source>
        <year>2017</year>
        <volume>45</volume>
        <fpage>D574</fpage>
        <lpage>D580</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkw1009</pub-id>
        <pub-id pub-id-type="pmid">27899569</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Durbin</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Fast and accurate short read alignment with Burrows–Wheeler transform</article-title>
        <source>bioinformatics</source>
        <year>2009</year>
        <volume>25</volume>
        <fpage>1754</fpage>
        <lpage>1760</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btp324</pub-id>
        <pub-id pub-id-type="pmid">19451168</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bankevich</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>SPAdes: a new genome assembly algorithm and its applications to single-cell sequencing</article-title>
        <source>Journal of computational biology</source>
        <year>2012</year>
        <volume>19</volume>
        <fpage>455</fpage>
        <lpage>477</lpage>
        <pub-id pub-id-type="doi">10.1089/cmb.2012.0021</pub-id>
        <pub-id pub-id-type="pmid">22506599</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zerbino</surname>
            <given-names>DR</given-names>
          </name>
          <name>
            <surname>Birney</surname>
            <given-names>E</given-names>
          </name>
        </person-group>
        <article-title>Velvet: algorithms for de novo short read assembly using de Bruijn graphs</article-title>
        <source>Genome research</source>
        <year>2008</year>
        <volume>18</volume>
        <fpage>821</fpage>
        <lpage>829</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.074492.107</pub-id>
        <pub-id pub-id-type="pmid">18349386</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Peng</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Leung</surname>
            <given-names>HC</given-names>
          </name>
          <name>
            <surname>Yiu</surname>
            <given-names>S-M</given-names>
          </name>
          <name>
            <surname>Chin</surname>
            <given-names>FY</given-names>
          </name>
        </person-group>
        <article-title>IDBA-UD: a de novo assembler for single-cell and metagenomic sequencing data with highly uneven depth</article-title>
        <source>Bioinformatics</source>
        <year>2012</year>
        <volume>28</volume>
        <fpage>1420</fpage>
        <lpage>1428</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bts174</pub-id>
        <pub-id pub-id-type="pmid">22495754</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>C-M</given-names>
          </name>
          <name>
            <surname>Luo</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Sadakane</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Lam</surname>
            <given-names>T-W</given-names>
          </name>
        </person-group>
        <article-title>MEGAHIT: an ultra-fast single-node solution for large and complex metagenomics assembly via succinct de Bruijn graph</article-title>
        <source>Bioinformatics</source>
        <year>2015</year>
        <volume>31</volume>
        <fpage>1674</fpage>
        <lpage>1676</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btv033</pub-id>
        <pub-id pub-id-type="pmid">25609793</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Boolchandani</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>D’Souza</surname>
            <given-names>AW</given-names>
          </name>
          <name>
            <surname>Dantas</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>Sequencing-based methods and resources to study antimicrobial resistance</article-title>
        <source>Nature Reviews Genetics</source>
        <year>2019</year>
        <volume>20</volume>
        <fpage>356</fpage>
        <lpage>370</lpage>
        <pub-id pub-id-type="doi">10.1038/s41576-019-0108-4</pub-id>
        <?supplied-pmid 30886350?>
        <pub-id pub-id-type="pmid">30886350</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>Y</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>DEEPre: sequence-based enzyme EC number prediction by deep learning</article-title>
        <source>Bioinformatics</source>
        <year>2017</year>
        <volume>34</volume>
        <fpage>760</fpage>
        <lpage>769</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btx680</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <mixed-citation publication-type="other">Rao, R. et al. in Advances in Neural Information Processing Systems. 9686-9698.</mixed-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Alley</surname>
            <given-names>EC</given-names>
          </name>
          <name>
            <surname>Khimulya</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Biswas</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>AlQuraishi</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Church</surname>
            <given-names>GM</given-names>
          </name>
        </person-group>
        <article-title>Unified rational protein engineering with sequence-based deep representation learning</article-title>
        <source>Nature methods</source>
        <year>2019</year>
        <volume>16</volume>
        <fpage>1315</fpage>
        <lpage>1322</lpage>
        <pub-id pub-id-type="doi">10.1038/s41592-019-0598-1</pub-id>
        <pub-id pub-id-type="pmid">31636460</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Riesselman</surname>
            <given-names>AJ</given-names>
          </name>
          <name>
            <surname>Ingraham</surname>
            <given-names>JB</given-names>
          </name>
          <name>
            <surname>Marks</surname>
            <given-names>DS</given-names>
          </name>
        </person-group>
        <article-title>Deep generative models of genetic variation capture the effects of mutations</article-title>
        <source>Nature methods</source>
        <year>2018</year>
        <volume>15</volume>
        <fpage>816</fpage>
        <lpage>822</lpage>
        <pub-id pub-id-type="doi">10.1038/s41592-018-0138-4</pub-id>
        <pub-id pub-id-type="pmid">30250057</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <mixed-citation publication-type="other">Arango-Argoty G. DeepARG: a deep learning approach for predicting antibiotic resistance genes from metagenomic data. Microbiome. 2018;6. 10.1186/s40168-018-0401-z.</mixed-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cox</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Wright</surname>
            <given-names>GD</given-names>
          </name>
        </person-group>
        <article-title>Intrinsic antibiotic resistance: mechanisms, origins, challenges and solutions</article-title>
        <source>International Journal of Medical Microbiology</source>
        <year>2013</year>
        <volume>303</volume>
        <fpage>287</fpage>
        <lpage>292</lpage>
        <pub-id pub-id-type="doi">10.1016/j.ijmm.2013.02.009</pub-id>
        <pub-id pub-id-type="pmid">23499305</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Van Hoek</surname>
            <given-names>AH</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Acquired antibiotic resistance genes: an overview</article-title>
        <source>Frontiers in microbiology</source>
        <year>2011</year>
        <volume>2</volume>
        <fpage>203</fpage>
        <?supplied-pmid 22046172?>
        <pub-id pub-id-type="pmid">22046172</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ochman</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Lawrence</surname>
            <given-names>JG</given-names>
          </name>
          <name>
            <surname>Groisman</surname>
            <given-names>EA</given-names>
          </name>
        </person-group>
        <article-title>Lateral gene transfer and the nature of bacterial innovation</article-title>
        <source>Nature</source>
        <year>2000</year>
        <volume>405</volume>
        <fpage>299</fpage>
        <lpage>304</lpage>
        <pub-id pub-id-type="doi">10.1038/35012500</pub-id>
        <?supplied-pmid 10830951?>
        <pub-id pub-id-type="pmid">10830951</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <mixed-citation publication-type="other">Jia B, et al. CARD 2017: expansion and model-centric curation of the comprehensive antibiotic resistance database. Nucleic acids research. 2016:gkw1004.</mixed-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Feldgarden</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Validating the AMRFinder tool and resistance gene database by using antimicrobial resistance genotype-phenotype correlations in a collection of isolates</article-title>
        <source>Antimicrobial agents and chemotherapy</source>
        <year>2019</year>
        <volume>63</volume>
        <fpage>e00483</fpage>
        <lpage>e00419</lpage>
        <pub-id pub-id-type="doi">10.1128/AAC.00483-19</pub-id>
        <pub-id pub-id-type="pmid">31427293</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zankari</surname>
            <given-names>E</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Identification of acquired antimicrobial resistance genes</article-title>
        <source>Journal of antimicrobial chemotherapy</source>
        <year>2012</year>
        <volume>67</volume>
        <fpage>2640</fpage>
        <lpage>2644</lpage>
        <pub-id pub-id-type="doi">10.1093/jac/dks261</pub-id>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gupta</surname>
            <given-names>SK</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>ARG-ANNOT, a new bioinformatic tool to discover antibiotic resistance genes in bacterial genomes</article-title>
        <source>Antimicrobial agents and chemotherapy</source>
        <year>2014</year>
        <volume>58</volume>
        <fpage>212</fpage>
        <lpage>220</lpage>
        <pub-id pub-id-type="doi">10.1128/AAC.01310-13</pub-id>
        <pub-id pub-id-type="pmid">24145532</pub-id>
      </element-citation>
    </ref>
    <ref id="CR29">
      <label>29.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hall</surname>
            <given-names>BG</given-names>
          </name>
          <name>
            <surname>Barlow</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Revised Ambler classification of β-lactamases</article-title>
        <source>Journal of Antimicrobial Chemotherapy</source>
        <year>2005</year>
        <volume>55</volume>
        <fpage>1050</fpage>
        <lpage>1051</lpage>
        <pub-id pub-id-type="doi">10.1093/jac/dki130</pub-id>
      </element-citation>
    </ref>
    <ref id="CR30">
      <label>30.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>UniProt</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>UniProt: a hub for protein information</article-title>
        <source>Nucleic acids research</source>
        <year>2015</year>
        <volume>43</volume>
        <fpage>D204</fpage>
        <lpage>D212</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gku989</pub-id>
        <pub-id pub-id-type="pmid">25348405</pub-id>
      </element-citation>
    </ref>
    <ref id="CR31">
      <label>31.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Naas</surname>
            <given-names>T</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Beta-lactamase database (BLDB)–structure and function</article-title>
        <source>Journal of enzyme inhibition and medicinal chemistry</source>
        <year>2017</year>
        <volume>32</volume>
        <fpage>917</fpage>
        <lpage>919</lpage>
        <pub-id pub-id-type="doi">10.1080/14756366.2017.1344235</pub-id>
        <pub-id pub-id-type="pmid">28719998</pub-id>
      </element-citation>
    </ref>
    <ref id="CR32">
      <label>32.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sinha</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>On counting position weight matrix matches in a sequence, with application to discriminative motif finding</article-title>
        <source>Bioinformatics</source>
        <year>2006</year>
        <volume>22</volume>
        <fpage>e454</fpage>
        <lpage>e463</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btl227</pub-id>
        <?supplied-pmid 16873507?>
        <pub-id pub-id-type="pmid">16873507</pub-id>
      </element-citation>
    </ref>
    <ref id="CR33">
      <label>33.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Altschul</surname>
            <given-names>SF</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Gapped BLAST and PSI-BLAST: a new generation of protein database search programs</article-title>
        <source>Nucleic acids research</source>
        <year>1997</year>
        <volume>25</volume>
        <fpage>3389</fpage>
        <lpage>3402</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/25.17.3389</pub-id>
        <pub-id pub-id-type="pmid">9254694</pub-id>
      </element-citation>
    </ref>
    <ref id="CR34">
      <label>34.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lakin</surname>
            <given-names>SM</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Hierarchical Hidden Markov models enable accurate and diverse detection of antimicrobial resistance sequences</article-title>
        <source>Communications biology</source>
        <year>2019</year>
        <volume>2</volume>
        <fpage>1</fpage>
        <lpage>11</lpage>
        <pub-id pub-id-type="doi">10.1038/s42003-019-0545-9</pub-id>
        <pub-id pub-id-type="pmid">30740537</pub-id>
      </element-citation>
    </ref>
    <ref id="CR35">
      <label>35.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Doster</surname>
            <given-names>E</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>MEGARes 2.0: a database for classification of antimicrobial drug, biocide and metal resistance determinants in metagenomic sequence data</article-title>
        <source>Nucleic acids research</source>
        <year>2020</year>
        <volume>48</volume>
        <fpage>D561</fpage>
        <lpage>D569</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkz1010</pub-id>
        <pub-id pub-id-type="pmid">31722416</pub-id>
      </element-citation>
    </ref>
    <ref id="CR36">
      <label>36.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>White</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Ismail</surname>
            <given-names>HD</given-names>
          </name>
          <name>
            <surname>Saigo</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>CNN-BLPred: a convolutional neural network based predictor for β-lactamases (BL) and their classes</article-title>
        <source>BMC bioinformatics</source>
        <year>2017</year>
        <volume>18</volume>
        <fpage>577</fpage>
        <pub-id pub-id-type="doi">10.1186/s12859-017-1972-6</pub-id>
        <pub-id pub-id-type="pmid">29297322</pub-id>
      </element-citation>
    </ref>
    <ref id="CR37">
      <label>37.</label>
      <mixed-citation publication-type="other">Sommer MOA, Dantas G, Church GM. Functional characterization of the antibiotic resistance reservoir in the human microflora. Science. 2009;325. 10.1126/science.1176950.</mixed-citation>
    </ref>
    <ref id="CR38">
      <label>38.</label>
      <mixed-citation publication-type="other">Moore AM. Pediatric fecal microbiota harbor diverse and novel antibiotic resistance genes. PLoS ONE. 2013;8. 10.1371/journal.pone.0078822.</mixed-citation>
    </ref>
    <ref id="CR39">
      <label>39.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ruppe</surname>
            <given-names>E</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Prediction of the intestinal resistome by a three-dimensional structure-based method</article-title>
        <source>Nat Microbiol</source>
        <year>2019</year>
        <volume>4</volume>
        <fpage>112</fpage>
        <lpage>123</lpage>
        <pub-id pub-id-type="doi">10.1038/s41564-018-0292-6</pub-id>
        <?supplied-pmid 30478291?>
        <pub-id pub-id-type="pmid">30478291</pub-id>
      </element-citation>
    </ref>
    <ref id="CR40">
      <label>40.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Camacho</surname>
            <given-names>C</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>BLAST+: architecture and applications</article-title>
        <source>BMC Bioinformatics</source>
        <year>2009</year>
        <volume>10</volume>
        <fpage>421</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-10-421</pub-id>
        <?supplied-pmid 2803857?>
        <pub-id pub-id-type="pmid">20003500</pub-id>
      </element-citation>
    </ref>
    <ref id="CR41">
      <label>41.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kadir</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Brady</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Saliency, scale and image description</article-title>
        <source>International Journal of Computer Vision</source>
        <year>2001</year>
        <volume>45</volume>
        <fpage>83</fpage>
        <lpage>105</lpage>
        <pub-id pub-id-type="doi">10.1023/A:1012460413855</pub-id>
      </element-citation>
    </ref>
    <ref id="CR42">
      <label>42.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Modise</surname>
            <given-names>T</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Genomic Comparison between a Virulent Type A1 Strain of &lt;span class="named-content genus-species" id="named-content-1"&gt;Francisella tularensis&lt;/span&gt; and Its Attenuated O-Antigen Mutant</article-title>
        <source>Journal of Bacteriology</source>
        <year>2012</year>
        <volume>194</volume>
        <fpage>2775</fpage>
        <lpage>2776</lpage>
        <pub-id pub-id-type="doi">10.1128/jb.00152-12</pub-id>
        <?supplied-pmid 22535949?>
        <pub-id pub-id-type="pmid">22535949</pub-id>
      </element-citation>
    </ref>
    <ref id="CR43">
      <label>43.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Singh</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Saxena</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Singh</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>Identification of group specific motifs in beta-lactamase family of proteins</article-title>
        <source>J Biomed Sci</source>
        <year>2009</year>
        <volume>16</volume>
        <fpage>109</fpage>
        <pub-id pub-id-type="doi">10.1186/1423-0127-16-109</pub-id>
        <?supplied-pmid 19954553?>
        <pub-id pub-id-type="pmid">19954553</pub-id>
      </element-citation>
    </ref>
    <ref id="CR44">
      <label>44.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Källberg</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Template-based protein structure modeling using the RaptorX web server</article-title>
        <source>Nature Protocols</source>
        <year>2012</year>
        <volume>7</volume>
        <fpage>1511</fpage>
        <lpage>1522</lpage>
        <pub-id pub-id-type="doi">10.1038/nprot.2012.085</pub-id>
        <?supplied-pmid 22814390?>
        <pub-id pub-id-type="pmid">22814390</pub-id>
      </element-citation>
    </ref>
    <ref id="CR45">
      <label>45.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Trott</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Olson</surname>
            <given-names>AJ</given-names>
          </name>
        </person-group>
        <article-title>AutoDock Vina: improving the speed and accuracy of docking with a new scoring function, efficient optimization, and multithreading</article-title>
        <source>J Comput Chem</source>
        <year>2010</year>
        <volume>31</volume>
        <fpage>455</fpage>
        <lpage>461</lpage>
        <pub-id pub-id-type="doi">10.1002/jcc.21334</pub-id>
        <?supplied-pmid 3041641?>
        <pub-id pub-id-type="pmid">19499576</pub-id>
      </element-citation>
    </ref>
    <ref id="CR46">
      <label>46.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Yu</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Gao</surname>
            <given-names>X</given-names>
          </name>
        </person-group>
        <article-title>Wavenano: a signal-level nanopore base-caller via simultaneous prediction of nucleotide labels and move labels through bi-directional wavenets</article-title>
        <source>Quantitative Biology</source>
        <year>2018</year>
        <volume>6</volume>
        <fpage>359</fpage>
        <lpage>368</lpage>
        <pub-id pub-id-type="doi">10.1007/s40484-018-0155-4</pub-id>
      </element-citation>
    </ref>
    <ref id="CR47">
      <label>47.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>Y</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>DeepSimulator1. 5: a more powerful, quicker and lighter simulator for Nanopore sequencing</article-title>
        <source>Bioinformatics</source>
        <year>2020</year>
        <volume>36</volume>
        <fpage>2578</fpage>
        <lpage>2580</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btz963</pub-id>
        <pub-id pub-id-type="pmid">31913436</pub-id>
      </element-citation>
    </ref>
    <ref id="CR48">
      <label>48.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Han</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Gao</surname>
            <given-names>X</given-names>
          </name>
        </person-group>
        <article-title>Novel algorithms for efficient subsequence searching and mapping in nanopore raw signals towards targeted sequencing</article-title>
        <source>Bioinformatics</source>
        <year>2020</year>
        <volume>36</volume>
        <fpage>1333</fpage>
        <lpage>1343</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btz894</pub-id>
        <pub-id pub-id-type="pmid">31593235</pub-id>
      </element-citation>
    </ref>
    <ref id="CR49">
      <label>49.</label>
      <mixed-citation publication-type="other">Han R, Li L, Yang P, Zhang F, Gao X. A novel constrained reconstruction model towards high-resolution subtomogram averaging. Bioinformatics. 2019.</mixed-citation>
    </ref>
    <ref id="CR50">
      <label>50.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>Y</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>DeepSimulator: a deep simulator for Nanopore sequencing</article-title>
        <source>Bioinformatics</source>
        <year>2018</year>
        <volume>34</volume>
        <fpage>2899</fpage>
        <lpage>2908</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bty223</pub-id>
        <pub-id pub-id-type="pmid">29659695</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
