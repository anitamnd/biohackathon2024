<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Genome Biol</journal-id>
    <journal-id journal-id-type="iso-abbrev">Genome Biol</journal-id>
    <journal-title-group>
      <journal-title>Genome Biology</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1474-7596</issn>
    <issn pub-type="epub">1474-760X</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">8549298</article-id>
    <article-id pub-id-type="publisher-id">2512</article-id>
    <article-id pub-id-type="doi">10.1186/s13059-021-02512-x</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Method</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>phasebook: haplotype-aware de novo assembly of diploid genomes from long reads</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" equal-contrib="yes">
        <name>
          <surname>Luo</surname>
          <given-names>Xiao</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author" equal-contrib="yes">
        <name>
          <surname>Kang</surname>
          <given-names>Xiongbin</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0003-3529-0856</contrib-id>
        <name>
          <surname>Schönhuth</surname>
          <given-names>Alexander</given-names>
        </name>
        <address>
          <email>aschoen@cebitec.uni-bielefeld.de</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="GRID">grid.6054.7</institution-id><institution-id institution-id-type="ISNI">0000 0004 0369 4183</institution-id><institution>Life Science &amp; Health, </institution><institution>Centrum Wiskunde &amp; Informatica, </institution></institution-wrap>Amsterdam, The Netherlands </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="GRID">grid.7491.b</institution-id><institution-id institution-id-type="ISNI">0000 0001 0944 9128</institution-id><institution>Genome Data Science, Faculty of Technology, </institution><institution>Bielefeld University, </institution></institution-wrap>Bielefeld, Germany </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>27</day>
      <month>10</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>27</day>
      <month>10</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2021</year>
    </pub-date>
    <volume>22</volume>
    <elocation-id>299</elocation-id>
    <history>
      <date date-type="received">
        <day>22</day>
        <month>4</month>
        <year>2021</year>
      </date>
      <date date-type="accepted">
        <day>5</day>
        <month>10</month>
        <year>2021</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2021</copyright-statement>
      <license>
        <ali:license_ref specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p><bold>Open Access</bold> This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article’s Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article’s Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated in a credit line to the data.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <p id="Par1">Haplotype-aware diploid genome assembly is crucial in genomics, precision medicine, and many other disciplines. Long-read sequencing technologies have greatly improved genome assembly. However, current long-read assemblers are either reference based, so introduce biases, or fail to capture the haplotype diversity of diploid genomes. We present phasebook, a de novo approach for reconstructing the haplotypes of diploid genomes from long reads. phasebook outperforms other approaches in terms of haplotype coverage by large margins, in addition to achieving competitive performance in terms of assembly errors and assembly contiguity.</p>
      <sec>
        <title>Supplementary Information</title>
        <p>The online version contains supplementary material available at (10.1186/s13059-021-02512-x).</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Genome assembly</kwd>
      <kwd>Haplotype</kwd>
      <kwd>Diploid</kwd>
      <kwd>Long reads</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>Dutch Scientific Organization, Vidi grant</institution>
        </funding-source>
        <award-id>639.072.309</award-id>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>Chinese Scholarship Council</institution>
        </funding-source>
        <award-id>Not applicable</award-id>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>Chinese Scholarship Council</institution>
        </funding-source>
        <award-id>Not applicable</award-id>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100010665</institution-id>
            <institution>H2020 Marie Sklodowska-Curie Actions</institution>
          </institution-wrap>
        </funding-source>
        <award-id>956229</award-id>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100010665</institution-id>
            <institution>H2020 Marie Sklodowska-Curie Actions</institution>
          </institution-wrap>
        </funding-source>
        <award-id>872539</award-id>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>Universität Bielefeld (3146)</institution>
        </funding-source>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2021</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec2">
    <title>Background</title>
    <p>There are generally multiple copies of hereditary material in most eukaryotic organisms, where each copy is inherited from one of the ancestors. The copy-specific nucleic acid sequences are called <italic>haplotypes</italic>, and the haplotype-specific contigs that assembly programs compute for reconstructing them are often referred to as <italic>haplotigs</italic>. Most vertebrates (such as human and mouse) and many higher plants (such as maize and arabidopsis) are diploid, which means that there are two copies for each chromosome.</p>
    <p>Haplotype reconstruction plays a crucial role in various disciplines. For example, haplotype information is important in functional genomics since there is widespread allele-specific gene expression across the human genome [<xref ref-type="bibr" rid="CR1">1</xref>]; haplotype information also crucially supports studies on population demography, gene flow, and selection in conservation genomics [<xref ref-type="bibr" rid="CR2">2</xref>]; the haplotype-specific combinations of genetic variants usually affect disease phenotypes and clinical responses, which is of great concern in precision medicine [<xref ref-type="bibr" rid="CR3">3</xref>, <xref ref-type="bibr" rid="CR4">4</xref>].</p>
    <p>Over the last few years, long-read sequencing technologies such as single-molecule real-time (SMRT) sequencing of Pacific Biosciences (PacBio) and nanopore sequencing of Oxford Nanopore Technologies (ONT) have improved genome assembly greatly because sequencing reads are sufficiently long (generally ranging from several kbp to hundreds of kbp, or even to a few Mbp) to also span more complex repeat regions [<xref ref-type="bibr" rid="CR5">5</xref>–<xref ref-type="bibr" rid="CR8">8</xref>].</p>
    <p>Although long reads have tremendous advantages in terms of read length in comparison with next-generation sequencing (NGS)–derived short reads, they suffer from (substantially) elevated sequencing error rates. In particular, PacBio CLR and ONT reads, as the most representative examples of long reads, have a sequencing error rate as high as 5 to 15%. While PacBio HiFi reads have much lower error rates (&lt; 1<italic>%</italic>), and in comparison with NGS reads are still long, such reads considerably sacrifice on read length in comparison with PacBio CLR and ONT. The significant differences in terms of read length and error characteristics explain why short-read genome assembly tools cannot be directly applied for long-read data; novel approaches are required.</p>
    <p>Existing methods for haplotype reconstruction of diploid genome from long reads basically fall into two classes. The first one involves alignment-based methods, which are referred to as <italic>haplotype assembly</italic> programs. Recent works such as WhatsHap [<xref ref-type="bibr" rid="CR9">9</xref>], HapCut2 [<xref ref-type="bibr" rid="CR10">10</xref>], and HapCol [<xref ref-type="bibr" rid="CR11">11</xref>] are designed for diploid haplotype assembly. It is characteristic for these tools to make use of a high-quality reference as a backbone sequence. They align reads to it to call variants using external tools. Subsequently, variants are separated into different haplotypes based on their own phasing algorithms. The output haplotigs of these tools then reflect modified reference sequence patches. However, because only minor modifications of the backbone sequence can be applied, the haplotigs can be affected by non-negligible biases.</p>
    <p>For avoiding reference induced biases, de novo assembly-based methods can be used as an alternative. A series of remarkable de novo genome assemblers specialized for long-read sequencing data have been developed so far. FALCON [<xref ref-type="bibr" rid="CR12">12</xref>], which follows the hierarchical genome assembly process, and its haplotype-aware version FALCON-Unzip are mainly designed for PacBio long reads. Improved Phased Assembler (IPA) [<xref ref-type="bibr" rid="CR13">13</xref>] is designed to produce phased genome assemblies from PacBio HiFi reads. Canu [<xref ref-type="bibr" rid="CR14">14</xref>] uses adaptive overlapping algorithm and sparse assembly graph construction which helps to separate repeats and haplotypes, and its modification version HiCanu [<xref ref-type="bibr" rid="CR15">15</xref>] is tailored for haplotype aware assembly from PacBio HiFi reads. Moreover, Flye [<xref ref-type="bibr" rid="CR16">16</xref>] tries to generate optimal assemblies using repeat graphs. Generic long-read assemblers Shasta [<xref ref-type="bibr" rid="CR17">17</xref>] and Wtdbg2 [<xref ref-type="bibr" rid="CR18">18</xref>] considerably speed up the large-scale long-read assembly based on novel graph representations. Notably, Hifiasm [<xref ref-type="bibr" rid="CR19">19</xref>] is a haplotype-resolved assembler specifically designed for PacBio HiFi reads. A graph-based approach to haplotype aware diploid assembly was proposed in [<xref ref-type="bibr" rid="CR20">20</xref>], which combines accurate short-read data and long-read (PacBio) data in a hybrid (employing both NGS and long reads) type framework.</p>
    <p>There are various other long-read assembly approaches, all of which are not designed to produce haplotype-aware assemblies. They usually collapse homologous sequences into one consensus sequence and therefore do not distinguish between the haplotypes of a diploid genome sufficiently accurately. We refer the reader to [<xref ref-type="bibr" rid="CR17">17</xref>, <xref ref-type="bibr" rid="CR21">21</xref>] for a comprehensive overview of such tools.</p>
    <p>In summary, long-read assemblers are either designed to work for only specific types of data, such as PacBio HiFi or ONT, or they do not address haplotype-aware assembly of diploid genomes by design. In somewhat more detail, there is no method that combines the following three important points: it generates high-quality haplotype-aware genome assemblies only based on long-read data (1); is capable of handling all three of PacBio CLR, PacBio HiFi, and Nanopore reads (2); and does not depend on high-quality reference sequence as a backbone (3).</p>
    <p>Here, we present <italic>phasebook</italic> and suggest it as an approach that to the best of our knowledge is the first one to address all (1), (2), and (3) in combination. By bridging the gap in the body of existing work, phasebook appears to be the first approach that presents a framework that allows to reconstruct the haplotypes of diploid genomes de novo from long reads without having to specialize in a particular sequencing technology.</p>
    <p>We evaluate phasebook on different long-read sequencing data, namely PacBio CLR/HiFi reads and Nanopore reads. Benchmarking results on both simulated and real data indicate that our method outperforms state-of-the-art tools (both haplotype assembly and de novo assembly approaches) in terms of various aspects. Thereby, an application scenario of major interest is to reconstruct individual haplotypes of the major histocompatibility complex (MHC) region, spanning ∼ 5 Mbp of chromosome 6 and playing a pivotal role in the adaptive immune system. Because of its great hereditary variability, haplotype identity is of utmost interest with respect to numerous human diseases and the corresponding medical treatments. Overall, phasebook generates more complete, more accurate, and, with respect to full contig length statistics, comparably long haplotigs compared with other approaches in this particularly challenging case.</p>
  </sec>
  <sec id="Sec3" sec-type="results">
    <title>Results</title>
    <p>We have designed and implemented phasebook, a novel approach to assemble individual haplotypes of diploid genomes from long-read sequencing data, namely PacBio HiFi, PacBio CLR, and Oxford Nanopore reads. In this section, we provide a high-level description of the workflow and evaluate its performance on both simulated and real data, in comparison with an exhaustive selection of existing state-of-the-art tools. These tools include both de novo long-read assemblers and reference-based haplotype assembly approaches.</p>
    <sec id="Sec4">
      <title>Approach</title>
      <p>See Fig. <xref rid="Fig1" ref-type="fig">1</xref> for an illustration of the following description. For full details on the following outline, see descriptions of the individual steps in the workflow figure in the “Methods” section.
<fig id="Fig1"><label>Fig. 1</label><caption><p>An overview of phasebook. The purple text represents that this step is optional. <italic>Correct errors from raw reads</italic> is recommended for long reads with high sequencing error rate such as PacBio CLR and ONT reads. <italic>Filter overlaps based on SNPs</italic> is recommended for small genomes or specific genomic regions such as MHCs</p></caption><graphic xlink:href="13059_2021_2512_Fig1_HTML" id="MO1"/></fig></p>
      <sec id="Sec5">
        <title>Motivation and related work</title>
        <p>From a larger perspective, phasebook pursues a <italic>divide-and-conquer strategy:</italic> in the <italic>divide</italic> stage, it collects contiguous raw reads into small local clusters. Each of the clusters then refers to a local instance of the <italic>minimum error correction (MEC)</italic> problem, the solution of which yields two haplotype-specific super reads. In the <italic>conquer</italic> stage, all haplotype-specific super reads are assembled following the overlap-layout-consensus (OLC) assembly paradigm, using an overlap graph where nodes correspond to the super reads and edges indicate that two super reads are likely to stem from identical haplotypes.</p>
        <p>As such, phasebook reflects a combination of an approach that solves the MEC problem without reference sequence first and performs OLC-ased assembly in a haplotype-aware setting second.</p>
        <p>The <italic>key insight</italic> is to first phase (and error correct) reads locally and only then perform global assembly. Local phasing is possible because local coordinate systems can be raised in a way that does not introduce biases that hamper the process. Having phased reads before assembly (and having corrected errors accordingly) then renders global assembly using OLC techniques easy in comparison with OLC-based approaches that work with unphased data.</p>
        <p>As a whole—combining the MEC problem in a divide stage with OLC-bsaed assembly in a conquer stage—the workflow of phasebook appears to be a novelty, to the best of our judgment. The components of phasebook are inspired by a few recent approaches.</p>
        <p>The divide stage is inspired by WhatsHap [<xref ref-type="bibr" rid="CR9">9</xref>], as an approach that is based on the minimum error correction (MEC) framework. However, while WhatsHap achieves good performance in phasing long third-generation sequencing reads in particular, it crucially depends on the availability of high-quality reference. Here, we set the framework for solving the MEC problem when high-quality reference genome sequence is not available.</p>
        <p>After solving the resulting local MEC instances, phasebook adopts techniques to support haplotype-aware de novo assembly based on overlap graphs, in full consistency with prior steps, in the <italic>conquer stage</italic>. In this, phasebook is inspired by recent, related work on short reads that focuses on overlap graph based assembly (see SAVAGE [<xref ref-type="bibr" rid="CR22">22</xref>] or POLYTE [<xref ref-type="bibr" rid="CR23">23</xref>], for example). Here, we adapt these techniques to dealing with long reads. For computing the necessary overlaps, we make use of Minimap2 [<xref ref-type="bibr" rid="CR24">24</xref>], as the superior current approach to compute overlaps among long reads in sufficiently short time also for large datasets.</p>
      </sec>
      <sec id="Sec6">
        <title>Overview of Technical Steps</title>
        <p>Each of the two stages falls into <italic>two basic steps</italic>.</p>
        <p>In the <italic>divide</italic> stage, phasebook <italic>first</italic> determines the clusters where each of the clusters reflects a collection of reads that overlap each other in terms of genomic position (executed by “Algorithm 1” in Fig. <xref rid="Fig1" ref-type="fig">1</xref>).</p>
        <p>Secondly, <italic>during divide,</italic> phasebook solves an instance of the MEC problem for each such cluster. For this, as abovementioned, phasebook follows the algorithmic principles of WhatsHap [<xref ref-type="bibr" rid="CR9">9</xref>, <xref ref-type="bibr" rid="CR25">25</xref>]. The decisive challenge for making this possible is to provide local reference sequence with which one can solve the local instances of the MEC problem. We recall that we operate in a de novo setting, such that we cannot expect reference sequence to exist in the first place. Here, we need to provide sufficiently reliable reference sequence for the small segments of the genome the clusters of reads stem from.</p>
        <p>See “Assembly” and “Reads mapping to call SNPs” in Fig. <xref rid="Fig2" ref-type="fig">2</xref> for the descriptions in the following paragraph. For computing such local reference sequences for each of the read clusters, we first construct a local overlap graph, and subsequently compute an ad hoc reference for each of the clusters based on the overlap graph (see the “Read overlap graph” and “Ad hoc reference construction” sections). After polishing this ad hoc reference, we determine the polymorphic loci using Longshot [<xref ref-type="bibr" rid="CR26">26</xref>], as a state-of-the-art tool for calling variants in long reads (see the “SNP calling” section); note that we need these variants for phasing reads by solving the MEC problem in the following. We determine a multiple alignment of all reads in a cluster based on the ad hoc reference. Overall, the procedure implies in particular to have setup reference coordinates, as provided by the positions in the ad hoc reference, that are sufficiently free of sequential biases.
<fig id="Fig2"><label>Fig. 2</label><caption><p>A schematic diagram for read phasing and super read generation in a read cluster. The blue reads belong to haplotype 1, and the orange reads belong to haplotype 2. The bold sky blue read means that this read is a seed read. We use WhatsHap to separate reads into two different groups based on SNPs involved in long reads. The dash line regions in super reads represent the bases with sequencing low coverage, which can be optionally trimmed to generate corrected super reads</p></caption><graphic xlink:href="13059_2021_2512_Fig2_HTML" id="MO2"/></fig></p>
        <p>In Fig. <xref rid="Fig1" ref-type="fig">1</xref>, this comprises all steps from “assemble to ad hoc reference” to “polish and trim super read” (where polishing and trimming may be required in low coverage areas). As pointed out above, see also Fig. <xref rid="Fig2" ref-type="fig">2</xref> for further illustrations. Solving the local MEC problem for each cluster results in two super reads that reflect local haplotypes for each cluster (one of which generated as per the blue, and one of which generated as per the red branch in Fig. <xref rid="Fig1" ref-type="fig">1</xref>).</p>
        <p>In the <italic>conquer</italic> stage, phasebook <italic>first</italic> constructs an overlap graph on all super reads emerging from the divide stage (comprising all steps from “Merge super reads” to “Filter overlaps based on SNPs” in Fig. <xref rid="Fig1" ref-type="fig">1</xref>). In this graph, edges indicate that two overlapping super-reads stem from the same haplotype, based on statistical considerations. The number of super reads is much smaller than the number of raw reads, which renders the construction of this overlap graph easily manageable (which arguably is a virtue of the design of the workflow overall). Because super reads are haplotype-specific, the corresponding overlap graph virtually consists of two components each of which reflects one of the haplotypes, with only a handful spurious edges connecting the components, see Fig. <xref rid="Fig3" ref-type="fig">3</xref> for further illustration.
<fig id="Fig3"><label>Fig. 3</label><caption><p>A schematic diagram for super read overlap graph construction. The blue super reads belong to haplotype 1, and the orange super reads belong to haplotype 2. The solid arrow lines (blue or orange) represent non-transitive edges, and the dash arrow lines represent transitive edges. The solid arrow lines (reddish purple) represent spurious edges caused by incorrect super read overlaps from different haplotypes</p></caption><graphic xlink:href="13059_2021_2512_Fig3_HTML" id="MO3"/></fig></p>
        <p>Finally, in the <italic>second step of the conquer stage</italic>, super reads are assembled into haplotype-specific contigs by careful elimination of redundant and spurious edges, where the identification of spurious edges is based on evaluating (putative) polymorphic sites. After edge elimination, phasebook lays out paths in the resulting connected components of the overlap graph, indicated by “Simplify graph” and “Merge simple paths” in Fig. <xref rid="Fig1" ref-type="fig">1</xref>.</p>
        <p>See the “Methods” section for full details on each of the sub-steps involved in the overall workflow.</p>
      </sec>
    </sec>
    <sec id="Sec7">
      <title>Datasets</title>
      <sec id="Sec8">
        <title>Simulated data</title>
        <p>We simulated various datasets using different long-read sequencing technologies, namely, PacBio CLR, PacBio HiFi, and ONT. Generally, PacBio CLR and ONT reads have high sequencing error rate (5 ∼ 15%), while PacBio HiFi reads have much lower error rate (&lt; 1<italic>%</italic>). We selected two human MHC haplotypes from the Vega Genome Browser: PGF and COX. Subsequently, we used PBSIM [<xref ref-type="bibr" rid="CR27">27</xref>] model-based simulation to generate PacBio CLR reads of N50 length 20 kbp and average sequencing error rate 10% for each of the two haplotypes at a coverage of 25 ×. We used PBSIM sampling-based simulation to generate PacBio HiFi reads of N50 length 10 kbp for each of two haplotypes at a coverage of 15 × by utilizing human individual HG00731 as the sample profile, which was downloaded from EBI. Besides, we used NanoSim V2.6.0 [<xref ref-type="bibr" rid="CR28">28</xref>] as an approved simulator to generate ONT reads of N50 length 20 kbp and average sequencing error rate 10% using the built-in pre-trained model human_NA12878_DNA_FAB49712_albacore for each of the two haplotypes at a coverage of 25 ×. For each sequencing platform, the reads from each of the two haplotypes were combined respectively, resulting a read set for a pseudo-diploid genome (PGF and COX). Additionally, we used PBSIM model-based simulation to generate PacBio CLR reads of N50 length 20 kbp and average sequencing error rate 10% for each of the two haplotypes at a coverage of 15 ×, 25 ×, 35 ×, and 45 ×, in order to evaluate the effect of sequencing coverage.</p>
      </sec>
      <sec id="Sec9">
        <title>Real data</title>
        <p>To evaluate our method on real sequencing data, we downloaded PacBio HiFi and CLR sequencing reads of human individual HG00733 from EBI and SRA (accession number: SRR7615963) and Oxford Nanopore PromethION sequencing reads of human individual NA19240 from ENA where the project ID is PRJEB26791. Subsequently, we extracted reads primarily aligned to chromosome 6, which is ∼ 170 Mbp in length. The approximate sequencing coverage per haplotype of chromosome 6 for these three types of long reads is 18 ×, 44 ×, and 26 ×. Full-length haplotypes have been reconstructed for HG00733 and NA19240 in a recent study [<xref ref-type="bibr" rid="CR29">29</xref>] by applying multi-platform sequencing technologies and specialized algorithms. Hence, we downloaded the corresponding haplotype sequences as the ground truth for benchmarking experiments with the focus on chromosome 6. As for a whole human genome, we benchmarked tools on the individual HG002, on all three kinds of long reads. In addition, we benchmarked tools on PacBio CLR sequencing data of <italic>Arabidopsis thaliana</italic> (<italic>A. thaliana</italic>). More details about data sources are shown in “Availability of data and materials” section.</p>
      </sec>
    </sec>
    <sec id="Sec10">
      <title>Run other approaches for comparison</title>
      <sec id="Sec11">
        <title>Reference-guided haplotype assembly</title>
        <p>Haplotype assembly methods such as WhatsHap and HapCut2 take as input a reference genome sequence and a variant set (unphased VCF file), and output a phased VCF file. For simulated data, we selected another MHC haplotype (named DBB) as the reference also from the Vega Genome Browser. For real data, we extracted the sequence of chromosome 6 from GRCh38 as the reference for HG00733 (Chr6) and NA19240 (Chr6) datasets. Likewise, we used the GRCh38 and assembly TAIR10.1 as references for HG002 and <italic>A. thaliana</italic> datasets, respectively. Note that the Chr6 haplotypes of HG00733, NA19240, and HG002 are quite diverged from GRCh38 Chr6, and the TAIR10.1 is one of the parental strain of the sequenced <italic>A. thaliana</italic>. Subsequently, we aligned sequencing reads to reference genomes and called variants using Minimap2 and Longshot, respectively. Ultimately, we followed the method proposed in [<xref ref-type="bibr" rid="CR23">23</xref>] to reconstruct contigs for each haplotype block from phased VCF files using bcftools consensus.</p>
      </sec>
      <sec id="Sec12">
        <title>De novo haplotype aware assembly</title>
        <p>For the sake of a fair comparison of the performance of the assembly programs, we chose to use the results which keep the haplotype information rather than collapse it. Consequently, we used the combination of primary contigs and associated contigs for Hifiasm and Falcon, and added the option –keep-haplotypes when running Flye, for haplotype-aware comparisons. For the remaining assemblers, we just compared with the contigs as output, because of the lack of alternative options. Note that we failed to run Falcon-Unzip on our datasets<xref ref-type="fn" rid="Fn1">1</xref>, because no adequate read overlaps were generated likely due to too low coverage, thus only results of Falcon are reported. To avoid excessive, redundant computations for whole genomes, we downloaded the assemblies of HG002 (HiFi, ONT) whenever available as previously published. For HG002 (CLR), we successfully ran tools such as Canu, WhatsHap, and HapCut2 but failed to run others because of limited computational resources.</p>
        <p>In addition to phasebook itself, we implemented a strategy that combines stand-alone error correction (and not necessarily combining error correction with phasing as in phasebook) with phasebook’s HiFi mode, referred to as <italic>phasebook-hi</italic> in the following. As for error correction, we used Canu because it offers error-corrected versions of the raw reads as convenient, separate output. The idea behind phasebook-hi was the development of a somewhat more aggressive version of phasebook that trades off exactness in terms of phasing (as demonstrated by more misassemblies and switch errors by phasebook-hi) with enhanced contiguity (as indicated by more long haplotigs in phasebook-hi). Preempting a detailed discussion, it seems that phasebook-hi leads to improvements in general when dealing with relatively variant poor diploid genomes (such as <italic>A. thaliana</italic>). We benchmarked phasebook-hi on both simulated and real data (PacBio CLR and ONT reads) for comparison.</p>
      </sec>
    </sec>
    <sec id="Sec13">
      <title>Assembly performance evaluation</title>
      <p>The assembly performance was evaluated by means of several commonly used metrics, routinely reported by QUAST v5.1.0 [<xref ref-type="bibr" rid="CR30">30</xref>], as a prominent tool that evaluates assemblies <italic>relative to a reference</italic> (see the “Metrics” section for specific explanations. For reference-guided haplotype assembly approaches, we generated contigs for each haplotype from phased variants, even if haplotypes share highly similar regions. De novo assembly approaches, however, can assemble genomic sequences from regions shared by the different haplotypes only once, which can be interpreted misleadingly. To circumvent the issue, for evaluating reference-guided methods, we used the parameter –ambiguity-usage one, whereas for de novo assemblers, we used the parameters –ambiguity-usage all and –ambiguity-score 0.999 so as to obtain reasonable alignments of contigs with both haplotypes.</p>
      <p>In addition to QUAST, we used Merqury v1.3 [<xref ref-type="bibr" rid="CR31">31</xref>] as a <italic>reference-free</italic> genome assembly evaluation tool. This way, one could assess the performance relative to the individual haplotypes, whenever parental sequencing data was available which was applicable for all genomes under consideration here (see more details in section “Commands and versions of tools used for comparison” in Additional file <xref rid="MOESM1" ref-type="media">1</xref>).</p>
    </sec>
    <sec id="Sec14">
      <title>Metrics</title>
      <sec id="Sec15">
        <title>Haplotype completeness</title>
        <p>Haplotype completeness is measured by two metrics, namely, haplotype coverage (HC) and <italic>k</italic>-mer recovery rate.</p>
        <p>Haplotype coverage is the percentage of aligned bases in the ground truth haplotypes covered by haplotigs, which is reported by QUAST and used to measure the overall completeness of the assembly.</p>
        <p><italic>k</italic>-mer recovery rate is reported by Mercury and consists of two aspects. First, <italic>k</italic>-mer completeness (<italic>k</italic>-mer recovery “All” in Tables <xref rid="Tab1" ref-type="table">1</xref>, <xref rid="Tab2" ref-type="table">2</xref>, and <xref rid="Tab3" ref-type="table">3</xref>) is equal to the number of solid <italic>k</italic>-mers found in the assembly divided by the solid <italic>k</italic>-mers in the read set. Second, maternal and paternal hap-mer completeness (<italic>k</italic>-mer recovery “Mat” and “Pat” in Tables <xref rid="Tab1" ref-type="table">1</xref>, <xref rid="Tab2" ref-type="table">2</xref>, and <xref rid="Tab3" ref-type="table">3</xref>) is calculated analogously, but only for the haplotype it refers to.
<table-wrap id="Tab1"><label>Table 1</label><caption><p>Benchmarking results for PacBio HiFi data</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Dataset</th><th align="left">Assembler</th><th align="left">Size (Mb)</th><th align="left">HC (%)</th><th align="left" colspan="3"><italic>k</italic>-mer recovery(%)</th><th align="left" colspan="3">Continuity (bp)</th><th align="left">QV</th><th align="left">Switch error(%)</th><th align="left"><italic>N</italic> (%)</th><th align="left">Dup (%)</th></tr><tr><th align="left"/><th align="left"/><th align="left"/><th align="left"/><th align="left">All</th><th align="left">Mat</th><th align="left">Pat</th><th align="left">NG50</th><th align="left">NGA50</th><th align="left">Phased N50</th><th align="left"/><th align="left"/><th align="left"/><th align="left"/></tr></thead><tbody><tr><td align="left">MHC (HiFi 15x)</td><td align="left">phasebook-hi</td><td align="left">11.2</td><td align="left">99.4</td><td align="left">99.9</td><td align="left">99.9</td><td align="left">99.5</td><td align="left">546,476</td><td align="left">539,378</td><td align="left">383,554</td><td align="left">46.7</td><td align="left">0.04</td><td align="left">0.0</td><td align="left">1.19</td></tr><tr><td align="left"/><td align="left">HiCanu</td><td align="left">9.5</td><td align="left">90.8</td><td align="left">100.0</td><td align="left">99.8</td><td align="left">99.9</td><td align="left">4,827,925</td><td align="left">517,913</td><td align="left">460,744</td><td align="left">42.1</td><td align="left">0.00</td><td align="left">0.0</td><td align="left">1.23</td></tr><tr><td align="left"/><td align="left">Flye</td><td align="left">5.1</td><td align="left">56.0</td><td align="left">96.0</td><td align="left">77.4</td><td align="left">78.1</td><td align="left">138,470</td><td align="left">10,861</td><td align="left">58,919</td><td align="left">44.0</td><td align="left">2.79</td><td align="left">0.0</td><td align="left">0.92</td></tr><tr><td align="left"/><td align="left">Hifiasm</td><td align="left">9.7</td><td align="left">97.3</td><td align="left">100.0</td><td align="left">99.9</td><td align="left">100.0</td><td align="left">4,878,334</td><td align="left">2,205,550</td><td align="left">620,366</td><td align="left">59.8</td><td align="left">0.01</td><td align="left">0.0</td><td align="left">1.21</td></tr><tr><td align="left"/><td align="left">IPA</td><td align="left">8.6</td><td align="left">81.9</td><td align="left">99.5</td><td align="left">92.7</td><td align="left">99.6</td><td align="left">1,426,746</td><td align="left">818,630</td><td align="left">589,604</td><td align="left">47.8</td><td align="left">0.03</td><td align="left">0.0</td><td align="left">1.15</td></tr><tr><td align="left"/><td align="left">Wtdbg2</td><td align="left">4.7</td><td align="left">49.8</td><td align="left">91.2</td><td align="left">47.0</td><td align="left">70.5</td><td align="left">–</td><td align="left">–</td><td align="left">72,528</td><td align="left">38.6</td><td align="left">3.76</td><td align="left">0.0</td><td align="left">0.77</td></tr><tr><td align="left"/><td align="left"><italic>HapCut2</italic></td><td align="left">9.0</td><td align="left">56.5</td><td align="left">84.7</td><td align="left">54.7</td><td align="left">54.0</td><td align="left">257,599</td><td align="left">155,079</td><td align="left">167,061</td><td align="left">31.4</td><td align="left">5.90</td><td align="left">9.0</td><td align="left">1.50</td></tr><tr><td align="left"/><td align="left"><italic>WhatsHap</italic></td><td align="left">9.0</td><td align="left">59.4</td><td align="left">84.7</td><td align="left">55.2</td><td align="left">53.7</td><td align="left">257,599</td><td align="left">155,079</td><td align="left">176,555</td><td align="left">31.4</td><td align="left">6.26</td><td align="left">9.0</td><td align="left">1.43</td></tr><tr><td align="left">HG00733 (Chr6) (HiFi 18x)</td><td align="left">phasebook-hi</td><td align="left">378.6</td><td align="left">91.2</td><td align="left">99.3</td><td align="left">96.7</td><td align="left">96.3</td><td align="left">517,478</td><td align="left">491,919</td><td align="left">317,664</td><td align="left">47.6</td><td align="left">2.08</td><td align="left">0.0</td><td align="left">1.53</td></tr><tr><td align="left"/><td align="left">HiCanu</td><td align="left">344.6</td><td align="left">83.9</td><td align="left">99.7</td><td align="left">97.3</td><td align="left">97.4</td><td align="left">1,456,437</td><td align="left">991,541</td><td align="left">440,882</td><td align="left">39.2</td><td align="left">1.76</td><td align="left">0.0</td><td align="left">1.42</td></tr><tr><td align="left"/><td align="left">Flye</td><td align="left">169.0</td><td align="left">55.1</td><td align="left">97.9</td><td align="left">53.3</td><td align="left">49.3</td><td align="left">–</td><td align="left">–</td><td align="left">70,128</td><td align="left">45.0</td><td align="left">11.40</td><td align="left">0.0</td><td align="left">0.97</td></tr><tr><td align="left"/><td align="left">Hifiasm</td><td align="left">341.5</td><td align="left">93.5</td><td align="left">99.7</td><td align="left">97.1</td><td align="left">96.5</td><td align="left">28,008,203</td><td align="left">10,513,146</td><td align="left">673,184</td><td align="left">46.4</td><td align="left">1.81</td><td align="left">0.0</td><td align="left">1.12</td></tr><tr><td align="left"/><td align="left">IPA</td><td align="left">280.5</td><td align="left">73.3</td><td align="left">99.2</td><td align="left">82.8</td><td align="left">86.0</td><td align="left">1,612,661</td><td align="left">722,645</td><td align="left">460,373</td><td align="left">41.7</td><td align="left">1.95</td><td align="left">0.0</td><td align="left">1.21</td></tr><tr><td align="left"/><td align="left">Wtdbg2</td><td align="left">167.3</td><td align="left">54.8</td><td align="left">97.3</td><td align="left">49.4</td><td align="left">47.3</td><td align="left">–</td><td align="left">–</td><td align="left">72,850</td><td align="left">40.6</td><td align="left">16.09</td><td align="left">0.0</td><td align="left">0.97</td></tr><tr><td align="left"/><td align="left"><italic>HapCut2</italic></td><td align="left">340.8</td><td align="left">76.5</td><td align="left">99.3</td><td align="left">91.7</td><td align="left">91.1</td><td align="left">379,321</td><td align="left">354,305</td><td align="left">330,339</td><td align="left">40.8</td><td align="left">6.48</td><td align="left">0.4</td><td align="left">1.3</td></tr><tr><td align="left"/><td align="left"><italic>WhatsHap</italic></td><td align="left">340.9</td><td align="left">76.5</td><td align="left">99.3</td><td align="left">91.7</td><td align="left">91.1</td><td align="left">381,196</td><td align="left">359,841</td><td align="left">327,329</td><td align="left">40.9</td><td align="left">6.52</td><td align="left">0.4</td><td align="left">1.3</td></tr><tr><td align="left">HG002(HiFi 14x)</td><td align="left">phasebook-hi</td><td align="left">6709</td><td align="left">–</td><td align="left">97.5</td><td align="left">80.0</td><td align="left">85.0</td><td align="left">136,140</td><td align="left">–</td><td align="left">111,668</td><td align="left">50.5</td><td align="left">0.33</td><td align="left">0.0</td><td align="left">–</td></tr><tr><td align="left"/><td align="left">HiCanu</td><td align="left">2953</td><td align="left">–</td><td align="left">97.1</td><td align="left">49.8</td><td align="left">54.0</td><td align="left">–</td><td align="left">–</td><td align="left">937,018</td><td align="left">57.9</td><td align="left">0.15</td><td align="left">0.0</td><td align="left">–</td></tr><tr><td align="left"/><td align="left">Falcon</td><td align="left">2955</td><td align="left">–</td><td align="left">97.3</td><td align="left">49.5</td><td align="left">62.2</td><td align="left">–</td><td align="left">–</td><td align="left">501,274</td><td align="left">49.1</td><td align="left">0.40</td><td align="left">0.0</td><td align="left">–</td></tr><tr><td align="left"/><td align="left">Hifiasm</td><td align="left">3067</td><td align="left">–</td><td align="left">97.5</td><td align="left">49.6</td><td align="left">65.3</td><td align="left">–</td><td align="left">–</td><td align="left">1,146,665</td><td align="left">54.0</td><td align="left">0.11</td><td align="left">0.0</td><td align="left">–</td></tr><tr><td align="left"/><td align="left"><italic>HapCut2</italic></td><td align="left">6435</td><td align="left">–</td><td align="left">98.8</td><td align="left">87.8</td><td align="left">90.2</td><td align="left">145,138,636</td><td align="left">–</td><td align="left">858,407</td><td align="left">40.0</td><td align="left">1.64</td><td align="left">5.4</td><td align="left">–</td></tr><tr><td align="left"/><td align="left"><italic>WhatsHap</italic></td><td align="left">6435</td><td align="left">–</td><td align="left">98.8</td><td align="left">87.8</td><td align="left">90.2</td><td align="left">145,138,636</td><td align="left">–</td><td align="left">858,156</td><td align="left">40.0</td><td align="left">1.64</td><td align="left">5.4</td><td align="left">–</td></tr></tbody></table><table-wrap-foot><p>The sequencing technology and the average sequencing coverage per haplotype are shown in the first column. The MHC dataset is simulated whereas the others are real. Size (Mb) represents the size of assemblies generated by each assembler. Due to lack of high-quality phased assemblies as the ground truth, haplotype coverage and NGA50 for HG002 are not provided. NGA50/NG50 calculation uses a diploid genome size (double haploid genome size). The haploid genome size of MHC, HG00733(Chr6), and HG002 is 4.7 Mb, 171 Mb, and 3.1 Gb, respectively. HC(%) is the haplotype coverage. In the <italic>k</italic>-mer recovery (%) multicolumn, all is the <italic>k</italic>-mer completeness for both haplotypes combined, mat is maternal hap-mer completeness and pat is paternal hap-mer completeness. <italic>N</italic> (%) is the ambiguous bases proportion. Dup (%) is the duplication ratio. The assemblers marked as italics (<italic>HapCut2</italic> and <italic>WhatsHap</italic>) are <italic>reference-guided</italic> methods, whereas the others are de novo assembly methods. Note that we compared with IPA in MHC and HG00733(Chr6) datasets, the official PacBio assembler for HiFi reads instead of Falcon. The publicly released assemblies of HG002 (Canu, Falcon, Hifiasm) were directly used for comparison</p></table-wrap-foot></table-wrap><table-wrap id="Tab2"><label>Table 2</label><caption><p>Benchmarking results for PacBio CLR data</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Dataset</th><th align="left">Assembler</th><th align="left">Size (Mb)</th><th align="left">HC (%)</th><th align="left" colspan="3"><italic>k</italic>-mer recovery(%)</th><th align="left" colspan="3">Continuity (bp)</th><th align="left">QV</th><th align="left">Switch error(%)</th><th align="left"><italic>N</italic> (%)</th><th align="left">Dup (%)</th></tr><tr><th align="left"/><th align="left"/><th align="left"/><th align="left"/><th align="left">All</th><th align="left">Mat</th><th align="left">Pat</th><th align="left">NG50</th><th align="left">NGA50</th><th align="left">Phased N50</th><th align="left"/><th align="left"/><th align="left"/><th align="left"/></tr></thead><tbody><tr><td align="left">MHC (CLR 25x)</td><td align="left">phasebook</td><td align="left">10.8</td><td align="left">95.2</td><td align="left">96.7</td><td align="left">88.0</td><td align="left">76.3</td><td align="left">172,577</td><td align="left">172,577</td><td align="left">133,141</td><td align="left">37.7</td><td align="left">0.66</td><td align="left">0.0</td><td align="left">1.36</td></tr><tr><td align="left"/><td align="left">phasebook-hi</td><td align="left">14.3</td><td align="left">98.0</td><td align="left">97.5</td><td align="left">89.4</td><td align="left">88.8</td><td align="left">361,721</td><td align="left">354,437</td><td align="left">122,594</td><td align="left">40.6</td><td align="left">6.26</td><td align="left">0.0</td><td align="left">1.88</td></tr><tr><td align="left"/><td align="left">Canu</td><td align="left">5.9</td><td align="left">59.2</td><td align="left">96.3</td><td align="left">80.7</td><td align="left">76.9</td><td align="left">2,184,005</td><td align="left">62,395</td><td align="left">65,217</td><td align="left">39.4</td><td align="left">4.57</td><td align="left">0.0</td><td align="left">0.92</td></tr><tr><td align="left"/><td align="left">Falcon</td><td align="left">5.4</td><td align="left">60.5</td><td align="left">94.3</td><td align="left">82.2</td><td align="left">68.8</td><td align="left">4,814,264</td><td align="left">32,719</td><td align="left">120,818</td><td align="left">27.6</td><td align="left">5.24</td><td align="left">0.0</td><td align="left">1.17</td></tr><tr><td align="left"/><td align="left">Flye</td><td align="left">5.0</td><td align="left">74.1</td><td align="left">94.2</td><td align="left">64.2</td><td align="left">70.5</td><td align="left">548,628</td><td align="left">66,242</td><td align="left">74,992</td><td align="left">37.1</td><td align="left">5.34</td><td align="left">0.0</td><td align="left">1.01</td></tr><tr><td align="left"/><td align="left">Wtdbg2</td><td align="left">4.7</td><td align="left">58.9</td><td align="left">90.5</td><td align="left">46.9</td><td align="left">63.2</td><td align="left">–</td><td align="left">–</td><td align="left">102,431</td><td align="left">33.0</td><td align="left">5.49</td><td align="left">0.0</td><td align="left">0.93</td></tr><tr><td align="left"/><td align="left"><italic>HapCut2</italic></td><td align="left">9.1</td><td align="left">56.4</td><td align="left">84.2</td><td align="left">53.7</td><td align="left">53.0</td><td align="left">393,164</td><td align="left">254,386</td><td align="left">282,817</td><td align="left">31.3</td><td align="left">5.93</td><td align="left">8.9</td><td align="left">1.52</td></tr><tr><td align="left"/><td align="left"><italic>WhatsHap</italic></td><td align="left">9.2</td><td align="left">56.6</td><td align="left">84.2</td><td align="left">53.4</td><td align="left">53.2</td><td align="left">393,164</td><td align="left">254,386</td><td align="left">279,136</td><td align="left">31.2</td><td align="left">5.62</td><td align="left">8.8</td><td align="left">1.52</td></tr><tr><td align="left">HG00733 (Chr6) (CLR 44x)</td><td align="left">phasebook</td><td align="left">453.2</td><td align="left">92.9</td><td align="left">98.7</td><td align="left">89.7</td><td align="left">90.6</td><td align="left">256,934</td><td align="left">253,785</td><td align="left">164,373</td><td align="left">32.6</td><td align="left">5.50</td><td align="left">0.0</td><td align="left">1.92</td></tr><tr><td align="left"/><td align="left">phasebook-hi</td><td align="left">291.0</td><td align="left">81.0</td><td align="left">97.9</td><td align="left">68.2</td><td align="left">65.3</td><td align="left">587,151</td><td align="left">552,300</td><td align="left">201,382</td><td align="left">33.9</td><td align="left">14.41</td><td align="left">0.0</td><td align="left">1.33</td></tr><tr><td align="left"/><td align="left">Canu</td><td align="left">178.0</td><td align="left">56.8</td><td align="left">97.9</td><td align="left">52.7</td><td align="left">52.9</td><td align="left">110,328</td><td align="left">–</td><td align="left">119,821</td><td align="left">38.8</td><td align="left">17.57</td><td align="left">0.0</td><td align="left">0.98</td></tr><tr><td align="left"/><td align="left">Falcon</td><td align="left">185.6</td><td align="left">63.4</td><td align="left">95.1</td><td align="left">41.8</td><td align="left">42.0</td><td align="left">155,444</td><td align="left">132,950</td><td align="left">142,167</td><td align="left">28.6</td><td align="left">22.22</td><td align="left">0.0</td><td align="left">1.04</td></tr><tr><td align="left"/><td align="left">Flye</td><td align="left">168.1</td><td align="left">51.9</td><td align="left">97.6</td><td align="left">25.4</td><td align="left">75.8</td><td align="left">–</td><td align="left">–</td><td align="left">2,094,032</td><td align="left">42.9</td><td align="left">3.12</td><td align="left">0.0</td><td align="left">0.99</td></tr><tr><td align="left"/><td align="left">Wtdbg2</td><td align="left">165.2</td><td align="left">64.6</td><td align="left">88.9</td><td align="left">35.3</td><td align="left">35.3</td><td align="left">–</td><td align="left">–</td><td align="left">142,300</td><td align="left">24.2</td><td align="left">20.07</td><td align="left">0.0</td><td align="left">1.0</td></tr><tr><td align="left"/><td align="left"><italic>HapCut2</italic></td><td align="left">341.3</td><td align="left">61.8</td><td align="left">99.3</td><td align="left">92.1</td><td align="left">91.7</td><td align="left">3,899,799</td><td align="left">1,944,878</td><td align="left">1,346,888</td><td align="left">41.0</td><td align="left">5.65</td><td align="left">0.4</td><td align="left">1.57</td></tr><tr><td align="left"/><td align="left"><italic>WhatsHap</italic></td><td align="left">341.3</td><td align="left">63.4</td><td align="left">99.3</td><td align="left">92.1</td><td align="left">91.6</td><td align="left">3,349,274</td><td align="left">1,944,877</td><td align="left">1,334,202</td><td align="left">40.9</td><td align="left">5.72</td><td align="left">0.4</td><td align="left">1.53</td></tr><tr><td align="left">HG002 (CLR 25x)</td><td align="left">phasebook</td><td align="left">5829</td><td align="left">–</td><td align="left">92.3</td><td align="left">60.1</td><td align="left">59.2</td><td align="left">96,740</td><td align="left">–</td><td align="left">70,473</td><td align="left">31.9</td><td align="left">1.61</td><td align="left">0.0</td><td align="left">–</td></tr><tr><td align="left"/><td align="left">phasebook-hi</td><td align="left">6590</td><td align="left">–</td><td align="left">97.1</td><td align="left">62.0</td><td align="left">70.6</td><td align="left">312,775</td><td align="left">–</td><td align="left">150,123</td><td align="left">35.2</td><td align="left">7.16</td><td align="left">0.0</td><td align="left">–</td></tr><tr><td align="left"/><td align="left">Canu</td><td align="left">3119</td><td align="left">–</td><td align="left">97.1</td><td align="left">49.5</td><td align="left">62.3</td><td align="left">47,412</td><td align="left">–</td><td align="left">207,853</td><td align="left">40.0</td><td align="left">6.49</td><td align="left">0.0</td><td align="left">–</td></tr><tr><td align="left"/><td align="left"><italic>HapCut2</italic></td><td align="left">6435</td><td align="left">–</td><td align="left">98.8</td><td align="left">87.9</td><td align="left">90.2</td><td align="left">145,138,636</td><td align="left">–</td><td align="left">1,756,246</td><td align="left">40.1</td><td align="left">1.52</td><td align="left">5.4</td><td align="left">–</td></tr><tr><td align="left"/><td align="left"><italic>WhatsHap</italic></td><td align="left">6435</td><td align="left">–</td><td align="left">98.8</td><td align="left">87.9</td><td align="left">90.2</td><td align="left">145,138,636</td><td align="left">–</td><td align="left">1,729,580</td><td align="left">40.1</td><td align="left">1.52</td><td align="left">5.4</td><td align="left">–</td></tr><tr><td align="left">A. thaliana (CLR 75x)</td><td align="left">phasebook</td><td align="left">301</td><td align="left">–</td><td align="left">89.7</td><td align="left">76.6</td><td align="left">76.0</td><td align="left">66,120</td><td align="left">–</td><td align="left">39,513</td><td align="left">27.0</td><td align="left">2.78</td><td align="left">0.0</td><td align="left">–</td></tr><tr><td align="left"/><td align="left">phasebook-hi</td><td align="left">296</td><td align="left">–</td><td align="left">94.9</td><td align="left">89.5</td><td align="left">88.8</td><td align="left">301,078</td><td align="left">–</td><td align="left">149,964</td><td align="left">33.4</td><td align="left">4.25</td><td align="left">0.0</td><td align="left">–</td></tr><tr><td align="left"/><td align="left">Canu</td><td align="left">238</td><td align="left">–</td><td align="left">94.4</td><td align="left">86.8</td><td align="left">86.6</td><td align="left">204,191</td><td align="left">–</td><td align="left">64,998</td><td align="left">31.9</td><td align="left">4.88</td><td align="left">0.0</td><td align="left">–</td></tr><tr><td align="left"/><td align="left">Flye</td><td align="left">142</td><td align="left">–</td><td align="left">87.1</td><td align="left">62.8</td><td align="left">62.5</td><td align="left">35,796</td><td align="left">–</td><td align="left">30,209</td><td align="left">30.0</td><td align="left">7.54</td><td align="left">0.0</td><td align="left">–</td></tr><tr><td align="left"/><td align="left">Wtdbg2</td><td align="left">125</td><td align="left">–</td><td align="left">35.1</td><td align="left">26.4</td><td align="left">26.3</td><td align="left">11,374</td><td align="left">–</td><td align="left">35,733</td><td align="left">14.4</td><td align="left">15.17</td><td align="left">0.0</td><td align="left">–</td></tr><tr><td align="left"/><td align="left"><italic>HapCut2</italic></td><td align="left">238</td><td align="left">–</td><td align="left">91.3</td><td align="left">99.4</td><td align="left">53.3</td><td align="left">18,585,056</td><td align="left">–</td><td align="left">531,267</td><td align="left">36.4</td><td align="left">5.73</td><td align="left">0.2</td><td align="left">–</td></tr><tr><td align="left"/><td align="left"><italic>WhatsHap</italic></td><td align="left">238</td><td align="left">–</td><td align="left">91.3</td><td align="left">99.5</td><td align="left">53.3</td><td align="left">1,8585,056</td><td align="left">–</td><td align="left">1,637,965</td><td align="left">36.3</td><td align="left">5.72</td><td align="left">0.2</td><td align="left">–</td></tr></tbody></table><table-wrap-foot><p>Due to lack of high-quality phased assemblies as the ground truth, haplotype coverage and NGA50 for HG002 and <italic>A. thaliana</italic> are not provided. We failed to run Falcon, Flye, and Wtdbg2 for the HG002 (CLR) data on a computing machine (48 cores, 1 TB RAM) probably because of running out of memory. The method phasebook-hi represents a combination of performing Canu’s error correction and trim module on raw noisy long reads and then performing genome assembly for corrected reads with phasebook (HiFi mode)</p></table-wrap-foot></table-wrap><table-wrap id="Tab3"><label>Table 3</label><caption><p>Benchmarking results for ONT data</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Dataset</th><th align="left">Assembler</th><th align="left">Size (Mb)</th><th align="left">HC (%)</th><th align="left" colspan="3"><italic>k</italic>-mer recovery(%)</th><th align="left" colspan="3">Continuity (bp)</th><th align="left">QV</th><th align="left">Switch error(%)</th><th align="left"><italic>N</italic> (%)</th><th align="left">Dup (%)</th></tr><tr><th align="left"/><th align="left"/><th align="left"/><th align="left"/><th align="left">All</th><th align="left">Mat</th><th align="left">Pat</th><th align="left">NG50</th><th align="left">NGA50</th><th align="left">Phased N50</th><th align="left"/><th align="left"/><th align="left"/><th align="left"/></tr></thead><tbody><tr><td align="left">MHC (ONT 25x)</td><td align="left">phasebook</td><td align="left">14.5</td><td align="left">97.0</td><td align="left">98.4</td><td align="left">94.0</td><td align="left">87.7</td><td align="left">152,599</td><td align="left">152,599</td><td align="left">102,954</td><td align="left">36.9</td><td align="left">0.78</td><td align="left">0.0</td><td align="left">1.82</td></tr><tr><td align="left"/><td align="left">phasebook-hi</td><td align="left">14.8</td><td align="left">91.6</td><td align="left">97.5</td><td align="left">89.4</td><td align="left">88.8</td><td align="left">796,423</td><td align="left">746,361</td><td align="left">176,895</td><td align="left">40.6</td><td align="left">6.99</td><td align="left">0.0</td><td align="left">1.96</td></tr><tr><td align="left"/><td align="left">Canu</td><td align="left">5.9</td><td align="left">59.6</td><td align="left">95.4</td><td align="left">83.2</td><td align="left">65.9</td><td align="left">1,419,330</td><td align="left">93,217</td><td align="left">100,918</td><td align="left">33.4</td><td align="left">6.44</td><td align="left">0.0</td><td align="left">0.84</td></tr><tr><td align="left"/><td align="left">Falcon</td><td align="left">6.3</td><td align="left">67.8</td><td align="left">94.3</td><td align="left">82.2</td><td align="left">68.8</td><td align="left">2,489,921</td><td align="left">442,832</td><td align="left">220,087</td><td align="left">27.6</td><td align="left">4.65</td><td align="left">0.0</td><td align="left">1.10</td></tr><tr><td align="left"/><td align="left">Flye</td><td align="left">5.0</td><td align="left">54.5</td><td align="left">95.0</td><td align="left">81.4</td><td align="left">62.6</td><td align="left">792,993</td><td align="left">86,893</td><td align="left">106,195</td><td align="left">39.7</td><td align="left">6.22</td><td align="left">0.0</td><td align="left">0.82</td></tr><tr><td align="left"/><td align="left">Shasta</td><td align="left">5.0</td><td align="left">63.0</td><td align="left">86.8</td><td align="left">62.5</td><td align="left">48.5</td><td align="left">957,250</td><td align="left">136,119</td><td align="left">147,280</td><td align="left">23.7</td><td align="left">10.71</td><td align="left">0.0</td><td align="left">0.89</td></tr><tr><td align="left"/><td align="left">Wtdbg2</td><td align="left">5.0</td><td align="left">76.5</td><td align="left">89.1</td><td align="left">67.0</td><td align="left">47.4</td><td align="left">4,821,843</td><td align="left">208,838</td><td align="left">136,335</td><td align="left">24.3</td><td align="left">4.33</td><td align="left">0.0</td><td align="left">0.99</td></tr><tr><td align="left"/><td align="left"><italic>HapCut2</italic></td><td align="left">9.1</td><td align="left">55.9</td><td align="left">84.5</td><td align="left">55.6</td><td align="left">52.9</td><td align="left">493,723</td><td align="left">279,218</td><td align="left">367,400</td><td align="left">31.5</td><td align="left">6.33</td><td align="left">8.9</td><td align="left">1.53</td></tr><tr><td align="left"/><td align="left"><italic>WhatsHap</italic></td><td align="left">9.2</td><td align="left">56.9</td><td align="left">84.4</td><td align="left">55.3</td><td align="left">53.0</td><td align="left">493,723</td><td align="left">279,218</td><td align="left">324,450</td><td align="left">31.5</td><td align="left">5.47</td><td align="left">8.9</td><td align="left">1.51</td></tr><tr><td align="left">NA19240 (Chr6) (ONT 26x)</td><td align="left">phasebook</td><td align="left">380.8</td><td align="left">84.4</td><td align="left">87.5</td><td align="left">53.9</td><td align="left">55.1</td><td align="left">90,219</td><td align="left">85,595</td><td align="left">51,291</td><td align="left">20.6</td><td align="left">36.96</td><td align="left">0.0</td><td align="left">1.87</td></tr><tr><td align="left"/><td align="left">phasebook-hi</td><td align="left">335.5</td><td align="left">79.4</td><td align="left">83.7</td><td align="left">46.3</td><td align="left">45.9</td><td align="left">127,968</td><td align="left">122,097</td><td align="left">63,798</td><td align="left">22.3</td><td align="left">40.12</td><td align="left">0.0</td><td align="left">1.76</td></tr><tr><td align="left"/><td align="left">Canu</td><td align="left">169.2</td><td align="left">65.4</td><td align="left">83.9</td><td align="left">40.7</td><td align="left">40.8</td><td align="left">–</td><td align="left">–</td><td align="left">129,586</td><td align="left">22.5</td><td align="left">35.40</td><td align="left">0.0</td><td align="left">0.98</td></tr><tr><td align="left"/><td align="left">Falcon</td><td align="left">179.3</td><td align="left">64.0</td><td align="left">77.7</td><td align="left">33.7</td><td align="left">35.4</td><td align="left">69,660</td><td align="left">37,993</td><td align="left">162,461</td><td align="left">20.5</td><td align="left">35.72</td><td align="left">0.0</td><td align="left">1.02</td></tr><tr><td align="left"/><td align="left">Flye</td><td align="left">167.4</td><td align="left">57.3</td><td align="left">89.4</td><td align="left">40.1</td><td align="left">48.3</td><td align="left">–</td><td align="left">–</td><td align="left">115,043</td><td align="left">25.1</td><td align="left">31.85</td><td align="left">0.0</td><td align="left">0.99</td></tr><tr><td align="left"/><td align="left">Shasta</td><td align="left">164.9</td><td align="left">62.7</td><td align="left">76.8</td><td align="left">33.2</td><td align="left">34.2</td><td align="left">–</td><td align="left">–</td><td align="left">190,758</td><td align="left">20.2</td><td align="left">39.98</td><td align="left">0.0</td><td align="left">0.99</td></tr><tr><td align="left"/><td align="left">Wtdbg2</td><td align="left">166.7</td><td align="left">60.6</td><td align="left">78.3</td><td align="left">33.2</td><td align="left">33.9</td><td align="left">–</td><td align="left">–</td><td align="left">160,729</td><td align="left">20.4</td><td align="left">35.13</td><td align="left">0.0</td><td align="left">0.98</td></tr><tr><td align="left"/><td align="left"><italic>HapCut2</italic></td><td align="left">341.3</td><td align="left">56.2</td><td align="left">96.3</td><td align="left">71.2</td><td align="left">71.2</td><td align="left">27,552,232</td><td align="left">3,285,944</td><td align="left">105,889</td><td align="left">23.0</td><td align="left">29.39</td><td align="left">0.4</td><td align="left">1.68</td></tr><tr><td align="left"/><td align="left"><italic>WhatsHap</italic></td><td align="left">341.3</td><td align="left">56.4</td><td align="left">96.2</td><td align="left">71.1</td><td align="left">71.3</td><td align="left">27,552,232</td><td align="left">3,520,811</td><td align="left">102,096</td><td align="left">23.0</td><td align="left">28.45</td><td align="left">0.4</td><td align="left">1.70</td></tr><tr><td align="left">HG002 (ONT 38x)</td><td align="left">phasebook</td><td align="left">5691</td><td align="left">–</td><td align="left">92.0</td><td align="left">62.2</td><td align="left">63.2</td><td align="left">390,659</td><td align="left">–</td><td align="left">202,723</td><td align="left">26.6</td><td align="left">2.28</td><td align="left">0.0</td><td align="left">–</td></tr><tr><td align="left"/><td align="left">Canu</td><td align="left">2901</td><td align="left">–</td><td align="left">84.5</td><td align="left">39.3</td><td align="left">51.6</td><td align="left">–</td><td align="left">–</td><td align="left">266,624</td><td align="left">23.2</td><td align="left">10.27</td><td align="left">0.0</td><td align="left">–</td></tr><tr><td align="left"/><td align="left">Flye</td><td align="left">2928</td><td align="left">–</td><td align="left">83.9</td><td align="left">38.5</td><td align="left">50.6</td><td align="left">–</td><td align="left">–</td><td align="left">287,619</td><td align="left">23.0</td><td align="left">11.94</td><td align="left">0.0</td><td align="left">–</td></tr><tr><td align="left"/><td align="left">Shasta</td><td align="left">2805</td><td align="left">–</td><td align="left">88.8</td><td align="left">40.9</td><td align="left">53.2</td><td align="left">–</td><td align="left">–</td><td align="left">276,802</td><td align="left">25.0</td><td align="left">12.59</td><td align="left">0.0</td><td align="left">–</td></tr><tr><td align="left"/><td align="left">Wtdbg2</td><td align="left">2794</td><td align="left">–</td><td align="left">83.0</td><td align="left">34.4</td><td align="left">44.2</td><td align="left">–</td><td align="left">–</td><td align="left">239,707</td><td align="left">22.8</td><td align="left">9.62</td><td align="left">0.0</td><td align="left">–</td></tr></tbody></table><table-wrap-foot><p>The publicly released assemblies of HG002 (Canu, Flye, Shasta, Wtdbg2) were directly used for comparison. We failed to run HapCut2 and WhatsHap for HG002 data on a computing machine (48 cores, 1 TB RAM) probably due to running out of memory</p></table-wrap-foot></table-wrap></p>
      </sec>
      <sec id="Sec16">
        <title>Contiguity</title>
        <p>N50, NG50, NGA50, and Phased N50 (phased block N50) are used to measure the contiguity of an assembly. N50 is defined as the length for which the collection of all contigs of that length or longer covers at least half of the assembly. NG50 is similar to N50 except that half of the true genome, and not the assembly needs to be covered. NGA50 is similar to NG50 insofar as contigs are replaced by only the blocks of the contigs that can be consistently aligned with the true genome. Phased N50 is similar to N50 where instead of contigs, phased blocks of contigs are considered; unlike the other metrics, Phased N50 is reported by Merqury, but not by Quast.</p>
      </sec>
      <sec id="Sec17">
        <title>Accuracy</title>
        <p>Quality value (QV) and switch error rates, as reported by Merqury, are estimated in a reference-free way. Besides, N-rate is defined as the proportion of ambiguous bases (‘N’s) in the assembly, which is reported by QUAST.</p>
      </sec>
      <sec id="Sec18">
        <title>Duplication ratio</title>
        <p>Duplication ratio is equal to the total amount of aligned bases in the assembly divided by the total amount of aligned bases in the reference sequences, which is reported by QUAST.</p>
      </sec>
    </sec>
    <sec id="Sec19">
      <title>Benchmarking experiments</title>
      <sec id="Sec20">
        <title>Summary</title>
        <p>In the following evaluation, we focus on the criteria that relate to performance in terms of phasing, like haplotype coverage, <italic>k</italic>-mer recovery rate, NGA50 and Phased N50, and switch error rate, apart from a basic evaluation of haplotigs in terms of error content, first and foremost (see Tables <xref rid="Tab1" ref-type="table">1</xref>, <xref rid="Tab2" ref-type="table">2</xref>, and <xref rid="Tab3" ref-type="table">3</xref> for the corresponding statistics). Please note that values like N50 and NG50, and contig length in general, are relatively meaningless in a setting that addresses to assemble genomes in a haplotype-aware manner (contig length alone comes regardless of haplotype awareness, so highlights effects that can be seriously misleading). We therefore list these numbers only for completeness, see Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Tables S1, S2 and S3 for the corresponding statistics.</p>
        <p>We performed benchmarking experiments including all methods on the simulated and real data as described above, for all three types of long reads, namely, PacBio HiFi, PacBio CLR, and Oxford Nanopore reads (see details in the section “Commands and versions of tools used for comparison” in Additional file <xref rid="MOESM1" ref-type="media">1</xref>). In summary, the results show that for both simulated and real PacBio HiFi reads, Hifiasm and phasebook share top performance. phasebook apparently reconstructs more complete (indicated by HC, <italic>k</italic>-mer recovery), comparably equally continuous (indicated by NGA50, phased block N50), and accurate (QV, switch error, N-rate) haplotigs than the other approaches. While Hifiasm is on a par with phasebook on HiFi data, advantages of phasebook are most evident for PacBio CLR, and Nanopore reads, where it outperforms other methods in terms of haplotype coverage on both simulated and real data in terms of a relatively large margin. At the same time, phasebook maintains better or similar performance in terms of various other metrics (NGA50, phased block N50, QV, switch error, and N-rate). More details on the results are provided in the following sections.</p>
      </sec>
      <sec id="Sec21">
        <title>PacBio HiFi reads</title>
        <p>Table <xref rid="Tab1" ref-type="table">1</xref> shows the assembly statistics on PacBio HiFi reads. In the simulation experiment (MHC), phasebook achieves the largest haplotype coverage (HC 99.4%), while on real data (HG00733-Chr6), it reconstructs the second largest part of the haplotypes (HC 91.2%), rivaled only by Hifiasm (HC 93.5%). On whole-genome real data (HG002), phasebook also obtains the second largest the haplotype completeness (all 97.5%, maternal 80.0%, paternal 85.0%), outperformed only by the reference-guided approaches HapCut2 and WhatsHap (all 98.8%, mat 87.8%, pat 90.2%). Apart from HapCut2 and WhatsHap requiring a reference genome, this is further compensated by the fact that HapCut2 and WhatsHap fail to achieve a large fraction of the haplotype sequence when dealing with Chromosome 6 (HC, only &lt;76.5%), the effects of which are likely to persist also on the entire genome. As for assembly contiguity, phasebook outperforms Flye and Wtdbg2 among de novo assemblers in terms of NGA50 and Phased N50 in both MHC and HG00733-Chr6 datasets.</p>
        <p>The currently most predominant reference-guided methods (WhatsHap and HapCut2) only yield less than 60% and 77% haplotype coverage in MHC and HG00733-Chr6 datasets, respectively, though achieving the highest <italic>k</italic>-mer recovery in HG002. Meanwhile, they have NGA50 and phased block N50 about twice as short in MHC compared with phasebook, whereas yielding similar and longer length in HG00733-Chr6 and HG002 datasets, respectively. Further, they have lower QV and much higher switch error rates in comparison with phasebook on all three datasets, and they clearly the largest N-rates in comparison with other methods. All these effects can be attributed to making use of a reference genome. De novo assemblies, which do not suffer from biases that are inherent to reference genome based approaches, do not have such high switch errors and N-rates (in fact they do not contain any <italic>N</italic>).</p>
        <p>See also Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S1 for contig length statistics. While the N50 of phasebook is much smaller, the amount of very long contigs is substantially greater than that of other approaches, so proves to be very well able to compute very long contigs. In general, phasebook generates substantially more contigs, which explains the relationship between N50 and long contigs. We point out again that contig length only has ambiguous value in the context of haplotype-aware assembly. The great N50 for Flye and Wtdbg2, for example, could be due to collapsing bubbles and smoothing tangled regions in the assembly graph, which is indicated by the relatively large amount of erroneous bases and misassemblies for the two tools, which further also prevents them from separating the two phases.</p>
      </sec>
      <sec id="Sec22">
        <title>PacBio CLR reads</title>
        <p>See Table <xref rid="Tab2" ref-type="table">2</xref> for the following discussions. Note that here we do not only consider phasebook itself, but also its more aggressive version phasebook-hi (reflecting to error correct reads first, where here Canu’s error correction is used, and then applying phasebook’s HiFi mode to the pre-corrected reads).</p>
        <p>In comparison with all other approaches, phasebook achieves the second largest and the largest haplotype coverage on the simulated MHC region (HC 95.2%) and on the real HG00733-Chr6 (HC 92.9%) data, respectively (HC 52∼74<italic>%</italic> throughout for all other approaches). phasebook-hi achieves the largest and the second largest haplotype coverage in MHC (HC 98%) and HG00733-Chr6 (HC 81%) data. Moreover, phasebook-hi outperforms Canu in terms of both maternal and paternal <italic>k</italic>-mer recovery. On HG002, phasebook only achieves higher maternal haplotype completeness compared with Canu. In <italic>A. thaliana</italic> data, phasebook shows higher haplotype completeness than other de novo assemblers such as Flye and Wtdbg2 but is outperformed by Canu in this respect. However, the best performance is achieved by phasebook-hi in <italic>k</italic>-mer recovery (all 94.9%, mat 89.5%, pat 88.8%), compared with all other methods. Interestingly, reference-based methods achieve high maternal, but rather low paternal <italic>k</italic>-mer recovery. This is very likely explained by the fact that high-quality maternal genome sequence has been used as the reference for these reference-dependent tools (note that this choice reflects the practically most reasonable decision, because the genome of the mother is the genome that resembles the genome under analysis the most and is of highest quality).</p>
        <p>Apart from this, phasebook and phasebook-hi outperform all other de novo approaches in terms of NGA50 (MHC, HG00733-Chr6) and NG50 (HG002, A. thaliana) quite drastically. In <italic>A. thaliana</italic>, phasebook has shorter NG50 than Canu, while phasebook-hi has the greatest NG50. phasebook also achieves the lowest switch error rate across all methods in MHC and <italic>A. thaliana</italic> data, and the second lowest switch error rate in HG00733-Chr6 and HG002. On HG002, phasebook is rivaled only by the reference assisted methods in that respect. Note further that Flye, which outperforms phasebook in terms of QV (Flye 42.9; phasebook 32.6) and switch error rate (Flye 3.12; phasebook 5.50), Flye obtains truly lower haplotype coverage (Flye 52%; phasebook 92.9%), and no NGA50, which puts this into perspective.</p>
        <p>The reference-guided methods WhatsHap and HapCut2 generate more contiguous haplotigs (larger Phased N50 and NG(A)50). Nevertheless, as we already observed in PacBio HiFi read data, this comes at the cost of substantially elevated N-rates and switch errors. Additionally, these methods only reconstruct 56∼63<italic>%</italic> haplotype coverage in MHC and HG00733-Chr6 datasets, which is much lower in comparison with phasebook.</p>
        <p>phasebook-hi generally trades higher switch error rates (being on a par with those of the other methods, while phasebook itself tends to have substantially lower switch error rates)) in compensation for greater (haplotype-aware) contiguity of the assembly, so may present an interesting option for certain applications. On <italic>A.thaliana</italic>, phasebook-hi even appears to be the best method overall. A likely explanation is that the modified protocol of phasebook-hi is favorable on diploid genomes that are relatively variant sparse.</p>
        <p>We also evaluated the effects of using correcting errors for raw reads (step “Correct errors from raw reads” in Fig. <xref rid="Fig1" ref-type="fig">1</xref>) or not, where correcting reads is the default. See Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Tables S5 and S9: results for MHC and HG00733-Chr6 show that using this option improves the assembly in terms of contiguity and accuracy (QV, switch error), and also improves haplotype coverage on HG00733-Chr6 quite substantially (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S5), at the expense of 4 times more CPU time (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S9). The general recommendation therefore is to use it, unless one cannot afford the requested amount CPU time. Note, however, that the requested amount does not appear to be excessive, as being roughly on a par with that of other methods.</p>
        <p>As for contig length statistics regardless of haplotype awareness, see Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S2, similar effects as for HiFi data show. While showing relatively small N50, phasebook, and phasebook-hi in particular, generate larger amounts of long contigs than the other methods. This shows that phasebook’s assemblies are similarly fragmentary as those from the other methods.</p>
      </sec>
      <sec id="Sec23">
        <title>Oxford Nanopore reads</title>
        <p>See Table <xref rid="Tab3" ref-type="table">3</xref> for the following results. Importantly, phasebook achieves the largest haplotype coverage on all (simulated) MHC (HC 97.0%), (real) NA19240-Chr6 (HC 84.4%), and (real) HG002 (overall/maternal/paternal <italic>k</italic>-mer recovery, 92%/62.2%/63.2%) data compared with all other approaches (HC 56∼77<italic>%</italic> in MHC, 56∼65<italic>%</italic> in NA19240-Chr6; overall/maternal/paternal <italic>k</italic>-mer recovery 83∼89<italic>%</italic>/34.4∼40.9<italic>%</italic>/44.2∼51.6<italic>%</italic> in HG002).</p>
        <p>Meanwhile, phasebook-hi achieves the second largest haplotype coverage in MHC and NA19240-Chr6 data. In addition, phasebook generates haplotigs with the lowest switch error rate (about 6∼14 times lower) and second largest QV (Flye having best QV) on MHC data. phasebook-hi further outperforms other de novo assemblers in terms of NGA50 on MHC and NA19240-Chr6, while phasebook outperforms alternative approaches on NA19240-Chr6 and HG002 data (evaluation of phasebook-hi on HG002 was not possible because of not being able to run Canu on HG002 by ourselves due to a lack of resources at the time of the analysis). Meanwhile, both phasebook and phasebook-hi achieve similar Phased N50 in MHC and HG002 data.</p>
        <p>Reference-guided methods generate more contiguous haplotigs (larger N50, phased block N50, and NGA50 values). As we have already observed in PacBio HiFi/CLR datasets, this comes at the expense of significantly higher N-rate and switch errors, especially in MHC data. Notably, these methods only obtain approximately 56% haplotype coverage in MHC and NA19240-Chr6 data, which is much inferior to the result reconstructed from our reference-free approach.</p>
        <p>As for contig length statistics, we observe effects very similar to those from HiFi and CLR reads: relatively small N50 values are put into perspective by large amounts of long contigs (in particular on the whole human genome HG002, phasebook delivers the by far greatest amount of contigs longer than 500 kb). This demonstrates that phasebook, just as the other methods, is very well possible to generate very long contigs. At any rate, we would like to recall that basic contig length statistics can be rather misleading in the evaluation of ploidy aware assemblers.</p>
      </sec>
    </sec>
    <sec id="Sec24">
      <title>Effect of sequencing coverage</title>
      <p>In order to evaluate the effect of sequencing coverage on noisy long read assembly performance, we used two MHC haplotypes (PGF and COX) as a template for a diploid genome. We then simulated PacBio CLR reads with different sequencing coverage, namely, 15 ×, 25 ×, 35 ×, and 45 × per haplotype. Subsequently, we ran phasebook and all other tools on these four datasets. The benchmarking results are shown in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S4.</p>
      <p>As the sequencing coverage varies, phasebook always achieves the best performance in terms of haplotype coverage (95∼97<italic>%</italic>), clearly outperforming all other tools (52∼76<italic>%</italic>). In addition, it yields haplotigs with much lower switch error rate (0.6∼1.3<italic>%</italic>, 3 to 10 times lower) at all different sequencing coverages. At a coverage of 15 ×, phasebook has the lowest QV with respect to all other methods, while being second best on all other coverage rates, with Canu taking first place in that respect (QV phasebook 37.7∼41.2 versus 39.4∼41.8 from Canu).</p>
      <p>The explanation for this effect is that phasebook corrects sequencing errors at haplotype level, whereas other methods correct errors by considering reads from the two haplotypes jointly. This yields improvements at low coverage rates for the other methods; however, other methods do not improve error rates on increasing coverage. Note in general that correcting sequencing errors in noisy long reads experiences difficulties starting from 15 × and less. Besides, the haplotype coverage of phasebook slightly improves on increasing sequencing coverage, and the accuracy (QV and switch errors) of phasebook is improved when sequencing coverage increases from 15 × to 25 ×; furthermore, only slight improvements are observed when raising sequence coverage to 35 × and 45 ×.</p>
    </sec>
    <sec id="Sec25">
      <title>Runtime and memory usage evaluation</title>
      <p>The runtime of phasebook is dominated by two steps. First, the computation of all-vs-all long read overlaps for which we use Minimap2, as one of the fastest approaches to compute read overlaps. Second, generating corrected super reads consumes a considerable amount of time, as a consequence of the high rate of sequencing errors in long reads.</p>
      <p>Of note, the number of read clusters is approximately linear with the genome size, as a logical consequence of the design of the clusters. Converting massive amounts of raw reads into a much reduced set of super reads, parallelized across clusters, and only then constructing overlap graphs on (the reduced amount of) super reads, and deriving assemblies from this (comparatively small) graph greatly speeds up the process, and avoids consumption of excessive amounts of memory.</p>
      <p>In an overall account, our approach is perfectly apt for assembling large genomes, such as human genomes or other diploid genomes of similar length.</p>
      <p>We evaluated the runtime and memory usage of related tools on both simulated and real data for all three kinds of long read data (namely, as usual, PacBio HiFi, PacBio CLR, and Oxford Nanopore reads). Results are shown in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S6, S7, S8, respectively.</p>
      <p>In detail, for PacBio HiFi data, Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S6 shows that phasebook takes 64.8 h CPU time on Chr6 data and 6636 h CPU time on whole human genome data (HG002). In comparison with HiFiasm, the strongest competitor, phasebook requires 1.5 and 18 times more runtime, but requires only at most half of the memory on HG002. In comparison with other approaches, phasebook requires more time, while still being on the same order of magnitude for Chr6 (other de novo approaches: 14.4 to 41.0 h). In terms of peak memory usage, phasebook requires roughly similar amounts like Canu and Flye (on MHC and Chr6). As was to be expected, reference-guided methods, such as WhatsHap and HapCut2, have advantages in terms of runtime and space consumption.</p>
      <p>For PacBio CLR reads, Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S7 shows that phasebook, Canu, and Falcon are orders of magnitude slower when assembling CLR reads relative to HiFi reads. phasebook requires 1129 h CPU time on Chr6 data, which is similar to Falcon, and twice the amount of Canu. phasebook-hi instead requires even less time than Canu, while still requiring more than Flye and Wtdbg2. In addition, Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S7 shows that phasebook consumes about 7213 h CPU time on the whole human genome data (HG002), which is faster than Canu (31,933 h) and also phasebook-hi (28,357 h). As shared by those methods, this indicates that the error correction routine requires substantially larger amounts of time than that of phasebook itself. Note that this logic turns around for <italic>A. thaliana</italic>: here, both Canu and phasebook-hi require substantially less time than phasebook, which underscores the impression that these approaches are favorable for variant poor, diploid genomes</p>
      <p>For ONT, Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S8 indicates that phasebook takes 727 h CPU time on Chr6 data, which is faster than Canu (1139 h), but somewhat slower than Falcon (508 h), with Flye, Shasta, and Wtdgb2 being the clearly least runtime intense tools. phasebook takes about 19,564 h CPU time on the whole human genome data, which reflects a normal amount of time in general.</p>
      <p>Overall, this demonstrates that phasebook and phasebook-hi generally appear to be relatively slow in comparison with other tools, while, however, never requiring runtimes that exceed those of others by orders of magnitude. In addition, phasebook is well behaved in terms of memory usage. In summary, both phasebook versions are very well applicable in all real world scenarios of interest.</p>
    </sec>
  </sec>
  <sec id="Sec26" sec-type="discussion">
    <title>Discussion</title>
    <p>Haplotype-aware assembly of diploid genomes, which preserves haplotype identity of the assembled sequences, plays a crucial role in various applications. Long-read sequencing data appears to be particularly suitable for addressing this task since long reads can capture linkage of genetic variations across much longer ranges than short reads. However, the elevated error rates of long reads induce considerable difficulties, because it can be challenging to distinguish errors from true variations. The error rates are the major reason why existing long-read assemblers tend to collapse assemblies into consensus sequence, thereby loosing haplotype information. Further, the majority of existing methods for generating haplotype-aware assemblies tend to require guidance by reference genomes.</p>
    <p>The difference in error profile characteristics of the most popular long-read technologies, such as PacBio HiFi, PacBio CLR, and Oxford Nanopore add to the challenge, because it seems that each sequencing technology requires specially tailored tools, where each tool integrates the particularities of the individual sources of errors. In summary, this explains why prior methods were struggling to address to generate haplotype-aware de novo assemblies for diploid genomes for all predominant sequencing technologies, despite the currently overwhelming interest in such tools.</p>
    <p>We have introduced phasebook to overcome this gap in terms of existing methods: phasebook is (to the best of our knowledge) the first method that successfully addresses all of these (crucial) points. phasebook reconstructs the haplotypes of diploid genomes, supporting usage of all predominant sequencing technologies, namely PacBio HiFi, PacBio CLR, and Oxford Nanopore, de novo, that is without requiring external guidance. The results demonstrate the superiority of the new approach in terms of the majority of approved assembly related metrics.</p>
    <p>Key to success for phasebook is to not just follow standard assembly paradigms (such as de-Bruijn or overlap graph based assemblies). Rather, phasebook adopts ideas from the original (non-de novo) WhatsHap, as a predominant tool for reference-guided read based phasing, and reframes these ideas in a reference-free setting.</p>
    <p>In somewhat more detail, phasebook casts the overall assembly problem as several local instances of the minimum error correction (MEC) problem, and assembles the resulting solutions of the local instances thereafter. The challenge inherent to this is to establish the instances of the MEC problem correctly; while this is straightforward in a reference-aided setting, the setup of appropriate MEC instances in a de novo setting requires careful consideration of various issues.</p>
    <p>Solving the instances corresponds to determining local haplotype-specific patches of genomics sequence. Just as for the original WhatsHap these patches are extremely accurate in terms of error content. This kills two birds with one stone: the local sequence patches do not only account for accurately preserving haplotype identity, but also for correcting errors in the original (long) reads.</p>
    <p>The high accuracy of the resulting sequence patches, referred to as super-reads, then allows for a fairly straightforward procedure that finalizes the generation of high-quality assemblies: One raises an overlap graph on the super reads and determines the longest paths in this overlap graph. Because super-reads are (1) long, (2) accurate, and (3) haplotype-specific, the resulting long and accurate overlaps reliably identify the haplotypes also across regions of the genomes that extend the read length by considerable amounts: Full-length assemblies can be easily determined by computing longest paths in the overlap graph. To further polish assemblies, we implement options for sequencing error correction and read overlap refinement that account for differences in terms of sequencing platform characteristics.</p>
    <p>Benchmarking results on both simulated and real data indicate that phasebook achieves the best performance in terms of haplotype coverage, often reconstructing up to 20–30% more haplotype-specific sequence than the toughest competitors. At the same time, phasebook maintains better or comparable performance in terms of various other relevant aspects. We also have presented phasebook-hi, as a more aggressive approach, which trades misassemblies for contiguity overall, by correcting reads for errors regardless of haplotype identity. This proves to be favorable for rather variant poor genomes, such as <italic>A. thaliana</italic>. The original approach to partition reads into haplotype-specific groups before correcting errors, instead, proves to be superior on sufficient amounts of polymorphic sites in the genome.</p>
    <p>Our comparisons consider all state-of-the-art tools that address to assemble diploid genomes in a way that takes ploidy into account. Note that although the focus is on de novo assembly, we also consider reference-guided approaches so as to judge the current state of the art from a larger perspective, which probably indicates the superiority of partitioning reads into haplotype-specific groups before sequencing error correction.</p>
    <p>Among the three kinds of long-read sequencing data, PacBio HiFi data is the most promising one in terms of distinguishing the different haplotypes thanks to its low error rates. PacBio CLR and Nanopore reads, on the other hand, come with elevated error rates. As usual, combining long and highly erroneous reads with accurate short reads may establish a viable alternative to achieving even better performance than phasebook, at the expense, of course, of additional efforts in terms of sequencing experiments.</p>
    <p>In summary, the results demonstrate that phasebook successfully reconstructs individual haplotypes of the most polymorphic region (MHC) in the human genome at utmost quality in terms of completeness, contiguity, and accuracy. The integration of phasebook in population-scale long-read sequencing projects may open up novel opportunities.</p>
    <p>Still, there is room for improvements. Most importantly, phasebook is confined to work with diploid genomes, so cannot handle polyploid genomes. We consider it worthwhile future work to expand on the idea of polyploids and to design and implement a method that can deal with polyploid genomes, or even cancer and metagenomes, while adopting the ideas of WhatsHap style approaches further.</p>
  </sec>
  <sec id="Sec27" sec-type="conclusion">
    <title>Conclusions</title>
    <p>We have presented phasebook, a novel approach for reconstructing the haplotypes of diploid genomes from long reads de novo, that is without the need for a reference genome. The approach is implemented in an easy-to-use open-source tool <ext-link ext-link-type="uri" xlink:href="https://github.com/phasebook/phasebook">https://github.com/phasebook/phasebook</ext-link>. Benchmarking results on both simulated and real data indicate that our method outperforms state-of-the-art tools (both haplotype assembly and de novo assembly approaches) in terms of haplotype coverage, while preserving competitive performance or even achieving advantages in terms of other various aspects relevant for genome assembly. Therefore, the integration of phasebook may reveal new opportunities in population-scale long read sequencing projects.</p>
  </sec>
  <sec id="Sec28">
    <title>Methods</title>
    <sec id="Sec29">
      <title>Read cluster generation</title>
      <sec id="Sec30">
        <title>Read overlap calculation</title>
        <p>We firstly compute all-vs-all overlaps for raw reads using Minimap2 [<xref ref-type="bibr" rid="CR24">24</xref>], whose seed-chain-align procedure is known to perform pairwise alignments extremely fast, so can manage the large amount of read pairs we need to process. Secondly, resulting bad overlaps are filtered by reasonable, additional criteria. For example, overlaps that are too short that do not exceed a minimum level of sequence identity and that reflect self-overlaps, duplicates, or internal matches are removed. In this, we follow Algorithm 5 in [<xref ref-type="bibr" rid="CR32">32</xref>].</p>
      </sec>
      <sec id="Sec31">
        <title>Read clusters</title>
        <p>We sort reads by their length in descending order, considering that longer reads tend to have more overlaps. Processing reads in the corresponding order therefore results in larger read clusters, which reduces the number of clusters, increases the length of the resulting super-reads and hence improves the assembly overall. In each iteration, the longest read having remained unprocessed is selected as the seed read. The corresponding cluster is then determined as the set of reads that overlap the seed read (according to the criteria listed above), and all of its reads are discarded from the sorted list of reads. The procedure stops when all reads have been processed. See the details in Algorithm 1.</p>
        <p>
          <graphic position="anchor" xlink:href="13059_2021_2512_Figa_HTML" id="MO4"/>
        </p>
      </sec>
    </sec>
    <sec id="Sec32">
      <title>Read phasing</title>
      <p>Since read clusters contain reads from both haplotypes, we further phase reads into two haplotype-specific groups. See Fig. <xref rid="Fig2" ref-type="fig">2</xref> for the explanation of this step.</p>
      <sec id="Sec33">
        <title>Read overlap graph</title>
        <p>For each read cluster, we largely follow the method proposed in [<xref ref-type="bibr" rid="CR22">22</xref>, <xref ref-type="bibr" rid="CR23">23</xref>] to construct a read overlap graph <italic>G</italic>=(<italic>V,E</italic>) where nodes <italic>v</italic>∈<italic>V</italic> represent reads and edges <italic>e</italic>=(<italic>v,w</italic>)∈<italic>E</italic> indicate overlaps that are consistent in terms of length, sequence identity (see the“Parameter settings” section). Edges (<italic>v,w</italic>) are directed indicating that the suffix of <italic>v</italic> is likely to be identical with the prefix of <italic>w</italic>. Note that the overlaps were already determined when computing clusters. Appropriate thresholds for sequence identity and length of the overlaps are user defined.</p>
      </sec>
      <sec id="Sec34">
        <title>Ad-hoc reference construction</title>
        <p>In order to reduce the complexity of the overlap graph, we remove transitive edges, which reflects a common procedure. An edge <italic>u</italic>→<italic>v</italic> is called transitive if there is a vertex <italic>w</italic> and edges <italic>u</italic>→<italic>w,w</italic>→<italic>v</italic>. Subsequently, we determine the longest path in this directed acyclic graph, and the reads that give rise to it. The resulting reads are then assembled into an ad hoc reference by concatenating the overlapping reads that give rise to the path.</p>
      </sec>
      <sec id="Sec35">
        <title>SNP calling</title>
        <p>To remove remaining sequencing errors, and improve variant (SNP) calling and phasing, we polish the ad hoc reference using Racon [<xref ref-type="bibr" rid="CR33">33</xref>]. The raw reads are then mapped back to the ad hoc reference. SNPs are detected by utilizing a pair-hidden Markov model, as implemented in Longshot [<xref ref-type="bibr" rid="CR26">26</xref>].</p>
      </sec>
      <sec id="Sec36">
        <title>Read phasing</title>
        <p>Reads within a cluster can stem from both haplotypes. One can phase the reads conveniently, because the majority of them tend to be sufficiently long to bridge neighboring polymorphic sites. For performing the phasing, we make use of WhatsHap [<xref ref-type="bibr" rid="CR25">25</xref>], as a tool that has been shown to operate at superior performance rates when phasing long reads. WhatsHap centers on the weighted minimum error correction problem, providing a solution with runtime linear in the number of variants. The solution corresponds to partitioning the reads in two groups, each of which immediately corresponds to one of the two local haplotypes of the diploid genome.</p>
      </sec>
    </sec>
    <sec id="Sec37">
      <title>Corrected super read generation</title>
      <sec id="Sec38">
        <title>Super read construction</title>
        <p>We construct a super-read for each of the two haplotype-specific groups of reads resulting from the phasing procedure. For each read group, we construct another read overlap graph, now comprising only reads as nodes that belong to the same haplotype. Using the overlap graph, we then assemble the reads in each group into a long haplotype-specific sequence, which we refer to as <italic>super-read</italic>. As a result, we generally obtain two super reads for each read cluster (see Fig. <xref rid="Fig2" ref-type="fig">2</xref>). Notably, there are two situations to consider when handling with homozygous regions since no SNP can be found. Firstly, all the reads in a cluster cannot be phased into two groups. Then, only one super-read will be computed. Secondly, some reads in a cluster can be phased into two groups, and some other reads cannot be safely assigned to phase groups. In this case, we assign the corresponding reads to both groups. Thus, they contribute to both super-read haplotypes.</p>
      </sec>
      <sec id="Sec39">
        <title>Error correction from raw reads</title>
        <p>This step is optional and recommended for long reads with high sequencing error rate such as PacBio CLR and Nanopore reads, while it is not necessary when processing PacBio HiFi reads because of their great accuracy. For small genomes or specific genomic regions such as MHCs, we make use of a method for self-correction of long reads in each read group. This method combines a multiple sequence alignment (MSA) strategy with local de Bruijn graphs and is implemented in CONSENT [<xref ref-type="bibr" rid="CR34">34</xref>]. When dealing with large genomes (e.g., Chr6), to increase efficiency, we use the MSA-based error correction modules built in MECAT2 [<xref ref-type="bibr" rid="CR35">35</xref>] and NECAT [<xref ref-type="bibr" rid="CR36">36</xref>] for PacBio CLR and Nanopore reads, respectively. Reads in one group are supposed to stem from the same haplotype, thus one can avoid the elimination of true variation, which happens when reads from different haplotypes are mixed together. Therefore, because of the prior arrangement of partitioning reads into haplotype-specific groups, the corrected reads enjoy error rates that are lower than when running these tools on reads referring to unphased settings.</p>
      </sec>
      <sec id="Sec40">
        <title>Super read polishing and trimming</title>
        <p>Using the error corrected reads, we return to the super-reads computed earlier, and polish each super-read by comparing it with the now error corrected reads. (When using PacBio HiFi reads, we apply the procedure without prior correction of errors.) As a result, the super-reads come with error rates that are comparable to the ones obtained for the error-corrected raw reads. We finally trim the super read, removing parts of low coverage of raw reads. The final result is an error corrected super-read.</p>
        <p>Note that the steps in the “Read phasing” and “Corrected super read generation” sections can be parallelized conveniently across clusters, because computations within clusters are independent of other clusters.</p>
      </sec>
    </sec>
    <sec id="Sec41">
      <title>Super read overlap graph construction</title>
      <sec id="Sec42">
        <title>Super read overlap graph</title>
        <p>The super read overlap graph <italic>G</italic><sup>′</sup>=(<italic>V</italic><sup>′</sup>,<italic>E</italic><sup>′</sup>) is very similar to the read overlap graph, except that it is constructed from the set of corrected super reads instead of raw reads (see Fig. <xref rid="Fig3" ref-type="fig">3</xref>). Thus, each node <italic>v</italic>∈<italic>V</italic><sup>′</sup> corresponds to a super read, and there is an edge <italic>v</italic><sub><italic>i</italic></sub>→<italic>v</italic><sub><italic>j</italic></sub>∈<italic>E</italic><sup>′</sup> if they have sufficient overlap length and sequence identity. For the last point, consider that the super-reads exhibit very low sequencing error rates, so near-perfect identity in the overlap is a necessary condition for edges.</p>
        <p>Because the number of super reads is substantially smaller than the number of raw reads, the super read overlap graph can be constructed in short time. For constructing it, we again compute all-vs-all super read overlaps using Minimap2, filter bad overlaps (remove self-overlaps, internal overlaps, etc.), and eventually establish the overlap graph analogous to the procedure of “Read phasing” section, where the only difference is that parameters differ; in general, because of the low error rates and the extended length of super reads, more stringent thresholds are necessary.</p>
      </sec>
      <sec id="Sec43">
        <title>SNP-based spurious edge removal</title>
        <p>As there may still be errors in super reads, one still needs to distinguish between uncorrected errors and true variations. As a consequence, super reads can have false-positive overlaps when considering sequence identity in the overlapping regions alone, which leads to the introduction of misassemblies.</p>
        <p>To control false-positive overlaps, we further refine the edges of the super read overlap graph by applying a heterozygous SNP-based procedure to remove spurious edges that we developed. In more detail, for a pair of overlapping super reads, we collect the corrected reads which belong to the read groups that correspond with the super reads and map the reads back to the sequence formed by concatenating the pair of super reads along their overlap.</p>
        <p>Subsequently, we genotype the variants involved in the overlap regions and remove overlaps that contain at least <italic>k</italic> heterozygous SNPs. In our experiments <italic>k</italic>=0, which correspond to requiring perfect overlap. This step might be time-consuming if genome size is large. We therefore consider it optional and recommend it preferably for small genomes or particular genomic regions, such as the MHC region in our case.</p>
      </sec>
    </sec>
    <sec id="Sec44">
      <title>Final contig generation</title>
      <sec id="Sec45">
        <title>Graph simplification</title>
        <p>First, we simplify the super read overlap graph by removing tips, because tips are likely to be introduced by spurious overlaps, hence reflect mistaken junctures of super reads. Second, we remove all transitive edges, for the exact same reasons for which we remove such edges in the read overlap graph (see the “Read phasing” section and Fig. <xref rid="Fig3" ref-type="fig">3</xref>).</p>
      </sec>
      <sec id="Sec46">
        <title>Merging simple paths</title>
        <p>A node <italic>v</italic>∈<italic>V</italic><sup>′</sup> in the directed graph <italic>G</italic><sup>′</sup> is defined as a <italic>non-branching node</italic> if its indegree and outdegree are both equal to one, and <italic>v</italic> is defined as a <italic>branching node</italic> if either its indegree or outdegree is greater than one. A simple path is a maximal non-branching path, that is its internal nodes are non-branching nodes, while starting and final nodes are branching. For such paths, there is only one possible way to combine the corresponding super reads. Therefore, we merge every simple path into a single contig. Since the number of nodes and edges in super read overlap graph <italic>G</italic><sup>′</sup> is small, it is straightforward and very efficient to enumerate and merge all simple paths (see Fig. <xref rid="Fig3" ref-type="fig">3</xref>).</p>
      </sec>
      <sec id="Sec47">
        <title>Final contig polishing</title>
        <p>This step is recommendable when the sequencing coverage is low, i.e., less than 20 × per haplotype. The reason is that the ends of super reads are likely to contain an elevated amount of errors. This needs to be addressed and corrected. So, for each contig generated from a simple path, we collect all corrected reads involved in the read groups that gave rise to the super reads forming the simple path and align them to the contig. By evaluation of the resulting alignment, further errors can be eliminated, resulting in polished contigs (longer than 1 kbp) as the final output.</p>
      </sec>
    </sec>
    <sec id="Sec48">
      <title>Parameter settings</title>
      <p>There are mainly two parameters to be set during the read overlap graph construction, namely, the minimum overlap length and the minimum sequence identity of the read overlap. In our experiments, the minimum overlap length is 1000 bp, and the minimum sequence identity of the read overlap is 0.95 for PacBio HiFi reads, and 0.75 for PacBio CLR and ONT reads, in agreement with the approximate expected amount of identity according to the inherent error rates. These parameters reflect similar choices used with other tools [<xref ref-type="bibr" rid="CR12">12</xref>, <xref ref-type="bibr" rid="CR14">14</xref>].</p>
    </sec>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Information</title>
    <sec id="Sec49">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="13059_2021_2512_MOESM1_ESM.pdf">
            <caption>
              <p><bold>Additional file 1</bold> Supplement: This contains all supplementary materials referenced in the main text.</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
      <p>
        <supplementary-material content-type="local-data" id="MOESM2">
          <media xlink:href="13059_2021_2512_MOESM2_ESM.docx">
            <caption>
              <p><bold>Additional file 2</bold> Review history.</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <fn-group>
    <fn id="Fn1">
      <label>1</label>
      <p>We contacted the authors, but received no response; note that the latest update in the GitHub repository is from 4 years ago. This seems to be in agreement with earlier attempts to contact the Falcon-unzip crew[<xref ref-type="bibr" rid="CR20">20</xref>].</p>
    </fn>
    <fn>
      <p>
        <bold>Publisher’s Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
    <fn>
      <p>Xiao Luo and Xiongbin Kang contributed equally to this work.</p>
    </fn>
  </fn-group>
  <ack>
    <title>Acknowledgements</title>
    <p>We would thank Jasmijn Baaijens and Marleen Balvert for their insightful discussions during the early stages of this project. Further, we thank Tobias Marschall for the useful comments towards the end of the project, and for suggesting the name of the tool.</p>
    <sec id="d32e4671">
      <title>Peer review information</title>
      <p>Barbara Cheifet was the primary editor of this article and managed its editorial process and peer review in collaboration with the rest of the editorial team.</p>
    </sec>
    <sec id="d32e4676">
      <title>Review history</title>
      <p>The review history is available as Additional file <xref rid="MOESM2" ref-type="media">2</xref>.</p>
    </sec>
  </ack>
  <notes notes-type="author-contribution">
    <sec id="FPar1">
      <title>Authors’ contributions</title>
      <p>XL and AS developed the method. XL, XK, and AS wrote the manuscript. XL and XK conducted the data analysis. XL implemented the tool. All authors read and approved the final version of the manuscript.</p>
    </sec>
    <sec id="FPar2">
      <title>Authors’ information</title>
      <p>Twitter handles: @XiaoLuo88872497 (Xiao Luo); @XiongbinK (Xiongbin Kang); @ASchonhuth (Alexander Schönhuth).</p>
    </sec>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>XL and XK were supported by the Chinese Scholarship Council. AS was supported by the Dutch Scientific Organization, through Vidi grant 639.072.309 during the early stages of the project, and from the European Union’s Horizon 2020 research and innovation programme under Marie Skłodowska-Curie grant agreements No 956229 (ALPACA) and No 872539 (PANGAIA). Open Access funding enabled and organized by Projekt DEAL.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and materials</title>
    <p>The data used to generate PacBio HiFi sample profile when simulating HiFi reads can be downloaded from EBI <ext-link ext-link-type="uri" xlink:href="http://ftp.1000genomes.ebi.ac.uk/vol1/ftp/data_collections/HGSVC2/working/20190925_PUR_PacBio_HiFi/">http://ftp.1000genomes.ebi.ac.uk/vol1/ftp/data_collections/HGSVC2/working/20190925_PUR_PacBio_HiFi/</ext-link>[<xref ref-type="bibr" rid="CR29">29</xref>].</p>
    <p>For real sequencing data, PacBio HiFi/CLR reads of human individual HG00733 can be downloaded from EBI <ext-link ext-link-type="uri" xlink:href="http://ftp.1000genomes.ebi.ac.uk/vol1/ftp/data_collections/HGSVC2/working/20190925_PUR_PacBio_HiFi/">http://ftp.1000genomes.ebi.ac.uk/vol1/ftp/data_collections/HGSVC2/working/20190925_PUR_PacBio_HiFi/</ext-link>and SRA (accession: <ext-link ext-link-type="uri" xlink:href="https://trace.ncbi.nlm.nih.gov/Traces/sra/?run=SRR7615963">SRR7615963</ext-link>), respectively [<xref ref-type="bibr" rid="CR29">29</xref>]. Oxford Nanopore PromethION sequencing reads of human individual NA19240 can be downloaded from ENA (project ID: <ext-link ext-link-type="uri" xlink:href="https://www.ebi.ac.uk/ena/browser/view/PRJEB26791">PRJEB26791</ext-link>) [<xref ref-type="bibr" rid="CR29">29</xref>]. PacBio HiFi, CLR, and ONT reads for HG002 can be downloaded from <ext-link ext-link-type="uri" xlink:href="https://github.com/human-pangenomics/HG002_Data_Freeze_v1.0">https://github.com/human-pangenomics/HG002_Data_Freeze_v1.0</ext-link> [<xref ref-type="bibr" rid="CR6">6</xref>, <xref ref-type="bibr" rid="CR17">17</xref>, <xref ref-type="bibr" rid="CR37">37</xref>]. PacBio CLR reads of <italic>Arabidopsis thaliana</italic> can be downloaded from SRA (accession: <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/bioproject/PRJNA314706">PRJNA314706</ext-link>) [<xref ref-type="bibr" rid="CR12">12</xref>].</p>
    <p>As for ground truth reference sequences used for benchmarking experiments, three human MHC haplotypes (PGF, COX, and DBB) are from the Vega Genome Browser <ext-link ext-link-type="uri" xlink:href="http://vega.archive.ensembl.org/info/data/MHC_Homo_sapiens.html">http://vega.archive.ensembl.org/info/data/MHC_Homo_sapiens.html</ext-link>.</p>
    <p>Full-length haplotypes (chromosome 6) of individuals HG00733 and NA19240 can be downloaded from <ext-link ext-link-type="uri" xlink:href="http://ftp.1000genomes.ebi.ac.uk/vol1/ftp/data_collections/hgsv_sv_discovery/working/20180227_IlluminaPolishedPhasedSV/">http://ftp.1000genomes.ebi.ac.uk/vol1/ftp/data_collections/hgsv_sv_discovery/working/20180227_IlluminaPolishedPhasedSV/</ext-link>[<xref ref-type="bibr" rid="CR29">29</xref>].</p>
    <p>Assemblies of HG002 (HiFi/ONT) generated by others can be downloaded from <ext-link ext-link-type="uri" xlink:href="https://zenodo.org/record/4393631#.YSQQu9MzYWr">https://zenodo.org/record/4393631#.YSQQu9MzYWr</ext-link> [<xref ref-type="bibr" rid="CR19">19</xref>] and <ext-link ext-link-type="uri" xlink:href="https://s3-us-west-2.amazonaws.com/human-pangenomics/index.html?prefix=publications/SHASTA2019/assemblies/raw/">https://s3-us-west-2.amazonaws.com/human-pangenomics/index.html?prefix=publications/SHASTA2019/assemblies/raw/</ext-link>[<xref ref-type="bibr" rid="CR17">17</xref>], respectively.</p>
    <p>Simulated reads of MHCs, real reads of human Chr6 and code for reproducing results can be downloaded from Code Ocean [<xref ref-type="bibr" rid="CR38">38</xref>]. Assemblies generated in this paper can be downloaded from Zenodo [<xref ref-type="bibr" rid="CR39">39</xref>].</p>
    <p>The source code of phasebook is GPL-3.0 licensed, and publicly available on Github [<xref ref-type="bibr" rid="CR40">40</xref>].</p>
  </notes>
  <notes>
    <title>Declarations</title>
    <notes id="FPar3">
      <title>Ethics approval and consent to participate</title>
      <p>Not applicable.</p>
    </notes>
    <notes id="FPar4">
      <title>Consent for publication</title>
      <p>Not applicable.</p>
    </notes>
    <notes id="FPar5" notes-type="COI-statement">
      <title>Competing interests</title>
      <p>The authors declare that they have no competing interests.</p>
    </notes>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tewhey</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Bansal</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Torkamani</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Topol</surname>
            <given-names>EJ</given-names>
          </name>
          <name>
            <surname>Schork</surname>
            <given-names>NJ</given-names>
          </name>
        </person-group>
        <article-title>The importance of phase information for human genomics</article-title>
        <source>Nat Rev Genet</source>
        <year>2011</year>
        <volume>12</volume>
        <issue>3</issue>
        <fpage>215</fpage>
        <lpage>23</lpage>
        <?supplied-pmid 21301473?>
        <pub-id pub-id-type="pmid">21301473</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Leitwein</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Duranton</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Rougemont</surname>
            <given-names>Q</given-names>
          </name>
          <name>
            <surname>Gagnaire</surname>
            <given-names>P-A</given-names>
          </name>
          <name>
            <surname>Bernatchez</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <article-title>Using haplotype information for conservation genomics</article-title>
        <source>Trends Ecol Evol</source>
        <year>2020</year>
        <volume>35</volume>
        <issue>3</issue>
        <fpage>245</fpage>
        <lpage>58</lpage>
        <?supplied-pmid 31810774?>
        <pub-id pub-id-type="pmid">31810774</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Muers</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>No half measures for haplotypes</article-title>
        <source>Nat Rev Genet</source>
        <year>2011</year>
        <volume>12</volume>
        <issue>2</issue>
        <fpage>77</fpage>
        <?supplied-pmid 21191422?>
        <pub-id pub-id-type="pmid">21191422</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Glusman</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Cox</surname>
            <given-names>HC</given-names>
          </name>
          <name>
            <surname>Roach</surname>
            <given-names>JC</given-names>
          </name>
        </person-group>
        <article-title>Whole-genome haplotyping approaches and genomic medicine</article-title>
        <source>Genome Med</source>
        <year>2014</year>
        <volume>6</volume>
        <issue>9</issue>
        <fpage>1</fpage>
        <lpage>16</lpage>
        <pub-id pub-id-type="pmid">24433494</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jain</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Koren</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Miga</surname>
            <given-names>KH</given-names>
          </name>
          <name>
            <surname>Quick</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Rand</surname>
            <given-names>AC</given-names>
          </name>
          <name>
            <surname>Sasani</surname>
            <given-names>TA</given-names>
          </name>
          <name>
            <surname>Tyson</surname>
            <given-names>JR</given-names>
          </name>
          <name>
            <surname>Beggs</surname>
            <given-names>AD</given-names>
          </name>
          <name>
            <surname>Dilthey</surname>
            <given-names>AT</given-names>
          </name>
          <name>
            <surname>Fiddes</surname>
            <given-names>IT</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Nanopore sequencing and assembly of a human genome with ultra-long reads</article-title>
        <source>Nat Biotechnol</source>
        <year>2018</year>
        <volume>36</volume>
        <issue>4</issue>
        <fpage>338</fpage>
        <lpage>45</lpage>
        <?supplied-pmid 29431738?>
        <pub-id pub-id-type="pmid">29431738</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wenger</surname>
            <given-names>AM</given-names>
          </name>
          <name>
            <surname>Peluso</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Rowell</surname>
            <given-names>WJ</given-names>
          </name>
          <name>
            <surname>Chang</surname>
            <given-names>P-C</given-names>
          </name>
          <name>
            <surname>Hall</surname>
            <given-names>RJ</given-names>
          </name>
          <name>
            <surname>Concepcion</surname>
            <given-names>GT</given-names>
          </name>
          <name>
            <surname>Ebler</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Fungtammasan</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Kolesnikov</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Olson</surname>
            <given-names>ND</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Accurate circular consensus long-read sequencing improves variant detection and assembly of a human genome</article-title>
        <source>Nat Biotechnol</source>
        <year>2019</year>
        <volume>37</volume>
        <issue>10</issue>
        <fpage>1155</fpage>
        <lpage>62</lpage>
        <?supplied-pmid 31406327?>
        <pub-id pub-id-type="pmid">31406327</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Miga</surname>
            <given-names>KH</given-names>
          </name>
          <name>
            <surname>Koren</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Rhie</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Vollger</surname>
            <given-names>MR</given-names>
          </name>
          <name>
            <surname>Gershman</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Bzikadze</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Brooks</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Howe</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Porubsky</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Logsdon</surname>
            <given-names>GA</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Telomere-to-telomere assembly of a complete human x chromosome</article-title>
        <source>Nature</source>
        <year>2020</year>
        <volume>585</volume>
        <issue>7823</issue>
        <fpage>79</fpage>
        <lpage>84</lpage>
        <?supplied-pmid 32663838?>
        <pub-id pub-id-type="pmid">32663838</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jung</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Winefield</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Bombarely</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Prentis</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Waterhouse</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>Tools and strategies for long-read sequencing and de novo assembly of plant genomes</article-title>
        <source>Trends Plant Sci</source>
        <year>2019</year>
        <volume>24</volume>
        <issue>8</issue>
        <fpage>700</fpage>
        <lpage>24</lpage>
        <?supplied-pmid 31208890?>
        <pub-id pub-id-type="pmid">31208890</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Patterson</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Marschall</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Pisanti</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Van Iersel</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Stougie</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Klau</surname>
            <given-names>GW</given-names>
          </name>
          <name>
            <surname>Schönhuth</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Whatshap: weighted haplotype assembly for future-generation sequencing reads</article-title>
        <source>J Comput Biol</source>
        <year>2015</year>
        <volume>22</volume>
        <issue>6</issue>
        <fpage>498</fpage>
        <lpage>509</lpage>
        <?supplied-pmid 25658651?>
        <pub-id pub-id-type="pmid">25658651</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Edge</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Bafna</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Bansal</surname>
            <given-names>V</given-names>
          </name>
        </person-group>
        <article-title>Hapcut2: robust and accurate haplotype assembly for diverse sequencing technologies</article-title>
        <source>Genome Res</source>
        <year>2017</year>
        <volume>27</volume>
        <issue>5</issue>
        <fpage>801</fpage>
        <lpage>12</lpage>
        <?supplied-pmid 27940952?>
        <pub-id pub-id-type="pmid">27940952</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pirola</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Zaccaria</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Dondi</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Klau</surname>
            <given-names>GW</given-names>
          </name>
          <name>
            <surname>Pisanti</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Bonizzoni</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>Hapcol: accurate and memory-efficient haplotype assembly from long reads</article-title>
        <source>Bioinformatics</source>
        <year>2016</year>
        <volume>32</volume>
        <issue>11</issue>
        <fpage>1610</fpage>
        <lpage>17</lpage>
        <?supplied-pmid 26315913?>
        <pub-id pub-id-type="pmid">26315913</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chin</surname>
            <given-names>C-S</given-names>
          </name>
          <name>
            <surname>Peluso</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Sedlazeck</surname>
            <given-names>FJ</given-names>
          </name>
          <name>
            <surname>Nattestad</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Concepcion</surname>
            <given-names>GT</given-names>
          </name>
          <name>
            <surname>Clum</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Dunn</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>O’Malley</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Figueroa-Balderas</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Morales-Cruz</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Phased diploid genome assembly with single-molecule real-time sequencing</article-title>
        <source>Nat Methods</source>
        <year>2016</year>
        <volume>13</volume>
        <issue>12</issue>
        <fpage>1050</fpage>
        <lpage>54</lpage>
        <?supplied-pmid 27749838?>
        <pub-id pub-id-type="pmid">27749838</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13</label>
      <mixed-citation publication-type="other">PacificBiosciences. IPA HiFi Genome Assembler. 2020. <ext-link ext-link-type="uri" xlink:href="https://github.com/PacificBiosciences/pbipa">https://github.com/PacificBiosciences/pbipa</ext-link>. Accessed 10 Feb 2020.</mixed-citation>
    </ref>
    <ref id="CR14">
      <label>14</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Koren</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Walenz</surname>
            <given-names>BP</given-names>
          </name>
          <name>
            <surname>Berlin</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Miller</surname>
            <given-names>JR</given-names>
          </name>
          <name>
            <surname>Bergman</surname>
            <given-names>NH</given-names>
          </name>
          <name>
            <surname>Phillippy</surname>
            <given-names>AM</given-names>
          </name>
        </person-group>
        <article-title>Canu: scalable and accurate long-read assembly via adaptive k-mer weighting and repeat separation</article-title>
        <source>Genome Res</source>
        <year>2017</year>
        <volume>27</volume>
        <issue>5</issue>
        <fpage>722</fpage>
        <lpage>36</lpage>
        <?supplied-pmid 28298431?>
        <pub-id pub-id-type="pmid">28298431</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nurk</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Walenz</surname>
            <given-names>BP</given-names>
          </name>
          <name>
            <surname>Rhie</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Vollger</surname>
            <given-names>MR</given-names>
          </name>
          <name>
            <surname>Logsdon</surname>
            <given-names>GA</given-names>
          </name>
          <name>
            <surname>Grothe</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Miga</surname>
            <given-names>KH</given-names>
          </name>
          <name>
            <surname>Eichler</surname>
            <given-names>EE</given-names>
          </name>
          <name>
            <surname>Phillippy</surname>
            <given-names>AM</given-names>
          </name>
          <name>
            <surname>Koren</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Hicanu: accurate assembly of segmental duplications, satellites, and allelic variants from high-fidelity long reads</article-title>
        <source>Genome Res</source>
        <year>2020</year>
        <volume>30</volume>
        <issue>9</issue>
        <fpage>1291</fpage>
        <lpage>305</lpage>
        <?supplied-pmid 32801147?>
        <pub-id pub-id-type="pmid">32801147</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kolmogorov</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Yuan</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Lin</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Pevzner</surname>
            <given-names>PA</given-names>
          </name>
        </person-group>
        <article-title>Assembly of long, error-prone reads using repeat graphs</article-title>
        <source>Nat Biotechnol</source>
        <year>2019</year>
        <volume>37</volume>
        <issue>5</issue>
        <fpage>540</fpage>
        <lpage>46</lpage>
        <?supplied-pmid 30936562?>
        <pub-id pub-id-type="pmid">30936562</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Shafin</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Pesout</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Lorig-Roach</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Haukness</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Olsen</surname>
            <given-names>HE</given-names>
          </name>
          <name>
            <surname>Bosworth</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Armstrong</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Tigyi</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Maurer</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Koren</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Nanopore sequencing and the shasta toolkit enable efficient de novo assembly of eleven human genomes</article-title>
        <source>Nat Biotechnol</source>
        <year>2020</year>
        <volume>38</volume>
        <issue>9</issue>
        <fpage>1044</fpage>
        <lpage>53</lpage>
        <?supplied-pmid 32686750?>
        <pub-id pub-id-type="pmid">32686750</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ruan</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>Fast and accurate long-read assembly with wtdbg2</article-title>
        <source>Nat Methods</source>
        <year>2020</year>
        <volume>17</volume>
        <issue>2</issue>
        <fpage>155</fpage>
        <lpage>58</lpage>
        <?supplied-pmid 31819265?>
        <pub-id pub-id-type="pmid">31819265</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cheng</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Concepcion</surname>
            <given-names>GT</given-names>
          </name>
          <name>
            <surname>Feng</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>Haplotype-resolved de novo assembly using phased assembly graphs with hifiasm</article-title>
        <source>Nat Methods</source>
        <year>2021</year>
        <volume>18</volume>
        <issue>2</issue>
        <fpage>170</fpage>
        <lpage>5</lpage>
        <?supplied-pmid 33526886?>
        <pub-id pub-id-type="pmid">33526886</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Garg</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Rautiainen</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Novak</surname>
            <given-names>AM</given-names>
          </name>
          <name>
            <surname>Garrison</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Durbin</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Marschall</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>A graph-based approach to diploid genome assembly</article-title>
        <source>Bioinformatics</source>
        <year>2018</year>
        <volume>34</volume>
        <issue>13</issue>
        <fpage>105</fpage>
        <lpage>14</lpage>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Logsdon</surname>
            <given-names>GA</given-names>
          </name>
          <name>
            <surname>Vollger</surname>
            <given-names>MR</given-names>
          </name>
          <name>
            <surname>Eichler</surname>
            <given-names>EE</given-names>
          </name>
        </person-group>
        <article-title>Long-read human genome sequencing and its applications</article-title>
        <source>Nat Rev Genet</source>
        <year>2020</year>
        <volume>21</volume>
        <issue>10</issue>
        <fpage>597</fpage>
        <lpage>614</lpage>
        <?supplied-pmid 32504078?>
        <pub-id pub-id-type="pmid">32504078</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Baaijens</surname>
            <given-names>JA</given-names>
          </name>
          <name>
            <surname>El Aabidine</surname>
            <given-names>AZ</given-names>
          </name>
          <name>
            <surname>Rivals</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Schönhuth</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>De novo assembly of viral quasispecies using overlap graphs</article-title>
        <source>Genome Res</source>
        <year>2017</year>
        <volume>27</volume>
        <issue>5</issue>
        <fpage>835</fpage>
        <lpage>48</lpage>
        <?supplied-pmid 28396522?>
        <pub-id pub-id-type="pmid">28396522</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Baaijens</surname>
            <given-names>JA</given-names>
          </name>
          <name>
            <surname>Schönhuth</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Overlap graph-based generation of haplotigs for diploids and polyploids</article-title>
        <source>Bioinformatics</source>
        <year>2019</year>
        <volume>35</volume>
        <issue>21</issue>
        <fpage>4281</fpage>
        <lpage>89</lpage>
        <?supplied-pmid 30994902?>
        <pub-id pub-id-type="pmid">30994902</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>Minimap2: pairwise alignment for nucleotide sequences</article-title>
        <source>Bioinformatics</source>
        <year>2018</year>
        <volume>34</volume>
        <issue>18</issue>
        <fpage>3094</fpage>
        <lpage>100</lpage>
        <?supplied-pmid 6137996?>
        <pub-id pub-id-type="pmid">29750242</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25</label>
      <mixed-citation publication-type="other">Martin M, Patterson M, Garg S, Fischer S, Pisanti N, Klau GW, Schönhuth A, Marschall T. Whatshap: fast and accurate read-based phasing. 2016:085050. 10.1101/085050.</mixed-citation>
    </ref>
    <ref id="CR26">
      <label>26</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Edge</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Bansal</surname>
            <given-names>V</given-names>
          </name>
        </person-group>
        <article-title>Longshot enables accurate variant calling in diploid genomes from single-molecule long read sequencing</article-title>
        <source>Nat Commun</source>
        <year>2019</year>
        <volume>10</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <lpage>10</lpage>
        <pub-id pub-id-type="pmid">30602773</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ono</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Asai</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Hamada</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Pbsim: Pacbio reads simulator—toward accurate genome assembly</article-title>
        <source>Bioinformatics</source>
        <year>2013</year>
        <volume>29</volume>
        <issue>1</issue>
        <fpage>119</fpage>
        <lpage>21</lpage>
        <?supplied-pmid 23129296?>
        <pub-id pub-id-type="pmid">23129296</pub-id>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yang</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Chu</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Warren</surname>
            <given-names>RL</given-names>
          </name>
          <name>
            <surname>Birol</surname>
            <given-names>I</given-names>
          </name>
        </person-group>
        <article-title>Nanosim: nanopore sequence read simulator based on statistical characterization</article-title>
        <source>GigaScience</source>
        <year>2017</year>
        <volume>6</volume>
        <issue>4</issue>
        <fpage>010</fpage>
      </element-citation>
    </ref>
    <ref id="CR29">
      <label>29</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chaisson</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>Sanders</surname>
            <given-names>AD</given-names>
          </name>
          <name>
            <surname>Zhao</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Malhotra</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Porubsky</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Rausch</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Gardner</surname>
            <given-names>EJ</given-names>
          </name>
          <name>
            <surname>Rodriguez</surname>
            <given-names>OL</given-names>
          </name>
          <name>
            <surname>Guo</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Collins</surname>
            <given-names>RL</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Multi-platform discovery of haplotype-resolved structural variation in human genomes</article-title>
        <source>Nat Commun</source>
        <year>2019</year>
        <volume>10</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <lpage>16</lpage>
        <pub-id pub-id-type="pmid">30602773</pub-id>
      </element-citation>
    </ref>
    <ref id="CR30">
      <label>30</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mikheenko</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Prjibelski</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Saveliev</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Antipov</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Gurevich</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Versatile genome assembly evaluation with quast-lg</article-title>
        <source>Bioinformatics</source>
        <year>2018</year>
        <volume>34</volume>
        <issue>13</issue>
        <fpage>142</fpage>
        <lpage>50</lpage>
      </element-citation>
    </ref>
    <ref id="CR31">
      <label>31</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rhie</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Walenz</surname>
            <given-names>BP</given-names>
          </name>
          <name>
            <surname>Koren</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Phillippy</surname>
            <given-names>AM</given-names>
          </name>
        </person-group>
        <article-title>Merqury: reference-free quality, completeness, and phasing assessment for genome assemblies</article-title>
        <source>Genome Biol</source>
        <year>2020</year>
        <volume>21</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <lpage>27</lpage>
      </element-citation>
    </ref>
    <ref id="CR32">
      <label>32</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>Minimap and miniasm: fast mapping and de novo assembly for noisy long sequences</article-title>
        <source>Bioinformatics</source>
        <year>2016</year>
        <volume>32</volume>
        <issue>14</issue>
        <fpage>2103</fpage>
        <lpage>10</lpage>
        <?supplied-pmid 27153593?>
        <pub-id pub-id-type="pmid">27153593</pub-id>
      </element-citation>
    </ref>
    <ref id="CR33">
      <label>33</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Vaser</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Sović</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Nagarajan</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Šikić</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Fast and accurate de novo genome assembly from long uncorrected reads</article-title>
        <source>Genome Res</source>
        <year>2017</year>
        <volume>27</volume>
        <issue>5</issue>
        <fpage>737</fpage>
        <lpage>46</lpage>
        <?supplied-pmid 28100585?>
        <pub-id pub-id-type="pmid">28100585</pub-id>
      </element-citation>
    </ref>
    <ref id="CR34">
      <label>34</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Morisse</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Marchet</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Limasset</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Lecroq</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Lefebvre</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Scalable long read self-correction and assembly polishing with multiple sequence alignment</article-title>
        <source>Sci Rep</source>
        <year>2021</year>
        <volume>11</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <lpage>13</lpage>
        <pub-id pub-id-type="pmid">33414495</pub-id>
      </element-citation>
    </ref>
    <ref id="CR35">
      <label>35</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Xiao</surname>
            <given-names>C-L</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Xie</surname>
            <given-names>S-Q</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>K-N</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Han</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Luo</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Xie</surname>
            <given-names>Z</given-names>
          </name>
        </person-group>
        <article-title>Mecat: fast mapping, error correction, and de novo assembly for single-molecule sequencing reads</article-title>
        <source>Nat Methods</source>
        <year>2017</year>
        <volume>14</volume>
        <issue>11</issue>
        <fpage>1072</fpage>
        <?supplied-pmid 28945707?>
        <pub-id pub-id-type="pmid">28945707</pub-id>
      </element-citation>
    </ref>
    <ref id="CR36">
      <label>36</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chen</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Nie</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Xie</surname>
            <given-names>S-Q</given-names>
          </name>
          <name>
            <surname>Zheng</surname>
            <given-names>Y-F</given-names>
          </name>
          <name>
            <surname>Dai</surname>
            <given-names>Q</given-names>
          </name>
          <name>
            <surname>Bray</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>Y-X</given-names>
          </name>
          <name>
            <surname>Xing</surname>
            <given-names>J-F</given-names>
          </name>
          <name>
            <surname>Huang</surname>
            <given-names>Z-J</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>D-P</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Efficient assembly of nanopore reads via highly accurate and intact error correction</article-title>
        <source>Nat Commun</source>
        <year>2021</year>
        <volume>12</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <lpage>10</lpage>
        <pub-id pub-id-type="pmid">33397941</pub-id>
      </element-citation>
    </ref>
    <ref id="CR37">
      <label>37</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zook</surname>
            <given-names>JM</given-names>
          </name>
          <name>
            <surname>Catoe</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>McDaniel</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Vang</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Spies</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Sidow</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Weng</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Mason</surname>
            <given-names>CE</given-names>
          </name>
          <name>
            <surname>Alexander</surname>
            <given-names>N</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Extensive sequencing of seven human genomes to characterize benchmark reference materials</article-title>
        <source>Sci Data</source>
        <year>2016</year>
        <volume>3</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <lpage>26</lpage>
      </element-citation>
    </ref>
    <ref id="CR38">
      <label>38</label>
      <mixed-citation publication-type="other">Luo X, Kang X, Schönhuth A. Simulated reads of MHCs, real reads of human Chr6 and code for reproducing results. Code Ocean. 2021. 10.24433/CO.6031956.v2.</mixed-citation>
    </ref>
    <ref id="CR39">
      <label>39</label>
      <mixed-citation publication-type="other">Luo X, Kang X, Schönhuth A. Assemblies used in benchmarking experiments. Zenodo. 2021. 10.5281/zenodo.5410503.</mixed-citation>
    </ref>
    <ref id="CR40">
      <label>40</label>
      <mixed-citation publication-type="other">Luo X, Kang X, Schönhuth A. phasebook. Github. 2021. <ext-link ext-link-type="uri" xlink:href="https://github.com/phasebook/phasebook">https://github.com/phasebook/phasebook</ext-link>.</mixed-citation>
    </ref>
  </ref-list>
</back>
