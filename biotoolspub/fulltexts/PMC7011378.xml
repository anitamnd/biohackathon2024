<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Genomics</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Genomics</journal-id>
    <journal-title-group>
      <journal-title>BMC Genomics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2164</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">7011378</article-id>
    <article-id pub-id-type="pmid">32039704</article-id>
    <article-id pub-id-type="publisher-id">6519</article-id>
    <article-id pub-id-type="doi">10.1186/s12864-020-6519-y</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Software</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>STELAR: a statistically consistent coalescent-based species tree estimation method by maximizing triplet consistency</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Islam</surname>
          <given-names>Mazharul</given-names>
        </name>
        <address>
          <email>mazharbuet11@gmail.com</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author" equal-contrib="yes">
        <name>
          <surname>Sarker</surname>
          <given-names>Kowshika</given-names>
        </name>
        <address>
          <email>preitykowshika28@gmail.com</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author" equal-contrib="yes">
        <name>
          <surname>Das</surname>
          <given-names>Trisha</given-names>
        </name>
        <address>
          <email>trisha.27494@gmail.com</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Reaz</surname>
          <given-names>Rezwana</given-names>
        </name>
        <address>
          <email>rezwana@cs.utexas.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-5640-0615</contrib-id>
        <name>
          <surname>Bayzid</surname>
          <given-names>Md. Shamsuzzoha</given-names>
        </name>
        <address>
          <email>shams_bayzid@cse.buet.ac.bd</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 2223 0518</institution-id><institution-id institution-id-type="GRID">grid.411512.2</institution-id><institution>Department of Computer Science and Engineering, Bangladesh University of Engineering and Technology, </institution></institution-wrap>Dhaka, 1205 Bangladesh </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0004 1936 9924</institution-id><institution-id institution-id-type="GRID">grid.89336.37</institution-id><institution>Department of Computer Science, The University of Texas at Austin, </institution></institution-wrap>Texas, 78712 USA </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>10</day>
      <month>2</month>
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>10</day>
      <month>2</month>
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2020</year>
    </pub-date>
    <volume>21</volume>
    <elocation-id>136</elocation-id>
    <history>
      <date date-type="received">
        <day>22</day>
        <month>9</month>
        <year>2019</year>
      </date>
      <date date-type="accepted">
        <day>20</day>
        <month>1</month>
        <year>2020</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2020</copyright-statement>
      <license license-type="OpenAccess">
        <license-p><bold>Open Access</bold> This article is distributed under the terms of the Creative Commons Attribution 4.0 International License(<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The Creative Commons Public Domain Dedication waiver(<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p id="Par1">Species tree estimation is frequently based on phylogenomic approaches that use multiple genes from throughout the genome. However, estimating a species tree from a collection of gene trees can be complicated due to the presence of gene tree incongruence resulting from incomplete lineage sorting (ILS), which is modelled by the multi-species coalescent process. Maximum likelihood and Bayesian MCMC methods can potentially result in accurate trees, but they do not scale well to large datasets.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p id="Par2">We present STELAR (Species Tree Estimation by maximizing tripLet AgReement), a new fast and highly accurate statistically consistent coalescent-based method for estimating species trees from a collection of gene trees. We formalized the constrained triplet consensus (CTC) problem and showed that the solution to the CTC problem is a statistically consistent estimate of the species tree under the multi-species coalescent (MSC) model. STELAR is an efficient dynamic programming based solution to the CTC problem which is highly accurate and scalable. We evaluated the accuracy of STELAR in comparison with SuperTriplets, which is an alternate fast and highly accurate triplet-based supertree method, and with MP-EST and ASTRAL – two of the most popular and accurate coalescent-based methods. Experimental results suggest that STELAR matches the accuracy of ASTRAL and improves on MP-EST and SuperTriplets.</p>
      </sec>
      <sec>
        <title>Conclusions</title>
        <p id="Par3">Theoretical and empirical results (on both simulated and real biological datasets) suggest that STELAR is a valuable technique for species tree estimation from gene tree distributions.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Phylogenomics</kwd>
      <kwd>Multi-species coalescent process</kwd>
      <kwd>Gene tree incongruence</kwd>
      <kwd>Incomplete lineage sorting</kwd>
    </kwd-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2020</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p>Estimated species trees are useful in many biological analyses, but accurate estimation of species trees can be quite complicated. Species tree inference can potentially result in accurate evolutionary history using data from multiple loci. Therefore, due to the advent of modern sequencing technologies, it is increasingly common to infer trees by analyzing sequences from multiple loci. However, combining multi-locus data is difficult, especially in the presence of gene tree discordance [<xref ref-type="bibr" rid="CR1">1</xref>]. A traditional approach to species tree estimation is called concatenation (also known as combined analysis), which concatenates gene sequence alignments into a supergene matrix, and then estimates the species tree using a sequence based tree estimation technique (e.g., maximum parsimony, maximum likelihood etc.). Although it has been used in many biological analyses, concatenation can be problematic as it is agnostic to the topological differences among the gene trees, can be statistically inconsistent [<xref ref-type="bibr" rid="CR2">2</xref>], and can return incorrect trees with high confidence [<xref ref-type="bibr" rid="CR3">3</xref>–<xref ref-type="bibr" rid="CR6">6</xref>].</p>
    <p>Recent modeling and computational advances have produced methods that explicitly take the gene tree discordance into account while combining multi-locus data to estimate species trees. Incomplete lineage sorting (ILS) (also known as deep coalescence) is one of the most prevalent reasons for gene tree incongruence [<xref ref-type="bibr" rid="CR1">1</xref>], which is modelled by the MSC [<xref ref-type="bibr" rid="CR7">7</xref>]. Rapid radiation is known to happen in many organisms (for example, birds) where ILS is likely to occur [<xref ref-type="bibr" rid="CR8">8</xref>]. Due to this growing awareness that ILS can be present in many phylogenomic datasets, ILS-aware species tree estimation techniques have gained substantial attention from systematists. These types of method are usually known as “summary methods” as they summarize a set of gene trees to estimate the species trees [<xref ref-type="bibr" rid="CR9">9</xref>].</p>
    <p>Several species-tree estimation methods have been proven to be statistically consistent under the multi-species coalescent model, meaning that they will return the true species tree with high probability given a sufficiently large number of true gene trees sampled from the distribution defined by the species tree. Methods that are statistically consistent under the MSC include ASTRAL [<xref ref-type="bibr" rid="CR10">10</xref>], MP-EST [<xref ref-type="bibr" rid="CR11">11</xref>], *BEAST [<xref ref-type="bibr" rid="CR12">12</xref>], NJst [<xref ref-type="bibr" rid="CR13">13</xref>], BUCKy [<xref ref-type="bibr" rid="CR14">14</xref>], GLASS [<xref ref-type="bibr" rid="CR15">15</xref>], STEM [<xref ref-type="bibr" rid="CR16">16</xref>], SNAPP [<xref ref-type="bibr" rid="CR17">17</xref>], SVDquartets [<xref ref-type="bibr" rid="CR18">18</xref>], STEAC [<xref ref-type="bibr" rid="CR19">19</xref>] and ASTRID [<xref ref-type="bibr" rid="CR20">20</xref>]. *BEAST, which is a Bayesian technique, can co-estimate both gene trees and species trees, and simulation studies suggest that *BEAST can be considered the best of the co-estimation methods with excellent accuracy, but it is computationally very intensive to run on even moderately-sized dataset [<xref ref-type="bibr" rid="CR9">9</xref>, <xref ref-type="bibr" rid="CR21">21</xref>]. SuperTriplets [<xref ref-type="bibr" rid="CR22">22</xref>] is a triplet-based supertree method which tries to find an asymmetric median supertree according to a triplet dissimilarity. SuperTriplets is very fast and accurate and was used in a number of important phylogenomic studies [<xref ref-type="bibr" rid="CR23">23</xref>–<xref ref-type="bibr" rid="CR28">28</xref>]. ASTRAL and MP-EST are two of the most accurate and widely used summary methods that are much faster than *BEAST. ASTRAL has been shown to be faster and more accurate than MP-EST and can handle large dataset containing hundreds of species which is not possible by MP-EST [<xref ref-type="bibr" rid="CR10">10</xref>, <xref ref-type="bibr" rid="CR29">29</xref>].</p>
    <p>ASTRAL finds a species tree that maximizes the number of consistent quartets between the species tree and the gene trees. MP-EST maximizes a pseudo-likelihood estimate utilizing the underlying triplet distribution of the gene trees. Quartet and triplet based methods are robust to the “anomaly zone” [<xref ref-type="bibr" rid="CR30">30</xref>, <xref ref-type="bibr" rid="CR31">31</xref>] (a condition where the most probable gene tree topology may not be identical to the species tree topology) as there are no anomalous rooted three-taxon species trees [<xref ref-type="bibr" rid="CR30">30</xref>, <xref ref-type="bibr" rid="CR32">32</xref>] and no anomalous unrooted four-taxon species trees [<xref ref-type="bibr" rid="CR31">31</xref>, <xref ref-type="bibr" rid="CR33">33</xref>].</p>
    <p>We present STELAR (Species Tree Estimation by maximizing tripLet AgReement), a new coalescent-based method which finds a species tree that agrees with the largest number of triplets induced by the gene trees. STELAR is statistically consistent under the MSC model, fast (having a polynomial running time), and highly accurate – enabling genome wide phylogenomic analyses. We report, on an extensive experimental study, the performance of STELAR in comparison with ASTRAL, MP-EST and SuperTriplets. These quartet- and triplet-based methods are known to be highly accurate and reliable, and are being widely used. Our experiments showed that STELAR is as good as ASTRAL, and is better than MP-EST and SuperTriplets in most of the model conditions. Thus, with the desirable property of being statistically consistent and reliable performance on challenging realistic model conditions, STELAR will be a useful tool for genome-scale analyses of species phylogeny.</p>
  </sec>
  <sec id="Sec2">
    <title>Implementation</title>
    <p>Design of ASTRAL and other quartet-based methods [<xref ref-type="bibr" rid="CR10">10</xref>, <xref ref-type="bibr" rid="CR34">34</xref>] and their proofs of being statistically consistent are based upon the fact that unrooted 4-taxon species trees do not contain anomaly zone [<xref ref-type="bibr" rid="CR31">31</xref>, <xref ref-type="bibr" rid="CR33">33</xref>]. We use similar design in STELAR, utilizing the fact that rooted 3-taxon species trees do not contain anomaly zone [<xref ref-type="bibr" rid="CR30">30</xref>, <xref ref-type="bibr" rid="CR32">32</xref>].</p>
    <p>STELAR is provably statistically consistent under the MSC model but its statistical guarantee can fail under model conditions in which gene tree discordance is due to gene duplication and loss or horizontal gene transfer. Furthermore, MSC model requires representing each gene by a single tree. Therefore, MSC model does not allow recombination events inside a gene [<xref ref-type="bibr" rid="CR32">32</xref>] and consequently the statistical guarantee can fail in the presence of recombination.</p>
    <sec id="Sec3">
      <title>Definitions and notation</title>
      <p>Let <italic>T</italic> be a binary rooted tree, leaf-labelled by species set <inline-formula id="IEq1"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {X}$\end{document}</tex-math><mml:math id="M2"><mml:mi mathvariant="script">X</mml:mi></mml:math><inline-graphic xlink:href="12864_2020_6519_Article_IEq1.gif"/></alternatives></inline-formula> with <italic>n</italic> taxa. Each internal node <italic>u</italic> in a tree <italic>T</italic> divides the set of taxa present in the subtree rooted at <italic>u</italic> into two distinct sets. We call this a <italic>subtree-bipartition</italic>, denoted by <inline-formula id="IEq2"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {SBP}_{T}(u)$\end{document}</tex-math><mml:math id="M4"><mml:msub><mml:mrow><mml:mi mathvariant="script">S</mml:mi><mml:mi mathvariant="script">ℬ</mml:mi><mml:mi mathvariant="script">P</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>u</mml:mi><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12864_2020_6519_Article_IEq2.gif"/></alternatives></inline-formula>, which was originally defined in [<xref ref-type="bibr" rid="CR35">35</xref>]. We denote by <italic>T</italic><sub><italic>u</italic></sub> the subtree under node <italic>u</italic> of tree <italic>T</italic>. We denote the leaves in <italic>T</italic> by <italic>L</italic>(<italic>T</italic>), an arbitrary set of three species <inline-formula id="IEq3"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\{a,b,c\} \subset \mathcal {X}$\end{document}</tex-math><mml:math id="M6"><mml:mo>{</mml:mo><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>b</mml:mi><mml:mo>,</mml:mo><mml:mi>c</mml:mi><mml:mo>}</mml:mo><mml:mo>⊂</mml:mo><mml:mi mathvariant="script">X</mml:mi></mml:math><inline-graphic xlink:href="12864_2020_6519_Article_IEq3.gif"/></alternatives></inline-formula> by <italic>r</italic>, and a rooted topology on <italic>r</italic> by <italic>t</italic><sub><italic>r</italic></sub>. We use <italic>a</italic>|<italic>b</italic><italic>c</italic> to show that <italic>b</italic> and <italic>c</italic> are siblings. Possible three topologies on {<italic>a</italic>,<italic>b</italic>,<italic>c</italic>} are: <italic>a</italic>|<italic>b</italic><italic>c</italic>,<italic>b</italic>|<italic>c</italic><italic>a</italic>,<italic>c</italic>|<italic>a</italic><italic>b</italic>. The probability, under the MSC model, of observing an induced gene tree triplet that matches the species tree topology is higher, and the other two triplet topologies are less probable and equal to each other [<xref ref-type="bibr" rid="CR30">30</xref>]. The triplet tree topology that appears more frequently than the two alternative topologies is called the <italic>dominant</italic> topology. <inline-formula id="IEq4"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {TR}(T)$\end{document}</tex-math><mml:math id="M8"><mml:mi mathvariant="script">T</mml:mi><mml:mi mathvariant="script">R</mml:mi><mml:mo>(</mml:mo><mml:mi>T</mml:mi><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12864_2020_6519_Article_IEq4.gif"/></alternatives></inline-formula> denotes the set of <inline-formula id="IEq5"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\binom {n}{3}$\end{document}</tex-math><mml:math id="M10"><mml:mfenced close=")" open="(" separators=""><mml:mfrac linethickness="0.0pt"><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:mfrac></mml:mfenced></mml:math><inline-graphic xlink:href="12864_2020_6519_Article_IEq5.gif"/></alternatives></inline-formula> triplet topologies induced by the tree <italic>T</italic>. We denote by <italic>T</italic>|<italic>r</italic> the triplet tree topology obtained by restricting <italic>T</italic> to the three species in <italic>r</italic>.</p>
    </sec>
    <sec id="Sec4">
      <title>Problem definition</title>
      <p>A natural optimization problem for estimating a species tree from a collection of gene trees under triplet consistency would be first decomposing the input gene trees into their induced triplets, and then estimating a species tree by amalgamating the dominant triplets [<xref ref-type="bibr" rid="CR36">36</xref>]. Building such a consensus tree from a set of triplets has been shown to be an NP-hard problem, and exact and heuristic algorithms have been proposed [<xref ref-type="bibr" rid="CR37">37</xref>, <xref ref-type="bibr" rid="CR38">38</xref>]. This approach considers only the dominant triplets which could be problematic when the frequencies of the alternate triplet topologies are very close to that of the dominant one, and when all the dominant triplets are not compatible with each other meaning that all of them do not agree with a single species tree. Moreover, this approach has to explicitly enumerate and consider <inline-formula id="IEq6"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$3*\binom {n}{3}$\end{document}</tex-math><mml:math id="M12"><mml:mn>3</mml:mn><mml:mo>∗</mml:mo><mml:mfenced close=")" open="(" separators=""><mml:mfrac linethickness="0.0pt"><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:mfrac></mml:mfenced></mml:math><inline-graphic xlink:href="12864_2020_6519_Article_IEq6.gif"/></alternatives></inline-formula> possible triplets, making it computationally expensive for larger values of <italic>n</italic>. An alternate approach would be to consider the relative frequencies of all the triplets, and infer a species tree that agrees with the largest number of triplets induced by the gene trees. Methods that do not explicitly decompose the gene trees into induced triplets and quartets are preferred over the ones that take a set of quartets or triplets as input, since the latter types of methods demand high computational time and memory, and thus are not scalable to large dataset [<xref ref-type="bibr" rid="CR10">10</xref>, <xref ref-type="bibr" rid="CR34">34</xref>]. This is possibly one of the reasons why quartet amalgamation method like QFM [<xref ref-type="bibr" rid="CR34">34</xref>], despite having excellent accuracy, is not as popular as ASTRAL. Taking these issues into consideration, we introduce a constrained version of the triplet consistency problem, which we call the <italic>Constrained Triplet Consensus</italic> (CTC) problem, and provide efficient exact and heuristic solutions to the CTC without having to decompose the gene trees into their induced triplets. We formalize the CTC problem as follows.
<list list-type="bullet"><list-item><p><bold>Input</bold>: a set <inline-formula id="IEq7"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {G}$\end{document}</tex-math><mml:math id="M14"><mml:mi mathvariant="script">G</mml:mi></mml:math><inline-graphic xlink:href="12864_2020_6519_Article_IEq7.gif"/></alternatives></inline-formula> of rooted gene trees on <inline-formula id="IEq8"><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {X}$\end{document}</tex-math><mml:math id="M16"><mml:mi mathvariant="script">X</mml:mi></mml:math><inline-graphic xlink:href="12864_2020_6519_Article_IEq8.gif"/></alternatives></inline-formula> and a set <inline-formula id="IEq9"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {SBP}$\end{document}</tex-math><mml:math id="M18"><mml:mi mathvariant="script">S</mml:mi><mml:mi mathvariant="script">ℬ</mml:mi><mml:mi mathvariant="script">P</mml:mi></mml:math><inline-graphic xlink:href="12864_2020_6519_Article_IEq9.gif"/></alternatives></inline-formula> of subtree-bipartitions.</p></list-item><list-item><p><bold>Output</bold>: a species tree <italic>S</italic><italic>T</italic> on <inline-formula id="IEq10"><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {X}$\end{document}</tex-math><mml:math id="M20"><mml:mi mathvariant="script">X</mml:mi></mml:math><inline-graphic xlink:href="12864_2020_6519_Article_IEq10.gif"/></alternatives></inline-formula> that maximizes the triplet agreement with <inline-formula id="IEq11"><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {G}$\end{document}</tex-math><mml:math id="M22"><mml:mi mathvariant="script">G</mml:mi></mml:math><inline-graphic xlink:href="12864_2020_6519_Article_IEq11.gif"/></alternatives></inline-formula> and all its subtree-bipartitions are in <inline-formula id="IEq12"><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {SBP}$\end{document}</tex-math><mml:math id="M24"><mml:mi mathvariant="script">S</mml:mi><mml:mi mathvariant="script">ℬ</mml:mi><mml:mi mathvariant="script">P</mml:mi></mml:math><inline-graphic xlink:href="12864_2020_6519_Article_IEq12.gif"/></alternatives></inline-formula>.</p></list-item></list></p>
      <p>Note that when <inline-formula id="IEq13"><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {SBP}$\end{document}</tex-math><mml:math id="M26"><mml:mi mathvariant="script">S</mml:mi><mml:mi mathvariant="script">ℬ</mml:mi><mml:mi mathvariant="script">P</mml:mi></mml:math><inline-graphic xlink:href="12864_2020_6519_Article_IEq13.gif"/></alternatives></inline-formula> is set to all possible subtree-bipartitions on <inline-formula id="IEq14"><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {X}$\end{document}</tex-math><mml:math id="M28"><mml:mi mathvariant="script">X</mml:mi></mml:math><inline-graphic xlink:href="12864_2020_6519_Article_IEq14.gif"/></alternatives></inline-formula>, the triplet consistency problem will find the globally optimal solution (exact solution). Otherwise, when <inline-formula id="IEq15"><alternatives><tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {SBP}$\end{document}</tex-math><mml:math id="M30"><mml:mi mathvariant="script">S</mml:mi><mml:mi mathvariant="script">ℬ</mml:mi><mml:mi mathvariant="script">P</mml:mi></mml:math><inline-graphic xlink:href="12864_2020_6519_Article_IEq15.gif"/></alternatives></inline-formula> contains only the subtree-bipartitions in the input gene trees, the search space will include only those species trees where every subtree-bipartition is present in at least one of the gene trees in <inline-formula id="IEq16"><alternatives><tex-math id="M31">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {G}$\end{document}</tex-math><mml:math id="M32"><mml:mi mathvariant="script">G</mml:mi></mml:math><inline-graphic xlink:href="12864_2020_6519_Article_IEq16.gif"/></alternatives></inline-formula>, and we call this the constrained version or heuristic version.</p>
      <sec id="d29e842">
        <title>
          <bold>Theorem 1</bold>
        </title>
        <p>Given a set <inline-formula id="IEq17"><alternatives><tex-math id="M33">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {G}$\end{document}</tex-math><mml:math id="M34"><mml:mi mathvariant="script">G</mml:mi></mml:math><inline-graphic xlink:href="12864_2020_6519_Article_IEq17.gif"/></alternatives></inline-formula> of true gene trees, solution to the CTC problem (both exact and constrained version) is a statistically consistent estimator of the species tree topology under the MSC model.</p>
      </sec>
      <sec id="d29e858">
        <title>
          <italic>Proof</italic>
        </title>
        <p>Let <inline-formula id="IEq18"><alternatives><tex-math id="M35">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {G}$\end{document}</tex-math><mml:math id="M36"><mml:mi mathvariant="script">G</mml:mi></mml:math><inline-graphic xlink:href="12864_2020_6519_Article_IEq18.gif"/></alternatives></inline-formula> be a set of sufficiently large number of true gene trees that has evolved within the model species tree <italic>T</italic> under the multi-species coalescent model. We know that a rooted 3-taxon species tree does not have any anomaly zone [<xref ref-type="bibr" rid="CR32">32</xref>]. So, as we increase the number of gene trees, each triplet topology induced by the species tree will have more frequency in <inline-formula id="IEq19"><alternatives><tex-math id="M37">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {G}$\end{document}</tex-math><mml:math id="M38"><mml:mi mathvariant="script">G</mml:mi></mml:math><inline-graphic xlink:href="12864_2020_6519_Article_IEq19.gif"/></alternatives></inline-formula> than its alternatives, with probability that approaches 1. Let <inline-formula id="IEq20"><alternatives><tex-math id="M39">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$w_{\mathcal {G}}(t_{r})$\end{document}</tex-math><mml:math id="M40"><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="script">G</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12864_2020_6519_Article_IEq20.gif"/></alternatives></inline-formula> be the number of trees in <inline-formula id="IEq21"><alternatives><tex-math id="M41">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {G}$\end{document}</tex-math><mml:math id="M42"><mml:mi mathvariant="script">G</mml:mi></mml:math><inline-graphic xlink:href="12864_2020_6519_Article_IEq21.gif"/></alternatives></inline-formula> that agree with <italic>t</italic><sub><italic>r</italic></sub>. Hence, for every triplet <italic>r</italic> and every possible tree <inline-formula id="IEq22"><alternatives><tex-math id="M43">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$T\prime, w_{\mathcal {G}}(T|r) \geq w_{\mathcal {G}}(T\prime |r)$\end{document}</tex-math><mml:math id="M44"><mml:mi>T′</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="script">G</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>T</mml:mi><mml:mo>|</mml:mo><mml:mi>r</mml:mi><mml:mo>)</mml:mo><mml:mo>≥</mml:mo><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="script">G</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>T′</mml:mi><mml:mo>|</mml:mo><mml:mi>r</mml:mi><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12864_2020_6519_Article_IEq22.gif"/></alternatives></inline-formula> with probability that approaches 1 for a large enough number of gene trees. Therefore, if <inline-formula id="IEq23"><alternatives><tex-math id="M45">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {TR}$\end{document}</tex-math><mml:math id="M46"><mml:mi mathvariant="script">T</mml:mi><mml:mi mathvariant="script">R</mml:mi></mml:math><inline-graphic xlink:href="12864_2020_6519_Article_IEq23.gif"/></alternatives></inline-formula> is the set of all possible triplets on <inline-formula id="IEq24"><alternatives><tex-math id="M47">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {X}$\end{document}</tex-math><mml:math id="M48"><mml:mi mathvariant="script">X</mml:mi></mml:math><inline-graphic xlink:href="12864_2020_6519_Article_IEq24.gif"/></alternatives></inline-formula>, then
<disp-formula id="Equa"><alternatives><tex-math id="M49">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\sum_{r \epsilon \mathcal{TR}}w_{\mathcal{G}}(T|r) \geq \sum_{r \epsilon \mathcal{TR}}w_{\mathcal{G}}(T\prime|r).$$ \end{document}</tex-math><mml:math id="M50"><mml:mrow><mml:munder><mml:mrow><mml:mo mathsize="big">∑</mml:mo></mml:mrow><mml:mrow><mml:mi>rε</mml:mi><mml:mi mathvariant="script">T</mml:mi><mml:mi mathvariant="script">R</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="script">G</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>T</mml:mi><mml:mo>|</mml:mo><mml:mi>r</mml:mi><mml:mo>)</mml:mo><mml:mo>≥</mml:mo><mml:munder><mml:mrow><mml:mo mathsize="big">∑</mml:mo></mml:mrow><mml:mrow><mml:mi>rε</mml:mi><mml:mi mathvariant="script">T</mml:mi><mml:mi mathvariant="script">R</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="script">G</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>T′</mml:mi><mml:mo>|</mml:mo><mml:mi>r</mml:mi><mml:mo>)</mml:mo><mml:mi>.</mml:mi></mml:mrow></mml:math><graphic xlink:href="12864_2020_6519_Article_Equa.gif" position="anchor"/></alternatives></disp-formula></p>
        <p>By definition, the exact solution to the CTC problem will find a tree that will maximize the triplet agreement with <inline-formula id="IEq25"><alternatives><tex-math id="M51">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {G}$\end{document}</tex-math><mml:math id="M52"><mml:mi mathvariant="script">G</mml:mi></mml:math><inline-graphic xlink:href="12864_2020_6519_Article_IEq25.gif"/></alternatives></inline-formula>. Therefore, for a sufficiently large number of true gene trees, the optimal tree under CTC will be identical to the true species tree <italic>T</italic> with probability approaching one.</p>
        <p>We now show that the solution to the constrained version is also statistically consistent. If we increase the number of gene trees, with probability approaching 1, at least one of the gene tree topologies in <inline-formula id="IEq26"><alternatives><tex-math id="M53">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {G}$\end{document}</tex-math><mml:math id="M54"><mml:mi mathvariant="script">G</mml:mi></mml:math><inline-graphic xlink:href="12864_2020_6519_Article_IEq26.gif"/></alternatives></inline-formula> will be identical to the true species tree topology. Therefore, with probability that tends to 1, the set <inline-formula id="IEq27"><alternatives><tex-math id="M55">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {SBP}$\end{document}</tex-math><mml:math id="M56"><mml:mi mathvariant="script">S</mml:mi><mml:mi mathvariant="script">ℬ</mml:mi><mml:mi mathvariant="script">P</mml:mi></mml:math><inline-graphic xlink:href="12864_2020_6519_Article_IEq27.gif"/></alternatives></inline-formula> will contain all the subtree bipartitions from the true species tree, and therefore the solution to the CTC problem will be identical to the true species tree <italic>T</italic>. □</p>
      </sec>
    </sec>
    <sec id="Sec5">
      <title>Algorithmic design of STELAR</title>
      <p>We propose a dynamic programming (DP) solution to the CTC problem. The algorithmic design (and corresponding theoretical results) in STELAR is structurally similar to ASTRAL. This sort of DP-based approach, which implicitly finds a maximum or minimum clique in a graph modelled from the input gene trees, was first used by [<xref ref-type="bibr" rid="CR39">39</xref>] and later was used in Phylonet [<xref ref-type="bibr" rid="CR40">40</xref>, <xref ref-type="bibr" rid="CR41">41</xref>], DynaDup [<xref ref-type="bibr" rid="CR35">35</xref>, <xref ref-type="bibr" rid="CR42">42</xref>] and ASTRAL. The key idea in STELAR is to find an equation for computing the number of triplets in the gene trees that agree with a given subtree in the species tree, which ultimately enables us to design a dynamic programming algorithm for estimating a species tree by maximizing the triplet agreement.</p>
      <p>We call a triplet <italic>t</italic><sub><italic>r</italic></sub>=<italic>a</italic>|<italic>b</italic><italic>c</italic> to be mapped to a subtree-bipartition at an internal node <italic>x</italic> in <italic>T</italic> (<inline-formula id="IEq28"><alternatives><tex-math id="M57">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {SBP}(T_{x})=X_{1}|X_{2}$\end{document}</tex-math><mml:math id="M58"><mml:mi mathvariant="script">S</mml:mi><mml:mi mathvariant="script">ℬ</mml:mi><mml:mi mathvariant="script">P</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12864_2020_6519_Article_IEq28.gif"/></alternatives></inline-formula>) when {<italic>a</italic>,<italic>b</italic>,<italic>c</italic>}⊆<italic>L</italic>(<italic>T</italic><sub><italic>x</italic></sub>), and the topology of <italic>t</italic><sub><italic>r</italic></sub> is compatible (consistent) with <italic>T</italic><sub><italic>x</italic></sub> (see Fig. <xref rid="Fig1" ref-type="fig">1</xref>). Each triplet mapped to a subtree-bipartition (<italic>X</italic><sub>1</sub>|<italic>X</italic><sub>2</sub>) will have either two leaves from <italic>X</italic><sub>1</sub> and one leaf from <italic>X</italic><sub>2</sub> or two leaves from <italic>X</italic><sub>2</sub> and one leaf from <italic>X</italic><sub>1</sub>. Therefore, we have the following results.
<fig id="Fig1"><label>Fig. 1</label><caption><p>Mapping of a triplet to a subtree-bipartition. Each internal node <italic>x</italic> in a rooted tree defines a subtree-bipartition (<italic>X</italic><sub>1</sub>|<italic>X</italic><sub>2</sub>). Each induced triplet in <italic>T</italic> maps to a subtree-bipartition in <italic>T</italic>. This figure shows the mapping of a triplet <italic>a</italic>|<italic>b</italic><italic>c</italic> to a subtree-bipartition <italic>x</italic>=<italic>X</italic><sub>1</sub>|<italic>X</italic><sub>2</sub></p></caption><graphic xlink:href="12864_2020_6519_Fig1_HTML" id="MO1"/></fig></p>
      <sec id="d29e1323">
        <title>
          <bold>Lemma 1</bold>
        </title>
        <p>Total number of triplets mapped to a subtree-bipartition <italic>x</italic>=(<italic>X</italic><sub>1</sub>|<italic>X</italic><sub>2</sub>) of a rooted binary tree <italic>T</italic>, where |<italic>X</italic><sub>1</sub>|=<italic>n</italic><sub>1</sub> and |<italic>X</italic><sub>2</sub>|=<italic>n</italic><sub>2</sub> is:
<disp-formula id="Equ1"><label>1</label><alternatives><tex-math id="M59">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ {\begin{aligned} \mathcal{NT}(n_{1}, n_{2}) &amp;= {n_{1}\choose 2}{n_{2}\choose 1} + {n_{2}\choose 2}{n_{1}\choose 1} \\ &amp;= \frac{n_{1}n_{2}(n_{1} + n_{2} - 2)}{2}. \end{aligned}}  $$ \end{document}</tex-math><mml:math id="M60"><mml:mtable><mml:mtr><mml:mtd><mml:mi mathvariant="script">N</mml:mi><mml:mi mathvariant="script">T</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mtd><mml:mtd><mml:mo>=</mml:mo><mml:mfenced close=")" open="(" separators=""><mml:mfrac linethickness="0"><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac></mml:mfenced><mml:mfenced close=")" open="(" separators=""><mml:mfrac linethickness="0"><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:mfrac></mml:mfenced><mml:mo>+</mml:mo><mml:mfenced close=")" open="(" separators=""><mml:mfrac linethickness="0"><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac></mml:mfenced><mml:mfenced close=")" open="(" separators=""><mml:mfrac linethickness="0"><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:mfrac></mml:mfenced></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mn>2</mml:mn><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac><mml:mi>.</mml:mi></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="12864_2020_6519_Article_Equ1.gif" position="anchor"/></alternatives></disp-formula></p>
      </sec>
      <sec id="d29e1509">
        <title>
          <bold>Lemma 2</bold>
        </title>
        <p>For two subtree-bipartitions <italic>x</italic>=(<italic>X</italic><sub>1</sub>|<italic>X</italic><sub>2</sub>) and <italic>y</italic>=(<italic>Y</italic><sub>1</sub>|<italic>Y</italic><sub>2</sub>) where <inline-formula id="IEq29"><alternatives><tex-math id="M61">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$(X_{1} \cup X_{2}) \subseteq \mathcal {X}$\end{document}</tex-math><mml:math id="M62"><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>∪</mml:mo><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>⊆</mml:mo><mml:mi mathvariant="script">X</mml:mi></mml:math><inline-graphic xlink:href="12864_2020_6519_Article_IEq29.gif"/></alternatives></inline-formula> and <inline-formula id="IEq30"><alternatives><tex-math id="M63">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$(Y_{1} \cup Y_{2}) \subseteq \mathcal {X}$\end{document}</tex-math><mml:math id="M64"><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>∪</mml:mo><mml:msub><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>⊆</mml:mo><mml:mi mathvariant="script">X</mml:mi></mml:math><inline-graphic xlink:href="12864_2020_6519_Article_IEq30.gif"/></alternatives></inline-formula>, the number of triplets mapped to both <italic>x</italic> and <italic>y</italic> is given by:
<disp-formula id="Equ2"><label>2</label><alternatives><tex-math id="M65">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ {\begin{aligned} \mathcal{M}(x,y) &amp;= \mathcal{NT}(|X_{1} \cap Y_{1}|, |X_{2} \cap Y_{2}|)\\ &amp;\quad + \mathcal{NT}(|X_{1} \cap Y_{2}|, |X_{2} \cap Y_{1}|). \end{aligned}}  $$ \end{document}</tex-math><mml:math id="M66"><mml:mtable><mml:mtr><mml:mtd><mml:mi mathvariant="script">ℳ</mml:mi><mml:mo>(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo>)</mml:mo></mml:mtd><mml:mtd><mml:mo>=</mml:mo><mml:mi mathvariant="script">N</mml:mi><mml:mi mathvariant="script">T</mml:mi><mml:mo>(</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>∩</mml:mo><mml:msub><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:mo>,</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>∩</mml:mo><mml:msub><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:mo>)</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mspace width="1em"/><mml:mo>+</mml:mo><mml:mi mathvariant="script">N</mml:mi><mml:mi mathvariant="script">T</mml:mi><mml:mo>(</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>∩</mml:mo><mml:msub><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:mo>,</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>∩</mml:mo><mml:msub><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:mo>)</mml:mo><mml:mi>.</mml:mi></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="12864_2020_6519_Article_Equ2.gif" position="anchor"/></alternatives></disp-formula></p>
      </sec>
      <sec id="d29e1749">
        <title>
          <italic>Proof</italic>
        </title>
        <p>We can obtain two possible subtree bipartitions by taking pairwise intersection: <italic>z</italic><sub>1</sub>=(<italic>X</italic><sub>1</sub>∩<italic>Y</italic><sub>1</sub>|<italic>X</italic><sub>2</sub>∩<italic>Y</italic><sub>2</sub>) and <italic>z</italic><sub>2</sub>=(<italic>X</italic><sub>1</sub>∩<italic>Y</italic><sub>2</sub>|<italic>X</italic><sub>2</sub>∩<italic>Y</italic><sub>1</sub>). Note that each leaf in <italic>z</italic><sub><italic>i</italic></sub> (<italic>i</italic>∈1,2) is also a leaf in both <italic>x</italic> and <italic>y</italic>, and so each triplet mapped to <italic>z</italic><sub><italic>i</italic></sub> is also mapped to <italic>x</italic> and <italic>y</italic> and the number of mapped triplets can be computed by Eq. <xref rid="Equ1" ref-type="">1</xref>.</p>
        <p>We now prove that Eq. <xref rid="Equ2" ref-type="">2</xref> counts a mapped triplet only once. Without loss of generality, let <italic>t</italic><sub><italic>r</italic></sub>=<italic>a</italic><italic>b</italic>|<italic>c</italic> be mapped to both <italic>x</italic> and <italic>y</italic> where <italic>a</italic>,<italic>b</italic>∈<italic>X</italic><sub>1</sub>,<italic>c</italic>∈<italic>X</italic><sub>2</sub>,<italic>a</italic>,<italic>b</italic>∈<italic>Y</italic><sub>1</sub> and <italic>c</italic>∈<italic>Y</italic><sub>2</sub>. Equation <xref rid="Equ2" ref-type="">2</xref> will count <italic>t</italic><sub><italic>r</italic></sub> for <italic>z</italic><sub>1</sub>=(<italic>X</italic><sub>1</sub>∩<italic>Y</italic><sub>1</sub>|<italic>X</italic><sub>2</sub>∩<italic>Y</italic><sub>2</sub>) only as <italic>z</italic><sub>2</sub> will have no element from {<italic>a</italic>,<italic>b</italic>,<italic>c</italic>}. Thus the lemma follows. □</p>
        <p>We now see how to compute the triplet consistency (<italic>TC</italic>) score of a species tree <italic>ST</italic> with respect to a set <inline-formula id="IEq31"><alternatives><tex-math id="M67">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {G}$\end{document}</tex-math><mml:math id="M68"><mml:mi mathvariant="script">G</mml:mi></mml:math><inline-graphic xlink:href="12864_2020_6519_Article_IEq31.gif"/></alternatives></inline-formula> of gene trees, which we denote by <inline-formula id="IEq32"><alternatives><tex-math id="M69">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$TC_{\mathcal {G}}(ST)$\end{document}</tex-math><mml:math id="M70"><mml:mi>T</mml:mi><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="script">G</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mtext mathvariant="italic">ST</mml:mtext><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12864_2020_6519_Article_IEq32.gif"/></alternatives></inline-formula>. If <inline-formula id="IEq33"><alternatives><tex-math id="M71">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {SBP}(T)$\end{document}</tex-math><mml:math id="M72"><mml:mi mathvariant="script">S</mml:mi><mml:mi mathvariant="script">ℬ</mml:mi><mml:mi mathvariant="script">P</mml:mi><mml:mo>(</mml:mo><mml:mi>T</mml:mi><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12864_2020_6519_Article_IEq33.gif"/></alternatives></inline-formula> is the set of subtree-bipartitions in <italic>T</italic>, for a subtree-bipartition <italic>x</italic> and a set of rooted binary trees <inline-formula id="IEq34"><alternatives><tex-math id="M73">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {G}$\end{document}</tex-math><mml:math id="M74"><mml:mi mathvariant="script">G</mml:mi></mml:math><inline-graphic xlink:href="12864_2020_6519_Article_IEq34.gif"/></alternatives></inline-formula>, the total number of triplets in <inline-formula id="IEq35"><alternatives><tex-math id="M75">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {G}$\end{document}</tex-math><mml:math id="M76"><mml:mi mathvariant="script">G</mml:mi></mml:math><inline-graphic xlink:href="12864_2020_6519_Article_IEq35.gif"/></alternatives></inline-formula> that are mapped to <italic>x</italic> is given by:
<disp-formula id="Equ3"><label>3</label><alternatives><tex-math id="M77">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$  TC_{\mathcal{G}}(x) = \sum_{gt \in \mathcal{G}}\sum_{y \in \mathcal{SBP}(gt)}\mathcal{M}(x, y).  $$ \end{document}</tex-math><mml:math id="M78"><mml:mi>T</mml:mi><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="script">G</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>x</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">gt</mml:mtext><mml:mo>∈</mml:mo><mml:mi mathvariant="script">G</mml:mi></mml:mrow></mml:munder><mml:munder><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>y</mml:mi><mml:mo>∈</mml:mo><mml:mi mathvariant="script">S</mml:mi><mml:mi mathvariant="script">ℬ</mml:mi><mml:mi mathvariant="script">P</mml:mi><mml:mo>(</mml:mo><mml:mtext mathvariant="italic">gt</mml:mtext><mml:mo>)</mml:mo></mml:mrow></mml:munder><mml:mi mathvariant="script">ℳ</mml:mi><mml:mo>(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo>)</mml:mo><mml:mi>.</mml:mi></mml:math><graphic xlink:href="12864_2020_6519_Article_Equ3.gif" position="anchor"/></alternatives></disp-formula></p>
        <p>Thus, the <italic>TC</italic> score of an estimated species tree <italic>ST</italic> is obtained by,
<disp-formula id="Equ4"><label>4</label><alternatives><tex-math id="M79">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$  TC_{\mathcal{G}}(ST) = \sum_{x \in \mathcal{SBP}(ST)}TC_{\mathcal{G}}(x)  $$ \end{document}</tex-math><mml:math id="M80"><mml:mi>T</mml:mi><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="script">G</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mtext mathvariant="italic">ST</mml:mtext><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>x</mml:mi><mml:mo>∈</mml:mo><mml:mi mathvariant="script">S</mml:mi><mml:mi mathvariant="script">ℬ</mml:mi><mml:mi mathvariant="script">P</mml:mi><mml:mo>(</mml:mo><mml:mtext mathvariant="italic">ST</mml:mtext><mml:mo>)</mml:mo></mml:mrow></mml:munder><mml:mi>T</mml:mi><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="script">G</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>x</mml:mi><mml:mo>)</mml:mo></mml:math><graphic xlink:href="12864_2020_6519_Article_Equ4.gif" position="anchor"/></alternatives></disp-formula></p>
        <p>Therefore, we can design a dynamic programming approach which starts with the whole species set <inline-formula id="IEq36"><alternatives><tex-math id="M81">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {X}$\end{document}</tex-math><mml:math id="M82"><mml:mi mathvariant="script">X</mml:mi></mml:math><inline-graphic xlink:href="12864_2020_6519_Article_IEq36.gif"/></alternatives></inline-formula> and recursively divides it into smaller subsets and picks the partition that maximizes the triplet consistency. At each level, we compute <italic>V</italic>(<italic>A</italic>) which gives the score of an optimal subtree on leaf set <inline-formula id="IEq37"><alternatives><tex-math id="M83">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$A \subseteq \mathcal {X}$\end{document}</tex-math><mml:math id="M84"><mml:mi>A</mml:mi><mml:mo>⊆</mml:mo><mml:mi mathvariant="script">X</mml:mi></mml:math><inline-graphic xlink:href="12864_2020_6519_Article_IEq37.gif"/></alternatives></inline-formula>. At the end level, we have computed <inline-formula id="IEq38"><alternatives><tex-math id="M85">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$V(\mathcal {X})$\end{document}</tex-math><mml:math id="M86"><mml:mi>V</mml:mi><mml:mo>(</mml:mo><mml:mi mathvariant="script">X</mml:mi><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12864_2020_6519_Article_IEq38.gif"/></alternatives></inline-formula> and sufficient information so that backtracking yields the corresponding subtree-bipartitions in the optimal species tree.</p>
      </sec>
      <sec id="Sec6">
        <title>Dynamic programming</title>
        <p><bold>Base case</bold>: |<italic>A</italic>|=1;<italic>V</italic>(<italic>A</italic>)=0<bold>Recursive relation</bold>: <inline-formula id="IEq39"><alternatives><tex-math id="M87">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$V(A) = \max _{(A^{\prime }\vert A - A^{\prime }) \in \mathcal {X}}\{V(A^{\prime }) + V(A - A^{\prime }) + TC_{\mathcal {G}}(A^{\prime }\vert A - A^{\prime })\}$\end{document}</tex-math><mml:math id="M88"><mml:mi>V</mml:mi><mml:mo>(</mml:mo><mml:mi>A</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mo>max</mml:mo></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:msup><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:mo>|</mml:mo><mml:mi>A</mml:mi><mml:mo>−</mml:mo><mml:msup><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:mo>)</mml:mo><mml:mo>∈</mml:mo><mml:mi mathvariant="script">X</mml:mi></mml:mrow></mml:munder><mml:mo>{</mml:mo><mml:mi>V</mml:mi><mml:mo>(</mml:mo><mml:msup><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:mo>)</mml:mo><mml:mo>+</mml:mo><mml:mi>V</mml:mi><mml:mo>(</mml:mo><mml:mi>A</mml:mi><mml:mo>−</mml:mo><mml:msup><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:mo>)</mml:mo><mml:mo>+</mml:mo><mml:mi>T</mml:mi><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="script">G</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:msup><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:mo>|</mml:mo><mml:mi>A</mml:mi><mml:mo>−</mml:mo><mml:msup><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:mo>)</mml:mo><mml:mo>}</mml:mo></mml:math><inline-graphic xlink:href="12864_2020_6519_Article_IEq39.gif"/></alternatives></inline-formula>, where <inline-formula id="IEq40"><alternatives><tex-math id="M89">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$ A^{\prime }|A- A^{\prime } \in \mathcal {SBP}$\end{document}</tex-math><mml:math id="M90"><mml:msup><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:mo>|</mml:mo><mml:mi>A</mml:mi><mml:mo>−</mml:mo><mml:msup><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:mo>∈</mml:mo><mml:mi mathvariant="script">S</mml:mi><mml:mi mathvariant="script">ℬ</mml:mi><mml:mi mathvariant="script">P</mml:mi></mml:math><inline-graphic xlink:href="12864_2020_6519_Article_IEq40.gif"/></alternatives></inline-formula>.</p>
      </sec>
      <sec id="Sec7">
        <title>Running time analysis</title>
        <sec id="d29e2421">
          <title>
            <bold>Lemma 3</bold>
          </title>
          <p>Given a set <inline-formula id="IEq41"><alternatives><tex-math id="M91">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {G}$\end{document}</tex-math><mml:math id="M92"><mml:mi mathvariant="script">G</mml:mi></mml:math><inline-graphic xlink:href="12864_2020_6519_Article_IEq41.gif"/></alternatives></inline-formula> of <italic>k</italic> gene trees on <italic>n</italic> taxa and a subtree-bipartition <italic>x</italic>, computing the triplet consistency score <inline-formula id="IEq42"><alternatives><tex-math id="M93">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$TC_{\mathcal {G}}(x)$\end{document}</tex-math><mml:math id="M94"><mml:mi>T</mml:mi><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="script">G</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>x</mml:mi><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12864_2020_6519_Article_IEq42.gif"/></alternatives></inline-formula> takes <italic>O</italic>(<italic>n</italic><sup>2</sup><italic>k</italic>) time.</p>
        </sec>
        <sec id="d29e2480">
          <title>
            <italic>Proof</italic>
          </title>
          <p>A gene tree with <italic>n</italic> taxa contains <italic>O</italic>(<italic>n</italic>) subtree-bipartitions. Thus, for a set of <italic>k</italic> input gene trees, there will be <italic>O</italic>(<italic>n</italic><italic>k</italic>) subtree-bipartitions. To find the triplet consistency score <inline-formula id="IEq43"><alternatives><tex-math id="M95">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$TC_{\mathcal {G}}(x)$\end{document}</tex-math><mml:math id="M96"><mml:mi>T</mml:mi><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="script">G</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>x</mml:mi><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12864_2020_6519_Article_IEq43.gif"/></alternatives></inline-formula> of a subtree-bipartition <italic>x</italic> using Eq. <xref rid="Equ3" ref-type="">3</xref>, we need to score <inline-formula id="IEq44"><alternatives><tex-math id="M97">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {M}(x,y)$\end{document}</tex-math><mml:math id="M98"><mml:mi mathvariant="script">ℳ</mml:mi><mml:mo>(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12864_2020_6519_Article_IEq44.gif"/></alternatives></inline-formula> for all subtree-bipartions <italic>y</italic> present in the input gene trees. Since we represent each subtree-bipartion by a bitset, calculating <inline-formula id="IEq45"><alternatives><tex-math id="M99">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {M}(x,y)$\end{document}</tex-math><mml:math id="M100"><mml:mi mathvariant="script">ℳ</mml:mi><mml:mo>(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12864_2020_6519_Article_IEq45.gif"/></alternatives></inline-formula> (using Eq. <xref rid="Equ2" ref-type="">2</xref>) takes <italic>O</italic>(<italic>n</italic>) time. Since there are <italic>O</italic>(<italic>n</italic><italic>k</italic>) subtree-bipartions in <inline-formula id="IEq46"><alternatives><tex-math id="M101">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {G}$\end{document}</tex-math><mml:math id="M102"><mml:mi mathvariant="script">G</mml:mi></mml:math><inline-graphic xlink:href="12864_2020_6519_Article_IEq46.gif"/></alternatives></inline-formula>, calculating <inline-formula id="IEq47"><alternatives><tex-math id="M103">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$TC_{\mathcal {G}}(x)$\end{document}</tex-math><mml:math id="M104"><mml:mi>T</mml:mi><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="script">G</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>x</mml:mi><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12864_2020_6519_Article_IEq47.gif"/></alternatives></inline-formula> takes <italic>O</italic>(<italic>n</italic><sup>2</sup><italic>k</italic>) time. □</p>
        </sec>
        <sec id="d29e2642">
          <title>
            <bold>Theorem 2</bold>
          </title>
          <p>For a given set <inline-formula id="IEq48"><alternatives><tex-math id="M105">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {G}$\end{document}</tex-math><mml:math id="M106"><mml:mi mathvariant="script">G</mml:mi></mml:math><inline-graphic xlink:href="12864_2020_6519_Article_IEq48.gif"/></alternatives></inline-formula> of <italic>k</italic> gene trees on <italic>n</italic> taxa and a set <inline-formula id="IEq49"><alternatives><tex-math id="M107">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {SBP}$\end{document}</tex-math><mml:math id="M108"><mml:mi mathvariant="script">S</mml:mi><mml:mi mathvariant="script">ℬ</mml:mi><mml:mi mathvariant="script">P</mml:mi></mml:math><inline-graphic xlink:href="12864_2020_6519_Article_IEq49.gif"/></alternatives></inline-formula> of subtree-bipartitions, STELAR runs in <inline-formula id="IEq50"><alternatives><tex-math id="M109">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$O\left (n^{2}k\vert \mathcal {SBP}\vert ^{2}\right)$\end{document}</tex-math><mml:math id="M110"><mml:mi>O</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msup><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mi>k</mml:mi><mml:mo>|</mml:mo><mml:mi mathvariant="script">S</mml:mi><mml:mi mathvariant="script">ℬ</mml:mi><mml:mi mathvariant="script">P</mml:mi><mml:msup><mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="12864_2020_6519_Article_IEq50.gif"/></alternatives></inline-formula> time.</p>
        </sec>
        <sec id="d29e2714">
          <title>
            <italic>Proof</italic>
          </title>
          <p>For a specific cluster <italic>A</italic>, <italic>V</italic>(<italic>A</italic>) can be computed in <inline-formula id="IEq51"><alternatives><tex-math id="M111">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$O\left (|\mathcal {SBP}|*n^{2}k\right)$\end{document}</tex-math><mml:math id="M112"><mml:mi>O</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mo>|</mml:mo><mml:mi mathvariant="script">S</mml:mi><mml:mi mathvariant="script">ℬ</mml:mi><mml:mi mathvariant="script">P</mml:mi><mml:mo>|</mml:mo><mml:mo>∗</mml:mo><mml:msup><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mi>k</mml:mi></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="12864_2020_6519_Article_IEq51.gif"/></alternatives></inline-formula> time since at worst we need to look at every subtree-bipartition in <inline-formula id="IEq52"><alternatives><tex-math id="M113">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {SBP}$\end{document}</tex-math><mml:math id="M114"><mml:mi mathvariant="script">S</mml:mi><mml:mi mathvariant="script">ℬ</mml:mi><mml:mi mathvariant="script">P</mml:mi></mml:math><inline-graphic xlink:href="12864_2020_6519_Article_IEq52.gif"/></alternatives></inline-formula>, and computing <inline-formula id="IEq53"><alternatives><tex-math id="M115">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$TC_{\mathcal {G}}(x)$\end{document}</tex-math><mml:math id="M116"><mml:mi>T</mml:mi><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="script">G</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>x</mml:mi><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12864_2020_6519_Article_IEq53.gif"/></alternatives></inline-formula> takes <italic>O</italic>(<italic>n</italic><sup>2</sup><italic>k</italic>) time. Note that this is a conservative analysis since the number of subtree-bipartitions that the DP algorithm needs to consider for computing <italic>V</italic>(<italic>A</italic>) for a specific cluster <italic>A</italic> is, in reality, much less than <inline-formula id="IEq54"><alternatives><tex-math id="M117">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$|\mathcal {SBP}|$\end{document}</tex-math><mml:math id="M118"><mml:mo>|</mml:mo><mml:mi mathvariant="script">S</mml:mi><mml:mi mathvariant="script">ℬ</mml:mi><mml:mi mathvariant="script">P</mml:mi><mml:mo>|</mml:mo></mml:math><inline-graphic xlink:href="12864_2020_6519_Article_IEq54.gif"/></alternatives></inline-formula> (especially for <italic>A</italic> where <inline-formula id="IEq55"><alternatives><tex-math id="M119">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$|A| &lt; |\mathcal {X}|$\end{document}</tex-math><mml:math id="M120"><mml:mo>|</mml:mo><mml:mi>A</mml:mi><mml:mo>|</mml:mo><mml:mo>&lt;</mml:mo><mml:mo>|</mml:mo><mml:mi mathvariant="script">X</mml:mi><mml:mo>|</mml:mo></mml:math><inline-graphic xlink:href="12864_2020_6519_Article_IEq55.gif"/></alternatives></inline-formula>). There will be <inline-formula id="IEq56"><alternatives><tex-math id="M121">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$O(|\mathcal {SBP}|)$\end{document}</tex-math><mml:math id="M122"><mml:mi>O</mml:mi><mml:mo>(</mml:mo><mml:mo>|</mml:mo><mml:mi mathvariant="script">S</mml:mi><mml:mi mathvariant="script">ℬ</mml:mi><mml:mi mathvariant="script">P</mml:mi><mml:mo>|</mml:mo><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12864_2020_6519_Article_IEq56.gif"/></alternatives></inline-formula> possible clusters for which we need to compute <italic>V</italic>(<italic>A</italic>). Thus, the running time of STELAR is <inline-formula id="IEq57"><alternatives><tex-math id="M123">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$O\left (n^{2}k|\mathcal {SBP}|^{2}\right)$\end{document}</tex-math><mml:math id="M124"><mml:mi>O</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msup><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mi>k</mml:mi><mml:mo>|</mml:mo><mml:mi mathvariant="script">S</mml:mi><mml:mi mathvariant="script">ℬ</mml:mi><mml:mi mathvariant="script">P</mml:mi><mml:msup><mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="12864_2020_6519_Article_IEq57.gif"/></alternatives></inline-formula>. □</p>
        </sec>
      </sec>
    </sec>
    <sec id="Sec8">
      <title>Software implementation</title>
      <p>STELAR is a java based cross-platform application. STELAR code uses code from the PhyloNet package by Luay Nakhleh (bioinfo.cs.rice.edu/phylonet). The Phylonet code base was previously used by DynaDup [<xref ref-type="bibr" rid="CR35">35</xref>, <xref ref-type="bibr" rid="CR42">42</xref>] and ASTRAL (with permission from the authors), and STELAR is mostly based on the DynaDup code base.</p>
    </sec>
    <sec id="Sec9">
      <title>Experimental studies</title>
      <p>We compared STELAR with SuperTriplets, which is a very fast and highly accurate triplet based supertree technique and has been used in several important phylogenomic studies [<xref ref-type="bibr" rid="CR22">22</xref>–<xref ref-type="bibr" rid="CR27">27</xref>]. We also evaluated STELAR in comparison with ASTRAL-III [<xref ref-type="bibr" rid="CR43">43</xref>] and MP-EST, two of the most widely used and accurate coalescent-based methods. ASTRAL has already been compared and shown to outperform many of the existing species tree estimation methods (e.g., BUCKy-pop, MRP, greedy consensus, CA-ML, etc.), especially in the presence of moderate to high levels of ILS. So we did not include those methods in this study. Most of the datasets analyzed in this study are prohibitively large for *BEAST to analyze. We ran MP-EST with 10 random starting points and selected the species tree with the highest pseudo-likelihood value.</p>
      <p>We used previously studied simulated and biological datasets to evaluate the performance of these methods. We compared the estimated species trees to the model species tree (for the simulated datasets) or to the scientific literature (for the biological datasets), to evaluate accuracy. We used normalized Robinson-Foulds distance (RF rate) [<xref ref-type="bibr" rid="CR44">44</xref>] to measure the tree error. The RF distance between two trees is the sum of the bipartitions (splits) induced by one tree but not by the other, and vice versa. All the trees estimated by ASTRAL-III, STELAR and MP-EST in this study are binary and so RF rate, False Positive (FP) rate and False Negative (FN) rate are identical. However, the trees estimated by SuperTriplets may produce multifurcations (unresolved trees). We performed Wilcoxon signed-rank test (with <italic>α</italic>=0.05) to measure the statistical significance of the differences between two methods.</p>
      <sec id="Sec10">
        <title>Datasets</title>
        <p>We studied four collections of simulated datasets: one based on a biological dataset (37-taxon mammalian dataset) that was generated and subsequently analyzed in prior studies [<xref ref-type="bibr" rid="CR10">10</xref>, <xref ref-type="bibr" rid="CR29">29</xref>, <xref ref-type="bibr" rid="CR45">45</xref>], and three other simulated datasets from [<xref ref-type="bibr" rid="CR45">45</xref>], [<xref ref-type="bibr" rid="CR46">46</xref>], and [<xref ref-type="bibr" rid="CR47">47</xref>]. Table <xref rid="Tab1" ref-type="table">1</xref> presents a summary of the datasets analyzed in this paper, showing various model conditions with varying numbers of taxa (11 to 37), ILS levels (reflected in the average topological distance between true gene trees and true species tree) and gene sequence lengths. All datasets consist of gene sequence alignments generated under a multi-stage simulation process that begins with a species tree, simulates gene trees down the species tree under the multi-species coalescent model (and so can differ topologically from the species tree), and then simulates gene sequence alignments down the gene trees.
<table-wrap id="Tab1"><label>Table 1</label><caption><p>Properties of the simulated datasets. Level of ILS is presented in terms of the average topological distance between true gene trees and true species tree</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Dataset</th><th align="left">ILS level</th><th align="left"># genes</th><th align="left"># sites</th><th align="left"># Replicates</th><th align="left">Ref.</th></tr></thead><tbody><tr><td align="left">11-taxon</td><td align="left">85%</td><td align="left">5 - 100</td><td align="left">2000</td><td align="left">20</td><td align="left">[<xref ref-type="bibr" rid="CR46">46</xref>]</td></tr><tr><td align="left">15-taxon</td><td align="left">82%</td><td align="left">100 - 1000</td><td align="left">100 - 1000</td><td align="left">10</td><td align="left">[<xref ref-type="bibr" rid="CR45">45</xref>]</td></tr><tr><td align="left">37-taxon</td><td align="left">18%, 32%, 54%</td><td align="left">25 - 800</td><td align="left">250 -1000</td><td align="left">20</td><td align="left">[<xref ref-type="bibr" rid="CR45">45</xref>]</td></tr></tbody></table></table-wrap></p>
        <p>Mammalian dataset was simulated by taking the species tree estimated by MP-EST on the biological dataset studied in [<xref ref-type="bibr" rid="CR48">48</xref>]. This species tree had branch lengths in coalescent units, which we used to produce a set of gene trees under the coalescent model. Thus, the mammalian simulation model tree has an ILS level based on a coalescent analysis of the biological mammalian dataset, and other properties of the simulation that are set to reflect the biological sequences [<xref ref-type="bibr" rid="CR48">48</xref>] studied. We explored the impact of varying amounts of ILS, varying numbers of genes (25 ∼800), the impact of phylogenetic signal by varying the sequence length (250, 500, and 1000 base pair (bp)) for the markers. Three levels of ILS were simulated. The basic model species tree has branch lengths in coalescent units, and we produced other model species trees by multiplying or dividing all internal branch lengths in the model species tree by two. This rescaling varies the amount of ILS (shorter branches have more ILS), and also impacts the amount of gene tree estimation error in the estimated gene trees. The basic model condition with moderate amount of ILS is referred to as 1X and the model conditions with higher and lower amounts of ILS are denoted by 0.5X and 2X, respectively.</p>
        <p>We used three other simulated datasets: 11-taxon dataset (generated by [<xref ref-type="bibr" rid="CR46">46</xref>] and subsequently studied by [<xref ref-type="bibr" rid="CR9">9</xref>, <xref ref-type="bibr" rid="CR49">49</xref>]), 15-taxon dataset (generated and studied by [<xref ref-type="bibr" rid="CR45">45</xref>]), and 500-taxon dataset (generated and studied by ASTRAL-II [<xref ref-type="bibr" rid="CR47">47</xref>]). 11-taxon dataset was simulated under a complex process to ensure substantial heterogeneity between genes and to deviate from the molecular clock [<xref ref-type="bibr" rid="CR46">46</xref>]. We analyzed the model condition with high amount of ILS as the model condition with lower amount of ILS is very easy to analyze and even methods without any statistical guarantee produced highly accurate tree with just 25 ∼ 50 gene trees [<xref ref-type="bibr" rid="CR9">9</xref>]. 15-taxon datasets vary in sequence lengths and has high amount of ILS. The 500-taxon dataset was generated under the MSC model by introducing rate heterogeneity between genes and deviations from molecular clock (see [<xref ref-type="bibr" rid="CR47">47</xref>] for more details).</p>
        <p>We used two biological datasets: the 37-taxon mammalian datasets studied by [<xref ref-type="bibr" rid="CR48">48</xref>] with 424 genes, and the Amniota dataset from [<xref ref-type="bibr" rid="CR50">50</xref>] containing 16 species and 248 genes.</p>
      </sec>
    </sec>
  </sec>
  <sec id="Sec11" sec-type="results">
    <title>Results</title>
    <sec id="Sec12">
      <title>Results on mammalian simulated dataset</title>
      <p>We analyzed the performance of SuperTriplets, ASTRAL-III, MP-EST and STELAR on various model conditions with varying amounts of ILS, numbers of genes and lengths of the sequences. Figure <xref rid="Fig2" ref-type="fig">2</xref>a shows the average RF rates of three methods on three model conditions with varying amounts of ILS. For all methods, RF rates increase as we increase the amount of ILS. SuperTriplets produced significantly less accurate trees than the other methods, and the trees are not fully resolved. For the dataset with varying amounts of ILS, SuperTriplets produced trees with RF rates 10% ∼18%, whereas the error rates of STELAR, MP-EST and ASTRAL-III range from 4% ∼ 6%. STELAR and ASTRAL-III are better than MP-EST on all amounts of ILS and, in some cases, the differences are statistically significant (<italic>P</italic>&lt;0.05). STELAR and ASTRAL are comparable in terms of tree accuracy and no statistically significant difference was noticed.
<fig id="Fig2"><label>Fig. 2</label><caption><p>Comparison of ASTRAL-III, MP-EST, STELAR and SuperTriplets on 37-taxon simulated mammalian dataset. We show the average RF rates with standard error bars over 20 replicates. <bold>a</bold> We fixed the sequence length to 500 bp and number of genes to 200, and varied the amounts of ILS. 2X model condition contains the lowest amount of ILS while 0.5X refers to the model condition with the highest amount of ILS. <bold>b</bold> We varied the amount of gene tree estimation error by varying the sequence lengths from 250 to 1000 bp, while keeping the ILS level (moderate) and the number of genes (200) fixed. <bold>c</bold> We fixed the sequence length to 500 bp and amount of ILS to 1X, and varied the numbers of genes (25, 50, 100, 200, 400, 800)</p></caption><graphic xlink:href="12864_2020_6519_Fig2_HTML" id="MO2"/></fig></p>
      <p>Figure <xref rid="Fig2" ref-type="fig">2</xref>c shows the impact of the numbers of gene trees on the accuracy of the estimated species trees. STELAR, MP-EST and ASTRAL-III improved with increasing numbers of genes (this is expected as these methods are statistically consistent and thus increasing the numbers of genes has resulted into improved topological accuracy). However, SuperTriplets failed to leverage the increasing amount of data since it did not improve as we increased the numbers of genes. Moreover, even with 800 genes, SuperTriplets produced unresolved trees. STELAR and ASTRAL-III achieved similar accuracy and performed significantly better than MP-EST and SuperTriplets across all model conditions.</p>
    </sec>
    <sec id="Sec13">
      <title>Results on 11-taxon dataset</title>
      <p>We analyzed both the estimated and true gene trees. In both cases, we varied the number of genes from (5 ∼ 100). Figure <xref rid="Fig3" ref-type="fig">3</xref> shows the results on 11-taxon dataset for both estimated and true gene trees. Similar to the mammalian dataset, SuperTriplets produced the least accurate trees. As expected, all methods improved with increased numbers of genes (except for a few cases for SuperTriplets), and had their best accuracies on true gene trees. The accuracies of ASTRAL-III, MP-EST and STELAR are almost similar with no statistically significant difference. On true gene trees, ASTRAL, MP-EST and STELAR recovered the true species trees across all the replicates with 50 or higher numbers of genes. However, the accuracy of SuperTriplets did not achieve any notable improvement as we increased the number of genes beyond 25. Unlike mammalian dataset, MP-EST was slightly better than ASTRAL-III and STELAR on a couple of model conditions (albeit the differences are not statistically significant with <italic>P</italic>-values greater than 0.05).
<fig id="Fig3"><label>Fig. 3</label><caption><p>Average RF rates of ASTRAL-III, MP-EST, STELAR and SuperTriplets on the 11-taxon dataset with high amount of ILS. We varied the numbers of genes from 5 to 100. We analyzed both the estimated and true gene trees. We show the average RF rates with standard error bars over 20 replicates</p></caption><graphic xlink:href="12864_2020_6519_Fig3_HTML" id="MO3"/></fig></p>
    </sec>
    <sec id="Sec14">
      <title>Results on 15-taxon dataset</title>
      <p>15-taxon dataset evolved under a caterpillar model species tree with very high level of ILS [<xref ref-type="bibr" rid="CR45">45</xref>]. We explored the performance on varying sequence lengths (100 bp and 1000 bp), and numbers of genes (100 and 1000). Unlike other two dataset, SuperTriplets returned well resolved trees without multi-furcations and matched the accuracy of other methods on this particular dataset. All the methods improved as the the number of genes and sequence length increased, and had their best accuracy (RF rate =0) on true gene trees (Fig. <xref rid="Fig4" ref-type="fig">4</xref>). No statistically significant difference was observed between STELAR and ASTRAL-III. MP-EST consistently had the highest error rates across all the model conditions on estimated gene trees. On true gene trees, all the methods returned the true species tree on almost all the replicates.
<fig id="Fig4"><label>Fig. 4</label><caption><p>Comparison of ASTRAL-III, MP-EST, STELAR and SuperTriplets on the 15-taxon dataset. We varied the numbers of estimated gene trees (100 and 1000) and sequence lengths (100 bp and 1000 bp). We also analyzed the true gene trees. We show the average RF rates with standard errors over 10 replicates</p></caption><graphic xlink:href="12864_2020_6519_Fig4_HTML" id="MO4"/></fig></p>
    </sec>
    <sec id="Sec15">
      <title>Results on 500-taxon dataset</title>
      <p>In order to assess the performance of STELAR on relatively larger datasets, we analyzed the 500-taxon dataset [<xref ref-type="bibr" rid="CR47">47</xref>] with 1000 genes. We analyzed 10 replicates of data. Some of the replicates had a few non-binary gene trees which we discarded in order to run STELAR. After removing the non-binary gene trees, the numbers of genes in the replicates range from 993∼1000. MP-EST is computationally too demanding to run on this large dataset. Figure <xref rid="Fig5" ref-type="fig">5</xref> shows the error rates of STELAR, ASTRAL-III and SuperTriplets. Both STELAR and ASTRAL produced competitive results with no statistically significant difference. However, similar to the other dataset analyzed in this study, SuperTriplets was much worse than ASTRAL-III and STELAR.
<fig id="Fig5"><label>Fig. 5</label><caption><p>Comparison of ASTRAL-III, MP-EST, STELAR and SuperTriplets on 500-taxon dataset. We show the average RF rates with standard errors over 10 replicates</p></caption><graphic xlink:href="12864_2020_6519_Fig5_HTML" id="MO5"/></fig></p>
    </sec>
    <sec id="Sec16">
      <title>Results on biological datasets</title>
      <p><italic>Amniota dataset:</italic> We analyzed the Amniota dataset from [<xref ref-type="bibr" rid="CR50">50</xref>] containing 248 genes across 16 amniota taxa in order to resolve the position of turtles within the amniotes, especially relative to birds and crocodiles. We re-analyzed both the amino acid (AA) and DNA gene trees, obtained from the authors, using ASTRAL, MP-EST, STELAR and SuperTriplets. The sister relationship of crocodiles and birds (forming Archosaurs), and placement of the turtles as the sister clade to Archosaurs are considered reliable and were supported by previous studies [<xref ref-type="bibr" rid="CR51">51</xref>–<xref ref-type="bibr" rid="CR53">53</xref>].</p>
      <p>For amino acid dataset, all the methods placed birds and crocodiles as sister groups (forming Archosaurs) and turtles as sister to Archosaurs clade (see Fig. <xref rid="Fig6" ref-type="fig">6</xref>). The unrooted version of STELAR estimated tree is identical to ASTRAL. MP-EST also returned a highly similar tree except for different resolutions within the turtles. SuperTriplets produced an unresolved tree with several multifurcations, leaving bird/turtle/crocodile relationship uncertain. It also did not resolve the Squamates clade.
<fig id="Fig6"><label>Fig. 6</label><caption><p>Analyses of the Amniota dataset (both DNA and AA gene trees) using STELAR, ASTRAL, MP-EST and SuperTriplets. We show the rooted version of the ASTRAL estimated trees using the outgroup (<italic>Protopterus annectens</italic>)</p></caption><graphic xlink:href="12864_2020_6519_Fig6_HTML" id="MO6"/></fig></p>
      <p>STELAR and MP-EST on the DNA gene trees produced the same tree which resolved bird/turtle/crocodile relationship as (birds,(turtles,crocodiles)) and thus did not form Archosaurs. However, ASTRAL on the DNA gene trees resolved the relationships as (turtles,(birds,crocodiles)). Therefore, maximizing triplet agreement and quartet agreement both recovered the (birds,(turtles,crocodiles)) relationships on AA gene trees, but differed on the DNA gene trees. Similar to the AA dataset, SuperTriplets did not resolve the bird/turtle/crocodile relationship. We estimated the quartet scores and the triplet scores of these different tree topologies with respect to the corresponding gene trees (see Tables <xref rid="Tab2" ref-type="table">2</xref> and <xref rid="Tab3" ref-type="table">3</xref>). As ASTRAL estimated trees need to be interpreted as unrooted trees, we root the ASTRAL trees using the correct outgroup (<italic>Protopterus annectens</italic>) in order to compute the triplet scores. As expected, ASTRAL achieved the highest quartet agreement scores and STELAR achieved the highest triplet agreement scores.
<table-wrap id="Tab2"><label>Table 2</label><caption><p>Triplet and quartet scores of the species trees estimated by ASTRAL, MP-EST, SuperTriplets and STELAR on the amino acid (AA) gene trees in Amniota dataset</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Tool</th><th align="left">Triplet score</th><th align="left">Quartet score</th></tr></thead><tbody><tr><td align="left">ASTRAL</td><td align="left">38394</td><td align="left">83604</td></tr><tr><td align="left">MP-EST</td><td align="left">38385</td><td align="left">83532</td></tr><tr><td align="left">SuperTriplets</td><td align="left">31793</td><td align="left">70499</td></tr><tr><td align="left">STELAR</td><td align="left">38394</td><td align="left">83604</td></tr></tbody></table></table-wrap>
<table-wrap id="Tab3"><label>Table 3</label><caption><p>Triplet and quartet scores of the species trees estimated by ASTRAL, MP-EST, SuperTriplets and STELAR on the DNA gene trees in Amniota dataset</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Tool</th><th align="left">Triplet score</th><th align="left">Quartet score</th></tr></thead><tbody><tr><td align="left">ASTRAL</td><td align="left">42419</td><td align="left">97890</td></tr><tr><td align="left">MP-EST</td><td align="left">42448</td><td align="left">97744</td></tr><tr><td align="left">SuperTriplets</td><td align="left">40095</td><td align="left">94121</td></tr><tr><td align="left">STELAR</td><td align="left">42448</td><td align="left">97744</td></tr></tbody></table></table-wrap></p>
      <p><italic>Mammalian dataset:</italic> We re-analyzed the mammalian dataset from [<xref ref-type="bibr" rid="CR48">48</xref>] containing 447 genes across 37 mammals after removing 21 mislabeled genes (confirmed by the authors), and two other outlier genes. The placement of tree shrews (<italic>Tupaia belangeri</italic>) is of great importance here as previous studies found that the phylogenetic placement of tree shrews is unstable as they can be classified as a sister group to Primates or to Glires [<xref ref-type="bibr" rid="CR48">48</xref>, <xref ref-type="bibr" rid="CR54">54</xref>–<xref ref-type="bibr" rid="CR56">56</xref>]. Our analyses using ASTRAL, MP-EST and STELAR recovered the same topology which placed tree shrews as sister to Glires (see Fig. <xref rid="Fig7" ref-type="fig">7</xref>). This is consistent to the tree estimated by CA-ML (reported in [<xref ref-type="bibr" rid="CR48">48</xref>]). However, previous studies with MP-EST, using multi-locus bootstrapping [<xref ref-type="bibr" rid="CR57">57</xref>], on the same dataset recovered a tree which placed tree shrews as the sister to Primates [<xref ref-type="bibr" rid="CR10">10</xref>, <xref ref-type="bibr" rid="CR56">56</xref>]. SuperTriplets produced a highly similar tree except that it resulted into an unresolved tree with several multi-furcations. It recovered the major clades such as Primates, Glires, Cetartiodactyla, Eulipotyphla, Chiroptera. However, SuperTriplets left the relationships within Primates/Glires/Scandentia unresolved. This is in line with the tree estimated by SuperTriplets on the OrthoMaM database [<xref ref-type="bibr" rid="CR58">58</xref>], which was reported in [<xref ref-type="bibr" rid="CR22">22</xref>]. We investigated the quartet and triplet scores of the two alternative hypotheses (regarding the placement of tree shrew) and found that the tree that suggests (tree shrew, Glires) clade has higher quartet and triplet scores (25526915 and 3042547, respectively) compared to the one that suggests (tree shrew, Primates) relationship which yields 25511503 and 3041747 quartet and triplet scores respectively. Therefore, our analyses strongly support the placement of tree shrews as sister to Glires.
<fig id="Fig7"><label>Fig. 7</label><caption><p>Analyses of the mammalian dataset using STELAR, ASTRAL, MP-EST and SuperTriplets</p></caption><graphic xlink:href="12864_2020_6519_Fig7_HTML" id="MO7"/></fig></p>
      <sec id="Sec17">
        <title>Running time</title>
        <p>We performed the experiments on small- to moderate-scale dataset (11 ∼ 37 taxa) on a Linux machine with 7.5 GiB RAM and an i5 1.6 GHz processor. For the 500-taxon dataset, we used a Linux machine with 15.6 GiB RAM and an i7 3.60 GHz processor. Our experiments show that SuperTriplets is usually significantly faster than the other methods, and MP-EST is computationally more demanding than the others. For 11-, 15-, and 37-taxon datasets, SuperTriplets took a fraction of a second to run on a single replicate. STELAR and ASTRAL-III are substantially faster than MP-EST. The running time of MP-EST is more sensitive to the number of species than the number of genes, and grows rapidly as we increase the number of taxa [<xref ref-type="bibr" rid="CR29">29</xref>]. On 37-taxon simulated dataset with 200 genes (moderate ILS), SuperTriplets took around half a second, both ASTRAL-III and STELAR took around 4 s whereas MP-EST (with 10 random starting points) took 3300 s (55 min). Running time of all these methods (except for SuperTriplets) increased with increasing amounts of ILS. On 37-taxon, 0.5X dataset (high ILS) with 200 genes, ASTRAL-III took around 10 s, STELAR took 15 s and MP-EST took 4800 s (80 min). This is because the numbers of distinct quartets and triplets in the gene trees increase as we increase the amount of discordance among the gene trees. When we increased the numbers of genes from 200 to 800 in 1X model condition, the running times of ASTRAL-III and STELAR increased from 4 s to 10 and 12 s respectively, whereas SuperTriplets took only 0.8 s. MP-EST took about 55 min and thus was not affected by the increased number of genes. On 11-taxon dataset, we ran the exact versions of ASTRAL-III and STELAR, and yet the running time is much less than MP-EST. Exact versions of ASTRAL-III and STELAR finished in less than a second on 5∼50 genes and less than two seconds on 50∼100 genes, whereas the running times of MP-EST range from 13 to 20 s. SuperTriplets took only 0.1 s irrespective of the numbers of genes. For 15-taxon dataset, MP-EST took 90∼100 s. ASTRAL-III and STELAR finished in less than 2 s on 100 gene dataset, and for 1000 genes they took about 50 and 80 s, respectively. The running time of SuperTriplets did not vary much with the change in the number of genes and finished in only around 0.4 s.</p>
        <p>There is no significant difference in running time between ASTRAL-III and STELAR on relatively smaller datasets. However, on the larger dataset with 500 taxa, ASTRAL-III is much faster than STELAR. ASTRAL-III took around 18 min whereas STELAR took about 2 h. Interestingly, SuperTriplets – which is much faster than ASTRAL-III and STELAR on relatively smaller datasets – is not the fastest on 500-taxon dataset, taking around 26 min. ASTRAL has evolved over the years (ASTRAL [<xref ref-type="bibr" rid="CR10">10</xref>], ASTRAL-II [<xref ref-type="bibr" rid="CR47">47</xref>], ASTRAL-III [<xref ref-type="bibr" rid="CR43">43</xref>], etc.) with efficient heuristics to explore the tree space and highly optimized implementation. Although STELAR is not as fast as ASTRAL at its current form, it is sufficiently fast to analyze large dataset with hundreds of taxa. We will continue to improve STELAR to make it fast enough to run on ultra large dataset with thousands of taxa.</p>
      </sec>
    </sec>
  </sec>
  <sec id="Sec18" sec-type="discussion">
    <title>Discussion</title>
    <p>Extensive experimental studies on simulated dataset with varying model conditions suggest that STELAR, which is an efficient DP-based algorithm for solving the triplet consistency problem, can produce substantially better trees than SuperTriplets (which is a triplet-based supertree method and tries to find a median supertree with respect to a triplet dissimilarity measure), and MP-EST (which tries to maximize a pseudo-likelihood measure based on the triplet distribution of the gene trees). Thus, within the scope of the experiments conducted in this study, maximum triplet agreement has been shown to be a better optimization criterion than the triplet frequency based maximum pseudo-likelihood used in MP-EST, and the triplet dissimilarity based maximum parsimony criterion used in SuperTriplets, and as good as the maximum quartet agreement criterion used in ASTRAL. Experiments on Amniota and mammalian biological dataset suggest that STELAR can produce reliable trees on real biological dataset.</p>
    <p>Most of the existing methods have assumed that the gene tree discordance is due to only a particular biological reason, for example, ILS. Therefore, both orthologs and paralogs are not being included in many studies such as 1KP project [<xref ref-type="bibr" rid="CR59">59</xref>], where many genes were discarded that evolved with duplications and losses. Furthermore, existing methods try to optimize a single optimization criterion (e.g., quartet consistency [<xref ref-type="bibr" rid="CR10">10</xref>], and pseudo-likelihood [<xref ref-type="bibr" rid="CR11">11</xref>]). Although these criteria are statistically consistent, the performance of various methods may vary on practical model conditions with limited numbers of genes and in the presence of gene tree estimation error. These factors underscore the need for modeling species tree estimation as a multi-objective optimization problem, where multiple explanations for observed data can be conjectured, and multiple optimization criteria are simultaneously optimized. Therefore, developing new scalable and statistically consistent estimators of species trees is of great importance. We believe this study advances the state-of-the-art in summary methods, and STELAR would be considered as a useful tool in phylogenomics.</p>
    <p>STELAR can consistently estimate the species tree topology and is fast enough to handle large numbers of genes and species, making it suitable for large scale phylogenomic analyses. However, STELAR can be expanded in several directions. Future work will need to investigate how the estimation of branch lengths (in coalescent unit) can be incorporated in STELAR. STELAR, at this stage, cannot handle unrooted and non-binary gene trees. The CTC problem for unrooted gene trees can be formulated as follows. The input is a set <inline-formula id="IEq58"><alternatives><tex-math id="M125">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {G} = \{gt_{1}, gt_{2}, gt_{3}, \ldots, gt_{k}\}$\end{document}</tex-math><mml:math id="M126"><mml:mi mathvariant="script">G</mml:mi><mml:mo>=</mml:mo><mml:mo>{</mml:mo><mml:mi>g</mml:mi><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>g</mml:mi><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>g</mml:mi><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>g</mml:mi><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>}</mml:mo></mml:math><inline-graphic xlink:href="12864_2020_6519_Article_IEq58.gif"/></alternatives></inline-formula> of <italic>k</italic> unrooted gene trees, and the output is a species tree <italic>ST</italic> that maximizes the triplet consistency score with respect to a set <inline-formula id="IEq59"><alternatives><tex-math id="M127">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {G'} = \{gt'_{1}, gt'_{2}, gt'_{3}, \ldots, gt'_{k}\}$\end{document}</tex-math><mml:math id="M128"><mml:msup><mml:mrow><mml:mi mathvariant="script">G</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mo>{</mml:mo><mml:mi>g</mml:mi><mml:msubsup><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mi>g</mml:mi><mml:msubsup><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mi>g</mml:mi><mml:msubsup><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>g</mml:mi><mml:msubsup><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msubsup><mml:mo>}</mml:mo></mml:math><inline-graphic xlink:href="12864_2020_6519_Article_IEq59.gif"/></alternatives></inline-formula> where <inline-formula id="IEq60"><alternatives><tex-math id="M129">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$gt^{\prime }_{i}$\end{document}</tex-math><mml:math id="M130"><mml:mi>g</mml:mi><mml:msubsup><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12864_2020_6519_Article_IEq60.gif"/></alternatives></inline-formula> is a rooted version of <italic>g</italic><italic>t</italic><sub><italic>i</italic></sub>. That means, the idea is to find the optimal rooted versions of the unrooted gene trees so that the triplet agreement is maximized. Similar approach was previously applied [<xref ref-type="bibr" rid="CR41">41</xref>] for estimating species trees from a set of unrooted gene trees by minimizing “extra lineages” resulting from deep coalescence. Similarly, the problem can be extended for non-binary gene trees as well. Thus, future works on formalizing the CTC problem for unrooted and non-binary gene trees and developing appropriate algorithms will be of great importance. The current version of STELAR is reasonably fast and can handle hundreds of taxa. However, more efficient algorithms and implementation are required to make STELAR scalable to much larger dataset with thousands of taxa. Furthermore, while we have studied various practical and challenging model conditions with varying numbers of genes, and varying amounts of ILS, and gene tree estimation error, future work should investigate the relative performance of STELAR and the widely used existing methods on various other challenging model conditions, for example, model conditions with missing taxa (i.e., incomplete gene trees). This study investigated relatively long sequences (250 ∼2000 bp); subsequent studies should investigate the relative performance of STELAR and other methods on very short sequences, since recombination-free loci can be very short [<xref ref-type="bibr" rid="CR60">60</xref>].</p>
  </sec>
  <sec id="Sec19" sec-type="conclusion">
    <title>Conclusions</title>
    <p>We developed STELAR – a method for estimating species trees from a set of estimated gene trees which is statistically consistent under the multi-species coalescent model. We formalized the constrained triplet consensus (CTC) problem and showed that the solution to the CTC problem is a statistically consistent estimator of the species tree under the MSC model. STELAR is a dynamic programming solution to the CTC problem. STELAR has an exact version (which provides the exact solution and takes exponential amount of time) as well as an efficient polynomial time heuristic version. Considering the high accuracy and scalability, we believe STELAR will be considered as a potential tool for constructing species phylogenies from genes sampled throughout the whole genome.</p>
  </sec>
  <sec id="Sec20">
    <title>Availability and requirements</title>
    <p><bold>Project name</bold>: STELAR<bold>Project home page</bold>: <ext-link ext-link-type="uri" xlink:href="https://islamazhar.github.io/STELAR/">https://islamazhar.github.io/STELAR/</ext-link><bold>Operating system(s)</bold>: Platform independent<bold>Programming language</bold>: Java<bold>Other requirements</bold>: Java 9.0 or higher<bold>License</bold>: Apache License 2.0<bold>Any restrictions to use by non-academics</bold>: Not applicable.</p>
  </sec>
</body>
<back>
  <glossary>
    <title>Abbreviations</title>
    <def-list>
      <def-item>
        <term>CTC</term>
        <def>
          <p>Constrained triplet consensus</p>
        </def>
      </def-item>
      <def-item>
        <term>DP</term>
        <def>
          <p>Dynamic programming</p>
        </def>
      </def-item>
      <def-item>
        <term>ILS</term>
        <def>
          <p>Incomplete lineage sorting</p>
        </def>
      </def-item>
      <def-item>
        <term>MSC</term>
        <def>
          <p>Multi-species coalescent</p>
        </def>
      </def-item>
      <def-item>
        <term>SBP</term>
        <def>
          <p>Subtree-bipartition</p>
        </def>
      </def-item>
    </def-list>
  </glossary>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher’s Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
    <fn>
      <p>Kowshika Sarker and Trisha Das contributed equally to this work.</p>
    </fn>
  </fn-group>
  <ack>
    <title>Acknowledgements</title>
    <p>Not applicable.</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Authors’ contributions</title>
    <p>MSB and RR conceived and designed the study; MI, KS and TD implemented STELAR; KS, TD, MI, MSB and RR proved the theoretical results; MI, KS and TD performed the experiments; MSB, KS, TD and MI wrote the first draft and all the authors took part in finalizing the manuscript. All authors read and approved the final manuscript.</p>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>The authors received no financial support for this research.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and materials</title>
    <p>STELAR is freely available as an open source software at <ext-link ext-link-type="uri" xlink:href="https://islamazhar.github.io/STELAR/">https://islamazhar.github.io/STELAR/</ext-link>. All the dataset analyzed in this paper are from previously published studies and are publicly available.</p>
  </notes>
  <notes>
    <title>Ethics approval and consent to participate</title>
    <p>Not applicable.</p>
  </notes>
  <notes>
    <title>Consent for publication</title>
    <p>Not applicable.</p>
  </notes>
  <notes notes-type="COI-statement">
    <title>Competing interests</title>
    <p>The authors declare that they have no competing interests.</p>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Maddison</surname>
            <given-names>WP</given-names>
          </name>
        </person-group>
        <article-title>Gene trees in species trees</article-title>
        <source>Syst Biol</source>
        <year>1997</year>
        <volume>46</volume>
        <fpage>523</fpage>
        <lpage>36</lpage>
        <pub-id pub-id-type="doi">10.1093/sysbio/46.3.523</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Roch</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Steel</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Likelihood-based tree reconstruction on a concatenation of aligned sequence data sets can be statistically inconsistent</article-title>
        <source>Theor Popul Biol</source>
        <year>2015</year>
        <volume>100</volume>
        <fpage>56</fpage>
        <lpage>62</lpage>
        <pub-id pub-id-type="doi">10.1016/j.tpb.2014.12.005</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kubatko</surname>
            <given-names>LS</given-names>
          </name>
          <name>
            <surname>Degnan</surname>
            <given-names>JH</given-names>
          </name>
        </person-group>
        <article-title>Inconsistency of phylogenetic estimates from concatenated data under coalescence</article-title>
        <source>Syst Biol</source>
        <year>2007</year>
        <volume>56</volume>
        <fpage>17</fpage>
        <pub-id pub-id-type="doi">10.1080/10635150601146041</pub-id>
        <?supplied-pmid 17366134?>
        <pub-id pub-id-type="pmid">17366134</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Edwards</surname>
            <given-names>SV</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Pearl</surname>
            <given-names>DK</given-names>
          </name>
        </person-group>
        <article-title>High-resolution species trees without concatenation</article-title>
        <source>Proc Nat Acad Sci</source>
        <year>2007</year>
        <volume>104</volume>
        <issue>14</issue>
        <fpage>5936</fpage>
        <lpage>41</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.0607004104</pub-id>
        <?supplied-pmid 17392434?>
        <pub-id pub-id-type="pmid">17392434</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Leaché</surname>
            <given-names>AD</given-names>
          </name>
          <name>
            <surname>Rannala</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <article-title>The accuracy of species tree estimation under simulation: a comparisonof methods</article-title>
        <source>Syst Biol</source>
        <year>2011</year>
        <volume>60</volume>
        <issue>2</issue>
        <fpage>126</fpage>
        <lpage>37</lpage>
        <pub-id pub-id-type="doi">10.1093/sysbio/syq073</pub-id>
        <?supplied-pmid 21088009?>
        <pub-id pub-id-type="pmid">21088009</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>DeGiorgio</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Degnan</surname>
            <given-names>JH</given-names>
          </name>
        </person-group>
        <article-title>Fast and consistent estimation of species trees using supermatrix rooted triples</article-title>
        <source>Mol Biol Evol</source>
        <year>2009</year>
        <volume>27</volume>
        <issue>3</issue>
        <fpage>552</fpage>
        <lpage>69</lpage>
        <pub-id pub-id-type="doi">10.1093/molbev/msp250</pub-id>
        <?supplied-pmid 19833741?>
        <pub-id pub-id-type="pmid">19833741</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kingman</surname>
            <given-names>JFC</given-names>
          </name>
        </person-group>
        <article-title>The coalescent</article-title>
        <source>Stoch Proc Appl</source>
        <year>1982</year>
        <volume>13</volume>
        <fpage>235</fpage>
        <lpage>48</lpage>
        <pub-id pub-id-type="doi">10.1016/0304-4149(82)90011-4</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jarvis</surname>
            <given-names>ED</given-names>
          </name>
          <name>
            <surname>Mirarab</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Aberer</surname>
            <given-names>AJ</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Houde</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Ho</surname>
            <given-names>SY</given-names>
          </name>
          <name>
            <surname>Faircloth</surname>
            <given-names>BC</given-names>
          </name>
          <name>
            <surname>Nabholz</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Howard</surname>
            <given-names>JT</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Whole-genome analyses resolve early branches in the tree of life of modern birds</article-title>
        <source>Science</source>
        <year>2014</year>
        <volume>346</volume>
        <issue>6215</issue>
        <fpage>1320</fpage>
        <lpage>31</lpage>
        <pub-id pub-id-type="doi">10.1126/science.1253451</pub-id>
        <?supplied-pmid 25504713?>
        <pub-id pub-id-type="pmid">25504713</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bayzid</surname>
            <given-names>MS</given-names>
          </name>
          <name>
            <surname>Warnow</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>Naive binning improves phylogenomic analyses</article-title>
        <source>Bioinformatics</source>
        <year>2013</year>
        <volume>29</volume>
        <issue>18</issue>
        <fpage>2277</fpage>
        <lpage>84</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btt394</pub-id>
        <?supplied-pmid 23842808?>
        <pub-id pub-id-type="pmid">23842808</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mirarab</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Reaz</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Bayzid</surname>
            <given-names>MS</given-names>
          </name>
          <name>
            <surname>Zimmermann</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Swenson</surname>
            <given-names>MS</given-names>
          </name>
          <name>
            <surname>Warnow</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>ASTRAL: genome-scale coalescent-based species tree estimation</article-title>
        <source>Bioinformatics</source>
        <year>2014</year>
        <volume>30</volume>
        <issue>17</issue>
        <fpage>541</fpage>
        <lpage>8</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btu462</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Liu</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Yu</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Edwards</surname>
            <given-names>SV</given-names>
          </name>
        </person-group>
        <article-title>A maximum pseudo-likelihood approach for estimating species trees under the coalescent model</article-title>
        <source>BMC Evol Biol</source>
        <year>2010</year>
        <volume>10</volume>
        <issue>1</issue>
        <fpage>302</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2148-10-302</pub-id>
        <?supplied-pmid 20937096?>
        <pub-id pub-id-type="pmid">20937096</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Heled</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Drummond</surname>
            <given-names>A. J.</given-names>
          </name>
        </person-group>
        <article-title>Bayesian inference of species trees from multilocus data</article-title>
        <source>Mol Biol Evol</source>
        <year>2010</year>
        <volume>27</volume>
        <fpage>570</fpage>
        <lpage>80</lpage>
        <pub-id pub-id-type="doi">10.1093/molbev/msp274</pub-id>
        <?supplied-pmid 19906793?>
        <pub-id pub-id-type="pmid">19906793</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Liu</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Yu</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <article-title>Estimating species trees from unrooted gene trees</article-title>
        <source>Syst Biol</source>
        <year>2011</year>
        <volume>60</volume>
        <issue>5</issue>
        <fpage>661</fpage>
        <lpage>7</lpage>
        <pub-id pub-id-type="doi">10.1093/sysbio/syr027</pub-id>
        <?supplied-pmid 21447481?>
        <pub-id pub-id-type="pmid">21447481</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Larget</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Kotha</surname>
            <given-names>SK</given-names>
          </name>
          <name>
            <surname>Dewey</surname>
            <given-names>CN</given-names>
          </name>
          <name>
            <surname>Ané</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>BUCKy: Gene tree/species tree reconciliation with the Bayesian concordance analysis</article-title>
        <source>Bioinf</source>
        <year>2010</year>
        <volume>26</volume>
        <issue>22</issue>
        <fpage>2910</fpage>
        <lpage>1</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btq539</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mossel</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Roch</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Incomplete lineage sorting: consistent phylogeny estimation from multiple loci</article-title>
        <source>IEEE Comp Biol Bioinform</source>
        <year>2011</year>
        <volume>7</volume>
        <issue>1</issue>
        <fpage>166</fpage>
        <lpage>71</lpage>
        <pub-id pub-id-type="doi">10.1109/TCBB.2008.66</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kubatko</surname>
            <given-names>LS</given-names>
          </name>
          <name>
            <surname>Carstens</surname>
            <given-names>BC</given-names>
          </name>
          <name>
            <surname>Knowles</surname>
            <given-names>LL</given-names>
          </name>
        </person-group>
        <article-title>Stem: Species tree estimation using maximum likelihood for gene trees under coalescence</article-title>
        <source>Bioinf</source>
        <year>2009</year>
        <volume>25</volume>
        <fpage>971</fpage>
        <lpage>3</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btp079</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bryant</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Bouckaert</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Felsenstein</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Rosenberg</surname>
            <given-names>NA</given-names>
          </name>
          <name>
            <surname>RoyChoudhury</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Inferring species trees directly from biallelic genetic markers: bypassing gene trees in a full coalescent analysis</article-title>
        <source>Mol Biol Evol</source>
        <year>2012</year>
        <volume>29</volume>
        <issue>8</issue>
        <fpage>1917</fpage>
        <lpage>32</lpage>
        <pub-id pub-id-type="doi">10.1093/molbev/mss086</pub-id>
        <?supplied-pmid 22422763?>
        <pub-id pub-id-type="pmid">22422763</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chifman</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Kubatko</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <article-title>Quartet inference from snp data under the coalescent model</article-title>
        <source>Bioinformatics</source>
        <year>2014</year>
        <volume>30</volume>
        <issue>23</issue>
        <fpage>3317</fpage>
        <lpage>24</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btu530</pub-id>
        <?supplied-pmid 4296144?>
        <pub-id pub-id-type="pmid">25104814</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Liu</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Yu</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Pearl</surname>
            <given-names>DK</given-names>
          </name>
          <name>
            <surname>Edwards</surname>
            <given-names>SV</given-names>
          </name>
        </person-group>
        <article-title>Estimating species phylogenies using coalescence times among sequences</article-title>
        <source>Syst Biol</source>
        <year>2009</year>
        <volume>58</volume>
        <issue>5</issue>
        <fpage>468</fpage>
        <lpage>77</lpage>
        <pub-id pub-id-type="doi">10.1093/sysbio/syp031</pub-id>
        <?supplied-pmid 20525601?>
        <pub-id pub-id-type="pmid">20525601</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Vachaspati</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Warnow</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>Astrid: accurate species trees from internode distances</article-title>
        <source>BMC Genomics</source>
        <year>2015</year>
        <volume>16</volume>
        <issue>10</issue>
        <fpage>3</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2164-16-S10-S3</pub-id>
        <pub-id pub-id-type="pmid">25649116</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Smith</surname>
            <given-names>BT</given-names>
          </name>
          <name>
            <surname>Harvey</surname>
            <given-names>MG</given-names>
          </name>
          <name>
            <surname>Faircloth</surname>
            <given-names>BC</given-names>
          </name>
          <name>
            <surname>Glenn</surname>
            <given-names>TC</given-names>
          </name>
          <name>
            <surname>Brumfield</surname>
            <given-names>RT</given-names>
          </name>
        </person-group>
        <article-title>Target capture and massively parallel sequencing of ultraconserved elements for comparative studies at shallow evolutionary time scales</article-title>
        <source>Syst Biol</source>
        <year>2013</year>
        <volume>63</volume>
        <issue>1</issue>
        <fpage>83</fpage>
        <lpage>95</lpage>
        <pub-id pub-id-type="doi">10.1093/sysbio/syt061</pub-id>
        <?supplied-pmid 24021724?>
        <pub-id pub-id-type="pmid">24021724</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ranwez</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Criscuolo</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Douzery</surname>
            <given-names>EJ</given-names>
          </name>
        </person-group>
        <article-title>Supertriplets: a triplet-based supertree approach to phylogenomics</article-title>
        <source>Bioinformatics</source>
        <year>2010</year>
        <volume>26</volume>
        <issue>12</issue>
        <fpage>115</fpage>
        <lpage>23</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btq196</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Romiguier</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Ranwez</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Delsuc</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Galtier</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Douzery</surname>
            <given-names>EJ</given-names>
          </name>
        </person-group>
        <article-title>Less is more in mammalian phylogenomics: At-rich genes minimize tree conflicts and unravel the root of placental mammals</article-title>
        <source>Mol Biol Evol</source>
        <year>2013</year>
        <volume>30</volume>
        <issue>9</issue>
        <fpage>2134</fpage>
        <lpage>44</lpage>
        <pub-id pub-id-type="doi">10.1093/molbev/mst116</pub-id>
        <?supplied-pmid 23813978?>
        <pub-id pub-id-type="pmid">23813978</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cornillot</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Hadj-Kaddour</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Dassouli</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Noel</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Ranwez</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Vacherie</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Augagneur</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Bres</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Duclos</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Randazzo</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Sequencing of the smallest apicomplexan genome from the human pathogen babesia microti</article-title>
        <source>Nucleic Acids Res</source>
        <year>2012</year>
        <volume>40</volume>
        <issue>18</issue>
        <fpage>9102</fpage>
        <lpage>14</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gks700</pub-id>
        <?supplied-pmid 22833609?>
        <pub-id pub-id-type="pmid">22833609</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Romiguier</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Cameron</surname>
            <given-names>SA</given-names>
          </name>
          <name>
            <surname>Woodard</surname>
            <given-names>SH</given-names>
          </name>
          <name>
            <surname>Fischman</surname>
            <given-names>BJ</given-names>
          </name>
          <name>
            <surname>Keller</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Praz</surname>
            <given-names>CJ</given-names>
          </name>
        </person-group>
        <article-title>Phylogenomics controlling for base compositional bias reveals a single origin of eusociality in corbiculate bees</article-title>
        <source>Mol Biol Evol</source>
        <year>2015</year>
        <volume>33</volume>
        <issue>3</issue>
        <fpage>670</fpage>
        <lpage>8</lpage>
        <pub-id pub-id-type="doi">10.1093/molbev/msv258</pub-id>
        <?supplied-pmid 26576851?>
        <pub-id pub-id-type="pmid">26576851</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Scornavacca</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Galtier</surname>
            <given-names>N</given-names>
          </name>
        </person-group>
        <article-title>Incomplete lineage sorting in mammalian phylogenomics</article-title>
        <source>Syst Biol</source>
        <year>2017</year>
        <volume>66</volume>
        <issue>1</issue>
        <fpage>112</fpage>
        <lpage>20</lpage>
        <?supplied-pmid 28173480?>
        <pub-id pub-id-type="pmid">28173480</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mavrodiev</surname>
            <given-names>EV</given-names>
          </name>
          <name>
            <surname>Martínez-Azorín</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Dranishnikov</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Crespo</surname>
            <given-names>MB</given-names>
          </name>
        </person-group>
        <article-title>At least 23 genera instead of one: The case of iris l. sl (iridaceae)</article-title>
        <source>PLoS One</source>
        <year>2014</year>
        <volume>9</volume>
        <issue>8</issue>
        <fpage>106459</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0106459</pub-id>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Douzery</surname>
            <given-names>EJ</given-names>
          </name>
          <name>
            <surname>Scornavacca</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Romiguier</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Belkhir</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Galtier</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Delsuc</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Ranwez</surname>
            <given-names>V</given-names>
          </name>
        </person-group>
        <article-title>Orthomam v8: a database of orthologous exons and coding sequences for comparative genomics in mammals</article-title>
        <source>Mol Biol Evol</source>
        <year>2014</year>
        <volume>31</volume>
        <issue>7</issue>
        <fpage>1923</fpage>
        <lpage>8</lpage>
        <pub-id pub-id-type="doi">10.1093/molbev/msu132</pub-id>
        <?supplied-pmid 24723423?>
        <pub-id pub-id-type="pmid">24723423</pub-id>
      </element-citation>
    </ref>
    <ref id="CR29">
      <label>29</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bayzid</surname>
            <given-names>MS</given-names>
          </name>
          <name>
            <surname>Hunt</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Warnow</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>Disk covering methods improve phylogenomic analyses</article-title>
        <source>BMC genomics</source>
        <year>2014</year>
        <volume>15</volume>
        <issue>6</issue>
        <fpage>7</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2164-15-S6-S7</pub-id>
        <pub-id pub-id-type="pmid">24384011</pub-id>
      </element-citation>
    </ref>
    <ref id="CR30">
      <label>30</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Degnan</surname>
            <given-names>JH</given-names>
          </name>
          <name>
            <surname>Rosenberg</surname>
            <given-names>NA</given-names>
          </name>
        </person-group>
        <article-title>Discordance of species trees with their most likely gene trees</article-title>
        <source>PLoS Genet</source>
        <year>2006</year>
        <volume>2</volume>
        <fpage>762</fpage>
        <lpage>8</lpage>
        <pub-id pub-id-type="doi">10.1371/journal.pgen.0020068</pub-id>
      </element-citation>
    </ref>
    <ref id="CR31">
      <label>31</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Degnan</surname>
            <given-names>JH</given-names>
          </name>
        </person-group>
        <article-title>Anomalous unrooted gene trees</article-title>
        <source>Syst Biol</source>
        <year>2013</year>
        <volume>62</volume>
        <issue>4</issue>
        <fpage>574</fpage>
        <lpage>90</lpage>
        <pub-id pub-id-type="doi">10.1093/sysbio/syt023</pub-id>
        <?supplied-pmid 23576318?>
        <pub-id pub-id-type="pmid">23576318</pub-id>
      </element-citation>
    </ref>
    <ref id="CR32">
      <label>32</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Degnan</surname>
            <given-names>JH</given-names>
          </name>
          <name>
            <surname>Rosenberg</surname>
            <given-names>NA</given-names>
          </name>
        </person-group>
        <article-title>Gene tree discordance, phylogenetic inference and the multispecies coalescent</article-title>
        <source>Trends Ecol Evol</source>
        <year>2009</year>
        <volume>24</volume>
        <issue>6</issue>
        <fpage>332</fpage>
        <lpage>340</lpage>
        <pub-id pub-id-type="doi">10.1016/j.tree.2009.01.009</pub-id>
        <?supplied-pmid 19307040?>
        <pub-id pub-id-type="pmid">19307040</pub-id>
      </element-citation>
    </ref>
    <ref id="CR33">
      <label>33</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Allman</surname>
            <given-names>ES</given-names>
          </name>
          <name>
            <surname>Degnan</surname>
            <given-names>JH</given-names>
          </name>
          <name>
            <surname>Rhodes</surname>
            <given-names>JA</given-names>
          </name>
        </person-group>
        <article-title>Identifying the rooted species tree from the distribution of unrooted gene trees under the coalescent</article-title>
        <source>J Math Biol</source>
        <year>2011</year>
        <volume>62</volume>
        <issue>6</issue>
        <fpage>833</fpage>
        <lpage>62</lpage>
        <pub-id pub-id-type="doi">10.1007/s00285-010-0355-7</pub-id>
        <?supplied-pmid 20652704?>
        <pub-id pub-id-type="pmid">20652704</pub-id>
      </element-citation>
    </ref>
    <ref id="CR34">
      <label>34</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Reaz</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Bayzid</surname>
            <given-names>MS</given-names>
          </name>
          <name>
            <surname>Rahman</surname>
            <given-names>MS</given-names>
          </name>
        </person-group>
        <article-title>Accurate phylogenetic tree reconstruction from quartets: A heuristic approach</article-title>
        <source>PLoS One</source>
        <year>2014</year>
        <volume>9</volume>
        <issue>8</issue>
        <fpage>104008</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0104008</pub-id>
      </element-citation>
    </ref>
    <ref id="CR35">
      <label>35</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Bayzid</surname>
            <given-names>MS</given-names>
          </name>
          <name>
            <surname>Mirarab</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Warnow</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>Inferring optimal species trees under gene duplication and loss</article-title>
        <source>Proc. of Pacific Symposium on Biocomputing (PSB)</source>
        <year>2013</year>
        <publisher-loc>Singapore</publisher-loc>
        <publisher-name>World Scientific</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR36">
      <label>36</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ewing</surname>
            <given-names>G. B.</given-names>
          </name>
          <name>
            <surname>Ebersberger</surname>
            <given-names>I.</given-names>
          </name>
          <name>
            <surname>Schmidt</surname>
            <given-names>H. A.</given-names>
          </name>
          <name>
            <surname>Von Haeseler</surname>
            <given-names>A.</given-names>
          </name>
        </person-group>
        <article-title>Rooted triple consensus and anomalous gene trees</article-title>
        <source>BMC Evol Biol</source>
        <year>2008</year>
        <volume>8</volume>
        <issue>1</issue>
        <fpage>118</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2148-8-118</pub-id>
        <?supplied-pmid 18439266?>
        <pub-id pub-id-type="pmid">18439266</pub-id>
      </element-citation>
    </ref>
    <ref id="CR37">
      <label>37</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wu</surname>
            <given-names>BY</given-names>
          </name>
        </person-group>
        <article-title>Constructing the maximum consensus tree from rooted triples</article-title>
        <source>J Comb Optim</source>
        <year>2004</year>
        <volume>8</volume>
        <issue>1</issue>
        <fpage>29</fpage>
        <lpage>39</lpage>
        <pub-id pub-id-type="doi">10.1023/B:JOCO.0000021936.04215.68</pub-id>
      </element-citation>
    </ref>
    <ref id="CR38">
      <label>38</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Byrka</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Guillemot</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Jansson</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>New results on optimizing rooted triplets consistency</article-title>
        <source>Discret Appl Math</source>
        <year>2010</year>
        <volume>158</volume>
        <issue>11</issue>
        <fpage>1136</fpage>
        <lpage>47</lpage>
        <pub-id pub-id-type="doi">10.1016/j.dam.2010.03.004</pub-id>
      </element-citation>
    </ref>
    <ref id="CR39">
      <label>39</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Hallett</surname>
            <given-names>MT</given-names>
          </name>
          <name>
            <surname>Lagergren</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>New algorithms for the duplication-loss model</article-title>
        <source>Proc ACM Symp Comput Biol RECOMB2000</source>
        <year>2000</year>
        <publisher-loc>New York</publisher-loc>
        <publisher-name>ACM Press</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR40">
      <label>40</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Than</surname>
            <given-names>CV</given-names>
          </name>
          <name>
            <surname>Nakhleh</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <article-title>Species tree inference by minimizing deep coalescences</article-title>
        <source>PLoS Comp Biol</source>
        <year>2009</year>
        <volume>5</volume>
        <issue>9</issue>
        <fpage>e1000501</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pcbi.1000501</pub-id>
      </element-citation>
    </ref>
    <ref id="CR41">
      <label>41</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yu</surname>
            <given-names>Y.</given-names>
          </name>
          <name>
            <surname>Warnow</surname>
            <given-names>T.</given-names>
          </name>
          <name>
            <surname>Nakhleh</surname>
            <given-names>L.</given-names>
          </name>
        </person-group>
        <article-title>Algorithms for mdc-based multi-locus phylogeny inference: beyond rooted binary gene trees on single alleles</article-title>
        <source>Journal of Computational Biology</source>
        <year>2011</year>
        <volume>18</volume>
        <issue>11</issue>
        <fpage>1543</fpage>
        <lpage>1559</lpage>
        <pub-id pub-id-type="doi">10.1089/cmb.2011.0174</pub-id>
        <?supplied-pmid 22035329?>
        <pub-id pub-id-type="pmid">22035329</pub-id>
      </element-citation>
    </ref>
    <ref id="CR42">
      <label>42</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bayzid</surname>
            <given-names>MS</given-names>
          </name>
          <name>
            <surname>Warnow</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>Gene tree parsimony for incomplete gene trees: addressing true biological loss</article-title>
        <source>Algoritm Mol Biol</source>
        <year>2018</year>
        <volume>13</volume>
        <fpage>1</fpage>
        <pub-id pub-id-type="doi">10.1186/s13015-017-0120-1</pub-id>
      </element-citation>
    </ref>
    <ref id="CR43">
      <label>43</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhang</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Rabiee</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Sayyari</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Mirarab</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Astral-iii: polynomial time species tree reconstruction from partially resolved gene trees</article-title>
        <source>BMC Bioinforma</source>
        <year>2018</year>
        <volume>19</volume>
        <issue>6</issue>
        <fpage>153</fpage>
        <pub-id pub-id-type="doi">10.1186/s12859-018-2129-y</pub-id>
      </element-citation>
    </ref>
    <ref id="CR44">
      <label>44</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Robinson</surname>
            <given-names>DF</given-names>
          </name>
          <name>
            <surname>Foulds</surname>
            <given-names>LR</given-names>
          </name>
        </person-group>
        <article-title>Comparison of phylogenetic trees</article-title>
        <source>Math Biosci</source>
        <year>1981</year>
        <volume>53</volume>
        <issue>1-2</issue>
        <fpage>131</fpage>
        <lpage>47</lpage>
        <pub-id pub-id-type="doi">10.1016/0025-5564(81)90043-2</pub-id>
      </element-citation>
    </ref>
    <ref id="CR45">
      <label>45</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mirarab</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Bayzid</surname>
            <given-names>MS</given-names>
          </name>
          <name>
            <surname>Boussau</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Warnow</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>Statistical binning enables an accurate coalescent-based estimation of the avian tree</article-title>
        <source>Science</source>
        <year>2014</year>
        <volume>346</volume>
        <issue>6215</issue>
        <fpage>1250463</fpage>
        <pub-id pub-id-type="doi">10.1126/science.1250463</pub-id>
        <?supplied-pmid 25504728?>
        <pub-id pub-id-type="pmid">25504728</pub-id>
      </element-citation>
    </ref>
    <ref id="CR46">
      <label>46</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chung</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Ané</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>Comparing two Bayesian methods for gene tree/species tree reconstruction: A simulation with incomplete lineage sorting and horizontal gene transfer</article-title>
        <source>Syst Biol</source>
        <year>2011</year>
        <volume>60</volume>
        <issue>3</issue>
        <fpage>261</fpage>
        <lpage>75</lpage>
        <pub-id pub-id-type="doi">10.1093/sysbio/syr003</pub-id>
        <?supplied-pmid 21368324?>
        <pub-id pub-id-type="pmid">21368324</pub-id>
      </element-citation>
    </ref>
    <ref id="CR47">
      <label>47</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mirarab</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Warnow</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>Astral-ii: coalescent-based species tree estimation with many hundreds of taxa and thousands of genes</article-title>
        <source>Bioinformatics</source>
        <year>2015</year>
        <volume>31</volume>
        <issue>12</issue>
        <fpage>44</fpage>
        <lpage>52</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btv234</pub-id>
      </element-citation>
    </ref>
    <ref id="CR48">
      <label>48</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Song</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Edwards</surname>
            <given-names>SV</given-names>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Resolving conflict in eutherian mammal phylogeny using phylogenomics and the multispecies coalescent model</article-title>
        <source>Proc Nat Acad Sci</source>
        <year>2012</year>
        <volume>109</volume>
        <issue>37</issue>
        <fpage>14942</fpage>
        <lpage>7</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.1211733109</pub-id>
        <?supplied-pmid 22930817?>
        <pub-id pub-id-type="pmid">22930817</pub-id>
      </element-citation>
    </ref>
    <ref id="CR49">
      <label>49</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bayzid</surname>
            <given-names>MS</given-names>
          </name>
          <name>
            <surname>Warnow</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>Estimating optimal species trees from incomplete gene trees under deep coalescence</article-title>
        <source>J Comput Biol</source>
        <year>2012</year>
        <volume>19</volume>
        <issue>6</issue>
        <fpage>591</fpage>
        <lpage>605</lpage>
        <pub-id pub-id-type="doi">10.1089/cmb.2012.0037</pub-id>
        <?supplied-pmid 22697236?>
        <pub-id pub-id-type="pmid">22697236</pub-id>
      </element-citation>
    </ref>
    <ref id="CR50">
      <label>50</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chiari</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Cahais</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Galtier</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Delsuc</surname>
            <given-names>F</given-names>
          </name>
        </person-group>
        <article-title>Phylogenomic analyses support the position of turtles as the sister group of birds and crocodiles (archosauria)</article-title>
        <source>Bmc Biol</source>
        <year>2012</year>
        <volume>10</volume>
        <issue>1</issue>
        <fpage>65</fpage>
        <pub-id pub-id-type="doi">10.1186/1741-7007-10-65</pub-id>
        <?supplied-pmid 22839781?>
        <pub-id pub-id-type="pmid">22839781</pub-id>
      </element-citation>
    </ref>
    <ref id="CR51">
      <label>51</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zardoya</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Meyer</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Complete mitochondrial genome suggests diapsid affinities of turtles</article-title>
        <source>Proc Nat Acad Sci</source>
        <year>1998</year>
        <volume>95</volume>
        <issue>24</issue>
        <fpage>14226</fpage>
        <lpage>31</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.95.24.14226</pub-id>
        <?supplied-pmid 9826682?>
        <pub-id pub-id-type="pmid">9826682</pub-id>
      </element-citation>
    </ref>
    <ref id="CR52">
      <label>52</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hugall</surname>
            <given-names>AF</given-names>
          </name>
          <name>
            <surname>Foster</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>MS</given-names>
          </name>
        </person-group>
        <article-title>Calibration choice, rate smoothing, and the pattern of tetrapod diversification according to the long nuclear gene rag-1</article-title>
        <source>Syst Biol</source>
        <year>2007</year>
        <volume>56</volume>
        <issue>4</issue>
        <fpage>543</fpage>
        <lpage>63</lpage>
        <pub-id pub-id-type="doi">10.1080/10635150701477825</pub-id>
        <?supplied-pmid 17654361?>
        <pub-id pub-id-type="pmid">17654361</pub-id>
      </element-citation>
    </ref>
    <ref id="CR53">
      <label>53</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Iwabe</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Hara</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Kumazawa</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Shibamoto</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Saito</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Miyata</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Katoh</surname>
            <given-names>K</given-names>
          </name>
        </person-group>
        <article-title>Sister group relationship of turtles to the bird-crocodilian clade revealed by nuclear dna–coded proteins</article-title>
        <source>Mol Biol Evol</source>
        <year>2004</year>
        <volume>22</volume>
        <issue>4</issue>
        <fpage>810</fpage>
        <lpage>3</lpage>
        <pub-id pub-id-type="doi">10.1093/molbev/msi075</pub-id>
        <?supplied-pmid 15625185?>
        <pub-id pub-id-type="pmid">15625185</pub-id>
      </element-citation>
    </ref>
    <ref id="CR54">
      <label>54</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Boussau</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Szöllősi</surname>
            <given-names>GJ</given-names>
          </name>
          <name>
            <surname>Duret</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Gouy</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Tannier</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Daubin</surname>
            <given-names>V</given-names>
          </name>
        </person-group>
        <article-title>Genome-scale coestimation of species and gene trees</article-title>
        <source>Genome Res</source>
        <year>2013</year>
        <volume>23</volume>
        <issue>2</issue>
        <fpage>323</fpage>
        <lpage>30</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.141978.112</pub-id>
        <?supplied-pmid 23132911?>
        <pub-id pub-id-type="pmid">23132911</pub-id>
      </element-citation>
    </ref>
    <ref id="CR55">
      <label>55</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kumar</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Hallström</surname>
            <given-names>BM</given-names>
          </name>
          <name>
            <surname>Janke</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Coalescent-based genome analyses resolve the early branches of the euarchontoglires</article-title>
        <source>PLoS One</source>
        <year>2013</year>
        <volume>8</volume>
        <issue>4</issue>
        <fpage>60019</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0060019</pub-id>
      </element-citation>
    </ref>
    <ref id="CR56">
      <label>56</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mirarab</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Bayzid</surname>
            <given-names>MS</given-names>
          </name>
          <name>
            <surname>Warnow</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>Evaluating summary methods for multilocus species tree estimation in the presence of incomplete lineage sorting</article-title>
        <source>Syst Biol</source>
        <year>2014</year>
        <volume>65</volume>
        <issue>3</issue>
        <fpage>366</fpage>
        <lpage>80</lpage>
        <pub-id pub-id-type="doi">10.1093/sysbio/syu063</pub-id>
        <?supplied-pmid 25164915?>
        <pub-id pub-id-type="pmid">25164915</pub-id>
      </element-citation>
    </ref>
    <ref id="CR57">
      <label>57</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Seo</surname>
            <given-names>T-K</given-names>
          </name>
        </person-group>
        <article-title>Calculating bootstrap probabilities of phylogeny using multilocus sequence data</article-title>
        <source>Mol Biol Evol</source>
        <year>2008</year>
        <volume>25</volume>
        <issue>5</issue>
        <fpage>960</fpage>
        <lpage>71</lpage>
        <pub-id pub-id-type="doi">10.1093/molbev/msn043</pub-id>
        <?supplied-pmid 18281270?>
        <pub-id pub-id-type="pmid">18281270</pub-id>
      </element-citation>
    </ref>
    <ref id="CR58">
      <label>58</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ranwez</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Delsuc</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Ranwez</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Belkhir</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Tilak</surname>
            <given-names>M-K</given-names>
          </name>
          <name>
            <surname>Douzery</surname>
            <given-names>EJ</given-names>
          </name>
        </person-group>
        <article-title>Orthomam: a database of orthologous genomic markers for placental mammal phylogenetics</article-title>
        <source>BMC Evol Biol</source>
        <year>2007</year>
        <volume>7</volume>
        <issue>1</issue>
        <fpage>241</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2148-7-241</pub-id>
        <?supplied-pmid 18053139?>
        <pub-id pub-id-type="pmid">18053139</pub-id>
      </element-citation>
    </ref>
    <ref id="CR59">
      <label>59</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wickett</surname>
            <given-names>NJ</given-names>
          </name>
          <name>
            <surname>Mirarab</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Nguyen</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Warnow</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Carpenter</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Matasci</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Ayyampalayam</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Barker</surname>
            <given-names>MS</given-names>
          </name>
          <name>
            <surname>Burleigh</surname>
            <given-names>JG</given-names>
          </name>
          <name>
            <surname>Gitzendanner</surname>
            <given-names>MA</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Phylotranscriptomic analysis of the origin and early diversification of land plants</article-title>
        <source>Proc Nat Acad Sci</source>
        <year>2014</year>
        <volume>111</volume>
        <issue>45</issue>
        <fpage>4859</fpage>
        <lpage>68</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.1323926111</pub-id>
      </element-citation>
    </ref>
    <ref id="CR60">
      <label>60</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gatesy</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Springer</surname>
            <given-names>MS</given-names>
          </name>
        </person-group>
        <article-title>Phylogenetic analysis at deep timescales: unreliable gene trees, bypassed hidden support, and the coalescence/concatalescence conundrum</article-title>
        <source>Mol Phylogenet Evol</source>
        <year>2014</year>
        <volume>80</volume>
        <fpage>231</fpage>
        <lpage>66</lpage>
        <pub-id pub-id-type="doi">10.1016/j.ympev.2014.08.013</pub-id>
        <?supplied-pmid 25152276?>
        <pub-id pub-id-type="pmid">25152276</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
