<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d3 20150301//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 39.96?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?subarticle pcbi.1009443.r001?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
    <journal-id journal-id-type="iso-abbrev">PLoS Comput Biol</journal-id>
    <journal-id journal-id-type="publisher-id">plos</journal-id>
    <journal-title-group>
      <journal-title>PLoS Computational Biology</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1553-734X</issn>
    <issn pub-type="epub">1553-7358</issn>
    <publisher>
      <publisher-name>Public Library of Science</publisher-name>
      <publisher-loc>San Francisco, CA USA</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">8523047</article-id>
    <article-id pub-id-type="pmid">34613960</article-id>
    <article-id pub-id-type="publisher-id">PCOMPBIOL-D-21-00225</article-id>
    <article-id pub-id-type="doi">10.1371/journal.pcbi.1009443</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research Article</subject>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Cell Biology</subject>
          <subj-group>
            <subject>Cellular Types</subject>
            <subj-group>
              <subject>Animal Cells</subject>
              <subj-group>
                <subject>Muscle Cells</subject>
                <subj-group>
                  <subject>Myofibrils</subject>
                  <subj-group>
                    <subject>Sarcomeres</subject>
                  </subj-group>
                </subj-group>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Anatomy</subject>
          <subj-group>
            <subject>Biological Tissue</subject>
            <subj-group>
              <subject>Muscle Tissue</subject>
              <subj-group>
                <subject>Muscle Cells</subject>
                <subj-group>
                  <subject>Myofibrils</subject>
                  <subj-group>
                    <subject>Sarcomeres</subject>
                  </subj-group>
                </subj-group>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Medicine and Health Sciences</subject>
        <subj-group>
          <subject>Anatomy</subject>
          <subj-group>
            <subject>Biological Tissue</subject>
            <subj-group>
              <subject>Muscle Tissue</subject>
              <subj-group>
                <subject>Muscle Cells</subject>
                <subj-group>
                  <subject>Myofibrils</subject>
                  <subj-group>
                    <subject>Sarcomeres</subject>
                  </subj-group>
                </subj-group>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Physiology</subject>
          <subj-group>
            <subject>Muscle Physiology</subject>
            <subj-group>
              <subject>Muscle Contraction</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Physical Sciences</subject>
        <subj-group>
          <subject>Physics</subject>
          <subj-group>
            <subject>Classical Mechanics</subject>
            <subj-group>
              <subject>Deformation</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Physical Sciences</subject>
        <subj-group>
          <subject>Physics</subject>
          <subj-group>
            <subject>Classical Mechanics</subject>
            <subj-group>
              <subject>Damage Mechanics</subject>
              <subj-group>
                <subject>Deformation</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Computer and Information Sciences</subject>
        <subj-group>
          <subject>Data Management</subject>
          <subj-group>
            <subject>Data Visualization</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Computer and Information Sciences</subject>
        <subj-group>
          <subject>Data Management</subject>
          <subj-group>
            <subject>Data Visualization</subject>
            <subj-group>
              <subject>Infographics</subject>
              <subj-group>
                <subject>Graphs</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Cell Biology</subject>
          <subj-group>
            <subject>Cellular Types</subject>
            <subj-group>
              <subject>Animal Cells</subject>
              <subj-group>
                <subject>Muscle Cells</subject>
                <subj-group>
                  <subject>Cardiomyocytes</subject>
                </subj-group>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Anatomy</subject>
          <subj-group>
            <subject>Biological Tissue</subject>
            <subj-group>
              <subject>Muscle Tissue</subject>
              <subj-group>
                <subject>Muscle Cells</subject>
                <subj-group>
                  <subject>Cardiomyocytes</subject>
                </subj-group>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Medicine and Health Sciences</subject>
        <subj-group>
          <subject>Anatomy</subject>
          <subj-group>
            <subject>Biological Tissue</subject>
            <subj-group>
              <subject>Muscle Tissue</subject>
              <subj-group>
                <subject>Muscle Cells</subject>
                <subj-group>
                  <subject>Cardiomyocytes</subject>
                </subj-group>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and Analysis Methods</subject>
        <subj-group>
          <subject>Research Design</subject>
          <subj-group>
            <subject>Quantitative Analysis</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Computer and Information Sciences</subject>
        <subj-group>
          <subject>Software Engineering</subject>
          <subj-group>
            <subject>Computer Software</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Engineering and Technology</subject>
        <subj-group>
          <subject>Software Engineering</subject>
          <subj-group>
            <subject>Computer Software</subject>
          </subj-group>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Sarc-Graph: Automated segmentation, tracking, and analysis of sarcomeres in hiPSC-derived cardiomyocytes</article-title>
      <alt-title alt-title-type="running-head">Sarc-Graph: Automated analysis of hiPSC-derived cardiomyocytes</alt-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-9303-4327</contrib-id>
        <name>
          <surname>Zhao</surname>
          <given-names>Bill</given-names>
        </name>
        <role content-type="https://casrai.org/credit/">Investigation</role>
        <role content-type="https://casrai.org/credit/">Writing – original draft</role>
        <xref rid="aff001" ref-type="aff">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-7979-3001</contrib-id>
        <name>
          <surname>Zhang</surname>
          <given-names>Kehan</given-names>
        </name>
        <role content-type="https://casrai.org/credit/">Conceptualization</role>
        <role content-type="https://casrai.org/credit/">Data curation</role>
        <role content-type="https://casrai.org/credit/">Writing – original draft</role>
        <xref rid="aff002" ref-type="aff">
          <sup>2</sup>
        </xref>
        <xref rid="aff003" ref-type="aff">
          <sup>3</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0003-2445-8449</contrib-id>
        <name>
          <surname>Chen</surname>
          <given-names>Christopher S.</given-names>
        </name>
        <role content-type="https://casrai.org/credit/">Conceptualization</role>
        <role content-type="https://casrai.org/credit/">Funding acquisition</role>
        <role content-type="https://casrai.org/credit/">Resources</role>
        <role content-type="https://casrai.org/credit/">Supervision</role>
        <role content-type="https://casrai.org/credit/">Writing – review &amp; editing</role>
        <xref rid="aff002" ref-type="aff">
          <sup>2</sup>
        </xref>
        <xref rid="aff003" ref-type="aff">
          <sup>3</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0001-8099-3468</contrib-id>
        <name>
          <surname>Lejeune</surname>
          <given-names>Emma</given-names>
        </name>
        <role content-type="https://casrai.org/credit/">Conceptualization</role>
        <role content-type="https://casrai.org/credit/">Data curation</role>
        <role content-type="https://casrai.org/credit/">Funding acquisition</role>
        <role content-type="https://casrai.org/credit/">Methodology</role>
        <role content-type="https://casrai.org/credit/">Resources</role>
        <role content-type="https://casrai.org/credit/">Software</role>
        <role content-type="https://casrai.org/credit/">Supervision</role>
        <role content-type="https://casrai.org/credit/">Validation</role>
        <role content-type="https://casrai.org/credit/">Visualization</role>
        <role content-type="https://casrai.org/credit/">Writing – original draft</role>
        <role content-type="https://casrai.org/credit/">Writing – review &amp; editing</role>
        <xref rid="aff001" ref-type="aff">
          <sup>1</sup>
        </xref>
        <xref rid="cor001" ref-type="corresp">*</xref>
      </contrib>
    </contrib-group>
    <aff id="aff001">
      <label>1</label>
      <addr-line>Department of Mechanical Engineering, Boston University, Boston, Massachusetts, United States of America</addr-line>
    </aff>
    <aff id="aff002">
      <label>2</label>
      <addr-line>Department of Biomedical Engineering, Boston University, Boston, Massachusetts, United States of America</addr-line>
    </aff>
    <aff id="aff003">
      <label>3</label>
      <addr-line>The Wyss Institute for Biologically Inspired Engineering, Harvard University, Cambridge, Massachusetts, United States of America</addr-line>
    </aff>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Pertea</surname>
          <given-names>Mihaela</given-names>
        </name>
        <role>Editor</role>
        <xref rid="edit1" ref-type="aff"/>
      </contrib>
    </contrib-group>
    <aff id="edit1">
      <addr-line>Johns Hopkins University, UNITED STATES</addr-line>
    </aff>
    <author-notes>
      <fn fn-type="COI-statement" id="coi001">
        <p>The authors have declared that no competing interests exist.</p>
      </fn>
      <corresp id="cor001">* E-mail: <email>elejeune@bu.edu</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <month>10</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>6</day>
      <month>10</month>
      <year>2021</year>
    </pub-date>
    <volume>17</volume>
    <issue>10</issue>
    <elocation-id>e1009443</elocation-id>
    <history>
      <date date-type="received">
        <day>8</day>
        <month>2</month>
        <year>2021</year>
      </date>
      <date date-type="accepted">
        <day>10</day>
        <month>9</month>
        <year>2021</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© 2021 Zhao et al</copyright-statement>
      <copyright-year>2021</copyright-year>
      <copyright-holder>Zhao et al</copyright-holder>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <self-uri content-type="pdf" xlink:href="pcbi.1009443.pdf"/>
    <abstract>
      <p>A better fundamental understanding of human induced pluripotent stem cell-derived cardiomyocytes (hiPSC-CMs) has the potential to advance applications ranging from drug discovery to cardiac repair. Automated quantitative analysis of beating hiPSC-CMs is an important and fast developing component of the hiPSC-CM research pipeline. Here we introduce “Sarc-Graph,” a computational framework to segment, track, and analyze sarcomeres in fluorescently tagged hiPSC-CMs. Our framework includes functions to segment z-discs and sarcomeres, track z-discs and sarcomeres in beating cells, and perform automated spatiotemporal analysis and data visualization. In addition to reporting good performance for sarcomere segmentation and tracking with little to no parameter tuning and a short runtime, we introduce two novel analysis approaches. First, we construct spatial graphs where z-discs correspond to nodes and sarcomeres correspond to edges. This makes measuring the network distance between each sarcomere (i.e., the number of connecting sarcomeres separating each sarcomere pair) straightforward. Second, we treat tracked and segmented components as fiducial markers and use them to compute the approximate deformation gradient of the entire tracked population. This represents a new quantitative descriptor of hiPSC-CM function. We showcase and validate our approach with both synthetic and experimental movies of beating hiPSC-CMs. By publishing Sarc-Graph, we aim to make automated quantitative analysis of hiPSC-CM behavior more accessible to the broader research community.</p>
    </abstract>
    <abstract abstract-type="summary">
      <title>Author summary</title>
      <p>Heart disease is the leading cause of death worldwide. Because of this, many researchers are studying heart cells in the lab and trying to create artificial heart tissue. Recently, there has been a growing focus on human induced pluripotent stem cell-derived cardiomyocytes (hiPSC-CMs). These are cells that are safely sampled from living humans, for example from the blood or skin, that are then transformed into human heart muscle cells. One active research goal is to use these cells to repair the damaged heart. Another active research goal is to test new drugs on these cells before testing them in animals and humans. However, one major challenge is that hiPSC-CMs often have an irregular internal structure that is difficult to analyze. At present, their behavior is far from fully understood. To address this, we have created software to automatically analyze movies of beating hiPSC-CMs. With our software, it is possible to quantify properties such as the amount and direction of beating cell contraction, and the variation in behavior across different parts of each cell. These tools will enable further quantitative analysis of hiPSC-CMs. With these tools, it will be easier to understand, control, and optimize artificial heart tissue created with hiPSC-CMs, and quantify the effects of drugs on hiPSC-CM behavior.</p>
    </abstract>
    <funding-group>
      <award-group id="award001">
        <funding-source>
          <institution>CELL-MET Engineering Research Center National Science Foundation</institution>
        </funding-source>
        <award-id>ECC-1647837</award-id>
        <principal-award-recipient>
          <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0003-2445-8449</contrib-id>
          <name>
            <surname>Chen</surname>
            <given-names>Christopher S.</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group id="award002">
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/100000968</institution-id>
            <institution>American Heart Association</institution>
          </institution-wrap>
        </funding-source>
        <award-id>17PRE33660967</award-id>
        <principal-award-recipient>
          <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-7979-3001</contrib-id>
          <name>
            <surname>Zhang</surname>
            <given-names>Kehan</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group id="award003">
        <funding-source>
          <institution>Boston University Hariri Junior Faculty Fellowship</institution>
        </funding-source>
        <principal-award-recipient>
          <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0001-8099-3468</contrib-id>
          <name>
            <surname>Lejeune</surname>
            <given-names>Emma</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group id="award004">
        <funding-source>
          <institution>the Boston University David R. Dalton Career Development Professorship</institution>
        </funding-source>
        <principal-award-recipient>
          <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0001-8099-3468</contrib-id>
          <name>
            <surname>Lejeune</surname>
            <given-names>Emma</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <funding-statement>This work was supported by the CELL-MET Engineering Research Center National Science Foundation ECC-1647837 (CSC is a co-PI, EL is an affiliated faculty). See: <ext-link xlink:href="https://www.bu.edu/cell-met/" ext-link-type="uri">https://www.bu.edu/cell-met/</ext-link> and <ext-link xlink:href="https://nsf.gov/awardsearch/showAward?AWD_ID=1647837" ext-link-type="uri">https://nsf.gov/awardsearch/showAward?AWD_ID=1647837</ext-link> KZ acknowledges fellowship support from the American Heart Association, award number 17PRE33660967. See: <ext-link xlink:href="https://www.heart.org/" ext-link-type="uri">https://www.heart.org/</ext-link>. EL acknowledges the Boston University Hariri Junior Faculty Fellowship, and the Boston University David R. Dalton Career Development Professorship. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
    </funding-group>
    <counts>
      <fig-count count="9"/>
      <table-count count="3"/>
      <page-count count="27"/>
    </counts>
    <custom-meta-group>
      <custom-meta>
        <meta-name>PLOS Publication Stage</meta-name>
        <meta-value>vor-update-to-uncorrected-proof</meta-value>
      </custom-meta>
      <custom-meta>
        <meta-name>Publication Update</meta-name>
        <meta-value>2021-10-18</meta-value>
      </custom-meta>
      <custom-meta id="data-availability">
        <meta-name>Data Availability</meta-name>
        <meta-value>The data underlying the results presented in the study are available from <ext-link xlink:href="https://github.com/elejeune11/Sarc-Graph" ext-link-type="uri">https://github.com/elejeune11/Sarc-Graph</ext-link>. In <xref rid="pcbi.1009443.s001" ref-type="supplementary-material">S1</xref>, <xref rid="pcbi.1009443.s002" ref-type="supplementary-material">S2</xref> and <xref rid="pcbi.1009443.s004" ref-type="supplementary-material">S4</xref> Texts we compare our work to other PREVIOUSLY PUBLISHED frameworks. In <xref rid="pcbi.1009443.s001" ref-type="supplementary-material">S1 Text</xref>, the SOTA code is implemented in MATLAB and available from <ext-link xlink:href="https://github.com/saucermanlab/SarcOrgTextureAnalysis" ext-link-type="uri">https://github.com/saucermanlab/SarcOrgTextureAnalysis</ext-link>, and the data is available from <ext-link xlink:href="https://figshare.com/articles/dataset/Sutcliffe_et_al_Scientific_Reports_2018_images/11390022" ext-link-type="uri">https://figshare.com/articles/dataset/Sutcliffe_et_al_Scientific_Reports_2018_images/11390022</ext-link>. In <xref rid="pcbi.1009443.s002" ref-type="supplementary-material">S2 Text</xref>, the data is available from <ext-link xlink:href="http://diseasebiophysics.seas.harvard.edu/publications" ext-link-type="uri">http://diseasebiophysics.seas.harvard.edu/publications</ext-link>. In <xref rid="pcbi.1009443.s004" ref-type="supplementary-material">S4 Text</xref>, the SarcTrack code is implemented in MATLAB and available from <ext-link xlink:href="https://github.com/HMS-IDAC/SarcTrack" ext-link-type="uri">https://github.com/HMS-IDAC/SarcTrack</ext-link>.</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
  <notes>
    <title>Data Availability</title>
    <p>The data underlying the results presented in the study are available from <ext-link xlink:href="https://github.com/elejeune11/Sarc-Graph" ext-link-type="uri">https://github.com/elejeune11/Sarc-Graph</ext-link>. In <xref rid="pcbi.1009443.s001" ref-type="supplementary-material">S1</xref>, <xref rid="pcbi.1009443.s002" ref-type="supplementary-material">S2</xref> and <xref rid="pcbi.1009443.s004" ref-type="supplementary-material">S4</xref> Texts we compare our work to other PREVIOUSLY PUBLISHED frameworks. In <xref rid="pcbi.1009443.s001" ref-type="supplementary-material">S1 Text</xref>, the SOTA code is implemented in MATLAB and available from <ext-link xlink:href="https://github.com/saucermanlab/SarcOrgTextureAnalysis" ext-link-type="uri">https://github.com/saucermanlab/SarcOrgTextureAnalysis</ext-link>, and the data is available from <ext-link xlink:href="https://figshare.com/articles/dataset/Sutcliffe_et_al_Scientific_Reports_2018_images/11390022" ext-link-type="uri">https://figshare.com/articles/dataset/Sutcliffe_et_al_Scientific_Reports_2018_images/11390022</ext-link>. In <xref rid="pcbi.1009443.s002" ref-type="supplementary-material">S2 Text</xref>, the data is available from <ext-link xlink:href="http://diseasebiophysics.seas.harvard.edu/publications" ext-link-type="uri">http://diseasebiophysics.seas.harvard.edu/publications</ext-link>. In <xref rid="pcbi.1009443.s004" ref-type="supplementary-material">S4 Text</xref>, the SarcTrack code is implemented in MATLAB and available from <ext-link xlink:href="https://github.com/HMS-IDAC/SarcTrack" ext-link-type="uri">https://github.com/HMS-IDAC/SarcTrack</ext-link>.</p>
  </notes>
</front>
<body>
  <disp-quote>
    <p>This is a <italic toggle="yes">PLOS Computational Biology</italic> Software paper.</p>
  </disp-quote>
  <sec sec-type="intro" id="sec001">
    <title>Introduction</title>
    <p>Quantitative analysis of movies of beating cardiomyocytes is a compelling approach for connecting cell morphology to dynamic cell function [<xref rid="pcbi.1009443.ref001" ref-type="bibr">1</xref>, <xref rid="pcbi.1009443.ref002" ref-type="bibr">2</xref>]. In particular, connecting structure and function is a crucial step towards a better fundamental understanding of human induced pluripotent stem cell-derived cardiomyocytes (hiPSC-CMs) [<xref rid="pcbi.1009443.ref003" ref-type="bibr">3</xref>, <xref rid="pcbi.1009443.ref004" ref-type="bibr">4</xref>]. In stark contrast to sarcomere chains in mature cardiomyocytes which have a highly ordered regular structure [<xref rid="pcbi.1009443.ref005" ref-type="bibr">5</xref>], sarcomere chains in hiPSC-CMs are typically immature and disordered [<xref rid="pcbi.1009443.ref006" ref-type="bibr">6</xref>]. This irregular structure, combined with large variation between cells, makes developing tools for quantitative analysis both more difficult and more pressing [<xref rid="pcbi.1009443.ref007" ref-type="bibr">7</xref>]. Robust quantitative analysis frameworks for analyzing beating hiPSC-CMs will help enable technological advances in drug discovery, genetic cardiac disease, and cardiac repair [<xref rid="pcbi.1009443.ref008" ref-type="bibr">8</xref>–<xref rid="pcbi.1009443.ref010" ref-type="bibr">10</xref>]. In this work, we aim to make automated quantitative analysis of hiPSC-CM contractile behavior more accessible to the broader research community.</p>
    <p>At present, there are multiple different methods available in the literature for analyzing the morphology of both mature cardiomyocytes and hiPSC-CMs. However, most of these methods are designed for still images (often of fixed cells) rather than dynamic movies of beating cells. Recently Morris et al. 2020 [<xref rid="pcbi.1009443.ref011" ref-type="bibr">11</xref>] developed the structural assay “ZlineDetection,” a computational tool to segment and analyze sarcomeric z-discs. Sutcliffe et al. 2018 [<xref rid="pcbi.1009443.ref012" ref-type="bibr">12</xref>] developed “SarcOmere Texture Analysis” (SOTA), a computational tool for quantifying sarcomere structure using Haralick texture features. And, Pasqualini et al. 2015 [<xref rid="pcbi.1009443.ref006" ref-type="bibr">6</xref>] defined 11 metrics for describing sarcomere structure (sarcomere length, total energy, sarcomeric energy, sarcomeric packing density, orientational order parameter (OOP), sarcomeric OOP, nonsarcomeric OOP, Z-disc relative presence, weighted OOP, coverage quality control, and coherency quality control). In the second two examples, filter operations are applied to each image and single quantities of interest are extracted for the entire field of view [<xref rid="pcbi.1009443.ref006" ref-type="bibr">6</xref>, <xref rid="pcbi.1009443.ref012" ref-type="bibr">12</xref>]. Though it is possible to analyze a movie as a sequence of images and compare average changes, none of these tools have built in functionality for tracking individual sarcomere motion and length changes between image frames.</p>
    <p>In well aligned and synchronously beating cardiomyocytes, Fast Fourier Transforms (FFT) can be used to determine sarcomere length in a chain of sarcomeres with a (often manually) defined axis [<xref rid="pcbi.1009443.ref002" ref-type="bibr">2</xref>]. We note that this is readily available as “SarCoptiM,” an ImageJ plugin [<xref rid="pcbi.1009443.ref002" ref-type="bibr">2</xref>, <xref rid="pcbi.1009443.ref013" ref-type="bibr">13</xref>]. However, because sarcomere chains in hiPSC-CMs are often not in alignment and individual sarcomeres often do not deform in sync, these methods are not necessarily suitable for robust automated analysis of hiPSC-CM movies. Recently, Ribeiro et al. 2017 [<xref rid="pcbi.1009443.ref008" ref-type="bibr">8</xref>] developed a multi-imaging (brightfield, fluorescent beads, and an actin stain) based assay to quantify the mechanical contractile output of hiPSC-CMs. For this method, cells are seeded onto a micropatterned deformable polyacrylamide substrates containing fluorescent microbeads. This setup makes it possible to not only image dynamic cell deformation, but also measure the contractile forces that the cell is exerting on the substrate. Though the authors explored multiple different approaches for calculating sarcomere length, sarcomeres were not explicitly tracked between frames. Finally, Toepfer et al. 2019 [<xref rid="pcbi.1009443.ref010" ref-type="bibr">10</xref>] developed “SarcTrack,” a tool for segmentation and tracking of individual sarcomeres in movies of beating hiPSC-CMs. With this software, sarcomeres are fitted with Morlet wavelets, and assumed to contract following a periodic sawtooth function. Because individual sarcomeres are tracked, it is possible to report quantities of interest such as sarcomere contraction and relaxation time and sarcomere shortening on an individual sarcomere basis.</p>
    <p>Movies of fluorescently labeled hiPSC-CMs contracting are incredibly information rich [<xref rid="pcbi.1009443.ref010" ref-type="bibr">10</xref>]. <xref rid="pcbi.1009443.g001" ref-type="fig">Fig 1A</xref> shows a hiPSC-CM with fluorescently labeled z-discs. Critically, with dynamic data it is possible to not only measure structure but also measure aspects of how the structural components functionally interact [<xref rid="pcbi.1009443.ref004" ref-type="bibr">4</xref>, <xref rid="pcbi.1009443.ref014" ref-type="bibr">14</xref>–<xref rid="pcbi.1009443.ref017" ref-type="bibr">17</xref>]. The focus of this work is on extracting structural and functional information from movies of beating hiPSC-CMs with fluorescently labeled z-discs. Here, we provide analysis tools beyond the scope of SarcTrack [<xref rid="pcbi.1009443.ref010" ref-type="bibr">10</xref>], the current state of the art software for sarcomere segmentation and tracking. In addition, we provide an alternative approach to both sarcomere segmentation and tracking that may be more effective in some scenarios. Notably, our code has the practical benefits of requiring little to no manual parameter tuning and implementation in the open source Python programming language.</p>
    <fig position="float" id="pcbi.1009443.g001">
      <object-id pub-id-type="doi">10.1371/journal.pcbi.1009443.g001</object-id>
      <label>Fig 1</label>
      <caption>
        <p>Analyzing movies of contracting human induced pluripotent stem cell-derived cardiomyocytes (hiPSC-CMs): (a) Still image of a beating hiPSC-CM movie. As per the schematic, z-discs, which define the ends of an ≈ 2 <italic toggle="yes">μ</italic>m sarcomere, are fluorescently labeled; (b) Movie still with a schematic illustration of deformation gradient <bold>F</bold><sub>avg</sub> and tracked sarcomeres overlaid, sarcomere color corresponds to contraction level with red indicating the highest level of contraction; (c) Magnitudes of average principal stretches (λ<sub>1</sub>, λ<sub>2</sub>) computed from <bold>F</bold><sub>avg</sub> with respect to the movie frame number; (d) Average normalized sarcomere length with respect to the movie frame number. We note that the definitions of <bold>F</bold><sub>avg</sub>, λ<sub>1</sub>, and λ<sub>2</sub> are introduced in this text.</p>
      </caption>
      <graphic xlink:href="pcbi.1009443.g001" position="float"/>
    </fig>
    <p>To extract biologically relevant quantitative information from these movies, we focus primarily on segmenting, tracking, and analyzing individual sarcomeres. This would not be possible with alternative approaches where one average metric is computed per image. Each movie will typically have over 100 frames, and each frame will contain 100s of sarcomeres. Therefore, it is infeasible to perform segmentation and tracking by hand at scale. In the first component of our computational framework, we introduce a procedure for automated sarcomere segmentation and tracking that explicitly captures individual sarcomeres. Example results from segmentation and tracking are shown in <xref rid="pcbi.1009443.g001" ref-type="fig">Fig 1B</xref>.</p>
    <p>Building on effective segmentation and tracking, the second contribution of our computational framework is tools for automated analysis of hiPSC-CM contractile behavior. To accomplish this, we first draw inspiration from recent literature on defining summary metrics for describing cardiomyocyte structure and cytoskeletal structure [<xref rid="pcbi.1009443.ref011" ref-type="bibr">11</xref>, <xref rid="pcbi.1009443.ref018" ref-type="bibr">18</xref>] and mechanical deformation in multiple cell types [<xref rid="pcbi.1009443.ref019" ref-type="bibr">19</xref>, <xref rid="pcbi.1009443.ref020" ref-type="bibr">20</xref>]. Specifically, we treat the tracked sarcomeres as fiducial markers and quantify the principal directions and magnitudes of average cell contraction for each movie frame. An example of applying this approach is shown in <xref rid="pcbi.1009443.g001" ref-type="fig">Fig 1C</xref>, with <xref rid="pcbi.1009443.g001" ref-type="fig">Fig 1D</xref> for comparison. Then, we move beyond average metrics and extend our framework to readily perform spatiotemporal analysis of sub-cellular sarcomere contraction. Specifically, we treat the structurally disordered and complex hiPSC-CMs as spatial graphs where z-discs are represented as nodes and sarcomeres are represented as edges. With a spatial graph defined, performing spatial statistics based analysis is straightforward. For example, it is possible to examine the correlation between individual sarcomere contraction time series using both Euclidean and network distances.</p>
    <p>In conjunction with segmentation, tracking, and analysis, our computational framework—Sarc-Graph—also contains multiple visualization tools. The remainder of this paper is focused on describing key components of the framework. We note that all code is available free and open source on GitHub: <ext-link xlink:href="https://github.com/elejeune11/Sarc-Graph" ext-link-type="uri">https://github.com/elejeune11/Sarc-Graph</ext-link>. The code is designed in a modular way such that making major alterations to one component or performing only a subset of the segmentation, tracking, and analysis steps should be straightforward when appropriate. Looking forward, we anticipate that this work is a starting point for a major effort in quantification and statistical analysis of hiPSC-CM contractile behavior.</p>
  </sec>
  <sec sec-type="materials|methods" id="sec002">
    <title>Materials and methods</title>
    <sec id="sec003">
      <title>Data</title>
      <p>In general, it is infeasible to perform segmentation and tracking by hand at scale for movies of hiPSC-CMs with fluorescently labeled z-discs. To address the lack of “ground truth” data we invest significant effort in realistic synthetic data generation to validate the segmentation and tracking components of our computational framework. In addition, we show the results of applying our framework to a selection of real experimental movies.</p>
      <sec id="sec004">
        <title>Synthetic data for software validation</title>
        <p>In <xref rid="pcbi.1009443.g002" ref-type="fig">Fig 2</xref>, we show the critical components of the synthetic data generation pipeline. The first step is illustrated in <xref rid="pcbi.1009443.g002" ref-type="fig">Fig 2A</xref> where we show an example of generating the three-dimensional (3D) skeleton of z-disc and sarcomere geometry for each movie frame. First, a baseline geometry is defined. Then, the baseline geometry is deformed in space such that each sarcomere is associated with a ground truth function for contraction (shown here as fractional change in length) with respect to time. By starting with this 3D skeleton geometry, it is straightforward to include examples with inhomogeneous contraction, out of plane orientation and deformation, and sarcomere chains that appear to intersect when projected into two-dimensional (2D) space.</p>
        <fig position="float" id="pcbi.1009443.g002">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1009443.g002</object-id>
          <label>Fig 2</label>
          <caption>
            <p>Creating synthetic data to test the image analysis code: (a) Define the geometry of z-discs (points) and sarcomeres (line segments) in three-dimensional (3D) space and prescribe the ground truth deformation for each sarcomere; (b) Approximate each z-disc as an oriented cylinder in 3D space; (c) Convert the 3D geometry into a voxel array with higher resolution in the x and y directions than the z direction; (d) Slice and project the voxel array to obtain a two-dimensional (2D) image. Image noise and blur can be added to the voxel array, 2D image, or both.</p>
          </caption>
          <graphic xlink:href="pcbi.1009443.g002" position="float"/>
        </fig>
        <p>Given the 3D skeleton geometry in <xref rid="pcbi.1009443.g002" ref-type="fig">Fig 2A</xref>, we then render each frame as illustrated in <xref rid="pcbi.1009443.g002" ref-type="fig">Fig 2B–2D</xref>. First, each z-disc is treated as an oriented cylinder with an associated height and radius. We note that with this approach it is straightforward to include multiple z-disc sizes in the same image. Then, the domain is converted into a voxel array such that the resolution is representative of the experimental images of interest. The voxel array, a 3D matrix, is then sliced around the simulated focal plane and projected into 2D. Both image noise and blur can be added at the voxel array step, 2D image step, or both. In the representative examples shown here, we add Gaussian blur to the voxel array [<xref rid="pcbi.1009443.ref021" ref-type="bibr">21</xref>] and Perlin noise to the 2D image [<xref rid="pcbi.1009443.ref022" ref-type="bibr">22</xref>]. We note that the entire synthetic data generation pipeline is available on GitHub. All code is written in Python with heavy use of the numpy and matplotlib packages [<xref rid="pcbi.1009443.ref023" ref-type="bibr">23</xref>, <xref rid="pcbi.1009443.ref024" ref-type="bibr">24</xref>].</p>
      </sec>
      <sec id="sec005">
        <title>Experimental data for software demonstration</title>
        <p>The first two examples of experimental data included with this paper (E1 and E2) were previously made available in a publication by Toepfer et al. [<xref rid="pcbi.1009443.ref010" ref-type="bibr">10</xref>]. The protocol to introduce green fluorescent protein (GFP) onto z-disc protein titin (TTN-GFP) in hiPSC-CMs is reported in [<xref rid="pcbi.1009443.ref026" ref-type="bibr">26</xref>]. Video imaging was conducted on small clusters of hiPSC-CMs using a 100X objective of a fluorescent microscope with a minimum acquisition rate of 30 frames per second. The three additional examples included with this publication were selected to showcase the general applicability of Sarc-Graph. Cells in E3, E4, and E5 were fluorescently labeled using lentiviral constructs lenti-GFP-actinin-2 or lenti-mApple-actinin-2 as described in [<xref rid="pcbi.1009443.ref025" ref-type="bibr">25</xref>], and were electrically stimulated at 1Hz using the IonOptix C-Pace EP Culture Pacer (IonOptix) during imaging. Time-lapse videos of cell contraction were acquired at 30 frames per second using a 40x objective on a Nikon Eclipse Ti (Nikon Instruments, Inc.) with an Evolve EMCCD Camera (Photometrics) or on a Zeiss Axiovert 200M inverted spinning disk microscope with an ORCA-100 Camera (Hamamatsu), equipped with a temperature and CO2 equilibrated environmental chamber. We note that substantial additional detail on the experimental protocol has been provided in previous literature [<xref rid="pcbi.1009443.ref025" ref-type="bibr">25</xref>, <xref rid="pcbi.1009443.ref026" ref-type="bibr">26</xref>]. Key details are summarized in <xref rid="pcbi.1009443.t001" ref-type="table">Table 1</xref>. Though not included as examples with this publication, our computational framework has also been tested on additional beating hiPSC-CM movies obtained by different researchers with subtly different experimental set ups. The examples E3, E4, and E5 were deliberately chosen as diverse examples to challenge the performance of Sarc-Graph for multiple setups. We also note that for all examples shown in the main body of this paper, both experimental and synthetic, our framework does not require any parameter tuning. All input parameters are identical across all cases. To complement these data, we also analyze previously released data from other groups [<xref rid="pcbi.1009443.ref006" ref-type="bibr">6</xref>, <xref rid="pcbi.1009443.ref012" ref-type="bibr">12</xref>] in the <xref rid="pcbi.1009443.s001" ref-type="supplementary-material">S1</xref> and <xref rid="pcbi.1009443.s002" ref-type="supplementary-material">S2</xref> Texts. Though these examples are of images rather than movies, they provide an additional opportunity to showcase the capabilities of Sarc-Graph on image segmentation under more diverse conditions and compare the performance of Sarc-Graph to other already established approaches. Further details are given in the <xref rid="pcbi.1009443.s001" ref-type="supplementary-material">S1</xref> and <xref rid="pcbi.1009443.s002" ref-type="supplementary-material">S2</xref> Texts.</p>
        <table-wrap position="float" id="pcbi.1009443.t001">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1009443.t001</object-id>
          <label>Table 1</label>
          <caption>
            <title>Summary of experimental examples included in this paper (E1, E2, E3, E4, and E5).</title>
            <p>We note that Examples E1 and E2 have already been published and made publicly available at <ext-link xlink:href="https://github.com/HMS-IDAC/SarcTrack" ext-link-type="uri">https://github.com/HMS-IDAC/SarcTrack</ext-link> [<xref rid="pcbi.1009443.ref010" ref-type="bibr">10</xref>].</p>
          </caption>
          <alternatives>
            <graphic xlink:href="pcbi.1009443.t001" id="pcbi.1009443.t001g" position="float"/>
            <table frame="box" rules="all" border="0">
              <colgroup span="1">
                <col align="left" valign="middle" span="1"/>
                <col align="left" valign="middle" span="1"/>
                <col align="left" valign="middle" span="1"/>
                <col align="left" valign="middle" span="1"/>
              </colgroup>
              <thead>
                <tr>
                  <th align="left" style="border-top-width:thick" rowspan="1" colspan="1"/>
                  <th align="left" style="border-top-width:thick" rowspan="1" colspan="1">key information on the experimental data</th>
                  <th align="left" style="border-top-width:thick" rowspan="1" colspan="1">key Sarc-Graph analysis challenges</th>
                  <th align="left" style="border-top-width:thick" rowspan="1" colspan="1">additional info</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td align="left" rowspan="1" colspan="1">E1</td>
                  <td align="left" rowspan="1" colspan="1">hiPSC-CMs cultured on a fibronectin coated glass substrate, vertically aligned fibers.</td>
                  <td align="left" rowspan="1" colspan="1">large deformation</td>
                  <td align="left" rowspan="1" colspan="1">[<xref rid="pcbi.1009443.ref010" ref-type="bibr">10</xref>]</td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">E2</td>
                  <td align="left" rowspan="1" colspan="1">hiPSC-CMs cultured on a fibronectin coated glass substrate, tangentially aligned fibers.</td>
                  <td align="left" rowspan="1" colspan="1">large deformation</td>
                  <td align="left" rowspan="1" colspan="1">[<xref rid="pcbi.1009443.ref010" ref-type="bibr">10</xref>]</td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">E3</td>
                  <td align="left" rowspan="1" colspan="1">Single paced hiPSC-CM constrained on a micropatterned island (2000 <italic toggle="yes">μm</italic><sup>2</sup>) with fibronectin coating on top of soft polyacrylamide hydrogel (7.9 kPa). The method for making the hydrogel is described in [<xref rid="pcbi.1009443.ref025" ref-type="bibr">25</xref>].</td>
                  <td align="left" rowspan="1" colspan="1">low spatial resolution, large deformation</td>
                  <td align="left" rowspan="1" colspan="1">[<xref rid="pcbi.1009443.ref025" ref-type="bibr">25</xref>, <xref rid="pcbi.1009443.ref026" ref-type="bibr">26</xref>]</td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">E4</td>
                  <td align="left" rowspan="1" colspan="1">Monolayer of paced hiPSC-CMs cultured on a fibronectin-coated glass substrate.</td>
                  <td align="left" rowspan="1" colspan="1">substantial background signal</td>
                  <td align="left" rowspan="1" colspan="1">[<xref rid="pcbi.1009443.ref025" ref-type="bibr">25</xref>, <xref rid="pcbi.1009443.ref026" ref-type="bibr">26</xref>]</td>
                </tr>
                <tr>
                  <td align="left" style="border-bottom-width:thick" rowspan="1" colspan="1">E5</td>
                  <td align="left" style="border-bottom-width:thick" rowspan="1" colspan="1">Single paced hiPSC-CMs cultured on a fibronectin-coated glass substrate.</td>
                  <td align="left" style="border-bottom-width:thick" rowspan="1" colspan="1">low spatial resolution, small deformation</td>
                  <td align="left" style="border-bottom-width:thick" rowspan="1" colspan="1">[<xref rid="pcbi.1009443.ref025" ref-type="bibr">25</xref>, <xref rid="pcbi.1009443.ref026" ref-type="bibr">26</xref>]</td>
                </tr>
              </tbody>
            </table>
          </alternatives>
        </table-wrap>
      </sec>
    </sec>
    <sec id="sec006">
      <title>Code</title>
      <p>Sarc-Graph is divided into seven modular components: <monospace>file_pre_processing</monospace>, <monospace>segmentation</monospace>, <monospace>tracking</monospace>, <monospace>time_series</monospace>, <monospace>spatial_graph</monospace>, <monospace>analysis_tools</monospace>, and <monospace>functional_metrics</monospace>. The first, <monospace>file_pre_processing</monospace>, is simply used to convert each movie into a series of 2D numpy arrays [<xref rid="pcbi.1009443.ref023" ref-type="bibr">23</xref>], one for each frame of the movie converted to grayscale. The code is designed such that the only new step required to support a previously unsupported movie file format is a function to convert each frame into a 2D numpy array. The remainder of the code can loosely be grouped as <monospace>segmentation</monospace> which is necessary for extracting spatial data, <monospace>tracking</monospace> and <monospace>time_series</monospace> which are necessary for extracting temporal data, and <monospace>spatial_graph</monospace>, <monospace>analysis_tools</monospace>, and <monospace>functional_metrics</monospace> which are necessary for synthesizing and interpreting the spatial and temporal data.</p>
      <sec id="sec007">
        <title>Segmentation</title>
        <p>Within the <monospace>segmentation</monospace> script, the function <monospace>segmentation_all(folder_name, gaussian_filter_size)</monospace> will segment all z-discs and all sarcomeres from each frame. The first parameter, “<monospace>folder_name</monospace>” specifies the folder that the data is in. The second parameter, “<monospace>gaussian_filter_size</monospace>” specifies the standard deviation for the Gaussian kernel applied to the image during z-disc segmentation [<xref rid="pcbi.1009443.ref030" ref-type="bibr">30</xref>]. The default value for <monospace>gaussian_filter_size</monospace> = 1 and that is the value for all data shown in this paper. In our experience, a value of 2 may be more appropriate for movies of hiPSC-CMs that have high levels of irregular fluctuating background signal, and thus it is left as a potential tunable parameter with a default value of 1. The key steps of segmentation are illustrated in <xref rid="pcbi.1009443.g003" ref-type="fig">Fig 3</xref>. z-disc segmentation is conducted by computing the Laplacian of the image [<xref rid="pcbi.1009443.ref027" ref-type="bibr">27</xref>], applying a Gaussian filter to the Laplacian [<xref rid="pcbi.1009443.ref030" ref-type="bibr">30</xref>], and then using the scikit-image “<monospace>measure.find_contours()</monospace>” function [<xref rid="pcbi.1009443.ref031" ref-type="bibr">31</xref>] to identify contours with a level matching a scalar threshold computed via Otsu’s method [<xref rid="pcbi.1009443.ref028" ref-type="bibr">28</xref>]. We note briefly that a global threshold determined with Otsu’s method is sufficient (i.e., an adaptive threshold is not required) because thresholding is performed on the Laplacian rather than the original image. As illustrated in <xref rid="pcbi.1009443.g003" ref-type="fig">Fig 3C</xref>, each contour represents a segmented z-disc and the properties of each z-disc are computed algorithmically from the contours. Of note, contour position is computed as the mean position of each pixel in the contour, contour length is computed as the maximum possible distance between two pixels in the contour, and contour endpoints are the locations of the pixels that correspond to the maximum distance.</p>
        <fig position="float" id="pcbi.1009443.g003">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1009443.g003</object-id>
          <label>Fig 3</label>
          <caption>
            <p>Segmenting and tracking the z-discs and sarcomeres: (a) An example of a raw synthetic two-dimensional (2D) input image; (b) The Laplacian of the input image is used to detect the high gradients present at the edge of every z-disc [<xref rid="pcbi.1009443.ref027" ref-type="bibr">27</xref>]; (c) z-discs are identified as closed contours where the value of the Laplacian exceeds the threshold computed with Otsu’s method [<xref rid="pcbi.1009443.ref028" ref-type="bibr">28</xref>]; (d) Sarcomeres are procedurally identified from the segmented z-discs; (e) Sarcomeres and z-discs are tracked independently between frames with the Python trackpy package [<xref rid="pcbi.1009443.ref029" ref-type="bibr">29</xref>]; (f) The algorithm to segment sarcomeres is based on linking the approximately parallel z-discs to their closest neighbors in the direction perpendicular to the z-disc; (g) Sarcomere properties are computed from the pair of associated z-discs; (h) Tracking each sarcomere leads to multiple spatially resolved time series.</p>
          </caption>
          <graphic xlink:href="pcbi.1009443.g003" position="float"/>
        </fig>
        <p>Once z-discs are segmented, sarcomeres are procedurally identified from the segmented z-discs with a custom algorithm schematically illustrated in <xref rid="pcbi.1009443.g003" ref-type="fig">Fig 3F</xref>. In brief, the steps of the algorithm are as follows:</p>
        <list list-type="order">
          <list-item>
            <p>Compute the distance between the center of each z-discs and the center of its nearest neighbor.</p>
          </list-item>
          <list-item>
            <p>Define <monospace>median_neigh</monospace> as the median distance between a z-disc and its nearest neighbor.</p>
          </list-item>
          <list-item>
            <p>For each z-disc, define a line that goes through the center of the z-disc and is perpendicular to the axis defined by the contour endpoints. Then, define the two points on the line that are <monospace>median_neigh</monospace>/2 distance from the z-disc center. These points are referred to as “<monospace>ghost_points</monospace>.” This is illustrated in <xref rid="pcbi.1009443.g003" ref-type="fig">Fig 3F</xref>.</p>
          </list-item>
          <list-item>
            <p>Find the nearest neighbor for each point in <monospace>ghost_points</monospace>.</p>
          </list-item>
          <list-item>
            <p>If there is a two-way nearest neighbor match between a pair in <monospace>ghost_points</monospace>, the pair of z-discs will correspond to a segmented sarcomere.</p>
          </list-item>
        </list>
        <p>As illustrated in <xref rid="pcbi.1009443.g003" ref-type="fig">Fig 3F</xref>, this algorithm links approximately parallel z-discs. In order to flexibly accommodate potential image artifacts, the criteria for “approximately parallel” is not strictly defined. However, in most cases, there will not be a persistent two way nearest neighbor match unless z-discs bound a convex quadrilateral, ideally a trapezoid. If necessary, additional match rejection criteria could be integrated into the algorithm. Once a sarcomere is identified, its properties are computed from the properties of the corresponding paired z-discs. This is illustrated in <xref rid="pcbi.1009443.g003" ref-type="fig">Fig 3G</xref>. Of note, sarcomere width is computed as the mean length of the two z-discs, sarcomere length is computed as the distance between the two z-disc centers, and sarcomere angle is computed as the angle of the vector connecting the two z-disc centers.</p>
        <p>For the examples shown in this paper, the segmentation step takes order of 10s of seconds to a few minutes to run on a single laptop. We also note that users working with still images rather than movies can still segment z-discs and sarcomeres from a single frame, and can still create a spatial graph with their data and perform several aspects of the spatial analysis described in this paper. For generality, all length data is reported in units of pixels.</p>
      </sec>
      <sec id="sec008">
        <title>Tracking and processing time series data</title>
        <p>The <monospace>tracking</monospace> component of Sarc-Graph is for independently tracking all z-discs and all sarcomeres. Tracking the sarcomeres is necessary for reporting the relative length change from frame to frame. Without tracking, it is only possible to report population average relative length change which is substantially less information rich because the sarcomeres do not necessarily contract in perfect synchrony, and are not necessarily of identical lengths. We track the z-discs and sarcomeres independently because we use this information to construct a spatial graph, described later in the text. Tracking is performed by calling the “<monospace>run_all_tracking(folder_name,tp_depth)</monospace>” function. As stated previously, “<monospace>folder_name</monospace>” specifies the folder that the data is in. The second parameter, “<monospace>tp_depth</monospace>” specifies the farthest distance in pixels that a tracked entity can travel between frames [<xref rid="pcbi.1009443.ref029" ref-type="bibr">29</xref>]. The default value for <monospace>tp_depth</monospace> = 4 and that is the value for all data shown in this paper. In some cases, particularly for movies with lower spatial resolution, it is necessary to change to <monospace>tp_depth</monospace> = 3. Particle tracking is performed with the Python package trackpy which is based on the Crocker–Grier algorithm [<xref rid="pcbi.1009443.ref029" ref-type="bibr">29</xref>, <xref rid="pcbi.1009443.ref032" ref-type="bibr">32</xref>]. We note that we do not use trackpy for feature detection, instead we convert each segmented z-disc and sarcomere to a pandas DataFrame for compatibility with the trackpy framework [<xref rid="pcbi.1009443.ref033" ref-type="bibr">33</xref>]. The outcome of running <monospace>run_all_tracking()</monospace> is a unique ID for each particle that is tracked for over 10% of the movie. With this information, it is possible to locate each tracked particle in space across multiple frames, as illustrated in <xref rid="pcbi.1009443.g003" ref-type="fig">Fig 3E</xref> where the position of each sarcomere across all frames is plotted.</p>
        <p>The <monospace>time_series</monospace> component of our computational framework processes the results from <monospace>tracking</monospace> so that there is time series data describing the length, normalized length <inline-formula id="pcbi.1009443.e001"><alternatives><graphic xlink:href="pcbi.1009443.e001.jpg" id="pcbi.1009443.e001g" position="anchor"/><mml:math id="M1" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>L</mml:mi><mml:mo>-</mml:mo><mml:mover accent="true"><mml:mi>L</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mo>)</mml:mo></mml:mrow><mml:mo>/</mml:mo><mml:mover accent="true"><mml:mi>L</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:mrow></mml:math></alternatives></inline-formula>, width, angle, and position for each tracked sarcomere. This is accomplished by running the function “<monospace>timeseries_all(folder_name, keep_thresh)</monospace>” where <monospace>keep_thresh</monospace> represents the fraction of movie frames that a tracked sarcomere must be present in to get processed. We recommend <monospace>keep_thresh</monospace> = 0.75 for quantitative analysis of time series data and <monospace>keep_thresh</monospace>&gt;1/<italic toggle="yes">k</italic> for visualization, where <italic toggle="yes">k</italic> is the approximate number of times the cell contracts during one movie. To process the results from <monospace>tracking</monospace>, Gaussian process regression is used to interpolate data across frames which temporarily lose signal [<xref rid="pcbi.1009443.ref034" ref-type="bibr">34</xref>]. Gaussian process regression is implemented through python scikit-learn with a radial basis function (RBF) and white noise kernel [<xref rid="pcbi.1009443.ref035" ref-type="bibr">35</xref>]. In addition to interpolating between lost frames, Gaussian process regression has the added benefit of adaptively smoothing the data without a need for additional dataset-specific input parameters. The main result of running the <monospace>timeseries_all</monospace> function is illustrated in <xref rid="pcbi.1009443.g003" ref-type="fig">Fig 3H</xref> where normalized sarcomere length is plotted with respect to frame number. Even with this synthetic data example, the individual recovered time series deviate from the ground truth. This is for two main reasons. First, for the ground truth geometry that we specified, some sarcomeres are angled out of the image z-plane and are thus not perfectly captured by a 2D image. Second, the limited resolution of the images introduces artifacts where lengths less than 1 pixel cannot be perfectly captured. However, the mean of all time series curves illustrated in <xref rid="pcbi.1009443.g003" ref-type="fig">Fig 3H</xref> is a near perfect fit to the ground truth.</p>
        <p>For the examples shown in this paper, the <monospace>tracking</monospace> step takes order of 10s of seconds to a minute to run on a single laptop. The <monospace>time_series</monospace> step takes on the order of 10s of seconds to a few minutes to run. The <monospace>time_series</monospace> step will output several user friendly text files describing sarcomere properties with respect to time where each row corresponds to a tracked sarcomere and each column corresponds to a movie frame. The normalized length data can be automatically plotted with the function <monospace>plot_normalized_tracked_timeseries()</monospace> from the <monospace>analysis_tools</monospace> file. For generality, all time data is reported in units of frames.</p>
      </sec>
      <sec id="sec009">
        <title>Computing average deformation (F<sub>avg</sub>)</title>
        <p>Developing methods to describe data rich images and movies of cells with a tractable set of output parameters is an active area of research [<xref rid="pcbi.1009443.ref011" ref-type="bibr">11</xref>, <xref rid="pcbi.1009443.ref036" ref-type="bibr">36</xref>]. In this paper specifically, we draw inspiration from recent work on summarizing data from traction force microscopy experiments [<xref rid="pcbi.1009443.ref020" ref-type="bibr">20</xref>] and agent based model simulations [<xref rid="pcbi.1009443.ref037" ref-type="bibr">37</xref>, <xref rid="pcbi.1009443.ref038" ref-type="bibr">38</xref>] and propose a method to compute the mean deformation gradient of each domain with respect to time. First, we define the standard continuum mechanics deformation gradient <bold>F</bold> as follows:
<disp-formula id="pcbi.1009443.e002"><alternatives><graphic xlink:href="pcbi.1009443.e002.jpg" id="pcbi.1009443.e002g" position="anchor"/><mml:math id="M2" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mspace width="4pt"/><mml:mi mathvariant="bold">F</mml:mi><mml:mspace width="0.166667em"/><mml:mi>d</mml:mi><mml:mi mathvariant="bold">X</mml:mi><mml:mo>=</mml:mo><mml:mi>d</mml:mi><mml:mi mathvariant="bold">x</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(1)</label></disp-formula>
where <italic toggle="yes">d</italic><bold>X</bold> is a vector in the initial configuration, <italic toggle="yes">d</italic><bold>x</bold> is the vector in the deformed configuration, and <bold>F</bold> is the mapping between them [<xref rid="pcbi.1009443.ref039" ref-type="bibr">39</xref>]. In the context of analyzing movies of contracting hiPSC-CMs, we first define a set of <italic toggle="yes">n</italic> vectors <bold>v</bold> that connect each potential pair of tracked fiducial markers, as illustrated in <xref rid="pcbi.1009443.g004" ref-type="fig">Fig 4A</xref>. The direction and magnitude of each vector <bold>v</bold> will change as the fiducial markers move between movie frames. With this definition, we can set up the over-determined system of equations:
<disp-formula id="pcbi.1009443.e003"><alternatives><graphic xlink:href="pcbi.1009443.e003.jpg" id="pcbi.1009443.e003g" position="anchor"/><mml:math id="M3" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mspace width="4pt"/><mml:msub><mml:mi mathvariant="bold">F</mml:mi><mml:mtext>avg</mml:mtext></mml:msub><mml:mspace width="0.166667em"/><mml:msub><mml:mo mathvariant="bold">Λ</mml:mo><mml:mn>0</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mo mathvariant="bold">Λ</mml:mo><mml:mspace width="2em"/><mml:mtext>where</mml:mtext><mml:mspace width="2em"/><mml:msub><mml:mo mathvariant="bold">Λ</mml:mo><mml:mn>0</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:msub><mml:mi mathvariant="bold">v</mml:mi><mml:mn>01</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="bold">v</mml:mi><mml:mn>02</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="bold">v</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>]</mml:mo></mml:mrow><mml:mspace width="2em"/><mml:mtext>and</mml:mtext><mml:mspace width="2em"/><mml:mo mathvariant="bold">Λ</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:msub><mml:mi mathvariant="bold">v</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="bold">v</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="bold">v</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(2)</label></disp-formula>
where <bold>F</bold><sub>avg</sub> is a 2 × 2 matrix, <bold>Λ</bold><sub>0</sub> is a 2 × <italic toggle="yes">n</italic> matrix of vectors in the initial (reference) configuration movie frame, and <bold>Λ</bold> is a 2 × <italic toggle="yes">n</italic> matrix of vectors in the current (deformed) configuration movie frame. Note that when the initial frame and the current frame are identical, <bold>Λ</bold><sub>0</sub> = <bold>Λ</bold> and <bold>F</bold><sub>avg</sub> = <bold>I</bold>. The initial configuration can be defined as either the first frame of the movie, or a selected movie frame where the cell is known to be in a relaxed state. Then, we can use the normal equation to solve for the best fit average deformation gradient as:
<disp-formula id="pcbi.1009443.e004"><alternatives><graphic xlink:href="pcbi.1009443.e004.jpg" id="pcbi.1009443.e004g" position="anchor"/><mml:math id="M4" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mspace width="4pt"/><mml:msub><mml:mi mathvariant="bold">F</mml:mi><mml:mtext>avg</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:mo mathvariant="bold">Λ</mml:mo><mml:msubsup><mml:mo mathvariant="bold">Λ</mml:mo><mml:mn>0</mml:mn><mml:mi mathvariant="normal">T</mml:mi></mml:msubsup><mml:mspace width="0.166667em"/><mml:msup><mml:mrow><mml:mo>[</mml:mo><mml:mspace width="0.166667em"/><mml:msub><mml:mo mathvariant="bold">Λ</mml:mo><mml:mn>0</mml:mn></mml:msub><mml:msubsup><mml:mo mathvariant="bold">Λ</mml:mo><mml:mn>0</mml:mn><mml:mi mathvariant="normal">T</mml:mi></mml:msubsup><mml:mspace width="0.166667em"/><mml:mo>]</mml:mo></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mspace width="0.166667em"/><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(3)</label></disp-formula></p>
        <fig position="float" id="pcbi.1009443.g004">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1009443.g004</object-id>
          <label>Fig 4</label>
          <caption>
            <p>Data analysis from segmentation and tracking: (a) Tracked elements are treated as fiducial markers and used to construct an average deformation gradient <bold>F</bold> (see Eqs <xref rid="pcbi.1009443.e002" ref-type="disp-formula">1</xref>–<xref rid="pcbi.1009443.e005" ref-type="disp-formula">4</xref>); (b) z-discs and sarcomeres are tracked independently and used to construct a spatial graph (z-discs are “nodes” and sarcomeres are “edges”, edge color corresponds to sarcomere orientation, node color corresponds to correlation in sarcomere orientation) to measure correlations based on network distance; (c) Automated analysis of time series data is used to extract constants such as mean contraction time and number of peaks.</p>
          </caption>
          <graphic xlink:href="pcbi.1009443.g004" position="float"/>
        </fig>
        <p>Once computed, the components of <bold>F</bold><sub>avg</sub> can be plotted directly, or <bold>F</bold><sub>avg</sub> can be manipulated to provide information that is more convenient to compare and interpret. For example, we can write
<disp-formula id="pcbi.1009443.e005"><alternatives><graphic xlink:href="pcbi.1009443.e005.jpg" id="pcbi.1009443.e005g" position="anchor"/><mml:math id="M5" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mspace width="4pt"/><mml:msub><mml:mi mathvariant="bold">F</mml:mi><mml:mtext>avg</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi mathvariant="bold">R</mml:mi><mml:mtext>avg</mml:mtext></mml:msub><mml:msub><mml:mi mathvariant="bold">U</mml:mi><mml:mtext>avg</mml:mtext></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(4)</label></disp-formula>
where <bold>R</bold><sub>avg</sub> is a rotation tensor and <bold>U</bold><sub>avg</sub> is a symmetric positive definite tensor that represents stretch. In the numerical setting, <bold>R</bold><sub>avg</sub> and <bold>U</bold><sub>avg</sub> are computed with the scipy polar decomposition function [<xref rid="pcbi.1009443.ref030" ref-type="bibr">30</xref>]. We can also compute the eigenvalues and eigenvectors of <bold>U</bold><sub>avg</sub>, <inline-formula id="pcbi.1009443.e006"><alternatives><graphic xlink:href="pcbi.1009443.e006.jpg" id="pcbi.1009443.e006g" position="anchor"/><mml:math id="M6" display="inline" overflow="scroll"><mml:msubsup><mml:mo>λ</mml:mo><mml:mn>1</mml:mn><mml:mtext>avg</mml:mtext></mml:msubsup></mml:math></alternatives></inline-formula>, <inline-formula id="pcbi.1009443.e007"><alternatives><graphic xlink:href="pcbi.1009443.e007.jpg" id="pcbi.1009443.e007g" position="anchor"/><mml:math id="M7" display="inline" overflow="scroll"><mml:msubsup><mml:mo>λ</mml:mo><mml:mn>2</mml:mn><mml:mtext>avg</mml:mtext></mml:msubsup></mml:math></alternatives></inline-formula>, <inline-formula id="pcbi.1009443.e008"><alternatives><graphic xlink:href="pcbi.1009443.e008.jpg" id="pcbi.1009443.e008g" position="anchor"/><mml:math id="M8" display="inline" overflow="scroll"><mml:msubsup><mml:mi mathvariant="bold">u</mml:mi><mml:mn>1</mml:mn><mml:mtext>avg</mml:mtext></mml:msubsup></mml:math></alternatives></inline-formula>, and <inline-formula id="pcbi.1009443.e009"><alternatives><graphic xlink:href="pcbi.1009443.e009.jpg" id="pcbi.1009443.e009g" position="anchor"/><mml:math id="M9" display="inline" overflow="scroll"><mml:msubsup><mml:mi mathvariant="bold">u</mml:mi><mml:mn>2</mml:mn><mml:mtext>avg</mml:mtext></mml:msubsup></mml:math></alternatives></inline-formula> respectively. In the numerical setting, this is done with the numpy linalg package, and we always define <inline-formula id="pcbi.1009443.e010"><alternatives><graphic xlink:href="pcbi.1009443.e010.jpg" id="pcbi.1009443.e010g" position="anchor"/><mml:math id="M10" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mo>λ</mml:mo><mml:mn>1</mml:mn><mml:mtext>avg</mml:mtext></mml:msubsup><mml:mo>&lt;</mml:mo><mml:msubsup><mml:mo>λ</mml:mo><mml:mn>2</mml:mn><mml:mtext>avg</mml:mtext></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> [<xref rid="pcbi.1009443.ref023" ref-type="bibr">23</xref>]. From a mechanical data interpretation perspective, the average stretch values <inline-formula id="pcbi.1009443.e011"><alternatives><graphic xlink:href="pcbi.1009443.e011.jpg" id="pcbi.1009443.e011g" position="anchor"/><mml:math id="M11" display="inline" overflow="scroll"><mml:msubsup><mml:mo>λ</mml:mo><mml:mn>1</mml:mn><mml:mtext>avg</mml:mtext></mml:msubsup></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1009443.e012"><alternatives><graphic xlink:href="pcbi.1009443.e012.jpg" id="pcbi.1009443.e012g" position="anchor"/><mml:math id="M12" display="inline" overflow="scroll"><mml:msubsup><mml:mo>λ</mml:mo><mml:mn>2</mml:mn><mml:mtext>avg</mml:mtext></mml:msubsup></mml:math></alternatives></inline-formula> and the associated eigenvectors are particularly convenient because they contain information about both the magnitude and direction of contraction. This is illustrated in <xref rid="pcbi.1009443.g001" ref-type="fig">Fig 1B and 1C</xref>.</p>
        <p>Because sarcomere data is already processed through the <monospace>time_series</monospace> component of our framework, we use the sarcomeres as our fiducial markers to define <bold>Λ</bold> and <bold>Λ</bold><sub>0</sub>. We note that this approach would be just as effective with the z-discs chosen as fiducial markers. In addition, if 3D data was available, this approach would still work with <bold>F</bold><sub>avg</sub> as a 3 × 3 matrix and <bold>Λ</bold> and <bold>Λ</bold><sub>0</sub> as 3 × <italic toggle="yes">n</italic> matrices. Within the <monospace>analysis_tools</monospace> file, the function <monospace>compute_F_whole_movie()</monospace> will compute <bold>F</bold><sub>avg</sub> for each movie frame. The function <monospace>visualize_F_full_movie()</monospace> will create a visualization of <inline-formula id="pcbi.1009443.e013"><alternatives><graphic xlink:href="pcbi.1009443.e013.jpg" id="pcbi.1009443.e013g" position="anchor"/><mml:math id="M13" display="inline" overflow="scroll"><mml:msubsup><mml:mo>λ</mml:mo><mml:mn>1</mml:mn><mml:mtext>avg</mml:mtext></mml:msubsup></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1009443.e014"><alternatives><graphic xlink:href="pcbi.1009443.e014.jpg" id="pcbi.1009443.e014g" position="anchor"/><mml:math id="M14" display="inline" overflow="scroll"><mml:msubsup><mml:mo>λ</mml:mo><mml:mn>2</mml:mn><mml:mtext>avg</mml:mtext></mml:msubsup></mml:math></alternatives></inline-formula> as a function of the movie frame and schematically illustrate <bold>F</bold><sub>avg</sub> overlaid on the original image data, as shown in <xref rid="pcbi.1009443.g001" ref-type="fig">Fig 1</xref>. The computational cost of computing and processing <bold>F</bold><sub>avg</sub> for all frames is on the order of seconds to 10s of seconds on a single laptop. The computational cost of data visualization is on the order of 10s of seconds to minutes.</p>
      </sec>
      <sec id="sec010">
        <title>Comparing average deformation (F<sub>avg</sub>) to average sarcomere shortening (<inline-formula id="pcbi.1009443.e015"><alternatives><graphic xlink:href="pcbi.1009443.e015.jpg" id="pcbi.1009443.e015g" position="anchor"/><mml:math id="M15" display="inline" overflow="scroll"><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo>˜</mml:mo></mml:mover></mml:math></alternatives></inline-formula>, <italic toggle="yes">s</italic><sub>avg</sub>) and Orientational Order Parameter (OOP)</title>
        <p>In addition to defining tensor <bold>F</bold><sub>avg</sub> as a dynamic metric that evolves over the course of the entire beating hiPSC-CM movie, it is possible to formulate scalar metrics from <bold>F</bold><sub>avg</sub> that are more straightforward to directly compare to well established metrics for describing hiPSC-CMs [<xref rid="pcbi.1009443.ref007" ref-type="bibr">7</xref>]. Here we focus on defining scalar metrics from <bold>F</bold><sub>avg</sub> that are directly comparable to average sarcomere shortening (<inline-formula id="pcbi.1009443.e016"><alternatives><graphic xlink:href="pcbi.1009443.e016.jpg" id="pcbi.1009443.e016g" position="anchor"/><mml:math id="M16" display="inline" overflow="scroll"><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo>˜</mml:mo></mml:mover></mml:math></alternatives></inline-formula>, <italic toggle="yes">s</italic><sub>avg</sub>) [<xref rid="pcbi.1009443.ref010" ref-type="bibr">10</xref>], and the Orientational Order Parameter (OOP) [<xref rid="pcbi.1009443.ref011" ref-type="bibr">11</xref>, <xref rid="pcbi.1009443.ref014" ref-type="bibr">14</xref>, <xref rid="pcbi.1009443.ref040" ref-type="bibr">40</xref>].</p>
        <p>We compute average sarcomere shortening in two different ways. In both cases, we work with the normalized sarcomere length obtained from <monospace>time_series</monospace>
<inline-formula id="pcbi.1009443.e017"><alternatives><graphic xlink:href="pcbi.1009443.e017.jpg" id="pcbi.1009443.e017g" position="anchor"/><mml:math id="M17" display="inline" overflow="scroll"><mml:mrow><mml:mi>y</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mi>L</mml:mi><mml:mo>-</mml:mo><mml:mover accent="true"><mml:mi>L</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mo>)</mml:mo></mml:mrow><mml:mo>/</mml:mo><mml:mover accent="true"><mml:mi>L</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:mrow></mml:math></alternatives></inline-formula> where <italic toggle="yes">L</italic> is sarcomere length in pixels. Given normalized sarcomere length <italic toggle="yes">y</italic> for each movie frame, we define shortening as:
<disp-formula id="pcbi.1009443.e018"><alternatives><graphic xlink:href="pcbi.1009443.e018.jpg" id="pcbi.1009443.e018g" position="anchor"/><mml:math id="M18" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mspace width="4pt"/><mml:mi>s</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mtext>max</mml:mtext></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mtext>min</mml:mtext></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mtext>max</mml:mtext></mml:msub><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfrac></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(5)</label></disp-formula>
where <italic toggle="yes">y</italic><sub>max</sub> is the maximum normalized length and <italic toggle="yes">y</italic><sub>min</sub> is the minimum normalized length. We note briefly that this is equivalent to defining <italic toggle="yes">s</italic> = (<italic toggle="yes">L</italic><sub>max</sub> − <italic toggle="yes">L</italic><sub>min</sub>)/<italic toggle="yes">L</italic><sub>max</sub>. Then, we can define <inline-formula id="pcbi.1009443.e019"><alternatives><graphic xlink:href="pcbi.1009443.e019.jpg" id="pcbi.1009443.e019g" position="anchor"/><mml:math id="M19" display="inline" overflow="scroll"><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo>˜</mml:mo></mml:mover></mml:math></alternatives></inline-formula> as the median value of <italic toggle="yes">s</italic> for all sarcomeres tracked in the movie. We choose to use median rather than mean in this case because the mean is more susceptible to outliers and thus <inline-formula id="pcbi.1009443.e020"><alternatives><graphic xlink:href="pcbi.1009443.e020.jpg" id="pcbi.1009443.e020g" position="anchor"/><mml:math id="M20" display="inline" overflow="scroll"><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo>˜</mml:mo></mml:mover></mml:math></alternatives></inline-formula> is a better reflection of the ground truth sarcomere deformation. In addition, we can compute the mean normalized length time series <italic toggle="yes">y</italic><sub>avg</sub> and then compute <italic toggle="yes">s</italic><sub>avg</sub> based on the single mean time series. If all sarcomeres are contracting identically, <inline-formula id="pcbi.1009443.e021"><alternatives><graphic xlink:href="pcbi.1009443.e021.jpg" id="pcbi.1009443.e021g" position="anchor"/><mml:math id="M21" display="inline" overflow="scroll"><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo>˜</mml:mo></mml:mover></mml:math></alternatives></inline-formula> and <italic toggle="yes">s</italic><sub>avg</sub> will be identical. However, if this is not the case, the two values will likely differ and <inline-formula id="pcbi.1009443.e022"><alternatives><graphic xlink:href="pcbi.1009443.e022.jpg" id="pcbi.1009443.e022g" position="anchor"/><mml:math id="M22" display="inline" overflow="scroll"><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo>˜</mml:mo></mml:mover></mml:math></alternatives></inline-formula> will reflect average individual sarcomere behavior while <italic toggle="yes">s</italic><sub>avg</sub> will reflect both individual sarcomeres and the (lack of) synchrony between them. Functions to compute <inline-formula id="pcbi.1009443.e023"><alternatives><graphic xlink:href="pcbi.1009443.e023.jpg" id="pcbi.1009443.e023g" position="anchor"/><mml:math id="M23" display="inline" overflow="scroll"><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo>˜</mml:mo></mml:mover></mml:math></alternatives></inline-formula> and <italic toggle="yes">s</italic><sub>avg</sub> are given in the <monospace>functional_metrics</monospace> component of Sarc-Graph.</p>
        <p>In addition to computing mean sarcomere shortening, we specify the method for computing OOP from hiPSC-CM movies that we implement in the <monospace>functional_metrics</monospace> component of Sarc-Graph. When hiPSC-CMs are fully relaxed, individual sarcomere chains are no longer under systolic tension and can thus become wavy and lose local alignment. Therefore, the first step to computing OOP is to define a frame of the movie where the lowest fraction of sarcomere chains will be in their relaxed and potentially wavy configuration. To select this frame, we compute det(<bold>F</bold><sub>avg</sub>) for every movie frame with the first frame of the movie used as the reference configuration. Then, we identify the frame where det(<bold>F</bold><sub>avg</sub>) is the greatest (i.e. the sarcomeres are most relaxed) and select that frame as the reference frame and recompute <bold>F</bold><sub>avg</sub>. With the appropriately selected reference frame, we re-compute det(<bold>F</bold><sub>avg</sub>) and define the most contracted frame as the frame with the lowest value of det(<bold>F</bold><sub>avg</sub>).</p>
        <p>We compute OOP for the static image corresponding to the most contracted frame of the movie. To do this, we define structural tensor <inline-formula id="pcbi.1009443.e024"><alternatives><graphic xlink:href="pcbi.1009443.e024.jpg" id="pcbi.1009443.e024g" position="anchor"/><mml:math id="M24" display="inline" overflow="scroll"><mml:mi mathvariant="double-struck">T</mml:mi></mml:math></alternatives></inline-formula> following the literature:
<disp-formula id="pcbi.1009443.e025"><alternatives><graphic xlink:href="pcbi.1009443.e025.jpg" id="pcbi.1009443.e025g" position="anchor"/><mml:math id="M25" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mspace width="4pt"/><mml:mi mathvariant="double-struck">T</mml:mi><mml:mspace width="0.166667em"/><mml:mo>=</mml:mo><mml:mspace width="0.166667em"/><mml:mo>⟨</mml:mo><mml:mspace width="0.166667em"/><mml:mn>2</mml:mn><mml:mo>[</mml:mo><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msubsup><mml:mi>r</mml:mi><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msubsup><mml:msubsup><mml:mi>r</mml:mi><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msubsup></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:msubsup><mml:mi>r</mml:mi><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msubsup><mml:msubsup><mml:mi>r</mml:mi><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msubsup></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msubsup><mml:mi>r</mml:mi><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msubsup><mml:msubsup><mml:mi>r</mml:mi><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msubsup></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:msubsup><mml:mi>r</mml:mi><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msubsup><mml:msubsup><mml:mi>r</mml:mi><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msubsup></mml:mrow></mml:mtd></mml:mtr></mml:mtable><mml:mo>]</mml:mo><mml:mspace width="0.166667em"/><mml:mo>-</mml:mo><mml:mspace width="0.166667em"/><mml:mo>[</mml:mo><mml:mtable><mml:mtr><mml:mtd><mml:mn>1</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>1</mml:mn></mml:mtd></mml:mtr></mml:mtable><mml:mo>]</mml:mo><mml:mspace width="0.166667em"/><mml:mo>⟩</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(6)</label></disp-formula>
where <inline-formula id="pcbi.1009443.e026"><alternatives><graphic xlink:href="pcbi.1009443.e026.jpg" id="pcbi.1009443.e026g" position="anchor"/><mml:math id="M26" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mi mathvariant="bold">r</mml:mi><mml:mi>i</mml:mi></mml:msup><mml:mo>=</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:msubsup><mml:mi>r</mml:mi><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>r</mml:mi><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msubsup><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> is the unit vector describing the orientation of the <italic toggle="yes">i</italic><sup>th</sup> sarcomere [<xref rid="pcbi.1009443.ref014" ref-type="bibr">14</xref>]. The structural tensor contains information about the amount and direction of sarcomere alignment. Given <inline-formula id="pcbi.1009443.e027"><alternatives><graphic xlink:href="pcbi.1009443.e027.jpg" id="pcbi.1009443.e027g" position="anchor"/><mml:math id="M27" display="inline" overflow="scroll"><mml:mi mathvariant="double-struck">T</mml:mi></mml:math></alternatives></inline-formula>, with eigenvalues <italic toggle="yes">a</italic><sub>max</sub> and <italic toggle="yes">a</italic><sub>min</sub> and corresponding unit eigenvectors <bold>v</bold><sub>max</sub> and <bold>v</bold><sub>min</sub>, OOP = <italic toggle="yes">a</italic><sub>max</sub>. When OOP = 0.0, sarcomeres are oriented randomly. When OOP = 1.0, sarcomeres are perfectly aligned. Corresponding eigenvector <bold>v</bold><sub>max</sub> corresponds to the dominant direction of sarcomere orientation.</p>
        <p>In order to best relate <bold>F</bold><sub>avg</sub> to OOP, we define two scalar metrics <italic toggle="yes">C</italic><sub>iso</sub> and <italic toggle="yes">C</italic><sub>∥</sub> that describe average radial contraction, and contraction in the direction of dominant sarcomere orientation <bold>v</bold><sub>max</sub> respectively. Unlike individual sarcomere contraction or the average of individual sarcomere contraction, <italic toggle="yes">C</italic><sub>iso</sub> and <italic toggle="yes">C</italic><sub>∥</sub> represent deformation throughout the whole domain and not necessarily along the sarcomere axis. Metric <italic toggle="yes">C</italic><sub>iso</sub> is defined as
<disp-formula id="pcbi.1009443.e028"><alternatives><graphic xlink:href="pcbi.1009443.e028.jpg" id="pcbi.1009443.e028g" position="anchor"/><mml:math id="M28" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mspace width="4pt"/><mml:msub><mml:mi>C</mml:mi><mml:mtext>iso</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>.</mml:mo><mml:mn>0</mml:mn><mml:mo>-</mml:mo><mml:mroot><mml:mrow><mml:mtext>det</mml:mtext><mml:mo>(</mml:mo><mml:msub><mml:mi mathvariant="bold">F</mml:mi><mml:mtext>avg</mml:mtext></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mtext>dim</mml:mtext></mml:mroot></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(7)</label></disp-formula>
where <bold>F</bold><sub>avg</sub> is computed in the most contracted frame and dim = 2 for the results presented in this paper (for extension to 3<italic toggle="yes">D</italic>, dim = 3). Practically, <italic toggle="yes">C</italic><sub>iso</sub> is the line shortening during contraction of an equivalent system where contraction is not directionally dependent. When <italic toggle="yes">C</italic><sub>iso</sub> = 0.0, no shortening occurs. As an example, a value <italic toggle="yes">C</italic><sub>iso</sub> = 0.10 corresponds to an equivalent isotropic line shortening of 10% in all directions. Essentially, higher <italic toggle="yes">C</italic><sub>iso</sub> indicates higher levels of hiPSC-CM contraction.</p>
        <p>To quantify shortening in the dominant direction specified by <bold>v</bold><sub>max</sub> computed from <inline-formula id="pcbi.1009443.e029"><alternatives><graphic xlink:href="pcbi.1009443.e029.jpg" id="pcbi.1009443.e029g" position="anchor"/><mml:math id="M29" display="inline" overflow="scroll"><mml:mi mathvariant="double-struck">T</mml:mi></mml:math></alternatives></inline-formula>, we consider the relation <bold>F</bold><sub>avg</sub><bold>v</bold><sub>0</sub> = <bold>v</bold><sub>max</sub> where <bold>v</bold><sub>0</sub> is the corresponding vector defined in the reference frame. We can manipulate this equation to compute <inline-formula id="pcbi.1009443.e030"><alternatives><graphic xlink:href="pcbi.1009443.e030.jpg" id="pcbi.1009443.e030g" position="anchor"/><mml:math id="M30" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi mathvariant="bold">v</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mi mathvariant="bold">F</mml:mi><mml:mrow><mml:mtext>avg</mml:mtext></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:msub><mml:mi mathvariant="bold">v</mml:mi><mml:mtext>max</mml:mtext></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> and then define <italic toggle="yes">C</italic><sub>∥</sub> as
<disp-formula id="pcbi.1009443.e031"><alternatives><graphic xlink:href="pcbi.1009443.e031.jpg" id="pcbi.1009443.e031g" position="anchor"/><mml:math id="M31" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mspace width="4pt"/><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mo>∥</mml:mo></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:msub><mml:mi mathvariant="bold">v</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mrow><mml:mo>|</mml:mo><mml:mo>-</mml:mo><mml:mo>|</mml:mo></mml:mrow><mml:msub><mml:mi mathvariant="bold">v</mml:mi><mml:mtext>max</mml:mtext></mml:msub><mml:mrow><mml:mo>|</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:msub><mml:mi mathvariant="bold">v</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mrow><mml:mo>|</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mspace width="0.166667em"/><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(8)</label></disp-formula></p>
        <p>With this definition, <italic toggle="yes">C</italic><sub>∥</sub> is the fractional shortening of a line in the direction of <bold>v</bold><sub>max</sub> where direction is defined in the contracted configuration. Conveniently, lower <inline-formula id="pcbi.1009443.e032"><alternatives><graphic xlink:href="pcbi.1009443.e032.jpg" id="pcbi.1009443.e032g" position="anchor"/><mml:math id="M32" display="inline" overflow="scroll"><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo>˜</mml:mo></mml:mover></mml:math></alternatives></inline-formula> and <italic toggle="yes">s</italic><sub>avg</sub>, <italic toggle="yes">C</italic><sub>iso</sub>, and <italic toggle="yes">C</italic><sub>∥</sub> all correspond to lower levels of contraction, and higher <inline-formula id="pcbi.1009443.e033"><alternatives><graphic xlink:href="pcbi.1009443.e033.jpg" id="pcbi.1009443.e033g" position="anchor"/><mml:math id="M33" display="inline" overflow="scroll"><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo>˜</mml:mo></mml:mover></mml:math></alternatives></inline-formula> and <italic toggle="yes">s</italic><sub>avg</sub>, <italic toggle="yes">C</italic><sub>iso</sub>, and <italic toggle="yes">C</italic><sub>∥</sub> all correspond to higher levels of contraction.</p>
        <p>Functions to compute and visualize <inline-formula id="pcbi.1009443.e034"><alternatives><graphic xlink:href="pcbi.1009443.e034.jpg" id="pcbi.1009443.e034g" position="anchor"/><mml:math id="M34" display="inline" overflow="scroll"><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo>˜</mml:mo></mml:mover></mml:math></alternatives></inline-formula>, <italic toggle="yes">s</italic><sub>avg</sub>, OOP, <italic toggle="yes">C</italic><sub>iso</sub>, and <italic toggle="yes">C</italic><sub>∥</sub> are all defined in the <monospace>functional_metrics</monospace> script. The function “<monospace>compute_metrics</monospace>” will compute <inline-formula id="pcbi.1009443.e035"><alternatives><graphic xlink:href="pcbi.1009443.e035.jpg" id="pcbi.1009443.e035g" position="anchor"/><mml:math id="M35" display="inline" overflow="scroll"><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo>˜</mml:mo></mml:mover></mml:math></alternatives></inline-formula>, <italic toggle="yes">s</italic><sub>avg</sub>, OOP, <italic toggle="yes">C</italic><sub>iso</sub>, and <italic toggle="yes">C</italic><sub>∥</sub> and create a visualization of OOP and <bold>F</bold><sub>avg</sub>. The function “<monospace>visualize_lambda_as_functional_metric</monospace>” will create a movie of <inline-formula id="pcbi.1009443.e036"><alternatives><graphic xlink:href="pcbi.1009443.e036.jpg" id="pcbi.1009443.e036g" position="anchor"/><mml:math id="M36" display="inline" overflow="scroll"><mml:msubsup><mml:mo>λ</mml:mo><mml:mn>1</mml:mn><mml:mtext>avg</mml:mtext></mml:msubsup></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1009443.e037"><alternatives><graphic xlink:href="pcbi.1009443.e037.jpg" id="pcbi.1009443.e037g" position="anchor"/><mml:math id="M37" display="inline" overflow="scroll"><mml:msubsup><mml:mo>λ</mml:mo><mml:mn>2</mml:mn><mml:mtext>avg</mml:mtext></mml:msubsup></mml:math></alternatives></inline-formula> changing over the course of the movie. Examples of this are provided as Supplementary Information. The computational cost of computing <bold>F</bold><sub>avg</sub> (including computing <italic toggle="yes">C</italic><sub>iso</sub>, and <italic toggle="yes">C</italic><sub>∥</sub>) and <inline-formula id="pcbi.1009443.e038"><alternatives><graphic xlink:href="pcbi.1009443.e038.jpg" id="pcbi.1009443.e038g" position="anchor"/><mml:math id="M38" display="inline" overflow="scroll"><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo>˜</mml:mo></mml:mover></mml:math></alternatives></inline-formula>, <italic toggle="yes">s</italic><sub>avg</sub>, and OOP for all frames is on the order of seconds to 10s of seconds on a single laptop.</p>
      </sec>
      <sec id="sec011">
        <title>Preparing spatial graphs</title>
        <p>In addition to analyzing average cell and sarcomere behavior (ex: average z-disc and sarcomere morphological properties, <bold>F</bold><sub>avg</sub>), we are interested in analyzing the spatiotemporal patterns that arise on the sub-cellular level. We implemented the <monospace>spatial_graph</monospace> component of Sarc-Graph to conveniently synthesize the outputs of the <monospace>segmentation</monospace>, <monospace>tracking</monospace>, and <monospace>time_series</monospace> steps. Specifically, running the function <monospace>create_spatial_graph()</monospace> will create a spatial graph where z-discs are represented as nodes and sarcomeres are represented as edges. With a spatial graph structure, it is then possible to better quantify spatiotemporal patterns in hiPSC-CM behavior. For example, access to a spatial graph can help delineate sarcomere synchrony that depends on Euclidean distance, and sarcomere synchrony that depends on network distance. In addition, access to a spatial graph can help us better quantify both global and local sarcomere alignment. This functionality is illustrated in <xref rid="pcbi.1009443.g004" ref-type="fig">Fig 4B</xref>.</p>
        <p>In the <monospace>run_all_tracking()</monospace> step, z-discs and sarcomeres are tracked independently. Every z-disc that is at least partially tracked (defined as present in over 10% of the movie frames) will have a unique local (frame-specific) ID and a unique global ID. Each node of the spatial graph corresponds to a unique global ID, and the local IDs specific to each frame are linked to the corresponding global ID node. Each tracked sarcomere is associated with two local z-disc IDs in each frame. To add sarcomeres to the spatial graph, the global ID of the associated z-disc is first determined. Then, either a new edge is created linking the two global IDs, or, if the edge already exists, the weight of the edge is increased. The spatial graph is created with the NetworkX python package, and all operations, such as computing the shortest path between two nodes, rely on built-in NetworkX functionality [<xref rid="pcbi.1009443.ref041" ref-type="bibr">41</xref>]. The function <monospace>create_spatial_graph()</monospace> runs in seconds on a single laptop. Running <monospace>create_spatial_graph()</monospace> will also produce a schematic drawing of the spatial graph.</p>
      </sec>
      <sec id="sec012">
        <title>Notable analysis and visualization tools</title>
        <p>In addition to the functions to compute and visualize <bold>F</bold><sub>avg</sub> and other functional metrics (<monospace>compute_F_whole_movie()</monospace>, <monospace>visualize_F_full_movie()</monospace>, <monospace>compute_metrics()</monospace>, <monospace>visualize_lambda_as_functional_metric()</monospace>) and plot normalized sarcomere length with respect to time (<monospace>plot_normalized_tracked_timeseries()</monospace>), the <monospace>analysis_tools</monospace> component of Sarc-Graph contains multiple functions to further visualize and analyze the data acquired from the hiPSC-CM movies. Example outputs from these functions are included on the Sarc-Graph GitHub page. Additional key analysis and visualization functions are as follows:</p>
        <list list-type="bullet">
          <list-item>
            <p><monospace>visualize_segmentation(folder_name, gaussian_filter_size, frame_num)</monospace>: Visualization of the segmented z-discs and sarcomeres overlaid on the original image. The parameter <monospace>gaussian_filter_size</monospace> should match the value chosen in <monospace>segmentation</monospace>. The default for <monospace>gaussian_filter_size</monospace> = 1 and the default for <monospace>frame_num</monospace> = 0.</p>
          </list-item>
          <list-item>
            <p><monospace>visualize_contract_anim_movie(folder_name, re_run_timeseries, use_re_run_timeseries, keep_thresh = 0.75)</monospace>: Visualization of the results of tracking overlaid on the original movie of the contracting hiPSC-CMs. If <monospace>re_run_timeseries</monospace> = <monospace>True</monospace> and <monospace>use_re_run_timeseries</monospace> = <monospace>True</monospace> this function will re-run the <monospace>timeseries_all()</monospace> function with the new specified <monospace>keep_thresh</monospace>. The saved tracking data will be designated for visualization purposes only.</p>
          </list-item>
          <list-item>
            <p><monospace>cluster_timeseries_plot_dendrogram(folder_name,compute_dist_DTW, compute_dist_euclidean)</monospace>: Visualize hierarchical clustering of all normalized sarcomere length time series data and plot a dendrogram that illustrates the clustering [<xref rid="pcbi.1009443.ref030" ref-type="bibr">30</xref>]. If <monospace>compute_dist_DTW</monospace> = <monospace>True</monospace> the similarity between each sarcomere time series will be measured with a Dynamic Time Warping algorithm [<xref rid="pcbi.1009443.ref042" ref-type="bibr">42</xref>]. Because this can be time consuming (order of minutes to 10s of minutes), we also provide an option to set <monospace>compute_dist_euclidean</monospace> = <monospace>True</monospace> and instead base clustering on the Euclidean distance between time series.</p>
          </list-item>
          <list-item>
            <p><monospace>plot_normalized_tracked_timeseries(folder_name)</monospace>: This function will create a plot of the normalized length of the tracked sarcomeres with respect to frame number.</p>
          </list-item>
          <list-item>
            <p><monospace>plot_untracked_absolute_timeseries(folder_name)</monospace>: This function will create a plot of the absolute sarcomere lengths in pixels with respect to frame number for all segmented sarcomeres. The number of segmented sarcomeres will exceed the number of tracked sarcomeres.</p>
          </list-item>
          <list-item>
            <p><monospace>compute_timeseries_individual_parameters(folder_name)</monospace>: This function will compute and save scalar values describing the normalized length time series data for the tracked sarcomeres (contraction time, relaxation time, flat time, period, offset, etc.) The results of this analysis will be saved in a spreadsheet titled “<monospace>timeseries_parameters_info.xlsx</monospace>.”</p>
          </list-item>
          <list-item>
            <p><monospace>analyze_J_full_movie(folder_name)</monospace>: This function will compute and save scalar values describing the <bold>F</bold><sub>avg</sub> time series data. Specifically, it will compute time constants describing the plot of the scalar Jacobian(<italic toggle="yes">J</italic> = det <bold>F</bold><sub>avg</sub>) with respect to frame number. This is illustrated in <xref rid="pcbi.1009443.g003" ref-type="fig">Fig 3C</xref>.</p>
          </list-item>
          <list-item>
            <p><monospace>compare_tracked_untracked(folder_name)</monospace>: This function will compare the tracked and untracked populations through random sampling of the untracked population. These plots are important for understanding if the tracked data is significantly biased compared to the segmented data.</p>
          </list-item>
          <list-item>
            <p><monospace>preliminary_spatial_temporal_correlation_info(folder_name)</monospace>: This function will perform a preliminary analysis of spatial/temporal correlation within the hiPSC-CMs. The main outcome is a plot of normalized cross-correlation score between normalized sarcomere length time series data with respect to both Euclidean and network distances.</p>
          </list-item>
        </list>
      </sec>
    </sec>
  </sec>
  <sec sec-type="conclusions" id="sec013">
    <title>Results and discussion</title>
    <sec id="sec014">
      <title>Synthetic data examples</title>
      <p>Our first investigation into the performance of Sarc-Graph on synthetic data is illustrated in <xref rid="pcbi.1009443.g005" ref-type="fig">Fig 5</xref>. In this investigation, we define a sinusoidal chain of 20 sarcomeres that deform homogeneously following the time series illustrated in <xref rid="pcbi.1009443.g002" ref-type="fig">Fig 2A</xref>. Under baseline conditions (modest amplitude, little angling out of plane, and low to moderate noise), Sarc-Graph is able to successfully track all 20 out of 20 sarcomeres. This is illustrated in <xref rid="pcbi.1009443.g005" ref-type="fig">Fig 5A</xref>. Then, we adversely alter these baseline conditions to demonstrate the limitations of our approach. In the first study, illustrated in <xref rid="pcbi.1009443.g005" ref-type="fig">Fig 5B</xref>, we alter the underlying 3D geometry of the sarcomere chain. As anticipated, performance degrades when we increase the amplitude of the sine wave, and when we increase the out of plane tilt of the sarcomere chain. That being said, we are able to segment and track at least half of the 20 sarcomeres in all but four of the examples shown. In the second study, illustrated in <xref rid="pcbi.1009443.g005" ref-type="fig">Fig 5C</xref>, we adversely alter baseline conditions by adding noise to the rendered image. Specifically, we add Perlin noise at varying levels of magnitude and with a varying number of octaves [<xref rid="pcbi.1009443.ref022" ref-type="bibr">22</xref>]. From these results, it is clear that our computational framework is quite robust to all tested types of low magnitude noise, and Perlin noise with a low number of octaves (low frequency). However, performance degrades in the presence of Perlin noise that has high gradients and is similar in size and brightness to the simulated z-discs themselves. We note that if a specific experimental dataset has a characteristic noise pattern that can be removed with a known operation, implementing additional steps in the <monospace>segmentation</monospace> component of our computational framework to address it would be straightforward. In some cases, simply increasing the parameter <monospace>gaussian_filter_size</monospace> will resolve the issue. In the experimental data that we have tested the computational framework on thus far, our current segmentation process is effective. To complement the synthetic data results shown in <xref rid="pcbi.1009443.g005" ref-type="fig">Fig 5</xref>, <xref rid="pcbi.1009443.s003" ref-type="supplementary-material">S3 Text</xref> shows the effect of decreasing image resolution on Sarc-Graph performance.</p>
      <fig position="float" id="pcbi.1009443.g005">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1009443.g005</object-id>
        <label>Fig 5</label>
        <caption>
          <title>For each image, the number of sarcomeres successfully segmented and tracked (out of 20 possible) is reported.</title>
          <p>Running the algorithm on synthetic data shows that the code is robust to geometry and noise up to a limit: (a) Illustration of successful z-disc and sarcomere segmentation and tracking for a curved geometry in the presence of noise; (b) Performance degrades when the baseline geometry moves partially out of plane (here slanted in the z-direction), and when the sarcomere chain is too distorted (here high amplitude to period ratio for sinusoidal geometry); (c) Performance degrades in the presence of Perlin noise, in particular noise that is similar in size and brightness to the z-discs themselves.</p>
        </caption>
        <graphic xlink:href="pcbi.1009443.g005" position="float"/>
      </fig>
      <p>Our second investigation into the performance of Sarc-Graph on synthetic data is illustrated in <xref rid="pcbi.1009443.g006" ref-type="fig">Fig 6</xref>. In these examples, our aim is to design synthetic data that contains many of challenges associated with analyzing real hiPSC-CMs: out of plane deformation, sarcomere chain curvature, sarcomere chain overlap, inhomogeneous deformation, variable z-disc size, and irregular contraction. From S1 to S5 the examples are loosely organized from “least” to “most” challenging for the computational framework to capture. The corresponding movies are included in our GitHub repository. Briefly, example S1 shows four sarcomere chains of variable curvature (decreasing from left to right) and variable out of plane deformation (increasing from left to right) deforming homogeneously. Our framework is able to recover 77 out of 80 sarcomeres, match the ground truth mean time series data, and match the ground truth on <inline-formula id="pcbi.1009443.e039"><alternatives><graphic xlink:href="pcbi.1009443.e039.jpg" id="pcbi.1009443.e039g" position="anchor"/><mml:math id="M39" display="inline" overflow="scroll"><mml:msubsup><mml:mo>λ</mml:mo><mml:mn>1</mml:mn><mml:mtext>avg</mml:mtext></mml:msubsup></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1009443.e040"><alternatives><graphic xlink:href="pcbi.1009443.e040.jpg" id="pcbi.1009443.e040g" position="anchor"/><mml:math id="M40" display="inline" overflow="scroll"><mml:msubsup><mml:mo>λ</mml:mo><mml:mn>2</mml:mn><mml:mtext>avg</mml:mtext></mml:msubsup></mml:math></alternatives></inline-formula>. This is consistent with the results shown in <xref rid="pcbi.1009443.g005" ref-type="fig">Fig 5</xref>. Example S2 shows two families of sarcomere chains, an external ellipse and four internal chains that overlap in the center. Our framework is able to recover 90 out of 99 sarcomeres (error occurs primarily near the overlap region), match the ground truth mean time series data, and match the ground truth on <inline-formula id="pcbi.1009443.e041"><alternatives><graphic xlink:href="pcbi.1009443.e041.jpg" id="pcbi.1009443.e041g" position="anchor"/><mml:math id="M41" display="inline" overflow="scroll"><mml:msubsup><mml:mo>λ</mml:mo><mml:mn>1</mml:mn><mml:mtext>avg</mml:mtext></mml:msubsup></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1009443.e042"><alternatives><graphic xlink:href="pcbi.1009443.e042.jpg" id="pcbi.1009443.e042g" position="anchor"/><mml:math id="M42" display="inline" overflow="scroll"><mml:msubsup><mml:mo>λ</mml:mo><mml:mn>2</mml:mn><mml:mtext>avg</mml:mtext></mml:msubsup></mml:math></alternatives></inline-formula>.</p>
      <fig position="float" id="pcbi.1009443.g006">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1009443.g006</object-id>
        <label>Fig 6</label>
        <caption>
          <p>Example performance on synthetic data of increasing complexity with a known ground truth: Segmentation and tracking (marker color corresponds to sarcomere contraction in the illustrated frame); Constructing a spatial graph (line color corresponds to sarcomere orientation); Recovering individual time series data (both Sarc-Graph output and ground truth shown); Recovering average deformation behavior (both Sarc-Graph output and ground truth shown).</p>
        </caption>
        <graphic xlink:href="pcbi.1009443.g006" position="float"/>
      </fig>
      <p>Example S3 shows three closely positioned elliptical sarcomere chains that deform inhomogeneously. Our framework is able to recover 34 out of 40 sarcomeres, however, because there is bias in which sarcomeres are recovered (recovery is worse towards the bottom of the image frame), both the mean time series data and the <inline-formula id="pcbi.1009443.e043"><alternatives><graphic xlink:href="pcbi.1009443.e043.jpg" id="pcbi.1009443.e043g" position="anchor"/><mml:math id="M43" display="inline" overflow="scroll"><mml:msubsup><mml:mo>λ</mml:mo><mml:mn>1</mml:mn><mml:mtext>avg</mml:mtext></mml:msubsup></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1009443.e044"><alternatives><graphic xlink:href="pcbi.1009443.e044.jpg" id="pcbi.1009443.e044g" position="anchor"/><mml:math id="M44" display="inline" overflow="scroll"><mml:msubsup><mml:mo>λ</mml:mo><mml:mn>2</mml:mn><mml:mtext>avg</mml:mtext></mml:msubsup></mml:math></alternatives></inline-formula> data are unable to perfectly capture the ground truth. We note that the results for <inline-formula id="pcbi.1009443.e045"><alternatives><graphic xlink:href="pcbi.1009443.e045.jpg" id="pcbi.1009443.e045g" position="anchor"/><mml:math id="M45" display="inline" overflow="scroll"><mml:msubsup><mml:mo>λ</mml:mo><mml:mn>1</mml:mn><mml:mtext>avg</mml:mtext></mml:msubsup></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1009443.e046"><alternatives><graphic xlink:href="pcbi.1009443.e046.jpg" id="pcbi.1009443.e046g" position="anchor"/><mml:math id="M46" display="inline" overflow="scroll"><mml:msubsup><mml:mo>λ</mml:mo><mml:mn>2</mml:mn><mml:mtext>avg</mml:mtext></mml:msubsup></mml:math></alternatives></inline-formula> are a better reflection of the ground truth than the mean time series data. We also note that the amount of sarcomere contraction simulated in S3 exceeds what is typically observed in the experimental setting (over 30% contraction).</p>
      <p>Example S4 shows two families of sarcomere chains: an external ellipse, and multiple partially overlapping and curved internal chains in different z-planes. In Example S4, the sarcomeres deform inhomogeneously with a brief abrupt jump in sarcomere deformation around frame 70. Our framework is able to recover 75 out of 90 sarcomeres, and is able to nearly recover the mean time series data, and the <inline-formula id="pcbi.1009443.e047"><alternatives><graphic xlink:href="pcbi.1009443.e047.jpg" id="pcbi.1009443.e047g" position="anchor"/><mml:math id="M47" display="inline" overflow="scroll"><mml:msubsup><mml:mo>λ</mml:mo><mml:mn>1</mml:mn><mml:mtext>avg</mml:mtext></mml:msubsup></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1009443.e048"><alternatives><graphic xlink:href="pcbi.1009443.e048.jpg" id="pcbi.1009443.e048g" position="anchor"/><mml:math id="M48" display="inline" overflow="scroll"><mml:msubsup><mml:mo>λ</mml:mo><mml:mn>2</mml:mn><mml:mtext>avg</mml:mtext></mml:msubsup></mml:math></alternatives></inline-formula> data. We note that for both approaches, the abrupt jump in sarcomere behavior seen in the ground truth is smoothed out in the automated time series processing because during the abrupt jump tracking temporarily fails for the entire outer ring of sarcomeres. There are two main implications of this result. First, that large abrupt motion may cause Sarc-Graph to fail. Second, that Sarc-Graph is able to track sarcomeres on either end of a time period where signal is temporarily lost, and interpolate data across the missing frames. Similar to example S3, the plot of <inline-formula id="pcbi.1009443.e049"><alternatives><graphic xlink:href="pcbi.1009443.e049.jpg" id="pcbi.1009443.e049g" position="anchor"/><mml:math id="M49" display="inline" overflow="scroll"><mml:msubsup><mml:mo>λ</mml:mo><mml:mn>1</mml:mn><mml:mtext>avg</mml:mtext></mml:msubsup></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1009443.e050"><alternatives><graphic xlink:href="pcbi.1009443.e050.jpg" id="pcbi.1009443.e050g" position="anchor"/><mml:math id="M50" display="inline" overflow="scroll"><mml:msubsup><mml:mo>λ</mml:mo><mml:mn>2</mml:mn><mml:mtext>avg</mml:mtext></mml:msubsup></mml:math></alternatives></inline-formula> is a better reflection of the ground truth than the mean time series curve.</p>
      <p>Example S5 shows multiple sarcomere chains that are all angled out of plane, appear to overlap at multiple points, and undergo inhomogeneous deformation. In this case, we are only able to recover time series data for 27 out of 70 sarcomeres. This results in mean time series data that is a poor reflection of the ground truth. However, the <inline-formula id="pcbi.1009443.e051"><alternatives><graphic xlink:href="pcbi.1009443.e051.jpg" id="pcbi.1009443.e051g" position="anchor"/><mml:math id="M51" display="inline" overflow="scroll"><mml:msubsup><mml:mo>λ</mml:mo><mml:mn>1</mml:mn><mml:mtext>avg</mml:mtext></mml:msubsup></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1009443.e052"><alternatives><graphic xlink:href="pcbi.1009443.e052.jpg" id="pcbi.1009443.e052g" position="anchor"/><mml:math id="M52" display="inline" overflow="scroll"><mml:msubsup><mml:mo>λ</mml:mo><mml:mn>2</mml:mn><mml:mtext>avg</mml:mtext></mml:msubsup></mml:math></alternatives></inline-formula> data is a much better match to the ground truth. This is a positive sign towards the efficacy of our proposed metric even when the number of sarcomeres recovered is relatively low. Though only 27 out of 70 sarcomeres were fully tracked, segmented but only partially tracked sarcomeres appear on the spatial graph shown in <xref rid="pcbi.1009443.g006" ref-type="fig">Fig 6</xref> example S5. Looking forward, additional criteria to further refine the spatial graph and further delineate “probable” and “improbable” links can readily be added to Sarc-Graph within the <monospace>spatial_graph</monospace> module.</p>
      <p>In <xref rid="pcbi.1009443.t002" ref-type="table">Table 2</xref>, we report median individual sarcomere shortening (<inline-formula id="pcbi.1009443.e053"><alternatives><graphic xlink:href="pcbi.1009443.e053.jpg" id="pcbi.1009443.e053g" position="anchor"/><mml:math id="M53" display="inline" overflow="scroll"><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo>˜</mml:mo></mml:mover></mml:math></alternatives></inline-formula>), mean time series sarcomere shortening (<italic toggle="yes">s</italic><sub>avg</sub>), Orientational Order Parameter (OOP), equivalent isotropic contraction (<italic toggle="yes">C</italic><sub>iso</sub>), and contraction in the dominant direction of sarcomere orientation (<italic toggle="yes">C</italic><sub>∥</sub>) for each synthetic data example. For all of the synthetic data cases, we are able to compute a ground truth for each of these parameters from the known ground truth contraction, displacement, and orientation of the sarcomere geometry. For examples S1 and S2, the parameters recovered by Sarc-Graph are a near perfect match to the ground truth. However, for all other samples minor discrepancies arise in <inline-formula id="pcbi.1009443.e054"><alternatives><graphic xlink:href="pcbi.1009443.e054.jpg" id="pcbi.1009443.e054g" position="anchor"/><mml:math id="M54" display="inline" overflow="scroll"><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo>˜</mml:mo></mml:mover></mml:math></alternatives></inline-formula>, OOP, <italic toggle="yes">C</italic><sub>iso</sub>, and <italic toggle="yes">C</italic><sub>∥</sub>. For example S4, <inline-formula id="pcbi.1009443.e055"><alternatives><graphic xlink:href="pcbi.1009443.e055.jpg" id="pcbi.1009443.e055g" position="anchor"/><mml:math id="M55" display="inline" overflow="scroll"><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo>˜</mml:mo></mml:mover></mml:math></alternatives></inline-formula> is overestimated. For examples S3 and S5, OOP is overestimated, <italic toggle="yes">C</italic><sub>iso</sub> is underestimated, and <italic toggle="yes">C</italic><sub>∥</sub> is underestimated. Consistent with the results shown in <xref rid="pcbi.1009443.g006" ref-type="fig">Fig 6</xref>, we believe that this error is due to bias in the region where sarcomeres are recovered in S3, and failure of the algorithm for overlapping and severely out of plane sarcomere chains in S4 and S5. We note that for all examples but S1 and S2—where sarcomere contraction is synchronous—recovered <italic toggle="yes">s</italic><sub>avg</sub> is not a good match to the ground truth. This is consistent with the normalized sarcomere length time series plot shown in <xref rid="pcbi.1009443.g006" ref-type="fig">Fig 6</xref>. However, the other metrics are able to perform acceptably in the presence of non-synchronous contraction. In general, these errors indicate that care should be taken when comparing results across beating hiPSC-CM movies that may have systemic differences. The accessibility of our code for generating additional synthetic data can aid in this preliminary check.</p>
      <table-wrap position="float" id="pcbi.1009443.t002">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1009443.t002</object-id>
        <label>Table 2</label>
        <caption>
          <title>Comparison of Sarc-Graph computed <inline-formula id="pcbi.1009443.e056"><alternatives><graphic xlink:href="pcbi.1009443.e056" id="pcbi.1009443.e056g" position="anchor"/><mml:math id="M56" display="inline" overflow="scroll"><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo>˜</mml:mo></mml:mover></mml:math></alternatives></inline-formula>, <italic toggle="yes">s</italic><sub>avg</sub>, OOP, <italic toggle="yes">C</italic><sub>iso</sub>, and <italic toggle="yes">C</italic><sub>∥</sub> with the ground truth values of these parameters for each synthetic data example.</title>
        </caption>
        <alternatives>
          <graphic xlink:href="pcbi.1009443.t002" id="pcbi.1009443.t002g" position="float"/>
          <table frame="box" rules="all" border="0">
            <colgroup span="1">
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <th align="center" style="border-top-width:thick" rowspan="1" colspan="1"/>
                <th align="left" style="border-top-width:thick" rowspan="1" colspan="1">
                  <inline-formula id="pcbi.1009443.e057">
                    <alternatives>
                      <graphic xlink:href="pcbi.1009443.e057" id="pcbi.1009443.e057g" position="anchor"/>
                      <mml:math id="M57" display="inline" overflow="scroll">
                        <mml:mover accent="true">
                          <mml:mi>s</mml:mi>
                          <mml:mo>˜</mml:mo>
                        </mml:mover>
                      </mml:math>
                    </alternatives>
                  </inline-formula>
                </th>
                <th align="left" style="border-top-width:thick" rowspan="1" colspan="1">
                  <inline-formula id="pcbi.1009443.e058">
                    <alternatives>
                      <graphic xlink:href="pcbi.1009443.e058" id="pcbi.1009443.e058g" position="anchor"/>
                      <mml:math id="M58" display="inline" overflow="scroll">
                        <mml:msup>
                          <mml:mover accent="true">
                            <mml:mi>s</mml:mi>
                            <mml:mo>˜</mml:mo>
                          </mml:mover>
                          <mml:mtext>GT</mml:mtext>
                        </mml:msup>
                      </mml:math>
                    </alternatives>
                  </inline-formula>
                </th>
                <th align="left" style="border-top-width:thick" rowspan="1" colspan="1">
                  <italic toggle="yes">s</italic>
                  <sub>avg</sub>
                </th>
                <th align="left" style="border-top-width:thick" rowspan="1" colspan="1">
                  <inline-formula id="pcbi.1009443.e059">
                    <alternatives>
                      <graphic xlink:href="pcbi.1009443.e059" id="pcbi.1009443.e059g" position="anchor"/>
                      <mml:math id="M59" display="inline" overflow="scroll">
                        <mml:msubsup>
                          <mml:mi>s</mml:mi>
                          <mml:mrow>
                            <mml:mtext>avg</mml:mtext>
                          </mml:mrow>
                          <mml:mtext>GT</mml:mtext>
                        </mml:msubsup>
                      </mml:math>
                    </alternatives>
                  </inline-formula>
                </th>
                <th align="left" style="border-top-width:thick" rowspan="1" colspan="1">OOP</th>
                <th align="left" style="border-top-width:thick" rowspan="1" colspan="1">OOP<sup>GT</sup></th>
                <th align="left" style="border-top-width:thick" rowspan="1" colspan="1">
                  <italic toggle="yes">C</italic>
                  <sub>iso</sub>
                </th>
                <th align="left" style="border-top-width:thick" rowspan="1" colspan="1">
                  <inline-formula id="pcbi.1009443.e060">
                    <alternatives>
                      <graphic xlink:href="pcbi.1009443.e060" id="pcbi.1009443.e060g" position="anchor"/>
                      <mml:math id="M60" display="inline" overflow="scroll">
                        <mml:msubsup>
                          <mml:mi>C</mml:mi>
                          <mml:mrow>
                            <mml:mtext>iso</mml:mtext>
                          </mml:mrow>
                          <mml:mtext>GT</mml:mtext>
                        </mml:msubsup>
                      </mml:math>
                    </alternatives>
                  </inline-formula>
                </th>
                <th align="left" style="border-top-width:thick" rowspan="1" colspan="1">
                  <italic toggle="yes">C</italic>
                  <sub>∥</sub>
                </th>
                <th align="left" style="border-top-width:thick" rowspan="1" colspan="1">
                  <inline-formula id="pcbi.1009443.e061">
                    <alternatives>
                      <graphic xlink:href="pcbi.1009443.e061" id="pcbi.1009443.e061g" position="anchor"/>
                      <mml:math id="M61" display="inline" overflow="scroll">
                        <mml:msubsup>
                          <mml:mi>C</mml:mi>
                          <mml:mrow>
                            <mml:mo>∥</mml:mo>
                          </mml:mrow>
                          <mml:mtext>GT</mml:mtext>
                        </mml:msubsup>
                      </mml:math>
                    </alternatives>
                  </inline-formula>
                </th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="left" rowspan="1" colspan="1">S1</td>
                <td align="char" char="." rowspan="1" colspan="1">0.15</td>
                <td align="char" char="." rowspan="1" colspan="1">0.15</td>
                <td align="char" char="." rowspan="1" colspan="1">0.15</td>
                <td align="char" char="." rowspan="1" colspan="1">0.15</td>
                <td align="char" char="." rowspan="1" colspan="1">0.62</td>
                <td align="char" char="." rowspan="1" colspan="1">0.63</td>
                <td align="char" char="." rowspan="1" colspan="1">0.15</td>
                <td align="char" char="." rowspan="1" colspan="1">0.15</td>
                <td align="char" char="." rowspan="1" colspan="1">0.15</td>
                <td align="char" char="." rowspan="1" colspan="1">0.15</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">S2</td>
                <td align="char" char="." rowspan="1" colspan="1">0.085</td>
                <td align="char" char="." rowspan="1" colspan="1">0.074</td>
                <td align="char" char="." rowspan="1" colspan="1">0.074</td>
                <td align="char" char="." rowspan="1" colspan="1">0.075</td>
                <td align="char" char="." rowspan="1" colspan="1">0.080</td>
                <td align="char" char="." rowspan="1" colspan="1">0.066</td>
                <td align="char" char="." rowspan="1" colspan="1">0.076</td>
                <td align="char" char="." rowspan="1" colspan="1">0.075</td>
                <td align="char" char="." rowspan="1" colspan="1">0.076</td>
                <td align="char" char="." rowspan="1" colspan="1">0.075</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">S3</td>
                <td align="char" char="." rowspan="1" colspan="1">0.38</td>
                <td align="char" char="." rowspan="1" colspan="1">0.40</td>
                <td align="char" char="." rowspan="1" colspan="1">0.079</td>
                <td align="char" char="." rowspan="1" colspan="1">0.24</td>
                <td align="char" char="." rowspan="1" colspan="1">0.93</td>
                <td align="char" char="." rowspan="1" colspan="1">0.88</td>
                <td align="char" char="." rowspan="1" colspan="1">0.11</td>
                <td align="char" char="." rowspan="1" colspan="1">0.16</td>
                <td align="char" char="." rowspan="1" colspan="1">0.039</td>
                <td align="char" char="." rowspan="1" colspan="1">0.070</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">S4</td>
                <td align="char" char="." rowspan="1" colspan="1">0.058</td>
                <td align="char" char="." rowspan="1" colspan="1">0.043</td>
                <td align="char" char="." rowspan="1" colspan="1">0.042</td>
                <td align="char" char="." rowspan="1" colspan="1">0.024</td>
                <td align="char" char="." rowspan="1" colspan="1">0.16</td>
                <td align="char" char="." rowspan="1" colspan="1">0.15</td>
                <td align="char" char="." rowspan="1" colspan="1">0.04</td>
                <td align="char" char="." rowspan="1" colspan="1">0.04</td>
                <td align="char" char="." rowspan="1" colspan="1">0.039</td>
                <td align="char" char="." rowspan="1" colspan="1">0.038</td>
              </tr>
              <tr>
                <td align="left" style="border-bottom-width:thick" rowspan="1" colspan="1">S5</td>
                <td align="char" char="." style="border-bottom-width:thick" rowspan="1" colspan="1">0.22</td>
                <td align="char" char="." style="border-bottom-width:thick" rowspan="1" colspan="1">0.22</td>
                <td align="char" char="." style="border-bottom-width:thick" rowspan="1" colspan="1">0.085</td>
                <td align="char" char="." style="border-bottom-width:thick" rowspan="1" colspan="1">0.042</td>
                <td align="char" char="." style="border-bottom-width:thick" rowspan="1" colspan="1">0.35</td>
                <td align="char" char="." style="border-bottom-width:thick" rowspan="1" colspan="1">0.21</td>
                <td align="char" char="." style="border-bottom-width:thick" rowspan="1" colspan="1">0.13</td>
                <td align="char" char="." style="border-bottom-width:thick" rowspan="1" colspan="1">0.16</td>
                <td align="char" char="." style="border-bottom-width:thick" rowspan="1" colspan="1">0.17</td>
                <td align="char" char="." style="border-bottom-width:thick" rowspan="1" colspan="1">0.20</td>
              </tr>
            </tbody>
          </table>
        </alternatives>
      </table-wrap>
      <p>In all examples, most glaringly example S5, more sarcomeres are segmented and tracked for a small number of frames (and thus appear on the spatial graph) than are tracked for enough frames to reconstruct the full time series. The recovered time series (<inline-formula id="pcbi.1009443.e062"><alternatives><graphic xlink:href="pcbi.1009443.e062.jpg" id="pcbi.1009443.e062g" position="anchor"/><mml:math id="M62" display="inline" overflow="scroll"><mml:msubsup><mml:mo>λ</mml:mo><mml:mn>1</mml:mn><mml:mtext>avg</mml:mtext></mml:msubsup></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1009443.e063"><alternatives><graphic xlink:href="pcbi.1009443.e063.jpg" id="pcbi.1009443.e063g" position="anchor"/><mml:math id="M63" display="inline" overflow="scroll"><mml:msubsup><mml:mo>λ</mml:mo><mml:mn>2</mml:mn><mml:mtext>avg</mml:mtext></mml:msubsup></mml:math></alternatives></inline-formula>) and parameters (<italic toggle="yes">C</italic><sub>iso</sub> and <italic toggle="yes">C</italic><sub>∥</sub>) associated with <bold>F</bold><sub>avg</sub> are typically a closer match to the synthetic data ground truth behavior than the mean curve of the recovered time series data. Example S5—with out of plane inhomogeneous deformation and overlapping sarcomere chains—is perhaps the best reflection of the challenges that we have seen in our experience thus far with the experimental data. We note that the extensible code used to generate the synthetic data is published on GitHub so implementing and testing additional examples is straightforward. To complement these results, <xref rid="pcbi.1009443.s004" ref-type="supplementary-material">S4 Text</xref> shows the performance of Sarc-Graph on the synthetic data generated for the SarcTrack paper [<xref rid="pcbi.1009443.ref010" ref-type="bibr">10</xref>] and directly compares results from both Sarc-Graph and SarcTrack.</p>
    </sec>
    <sec id="sec015">
      <title>Experimental data examples</title>
      <p>Here, we show the performance of Sarc-Graph on the five experimental data examples listed in <xref rid="pcbi.1009443.t001" ref-type="table">Table 1</xref>. In Figs <xref rid="pcbi.1009443.g007" ref-type="fig">7</xref>–<xref rid="pcbi.1009443.g009" ref-type="fig">9</xref>, we illustrate the key Sarc-Graph outputs. In <xref rid="pcbi.1009443.t003" ref-type="table">Table 3</xref>, we report <inline-formula id="pcbi.1009443.e064"><alternatives><graphic xlink:href="pcbi.1009443.e064.jpg" id="pcbi.1009443.e064g" position="anchor"/><mml:math id="M64" display="inline" overflow="scroll"><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo>˜</mml:mo></mml:mover></mml:math></alternatives></inline-formula>, <italic toggle="yes">s</italic><sub>avg</sub>, OOP, <italic toggle="yes">C</italic><sub>avg</sub>, and <italic toggle="yes">C</italic><sub>∥</sub> for each example. In the Supplementary Information section, we include a movie for each sample that shows both the change in length of the successfully tracked sarcomeres, and how our computed metric <bold>F</bold><sub>avg</sub> changes over the course of the movie.</p>
      <fig position="float" id="pcbi.1009443.g007">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1009443.g007</object-id>
        <label>Fig 7</label>
        <caption>
          <p>Example performance on experimental data E1 and E2: Raw image visualization; z-disc and sarcomere segmentation; Sarcomeres that are tracked for 1/3 or more of the movie, red corresponds to a contracted state, blue corresponds to a relaxed state (frame 20); Sarcomeres that are tracked for 3/4 or more of the movie, red corresponds to a contracted state, blue corresponds to a relaxed state (frame 20), note that these sarcomeres are included in the time series analysis; Individual time series data for normalized sarcomere length; Average deformation behavior; Illustration of the data represented as a spatial graph, color corresponds to sarcomere orientation; Normalized sarcomere time series cross-correlation score plotted as a function of the distance along the network. <xref rid="pcbi.1009443.s005" ref-type="supplementary-material">S1</xref> and <xref rid="pcbi.1009443.s006" ref-type="supplementary-material">S2</xref> Movies are included for further visualization.</p>
        </caption>
        <graphic xlink:href="pcbi.1009443.g007" position="float"/>
      </fig>
      <fig position="float" id="pcbi.1009443.g008">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1009443.g008</object-id>
        <label>Fig 8</label>
        <caption>
          <p>Example performance on experimental data E3 and E4: Raw image visualization; z-disc and sarcomere segmentation; Sarcomeres that are tracked for 1/3 or more of the movie, red corresponds to a contracted state, blue corresponds to a relaxed state (frame 50 for E3, frame 40 for E4); Sarcomeres that are tracked for 3/4 or more of the movie, red corresponds to a contracted state, blue corresponds to a relaxed state (frame 50 for E3, frame 40 for E4), note that these sarcomeres are included in the time series analysis; Individual time series data for normalized sarcomere length; Average deformation behavior; Illustration of the data represented as a spatial graph, color corresponds to sarcomere orientation; Normalized sarcomere time series cross-correlation score plotted as a function of the distance along the network. <xref rid="pcbi.1009443.s007" ref-type="supplementary-material">S3</xref> and <xref rid="pcbi.1009443.s008" ref-type="supplementary-material">S4</xref> Movies are included for further visualization.</p>
        </caption>
        <graphic xlink:href="pcbi.1009443.g008" position="float"/>
      </fig>
      <fig position="float" id="pcbi.1009443.g009">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1009443.g009</object-id>
        <label>Fig 9</label>
        <caption>
          <p>Example performance on experimental data E5: Raw image visualization; z-disc and sarcomere segmentation; Sarcomeres that are tracked for 1/3 or more of the movie, red corresponds to a contracted state, blue corresponds to a relaxed state (frame 50); Sarcomeres that are tracked for 3/4 or more of the movie, red corresponds to a contracted state, blue corresponds to a relaxed state (frame 50), note that these sarcomeres are included in the time series analysis; Individual time series data for normalized sarcomere length; Average deformation behavior; Illustration of the data represented as a spatial graph, color corresponds to sarcomere orientation; Normalized sarcomere time series cross-correlation score plotted as a function of the distance along the network. <xref rid="pcbi.1009443.s009" ref-type="supplementary-material">S5 Movie</xref> is included for further visualization.</p>
        </caption>
        <graphic xlink:href="pcbi.1009443.g009" position="float"/>
      </fig>
      <p>In <xref rid="pcbi.1009443.g007" ref-type="fig">Fig 7</xref>, we show the performance of Sarc-Graph on two similar examples of beating hiPSC-CM movies, examples E1 and E2. For example E1, we are able to segment ≈ 500 sarcomeres per frame and successfully track 74 sarcomeres. The time series plot of absolute sarcomere length change with respect to frame number shows three distinct contraction events during the movie. Though the individual sarcomeres are clearly not perfectly in sync, there is enough of a unifying pattern for these three peaks to emerge. These three distinct contraction events are also reflected in the plot of <inline-formula id="pcbi.1009443.e065"><alternatives><graphic xlink:href="pcbi.1009443.e065.jpg" id="pcbi.1009443.e065g" position="anchor"/><mml:math id="M65" display="inline" overflow="scroll"><mml:msubsup><mml:mo>λ</mml:mo><mml:mn>1</mml:mn><mml:mtext>avg</mml:mtext></mml:msubsup></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1009443.e066"><alternatives><graphic xlink:href="pcbi.1009443.e066.jpg" id="pcbi.1009443.e066g" position="anchor"/><mml:math id="M66" display="inline" overflow="scroll"><mml:msubsup><mml:mo>λ</mml:mo><mml:mn>2</mml:mn><mml:mtext>avg</mml:mtext></mml:msubsup></mml:math></alternatives></inline-formula>. For example E2, we are able to segment ≈ 500 sarcomeres per frame and successfully track 60 sarcomeres. The time series plots of absolute sarcomere length change and <inline-formula id="pcbi.1009443.e067"><alternatives><graphic xlink:href="pcbi.1009443.e067.jpg" id="pcbi.1009443.e067g" position="anchor"/><mml:math id="M67" display="inline" overflow="scroll"><mml:msubsup><mml:mo>λ</mml:mo><mml:mn>1</mml:mn><mml:mtext>avg</mml:mtext></mml:msubsup></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1009443.e068"><alternatives><graphic xlink:href="pcbi.1009443.e068.jpg" id="pcbi.1009443.e068g" position="anchor"/><mml:math id="M68" display="inline" overflow="scroll"><mml:msubsup><mml:mo>λ</mml:mo><mml:mn>2</mml:mn><mml:mtext>avg</mml:mtext></mml:msubsup></mml:math></alternatives></inline-formula> with respect to frame number also show three distinct peaks. We also show the spatial graph representation of each example and a plot of normalized cross-correlation between pairs of individual sarcomere time series curves with respect to network distance.</p>
      <p>Qualitatively, examples E1 and E2 are different in that the sarcomeres in example E1 appear vertically(top/bottom of the page) aligned throughout while the sarcomeres in example E2 appear tangentially aligned around the edge of the cell and unaligned in the center. This qualitative observation is consistent with the values of OOP reported in <xref rid="pcbi.1009443.t003" ref-type="table">Table 3</xref>. In addition, we can use our computed metric <bold>F</bold><sub>avg</sub> to go beyond morphology alone and quantify the function of the observed hiPSC-CMs. By looking at the time series plots of <inline-formula id="pcbi.1009443.e069"><alternatives><graphic xlink:href="pcbi.1009443.e069.jpg" id="pcbi.1009443.e069g" position="anchor"/><mml:math id="M69" display="inline" overflow="scroll"><mml:msubsup><mml:mo>λ</mml:mo><mml:mn>1</mml:mn><mml:mtext>avg</mml:mtext></mml:msubsup></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1009443.e070"><alternatives><graphic xlink:href="pcbi.1009443.e070.jpg" id="pcbi.1009443.e070g" position="anchor"/><mml:math id="M70" display="inline" overflow="scroll"><mml:msubsup><mml:mo>λ</mml:mo><mml:mn>2</mml:mn><mml:mtext>avg</mml:mtext></mml:msubsup></mml:math></alternatives></inline-formula> with respect to frame number, we can see that example E1 is deforming quite anisotropically <inline-formula id="pcbi.1009443.e071"><alternatives><graphic xlink:href="pcbi.1009443.e071.jpg" id="pcbi.1009443.e071g" position="anchor"/><mml:math id="M71" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mo>λ</mml:mo><mml:mn>1</mml:mn><mml:mtext>avg</mml:mtext></mml:msubsup><mml:mo>&lt;</mml:mo><mml:msubsup><mml:mo>λ</mml:mo><mml:mn>2</mml:mn><mml:mtext>avg</mml:mtext></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> while the deformation of example E2 is much closer to isotropic where <inline-formula id="pcbi.1009443.e072"><alternatives><graphic xlink:href="pcbi.1009443.e072.jpg" id="pcbi.1009443.e072g" position="anchor"/><mml:math id="M72" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mo>λ</mml:mo><mml:mn>1</mml:mn><mml:mtext>avg</mml:mtext></mml:msubsup><mml:mo>≈</mml:mo><mml:msubsup><mml:mo>λ</mml:mo><mml:mn>2</mml:mn><mml:mtext>avg</mml:mtext></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula>. In example E1, <italic toggle="yes">C</italic><sub>∥</sub> is meaningfully greater than <italic toggle="yes">C</italic><sub>iso</sub> while in example E2 the two parameters are much closer in value. Essentially, example E1 is experiencing more substantial oriented contraction than example E2. We also note that for these two examples, where <inline-formula id="pcbi.1009443.e073"><alternatives><graphic xlink:href="pcbi.1009443.e073.jpg" id="pcbi.1009443.e073g" position="anchor"/><mml:math id="M73" display="inline" overflow="scroll"><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo>˜</mml:mo></mml:mover></mml:math></alternatives></inline-formula> is similar but OOP is different, metrics derived from <bold>F</bold><sub>avg</sub> are able to capture functional differences in contraction.</p>
      <table-wrap position="float" id="pcbi.1009443.t003">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1009443.t003</object-id>
        <label>Table 3</label>
        <caption>
          <title>Sarc-Graph computed <inline-formula id="pcbi.1009443.e074"><alternatives><graphic xlink:href="pcbi.1009443.e074" id="pcbi.1009443.e074g" position="anchor"/><mml:math id="M74" display="inline" overflow="scroll"><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo>˜</mml:mo></mml:mover></mml:math></alternatives></inline-formula>, <italic toggle="yes">s</italic><sub>avg</sub>, OOP, <italic toggle="yes">C</italic><sub>iso</sub>, and <italic toggle="yes">C</italic><sub>∥</sub> for each experimental data example.</title>
        </caption>
        <alternatives>
          <graphic xlink:href="pcbi.1009443.t003" id="pcbi.1009443.t003g" position="float"/>
          <table frame="box" rules="all" border="0">
            <colgroup span="1">
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <th align="left" style="border-top-width:thick" rowspan="1" colspan="1"/>
                <th align="left" style="border-top-width:thick" rowspan="1" colspan="1">
                  <inline-formula id="pcbi.1009443.e075">
                    <alternatives>
                      <graphic xlink:href="pcbi.1009443.e075" id="pcbi.1009443.e075g" position="anchor"/>
                      <mml:math id="M75" display="inline" overflow="scroll">
                        <mml:mover accent="true">
                          <mml:mi>s</mml:mi>
                          <mml:mo>˜</mml:mo>
                        </mml:mover>
                      </mml:math>
                    </alternatives>
                  </inline-formula>
                </th>
                <th align="left" style="border-top-width:thick" rowspan="1" colspan="1">
                  <italic toggle="yes">s</italic>
                  <sub>avg</sub>
                </th>
                <th align="left" style="border-top-width:thick" rowspan="1" colspan="1">OOP</th>
                <th align="left" style="border-top-width:thick" rowspan="1" colspan="1">
                  <italic toggle="yes">C</italic>
                  <sub>iso</sub>
                </th>
                <th align="left" style="border-top-width:thick" rowspan="1" colspan="1">
                  <italic toggle="yes">C</italic>
                  <sub>∥</sub>
                </th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="left" rowspan="1" colspan="1">E1</td>
                <td align="char" char="." rowspan="1" colspan="1">0.17</td>
                <td align="char" char="." rowspan="1" colspan="1">0.049</td>
                <td align="char" char="." rowspan="1" colspan="1">0.48</td>
                <td align="char" char="." rowspan="1" colspan="1">0.015</td>
                <td align="char" char="." rowspan="1" colspan="1">0.026</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">E2</td>
                <td align="char" char="." rowspan="1" colspan="1">0.15</td>
                <td align="char" char="." rowspan="1" colspan="1">0.07</td>
                <td align="char" char="." rowspan="1" colspan="1">0.29</td>
                <td align="char" char="." rowspan="1" colspan="1">0.025</td>
                <td align="char" char="." rowspan="1" colspan="1">0.028</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">E3</td>
                <td align="char" char="." rowspan="1" colspan="1">0.18</td>
                <td align="char" char="." rowspan="1" colspan="1">0.061</td>
                <td align="char" char="." rowspan="1" colspan="1">0.68</td>
                <td align="char" char="." rowspan="1" colspan="1">0.069</td>
                <td align="char" char="." rowspan="1" colspan="1">0.041</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">E4</td>
                <td align="char" char="." rowspan="1" colspan="1">0.13</td>
                <td align="char" char="." rowspan="1" colspan="1">0.041</td>
                <td align="char" char="." rowspan="1" colspan="1">0.16</td>
                <td align="char" char="." rowspan="1" colspan="1">0.021</td>
                <td align="char" char="." rowspan="1" colspan="1">0.027</td>
              </tr>
              <tr>
                <td align="left" style="border-bottom-width:thick" rowspan="1" colspan="1">E5</td>
                <td align="char" char="." style="border-bottom-width:thick" rowspan="1" colspan="1">0.13</td>
                <td align="char" char="." style="border-bottom-width:thick" rowspan="1" colspan="1">0.02</td>
                <td align="char" char="." style="border-bottom-width:thick" rowspan="1" colspan="1">0.38</td>
                <td align="char" char="." style="border-bottom-width:thick" rowspan="1" colspan="1">0.0060</td>
                <td align="char" char="." style="border-bottom-width:thick" rowspan="1" colspan="1">0.0066</td>
              </tr>
            </tbody>
          </table>
        </alternatives>
      </table-wrap>
      <p>In <xref rid="pcbi.1009443.g008" ref-type="fig">Fig 8</xref>, we show the performance of Sarc-Graph on two contrasting examples of beating hiPSC-CM movies, examples E3 and E4. Example E3 is of a single hiPSC-CM adhered to a patterned soft hydrogel substrate with highly aligned sarcomeres and large deformation while Example E4 is of hiPSC-CMs in a monolayer culture without a clear direction of sarcomere alignment. With Sarc-Graph, we are able to segment approximately 100, and track 44 sarcomeres from E3. From the plots of <inline-formula id="pcbi.1009443.e076"><alternatives><graphic xlink:href="pcbi.1009443.e076.jpg" id="pcbi.1009443.e076g" position="anchor"/><mml:math id="M76" display="inline" overflow="scroll"><mml:msubsup><mml:mo>λ</mml:mo><mml:mn>1</mml:mn><mml:mtext>avg</mml:mtext></mml:msubsup></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1009443.e077"><alternatives><graphic xlink:href="pcbi.1009443.e077.jpg" id="pcbi.1009443.e077g" position="anchor"/><mml:math id="M77" display="inline" overflow="scroll"><mml:msubsup><mml:mo>λ</mml:mo><mml:mn>2</mml:mn><mml:mtext>avg</mml:mtext></mml:msubsup></mml:math></alternatives></inline-formula>, and scalar metrics OOP, <italic toggle="yes">C</italic><sub>iso</sub>, and <italic toggle="yes">C</italic><sub>∥</sub>, we observe high sarcomere alignment and corresponding highly aligned contraction. Notably, the cell contracts substantially in the direction perpendicular to fiber alignment, thus exhibiting auxetic deformation during contraction. For example E4 we are able to segment approximately 700, and track 228 sarcomeres. This is notable because the conditions in E4 are far from ideal for image analysis. In both cases, five distinct contraction events are observed over the course of the movie and are visible from both the average normalized sarcomere length time series and the <inline-formula id="pcbi.1009443.e078"><alternatives><graphic xlink:href="pcbi.1009443.e078.jpg" id="pcbi.1009443.e078g" position="anchor"/><mml:math id="M78" display="inline" overflow="scroll"><mml:msubsup><mml:mo>λ</mml:mo><mml:mn>1</mml:mn><mml:mtext>avg</mml:mtext></mml:msubsup></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1009443.e079"><alternatives><graphic xlink:href="pcbi.1009443.e079.jpg" id="pcbi.1009443.e079g" position="anchor"/><mml:math id="M79" display="inline" overflow="scroll"><mml:msubsup><mml:mo>λ</mml:mo><mml:mn>2</mml:mn><mml:mtext>avg</mml:mtext></mml:msubsup></mml:math></alternatives></inline-formula> time series.</p>
      <p>In <xref rid="pcbi.1009443.g009" ref-type="fig">Fig 9</xref>, we show the performance of Sarc-Graph on example E5. Example E5 is of a hiPSC-CM on a glass slide with poor fiber alignment, curved fibers, and relatively low deformation over the course of the movie. With Sarc-Graph, we are able to segment approximately 800 and track 539 sarcomeres for example E5. Though individual sarcomeres in this movie contract substantially (<inline-formula id="pcbi.1009443.e080"><alternatives><graphic xlink:href="pcbi.1009443.e080.jpg" id="pcbi.1009443.e080g" position="anchor"/><mml:math id="M80" display="inline" overflow="scroll"><mml:mrow><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>.</mml:mo><mml:mn>13</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>), there is low overall synchrony, and overall average deformation is quite low (<italic toggle="yes">C</italic><sub>iso</sub> = 0.0060). Despite low synchrony, Sarc-Graph still detects 5 distinct contractions in both the average time series plot and the <inline-formula id="pcbi.1009443.e081"><alternatives><graphic xlink:href="pcbi.1009443.e081.jpg" id="pcbi.1009443.e081g" position="anchor"/><mml:math id="M81" display="inline" overflow="scroll"><mml:msubsup><mml:mo>λ</mml:mo><mml:mn>1</mml:mn><mml:mtext>avg</mml:mtext></mml:msubsup></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1009443.e082"><alternatives><graphic xlink:href="pcbi.1009443.e082.jpg" id="pcbi.1009443.e082g" position="anchor"/><mml:math id="M82" display="inline" overflow="scroll"><mml:msubsup><mml:mo>λ</mml:mo><mml:mn>2</mml:mn><mml:mtext>avg</mml:mtext></mml:msubsup></mml:math></alternatives></inline-formula> time series plot. Notably, overall contraction is also slightly higher (<italic toggle="yes">C</italic><sub>∥</sub> &gt; <italic toggle="yes">C</italic><sub>iso</sub>) in the dominant direction of sarcomere orientation. This example is notable because Sarc-Graph is able to segment and track a high number of sarcomeres from an irregular geometry and detect subtle sarcomere behavior beyond the limits of what has been accomplished with the previous state of the art [<xref rid="pcbi.1009443.ref010" ref-type="bibr">10</xref>].</p>
      <p>To complement the results of analyzing movies E1-E5, we also apply Sarc-Graph to two experimental datasets published by others [<xref rid="pcbi.1009443.ref006" ref-type="bibr">6</xref>, <xref rid="pcbi.1009443.ref012" ref-type="bibr">12</xref>]. In both cases, we are only evaluating the segmentation functionality of the code because the datasets only contain still images. In <xref rid="pcbi.1009443.s001" ref-type="supplementary-material">S1 Text</xref>, we compare sarcomere length predicted by Sarc-Graph to the sarcomere length predicted by the SOTA framework [<xref rid="pcbi.1009443.ref012" ref-type="bibr">12</xref>]. In <xref rid="pcbi.1009443.s002" ref-type="supplementary-material">S2 Text</xref>, we demonstrate the feasibility of constructing a machine learning phenotype classification model using Sarc-Graph derived metrics with the data published with Pasqualini et al. 2015 [<xref rid="pcbi.1009443.ref006" ref-type="bibr">6</xref>]. These results help provide broader context of Sarc-Graph functionality and show the performance of Sarc-Graph on datasets that the code was not originally designed for.</p>
    </sec>
    <sec id="sec016">
      <title>Current limitations and future directions</title>
      <p>Based on the results from both synthetic and experimental data, it is clear that Sarc-Graph is a powerful software tool for segmentation, tracking, and analysis of sarcomeres in hiPSC-CMs. However, there are multiple current limitations and opportunities for further improvement. Key limitations are as follows:</p>
      <list list-type="bullet">
        <list-item>
          <p>Potential bias in interpreting data due to variations in sarcomere width. At present, segmented sarcomeres are not weighted by size in any of the analysis steps. Therefore, a large (i.e., wide) sarcomere will have the same importance as a small (i.e., narrow) sarcomere in analysis. Because sarcomere width is measured and saved, it would be straightforward to apply a width based weighting factor during the analysis step in future work and/or compare segmented sarcomere widths between groups.</p>
        </list-item>
        <list-item>
          <p>Potential bias in segmentation due to missing poorly formed sarcomeres. As a general rule of thumb, sarcomeres (i.e., z-disc pairs) that are not discernible to the human eye will not be properly segmented by Sarc-Graph. In some cases, Sarc-Graph may segment sarcomere-like shapes, but due to inconsistency between frames these shapes will rarely be both segmented and tracked. In general, Sarc-Graph reported metrics have not been explored for poorly formed individual sarcomeres and, at this point in time, are not suitable for these applications. An example of what applying Sarc-Graph to poorly formed sarcomeres might look like is shown in <xref rid="pcbi.1009443.s001" ref-type="supplementary-material">S1 Text</xref>.</p>
        </list-item>
        <list-item>
          <p>Potential bias due to an inability to track all sarcomeres. As seen in both the synthetic and experimental data examples, it is typical for many more sarcomeres to be segmented than tracked. In some cases, segmented sarcomeres will be spurious and because these spurious sarcomere-like conditions are less likely to persist across frames the tracking step provides a beneficial additional filter to remove them. However, in many cases, sarcomere tracking will fail due to either large deformations or deformation with respect to the image plane. Partial tracking becomes a concern when there is bias in the type or location of sarcomeres that are tracked. To address this, there are two options: (1) specify a smaller number of frames to track (e.g. only a single contraction) thus reducing the chance of motion outside the image plane; (2) use the <monospace>compare_tracked_untracked()</monospace> function to compare the properties of tracked and untracked sarcomeres. If there are notable systematic differences, further investigation may be necessary. Future work will focus on making multiple tweaks to improve the performance of Sarc-Graph in both consistent segmentation, tracking, and subsequent statistical analysis.</p>
        </list-item>
        <list-item>
          <p>Lack of explicit force measurements. Our proposed metrics summarize kinematic information only. During cell contraction, individual sarcomere chains may bend, buckle, re-arrange, and interact with other cell components that are not directly visualized [<xref rid="pcbi.1009443.ref043" ref-type="bibr">43</xref>]. Though Sarc-Graph is able to capture the kinematic aspects of bending, buckling, and re-arrangement, Sarc-Graph is unable to capture any direct information about force. Therefore, the proposed contraction metrics should be thought of strictly as kinematic contraction. In future work, Sarc-Graph metrics can be combined with additional experimental information and modeling to better determine the relationship between sarcomere length, motion, and force.</p>
        </list-item>
      </list>
      <p>Future work will focus on both addressing these limitations and comparing the Sarc-Graph metrics to alternative approaches to capturing cell contractile function such as Traction Force Microscopy [<xref rid="pcbi.1009443.ref008" ref-type="bibr">8</xref>, <xref rid="pcbi.1009443.ref044" ref-type="bibr">44</xref>, <xref rid="pcbi.1009443.ref045" ref-type="bibr">45</xref>]. Critically, Sarc-Graph is a platform thorough which biologically relevant length and time scales for hiPSC-CM contraction can be uncovered. For example, Sarc-Graph can be used to understand the relationship between individual sarcomere shortening and overall cell deformation. By extracting explicitly defined relevant information from these information rich movies of hiPSC-CM contraction, Sarc-Graph will help users compare between groups of cells and help uncover fundamental relationships between external conditions, morphology, and contractile function.</p>
    </sec>
  </sec>
  <sec sec-type="conclusions" id="sec017">
    <title>Conclusion</title>
    <p>The objective of this work is to provide an open source computational framework to quantitatively analyze movies of beating hiPSC-CMs. To accomplish this, we introduce tools to segment and track z-discs and sarcomeres, and analyze their spatiotemporal behavior. Notably, we are able to automatically segment and track a high number of sarcomeres across multiple experimental conditions without any input parameter tuning, and we introduce two important new approaches for the analysis of beating hiPSC-CM: a method for computing average deformation gradient, and a method for treating the hiPSC-CMs as spatial graphs. Looking forward, we see this work as an important tool for substantial future study of hiPSC-CM behavior. Finally, our proposed computational framework is heavily documented and has a modular extensible design. We anticipate that many components of our open source software will be directly useful to other researchers.</p>
  </sec>
  <sec id="sec018" sec-type="supplementary-material">
    <title>Supporting information</title>
    <supplementary-material id="pcbi.1009443.s001" position="float" content-type="local-data">
      <label>S1 Text</label>
      <caption>
        <title>A direct comparison to SarcOmere Texture Analysis (SOTA) software from Sutcliffe et al. [<xref rid="pcbi.1009443.ref012" ref-type="bibr">12</xref>].</title>
        <p>Direct comparison to an alternative method for automatically quantifying morphology of single images. <bold>Fig A. Pre-processing with a Gaussian filter</bold>. The effect of applying a Gaussian filter as a pre-processing step on Sarc-Graph illustrated on data from Sutcliffe et al. 2018 [<xref rid="pcbi.1009443.ref012" ref-type="bibr">12</xref>]. <bold>Fig B. Direct comparison between Sarc-Graph and SOTA</bold> [<xref rid="pcbi.1009443.ref012" ref-type="bibr">12</xref>]. Comparison between SOTA and Sarc-Graph of sarcomere segmentation and analysis for the images shown in Figure 6 of Sutcliffe et al. 2018 [<xref rid="pcbi.1009443.ref012" ref-type="bibr">12</xref>].</p>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pcbi.1009443.s001.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pcbi.1009443.s002" position="float" content-type="local-data">
      <label>S2 Text</label>
      <caption>
        <title>A direct comparison to Pasqualini et al. [<xref rid="pcbi.1009443.ref006" ref-type="bibr">6</xref>].</title>
        <p>Evaluation of Sarc-Graph as a potential tool for creating features suitable for machine learning based classification. <bold>Fig A. Pasqualini et al</bold>. [<xref rid="pcbi.1009443.ref006" ref-type="bibr">6</xref>] <bold>dataset</bold>. Visualization of the un-processed dataset from Pasqualini et al. [<xref rid="pcbi.1009443.ref006" ref-type="bibr">6</xref>]. <bold>Fig B. Pasqualini et al</bold>. [<xref rid="pcbi.1009443.ref006" ref-type="bibr">6</xref>] <bold>dataset segmented</bold>. Visualization of the dataset from Pasqualini et al. [<xref rid="pcbi.1009443.ref006" ref-type="bibr">6</xref>] segmented with Sarc-Graph. <bold>Fig C. Pasqualini et al</bold>. [<xref rid="pcbi.1009443.ref006" ref-type="bibr">6</xref>] <bold>dataset analysis results</bold>. Visualization of the information obtained from the Sarc-Graph segmentation shown in Fig B in S2 Text.</p>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pcbi.1009443.s002.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pcbi.1009443.s003" position="float" content-type="local-data">
      <label>S3 Text</label>
      <caption>
        <title>Influence of image resolution on Sarc-Graph performance.</title>
        <p>Presentation and analysis of more synthetic data at multiple image resolutions (this is similar to <xref rid="pcbi.1009443.g005" ref-type="fig">Fig 5</xref>). <bold>Fig A. Demonstration of varied image resolution</bold>. Performance of Sarc-Graph in segmentation and tracking with respect to image resolution. <bold>Fig B. F<sub>avg</sub> analysis at multiple image resolutions</bold>. Comparison of <bold>F</bold><sub>avg</sub> computed with Sarc-Graph to the ground truth at different rendering resolutions. <bold>Fig C. OOP analysis at multiple image resolutions</bold>. Comparison of <italic toggle="yes">OOP</italic> computed with Sarc-Graph to the ground truth at different rendering resolutions. <bold>Fig D. Angle analysis at multiple image resolutions</bold>. Comparison of sarcomere angle computed with Sarc-Graph to the ground truth at different rendering resolutions.</p>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pcbi.1009443.s003.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pcbi.1009443.s004" position="float" content-type="local-data">
      <label>S4 Text</label>
      <caption>
        <title>A direct comparison to SarcTrack software from Toepfer et al. [<xref rid="pcbi.1009443.ref010" ref-type="bibr">10</xref>].</title>
        <p>Direct comparison to an alternative method for automated segmentation and tracking of hiPSC-CMs. <bold>Fig A. SarcTrack</bold> [<xref rid="pcbi.1009443.ref010" ref-type="bibr">10</xref>] <bold>comparison 1</bold>. Synthetic data and comparison to SarcTrack [<xref rid="pcbi.1009443.ref010" ref-type="bibr">10</xref>], example “411.” <bold>Fig B. SarcTrack</bold> [<xref rid="pcbi.1009443.ref010" ref-type="bibr">10</xref>] <bold>comparison 2</bold>. Synthetic data and comparison to SarcTrack [<xref rid="pcbi.1009443.ref010" ref-type="bibr">10</xref>], example “412.” <bold>Fig C. SarcTrack</bold> [<xref rid="pcbi.1009443.ref010" ref-type="bibr">10</xref>] <bold>comparison 3</bold>. Synthetic data and comparison to SarcTrack [<xref rid="pcbi.1009443.ref010" ref-type="bibr">10</xref>], example “421.” <bold>Fig D. SarcTrack</bold> [<xref rid="pcbi.1009443.ref010" ref-type="bibr">10</xref>] <bold>comparison 4</bold>. Synthetic data and comparison to SarcTrack [<xref rid="pcbi.1009443.ref010" ref-type="bibr">10</xref>], example “422.” <bold>Fig E. SarcTrack</bold> [<xref rid="pcbi.1009443.ref010" ref-type="bibr">10</xref>] <bold>comparison 5</bold>. Synthetic data and comparison to SarcTrack [<xref rid="pcbi.1009443.ref010" ref-type="bibr">10</xref>], example “1011.” <bold>Fig F. SarcTrack</bold> [<xref rid="pcbi.1009443.ref010" ref-type="bibr">10</xref>] <bold>comparison 6</bold>. Synthetic data and comparison to SarcTrack [<xref rid="pcbi.1009443.ref010" ref-type="bibr">10</xref>], example “1012.” <bold>Fig G. SarcTrack</bold> [<xref rid="pcbi.1009443.ref010" ref-type="bibr">10</xref>] <bold>comparison 7</bold>. Synthetic data and comparison to SarcTrack [<xref rid="pcbi.1009443.ref010" ref-type="bibr">10</xref>], example “1021.” <bold>Fig H. SarcTrack</bold> [<xref rid="pcbi.1009443.ref010" ref-type="bibr">10</xref>] <bold>comparison 8</bold>. Synthetic data and comparison to SarcTrack [<xref rid="pcbi.1009443.ref010" ref-type="bibr">10</xref>], example “1022.”.</p>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pcbi.1009443.s004.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pcbi.1009443.s005" position="float" content-type="local-data">
      <label>S1 Movie</label>
      <caption>
        <title>A movie of E1.</title>
        <p>The movie contains a schematic illustration of deformation gradient <bold>F</bold><sub>avg</sub> and tracked sarcomeres overlaid (sarcomere color corresponds to contraction level with red indicating the highest level of contraction), magnitudes of average principal stretches (λ<sub>1</sub>, λ<sub>2</sub> computed from <bold>F</bold><sub>avg</sub>), and average normalized sarcomere length, both with respect to the movie frame number. This movie is a supplement to <xref rid="pcbi.1009443.g007" ref-type="fig">Fig 7</xref>, sample E1.</p>
        <p>(MP4)</p>
      </caption>
      <media xlink:href="pcbi.1009443.s005.mp4" mimetype="video" mime-subtype="mp4">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pcbi.1009443.s006" position="float" content-type="local-data">
      <label>S2 Movie</label>
      <caption>
        <title>A movie of E2.</title>
        <p>The movie contains a schematic illustration of deformation gradient <bold>F</bold><sub>avg</sub> and tracked sarcomeres overlaid (sarcomere color corresponds to contraction level with red indicating the highest level of contraction), magnitudes of average principal stretches (λ<sub>1</sub>, λ<sub>2</sub> computed from <bold>F</bold><sub>avg</sub>), and average normalized sarcomere length, both with respect to the movie frame number. This movie is a supplement to <xref rid="pcbi.1009443.g007" ref-type="fig">Fig 7</xref>, sample E2.</p>
        <p>(MP4)</p>
      </caption>
      <media xlink:href="pcbi.1009443.s006.mp4" mimetype="video" mime-subtype="mp4">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pcbi.1009443.s007" position="float" content-type="local-data">
      <label>S3 Movie</label>
      <caption>
        <title>A movie of E3.</title>
        <p>The movie contains a schematic illustration of deformation gradient <bold>F</bold><sub>avg</sub> and tracked sarcomeres overlaid (sarcomere color corresponds to contraction level with red indicating the highest level of contraction), magnitudes of average principal stretches (λ<sub>1</sub>, λ<sub>2</sub> computed from <bold>F</bold><sub>avg</sub>), and average normalized sarcomere length, both with respect to the movie frame number. This movie is a supplement to <xref rid="pcbi.1009443.g008" ref-type="fig">Fig 8</xref>, sample E3.</p>
        <p>(MP4)</p>
      </caption>
      <media xlink:href="pcbi.1009443.s007.mp4" mimetype="video" mime-subtype="mp4">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pcbi.1009443.s008" position="float" content-type="local-data">
      <label>S4 Movie</label>
      <caption>
        <title>A movie of E4.</title>
        <p>The movie contains a schematic illustration of deformation gradient <bold>F</bold><sub>avg</sub> and tracked sarcomeres overlaid (sarcomere color corresponds to contraction level with red indicating the highest level of contraction), magnitudes of average principal stretches (λ<sub>1</sub>, λ<sub>2</sub> computed from <bold>F</bold><sub>avg</sub>), and average normalized sarcomere length, both with respect to the movie frame number. This movie is a supplement to <xref rid="pcbi.1009443.g008" ref-type="fig">Fig 8</xref>, sample E4.</p>
        <p>(MP4)</p>
      </caption>
      <media xlink:href="pcbi.1009443.s008.mp4" mimetype="video" mime-subtype="mp4">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pcbi.1009443.s009" position="float" content-type="local-data">
      <label>S5 Movie</label>
      <caption>
        <title>A movie of E5.</title>
        <p>The movie contains a schematic illustration of deformation gradient <bold>F</bold><sub>avg</sub> and tracked sarcomeres overlaid (sarcomere color corresponds to contraction level with red indicating the highest level of contraction), magnitudes of average principal stretches (λ<sub>1</sub>, λ<sub>2</sub> computed from <bold>F</bold><sub>avg</sub>), and average normalized sarcomere length, both with respect to the movie frame number. This movie is a supplement to <xref rid="pcbi.1009443.g009" ref-type="fig">Fig 9</xref>, sample E5. A still frame from this movie is also shown in <xref rid="pcbi.1009443.g001" ref-type="fig">Fig 1</xref>.</p>
        <p>(MP4)</p>
      </caption>
      <media xlink:href="pcbi.1009443.s009.mp4" mimetype="video" mime-subtype="mp4">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ref-list>
    <title>References</title>
    <ref id="pcbi.1009443.ref001">
      <label>1</label>
      <mixed-citation publication-type="book"><name><surname>Gorski</surname><given-names>PA</given-names></name>, <name><surname>Kho</surname><given-names>C</given-names></name>, <name><surname>Oh</surname><given-names>JG</given-names></name>. <part-title>Measuring cardiomyocyte contractility and calcium handling in vitro</part-title>. In: <source>Experimental Models of Cardiovascular Diseases</source>. <publisher-name>Springer</publisher-name>; <year>2018</year>. p. <fpage>93</fpage>–<lpage>104</lpage>.</mixed-citation>
    </ref>
    <ref id="pcbi.1009443.ref002">
      <label>2</label>
      <mixed-citation publication-type="journal"><name><surname>Pasqualin</surname><given-names>C</given-names></name>, <name><surname>Gannier</surname><given-names>F</given-names></name>, <name><surname>Yu</surname><given-names>A</given-names></name>, <name><surname>Malécot</surname><given-names>CO</given-names></name>, <name><surname>Bredeloux</surname><given-names>P</given-names></name>, <name><surname>Maupoil</surname><given-names>V</given-names></name>. <article-title>SarcOptiM for ImageJ: high-frequency online sarcomere length computing on stimulated cardiomyocytes</article-title>. <source>American Journal of Physiology-Cell Physiology</source>. <year>2016</year>;<volume>311</volume>(<issue>2</issue>):<fpage>C277</fpage>–<lpage>C283</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1152/ajpcell.00094.2016</pub-id><?supplied-pmid 27335170?><pub-id pub-id-type="pmid">27335170</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009443.ref003">
      <label>3</label>
      <mixed-citation publication-type="journal"><name><surname>Beussman</surname><given-names>KM</given-names></name>, <name><surname>Rodriguez</surname><given-names>ML</given-names></name>, <name><surname>Leonard</surname><given-names>A</given-names></name>, <name><surname>Taparia</surname><given-names>N</given-names></name>, <name><surname>Thompson</surname><given-names>CR</given-names></name>, <name><surname>Sniadecki</surname><given-names>NJ</given-names></name>. <article-title>Micropost arrays for measuring stem cell-derived cardiomyocyte contractility</article-title>. <source>Methods</source>. <year>2016</year>;<volume>94</volume>:<fpage>43</fpage>–<lpage>50</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1016/j.ymeth.2015.09.005</pub-id><?supplied-pmid 26344757?><pub-id pub-id-type="pmid">26344757</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009443.ref004">
      <label>4</label>
      <mixed-citation publication-type="journal"><name><surname>Wheelwright</surname><given-names>M</given-names></name>, <name><surname>Win</surname><given-names>Z</given-names></name>, <name><surname>Mikkila</surname><given-names>JL</given-names></name>, <name><surname>Amen</surname><given-names>KY</given-names></name>, <name><surname>Alford</surname><given-names>PW</given-names></name>, <name><surname>Metzger</surname><given-names>JM</given-names></name>. <article-title>Investigation of human iPSC-derived cardiac myocyte functional maturation by single cell traction force microscopy</article-title>. <source>PLoS One</source>. <year>2018</year>;<volume>13</volume>(<issue>4</issue>):<fpage>e0194909</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1371/journal.pone.0194909</pub-id><?supplied-pmid 29617427?><pub-id pub-id-type="pmid">29617427</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009443.ref005">
      <label>5</label>
      <mixed-citation publication-type="journal"><name><surname>Clark</surname><given-names>KA</given-names></name>, <name><surname>McElhinny</surname><given-names>AS</given-names></name>, <name><surname>Beckerle</surname><given-names>MC</given-names></name>, <name><surname>Gregorio</surname><given-names>CC</given-names></name>. <article-title>Striated muscle cytoarchitecture: an intricate web of form and function</article-title>. <source>Annual review of cell and developmental biology</source>. <year>2002</year>;<volume>18</volume>(<issue>1</issue>):<fpage>637</fpage>–<lpage>706</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1146/annurev.cellbio.18.012502.105840</pub-id><?supplied-pmid 12142273?><pub-id pub-id-type="pmid">12142273</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009443.ref006">
      <label>6</label>
      <mixed-citation publication-type="journal"><name><surname>Pasqualini</surname><given-names>FS</given-names></name>, <name><surname>Sheehy</surname><given-names>SP</given-names></name>, <name><surname>Agarwal</surname><given-names>A</given-names></name>, <name><surname>Aratyn-Schaus</surname><given-names>Y</given-names></name>, <name><surname>Parker</surname><given-names>KK</given-names></name>. <article-title>Structural phenotyping of stem cell-derived cardiomyocytes</article-title>. <source>Stem cell reports</source>. <year>2015</year>;<volume>4</volume>(<issue>3</issue>):<fpage>340</fpage>–<lpage>347</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1016/j.stemcr.2015.01.020</pub-id><?supplied-pmid 25733020?><pub-id pub-id-type="pmid">25733020</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009443.ref007">
      <label>7</label>
      <mixed-citation publication-type="journal"><name><surname>Sheehy</surname><given-names>SP</given-names></name>, <name><surname>Pasqualini</surname><given-names>F</given-names></name>, <name><surname>Grosberg</surname><given-names>A</given-names></name>, <name><surname>Park</surname><given-names>SJ</given-names></name>, <name><surname>Aratyn-Schaus</surname><given-names>Y</given-names></name>, <name><surname>Parker</surname><given-names>KK</given-names></name>. <article-title>Quality metrics for stem cell-derived cardiac myocytes</article-title>. <source>Stem cell reports</source>. <year>2014</year>;<volume>2</volume>(<issue>3</issue>):<fpage>282</fpage>–<lpage>294</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1016/j.stemcr.2014.01.015</pub-id><?supplied-pmid 24672752?><pub-id pub-id-type="pmid">24672752</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009443.ref008">
      <label>8</label>
      <mixed-citation publication-type="journal"><name><surname>Ribeiro</surname><given-names>AJ</given-names></name>, <name><surname>Schwab</surname><given-names>O</given-names></name>, <name><surname>Mandegar</surname><given-names>MA</given-names></name>, <name><surname>Ang</surname><given-names>YS</given-names></name>, <name><surname>Conklin</surname><given-names>BR</given-names></name>, <name><surname>Srivastava</surname><given-names>D</given-names></name>, <etal>et al</etal>. <article-title>Multi-imaging method to assay the contractile mechanical output of micropatterned human iPSC-derived cardiac myocytes</article-title>. <source>Circulation research</source>. <year>2017</year>;<volume>120</volume>(<issue>10</issue>):<fpage>1572</fpage>–<lpage>1583</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1161/CIRCRESAHA.116.310363</pub-id><?supplied-pmid 28400398?><pub-id pub-id-type="pmid">28400398</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009443.ref009">
      <label>9</label>
      <mixed-citation publication-type="journal"><name><surname>Eschenhagen</surname><given-names>T</given-names></name>, <name><surname>Carrier</surname><given-names>L</given-names></name>. <article-title>Cardiomyopathy phenotypes in human-induced pluripotent stem cell-derived cardiomyocytes—a systematic review</article-title>. <source>Pflügers Archiv-European Journal of Physiology</source>. <year>2019</year>;<volume>471</volume>(<issue>5</issue>):<fpage>755</fpage>–<lpage>768</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1007/s00424-018-2214-0</pub-id><?supplied-pmid 30324321?><pub-id pub-id-type="pmid">30324321</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009443.ref010">
      <label>10</label>
      <mixed-citation publication-type="journal"><name><surname>Toepfer</surname><given-names>CN</given-names></name>, <name><surname>Sharma</surname><given-names>A</given-names></name>, <name><surname>Cicconet</surname><given-names>M</given-names></name>, <name><surname>Garfinkel</surname><given-names>AC</given-names></name>, <name><surname>Mücke</surname><given-names>M</given-names></name>, <name><surname>Neyazi</surname><given-names>M</given-names></name>, <etal>et al</etal>. <article-title>SarcTrack: an adaptable software tool for efficient large-scale analysis of sarcomere function in hiPSC-cardiomyocytes</article-title>. <source>Circulation research</source>. <year>2019</year>;<volume>124</volume>(<issue>8</issue>):<fpage>1172</fpage>–<lpage>1183</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1161/CIRCRESAHA.118.314505</pub-id><?supplied-pmid 30700234?><pub-id pub-id-type="pmid">30700234</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009443.ref011">
      <label>11</label>
      <mixed-citation publication-type="journal"><name><surname>Morris</surname><given-names>TA</given-names></name>, <name><surname>Naik</surname><given-names>J</given-names></name>, <name><surname>Fibben</surname><given-names>KS</given-names></name>, <name><surname>Kong</surname><given-names>X</given-names></name>, <name><surname>Kiyono</surname><given-names>T</given-names></name>, <name><surname>Yokomori</surname><given-names>K</given-names></name>, <etal>et al</etal>. <article-title>Striated myocyte structural integrity: Automated analysis of sarcomeric z-discs</article-title>. <source>PLoS computational biology</source>. <year>2020</year>;<volume>16</volume>(<issue>3</issue>):<fpage>e1007676</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1371/journal.pcbi.1007676</pub-id><?supplied-pmid 32130207?><pub-id pub-id-type="pmid">32130207</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009443.ref012">
      <label>12</label>
      <mixed-citation publication-type="journal"><name><surname>Sutcliffe</surname><given-names>MD</given-names></name>, <name><surname>Tan</surname><given-names>PM</given-names></name>, <name><surname>Fernandez-Perez</surname><given-names>A</given-names></name>, <name><surname>Nam</surname><given-names>YJ</given-names></name>, <name><surname>Munshi</surname><given-names>NV</given-names></name>, <name><surname>Saucerman</surname><given-names>JJ</given-names></name>. <article-title>High content analysis identifies unique morphological features of reprogrammed cardiomyocytes</article-title>. <source>Scientific reports</source>. <year>2018</year>;<volume>8</volume>(<issue>1</issue>):<fpage>1</fpage>–<lpage>11</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/s41598-018-19539-z</pub-id><?supplied-pmid 29352247?><pub-id pub-id-type="pmid">29311619</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009443.ref013">
      <label>13</label>
      <mixed-citation publication-type="journal"><name><surname>Schneider</surname><given-names>CA</given-names></name>, <name><surname>Rasband</surname><given-names>WS</given-names></name>, <name><surname>Eliceiri</surname><given-names>KW</given-names></name>. <article-title>NIH Image to ImageJ: 25 years of image analysis</article-title>. <source>Nature methods</source>. <year>2012</year>;<volume>9</volume>(<issue>7</issue>):<fpage>671</fpage>–<lpage>675</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/nmeth.2089</pub-id><?supplied-pmid 22930834?><pub-id pub-id-type="pmid">22930834</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009443.ref014">
      <label>14</label>
      <mixed-citation publication-type="journal"><name><surname>Grosberg</surname><given-names>A</given-names></name>, <name><surname>Kuo</surname><given-names>PL</given-names></name>, <name><surname>Guo</surname><given-names>CL</given-names></name>, <name><surname>Geisse</surname><given-names>NA</given-names></name>, <name><surname>Bray</surname><given-names>MA</given-names></name>, <name><surname>Adams</surname><given-names>WJ</given-names></name>, <etal>et al</etal>. <article-title>Self-organization of muscle cell structure and function</article-title>. <source>PLoS computational biology</source>. <year>2011</year>;<volume>7</volume>(<issue>2</issue>):<fpage>e1001088</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1371/journal.pcbi.1001088</pub-id><?supplied-pmid 21390276?><pub-id pub-id-type="pmid">21390276</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009443.ref015">
      <label>15</label>
      <mixed-citation publication-type="journal"><name><surname>Kijlstra</surname><given-names>JD</given-names></name>, <name><surname>Hu</surname><given-names>D</given-names></name>, <name><surname>Mittal</surname><given-names>N</given-names></name>, <name><surname>Kausel</surname><given-names>E</given-names></name>, <name><surname>van der Meer</surname><given-names>P</given-names></name>, <name><surname>Garakani</surname><given-names>A</given-names></name>, <etal>et al</etal>. <article-title>Integrated analysis of contractile kinetics, force generation, and electrical activity in single human stem cell-derived cardiomyocytes</article-title>. <source>Stem cell reports</source>. <year>2015</year>;<volume>5</volume>(<issue>6</issue>):<fpage>1226</fpage>–<lpage>1238</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1016/j.stemcr.2015.10.017</pub-id><?supplied-pmid 26626178?><pub-id pub-id-type="pmid">26626178</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009443.ref016">
      <label>16</label>
      <mixed-citation publication-type="journal"><name><surname>Lundy</surname><given-names>SD</given-names></name>, <name><surname>Zhu</surname><given-names>WZ</given-names></name>, <name><surname>Regnier</surname><given-names>M</given-names></name>, <name><surname>Laflamme</surname><given-names>MA</given-names></name>. <article-title>Structural and functional maturation of cardiomyocytes derived from human pluripotent stem cells</article-title>. <source>Stem cells and development</source>. <year>2013</year>;<volume>22</volume>(<issue>14</issue>):<fpage>1991</fpage>–<lpage>2002</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1089/scd.2012.0490</pub-id><?supplied-pmid 23461462?><pub-id pub-id-type="pmid">23461462</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009443.ref017">
      <label>17</label>
      <mixed-citation publication-type="journal"><name><surname>Ribeiro</surname><given-names>AJ</given-names></name>, <name><surname>Ang</surname><given-names>YS</given-names></name>, <name><surname>Fu</surname><given-names>JD</given-names></name>, <name><surname>Rivas</surname><given-names>RN</given-names></name>, <name><surname>Mohamed</surname><given-names>TM</given-names></name>, <name><surname>Higgs</surname><given-names>GC</given-names></name>, <etal>et al</etal>. <article-title>Contractility of single cardiomyocytes differentiated from pluripotent stem cells depends on physiological shape and substrate stiffness</article-title>. <source>Proceedings of the National Academy of Sciences</source>. <year>2015</year>;<volume>112</volume>(<issue>41</issue>):<fpage>12705</fpage>–<lpage>12710</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1073/pnas.1508073112</pub-id><?supplied-pmid 26417073?><pub-id pub-id-type="pmid">26417073</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009443.ref018">
      <label>18</label>
      <mixed-citation publication-type="journal"><name><surname>Drew</surname><given-names>NK</given-names></name>, <name><surname>Eagleson</surname><given-names>MA</given-names></name>, <name><surname>Baldo</surname><given-names>DB</given-names><suffix>Jr</suffix></name>, <name><surname>Parker</surname><given-names>KK</given-names></name>, <name><surname>Grosberg</surname><given-names>A</given-names></name>. <article-title>Metrics for assessing cytoskeletal orientational correlations and consistency</article-title>. <source>PLoS computational biology</source>. <year>2015</year>;<volume>11</volume>(<issue>4</issue>):<fpage>e1004190</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1371/journal.pcbi.1004190</pub-id><?supplied-pmid 25849553?><pub-id pub-id-type="pmid">25849553</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009443.ref019">
      <label>19</label>
      <mixed-citation publication-type="journal"><name><surname>Leggett</surname><given-names>SE</given-names></name>, <name><surname>Patel</surname><given-names>M</given-names></name>, <name><surname>Valentin</surname><given-names>TM</given-names></name>, <name><surname>Gamboa</surname><given-names>L</given-names></name>, <name><surname>Khoo</surname><given-names>AS</given-names></name>, <name><surname>Williams</surname><given-names>EK</given-names></name>, <etal>et al</etal>. <article-title>Mechanophenotyping of 3D multicellular clusters using displacement arrays of rendered tractions</article-title>. <source>Proceedings of the National Academy of Sciences</source>. <year>2020</year>;<volume>117</volume>(<issue>11</issue>):<fpage>5655</fpage>–<lpage>5663</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1073/pnas.1918296117</pub-id><?supplied-pmid 32123100?><pub-id pub-id-type="pmid">32123100</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009443.ref020">
      <label>20</label>
      <mixed-citation publication-type="journal"><name><surname>Stout</surname><given-names>DA</given-names></name>, <name><surname>Bar-Kochba</surname><given-names>E</given-names></name>, <name><surname>Estrada</surname><given-names>JB</given-names></name>, <name><surname>Toyjanova</surname><given-names>J</given-names></name>, <name><surname>Kesari</surname><given-names>H</given-names></name>, <name><surname>Reichner</surname><given-names>JS</given-names></name>, <etal>et al</etal>. <article-title>Mean deformation metrics for quantifying 3D cell–matrix interactions without requiring information about matrix material properties</article-title>. <source>Proceedings of the National Academy of Sciences</source>. <year>2016</year>;<volume>113</volume>(<issue>11</issue>):<fpage>2898</fpage>–<lpage>2903</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1073/pnas.1510935113</pub-id><?supplied-pmid 26929377?><pub-id pub-id-type="pmid">26929377</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009443.ref021">
      <label>21</label>
      <mixed-citation publication-type="journal"><name><surname>Haddad</surname><given-names>RA</given-names></name>, <name><surname>Akansu</surname><given-names>AN</given-names></name>, <etal>et al</etal>. <article-title>A class of fast Gaussian binomial filters for speech and image processing</article-title>. <source>IEEE Transactions on Signal Processing</source>. <year>1991</year>;<volume>39</volume>(<issue>3</issue>):<fpage>723</fpage>–<lpage>727</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1109/78.80892</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009443.ref022">
      <label>22</label>
      <mixed-citation publication-type="journal"><name><surname>Perlin</surname><given-names>K</given-names></name>. <article-title>An image synthesizer</article-title>. <source>ACM Siggraph Computer Graphics</source>. <year>1985</year>;<volume>19</volume>(<issue>3</issue>):<fpage>287</fpage>–<lpage>296</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1145/325165.325247</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009443.ref023">
      <label>23</label>
      <mixed-citation publication-type="journal"><name><surname>Harris</surname><given-names>CR</given-names></name>, <name><surname>Millman</surname><given-names>KJ</given-names></name>, <name><surname>van der Walt</surname><given-names>SJ</given-names></name>, <name><surname>Gommers</surname><given-names>R</given-names></name>, <name><surname>Virtanen</surname><given-names>P</given-names></name>, <name><surname>Cournapeau</surname><given-names>D</given-names></name>, <etal>et al</etal>. <article-title>Array programming with NumPy</article-title>. <source>Nature</source>. <year>2020</year>;<volume>585</volume>(<issue>7825</issue>):<fpage>357</fpage>–<lpage>362</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/s41586-020-2649-2</pub-id><?supplied-pmid 32939066?><pub-id pub-id-type="pmid">32939066</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009443.ref024">
      <label>24</label>
      <mixed-citation publication-type="journal"><name><surname>Hunter</surname><given-names>JD</given-names></name>. <article-title>Matplotlib: A 2D graphics environment</article-title>. <source>Computing in Science &amp; Engineering</source>. <year>2007</year>;<volume>9</volume>(<issue>3</issue>):<fpage>90</fpage>–<lpage>95</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1109/MCSE.2007.55</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009443.ref025">
      <label>25</label>
      <mixed-citation publication-type="journal"><name><surname>Chopra</surname><given-names>A</given-names></name>, <name><surname>Kutys</surname><given-names>ML</given-names></name>, <name><surname>Zhang</surname><given-names>K</given-names></name>, <name><surname>Polacheck</surname><given-names>WJ</given-names></name>, <name><surname>Sheng</surname><given-names>CC</given-names></name>, <name><surname>Luu</surname><given-names>RJ</given-names></name>, <etal>et al</etal>. <article-title>Force generation via <italic toggle="yes">β</italic>-cardiac myosin, titin, and <italic toggle="yes">α</italic>-actinin drives cardiac sarcomere assembly from cell-matrix adhesions</article-title>. <source>Developmental cell</source>. <year>2018</year>;<volume>44</volume>(<issue>1</issue>):<fpage>87</fpage>–<lpage>96</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1016/j.devcel.2017.12.012</pub-id><?supplied-pmid 29316444?><pub-id pub-id-type="pmid">29316444</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009443.ref026">
      <label>26</label>
      <mixed-citation publication-type="journal"><name><surname>Sharma</surname><given-names>A</given-names></name>, <name><surname>Toepfer</surname><given-names>CN</given-names></name>, <name><surname>Ward</surname><given-names>T</given-names></name>, <name><surname>Wasson</surname><given-names>L</given-names></name>, <name><surname>Agarwal</surname><given-names>R</given-names></name>, <name><surname>Conner</surname><given-names>DA</given-names></name>, <etal>et al</etal>. <article-title>CRISPR/Cas9-mediated fluorescent tagging of endogenous proteins in human pluripotent stem cells</article-title>. <source>Current protocols in human genetics</source>. <year>2018</year>;<volume>96</volume>(<issue>1</issue>):<fpage>21</fpage>–<lpage>11</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1002/cphg.52</pub-id><?supplied-pmid 29364519?><pub-id pub-id-type="pmid">29364519</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009443.ref027">
      <label>27</label>
      <mixed-citation publication-type="journal"><name><surname>Bradski</surname><given-names>G</given-names></name>. <article-title>The OpenCV Library</article-title>. <source>Dr Dobb’s Journal of Software Tools</source>. <year>2000</year>;.</mixed-citation>
    </ref>
    <ref id="pcbi.1009443.ref028">
      <label>28</label>
      <mixed-citation publication-type="journal"><name><surname>Otsu</surname><given-names>N</given-names></name>. <article-title>A threshold selection method from gray-level histograms</article-title>. <source>IEEE transactions on systems, man, and cybernetics</source>. <year>1979</year>;<volume>9</volume>(<issue>1</issue>):<fpage>62</fpage>–<lpage>66</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1109/TSMC.1979.4310076</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009443.ref029">
      <label>29</label>
      <mixed-citation publication-type="other">Allan D, van der Wel C, Keim N, Caswell T, Wieker D, Verweij R, et al. soft-matter/trackpy: Trackpy v0. 4.2 (2019).</mixed-citation>
    </ref>
    <ref id="pcbi.1009443.ref030">
      <label>30</label>
      <mixed-citation publication-type="journal"><name><surname>Virtanen</surname><given-names>P</given-names></name>, <name><surname>Gommers</surname><given-names>R</given-names></name>, <name><surname>Oliphant</surname><given-names>TE</given-names></name>, <name><surname>Haberland</surname><given-names>M</given-names></name>, <name><surname>Reddy</surname><given-names>T</given-names></name>, <name><surname>Cournapeau</surname><given-names>D</given-names></name>, <etal>et al</etal>. <article-title>SciPy 1.0: Fundamental Algorithms for Scientific Computing in Python</article-title>. <source>Nature Methods</source>. <year>2020</year>;<volume>17</volume>:<fpage>261</fpage>–<lpage>272</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/s41592-019-0686-2</pub-id><?supplied-pmid 32015543?><pub-id pub-id-type="pmid">32015543</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009443.ref031">
      <label>31</label>
      <mixed-citation publication-type="journal"><name><surname>Van der Walt</surname><given-names>S</given-names></name>, <name><surname>Schönberger</surname><given-names>JL</given-names></name>, <name><surname>Nunez-Iglesias</surname><given-names>J</given-names></name>, <name><surname>Boulogne</surname><given-names>F</given-names></name>, <name><surname>Warner</surname><given-names>JD</given-names></name>, <name><surname>Yager</surname><given-names>N</given-names></name>, <etal>et al</etal>. <article-title>scikit-image: image processing in Python</article-title>. <source>PeerJ</source>. <year>2014</year>;<volume>2</volume>:<fpage>e453</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.7717/peerj.453</pub-id><?supplied-pmid 25024921?><pub-id pub-id-type="pmid">25024921</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009443.ref032">
      <label>32</label>
      <mixed-citation publication-type="journal"><name><surname>Crocker</surname><given-names>JC</given-names></name>, <name><surname>Grier</surname><given-names>DG</given-names></name>. <article-title>Methods of digital video microscopy for colloidal studies</article-title>. <source>Journal of colloid and interface science</source>. <year>1996</year>;<volume>179</volume>(<issue>1</issue>):<fpage>298</fpage>–<lpage>310</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1006/jcis.1996.0217</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009443.ref033">
      <label>33</label>
      <mixed-citation publication-type="other">pandas development team T. pandas-dev/pandas: Pandas; 2020. Available from: <pub-id pub-id-type="doi">10.5281/zenodo.3509134</pub-id>.</mixed-citation>
    </ref>
    <ref id="pcbi.1009443.ref034">
      <label>34</label>
      <mixed-citation publication-type="other">Rasmussen CE, Williams CK. Gaussian Process Regression for Machine Learning; 2006.</mixed-citation>
    </ref>
    <ref id="pcbi.1009443.ref035">
      <label>35</label>
      <mixed-citation publication-type="journal"><name><surname>Pedregosa</surname><given-names>F</given-names></name>, <name><surname>Varoquaux</surname><given-names>G</given-names></name>, <name><surname>Gramfort</surname><given-names>A</given-names></name>, <name><surname>Michel</surname><given-names>V</given-names></name>, <name><surname>Thirion</surname><given-names>B</given-names></name>, <name><surname>Grisel</surname><given-names>O</given-names></name>, <etal>et al</etal>. <article-title>Scikit-learn: Machine learning in Python</article-title>. <source>the Journal of machine Learning research</source>. <year>2011</year>;<volume>12</volume>:<fpage>2825</fpage>–<lpage>2830</lpage>.</mixed-citation>
    </ref>
    <ref id="pcbi.1009443.ref036">
      <label>36</label>
      <mixed-citation publication-type="journal"><name><surname>Carpenter</surname><given-names>AE</given-names></name>, <name><surname>Jones</surname><given-names>TR</given-names></name>, <name><surname>Lamprecht</surname><given-names>MR</given-names></name>, <name><surname>Clarke</surname><given-names>C</given-names></name>, <name><surname>Kang</surname><given-names>IH</given-names></name>, <name><surname>Friman</surname><given-names>O</given-names></name>, <etal>et al</etal>. <article-title>CellProfiler: image analysis software for identifying and quantifying cell phenotypes</article-title>. <source>Genome biology</source>. <year>2006</year>;<volume>7</volume>(<issue>10</issue>):<fpage>R100</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1186/gb-2006-7-10-r100</pub-id><?supplied-pmid 17076895?><pub-id pub-id-type="pmid">17076895</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009443.ref037">
      <label>37</label>
      <mixed-citation publication-type="journal"><name><surname>Lejeune</surname><given-names>E</given-names></name>, <name><surname>Dortdivanlioglu</surname><given-names>B</given-names></name>, <name><surname>Kuhl</surname><given-names>E</given-names></name>, <name><surname>Linder</surname><given-names>C</given-names></name>. <article-title>Understanding the mechanical link between oriented cell division and cerebellar morphogenesis</article-title>. <source>Soft matter</source>. <year>2019</year>;<volume>15</volume>(<issue>10</issue>):<fpage>2204</fpage>–<lpage>2215</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1039/C8SM02231C</pub-id><?supplied-pmid 30758032?><pub-id pub-id-type="pmid">30758032</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009443.ref038">
      <label>38</label>
      <mixed-citation publication-type="journal"><name><surname>Lejeune</surname><given-names>E</given-names></name>, <name><surname>Linder</surname><given-names>C</given-names></name>. <article-title>Quantifying the relationship between cell division angle and morphogenesis through computational modeling</article-title>. <source>Journal of theoretical biology</source>. <year>2017</year>;<volume>418</volume>:<fpage>1</fpage>–<lpage>7</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1016/j.jtbi.2017.01.026</pub-id><?supplied-pmid 28119022?><pub-id pub-id-type="pmid">28119022</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009443.ref039">
      <label>39</label>
      <mixed-citation publication-type="other">Holzapfel GA. Nonlinear Solid Mechanics A Continuum Approach for Engineering; 2000.</mixed-citation>
    </ref>
    <ref id="pcbi.1009443.ref040">
      <label>40</label>
      <mixed-citation publication-type="journal"><name><surname>Umeno</surname><given-names>A</given-names></name>, <name><surname>Kotani</surname><given-names>H</given-names></name>, <name><surname>Iwasaka</surname><given-names>M</given-names></name>, <name><surname>Ueno</surname><given-names>S</given-names></name>. <article-title>Quantification of adherent cell orientation and morphology under strong magnetic fields</article-title>. <source>IEEE transactions on magnetics</source>. <year>2001</year>;<volume>37</volume>(<issue>4</issue>):<fpage>2909</fpage>–<lpage>2911</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1109/20.951344</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009443.ref041">
      <label>41</label>
      <mixed-citation publication-type="other">Hagberg AA, Schult DA, Swart PJ. Exploring Network Structure, Dynamics, and Function using NetworkX. In: Varoquaux G, Vaught T, Millman J, editors. Proceedings of the 7th Python in Science Conference. Pasadena, CA USA; 2008. p. 11–15.</mixed-citation>
    </ref>
    <ref id="pcbi.1009443.ref042">
      <label>42</label>
      <mixed-citation publication-type="journal"><name><surname>Senin</surname><given-names>P</given-names></name>. <article-title>Dynamic time warping algorithm review</article-title>. <source>Information and Computer Science Department University of Hawaii at Manoa Honolulu, USA</source>. <year>2008</year>;<volume>855</volume>(<issue>1-23</issue>):<fpage>40</fpage>.</mixed-citation>
    </ref>
    <ref id="pcbi.1009443.ref043">
      <label>43</label>
      <mixed-citation publication-type="journal"><name><surname>Robison</surname><given-names>P</given-names></name>, <name><surname>Caporizzo</surname><given-names>MA</given-names></name>, <name><surname>Ahmadzadeh</surname><given-names>H</given-names></name>, <name><surname>Bogush</surname><given-names>AI</given-names></name>, <name><surname>Chen</surname><given-names>CY</given-names></name>, <name><surname>Margulies</surname><given-names>KB</given-names></name>, <etal>et al</etal>. <article-title>Detyrosinated microtubules buckle and bear load in contracting cardiomyocytes</article-title>. <source>Science</source>. <year>2016</year>;<volume>352</volume> (<issue>6284</issue>). <comment>doi: </comment><pub-id pub-id-type="doi">10.1126/science.aaf0659</pub-id>
<?supplied-pmid 27102488?><pub-id pub-id-type="pmid">27102488</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009443.ref044">
      <label>44</label>
      <mixed-citation publication-type="journal"><name><surname>Legant</surname><given-names>WR</given-names></name>, <name><surname>Miller</surname><given-names>JS</given-names></name>, <name><surname>Blakely</surname><given-names>BL</given-names></name>, <name><surname>Cohen</surname><given-names>DM</given-names></name>, <name><surname>Genin</surname><given-names>GM</given-names></name>, <name><surname>Chen</surname><given-names>CS</given-names></name>. <article-title>Measurement of mechanical tractions exerted by cells in three-dimensional matrices</article-title>. <source>Nature methods</source>. <year>2010</year>;<volume>7</volume>(<issue>12</issue>):<fpage>969</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/nmeth.1531</pub-id><?supplied-pmid 21076420?><pub-id pub-id-type="pmid">21076420</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009443.ref045">
      <label>45</label>
      <mixed-citation publication-type="journal"><name><surname>Lejeune</surname><given-names>E</given-names></name>, <name><surname>Khang</surname><given-names>A</given-names></name>, <name><surname>Sansom</surname><given-names>J</given-names></name>, <name><surname>Sacks</surname><given-names>MS</given-names></name>. <article-title>FM-Track: A fiducial marker tracking software for studying cell mechanics in a three-dimensional environment</article-title>. <source>SoftwareX</source>. <year>2020</year>;<volume>11</volume>:<fpage>100417</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1016/j.softx.2020.100417</pub-id><?supplied-pmid 34291145?><pub-id pub-id-type="pmid">34291145</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
<sub-article article-type="aggregated-review-documents" id="pcbi.1009443.r001" specific-use="decision-letter">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pcbi.1009443.r001</article-id>
    <title-group>
      <article-title>Decision Letter 0</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Pertea</surname>
          <given-names>Mihaela</given-names>
        </name>
        <role>Software Editor</role>
      </contrib>
    </contrib-group>
    <permissions>
      <copyright-statement>© 2021 Mihaela Pertea</copyright-statement>
      <copyright-year>2021</copyright-year>
      <copyright-holder>Mihaela Pertea</copyright-holder>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <related-article ext-link-type="doi" xlink:href="10.1371/journal.pcbi.1009443" id="rel-obj001" related-article-type="reviewed-article"/>
    <custom-meta-group>
      <custom-meta>
        <meta-name>Submission Version</meta-name>
        <meta-value>0</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>
      <named-content content-type="letter-date">21 Mar 2021</named-content>
    </p>
    <p>Dear Dr. Lejeune,</p>
    <p>Thank you very much for submitting your manuscript "Sarc-Graph: Automated segmentation, tracking, and analysis of sarcomeres in hiPSC-derived cardiomyocytes" for consideration at PLOS Computational Biology.</p>
    <p>As with all papers reviewed by the journal, your manuscript was reviewed by members of the editorial board and by several independent reviewers. In light of the reviews (below this email), we would like to invite the resubmission of a significantly-revised version that takes into account the reviewers' comments.</p>
    <p>We cannot make any decision about publication until we have seen the revised manuscript and your response to the reviewers' comments. Your revised manuscript is also likely to be sent to reviewers for further evaluation.</p>
    <p>When you are ready to resubmit, please upload the following:</p>
    <p>[1] A letter containing a detailed list of your responses to the review comments and a description of the changes you have made in the manuscript. Please note while forming your response, if your article is accepted, you may have the opportunity to make the peer review history publicly available. The record will include editor decision letters (with reviews) and your responses to reviewer comments. If eligible, we will contact you to opt in or out.</p>
    <p>[2] Two versions of the revised manuscript: one with either highlights or tracked changes denoting where the text has been changed; the other a clean version (uploaded as the manuscript file).</p>
    <p>Important additional instructions are given below your reviewer comments.</p>
    <p>Please prepare and submit your revised manuscript within 60 days. If you anticipate any delay, please let us know the expected resubmission date by replying to this email. Please note that revised manuscripts received after the 60-day due date may require evaluation and peer review similar to newly submitted manuscripts.</p>
    <p>Thank you again for your submission. We hope that our editorial process has been constructive so far, and we welcome your feedback at any time. Please don't hesitate to contact us if you have any questions or comments.</p>
    <p>Sincerely,</p>
    <p>Mihaela Pertea</p>
    <p>Software Editor</p>
    <p>PLOS Computational Biology</p>
    <p>Mihaela Pertea</p>
    <p>Software Editor</p>
    <p>PLOS Computational Biology</p>
    <p>***********************</p>
    <p>Reviewer's Responses to Questions</p>
    <p>
      <bold>Comments to the Authors:</bold>
    </p>
    <p>
      <bold>Please note here if the review is uploaded as an attachment.</bold>
    </p>
    <p>Reviewer #1: This manuscript describes a method to automatically track sarcomeres in hiPSC derived cardiomyocytes. This is an important problem that has been the subject of multiple publications lately as it is imperative that stem-cell derived cardiomyocytes are compared without bias among test populations. The method uses segmentation to track sarcomeric architecture through time and the outputs include metrics that quantify a measure of contractility, sarcomere shortening, and others. While this article addresses an important issue in the field, there are some major issues that need to be addressed prior to proper review:</p>
    <p>Major:</p>
    <p>1. The introduction reads like a discussion section in that it presents the results of the paper instead of the background. It would be more appropriate to more fully describe the previous computational frameworks cited in the paper. The contrasting with the present work is more appropriate for the discussion section.</p>
    <p>2. There is a logical conflict between the stated goals of the paper in the introduction and the approach taken. Indeed, as stated, there is a pressing need in the field to analyze iPSC-derived cardiomyocyte structure. However, this is a challenging problem because the sarcomeres in these cells are often not fully formed (i.e. immature as mentioned in the introduction). However, all of the synthetic data presented in the paper assumes perfectly formed sarcomeres. Further, the images picked for the optimization/validation of this method are cherry picked as very good single cell iPSC-derived cardiomyocytes except for those presented in Figure 8-E4. However, the latter is not at a high enough resolution to judge if the reconstruction of the architecture is of good quality. In general, this is a non-trivial requirement for an automated analysis code, but the authors need to discuss how ignoring immature sarcomeres affects their results.</p>
    <p>3. The other issue with iPSC derived cardiomyocytes is that the sarcomeres will often deform out of sync with each other. It is not clear how the metrics described in Eq. 1-4 would be affected by non-synchronous dynamics. It is imperative that such motion be considered theoretically in order to interpret experimental results.</p>
    <p>4. As this is a paper targeted at the computational/image analysis community, there needs to be more context in the description of the experimental results. Are these typical cells? Are these the best possible cells achieved with the given technique? Would the image analysis work on iPSC-derived cardiac tissues that were not well formed? Basically the reader needs more context to judge how challenged the code was.</p>
    <p>5. Additionally, the brevity of the experimental section was a bit concerning if any of the data was new. If all of the experimental data has already been published previously, that needs to be more clearly stated in each row of Table 1 where the published data can be found. As I read it, there need to be more details for E3-E5.</p>
    <p>6. Generally, the paper organization needs to be improved. Some of the descriptions in the “Materials and Methods” section should be moved into the “Results” Section. In particular, “Computing average deformation” and “Comparing average deformation to average sarcomere shortening and orientational order parameter” would be better suited for the “Results” section.</p>
    <p>7. There looks to be a huge loss in sarcomeres that are partially tracked vs fully tracked (Fig. 7-8). Additionally, there is a huge loss in sarcomeres between the segmented image and the partially tracked image. Based on Figure 7, it appears that sarcomeres from parallel myofibrils that are aligned or in register, are treated as one sarcomere and are consequently not partially or fully tracked. This needs to be explained and put into context of applicability of this code.</p>
    <p>8. It would also improve the paper to directly compare the segmentation and metrics reported by “Sarc-Graph” with those done by other software (Pasqualini et al., 2015; “SarcOptiM” by Pasqualin et al., 2016; “SarcOmere Texture Analysis” Sutcliffe et al., 2018; “SarcTrack” by Toepher et al., 2019). In particular, the segmentation and tracking should be directly compared with “SarcTrack” by Toepher et al., 2019. In that work they provide metrics that quantify contractility and sarcomere structure, such as duration of contraction and relaxation, sarcomere shortening, and sarcomere length. Will computing the sarcomere shortening with their software yield the same results as Sarc-Graph? Why or why not? Further, there should be more discussion on how the contractility metrics reported by Sarc-Graph (Favg, Ciso, C||) relate to other contractility metrics or any methods that directly measure contractility (Traction Force Microscopy).</p>
    <p>9. Further to the above point, it is unclear how the authors differentiate in their measure of contractility between the stress generated by shortening of the sarcomeres, the possible bending of the sarcomeres as the myofibril is deforming, and the resultant applied force. This is a very challenging problem as the material properties of the myofibril are non-simplistic. As a result, the metrics proposed in this work are at best an indirect measure of contractility. As such, it is important that the authors clearly state the actual physical meaning of the proposed metrics. Without such a clear-cut explanation, these would be greatly misused and misinterpreted in the field.</p>
    <p>10. The Discussion section lacks a serious comparison to other works, existing metrics, and a in depth discussion of how the metrics should be applied AND the situations where the metrics should not be used.</p>
    <p>11. Further, the discussion section should be expanded to explain how this new method contributes to a deeper understanding of the biology of the IPSC-derived cardiomyocytes.</p>
    <p>12. For this work to be impactful better documentation is needed. In particular, setup.py / requirements.txt file should be added and it should include better instructions on how to set up the environment, including package versions. The package links included in the README.md were not sufficient for this reviewer to be able to run Sarc-Graph. This is an important step to be able to properly review this manuscript.</p>
    <p>Minor:</p>
    <p>1. Z-discs is spelled “z-disk” in Fig 3c.</p>
    <p>2. Experimental movies/images should have scale bars.</p>
    <p>3. It would be helpful if the sub-figures actually had labels that were referenced specifically in the text.</p>
    <p>In summary, while this paper presents a possible solution to a pressing problem in the field, its results were not presented in a manner that would allow for in depth analysis and interpretation of the applicability of the code to a wide range of experimental data.</p>
    <p>Reviewer #2: "Sarc-Graph: Automated segmentation, tracking, and analysis of sarcomeres in hiPSC-derived cardiomyocytes" is a particularly interesting manuscript regarding an automated segmentation and mechanical analysis procedure for sarcomeres in cardiomyocytes. Broadly, the image processing procedures are well-executed and characterized, and I am appreciative of the authors' attention to detail in their assessment of the robustness of their algorithms and analysis. There are a few areas where the paper can be shored up and perhaps made more intuitive to a broad (i.e. non-cardiomyocyte-related) audience, but I'm quite supportive of the work.</p>
    <p>I'll begin with some broad points, and follow with specific line items.</p>
    <p>A1) Some more detail about the structure and optical imaging of sarcomeres would be welcome. Perhaps a schematic with some definitions would clarify to the uninformed what a sarcomere, z-disc, etc. are considered in terms of lengths, bounds, etc.</p>
    <p>A2) There are a variety of typos, one of the more common ones was permuting the ‘u’ and ‘o’ in fluorescent. It’d be worth an additional check to catch these, some hyphenation issues, etc.</p>
    <p>A3) Regarding angular error: the pixel error from z-discs being small may have an outsized effect on the measured angular rotation between neighboring discs. Can this be approximated? What effects does this propagate to F? This would be of interest for imaging with different objectives, etc. There’s allusion to this in ln.207, but even an approximate quantification would be helpful.</p>
    <p>A4) The metric of “shortening” is somewhat opaque to me, possibly just because of the +1 in the denominator. Why is it defined as it is, rather than e.g. simply delta-y/y_max? Why not use something conventional, like axial strain?</p>
    <p>A5) Is there any physical interpretation of the structural tensor T? I’d also recommend using a different set of variables for the eigenvalues, as the eigenvectors for the stretch tensor are given as u already. Perhaps change eig(U) to lambda_i (e.g. as in Holtzapfel).</p>
    <p>A6) The use of the Jacobian of the deformation gradient tensor seems incorrect to me. J is conventionally det(F), and is defined as the norm of F in ln.397. Regarding C_iso as well, it seems to me that the square root would be true for an assumed 2D setup, where in the 3D version it should be a cube root instead.</p>
    <p>A7) I just want to reiterate that the tests for robustness are really well done, and I especially support the use of the viridis map and matplotlib package for accessibility. Nice work.</p>
    <p>Minor comments by line:</p>
    <p>Ln.9. Unsure what “more pressing” is being compared to</p>
    <p>25. Shown</p>
    <p>Table 1. What direction is vertical?</p>
    <p>Fig. 3 legend. Is the “raw” 2D input image experimental or synthetic?</p>
    <p>122. Fluctuating</p>
    <p>139. Its</p>
    <p>176. What’s considered a particle?</p>
    <p>249. Sarcomeres is pluralized, possibly shouldn’t be</p>
    <p>362. Two ns in on</p>
    <p>**********</p>
    <p>
      <bold>Have all data underlying the figures and results presented in the manuscript been provided?</bold>
    </p>
    <p>Large-scale datasets should be made available via a public repository as described in the <italic toggle="yes">PLOS Computational Biology</italic>
<ext-link xlink:href="http://journals.plos.org/ploscompbiol/s/data-availability" ext-link-type="uri">data availability policy</ext-link>, and numerical data that underlies graphs or summary statistics should be provided in spreadsheet form as supporting information.</p>
    <p>Reviewer #1: Yes</p>
    <p>Reviewer #2: Yes</p>
    <p>**********</p>
    <p>PLOS authors have the option to publish the peer review history of their article (<ext-link xlink:href="https://journals.plos.org/ploscompbiol/s/editorial-and-peer-review-process#loc-peer-review-history" ext-link-type="uri">what does this mean?</ext-link>). If published, this will include your full peer review and any attached files.</p>
    <p>If you choose “no”, your identity will remain anonymous but your review may still be made public.</p>
    <p><bold>Do you want your identity to be public for this peer review?</bold> For information about this choice, including consent withdrawal, please see our <ext-link xlink:href="https://www.plos.org/privacy-policy" ext-link-type="uri">Privacy Policy</ext-link>.</p>
    <p>Reviewer #1: No</p>
    <p>Reviewer #2: No</p>
    <p>
      <underline>Figure Files:</underline>
    </p>
    <p>While revising your submission, please upload your figure files to the Preflight Analysis and Conversion Engine (PACE) digital diagnostic tool, <underline><ext-link xlink:href="https://pacev2.apexcovantage.com/" ext-link-type="uri">https://pacev2.apexcovantage.com</ext-link></underline>. PACE helps ensure that figures meet PLOS requirements. To use PACE, you must first register as a user. Then, login and navigate to the UPLOAD tab, where you will find detailed instructions on how to use the tool. If you encounter any issues or have any questions when using PACE, please email us at <underline><email>figures@plos.org</email></underline>.</p>
    <p>
      <underline>Data Requirements:</underline>
    </p>
    <p>Please note that, as a condition of publication, PLOS' data policy requires that you make available all data used to draw the conclusions outlined in your manuscript. Data must be deposited in an appropriate repository, included within the body of the manuscript, or uploaded as supporting information. This includes all numerical values that were used to generate graphs, histograms etc.. For an example in PLOS Biology see here: <ext-link xlink:href="http://www.plosbiology.org/article/info%3Adoi%2F10.1371%2Fjournal.pbio.1001908#s5" ext-link-type="uri">http://www.plosbiology.org/article/info%3Adoi%2F10.1371%2Fjournal.pbio.1001908#s5</ext-link>.</p>
    <p>
      <underline>Reproducibility:</underline>
    </p>
    <p>To enhance the reproducibility of your results, we recommend that you deposit your laboratory protocols in protocols.io, where a protocol can be assigned its own identifier (DOI) such that it can be cited independently in the future. Additionally, PLOS ONE offers an option to publish peer-reviewed clinical study protocols. Read more information on sharing protocols at <ext-link xlink:href="https://plos.org/protocols?utm_medium=editorial-email&amp;utm_source=authorletters&amp;utm_campaign=protocols" ext-link-type="uri">https://plos.org/protocols?utm_medium=editorial-email&amp;utm_source=authorletters&amp;utm_campaign=protocols</ext-link></p>
  </body>
</sub-article>
<sub-article article-type="author-comment" id="pcbi.1009443.r002">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pcbi.1009443.r002</article-id>
    <title-group>
      <article-title>Author response to Decision Letter 0</article-title>
    </title-group>
    <related-article ext-link-type="doi" xlink:href="10.1371/journal.pcbi.1009443" id="rel-obj002" related-article-type="editor-report"/>
    <custom-meta-group>
      <custom-meta>
        <meta-name>Submission Version</meta-name>
        <meta-value>1</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>
      <named-content content-type="author-response-date">16 Apr 2021</named-content>
    </p>
    <supplementary-material id="pcbi.1009443.s010" position="float" content-type="local-data">
      <label>Attachment</label>
      <caption>
        <p>Submitted filename: <named-content content-type="submitted-filename">rebuttal.pdf</named-content></p>
      </caption>
      <media xlink:href="pcbi.1009443.s010.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </body>
</sub-article>
<sub-article article-type="aggregated-review-documents" id="pcbi.1009443.r003" specific-use="decision-letter">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pcbi.1009443.r003</article-id>
    <title-group>
      <article-title>Decision Letter 1</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Pertea</surname>
          <given-names>Mihaela</given-names>
        </name>
        <role>Software Editor</role>
      </contrib>
    </contrib-group>
    <permissions>
      <copyright-statement>© 2021 Mihaela Pertea</copyright-statement>
      <copyright-year>2021</copyright-year>
      <copyright-holder>Mihaela Pertea</copyright-holder>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <related-article ext-link-type="doi" xlink:href="10.1371/journal.pcbi.1009443" id="rel-obj003" related-article-type="reviewed-article"/>
    <custom-meta-group>
      <custom-meta>
        <meta-name>Submission Version</meta-name>
        <meta-value>1</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>
      <named-content content-type="letter-date">30 May 2021</named-content>
    </p>
    <p>Dear Dr. Lejeune,</p>
    <p>Thank you very much for submitting your manuscript "Sarc-Graph: Automated segmentation, tracking, and analysis of sarcomeres in hiPSC-derived cardiomyocytes" for consideration at PLOS Computational Biology. As with all papers reviewed by the journal, your manuscript was reviewed by members of the editorial board and by several independent reviewers. The reviewers appreciated the attention to an important topic. Based on the reviews, we are likely to accept this manuscript for publication, providing that you modify the manuscript according to the review recommendations.</p>
    <p>Please, can you test your software on multiple environments and address the error that one of the reviewers is getting while running the software? </p>
    <p>Please prepare and submit your revised manuscript within 30 days. If you anticipate any delay, please let us know the expected resubmission date by replying to this email.</p>
    <p>When you are ready to resubmit, please upload the following:</p>
    <p>[1] A letter containing a detailed list of your responses to all review comments, and a description of the changes you have made in the manuscript. Please note while forming your response, if your article is accepted, you may have the opportunity to make the peer review history publicly available. The record will include editor decision letters (with reviews) and your responses to reviewer comments. If eligible, we will contact you to opt in or out</p>
    <p>[2] Two versions of the revised manuscript: one with either highlights or tracked changes denoting where the text has been changed; the other a clean version (uploaded as the manuscript file).</p>
    <p>Important additional instructions are given below your reviewer comments.</p>
    <p>Thank you again for your submission to our journal. We hope that our editorial process has been constructive so far, and we welcome your feedback at any time. Please don't hesitate to contact us if you have any questions or comments.</p>
    <p>Sincerely,</p>
    <p>Mihaela Pertea</p>
    <p>Software Editor</p>
    <p>PLOS Computational Biology</p>
    <p>Mihaela Pertea</p>
    <p>Software Editor</p>
    <p>PLOS Computational Biology</p>
    <p>***********************</p>
    <p>A link appears below if there are any accompanying review attachments. If you believe any reviews to be missing, please contact <email>ploscompbiol@plos.org</email> immediately:</p>
    <p>[LINK]</p>
    <p>Reviewer's Responses to Questions</p>
    <p>
      <bold>Comments to the Authors:</bold>
    </p>
    <p>
      <bold>Please note here if the review is uploaded as an attachment.</bold>
    </p>
    <p>Reviewer #1: The authors have addressed almost all of my concerns. However, I was still unable to run the code. It give the following error:</p>
    <p>Traceback (most recent call last):</p>
    <p>File "run_code.py", line 1, in &lt;module&gt;</p>
    <p>import file_pre_processing as fpp</p>
    <p>File "/mnt/c/Users/Admin/Documents/Python/Sarc-Graph/file_pre_processing.py", line 1, in &lt;module&gt;</p>
    <p>import av</p>
    <p>ModuleNotFoundError: No module named 'av'</p>
    <p>It is essential that the code can be run by the readers for this work to have the desired impact.&lt;/module&gt;&lt;/module&gt;</p>
    <p>Reviewer #2: I'm grateful for your attention to detail in the improved version of this manuscript, and enthusiastically support its acceptance to PLoS Comp Biol.</p>
    <p>**********</p>
    <p>
      <bold>Have the authors made all data and (if applicable) computational code underlying the findings in their manuscript fully available?</bold>
    </p>
    <p>The <ext-link xlink:href="https://journals.plos.org/ploscompbiol/s/materials-and-software-sharing" ext-link-type="uri">PLOS Data policy</ext-link> requires authors to make all data and code underlying the findings described in their manuscript fully available without restriction, with rare exception (please refer to the Data Availability Statement in the manuscript PDF file). The data and code should be provided as part of the manuscript or its supporting information, or deposited to a public repository. For example, in addition to summary statistics, the data points behind means, medians and variance measures should be available. If there are restrictions on publicly sharing data or code —e.g. participant privacy or use of data from a third party—those must be specified.</p>
    <p>Reviewer #1: Yes</p>
    <p>Reviewer #2: None</p>
    <p>**********</p>
    <p>PLOS authors have the option to publish the peer review history of their article (<ext-link xlink:href="https://journals.plos.org/ploscompbiol/s/editorial-and-peer-review-process#loc-peer-review-history" ext-link-type="uri">what does this mean?</ext-link>). If published, this will include your full peer review and any attached files.</p>
    <p>If you choose “no”, your identity will remain anonymous but your review may still be made public.</p>
    <p><bold>Do you want your identity to be public for this peer review?</bold> For information about this choice, including consent withdrawal, please see our <ext-link xlink:href="https://www.plos.org/privacy-policy" ext-link-type="uri">Privacy Policy</ext-link>.</p>
    <p>Reviewer #1: No</p>
    <p>Reviewer #2: No</p>
    <p>Figure Files:</p>
    <p>While revising your submission, please upload your figure files to the Preflight Analysis and Conversion Engine (PACE) digital diagnostic tool, <ext-link xlink:href="https://pacev2.apexcovantage.com" ext-link-type="uri">https://pacev2.apexcovantage.com</ext-link>. PACE helps ensure that figures meet PLOS requirements. To use PACE, you must first register as a user. Then, login and navigate to the UPLOAD tab, where you will find detailed instructions on how to use the tool. If you encounter any issues or have any questions when using PACE, please email us at <email>figures@plos.org</email>.</p>
    <p>Data Requirements:</p>
    <p>Please note that, as a condition of publication, PLOS' data policy requires that you make available all data used to draw the conclusions outlined in your manuscript. Data must be deposited in an appropriate repository, included within the body of the manuscript, or uploaded as supporting information. This includes all numerical values that were used to generate graphs, histograms etc.. For an example in PLOS Biology see here: <ext-link xlink:href="http://www.plosbiology.org/article/info%3Adoi%2F10.1371%2Fjournal.pbio.1001908#s5" ext-link-type="uri">http://www.plosbiology.org/article/info%3Adoi%2F10.1371%2Fjournal.pbio.1001908#s5</ext-link>.</p>
    <p>Reproducibility:</p>
    <p>To enhance the reproducibility of your results, we recommend that you deposit your laboratory protocols in protocols.io, where a protocol can be assigned its own identifier (DOI) such that it can be cited independently in the future. Additionally, PLOS ONE offers an option to publish peer-reviewed clinical study protocols. Read more information on sharing protocols at <ext-link xlink:href="https://plos.org/protocols?utm_medium=editorial-email&amp;utm_source=authorletters&amp;utm_campaign=protocols" ext-link-type="uri">https://plos.org/protocols?utm_medium=editorial-email&amp;utm_source=authorletters&amp;utm_campaign=protocols</ext-link></p>
    <p>References:</p>
    <p>Review your reference list to ensure that it is complete and correct. If you have cited papers that have been retracted, please include the rationale for doing so in the manuscript text, or remove these references and replace them with relevant current references. Any changes to the reference list should be mentioned in the rebuttal letter that accompanies your revised manuscript.</p>
    <p>
      <italic toggle="yes">If you need to cite a retracted article, indicate the article’s retracted status in the References list and also include a citation and full reference for the retraction notice.</italic>
    </p>
  </body>
</sub-article>
<sub-article article-type="author-comment" id="pcbi.1009443.r004">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pcbi.1009443.r004</article-id>
    <title-group>
      <article-title>Author response to Decision Letter 1</article-title>
    </title-group>
    <related-article ext-link-type="doi" xlink:href="10.1371/journal.pcbi.1009443" id="rel-obj004" related-article-type="editor-report"/>
    <custom-meta-group>
      <custom-meta>
        <meta-name>Submission Version</meta-name>
        <meta-value>2</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>
      <named-content content-type="author-response-date">20 Jul 2021</named-content>
    </p>
    <supplementary-material id="pcbi.1009443.s011" position="float" content-type="local-data">
      <label>Attachment</label>
      <caption>
        <p>Submitted filename: <named-content content-type="submitted-filename">rebuttal.pdf</named-content></p>
      </caption>
      <media xlink:href="pcbi.1009443.s011.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </body>
</sub-article>
<sub-article article-type="aggregated-review-documents" id="pcbi.1009443.r005" specific-use="decision-letter">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pcbi.1009443.r005</article-id>
    <title-group>
      <article-title>Decision Letter 2</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Pertea</surname>
          <given-names>Mihaela</given-names>
        </name>
        <role>Software Editor</role>
      </contrib>
    </contrib-group>
    <permissions>
      <copyright-statement>© 2021 Mihaela Pertea</copyright-statement>
      <copyright-year>2021</copyright-year>
      <copyright-holder>Mihaela Pertea</copyright-holder>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <related-article ext-link-type="doi" xlink:href="10.1371/journal.pcbi.1009443" id="rel-obj005" related-article-type="reviewed-article"/>
    <custom-meta-group>
      <custom-meta>
        <meta-name>Submission Version</meta-name>
        <meta-value>2</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>
      <named-content content-type="letter-date">10 Sep 2021</named-content>
    </p>
    <p>Dear Dr. Lejeune,</p>
    <p>We are pleased to inform you that your manuscript 'Sarc-Graph: Automated segmentation, tracking, and analysis of sarcomeres in hiPSC-derived cardiomyocytes' has been provisionally accepted for publication in PLOS Computational Biology.</p>
    <p>Before your manuscript can be formally accepted you will need to complete some formatting changes, which you will receive in a follow up email. A member of our team will be in touch with a set of requests.</p>
    <p>Please note that your manuscript will not be scheduled for publication until you have made the required changes, so a swift response is appreciated.</p>
    <p>IMPORTANT: The editorial review process is now complete. PLOS will only permit corrections to spelling, formatting or significant scientific errors from this point onwards. Requests for major changes, or any which affect the scientific understanding of your work, will cause delays to the publication date of your manuscript.</p>
    <p>Should you, your institution's press office or the journal office choose to press release your paper, you will automatically be opted out of early publication. We ask that you notify us now if you or your institution is planning to press release the article. All press must be co-ordinated with PLOS.</p>
    <p>Thank you again for supporting Open Access publishing; we are looking forward to publishing your work in PLOS Computational Biology. </p>
    <p>Best regards,</p>
    <p>Mihaela Pertea</p>
    <p>Software Editor</p>
    <p>PLOS Computational Biology</p>
    <p>Feilim Mac Gabhann</p>
    <p>Editor-in-Chief</p>
    <p>PLOS Computational Biology</p>
    <p>***********************************************************</p>
    <p>Reviewer's Responses to Questions</p>
    <p>
      <bold>Comments to the Authors:</bold>
    </p>
    <p>
      <bold>Please note here if the review is uploaded as an attachment.</bold>
    </p>
    <p>Reviewer #1: The authors have addressed all of my concerns.</p>
    <p>**********</p>
    <p>
      <bold>Have the authors made all data and (if applicable) computational code underlying the findings in their manuscript fully available?</bold>
    </p>
    <p>The <ext-link xlink:href="https://journals.plos.org/ploscompbiol/s/materials-and-software-sharing" ext-link-type="uri">PLOS Data policy</ext-link> requires authors to make all data and code underlying the findings described in their manuscript fully available without restriction, with rare exception (please refer to the Data Availability Statement in the manuscript PDF file). The data and code should be provided as part of the manuscript or its supporting information, or deposited to a public repository. For example, in addition to summary statistics, the data points behind means, medians and variance measures should be available. If there are restrictions on publicly sharing data or code —e.g. participant privacy or use of data from a third party—those must be specified.</p>
    <p>Reviewer #1: Yes</p>
    <p>**********</p>
    <p>PLOS authors have the option to publish the peer review history of their article (<ext-link xlink:href="https://journals.plos.org/ploscompbiol/s/editorial-and-peer-review-process#loc-peer-review-history" ext-link-type="uri">what does this mean?</ext-link>). If published, this will include your full peer review and any attached files.</p>
    <p>If you choose “no”, your identity will remain anonymous but your review may still be made public.</p>
    <p><bold>Do you want your identity to be public for this peer review?</bold> For information about this choice, including consent withdrawal, please see our <ext-link xlink:href="https://www.plos.org/privacy-policy" ext-link-type="uri">Privacy Policy</ext-link>.</p>
    <p>Reviewer #1: No</p>
  </body>
</sub-article>
<sub-article article-type="editor-report" id="pcbi.1009443.r006" specific-use="acceptance-letter">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pcbi.1009443.r006</article-id>
    <title-group>
      <article-title>Acceptance letter</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Pertea</surname>
          <given-names>Mihaela</given-names>
        </name>
        <role>Software Editor</role>
      </contrib>
    </contrib-group>
    <permissions>
      <copyright-statement>© 2021 Mihaela Pertea</copyright-statement>
      <copyright-year>2021</copyright-year>
      <copyright-holder>Mihaela Pertea</copyright-holder>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <related-article ext-link-type="doi" xlink:href="10.1371/journal.pcbi.1009443" id="rel-obj006" related-article-type="reviewed-article"/>
  </front-stub>
  <body>
    <p>
      <named-content content-type="letter-date">30 Sep 2021</named-content>
    </p>
    <p>PCOMPBIOL-D-21-00225R2 </p>
    <p>Sarc-Graph: Automated segmentation, tracking, and analysis of sarcomeres in hiPSC-derived cardiomyocytes</p>
    <p>Dear Dr Lejeune,</p>
    <p>I am pleased to inform you that your manuscript has been formally accepted for publication in PLOS Computational Biology. Your manuscript is now with our production department and you will be notified of the publication date in due course.</p>
    <p>The corresponding author will soon be receiving a typeset proof for review, to ensure errors have not been introduced during production. Please review the PDF proof of your manuscript carefully, as this is the last chance to correct any errors. Please note that major changes, or those which affect the scientific understanding of the work, will likely cause delays to the publication date of your manuscript. </p>
    <p>Soon after your final files are uploaded, unless you have opted out, the early version of your manuscript will be published online. The date of the early version will be your article's publication date. The final article will be published to the same URL, and all versions of the paper will be accessible to readers.</p>
    <p>Thank you again for supporting PLOS Computational Biology and open-access publishing. We are looking forward to publishing your work! </p>
    <p>With kind regards,</p>
    <p>Olena Szabo</p>
    <p>PLOS Computational Biology | Carlyle House, Carlyle Road, Cambridge CB4 3DN | United Kingdom <email>ploscompbiol@plos.org</email> | Phone +44 (0) 1223-442824 | <ext-link xlink:href="http://ploscompbiol.org" ext-link-type="uri">ploscompbiol.org</ext-link> | @PLOSCompBiol</p>
  </body>
</sub-article>
