<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Genome Biol</journal-id>
    <journal-id journal-id-type="iso-abbrev">Genome Biol</journal-id>
    <journal-title-group>
      <journal-title>Genome Biology</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1474-7596</issn>
    <issn pub-type="epub">1474-760X</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">9199219</article-id>
    <article-id pub-id-type="publisher-id">2688</article-id>
    <article-id pub-id-type="doi">10.1186/s13059-022-02688-w</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Method</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>SCADIE: simultaneous estimation of cell type proportions and cell type-specific gene expressions using SCAD-based iterative estimating procedure</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Tang</surname>
          <given-names>Daiwei</given-names>
        </name>
        <address>
          <email>daiwei.tang@yale.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Park</surname>
          <given-names>Seyoung</given-names>
        </name>
        <address>
          <email>ishspsy@skku.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0003-1195-9607</contrib-id>
        <name>
          <surname>Zhao</surname>
          <given-names>Hongyu</given-names>
        </name>
        <address>
          <email>hongyu.zhao@yale.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="GRID">grid.47100.32</institution-id><institution-id institution-id-type="ISNI">0000000419368710</institution-id><institution>Department of Biostatistics, Yale School of Public Health, </institution></institution-wrap>60 College Street, New Haven, USA </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="GRID">grid.264381.a</institution-id><institution-id institution-id-type="ISNI">0000 0001 2181 989X</institution-id><institution>Department of Statistics, Sungkyunkwan University, </institution></institution-wrap>25-2, Sungkyunkwan-ro, Jongno-gu, Seoul, South Korea </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>15</day>
      <month>6</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>15</day>
      <month>6</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2022</year>
    </pub-date>
    <volume>23</volume>
    <elocation-id>129</elocation-id>
    <history>
      <date date-type="received">
        <day>2</day>
        <month>8</month>
        <year>2021</year>
      </date>
      <date date-type="accepted">
        <day>11</day>
        <month>5</month>
        <year>2022</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2022</copyright-statement>
      <license>
        <ali:license_ref specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p><bold>Open Access</bold> This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article’s Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article’s Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated in a credit line to the data.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <p id="Par1">A challenge in bulk gene differential expression analysis is to differentiate changes due to cell type-specific gene expression and cell type proportions. SCADIE is an iterative algorithm that simultaneously estimates cell type-specific gene expression profiles and cell type proportions, and performs cell type-specific differential expression analysis at the group level. Through its unique penalty and objective function, SCADIE more accurately identifies cell type-specific differentially expressed genes than existing methods, including those that may be missed from single cell RNA-Seq data. SCADIE has robust performance with respect to the choice of deconvolution methods and the sources and quality of input data.</p>
      <sec>
        <title>Supplementary Information</title>
        <p>The online version contains supplementary material available at (10.1186/s13059-022-02688-w).</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Deconvolution</kwd>
      <kwd>RNA-Seq</kwd>
      <kwd>scRNA-seq</kwd>
      <kwd>Cell type-specific differential expression</kwd>
      <kwd>SCAD</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000002</institution-id>
            <institution>national institutes of health</institution>
          </institution-wrap>
        </funding-source>
        <award-id>CA196530</award-id>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000002</institution-id>
            <institution>national institutes of health</institution>
          </institution-wrap>
        </funding-source>
        <award-id>CA196530</award-id>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>national research foundation of korea</institution>
        </funding-source>
        <award-id>NRF-2022R1A2C4002150</award-id>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>national institutes of health</institution>
        </funding-source>
        <award-id>R56 AG074015</award-id>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>national institute of health</institution>
        </funding-source>
        <award-id>R56 AG074015</award-id>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2022</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p>The past three decades have seen rapid development in gene expression analysis using microarray and sequencing technologies, where bulk samples are analyzed to answer specific biological questions, e.g., to identify genes with different expression levels between cancer samples versus controls. Because bulk samples contain many distinct cell types, such analyses only provide limited granularity. Most differential expression analyses on bulk samples often assume that the measured gene expression is from the primary cell type, e.g., tumor cell in bulk tumor sample.</p>
    <p>Recent progresses in single-cell RNA-sequencing (scRNA-seq) techniques have demonstrated substantial heterogeneity in bulk samples. However due to the high cost and complexity for scRNA-seq, most available data have remained to be from bulk samples. To make better use of bulk sample data, many in silico deconvolution methods have been proposed to infer cell type proportions from bulk data. Most deconvolution methods assume that the observed bulk gene expression profile is a convex mixture of cell-type specific gene expression profiles, i.e., 
<disp-formula id="Equ1"><label>1</label><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{array}{*{20}l} Y = W\cdot H,\quad W \in R^{(m\times k)+}, H \in R^{(k\times n)+},\ and\ \sum_{i=1}^{k} H_{ij}=1,\forall j. \end{array} $$ \end{document}</tex-math><mml:math id="M2"><mml:mtable class="align" columnalign="left"><mml:mtr><mml:mtd class="align-1"><mml:mi>Y</mml:mi><mml:mo>=</mml:mo><mml:mi>W</mml:mi><mml:mo>·</mml:mo><mml:mi>H</mml:mi><mml:mo>,</mml:mo><mml:mspace width="1em"/><mml:mi>W</mml:mi><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>m</mml:mi><mml:mo>×</mml:mo><mml:mi>k</mml:mi><mml:mo>)</mml:mo><mml:mo>+</mml:mo></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mi>H</mml:mi><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>k</mml:mi><mml:mo>×</mml:mo><mml:mi>n</mml:mi><mml:mo>)</mml:mo><mml:mo>+</mml:mo></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mspace width="1em"/><mml:mtext mathvariant="italic">and</mml:mtext><mml:mspace width="1em"/><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo mathsize="big">∑</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>∀</mml:mo><mml:mi>j.</mml:mi></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="13059_2022_2688_Article_Equ1.gif" position="anchor"/></alternatives></disp-formula></p>
    <p>Here <italic>Y</italic> is the bulk gene expression matrix with <italic>m</italic> genes and <italic>n</italic> samples, <italic>W</italic> is the cell type-specific gene expression matrix of the <italic>k</italic> component cell types, and each column in <italic>H</italic> represents the cell type proportions for the corresponding bulk sample. All entries in these matrices are non-negative, which is indicated by the “+” sign in the notations.</p>
    <p>The principle behind the designs of most existing deconvolution methods is to utilize genes that have distinct expression levels across cell types to infer cell type proportions. To this end, some methods curate a signature matrix <inline-formula id="IEq1"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\underline {W} \in R^{m_{sub}\times k}$\end{document}</tex-math><mml:math id="M4"><mml:munder accentunder="false"><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mo accent="true">_</mml:mo></mml:munder><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">sub</mml:mtext></mml:mrow></mml:msub><mml:mo>×</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="13059_2022_2688_Article_IEq1.gif"/></alternatives></inline-formula> with only a subset of cell type-specific genes and gather their expression profiles either from pure cell types [<xref ref-type="bibr" rid="CR24">24</xref>, <xref ref-type="bibr" rid="CR29">29</xref>, <xref ref-type="bibr" rid="CR41">41</xref>] or scRNA-seq data [<xref ref-type="bibr" rid="CR4">4</xref>]; others use all genes but assign higher weights to genes with more differentiating power to produce a weighted version <inline-formula id="IEq2"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\tilde {\bar {W}} \in R^{m \times k}$\end{document}</tex-math><mml:math id="M6"><mml:mover accent="true"><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mo>~</mml:mo></mml:mover><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mo>×</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="13059_2022_2688_Article_IEq2.gif"/></alternatives></inline-formula> [<xref ref-type="bibr" rid="CR42">42</xref>]. Both genres of methods then solve the constraint regression problem specified in the following Eqs. <xref rid="Equ2" ref-type="">2</xref>-(<xref rid="Equ3" ref-type="">3</xref>) with a variety of techniques [<xref ref-type="bibr" rid="CR24">24</xref>, <xref ref-type="bibr" rid="CR37">37</xref>, <xref ref-type="bibr" rid="CR40">40</xref>, <xref ref-type="bibr" rid="CR42">42</xref>]. 
<disp-formula id="Equ2"><label>2</label><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{array}{*{20}l} \underline{Y} &amp;= \underline{W}\cdot H,\quad Y \in R^{(m_{sub} \times n)+}, \underline{W} \in R^{(m_{sub}\times k)+}, H \in R^{(k\times n)+}, \sum_{i=1}^{k} H_{ij}=1, \forall j,  \end{array} $$ \end{document}</tex-math><mml:math id="M8"><mml:mtable class="align" columnalign="left"><mml:mtr><mml:mtd class="align-1"><mml:munder accentunder="false"><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mo accent="true">_</mml:mo></mml:munder></mml:mtd><mml:mtd class="align-2"><mml:mo>=</mml:mo><mml:munder accentunder="false"><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mo accent="true">_</mml:mo></mml:munder><mml:mo>·</mml:mo><mml:mi>H</mml:mi><mml:mo>,</mml:mo><mml:mspace width="1em"/><mml:mi>Y</mml:mi><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">sub</mml:mtext></mml:mrow></mml:msub><mml:mo>×</mml:mo><mml:mi>n</mml:mi><mml:mo>)</mml:mo><mml:mo>+</mml:mo></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:munder accentunder="false"><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mo accent="true">_</mml:mo></mml:munder><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">sub</mml:mtext></mml:mrow></mml:msub><mml:mo>×</mml:mo><mml:mi>k</mml:mi><mml:mo>)</mml:mo><mml:mo>+</mml:mo></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mi>H</mml:mi><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>k</mml:mi><mml:mo>×</mml:mo><mml:mi>n</mml:mi><mml:mo>)</mml:mo><mml:mo>+</mml:mo></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo mathsize="big">∑</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>∀</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mspace width="2em"/></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="13059_2022_2688_Article_Equ2.gif" position="anchor"/></alternatives></disp-formula></p>
    <p>
      <disp-formula id="Equ3">
        <label>3</label>
        <alternatives>
          <tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{array}{*{20}l} {Y} &amp;= \tilde{\bar{W}}\cdot H,\quad Y \in R^{(m \times n)+}, \tilde{\bar{W}} \in R^{(m\times k)+}, H \in R^{(k\times n)+}, \sum_{i=1}^{k} H_{ij}=1, \forall j.  \end{array} $$ \end{document}</tex-math>
          <mml:math id="M10">
            <mml:mtable class="align" columnalign="left">
              <mml:mtr>
                <mml:mtd class="align-1">
                  <mml:mi>Y</mml:mi>
                </mml:mtd>
                <mml:mtd class="align-2">
                  <mml:mo>=</mml:mo>
                  <mml:mover accent="true">
                    <mml:mrow>
                      <mml:mover accent="true">
                        <mml:mrow>
                          <mml:mi>W</mml:mi>
                        </mml:mrow>
                        <mml:mo>¯</mml:mo>
                      </mml:mover>
                    </mml:mrow>
                    <mml:mo>~</mml:mo>
                  </mml:mover>
                  <mml:mo>·</mml:mo>
                  <mml:mi>H</mml:mi>
                  <mml:mo>,</mml:mo>
                  <mml:mspace width="1em"/>
                  <mml:mi>Y</mml:mi>
                  <mml:mo>∈</mml:mo>
                  <mml:msup>
                    <mml:mrow>
                      <mml:mi>R</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mo>(</mml:mo>
                      <mml:mi>m</mml:mi>
                      <mml:mo>×</mml:mo>
                      <mml:mi>n</mml:mi>
                      <mml:mo>)</mml:mo>
                      <mml:mo>+</mml:mo>
                    </mml:mrow>
                  </mml:msup>
                  <mml:mo>,</mml:mo>
                  <mml:mover accent="true">
                    <mml:mrow>
                      <mml:mover accent="true">
                        <mml:mrow>
                          <mml:mi>W</mml:mi>
                        </mml:mrow>
                        <mml:mo>¯</mml:mo>
                      </mml:mover>
                    </mml:mrow>
                    <mml:mo>~</mml:mo>
                  </mml:mover>
                  <mml:mo>∈</mml:mo>
                  <mml:msup>
                    <mml:mrow>
                      <mml:mi>R</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mo>(</mml:mo>
                      <mml:mi>m</mml:mi>
                      <mml:mo>×</mml:mo>
                      <mml:mi>k</mml:mi>
                      <mml:mo>)</mml:mo>
                      <mml:mo>+</mml:mo>
                    </mml:mrow>
                  </mml:msup>
                  <mml:mo>,</mml:mo>
                  <mml:mi>H</mml:mi>
                  <mml:mo>∈</mml:mo>
                  <mml:msup>
                    <mml:mrow>
                      <mml:mi>R</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mo>(</mml:mo>
                      <mml:mi>k</mml:mi>
                      <mml:mo>×</mml:mo>
                      <mml:mi>n</mml:mi>
                      <mml:mo>)</mml:mo>
                      <mml:mo>+</mml:mo>
                    </mml:mrow>
                  </mml:msup>
                  <mml:mo>,</mml:mo>
                  <mml:munderover accent="false" accentunder="false">
                    <mml:mrow>
                      <mml:mo mathsize="big">∑</mml:mo>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>i</mml:mi>
                      <mml:mo>=</mml:mo>
                      <mml:mn>1</mml:mn>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>k</mml:mi>
                    </mml:mrow>
                  </mml:munderover>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>H</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mtext mathvariant="italic">ij</mml:mtext>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mo>=</mml:mo>
                  <mml:mn>1</mml:mn>
                  <mml:mo>,</mml:mo>
                  <mml:mo>∀</mml:mo>
                  <mml:mi>j.</mml:mi>
                  <mml:mspace width="2em"/>
                </mml:mtd>
              </mml:mtr>
            </mml:mtable>
          </mml:math>
          <graphic xlink:href="13059_2022_2688_Article_Equ3.gif" position="anchor"/>
        </alternatives>
      </disp-formula>
    </p>
    <p>Although enormous insights on cell type proportion changes have been drawn from the applications of these deconvolution methods, most of these downstream analyses were performed under the scheme of single signature matrix, i.e., the same signature matrix was used for different groups of bulk data. In real data analyses, a more appropriate model would be that the observed differences in the bulk samples result from not only cell type compositional changes, but also from changes in cell type-specific gene expression profiles. In mathematical terms, it is <italic>Y</italic><sub>1</sub>=<italic>W</italic><sub>1</sub><italic>H</italic><sub>1</sub> and <italic>Y</italic><sub>2</sub>=<italic>W</italic><sub>2</sub><italic>H</italic><sub>2</sub>, when an analysis is performed assuming <italic>W</italic><sub>1</sub>=<italic>W</italic><sub>2</sub>, it intrinsically over-attributes changes to cell type proportion changes.</p>
    <p>In this article, we aim to simultaneously estimate group-specific <italic>W</italic>s and <italic>H</italic>s in a two-group comparison setting, thus to accurately infer cell type-specific differentially expressed genes (DEGs) as well as cell type proportion changes. To this end, we present a smoothly clipped absolute deviation-based (SCAD) iterative estimation (SCADIE) framework that can address this challenging problem.</p>
    <p>The SCAD penalty and weighted <italic>ℓ</italic><sub>1</sub> penalty using the derivative of SCAD are widely used in the penalization methods [<xref ref-type="bibr" rid="CR7">7</xref>, <xref ref-type="bibr" rid="CR21">21</xref>]. SCAD is defined as 
<disp-formula id="Equa"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$P_{\zeta_{n}}(x) = \left\{\begin{array}{ll} \zeta_{n} |x| &amp; \text{if}\ |x| \le \zeta_{n} \\ {\left(2a\zeta_{n} |x| -x^{2} - \zeta_{n}^{2}\right)}/{\{2(a-1)\}}\ \ \ \ \ \ \ &amp; \text{if}\ \zeta_{n} &lt; |x| \le a \zeta_{n} \\ {\zeta_{n}^{2} (a+1)}/{2} &amp; \text{otherwise}, \end{array}\right. $$ \end{document}</tex-math><mml:math id="M12"><mml:mrow><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>ζ</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>x</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mfenced open="{"><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:msub><mml:mrow><mml:mi>ζ</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:mi>x</mml:mi><mml:mo>|</mml:mo></mml:mtd><mml:mtd><mml:mtext>if</mml:mtext><mml:mspace width="1em"/><mml:mo>|</mml:mo><mml:mi>x</mml:mi><mml:mo>|</mml:mo><mml:mo>≤</mml:mo><mml:msub><mml:mrow><mml:mi>ζ</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mfenced close=")" open="("><mml:mrow><mml:mn>2</mml:mn><mml:mi>a</mml:mi><mml:msub><mml:mrow><mml:mi>ζ</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:mi>x</mml:mi><mml:mo>|</mml:mo><mml:mo>−</mml:mo><mml:msup><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>−</mml:mo><mml:msubsup><mml:mrow><mml:mi>ζ</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced><mml:mo>/</mml:mo><mml:mo>{</mml:mo><mml:mn>2</mml:mn><mml:mo>(</mml:mo><mml:mi>a</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo><mml:mo>}</mml:mo><mml:mspace width="1em"/><mml:mspace width="1em"/><mml:mspace width="1em"/><mml:mspace width="1em"/><mml:mspace width="1em"/><mml:mspace width="1em"/><mml:mspace width="1em"/></mml:mtd><mml:mtd><mml:mtext>if</mml:mtext><mml:mspace width="1em"/><mml:msub><mml:mrow><mml:mi>ζ</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>&lt;</mml:mo><mml:mo>|</mml:mo><mml:mi>x</mml:mi><mml:mo>|</mml:mo><mml:mo>≤</mml:mo><mml:mi>a</mml:mi><mml:msub><mml:mrow><mml:mi>ζ</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msubsup><mml:mrow><mml:mi>ζ</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>(</mml:mo><mml:mi>a</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo><mml:mo>/</mml:mo><mml:mn>2</mml:mn></mml:mtd><mml:mtd><mml:mtext>otherwise</mml:mtext><mml:mo>,</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:mrow></mml:math><graphic xlink:href="13059_2022_2688_Article_Equa.gif" position="anchor"/></alternatives></disp-formula> where <italic>a</italic>,<italic>ζ</italic><sub><italic>n</italic></sub>&gt;0 are parameters to be tuned. SCAD can be viewed as a hybrid of <italic>ℓ</italic><sub>0</sub> and <italic>ℓ</italic><sub>1</sub> regularizers in the sense that it resembles the <italic>ℓ</italic><sub>1</sub> norm in a neighborhood of the origin, but stabilizes to constant at larger values [<xref ref-type="bibr" rid="CR21">21</xref>]. Although the nonconvexity of the SCAD leads to the nonconvex optimization problem, various empirical studies have shown that it often produces estimators with smaller estimation error than the estimators via the convex <italic>ℓ</italic><sub>1</sub> penalty.</p>
    <p>At high level, SCADIE is built on existing supervised deconvolution methods. It takes bulk gene expression along with a common signature matrix or initial cell type proportions as input and then estimates group specific <italic>W</italic>s and <italic>H</italic>s. Its underlying assumption is that the cell type-specific <italic>W</italic><sub>1</sub>,<italic>W</italic><sub>2</sub> are reasonably similar but not exactly the same, thus it is possible to initialize with the same <italic>W</italic> and use an iterative algorithm to search for optimal group-specific <italic>W</italic>s. Through comprehensive simulation and real data analyses, we demonstrate that SCADIE is capable of identifying cell type-specific DEGs between <italic>W</italic>s while maintaining high accuracy in estimating <italic>H</italic>s.</p>
  </sec>
  <sec id="Sec2" sec-type="results">
    <title>Results</title>
    <sec id="Sec3">
      <title>Overview of SCADIE</title>
      <p>The goal of the SCADIE framework is to estimate matched <italic>W</italic><sub>1</sub>,<italic>H</italic><sub>1</sub> and <italic>W</italic><sub>2</sub>,<italic>H</italic><sub>2</sub> from bulk data <italic>Y</italic><sub>1</sub>,<italic>Y</italic><sub>2</sub> and then perform hypothesis tests to identify cell type-specific DEGs. In the most common deconvolution scenario, only <italic>Y</italic><sub>1</sub>,<italic>Y</italic><sub>2</sub> and a shared signature matrix <inline-formula id="IEq3"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\underline {W}$\end{document}</tex-math><mml:math id="M14"><mml:munder accentunder="false"><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mo accent="true">_</mml:mo></mml:munder></mml:math><inline-graphic xlink:href="13059_2022_2688_Article_IEq3.gif"/></alternatives></inline-formula> are provided, going from shared <italic>W</italic><sub><italic>sub</italic></sub> with only signature genes to group-specific <italic>W</italic><sub>1</sub>,<italic>W</italic><sub>2</sub> containing all genes remains to be a challenge.</p>
      <p>In view of this challenge, we assume the following conditions hold in our estimation setting: First, most entries in <italic>W</italic><sub>1</sub> and <italic>W</italic><sub>2</sub> are not differentially expressed. This should especially hold for signature genes in <inline-formula id="IEq4"><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\underline {W}_{1}$\end{document}</tex-math><mml:math id="M16"><mml:msub><mml:mrow><mml:munder accentunder="false"><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mo accent="true">_</mml:mo></mml:munder></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2022_2688_Article_IEq4.gif"/></alternatives></inline-formula> and <inline-formula id="IEq5"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\underline {W}_{2}$\end{document}</tex-math><mml:math id="M18"><mml:msub><mml:mrow><mml:munder accentunder="false"><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mo accent="true">_</mml:mo></mml:munder></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2022_2688_Article_IEq5.gif"/></alternatives></inline-formula>. In the case where systematic changes in expression profile occur across all cell types, neither should we use shared <italic>W</italic><sub><italic>sub</italic></sub> for initialization, nor is SCADIE applicable. Second, the compositional cell types in <italic>W</italic><sub>1</sub>,<italic>W</italic><sub>2</sub> should remain the same; otherwise, different models should be used for group 1 and group 2. Common applicable scenarios include tumor microenvironments between different responding groups, or different subtypes of the same disease.</p>
      <p>With the above assumptions, we propose a smoothly clipped absolute deviation (SCAD) penalty-based iterative estimation procedure (SCADIE) that consists of the following steps: 
<list list-type="order"><list-item><p>Jointly estimate cell type proportions for both groups, obtaining <inline-formula id="IEq6"><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$H_{1}^{(0)}$\end{document}</tex-math><mml:math id="M20"><mml:msubsup><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2022_2688_Article_IEq6.gif"/></alternatives></inline-formula> and <inline-formula id="IEq7"><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$H_{2}^{(0)}$\end{document}</tex-math><mml:math id="M22"><mml:msubsup><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2022_2688_Article_IEq7.gif"/></alternatives></inline-formula>. Any deconvolution method can be used in this step, and by joint estimation, we assume that both groups share the same signature gene matrix <inline-formula id="IEq8"><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\underline {W}$\end{document}</tex-math><mml:math id="M24"><mml:munder accentunder="false"><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mo accent="true">_</mml:mo></mml:munder></mml:math><inline-graphic xlink:href="13059_2022_2688_Article_IEq8.gif"/></alternatives></inline-formula> (Fig. <xref rid="Fig1" ref-type="fig">1</xref> (a)). Users can also directly input <inline-formula id="IEq9"><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$H_{1}^{(0)}$\end{document}</tex-math><mml:math id="M26"><mml:msubsup><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2022_2688_Article_IEq9.gif"/></alternatives></inline-formula> and <inline-formula id="IEq10"><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$H_{2}^{(0)}$\end{document}</tex-math><mml:math id="M28"><mml:msubsup><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2022_2688_Article_IEq10.gif"/></alternatives></inline-formula> from other methods.
<fig id="Fig1"><label>Fig. 1</label><caption><p>Schematic diagram for SCADIE: (a) SCADIE requires either (1) bulk gene expression matrices and cell type proportions or (2) bulk gene expression matrices and shared signature matrix as input; the cell type proportions can be obtained by any deconvolution method. (b) The initial full <italic>W</italic> matrices and weights are obtained by a few rounds of NNLS-based iterative updates. (c) The main iterative procedure consists of two parts: one iterative run for estimating <inline-formula id="IEq11"><alternatives><tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\hat {W}_{1}, \hat {W}_{2}$\end{document}</tex-math><mml:math id="M30"><mml:msub><mml:mrow><mml:mi>Ŵ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>Ŵ</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2022_2688_Article_IEq11.gif"/></alternatives></inline-formula>, and <italic>n</italic> (sample size) additional runs for leave-one-out jackknife estimation for standard error <inline-formula id="IEq12"><alternatives><tex-math id="M31">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\Sigma _{W_{1}-W_{2}}$\end{document}</tex-math><mml:math id="M32"><mml:msub><mml:mrow><mml:mi>Σ</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2022_2688_Article_IEq12.gif"/></alternatives></inline-formula>. (d) With point estimates and entry-wise standard errors, DEGs can thus be identified</p></caption><graphic xlink:href="13059_2022_2688_Fig1_HTML" id="MO1"/></fig></p></list-item><list-item><p>Obtain the initial estimates of <inline-formula id="IEq13"><alternatives><tex-math id="M33">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$W_{1}^{(0)}$\end{document}</tex-math><mml:math id="M34"><mml:msubsup><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2022_2688_Article_IEq13.gif"/></alternatives></inline-formula> and <inline-formula id="IEq14"><alternatives><tex-math id="M35">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$W_{2}^{(0)}$\end{document}</tex-math><mml:math id="M36"><mml:msubsup><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2022_2688_Article_IEq14.gif"/></alternatives></inline-formula> separately, then iteratively update <italic>W</italic>s and <italic>H</italic>s for a few rounds using non-negative least squares (NNLS).</p></list-item><list-item><p>Derive the weight matrix <italic>E</italic> used for the main estimation procedure with the derivative of SCAD function [<xref ref-type="bibr" rid="CR7">7</xref>] (Fig. <xref rid="Fig1" ref-type="fig">1</xref> (b), section “<xref rid="Sec19" ref-type="sec">Warm-up run and weight matrix derivation</xref>”). We justify the choice of the SCAD derivative based penalty in the “<xref rid="Sec17" ref-type="sec">Rationale behind SCAD penalty</xref>” section.</p></list-item><list-item><p>After completing steps 1 to 3, the main SCADIE estimation procedure consists of iteratively updating <italic>H</italic><sub>1</sub> and <italic>H</italic><sub>2</sub> using NNLS, respectively, and jointly updating <italic>W</italic><sub>1</sub> and <italic>W</italic><sub>2</sub> with a SCAD-based matrix factorization. A parallel leave-one-out jackknife procedure is also run to obtain entry-level standard error for all entries in <italic>W</italic><sub>1</sub>−<italic>W</italic><sub>2</sub>, and these standard errors can be summarized in a matrix <inline-formula id="IEq15"><alternatives><tex-math id="M37">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\Sigma _{W_{1}-W_{2}}$\end{document}</tex-math><mml:math id="M38"><mml:msub><mml:mrow><mml:mi>Σ</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2022_2688_Article_IEq15.gif"/></alternatives></inline-formula> (Fig. <xref rid="Fig1" ref-type="fig">1</xref> (c) and section “<xref rid="Sec20" ref-type="sec">Update <italic>W</italic> and <italic>H</italic></xref>”).</p></list-item><list-item><p>For each pair of entries <inline-formula id="IEq16"><alternatives><tex-math id="M39">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\hat {W}^{ij}_{1}$\end{document}</tex-math><mml:math id="M40"><mml:msubsup><mml:mrow><mml:mi>Ŵ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2022_2688_Article_IEq16.gif"/></alternatives></inline-formula> and <inline-formula id="IEq17"><alternatives><tex-math id="M41">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\hat {W}^{ij}_{2}$\end{document}</tex-math><mml:math id="M42"><mml:msubsup><mml:mrow><mml:mi>Ŵ</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2022_2688_Article_IEq17.gif"/></alternatives></inline-formula>, we can calculate their <italic>z</italic>-score based on the standard errors of their difference <inline-formula id="IEq18"><alternatives><tex-math id="M43">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\Sigma _{W_{1}-W_{2}}^{ij}$\end{document}</tex-math><mml:math id="M44"><mml:msubsup><mml:mrow><mml:mi>Σ</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2022_2688_Article_IEq18.gif"/></alternatives></inline-formula> and then obtain a <italic>p</italic>-value for testing differential expression.</p></list-item></list></p>
      <p>The above procedure outputs <inline-formula id="IEq19"><alternatives><tex-math id="M45">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\hat {H}_{1}, \hat {H}_{2},\hat {W}_{1},\hat {W}_{2}$\end{document}</tex-math><mml:math id="M46"><mml:msub><mml:mrow><mml:mi>Ĥ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>Ĥ</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>Ŵ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>Ŵ</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2022_2688_Article_IEq19.gif"/></alternatives></inline-formula>, and <inline-formula id="IEq20"><alternatives><tex-math id="M47">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\Sigma _{W_{1}-W_{2}}$\end{document}</tex-math><mml:math id="M48"><mml:msub><mml:mrow><mml:mi>Σ</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2022_2688_Article_IEq20.gif"/></alternatives></inline-formula>. Among these, <inline-formula id="IEq21"><alternatives><tex-math id="M49">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\hat {H}_{1}$\end{document}</tex-math><mml:math id="M50"><mml:msub><mml:mrow><mml:mi>Ĥ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2022_2688_Article_IEq21.gif"/></alternatives></inline-formula> and <inline-formula id="IEq22"><alternatives><tex-math id="M51">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\hat {H}_{2}$\end{document}</tex-math><mml:math id="M52"><mml:msub><mml:mrow><mml:mi>Ĥ</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2022_2688_Article_IEq22.gif"/></alternatives></inline-formula> can be used for cell type proportion comparison; <inline-formula id="IEq23"><alternatives><tex-math id="M53">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\hat {W}_{1},\hat {W}_{2}$\end{document}</tex-math><mml:math id="M54"><mml:msub><mml:mrow><mml:mi>Ŵ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>Ŵ</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2022_2688_Article_IEq23.gif"/></alternatives></inline-formula>, in combination with <inline-formula id="IEq24"><alternatives><tex-math id="M55">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\Sigma _{W_{1}-W_{2}}$\end{document}</tex-math><mml:math id="M56"><mml:msub><mml:mrow><mml:mi>Σ</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2022_2688_Article_IEq24.gif"/></alternatives></inline-formula>, can be used to perform hypothesis testing for cell type-specific differential expression analysis between the two groups.</p>
    </sec>
    <sec id="Sec4">
      <title>Simulation results</title>
    </sec>
    <sec id="Sec5">
      <title>SCADIE maintains high cell proportion estimation accuracy</title>
      <p>One concern of SCADIE’s algorithm is that its iterative procedure and full <italic>W</italic>-based <italic>H</italic> update might result in reduced <italic>H</italic> estimation accuracy. To evaluate SCADIE’s performance on cell type proportion estimates, we benchmarked SCADIE against four deconvolution algorithms, including DWLS[<xref ref-type="bibr" rid="CR40">40</xref>], CIBERSORTx[<xref ref-type="bibr" rid="CR25">25</xref>], MuSiC[<xref ref-type="bibr" rid="CR42">42</xref>], and a naive version of SCADIE using NNLS in updating <italic>W</italic>. We tested these four methods on a simulated data set, a pseudo-bulk data set[<xref ref-type="bibr" rid="CR43">43</xref>], and a bulk microarray data with known cell type proportions[<xref ref-type="bibr" rid="CR34">34</xref>]. We used two metrics to evaluate the accuracy of the estimated <italic>H</italic>s: K-L divergence and root-mean-squared error (RMSE). K-L divergence is a suitable measure because it measures the distance between two sum-to-1 discrete distributions, which are the same format as cell proportions, while RMSE is widely used by previous deconvolution methods.</p>
      <p>Additional File <xref rid="MOESM1" ref-type="media">1</xref>: Supplementary Fig. S3ab shows the final output <italic>H</italic> accuracy compared to CIBERSORTx, DWLS, MuSiC, and NNLS-iteration, measured by K-L Divergence and RMSE, respectively. The overall result patterns between these two metrics are very consistent. In terms of performance, SCADIE showed equal or better accuracies than the other four methods except in the mouse ISC pseudo bulk dataset, where MuSiC substantially outperformed all other methods. MuSiC is specifically tailored for single cell count data, and its significantly better performance in the single cell data suggests the same. Besides, although the NNLS iteration only differs from SCADIE in its <italic>W</italic>-update step, the results were substantially inferior. This was due to the uncontrolled changes in <italic>W</italic>s over iteration and it highlights the importance of using the SCAD penalty (this will be discussed in detail in the section “<xref rid="Sec17" ref-type="sec">Rationale behind SCAD penalty</xref>”). Further, the accuracy of the estimated <italic>H</italic> was stable over iterations (Additional File <xref rid="MOESM1" ref-type="media">1</xref>: Supplementary Fig. S3cde). Specifically, the results for the true bulk data were flat because there was only one group of samples; thus, there was no separate updating.</p>
      <p>These results suggest that although our iterative procedure uses full <italic>W</italic> to update <italic>H</italic>, it would not negatively impact cell type proportion estimation. However, to accommodate potentially different needs, we also made signature-only updates as an option in the SCADIE package.</p>
    </sec>
    <sec id="Sec6">
      <title>SCADIE can better identify DEGs</title>
      <p>One of SCADIE’s key features is to estimate condition-specific <italic>W</italic> matrices. To demonstrate the efficacy of SCADIE’s framework for this feature, we next compared its performance with four other methods with similar functions.</p>
      <p>The most straightforward way to estimate <italic>W</italic> is by solving <italic>Y</italic><sup><italic>T</italic></sup>=<italic>H</italic><sup><italic>T</italic></sup><italic>W</italic><sup><italic>T</italic></sup> using NNLS. We implemented this method in our SCADIE package and labeled it as “NNLS”. A similar technique using ordinary regression was adopted in a microarray deconvolution method called csSAM from [<xref ref-type="bibr" rid="CR34">34</xref>]. A recently proposed statistical framework named TOAST that aims at performing hypothesis testing for cell type-specific gene expression [<xref ref-type="bibr" rid="CR16">16</xref>] is also included. Finally, CIBERSORTx has a high resolution mode for sample-specific <italic>W</italic> estimate, whose results can also be used for DEG analysis.</p>
      <p>Here we benchmarked SCADIE against the above four methods on one simulated dataset and two pseudo-bulk datasets generated from scRNA-seq data. Because these were simulated data with known DEG statuses, we were able to measure the true-positive and false-positive rates (see the “<xref rid="Sec16" ref-type="sec">Methods</xref>” section for more details). We plot the true-positive rates against false-positive rates over a range of <italic>p</italic>-values (from 10<sup>−12</sup> to 0.5) for each method on each dataset in Fig. <xref rid="Fig2" ref-type="fig">2</xref>.
<fig id="Fig2"><label>Fig. 2</label><caption><p>Comparison of DEG identification performances for SCADIE, NNLS <italic>W</italic> update, csSAM, TOAST, and CIBERSORTx’s high resolution mode under a series of <italic>p</italic>-value cutoff from 10<sup>−12</sup> to 0.5</p></caption><graphic xlink:href="13059_2022_2688_Fig2_HTML" id="MO2"/></fig></p>
      <p>As shown in Fig. <xref rid="Fig2" ref-type="fig">2</xref>, SCADIE performed the best for all three datasets in identifying both up-DEGs and down-DEGs. Specifically, SCADIE outperformed CIBERSORTx, csSAM, and TOAST in both true-positive identification and false-positive control. It should be noted that since CIBERSORTx’ high resolution mode is not designed to impute group-specific gene expression levels for whole transcriptome, only a small fraction of <italic>W</italic>s was output from it, and the missing results for most genes were reflected in the overall low true-positive and false-positive rates. When compared to the NNLS <italic>W</italic>-update, SCADIE showed similar power in true-positive identification, but better false-positive controls. This is consistent with our understanding of SCAD-penalty’s advantage, which is also shown in simulation results from <xref rid="MOESM1" ref-type="media">Fig. S2</xref> (where false positives measured by PPV): as separate NNLS <italic>W</italic>-update may cause too much divergence between <italic>W</italic><sub>1</sub> and <italic>W</italic><sub>2</sub> over iterations, leading to more false positive results.</p>
    </sec>
    <sec id="Sec7">
      <title>SCADIE can improve the estimates from other methods</title>
      <p>We next asked the question whether the initial results from CIBERSOTx and csSAM can be improved via SCADIE’s iterative procedure. To investigate this, we initialized the SCADIE algorithm with output from CIBERSORTx and csSAM on the same three datasets above and used SCADIE to iteratively estimate <italic>W</italic>s and <italic>H</italic>s, followed by DEG analysis with SCADIE’s framework. TOAST was not included in this analysis because it only performs hypothesis test without providing point estimates for <italic>W</italic>s.</p>
      <p>As can be seen from Fig. <xref rid="Fig3" ref-type="fig">3</xref>, the accuracy of DEG improved in 11 out of 12 cases (including both down- and up-DEGs) through this scheme. This demonstrates the efficacy of SCADIE’s iterative procedure in improving DEG identification accuracy.
<fig id="Fig3"><label>Fig. 3</label><caption><p>Applying SCADIE’s iterative procedure on initial estimates of CIBERSORTx and csSAM improves DEG identification accuracy</p></caption><graphic xlink:href="13059_2022_2688_Fig3_HTML" id="MO3"/></fig></p>
    </sec>
    <sec id="Sec8">
      <title>Robustness with respect to <italic>ζ</italic><sub><italic>n</italic></sub></title>
      <p>Since the parameter <italic>ζ</italic><sub><italic>n</italic></sub> of the SCAD as in (<xref rid="Equ6" ref-type="">6</xref>) (see the “<xref rid="Sec16" ref-type="sec">Methods</xref>” section at the end) plays a crucial role in defining similarity penalty via SCAD, it is important to examine the robustness of SCADIE with respect to the choice of <italic>ζ</italic><sub><italic>n</italic></sub>. To this end, we performed comprehensive sensitivity analyses on both simulation and real data for a wide range of <italic>ζ</italic><sub><italic>n</italic></sub> (Additional File <xref rid="MOESM1" ref-type="media">1</xref>: Supplementary section S3.2). The results suggest that when <italic>ζ</italic><sub><italic>n</italic></sub> is within a reasonable range (from 1 to 8), SCADIE’s output is highly robust in terms of <italic>H</italic> estimates, <italic>W</italic> estimates, and the DEG identifications (see Additional File <xref rid="MOESM1" ref-type="media">1</xref>: Supplementary section S3.2 for more details).</p>
    </sec>
    <sec id="Sec9">
      <title>SCADIE’s performance on real data</title>
      <p>In the previous sections, we examined SCADIE’s performance extensively through simulation and pseudo-bulk data. Compared to simulated data, real datasets rarely come with ground truth cell type proportions nor cell type-specific gene expression. In addition, biopsy heterogeneity and platform/technical variation present huge uncertainty in estimation outcome.</p>
      <p>To evaluate SCADIE’s performance on real datasets, we applied SCADIE on four bulk datasets with distinct features, from microarray to post-mortem RNA-Seq. Due to the lack of groundtruth, we primarily evaluated from the following four aspects: 1. Can SCADIE identify biologically meaningful cell type proportion changes? 2. Can SCADIE identify known cell type-specific DEGs? 3. For DEGs identified from SCADIE, are they associated with known biological processes? and 4. Can the iterative procedure improve estimation accuracy?</p>
    </sec>
    <sec id="Sec10">
      <title>SCADIE accurately infers cell type proportions and cell type-specific genes in chronic obstructive pulmonary disease</title>
      <p>Chronic obstructive pulmonary disease (COPD) is a chronic lung disease and a leading cause of death. Many efforts have been made to profile the transcriptomes from COPD patients [<xref ref-type="bibr" rid="CR1">1</xref>, <xref ref-type="bibr" rid="CR14">14</xref>, <xref ref-type="bibr" rid="CR28">28</xref>, <xref ref-type="bibr" rid="CR32">32</xref>]. To assess SCAIDE’s performance on COPD data, we derived signature matrix from a COPD single cell dataset [<xref ref-type="bibr" rid="CR1">1</xref>] and performed deconvolution on an independent bulk data set [<xref ref-type="bibr" rid="CR14">14</xref>] with both COPD and control samples (98 COPD samples; 91 control samples), for five major cell types (stromal, myeloid, lymphoid, epithelial, and endothelial) as clustered in [<xref ref-type="bibr" rid="CR32">32</xref>].</p>
      <p>Although COPD causes pathological changes in several myeloid, epithelial, and endothelial cell types, previous studies did not find any systematic changes in cell type proportions associated with COPD [<xref ref-type="bibr" rid="CR28">28</xref>, <xref ref-type="bibr" rid="CR32">32</xref>]. Reasons for this include the high heterogeneity of disease [<xref ref-type="bibr" rid="CR26">26</xref>], as well as high variability in cell type compositions across specimens, which makes it difficult to identify consistent patterns. Cell type proportions estimated from SCADIE suggest similar pattern, where the mean cell type proportions are consistent between the COPD and control groups (Fig. <xref rid="Fig4" ref-type="fig">4</xref>a), while individual compositions varied across samples (Fig. <xref rid="Fig4" ref-type="fig">4</xref>b). The epithelial proportion varied most, as it is not only associated with biopsy spatial location, but also with disease severity [<xref ref-type="bibr" rid="CR39">39</xref>].
<fig id="Fig4"><label>Fig. 4</label><caption><p>SCADIE-estimated cell proportions in control and COPD samples: <bold>a</bold> Mean proportions of the five cell types in control and COPD samples. <bold>b</bold> Boxplot for each cell type’s proportions across all individuals in the two cohorts</p></caption><graphic xlink:href="13059_2022_2688_Fig4_HTML" id="MO4"/></fig></p>
      <p>We next evaluated SCADIE’s performance in identifying cell type-specific DEGs from bulk data. “Ground truth” cell type-specific DEGs were first obtained by performing differential expression analysis on the COPD-Control single cell data cohort[<xref ref-type="bibr" rid="CR32">32</xref>] for the five major cell types. Their log2 fold changes as well as <italic>p</italic> values are shown in volcano plots in Fig. <xref rid="Fig5" ref-type="fig">5</xref>a to e. Across all cell types, more than 60% of the single cell-identified DEGs showed concordant directional changes from SCADIE output. In terms of significant DEGs, 9–33% of single cell identified DEGs were also inferred to be significant DEGs by SCADIE from bulk data (Additional File <xref rid="MOESM1" ref-type="media">1</xref>: Supplementary Fig. S4). Since there were only fewer than half of single cell DEGs replicated in bulk data, we next asked the question of whether it was due to data heterogeneity or method deficiency. To this end, we compared SCADIE with TOAST in terms of correct direction percentage (percentage of single cell derived cell type-specific DEGs that have same directional change from SCADIE or TOAST) and correct significant DEGs percentage (percentage of single cell derived cell type-specific DEGs that are also identified significant from SCADIE or TOAST). SCADIE consistently outperformed TOAST by significant margins in both aspects (see Fig. <xref rid="Fig5" ref-type="fig">5</xref>f). This result suggests that there is indeed significant heterogeneity between these two unrelated single cell and bulk data cohorts, and SCADIE outperformed existing method even under this noisy circumstance. Here we only included TOAST in comparisons because csSAM only works on microarray data, while CIBERSORTx does not infer cell type-specific DEGs at the whole transcriptome level.
<fig id="Fig5"><label>Fig. 5</label><caption><p>Volcano plots for single cell DEGs’ estimated differential expression statuses from SCADIE and their summary: <bold>a</bold>–<bold>e</bold> Volcano plots for single cell-identified DEGs in the five component cell types, <italic>x</italic>-axis represents the log2 fold-change from SCADIE, and <italic>y</italic>-axis represents each gene’s <italic>p</italic>-value from SCADIE. <bold>f</bold> A summary table for benchmarking SCADIE against TOAST using the same COPD datasets, the first two columns summarize the percentages of single cell DEGs that were of concordant directional changes from bulk data, and the last two columns summarize the percentages of single cell DEGs that were correctly identified as DEGs from bulk data</p></caption><graphic xlink:href="13059_2022_2688_Fig5_HTML" id="MO5"/></fig></p>
      <p>Note that from Supplementary <xref rid="MOESM1" ref-type="media">Fig. S4</xref> there is a substantial number of SCADIE-inferred DEGs that were not present in single cell DEGs; it is important to find out whether the large proportion of non-overlapping DEGs was due to false positives. To this regard, we ran Gene Set Enrichment Analysis (GSEA) on single cell and SCADIE-derived DEGs separately and compared their top enriched pathways. Results from Additional File <xref rid="MOESM1" ref-type="media">1</xref>: Supplementary <xref rid="MOESM1" ref-type="media">Fig. S5</xref> show that the top pathways from single cell and SCADIE were significantly more overlapped than that expected by chance, indicating that the underlying biological signals do share consistent patterns even the actual DEG sets differ.</p>
      <p>Finally, we asked the question whether SCADIE can infer DEGs that were not identified in single cell data. To answer this question, we looked into the top 10 SCADIE-inferred down DEGs in each cell type. Among the 50 genes, only 8 of them were also identified from single cell DE analysis. Among the 42 DEGs unique to SCADIE, 39 were also present in the single cell dataset, and 33 showed concordant cell type-specific directional changes as SCADIE. This finding suggests that the cell type-specific expression changes from SCADIE were likely true signals, and the main reason they were missed in single cell data was the limited power due to data sparsity (See Additional File <xref rid="MOESM2" ref-type="media">2</xref>: Supplementary Table S1 for details). In addition, literature search showed that 19 out of the 42 SCADIE-unique genes were associated with COPD from previous studies (See Additional File <xref rid="MOESM2" ref-type="media">2</xref>: Supplementary Table S1 for details). This suggests that SCADIE is capable of mining DEG information that is too sparse to be identified in single cell data.</p>
      <p>In summary, SCADIE is not only capable of identifying known cell type proportion patterns and cell type-specific DEGs, it can also infer DEGs that may be missed by single cell data due to the high noise and drop-out in single cell data.</p>
    </sec>
    <sec id="Sec11">
      <title>SCADIE reveals biologically meaningful composition and expression differences in DLBLC subtypes</title>
      <p>Diffuse large B cell lymphoma (DLBCL) is the most common type of non-Hodgkin lymphoma and can be classified into two main subtypes based on gene expression: germinal center-like (GCB) and activated B cell-like (ABC) DLBCL [<xref ref-type="bibr" rid="CR2">2</xref>, <xref ref-type="bibr" rid="CR19">19</xref>]. Traditionally DLBCL patients were treated with cyclophosphamide, doxorubicin, vincristine, and prednisone (CHOP), and in recent years CHOP in combination with immunotherapeutic drug rituximab (R-CHOP) has gained more popularity due to its benefit in clinical outcome [<xref ref-type="bibr" rid="CR33">33</xref>].</p>
      <p>Here we analyzed a dataset consisting of 414 samples from both subtypes who received either CHOP or R-CHOP [<xref ref-type="bibr" rid="CR15">15</xref>]. Inspired by a previous analysis from [<xref ref-type="bibr" rid="CR25">25</xref>], we first asked the question whether the DEGs between GCB and ABC can be attributed mostly to B cells. To this regard, we applied SCADIE to all samples and compared the cell type-specific DEGs by treatment groups using the same cell type characterization and signature matrix from [<xref ref-type="bibr" rid="CR25">25</xref>]. From Fig. <xref rid="Fig6" ref-type="fig">6</xref>ab, we can observe distinct DEG composition patterns between CHOP and R-CHOP patients: in the CHOP group, DEGs of GCB are dominantly by genes from B cells, and those of ABC are also from B cells or activated B cells (plasma cell), while in the R-CHOP group, there is a substantial reduction in B cell DEGs and most DEGs are instead from T cells. While this may seem counterintuitive at first, given the rituximab’s nature as an antibody against B cells, it is consistent with several lines of previous studies [<xref ref-type="bibr" rid="CR18">18</xref>, <xref ref-type="bibr" rid="CR30">30</xref>] that rituximab reduces B cell proportion substantially in the GCB group (Fig. <xref rid="Fig6" ref-type="fig">6</xref>d) and alters T cells gene expressions more than B cells.
<fig id="Fig6"><label>Fig. 6</label><caption><p>DLBLC Cell type-specific DEGs and proportion results: <bold>a</bold> The composition of DEGs by cell type in the CHOP cohort. <bold>b</bold> The composition of DEGs by cell type in the R-CHOP cohort. <bold>c</bold> A comparison of marker genes’ log2 fold change in estimated <italic>W</italic>s and original bulk data. <bold>d</bold> Estimated B cell proportion by disease subtype and treatment; in each case, a reduction in B cell proportion was observed</p></caption><graphic xlink:href="13059_2022_2688_Fig6_HTML" id="MO6"/></fig></p>
      <p>Next, we compiled a list of validated markers for GCB and ABC from published studies [<xref ref-type="bibr" rid="CR2">2</xref>, <xref ref-type="bibr" rid="CR10">10</xref>] (see a list of all genes at [<xref ref-type="bibr" rid="CR38">38</xref>]) and examined if SCADIE could accurately infer their distinct expressions. The log2 fold changes in the estimated B cell expressions between ABC and GCB are shown in Fig.<xref rid="Fig6" ref-type="fig">6</xref>c, where we can see that not only all markers show higher expression levels in their corresponding cell types; their estimated fold changes in B cell are also higher compared to those in the bulk data.</p>
      <p>Unlike previous analyses, although in real data we do not have comprehensive differential expression ground truth for all genes, we are able to demonstrate that the cell type proportions and cell type-specific DEGs inferred from SCADIE align well with the literature.</p>
    </sec>
    <sec id="Sec12">
      <title>SCADIE improves AD-associated cell type-specific DEG estimation</title>
      <p>Alzheimer’s disease (AD) is a leading threat to global elder population and has been under intensive research over decades. However, gene expression analyses remain challenging due to the difficulty in accessing samples and the low quality of post-mortem RNA-Seq samples. To examine SCADIE’s performance on these challenging data, we applied SCADIE to an AD bulk RNA-Seq dataset where the cell type proportions had been measured by immunohistochemistry (IHC) [<xref ref-type="bibr" rid="CR27">27</xref>]. The dataset contains RNA-Seq samples from 31 healthy individuals and 18 AD patients. We initialized <italic>W</italic>s with the IHC-estimated proportions and ran the iterative procedure subsequently. Due to different cell type categorizations between the IHC study [<xref ref-type="bibr" rid="CR27">27</xref>] and DEG study [<xref ref-type="bibr" rid="CR22">22</xref>], we only examined the three overlapped cell types: astrocyte, oligodendrocyte, and microglia (see the section “<xref rid="Sec16" ref-type="sec">Methods</xref>—<xref rid="Sec26" ref-type="sec">Real data processing and analyses</xref>” for details.)</p>
      <p>To evaluate SCADIE’s performance, we obtained a list of cell type-specific DEGs from [<xref ref-type="bibr" rid="CR22">22</xref>] and tested if SCADIE could correctly identify them. Figure <xref rid="Fig7" ref-type="fig">7</xref> shows the estimated expression levels for those known up- and down-DEGs in the initial and final <italic>W</italic>s, respectively. In the initial <italic>W</italic>s, 34%, 20%, and 14% of known DEGs were estimated to have fold-changes in the opposite directions (i.e., up(down)-DEGs were estimated to be down(up)-regulated) with | log2<italic>F</italic><italic>C</italic>|&gt;1) in astrocyte, oligodendrocyte, and microglia. After SCADIE procedure, these ratios reduced to 5%, 9%, and 7%, respectively (Fig. <xref rid="Fig7" ref-type="fig">7</xref>).
<fig id="Fig7"><label>Fig. 7</label><caption><p>Volcano plots for cell type-specific AD-associated DEGs in initial <italic>W</italic>s and SCADIE output</p></caption><graphic xlink:href="13059_2022_2688_Fig7_HTML" id="MO7"/></fig></p>
      <p>These results suggest that, although low initialization quality might limit the performance of SCADIE, its iterative procedure could still improve and recover the DEGs’ directional signals.</p>
    </sec>
    <sec id="Sec13">
      <title>DEG identification under poor initialization and limited sample size</title>
      <p>Although SCADIE can be well tuned to identify DEGs, it may run the risk of increasing error when the initial <italic>W</italic> and <italic>H</italic> deviate from ground truth. In addition, the jackknife method might perform poorly when sample size is relatively small compared to the number of cell types. To study the potential impacts of these issues, we first benchmarked SCADIE’s performances under different initial <italic>H</italic> accuracy levels and sample sizes. SCADIE’s accuracy decreases with both the initial <italic>H</italic>’s accuracy (Additional File <xref rid="MOESM1" ref-type="media">1</xref>: Supplementary Fig. S6) and the reduction in sample size (Additional File <xref rid="MOESM1" ref-type="media">1</xref>: Supplementary section S3.4), while <italic>H</italic> accuracy has a larger effect. This is in line with our expectation because <italic>H</italic> directly affects point estimates of <italic>W</italic>s while sample size’s effect is more on standard error.</p>
      <p>On real data performance, we benchmarked SCADIE on a previously studied follicular lymphoma (FL) bulk dataset with both issues present. FL is a common type of B cell lymphoma and can be classified into two subtypes by the presence of CREBBP mutation [<xref ref-type="bibr" rid="CR9">9</xref>]. We re-analyzed a cohort of 26 samples whose genotypes are known (16 CREBBP-mutant and 10 CREBBP-wild type) from [<xref ref-type="bibr" rid="CR25">25</xref>] and benchmarked against a list of known DEGs identified by [<xref ref-type="bibr" rid="CR9">9</xref>].</p>
      <p>We inferred the initial <italic>H</italic> via deconvolution using CIBERSORTx’s LM22 signature matrix. Since this <italic>H</italic> contains 22 cell types while our sample number and leave-one-out jackknife require the number of cell type not exceeding 9, we merged <italic>H</italic> into eight main cell types based on their abundances and similarities. Then, the initial <italic>W</italic>s were obtained for CREBBP-mutant and CREBBP-wild type groups respectively. To measure the qualities of the initial <italic>W</italic>s, we made the volcano plot for known DEGs in initial <italic>W</italic>s. The results show few correctly identified down-DEGs with some false positives (Fig. <xref rid="Fig8" ref-type="fig">8</xref>a “SCADIE initial <italic>W</italic>”) in the initial <italic>W</italic>s. After iteration, the final <italic>W</italic>s correctly identified more DEGs in both directions (upregulated and downregulated, see Fig. <xref rid="Fig8" ref-type="fig">8</xref>a “SCADIE final <italic>W</italic>”). This is consistent with the table in Fig. <xref rid="Fig8" ref-type="fig">8</xref>b.
<fig id="Fig8"><label>Fig. 8</label><caption><p>Benchmarking SCADIE on FL bulk dataset with poor initialization and limited sample size. <bold>a</bold> Volcano plots for known DEGs from CIBERSORTx, TOAST, SCADIE’s initial <italic>W</italic>s and final <italic>W</italic>s, for the latter two cases the standard errors were obtained through jackknife. <bold>b</bold> Number of correctly identified DEG (<italic>p</italic>-value cutoff 0.01) from CIBERSORTx HiRes, TOAST, and SCADIE. For SCADIE’s initial <italic>W</italic> and final <italic>W</italic> cases, their point estimates were different <italic>W</italic>s but the same set of standard deviation was used in the hypothesis tests</p></caption><graphic xlink:href="13059_2022_2688_Fig8_HTML" id="MO8"/></fig></p>
      <p>We next compared SCADIE with CIBERSORTx’s high resolution mode and TOAST. Since CIBERSORTx cannot perform whole-transcriptome imputation, we only input the 467 known DEGs for imputation. The results suggest that although SCADIE’s estimations had more directional errors, its overall power (Fig. <xref rid="Fig8" ref-type="fig">8</xref>a) and number of correctly identified DEGs (Fig. <xref rid="Fig8" ref-type="fig">8</xref>b) exceeded CIBERSORTx. Outcome from TOAST is very similar to SCADIE’s initial outcome (Fig. <xref rid="Fig8" ref-type="fig">8</xref>a), but SCADIE’s final <italic>W</italic>s can identify more DEGs in both directions, though at a cost of higher false positives.</p>
      <p>The above results suggest that incorrect initialization and limited sample size do lower the estimation quality of SCADIE; however, SCADIE can still improve and maintain competitive performance in these scenarios. It is recommended to consider SCADIE’s applicability since poor initialization quality or limited sample size is common in real applications. Though it is usually not possible to evaluate initial <italic>H</italic>’s quality, we recommend having sample size at least 1.5x the number of cell types when performing DEG identification with SCADIE.</p>
    </sec>
  </sec>
  <sec id="Sec14" sec-type="discussion">
    <title>Discussion</title>
    <p>Recent years have seen rapid developments of technologies and computational methods to enable researchers to identify genes with different expression levels across conditions, either through bulk samples or single cells. When a gene is differentially expressed between two groups of bulk samples, should we attribute it to cell type proportions changes, or cell type-specific gene expression changes?</p>
    <p>To this end, we have developed SCADIE, an estimation framework to simultaneously estimate both cell type proportions <italic>H</italic> and cell type-specific gene expressions <italic>W</italic>. SCADIE features an iterative update procedure of <italic>W</italic> and <italic>H</italic>, a SCAD-based penalty for similarity control, as well as a jackknife-based standard error estimation. This framework enjoys several advantages over existing methods. First of all, compared to scRNA-seq, SCADIE’s cell type proportion estimate is not affected by technical dropouts. Second, SCADIE has shown better sensitivity and specificity compared to existing methods. In addition, SCADIE also has certain advantages in functionality compared to other methods mentioned in this paper: when compared to CIBERSORTx, SCADIE’s design can estimate and test all the genes to identify DEGs (while CIBERSORTx only imputes a subset of given genes); it can also accommodate more than microarray data and output matched cell proportions (while csSAM only works on microarray data); when compared to TOAST, SCADIE can not only perform hypothesis testing for DEGs, but produce matched point estimates in the meantime. It is worth mentioning that recently two additional methods, CellR [<xref ref-type="bibr" rid="CR5">5</xref>] and CARseq [<xref ref-type="bibr" rid="CR12">12</xref>], have been proposed to specifically perform cell type-specific DEG identification based on RNA-Seq raw counts data. We were unable to include them in our benchmarking because most of the data in our study were only available either as normalized RNA-Seq or microarray, but they might have superior performance in heavily normalized brain tissue data where SCADIE’s performance was not ideal.</p>
    <p>Through extensive comparisons using simulated and real datasets, we demonstrated that SCADIE can not only maintain high cell proportion estimate accuracy, it can also effectively identify cell type-specific DEGs. In the cases where initialization quality is poor or with barely sufficient sample size, SCADIE’s performance will be affected; however, its iteration procedure can still recover signals to certain extent. We have provided guidelines regarding SCADIE’s applicability under these extreme situations. Besides, its performance is highly robust with respect to a range of parameter values. These features all ensure that SCADIE can be broadly applicable to different settings.</p>
    <p>Although SCADIE enjoys several advantages over existing methods, there are several aspects that can be further explored. First, the proposed NMF estimate may involve bias due to the non-negative constraint and the penalization term. One can consider a de-biased estimate to fix the potential bias of the proposed penalization method to improve inference. Second, although SCADIE can take initial input from any deconvolution algorithm, it only uses NNLS in its iterative <italic>H</italic>-update step. We may expand its modularity and enable it to fully take advantage of other deconvolution methods (e.g., DWLS for cases with rare cell types, and weighted NNLS [<xref ref-type="bibr" rid="CR42">42</xref>] for single cell counts data). It shall also be noted that although SCADIE is built as a supervised deconvolution tool, it is also compatible with all the unsupervised deconvolution methods that only require bulk gene expression data [<xref ref-type="bibr" rid="CR13">13</xref>, <xref ref-type="bibr" rid="CR31">31</xref>, <xref ref-type="bibr" rid="CR44">44</xref>] as long as they could provide initial <italic>W</italic> and <italic>H</italic>. Unsupervised methods are useful in situations of cell type discovery or lack of supervising information, but as there is no guarantee that their inferred cell types have one-to-one mapping to actual cell types, annotating cell types remains a challenge. Third, we have shown that using the full <italic>W</italic> along with NNLS has provided robust and accurate <italic>H</italic> estimates over iteration, further investigation into the mechanism behind this may enlighten the simplification of deconvolution. Finally, we can improve the DE hypothesis testing procedure by incorporating more advanced DE techniques and better false discovery control into the framework.</p>
  </sec>
  <sec id="Sec15" sec-type="conclusion">
    <title>Conclusions</title>
    <p>Simultaneous estimation of cell type proportions and cell type-specific gene expressions from bulk gene expression data remains a challenge due to its non-identifiable nature. In this article, through our proposed method SCADIE, we demonstrated that with reasonable assumptions on the similarity between group level cell type-specific gene expression profiles, proper design of objective function, and reasonable initial deconvolution accuracy, it is possible to infer cell type proportions along with cell type-specific gene expressions with robustness and high accuracy. Despite this progress, technical challenges including multi-group comparison, limited sample size, and poor initialization quality still remain to be further addressed in the future.</p>
  </sec>
  <sec id="Sec16">
    <title>Methods</title>
    <p>For a full list of notations, refer to Additional File <xref rid="MOESM1" ref-type="media">1</xref>: Supplementary section S1.</p>
    <sec id="Sec17">
      <title>Rationale behind SCAD penalty</title>
      <p>A key consideration in our proposed method is to maintain a proper dissimilarity level between <italic>W</italic><sub>1</sub> and <italic>W</italic><sub>2</sub>, where the true DEGs can be identified without introducing many false-positive DEGs. In our simulation analyses, we found that keeping <italic>W</italic><sub>1</sub> and <italic>W</italic><sub>2</sub> similar by a ridge penalty did increase the accuracy in <italic>H</italic>s (Additional File <xref rid="MOESM1" ref-type="media">1</xref>: Supplementary Fig. S1cd). However, the <italic>W</italic> accuracy and DEG identifying power are reduced (Additional File <xref rid="MOESM1" ref-type="media">1</xref>: Supplementary Figs. S1ab, S2). An intuitive explanation to this is that forcing <italic>W</italic><sub>1</sub> and <italic>W</italic><sub>2</sub> prevents them from being too divergent with each other, thus increasing <italic>H</italic> accuracy; however, this penalty also makes <italic>W</italic><sub>1</sub> and <italic>W</italic><sub>2</sub> over-similar, thus reducing its sensitivity substantially (<xref rid="MOESM1" ref-type="media">Fig. S2</xref>).</p>
      <p>To combine the advantages with and without ridge penalty, we adopt the SCAD-based penalty that imposes entry-specific dissimilarity penalty based on the prior difference between <italic>W</italic><sub>1</sub> and <italic>W</italic><sub>2</sub>: if the separately estimated <inline-formula id="IEq25"><alternatives><tex-math id="M57">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\bar {W}_{1}$\end{document}</tex-math><mml:math id="M58"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2022_2688_Article_IEq25.gif"/></alternatives></inline-formula> and <inline-formula id="IEq26"><alternatives><tex-math id="M59">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\bar {W}_{2}$\end{document}</tex-math><mml:math id="M60"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2022_2688_Article_IEq26.gif"/></alternatives></inline-formula> have similar entries for the (<italic>k</italic>,<italic>j</italic>) component, we put a high but bounded penalty on their difference in our procedure, whereas if the components are quite different, we penalize less on the difference. Specifically, we penalize <inline-formula id="IEq27"><alternatives><tex-math id="M61">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\sum _{k,j} E_{jk} \left ([W_{1}]^{T}_{jk} - [W_{2}]^{T}_{jk}\right)^{2}$\end{document}</tex-math><mml:math id="M62"><mml:munder><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">jk</mml:mtext></mml:mrow></mml:msub><mml:msup><mml:mrow><mml:mfenced close=")" open="("><mml:mrow><mml:msubsup><mml:mrow><mml:mo>[</mml:mo><mml:msub><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>]</mml:mo></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">jk</mml:mtext></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:msubsup><mml:mrow><mml:mo>[</mml:mo><mml:msub><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>]</mml:mo></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">jk</mml:mtext></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="13059_2022_2688_Article_IEq27.gif"/></alternatives></inline-formula>, where <inline-formula id="IEq28"><alternatives><tex-math id="M63">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$E_{jk} = P'_{\zeta _{n}}\left \{ \left [\bar {W}_{1}^{T} - \bar {W}^{T}_{2}\right ]^{2}_{jk}\right \}$\end{document}</tex-math><mml:math id="M64"><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">jk</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>ζ</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msubsup><mml:mfenced close="}" open="{"><mml:mrow><mml:msubsup><mml:mrow><mml:mfenced close="]" open="["><mml:mrow><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">jk</mml:mtext></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="13059_2022_2688_Article_IEq28.gif"/></alternatives></inline-formula> and <inline-formula id="IEq29"><alternatives><tex-math id="M65">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$P^{\prime }_{\zeta _{n}}(\cdot)$\end{document}</tex-math><mml:math id="M66"><mml:msubsup><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>ζ</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msubsup><mml:mo>(</mml:mo><mml:mo>·</mml:mo><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="13059_2022_2688_Article_IEq29.gif"/></alternatives></inline-formula> is the derivative of the SCAD penalty function as defined in (<xref rid="Equ6" ref-type="">6</xref>). To the best of our knowledge, weighted <italic>ℓ</italic><sub>2</sub> penalty using the derivative of SCAD has not been investigated. By doing so, we can incorporate the structure pattern in <inline-formula id="IEq30"><alternatives><tex-math id="M67">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\bar {W}_{1} - \bar {W}_{2}$\end{document}</tex-math><mml:math id="M68"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2022_2688_Article_IEq30.gif"/></alternatives></inline-formula> when estimating <italic>W</italic><sub>1</sub> and <italic>W</italic><sub>2</sub> in a more adaptive manner (see the sections “<xref rid="Sec19" ref-type="sec">Warm-up run and weight matrix derivation</xref>” and “<xref rid="Sec20" ref-type="sec">Update <italic>W</italic> and <italic>H</italic></xref>” for more details).</p>
      <p>Theoretical analyses suggest that this novel penalty structure can achieve high accuracy in the estimation of <italic>W</italic> and <italic>H</italic> (Additional File <xref rid="MOESM1" ref-type="media">1</xref>: Supplementary section S3.1). In addition, we performed simulations comparing sensitivity, specificity, and positive predictive rate (PPV) by using the following: (1) independent <italic>W</italic><sub>1</sub>,<italic>W</italic><sub>2</sub> updates with NNLS, (2) ridge regression imposing similarity between <italic>W</italic><sub>1</sub> and <italic>W</italic><sub>2</sub>, and (3) SCAD-penalty. The results suggest that SCAD-penalty can keep sensitivity high while in the meantime better control false positives through its precise penalty (<xref rid="MOESM1" ref-type="media">Figs. S1</xref> and <xref rid="MOESM1" ref-type="media">S2</xref>).</p>
    </sec>
    <sec id="Sec18">
      <title>Initialization</title>
      <p>For SCADIE’s initialization, users can either input bulk matrices along with corresponding <italic>H</italic>s, or input bulk and signature matrices to perform generic deconvolution using NNLS or DWLS[<xref ref-type="bibr" rid="CR40">40</xref>]. Given that many deconvolution methods have been proposed to accommodate various data and conditions, we recommend users provide bulk matrix along with the best initial <italic>H</italic>s available.</p>
      <p>In real applications, obtaining accurate deconvolution results is often difficult. We have shown that although poor initialization does affect SCADIE’s performance, its iterative procedure could recover the signals and produce decent results (see the section “<xref rid="Sec12" ref-type="sec">SCADIE improves AD-associated cell type-specific DEG estimation</xref>” and Fig. <xref rid="Fig8" ref-type="fig">8</xref>).</p>
    </sec>
    <sec id="Sec19">
      <title>Warm-up run and weight matrix derivation</title>
      <p>The proposed penalty requires a prior weight matrix <italic>E</italic> of the same dimension as <italic>W</italic>, which provides prior information on how likely certain entries differ between two <italic>W</italic>s.</p>
      <p>To obtain <italic>E</italic>, we perform a few steps of “warm-up” iterations: 
<list list-type="order"><list-item><p>We first obtain full <inline-formula id="IEq31"><alternatives><tex-math id="M69">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$W_{1}^{(0)}$\end{document}</tex-math><mml:math id="M70"><mml:msubsup><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2022_2688_Article_IEq31.gif"/></alternatives></inline-formula> and <inline-formula id="IEq32"><alternatives><tex-math id="M71">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$W_{2}^{(0)}$\end{document}</tex-math><mml:math id="M72"><mml:msubsup><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2022_2688_Article_IEq32.gif"/></alternatives></inline-formula> from solving the NNLS problem <inline-formula id="IEq33"><alternatives><tex-math id="M73">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\min _{W_{i} \in \mathbb {R}_{+}^{m \times k}} \left \|Y_{i}^{T} - H_{i}^{T}W_{i}^{T} \right \|_{F}^{2}, i = 1,2$\end{document}</tex-math><mml:math id="M74"><mml:munder><mml:mrow><mml:mo>min</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:msubsup><mml:mrow><mml:mi>ℝ</mml:mi></mml:mrow><mml:mrow><mml:mo>+</mml:mo></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mo>×</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:munder><mml:msubsup><mml:mrow><mml:mfenced close="∥" open="∥"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:msubsup><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msubsup><mml:msubsup><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn></mml:math><inline-graphic xlink:href="13059_2022_2688_Article_IEq33.gif"/></alternatives></inline-formula>.</p></list-item><list-item><p>The <italic>H</italic>s are subsequently updated by NNLS using full <italic>Y</italic>s and <italic>W</italic>s.</p></list-item><list-item><p>Repeat steps 1–2 for a few rounds (default 5 rounds, but can be manually changed), and plug in the output <inline-formula id="IEq34"><alternatives><tex-math id="M75">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\hat {W}_{1}^{NNLS},\hat {W}_{2}^{NNLS}$\end{document}</tex-math><mml:math id="M76"><mml:msubsup><mml:mrow><mml:mi>Ŵ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">NNLS</mml:mtext></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>Ŵ</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">NNLS</mml:mtext></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2022_2688_Article_IEq34.gif"/></alternatives></inline-formula> to Eq. <xref rid="Equ6" ref-type="">6</xref> in the section “<xref rid="Sec20" ref-type="sec">Update <italic>W</italic> and <italic>H</italic></xref>” to obtain the weight matrix <italic>E</italic>.</p></list-item></list></p>
    </sec>
    <sec id="Sec20">
      <title>Update <italic>W</italic> and <italic>H</italic></title>
      <p>In this subsection, we provide details of updating <italic>W</italic> and <italic>H</italic>, which corresponds to step (b) in Fig. <xref rid="Fig1" ref-type="fig">1</xref>.</p>
      <p>Note that for the simplicity of notation, we intrinsically assume the sample sizes of group 1 and group 2 are both <italic>n</italic> throughout analyses in this paper, i.e., <italic>Y</italic><sub>1</sub>,<italic>Y</italic><sub>2</sub>∈<italic>R</italic><sup>(<italic>m</italic>×<italic>n</italic>)+</sup> and <italic>H</italic><sub>1</sub>,<italic>H</italic><sub>2</sub>∈<italic>R</italic><sup>(<italic>k</italic>×<italic>n</italic>)+</sup>. Although this is not the case in most real applications, making this assumption does not affect either our theoretic derivation or most implementations. For scenarios where <italic>n</italic><sub>1</sub>≠<italic>n</italic><sub>2</sub> makes a difference (e.g., jackknife estimation), we will discuss our handling of this issue specifically.</p>
      <p>For the update of <italic>H</italic> in the main iterative procedure, we simply use NNLS to solve for the problems below for the two groups separately: 
<disp-formula id="Equ4"><label>4</label><alternatives><tex-math id="M77">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{array}{*{20}l} \min_{H_{i} \in \mathbb{R}^{(k \times n)+}} \|Y_{i} - W_{i} H_{i} \|_{F}^{2}, i = 1,2. \end{array} $$ \end{document}</tex-math><mml:math id="M78"><mml:mtable class="align" columnalign="left"><mml:mtr><mml:mtd class="align-1"><mml:munder><mml:mrow><mml:mo>min</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi>ℝ</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>k</mml:mi><mml:mo>×</mml:mo><mml:mi>n</mml:mi><mml:mo>)</mml:mo><mml:mo>+</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:munder><mml:mo>∥</mml:mo><mml:msub><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo>∥</mml:mo></mml:mrow><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:munderover><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mi>.</mml:mi></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="13059_2022_2688_Article_Equ4.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>Note that here we use the full <italic>W</italic>s instead of signature genes only, and this alteration still produces good estimation accuracy (see the section “<xref rid="Sec5" ref-type="sec">SCADIE maintains high cell proportion estimation accuracy</xref>”).</p>
      <p>To update <italic>W</italic><sub>1</sub> and <italic>W</italic><sub>2</sub> simultaneously, we consider the following weighted-regression-based optimization: 
<disp-formula id="Equ5"><label>5</label><alternatives><tex-math id="M79">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$  \min_{W_{1}, W_{2} \in \mathbb{R}^{(m \times k)+}} \frac{1}{2} \left\|Y_{1}^{T} - H^{T}_{1} W_{1}^{T}\right\|_{F}^{2} + \frac{1}{2} \left\|Y_{2}^{T} - H^{T}_{2} W_{2}^{T}\right\|_{F}^{2} + \frac{\lambda}{2} \left\|W_{1}^{T} - W_{2}^{T}\right\|_{E,F}^{2},  $$ \end{document}</tex-math><mml:math id="M80"><mml:munder><mml:mrow><mml:mo>min</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi>ℝ</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>m</mml:mi><mml:mo>×</mml:mo><mml:mi>k</mml:mi><mml:mo>)</mml:mo><mml:mo>+</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:munder><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac><mml:msubsup><mml:mrow><mml:mfenced close="∥" open="∥"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:msubsup><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msubsup><mml:msubsup><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac><mml:msubsup><mml:mrow><mml:mfenced close="∥" open="∥"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:msubsup><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msubsup><mml:msubsup><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac><mml:msubsup><mml:mrow><mml:mfenced close="∥" open="∥"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:msubsup><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mi>E</mml:mi><mml:mo>,</mml:mo><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>,</mml:mo></mml:math><graphic xlink:href="13059_2022_2688_Article_Equ5.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>where <inline-formula id="IEq35"><alternatives><tex-math id="M81">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\|W_{1}^{T}-W_{2}^{T}\|_{E,F}^{2} = \sum _{j,k} E_{jk} \left (W_{1}^{T}-W_{2}^{T} \right)_{jk}^{2}$\end{document}</tex-math><mml:math id="M82"><mml:mo>∥</mml:mo><mml:msubsup><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:msubsup><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msubsup><mml:msubsup><mml:mrow><mml:mo>∥</mml:mo></mml:mrow><mml:mrow><mml:mi>E</mml:mi><mml:mo>,</mml:mo><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">jk</mml:mtext></mml:mrow></mml:msub><mml:msubsup><mml:mrow><mml:mfenced close=")" open="("><mml:mrow><mml:msubsup><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:msubsup><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">jk</mml:mtext></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2022_2688_Article_IEq35.gif"/></alternatives></inline-formula>. Note that (<xref rid="Equ5" ref-type="">5</xref>) is not separable with respect to <italic>W</italic><sub>1</sub> and <italic>W</italic><sub>2</sub> due to the third term, from which the information is shared between the two groups.</p>
      <p>Let <inline-formula id="IEq36"><alternatives><tex-math id="M83">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\tilde {W} = [{W}_{1}, {W}_{2}]^{T} \in \mathbb {R}^{(2k \times m)+}$\end{document}</tex-math><mml:math id="M84"><mml:mover accent="true"><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mo>[</mml:mo><mml:msub><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>]</mml:mo></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi>ℝ</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mn>2</mml:mn><mml:mi>k</mml:mi><mml:mo>×</mml:mo><mml:mi>m</mml:mi><mml:mo>)</mml:mo><mml:mo>+</mml:mo></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="13059_2022_2688_Article_IEq36.gif"/></alternatives></inline-formula>. We update each column of <inline-formula id="IEq37"><alternatives><tex-math id="M85">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\tilde {W}$\end{document}</tex-math><mml:math id="M86"><mml:mover accent="true"><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="13059_2022_2688_Article_IEq37.gif"/></alternatives></inline-formula> separately. Specifically, updating the <italic>j</italic>th column of <inline-formula id="IEq38"><alternatives><tex-math id="M87">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\tilde {W}$\end{document}</tex-math><mml:math id="M88"><mml:mover accent="true"><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="13059_2022_2688_Article_IEq38.gif"/></alternatives></inline-formula> is equivalent to solving 
<disp-formula id="Equb"><alternatives><tex-math id="M89">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\hat{x}^{(j)} = \arg\min_{x \in \mathbb{R}_{+}^{2k \times 1}} \left\|\tilde{Y}^{(j)} - \tilde{X}^{(j)} x\right\|_{F}^{2}, $$ \end{document}</tex-math><mml:math id="M90"><mml:mrow><mml:msup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>j</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mo>arg</mml:mo><mml:munder><mml:mrow><mml:mo>min</mml:mo></mml:mrow><mml:mrow><mml:mi>x</mml:mi><mml:mo>∈</mml:mo><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mi>ℝ</mml:mi></mml:mrow><mml:mrow><mml:mo>+</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mi>k</mml:mi><mml:mo>×</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munderover></mml:mrow></mml:munder><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mfenced close="∥" open="∥"><mml:mrow><mml:msup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>j</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msup><mml:mo>−</mml:mo><mml:msup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>j</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msup><mml:mi>x</mml:mi></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:munderover><mml:mo>,</mml:mo></mml:mrow></mml:math><graphic xlink:href="13059_2022_2688_Article_Equb.gif" position="anchor"/></alternatives></disp-formula> where 
<disp-formula id="Equc"><alternatives><tex-math id="M91">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\tilde{Y}^{(j)} = \left[\begin{array}{c} [Y_{1}^{T}]_{j} \\ \left[Y_{2}^{T}\right]_{j} \\ {0}_{k,1}\\ \end{array}\right] \in \mathbb{R}^{(2n+k) \times 1}, \quad \tilde{X}^{(j)} = \left[\begin{array}{cc} H_{1}^{T} &amp; 0_{n,k} \\ 0_{n,k} &amp; H_{2}^{T}\\ \sqrt{\lambda} \text{diag}(\sqrt{E_{j}}) &amp; - \sqrt{\lambda} \text{diag}(\sqrt{E_{j}})\\ \end{array}\right], $$ \end{document}</tex-math><mml:math id="M92"><mml:mrow><mml:msup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>j</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mfenced close="]" open="["><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:msubsup><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msubsup><mml:mo>]</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mrow><mml:mfenced close="]" open="["><mml:mrow><mml:msubsup><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr/></mml:mtable></mml:mrow></mml:mfenced><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi>ℝ</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mn>2</mml:mn><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mi>k</mml:mi><mml:mo>)</mml:mo><mml:mo>×</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mspace width="1em"/><mml:msup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>j</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mfenced close="]" open="["><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:msubsup><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msubsup></mml:mtd><mml:mtd><mml:msub><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mtd><mml:mtd><mml:msubsup><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msubsup></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msqrt><mml:mrow><mml:mi>λ</mml:mi></mml:mrow></mml:msqrt><mml:mtext>diag</mml:mtext><mml:mo>(</mml:mo><mml:msqrt><mml:mrow><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msqrt><mml:mo>)</mml:mo></mml:mtd><mml:mtd><mml:mo>−</mml:mo><mml:msqrt><mml:mrow><mml:mi>λ</mml:mi></mml:mrow></mml:msqrt><mml:mtext>diag</mml:mtext><mml:mo>(</mml:mo><mml:msqrt><mml:mrow><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msqrt><mml:mo>)</mml:mo></mml:mtd></mml:mtr><mml:mtr/></mml:mtable></mml:mrow></mml:mfenced><mml:mo>,</mml:mo></mml:mrow></mml:math><graphic xlink:href="13059_2022_2688_Article_Equc.gif" position="anchor"/></alternatives></disp-formula> where <italic>A</italic><sub><italic>j</italic></sub> represents the <italic>j</italic>th column of a matrix <italic>A</italic>. Then the minimizer <inline-formula id="IEq39"><alternatives><tex-math id="M93">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\hat {x}^{(j)}$\end{document}</tex-math><mml:math id="M94"><mml:msup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>j</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="13059_2022_2688_Article_IEq39.gif"/></alternatives></inline-formula> corresponds to the <italic>j</italic>th column of <inline-formula id="IEq40"><alternatives><tex-math id="M95">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\tilde {W}$\end{document}</tex-math><mml:math id="M96"><mml:mover accent="true"><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="13059_2022_2688_Article_IEq40.gif"/></alternatives></inline-formula>.</p>
      <p>For the weight matrix <inline-formula id="IEq41"><alternatives><tex-math id="M97">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$E \in \mathbb {R}^{k \times m}$\end{document}</tex-math><mml:math id="M98"><mml:mi>E</mml:mi><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi>ℝ</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>×</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="13059_2022_2688_Article_IEq41.gif"/></alternatives></inline-formula>, we set <inline-formula id="IEq42"><alternatives><tex-math id="M99">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$E_{jk} = P'_{\zeta _{n}}\left \{ \left [\bar {W}^{T}_{1} - \bar {W}_{2}^{T}\right ]^{2}_{jk}\right \}$\end{document}</tex-math><mml:math id="M100"><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">jk</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>ζ</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msubsup><mml:mfenced close="}" open="{"><mml:mrow><mml:msubsup><mml:mrow><mml:mfenced close="]" open="["><mml:mrow><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">jk</mml:mtext></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="13059_2022_2688_Article_IEq42.gif"/></alternatives></inline-formula>, where <inline-formula id="IEq43"><alternatives><tex-math id="M101">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$P^{\prime }_{\zeta _{n}}(\cdot)$\end{document}</tex-math><mml:math id="M102"><mml:msubsup><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>ζ</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msubsup><mml:mo>(</mml:mo><mml:mo>·</mml:mo><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="13059_2022_2688_Article_IEq43.gif"/></alternatives></inline-formula> is the derivative of the SCAD penalty function, i.e., 
<disp-formula id="Equ6"><label>6</label><alternatives><tex-math id="M103">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{array}{*{20}l}  P'_{\zeta_{n}}(x) = I(x \le \zeta_{n}) + \frac{(a\zeta_{n} - x)_{+}}{(a-1)\zeta_{n}} I(x &gt; \zeta_{n}), \end{array} $$ \end{document}</tex-math><mml:math id="M104"><mml:mtable class="align" columnalign="left"><mml:mtr><mml:mtd class="align-1"><mml:msubsup><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>ζ</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msubsup><mml:mo>(</mml:mo><mml:mi>x</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mi>I</mml:mi><mml:mo>(</mml:mo><mml:mi>x</mml:mi><mml:mo>≤</mml:mo><mml:msub><mml:mrow><mml:mi>ζ</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>a</mml:mi><mml:msub><mml:mrow><mml:mi>ζ</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mi>x</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>a</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo><mml:msub><mml:mrow><mml:mi>ζ</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mi>I</mml:mi><mml:mo>(</mml:mo><mml:mi>x</mml:mi><mml:mo>&gt;</mml:mo><mml:msub><mml:mrow><mml:mi>ζ</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>,</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="13059_2022_2688_Article_Equ6.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>with a regularization parameter <italic>ζ</italic><sub><italic>n</italic></sub>≥0, and <inline-formula id="IEq44"><alternatives><tex-math id="M105">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\bar {W}_{1}$\end{document}</tex-math><mml:math id="M106"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2022_2688_Article_IEq44.gif"/></alternatives></inline-formula> and <inline-formula id="IEq45"><alternatives><tex-math id="M107">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\bar {W}_{2}$\end{document}</tex-math><mml:math id="M108"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2022_2688_Article_IEq45.gif"/></alternatives></inline-formula> are the separate estimates obtained from the previous step. We set <italic>a</italic>=3.7 as suggested by [<xref ref-type="bibr" rid="CR8">8</xref>], which is known to be optimal based on cross-validated empirical studies [<xref ref-type="bibr" rid="CR20">20</xref>]. For the choice of parameter <italic>ζ</italic><sub><italic>n</italic></sub>, we keep <italic>ζ</italic><sub><italic>n</italic></sub>=4 throughout all our analyses. We also demonstrate that SCADIE output is robust with respect to <italic>ζ</italic><sub><italic>n</italic></sub> in terms of <italic>H</italic>s, <italic>W</italic>s, and DEG identification, if <italic>ζ</italic><sub><italic>n</italic></sub> is in an appropriate range. See the section “<xref rid="Sec8" ref-type="sec">Robustness with respect to <italic>ζ</italic><sub><italic>n</italic></sub></xref>” and Additional File <xref rid="MOESM1" ref-type="media">1</xref>: Supplementary section S3.2 for more details.</p>
      <p>The proposed weighted-regression-based optimization (<xref rid="Equ5" ref-type="">5</xref>) with the weight based on SCAD derivative function can be understood as the one-step local linear approximation of the following SCAD penalty [<xref ref-type="bibr" rid="CR45">45</xref>]: 
<disp-formula id="Equd"><alternatives><tex-math id="M109">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $${}\min_{W_{1}, W_{2} \in \mathbb{R}^{(m \times k)+}} \frac{1}{2} \left\|Y_{1}^{T} - H^{T}_{1} W_{1}^{T}\right\|_{F}^{2} + \frac{1}{2} \left\|Y_{2}^{T} - H^{T}_{2} W_{2}^{T}\right\|_{F}^{2} + \sum_{j,k} P_{\zeta_{n}} \left(\left[W_{1}^{T} - W_{2}^{T}\right]^{2}_{jk}\right). $$ \end{document}</tex-math><mml:math id="M110"><mml:mrow><mml:munder><mml:mrow><mml:mo>min</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi>ℝ</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>m</mml:mi><mml:mo>×</mml:mo><mml:mi>k</mml:mi><mml:mo>)</mml:mo><mml:mo>+</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:munder><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mfenced close="∥" open="∥"><mml:mrow><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:munderover><mml:mo>−</mml:mo><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:munderover><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:munderover></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:munderover><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mfenced close="∥" open="∥"><mml:mrow><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:munderover><mml:mo>−</mml:mo><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:munderover><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:munderover></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:munderover><mml:mo>+</mml:mo><mml:munder><mml:mrow><mml:mo mathsize="big">∑</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>ζ</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mfenced close=")" open="("><mml:mrow><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mfenced close="]" open="["><mml:mrow><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:munderover><mml:mo>−</mml:mo><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:munderover></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">jk</mml:mtext></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:munderover></mml:mrow></mml:mfenced><mml:mi>.</mml:mi></mml:mrow></mml:math><graphic xlink:href="13059_2022_2688_Article_Equd.gif" position="anchor"/></alternatives></disp-formula> Hence, the proposed weighted regression-based optimization penalizes differently based on the range of <inline-formula id="IEq46"><alternatives><tex-math id="M111">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$[W_{1}^{T} - W_{2}^{T}]_{jk}$\end{document}</tex-math><mml:math id="M112"><mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:msubsup><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:msubsup><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msubsup><mml:mo>]</mml:mo></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">jk</mml:mtext></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2022_2688_Article_IEq46.gif"/></alternatives></inline-formula>. Compared with the SCAD penalty, the proposed method can be efficiently computed and enjoys the same theoretical properties known as “oracle properties” [<xref ref-type="bibr" rid="CR45">45</xref>].</p>
      <p>The SCAD penalty and weighted <italic>ℓ</italic><sub>1</sub> penalty using the derivative of SCAD are widely used in the penalization methods [<xref ref-type="bibr" rid="CR7">7</xref>, <xref ref-type="bibr" rid="CR21">21</xref>]. SCAD enjoys variable selection consistency and unbiasedness property by imposing no weights on the signal that is beyond 3.7<italic>ζ</italic><sub><italic>n</italic></sub>, which may reduce bias. By using the weighted Frobenius penalization, we may obtain less biased estimate compared to that of Frobenius penalization. In theory, we derive the estimation error bound of the proposed method under certain regularity conditions if <italic>ζ</italic><sub><italic>n</italic></sub> is in an appropriate range; see Additional File <xref rid="MOESM1" ref-type="media">1</xref>: Supplementary section S3.1 for more details.</p>
    </sec>
    <sec id="Sec21">
      <title>Jackknife standard error estimation</title>
      <p>The above iterative procedure only provides us with point estimates of <italic>W</italic><sub>1</sub>,<italic>W</italic><sub>2</sub>,<italic>H</italic><sub>1</sub>, and <italic>H</italic><sub>2</sub>. For differential expression analysis between <italic>W</italic><sub>1</sub> and <italic>W</italic><sub>2</sub>, we use a leave-one-out jackknife procedure to estimate standard error for <italic>W</italic><sub>1</sub>−<italic>W</italic><sub>2</sub>.</p>
      <p>For standard error estimation in most real data, <italic>Y</italic><sub>1</sub> and <italic>Y</italic><sub>2</sub> have different sample sizes (number of columns). We denote <italic>n</italic><sub>1</sub> and <italic>n</italic><sub>2</sub> as column numbers of <italic>Y</italic><sub>1</sub>,<italic>Y</italic><sub>2</sub>, respectively, and let <italic>n</italic><sub>0</sub>= min{<italic>n</italic><sub>1</sub>,<italic>n</italic><sub>2</sub>}. Then we run the iterative procedure <italic>n</italic><sub>0</sub> times—each time leaving one sample out from <italic>Y</italic><sub>1</sub>,<italic>H</italic><sub>1</sub> and <italic>Y</italic><sub>2</sub>,<italic>H</italic><sub>2</sub>, respectively; this will give us <italic>n</italic><sub>0</sub> different <inline-formula id="IEq47"><alternatives><tex-math id="M113">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\hat {W}_{1}-\hat {W}_{2}$\end{document}</tex-math><mml:math id="M114"><mml:msub><mml:mrow><mml:mi>Ŵ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>Ŵ</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2022_2688_Article_IEq47.gif"/></alternatives></inline-formula>s, and element-wise jackknife standard error estimates can be obtained by: <inline-formula id="IEq48"><alternatives><tex-math id="M115">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\sigma ^{jackknife}_{ij} = \frac {n_{0}-1}{\sqrt {n_{0} }}\hat {\sigma }_{ij}, i=1,...,m; j = 1,...,k$\end{document}</tex-math><mml:math id="M116"><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">jackknife</mml:mtext></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msqrt><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msqrt></mml:mrow></mml:mfrac><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>...</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi><mml:mo>;</mml:mo><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>...</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:math><inline-graphic xlink:href="13059_2022_2688_Article_IEq48.gif"/></alternatives></inline-formula>, where <inline-formula id="IEq49"><alternatives><tex-math id="M117">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\hat {\sigma }_{ij}$\end{document}</tex-math><mml:math id="M118"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2022_2688_Article_IEq49.gif"/></alternatives></inline-formula> is the sample standard deviation for the <italic>ij</italic>th entry from the <inline-formula id="IEq50"><alternatives><tex-math id="M119">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$n_{0} \hat {W}_{1}-\hat {W}_{2}$\end{document}</tex-math><mml:math id="M120"><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>Ŵ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>Ŵ</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2022_2688_Article_IEq50.gif"/></alternatives></inline-formula>s [<xref ref-type="bibr" rid="CR23">23</xref>]. With these, we can then conduct element-wise hypothesis testing to identify DEGs between <italic>W</italic><sub>1</sub> and <italic>W</italic><sub>2</sub>.</p>
      <p>We compared the jackknife standard error estimates with those from bootstrap, and both led to highly consistent results (Additional File <xref rid="MOESM1" ref-type="media">1</xref>: Supplementary section S3.6). In the R package implementation of SCADIE, bootstrap is also available for standard error estimation. However, we recommend using jackknife for general purposes to avoid the potential singularity issue arising from bootstrap’s sampling with replacement; see Additional File <xref rid="MOESM1" ref-type="media">1</xref>: Supplementary section S3.6 for a detailed explanation.</p>
    </sec>
    <sec id="Sec22">
      <title>Simulation models and benchmarking</title>
      <sec id="Sec23">
        <title>Simulation datasets</title>
        <p>The simulation data used in the section “<xref rid="Sec5" ref-type="sec">SCADIE maintains high cell proportion estimation accuracy</xref>” to section “<xref rid="Sec7" ref-type="sec">SCADIE can improve the estimates from other methods</xref>” were generated as follows: first, <italic>W</italic><sub>1</sub>∈<italic>R</italic><sup>5000×5</sup> was generated with all its entries following the log-normal distribution with mean 8 and standard deviation 3; then to generate <italic>W</italic><sub>2</sub>, 2.5% of the entries in <italic>W</italic><sub>1</sub> were upregulated to 1.5× or 2×, with another 2.5% downregulated to 0.67× or 0.5×; <italic>H</italic><sub>1</sub> and <italic>H</italic><sub>2</sub> were generated using two distinct Dirichlet distributions, each group consisting of 20 samples; bulk expression matrices <italic>Y</italic> were generated by <italic>W</italic>·<italic>H</italic>+<italic>ε</italic>, where <italic>ε</italic> is a Gaussian white noise matrix with <italic>s</italic><italic>d</italic>=4, if negative entries were present after adding noise, these entries were reset back to 0.</p>
        <p>For signature matrix generation, we first obtained <inline-formula id="IEq51"><alternatives><tex-math id="M121">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\bar {W}=\frac {W_{1}+W_{2}}{2}$\end{document}</tex-math><mml:math id="M122"><mml:mover accent="true"><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac></mml:math><inline-graphic xlink:href="13059_2022_2688_Article_IEq51.gif"/></alternatives></inline-formula> and used the top 5% rows in terms of the largest-entry/second-largest entry ratio as signature gene rows. In <italic>H</italic>’s benchmarking, all methods support <italic>H</italic> estimation with bulk gene expression and signature matrix as input; since MuSiC only supports count data, we rounded the data before input into MuSiC.</p>
      </sec>
      <sec id="Sec24">
        <title>Mouse ISC pseudo-bulk data set</title>
        <p>The pseudo-bulk data used in the section “<xref rid="Sec5" ref-type="sec">SCADIE maintains high cell proportion estimation accuracy</xref>” to section “<xref rid="Sec7" ref-type="sec">SCADIE can improve the estimates from other methods</xref>” were generated as follows. We downloaded the original ISC scRNA-seq data through GEO using accession number GSE92865. We clustered its 14 cell types into four major cell types: ISC, TA, Ent, and other, which was based on the t-SNE results of the paper [<xref ref-type="bibr" rid="CR43">43</xref>]. We then separated the scRNA-seq data by treatment status, where the Fc treatment was group 1, the scFv-DKK1c treatment was group 2, and the RSPO2 treatment was group 3. The corresponding <italic>W</italic><sub>1</sub>,<italic>W</italic><sub>2</sub>,<italic>W</italic><sub>3</sub> matrices were generated by averaging over all cells in each major cell type of the same treatment group. <italic>H</italic><sub>1</sub> to <italic>H</italic><sub>3</sub> were generated the same way as previous section, also with 20 samples in each group. Finally, <italic>Y</italic><sub>1</sub> to <italic>Y</italic><sub>3</sub> were generated by <italic>Y</italic><sub><italic>i</italic></sub>=<italic>W</italic><sub><italic>i</italic></sub>·<italic>H</italic><sub><italic>i</italic></sub>+<italic>ε</italic>,<italic>i</italic>=1,2,3, where <italic>ε</italic> is a Gaussian white noise matrix with <italic>s</italic><italic>d</italic>=4.</p>
        <p>Signature matrix was derived using the <italic>buildSignatureMatrixUsingSeurat</italic> function from the DWLS package [<xref ref-type="bibr" rid="CR32">32</xref>] using all the single cells regardless of their treatment status.</p>
        <p>Ground truth DEGs were derived by performing differential expression analysis for each cell type between group 2 and group 1 and group 3 and group 1, using the <italic>DEAnalysis</italic> function in the DWLS package [<xref ref-type="bibr" rid="CR40">40</xref>].</p>
        <p>In the sections “<xref rid="Sec6" ref-type="sec">SCADIE can better identify DEGs</xref>” and “<xref rid="Sec7" ref-type="sec">SCADIE can improve the estimates from other methods</xref>,” mouse ISC pseudo-bulk 1 dataset consists of group 1 and group 2 data, while the pseudo-bulk 2 dataset consists of group1 and group3 data.</p>
      </sec>
      <sec id="Sec25">
        <title>Mouse bulk data set</title>
        <p>In thesection “<xref rid="Sec5" ref-type="sec">SCADIE maintains high cell proportion estimation accuracy</xref>,” we used a mouse brain-liver-lung mixture microarray dataset (referred as mouse bulk); the data were accessed through GEO using accession number GSE19830. Raw data were preprocessed with the <italic>affy</italic> package in R and normalized using the rma method. We used rma normalization to keep the data comparable to [<xref ref-type="bibr" rid="CR34">34</xref>]. The signature matrix was generated using the DWLS package [<xref ref-type="bibr" rid="CR40">40</xref>]. In <italic>H</italic>’s benchmarking, since MuSiC only supports count level data, we rounded the bulk matrices and signature gene matrices before input into MuSiC.</p>
      </sec>
    </sec>
    <sec id="Sec26">
      <title>Real data processing and analyses</title>
      <sec id="Sec27">
        <title>COPD single cell and bulk data</title>
        <p>Raw scRNA-seq data were obtained from [<xref ref-type="bibr" rid="CR1">1</xref>]. Data preprocessing, quality control, and normalization were done using Seurat V3 [<xref ref-type="bibr" rid="CR36">36</xref>] in R. The original data contained samples of control, COPD, and idiopathic pulmonary fibrosis (IPF), where cells from IPF samples were excluded in our analysis. There were 37 distinct cell types originally; we used the five major cell type clusters according to UMAP clustering from [<xref ref-type="bibr" rid="CR32">32</xref>], and we did not further sub-divide because (1) there are limited cell numbers in some clusters and (2) the correlated expression profiles of cell types within each cluster might introduce unwanted collinearity in <italic>W</italic>. “Groundtruth” DEGs were identified for each cell type between control and COPD using the DWLS package[<xref ref-type="bibr" rid="CR32">32</xref>].</p>
        <p>Signature matrices were generated using the CIBERSORTx [<xref ref-type="bibr" rid="CR25">25</xref>] and DWLS packages [<xref ref-type="bibr" rid="CR40">40</xref>]. The cell type proportion results from DWLS were considered better, and we proceeded with its signature matrix.</p>
        <p>Bulk RNA-Seq data in FPKM was obtained through GEO with accession code GSE57148, the FPKM matrix was further transformed into log scale to accommodate the scale of signature matrix.</p>
        <p>For benchmarking with TOAST, we input the bulk gene expression and the same initial <italic>H</italic>s as SCADIE; the control and COPD groups were denoted as groups 0 and 1, respectively. We used the output effect size as indication of DEGs’ direction, and <italic>p</italic>-value to identify significant DEGs.</p>
        <p>For GSEA analysis, we first transformed the single cell and SCADIE-derived DEGs into <italic>z</italic>-scores. For single cell DEGs, the <italic>z</italic>-scores were obtained from normal distribution quantiles of their <italic>p</italic>-values, while for SCADIE output, since we know the point estimates and standard error estimates for all genes, we directly calculated their <italic>z</italic>-scores. The <italic>z</italic>-score lists for both groups were sorted and input for pre-ranked GSEA analysis using R’s <italic>fgsea</italic> package, and Molecular Signatures Database v7.4 database [<xref ref-type="bibr" rid="CR17">17</xref>]. For the top enrichment analysis, pathways of each group were first ranked by their GSEA <italic>p</italic> values, then the top 5% or 10% were chosen and compared accordingly. The overlapping <italic>p</italic>-values were calculated using a binomial distribution, where the model parameter <italic>N</italic> equals the total number of shared pathways, while <italic>p</italic>=0.01 for top 10% overlapping and <italic>p</italic>=0.0025 for top 5% overlapping under the null hypothesis.</p>
      </sec>
      <sec id="Sec28">
        <title>DLBLC data</title>
        <p>Raw bulk microarray data were obtained through GEO with accession number GSE10846. Raw data were preprocessed with <italic>affy</italic> package in R and normalized using mas5 method. Sample treatment and subtype information was retrieved using the <italic>GEOquery</italic> package. LM22 matrix from [<xref ref-type="bibr" rid="CR25">25</xref>] was used for initial deconvolution.</p>
      </sec>
      <sec id="Sec29">
        <title>Alzheimer’s disease data</title>
        <p>Bulk post-mortem RNA-Seq samples of prefrontal cortex were downloaded from the ROSMAP cohort [<xref ref-type="bibr" rid="CR3">3</xref>]. We only kept the subset of 49 samples whose cell type proportion results were measured in [<xref ref-type="bibr" rid="CR27">27</xref>]. The IHC results measured four major cell types (neuron, astrocyte, oligodendrocyte and microglia) without differentiating between excitatory and inhibitory neurons, while the cell type-specific DEGs from [<xref ref-type="bibr" rid="CR22">22</xref>] did separate these two cell types. In this regard, we only included results for the three overlapping cell types.</p>
      </sec>
      <sec id="Sec30">
        <title>Follicular lymphoma data</title>
        <p>The raw bulk microarray data were accessed through GEO with accession number GSE127462; preprocessing and normalizing were performed the same as the above procedure for DLBLC. The initial deconvolution used LM22 matrix from [<xref ref-type="bibr" rid="CR25">25</xref>] and we merged the cell types into the following 8 major groups (B cell, CD8 T CELL, CD4 T cell, NK, Monocyte/Macrophage, DC cell, Mast, Neutrophil) before inputting this updated <italic>H</italic> into SCADIE. For the DEGs comparison, unlike SCADIE’s whole transcriptome approach, we ran CIBERSORTx’s high resolution mode only inputting those known DEGs. For TOAST run, we input bulk gene expression and initial the same initial <italic>H</italic>s as SCADIE and CIBERSORTx; WT group was denoted as group 0, and MT group was denoted as group 1. The output DEGs’ directions were determined by their effect sizes; <italic>p</italic>-values were directly from output. Noted that in our analysis for COPD, we kept its original effect sizes as fold change measure, instead of trying to transform to log2 fold change.</p>
      </sec>
    </sec>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Information</title>
    <sec id="Sec31">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="13059_2022_2688_MOESM1_ESM.pdf">
            <caption>
              <p><bold>Additional file 1</bold> Includes notations, additional figures, theoretical properties of the proposed method, simulation models, details of the simulation and real data processing.</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
      <p>
        <supplementary-material content-type="local-data" id="MOESM2">
          <media xlink:href="13059_2022_2688_MOESM2_ESM.xlsx">
            <caption>
              <p><bold>Additional file 2</bold> Supplementary Table S1 contains details on the DEGs exclusively identified by SCADIE as discussed in Section ‘SCADIE accurately infers cell proportions and cell type-specific genes in Chronic Obstructive Pulmonary Disease’.</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
      <p>
        <supplementary-material content-type="local-data" id="MOESM3">
          <media xlink:href="13059_2022_2688_MOESM3_ESM.docx">
            <caption>
              <p><bold>Additional file 3</bold> Review history.</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher’s Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <ack>
    <title>Acknowledgements</title>
    <p>The authors would like to thank Jiawei Wang, Wenxuan Deng, and Chang Su from Yale University for their suggestions and help on data of this paper. And we would also like to thank Prof. Katerina Politi and Prof. Steven Kleinstein from Yale University for their suggestions on the results presented in this paper.</p>
    <sec id="d32e5546">
      <title>Peer review information</title>
      <p>Andrew Cosgrove was the primary editor of this article and managed its editorial process and peer review in collaboration with the rest of the editorial team.</p>
    </sec>
    <sec id="d32e5551">
      <title>Review history</title>
      <p>The review history is available as Additional file <xref rid="MOESM3" ref-type="media">3</xref>.</p>
    </sec>
  </ack>
  <notes notes-type="author-contribution">
    <title>Authors’ contributions</title>
    <p>DT collected the data, designed the computational algorithm, conducted the real and simulated data analysis, and wrote the manuscript. SP designed the computational algorithm, conducted the theoretical analysis, and wrote the manuscript. HZ supervised the research and wrote the manuscript. All authors read and approved the final manuscript.</p>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>DT and HZ were supported in part by NIH P50 CA196530 and R56 AG074015 grants. SP was supported by a National Research Foundation of Korea grant funded by the Korea government (MSIT) (No. NRF-2022R1A2C4002150).</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and materials</title>
    <p>The code for SCADIE is available at <ext-link ext-link-type="uri" xlink:href="https://github.com/tdw1221/SCADIE">https://github.com/tdw1221/SCADIE</ext-link> under MIT license and the source code used in this paper is available at Zenodo [<xref ref-type="bibr" rid="CR38">38</xref>] under Creative Commons Attribution 4.0 International license. The original scRNA-seq data used for generating pseudo-bulk data used in the section “<xref rid="Sec5" ref-type="sec">SCADIE maintains high cell proportion estimation accuracy</xref>” to section “<xref rid="Sec7" ref-type="sec">SCADIE can improve the estimates from other methods</xref>” can be accessed through GEO with accession number GSE92865. The original microarray data used in the section “<xref rid="Sec5" ref-type="sec">SCADIE maintains high cell proportion estimation accuracy</xref>” can be accessed through GEO with accession number GSE19830. For COPD analyses, raw scRNA-seq data can be obtained from [<xref ref-type="bibr" rid="CR1">1</xref>], and bulk RNA-Seq data in FPKM can be obtained through GEO with accession number GSE57148. DLBLC data can be accessed through GEO with accession number GSE10846. For analyses performed in the section “<xref rid="Sec12" ref-type="sec">SCADIE improves AD-associated cell type-specific DEG estimation</xref>,” bulk post-mortem RNA-Seq samples can be downloaded from the ROSMAP cohort [<xref ref-type="bibr" rid="CR3">3</xref>]. The raw bulk microarray data of follicular lymphoma in the section “<xref rid="Sec13" ref-type="sec">DEG identification under poor initialization and limited sample size</xref>” can be accessed through GEO with accession number GSE12746.</p>
  </notes>
  <notes>
    <title>Declarations</title>
    <notes id="FPar1">
      <title>Ethics approval and consent to participate</title>
      <p>Ethics approvals were not needed for the study.</p>
    </notes>
    <notes id="FPar2" notes-type="COI-statement">
      <title>Competing interests</title>
      <p>The authors declare that they have no competing interests.</p>
    </notes>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1</label>
      <mixed-citation publication-type="other">Adams TS, Schupp JC, Poli S, Ayaub EA, Neumark N, Ahangari F, Chu SG, Raby BA, DeIuliis G, Januszyk M, et al., Vol. 6. Single-cell rna-seq reveals ectopic and aberrant lung-resident cell populations in idiopathic pulmonary fibrosis; 2020, p. eaba1983.</mixed-citation>
    </ref>
    <ref id="CR2">
      <label>2</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Blenk</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Engelmann</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Weniger</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Schultz</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Dittrich</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Rosenwald</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Müller-Hermelink</surname>
            <given-names>HK</given-names>
          </name>
          <name>
            <surname>Müller</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Dandekar</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>Germinal center b cell-like (gcb) and activated b cell-like (abc) type of diffuse large b cell lymphoma (dlbcl): analysis of molecular predictors, signatures, cell cycle state and patient survival</article-title>
        <source>Cancer Informat</source>
        <year>2007</year>
        <volume>3</volume>
        <issue>117693510700300</issue>
        <fpage>004</fpage>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>De Jager</surname>
            <given-names>PL</given-names>
          </name>
          <name>
            <surname>Ma</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>McCabe</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Xu</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Vardarajan</surname>
            <given-names>BN</given-names>
          </name>
          <name>
            <surname>Felsky</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Klein</surname>
            <given-names>HU</given-names>
          </name>
          <name>
            <surname>White</surname>
            <given-names>CC</given-names>
          </name>
          <name>
            <surname>Peters</surname>
            <given-names>MA</given-names>
          </name>
          <name>
            <surname>Lodgson</surname>
            <given-names>B</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A multi-omic atlas of the human frontal cortex for aging and alzheimer’s disease research</article-title>
        <source>Sci Data</source>
        <year>2018</year>
        <volume>5</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <lpage>13</lpage>
        <pub-id pub-id-type="pmid">30482902</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dong</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Thennavan</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Urrutia</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Perou</surname>
            <given-names>CM</given-names>
          </name>
          <name>
            <surname>Zou</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Jiang</surname>
            <given-names>Y</given-names>
          </name>
        </person-group>
        <article-title>Scdc: bulk gene expression deconvolution by multiple single-cell rna sequencing references</article-title>
        <source>Brief Bioinform</source>
        <year>2021</year>
        <volume>22</volume>
        <issue>1</issue>
        <fpage>416</fpage>
        <lpage>27</lpage>
        <?supplied-pmid 31925417?>
        <pub-id pub-id-type="pmid">31925417</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Doostparast Torshizi</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Duan</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>K</given-names>
          </name>
        </person-group>
        <article-title>A computational method for direct imputation of cell type-specific expression profiles and cellular compositions from bulk-tissue rna-seq in brain disorders</article-title>
        <source>NAR Genomics Bioinforma</source>
        <year>2021</year>
        <volume>3</volume>
        <issue>2</issue>
        <fpage>lqab056</fpage>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Efron</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <source>The jackknife, the bootstrap and other resampling plans. CBMS-NSF Regional Conference Series in Applied Mathematics, Monograph 38</source>
        <year>1982</year>
        <publisher-loc>Philadelphia</publisher-loc>
        <publisher-name>SIAM</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Fan</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Variable selection via nonconcave penalized likelihood and its oracle properties</article-title>
        <source>J Am Stat Assoc</source>
        <year>2001</year>
        <volume>96</volume>
        <issue>456</issue>
        <fpage>1348</fpage>
        <lpage>60</lpage>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Fan</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Variable selection via nonconcave penalized likelihood and its oracle properties</article-title>
        <source>J Am Stat Assoc</source>
        <year>2001</year>
        <volume>96</volume>
        <fpage>1348</fpage>
        <lpage>60</lpage>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Green</surname>
            <given-names>MR</given-names>
          </name>
          <name>
            <surname>Kihira</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>CL</given-names>
          </name>
          <name>
            <surname>Nair</surname>
            <given-names>RV</given-names>
          </name>
          <name>
            <surname>Salari</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Gentles</surname>
            <given-names>AJ</given-names>
          </name>
          <name>
            <surname>Irish</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Stehr</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Vicente-Dueñas</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Romero-Camarero</surname>
            <given-names>I</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Mutations in early follicular lymphoma progenitors are associated with suppressed antigen presentation</article-title>
        <source>Proc Natl Acad Sci</source>
        <year>2015</year>
        <volume>112</volume>
        <issue>10</issue>
        <fpage>E1116</fpage>
        <lpage>25</lpage>
        <?supplied-pmid 25713363?>
        <pub-id pub-id-type="pmid">25713363</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hardee</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Ouyang</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Kundaje</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Lacroute</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Snyder</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Stat3 targets suggest mechanisms of aggressive tumorigenesis in diffuse large b-cell lymphoma. G3: Genes, Genomes</article-title>
        <source>Genetics</source>
        <year>2013</year>
        <volume>3</volume>
        <issue>12</issue>
        <fpage>2173</fpage>
        <lpage>85</lpage>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ingram</surname>
            <given-names>JM</given-names>
          </name>
          <name>
            <surname>Marsh</surname>
            <given-names>MM</given-names>
          </name>
        </person-group>
        <article-title>Projections onto convex cones in hilbert space</article-title>
        <source>J Approx Theory</source>
        <year>1991</year>
        <volume>64</volume>
        <issue>3</issue>
        <fpage>343</fpage>
        <lpage>50</lpage>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jin</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Lin</surname>
            <given-names>DY</given-names>
          </name>
          <name>
            <surname>Sun</surname>
            <given-names>W</given-names>
          </name>
        </person-group>
        <article-title>Cell-type-aware analysis of rna-seq data</article-title>
        <source>Nat Comput Sci</source>
        <year>2021</year>
        <volume>1</volume>
        <issue>4</issue>
        <fpage>253</fpage>
        <lpage>61</lpage>
        <?supplied-pmid 34957416?>
        <pub-id pub-id-type="pmid">34957416</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13</label>
      <mixed-citation publication-type="other">Kang K, Meng Q, Shats I, Umbach DM, Li M, Li Y, Li X, Li L, Vol. 15. Cdseq: A novel complete deconvolution method for dissecting heterogeneous samples using gene expression data; 2019, p. 1007510.</mixed-citation>
    </ref>
    <ref id="CR14">
      <label>14</label>
      <mixed-citation publication-type="other">Kim WJ, Lim JH, Lee JS, Lee SD, Kim JH, Oh YM. Comprehensive analysis of transcriptome sequencing data in the lung tissues of copd subjects. Int J Genomics. 2015; 2015.</mixed-citation>
    </ref>
    <ref id="CR15">
      <label>15</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lenz</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Wright</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Dave</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Xiao</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Powell</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Zhao</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Xu</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Tan</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Goldschmidt</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Iqbal</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Stromal gene signatures in large-b-cell lymphomas</article-title>
        <source>N Engl J Med</source>
        <year>2008</year>
        <volume>359</volume>
        <issue>22</issue>
        <fpage>2313</fpage>
        <lpage>23</lpage>
        <?supplied-pmid 19038878?>
        <pub-id pub-id-type="pmid">19038878</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Jin</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>Dissecting differential signals in high-throughput data from complex tissues</article-title>
        <source>Bioinformatics</source>
        <year>2019</year>
        <volume>35</volume>
        <issue>20</issue>
        <fpage>3898</fpage>
        <lpage>905</lpage>
        <?supplied-pmid 30903684?>
        <pub-id pub-id-type="pmid">30903684</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Liberzon</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Birger</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Thorvaldsdóttir</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Ghandi</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Mesirov</surname>
            <given-names>JP</given-names>
          </name>
          <name>
            <surname>Tamayo</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>The molecular signatures database hallmark gene set collection</article-title>
        <source>Cell Syst</source>
        <year>2015</year>
        <volume>1</volume>
        <issue>6</issue>
        <fpage>417</fpage>
        <lpage>25</lpage>
        <?supplied-pmid 26771021?>
        <pub-id pub-id-type="pmid">26771021</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Linsley</surname>
            <given-names>PS</given-names>
          </name>
          <name>
            <surname>Greenbaum</surname>
            <given-names>CJ</given-names>
          </name>
          <name>
            <surname>Rosasco</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Presnell</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Herold</surname>
            <given-names>KC</given-names>
          </name>
          <name>
            <surname>Dufort</surname>
            <given-names>MJ</given-names>
          </name>
        </person-group>
        <article-title>Elevated t cell levels in peripheral blood predict poor clinical response following rituximab treatment in new-onset type 1 diabetes</article-title>
        <source>Genes Immun</source>
        <year>2019</year>
        <volume>20</volume>
        <issue>4</issue>
        <fpage>293</fpage>
        <lpage>307</lpage>
        <?supplied-pmid 29925930?>
        <pub-id pub-id-type="pmid">29925930</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Liu</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Zhao</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Gu</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Han</surname>
            <given-names>Q</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <article-title>Screening of key genes associated with r-chop immunochemotherapy and construction of a prognostic risk model in diffuse large b-cell lymphoma</article-title>
        <source>Mol Med Rep</source>
        <year>2019</year>
        <volume>20</volume>
        <issue>4</issue>
        <fpage>3679</fpage>
        <lpage>90</lpage>
        <?supplied-pmid 31485671?>
        <pub-id pub-id-type="pmid">31485671</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Loh</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Wainwright</surname>
            <given-names>MJ</given-names>
          </name>
        </person-group>
        <article-title>Regularized m-estimators with nonconvexity: statistical and algorithmic theory for local optima</article-title>
        <source>J Mach Learn Res</source>
        <year>2014</year>
        <volume>1</volume>
        <fpage>1</fpage>
        <lpage>56</lpage>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Loh</surname>
            <given-names>PL</given-names>
          </name>
          <name>
            <surname>Wainwright</surname>
            <given-names>MJ</given-names>
          </name>
        </person-group>
        <article-title>Support recovery without incoherence: a case for nonconvex regularization</article-title>
        <source>Ann Stat</source>
        <year>2017</year>
        <volume>45</volume>
        <issue>6</issue>
        <fpage>2455</fpage>
        <lpage>82</lpage>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mathys</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Davila-Velderrain</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Peng</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Gao</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Mohammadi</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Young</surname>
            <given-names>JZ</given-names>
          </name>
          <name>
            <surname>Menon</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>He</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Abdurrob</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Jiang</surname>
            <given-names>X</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Single-cell transcriptomic analysis of Alzheimer’s disease</article-title>
        <source>Nature</source>
        <year>2019</year>
        <volume>570</volume>
        <issue>7761</issue>
        <fpage>332</fpage>
        <lpage>37</lpage>
        <?supplied-pmid 31042697?>
        <pub-id pub-id-type="pmid">31042697</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>McIntosh</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>The jackknife estimation method</article-title>
        <source>arXiv preprint arXiv</source>
        <year>2016</year>
        <volume>1606</volume>
        <fpage>00497</fpage>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Newman</surname>
            <given-names>AM</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>CL</given-names>
          </name>
          <name>
            <surname>Green</surname>
            <given-names>MR</given-names>
          </name>
          <name>
            <surname>Gentles</surname>
            <given-names>AJ</given-names>
          </name>
          <name>
            <surname>Feng</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Xu</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Hoang</surname>
            <given-names>CD</given-names>
          </name>
          <name>
            <surname>Diehn</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Alizadeh</surname>
            <given-names>AA</given-names>
          </name>
        </person-group>
        <article-title>Robust enumeration of cell subsets from tissue expression profiles</article-title>
        <source>Nat Methods</source>
        <year>2015</year>
        <volume>12</volume>
        <issue>5</issue>
        <fpage>453</fpage>
        <lpage>57</lpage>
        <?supplied-pmid 25822800?>
        <pub-id pub-id-type="pmid">25822800</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Newman</surname>
            <given-names>AM</given-names>
          </name>
          <name>
            <surname>Steen</surname>
            <given-names>CB</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>CL</given-names>
          </name>
          <name>
            <surname>Gentles</surname>
            <given-names>AJ</given-names>
          </name>
          <name>
            <surname>Chaudhuri</surname>
            <given-names>AA</given-names>
          </name>
          <name>
            <surname>Scherer</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Khodadoust</surname>
            <given-names>MS</given-names>
          </name>
          <name>
            <surname>Esfahani</surname>
            <given-names>MS</given-names>
          </name>
          <name>
            <surname>Luca</surname>
            <given-names>BA</given-names>
          </name>
          <name>
            <surname>Steiner</surname>
            <given-names>D</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Determining cell type abundance and expression from bulk tissues with digital cytometry</article-title>
        <source>Nat Biotechnol</source>
        <year>2019</year>
        <volume>37</volume>
        <issue>7</issue>
        <fpage>773</fpage>
        <lpage>82</lpage>
        <?supplied-pmid 31061481?>
        <pub-id pub-id-type="pmid">31061481</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>O’donnell</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Breen</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Wilson</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Djukanovic</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Inflammatory cells in the airways in copd</article-title>
        <source>Thorax</source>
        <year>2006</year>
        <volume>61</volume>
        <issue>5</issue>
        <fpage>448</fpage>
        <lpage>54</lpage>
        <?supplied-pmid 16648353?>
        <pub-id pub-id-type="pmid">16648353</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Patrick</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Taga</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Ergun</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Ng</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Casazza</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Cimpean</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Yung</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Schneider</surname>
            <given-names>JA</given-names>
          </name>
          <name>
            <surname>Bennett</surname>
            <given-names>DA</given-names>
          </name>
          <name>
            <surname>Gaiteri</surname>
            <given-names>C</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Deconvolving the contributions of cell-type heterogeneity on cortical gene expression</article-title>
        <source>PLoS Comput Biol</source>
        <year>2020</year>
        <volume>16</volume>
        <issue>8</issue>
        <fpage>e1008,120</fpage>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Polverino</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Celli</surname>
            <given-names>BR</given-names>
          </name>
          <name>
            <surname>Owen</surname>
            <given-names>CA</given-names>
          </name>
        </person-group>
        <article-title>Copd as an endothelial disorder: endothelial injury linking lesions in the lungs and other organs?(2017 grover conference series)</article-title>
        <source>Pulm Circ</source>
        <year>2018</year>
        <volume>8</volume>
        <issue>1</issue>
        <fpage>2045894018758,528</fpage>
      </element-citation>
    </ref>
    <ref id="CR29">
      <label>29</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Racle</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>de Jonge</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Baumgaertner</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Speiser</surname>
            <given-names>DE</given-names>
          </name>
          <name>
            <surname>Gfeller</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>Simultaneous enumeration of cancer and immune cell types from bulk tumor gene expression data</article-title>
        <source>elife</source>
        <year>2017</year>
        <volume>6</volume>
        <fpage>e26,476</fpage>
      </element-citation>
    </ref>
    <ref id="CR30">
      <label>30</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ramwadhdoebe</surname>
            <given-names>TH</given-names>
          </name>
          <name>
            <surname>van Baarsen</surname>
            <given-names>LG</given-names>
          </name>
          <name>
            <surname>Boumans</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>Bruijnen</surname>
            <given-names>ST</given-names>
          </name>
          <name>
            <surname>Safy</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Berger</surname>
            <given-names>FH</given-names>
          </name>
          <name>
            <surname>Semmelink</surname>
            <given-names>JF</given-names>
          </name>
          <name>
            <surname>van der Laken</surname>
            <given-names>CJ</given-names>
          </name>
          <name>
            <surname>Gerlag</surname>
            <given-names>DM</given-names>
          </name>
          <name>
            <surname>Thurlings</surname>
            <given-names>RM</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Effect of rituximab treatment on t and b cell subsets in lymph node biopsies of patients with rheumatoid arthritis</article-title>
        <source>Rheumatology</source>
        <year>2019</year>
        <volume>58</volume>
        <issue>6</issue>
        <fpage>1075</fpage>
        <lpage>85</lpage>
        <?supplied-pmid 30649469?>
        <pub-id pub-id-type="pmid">30649469</pub-id>
      </element-citation>
    </ref>
    <ref id="CR31">
      <label>31</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Repsilber</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Kern</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Telaar</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Walzl</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Black</surname>
            <given-names>GF</given-names>
          </name>
          <name>
            <surname>Selbig</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Parida</surname>
            <given-names>SK</given-names>
          </name>
          <name>
            <surname>Kaufmann</surname>
            <given-names>SH</given-names>
          </name>
          <name>
            <surname>Jacobsen</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Biomarker discovery in heterogeneous tissue samples-taking the in-silico deconfounding approach</article-title>
        <source>BMC Bioinformatics</source>
        <year>2010</year>
        <volume>1</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <lpage>15</lpage>
      </element-citation>
    </ref>
    <ref id="CR32">
      <label>32</label>
      <mixed-citation publication-type="other">Sauler M, McDonough JE, Adams TS, Kothapalli N, Schupp JS, Nouws J, Chioccioli M, Omote N, Cosme C, Poli S, et al.Single-cell rna sequencing identifies aberrant transcriptional profiles of cellular populations and altered alveolar niche signalling networks in chronic obstructive pulmonary disease (copd); 2020.</mixed-citation>
    </ref>
    <ref id="CR33">
      <label>33</label>
      <mixed-citation publication-type="other">Savage KJ, Yenson PR, Shenkier T, Klasa R, Villa D, Goktepe O, Steidl C, Slack GW, Gascoyne RD, Connors JM, et al.The outcome of primary mediastinal large b-cell lymphoma (pmbcl) in the r-chop treatment era. 2012.</mixed-citation>
    </ref>
    <ref id="CR34">
      <label>34</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Shen-Orr</surname>
            <given-names>SS</given-names>
          </name>
          <name>
            <surname>Tibshirani</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Khatri</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Bodian</surname>
            <given-names>DL</given-names>
          </name>
          <name>
            <surname>Staedtler</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Perry</surname>
            <given-names>NM</given-names>
          </name>
          <name>
            <surname>Hastie</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Sarwal</surname>
            <given-names>MM</given-names>
          </name>
          <name>
            <surname>Davis</surname>
            <given-names>MM</given-names>
          </name>
          <name>
            <surname>Butte</surname>
            <given-names>AJ</given-names>
          </name>
        </person-group>
        <article-title>Cell type–specific gene expression differences in complex tissues</article-title>
        <source>Nat Methods</source>
        <year>2010</year>
        <volume>7</volume>
        <issue>4</issue>
        <fpage>287</fpage>
        <lpage>89</lpage>
        <?supplied-pmid 20208531?>
        <pub-id pub-id-type="pmid">20208531</pub-id>
      </element-citation>
    </ref>
    <ref id="CR35">
      <label>35</label>
      <mixed-citation publication-type="other">Sinharay S. Jackknife methods. International Encyclopedia of Education, Third Edition: Elsevier; 2010.</mixed-citation>
    </ref>
    <ref id="CR36">
      <label>36</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Stuart</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Butler</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Hoffman</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Hafemeister</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Papalexi</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Mauck III</surname>
            <given-names>WM</given-names>
          </name>
          <name>
            <surname>Hao</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Stoeckius</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Smibert</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Satija</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Comprehensive integration of single-cell data</article-title>
        <source>Cell</source>
        <year>2019</year>
        <volume>177</volume>
        <fpage>1888</fpage>
        <lpage>902</lpage>
        <?supplied-pmid 31178118?>
        <pub-id pub-id-type="pmid">31178118</pub-id>
      </element-citation>
    </ref>
    <ref id="CR37">
      <label>37</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tang</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Park</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Zhao</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>Nitumid: nonnegative matrix factorization-based immune-tumor microenvironment deconvolution</article-title>
        <source>Bioinformatics</source>
        <year>2020</year>
        <volume>36</volume>
        <issue>5</issue>
        <fpage>1344</fpage>
        <lpage>50</lpage>
        <?supplied-pmid 31593244?>
        <pub-id pub-id-type="pmid">31593244</pub-id>
      </element-citation>
    </ref>
    <ref id="CR38">
      <label>38</label>
      <mixed-citation publication-type="other">Tang D, Park S, Zhao H. SCADIE: simultaneous estimation of cell type proportions and cell type-specific gene expressions using SCAD-based iterative estimating procedure. 10.5281/zenodo.6509668.</mixed-citation>
    </ref>
    <ref id="CR39">
      <label>39</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tetley</surname>
            <given-names>TD</given-names>
          </name>
        </person-group>
        <article-title>Inflammatory cells and chronic obstructive pulmonary disease</article-title>
        <source>Curr Drug Targets-Inflamm Allergy</source>
        <year>2005</year>
        <volume>4</volume>
        <issue>6</issue>
        <fpage>607</fpage>
        <lpage>18</lpage>
        <?supplied-pmid 17305517?>
        <pub-id pub-id-type="pmid">17305517</pub-id>
      </element-citation>
    </ref>
    <ref id="CR40">
      <label>40</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tsoucas</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Dong</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Zhu</surname>
            <given-names>Q</given-names>
          </name>
          <name>
            <surname>Guo</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Yuan</surname>
            <given-names>GC</given-names>
          </name>
        </person-group>
        <article-title>Accurate estimation of cell-type composition from gene expression data</article-title>
        <source>Nat Commun</source>
        <year>2019</year>
        <volume>10</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <lpage>9</lpage>
        <pub-id pub-id-type="pmid">30602773</pub-id>
      </element-citation>
    </ref>
    <ref id="CR41">
      <label>41</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Vallania</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Tam</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Lofgren</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Schaffert</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Azad</surname>
            <given-names>TD</given-names>
          </name>
          <name>
            <surname>Bongen</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Haynes</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Alsup</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Alonso</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Davis</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Leveraging heterogeneity across multiple datasets increases cell-mixture deconvolution accuracy and reduces biological and technical biases</article-title>
        <source>Nat Commun</source>
        <year>2018</year>
        <volume>9</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <lpage>8</lpage>
        <pub-id pub-id-type="pmid">29317637</pub-id>
      </element-citation>
    </ref>
    <ref id="CR42">
      <label>42</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Park</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Susztak</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>NR</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Bulk tissue cell type deconvolution with multi-subject single-cell expression reference</article-title>
        <source>Nat Commun</source>
        <year>2019</year>
        <volume>10</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <lpage>9</lpage>
        <pub-id pub-id-type="pmid">30602773</pub-id>
      </element-citation>
    </ref>
    <ref id="CR43">
      <label>43</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yan</surname>
            <given-names>KS</given-names>
          </name>
          <name>
            <surname>Janda</surname>
            <given-names>CY</given-names>
          </name>
          <name>
            <surname>Chang</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Zheng</surname>
            <given-names>GX</given-names>
          </name>
          <name>
            <surname>Larkin</surname>
            <given-names>KA</given-names>
          </name>
          <name>
            <surname>Luca</surname>
            <given-names>VC</given-names>
          </name>
          <name>
            <surname>Chia</surname>
            <given-names>LA</given-names>
          </name>
          <name>
            <surname>Mah</surname>
            <given-names>AT</given-names>
          </name>
          <name>
            <surname>Han</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Terry</surname>
            <given-names>JM</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Non-equivalence of wnt and r-spondin ligands during lgr5+ intestinal stem-cell self-renewal</article-title>
        <source>Nature</source>
        <year>2017</year>
        <volume>545</volume>
        <issue>7653</issue>
        <fpage>238</fpage>
        <lpage>42</lpage>
        <?supplied-pmid 28467820?>
        <pub-id pub-id-type="pmid">28467820</pub-id>
      </element-citation>
    </ref>
    <ref id="CR44">
      <label>44</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zaitsev</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Bambouskova</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Swain</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Artyomov</surname>
            <given-names>M. N</given-names>
          </name>
        </person-group>
        <article-title>Complete deconvolution of cellular mixtures based on linearity of transcriptional signatures</article-title>
        <source>Nat Commun</source>
        <year>2019</year>
        <volume>10</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <lpage>16</lpage>
        <pub-id pub-id-type="pmid">30602773</pub-id>
      </element-citation>
    </ref>
    <ref id="CR45">
      <label>45</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zou</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>One-step sparse estimates in nonconcave penalized likelihood models</article-title>
        <source>Ann Stat</source>
        <year>2008</year>
        <volume>36</volume>
        <issue>4</issue>
        <fpage>1509</fpage>
        <lpage>33</lpage>
        <?supplied-pmid 19823597?>
        <pub-id pub-id-type="pmid">19823597</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
