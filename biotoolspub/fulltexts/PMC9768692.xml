<?DTDIdentifier.IdentifierValue -//ES//DTD journal article DTD version 5.6.0//EN//XML?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName art560.dtd?>
<?SourceDTD.Version 5.6.0?>
<?ConverterInfo.XSLTName elsevier2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<?origin publisher?>
<?FILEmeta_PATTER100656 xml ?>
<?FILEmain xml ?>
<?FILEmain pdf ?>
<?FILEgr1 jpg ?>
<?FILEgr2 jpg ?>
<?FILEgr3 jpg ?>
<?FILEgr4 jpg ?>
<?FILEgr5 jpg ?>
<?FILEgr6 jpg ?>
<?FILEgr7 jpg ?>
<?FILEgr8 jpg ?>
<?FILEgr9 jpg ?>
<?FILEgr10 jpg ?>
<?FILEgr11 jpg ?>
<?FILEmmc1 pdf ?>
<?FILEmmc2 pdf ?>
<?FILEsi1 gif ?>
<?FILEsi2 gif ?>
<?FILEsi3 gif ?>
<?FILEsi4 gif ?>
<?FILEsi5 gif ?>
<?FILEsi6 gif ?>
<?FILEsi7 gif ?>
<?FILEsi8 gif ?>
<?FILEsi9 gif ?>
<?FILEsi10 gif ?>
<?FILEsi11 gif ?>
<?FILEsi12 gif ?>
<?FILEsi13 gif ?>
<?FILEsi14 gif ?>
<?FILEsi15 gif ?>
<?FILEsi16 gif ?>
<?FILEsi17 gif ?>
<?FILEsi18 gif ?>
<?FILEsi19 gif ?>
<?FILEsi20 gif ?>
<?FILEsi21 gif ?>
<?FILEsi22 gif ?>
<?FILEsi23 gif ?>
<?FILEsi24 gif ?>
<?FILEsi25 gif ?>
<?FILEsi26 gif ?>
<?FILEsi27 gif ?>
<?FILEsi28 gif ?>
<?FILEsi29 gif ?>
<?FILEsi30 gif ?>
<?FILEsi31 gif ?>
<?FILEsi32 gif ?>
<?FILEsi33 gif ?>
<?FILEsi34 gif ?>
<?FILEsi35 gif ?>
<?FILEsi36 gif ?>
<?FILEsi37 gif ?>
<?FILEsi38 gif ?>
<?FILEsi39 gif ?>
<?FILEsi40 gif ?>
<?FILEsi41 gif ?>
<?FILEsi42 gif ?>
<?FILEsi43 gif ?>
<?FILEsi44 gif ?>
<?FILEsi45 gif ?>
<?FILEsi46 gif ?>
<?FILEsi47 gif ?>
<?FILEsi48 gif ?>
<?FILEsi49 gif ?>
<?FILEsi50 gif ?>
<?FILEsi51 gif ?>
<?FILEsi52 gif ?>
<?FILEsi53 gif ?>
<?FILEsi54 gif ?>
<?FILEsi55 gif ?>
<?FILEsi56 gif ?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Patterns (N Y)</journal-id>
    <journal-id journal-id-type="iso-abbrev">Patterns (N Y)</journal-id>
    <journal-title-group>
      <journal-title>Patterns</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2666-3899</issn>
    <publisher>
      <publisher-name>Elsevier</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">9768692</article-id>
    <article-id pub-id-type="pii">S2666-3899(22)00296-3</article-id>
    <article-id pub-id-type="doi">10.1016/j.patter.2022.100656</article-id>
    <article-id pub-id-type="publisher-id">100656</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>GeoSPM: Geostatistical parametric mapping for medicine</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" id="au1">
        <name>
          <surname>Engleitner</surname>
          <given-names>Holger</given-names>
        </name>
        <email>h.engleitner@ucl.ac.uk</email>
        <xref rid="aff1" ref-type="aff">1</xref>
        <xref rid="cor1" ref-type="corresp">∗</xref>
      </contrib>
      <contrib contrib-type="author" id="au2">
        <name>
          <surname>Jha</surname>
          <given-names>Ashwani</given-names>
        </name>
        <xref rid="aff1" ref-type="aff">1</xref>
      </contrib>
      <contrib contrib-type="author" id="au3">
        <name>
          <surname>Pinilla</surname>
          <given-names>Marta Suarez</given-names>
        </name>
        <xref rid="aff1" ref-type="aff">1</xref>
      </contrib>
      <contrib contrib-type="author" id="au4">
        <name>
          <surname>Nelson</surname>
          <given-names>Amy</given-names>
        </name>
        <xref rid="aff1" ref-type="aff">1</xref>
      </contrib>
      <contrib contrib-type="author" id="au5">
        <name>
          <surname>Herron</surname>
          <given-names>Daniel</given-names>
        </name>
        <xref rid="aff2" ref-type="aff">2</xref>
      </contrib>
      <contrib contrib-type="author" id="au6">
        <name>
          <surname>Rees</surname>
          <given-names>Geraint</given-names>
        </name>
        <xref rid="aff1" ref-type="aff">1</xref>
      </contrib>
      <contrib contrib-type="author" id="au7">
        <name>
          <surname>Friston</surname>
          <given-names>Karl</given-names>
        </name>
        <xref rid="aff1" ref-type="aff">1</xref>
      </contrib>
      <contrib contrib-type="author" id="au8">
        <name>
          <surname>Rossor</surname>
          <given-names>Martin</given-names>
        </name>
        <xref rid="aff1" ref-type="aff">1</xref>
      </contrib>
      <contrib contrib-type="author" id="au9">
        <name>
          <surname>Nachev</surname>
          <given-names>Parashkev</given-names>
        </name>
        <email>p.nachev@ucl.ac.uk</email>
        <xref rid="aff1" ref-type="aff">1</xref>
        <xref rid="fn1" ref-type="fn">3</xref>
        <xref rid="cor2" ref-type="corresp">∗∗</xref>
      </contrib>
      <aff id="aff1"><label>1</label>UCL Queen Square Institute of Neurology, University College London, London WC1N 3BG, UK</aff>
      <aff id="aff2"><label>2</label>Research &amp; Development, NIHR University College London Hospitals Biomedical Research Centre, London W1T 7DN, UK</aff>
    </contrib-group>
    <author-notes>
      <corresp id="cor1"><label>∗</label>Corresponding author <email>h.engleitner@ucl.ac.uk</email></corresp>
      <corresp id="cor2"><label>∗∗</label>Corresponding author <email>p.nachev@ucl.ac.uk</email></corresp>
      <fn id="fn1">
        <label>3</label>
        <p id="ntpara0010">Lead contact</p>
      </fn>
    </author-notes>
    <pub-date pub-type="pmc-release">
      <day>09</day>
      <month>12</month>
      <year>2022</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on <pub-date
						pub-type="epub">.-->
    <pub-date pub-type="collection">
      <day>09</day>
      <month>12</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>09</day>
      <month>12</month>
      <year>2022</year>
    </pub-date>
    <volume>3</volume>
    <issue>12</issue>
    <elocation-id>100656</elocation-id>
    <history>
      <date date-type="received">
        <day>31</day>
        <month>5</month>
        <year>2022</year>
      </date>
      <date date-type="rev-recd">
        <day>1</day>
        <month>7</month>
        <year>2022</year>
      </date>
      <date date-type="accepted">
        <day>11</day>
        <month>11</month>
        <year>2022</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© 2022 The Author(s)</copyright-statement>
      <copyright-year>2022</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an open access article under the CC BY license (http://creativecommons.org/licenses/by/4.0/).</license-p>
      </license>
    </permissions>
    <abstract id="abs0010">
      <title>Summary</title>
      <p>The characteristics and determinants of health and disease are often organized in space, reflecting our spatially extended nature. Understanding the influence of such factors requires models capable of capturing spatial relations. Drawing on statistical parametric mapping, a framework for topological inference well established in the realm of neuroimaging, we propose and validate an approach to the spatial analysis of diverse clinical data—GeoSPM—based on differential geometry and random field theory. We evaluate GeoSPM across an extensive array of synthetic simulations encompassing diverse spatial relationships, sampling, and corruption by noise, and demonstrate its application on large-scale data from UK Biobank. GeoSPM is readily interpretable, can be implemented with ease by non-specialists, enables flexible modeling of complex spatial relations, exhibits robustness to noise and under-sampling, offers principled criteria of statistical significance, and is through computational efficiency readily scalable to large datasets. We provide a complete, open-source software implementation.</p>
    </abstract>
    <abstract abstract-type="author-highlights" id="abs0015">
      <title>Highlights</title>
      <p>
        <list list-type="simple" id="ulist0010">
          <list-item id="u0010">
            <label>•</label>
            <p id="p0010">A framework for topological inference applicable to diverse clinical data is proposed</p>
          </list-item>
          <list-item id="u0015">
            <label>•</label>
            <p id="p0015">Superior robustness to noise and under-sampling is observed compared with kriging</p>
          </list-item>
          <list-item id="u0020">
            <label>•</label>
            <p id="p0020">Application to UK Biobank data is demonstrated</p>
          </list-item>
        </list>
      </p>
    </abstract>
    <abstract abstract-type="editor-highlights" id="abs0020">
      <title>The bigger picture</title>
      <p>Many aspects of health and disease are distributed in space, requiring models of topological organization. The complexity of the task, however, makes spatial analysis comparatively rare in medicine. Here, we introduce GeoSPM, a platform for topological inference from clinical data based on a mature mathematical framework—statistical parametric mapping—validated by decades of use in neuroimaging. We provide comprehensive synthetic evaluation of the approach, and illustrate its application on large-scale data from UK Biobank. The interpretability, flexibility, scalability, ease of implementation, robustness to noise and under-sampling, computational efficiency, and provision of principled criteria of statistical significance, provided by our open-source platform should catalyze wider use of spatial analysis across medicine.</p>
    </abstract>
    <abstract abstract-type="teaser" id="abs0025">
      <p>We present GeoSPM, an approach to the spatial analysis of diverse clinical data that extends a framework for topological inference, well established in neuroimaging, based on differential geometry and random field theory. We evaluate GeoSPM with extensive synthetic simulations, and apply it to large-scale data from UK Biobank. Our approach is readily interpretable, easy to implement, enables flexible modeling of complex spatial relations, exhibits robustness to noise and under-sampling, offers principled criteria of statistical significance, and is scalable to large datasets.</p>
    </abstract>
    <kwd-group id="kwrds0010">
      <title>Keywords</title>
      <kwd>geostatistics</kwd>
      <kwd>spatial analysis</kwd>
      <kwd>statistical parametric mapping</kwd>
      <kwd>kriging</kwd>
      <kwd>epidemiology</kwd>
    </kwd-group>
  </article-meta>
  <notes>
    <p id="misc0010">Published: December 9, 2022</p>
  </notes>
</front>
<body>
  <sec id="sec1">
    <title>Introduction</title>
    <p id="p0030">Human beings vary along a rich multiplicity of social and biological dimensions, whose complex interactions across health and disease present a challenge for medical science and systems biology in general. The combination of large-scale data with machine learning promises to cast brighter light on this complexity than conventional inferential techniques, illuminating distributed, long-range dependencies hitherto obscured. Our interventions are increasingly grounded in an understanding of the factors that shape disease trajectories and determine individual responses to treatment.</p>
    <p id="p0035">One comparatively neglected dimension is the literal dimension of space: each of us inhabits a particular location that may reflect or modify our individual biological characteristics and the influence of (and on) other spatially distributed variables. Spatial factors may be static or vary over time, arising at multiple scales, ranging from the domestic to the inter-continental. Their reference frames may be set by internal communities, by external geographies, or by a complex blend of the two. Their spatial organization may be linear or consistently distorted by individual or environmental movement within these frames of reference. Spatial factors may disclose or alter characteristics of biology directly, or render them more or less clinically accessible or actionable. Space arises not only in epidemiology, environmental medicine, healthcare policy, and public health, but in the fundamental organization of biology itself.</p>
    <p id="p0040">Yet outside a few specialist areas spatial analysis is comparatively rare in medicine. An indicative survey of published paper titles and abstracts in Microsoft Academic Graph, spanning 30 years of medical research, reveals only 1,897 journal papers at the intersection of geospatial analysis and medicine, with an annual citation distribution for those cited more than once nonetheless substantially higher than a matched biomedical sample (mean 2.75 versus 2.13, Mann-Whitney U test, p &lt; 0.001, <xref rid="mmc1" ref-type="supplementary-material">Figure S1</xref>, see <xref rid="mmc1" ref-type="supplementary-material">supplemental note</xref>). The comparative scarcity is arguably in part explained by the difficulty of the task. The spatial factors arising in a medical context are often entangled, their sampling is sparse and frequently corrupted by noise, and the underlying signals tend to be weak. But spatial analysis is hard even where the data regime is benign, for the problem is essentially multidimensional and is rarely, if ever, open to analytic solutions.</p>
    <p id="p0045">The fundamental challenge is reflected in the wide array of techniques in current use. A survey of 397 papers published since January 1, 2017, in the joint domains of health and spatial modeling identifies local indicators of spatial association,<xref rid="bib1" ref-type="bibr"><sup>1</sup></xref> spatial scan statistics,<xref rid="bib2" ref-type="bibr"><sup>2</sup></xref> inverse distance weighting,<xref rid="bib3" ref-type="bibr"><sup>3</sup></xref> kernel density estimation,<xref rid="bib4" ref-type="bibr"><sup>4</sup></xref><sup>,</sup><xref rid="bib5" ref-type="bibr"><sup>5</sup></xref> spatial regression in terms of spatial lag and spatial error models,<xref rid="bib6" ref-type="bibr"><sup>6</sup></xref> geographically weighted regression (GWR),<xref rid="bib7" ref-type="bibr"><sup>7</sup></xref> land-use regression,<xref rid="bib8" ref-type="bibr"><sup>8</sup></xref> kriging,<xref rid="bib9" ref-type="bibr"><sup>9</sup></xref><sup>,</sup><xref rid="bib10" ref-type="bibr"><sup>10</sup></xref> generalized linear mixed models,<xref rid="bib11" ref-type="bibr"><sup>11</sup></xref> generalized (geo-)additive models,<xref rid="bib12" ref-type="bibr"><sup>12</sup></xref><sup>,</sup><xref rid="bib13" ref-type="bibr"><sup>13</sup></xref> hierarchical Bayesian spatial analysis,<xref rid="bib14" ref-type="bibr"><sup>14</sup></xref><sup>,</sup><xref rid="bib15" ref-type="bibr"><sup>15</sup></xref> and model-based geostatistics,<xref rid="bib16" ref-type="bibr"><sup>16</sup></xref><sup>,</sup><xref rid="bib17" ref-type="bibr"><sup>17</sup></xref> among others.</p>
    <p id="p0050">This methodological diversity reflects differing demands on the spatial aspects of the model and the breadth of specific questions that arise in a spatial setting. With the question may vary the modeling objective, and the theoretical assumptions that underpin it. Common objectives include spatial prediction, the analysis and regression of spatially varying or spatially confounded associations, and the investigation of spatial point patterns. Arguably the most general and taxing research questions involve inference—whether explicit or not—to a topological organization, for example, identifying the location and extent of a spatially organized signal buried in noise. Such questions typically—if not always—require methods that treat space as a continuity, produce spatially continuous estimates, and provide principled measures of spatial uncertainty. Dominant in this category are methods that adopt a nonlinear multivariate approach, taking advantage of the flexibility and expressivity it offers. Although potentially powerful, they require joint expertise in the method and the domain of its application, depend on prior specification of model parameters, and tend to demand substantial computational resource even for data of moderate scale. Furthermore, in the generalized linear framework, space commonly enters the model as a latent random effect—usually derived from a suitable Gaussian process. This approach adjusts for spatially correlated variance within an otherwise non-spatial framework, with the fixed effects remaining constant across the spatial field.<xref rid="bib18" ref-type="bibr"><sup>18</sup></xref></p>
    <p id="p0055">These obstacles motivate the pursuit of alternatives outside the multivariate paradigm for the task of topological inference. The direct counterpoint is a mass-univariate approach, where a complex multivariate model is replaced by a spatially indexed ensemble of simpler models. GWR modifies the predictors in a regression model through a spatially localized weight matrix, so that a variation of the model is estimated at each location and the resulting estimates exhibit spatial smoothness. Although GWR estimates can be derived from a prespecified grid, in practice only sampled locations or grids of modest size tend to be evaluated owing to the difficulty of correcting for multiple comparisons in a topologically informed manner.<xref rid="bib19" ref-type="bibr"><sup>19</sup></xref> Spatial inference with GWR is commonly limited to regression coefficient or coefficient of determination maps that simply indicate the local goodness of fit,<xref rid="bib20" ref-type="bibr"><sup>20</sup></xref> without employing formal tests of significance.<xref rid="bib21" ref-type="bibr"><sup>21</sup></xref><sup>,</sup><xref rid="bib22" ref-type="bibr"><sup>22</sup></xref> Finally, these are regression models relating a response to a set of spatially organized predictors, not models of the spatial variation of a set of variables within a topological framework of uncertainty: our primary concern.</p>
    <p id="p0060">Here, we propose, implement, and validate an approach to the spatial analysis of diverse clinical or public health data that draw upon differential geometry and random field theory, with the topological objective of identifying connected neighborhoods and peaks of spatial significance. In particular, we leverage the procedures used in statistical parametric mapping (SPM): a framework for making topological inferences about spatially structured effects, with well-behaved spatial dependencies.<xref rid="bib23" ref-type="bibr"><sup>23</sup></xref> This approach has been established for decades in the realm of (structural and functional) volumetric neuroimaging.</p>
    <p id="p0065">The core idea is to transform sparse spatial signals into a form suited to mass-univariate statistical testing on a chosen point grid: for example, testing that the spatial or regional expression of a particular variable is greater than would be expected under the null hypothesis of no regional effect. The probability of observing topological features in the observed map, such as peaks or clusters (i.e., level sets above some threshold), can then be evaluated with classical inference based on random field theory, and used to ascribe a p value to spatially organized effects. This principled approach radically simplifies one important domain of spatial analysis, rendering it potentially more sensitive and robust to noise, and places it on a formal inferential footing, yielding a general-purpose geostatistical tool readily deployable across a multitude of medical fields where the modeling objective requires inference to the topological organization of a set of signals of interest. For example, we may use the approach to infer the location and extent of regional expression of spatially organized variables—taken alone or in conjunction—such as disease prevalence in a community, while accounting for multiple potentially interacting confounding factors, and without relying on any <italic>a priori</italic> parcellation of the space.</p>
    <p id="p0070">In what follows, we (1) offer a detailed rationale for our approach; (2) proceed to evaluate it across an extensive array of synthetic simulations where the nature of the spatial relationships, sampling, and corruption by noise are prespecified; and (3) demonstrate its application on large-scale data from UK Biobank (<ext-link ext-link-type="uri" xlink:href="https://www.ukbiobank.ac.uk/" id="intref0025">https://www.ukbiobank.ac.uk/</ext-link>).<xref rid="bib24" ref-type="bibr"><sup>24</sup></xref> The numerical analyses serve to establish face validity; the empirical analysis to demonstrate predictive validity. We provide a complete, open-source software implementation of our framework (<ext-link ext-link-type="uri" xlink:href="https://github.com/high-dimensional/geospm" id="intref0030">https://github.com/high-dimensional/geospm</ext-link>), released as an extension to SPM; namely, geospatial SPM or “GeoSPM.” <xref rid="mmc1" ref-type="supplementary-material">Supplemental note S4</xref> and <xref rid="mmc1" ref-type="supplementary-material">Figure S56</xref> provide an overview of GeoSPM’s class structure as implemented in MATLAB.</p>
  </sec>
  <sec id="sec4">
    <title>Experimental procedures</title>
    <sec id="sec4.1">
      <title>Resource availability</title>
      <sec id="sec4.1.1">
        <title>Lead contact</title>
        <p id="p0160">Further information and requests for resources should be directed to and will be fulfilled by the lead contact, Holger Engleitner (<ext-link ext-link-type="uri" xlink:href="mailto:h.engleitner@ucl.ac.uk" id="intref0035">h.engleitner@ucl.ac.uk</ext-link>).</p>
      </sec>
      <sec id="sec4.1.2">
        <title>Materials availability</title>
        <p id="p0165">This study did not generate new unique reagents and did not use any additional materials aside from the data and code cited below.</p>
      </sec>
    </sec>
    <sec id="sec4.2">
      <title>Overview</title>
      <p id="p0170">Our approach builds on the well-established regression analysis framework implemented in SPM12 (<ext-link ext-link-type="uri" xlink:href="http://www.fil.ion.ucl.ac.uk/spm/" id="intref0040">http://www.fil.ion.ucl.ac.uk/spm/</ext-link>), the most widely used platform for spatial inference in brain imaging. Within this framework, a set of explanatory variables is associated with a multivariate, spatially structured response, whose components represent measurements taken at regular locations in a spatial domain. The association between explanatory variables and response is estimated at each location separately, using the same general linear model (GLM). This yields a collection of univariate multiple regression models that share the same model architecture and design matrix but differ in the response variable and the estimated parameter values. Crucially, random fluctuation, or variations in the response variable that are not explained by the GLM, are treated as realizations of a random (spatial) field with certain contiguity or smoothness properties. This is <italic>mass-univariate</italic> inference from a spatial perspective.</p>
      <p id="p0175">A distinguishing feature of SPM is the manner of correcting for multiple comparisons when testing mass-univariate model parameters (i.e., regression coefficients) for significance. The large number of tests, performed simultaneously, gives rise to a proportionally large number of false positives by chance alone. Conversely, the strong spatial correlations among the components of the response violate assumptions of mutual independence, and render simple Bonferroni correction inappropriately strict. SPM applies a more suitable correction by modeling the residuals as a random Gaussian field, so that p values are meaningful in terms of identifying significant peaks and clusters in a discretized spatial domain. Heuristically, topological inference of this kind automatically accounts for spatial dependencies; in the sense that smooth random fluctuations will produce a smaller number of maxima than rough random fields with less spatial dependence (even though the total area above some threshold could be the same). It can be shown that the smoothness of the residual fields is a suitable approximation to the smoothness of a t statistic map derived from the model, which in turn reflects the spatial dependence of the covariates.<xref rid="bib25" ref-type="bibr"><sup>25</sup></xref><sup>,</sup><xref rid="bib26" ref-type="bibr"><sup>26</sup></xref></p>
      <p id="p0180">The kind of data we are concerned with comprise variables of interest observed at locations in a continuous spatial domain <inline-formula><mml:math id="M1" altimg="si5.gif"><mml:mrow><mml:mi>D</mml:mi></mml:mrow></mml:math></inline-formula>. <inline-formula><mml:math id="M2" altimg="si5.gif"><mml:mrow><mml:mi>D</mml:mi></mml:mrow></mml:math></inline-formula> is usually a subset of <inline-formula><mml:math id="M3" altimg="si6.gif"><mml:mrow><mml:msup><mml:mi mathvariant="double-struck">R</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mspace width="0.25em"/></mml:mrow></mml:math></inline-formula> representing coordinates of a geographic space. More precisely, every element in a spatially referenced dataset associates a vector <inline-formula><mml:math id="M4" altimg="si7.gif"><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mspace width="0.25em"/></mml:mrow></mml:math></inline-formula> of <inline-formula><mml:math id="M5" altimg="si8.gif"><mml:mrow><mml:mi>P</mml:mi></mml:mrow></mml:math></inline-formula> variable observations <inline-formula><mml:math id="M6" altimg="si9.gif"><mml:mrow><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>P</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mtext>T</mml:mtext></mml:msup><mml:mo linebreak="goodbreak" linebreakstyle="after">∈</mml:mo><mml:msup><mml:mi mathvariant="double-struck">R</mml:mi><mml:mi>P</mml:mi></mml:msup></mml:mrow></mml:math></inline-formula> with a location <inline-formula><mml:math id="M7" altimg="si10.gif"><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo linebreak="goodbreak" linebreakstyle="after">∈</mml:mo><mml:mi>D</mml:mi></mml:mrow></mml:math></inline-formula>
<disp-formula id="ufd1"><mml:math id="M8" altimg="si11.gif"><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>:</mml:mo><mml:mi>i</mml:mi><mml:mo linebreak="badbreak">=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>N</mml:mi><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p>
      <p id="p0185">SPM typically requires data sampled at regular locations across a grid, spanning the spatial domain. However, we wish to analyze data that are irregularly and sometimes sparsely sampled. This can be resolved by distributing each data point locally—over regular grid locations—using a spatial Gaussian kernel of suitable and fixed variance.</p>
      <p id="p0190">From a data-centric point of view, we can interpret this spatial transformation as estimating the contribution of an individual observation to regular sample points, where the contribution has a maximum value at the observation location and then diminishes with increasing distance. In this way, the dependent variable in the univariate regression at any location of space is essentially a weighting of individual observations according to their proximity to that location: the higher the local response, the closer the observation. We can do this with impunity because we are interested in the explainable differences in these contributions at prespecified (grid point) locations. These explainable differences are assessed with normalized effect sizes (i.e., classical statistics), which are not affected by the total contribution or variance.<xref rid="bib23" ref-type="bibr"><sup>23</sup></xref><sup>,</sup><xref rid="bib27" ref-type="bibr"><sup>27</sup></xref></p>
      <p id="p0195">The chosen variance of the Gaussian kernel is a parameter—hereafter called the <italic>smoothing</italic> parameter—deliberately left open to the analyst to specify the appropriate degree of spatial coarse graining (i.e., spatial smoothness of the data features in question). Since SPM naturally handles volumetric data, we are free to use the third dimension to model multiple smoothing values on a continuous positive scale, rendering them as different spatial “scales” or “features” of a response variable.<xref rid="bib28" ref-type="bibr"><sup>28</sup></xref> Here, two coordinates represent the location in space (i.e., location space), and the third coordinate tracks spatial spread (i.e., scale space), allowing the regression analysis to operate at different scales simultaneously. It is appropriate to permit inference under varied assumptions of uncertainty, allowing the analyst to draw conclusions from the similarities and differences obtained across the range of plausible spatial scales. The analyst is also free to implement mechanisms that select an optimal parameter under some criterion: here we suggest one pragmatic method of doing this. Note that this scale-space implementation of topological inference automatically accounts for dependencies in moving from one scale to another and enables topological inference in terms of maxima or clusters in both location and scale space (i.e., a particular effect can be declared significant at this location and this spatial scale). For simplicity, we will focus on topological inference at a given spatial scale.</p>
      <p id="p0200">Downstream of the above spatial transformation of data features, the statistical approach is formally identical to a standard SPM analysis. The output comprises a series of volumes representing regression coefficients, statistical contrasts derived from these model parameters, the statistical parametric maps—of classical statistics based on these contrasts—and, finally, thresholded binary maps that indicate whether the voxels in the corresponding statistical map are significant at the chosen (suitably corrected) p value.</p>
    </sec>
    <sec id="sec4.3">
      <title>Synthetic data and generative models</title>
      <p id="p0205">The statistical validity of the proposed approach is underwritten by the assumptions on which SPM rests. Nonetheless, it is helpful to examine its construct validity, in comparison with alternative methods (e.g., kriging), and face validity, in terms of its ability to recover known effects in different situations. Such validation is best performed with a known (spatial) ground truth, under manipulations of sampling and noise traversing the plausible space of possibility as far as is practicable. Note, however, that no aspect of the modeling approach—as opposed to its validation—may be allowed to rely on a ground truth, for in topological inference—as opposed to prediction—no ground truth is generally available. We cannot, for example, use a ground truth to tune a hyperparameter without excluding precisely the inferential context we are interested in.</p>
      <p id="p0210">For maximum flexibility and control over the evaluation process, here we use synthetic data drawn from a generative model with a spatially varying distribution of one or two joint binary variables. The spatial variability of the distribution is determined by the locale and extent of shapes with a fractal boundary. Fractals characteristically exhibit detail across an infinite range of spatial scales, which makes them ideal candidates for a spatially structured ground truth with sensitivity to the widest possible range of spatial scales. The use of binary variables to generate two distinct signal levels for the response allows us to focus on data that are generated in a spatially structured way; namely, in a regionally specific fashion under various levels of noise or stochasticity. A full description of the process is provided in <xref rid="mmc1" ref-type="supplementary-material">supplemental note S2</xref>.</p>
    </sec>
    <sec id="sec4.4">
      <title>Demonstration with UK Biobank data</title>
      <p id="p0215">To demonstrate the application of GeoSPM to real data, we chose to explore the potential association between a common disease—type 2 diabetes—and a small number of demographic variables in UK Biobank drawn from the area of Greater Birmingham. It should be stressed that the sole purpose of this analysis was to illustrate the application of the method, not to make inferences about the data itself, which would require more detailed investigation than our foundational focus here permits. The objective instead is to illustrate how spatial variation of a variable of interest may be examined, with specific attention to two important contexts: where the effect of the variable must be isolated from a set of known potential confounders, and where the joint effects of two or more variables are of interest. A detailed description of the variable selection and preprocessing is given in <xref rid="mmc1" ref-type="supplementary-material">supplemental note S2.2</xref>.</p>
    </sec>
    <sec id="sec4.5">
      <title>Numerical experiments</title>
      <sec id="sec4.5.1">
        <title>Kriging</title>
        <p id="p0220">We evaluate GeoSPM in comparison with the well-established multivariate geostatistical method of kriging, described in detail in <xref rid="mmc1" ref-type="supplementary-material">supplemental note S2.3</xref>. All kriging computations were done in R using the gstat package,<xref rid="bib29" ref-type="bibr"><sup>29</sup></xref> which is available at <ext-link ext-link-type="uri" xlink:href="https://cran.r-project.org/web/packages/gstat/index.html" id="intref0045">https://cran.r-project.org/web/packages/gstat/index.html</ext-link>. For each variable of interest kriging produced an image of the predicted mean and an image of the corresponding prediction variance, which is derived solely from the arrangement of positions in the data, i.e., the prediction variance does not depend on the values of the observations, only on their locations.</p>
      </sec>
      <sec id="sec4.5.2">
        <title>Synthetic experiments: Noise parameterization</title>
        <p id="p0225">The numerical face validation experiments are based on three univariate models (snowflake, anti-snowflake, snowflake field) and two bivariate models (snowflake, anti-snowflake) as depicted in <xref rid="mmc1" ref-type="supplementary-material">Figures S2</xref> and <xref rid="mmc1" ref-type="supplementary-material">S3</xref>. For all models, we ran experiments at different sampling levels, <inline-formula><mml:math id="M9" altimg="si12.gif"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>u</mml:mi><mml:mi>n</mml:mi><mml:mi>i</mml:mi><mml:mi>v</mml:mi><mml:mi>a</mml:mi><mml:mi>r</mml:mi><mml:mi>i</mml:mi><mml:mi>a</mml:mi><mml:mi>t</mml:mi><mml:mi>e</mml:mi></mml:mrow></mml:msub><mml:mspace width="0.25em"/><mml:mi>ϵ</mml:mi><mml:mspace width="0.25em"/><mml:mfenced open="{" close="}"><mml:mrow><mml:mn>600</mml:mn><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:mn>1200</mml:mn><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:mn>1800</mml:mn></mml:mrow></mml:mfenced></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="M10" altimg="si13.gif"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>b</mml:mi><mml:mi>i</mml:mi><mml:mi>v</mml:mi><mml:mi>a</mml:mi><mml:mi>r</mml:mi><mml:mi>i</mml:mi><mml:mi>a</mml:mi><mml:mi>t</mml:mi><mml:mi>e</mml:mi></mml:mrow></mml:msub><mml:mspace width="0.25em"/><mml:mi>ϵ</mml:mi><mml:mspace width="0.25em"/><mml:mfenced open="{" close="}"><mml:mrow><mml:mn>1600</mml:mn><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:mn>3200</mml:mn></mml:mrow></mml:mfenced></mml:mrow></mml:math></inline-formula>, and increased the noise parameter <inline-formula><mml:math id="M11" altimg="si14.gif"><mml:mrow><mml:mi>γ</mml:mi></mml:mrow></mml:math></inline-formula> from <inline-formula><mml:math id="M12" altimg="si15.gif"><mml:mrow><mml:mn>0.0</mml:mn></mml:mrow></mml:math></inline-formula> to <inline-formula><mml:math id="M13" altimg="si16.gif"><mml:mrow><mml:mn>0.35</mml:mn></mml:mrow></mml:math></inline-formula> in <inline-formula><mml:math id="M14" altimg="si17.gif"><mml:mrow><mml:mn>0.01</mml:mn></mml:mrow></mml:math></inline-formula> increments (<xref rid="fig1" ref-type="fig">Figure 1</xref>). For each triplet (model, <inline-formula><mml:math id="M15" altimg="si18.gif"><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="M16" altimg="si14.gif"><mml:mrow><mml:mi>γ</mml:mi></mml:mrow></mml:math></inline-formula>), 10 independent datasets were randomly generated.<fig id="fig1"><label>Figure 1</label><caption><p>Sampling levels (noise-free, <inline-formula><mml:math id="M17" altimg="si36.gif"><mml:mrow><mml:mi>γ</mml:mi><mml:mo linebreak="goodbreak" linebreakstyle="after">=</mml:mo><mml:mspace width="0.25em"/><mml:mn>0.0</mml:mn></mml:mrow></mml:math></inline-formula>) for the univariate models on the left (<inline-formula><mml:math id="M18" altimg="si37.gif"><mml:mrow><mml:mi>N</mml:mi><mml:mspace width="0.25em"/><mml:mo linebreak="goodbreak" linebreakstyle="after">=</mml:mo><mml:mspace width="0.25em"/><mml:mn>600</mml:mn><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:mn>1200</mml:mn><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:mn>1800</mml:mn></mml:mrow></mml:math></inline-formula>), and for the bivariate models on the right (<inline-formula><mml:math id="M19" altimg="si38.gif"><mml:mrow><mml:mi>N</mml:mi><mml:mspace width="0.25em"/><mml:mo linebreak="goodbreak" linebreakstyle="after">=</mml:mo><mml:mspace width="0.25em"/><mml:mn>1600</mml:mn><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:mn>3200</mml:mn></mml:mrow></mml:math></inline-formula>)</p></caption><graphic xlink:href="gr1"/></fig></p>
        <p id="p0230">Each generated dataset was processed by GeoSPM as well as gstat. For GeoSPM, the spread of the spatial response at locations <inline-formula><mml:math id="M20" altimg="si19.gif"><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>, i.e., the spatial distribution of the response following smoothing, was modeled at increasing smoothing parameter values (<inline-formula><mml:math id="M21" altimg="si20.gif"><mml:mrow><mml:mi>ℓ</mml:mi><mml:mspace width="0.25em"/><mml:mo linebreak="goodbreak" linebreakstyle="after">=</mml:mo><mml:mspace width="0.25em"/><mml:mn>10</mml:mn></mml:mrow></mml:math></inline-formula>) using the 95% iso-density diameters of the bivariate normal distribution, <inline-formula><mml:math id="M22" altimg="si21.gif"><mml:mrow><mml:mi mathvariant="bold-italic">s</mml:mi><mml:mo linebreak="goodbreak" linebreakstyle="after">=</mml:mo><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mn>10</mml:mn><mml:mo>,</mml:mo><mml:mn>15</mml:mn><mml:mo>,</mml:mo><mml:mn>20</mml:mn><mml:mo>,</mml:mo><mml:mn>25</mml:mn><mml:mo>,</mml:mo><mml:mn>30</mml:mn><mml:mo>,</mml:mo><mml:mn>35</mml:mn><mml:mo>,</mml:mo><mml:mn>40</mml:mn><mml:mo>,</mml:mo><mml:mn>45</mml:mn><mml:mo>,</mml:mo><mml:mn>50</mml:mn><mml:mo>,</mml:mo><mml:mn>55</mml:mn><mml:mo>,</mml:mo><mml:mn>60</mml:mn><mml:mo>)</mml:mo></mml:mrow><mml:mtext>T</mml:mtext></mml:msup></mml:mrow></mml:math></inline-formula>. This measure of spread is the diameter of a circle that contains 95% of the probability mass of a two-dimensional Gaussian distribution at its center. The largest value of the smoothing parameter, 60, was chosen to be half the height of the grid for the univariate models. The regression coefficients estimated by GeoSPM were tested using a one-tailed t test at p &lt; 0.05 FWE (voxel-level, family-wise correction), producing a stack of <inline-formula><mml:math id="M23" altimg="si22.gif"><mml:mrow><mml:mi>ℓ</mml:mi></mml:mrow></mml:math></inline-formula> binary maps of significant areas for every variable of interest. To derive corresponding maps—one per variable—for kriging, we compared a standardized form of the kriging prediction <inline-formula><mml:math id="M24" altimg="si23.gif"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>y</mml:mi><mml:mo>ˆ</mml:mo></mml:mover><mml:mrow><mml:mi>s</mml:mi><mml:mi>t</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> with the critical value of the upper tail probability p &lt; 0.05 of the normal distribution. We standardized <inline-formula><mml:math id="M25" altimg="si24.gif"><mml:mrow><mml:mover accent="true"><mml:mi>y</mml:mi><mml:mo>ˆ</mml:mo></mml:mover><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> at each grid cell <inline-formula><mml:math id="M26" altimg="si25.gif"><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> using its estimated (positional) variance <inline-formula><mml:math id="M27" altimg="si26.gif"><mml:mrow><mml:mover accent="true"><mml:mi>σ</mml:mi><mml:mo>ˆ</mml:mo></mml:mover><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> and assuming a null mean of <inline-formula><mml:math id="M28" altimg="si27.gif"><mml:mrow><mml:mn>0.5</mml:mn></mml:mrow></mml:math></inline-formula> to produce <inline-formula><mml:math id="M29" altimg="si23.gif"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>y</mml:mi><mml:mo>ˆ</mml:mo></mml:mover><mml:mrow><mml:mi>s</mml:mi><mml:mi>t</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>:<disp-formula id="ufd2"><mml:math id="M30" altimg="si28.gif"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>y</mml:mi><mml:mo>ˆ</mml:mo></mml:mover><mml:mrow><mml:mi>s</mml:mi><mml:mi>t</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo linebreak="badbreak">=</mml:mo><mml:mfrac><mml:mrow><mml:mover accent="true"><mml:mi>y</mml:mi><mml:mo>ˆ</mml:mo></mml:mover><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>–</mml:mo><mml:msub><mml:mtext>μ</mml:mtext><mml:mrow><mml:mi>n</mml:mi><mml:mi>u</mml:mi><mml:mi>l</mml:mi><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mover accent="true"><mml:mi>σ</mml:mi><mml:mo>ˆ</mml:mo></mml:mover><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mo>,</mml:mo><mml:mi>w</mml:mi><mml:mi>h</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo linebreak="goodbreak">∈</mml:mo><mml:msup><mml:mi>D</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mi>u</mml:mi><mml:mi>l</mml:mi><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo linebreak="goodbreak">=</mml:mo><mml:mn>0.5</mml:mn><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p>
        <p id="p0235">For a fair comparison with kriging, one of the <inline-formula><mml:math id="M31" altimg="si22.gif"><mml:mrow><mml:mi>ℓ</mml:mi></mml:mrow></mml:math></inline-formula> smoothing values and its associated maps produced in a run of GeoSPM had to be chosen. We based this choice on maximizing the spatial coverage by the significant areas at each spatial scale (see <xref rid="fig2" ref-type="fig">Figure 2</xref>), while minimizing the spatial overlap between them. A spatial condition in the context of the observed variables <inline-formula><mml:math id="M32" altimg="si29.gif"><mml:mrow><mml:mi mathvariant="bold-italic">Y</mml:mi><mml:mo linebreak="goodbreak" linebreakstyle="after">∈</mml:mo><mml:msup><mml:mi mathvariant="double-struck">R</mml:mi><mml:mi>P</mml:mi></mml:msup></mml:mrow></mml:math></inline-formula> in our models is obtained by applying a threshold of <inline-formula><mml:math id="M33" altimg="si27.gif"><mml:mrow><mml:mn>0.5</mml:mn></mml:mrow></mml:math></inline-formula> to all observations, recording as 1 if an observed variable value exceeds the threshold or 0 if it does not. Each observation of a univariate model can thus be assigned one of two spatial conditions, or one of four conditions in the case of a bivariate model. We obtain the significant areas for each spatial condition by running a separate analysis in GeoSPM on a set of data that represents the spatial condition of each observation as a one-hot encoding, i.e., with each category represented as a set of binary dummy variables.<fig id="fig2"><label>Figure 2</label><caption><p>Example of a coverage computation for an instance of the bivariate snowflake model with noise <inline-formula><mml:math id="M34" altimg="si56.gif"><mml:mrow><mml:mi>γ</mml:mi><mml:mspace width="0.25em"/><mml:mo>=</mml:mo><mml:mspace width="0.25em"/><mml:mn>0.1</mml:mn></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="M35" altimg="si55.gif"><mml:mrow><mml:mi>N</mml:mi><mml:mspace width="0.25em"/><mml:mo>=</mml:mo><mml:mn>1600</mml:mn></mml:mrow></mml:math></inline-formula></p><p>For each value <inline-formula><mml:math id="M36" altimg="si54.gif"><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:math></inline-formula> of the smoothing parameter, the combined significant areas for all four spatial conditions <inline-formula><mml:math id="M37" altimg="si40.gif"><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mi>Z</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo linebreak="goodbreak" linebreakstyle="after">∈</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:mn>0</mml:mn><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:mrow><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:mn>0</mml:mn><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:mrow><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:mrow><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> as determined by a separate run of GeoSPM are shaded in light gray. The maximum number of significant grid cells is obtained for <inline-formula><mml:math id="M38" altimg="si39.gif"><mml:mrow><mml:mi>s</mml:mi><mml:mspace width="0.25em"/><mml:mo>=</mml:mo><mml:mspace width="0.25em"/><mml:mn>40</mml:mn></mml:mrow></mml:math></inline-formula>, highlighted in red.</p></caption><graphic xlink:href="gr2"/></fig></p>
        <p id="p0240">This approach enabled us to derive a score for each of the <inline-formula><mml:math id="M39" altimg="si22.gif"><mml:mrow><mml:mi>ℓ</mml:mi></mml:mrow></mml:math></inline-formula> smoothing values, which simply comprised the total number of significant grid cells that appeared for exactly one of the spatial conditions, thereby ignoring any overlap. The smoothing value with the highest score was selected, together with the binary maps of significant areas computed from it. Ties were broken by choosing the smallest scale.</p>
        <p id="p0245">The binary maps for each variable were assessed relative to their respective target maps, which were derived by thresholding the corresponding marginal distribution of the model, adding grid cells with a probability greater than <inline-formula><mml:math id="M40" altimg="si27.gif"><mml:mrow><mml:mn>0.5</mml:mn></mml:mrow></mml:math></inline-formula> to the target. We applied a number of representative image segmentation metrics to each pair of maps, computing a mean score over the 10 repetitions of each unique triplet (model, <inline-formula><mml:math id="M41" altimg="si18.gif"><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="M42" altimg="si14.gif"><mml:mrow><mml:mi>γ</mml:mi></mml:mrow></mml:math></inline-formula>) and variable. The following metrics were used<xref rid="bib30" ref-type="bibr"><sup>30</sup></xref><sup>,</sup><xref rid="bib31" ref-type="bibr"><sup>31</sup></xref>: Jaccard index, Dice score, Matthew’s correlation coefficient, symmetric uncertainty and the modified Hausdorff distance (as a fraction of the length of the model diagonal). The mean score and deviation for each metric and computation method were aggregated into the plots reported below.</p>
      </sec>
      <sec id="sec4.5.3">
        <title>Numerical experiments: Interaction parameterization</title>
        <p id="p0250">These experiments used the snowflake interaction model above and comprise observations of its variables, augmented by an interaction term. The interaction term is formed in the usual manner, by multiplying the observed values for both variables, yielding augmented observations: <inline-formula><mml:math id="M43" altimg="si30.gif"><mml:mrow><mml:msup><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mspace width="0.25em"/><mml:mo linebreak="goodbreak" linebreakstyle="after">=</mml:mo><mml:mspace width="0.25em"/><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo linebreak="badbreak">·</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mtext>T</mml:mtext></mml:msup></mml:mrow></mml:math></inline-formula>. The regional arrangement of the model is the same as the one employed for the bivariate snowflake model shown on the left of <xref rid="mmc1" ref-type="supplementary-material">Figure S2</xref>. A single sampling level <inline-formula><mml:math id="M44" altimg="si31.gif"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mi>t</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mi>a</mml:mi><mml:mi>c</mml:mi><mml:mi>t</mml:mi><mml:mi>i</mml:mi><mml:mi>o</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo linebreak="goodbreak" linebreakstyle="after">=</mml:mo><mml:mn>15000</mml:mn></mml:mrow></mml:math></inline-formula> was used and the interaction parameter <inline-formula><mml:math id="M45" altimg="si1.gif"><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> was increased from <inline-formula><mml:math id="M46" altimg="si32.gif"><mml:mrow><mml:mn>0.25</mml:mn></mml:mrow></mml:math></inline-formula> to <inline-formula><mml:math id="M47" altimg="si27.gif"><mml:mrow><mml:mn>0.5</mml:mn></mml:mrow></mml:math></inline-formula> in steps of <inline-formula><mml:math id="M48" altimg="si33.gif"><mml:mrow><mml:mn>0.05</mml:mn></mml:mrow></mml:math></inline-formula>. For each level of <inline-formula><mml:math id="M49" altimg="si1.gif"><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="M50" altimg="si34.gif"><mml:mrow><mml:mi>R</mml:mi><mml:mspace width="0.25em"/><mml:mo linebreak="goodbreak" linebreakstyle="after">=</mml:mo><mml:mspace width="0.25em"/><mml:mn>10</mml:mn><mml:mspace width="0.25em"/></mml:mrow></mml:math></inline-formula> independent datasets were randomly generated. We set a single value for the smoothing parameter <inline-formula><mml:math id="M51" altimg="si35.gif"><mml:mrow><mml:mi>s</mml:mi><mml:mo linebreak="goodbreak" linebreakstyle="after">=</mml:mo><mml:mn>60</mml:mn></mml:mrow></mml:math></inline-formula>, which was the highest value for the noise experiments. As before, a one-tailed t test at p &lt; 0.05 FWE (voxel-level family-wise correction) determined areas of significance and the same set of image segmentation metrics was computed for the binary maps.</p>
      </sec>
      <sec id="sec4.5.4">
        <title>UK Biobank experiments</title>
        <p id="p0255">Results for the UK Biobank data were obtained by a single invocation of GeoSPM for each of the four models listed in <xref rid="mmc1" ref-type="supplementary-material">Table S6</xref>. We choose a smoothing value of 7 km, specified as the diameter of a patch enclosing 95% of the density the bivariate normal distribution with equal variances. This represents 20% of the width and height of our Birmingham analysis area, and seemed appropriate for identifying local variation sensitive to the plausible spatial scale of distinct geographically defined communities. This time, a two-tailed t test at p &lt; 0.05 FWE (voxel-level family-wise correction) was used for thresholding the statistic maps. Analysis is restricted to areas where the combined smoothing density of all observations is at least 10 times the kernel peak value.</p>
      </sec>
      <sec id="sec4.5.5">
        <title>Ethical approval</title>
        <p id="p0260">UK Biobank has approval from the North West Multi-centre Research Ethics Committee as a Research Tissue Bank (RTB) approval. This approval means that researchers do not require separate ethical clearance and can operate under the RTB approval.</p>
      </sec>
    </sec>
  </sec>
  <sec id="sec2">
    <title>Results</title>
    <p id="p0075">Our numerical experiments with a known generative model enabled us to measure performance against a known ground truth under circumstances varying in density of sampling and contamination with noise, enclosing the range likely to obtain in real-world scenarios. It also permits robust evaluation of graded interaction effects. In total, 2,160 independent simulations with synthetic data were performed for the univariate models, 1,440 for the bivariate models and 60 for the interaction model. Summarizing scores within the three sets of simulations, we derive performance curves for GeoSPM and kriging solutions in each case. We then proceed to illustrate the application of GeoSPM to real world data from UK Biobank.</p>
    <sec id="sec2.1">
      <title>Synthetic models</title>
      <p id="p0080">Displayed in the following figures are sets of independent simulations comparing the performance of GeoSPM (in yellow) versus kriging (in green) as a function of contaminating noise, measured by five different indices of retrieval fidelity, using the snowflake (<xref rid="fig3" ref-type="fig">Figure 3</xref>) or anti-snowflake (<xref rid="fig4" ref-type="fig">Figure 4</xref>) bivariate ground truths, and low or high data sampling regimes (similar results for the univariate ground truths are reported in <xref rid="mmc1" ref-type="supplementary-material">Figures S7–S9</xref> in <xref rid="mmc1" ref-type="supplementary-material">supplemental note S3.1</xref>, as are the results for the second term in the bivariate models in <xref rid="mmc1" ref-type="supplementary-material">Figures S10</xref> and <xref rid="mmc1" ref-type="supplementary-material">S11</xref> of <xref rid="mmc1" ref-type="supplementary-material">supplemental note S3.2</xref>). A visual summary of the recovered binary maps underlying these performance curves—for the bivariate snowflake model and the high sampling regime—affords a further qualitative comparison between the two methods (<xref rid="fig5" ref-type="fig">Figure 5</xref>).<fig id="fig3"><label>Figure 3</label><caption><p>Synthetic snowflake models: recovery scores for GeoSPM and kriging of model term <inline-formula><mml:math id="M52" altimg="si3.gif"><mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> in the low (<italic>N</italic> = 1600) and high (<italic>N</italic> = 3200) sampling regimes</p><p>Lines denote the mean score across 10 random model realizations, shaded areas its SD to either side of the mean. Areas of overlapping performance are identified by additive shading. GeoSPM degrades more slowly and gracefully as noise increases compared with kriging. Comparable results for model term <inline-formula><mml:math id="M53" altimg="si41.gif"><mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> are shown in <xref rid="mmc1" ref-type="supplementary-material">Figure S10</xref>.</p></caption><graphic xlink:href="gr3"/></fig><fig id="fig4"><label>Figure 4</label><caption><p>Synthetic anti-snowflake models: recovery scores for GeoSPM and kriging of model term <inline-formula><mml:math id="M54" altimg="si3.gif"><mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> in the low (<italic>N</italic> = 1600) and high (<italic>N</italic> = 3200) sampling regime</p><p>Lines denote the mean score across 10 random model realizations, shaded areas its SD to either side of the mean. Areas of overlapping performance are identified by additive shading. As is the case with the snowflake models, GeoSPM degrades more slowly and gracefully as noise increases compared with kriging. Comparable results for model term <inline-formula><mml:math id="M55" altimg="si41.gif"><mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> are shown in <xref rid="mmc1" ref-type="supplementary-material">Figure S11</xref>.</p></caption><graphic xlink:href="gr4"/></fig><fig id="fig5"><label>Figure 5</label><caption><p>Recoveries of variable <inline-formula><mml:math id="M56" altimg="si3.gif"><mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> in the synthetic bivariate snowflake model across <inline-formula><mml:math id="M57" altimg="si42.gif"><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:math></inline-formula> = 10 repetitions for GeoSPM in the top row and kriging with a Matérn kernel and nugget component in the bottom row, both in the high sampling regime (<inline-formula><mml:math id="M58" altimg="si18.gif"><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:math></inline-formula> = 3200)</p><p>Grid cells that lie in the target region are shown in white, those outside in gray. The number of significant tests out of 10 repetitions is superimposed in color for each grid cell: dark blue indicates at least one significant test and dark red indicates the maximum number of 10, while cells with no significant test did not receive any color. Kriging only produces recoveries up to a <inline-formula><mml:math id="M59" altimg="si14.gif"><mml:mrow><mml:mi>γ</mml:mi></mml:mrow></mml:math></inline-formula> value of 0.10, whereas GeoSPM still produces recoveries for much higher values of <inline-formula><mml:math id="M60" altimg="si14.gif"><mml:mrow><mml:mi>γ</mml:mi></mml:mrow></mml:math></inline-formula>. GeoSPM used t tests with a family-wise error corrected p value of 0.05, for kriging we applied a z-test with an uncorrected p value of 0.05, a null mean of 0.5 and a sample deviation obtained from the (positional) kriging variance estimate, as described in the section on “synthetic experiments: noise parameterization”. Additional kriging recoveries are shown in <xref rid="mmc1" ref-type="supplementary-material">Figures S21–S25</xref> of <xref rid="mmc1" ref-type="supplementary-material">supplemental note S3.5</xref>.</p></caption><graphic xlink:href="gr5"/></fig></p>
      <p id="p0085">It is evident that GeoSPM offers superior efficiency across most of the noise range in all models and on all metrics. GeoSPM models generally remain stable at higher levels of noise than kriging. Both GeoSPM and kriging exhibit sensitivity to the sampling regime, both in terms of variability and stability, but the effects are dwarfed by the difference between the two approaches. The type of ground truth has negligible impact. In addition, neither changing the (cross-) covariance function used for kriging from a Matérn function to a Gaussian nor applying a different regime for dealing with coincident observations—such as averaging—yields a discernible improvement to the performance of kriging in this context (see <xref rid="mmc1" ref-type="supplementary-material">Figure S12</xref> in <xref rid="mmc1" ref-type="supplementary-material">supplemental note S3.3</xref>).</p>
      <p id="p0090">Additional results based on an extended selection of covariance models for kriging show comparable outcomes and are similar to those presented in <xref rid="fig3" ref-type="fig">Figures 3</xref>, <xref rid="fig4" ref-type="fig">4</xref>, and <xref rid="fig5" ref-type="fig">5</xref>, as documented in <xref rid="mmc1" ref-type="supplementary-material">Figures S13–S20</xref> in <xref rid="mmc1" ref-type="supplementary-material">supplemental note S3.4</xref> and <xref rid="mmc1" ref-type="supplementary-material">Figures S21–S25</xref> in <xref rid="mmc1" ref-type="supplementary-material">supplemental note S3.5</xref>. For a more in-depth view of the behavior of kriging parameters and variograms, refer to <xref rid="mmc1" ref-type="supplementary-material">supplemental note S3.6</xref> and <xref rid="mmc1" ref-type="supplementary-material">S3.7</xref>.</p>
      <p id="p0095">The recoveries obtained from simulations of the interaction model clearly show GeoSPM’s ability to detect an interaction between two spatially distributed factors, even toward the lower end of the approximate interaction effect size range (<xref rid="fig6" ref-type="fig">Figure 6</xref>). Plots of the same five indices above demonstrate successful retrieval for these interaction simulations quantitatively (<xref rid="fig7" ref-type="fig">Figure 7</xref>). As we increase the size of the approximate interaction effect <inline-formula><mml:math id="M61" altimg="si1.gif"><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>, retrieval results for the interaction term <inline-formula><mml:math id="M62" altimg="si2.gif"><mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo linebreak="goodbreak" linebreakstyle="after">×</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mi>Z</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> approach those of the previous, noise-free bivariate snowflake model (setting aside the different sampling regimes). At the same time, recovery for variable <inline-formula><mml:math id="M63" altimg="si3.gif"><mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> decreases in the interaction region <inline-formula><mml:math id="M64" altimg="si4.gif"><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> (but not elsewhere), as the interaction term explains more variance. Once the recovery for variable <inline-formula><mml:math id="M65" altimg="si3.gif"><mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> in region <inline-formula><mml:math id="M66" altimg="si4.gif"><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> has vanished, the corresponding retrieval scores are about half of those for the same term in the noise-free model, which agrees with our expectation, because only one of two snowflake shapes in the target are still retrieved at that stage.<fig id="fig6"><label>Figure 6</label><caption><p>Recoveries produced by GeoSPM for the synthetic interaction model across <inline-formula><mml:math id="M67" altimg="si42.gif"><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:math></inline-formula> = 10 repetitions for variable <inline-formula><mml:math id="M68" altimg="si3.gif"><mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> in the top row and term <inline-formula><mml:math id="M69" altimg="si2.gif"><mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo linebreak="goodbreak" linebreakstyle="after">×</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mi>Z</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> in the bottom row, with <italic>N</italic> = 15,000 samples</p><p>Grid cells that lie in the target region are shown in white, those outside in gray. The number of significant tests out of 10 repetitions is superimposed in color for each grid cell: dark blue indicates at least one significant test and dark red indicates the maximum number of 10, while cells with no significant test did not receive any color. Starting with a low value for the interaction effect <inline-formula><mml:math id="M70" altimg="si1.gif"><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> on the left, recovery of the interaction term <inline-formula><mml:math id="M71" altimg="si2.gif"><mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo linebreak="goodbreak" linebreakstyle="after">×</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mi>Z</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> in region <inline-formula><mml:math id="M72" altimg="si4.gif"><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> is weak, while recovery for variable <inline-formula><mml:math id="M73" altimg="si3.gif"><mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> in the same region is stronger. This correlates with the fact that observations <inline-formula><mml:math id="M74" altimg="si43.gif"><mml:mrow><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:math></inline-formula> occur with only a slightly elevated probability <inline-formula><mml:math id="M75" altimg="si44.gif"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:mo linebreak="goodbreak" linebreakstyle="after">=</mml:mo><mml:mn>0.6</mml:mn></mml:mrow></mml:math></inline-formula> compared with their null probability of <inline-formula><mml:math id="M76" altimg="si45.gif"><mml:mrow><mml:mn>0.525</mml:mn></mml:mrow></mml:math></inline-formula> when <inline-formula><mml:math id="M77" altimg="si1.gif"><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> equals <inline-formula><mml:math id="M78" altimg="si46.gif"><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> in the same setting. As <inline-formula><mml:math id="M79" altimg="si1.gif"><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> increases toward the right, recovery in the same region for term <inline-formula><mml:math id="M80" altimg="si2.gif"><mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo linebreak="goodbreak" linebreakstyle="after">×</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mi>Z</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> increases (<inline-formula><mml:math id="M81" altimg="si47.gif"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:mo linebreak="goodbreak" linebreakstyle="after">=</mml:mo><mml:mn>0.725</mml:mn></mml:mrow></mml:math></inline-formula> at the right), while recovery for variable <inline-formula><mml:math id="M82" altimg="si3.gif"><mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> decreases (probability <inline-formula><mml:math id="M83" altimg="si48.gif"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo linebreak="goodbreak" linebreakstyle="after">=</mml:mo><mml:mn>0.125</mml:mn><mml:mspace width="0.25em"/></mml:mrow></mml:math></inline-formula> at the right for observing <inline-formula><mml:math id="M84" altimg="si49.gif"><mml:mrow><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:mn>0</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:math></inline-formula>, which is half of what it would be if there was no interaction effect). GeoSPM used t tests with a family-wise error corrected p value of 0.05.</p></caption><graphic xlink:href="gr6"/></fig><fig id="fig7"><label>Figure 7</label><caption><p>Synthetic snowflake interaction model: recovery scores for SPM model variable <inline-formula><mml:math id="M85" altimg="si3.gif"><mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> and term <inline-formula><mml:math id="M86" altimg="si2.gif"><mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo linebreak="goodbreak" linebreakstyle="after">×</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mi>Z</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> with <italic>N</italic> = 15,000 samples</p><p>Lines denote the mean score across 10 random model realizations, shaded areas its SD to either side of the mean. We increase the approximate interaction effect in region <inline-formula><mml:math id="M87" altimg="si4.gif"><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> of the grid from left to right, so that the probability of observing <inline-formula><mml:math id="M88" altimg="si43.gif"><mml:mrow><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:math></inline-formula> grows while the probability of observing <inline-formula><mml:math id="M89" altimg="si49.gif"><mml:mrow><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:mn>0</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:math></inline-formula> or <inline-formula><mml:math id="M90" altimg="si50.gif"><mml:mrow><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:math></inline-formula> shrinks (the probability of observing <inline-formula><mml:math id="M91" altimg="si51.gif"><mml:mrow><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:mn>0</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:math></inline-formula> stays the same). As a result, scores increase for the interaction term <inline-formula><mml:math id="M92" altimg="si2.gif"><mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo linebreak="goodbreak" linebreakstyle="after">×</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mi>Z</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> as it captures more of the overall variance, whereas scores for variable <inline-formula><mml:math id="M93" altimg="si3.gif"><mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> decrease, until the only significant recovery occurs in region <inline-formula><mml:math id="M94" altimg="si52.gif"><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>, which represents half of the target for <inline-formula><mml:math id="M95" altimg="si3.gif"><mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> and explains why the overall decrease saturates.</p></caption><graphic xlink:href="gr7"/></fig></p>
    </sec>
    <sec id="sec2.2">
      <title>UK Biobank models</title>
      <p id="p0100">In real-world scenarios there is usually no explicit ground truth against which an inference can be tested: the conclusion rests on the integrity of the underlying statistical assumptions. Our illustrative analysis of UK Biobank data<xref rid="bib24" ref-type="bibr"><sup>24</sup></xref> therefore does not seek to quantify GeoSPM’s fidelity but to demonstrate its potential utility in the medical realm. We focus on two aspects: the derivation of marginalized spatial maps that disentangle a factor of interest from a set of (interacting) confounders, and the use of conjunction analysis to identify regions jointly modulated by multiple spatially organized factors.</p>
      <p id="p0105">The propensity to develop type 2 diabetes is related to age, sex, BMI, and household income, among other factors: a known pattern clearly replicated in UK Biobank. A map of diabetes may therefore reflect not just the propensity to develop the disease but also the spatial structure of associated factors, both causal and incidental. If we are pursuing a previously unknown spatial factor—pollution, for example,<xref rid="bib32" ref-type="bibr"><sup>32</sup></xref><sup>,</sup><xref rid="bib33" ref-type="bibr"><sup>33</sup></xref><sup>,</sup><xref rid="bib34" ref-type="bibr"><sup>34</sup></xref>—we would wish to void our diabetes map of known confounders, yielding a spatial distribution of fully marginalized propensity.</p>
      <p id="p0110">We demonstrate GeoSPM on individual-level UK Biobank data drawn from Birmingham. <xref rid="fig8" ref-type="fig">Figure 8</xref> presents the regression coefficient maps and significant t test areas for four separate models of diabetes with incrementally greater numbers of covariates. The first, univariate, model of diabetes (model 1) reveals an extensive concentric organization, positive in the center and negative in the periphery, especially in the north and south. The map becomes more tightly circumscribed with the addition of sex, age, and BMI in model 2: the two negative areas in the north and south are no longer significant, and a stronger negative region emerges west of the center. With the addition of further covariates and their interactions, the spatial structure of diabetes that remains unexplained converges on a set of focal, central regions, displayed in detail in comparison with the univariate model in <xref rid="fig9" ref-type="fig">Figure 9</xref>. Here the regional expression of diabetes is not explained by the modeled covariates, suggesting the presence of other factors in play to be subsequently investigated. In general, the ensemble of significant areas for each model indicates the spatial structure that remains unexplained for the corresponding set of covariates, while the intensity and sign of each regression coefficient map represent the degree of spatial association of its covariate in the ensemble. With this in mind, the individual maps for diabetes represent a spatial distribution of propensity marginalized against the other covariates, but not an absolute rate of disease.<fig id="fig8"><label>Figure 8</label><caption><p>GeoSPM results for the four UK Biobank models of Birmingham (one column per model)</p><p>Geographic regression coefficient maps are shown with outlines of significant areas in the corresponding two-tailed t test at p &lt; 0.05 FWE (voxel-level family-wise correction). The smoothing parameter value is 7,000 m.</p></caption><graphic xlink:href="gr8"/></fig><fig id="fig9"><label>Figure 9</label><caption><p>Geographic regression coefficient maps with location names for a single run of UK Biobank models 1 and 4</p><p>Model 1 is a univariate model of diabetes, model 4 adds sex, age, BMI, household income, and an interaction term BMI × household income. Outlines show significant areas in the corresponding two-tailed t test at p &lt; 0.05 FWE (voxel-level family-wise correction). The smoothing parameter value is 7,000 m. The color map scale is the same as in <xref rid="fig8" ref-type="fig">Figure 8</xref>.</p></caption><graphic xlink:href="gr9"/></fig></p>
      <p id="p0115">We can now also examine the <italic>conjunctions</italic> of multiple maps, not necessarily derived from the same model, within a second-level analysis. Conjunctions are here simply the intersections of two or more thresholded t maps, identifying areas where the regression coefficients and their associated variables are jointly significant. Applied to the outputs of our most complex model above, the approach and resulting conjunctions are shown in <xref rid="fig10" ref-type="fig">Figure 10</xref>. Pairwise conjunctions show a single region where diabetes and male sex are colocalized; a distinct region where diabetes and age are inversely associated; a very narrow region with an inverse relation between diabetes and BMI; and a single region where diabetes is inversely related to household income. Finally, a three-way conjunction identifies a region where diabetes is spatially associated with younger age, male sex, and lower income (<xref rid="fig11" ref-type="fig">Figure 11</xref>). Such conjunction maps identify regions where two or more variables of interest are significantly expressed together, representing subpopulations whose intersectionally characteristic features may inform responsive action or further investigation.<fig id="fig10"><label>Figure 10</label><caption><p>Binary conjunctions of geographic regression significance maps for a single run of UK Biobank model 4</p><p>A binary conjunction is formed of the significant areas of a two-tailed t test at p &lt; 0.05 FWE (voxel-level family-wise correction) between type 2 diabetes and, in turn, sex, age, BMI, household income, and BMI <inline-formula><mml:math id="M96" altimg="si53.gif"><mml:mrow><mml:mo linebreak="goodbreak" linebreakstyle="after">×</mml:mo></mml:mrow></mml:math></inline-formula> household income. Purple outlines show significant areas in the two-tailed t test of each variable, green outlines show significant areas of conjunction: significant areas of conjunction arise in diabetes combined with each of sex (male), age (younger than 56.6 years), BMI (below 27.9 kg/m<sup>2</sup>), and household income (below £35,015). No significant areas of conjunction exist for diabetes and BMI <inline-formula><mml:math id="M97" altimg="si53.gif"><mml:mrow><mml:mo linebreak="goodbreak" linebreakstyle="after">×</mml:mo></mml:mrow></mml:math></inline-formula> household income. Locations shown in darker gray tone are not significant for any of the variables. The smoothing parameter value is 7,000 m.</p></caption><graphic xlink:href="gr10"/></fig><fig id="fig11"><label>Figure 11</label><caption><p>Example of a multiple conjunction (here quaternary) of geographic regression significance maps for a single run of UK Biobank model 4</p><p>A binary conjunction is formed of the significant areas of a two-tailed t test at p &lt; 0.05 FWE (voxel-level family-wise correction) between type 2 diabetes and, in turn, sex, age, BMI, household income, and BMI <inline-formula><mml:math id="M98" altimg="si53.gif"><mml:mrow><mml:mo linebreak="goodbreak" linebreakstyle="after">×</mml:mo></mml:mrow></mml:math></inline-formula> household income. Purple outlines show significant areas in the two-tailed t test of each variable, green outlines show significant areas of conjunction: we can identify a significant area where younger males of lower income are associated with having type 2 diabetes in Birmingham. The smoothing parameter value is 7,000 m.</p></caption><graphic xlink:href="gr11"/></fig></p>
      <p id="p0120">This concludes our illustration of GeoSPM. Note that the fact that GeoSPM was able to identify significant regionally specific effects provides a provisional form of predictive validity; under the assumption that these effects were present in the population—and could therefore be used to predict response variables.</p>
    </sec>
  </sec>
  <sec id="sec3">
    <title>Discussion</title>
    <p id="p0125">We propose, implement, and validate an approach to drawing spatial inferences from sparse clinical data, extending to geostatistics a mature, principled framework for topological inference—SPM—that is well established in the realm of brain imaging. Compared with kriging, GeoSPM combines similar fidelity under optimal conditions with substantially less sensitivity to noise and under-sampling, greater robustness to failure, faster computation, graceful handling of multiple scales of spatial variation, and formal inferential support. Its simplicity and accessibility facilitate widespread application of the comprehensive software implementation we have provided, built on the validated SPM open-source codebase, across a wide range of applications in medicine and beyond. Here, we consider six points concerning the application, extension, and limitations of our approach.</p>
    <p id="p0130">First, GeoSPM is applicable to problems of topological spatial inference, whose formulation conforms to the minimal assumptions of the underlying statistical framework. The types of data, the choice of model evaluated at each point, and the size and density of the evaluated grid are not under any strong constraint. Eliminating the spatial dimension allows each point-wise model to be more flexible than the data or computational resource could otherwise sustain. The model could even be complicated spatially, extending to encompass a local patch within otherwise the same framework. This is a key strength in medical applications, where a spatial effect typically needs to be disentangled from a wide array of others.</p>
    <p id="p0135">Second, although here prototyped on temporally stationary data, GeoSPM can be configured with time instead of the spatial scale in the third dimension, enabling graceful modeling of both spatial and temporal correlations. This has been used, for example, in the context of electrophysiology<xref rid="bib35" ref-type="bibr"><sup>35</sup></xref> where extra dimensions can include peristimulus time or, indeed, fast oscillatory frequencies. The effects of manipulating noise and spatial dependencies can then be evaluated across individual time series. Equally, the third dimension could be used for multimodal data projected within the same grid, informing the inference by multiple sampling modalities.</p>
    <p id="p0140">Third, the smoothing parameter may be constrained by prior knowledge or independent estimation from the data, even if evaluating a set of models over a plausible range is arguably the most robust approach. One may alternatively rely on the properties of the inferred maps, as suggested in our validation analyses. All competing spatial modeling frameworks rely on chosen parameters to some degree; ours is reduced to a single readily interpretable one.</p>
    <p id="p0145">Fourth, no model could perfectly remedy defects in the data itself, such as inadequate or biased coverage. The former can be mitigated by confining inference to spatial locations exhibiting sufficient sampling density; the latter, analogously to structured missingness, is not easily remediable within this or any other inferential framework, and presents no more or less of a problem.</p>
    <p id="p0150">Fifth, GeoSPM, like SPM itself, is a platform for standard frequentist statistical inference, revealing the organization of spatially structured variables without causal implications of any kind. But, also like SPM, it is open both to Bayesian extensions, and causal modeling upstream or downstream of the core framework. There are many ways of querying data, both with classical mass univariate and Bayesian analyses of this kind. Although not illustrated here, model comparison using the <italic>F</italic>-statistic is a common application that could be enabled by GeoSPM. For example, one could ask whether household income has an effect on the regional prevalence of diabetes, having accounted for other demographic variables, by comparing (general linear) models that do and do not include household income as an explanatory variable.</p>
    <p id="p0155">Finally, the SPM approach, in any formulation, is designed for topological inference, not discrimination between distributed spatial patterns, which may also arise in healthcare, and requires explicit modeling of spatial interactions that only a multivariate model could conceivably deliver. Indeed, such use would violate the underlying assumption of benign regional dependence, as do analogous attempts in the domain of lesion-deficit mapping of the brain.<xref rid="bib36" ref-type="bibr"><sup>36</sup></xref> GeoSPM maps may nonetheless be used to select features where the fragility of the multivariate model, or the applicable data regime, compel it.</p>
  </sec>
</body>
<back>
  <ref-list id="cebib0010">
    <title>References</title>
    <ref id="bib1">
      <label>1</label>
      <element-citation publication-type="journal" id="sref1">
        <person-group person-group-type="author">
          <name>
            <surname>Anselin</surname>
            <given-names>L.</given-names>
          </name>
        </person-group>
        <article-title>Local indicators of spatial association—LISA</article-title>
        <source>Geogr. Anal.</source>
        <volume>27</volume>
        <year>1995</year>
        <fpage>93</fpage>
        <lpage>115</lpage>
        <pub-id pub-id-type="doi">10.1111/j.1538-4632.1995.tb00338.x</pub-id>
      </element-citation>
    </ref>
    <ref id="bib2">
      <label>2</label>
      <element-citation publication-type="journal" id="sref2">
        <person-group person-group-type="author">
          <name>
            <surname>Kulldorff</surname>
            <given-names>M.</given-names>
          </name>
        </person-group>
        <article-title>A spatial scan statistic</article-title>
        <source>Commun. Stat. Theory</source>
        <volume>26</volume>
        <year>1997</year>
        <fpage>1481</fpage>
        <lpage>1496</lpage>
        <pub-id pub-id-type="doi">10.1080/03610929708831995</pub-id>
      </element-citation>
    </ref>
    <ref id="bib3">
      <label>3</label>
      <element-citation publication-type="book" id="sref3">
        <person-group person-group-type="author">
          <name>
            <surname>Shepard</surname>
            <given-names>D.</given-names>
          </name>
        </person-group>
        <part-title>A two-dimensional interpolation function for irregularly-spaced data</part-title>
        <source>Proceedings of the 1968 23rd ACM National Conference</source>
        <year>1968</year>
        <fpage>517</fpage>
        <lpage>524</lpage>
        <pub-id pub-id-type="doi">10.1145/800186.810616</pub-id>
      </element-citation>
    </ref>
    <ref id="bib4">
      <label>4</label>
      <element-citation publication-type="journal" id="sref4">
        <person-group person-group-type="author">
          <name>
            <surname>Rosenblatt</surname>
            <given-names>M.</given-names>
          </name>
        </person-group>
        <article-title>Remarks on some nonparametric estimates of a density function</article-title>
        <source>Ann. Math. Stat.</source>
        <volume>27</volume>
        <year>1956</year>
        <fpage>832</fpage>
        <lpage>837</lpage>
        <pub-id pub-id-type="doi">10.1214/aoms/1177728190</pub-id>
      </element-citation>
    </ref>
    <ref id="bib5">
      <label>5</label>
      <element-citation publication-type="book" id="sref5">
        <person-group person-group-type="author">
          <name>
            <surname>Wand</surname>
            <given-names>M.P.</given-names>
          </name>
          <name>
            <surname>Jones</surname>
            <given-names>M.C.</given-names>
          </name>
        </person-group>
        <part-title>Kernel Smoothing</part-title>
        <year>1994</year>
        <publisher-name>CRC Press</publisher-name>
        <pub-id pub-id-type="doi">10.1007/978-1-4899-4493-1</pub-id>
      </element-citation>
    </ref>
    <ref id="bib6">
      <label>6</label>
      <element-citation publication-type="book" id="sref6">
        <person-group person-group-type="author">
          <name>
            <surname>Anselin</surname>
            <given-names>L.</given-names>
          </name>
        </person-group>
        <part-title>Spatial Econometrics: Methods and Models</part-title>
        <year>1988</year>
        <publisher-name>Springer Science &amp; Business Media</publisher-name>
        <pub-id pub-id-type="doi">10.1007/978-94-015-7799-1</pub-id>
      </element-citation>
    </ref>
    <ref id="bib7">
      <label>7</label>
      <element-citation publication-type="journal" id="sref7">
        <person-group person-group-type="author">
          <name>
            <surname>Brunsdon</surname>
            <given-names>C.</given-names>
          </name>
          <name>
            <surname>Fotheringham</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Charlton</surname>
            <given-names>M.</given-names>
          </name>
        </person-group>
        <article-title>Geographically weighted regression</article-title>
        <source>J. Roy. Stat. Soc. D-Sta</source>
        <volume>47</volume>
        <year>1998</year>
        <fpage>431</fpage>
        <lpage>443</lpage>
        <pub-id pub-id-type="doi">10.1111/1467-9884.00145</pub-id>
      </element-citation>
    </ref>
    <ref id="bib8">
      <label>8</label>
      <element-citation publication-type="journal" id="sref8">
        <person-group person-group-type="author">
          <name>
            <surname>Briggs</surname>
            <given-names>D.J.</given-names>
          </name>
          <name>
            <surname>Collins</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Fischer</surname>
            <given-names>P.</given-names>
          </name>
          <name>
            <surname>Kingham</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Lebret</surname>
            <given-names>E.</given-names>
          </name>
          <name>
            <surname>Pryl</surname>
            <given-names>K.</given-names>
          </name>
          <name>
            <surname>Van Reeuwijk</surname>
            <given-names>H.</given-names>
          </name>
          <name>
            <surname>Smallbone</surname>
            <given-names>K.</given-names>
          </name>
          <name>
            <surname>Van Der Veen</surname>
            <given-names>A.</given-names>
          </name>
        </person-group>
        <article-title>Mapping urban air pollution using GIS: a regression-based approach</article-title>
        <source>Int. J. Geogr. Inf. Sci.</source>
        <volume>11</volume>
        <year>1997</year>
        <fpage>699</fpage>
        <lpage>718</lpage>
        <pub-id pub-id-type="doi">10.1080/136588197242158</pub-id>
      </element-citation>
    </ref>
    <ref id="bib9">
      <label>9</label>
      <element-citation publication-type="book" id="sref9">
        <person-group person-group-type="author">
          <name>
            <surname>Goovaerts</surname>
            <given-names>P.</given-names>
          </name>
        </person-group>
        <part-title>Geostatistics for Natural Resources Evaluation</part-title>
        <year>1997</year>
        <publisher-name>Oxford University Press on Demand</publisher-name>
      </element-citation>
    </ref>
    <ref id="bib10">
      <label>10</label>
      <element-citation publication-type="book" id="sref10">
        <person-group person-group-type="author">
          <name>
            <surname>Stein</surname>
            <given-names>M.L.</given-names>
          </name>
        </person-group>
        <part-title>Interpolation of Spatial Data: Some Theory for Kriging</part-title>
        <year>1999</year>
        <publisher-name>Springer Science &amp; Business Media</publisher-name>
        <pub-id pub-id-type="doi">10.1007/978-1-4612-1494-6</pub-id>
      </element-citation>
    </ref>
    <ref id="bib11">
      <label>11</label>
      <element-citation publication-type="journal" id="sref11">
        <person-group person-group-type="author">
          <name>
            <surname>Breslow</surname>
            <given-names>N.E.</given-names>
          </name>
          <name>
            <surname>Clayton</surname>
            <given-names>D.G.</given-names>
          </name>
        </person-group>
        <article-title>Approximate inference in generalized linear mixed models</article-title>
        <source>J. Am. Stat. Assoc.</source>
        <volume>88</volume>
        <year>1993</year>
        <fpage>9</fpage>
        <lpage>25</lpage>
        <pub-id pub-id-type="doi">10.1080/01621459.1993.10594284</pub-id>
      </element-citation>
    </ref>
    <ref id="bib12">
      <label>12</label>
      <element-citation publication-type="journal" id="sref12">
        <person-group person-group-type="author">
          <name>
            <surname>Hastie</surname>
            <given-names>T.</given-names>
          </name>
          <name>
            <surname>Tibshirani</surname>
            <given-names>R.</given-names>
          </name>
        </person-group>
        <article-title>Generalized additive models</article-title>
        <source>Stat. Sci.</source>
        <volume>1</volume>
        <year>1986</year>
        <fpage>297</fpage>
        <lpage>310</lpage>
        <pub-id pub-id-type="doi">10.1214/ss/1177013604</pub-id>
      </element-citation>
    </ref>
    <ref id="bib13">
      <label>13</label>
      <element-citation publication-type="journal" id="sref13">
        <person-group person-group-type="author">
          <name>
            <surname>Kammann</surname>
            <given-names>E.E.</given-names>
          </name>
          <name>
            <surname>Wand</surname>
            <given-names>M.P.</given-names>
          </name>
        </person-group>
        <article-title>Geoadditive models</article-title>
        <source>J. Roy. Stat. Soc. C.–App.</source>
        <volume>52</volume>
        <year>2003</year>
        <fpage>1</fpage>
        <lpage>18</lpage>
        <pub-id pub-id-type="doi">10.1111/1467-9876.00385</pub-id>
      </element-citation>
    </ref>
    <ref id="bib14">
      <label>14</label>
      <element-citation publication-type="book" id="sref14">
        <person-group person-group-type="author">
          <name>
            <surname>Banerjee</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Carlin</surname>
            <given-names>B.P.</given-names>
          </name>
          <name>
            <surname>Gelfand</surname>
            <given-names>A.E.</given-names>
          </name>
          <name>
            <surname>Banerjee</surname>
            <given-names>S.</given-names>
          </name>
        </person-group>
        <part-title>Hierarchical Modeling and Analysis for Spatial Data</part-title>
        <year>2003</year>
        <publisher-name>Chapman and Hall/CRC</publisher-name>
        <pub-id pub-id-type="doi">10.1201/9780203487808</pub-id>
      </element-citation>
    </ref>
    <ref id="bib15">
      <label>15</label>
      <element-citation publication-type="book" id="sref15">
        <person-group person-group-type="author">
          <name>
            <surname>Lawson</surname>
            <given-names>A.B.</given-names>
          </name>
        </person-group>
        <part-title>Bayesian Disease Mapping: Hierarchical Modeling in Spatial Epidemiology</part-title>
        <edition>Third edition</edition>
        <year>2018</year>
        <publisher-name>CRC Press</publisher-name>
        <pub-id pub-id-type="doi">10.1201/9781351271769</pub-id>
      </element-citation>
    </ref>
    <ref id="bib16">
      <label>16</label>
      <element-citation publication-type="journal" id="sref16">
        <person-group person-group-type="author">
          <name>
            <surname>Diggle</surname>
            <given-names>P.J.</given-names>
          </name>
          <name>
            <surname>Tawn</surname>
            <given-names>J.A.</given-names>
          </name>
          <name>
            <surname>Moyeed</surname>
            <given-names>R.A.</given-names>
          </name>
        </person-group>
        <article-title>Model-based geostatistics</article-title>
        <source>J. Roy. Stat. Soc. C.–App.</source>
        <volume>47</volume>
        <year>1998</year>
        <fpage>299</fpage>
        <lpage>350</lpage>
        <pub-id pub-id-type="doi">10.1111/1467-9876.00113</pub-id>
      </element-citation>
    </ref>
    <ref id="bib17">
      <label>17</label>
      <element-citation publication-type="book" id="sref17">
        <person-group person-group-type="author">
          <name>
            <surname>Diggle</surname>
            <given-names>P.J.</given-names>
          </name>
          <name>
            <surname>Ribeiro</surname>
            <given-names>P.J.</given-names>
          </name>
        </person-group>
        <part-title>Model-based Geostatistics</part-title>
        <year>2007</year>
        <publisher-name>Springer</publisher-name>
        <pub-id pub-id-type="doi">10.1007/978-0-387-48536-2</pub-id>
      </element-citation>
    </ref>
    <ref id="bib18">
      <label>18</label>
      <element-citation publication-type="journal" id="sref18">
        <person-group person-group-type="author">
          <name>
            <surname>Gelfand</surname>
            <given-names>A.E.</given-names>
          </name>
          <name>
            <surname>Kim</surname>
            <given-names>H.-J.</given-names>
          </name>
          <name>
            <surname>Sirmans</surname>
            <given-names>C.F.</given-names>
          </name>
          <name>
            <surname>Banerjee</surname>
            <given-names>S.</given-names>
          </name>
        </person-group>
        <article-title>Spatial modeling with spatially varying coefficient processes</article-title>
        <source>J. Am. Stat. Assoc.</source>
        <volume>98</volume>
        <year>2003</year>
        <fpage>387</fpage>
        <lpage>396</lpage>
        <pub-id pub-id-type="doi">10.1198/016214503000170</pub-id>
      </element-citation>
    </ref>
    <ref id="bib19">
      <label>19</label>
      <element-citation publication-type="journal" id="sref19">
        <person-group person-group-type="author">
          <name>
            <surname>Da Silva</surname>
            <given-names>A.R.</given-names>
          </name>
          <name>
            <surname>Fotheringham</surname>
            <given-names>A.S.</given-names>
          </name>
        </person-group>
        <article-title>The multiple testing issue in geographically weighted regression</article-title>
        <source>Geogr. Anal.</source>
        <volume>48</volume>
        <year>2016</year>
        <fpage>233</fpage>
        <lpage>247</lpage>
        <pub-id pub-id-type="doi">10.1111/gean.12084</pub-id>
      </element-citation>
    </ref>
    <ref id="bib20">
      <label>20</label>
      <element-citation publication-type="journal" id="sref20">
        <person-group person-group-type="author">
          <name>
            <surname>Yuan</surname>
            <given-names>Y.</given-names>
          </name>
          <name>
            <surname>Cave</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Xu</surname>
            <given-names>H.</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>C.</given-names>
          </name>
        </person-group>
        <article-title>Exploration of spatially varying relationships between Pb and Al in urban soils of London at the regional scale using geographically weighted regression (GWR)</article-title>
        <source>J. Hazard Mater.</source>
        <volume>393</volume>
        <year>2020</year>
        <fpage>122377</fpage>
        <pub-id pub-id-type="doi">10.1016/j.jhazmat.2020.122377</pub-id>
        <pub-id pub-id-type="pmid">32114137</pub-id>
      </element-citation>
    </ref>
    <ref id="bib21">
      <label>21</label>
      <element-citation publication-type="journal" id="sref21">
        <person-group person-group-type="author">
          <name>
            <surname>Brunsdon</surname>
            <given-names>C.</given-names>
          </name>
          <name>
            <surname>Fotheringham</surname>
            <given-names>A.S.</given-names>
          </name>
          <name>
            <surname>Charlton</surname>
            <given-names>M.E.</given-names>
          </name>
        </person-group>
        <article-title>Geographically weighted regression: a method for exploring spatial nonstationarity</article-title>
        <source>Geogr. Anal.</source>
        <volume>28</volume>
        <year>1996</year>
        <fpage>281</fpage>
        <lpage>298</lpage>
        <pub-id pub-id-type="doi">10.1111/j.1538-4632.1996.tb00936.x</pub-id>
      </element-citation>
    </ref>
    <ref id="bib22">
      <label>22</label>
      <element-citation publication-type="journal" id="sref22">
        <person-group person-group-type="author">
          <name>
            <surname>Stewart Fotheringham</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Charlton</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Brunsdon</surname>
            <given-names>C.</given-names>
          </name>
        </person-group>
        <article-title>The geography of parameter space: an investigation of spatial non-stationarity</article-title>
        <source>Int. J. Geogr. Inf. Syst.</source>
        <volume>10</volume>
        <year>1996</year>
        <fpage>605</fpage>
        <lpage>627</lpage>
        <pub-id pub-id-type="doi">10.1080/02693799608902100</pub-id>
      </element-citation>
    </ref>
    <ref id="bib23">
      <label>23</label>
      <element-citation publication-type="journal" id="sref23">
        <person-group person-group-type="author">
          <name>
            <surname>Friston</surname>
            <given-names>K.J.</given-names>
          </name>
          <name>
            <surname>Worsley</surname>
            <given-names>K.J.</given-names>
          </name>
          <name>
            <surname>Frackowiak</surname>
            <given-names>R.S.</given-names>
          </name>
          <name>
            <surname>Mazziotta</surname>
            <given-names>J.C.</given-names>
          </name>
          <name>
            <surname>Evans</surname>
            <given-names>A.C.</given-names>
          </name>
        </person-group>
        <article-title>Assessing the significance of focal activations using their spatial extent</article-title>
        <source>Hum. Brain Mapp.</source>
        <volume>1</volume>
        <year>1994</year>
        <fpage>210</fpage>
        <lpage>220</lpage>
        <pub-id pub-id-type="doi">10.1002/hbm.460010306</pub-id>
        <pub-id pub-id-type="pmid">24578041</pub-id>
      </element-citation>
    </ref>
    <ref id="bib24">
      <label>24</label>
      <element-citation publication-type="journal" id="sref24">
        <person-group person-group-type="author">
          <name>
            <surname>Sudlow</surname>
            <given-names>C.</given-names>
          </name>
          <name>
            <surname>Gallacher</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Allen</surname>
            <given-names>N.</given-names>
          </name>
          <name>
            <surname>Beral</surname>
            <given-names>V.</given-names>
          </name>
          <name>
            <surname>Burton</surname>
            <given-names>P.</given-names>
          </name>
          <name>
            <surname>Danesh</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Downey</surname>
            <given-names>P.</given-names>
          </name>
          <name>
            <surname>Elliott</surname>
            <given-names>P.</given-names>
          </name>
          <name>
            <surname>Green</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Landray</surname>
            <given-names>M.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>UK biobank: an open access resource for identifying the causes of a wide range of complex diseases of middle and old age</article-title>
        <source>PLoS Med.</source>
        <volume>12</volume>
        <year>2015</year>
        <fpage>e1001779</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pmed.1001779</pub-id>
        <pub-id pub-id-type="pmid">25826379</pub-id>
      </element-citation>
    </ref>
    <ref id="bib25">
      <label>25</label>
      <element-citation publication-type="book" id="sref25">
        <person-group person-group-type="author">
          <name>
            <surname>Worsley</surname>
            <given-names>K.J.</given-names>
          </name>
        </person-group>
        <part-title>An Unbiased Estimator for the Roughness of a Multivariate Gaussian Random Field</part-title>
        <year>2000</year>
        <publisher-name>Department of Mathematics and Statistics, University of McGill</publisher-name>
        <ext-link ext-link-type="uri" xlink:href="https://www.math.mcgill.ca/keith/smoothness/techrept.pdf" id="intref0055">https://www.math.mcgill.ca/keith/smoothness/techrept.pdf</ext-link>
      </element-citation>
    </ref>
    <ref id="bib26">
      <label>26</label>
      <element-citation publication-type="journal" id="sref26">
        <person-group person-group-type="author">
          <name>
            <surname>Kiebel</surname>
            <given-names>S.J.</given-names>
          </name>
          <name>
            <surname>Poline</surname>
            <given-names>J.-B.</given-names>
          </name>
          <name>
            <surname>Friston</surname>
            <given-names>K.J.</given-names>
          </name>
          <name>
            <surname>Holmes</surname>
            <given-names>A.P.</given-names>
          </name>
          <name>
            <surname>Worsley</surname>
            <given-names>K.J.</given-names>
          </name>
        </person-group>
        <article-title>Robust smoothness estimation in statistical parametric maps using standardized residuals from the general linear</article-title>
        <source>Neuroimage</source>
        <volume>10</volume>
        <year>1999</year>
        <fpage>756</fpage>
        <lpage>766</lpage>
        <pub-id pub-id-type="doi">10.1006/nimg.1999.0508</pub-id>
        <pub-id pub-id-type="pmid">10600421</pub-id>
      </element-citation>
    </ref>
    <ref id="bib27">
      <label>27</label>
      <element-citation publication-type="journal" id="sref27">
        <person-group person-group-type="author">
          <name>
            <surname>Friston</surname>
            <given-names>K.J.</given-names>
          </name>
          <name>
            <surname>Josephs</surname>
            <given-names>O.</given-names>
          </name>
          <name>
            <surname>Zarahn</surname>
            <given-names>E.</given-names>
          </name>
          <name>
            <surname>Holmes</surname>
            <given-names>A.P.</given-names>
          </name>
          <name>
            <surname>Rouquette</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Poline</surname>
            <given-names>J.</given-names>
          </name>
        </person-group>
        <article-title>To smooth or not to smooth? Bias and efficiency in fMRI time-series analysis</article-title>
        <source>Neuroimage</source>
        <volume>12</volume>
        <year>2000</year>
        <fpage>196</fpage>
        <lpage>208</lpage>
        <pub-id pub-id-type="doi">10.1006/nimg.2000.0609</pub-id>
        <pub-id pub-id-type="pmid">10913325</pub-id>
      </element-citation>
    </ref>
    <ref id="bib28">
      <label>28</label>
      <element-citation publication-type="journal" id="sref28">
        <person-group person-group-type="author">
          <name>
            <surname>Worsley</surname>
            <given-names>K.J.</given-names>
          </name>
          <name>
            <surname>Marrett</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Neelin</surname>
            <given-names>P.</given-names>
          </name>
          <name>
            <surname>Evans</surname>
            <given-names>A.C.</given-names>
          </name>
        </person-group>
        <article-title>Searching scale space for activation in PET images</article-title>
        <source>Hum. Brain Mapp.</source>
        <volume>4</volume>
        <year>1996</year>
        <fpage>74</fpage>
        <lpage>90</lpage>
        <pub-id pub-id-type="doi">10.1002/(SICI)1097-0193(1996)4:1&lt;74::AID-HBM5&gt;3.0.CO;2-M</pub-id>
        <pub-id pub-id-type="pmid">20408187</pub-id>
      </element-citation>
    </ref>
    <ref id="bib29">
      <label>29</label>
      <element-citation publication-type="journal" id="sref29">
        <person-group person-group-type="author">
          <name>
            <surname>Pebesma</surname>
            <given-names>E.J.</given-names>
          </name>
        </person-group>
        <article-title>Multivariable geostatistics in S: the gstat package</article-title>
        <source>Comput. Geosci.</source>
        <volume>30</volume>
        <year>2004</year>
        <fpage>683</fpage>
        <lpage>691</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cageo.2004.03.012</pub-id>
      </element-citation>
    </ref>
    <ref id="bib30">
      <label>30</label>
      <element-citation publication-type="book" id="sref30">
        <person-group person-group-type="author">
          <name>
            <surname>Dubuisson</surname>
            <given-names>M.-P.</given-names>
          </name>
          <name>
            <surname>Jain</surname>
            <given-names>A.K.</given-names>
          </name>
        </person-group>
        <part-title>A modified Hausdorff distance for object matching</part-title>
        <series>Proceedings of 12th International Conference on Pattern Recognition</series>
        <volume>1</volume>
        <year>1994</year>
        <fpage>566</fpage>
        <lpage>568</lpage>
        <pub-id pub-id-type="doi">10.1109/ICPR.1994.576361</pub-id>
      </element-citation>
    </ref>
    <ref id="bib31">
      <label>31</label>
      <element-citation publication-type="journal" id="sref31">
        <person-group person-group-type="author">
          <name>
            <surname>Taha</surname>
            <given-names>A.A.</given-names>
          </name>
          <name>
            <surname>Hanbury</surname>
            <given-names>A.</given-names>
          </name>
        </person-group>
        <article-title>Metrics for evaluating 3D medical image segmentation: analysis, selection, and tool</article-title>
        <source>BMC Med. Imag.</source>
        <volume>15</volume>
        <year>2015</year>
        <fpage>1</fpage>
        <lpage>28</lpage>
        <pub-id pub-id-type="doi">10.1186/s12880-015-0068-x</pub-id>
      </element-citation>
    </ref>
    <ref id="bib32">
      <label>32</label>
      <element-citation publication-type="journal" id="sref32">
        <person-group person-group-type="author">
          <name>
            <surname>Yang</surname>
            <given-names>B.-Y.</given-names>
          </name>
          <name>
            <surname>Fan</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Thiering</surname>
            <given-names>E.</given-names>
          </name>
          <name>
            <surname>Seissler</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Nowak</surname>
            <given-names>D.</given-names>
          </name>
          <name>
            <surname>Dong</surname>
            <given-names>G.-H.</given-names>
          </name>
          <name>
            <surname>Heinrich</surname>
            <given-names>J.</given-names>
          </name>
        </person-group>
        <article-title>Ambient air pollution and diabetes: a systematic review and meta-analysis</article-title>
        <source>Environ. Res.</source>
        <volume>180</volume>
        <year>2020</year>
        <fpage>108817</fpage>
        <pub-id pub-id-type="doi">10.1016/j.envres.2019.108817</pub-id>
        <pub-id pub-id-type="pmid">31627156</pub-id>
      </element-citation>
    </ref>
    <ref id="bib33">
      <label>33</label>
      <element-citation publication-type="journal" id="sref33">
        <person-group person-group-type="author">
          <name>
            <surname>Bowe</surname>
            <given-names>B.</given-names>
          </name>
          <name>
            <surname>Xie</surname>
            <given-names>Y.</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>T.</given-names>
          </name>
          <name>
            <surname>Yan</surname>
            <given-names>Y.</given-names>
          </name>
          <name>
            <surname>Xian</surname>
            <given-names>H.</given-names>
          </name>
          <name>
            <surname>Al-Aly</surname>
            <given-names>Z.</given-names>
          </name>
        </person-group>
        <article-title>The 2016 global and national burden of diabetes mellitus attributable to PM<sub>2·5</sub> air pollution</article-title>
        <source>Lancet Planet. Health</source>
        <volume>2</volume>
        <year>2018</year>
        <fpage>E301</fpage>
        <lpage>E317</lpage>
        <pub-id pub-id-type="doi">10.1016/S2542-5196(18)30140-2</pub-id>
        <pub-id pub-id-type="pmid">30074893</pub-id>
      </element-citation>
    </ref>
    <ref id="bib34">
      <label>34</label>
      <element-citation publication-type="journal" id="sref34">
        <person-group person-group-type="author">
          <name>
            <surname>Yongze</surname>
            <given-names>L.</given-names>
          </name>
          <name>
            <surname>Xu</surname>
            <given-names>L.</given-names>
          </name>
          <name>
            <surname>Shan</surname>
            <given-names>Z.</given-names>
          </name>
          <name>
            <surname>Teng</surname>
            <given-names>W.</given-names>
          </name>
          <name>
            <surname>Han</surname>
            <given-names>C.</given-names>
          </name>
        </person-group>
        <article-title>Association between air pollution and type 2 diabetes: an updated review of the literature</article-title>
        <source>Ther. Adv. Endocrinol. Metab.</source>
        <volume>10</volume>
        <year>2019</year>
        <fpage>1</fpage>
        <lpage>15</lpage>
        <pub-id pub-id-type="doi">10.1177/2042018819897046</pub-id>
      </element-citation>
    </ref>
    <ref id="bib35">
      <label>35</label>
      <element-citation publication-type="journal" id="sref35">
        <person-group person-group-type="author">
          <name>
            <surname>Litvak</surname>
            <given-names>V.</given-names>
          </name>
          <name>
            <surname>Mattout</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Kiebel</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Phillips</surname>
            <given-names>C.</given-names>
          </name>
          <name>
            <surname>Henson</surname>
            <given-names>R.</given-names>
          </name>
          <name>
            <surname>Kilner</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Barnes</surname>
            <given-names>G.</given-names>
          </name>
          <name>
            <surname>Oostenveld</surname>
            <given-names>R.</given-names>
          </name>
          <name>
            <surname>Daunizeau</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Flandin</surname>
            <given-names>G.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>EEG and MEG data analysis in SPM8</article-title>
        <source>Comput. Intel. Neurosc.</source>
        <volume>2011</volume>
        <year>2011</year>
        <fpage>852961</fpage>
        <pub-id pub-id-type="doi">10.1155/2011/852961</pub-id>
      </element-citation>
    </ref>
    <ref id="bib36">
      <label>36</label>
      <element-citation publication-type="journal" id="sref36">
        <person-group person-group-type="author">
          <name>
            <surname>Mah</surname>
            <given-names>Y.-H.</given-names>
          </name>
          <name>
            <surname>Husain</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Rees</surname>
            <given-names>G.</given-names>
          </name>
          <name>
            <surname>Nachev</surname>
            <given-names>P.</given-names>
          </name>
        </person-group>
        <article-title>Human brain lesion-deficit inference remapped</article-title>
        <source>Brain</source>
        <volume>137</volume>
        <year>2014</year>
        <fpage>2522</fpage>
        <lpage>2531</lpage>
        <pub-id pub-id-type="doi">10.1093/brain/awu164</pub-id>
        <pub-id pub-id-type="pmid">24974384</pub-id>
      </element-citation>
    </ref>
  </ref-list>
  <sec id="appsec2" sec-type="supplementary-material">
    <title>Supplemental information</title>
    <p id="p0285">
      <supplementary-material content-type="local-data" id="mmc1">
        <caption>
          <title>Document S1. Supplemental experimental procedures, Figures S1–S56, Tables S1–S7, and supplemental notes</title>
        </caption>
        <media xlink:href="mmc1.pdf"/>
      </supplementary-material>
      <supplementary-material content-type="local-data" id="mmc2">
        <caption>
          <title>Document S2. Article plus supplemental information</title>
        </caption>
        <media xlink:href="mmc2.pdf"/>
      </supplementary-material>
    </p>
  </sec>
  <sec sec-type="data-availability" id="da0010">
    <title>Data and code availability</title>
    <p id="p0025">The data analyzed in this study are available on application to UK Biobank (<ext-link ext-link-type="uri" xlink:href="https://www.ukbiobank.ac.uk" id="intref0010">https://www.ukbiobank.ac.uk</ext-link>). The open-source software implementation of GeoSPM presented in this study is available on GitHub: <ext-link ext-link-type="uri" xlink:href="https://github.com/high-dimensional/geospm" id="intref0015">https://github.com/high-dimensional/geospm</ext-link> (<ext-link ext-link-type="uri" xlink:href="https://doi.org/10.5281/zenodo.7258971" id="intref0020">https://doi.org/10.5281/zenodo.7258971</ext-link>).</p>
  </sec>
  <ack id="ack0010">
    <title>Acknowledgments</title>
    <p id="p0265">This work is aligned with a project on “Novel methods to explore the value of cognitive health in a place” supported by the <funding-source id="gs1"><institution-wrap><institution-id institution-id-type="doi">10.13039/501100000724</institution-id><institution>Health Foundation</institution></institution-wrap></funding-source>, an independent charity committed to bringing about better health and health care for people in the UK. H.E., A.N., D.H., and P.N. are supported by the <funding-source id="gs2">NIHR UCLH Biomedical Research Centre</funding-source>. M.S.P. is supported by the Health Foundation. M.R. is supported by the <funding-source id="gs3"><institution-wrap><institution-id institution-id-type="doi">10.13039/501100000272</institution-id><institution>National Institute for Health Research</institution></institution-wrap></funding-source> (NIHR) Senior Investigator Award/NF-SI-0512-10033. A.J., G.R., and P.N. are supported by <funding-source id="gs4"><institution-wrap><institution-id institution-id-type="doi">10.13039/100004440</institution-id><institution>Wellcome</institution></institution-wrap></funding-source> (213038). The views expressed are those of the authors and not necessarily those of the NIHR, the Department of Health and Social Care, the Health Foundation, or Wellcome. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</p>
    <sec id="sec5">
      <title>Author contributions</title>
      <p id="p0270">Conceptualization, P.N., H.E., and A.J.; methodology, P.N., H.E., A.J., and K.F.; software, H.E.; validation, P.N., H.E., A.J., and M.S.P.; formal analysis, H.E.; investigation, H.E. and A.N.; resources, P.N.; data curation, H.E.; writing – original draft, P.N. and H.E.; writing – review &amp; editing, P.N., H.E., A.J., K.F., M.R., M.S.P., D.H., and G.R.; visualization, H.E. and P.N.; supervision, P.N.; funding acquisition, P.N. and M.R.</p>
    </sec>
    <sec sec-type="COI-statement" id="sec6">
      <title>Declaration of interests</title>
      <p id="p0275">The authors declare no competing interests.</p>
    </sec>
  </ack>
  <fn-group>
    <fn id="appsec1" fn-type="supplementary-material">
      <p id="p0280">Supplemental information can be found online at <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.patter.2022.100656" id="intref0050">https://doi.org/10.1016/j.patter.2022.100656</ext-link>.</p>
    </fn>
  </fn-group>
</back>
