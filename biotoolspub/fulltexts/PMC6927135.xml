<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Genome Biol</journal-id>
    <journal-id journal-id-type="iso-abbrev">Genome Biol</journal-id>
    <journal-title-group>
      <journal-title>Genome Biology</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1474-7596</issn>
    <issn pub-type="epub">1474-760X</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">6927135</article-id>
    <article-id pub-id-type="publisher-id">1861</article-id>
    <article-id pub-id-type="doi">10.1186/s13059-019-1861-6</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Method</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Feature selection and dimension reduction for single-cell RNA-Seq based on a multinomial model</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0003-0320-6787</contrib-id>
        <name>
          <surname>Townes</surname>
          <given-names>F. William</given-names>
        </name>
        <address>
          <email>ftownes@princeton.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Hicks</surname>
          <given-names>Stephanie C.</given-names>
        </name>
        <address>
          <email>shicks19@jhu.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Aryee</surname>
          <given-names>Martin J.</given-names>
        </name>
        <address>
          <email>aryee.martin@mgh.harvard.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff4">4</xref>
        <xref ref-type="aff" rid="Aff5">5</xref>
        <xref ref-type="aff" rid="Aff6">6</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Irizarry</surname>
          <given-names>Rafael A.</given-names>
        </name>
        <address>
          <email>rafa@ds.dfci.harvard.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff7">7</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ISNI">000000041936754X</institution-id><institution-id institution-id-type="GRID">grid.38142.3c</institution-id><institution>Department of Biostatistics, </institution><institution>Harvard University, </institution></institution-wrap>Cambridge, MA USA </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 2097 5006</institution-id><institution-id institution-id-type="GRID">grid.16750.35</institution-id><institution>Present Address: Department of Computer Science, </institution><institution>Princeton University, </institution></institution-wrap>Princeton, NJ USA </aff>
      <aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 2171 9311</institution-id><institution-id institution-id-type="GRID">grid.21107.35</institution-id><institution>Department of Biostatistics, </institution><institution>Johns Hopkins University, </institution></institution-wrap>Baltimore, MD USA </aff>
      <aff id="Aff4"><label>4</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0004 0386 9924</institution-id><institution-id institution-id-type="GRID">grid.32224.35</institution-id><institution>Molecular Pathology Unit, </institution><institution>Massachusetts General Hospital, </institution></institution-wrap>Charlestown, MA USA </aff>
      <aff id="Aff5"><label>5</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0004 0386 9924</institution-id><institution-id institution-id-type="GRID">grid.32224.35</institution-id><institution>Center for Cancer Research, </institution><institution>Massachusetts General Hospital, </institution></institution-wrap>Charlestown, MA USA </aff>
      <aff id="Aff6"><label>6</label><institution-wrap><institution-id institution-id-type="ISNI">000000041936754X</institution-id><institution-id institution-id-type="GRID">grid.38142.3c</institution-id><institution>Department of Pathology, </institution><institution>Harvard Medical School, </institution></institution-wrap>Boston, MA USA </aff>
      <aff id="Aff7"><label>7</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 2106 9910</institution-id><institution-id institution-id-type="GRID">grid.65499.37</institution-id><institution>Department of Data Sciences, </institution><institution>Dana-Farber Cancer Institute, </institution></institution-wrap>Boston, MA USA </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>23</day>
      <month>12</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>23</day>
      <month>12</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2019</year>
    </pub-date>
    <volume>20</volume>
    <elocation-id>295</elocation-id>
    <history>
      <date date-type="received">
        <day>12</day>
        <month>3</month>
        <year>2019</year>
      </date>
      <date date-type="accepted">
        <day>15</day>
        <month>10</month>
        <year>2019</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2019</copyright-statement>
      <license license-type="OpenAccess">
        <license-p><bold>Open Access</bold> This article is distributed under the terms of the Creative Commons Attribution 4.0 International License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The Creative Commons Public Domain Dedication waiver(<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <p id="Par1">Single-cell RNA-Seq (scRNA-Seq) profiles gene expression of individual cells. Recent scRNA-Seq datasets have incorporated unique molecular identifiers (UMIs). Using negative controls, we show UMI counts follow multinomial sampling with no zero inflation. Current normalization procedures such as log of counts per million and feature selection by highly variable genes produce false variability in dimension reduction. We propose simple multinomial methods, including generalized principal component analysis (GLM-PCA) for non-normal distributions, and feature selection using deviance. These methods outperform the current practice in a downstream clustering assessment using ground truth datasets.</p>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Gene expression</kwd>
      <kwd>Single cell</kwd>
      <kwd>RNA-Seq</kwd>
      <kwd>Dimension reduction</kwd>
      <kwd>Variable genes</kwd>
      <kwd>Principal component analysis</kwd>
      <kwd>GLM-PCA</kwd>
    </kwd-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2019</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p>Single-cell RNA-Seq (scRNA-Seq) is a powerful tool for profiling gene expression patterns in individual cells, facilitating a variety of analyses such as identification of novel cell types [<xref ref-type="bibr" rid="CR1">1</xref>, <xref ref-type="bibr" rid="CR2">2</xref>]. In a typical protocol, single cells are isolated in liquid droplets, and messenger RNA (mRNA) is captured from each cell, converted to cDNA by reverse transcriptase (RT), then amplified using polymerase chain reaction (PCR) [<xref ref-type="bibr" rid="CR3">3</xref>–<xref ref-type="bibr" rid="CR5">5</xref>]. Finally, fragments are sequenced, and expression of a gene in a cell is quantified by the number of sequencing reads that mapped to that gene [<xref ref-type="bibr" rid="CR6">6</xref>]. A crucial difference between scRNA-Seq and traditional bulk RNA-Seq is the low quantity of mRNA isolated from individual cells, which requires a larger number of PCR cycles to produce enough material for sequencing (bulk RNA-Seq comingles thousands of cells per sample). For example, the popular 10x Genomics protocol uses 14 cycles [<xref ref-type="bibr" rid="CR5">5</xref>]. Thus, many of the reads counted in scRNA-Seq are duplicates of a single mRNA molecule in the original cell [<xref ref-type="bibr" rid="CR7">7</xref>]. Full-length protocols such as SMART-Seq2 [<xref ref-type="bibr" rid="CR8">8</xref>] analyze these <italic>read counts</italic> directly, and several methods have been developed to facilitate this [<xref ref-type="bibr" rid="CR9">9</xref>]. However, in many experiments, it is desirable to analyze larger numbers of cells than possible with full-length protocols, and isoform-level inference may be unnecessary. Under such conditions, it is advantagous to include unique molecular identifiers (UMIs) which enable computational removal of PCR duplicates [<xref ref-type="bibr" rid="CR10">10</xref>, <xref ref-type="bibr" rid="CR11">11</xref>], producing <italic>UMI counts</italic>. Although a zero UMI count is equivalent to a zero read count, nonzero read counts are larger than their corresponding UMI counts. In general, all scRNA-Seq data contain large numbers of zero counts (often &gt;90<italic>%</italic> of the data). Here, we focus on the analysis of scRNA-Seq data with UMI counts.</p>
    <p>Starting from raw counts, a scRNA-Seq data analysis typically includes normalization, feature selection, and dimension reduction steps. Normalization seeks to adjust for differences in experimental conditions between samples (individual cells), so that these do not confound true biological differences. For example, the efficiency of mRNA capture and RT is variable between samples (technical variation), causing different cells to have different total UMI counts, even if the number of molecules in the original cells is identical. Feature selection refers to excluding uninformative genes such as those which exhibit no meaningful biological variation across samples. Since scRNA-Seq experiments usually examine cells within a single tissue, only a small fraction of genes are expected to be informative since many genes are biologically variable only across different tissues. Dimension reduction aims to embed each cell’s high-dimensional expression profile into a low-dimensional representation to facilitate visualization and clustering.</p>
    <p>While a plethora of methods [<xref ref-type="bibr" rid="CR5">5</xref>, <xref ref-type="bibr" rid="CR12">12</xref>–<xref ref-type="bibr" rid="CR15">15</xref>] have been developed for each of these steps, here, we describe what is considered to be the standard pipeline [<xref ref-type="bibr" rid="CR15">15</xref>]. First, raw counts are normalized by scaling of sample-specific <italic>size factors</italic>, followed by log transformation, which attempts to reduce skewness. Next, feature selection involves identifying the top 500–2000 genes by computing either their coefficient of variation (highly variable genes [<xref ref-type="bibr" rid="CR16">16</xref>, <xref ref-type="bibr" rid="CR17">17</xref>]) or average expression level (highly expressed genes) across all cells [<xref ref-type="bibr" rid="CR15">15</xref>]. Alternatively, highly dropout genes may be retained [<xref ref-type="bibr" rid="CR18">18</xref>]. Principal component analysis (PCA) [<xref ref-type="bibr" rid="CR19">19</xref>] is the most popular dimension reduction method (see for example tutorials for Seurat [<xref ref-type="bibr" rid="CR17">17</xref>] and Cell Ranger [<xref ref-type="bibr" rid="CR5">5</xref>]). PCA compresses each cell’s 2000-dimensional expression profile into, say, a 10-dimensional vector of principal component coordinates or latent factors. Prior to PCA, data are usually centered and scaled so that each gene has mean 0 and standard deviation 1 (<italic>z</italic>-score transformation). Finally, a clustering algorithm can be applied to group cells with similar representations in the low-dimensional PCA space.</p>
    <p>Despite the appealing simplicity of this standard pipeline, the characteristics of scRNA-Seq UMI counts present difficulties at each stage. Many normalization schemes derived from bulk RNA-Seq cannot compute size factors stably in the presence of large numbers of zeros [<xref ref-type="bibr" rid="CR20">20</xref>]. A numerically stable and popular method is to set the size factor for each cell as the total counts divided by 10<sup>6</sup> (<italic>counts per million</italic>, CPM). Note that CPM does not alter zeros, which dominate scRNA-Seq data. Log transformation is not possible for exact zeros, so it is common practice to add a small <italic>pseudocount</italic> such as 1 to all normalized counts prior to taking the log. The choice of pseudocount is arbitrary and can introduce subtle biases in the transformed data [<xref ref-type="bibr" rid="CR21">21</xref>]. For a statistical interpretation of the pseudocount, see the “<xref rid="Sec14" ref-type="sec">Methods</xref>” section. Similarly, the use of highly variable genes for feature selection is somewhat arbitrary since the observed variability will depend on the pseudocount: pseudocounts close to zero arbitrarily increase the variance of genes with zero counts. Finally, PCA implicitly relies on Euclidean geometry, which may not be appropriate for highly sparse, discrete, and skewed data, even after normalizations and transformations [<xref ref-type="bibr" rid="CR22">22</xref>].</p>
    <p>Widely used methods for the analysis of scRNA-Seq lack statistically rigorous justification based on a plausible data generating a mechanism for UMI counts. Instead, it appears many of the techniques have been borrowed from the data analysis pipelines developed for read counts, especially those based on bulk RNA-Seq [<xref ref-type="bibr" rid="CR23">23</xref>]. For example, models based on the lognormal distribution cannot account for exact zeros, motivating the development of zero-inflated lognormal models for scRNA-Seq read counts [<xref ref-type="bibr" rid="CR24">24</xref>–<xref ref-type="bibr" rid="CR27">27</xref>]. Alternatively, ZINB-WAVE uses a zero-inflated negative binomial model for dimension reduction of read counts [<xref ref-type="bibr" rid="CR28">28</xref>]. However, as shown below, the sampling distribution of UMI counts is not zero inflated [<xref ref-type="bibr" rid="CR29">29</xref>] and differs markedly from read counts, so application of read count models to UMI counts needs either theoretical or empirical justification.</p>
    <p>We present a unifying statistical foundation for scRNA-Seq with UMI counts based on the multinomial distribution. The multinomial model adequately describes negative control data, and there is no need to model zero inflation. We show the mechanism by which PCA on log-normalized UMI counts can lead to distorted low-dimensional factors and false discoveries. We identify the source of the frequently observed and undesirable fact that the fraction of zeros reported in each cell drives the first principal component in most experiments [<xref ref-type="bibr" rid="CR30">30</xref>]. To remove these distortions, we propose the use of GLM-PCA, a generalization of PCA to exponential family likelihoods [<xref ref-type="bibr" rid="CR31">31</xref>]. GLM-PCA operates on raw counts, avoiding the pitfalls of normalization. We also demonstrate that applying PCA to deviance or Pearson residuals provides a useful and fast approximation to GLM-PCA. We provide a closed-form deviance statistic as a feature selection method. We systematically compare the performance of all combinations of methods using ground truth datasets and assessment procedures from [<xref ref-type="bibr" rid="CR15">15</xref>]. We conclude by suggesting best practices.</p>
  </sec>
  <sec id="Sec2">
    <title>Results and discussion</title>
    <sec id="Sec3">
      <title>Datasets</title>
      <p>We used 9 public UMI count datasets to benchmark our methods (Table <xref rid="Tab1" ref-type="table">1</xref>). The first dataset was a highly controlled experiment specifically designed to understand the technical variability. No actual cells were used to generate this dataset. Instead, each droplet received the same ratio of 92 synthetic spike-in RNA molecules from External RNA Controls Consortium (ERCC). We refer to this dataset as the <italic>technical replicates negative control</italic> as there is no biological variability whatsoever, and in principle, each expression profile should be the same.
<table-wrap id="Tab1"><label>Table 1</label><caption><p>Single cell RNA-Seq datasets used</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Number</th><th align="left">Author</th><th align="left">Tissue</th><th align="left">Cells</th><th align="left">MTU</th><th align="left">Notes</th></tr></thead><tbody><tr><td align="left">1</td><td align="left">Zheng [<xref ref-type="bibr" rid="CR5">5</xref>]</td><td align="left">ERCC</td><td align="left">1015</td><td align="left">11,125</td><td align="left">Spike-in only; technical negative control</td></tr><tr><td align="left">2</td><td align="left">Zheng [<xref ref-type="bibr" rid="CR5">5</xref>]</td><td align="left">Monocytes</td><td align="left">2612</td><td align="left">782</td><td align="left">1 cell type; biological negative control</td></tr><tr><td align="left">3</td><td align="left">Tung [<xref ref-type="bibr" rid="CR32">32</xref>]</td><td align="left">iPSCs</td><td align="left">57</td><td align="left">24,170</td><td align="left">1 cell type; biological negative control</td></tr><tr><td align="left">4</td><td align="left">Duo [<xref ref-type="bibr" rid="CR15">15</xref>]</td><td align="left">PBMCs</td><td align="left">3994</td><td align="left">1215</td><td align="left">4 equal clusters of FACS-purified cells</td></tr><tr><td align="left">5</td><td align="left">Duo [<xref ref-type="bibr" rid="CR15">15</xref>]</td><td align="left">PBMCs</td><td align="left">3994</td><td align="left">1298</td><td align="left">8 equal clusters of FACS-purified cells</td></tr><tr><td align="left">6</td><td align="left">Haber [<xref ref-type="bibr" rid="CR33">33</xref>]</td><td align="left">Intestine</td><td align="left">533</td><td align="left">3755</td><td align="left">Authors computationally identified 12 types</td></tr><tr><td align="left">7</td><td align="left">Muraro [<xref ref-type="bibr" rid="CR34">34</xref>]</td><td align="left">Pancreas</td><td align="left">2282</td><td align="left">18,795</td><td align="left">Authors computationally identified 9 types</td></tr><tr><td align="left">8</td><td align="left">Zheng [<xref ref-type="bibr" rid="CR5">5</xref>]</td><td align="left">PBMCs</td><td align="left">68,579</td><td align="left">1292</td><td align="left">Benchmarking computational speed</td></tr></tbody></table><table-wrap-foot><p>Species: all <italic>H. sapiens</italic> except Haber (<italic>M. musculus</italic>). Protocols: all 10 × except Muraro (CEL-Seq2) and Tung (SMARTer). <italic>MTU</italic> median total UMI count. <italic>iPSCs</italic> induced pluripotent stem cells</p></table-wrap-foot></table-wrap></p>
      <p>The second and third datasets contained cells from homogeneous populations purified using fluorescence-activated cell sorting (FACS). We refer to these datasets as <italic>biological replicates negative controls</italic>. Because these cells were all the same type, we did not expect to observe any significant differences in unsupervised analysis. The 10 × Zheng monocytes data had low total UMI counts, while the SMARTer Tung data had high counts.</p>
      <p>The fourth and fifth datasets were created by [<xref ref-type="bibr" rid="CR15">15</xref>]. The authors allocated FACS-purified peripheral blood mononuclear cells (PBMCs) from 10 × data [<xref ref-type="bibr" rid="CR5">5</xref>] equally into four (Zheng 4eq dataset) and eight (Zheng 8eq dataset) clusters, respectively. In these positive control datasets, the cluster identity of all cells was assigned independently of gene expression (using FACS), so they served as the ground truth labels.</p>
      <p>The sixth and seventh datasets contained a wider variety of cell types. However, the cluster identities were determined computationally by the original authors’ unsupervised analyses and could not serve as a ground truth. The 10 × Haber intestinal dataset had low total UMI counts, while the CEL-Seq2 Muraro pancreas dataset had high counts.</p>
      <p>The final Zheng dataset consisted of a larger number of unsorted PBMCs and was used to compare computational speed of different dimension reduction algorithms. We refer to it as the PBMC 68K dataset.</p>
    </sec>
    <sec id="Sec4">
      <title>UMI count distribution differs from reads</title>
      <p>To illustrate the marked difference between UMI count distributions and read count distributions, we created histograms from individual genes and spike-ins of the negative control data. Here, the UMI counts are the computationally de-duplicated versions of the read counts; both measurements are from the same experiment, so no differences are due to technical or biological variation. The results suggest that while read counts appear zero-inflated and multimodal, UMI counts follow a discrete distribution with no zero inflation (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S1). The apparent zero inflation in read counts is a result of PCR duplicates.</p>
    </sec>
    <sec id="Sec5">
      <title>Multinomial sampling distribution for UMI counts</title>
      <p>Consider a single cell <italic>i</italic> containing <italic>t</italic><sub><italic>i</italic></sub> total mRNA transcripts. Let <italic>n</italic><sub><italic>i</italic></sub> be the total number of UMIs for the same cell. When the cell is processed by a scRNA-Seq protocol, it is lysed, then some fraction of the transcripts are captured by beads within the droplets. A series of complex biochemical reactions occur, including attachment of barcodes and UMIs, and reverse transcription of the captured mRNA to a cDNA molecule. Finally, the cDNA is sequenced, and PCR duplicates are removed to generate the UMI counts [<xref ref-type="bibr" rid="CR5">5</xref>]. In each of these stages, some fraction of the molecules from the previous stage are lost [<xref ref-type="bibr" rid="CR5">5</xref>, <xref ref-type="bibr" rid="CR7">7</xref>, <xref ref-type="bibr" rid="CR32">32</xref>]. In particular, reverse transcriptase is an inefficient and error-prone enzyme [<xref ref-type="bibr" rid="CR35">35</xref>]. Therefore, the number of UMI counts representing the cell is much less than the number of transcripts in the original cell (<italic>n</italic><sub><italic>i</italic></sub>≪<italic>t</italic><sub><italic>i</italic></sub>). Specifically, <italic>n</italic><sub><italic>i</italic></sub> typically ranges from 1000−10,000 while <italic>t</italic><sub><italic>i</italic></sub> is estimated to be approximately 200,000 for a typical mammalian cell [<xref ref-type="bibr" rid="CR36">36</xref>]. Furthermore, which molecules are selected and successfully become UMIs is a random process. Let <italic>x</italic><sub><italic>ij</italic></sub> be the true number of mRNA transcripts of gene <italic>j</italic> in cell <italic>i</italic>, and <italic>y</italic><sub><italic>ij</italic></sub> be the UMI count for the same gene and cell. We define the <italic>relative abundance</italic>
<italic>π</italic><sub><italic>ij</italic></sub> as the true number of mRNA transcripts represented by gene <italic>j</italic> in cell <italic>i</italic> divided by the total number of mRNA transcripts in cell <italic>i</italic>. Relative abundance is given by <italic>π</italic><sub><italic>ij</italic></sub>=<italic>x</italic><sub><italic>ij</italic></sub>/<italic>t</italic><sub><italic>i</italic></sub> where total transcripts <inline-formula id="IEq1"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$t_{i}=\sum _{j} x_{ij}$\end{document}</tex-math><mml:math id="M2"><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2019_1861_Article_IEq1.gif"/></alternatives></inline-formula>. Since <italic>n</italic><sub><italic>i</italic></sub>≪<italic>t</italic><sub><italic>i</italic></sub>, there is a “competition to be counted” [<xref ref-type="bibr" rid="CR37">37</xref>]; genes with large relative abundance <italic>π</italic><sub><italic>ij</italic></sub> in the original cell are more likely to have nonzero UMI counts, but genes with small relative abundances may be observed with UMI counts of exact zeros. The UMI counts <italic>y</italic><sub><italic>ij</italic></sub> are a multinomial sample of the true biological counts <italic>x</italic><sub><italic>ij</italic></sub>, containing only relative information about expression patterns in the cell [<xref ref-type="bibr" rid="CR37">37</xref>, <xref ref-type="bibr" rid="CR38">38</xref>].</p>
      <p>The multinomial distribution can be approximated by independent Poisson distributions and overdispersed (Dirichlet) multinomials by independent negative binomial distributions. These approximations are useful for computational tractability. Details are provided in the “<xref rid="Sec14" ref-type="sec">Methods</xref>” section.</p>
      <p>The multinomial model makes two predictions which we verified using negative control data. First, the fraction of zeros in a sample (cell or droplet) is inversely related to the total number of UMIs in that sample. Second, the probability of an endogenous gene or ERCC spike-in having zero counts is a decreasing function of its mean expression (equations provided in the “<xref rid="Sec14" ref-type="sec">Methods</xref>” section). Both of these predictions were validated by the negative control data (Fig. <xref rid="Fig1" ref-type="fig">1</xref>). In particular, the empirical probability of a gene being zero across droplets was well calibrated to the theoretical prediction based on the multinomial model. This also demonstrates that UMI counts are not zero inflated, consistent with [<xref ref-type="bibr" rid="CR29">29</xref>].
<fig id="Fig1"><label>Fig. 1</label><caption><p>Multinomial model adequately characterizes sampling distributions of technical and biological replicates negative control data. <bold>a</bold> Fraction of zeros is plotted against the total number of UMI in each droplet for the technical replicates. <bold>b</bold> As <bold>a</bold> but for cells in the biological replicates (monocytes). <bold>c</bold> After down-sampling replicates to 10,000 UMIs per droplet to remove variability due to the differences in sequencing depth, the fraction of zeros is computed for each gene and plotted against the log of expression across all samples for the technical replicates data. The solid curve is theoretical probability of observing a zero as a function of the expected counts derived from the multinomial model (blue) and its Poisson approximation (green). <bold>d</bold> As <bold>c</bold> but for the biological replicates (monocytes) dataset and after down-sampling to 575 UMIs per cell. Here, we also add the theoretical probability derived from a negative binomial model (red)</p></caption><graphic xlink:href="13059_2019_1861_Fig1_HTML" id="MO1"/></fig></p>
      <p>To further validate the multinomial model, we assessed goodness-of-fit of seven possible null distributions to both the Tung and Zheng monocytes negative control datasets (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S2). When applied to UMI counts, the multinomial, Dirichlet-multinomial, and Poisson (as approximation to multinomial) distributions fit best. When applied to read counts, the zero-inflated lognormal was the best fitting distribution followed by the Dirichlet-multinomial.</p>
      <p>These results are consistent with [<xref ref-type="bibr" rid="CR39">39</xref>], which also found that the relationship between average expression and zero probability follows the theoretical curve predicted by a Poisson model using negative control data processed with Indrop [<xref ref-type="bibr" rid="CR4">4</xref>] and Dropseq [<xref ref-type="bibr" rid="CR3">3</xref>] protocols. These are droplet protocols with typically low counts. It has been argued that the Poisson model is insufficient to describe the sampling distribution of genes with high counts and the negative binomial model is more appropriate [<xref ref-type="bibr" rid="CR11">11</xref>]. The Tung dataset contained high counts, and we nevertheless found the Poisson gave a better fit than the negative binomial. However, the difference was not dramatic, so our results do not preclude the negative binomial as a reasonable sampling distribution for UMI counts. Taken together, these results suggest our data-generating mechanism is an accurate model of technical noise in real data.</p>
    </sec>
    <sec id="Sec6">
      <title>Normalization and log transformation distorts UMI data</title>
      <p>Standard scRNA-Seq analysis involves normalizing raw counts using size factors, applying a log transformation with a pseudocount, and then centering and scaling each gene before dimension reduction. The most popular normalization is counts per million (CPM). The CPM are defined as (<italic>y</italic><sub><italic>ij</italic></sub>/<italic>n</italic><sub><italic>i</italic></sub>)×10<sup>6</sup> (i.e., the size factor is <italic>n</italic><sub><italic>i</italic></sub>/10<sup>6</sup>). This is equivalent to the maximum likelihood estimator (MLE) for relative abundance <inline-formula id="IEq2"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\hat {\pi }_{ij}$\end{document}</tex-math><mml:math id="M4"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2019_1861_Article_IEq2.gif"/></alternatives></inline-formula> multiplied by 10<sup>6</sup>. The log-CPM are then <inline-formula id="IEq3"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\log _{2}(c+\hat {\pi }_{ij}10^{6}) = \log _{2}(\tilde {\pi }_{ij})+C$\end{document}</tex-math><mml:math id="M6"><mml:munder><mml:mrow><mml:mo>log</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:munder><mml:mo>(</mml:mo><mml:mi>c</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub><mml:mn>1</mml:mn><mml:msup><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mn>6</mml:mn></mml:mrow></mml:msup><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mo>log</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:munder><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>+</mml:mo><mml:mi>C</mml:mi></mml:math><inline-graphic xlink:href="13059_2019_1861_Article_IEq3.gif"/></alternatives></inline-formula>, where <inline-formula id="IEq4"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\tilde {\pi }_{ij}$\end{document}</tex-math><mml:math id="M8"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2019_1861_Article_IEq4.gif"/></alternatives></inline-formula> is a maximum a posteriori estimator (MAP) for <italic>π</italic><sub><italic>ij</italic></sub> (mathematical justification and interpretation of this approach provided in the “<xref rid="Sec14" ref-type="sec">Methods</xref>” section). The additive constant <italic>C</italic> is irrelevant if data are centered for each gene after log transformation, as is common practice. Thus, normalization of raw counts is equivalent to using MLEs or MAP estimators of the relative abundances.</p>
      <p>Log transformation of MLEs is not possible for UMI counts due to exact zeros, while log transformation of MAP estimators of <italic>π</italic><sub><italic>ij</italic></sub> systematically distorts the differences between zero and nonzero UMI counts, depending on the arbitrary pseudocount <italic>c</italic> (derivations provided in the “<xref rid="Sec14" ref-type="sec">Methods</xref>” section). To illustrate this phenomenon, we examined the distribution of an illustrative gene before and after the log transform with varying normalizations using the biological replicates negative control data (Fig. <xref rid="Fig2" ref-type="fig">2</xref>). Consistent with our theoretical predictions, this artificially caused the distribution to appear zero inflated and exaggerated differences between cells based on whether the count was zero or nonzero.
<fig id="Fig2"><label>Fig. 2</label><caption><p>Example of how current approaches to normalization and transformation artificially distort differences between zero and nonzero counts. <bold>a</bold> UMI count distribution for gene ENSG00000114391 in the monocytes biological replicates negative control dataset. <bold>b</bold> Counts per million (CPM) distribution for the exact same count data. <bold>c</bold> Distribution of <italic>l</italic><italic>o</italic><italic>g</italic><sub>2</sub>(1+<italic>C</italic><italic>P</italic><italic>M</italic>) values for the exact same count data</p></caption><graphic xlink:href="13059_2019_1861_Fig2_HTML" id="MO2"/></fig></p>
      <p>Focusing on the entire negative control datasets, we applied PCA to log-CPM values. We observed a strong correlation (<italic>r</italic>=0.8 for technical and <italic>r</italic>=0.98 for monocytes biological replicates) between the first principal component (PC) and the fraction of zeros, consistent with [<xref ref-type="bibr" rid="CR30">30</xref>]. Application of PCA to CPM values without log transform reduced this correlation to <italic>r</italic>=0.1 for technical and <italic>r</italic>=0.7 for monocytes biological replicates. Additionally, the first PC of log-CPM correlated with the log of total UMI, which is consistent with the multinomial model (Fig. <xref rid="Fig3" ref-type="fig">3</xref>). Note that in datasets with strong biological variability, the nuisance variation from zero fraction and total counts could appear in secondary PCs rather than the first PC, but it would still confound downstream analyses. Based on these results, the log transformation is not necessary and in fact detrimental for the analysis of UMI counts. The benefits of avoiding normalization by instead directly modeling raw counts have been demonstrated in the context of differential expression [<xref ref-type="bibr" rid="CR40">40</xref>]. Where normalization is unavoidable, we propose the use of approximate multinomial deviance residuals (defined in the “<xref rid="Sec18" ref-type="sec">Residuals and <italic>z</italic>-scores</xref>” section) instead of log-transformed CPM.
<fig id="Fig3"><label>Fig. 3</label><caption><p>Current approaches to normalization and transformation induce variability in the fraction of zeros across cells to become the largest source of variability which in turn biases clustering algorithms to produce false-positive results based on distorted latent factors. <bold>a</bold> First principal component (PC) from the technical replicates dataset plotted against fraction of zeros for each cell. A red to blue color scale represents total UMIs per cell. <bold>b</bold> As <bold>a</bold> but for the monocytes biological replicates data. <bold>c</bold> Using the technical replicates, we applied t-distributed stochastic neighbor embedding (tSNE) with perplexity 30 to the top 50 PCs computed from log-CPM. The first 2 tSNE dimensions are shown with a blue to red color scale representing the fraction of zeros. <bold>d</bold> As <bold>c</bold> but for the biological replicates data. Here, we do not expect to find differences, yet we see distorted latent factors being driven by the total UMIs. PCA was applied to 5000 random genes</p></caption><graphic xlink:href="13059_2019_1861_Fig3_HTML" id="MO3"/></fig></p>
    </sec>
    <sec id="Sec7">
      <title>Zero inflation is an artifact of log normalization</title>
      <p>To see how normalization and log transformation introduce the appearance of zero inflation, consider the following example. Let <italic>y</italic><sub><italic>ij</italic></sub> be the observed UMI counts following a multinomial distribution with size <italic>n</italic><sub><italic>i</italic></sub> for each cell and relative abundance <italic>π</italic><sub><italic>j</italic></sub> for each gene, constant across cells. Focusing on a single gene <italic>j</italic>, <italic>y</italic><sub><italic>ij</italic></sub> follows a binomial distribution with parameters <italic>n</italic><sub><italic>i</italic></sub> and <italic>p</italic><sub><italic>j</italic></sub>. Assume <italic>π</italic><sub><italic>j</italic></sub>=10<sup>−4</sup> and the <italic>n</italic><sub><italic>i</italic></sub> range from 1000−3000, which is consistent with the biological replicates negative control data (Fig. <xref rid="Fig1" ref-type="fig">1</xref> and Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S1). Under this assumption, we expect to see about 74–90% zeros, 22–30% ones, and less than 4% values above one. However, notice that after normalization to CPM and log transformation, all the zeros remain log2(1+0)=0, yet the ones turn into values ranging from log2(1+1/3000×10<sup>6</sup>)= log2(334)≈8.4 to log2(1001)≈10. The few values that are 2 will have values ranging from log2(668)≈9.4 to log2(2001)≈11. The large, artificial gap between zero and nonzero values makes the log-normalized data appear zero-inflated (Fig. <xref rid="Fig2" ref-type="fig">2</xref>). The variability in CPM values across cells is almost completely driven by the variability in <italic>n</italic><sub><italic>i</italic></sub>. Indeed, it shows up as the primary source of variation in PCA plots (Fig. <xref rid="Fig3" ref-type="fig">3</xref>).</p>
    </sec>
    <sec id="Sec8">
      <title>Generalized PCA for dimension reduction of sparse counts</title>
      <p>While PCA is a popular dimension reduction method, it is implicitly based on Euclidean distance, which corresponds to maximizing a Gaussian likelihood. Since UMI counts are not normally distributed, even when normalized and log transformed, this distance metric is inappropriate [<xref ref-type="bibr" rid="CR41">41</xref>], causing PCA to produce distorted latent factors (Fig. <xref rid="Fig3" ref-type="fig">3</xref>). We propose the use of PCA for generalized linear models (GLMs) [<xref ref-type="bibr" rid="CR31">31</xref>] or GLM-PCA as a more appropriate alternative. The GLM-PCA framework allows for a wide variety of likelihoods suitable for data types such as counts and binary values. While the multinomial likelihood is ideal for modeling technical variability in scRNA-Seq UMI counts (Fig. <xref rid="Fig1" ref-type="fig">1</xref>), in many cases, there may be excess biological variability present as well. For example, if we wish to capture variability due to clusters of different cell types in a dimension reduction, we may wish to exclude biological variability due to cell cycle. Biological variability not accounted for by the sampling distribution may be accomodated by using a Dirichlet-multinomial likelihood, which is overdispersed relative to the multinomial. In practice, both the multinomial and Dirichlet-multinomial are computationally intractable and may be approximated by the Poisson and negative binomial likelihoods, respectively (detailed derivations provided in the “<xref rid="Sec14" ref-type="sec">Methods</xref>” section). We implemented both negative binomial and Poisson GLM-PCA, but we focused primarily on the latter in our assessments for simplicity of exposition. Intuitively, using Poisson instead of negative binomial implies, we assume the biological variability is captured by the factor model and the unwanted biological variability is small relative to the sampling variability. Our implementation also allows the user to adjust for gene-specific or cell-specific covariates (such as batch labels) as part of the overall model.</p>
      <p>We ran Poisson GLM-PCA on the technical and biological (monocytes) replicates negative control datasets and found it removed the spurious correlation between the first dimension and the total UMIs and fraction of zeros (Fig. <xref rid="Fig4" ref-type="fig">4</xref>). To examine GLM-PCA as a visualization tool, we ran Poisson and negative binomial GLM-PCA along with competing methods on the 2 ground truth datasets (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S3). For the Zheng 4eq dataset, we directly reduced to 2 dimensions. For the Zheng 8eq dataset, we reduced to 15 dimensions then applied UMAP [<xref ref-type="bibr" rid="CR42">42</xref>]. While all methods effectively separated T cells from other PBMCs, GLM-PCA methods also separated memory and naive cytotoxic cells from the other subtypes of T cells. This separation was not visible with PCA on log-CPM. Computational speed is discussed in the “<xref rid="Sec10" ref-type="sec">Computational efficiency of multinomial models</xref>” section.
<fig id="Fig4"><label>Fig. 4</label><caption><p>GLM-PCA dimension reduction is not affected by unwanted fraction of zeros variability and avoids false-positive results. <bold>a</bold> First GLM-PCA dimension (analogous to the first principal component) plotted against the fraction of zeros for the technical replicates with colors representing the total UMIs. <bold>b</bold> As <bold>a</bold> but using monocytes biological replicates. <bold>c</bold> Using the technical replicates, we applied t-distributed stochastic neighbor embedding (tSNE) with perplexity 30 to the top 50 GLM-PCA dimensions. The first 2 tSNE dimensions are shown with a blue to red color scale representing the fraction of zeros. <bold>d</bold> As <bold>c</bold> but for the biological replicates data. GLM-PCA using the Poisson approximation to the multinomial was applied to the same 5000 random genes as in Fig. <xref rid="Fig3" ref-type="fig">3</xref></p></caption><graphic xlink:href="13059_2019_1861_Fig4_HTML" id="MO4"/></fig></p>
    </sec>
    <sec id="Sec9">
      <title>Deviance residuals provide fast approximation to GLM-PCA</title>
      <p>One disadvantage of GLM-PCA is it depends on an iterative algorithm to obtain estimates for the latent factors and is at least ten times slower than PCA. We therefore propose a fast approximation to GLM-PCA. When using PCA a common first step is to center and scale the data for each gene as z-scores. This is equivalent to the following procedure. First, specify a null model of constant gene expression across cells, assuming a normal distribution. Next, find the MLEs of its parameters for each gene (the mean and variance). Finally, compute the residuals of the model as the <italic>z</italic>-scores (derivation provided in the “<xref rid="Sec14" ref-type="sec">Methods</xref>” section). The fact that scRNA-Seq data are skewed, discrete, and possessing many zeros suggests the normality assumption may be inappropriate. Further, using <italic>z</italic>-scores does not account for variability in total UMIs across cells. Instead, we propose to replace the normal null model with a multinomial null model as a better match to the data-generating mechanism. The analogs to <italic>z</italic>-scores under this model are called deviance and Pearson residuals. Mathematical formulae are presented in the “<xref rid="Sec14" ref-type="sec">Methods</xref>” section. The use of multinomial residuals enables a fast transformation similar to <italic>z</italic>-scores that avoids difficulties of normalization and log transformation by directly modeling counts. Additionally, this framework allows straightforward adjustment for covariates such as cell cycle signatures or batch labels. In an illustrative simulation (details in the “<xref rid="Sec18" ref-type="sec">Residuals and <italic>z</italic>-scores</xref>” section), residual approximations to GLM-PCA lost accuracy in the presence of strong batch effects, but still outperformed the traditional PCA (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S4). Systematic comparisons on ground truth data are provided in the “<xref rid="Sec12" ref-type="sec">Multinomial models improve unsupervised clustering</xref>” section.</p>
    </sec>
    <sec id="Sec10">
      <title>Computational efficiency of multinomial models</title>
      <p>We measured time to convergence for reduction to two latent dimensions of GLM-PCA, ZINB-WAVE, PCA on log-CPM, PCA on deviance residuals, and PCA on Pearson residuals. Using the top 600 informative genes, we subsampled the PBMC 68K dataset to 680, 6800, and 68,000 cells. All methods scaled approximately linearly with increasing the numbers of cells, but GLM-PCA was 23–63 times faster than ZINB-WAVE across sample sizes (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S5). Specifically, GLM-PCA processed 68,000 cells in less than 7 min. The deviance and Pearson residuals methods exhibited speeds comparable to PCA: 9–26 times faster than GLM-PCA. We also timed dimension reduction of the 8eq dataset (3994 cells) from 1500 informative genes to 10 latent dimensions. PCA (with either log-CPM, deviance, or Pearson residuals) took 7 s, GLM-PCA took 4.7 min, and ZINB-WAVE took 86.6 min.</p>
    </sec>
    <sec id="Sec11">
      <title>Feature selection using deviance</title>
      <p>Feature selection, or identification of informative genes, may be accomplished by ranking genes using the <italic>deviance</italic>, which quantifies how well each gene fits a null model of constant expression across cells. Unlike the competing highly variable or highly expressed genes methods, which are sensitive to normalization, ranking genes by deviance operates on raw UMI counts. An approximate multinomial deviance statistic can be computed in closed form (formula provided in the “<xref rid="Sec14" ref-type="sec">Methods</xref>” section).</p>
      <p>We compared gene ranks for all three feature selection methods (deviance, highly expressed, and highly variable genes) on the 8eq dataset (Table <xref rid="Tab1" ref-type="table">1</xref>). We found a strong concordance between highly deviant genes and highly expressed genes (Spearman’s rank correlation <italic>r</italic>=0.9987), while highly variable genes correlated weakly with both high expression (<italic>r</italic>=0.3835) and deviance (<italic>r</italic>=0.3738).</p>
      <p>Choosing informative genes by high expression alone would be ineffective if a gene had high but constant expression across cells. To ensure the deviance criterion did not identify such genes, we created a simulation with three types of genes: lowly expressed, high but constantly expressed, and high and variably expressed. Deviance preferentially selected high and variably expressed genes while filtering by highly expressed genes identified the constantly expressed genes before the variably expressed (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S6, Table S1). Furthermore, an examination of the top 1000 genes by each criteria on the Muraro dataset showed that deviance did not identify the same set of genes as highly expressed genes (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S7, Table S2). Empirically, deviance seems to select genes that are both highly expressed and highly variable, which provides a rigorous justification for a common practice.</p>
    </sec>
    <sec id="Sec12">
      <title>Multinomial models improve unsupervised clustering</title>
      <p>Dimension reduction with GLM-PCA or its fast multinomial residuals approximation improved clustering performance over competing methods (Fig. <xref rid="Fig5" ref-type="fig">5</xref>a, Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S8a). Feature selection by multinomial deviance was superior to highly variable genes (Fig. <xref rid="Fig5" ref-type="fig">5</xref>b).
<fig id="Fig5"><label>Fig. 5</label><caption><p>Dimension reduction with GLM-PCA and feature selection using deviance improves Seurat clustering performance. Each column represents a different ground truth dataset from [<xref ref-type="bibr" rid="CR15">15</xref>]. <bold>a</bold> Comparison of dimension reduction methods based on the top 1500 informative genes identified by approximate multinomial deviance. The Poisson approximation to the multinomial was used for GLM-PCA. Dev. resid. PCA, PCA on approximate multinomial deviance residuals. <bold>b</bold> Comparison of feature selection methods. The top 1500 genes identified by deviance and highly variable genes were passed to 2 different dimension reduction methods: GLM-PCA and PCA on log-transformed CPM. Only the results with the number of clusters within 25% of the true number are presented</p></caption><graphic xlink:href="13059_2019_1861_Fig5_HTML" id="MO5"/></fig></p>
      <p>Using the two ground truth datasets described under the “<xref rid="Sec3" ref-type="sec">Datasets</xref>” section, we systematically compared the clustering performance of all combinations of previously described methods for normalization, feature selection, and dimension reduction. In addition, we compared against ZINB-WAVE since it also avoids requiring the user to pre-process and normalize the UMI count data (e.g., log transformation of CPM) and accounts for varying total UMIs across cells [<xref ref-type="bibr" rid="CR28">28</xref>]. After obtaining latent factors, we used Seurat’s Louvain implementation and <italic>k</italic>-means to infer clusters, and compared these to the known cell identities using adjusted Rand index (ARI, [<xref ref-type="bibr" rid="CR43">43</xref>]). This quantified accuracy. We assessed cluster separation using the silhouette coefficient. We varied the number of latent dimensions and number of clusters to assess robustness. Where possible, we used the same combinations of hyperparameters as [<xref ref-type="bibr" rid="CR15">15</xref>] to facilitate comparisons to their extensive benchmarking (details are provided in the “<xref rid="Sec14" ref-type="sec">Methods</xref>” section).</p>
      <p>We compared the Seurat clustering performance of GLM-PCA (with Poisson approximation to multinomial) to running PCA on deviance residuals, which adhere more closely to the normal distribution than log-CPM. We found both of these approximate multinomial methods gave similar results on the 4eq dataset and outperformed PCA on log-CPM <italic>z</italic>-scores. However, GLM-PCA outperformed the residuals method on the 8eq dataset. Also, performance on ZINB-WAVE factors degraded when the number of latent dimensions increased from 10 to 30, whereas GLM-PCA and its fast approximation with deviance residuals were robust to this change (Fig. <xref rid="Fig5" ref-type="fig">5</xref>a). GLM-PCA and its residual approximations produced better cluster separation than PCA or ZINB-WAVE, even in scenarios where all methods had similar accuracy (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S8a). The performance of Pearson residuals was similar to that of deviance residuals (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S9, S10).</p>
      <p>Focusing on feature selection methods, deviance had higher accuracy than highly variable genes across both datasets and across dimension reduction methods (Fig. <xref rid="Fig5" ref-type="fig">5</xref>b). Filtering by highly expressed genes led to similar clustering performance as deviance (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S9), because both criteria identified strongly overlapping gene lists for these data. The combination of feature selection with deviance and dimension reduction with GLM-PCA also improved clustering performance when <italic>k</italic>-means was used in place of Seurat (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S11). A complete table of results is publicly available (see the “Availability of data and materials” section).</p>
      <p>Finally, we examined the clustering performance of competing dimension reduction methods on two public datasets with more complex subtypes (Table <xref rid="Tab1" ref-type="table">1</xref>). The 10 × Haber dataset [<xref ref-type="bibr" rid="CR33">33</xref>] was annotated with 12 types of enteroendocrine cells from the intestine. The CEL-Seq2 Muraro dataset [<xref ref-type="bibr" rid="CR34">34</xref>] was annotated with 9 types of pancreatic cells. Since these cluster labels were computationally derived, they did not constitute a ground truth comparison. Nevertheless, GLM-PCA had the closest concordance with the original authors’ annotation in both datasets (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Tables S3, S4).</p>
    </sec>
  </sec>
  <sec id="Sec13" sec-type="conclusion">
    <title>Conclusions</title>
    <p>We have outlined a statistical framework for analysis of scRNA-Seq data with UMI counts based on a multinomial model, providing effective and simple to compute methods for feature selection and dimension reduction. We found that UMI count distributions differ dramatically from read counts, are well-described by a multinomial distribution, and are not zero inflated. Log transformation of normalized UMI counts is detrimental, because it artificially exaggerates the differences between zeros and all other values. For feature selection, or identification of informative genes, deviance is a more effective criterion than highly variable genes. Dimension reduction via GLM-PCA, or its fast approximation using residuals from a multinomial model, leads to better clustering performance than PCA on <italic>z</italic>-scores of log-CPM.</p>
    <p>Although our methods were inspired by scRNA-Seq UMI counts, they may be useful for a wider array of data sources. Any high dimensional, sparse dataset where samples contain only relative information in the form of counts may conceivably be modeled by the multinomial distribution. Under such scenarios, our methods are likely to be more effective than applying log transformations and standard PCA. A possible example is microbiome data.</p>
    <p>We have not addressed major topics in the scRNA-Seq literature such as pseudotime inference [<xref ref-type="bibr" rid="CR44">44</xref>], differential expression [<xref ref-type="bibr" rid="CR45">45</xref>], and spatial analysis [<xref ref-type="bibr" rid="CR46">46</xref>]. However, the statistical ideas outlined here can also be used to improve methods in these more specialized types of analyses.</p>
    <p>Our results have focused on (generalized) linear models for simplicity of exposition. Recently, several promising nonlinear dimension reductions for scRNA-Seq have been proposed. The variational autoencoder (VAE, a type of neural network) method scVI [<xref ref-type="bibr" rid="CR47">47</xref>] utilizes a negative binomial likelihood in the decoder, while the encoder relies on log-normalized input data for numerical stability. The Gaussian process method tGPLVM [<xref ref-type="bibr" rid="CR48">48</xref>] models log-transformed counts. In both cases, we suggest replacing log-transformed values with deviance residuals to improve performance. Nonlinear dimension reduction methods may also depend on feature selection to reduce memory consumption and speed computation; here, our deviance method may be utilized as an alternative to high variability for screening informative genes.</p>
  </sec>
  <sec id="Sec14">
    <title>Methods</title>
    <sec id="Sec15">
      <title>Multinomial model for scRNA-Seq</title>
      <p>Let <italic>y</italic><sub><italic>ij</italic></sub> be the observed UMI counts for cell or droplet <italic>i</italic> and gene or spike-in <italic>j</italic>. Let <inline-formula id="IEq5"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$n_{i}=\sum _{j} y_{ij}$\end{document}</tex-math><mml:math id="M10"><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2019_1861_Article_IEq5.gif"/></alternatives></inline-formula> be the total UMIs in the sample, and <italic>π</italic><sub><italic>ij</italic></sub> be the unknown true relative abundance of gene <italic>j</italic> in cell <italic>i</italic>. The random vector <inline-formula id="IEq6"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\vec {y}_{i} = (y_{i1},\ldots,y_{iJ})^{\top }$\end{document}</tex-math><mml:math id="M12"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mo>→</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">iJ</mml:mtext></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>⊤</mml:mo></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="13059_2019_1861_Article_IEq6.gif"/></alternatives></inline-formula> with constraint <inline-formula id="IEq7"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\sum _{j} y_{ij}=n_{i}$\end{document}</tex-math><mml:math id="M14"><mml:munder><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2019_1861_Article_IEq7.gif"/></alternatives></inline-formula> follows a multinomial distribution with densit function:
<disp-formula id="Equa"><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$f(\vec{y}_{i}) = \binom{n_{i}}{y_{i1},\ldots,y_{iJ}} \prod_{j} \pi_{ij}^{y_{ij}} $$ \end{document}</tex-math><mml:math id="M16"><mml:mrow><mml:mi>f</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mo>→</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mfenced close=")" open="(" separators=""><mml:mfrac linethickness="0.0pt"><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">iJ</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mfenced><mml:munder><mml:mrow><mml:mo mathsize="big">∏</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:munder><mml:msubsup><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:msubsup></mml:mrow></mml:math><graphic xlink:href="13059_2019_1861_Article_Equa.gif" position="anchor"/></alternatives></disp-formula> Focusing on a single gene <italic>j</italic> at a time, the marginal distribution of <italic>y</italic><sub><italic>ij</italic></sub> is binomial with parameters <italic>n</italic><sub><italic>i</italic></sub> and <italic>π</italic><sub><italic>ij</italic></sub>. The marginal mean is E[<italic>y</italic><sub><italic>ij</italic></sub>]=<italic>n</italic><sub><italic>i</italic></sub><italic>π</italic><sub><italic>ij</italic></sub>=<italic>μ</italic><sub><italic>ij</italic></sub>, the marginal variance is <inline-formula id="IEq8"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\text {var}[y_{ij}] = n_{i} \pi _{ij}(1-\pi _{ij}) = \mu _{ij}-\frac {1}{n_{i}}\mu _{ij}^{2}$\end{document}</tex-math><mml:math id="M18"><mml:mtext>var</mml:mtext><mml:mo>[</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub><mml:mo>]</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:msubsup><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2019_1861_Article_IEq8.gif"/></alternatives></inline-formula>, and the marginal probability of a zero count is <inline-formula id="IEq9"><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$(1-\pi _{ij})^{n_{i}} = \left (1-\frac {\mu _{ij}}{n_{i}}\right)^{n_{i}}$\end{document}</tex-math><mml:math id="M20"><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="13059_2019_1861_Article_IEq9.gif"/></alternatives></inline-formula>. The correlation between two genes <italic>j</italic>,<italic>k</italic> is:
<disp-formula id="Equb"><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\text{cor}[y_{ij},y_{ik}] = \frac{-\sqrt{\pi_{ij}\pi_{ik}}}{\sqrt{(1-\pi_{ij})(1-\pi_{ik})}} $$ \end{document}</tex-math><mml:math id="M22"><mml:mrow><mml:mtext>cor</mml:mtext><mml:mo>[</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ik</mml:mtext></mml:mrow></mml:msub><mml:mo>]</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mo>−</mml:mo><mml:msqrt><mml:mrow><mml:msub><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ik</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:msqrt></mml:mrow><mml:mrow><mml:msqrt><mml:mrow><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ik</mml:mtext></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:msqrt></mml:mrow></mml:mfrac></mml:mrow></mml:math><graphic xlink:href="13059_2019_1861_Article_Equb.gif" position="anchor"/></alternatives></disp-formula> The correlation is induced by the sum to <italic>n</italic><sub><italic>i</italic></sub> constraint. As an extreme example, if there are only two genes (<italic>J</italic>=2), increasing the count of the first gene automatically reduces the count of the second gene since they must add up to <italic>n</italic><sub><italic>i</italic></sub> under multinomial sampling. This means when <italic>J</italic>=2, there is a perfect anti-correlation between the gene counts which has nothing to do with biology. More generally, when either <italic>J</italic> or <italic>n</italic><sub><italic>i</italic></sub> is small, gene counts will be negatively correlated independent of biological gene-gene correlations, and it is not possible to analyze the data on a gene-by-gene basis (for example, by ranking and filtering genes for feature selection). Rather, comparisons are only possible between pairwise ratios of gene expression values [<xref ref-type="bibr" rid="CR49">49</xref>]. Yet, this type of analysis is difficult to interpret and computationally expensive for large numbers of genes (i.e., in high dimensions). Fortunately, under certain assumptions, more tractable approximations may be substituted for the true multinomial distribution.</p>
      <p>First, note that if correlation is ignored, the multinomial may be approximated by <italic>J</italic>-independent binomial distributions. Intuitively, this approximation will be reasonable if all <italic>π</italic><sub><italic>ij</italic></sub> are very small, which is likely to be satisfied for scRNA-Seq if the number of genes <italic>J</italic> is large, and no single gene constitutes the majority of mRNAs in the cell. If <italic>n</italic><sub><italic>i</italic></sub> is large and <italic>π</italic><sub><italic>ij</italic></sub> is small, each binomial distribution can be further approximated by a Poisson with mean <italic>n</italic><sub><italic>i</italic></sub><italic>π</italic><sub><italic>ij</italic></sub>. Alternatively, the multinomial can be constructed by drawing <italic>J</italic>-independent Poisson random variables and conditioning on their sum. If <italic>J</italic> and <italic>n</italic><sub><italic>i</italic></sub> are large, the difference between the conditional, multinomial distribution, and the independent Poissons becomes negligible. Since in practice <italic>n</italic><sub><italic>i</italic></sub> is large, the Poisson approximation to the multinomial may be reasonable [<xref ref-type="bibr" rid="CR50">50</xref>–<xref ref-type="bibr" rid="CR53">53</xref>].</p>
      <p>The multinomial model does not account for biological variability. As a result, an overdispersed version of the multinomial model may be necessary. This can be accommodated with the Dirichlet-multinomial distribution. Let <inline-formula id="IEq10"><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\vec {y}_{i}$\end{document}</tex-math><mml:math id="M24"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mo>→</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2019_1861_Article_IEq10.gif"/></alternatives></inline-formula> be distributed as a multinomial conditional on the relative abundance parameter vector <inline-formula id="IEq11"><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\vec {\pi }_{i}=(\pi _{i1},\ldots,\pi _{iJ})^{\top }$\end{document}</tex-math><mml:math id="M26"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mo>→</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">iJ</mml:mtext></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>⊤</mml:mo></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="13059_2019_1861_Article_IEq11.gif"/></alternatives></inline-formula>. If <inline-formula id="IEq12"><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\vec {\pi }_{i}$\end{document}</tex-math><mml:math id="M28"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mo>→</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2019_1861_Article_IEq12.gif"/></alternatives></inline-formula> is itself a random variable with symmetric Dirichlet distribution having shape parameter <italic>α</italic>, the marginal distribution of <inline-formula id="IEq13"><alternatives><tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\vec {y}_{i}$\end{document}</tex-math><mml:math id="M30"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mo>→</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2019_1861_Article_IEq13.gif"/></alternatives></inline-formula> is Dirichlet-multinomial. This distribution can itself be approximated by independent negative binomials. First, note that a symmetric Dirichlet random vector can be constructed by drawing <italic>J</italic>-independent gamma variates with shape parameter <italic>α</italic> and dividing by their sum. Suppose (as above) we approximate the conditional multinomial distribution of <inline-formula id="IEq14"><alternatives><tex-math id="M31">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\vec {y}_{i}$\end{document}</tex-math><mml:math id="M32"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mo>→</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2019_1861_Article_IEq14.gif"/></alternatives></inline-formula> such that <italic>y</italic><sub><italic>ij</italic></sub> follows an approximate Poisson distribution with mean <italic>n</italic><sub><italic>i</italic></sub><italic>π</italic><sub><italic>ij</italic></sub>. Let <italic>λ</italic><sub><italic>ij</italic></sub> be a collection of non-negative random variables such that <inline-formula id="IEq15"><alternatives><tex-math id="M33">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\pi _{ij}=\frac {\lambda _{ij}}{\sum _{j} \lambda _{ij}}$\end{document}</tex-math><mml:math id="M34"><mml:msub><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:munder><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:math><inline-graphic xlink:href="13059_2019_1861_Article_IEq15.gif"/></alternatives></inline-formula>. We require that <inline-formula id="IEq16"><alternatives><tex-math id="M35">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\vec {\pi }_{i}$\end{document}</tex-math><mml:math id="M36"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mo>→</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2019_1861_Article_IEq16.gif"/></alternatives></inline-formula> follows a symmetric Dirichlet, which is accomplished by having <italic>λ</italic><sub><italic>ij</italic></sub> follow independent gamma distributions with shape <italic>α</italic> and mean <italic>n</italic><sub><italic>i</italic></sub>/<italic>J</italic>. This implies <inline-formula id="IEq17"><alternatives><tex-math id="M37">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\sum _{j} \lambda _{ij}$\end{document}</tex-math><mml:math id="M38"><mml:munder><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2019_1861_Article_IEq17.gif"/></alternatives></inline-formula> follows a gamma with shape <italic>J</italic><italic>α</italic> and mean <italic>n</italic><sub><italic>i</italic></sub>. As <italic>J</italic>→<italic>∞</italic>, this distribution converges to a point mass at <italic>n</italic><sub><italic>i</italic></sub>, so for large <italic>J</italic> (satisfied by scRNA-Seq), <inline-formula id="IEq18"><alternatives><tex-math id="M39">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\sum _{j} \lambda _{ij}\approx n_{i}$\end{document}</tex-math><mml:math id="M40"><mml:munder><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub><mml:mo>≈</mml:mo><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2019_1861_Article_IEq18.gif"/></alternatives></inline-formula>. This implies that <italic>y</italic><sub><italic>ij</italic></sub> approximately follows a conditional Poisson distribution with mean <italic>λ</italic><sub><italic>ij</italic></sub>, where <italic>λ</italic><sub><italic>ij</italic></sub> is itself a gamma random variable with mean <italic>n</italic><sub><italic>i</italic></sub>/<italic>J</italic> and shape <italic>α</italic>. If we then integrate out <italic>λ</italic><sub><italic>ij</italic></sub> we obtain the marginal distribution of <italic>y</italic><sub><italic>ij</italic></sub> as negative binomial with shape <italic>α</italic> and mean <italic>n</italic><sub><italic>i</italic></sub>/<italic>J</italic>. Hence a negative binomial model for count data may be regarded as an approximation to an overdispersed Dirichlet-multinomial model.</p>
      <p>Parameter estimation with multinomial models (and their binomial or Poisson approximations) is straightforward. First, suppose we observe replicate samples <inline-formula id="IEq19"><alternatives><tex-math id="M41">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\vec {y}_{i}$\end{document}</tex-math><mml:math id="M42"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mo>→</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2019_1861_Article_IEq19.gif"/></alternatives></inline-formula>, <italic>i</italic>=1,…,<italic>I</italic> from the same underlying population of molecules, where the relative abundance of gene <italic>j</italic> is <italic>π</italic><sub><italic>j</italic></sub>. This is a null model because it assumes each gene has a constant expected expression level, and there is no biological variation across samples. Regardless of whether one assumes a multinomial, binomial, or Poisson model, the maximum likelihood estimator (MLE) of <italic>π</italic><sub><italic>j</italic></sub> is <inline-formula id="IEq20"><alternatives><tex-math id="M43">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\hat {\pi }_{j} = \frac {\sum _{i} y_{ij}}{\sum _{i} n_{i}}$\end{document}</tex-math><mml:math id="M44"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:munder><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:munder><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:math><inline-graphic xlink:href="13059_2019_1861_Article_IEq20.gif"/></alternatives></inline-formula> where <italic>n</italic><sub><italic>i</italic></sub> is the total count of sample <italic>i</italic>. In the more realistic case that relative abundances <italic>π</italic><sub><italic>ij</italic></sub> of genes vary across samples, the MLE is <inline-formula id="IEq21"><alternatives><tex-math id="M45">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\hat {\pi }_{ij}=\frac {y_{ij}}{n_{i}}$\end{document}</tex-math><mml:math id="M46"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:math><inline-graphic xlink:href="13059_2019_1861_Article_IEq21.gif"/></alternatives></inline-formula>.</p>
      <p>An alternative to the MLE is the maximum a posteriori (MAP) estimator. Suppose a symmetric Dirichlet prior with concentration parameter <italic>α</italic><sub><italic>i</italic></sub> is combined with the multinomial likelihood for cell <italic>i</italic>. The MAP estimator for <italic>π</italic><sub><italic>ij</italic></sub> is given by:
<disp-formula id="Equc"><alternatives><tex-math id="M47">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\tilde{\pi}_{ij}=\frac{\alpha_{i}+y_{ij}}{J\alpha_{i}+n_{i}} = w_{i}\frac{1}{J}+(1-w_{i})\hat{\pi}_{ij} $$ \end{document}</tex-math><mml:math id="M48"><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>J</mml:mi><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>J</mml:mi></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math><graphic xlink:href="13059_2019_1861_Article_Equc.gif" position="anchor"/></alternatives></disp-formula> where <italic>w</italic><sub><italic>i</italic></sub>=<italic>J</italic><italic>α</italic><sub><italic>i</italic></sub>/(<italic>J</italic><italic>α</italic><sub><italic>i</italic></sub>+<italic>n</italic><sub><italic>i</italic></sub>), showing that the MAP is a weighted average of the prior mean that all genes are equally expressed (1/<italic>J</italic>) and the MLE (<inline-formula id="IEq22"><alternatives><tex-math id="M49">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\hat {\pi }_{ij}$\end{document}</tex-math><mml:math id="M50"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2019_1861_Article_IEq22.gif"/></alternatives></inline-formula>). Compared to the MLE, the MAP biases the estimate toward the prior where all genes have the same expression. Larger values of <italic>α</italic><sub><italic>i</italic></sub> introduce more bias, while <italic>α</italic><sub><italic>i</italic></sub>→0 leads to the MLE. If <italic>α</italic><sub><italic>i</italic></sub>&gt;0, the smallest possible value of <inline-formula id="IEq23"><alternatives><tex-math id="M51">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\tilde {\pi }_{ij}$\end{document}</tex-math><mml:math id="M52"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2019_1861_Article_IEq23.gif"/></alternatives></inline-formula> is <italic>α</italic><sub><italic>i</italic></sub>/(<italic>J</italic><italic>α</italic><sub><italic>i</italic></sub>+<italic>n</italic><sub><italic>i</italic></sub>) rather than zero for the MLE. When there are many zeros in the data, MAP can stabilize relative abundance estimates at the cost of introducing bias.</p>
    </sec>
    <sec id="Sec16">
      <title>Mathematics of distortion from log-normalizing UMIs</title>
      <p>Suppose the true counts in cell <italic>i</italic> are given by <italic>x</italic><sub><italic>ij</italic></sub> for genes <italic>j</italic>=1,…,<italic>J</italic>. Some of these may be zero, if a gene is not turned on in the cell. Knowing <italic>x</italic><sub><italic>ij</italic></sub> is equivalent to knowing the total number of transcripts <inline-formula id="IEq24"><alternatives><tex-math id="M53">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$t_{i}=\sum _{j} x_{ij}$\end{document}</tex-math><mml:math id="M54"><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2019_1861_Article_IEq24.gif"/></alternatives></inline-formula> and the relative proportions of each gene <italic>π</italic><sub><italic>ij</italic></sub>, since <italic>x</italic><sub><italic>ij</italic></sub>=<italic>t</italic><sub><italic>i</italic></sub><italic>π</italic><sub><italic>ij</italic></sub>. The total number of UMI counts <inline-formula id="IEq25"><alternatives><tex-math id="M55">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$n_{i}=\sum _{j} y_{ij}$\end{document}</tex-math><mml:math id="M56"><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2019_1861_Article_IEq25.gif"/></alternatives></inline-formula> does not estimate <italic>t</italic><sub><italic>i</italic></sub>. However, under multinomial sampling, the UMI relative abundances <inline-formula id="IEq26"><alternatives><tex-math id="M57">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\hat {\pi }_{ij}=\frac {y_{ij}}{n_{i}}$\end{document}</tex-math><mml:math id="M58"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:math><inline-graphic xlink:href="13059_2019_1861_Article_IEq26.gif"/></alternatives></inline-formula> are MLEs for the true proportions <italic>π</italic><sub><italic>ij</italic></sub>. Note that it is possible that <inline-formula id="IEq27"><alternatives><tex-math id="M59">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\hat {\pi }_{ij}=0$\end{document}</tex-math><mml:math id="M60"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:math><inline-graphic xlink:href="13059_2019_1861_Article_IEq27.gif"/></alternatives></inline-formula> even though <italic>π</italic><sub><italic>ij</italic></sub>&gt;0. Because <inline-formula id="IEq28"><alternatives><tex-math id="M61">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\sum _{j} \hat {\pi }_{ij}=1$\end{document}</tex-math><mml:math id="M62"><mml:munder><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:math><inline-graphic xlink:href="13059_2019_1861_Article_IEq28.gif"/></alternatives></inline-formula> regardless of <italic>n</italic><sub><italic>i</italic></sub>, the use of multinomial MLEs is equivalent to the widespread practice of normalizing each cell by the total counts. Furthermore, the use of size factors <italic>s</italic><sub><italic>i</italic></sub>=<italic>n</italic><sub><italic>i</italic></sub>/<italic>m</italic> leads to <inline-formula id="IEq29"><alternatives><tex-math id="M63">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\hat {\pi }_{ij} \times m$\end{document}</tex-math><mml:math id="M64"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub><mml:mo>×</mml:mo><mml:mi>m</mml:mi></mml:math><inline-graphic xlink:href="13059_2019_1861_Article_IEq29.gif"/></alternatives></inline-formula> (if <italic>m</italic>=10<sup>6</sup>, this is CPM).</p>
      <p>Traditional bulk RNA-Seq experiments measured gene expression in read counts of many cells per sample rather than UMI counts of single cells. Gene counts from bulk RNA-Seq could thus range over several orders of magnitude. To facilitate comparison of these large numbers, many bulk RNA-Seq methods have relied on a logarithm transformation. This enables interpretation of differences in normalized counts as fold changes on a relative scale. Also, for count data, the variance of each gene is a function of its mean, and log transformation can help to prevent highly expressed outlier genes from overwhelming downstream analyses. Prior to the use of UMIs, scRNA-Seq experiments also produced read counts with wide ranging values, and a log transform was again employed. However, with single cell data, more than 90% of the genes might be observed as exact zeros, and log(0)=−<italic>∞</italic> which is not useful for data analysis. UMI data also contain large numbers of zeros, but do not contain very large counts since PCR duplicates have been removed. Nevertheless, log transformation has been commonly used with UMI data as well.</p>
      <p>The current standard is to transform the UMI counts as <inline-formula id="IEq30"><alternatives><tex-math id="M65">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\log _{2}(c+\hat {\pi }_{ij} \times m)$\end{document}</tex-math><mml:math id="M66"><mml:munder><mml:mrow><mml:mo>log</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:munder><mml:mo>(</mml:mo><mml:mi>c</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub><mml:mo>×</mml:mo><mml:mi>m</mml:mi><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="13059_2019_1861_Article_IEq30.gif"/></alternatives></inline-formula> where <italic>c</italic> is a pseudocount to avoid taking the log of zero, and typically <italic>c</italic>=1. As before, <italic>m</italic> is some constant such as 10<sup>6</sup> for CPM (see also [<xref ref-type="bibr" rid="CR54">54</xref>] for an alternative). Finally, the data are centered and scaled so that the mean of each gene across cells is 0, and the standard deviation is 1. This standardization of the data causes any subsequent computation of distances or dimension reduction to be invariant to constant additive or multiplicative scaling. For example, under Manhattan distance, <italic>d</italic>(<italic>x</italic>+<italic>c</italic>,<italic>y</italic>+<italic>c</italic>)=|<italic>x</italic>+<italic>c</italic>−(<italic>y</italic>+<italic>c</italic>)|=|<italic>x</italic>−<italic>y</italic>|=<italic>d</italic>(<italic>x</italic>,<italic>y</italic>). In particular, using size factors such as CPM instead of relative abundances leads to a rescaling of the pseudocount, and use of any pseudocount is equivalent to replacing the MLE with the MAP estimator. Let <italic>k</italic>=<italic>c</italic>/<italic>m</italic> and <italic>α</italic><sub><italic>i</italic></sub>=<italic>k</italic><italic>n</italic><sub><italic>i</italic></sub>. Then, the weight term in the MAP formula becomes <italic>w</italic><sub><italic>i</italic></sub>=<italic>J</italic><italic>k</italic>/(1+<italic>J</italic><italic>k</italic>)=<italic>w</italic> which is constant across all cells <italic>i</italic>. Furthermore <italic>J</italic><italic>k</italic>=<italic>w</italic>/(1−<italic>w</italic>), showing that:
<disp-formula id="Equd"><alternatives><tex-math id="M67">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $${}{\begin{aligned} \log_{2}(c+\hat{\pi}_{ij} \times m) &amp;= \log_{2}(k+\hat{\pi}_{ij}) + \log_{2}(m)\\ &amp;= \log_{2}\left(\frac{w}{1-w}\frac{1}{J}+\hat{\pi}_{ij}\right)+\log_{2}(m)\\ &amp;= \log_{2}\left(w\frac{1}{J}+(1-w)\hat{\pi}_{ij}\right)-\log_{2}(1-w)+\log_{2}(m)\\ &amp;= \log_{2}(\tilde{\pi}_{ij})+C \end{aligned}} $$ \end{document}</tex-math><mml:math id="M68"><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:munder><mml:mrow><mml:mo>log</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:munder><mml:mo>(</mml:mo><mml:mi>c</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub><mml:mo>×</mml:mo><mml:mi>m</mml:mi><mml:mo>)</mml:mo></mml:mtd><mml:mtd><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mo>log</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:munder><mml:mo>(</mml:mo><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>+</mml:mo><mml:munder><mml:mrow><mml:mo>log</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:munder><mml:mo>(</mml:mo><mml:mi>m</mml:mi><mml:mo>)</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mo>log</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:munder><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mfrac><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>w</mml:mi></mml:mrow></mml:mfrac><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>J</mml:mi></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>+</mml:mo><mml:munder><mml:mrow><mml:mo>log</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:munder><mml:mo>(</mml:mo><mml:mi>m</mml:mi><mml:mo>)</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mo>log</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:munder><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi>w</mml:mi><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>J</mml:mi></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>w</mml:mi><mml:mo>)</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>−</mml:mo><mml:munder><mml:mrow><mml:mo>log</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:munder><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>w</mml:mi><mml:mo>)</mml:mo><mml:mo>+</mml:mo><mml:munder><mml:mrow><mml:mo>log</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:munder><mml:mo>(</mml:mo><mml:mi>m</mml:mi><mml:mo>)</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mo>log</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:munder><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>+</mml:mo><mml:mi>C</mml:mi></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="13059_2019_1861_Article_Equd.gif" position="anchor"/></alternatives></disp-formula> Where <italic>C</italic> is a global constant that does not vary across cells or genes. For illustration, if <italic>c</italic>=1 and <italic>m</italic>=10<sup>6</sup>, this is equivalent to assuming a prior where all genes are equally expressed and for cell <italic>i</italic>, a weight of <italic>w</italic>=<italic>J</italic>/(10<sup>6</sup>+<italic>J</italic>) is given to the prior relative to the MLE. Since the number of genes <italic>J</italic> is on the order of 10<sup>4</sup>, we have <italic>w</italic>≈.01. The prior sample size for cell <italic>i</italic> is <italic>J</italic><italic>α</italic><sub><italic>i</italic></sub>=10<sup>−6</sup><italic>J</italic><italic>n</italic><sub><italic>i</italic></sub>≈.01×<italic>n</italic><sub><italic>i</italic></sub> where <italic>n</italic><sub><italic>i</italic></sub> is the data sample size. The standard transformation is therefore equivalent to using a weak prior to obtain a MAP estimate of the relative abundances, then log transforming before dimension reduction.</p>
      <p>In most scRNA-Seq datasets, the total number of UMIs <italic>n</italic><sub><italic>i</italic></sub> for some cells may be significantly less than the constant <italic>m</italic>. For these cells, the size factors <italic>s</italic><sub><italic>i</italic></sub>=<italic>n</italic><sub><italic>i</italic></sub>/<italic>m</italic> are less than 1. Therefore, after normalization (dividing by size factor), the counts are scaled up to match the target size of <italic>m</italic>. Due to the discreteness of counts, this introduces a bias after log transformation, if the pseudocount is small (or equivalently, if <italic>m</italic> is large). For example, let <italic>c</italic>=1 and <italic>m</italic>=10<sup>6</sup> (CPM). If <italic>n</italic><sub><italic>i</italic></sub>=10<sup>4</sup> for a particular cell, we have <italic>s</italic><sub><italic>i</italic></sub>=.01. A raw count of <italic>y</italic><sub><italic>ij</italic></sub>=1 for this cell is normalized to 1/.01=100 and transformed to log2(1+100)=6.7. For this cell, on the log scale, there cannot be any values between 0 and 6.7 because fractional UMI counts cannot be observed and log2(1+0)=0. Small pseudocounts and small size factors combined with log transform arbitrarily exaggerate the difference between a zero count and a small nonzero count. As previously shown, this scenario is equivalent to using MAP estimation of <italic>π</italic><sub><italic>ij</italic></sub> with a weak prior. To combat this distortion, one may attempt to strengthen the prior to regularize <inline-formula id="IEq31"><alternatives><tex-math id="M69">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\tilde {\pi }_{ij}$\end{document}</tex-math><mml:math id="M70"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2019_1861_Article_IEq31.gif"/></alternatives></inline-formula> estimation at the cost of additional bias, as advocated by [<xref ref-type="bibr" rid="CR21">21</xref>]. An extreme case occurs when <italic>c</italic>=1 and <italic>m</italic>=1. Here, the prior sample size is <italic>J</italic><italic>n</italic><sub><italic>i</italic></sub>, so almost all the weight is on the prior. The transform is then <inline-formula id="IEq32"><alternatives><tex-math id="M71">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\log _{2}(1+\hat {\pi }_{ij})$\end{document}</tex-math><mml:math id="M72"><mml:munder><mml:mrow><mml:mo>log</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:munder><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="13059_2019_1861_Article_IEq32.gif"/></alternatives></inline-formula>. But this function is approximately linear on the domain <inline-formula id="IEq33"><alternatives><tex-math id="M73">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$0\leq \hat {\pi }_{ij}\leq 1$\end{document}</tex-math><mml:math id="M74"><mml:mn>0</mml:mn><mml:mo>≤</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub><mml:mo>≤</mml:mo><mml:mn>1</mml:mn></mml:math><inline-graphic xlink:href="13059_2019_1861_Article_IEq33.gif"/></alternatives></inline-formula>. After centering and scaling, a linear transformation is vacuous.</p>
      <p>To summarize, log transformation with a weak prior (small size factor, such as CPM) introduces strong artificial distortion between zeros and nonzeros, while log tranformation with a strong prior (large size factor) is roughly equivalent to not log transforming the data.</p>
    </sec>
    <sec id="Sec17">
      <title>Generalized PCA</title>
      <p>PCA minimizes the mean squared error (MSE) between the data and a low-rank representation, or embedding. Let <italic>y</italic><sub><italic>ij</italic></sub> be the raw counts and <italic>z</italic><sub><italic>ij</italic></sub> be the normalized and transformed version of <italic>y</italic><sub><italic>ij</italic></sub> such as centered and scaled log-CPM (<italic>z</italic>-scores). The PCA objective function is:
<disp-formula id="Eque"><alternatives><tex-math id="M75">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\min_{u,v} \sum_{i,j}(z_{ij}-\vec{u}_{i}'\vec{v}_{j})^{2} $$ \end{document}</tex-math><mml:math id="M76"><mml:mrow><mml:munder><mml:mrow><mml:mo>min</mml:mo></mml:mrow><mml:mrow><mml:mi>u</mml:mi><mml:mo>,</mml:mo><mml:mi>v</mml:mi></mml:mrow></mml:munder><mml:munder><mml:mrow><mml:mo mathsize="big">∑</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:munder><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>u</mml:mi></mml:mrow><mml:mo>→</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mo>→</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math><graphic xlink:href="13059_2019_1861_Article_Eque.gif" position="anchor"/></alternatives></disp-formula> where <inline-formula id="IEq34"><alternatives><tex-math id="M77">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\vec {u}_{i},\vec {v}_{j}\in \mathbb {R}^{L}$\end{document}</tex-math><mml:math id="M78"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>u</mml:mi></mml:mrow><mml:mo>→</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mo>→</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi>ℝ</mml:mi></mml:mrow><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="13059_2019_1861_Article_IEq34.gif"/></alternatives></inline-formula> for <italic>i</italic>=1,…,<italic>I</italic>, <italic>j</italic>=1,…,<italic>J</italic>. The <inline-formula id="IEq35"><alternatives><tex-math id="M79">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\vec {u}_{i}$\end{document}</tex-math><mml:math id="M80"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>u</mml:mi></mml:mrow><mml:mo>→</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2019_1861_Article_IEq35.gif"/></alternatives></inline-formula> are called factors or principal components, and the <inline-formula id="IEq36"><alternatives><tex-math id="M81">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\vec {v}_{j}$\end{document}</tex-math><mml:math id="M82"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mo>→</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2019_1861_Article_IEq36.gif"/></alternatives></inline-formula> are called loadings. The number of latent dimensions <italic>L</italic> controls the complexity of the model. Minimization of the MSE is equivalent to minimizing the Euclidean distance metric between the embedding and the data. It is also equivalent to maximizing the likelihood of a Gaussian model:
<disp-formula id="Equf"><alternatives><tex-math id="M83">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$z_{ij}\sim\mathcal{N}\left(\vec{u}_{i}'\vec{v}_{j},\sigma^{2}\right) $$ \end{document}</tex-math><mml:math id="M84"><mml:mrow><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub><mml:mo>∼</mml:mo><mml:mi mathvariant="script">N</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>u</mml:mi></mml:mrow><mml:mo>→</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msubsup><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mo>→</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfenced></mml:mrow></mml:math><graphic xlink:href="13059_2019_1861_Article_Equf.gif" position="anchor"/></alternatives></disp-formula> If we replace the Gaussian model with a Poisson, which approximates the multinomial, we can directly model the UMI counts as:
<disp-formula id="Equg"><alternatives><tex-math id="M85">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$y_{ij}\sim \text{Poi}\left(n_{i}\exp\{\vec{u}_{i}'\vec{v}_{j}\}\right) $$ \end{document}</tex-math><mml:math id="M86"><mml:mrow><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub><mml:mo>∼</mml:mo><mml:mtext>Poi</mml:mtext><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>exp</mml:mo><mml:mo>{</mml:mo><mml:munderover><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>u</mml:mi></mml:mrow><mml:mo>→</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mo>→</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>}</mml:mo></mml:mrow></mml:mfenced></mml:mrow></mml:math><graphic xlink:href="13059_2019_1861_Article_Equg.gif" position="anchor"/></alternatives></disp-formula> or alternatively, in the case of overdispersion, we may approximate the Dirichlet-multinomial using a negative binomial likelihood:
<disp-formula id="Equh"><alternatives><tex-math id="M87">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$y_{ij}\sim NB\left(n_{i}\exp\{\vec{u}_{i}'\vec{v}_{j}\};~\phi_{j}\right) $$ \end{document}</tex-math><mml:math id="M88"><mml:mrow><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub><mml:mo>∼</mml:mo><mml:mtext mathvariant="italic">NB</mml:mtext><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>exp</mml:mo><mml:mo>{</mml:mo><mml:munderover><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>u</mml:mi></mml:mrow><mml:mo>→</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mo>→</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>}</mml:mo><mml:mo>;</mml:mo><mml:mspace width="1em"/><mml:msub><mml:mrow><mml:mi>ϕ</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:math><graphic xlink:href="13059_2019_1861_Article_Equh.gif" position="anchor"/></alternatives></disp-formula> We define the <italic>linear predictor</italic> as <inline-formula id="IEq37"><alternatives><tex-math id="M89">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\eta _{ij} = \log n_{i} + \vec {u}_{i}'\vec {v}_{j}$\end{document}</tex-math><mml:math id="M90"><mml:msub><mml:mrow><mml:mi>η</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo>log</mml:mo><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>u</mml:mi></mml:mrow><mml:mo>→</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msubsup><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mo>→</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2019_1861_Article_IEq37.gif"/></alternatives></inline-formula>. It is clear that the mean <inline-formula id="IEq38"><alternatives><tex-math id="M91">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mu _{ij}=e^{\eta }_{ij}$\end{document}</tex-math><mml:math id="M92"><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow><mml:mrow><mml:mi>η</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2019_1861_Article_IEq38.gif"/></alternatives></inline-formula> appears in both the Poisson and negative binomial model statements, showing that the latent factors interact with the data only through the mean. We may then estimate <inline-formula id="IEq39"><alternatives><tex-math id="M93">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\vec {u}_{i}$\end{document}</tex-math><mml:math id="M94"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>u</mml:mi></mml:mrow><mml:mo>→</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2019_1861_Article_IEq39.gif"/></alternatives></inline-formula> and <inline-formula id="IEq40"><alternatives><tex-math id="M95">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\vec {v}_{j}$\end{document}</tex-math><mml:math id="M96"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mo>→</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2019_1861_Article_IEq40.gif"/></alternatives></inline-formula> (and <italic>ϕ</italic><sub><italic>j</italic></sub>) by maximizing the likelihood (in practice, adding a small L2 penalty to large parameter values improves numerical stability). A link function must be used since <inline-formula id="IEq41"><alternatives><tex-math id="M97">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\vec {u}_{i}$\end{document}</tex-math><mml:math id="M98"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>u</mml:mi></mml:mrow><mml:mo>→</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2019_1861_Article_IEq41.gif"/></alternatives></inline-formula> and <inline-formula id="IEq42"><alternatives><tex-math id="M99">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\vec {v}_{j}$\end{document}</tex-math><mml:math id="M100"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mo>→</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2019_1861_Article_IEq42.gif"/></alternatives></inline-formula> are real valued whereas the mean of a Poisson or negative binomial must be positive. The total UMIs <italic>n</italic><sub><italic>i</italic></sub> term is used as an offset since no normalization has taken place; alternative size factors <italic>s</italic><sub><italic>i</italic></sub> such as those from scran [<xref ref-type="bibr" rid="CR20">20</xref>] could be used in place of <italic>n</italic><sub><italic>i</italic></sub>. If the first element of each <inline-formula id="IEq43"><alternatives><tex-math id="M101">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\vec {u}_{i}$\end{document}</tex-math><mml:math id="M102"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>u</mml:mi></mml:mrow><mml:mo>→</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2019_1861_Article_IEq43.gif"/></alternatives></inline-formula> is constrained to equal 1, this induces a gene-specific intercept term in the first position of each <inline-formula id="IEq44"><alternatives><tex-math id="M103">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\vec {v}_{j}$\end{document}</tex-math><mml:math id="M104"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mo>→</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2019_1861_Article_IEq44.gif"/></alternatives></inline-formula>, which is analogous to centering. Otherwise, the model is very similar to that of PCA; it is simply optimizing a different objective function. Unfortunately, MLEs for <inline-formula id="IEq45"><alternatives><tex-math id="M105">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\vec {u}_{i}$\end{document}</tex-math><mml:math id="M106"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>u</mml:mi></mml:mrow><mml:mo>→</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2019_1861_Article_IEq45.gif"/></alternatives></inline-formula> and <inline-formula id="IEq46"><alternatives><tex-math id="M107">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\vec {v}_{j}$\end{document}</tex-math><mml:math id="M108"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mo>→</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2019_1861_Article_IEq46.gif"/></alternatives></inline-formula> cannot be expressed in closed form, so an iterative Fisher scoring procedure is necessary. We refer to this model as GLM-PCA [<xref ref-type="bibr" rid="CR55">55</xref>]. Just as PCA minimizes MSE, GLM-PCA minimizes a generalization of MSE called the <italic>deviance</italic> [<xref ref-type="bibr" rid="CR56">56</xref>]. While generalized PCA was originally proposed by [<xref ref-type="bibr" rid="CR31">31</xref>] (see also [<xref ref-type="bibr" rid="CR57">57</xref>] and [<xref ref-type="bibr" rid="CR58">58</xref>]), our implementation is novel in that it allows for intercept terms, offsets, overdispersion, and non-canonical link functions. We also use a blockwise update for optimization which we found to be more numerically stable than that of [<xref ref-type="bibr" rid="CR31">31</xref>]; we iterate over latent dimensions <italic>l</italic> rather than rows or columns. This technique is inspired by non-negative matrix factorization algorithms such as hierarchical alternating least squares and rank-one residue iteration, see [<xref ref-type="bibr" rid="CR59">59</xref>] for a review.</p>
      <p>As an illustration, consider GLM-PCA with the Poisson approximation to a multinomial likelihood. The objective function to be minimized is simply the overall deviance:
<disp-formula id="Equi"><alternatives><tex-math id="M109">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{array}{*{20}l} D &amp;= \sum_{i,j} y_{ij}\log\left(\frac{y_{ij}}{\mu_{ij}}\right)-(y_{ij}-\mu_{ij})\\ \log\mu_{ij} &amp;= \eta_{ij} = \log s_{i} + \vec{u}_{i}'\vec{v}_{j} = \log s_{i} + v_{j1} + \sum_{l=2}^{L} u_{il}v_{jl} \end{array} $$ \end{document}</tex-math><mml:math id="M110"><mml:mtable class="align" columnalign="left"><mml:mtr><mml:mtd class="align-1"><mml:mi>D</mml:mi></mml:mtd><mml:mtd class="align-2"><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mo mathsize="big">∑</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub><mml:mo>log</mml:mo><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:mfenced><mml:mo>−</mml:mo><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mspace width="2em"/></mml:mtd><mml:mtd><mml:mspace width="2em"/></mml:mtd></mml:mtr><mml:mtr><mml:mtd class="align-1"><mml:mo>log</mml:mo><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub></mml:mtd><mml:mtd class="align-2"><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>η</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo>log</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>u</mml:mi></mml:mrow><mml:mo>→</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msubsup><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mo>→</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo>log</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo mathsize="big">∑</mml:mo></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>u</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">il</mml:mtext></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">jl</mml:mtext></mml:mrow></mml:msub><mml:mspace width="2em"/></mml:mtd><mml:mtd><mml:mspace width="2em"/></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="13059_2019_1861_Article_Equi.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>where <italic>s</italic><sub><italic>i</italic></sub> is a fixed size factor such as the total number of UMIs (<italic>n</italic><sub><italic>i</italic></sub>). The optimization proceeds by taking derivatives with respect to the unknown parameters: <italic>v</italic><sub><italic>j</italic>1</sub> is a gene-specific intercept term, and the remaining <italic>u</italic><sub><italic>il</italic></sub> and <italic>v</italic><sub><italic>jl</italic></sub> are the latent factors.</p>
      <p>The GLM-PCA method is most concordant to the data-generating mechanism since all aspects of the pipeline are integrated into a coherent model rather than being dealt with through sequential normalizations and transformations. The interpretation of the <inline-formula id="IEq47"><alternatives><tex-math id="M111">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\vec {u}_{i}$\end{document}</tex-math><mml:math id="M112"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>u</mml:mi></mml:mrow><mml:mo>→</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2019_1861_Article_IEq47.gif"/></alternatives></inline-formula> and <inline-formula id="IEq48"><alternatives><tex-math id="M113">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\vec {v}_{j}$\end{document}</tex-math><mml:math id="M114"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mo>→</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2019_1861_Article_IEq48.gif"/></alternatives></inline-formula> vectors is the same as in PCA. For example, suppose we set the number of latent dimensions to 2 (i.e., <italic>L</italic>=3 to account for the intercept). We can plot <italic>u</italic><sub><italic>i</italic>2</sub> on the horizontal axis and <italic>u</italic><sub><italic>i</italic>3</sub> on the vertical axis for each cell <italic>i</italic> to visualize the relationships between cells such as gradients or clusters. In this way, the <inline-formula id="IEq49"><alternatives><tex-math id="M115">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\vec {u}_{i}$\end{document}</tex-math><mml:math id="M116"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>u</mml:mi></mml:mrow><mml:mo>→</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2019_1861_Article_IEq49.gif"/></alternatives></inline-formula> and <inline-formula id="IEq50"><alternatives><tex-math id="M117">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\vec {v}_{j}$\end{document}</tex-math><mml:math id="M118"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mo>→</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2019_1861_Article_IEq50.gif"/></alternatives></inline-formula> capture biological variability such as differentially expressed genes.</p>
    </sec>
    <sec id="Sec18">
      <title>Residuals and <italic>z</italic>-scores</title>
      <p>Just as mean squared error can be computed by taking the sum of squared residuals under a Gaussian likelihood, the deviance is equal to the sum of squared <italic>deviance residuals</italic> [<xref ref-type="bibr" rid="CR56">56</xref>]. Since deviance residuals are not well-defined for the multinomial distribution, we adopt the binomial approximation. The deviance residual for gene <italic>j</italic> in cell <italic>i</italic> is given by:
<disp-formula id="Equj"><alternatives><tex-math id="M119">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $${}r^{(d)}_{ij}=\text{sign}(y_{ij}-\hat{\mu}_{ij})\sqrt{2y_{ij}\log\frac{y_{ij}}{\hat{\mu}_{ij}} + 2(n_{i}-y_{ij})\log\frac{n_{i}-y_{ij}}{n_{i}-\hat{\mu}_{ij}}} $$ \end{document}</tex-math><mml:math id="M120"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>d</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mtext>sign</mml:mtext><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:msqrt><mml:mrow><mml:mn>2</mml:mn><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub><mml:mo>log</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mn>2</mml:mn><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>log</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:msqrt></mml:mrow></mml:math><graphic xlink:href="13059_2019_1861_Article_Equj.gif" position="anchor"/></alternatives></disp-formula> where under the null model of constant gene expression across cells, <inline-formula id="IEq51"><alternatives><tex-math id="M121">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\hat {\mu }_{ij}=n_{i}\hat {\pi }_{j}$\end{document}</tex-math><mml:math id="M122"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2019_1861_Article_IEq51.gif"/></alternatives></inline-formula>. The deviance residuals are the result of regressing away this null model. An alternative to deviance residuals is the Pearson residual, which is simply the difference in observed and expected values scaled by an estimate of the standard deviation. For the binomial, this is:
<disp-formula id="Equk"><alternatives><tex-math id="M123">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$r^{(p)}_{ij}=\frac{y_{ij}-\hat{\mu}_{ij}}{\sqrt{\hat{\mu}_{ij}-\frac{1}{n_{i}}\hat{\mu}_{ij}^{2}}} $$ \end{document}</tex-math><mml:math id="M124"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>p</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msqrt><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:msqrt></mml:mrow></mml:mfrac></mml:mrow></mml:math><graphic xlink:href="13059_2019_1861_Article_Equk.gif" position="anchor"/></alternatives></disp-formula> According to the theory of generalized linear models (GLM), both types of residuals follow approximately a normal distribution with mean zero if the null model is correct [<xref ref-type="bibr" rid="CR56">56</xref>]. Deviance residuals tend to be more symmetric than Pearson residuals. In practice, the residuals may not have mean exactly equal to zero, and may be standardized by scaling their gene-specific standard deviation just as in the Gaussian case. Recently, Pearson residuals based on a negative binomial null model have also been independently proposed as the sctransform method [<xref ref-type="bibr" rid="CR60">60</xref>].</p>
      <p>The <italic>z</italic>-score is simply the Pearson residual where we replace the multinomial likelihood with a Gaussian (normal) likelihood and use normalized values instead of raw UMI counts. Let <italic>q</italic><sub><italic>ij</italic></sub> be the normalized (possibly log-transformed) expression of gene <italic>j</italic> in cell <italic>i</italic> without centering and scaling. The null model is that the expression of the gene is constant across all cells:
<disp-formula id="Equl"><alternatives><tex-math id="M125">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$q_{ij}\sim\mathcal{N}\left(\mu_{j},~\sigma^{2}_{j}\right) $$ \end{document}</tex-math><mml:math id="M126"><mml:mrow><mml:msub><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub><mml:mo>∼</mml:mo><mml:mi mathvariant="script">N</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mspace width="1em"/><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced></mml:mrow></mml:math><graphic xlink:href="13059_2019_1861_Article_Equl.gif" position="anchor"/></alternatives></disp-formula> The MLEs are <inline-formula id="IEq52"><alternatives><tex-math id="M127">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\hat {\mu }_{j} = \frac {1}{I}\sum _{i} q_{ij}$\end{document}</tex-math><mml:math id="M128"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>I</mml:mi></mml:mrow></mml:mfrac><mml:munder><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2019_1861_Article_IEq52.gif"/></alternatives></inline-formula>, <inline-formula id="IEq53"><alternatives><tex-math id="M129">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\hat {\sigma }^{2}_{j} = \frac {1}{I}\sum _{i} (q_{ij}-\hat {\mu }_{j})^{2}$\end{document}</tex-math><mml:math id="M130"><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>I</mml:mi></mml:mrow></mml:mfrac><mml:munder><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:munder><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="13059_2019_1861_Article_IEq53.gif"/></alternatives></inline-formula>, and the <italic>z</italic>-scores equal the Pearson residuals <inline-formula id="IEq54"><alternatives><tex-math id="M131">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$z_{ij}=(q_{ij}-\hat {\mu }_{j})/\hat {\sigma }_{j}$\end{document}</tex-math><mml:math id="M132"><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>/</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2019_1861_Article_IEq54.gif"/></alternatives></inline-formula>.</p>
      <p>We compared the accuracy of the residuals approximations by simulating 150 cells in 3 clusters of 50 cells each with 5000 genes, of which 500 were differentially expressed across clusters (informative genes). We also created 2 batches, batch 1 with total counts of 1000 and batch 2 with total counts of 2000. Each cluster had an equal number of cells in the 2 batches. We then ran GLM-PCA on the raw counts, PCA on <italic>l</italic><italic>o</italic><italic>g</italic><sub>2</sub>(1+<italic>C</italic><italic>P</italic><italic>M</italic>), PCA on deviance residuals, and PCA on Pearson residuals with <italic>L</italic>=2 dimensions.</p>
    </sec>
    <sec id="Sec19">
      <title>Feature selection using deviance</title>
      <p>Genes with constant expression across cells are not informative. Such genes may be described by the multinomial null model where <italic>π</italic><sub><italic>ij</italic></sub>=<italic>π</italic><sub><italic>j</italic></sub>. Goodness of fit to a multinomial distribution can be quantified using deviance, which is twice the difference in log-likelihoods comparing a saturated model to a fitted model. The multinomial deviance is a joint deviance across all genes,and for this reason is not helpful for screening informative genes. Instead, one may use the binomial deviance as an approximation:
<disp-formula id="Equm"><alternatives><tex-math id="M133">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$D_{j} = 2\sum_{i}\left[y_{ij}\log\frac{y_{ij}}{n_{i}\hat{\pi}_{j}} + (n_{i}-y_{ij})\log\frac{(n_{i}-y_{ij})}{n_{i}(1-\hat{\pi}_{j})}\right] $$ \end{document}</tex-math><mml:math id="M134"><mml:mrow><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:munder><mml:mrow><mml:mo mathsize="big">∑</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:munder><mml:mfenced close="]" open="[" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub><mml:mo>log</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>log</mml:mo><mml:mfrac><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mfrac></mml:mrow></mml:mfenced></mml:mrow></mml:math><graphic xlink:href="13059_2019_1861_Article_Equm.gif" position="anchor"/></alternatives></disp-formula> A large deviance value indicates the model in question provides a poor fit. Those genes with biological variation across cells will be poorly fit by the null model and will have the largest deviances. By ranking genes according to their deviances, one may thus obtain highly deviant genes as an alternative to highly variable or highly expressed genes.</p>
    </sec>
    <sec id="Sec20">
      <title>Systematic comparison of methods</title>
      <p>We considered combinations of the following methods and parameter settings, following [<xref ref-type="bibr" rid="CR15">15</xref>]. Italics indicate methods proposed in this manuscript. Feature selection: highly expressed genes, highly variable genes, and <italic>highly deviant genes</italic>. We did not compare against highly dropout genes because [<xref ref-type="bibr" rid="CR15">15</xref>] found this method to have poor downstream clustering performance for UMI counts and it is not as widely used in the literature. The numbers of genes are 60, 300, 1500. Normalization, transformation, and dimension reduction: PCA on log-CPM <italic>z</italic>-scores, ZINB-WAVE [<xref ref-type="bibr" rid="CR28">28</xref>], <italic>PCA on deviance residuals</italic>, <italic>PCA on Pearson residuals</italic>, and <italic>GLM-PCA</italic>. The numbers of latent dimensions are 10 and 30. Clustering algorithms are <italic>k</italic>-means [<xref ref-type="bibr" rid="CR61">61</xref>] and Seurat [<xref ref-type="bibr" rid="CR17">17</xref>]. The number of clusters is all values from 2 to 10, inclusive. Seurat resolutions are 0.05, 0.1, 0.2, 0.5, 0.8, 1, 1.2, 1.5, and 2.</p>
    </sec>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary information</title>
    <sec id="Sec21">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="13059_2019_1861_MOESM1_ESM.pdf">
            <caption>
              <p><bold>Additional file 1</bold> Contains supplementary figures S1–S11 and tables S1–S4.</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
      <p>
        <supplementary-material content-type="local-data" id="MOESM2">
          <media xlink:href="13059_2019_1861_MOESM2_ESM.docx">
            <caption>
              <p><bold>Additional file 2</bold> Review history.</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher’s Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <sec>
    <title>Supplementary information</title>
    <p><bold>Supplementary information</bold> accompanies this paper at 10.1186/s13059-019-1861-6.</p>
  </sec>
  <ack>
    <title>Acknowledgements</title>
    <p>The authors thank Keegan Korthauer, Jeff Miller, Linglin Huang, Alejandro Reyes, Yered Pita-Juarez, Mike Love, Ziyi Li, and Kelly Street for the valuable suggestions.</p>
    <sec id="d29e5709">
      <title>Review history</title>
      <p>The review history is available as Additional file <xref rid="MOESM2" ref-type="media">2</xref>.</p>
    </sec>
  </ack>
  <notes notes-type="author-contribution">
    <title>Authors’ contributions</title>
    <p>SCH, MJA, and RAI identified the problem. FWT proposed, derived, and implemented the GLM-PCA model, its fast approximation using residuals, and feature selection using deviance. SCH, MJA, and RAI provided guidance on refining the methods and evaluation strategies. FWT and RAI wrote the draft manuscript, and revisions were suggested by SCH and MJA. All authors approved the final manuscript.</p>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>FWT was supported by NIH grant T32CA009337, SCH was supported by NIH grant R00HG009007, MJA was supported by an MGH Pathology Department startup fund, and RAI was supported by Chan-Zuckerberg Initiative grant CZI 2018-183142 and NIH grants R01HG005220, R01GM083084, and P41HG004059.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and materials</title>
    <p>All methods and assessments described in this manuscript are publicly available at <ext-link ext-link-type="uri" xlink:href="https://github.com/willtownes/scrna2019">https://github.com/willtownes/scrna2019</ext-link> [<xref ref-type="bibr" rid="CR62">62</xref>]. GLM-PCA is available as an R package from CRAN (<ext-link ext-link-type="uri" xlink:href="https://cran.r-project.org/web/packages/glmpca/index.html">https://cran.r-project.org/web/packages/glmpca/index.html</ext-link>). The source code is licensed under LGPL-3.</p>
    <p>All datasets used in the study were obtained from public sources (Table <xref rid="Tab1" ref-type="table">1</xref>). The three Zheng datasets (ERCCs, monocytes, and 68K PBMCs) [<xref ref-type="bibr" rid="CR5">5</xref>] were downloaded from <ext-link ext-link-type="uri" xlink:href="https://support.10xgenomics.com/single-cell-gene-expression/datasets">https://support.10xgenomics.com/single-cell-gene-expression/datasets</ext-link>. The Duo datasets were obtained through the bioconductor package DuoClustering2018 [<xref ref-type="bibr" rid="CR15">15</xref>]. The remaining three datasets had GEO accession numbers GSE77288 (Tung) [<xref ref-type="bibr" rid="CR32">32</xref>], GSE92332 (Haber) [<xref ref-type="bibr" rid="CR33">33</xref>], and GSE85241 (Muraro) [<xref ref-type="bibr" rid="CR34">34</xref>].</p>
  </notes>
  <notes>
    <title>Ethics approval and consent to participate</title>
    <p>Not applicable.</p>
  </notes>
  <notes>
    <title>Consent for publication</title>
    <p>Not applicable.</p>
  </notes>
  <notes notes-type="COI-statement">
    <title>Competing interests</title>
    <p>The authors declare that they have no competing interests.</p>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kalisky</surname>
            <given-names>Tomer</given-names>
          </name>
          <name>
            <surname>Oriel</surname>
            <given-names>Sarit</given-names>
          </name>
          <name>
            <surname>Bar-Lev</surname>
            <given-names>Tali Hana</given-names>
          </name>
          <name>
            <surname>Ben-Haim</surname>
            <given-names>Nissim</given-names>
          </name>
          <name>
            <surname>Trink</surname>
            <given-names>Ariel</given-names>
          </name>
          <name>
            <surname>Wineberg</surname>
            <given-names>Yishay</given-names>
          </name>
          <name>
            <surname>Kanter</surname>
            <given-names>Itamar</given-names>
          </name>
          <name>
            <surname>Gilad</surname>
            <given-names>Shlomit</given-names>
          </name>
          <name>
            <surname>Pyne</surname>
            <given-names>Saumyadipta</given-names>
          </name>
        </person-group>
        <article-title>A brief review of single-cell transcriptomic technologies</article-title>
        <source>Briefings in Functional Genomics</source>
        <year>2017</year>
        <volume>17</volume>
        <issue>1</issue>
        <fpage>64</fpage>
        <lpage>76</lpage>
        <pub-id pub-id-type="doi">10.1093/bfgp/elx019</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Svensson</surname>
            <given-names>Valentine</given-names>
          </name>
          <name>
            <surname>Vento-Tormo</surname>
            <given-names>Roser</given-names>
          </name>
          <name>
            <surname>Teichmann</surname>
            <given-names>Sarah A</given-names>
          </name>
        </person-group>
        <article-title>Exponential scaling of single-cell RNA-seq in the past decade</article-title>
        <source>Nature Protocols</source>
        <year>2018</year>
        <volume>13</volume>
        <issue>4</issue>
        <fpage>599</fpage>
        <lpage>604</lpage>
        <pub-id pub-id-type="doi">10.1038/nprot.2017.149</pub-id>
        <pub-id pub-id-type="pmid">29494575</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Macosko</surname>
            <given-names>Evan Z.</given-names>
          </name>
          <name>
            <surname>Basu</surname>
            <given-names>Anindita</given-names>
          </name>
          <name>
            <surname>Satija</surname>
            <given-names>Rahul</given-names>
          </name>
          <name>
            <surname>Nemesh</surname>
            <given-names>James</given-names>
          </name>
          <name>
            <surname>Shekhar</surname>
            <given-names>Karthik</given-names>
          </name>
          <name>
            <surname>Goldman</surname>
            <given-names>Melissa</given-names>
          </name>
          <name>
            <surname>Tirosh</surname>
            <given-names>Itay</given-names>
          </name>
          <name>
            <surname>Bialas</surname>
            <given-names>Allison R.</given-names>
          </name>
          <name>
            <surname>Kamitaki</surname>
            <given-names>Nolan</given-names>
          </name>
          <name>
            <surname>Martersteck</surname>
            <given-names>Emily M.</given-names>
          </name>
          <name>
            <surname>Trombetta</surname>
            <given-names>John J.</given-names>
          </name>
          <name>
            <surname>Weitz</surname>
            <given-names>David A.</given-names>
          </name>
          <name>
            <surname>Sanes</surname>
            <given-names>Joshua R.</given-names>
          </name>
          <name>
            <surname>Shalek</surname>
            <given-names>Alex K.</given-names>
          </name>
          <name>
            <surname>Regev</surname>
            <given-names>Aviv</given-names>
          </name>
          <name>
            <surname>McCarroll</surname>
            <given-names>Steven A.</given-names>
          </name>
        </person-group>
        <article-title>Highly Parallel Genome-wide Expression Profiling of Individual Cells Using Nanoliter Droplets</article-title>
        <source>Cell</source>
        <year>2015</year>
        <volume>161</volume>
        <issue>5</issue>
        <fpage>1202</fpage>
        <lpage>1214</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2015.05.002</pub-id>
        <pub-id pub-id-type="pmid">26000488</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Klein</surname>
            <given-names>Allon M.</given-names>
          </name>
          <name>
            <surname>Mazutis</surname>
            <given-names>Linas</given-names>
          </name>
          <name>
            <surname>Akartuna</surname>
            <given-names>Ilke</given-names>
          </name>
          <name>
            <surname>Tallapragada</surname>
            <given-names>Naren</given-names>
          </name>
          <name>
            <surname>Veres</surname>
            <given-names>Adrian</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>Victor</given-names>
          </name>
          <name>
            <surname>Peshkin</surname>
            <given-names>Leonid</given-names>
          </name>
          <name>
            <surname>Weitz</surname>
            <given-names>David A.</given-names>
          </name>
          <name>
            <surname>Kirschner</surname>
            <given-names>Marc W.</given-names>
          </name>
        </person-group>
        <article-title>Droplet Barcoding for Single-Cell Transcriptomics Applied to Embryonic Stem Cells</article-title>
        <source>Cell</source>
        <year>2015</year>
        <volume>161</volume>
        <issue>5</issue>
        <fpage>1187</fpage>
        <lpage>1201</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2015.04.044</pub-id>
        <pub-id pub-id-type="pmid">26000487</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5</label>
      <mixed-citation publication-type="other">Zheng GXY, Terry JM, Belgrader P, Ryvkin P, Bent ZW, Wilson R, Ziraldo SB, Wheeler TD, McDermott GP, Zhu J, Gregory MT, Shuga J, Montesclaros L, Underwood JG, Masquelier DA, Nishimura SY, Schnall-Levin M, Wyatt PW, Hindson CM, Bharadwaj R, Wong A, Ness KD, Beppu LW, Deeg HJ, McFarland C, Loeb KR, Valente WJ, Ericson NG, Stevens EA, Radich JP, Mikkelsen TS, Hindson BJ, Bielas JH. Massively parallel digital transcriptional profiling of single cells. Nat Commun. 2017; 8:14049. 10.1038/ncomms14049.</mixed-citation>
    </ref>
    <ref id="CR6">
      <label>6</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dal Molin</surname>
            <given-names>Alessandra</given-names>
          </name>
          <name>
            <surname>Di Camillo</surname>
            <given-names>Barbara</given-names>
          </name>
        </person-group>
        <article-title>How to design a single-cell RNA-sequencing experiment: pitfalls, challenges and perspectives</article-title>
        <source>Briefings in Bioinformatics</source>
        <year>2018</year>
        <volume>20</volume>
        <issue>4</issue>
        <fpage>1384</fpage>
        <lpage>1394</lpage>
        <pub-id pub-id-type="doi">10.1093/bib/bby007</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Qiu</surname>
            <given-names>Xiaojie</given-names>
          </name>
          <name>
            <surname>Hill</surname>
            <given-names>Andrew</given-names>
          </name>
          <name>
            <surname>Packer</surname>
            <given-names>Jonathan</given-names>
          </name>
          <name>
            <surname>Lin</surname>
            <given-names>Dejun</given-names>
          </name>
          <name>
            <surname>Ma</surname>
            <given-names>Yi-An</given-names>
          </name>
          <name>
            <surname>Trapnell</surname>
            <given-names>Cole</given-names>
          </name>
        </person-group>
        <article-title>Single-cell mRNA quantification and differential analysis with Census</article-title>
        <source>Nature Methods</source>
        <year>2017</year>
        <volume>14</volume>
        <issue>3</issue>
        <fpage>309</fpage>
        <lpage>315</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.4150</pub-id>
        <pub-id pub-id-type="pmid">28114287</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Picelli</surname>
            <given-names>Simone</given-names>
          </name>
          <name>
            <surname>Björklund</surname>
            <given-names>Åsa K</given-names>
          </name>
          <name>
            <surname>Faridani</surname>
            <given-names>Omid R</given-names>
          </name>
          <name>
            <surname>Sagasser</surname>
            <given-names>Sven</given-names>
          </name>
          <name>
            <surname>Winberg</surname>
            <given-names>Gösta</given-names>
          </name>
          <name>
            <surname>Sandberg</surname>
            <given-names>Rickard</given-names>
          </name>
        </person-group>
        <article-title>Smart-seq2 for sensitive full-length transcriptome profiling in single cells</article-title>
        <source>Nature Methods</source>
        <year>2013</year>
        <volume>10</volume>
        <issue>11</issue>
        <fpage>1096</fpage>
        <lpage>1098</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.2639</pub-id>
        <pub-id pub-id-type="pmid">24056875</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kolodziejczyk</surname>
            <given-names>Aleksandra A.</given-names>
          </name>
          <name>
            <surname>Kim</surname>
            <given-names>Jong Kyoung</given-names>
          </name>
          <name>
            <surname>Svensson</surname>
            <given-names>Valentine</given-names>
          </name>
          <name>
            <surname>Marioni</surname>
            <given-names>John C.</given-names>
          </name>
          <name>
            <surname>Teichmann</surname>
            <given-names>Sarah A.</given-names>
          </name>
        </person-group>
        <article-title>The Technology and Biology of Single-Cell RNA Sequencing</article-title>
        <source>Molecular Cell</source>
        <year>2015</year>
        <volume>58</volume>
        <issue>4</issue>
        <fpage>610</fpage>
        <lpage>620</lpage>
        <pub-id pub-id-type="doi">10.1016/j.molcel.2015.04.005</pub-id>
        <pub-id pub-id-type="pmid">26000846</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Islam</surname>
            <given-names>Saiful</given-names>
          </name>
          <name>
            <surname>Zeisel</surname>
            <given-names>Amit</given-names>
          </name>
          <name>
            <surname>Joost</surname>
            <given-names>Simon</given-names>
          </name>
          <name>
            <surname>La Manno</surname>
            <given-names>Gioele</given-names>
          </name>
          <name>
            <surname>Zajac</surname>
            <given-names>Pawel</given-names>
          </name>
          <name>
            <surname>Kasper</surname>
            <given-names>Maria</given-names>
          </name>
          <name>
            <surname>Lönnerberg</surname>
            <given-names>Peter</given-names>
          </name>
          <name>
            <surname>Linnarsson</surname>
            <given-names>Sten</given-names>
          </name>
        </person-group>
        <article-title>Quantitative single-cell RNA-seq with unique molecular identifiers</article-title>
        <source>Nature Methods</source>
        <year>2013</year>
        <volume>11</volume>
        <issue>2</issue>
        <fpage>163</fpage>
        <lpage>166</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.2772</pub-id>
        <pub-id pub-id-type="pmid">24363023</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Grün</surname>
            <given-names>Dominic</given-names>
          </name>
          <name>
            <surname>Kester</surname>
            <given-names>Lennart</given-names>
          </name>
          <name>
            <surname>van Oudenaarden</surname>
            <given-names>Alexander</given-names>
          </name>
        </person-group>
        <article-title>Validation of noise models for single-cell transcriptomics</article-title>
        <source>Nature Methods</source>
        <year>2014</year>
        <volume>11</volume>
        <issue>6</issue>
        <fpage>637</fpage>
        <lpage>640</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.2930</pub-id>
        <pub-id pub-id-type="pmid">24747814</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lun</surname>
            <given-names>Aaron T.L.</given-names>
          </name>
          <name>
            <surname>McCarthy</surname>
            <given-names>Davis J.</given-names>
          </name>
          <name>
            <surname>Marioni</surname>
            <given-names>John C.</given-names>
          </name>
        </person-group>
        <article-title>A step-by-step workflow for low-level analysis of single-cell RNA-seq data with Bioconductor</article-title>
        <source>F1000Research</source>
        <year>2016</year>
        <volume>5</volume>
        <fpage>2122</fpage>
        <?supplied-pmid 27909575?>
        <pub-id pub-id-type="pmid">27909575</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13</label>
      <mixed-citation publication-type="other">McCarthy DJ, Campbell KR, Lun ATL, Wills QF. Scater: pre-processing, quality control, normalization and visualization of single-cell RNA-seq data in R. Bioinformatics. 2017; 33(8):1179–86. 10.1093/bioinformatics/btw777.</mixed-citation>
    </ref>
    <ref id="CR14">
      <label>14</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Andrews</surname>
            <given-names>Tallulah S.</given-names>
          </name>
          <name>
            <surname>Hemberg</surname>
            <given-names>Martin</given-names>
          </name>
        </person-group>
        <article-title>Identifying cell populations with scRNASeq</article-title>
        <source>Molecular Aspects of Medicine</source>
        <year>2018</year>
        <volume>59</volume>
        <fpage>114</fpage>
        <lpage>122</lpage>
        <pub-id pub-id-type="doi">10.1016/j.mam.2017.07.002</pub-id>
        <pub-id pub-id-type="pmid">28712804</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Duò</surname>
            <given-names>Angelo</given-names>
          </name>
          <name>
            <surname>Robinson</surname>
            <given-names>Mark D.</given-names>
          </name>
          <name>
            <surname>Soneson</surname>
            <given-names>Charlotte</given-names>
          </name>
        </person-group>
        <article-title>A systematic performance evaluation of clustering methods for single-cell RNA-seq data</article-title>
        <source>F1000Research</source>
        <year>2018</year>
        <volume>7</volume>
        <fpage>1141</fpage>
        <pub-id pub-id-type="doi">10.12688/f1000research.15666.1</pub-id>
        <pub-id pub-id-type="pmid">30271584</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Brennecke</surname>
            <given-names>Philip</given-names>
          </name>
          <name>
            <surname>Anders</surname>
            <given-names>Simon</given-names>
          </name>
          <name>
            <surname>Kim</surname>
            <given-names>Jong Kyoung</given-names>
          </name>
          <name>
            <surname>Kołodziejczyk</surname>
            <given-names>Aleksandra A</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>Xiuwei</given-names>
          </name>
          <name>
            <surname>Proserpio</surname>
            <given-names>Valentina</given-names>
          </name>
          <name>
            <surname>Baying</surname>
            <given-names>Bianka</given-names>
          </name>
          <name>
            <surname>Benes</surname>
            <given-names>Vladimir</given-names>
          </name>
          <name>
            <surname>Teichmann</surname>
            <given-names>Sarah A</given-names>
          </name>
          <name>
            <surname>Marioni</surname>
            <given-names>John C</given-names>
          </name>
          <name>
            <surname>Heisler</surname>
            <given-names>Marcus G</given-names>
          </name>
        </person-group>
        <article-title>Accounting for technical noise in single-cell RNA-seq experiments</article-title>
        <source>Nature Methods</source>
        <year>2013</year>
        <volume>10</volume>
        <issue>11</issue>
        <fpage>1093</fpage>
        <lpage>1095</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.2645</pub-id>
        <pub-id pub-id-type="pmid">24056876</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Butler</surname>
            <given-names>Andrew</given-names>
          </name>
          <name>
            <surname>Hoffman</surname>
            <given-names>Paul</given-names>
          </name>
          <name>
            <surname>Smibert</surname>
            <given-names>Peter</given-names>
          </name>
          <name>
            <surname>Papalexi</surname>
            <given-names>Efthymia</given-names>
          </name>
          <name>
            <surname>Satija</surname>
            <given-names>Rahul</given-names>
          </name>
        </person-group>
        <article-title>Integrating single-cell transcriptomic data across different conditions, technologies, and species</article-title>
        <source>Nature Biotechnology</source>
        <year>2018</year>
        <volume>36</volume>
        <issue>5</issue>
        <fpage>411</fpage>
        <lpage>420</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.4096</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Andrews</surname>
            <given-names>Tallulah S</given-names>
          </name>
          <name>
            <surname>Hemberg</surname>
            <given-names>Martin</given-names>
          </name>
        </person-group>
        <article-title>M3Drop: dropout-based feature selection for scRNASeq</article-title>
        <source>Bioinformatics</source>
        <year>2018</year>
        <volume>35</volume>
        <issue>16</issue>
        <fpage>2865</fpage>
        <lpage>2867</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bty1044</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hotelling</surname>
            <given-names>H.</given-names>
          </name>
        </person-group>
        <article-title>Analysis of a complex of statistical variables into principal components</article-title>
        <source>Journal of Educational Psychology</source>
        <year>1933</year>
        <volume>24</volume>
        <issue>6</issue>
        <fpage>417</fpage>
        <lpage>441</lpage>
        <pub-id pub-id-type="doi">10.1037/h0071325</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20</label>
      <mixed-citation publication-type="other">Lun AT, Bach K, Marioni JC. Pooling across cells to normalize single-cell RNA sequencing data with many zero counts. Genome Biol. 2016; 17:75. 10.1186/s13059-016-0947-7.</mixed-citation>
    </ref>
    <ref id="CR21">
      <label>21</label>
      <mixed-citation publication-type="other">Lun A. Overcoming systematic errors caused by log-transformation of normalized single-cell RNA sequencing data. bioRxiv. 2018:404962. 10.1101/404962.</mixed-citation>
    </ref>
    <ref id="CR22">
      <label>22</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Warton</surname>
            <given-names>David I.</given-names>
          </name>
        </person-group>
        <article-title>Why you cannot transform your way out of trouble for small counts</article-title>
        <source>Biometrics</source>
        <year>2017</year>
        <volume>74</volume>
        <issue>1</issue>
        <fpage>362</fpage>
        <lpage>368</lpage>
        <pub-id pub-id-type="doi">10.1111/biom.12728</pub-id>
        <pub-id pub-id-type="pmid">28504821</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Vallejos</surname>
            <given-names>Catalina A</given-names>
          </name>
          <name>
            <surname>Risso</surname>
            <given-names>Davide</given-names>
          </name>
          <name>
            <surname>Scialdone</surname>
            <given-names>Antonio</given-names>
          </name>
          <name>
            <surname>Dudoit</surname>
            <given-names>Sandrine</given-names>
          </name>
          <name>
            <surname>Marioni</surname>
            <given-names>John C</given-names>
          </name>
        </person-group>
        <article-title>Normalizing single-cell RNA sequencing data: challenges and opportunities</article-title>
        <source>Nature Methods</source>
        <year>2017</year>
        <volume>14</volume>
        <issue>6</issue>
        <fpage>565</fpage>
        <lpage>571</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.4292</pub-id>
        <pub-id pub-id-type="pmid">28504683</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24</label>
      <mixed-citation publication-type="other">Finak G, McDavid A, Yajima M, Deng J, Gersuk V, Shalek AK, Slichter CK, Miller HW, McElrath MJ, Prlic M, Linsley PS, Gottardo R. MAST: a flexible statistical framework for assessing transcriptional changes and characterizing heterogeneity in single-cell RNA sequencing data. Genome Biol. 2015; 16:278. 10.1186/s13059-015-0844-5.</mixed-citation>
    </ref>
    <ref id="CR25">
      <label>25</label>
      <mixed-citation publication-type="other">Pierson E, Yau C. ZIFA: Dimensionality reduction for zero-inflated single-cell gene expression analysis. Genome Biol. 2015; 16:241. 10.1186/s13059-015-0805-z.</mixed-citation>
    </ref>
    <ref id="CR26">
      <label>26</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Liu</surname>
            <given-names>Serena</given-names>
          </name>
          <name>
            <surname>Trapnell</surname>
            <given-names>Cole</given-names>
          </name>
        </person-group>
        <article-title>Single-cell transcriptome sequencing: recent advances and remaining challenges</article-title>
        <source>F1000Research</source>
        <year>2016</year>
        <volume>5</volume>
        <fpage>182</fpage>
        <pub-id pub-id-type="doi">10.12688/f1000research.7223.1</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27</label>
      <mixed-citation publication-type="other">Lin P, Troup M, Ho JWK. CIDR: ultrafast and accurate clustering through imputation for single-cell RNA-seq data. Genome Biol. 2017; 18:59. 10.1186/s13059-017-1188-0.</mixed-citation>
    </ref>
    <ref id="CR28">
      <label>28</label>
      <mixed-citation publication-type="other">Risso D, Perraudeau F, Gribkova S, Dudoit S, Vert J-P. A general and flexible method for signal extraction from single-cell RNA-seq data. Nat Commun. 2018; 9(1):1–17. 10.1038/s41467-017-02554-5.</mixed-citation>
    </ref>
    <ref id="CR29">
      <label>29</label>
      <mixed-citation publication-type="other">Svensson V. Droplet scRNA-seq is not zero-inflated. bioRxiv. 2019:582064. 10.1101/582064.</mixed-citation>
    </ref>
    <ref id="CR30">
      <label>30</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hicks</surname>
            <given-names>Stephanie C</given-names>
          </name>
          <name>
            <surname>Townes</surname>
            <given-names>F William</given-names>
          </name>
          <name>
            <surname>Teng</surname>
            <given-names>Mingxiang</given-names>
          </name>
          <name>
            <surname>Irizarry</surname>
            <given-names>Rafael A</given-names>
          </name>
        </person-group>
        <article-title>Missing data and technical variability in single-cell RNA-sequencing experiments</article-title>
        <source>Biostatistics</source>
        <year>2017</year>
        <volume>19</volume>
        <issue>4</issue>
        <fpage>562</fpage>
        <lpage>578</lpage>
        <pub-id pub-id-type="doi">10.1093/biostatistics/kxx053</pub-id>
      </element-citation>
    </ref>
    <ref id="CR31">
      <label>31</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Collins</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Dasgupta</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Schapire</surname>
            <given-names>RE</given-names>
          </name>
        </person-group>
        <person-group person-group-type="editor">
          <name>
            <surname>Dietterich</surname>
            <given-names>TG</given-names>
          </name>
          <name>
            <surname>Becker</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Ghahramani</surname>
            <given-names>Z</given-names>
          </name>
        </person-group>
        <article-title>A generalization of principal components analysis to the exponential family</article-title>
        <source>Advances in Neural Information Processing Systems 14</source>
        <year>2002</year>
        <publisher-loc>Cambridge</publisher-loc>
        <publisher-name>MIT Press</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR32">
      <label>32</label>
      <mixed-citation publication-type="other">Tung P-Y, Blischak JD, Hsiao CJ, Knowles DA, Burnett JE, Pritchard JK, Gilad Y. Batch effects and the effective design of single-cell gene expression studies. Sci Rep. 2017; 7:39921. 10.1038/srep39921.</mixed-citation>
    </ref>
    <ref id="CR33">
      <label>33</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Haber</surname>
            <given-names>Adam L.</given-names>
          </name>
          <name>
            <surname>Biton</surname>
            <given-names>Moshe</given-names>
          </name>
          <name>
            <surname>Rogel</surname>
            <given-names>Noga</given-names>
          </name>
          <name>
            <surname>Herbst</surname>
            <given-names>Rebecca H.</given-names>
          </name>
          <name>
            <surname>Shekhar</surname>
            <given-names>Karthik</given-names>
          </name>
          <name>
            <surname>Smillie</surname>
            <given-names>Christopher</given-names>
          </name>
          <name>
            <surname>Burgin</surname>
            <given-names>Grace</given-names>
          </name>
          <name>
            <surname>Delorey</surname>
            <given-names>Toni M.</given-names>
          </name>
          <name>
            <surname>Howitt</surname>
            <given-names>Michael R.</given-names>
          </name>
          <name>
            <surname>Katz</surname>
            <given-names>Yarden</given-names>
          </name>
          <name>
            <surname>Tirosh</surname>
            <given-names>Itay</given-names>
          </name>
          <name>
            <surname>Beyaz</surname>
            <given-names>Semir</given-names>
          </name>
          <name>
            <surname>Dionne</surname>
            <given-names>Danielle</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>Mei</given-names>
          </name>
          <name>
            <surname>Raychowdhury</surname>
            <given-names>Raktima</given-names>
          </name>
          <name>
            <surname>Garrett</surname>
            <given-names>Wendy S.</given-names>
          </name>
          <name>
            <surname>Rozenblatt-Rosen</surname>
            <given-names>Orit</given-names>
          </name>
          <name>
            <surname>Shi</surname>
            <given-names>Hai Ning</given-names>
          </name>
          <name>
            <surname>Yilmaz</surname>
            <given-names>Omer</given-names>
          </name>
          <name>
            <surname>Xavier</surname>
            <given-names>Ramnik J.</given-names>
          </name>
          <name>
            <surname>Regev</surname>
            <given-names>Aviv</given-names>
          </name>
        </person-group>
        <article-title>A single-cell survey of the small intestinal epithelium</article-title>
        <source>Nature</source>
        <year>2017</year>
        <volume>551</volume>
        <issue>7680</issue>
        <fpage>333</fpage>
        <lpage>339</lpage>
        <pub-id pub-id-type="doi">10.1038/nature24489</pub-id>
        <pub-id pub-id-type="pmid">29144463</pub-id>
      </element-citation>
    </ref>
    <ref id="CR34">
      <label>34</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Muraro</surname>
            <given-names>Mauro J.</given-names>
          </name>
          <name>
            <surname>Dharmadhikari</surname>
            <given-names>Gitanjali</given-names>
          </name>
          <name>
            <surname>Grün</surname>
            <given-names>Dominic</given-names>
          </name>
          <name>
            <surname>Groen</surname>
            <given-names>Nathalie</given-names>
          </name>
          <name>
            <surname>Dielen</surname>
            <given-names>Tim</given-names>
          </name>
          <name>
            <surname>Jansen</surname>
            <given-names>Erik</given-names>
          </name>
          <name>
            <surname>van Gurp</surname>
            <given-names>Leon</given-names>
          </name>
          <name>
            <surname>Engelse</surname>
            <given-names>Marten A.</given-names>
          </name>
          <name>
            <surname>Carlotti</surname>
            <given-names>Francoise</given-names>
          </name>
          <name>
            <surname>de Koning</surname>
            <given-names>Eelco J.P.</given-names>
          </name>
          <name>
            <surname>van Oudenaarden</surname>
            <given-names>Alexander</given-names>
          </name>
        </person-group>
        <article-title>A Single-Cell Transcriptome Atlas of the Human Pancreas</article-title>
        <source>Cell Systems</source>
        <year>2016</year>
        <volume>3</volume>
        <issue>4</issue>
        <fpage>385-394.e3</fpage>
        <pub-id pub-id-type="doi">10.1016/j.cels.2016.09.002</pub-id>
        <pub-id pub-id-type="pmid">27693023</pub-id>
      </element-citation>
    </ref>
    <ref id="CR35">
      <label>35</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ellefson</surname>
            <given-names>J. W.</given-names>
          </name>
          <name>
            <surname>Gollihar</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Shroff</surname>
            <given-names>R.</given-names>
          </name>
          <name>
            <surname>Shivram</surname>
            <given-names>H.</given-names>
          </name>
          <name>
            <surname>Iyer</surname>
            <given-names>V. R.</given-names>
          </name>
          <name>
            <surname>Ellington</surname>
            <given-names>A. D.</given-names>
          </name>
        </person-group>
        <article-title>Synthetic evolutionary origin of a proofreading reverse transcriptase</article-title>
        <source>Science</source>
        <year>2016</year>
        <volume>352</volume>
        <issue>6293</issue>
        <fpage>1590</fpage>
        <lpage>1593</lpage>
        <pub-id pub-id-type="doi">10.1126/science.aaf5409</pub-id>
        <pub-id pub-id-type="pmid">27339990</pub-id>
      </element-citation>
    </ref>
    <ref id="CR36">
      <label>36</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Shapiro</surname>
            <given-names>Ehud</given-names>
          </name>
          <name>
            <surname>Biezuner</surname>
            <given-names>Tamir</given-names>
          </name>
          <name>
            <surname>Linnarsson</surname>
            <given-names>Sten</given-names>
          </name>
        </person-group>
        <article-title>Single-cell sequencing-based technologies will revolutionize whole-organism science</article-title>
        <source>Nature Reviews Genetics</source>
        <year>2013</year>
        <volume>14</volume>
        <issue>9</issue>
        <fpage>618</fpage>
        <lpage>630</lpage>
        <pub-id pub-id-type="doi">10.1038/nrg3542</pub-id>
      </element-citation>
    </ref>
    <ref id="CR37">
      <label>37</label>
      <mixed-citation publication-type="other">Silverman JD, Roche K, Mukherjee S, David LA. Naught all zeros in sequence count data are the same. bioRxiv. 2018:477794. 10.1101/477794.</mixed-citation>
    </ref>
    <ref id="CR38">
      <label>38</label>
      <mixed-citation publication-type="other">Pachter L. Models for transcript quantification from RNA-Seq. arXiv:1104.3889 [q-bio, stat]. 2011. http://arxiv.org/abs/1104.3889.</mixed-citation>
    </ref>
    <ref id="CR39">
      <label>39</label>
      <mixed-citation publication-type="other">Wagner F, Yan Y, Yanai I. K-nearest neighbor smoothing for high-throughput single-cell RNA-Seq data. bioRxiv. 2018:217737. 10.1101/217737.</mixed-citation>
    </ref>
    <ref id="CR40">
      <label>40</label>
      <mixed-citation publication-type="other">Van den Berge K, Perraudeau F, Soneson C, Love MI, Risso D, Vert J-P, Robinson MD, Dudoit S, Clement L. Observation weights unlock bulk RNA-seq tools for zero inflation and single-cell applications. Genome Biol. 2018; 19:24. 10.1186/s13059-018-1406-4.</mixed-citation>
    </ref>
    <ref id="CR41">
      <label>41</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Witten</surname>
            <given-names>Daniela M.</given-names>
          </name>
        </person-group>
        <article-title>Classification and clustering of sequencing data using a Poisson model</article-title>
        <source>The Annals of Applied Statistics</source>
        <year>2011</year>
        <volume>5</volume>
        <issue>4</issue>
        <fpage>2493</fpage>
        <lpage>2518</lpage>
        <pub-id pub-id-type="doi">10.1214/11-AOAS493</pub-id>
      </element-citation>
    </ref>
    <ref id="CR42">
      <label>42</label>
      <mixed-citation publication-type="other">McInnes L, Healy J, Melville J. UMAP: uniform manifold approximation and projection for dimension reduction. arXiv:1802.03426 [cs, stat]. 2018. http://arxiv.org/abs/1802.03426.</mixed-citation>
    </ref>
    <ref id="CR43">
      <label>43</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hubert</surname>
            <given-names>Lawrence</given-names>
          </name>
          <name>
            <surname>Arabie</surname>
            <given-names>Phipps</given-names>
          </name>
        </person-group>
        <article-title>Comparing partitions</article-title>
        <source>Journal of Classification</source>
        <year>1985</year>
        <volume>2</volume>
        <issue>1</issue>
        <fpage>193</fpage>
        <lpage>218</lpage>
        <pub-id pub-id-type="doi">10.1007/BF01908075</pub-id>
      </element-citation>
    </ref>
    <ref id="CR44">
      <label>44</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Trapnell</surname>
            <given-names>Cole</given-names>
          </name>
          <name>
            <surname>Cacchiarelli</surname>
            <given-names>Davide</given-names>
          </name>
          <name>
            <surname>Grimsby</surname>
            <given-names>Jonna</given-names>
          </name>
          <name>
            <surname>Pokharel</surname>
            <given-names>Prapti</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>Shuqiang</given-names>
          </name>
          <name>
            <surname>Morse</surname>
            <given-names>Michael</given-names>
          </name>
          <name>
            <surname>Lennon</surname>
            <given-names>Niall J</given-names>
          </name>
          <name>
            <surname>Livak</surname>
            <given-names>Kenneth J</given-names>
          </name>
          <name>
            <surname>Mikkelsen</surname>
            <given-names>Tarjei S</given-names>
          </name>
          <name>
            <surname>Rinn</surname>
            <given-names>John L</given-names>
          </name>
        </person-group>
        <article-title>The dynamics and regulators of cell fate decisions are revealed by pseudotemporal ordering of single cells</article-title>
        <source>Nature Biotechnology</source>
        <year>2014</year>
        <volume>32</volume>
        <issue>4</issue>
        <fpage>381</fpage>
        <lpage>386</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.2859</pub-id>
      </element-citation>
    </ref>
    <ref id="CR45">
      <label>45</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Soneson</surname>
            <given-names>Charlotte</given-names>
          </name>
          <name>
            <surname>Robinson</surname>
            <given-names>Mark D</given-names>
          </name>
        </person-group>
        <article-title>Bias, robustness and scalability in single-cell differential expression analysis</article-title>
        <source>Nature Methods</source>
        <year>2018</year>
        <volume>15</volume>
        <issue>4</issue>
        <fpage>255</fpage>
        <lpage>261</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.4612</pub-id>
        <pub-id pub-id-type="pmid">29481549</pub-id>
      </element-citation>
    </ref>
    <ref id="CR46">
      <label>46</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Svensson</surname>
            <given-names>Valentine</given-names>
          </name>
          <name>
            <surname>Teichmann</surname>
            <given-names>Sarah A</given-names>
          </name>
          <name>
            <surname>Stegle</surname>
            <given-names>Oliver</given-names>
          </name>
        </person-group>
        <article-title>SpatialDE: identification of spatially variable genes</article-title>
        <source>Nature Methods</source>
        <year>2018</year>
        <volume>15</volume>
        <issue>5</issue>
        <fpage>343</fpage>
        <lpage>346</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.4636</pub-id>
        <pub-id pub-id-type="pmid">29553579</pub-id>
      </element-citation>
    </ref>
    <ref id="CR47">
      <label>47</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lopez</surname>
            <given-names>Romain</given-names>
          </name>
          <name>
            <surname>Regier</surname>
            <given-names>Jeffrey</given-names>
          </name>
          <name>
            <surname>Cole</surname>
            <given-names>Michael B.</given-names>
          </name>
          <name>
            <surname>Jordan</surname>
            <given-names>Michael I.</given-names>
          </name>
          <name>
            <surname>Yosef</surname>
            <given-names>Nir</given-names>
          </name>
        </person-group>
        <article-title>Deep generative modeling for single-cell transcriptomics</article-title>
        <source>Nature Methods</source>
        <year>2018</year>
        <volume>15</volume>
        <issue>12</issue>
        <fpage>1053</fpage>
        <lpage>1058</lpage>
        <pub-id pub-id-type="doi">10.1038/s41592-018-0229-2</pub-id>
        <pub-id pub-id-type="pmid">30504886</pub-id>
      </element-citation>
    </ref>
    <ref id="CR48">
      <label>48</label>
      <mixed-citation publication-type="other">Verma A, Engelhardt B. A robust nonlinear low-dimensional manifold for single cell RNA-seq data. bioRxiv. 2018:443044. 10.1101/443044.</mixed-citation>
    </ref>
    <ref id="CR49">
      <label>49</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Egozcue</surname>
            <given-names>J. J.</given-names>
          </name>
        </person-group>
        <source>Mathematical Geology</source>
        <year>2003</year>
        <volume>35</volume>
        <issue>3</issue>
        <fpage>279</fpage>
        <lpage>300</lpage>
        <pub-id pub-id-type="doi">10.1023/A:1023818214614</pub-id>
      </element-citation>
    </ref>
    <ref id="CR50">
      <label>50</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>McDonald</surname>
            <given-names>David R.</given-names>
          </name>
        </person-group>
        <article-title>On the poisson approximation to the multinomial distribution</article-title>
        <source>Canadian Journal of Statistics</source>
        <year>1980</year>
        <volume>8</volume>
        <issue>1</issue>
        <fpage>115</fpage>
        <lpage>118</lpage>
        <pub-id pub-id-type="doi">10.2307/3314676</pub-id>
      </element-citation>
    </ref>
    <ref id="CR51">
      <label>51</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Baker</surname>
            <given-names>Stuart G.</given-names>
          </name>
        </person-group>
        <article-title>The Multinomial-Poisson Transformation</article-title>
        <source>The Statistician</source>
        <year>1994</year>
        <volume>43</volume>
        <issue>4</issue>
        <fpage>495</fpage>
        <pub-id pub-id-type="doi">10.2307/2348134</pub-id>
      </element-citation>
    </ref>
    <ref id="CR52">
      <label>52</label>
      <mixed-citation publication-type="other">Gopalan P, Hofman JM, Blei DM. Scalable recommendation with Poisson factorization. arXiv:1311.1704 [cs, stat]. 2013. http://arxiv.org/abs/1311.1704.</mixed-citation>
    </ref>
    <ref id="CR53">
      <label>53</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Taddy</surname>
            <given-names>Matt</given-names>
          </name>
        </person-group>
        <article-title>Distributed multinomial regression</article-title>
        <source>The Annals of Applied Statistics</source>
        <year>2015</year>
        <volume>9</volume>
        <issue>3</issue>
        <fpage>1394</fpage>
        <lpage>1414</lpage>
        <pub-id pub-id-type="doi">10.1214/15-AOAS831</pub-id>
      </element-citation>
    </ref>
    <ref id="CR54">
      <label>54</label>
      <mixed-citation publication-type="other">Biswas S. The latent logarithm. arXiv:1605.06064 [stat]. 2016. http://arxiv.org/abs/1605.06064.</mixed-citation>
    </ref>
    <ref id="CR55">
      <label>55</label>
      <mixed-citation publication-type="other">Townes FW. Generalized principal component analysis. arXiv:1907.02647 [cs, stat]. 2019. http://arxiv.org/abs/1907.02647.</mixed-citation>
    </ref>
    <ref id="CR56">
      <label>56</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Agresti</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <source>Foundations of linear and generalized linear models</source>
        <year>2015</year>
        <publisher-loc>Hoboken</publisher-loc>
        <publisher-name>Wiley</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR57">
      <label>57</label>
      <mixed-citation publication-type="other">Landgraf AJ. Generalized principal component analysis: dimensionality reduction through the projection of natural parameters. 2015. PhD thesis, The Ohio State University.</mixed-citation>
    </ref>
    <ref id="CR58">
      <label>58</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>Gen</given-names>
          </name>
          <name>
            <surname>Gaynanova</surname>
            <given-names>Irina</given-names>
          </name>
        </person-group>
        <article-title>A general framework for association analysis of heterogeneous data</article-title>
        <source>The Annals of Applied Statistics</source>
        <year>2018</year>
        <volume>12</volume>
        <issue>3</issue>
        <fpage>1700</fpage>
        <lpage>1726</lpage>
        <pub-id pub-id-type="doi">10.1214/17-AOAS1127</pub-id>
      </element-citation>
    </ref>
    <ref id="CR59">
      <label>59</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kim</surname>
            <given-names>Jingu</given-names>
          </name>
          <name>
            <surname>He</surname>
            <given-names>Yunlong</given-names>
          </name>
          <name>
            <surname>Park</surname>
            <given-names>Haesun</given-names>
          </name>
        </person-group>
        <article-title>Algorithms for nonnegative matrix and tensor factorizations: a unified view based on block coordinate descent framework</article-title>
        <source>Journal of Global Optimization</source>
        <year>2013</year>
        <volume>58</volume>
        <issue>2</issue>
        <fpage>285</fpage>
        <lpage>319</lpage>
        <pub-id pub-id-type="doi">10.1007/s10898-013-0035-4</pub-id>
      </element-citation>
    </ref>
    <ref id="CR60">
      <label>60</label>
      <mixed-citation publication-type="other">Hafemeister C, Satija R. Normalization and variance stabilization of single-cell RNA-seq data using regularized negative binomial regression. bioRxiv. 2019:576827. 10.1101/576827.</mixed-citation>
    </ref>
    <ref id="CR61">
      <label>61</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hartigan</surname>
            <given-names>J. A.</given-names>
          </name>
          <name>
            <surname>Wong</surname>
            <given-names>M. A.</given-names>
          </name>
        </person-group>
        <article-title>Algorithm AS 136: A K-Means Clustering Algorithm</article-title>
        <source>Applied Statistics</source>
        <year>1979</year>
        <volume>28</volume>
        <issue>1</issue>
        <fpage>100</fpage>
        <pub-id pub-id-type="doi">10.2307/2346830</pub-id>
      </element-citation>
    </ref>
    <ref id="CR62">
      <label>62</label>
      <mixed-citation publication-type="other">Townes W, Pita-Juarez Y. Willtownes/Scrna2019: Genome Biology Publication. Zenodo. 2019. 10.5281/zenodo.3475535.</mixed-citation>
    </ref>
  </ref-list>
</back>
