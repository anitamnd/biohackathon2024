<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Sci Rep</journal-id>
    <journal-id journal-id-type="iso-abbrev">Sci Rep</journal-id>
    <journal-title-group>
      <journal-title>Scientific Reports</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2045-2322</issn>
    <publisher>
      <publisher-name>Nature Publishing Group UK</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">9500060</article-id>
    <article-id pub-id-type="publisher-id">20108</article-id>
    <article-id pub-id-type="doi">10.1038/s41598-022-20108-8</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>A pipeline for automated deep learning liver segmentation (PADLLS) from contrast enhanced CT exams</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Senthilvelan</surname>
          <given-names>Jayasuriya</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Jamshidi</surname>
          <given-names>Neema</given-names>
        </name>
        <address>
          <email>njamshidi@mednet.ucla.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <aff id="Aff1"><institution-wrap><institution-id institution-id-type="GRID">grid.19006.3e</institution-id><institution-id institution-id-type="ISNI">0000 0000 9632 6718</institution-id><institution>Department of Radiological Sciences, David Geffen School of Medicine, </institution><institution>University of California, Los Angeles, </institution></institution-wrap>757 Westwood Ave, Suite 2125, Los Angeles, CA 90095 USA </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>22</day>
      <month>9</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>22</day>
      <month>9</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2022</year>
    </pub-date>
    <volume>12</volume>
    <elocation-id>15794</elocation-id>
    <history>
      <date date-type="received">
        <day>31</day>
        <month>10</month>
        <year>2021</year>
      </date>
      <date date-type="accepted">
        <day>8</day>
        <month>9</month>
        <year>2022</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2022</copyright-statement>
      <license>
        <ali:license_ref specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p><bold>Open Access</bold> This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article's Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article's Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <p id="Par1">Multiple studies have created state-of-the-art liver segmentation models using Deep Convolutional Neural Networks (DCNNs) such as the V-net and H-DenseUnet. Oversegmentation however continues to be a problem. We set forth to address these limitations by developing a an automated workflow that leverages the strengths of different DCNN architectures, resulting in a pipeline that enables fully automated liver segmentation. A Pipeline for Automated Deep Learning Liver Segmentation (PADLLS) was developed and implemented that cascades multiple DCNNs that were trained on more than 200 CT scans. First, a V-net is used to create a rough liver, spleen, and stomach mask. After stomach and spleen pixels are removed using their respective masks and ascites is removed using a morphological algorithm, the scan is passed to a H-DenseUnet to yield the final segmentation. The segmentation accuracy of the pipleline was compared to the H-DenseUnet and the V-net using the SLIVER07 and 3DIRCADb datasets as benchmarks. The PADLLS Dice score for the SLIVER07 dataset was calculated to be 0.957 ± 0.033 and was significantly better than the H-DenseUnet’s score of 0.927 ± 0.044 (<italic>p</italic> = 0.0219) and the V-net’s score of 0.872 ± 0.121 (<italic>p</italic> = 0.0067). The PADLLS Dice score for the 3DIRCADb dataset was 0.965 ± 0.016 and was significantly better than the H-DenseUnet’s score of 0.930 ± 0.041 (<italic>p</italic> = 0.0014) the V-net’s score of 0.874 ± 0.060 (<italic>p</italic> &lt; 0.001). In conclusion, our pipeline (PADLLS) outperforms existing liver segmentation models, serves as a valuable tool for image-based analysis, and is freely available for download and use.
</p>
    </abstract>
    <kwd-group kwd-group-type="npg-subject">
      <title>Subject terms</title>
      <kwd>Diagnostic markers</kwd>
      <kwd>Three-dimensional imaging</kwd>
      <kwd>Tomography</kwd>
      <kwd>Image processing</kwd>
      <kwd>Machine learning</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000002</institution-id>
            <institution>National Institutes of Health</institution>
          </institution-wrap>
        </funding-source>
        <award-id>KL2TR001882</award-id>
        <principal-award-recipient>
          <name>
            <surname>Jamshidi</surname>
            <given-names>Neema</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2022</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Introduction</title>
    <p id="Par20">The growth and development of deep learning applications in biomedical imaging research have been profound in the past decade. To leverage these developments and to fully achieve goals of radiomic and radiogenomic objectives, fully automated organ segmentation will become increasingly important. The liver is a critical organ in health and disease, notably in oncologic disease (primary and metastatic) as well as endocrine and metabolic disorders, with computed tomography (CT) imaging playing a critical role for diagnosis, treatment planning, and follow-up for numerous hepatic diseases<sup><xref ref-type="bibr" rid="CR1">1</xref>–<xref ref-type="bibr" rid="CR3">3</xref></sup>. Segmentation applications have increased dramatically, but growth has been limited by the widespread availability of tools and semi-automated approaches that require user input. Although these methods give physicians greater control over the nature of the segmentation, they are also subjective and time-consuming. As a result, there is a need for automated segmentation for advancing quantitative analyses of livers.</p>
    <p id="Par21">Traditional approaches for organ segmentation can be classified into three groups: region-based methods, classification and clustering methods, and hybrid methods<sup><xref ref-type="bibr" rid="CR4">4</xref></sup>. Region-based methods include thresholding and region growing<sup><xref ref-type="bibr" rid="CR5">5</xref></sup>. Disadvantages of these two methods include sensitivity to noise and segmentation accuracy dependence on the operator's seed point selection, respectively. Classification methods, like k-Nearest Neighbor (kNN) and Maximum Likelihood Estimation, typically classify each pixel one at a time based on the training data. Clustering methods are similar to classification models with the exception that they do not require training data, including, for example, K-means and Expectation Maximization. The drawback to this category is the inability to factor in extensive spatial information<sup><xref ref-type="bibr" rid="CR6">6</xref></sup>. Hybrid methods are based on both the region of interest (ROI) and boundary information (calculating a gradient based on pixel values) but are hindered by the requisite user interaction for every slice that is segmented in a series<sup><xref ref-type="bibr" rid="CR7">7</xref></sup>.</p>
    <p id="Par22">Deep Convolutional Neural Networks (DCNNs) address many of the issues posed by earlier segmentation models. For instance, they can take into account both 2D and 3D spatial information. DCNNs are also highly adaptable, which is critical for liver segmentation as liver size, shape, and density vary widely from patient to patient. Additionally, once trained the method is fully automatic, so no user input is required<sup><xref ref-type="bibr" rid="CR8">8</xref></sup>. Conversely, there are drawbacks to DCNNs, such as the large amount of manually segmented training data, time, and computational power it takes to train the model. Running the model successfully also requires significant GPU resources and time. However, the success of DCNNs in image segmentation challenges like LiTS (Liver Tumor Segmentation) justifies the initial investment of time and resources<sup><xref ref-type="bibr" rid="CR9">9</xref></sup>.</p>
    <p id="Par23">Current state of the art liver segmentation DCNNs, such as the V-net from Gibson et al. and the H-DenseUnet from Li et al.<sup><xref ref-type="bibr" rid="CR10">10</xref>, <xref ref-type="bibr" rid="CR11">11</xref></sup>, have overcome many of the challenges related to liver segmentation such as separation from potential structures such as the heart and kidney as well as minimizing the confounding effect of diaphragmatic motion. However, there remain limitations to the results from each of these models, notably oversegmentation of the stomach, spleen, and/or ascites. In this paper, we define oversegmentation as the inclusion of non-hepatic voxels in the final liver mask due to indistinct anatomic boundaries between organs and structures. These types of problems increase the false positive error and compromise the validity of any subsequent analyses.</p>
    <p id="Par24">In order to solve this issue, we developed a robust, automated pipeline approach by cascading the V-net and H-DenseUnet and applying knowledge-based heuristics; the result is a Pipeline for Automated Deep Learning Liver Segmentation (PADLLS). The V-net’s spleen and stomach masks were used to modify the original CT volume to entirely remove all spleen and stomach voxels. Ascites was also removed from the dataset through thresholding and morphological processing. The resulting edited volume was passed to the H-DenseUnet to generate the final liver segmentation. Testing on benchmark datasets (3DIRCADb and SLIVER07) demonstrated that our approach outperforms the H-DenseUnet and V-net, which is indicative of a synergistic improvement in accuracy. A direct comparison of our pipeline to other state-of-the-art models supports these findings.</p>
  </sec>
  <sec id="Sec2">
    <title>Methods</title>
    <sec id="Sec3">
      <title>Preprocessing</title>
      <p id="Par25">Data from both SLIVER07 (Segmentation of the Liver Competition 2007)<sup><xref ref-type="bibr" rid="CR12">12</xref></sup> and 3DIRCADb<sup><xref ref-type="bibr" rid="CR13">13</xref></sup> are available in a different orientation and file format than that which the V-net, H-DenseUnet, and our segmentation pipeline required. Hence, each slice of SLIVER07 and 3DIRCADb CT scans was rotated clockwise by 90° and reflected about the vertical axis. All datasets were then converted from either DICOM or MHD to NIfTI, which is the format used by all networks in this manuscript. This was accomplished by extracting the raw data array from the DICOM or MHD file and creating an entirely new NIfTI file.
</p>
    </sec>
    <sec id="Sec4">
      <title>Test datasets</title>
      <p id="Par26">The final liver segmentation pipeline in Fig. <xref rid="Fig1" ref-type="fig">1</xref> was tested on two public challenge CT datasets: SLIVER07 and 3DIRCADb<sup><xref ref-type="bibr" rid="CR13">13</xref></sup>. Most of the scans in the SLIVER07 datasets were of diseased livers, with cysts and tumors. All images were also contrast enhanced. The pipeline was run on an NVIDIA Quadro RTX4000 with 8 GB memory and a NVIDIA Tesla V100 with 32 GB memory. The SLIVER07 challenge provided 20 datasets in RAW and MHD format. These datasets were first converted to DICOM format before running them through the segmentation pipeline. Reference segmentations for each respective dataset were provided. The 3DIRCADb dataset with 20 contrast enhanced CT-scans (10 men and 10 women) and reference ‘gold standard’ manual segmentation was used as well. Seventy-five percent of the datasets in 3DIRCADb had hepatic tumors. Three additional datasets (multiphase CT scans) were used to test the effectiveness of ascites removal.<fig id="Fig1"><label>Figure 1</label><caption><p>Flowchart schematic outlining the PADLLS steps. First, the imported images are standardized with respect to orientation and format. Next, the V-net segments the study for the initial liver mask (in addition to the stomach and spleen). Oversegmentation correction is then applied though thresholding and finally the H-DenseUnet further refines the liver segmentation.</p></caption><graphic xlink:href="41598_2022_20108_Fig1_HTML" id="MO1"/></fig></p>
    </sec>
    <sec id="Sec5">
      <title>Initial V-net segmentation</title>
      <p id="Par27">The initial V-net segmentation was performed using the Dense V-net proposed by Gibson et al.<sup><xref ref-type="bibr" rid="CR10">10</xref></sup>. A summary of the network architecture is provided as follows. A 144 × 144 × 144 initial volume is provided as input to the network and convolutional downsampling is performed. The downsampled volume is then run through a series of dense feature stacks and convolutions, which are used to create activation maps at three resolutions. These maps are bilinearly upsampled, concatenated, and convolved to generate likelihood logits. Finally, an explicit spatial prior was added to these logits to generate the segmentation. The network was trained to segment eight different organs: pancreas, esophagus, duodenum, stomach, liver, spleen, left kidney, and gallbladder. The data used to train this network originated from the Cancer Imaging Archive Pancreas-CT dataset<sup><xref ref-type="bibr" rid="CR14">14</xref></sup> and Beyond the Cranial Vault (BTCV) Segmentation Challenge<sup><xref ref-type="bibr" rid="CR15">15</xref></sup>. The V-net was trained using the following probabilistic Dice score function to calculate an L2 regularization loss.<disp-formula id="Equ1"><label>1</label><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{pDice}}_{{\varvec{l}}} \left( {{\varvec{L}}_{{\varvec{l}}}^{\prime \prime } ,{\varvec{R}}_{{\varvec{l}}} } \right) = \overline{{\left( {\frac{{{\text{min}}\left( {{\varvec{L}}_{{\varvec{l}}}^{\prime \prime } ,0.9} \right)}}{{\left\| {{\varvec{R}}_{{\varvec{l}}} } \right\|_{2} + \left\| {{\text{min}}\left( {{\varvec{L}}_{{\varvec{l}}}^{\prime \prime } ,0.9} \right)} \right\|_{2} }}} \right)}}$$\end{document}</tex-math><mml:math id="M2" display="block"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">pDice</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">l</mml:mi></mml:mrow></mml:msub><mml:mfenced close=")" open="("><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">L</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">l</mml:mi></mml:mrow></mml:mrow><mml:mo>″</mml:mo></mml:msubsup><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">R</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">l</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mover><mml:mfenced close=")" open="("><mml:mfrac><mml:mrow><mml:mtext>min</mml:mtext><mml:mfenced close=")" open="("><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">L</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">l</mml:mi></mml:mrow></mml:mrow><mml:mo>″</mml:mo></mml:msubsup><mml:mo>,</mml:mo><mml:mn>0.9</mml:mn></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:msub><mml:mfenced close="∥" open="∥"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">R</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">l</mml:mi></mml:mrow></mml:msub></mml:mfenced><mml:mn>2</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mfenced close="∥" open="∥"><mml:mrow><mml:mtext>min</mml:mtext><mml:mfenced close=")" open="("><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">L</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">l</mml:mi></mml:mrow></mml:mrow><mml:mo>″</mml:mo></mml:msubsup><mml:mo>,</mml:mo><mml:mn>0.9</mml:mn></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:mfrac></mml:mfenced><mml:mo>¯</mml:mo></mml:mover></mml:mrow></mml:math><graphic xlink:href="41598_2022_20108_Article_Equ1.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par28"><inline-formula id="IEq1"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$L$$\end{document}</tex-math><mml:math id="M4"><mml:mi>L</mml:mi></mml:math><inline-graphic xlink:href="41598_2022_20108_Article_IEq1.gif"/></alternatives></inline-formula> is the logit result of the V-net with nine different classes. <inline-formula id="IEq2"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$L$$\end{document}</tex-math><mml:math id="M6"><mml:mi>L</mml:mi></mml:math><inline-graphic xlink:href="41598_2022_20108_Article_IEq2.gif"/></alternatives></inline-formula> becomes <inline-formula id="IEq3"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$L^{\prime }$$\end{document}</tex-math><mml:math id="M8"><mml:msup><mml:mi>L</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="41598_2022_20108_Article_IEq3.gif"/></alternatives></inline-formula> upon the addition of a spatial prior called <inline-formula id="IEq4"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$P$$\end{document}</tex-math><mml:math id="M10"><mml:mi>P</mml:mi></mml:math><inline-graphic xlink:href="41598_2022_20108_Article_IEq4.gif"/></alternatives></inline-formula>, introduced by Gibson in a previous work<sup><xref ref-type="bibr" rid="CR16">16</xref></sup>. <inline-formula id="IEq5"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$L_{l}^{\prime \prime }$$\end{document}</tex-math><mml:math id="M12"><mml:msubsup><mml:mi>L</mml:mi><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mo>″</mml:mo></mml:msubsup></mml:math><inline-graphic xlink:href="41598_2022_20108_Article_IEq5.gif"/></alternatives></inline-formula> is the result of applying the softmax function to <inline-formula id="IEq6"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$L^{\prime }$$\end{document}</tex-math><mml:math id="M14"><mml:msup><mml:mi>L</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="41598_2022_20108_Article_IEq6.gif"/></alternatives></inline-formula> for some label <inline-formula id="IEq7"><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$l$$\end{document}</tex-math><mml:math id="M16"><mml:mi>l</mml:mi></mml:math><inline-graphic xlink:href="41598_2022_20108_Article_IEq7.gif"/></alternatives></inline-formula>. <inline-formula id="IEq8"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$R_{l}$$\end{document}</tex-math><mml:math id="M18"><mml:msub><mml:mi>R</mml:mi><mml:mi>l</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="41598_2022_20108_Article_IEq8.gif"/></alternatives></inline-formula> is the ground truth segmentation for some organ <inline-formula id="IEq9"><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$l$$\end{document}</tex-math><mml:math id="M20"><mml:mi>l</mml:mi></mml:math><inline-graphic xlink:href="41598_2022_20108_Article_IEq9.gif"/></alternatives></inline-formula>. This network was trained for 6 h on a Titan X Pascal GPU with 12 GB of RAM. The liver segmentation from the V-net was used to define a bounding box for the subsequent H-DenseUnet. Further, using the stomach and spleen masks from the V-net, the stomach and spleen voxels were replaced with − 100 Hounsfield Units (HU) in the CT data passed to the H-DenseUnet in order to prevent any potential oversegmentation by the H-DenseUnet phase of the pipeline. Full architecture details of V-net can be found in Supplementary Table <xref rid="MOESM1" ref-type="media">S1</xref>.</p>
    </sec>
    <sec id="Sec6">
      <title>Ascites correction</title>
      <p id="Par29">Since the H-DenseUnet and V-net were both observed to overestimate liver volumes in imaging studies with ascites, we felt it was important to correct for this. Hence, a 3D binary mask of all pixels less than 15 HU was created (inclusive of ascites and peritoneal fat; see Statistics and Analysis). Then, image opening was performed with a disk of radius 2 pixels on each slice. Image opening is the erosion of an image followed by dilation using a structuring element. Spherical and circular structural elements were used throughout this paper because they best preserve the border contours of the binary image. It is intended to remove small binary objects. It can be described with the following formula:<disp-formula id="Equ2"><label>2</label><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{A}} \circ {\varvec{B}} = \left( {{\varvec{A}}{ \ominus }{\varvec{B}}} \right) \oplus {\varvec{B}}$$\end{document}</tex-math><mml:math id="M22" display="block"><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">A</mml:mi></mml:mrow><mml:mo>∘</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">B</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">A</mml:mi></mml:mrow><mml:mo>⊖</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">B</mml:mi></mml:mrow></mml:mrow></mml:mfenced><mml:mo>⊕</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">B</mml:mi></mml:mrow></mml:mrow></mml:math><graphic xlink:href="41598_2022_20108_Article_Equ2.gif" position="anchor"/></alternatives></disp-formula>
Here, A is the binary image and B is the structuring element. <inline-formula id="IEq10"><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\oplus$$\end{document}</tex-math><mml:math id="M24"><mml:mo>⊕</mml:mo></mml:math><inline-graphic xlink:href="41598_2022_20108_Article_IEq10.gif"/></alternatives></inline-formula> and <inline-formula id="IEq11"><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\ominus$$\end{document}</tex-math><mml:math id="M26"><mml:mo>⊖</mml:mo></mml:math><inline-graphic xlink:href="41598_2022_20108_Article_IEq11.gif"/></alternatives></inline-formula> refer to image dilation and image erosion, respectively. Overall, these steps eliminated any parts of the liver or other organs that were lower than 15 HU in intensity. Subsequently, a binary area filter selecting objects that were greater in area than 1500 pixels was applied to each image in the volumetric dataset. Finally, all CT dataset voxels that were included in this binary volume were set to − 100 HU in order to exclude ascites.</p>
    </sec>
    <sec id="Sec7">
      <title>Final H-DenseUnet segmentation</title>
      <p id="Par30">The output of the V-net segmentation was passed to the H-DenseUnet presented by Li et al.<sup><xref ref-type="bibr" rid="CR11">11</xref></sup>. This network consisted of 3 critical components: a 2D DenseUnet, a 3D DenseUnet, and a Hybrid Fusion (HF) layer. The 2D DenseUnet is good at recognizing intra-slice features but fails to take into account information along the z-axis, whereas the 3D DenseUnet is good at recognizing inter-slice features but has a large computational cost. As a result, combining these two networks in a cascaded learning approach was determined to produce optimal segmentation results.</p>
      <p id="Par31">The H-DenseUnet was trained using a weighted cross-entropy loss function, seen below:<disp-formula id="Equ3"><label>3</label><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{L}}\left( {{\varvec{y}},\hat{\user2{y}}} \right) = - \frac{1}{{\varvec{N}}}\mathop \sum \limits_{{{\varvec{i}} = 1}}^{{\varvec{N}}} \mathop \sum \limits_{{{\varvec{c}} = 1}}^{3} {\varvec{w}}_{{\varvec{i}}}^{{\varvec{c}}} {\varvec{y}}_{{\varvec{i}}}^{{\varvec{c}}} {\text{log}}\widehat{{{\varvec{y}}_{{\varvec{i}}} }}^{{\varvec{c}}}$$\end{document}</tex-math><mml:math id="M28" display="block"><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">L</mml:mi></mml:mrow><mml:mfenced close=")" open="("><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">y</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">y</mml:mi></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mo>-</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mi mathvariant="bold-italic">N</mml:mi></mml:mrow></mml:mfrac><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">i</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">N</mml:mi></mml:mrow></mml:munderover><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">c</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mrow><mml:mn>3</mml:mn></mml:munderover><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">w</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">i</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">c</mml:mi></mml:mrow></mml:msubsup><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">y</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">i</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">c</mml:mi></mml:mrow></mml:msubsup><mml:mtext>log</mml:mtext><mml:msup><mml:mover accent="true"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">y</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mrow><mml:mi mathvariant="bold-italic">c</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math><graphic xlink:href="41598_2022_20108_Article_Equ3.gif" position="anchor"/></alternatives></disp-formula><inline-formula id="IEq12"><alternatives><tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${w}_{i}^{c}$$\end{document}</tex-math><mml:math id="M30"><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mi>c</mml:mi></mml:msubsup></mml:math><inline-graphic xlink:href="41598_2022_20108_Article_IEq12.gif"/></alternatives></inline-formula> represents the weight and <inline-formula id="IEq13"><alternatives><tex-math id="M31">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${y}_{i}^{c}$$\end{document}</tex-math><mml:math id="M32"><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mi>c</mml:mi></mml:msubsup></mml:math><inline-graphic xlink:href="41598_2022_20108_Article_IEq13.gif"/></alternatives></inline-formula> is the ground truth for pixel <inline-formula id="IEq14"><alternatives><tex-math id="M33">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i$$\end{document}</tex-math><mml:math id="M34"><mml:mi>i</mml:mi></mml:math><inline-graphic xlink:href="41598_2022_20108_Article_IEq14.gif"/></alternatives></inline-formula>. <inline-formula id="IEq15"><alternatives><tex-math id="M35">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\widehat{{y}_{i}}}^{c}$$\end{document}</tex-math><mml:math id="M36"><mml:msup><mml:mrow><mml:mover accent="true"><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="true">^</mml:mo></mml:mover></mml:mrow><mml:mi>c</mml:mi></mml:msup></mml:math><inline-graphic xlink:href="41598_2022_20108_Article_IEq15.gif"/></alternatives></inline-formula> is the probability that a pixel <inline-formula id="IEq16"><alternatives><tex-math id="M37">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i$$\end{document}</tex-math><mml:math id="M38"><mml:mi>i</mml:mi></mml:math><inline-graphic xlink:href="41598_2022_20108_Article_IEq16.gif"/></alternatives></inline-formula> is found in class <inline-formula id="IEq17"><alternatives><tex-math id="M39">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$c$$\end{document}</tex-math><mml:math id="M40"><mml:mi>c</mml:mi></mml:math><inline-graphic xlink:href="41598_2022_20108_Article_IEq17.gif"/></alternatives></inline-formula>, where the classes are background, lesion, and liver. This network was trained for 30 h using two NVIDIA Titan Xp GPUs (12 GB each).</p>
      <p id="Par32">First, the initial liver segmentation from the V-net was used to define a rough bounding box in the CT data, which was then resized to 224 × 224 × 12. Next, every three adjacent slices in the input volume (224 × 224 × 3) were passed to the 2D DenseUnet. These 2D segmentation results were concatenated with the 3D input volume (224 × 224 × 12) and fed into the 3D DenseUnet. Then, the HF layer was used to fuse the intra-slice and inter-slice features from the 2D DenseUnet and the 3D DenseUnet, respectively, to create a final liver segmentation. Full details of H-DenseUnet architecture can be found in Supplementary Table <xref rid="MOESM1" ref-type="media">S2</xref>.</p>
    </sec>
    <sec id="Sec8">
      <title>Post-processing</title>
      <p id="Par33">The result of the H-DenseUnet segmentation was truncated to only include slices that had liver pixels in them. Sometimes the liver segmentation included lung pixels near the hepatic dome. Hence, all pixels in the liver binary mask with values less than 0 HU were excluded from the final segmentation. Volume filtering was performed to select the largest object and image closing was performed with disk of radius 2 pixels. Liver and tumor masks from the H-DenseUnet were combined into one liver binary volume. Any holes in the mask were filled, and image closing was performed on the volume with a sphere of radius 3 pixels. Image closing is defined as the dilation of a binary image followed by erosion using a structuring element, intended to fill small holes in a binary image. It can be described with the following formula:<disp-formula id="Equ4"><label>4</label><alternatives><tex-math id="M41">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{A}} \cdot {\varvec{B}} = \left( {{\varvec{A}} \oplus {\varvec{B}}} \right){ \ominus }{\varvec{B}}$$\end{document}</tex-math><mml:math id="M42" display="block"><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">A</mml:mi></mml:mrow><mml:mo>·</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">B</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">A</mml:mi></mml:mrow><mml:mo>⊕</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">B</mml:mi></mml:mrow></mml:mrow></mml:mfenced><mml:mo>⊖</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">B</mml:mi></mml:mrow></mml:mrow></mml:math><graphic xlink:href="41598_2022_20108_Article_Equ4.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par34">A is the binary image and B is the structuring element. <inline-formula id="IEq18"><alternatives><tex-math id="M43">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\oplus$$\end{document}</tex-math><mml:math id="M44"><mml:mo>⊕</mml:mo></mml:math><inline-graphic xlink:href="41598_2022_20108_Article_IEq18.gif"/></alternatives></inline-formula> and <inline-formula id="IEq19"><alternatives><tex-math id="M45">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\ominus$$\end{document}</tex-math><mml:math id="M46"><mml:mo>⊖</mml:mo></mml:math><inline-graphic xlink:href="41598_2022_20108_Article_IEq19.gif"/></alternatives></inline-formula> retain their meaning from Eq. (<xref rid="Equ2" ref-type="">2</xref>). Schematic of full segmentation pipeline from start to finish can be seen in Fig. <xref rid="Fig1" ref-type="fig">1</xref>.</p>
    </sec>
    <sec id="Sec9">
      <title>Statistics and analysis</title>
      <p id="Par35">For the ascites correction, a receiver operating characteristic (ROC) curve was generated across the range of 0 to 30 HU, with increments of 1 HU between 10 and 20 HU and increments of 5 HU otherwise. Volumetric Overlap Error (VOE), Relative Volume Difference (RVD), Average Symmetric Surface Distance (ASD), Root Mean Square Symmetric Surface Distance (RMSD), Hausdorff Distance (HD), and Dice score were calculated as metrics to comprehensively compare the segmentation results of the different algorithms. In the following formulas, <inline-formula id="IEq20"><alternatives><tex-math id="M47">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$A$$\end{document}</tex-math><mml:math id="M48"><mml:mi>A</mml:mi></mml:math><inline-graphic xlink:href="41598_2022_20108_Article_IEq20.gif"/></alternatives></inline-formula> is the binary segmentation result and <inline-formula id="IEq21"><alternatives><tex-math id="M49">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$B$$\end{document}</tex-math><mml:math id="M50"><mml:mi>B</mml:mi></mml:math><inline-graphic xlink:href="41598_2022_20108_Article_IEq21.gif"/></alternatives></inline-formula> is the ground truth mask. <inline-formula id="IEq22"><alternatives><tex-math id="M51">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$d$$\end{document}</tex-math><mml:math id="M52"><mml:mi>d</mml:mi></mml:math><inline-graphic xlink:href="41598_2022_20108_Article_IEq22.gif"/></alternatives></inline-formula> is the Euclidean distance between two points. <inline-formula id="IEq23"><alternatives><tex-math id="M53">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$S\left(A\right)$$\end{document}</tex-math><mml:math id="M54"><mml:mrow><mml:mi>S</mml:mi><mml:mfenced close=")" open="("><mml:mi>A</mml:mi></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="41598_2022_20108_Article_IEq23.gif"/></alternatives></inline-formula> and <inline-formula id="IEq24"><alternatives><tex-math id="M55">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$S\left(B\right)$$\end{document}</tex-math><mml:math id="M56"><mml:mrow><mml:mi>S</mml:mi><mml:mfenced close=")" open="("><mml:mi>B</mml:mi></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="41598_2022_20108_Article_IEq24.gif"/></alternatives></inline-formula> are the surface of the ground truth mask and binary segmentation result, respectively.</p>
      <p id="Par36">Dice coefficients for the segmentation results were calculated as:<disp-formula id="Equ5"><label>5</label><alternatives><tex-math id="M57">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{Dice}} = 2\left( {{\varvec{A}} \cap {\varvec{B}}} \right)/\left( {\left| {\varvec{A}} \right| + \left| {\varvec{B}} \right|} \right)$$\end{document}</tex-math><mml:math id="M58" display="block"><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">Dice</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:mfenced close=")" open="("><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">A</mml:mi></mml:mrow><mml:mo>∩</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">B</mml:mi></mml:mrow></mml:mrow></mml:mfenced><mml:mo stretchy="false">/</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:mfenced close="|" open="|"><mml:mrow><mml:mi mathvariant="bold-italic">A</mml:mi></mml:mrow></mml:mfenced><mml:mo>+</mml:mo><mml:mfenced close="|" open="|"><mml:mrow><mml:mi mathvariant="bold-italic">B</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced></mml:mrow></mml:math><graphic xlink:href="41598_2022_20108_Article_Equ5.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par37">A Dice score of 1 reflects perfect segmentation of the entire study. VOE was calculated as a percent, where a VOE of 0% means a perfect segmentation. VOE was also used to compare the effect of ascites on the performance of the V-net and H-DenseUnet with our pipeline. The VOE was calculated as:<disp-formula id="Equ6"><label>6</label><alternatives><tex-math id="M59">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{VOE}} = 100\left( {1 - \left( {\left| {{\varvec{A}} \cap {\varvec{B}}} \right|} \right)/\left| {{\varvec{A}} \cup {\varvec{B}}} \right|} \right)$$\end{document}</tex-math><mml:math id="M60" display="block"><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">VOE</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mn>100</mml:mn><mml:mfenced close=")" open="("><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mfenced close=")" open="("><mml:mfenced close="|" open="|"><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">A</mml:mi></mml:mrow><mml:mo>∩</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">B</mml:mi></mml:mrow></mml:mrow></mml:mfenced></mml:mfenced><mml:mo stretchy="false">/</mml:mo><mml:mfenced close="|" open="|"><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">A</mml:mi></mml:mrow><mml:mo>∪</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">B</mml:mi></mml:mrow></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced></mml:mrow></mml:math><graphic xlink:href="41598_2022_20108_Article_Equ6.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par38">RVD was also calculated with the following formula:<disp-formula id="Equ7"><label>7</label><alternatives><tex-math id="M61">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{RVD}} = 100\left( {\left( {\left| {\varvec{A}} \right| - \left| {\varvec{B}} \right|} \right)/\left| {\varvec{B}} \right|} \right)$$\end{document}</tex-math><mml:math id="M62" display="block"><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">RVD</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mn>100</mml:mn><mml:mfenced close=")" open="("><mml:mrow><mml:mfenced close=")" open="("><mml:mrow><mml:mfenced close="|" open="|"><mml:mrow><mml:mi mathvariant="bold-italic">A</mml:mi></mml:mrow></mml:mfenced><mml:mo>-</mml:mo><mml:mfenced close="|" open="|"><mml:mrow><mml:mi mathvariant="bold-italic">B</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced><mml:mo stretchy="false">/</mml:mo><mml:mfenced close="|" open="|"><mml:mrow><mml:mi mathvariant="bold-italic">B</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced></mml:mrow></mml:math><graphic xlink:href="41598_2022_20108_Article_Equ7.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par39">An RVD of 0% means a perfect segmentation. ASD was calculated in millimeters with the following formula:<disp-formula id="Equ8"><label>8</label><alternatives><tex-math id="M63">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{ASD}}\left( {{\varvec{A}},{\varvec{B}}} \right) = \frac{1}{{\left| {{\varvec{S}}\left( {\varvec{A}} \right)} \right| + \left| {{\varvec{S}}\left( {\varvec{B}} \right)} \right|}} \times \left( {\mathop \sum \limits_{{{\varvec{s}}_{{\varvec{A}}} \in {\varvec{S}}\left( {\varvec{A}} \right)}} {\varvec{d}}\left( {{\varvec{s}}_{{\varvec{A}}} ,{\varvec{S}}\left( {\varvec{B}} \right)} \right) + \mathop \sum \limits_{{{\varvec{s}}_{{\varvec{A}}} \in {\varvec{S}}\left( {\varvec{A}} \right)}} {\varvec{d}}({\varvec{s}}_{{\varvec{B}}} ,{\varvec{S}}\left( {\varvec{A}} \right)} \right)$$\end{document}</tex-math><mml:math id="M64" display="block"><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">ASD</mml:mi></mml:mrow><mml:mfenced close=")" open="("><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">A</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">B</mml:mi></mml:mrow></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mfenced close="|" open="|"><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">S</mml:mi></mml:mrow><mml:mfenced close=")" open="("><mml:mrow><mml:mi mathvariant="bold-italic">A</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced><mml:mo>+</mml:mo><mml:mfenced close="|" open="|"><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">S</mml:mi></mml:mrow><mml:mfenced close=")" open="("><mml:mrow><mml:mi mathvariant="bold-italic">B</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced></mml:mrow></mml:mfrac><mml:mo>×</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">s</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">A</mml:mi></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">S</mml:mi></mml:mrow><mml:mfenced close=")" open="("><mml:mrow><mml:mi mathvariant="bold-italic">A</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:munder><mml:mrow><mml:mi mathvariant="bold-italic">d</mml:mi></mml:mrow><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">s</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">A</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">S</mml:mi></mml:mrow><mml:mfenced close=")" open="("><mml:mrow><mml:mi mathvariant="bold-italic">B</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced><mml:mo>+</mml:mo><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">s</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">A</mml:mi></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">S</mml:mi></mml:mrow><mml:mfenced close=")" open="("><mml:mrow><mml:mi mathvariant="bold-italic">A</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:munder><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">d</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo></mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">s</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">B</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">S</mml:mi></mml:mrow><mml:mfenced close=")" open="("><mml:mrow><mml:mi mathvariant="bold-italic">A</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced></mml:mrow></mml:math><graphic xlink:href="41598_2022_20108_Article_Equ8.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par40">For all points on the surface of volume A, the Euclidean distance is calculated to the nearest surface point on volume B. This process is repeated for all surface points on volume B with respect to the nearest surface point on volume A. The mean of these distances yields the ASD. An ASD of 0 mm means a perfect segmentation. The RMSD in millimeters is calculated as follows:<disp-formula id="Equ9"><label>9</label><alternatives><tex-math id="M65">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{RMSD}}\left( {{\varvec{A}},{\varvec{B}}} \right) = \frac{1}{{\left| {{\varvec{S}}\left( {\varvec{A}} \right)} \right| + \left| {{\varvec{S}}\left( {\varvec{B}} \right)} \right|}} \times \sqrt {\mathop \sum \limits_{{{\varvec{s}}_{{\varvec{A}}} \in {\varvec{S}}\left( {\varvec{A}} \right)}} {\varvec{d}}^{2} \left( {{\varvec{s}}_{{\varvec{A}}} ,{\varvec{S}}\left( {\varvec{B}} \right)} \right) + \mathop \sum \limits_{{{\varvec{s}}_{{\varvec{A}}} \in {\varvec{S}}\left( {\varvec{A}} \right)}} {\varvec{d}}^{2} ({\varvec{s}}_{{\varvec{B}}} ,{\varvec{S}}\left( {\varvec{A}} \right)}$$\end{document}</tex-math><mml:math id="M66" display="block"><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">RMSD</mml:mi></mml:mrow><mml:mfenced close=")" open="("><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">A</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">B</mml:mi></mml:mrow></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mfenced close="|" open="|"><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">S</mml:mi></mml:mrow><mml:mfenced close=")" open="("><mml:mrow><mml:mi mathvariant="bold-italic">A</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced><mml:mo>+</mml:mo><mml:mfenced close="|" open="|"><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">S</mml:mi></mml:mrow><mml:mfenced close=")" open="("><mml:mrow><mml:mi mathvariant="bold-italic">B</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced></mml:mrow></mml:mfrac><mml:mo>×</mml:mo><mml:msqrt><mml:mrow><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">s</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">A</mml:mi></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">S</mml:mi></mml:mrow><mml:mfenced close=")" open="("><mml:mrow><mml:mi mathvariant="bold-italic">A</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:munder><mml:msup><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">d</mml:mi></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">s</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">A</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">S</mml:mi></mml:mrow><mml:mfenced close=")" open="("><mml:mrow><mml:mi mathvariant="bold-italic">B</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced><mml:mo>+</mml:mo><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">s</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">A</mml:mi></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">S</mml:mi></mml:mrow><mml:mfenced close=")" open="("><mml:mrow><mml:mi mathvariant="bold-italic">A</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:munder><mml:msup><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">d</mml:mi></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo></mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">s</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">B</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">S</mml:mi></mml:mrow><mml:mfenced close=")" open="("><mml:mrow><mml:mi mathvariant="bold-italic">A</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:msqrt></mml:mrow></mml:math><graphic xlink:href="41598_2022_20108_Article_Equ9.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par41">It is simply the root mean square of the distances calculated during the process of calculating ASD. An RMSD of 0 mm means a perfect segmentation. Hausdorff distance was calculated in millimeters with the following formula:<disp-formula id="Equ10"><label>10</label><alternatives><tex-math id="M67">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{HD}}\left( {{\varvec{A}},{\varvec{B}}} \right) = \mathop {{\text{max}}}\limits_{{{\varvec{a}} \in {\varvec{A}}}} \left\{ {\mathop {{\text{min}}}\limits_{{{\varvec{b}} \in {\varvec{B}}}} \left\{ {{\varvec{d}}\left( {{\varvec{a}},{\varvec{b}}} \right)} \right\}} \right\}$$\end{document}</tex-math><mml:math id="M68" display="block"><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">HD</mml:mi></mml:mrow><mml:mfenced close=")" open="("><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">A</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">B</mml:mi></mml:mrow></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:munder><mml:mtext>max</mml:mtext><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">a</mml:mi></mml:mrow><mml:mo>∈</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">A</mml:mi></mml:mrow></mml:mrow></mml:munder><mml:mfenced close="}" open="{"><mml:mrow><mml:munder><mml:mtext>min</mml:mtext><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">b</mml:mi></mml:mrow><mml:mo>∈</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">B</mml:mi></mml:mrow></mml:mrow></mml:munder><mml:mfenced close="}" open="{"><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">d</mml:mi></mml:mrow><mml:mfenced close=")" open="("><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">a</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">b</mml:mi></mml:mrow></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced></mml:mrow></mml:math><graphic xlink:href="41598_2022_20108_Article_Equ10.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par42">It is defined as the largest distance between the surface of A to the closest point in the surface of B. A Hausdorff distance of 0 mm means a perfect segmentation.</p>
      <p id="Par43">Statistical significance criterion was defined as <italic>p</italic> values <inline-formula id="IEq25"><alternatives><tex-math id="M69">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$&lt;$$\end{document}</tex-math><mml:math id="M70"><mml:mo>&lt;</mml:mo></mml:math><inline-graphic xlink:href="41598_2022_20108_Article_IEq25.gif"/></alternatives></inline-formula> 0.05 with Welch’s t-test.</p>
      <p id="Par44">UCLA Institutional Review Board approval was obtained (IRB#: 10-001869) and included waiver of informed consent. The authors attest they are in compliance with human studies committees of the authors’ institutions and performed in accordance with the ethical standards as laid down in the 1964 Declaration of Helsinki and its later amendments or comparable ethical standards.</p>
    </sec>
    <sec id="Sec10" sec-type="data-availability">
      <title>Data availability</title>
      <p id="Par45">The SLIVER07 dataset analyzed in this study is available at <ext-link ext-link-type="uri" xlink:href="https://sliver07.grand-challenge.org">https://sliver07.grand-challenge.org</ext-link>. The 3DIRCADb dataset analyzed in this study is available at <ext-link ext-link-type="uri" xlink:href="https://www.ircad.fr/research/data-sets/liver-segmentation-3d-ircadb-01/">https://www.ircad.fr/research/data-sets/liver-segmentation-3d-ircadb-01/</ext-link>. The entire code base and dockerfile for the code environment in Python are provided at <ext-link ext-link-type="uri" xlink:href="https://github.com/neemajamshidi/PADLLS">https://github.com/neemajamshidi/PADLLS</ext-link> and is also available as a Docker image on Docker Hub at jaysen20/siml-liver-net.</p>
    </sec>
  </sec>
  <sec id="Sec11">
    <title>Results</title>
    <sec id="Sec12">
      <title>Component-wise validation</title>
      <p id="Par46">The validation of the individual components of the liver segmentation pipeline were recorded in their respective papers; the V-net used in the initial segmentation was trained with more than 90 datasets<sup><xref ref-type="bibr" rid="CR10">10</xref></sup> and the H-DenseUnet that was used was trained with more than 130 datasets<sup><xref ref-type="bibr" rid="CR11">11</xref></sup>. Hence, the pipeline in this paper has been trained on more than 220 abdominal CT scans. The average Dice score per case for the H-DenseUnet was 0.961 for the LiTS challenge<sup><xref ref-type="bibr" rid="CR9">9</xref>, <xref ref-type="bibr" rid="CR11">11</xref></sup>. On a multi-center dataset with 90 subjects, the average Dice score per case for the V-net was 0.95 for the liver<sup><xref ref-type="bibr" rid="CR10">10</xref></sup>. While these results are encouraging, each of the networks has limitations that can result in oversegmentation of the liver, for example by inappropriate inclusion of abdominal ascites or other (non-hepatic) abdominal organs as part of the liver mask.</p>
    </sec>
    <sec id="Sec13">
      <title>Ascites correction</title>
      <p id="Par47">ROC analysis was used to identify an optimal threshold to remove ascites (Fig. <xref rid="Fig2" ref-type="fig">2</xref>). The ascites cutoff was selected at peak of the curve, 15 HU, a value that is consistent with the typical CT attenuation range of 5 to 15 HU for simple fluid. An example of the effects of the ascites correction for each of the individual DCNNs versus the pipeline are illustrated in Fig. <xref rid="Fig3" ref-type="fig">3</xref>. Figure <xref rid="Fig3" ref-type="fig">3</xref>A and C show that the V-net and H-DenseUnet have erroneously included abdominal fluid in their liver segmentations. However, once the ascites correction is applied, the liver segmentation contour becomes more accurate, as shown in Fig. <xref rid="Fig3" ref-type="fig">3</xref>B and D. The relative oversegmentation of ascites by these networks was quantified by comparing their respective VOE% for the case in Fig. <xref rid="Fig3" ref-type="fig">3</xref>. These results are reported in Table <xref rid="Tab3" ref-type="table">3</xref>, which reveals that PADLLS decreases ascites oversegmentation by approximately a factor of two and five for the V-net and H-DenseUnet, respectively.<fig id="Fig2"><label>Figure 2</label><caption><p>ROC curve for the ascites correction threshold. The threshold value was varied from 0 to 50 HU in increments of 5 HU to construct this curve. From 10 to 20 HU, the threshold was varied in increments of 1 HU. The optimal value of 15 HU was selected as the ascites threshold because it maximizes true positive rate and minimizes false positive rate.</p></caption><graphic xlink:href="41598_2022_20108_Fig2_HTML" id="MO2"/></fig><fig id="Fig3"><label>Figure 3</label><caption><p>Example of PADLLS oversegmentation correction of ascites. (<bold>A</bold>) V-net liver segmentation with no ascites correction and (<bold>C</bold>) H-DenseUnet segmentation with no ascites correction. (<bold>B</bold>) and (<bold>D</bold>) are final pipeline segmentations with ascites correction. The yellow shading in all of the images demarcates the liver. Window width (WW) and window length (WL) of 30 and 150 HU were used, respectively.</p></caption><graphic xlink:href="41598_2022_20108_Fig3_HTML" id="MO3"/></fig></p>
      <p id="Par48">A quantitative assessment of the ascites correction was performed through comparison of the Dice score with and without the correction. For 3DIRCADb, the average Dice improved from 0.926 to 0.965, a statistically significant difference based on Welch’s t-test (<italic>p</italic> = 0.0008). For SLIVER07, the average Dice improved from 0.940 to 0.957, but this difference was not statistically significant (<italic>p</italic> = 0.170). Given the relatively small number of datasets in 3DIRCADb and SLIVER07, this difference may reflect a higher incidence of ascites in 3DIRCADb than SLIVER07. Regardless, we expect that correction of ascites may have a significant impact on potential applications for liver segmentation (e.g. tumor segmentation, radiomic studies, etc.).</p>
    </sec>
    <sec id="Sec14">
      <title>Correction abdominal organ oversegmentation</title>
      <p id="Par49">The H-DenseUnet frequently oversegments by including portions of liver-adjacent organs (Fig. <xref rid="Fig4" ref-type="fig">4</xref>). Figure <xref rid="Fig4" ref-type="fig">4</xref>A and B are coronal and axial slices of the liver from a single example dataset used to demonstrate this phenomenon. Figure <xref rid="Fig4" ref-type="fig">4</xref>C shows an example 3D liver segmentation volume performed by the H-DenseUnet that has erroneously included a large portion of the spleen. Our pipeline, however, solves this issue by removing the spleen (identified from the V-net segmentation) before feeding this input into the H-DenseUnet. Figure <xref rid="Fig4" ref-type="fig">4</xref>D shows a 3D model of the liver from the same CT scan following PADLLS segmentation, notably without oversegmentation of the spleen or other abdominal organs.<fig id="Fig4"><label>Figure 4</label><caption><p>Example of PADLLS oversegmentation correction of the spleen and stomach. Axial (<bold>A</bold>) and coronal (<bold>B</bold>) CT slices of the segmented dataset at the level of the liver. (<bold>C</bold>) H-DenseUnet segmentation of liver from 3DIRCADb dataset that includes the spleen. (<bold>D</bold>) Final pipeline segmentation that accurately captures the lateral margin of the liver adjacent to the stomach but does not oversegment with the stomach or spleen. WW and WL of 350 and 40 HU were used, respectively.</p></caption><graphic xlink:href="41598_2022_20108_Fig4_HTML" id="MO4"/></fig></p>
    </sec>
    <sec id="Sec15">
      <title>Pipeline validation</title>
      <p id="Par50">Another exemplar illustrating the step wise improvement in segmentation during the intermediate steps is shown in Fig. <xref rid="Fig5" ref-type="fig">5</xref>. Figure <xref rid="Fig5" ref-type="fig">5</xref>A shows a preprocessed, unsegmented, axial CT slice. Figure <xref rid="Fig5" ref-type="fig">5</xref>B shows the V-net segmentation of the liver, stomach, and spleen. Figure <xref rid="Fig5" ref-type="fig">5</xref>C shows the result of the heuristic method of creating a binary ascites mask. Figure <xref rid="Fig5" ref-type="fig">5</xref>D was created by setting all stomach, spleen, and ascites pixels to − 100 HU using the yellow and purple segmentations from Fig. <xref rid="Fig5" ref-type="fig">5</xref>B and the ascites mask from Fig. <xref rid="Fig5" ref-type="fig">5</xref>C. Figure <xref rid="Fig5" ref-type="fig">5</xref>D then became the input for the H-DenseUnet. The final pipeline segmentation of the liver is provided in Fig. <xref rid="Fig5" ref-type="fig">5</xref>E.<fig id="Fig5"><label>Figure 5</label><caption><p>Example outlining intermediate pipeline steps. (<bold>A</bold>) An axial slice of a post-contrast CT image through the middle of the liver. (<bold>B</bold>) Initial result following V-net segmentation. Liver, stomach, and spleen are shaded orange, yellow, and purple, respectively. (<bold>C</bold>) Filter mask for ascites removal. (<bold>D</bold>) Input to the H-DenseUnet. Note that the stomach, spleen, and ascites pixels have been replaced with − 100 HU. (<bold>E</bold>) Final pipeline segmentation result with liver shaded in red. WW and WL are 400 and 50 for all of CT scans.</p></caption><graphic xlink:href="41598_2022_20108_Fig5_HTML" id="MO5"/></fig></p>
      <p id="Par51">The validation of the proposed liver segmentation pipeline was performed using the 3DIRCADb and SLIVER07 challenge datasets. The average Dice score for our pipeline for 3DIRCADb was 0.965 <inline-formula id="IEq26"><alternatives><tex-math id="M71">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\pm$$\end{document}</tex-math><mml:math id="M72"><mml:mo>±</mml:mo></mml:math><inline-graphic xlink:href="41598_2022_20108_Article_IEq26.gif"/></alternatives></inline-formula> 0.016. The average Dice score for our pipeline for the SLIVER07 challenge was 0.957 <inline-formula id="IEq27"><alternatives><tex-math id="M73">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\pm$$\end{document}</tex-math><mml:math id="M74"><mml:mo>±</mml:mo></mml:math><inline-graphic xlink:href="41598_2022_20108_Article_IEq27.gif"/></alternatives></inline-formula> 0.033. Tables <xref rid="Tab1" ref-type="table">1</xref> and <xref rid="Tab2" ref-type="table">2</xref> compare the average PADLLS Dice score to those of the V-net and H-DenseUnet for the SLIVER07 and 3DIRCADb benchmarks, respectively. From these tables we can see that PADLLS outperforms its constituent networks by a statistically significant margin (<italic>p</italic>
<inline-formula id="IEq28"><alternatives><tex-math id="M75">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$&lt;$$\end{document}</tex-math><mml:math id="M76"><mml:mo>&lt;</mml:mo></mml:math><inline-graphic xlink:href="41598_2022_20108_Article_IEq28.gif"/></alternatives></inline-formula> 0.05) for both benchmarks. Thus we believe our pipeline leverages strengths of different types of DCNN and further improves upon them in a synergistic fashion, as reflected by the boxplots of Dice scores for each network in each validation dataset (Fig. <xref rid="Fig6" ref-type="fig">6</xref>). Not only is the segmentation accuracy of PADLLS higher than both H-DenseUnet and V-net (Tables 1 and 2), but the segmentation error is also lower, suggesting greater consistency with PADLLS segmentation (Table <xref rid="Tab3" ref-type="table">3</xref>).<table-wrap id="Tab1"><label>Table 1</label><caption><p>Comparison of liver segmentation results on SLIVER07.</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Model</th><th align="left">Year</th><th align="left">VOE (%)</th><th align="left">RVD (%)</th><th align="left">ASD (mm)</th><th align="left">RMSD (mm)</th><th align="left">HD (mm)</th><th align="left">Dice</th><th align="left"><italic>p</italic> value</th></tr></thead><tbody><tr><td align="left">V-net<sup><xref ref-type="bibr" rid="CR10">10</xref></sup></td><td align="left">2018</td><td char="." align="char">21.15 <inline-formula id="IEq29"><alternatives><tex-math id="M77">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\pm$$\end{document}</tex-math><mml:math id="M78"><mml:mo>±</mml:mo></mml:math><inline-graphic xlink:href="41598_2022_20108_Article_IEq29.gif"/></alternatives></inline-formula> 14.65</td><td align="left">− 0.17 <inline-formula id="IEq30"><alternatives><tex-math id="M79">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\pm$$\end{document}</tex-math><mml:math id="M80"><mml:mo>±</mml:mo></mml:math><inline-graphic xlink:href="41598_2022_20108_Article_IEq30.gif"/></alternatives></inline-formula> 0.16</td><td char="." align="char">3.55 <inline-formula id="IEq31"><alternatives><tex-math id="M81">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\pm$$\end{document}</tex-math><mml:math id="M82"><mml:mo>±</mml:mo></mml:math><inline-graphic xlink:href="41598_2022_20108_Article_IEq31.gif"/></alternatives></inline-formula> 2.61</td><td char="." align="char">3.70 <inline-formula id="IEq32"><alternatives><tex-math id="M83">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\pm$$\end{document}</tex-math><mml:math id="M84"><mml:mo>±</mml:mo></mml:math><inline-graphic xlink:href="41598_2022_20108_Article_IEq32.gif"/></alternatives></inline-formula> 2.27</td><td char="." align="char">83.90 <inline-formula id="IEq33"><alternatives><tex-math id="M85">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\pm$$\end{document}</tex-math><mml:math id="M86"><mml:mo>±</mml:mo></mml:math><inline-graphic xlink:href="41598_2022_20108_Article_IEq33.gif"/></alternatives></inline-formula> 156.93</td><td char="." align="char">0.872 <inline-formula id="IEq34"><alternatives><tex-math id="M87">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\pm$$\end{document}</tex-math><mml:math id="M88"><mml:mo>±</mml:mo></mml:math><inline-graphic xlink:href="41598_2022_20108_Article_IEq34.gif"/></alternatives></inline-formula> 0.121</td><td align="left">0.0067*</td></tr><tr><td align="left">H-DenseUnet<sup><xref ref-type="bibr" rid="CR11">11</xref></sup></td><td align="left">2018</td><td char="." align="char">13.29 <inline-formula id="IEq35"><alternatives><tex-math id="M89">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\pm$$\end{document}</tex-math><mml:math id="M90"><mml:mo>±</mml:mo></mml:math><inline-graphic xlink:href="41598_2022_20108_Article_IEq35.gif"/></alternatives></inline-formula> 7.38</td><td align="left">0.0754 <inline-formula id="IEq36"><alternatives><tex-math id="M91">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\pm$$\end{document}</tex-math><mml:math id="M92"><mml:mo>±</mml:mo></mml:math><inline-graphic xlink:href="41598_2022_20108_Article_IEq36.gif"/></alternatives></inline-formula> 0.1174</td><td char="." align="char">5.34 <inline-formula id="IEq37"><alternatives><tex-math id="M93">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\pm$$\end{document}</tex-math><mml:math id="M94"><mml:mo>±</mml:mo></mml:math><inline-graphic xlink:href="41598_2022_20108_Article_IEq37.gif"/></alternatives></inline-formula> 8.13</td><td char="." align="char">6.85 <inline-formula id="IEq38"><alternatives><tex-math id="M95">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\pm$$\end{document}</tex-math><mml:math id="M96"><mml:mo>±</mml:mo></mml:math><inline-graphic xlink:href="41598_2022_20108_Article_IEq38.gif"/></alternatives></inline-formula> 5.84</td><td char="." align="char">93.35 <inline-formula id="IEq39"><alternatives><tex-math id="M97">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\pm$$\end{document}</tex-math><mml:math id="M98"><mml:mo>±</mml:mo></mml:math><inline-graphic xlink:href="41598_2022_20108_Article_IEq39.gif"/></alternatives></inline-formula> 131.38</td><td char="." align="char">0.927 <inline-formula id="IEq40"><alternatives><tex-math id="M99">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\pm$$\end{document}</tex-math><mml:math id="M100"><mml:mo>±</mml:mo></mml:math><inline-graphic xlink:href="41598_2022_20108_Article_IEq40.gif"/></alternatives></inline-formula> 0.044</td><td align="left">0.0219*</td></tr><tr><td align="left">PADLLS</td><td align="left">2022</td><td char="." align="char">8.14 <inline-formula id="IEq41"><alternatives><tex-math id="M101">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\pm$$\end{document}</tex-math><mml:math id="M102"><mml:mo>±</mml:mo></mml:math><inline-graphic xlink:href="41598_2022_20108_Article_IEq41.gif"/></alternatives></inline-formula> 5.67</td><td align="left">− 0.0056 <inline-formula id="IEq42"><alternatives><tex-math id="M103">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\pm$$\end{document}</tex-math><mml:math id="M104"><mml:mo>±</mml:mo></mml:math><inline-graphic xlink:href="41598_2022_20108_Article_IEq42.gif"/></alternatives></inline-formula> 0.0812</td><td char="." align="char">1.72 <inline-formula id="IEq43"><alternatives><tex-math id="M105">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\pm$$\end{document}</tex-math><mml:math id="M106"><mml:mo>±</mml:mo></mml:math><inline-graphic xlink:href="41598_2022_20108_Article_IEq43.gif"/></alternatives></inline-formula> 2.90</td><td char="." align="char">2.89 <inline-formula id="IEq44"><alternatives><tex-math id="M107">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\pm$$\end{document}</tex-math><mml:math id="M108"><mml:mo>±</mml:mo></mml:math><inline-graphic xlink:href="41598_2022_20108_Article_IEq44.gif"/></alternatives></inline-formula> 5.26</td><td char="." align="char">33.63 <inline-formula id="IEq45"><alternatives><tex-math id="M109">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\pm$$\end{document}</tex-math><mml:math id="M110"><mml:mo>±</mml:mo></mml:math><inline-graphic xlink:href="41598_2022_20108_Article_IEq45.gif"/></alternatives></inline-formula> 38.97</td><td char="." align="char">0.957 <inline-formula id="IEq46"><alternatives><tex-math id="M111">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\pm$$\end{document}</tex-math><mml:math id="M112"><mml:mo>±</mml:mo></mml:math><inline-graphic xlink:href="41598_2022_20108_Article_IEq46.gif"/></alternatives></inline-formula> 0.033</td><td align="left">–</td></tr></tbody></table><table-wrap-foot><p>An asterisk indicates a statistically significant difference in Dice score between our pipeline and another model (<italic>p</italic> &lt; 0.05).</p></table-wrap-foot></table-wrap><table-wrap id="Tab2"><label>Table 2</label><caption><p>Comparison of liver segmentation results on 3DIRCADb.</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Model</th><th align="left">Year</th><th align="left">VOE (%)</th><th align="left">RVD (%)</th><th align="left">ASD (mm)</th><th align="left">RMSD (mm)</th><th align="left">HD (mm)</th><th align="left">Dice</th><th align="left"><italic>p</italic> value</th></tr></thead><tbody><tr><td align="left">V-net<sup><xref ref-type="bibr" rid="CR10">10</xref></sup></td><td align="left">2018</td><td char="." align="char">21.85 ± 8.90</td><td align="left">− 0.1726 ± 0.100</td><td char="." align="char">4.07 ± 2.05</td><td char="." align="char">4.07 ± 2.81</td><td char="." align="char">49.59 ± 49.40</td><td char="." align="char">0.874 ± 0.060</td><td align="left"> &lt; 0.001*</td></tr><tr><td align="left">H-DenseUnet<sup><xref ref-type="bibr" rid="CR11">11</xref></sup></td><td align="left">2018</td><td char="." align="char">12.87 ± 6.87</td><td align="left">0.0313 ± 0.1187</td><td char="." align="char">4.10 ± 4.63</td><td char="." align="char">5.89 ± 7.16</td><td char="." align="char">53.60 ± 43.69</td><td char="." align="char">0.930 ± 0.041</td><td align="left">0.0014</td></tr><tr><td align="left">PADLLS</td><td align="left">2022</td><td char="." align="char">6.66 ± 2.89</td><td align="left">− 0.0421 ± 0.033</td><td char="." align="char">1.31 ± 0.83</td><td char="." align="char">1.94 ± 1.85</td><td char="." align="char">29.73 ± 19.90</td><td char="." align="char">0.965 ± 0.016</td><td align="left">–</td></tr></tbody></table><table-wrap-foot><p>An asterisk indicates a statistically significant difference in Dice score between our pipeline and another model (<italic>p</italic> &lt; 0.05).</p></table-wrap-foot></table-wrap><fig id="Fig6"><label>Figure 6</label><caption><p>Statistical summary of the Dice coefficients for SLIVER07 (<bold>A</bold>) and 3DIRCADb (<bold>B</bold>) for our pipeline, H-DenseUnet, and V-net corresponding to left, middle, and right boxplots, respectively. Box and whisker plots with blue boxes showing the interquartile range, red line indicating the median, and red pluses indicating outliers. 3DIRCADb and SLIVER07 consist of 2823 and 4159 individual CT slices, respectively.</p></caption><graphic xlink:href="41598_2022_20108_Fig6_HTML" id="MO6"/></fig><table-wrap id="Tab3"><label>Table 3</label><caption><p>Comparison of Volumetric Overlap Errors (VOE) for the case in Fig. <xref rid="Fig3" ref-type="fig">3</xref>.</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Model</th><th align="left">VOE (%)</th></tr></thead><tbody><tr><td align="left">V-net<sup><xref ref-type="bibr" rid="CR10">10</xref></sup></td><td char="." align="char">22.99</td></tr><tr><td align="left">H-DenseUnet<sup><xref ref-type="bibr" rid="CR11">11</xref></sup></td><td char="." align="char">51.01</td></tr><tr><td align="left">PADLLS</td><td char="." align="char">12.45</td></tr></tbody></table></table-wrap></p>
    </sec>
  </sec>
  <sec id="Sec16">
    <title>Discussion</title>
    <p id="Par52">Solid organ segmentation, particularly the liver, has received much attention in recent years and while many reports have now been able to achieve excellent scores for segmentation, there remain multiple challenges for broad adoption of these methods, (1) over/under-segmentation problems still exist, (2) most approaches are still only semi-automated, (3) depending on the underlying architecture of the network, some may perform well at separation of the liver from the heart and diaphragm but poorly with the spleen or bowel, and vice-versa with other networks, (4) most do not make code-bases publicly/freely available, (5) those that are available are often in restricted formats for input/output. We sought to overcome these limitations and provide a deep learning, fully automated liver segmentation pipeline that leverages the strengths of 2D and 3D based learning architectures to result in a model that outperforms the current state of the art models.</p>
    <p id="Par53">DCNN based approaches for liver segmentation have made great advancements in recent years producing multiple strong-performing segmentation models, but each of these models have had different pros and cons to date; no single model has been able to combine the strengths of different network structures (e.g., U-nets versus V-nets). The 2D H-DenseUnet is good at identifying intra-slice features but fails to take into account information along the z-axis, whereas the 3D V-net is good at inter-slice features but has a large computational cost. Furthermore, the majority of the top-performing models require some level of user interface and frequently have different input/output formats, thus limiting the potential for more wide-scale utility by the biomedical imaging community. Here we provide PADLLS as a fully automated pipeline leveraging the benefits of dense V-net and U-nets in addition to heuristic filters to correct oversegmentation problems.</p>
    <p id="Par54">Our pipeline was validated against the 3DIRCADb and SLIVER07 public datasets, which returned average Dice scores of 0.965 and 0.957, respectively; these scores were higher than the H-DenseUnet and V-net. The differences were statistically significant when compared to that of the V-net and H-DenseUnet for both the SLIVER07 and 3DIRCADb challenge. The improvement in performance supports the utility of the pipeline incorporating both network structures. Table <xref rid="Tab4" ref-type="table">4</xref> compares our pipeline to other segmentation algorithms that participated in the 3DIRCADb challenge in 2017 and some that were published after the challenge. PADLLS outperforms these networks as well. Supplementary Table <xref rid="MOESM1" ref-type="media">S3</xref> provides a comparison against additional networks that were only validated against a portion of the 3DIRCADb (including the mU-Net<sup><xref ref-type="bibr" rid="CR17">17</xref></sup>).<table-wrap id="Tab4"><label>Table 4</label><caption><p>Comparison of other liver segmentation models on 3DIRCADb challenge.</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Model</th><th align="left">Year</th><th align="left">Dataset</th><th align="left">VOE (%)</th><th align="left">RVD (%)</th><th align="left">ASD (mm)</th><th align="left">RMSD (mm)</th><th align="left">Dice</th><th align="left"><italic>P</italic> value</th></tr></thead><tbody><tr><td align="left">Unet<sup><xref ref-type="bibr" rid="CR22">22</xref></sup></td><td align="left">2017</td><td align="left">3DIRCADb</td><td align="left">14.21 <inline-formula id="IEq47"><alternatives><tex-math id="M113">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\pm$$\end{document}</tex-math><mml:math id="M114"><mml:mo>±</mml:mo></mml:math><inline-graphic xlink:href="41598_2022_20108_Article_IEq47.gif"/></alternatives></inline-formula> 5.71</td><td align="left">− 0.05 <inline-formula id="IEq48"><alternatives><tex-math id="M115">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\pm$$\end{document}</tex-math><mml:math id="M116"><mml:mo>±</mml:mo></mml:math><inline-graphic xlink:href="41598_2022_20108_Article_IEq48.gif"/></alternatives></inline-formula> 0.10</td><td align="left">4.33 <inline-formula id="IEq49"><alternatives><tex-math id="M117">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\pm$$\end{document}</tex-math><mml:math id="M118"><mml:mo>±</mml:mo></mml:math><inline-graphic xlink:href="41598_2022_20108_Article_IEq49.gif"/></alternatives></inline-formula> 3.39</td><td align="left">8.35 <inline-formula id="IEq50"><alternatives><tex-math id="M119">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\pm$$\end{document}</tex-math><mml:math id="M120"><mml:mo>±</mml:mo></mml:math><inline-graphic xlink:href="41598_2022_20108_Article_IEq50.gif"/></alternatives></inline-formula> 7.54</td><td align="left">0.923 <inline-formula id="IEq51"><alternatives><tex-math id="M121">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\pm$$\end{document}</tex-math><mml:math id="M122"><mml:mo>±</mml:mo></mml:math><inline-graphic xlink:href="41598_2022_20108_Article_IEq51.gif"/></alternatives></inline-formula> 0.03</td><td align="left">0.001*</td></tr><tr><td align="left">ResNet<sup><xref ref-type="bibr" rid="CR23">23</xref></sup></td><td align="left">2017</td><td align="left">3DIRCADb</td><td align="left">11.65 <inline-formula id="IEq52"><alternatives><tex-math id="M123">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\pm$$\end{document}</tex-math><mml:math id="M124"><mml:mo>±</mml:mo></mml:math><inline-graphic xlink:href="41598_2022_20108_Article_IEq52.gif"/></alternatives></inline-formula> 4.06</td><td align="left">− 0.03 <inline-formula id="IEq53"><alternatives><tex-math id="M125">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\pm$$\end{document}</tex-math><mml:math id="M126"><mml:mo>±</mml:mo></mml:math><inline-graphic xlink:href="41598_2022_20108_Article_IEq53.gif"/></alternatives></inline-formula> 0.06</td><td align="left">3.91 <inline-formula id="IEq54"><alternatives><tex-math id="M127">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\pm$$\end{document}</tex-math><mml:math id="M128"><mml:mo>±</mml:mo></mml:math><inline-graphic xlink:href="41598_2022_20108_Article_IEq54.gif"/></alternatives></inline-formula> 3.95</td><td align="left">8.11 <inline-formula id="IEq55"><alternatives><tex-math id="M129">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\pm$$\end{document}</tex-math><mml:math id="M130"><mml:mo>±</mml:mo></mml:math><inline-graphic xlink:href="41598_2022_20108_Article_IEq55.gif"/></alternatives></inline-formula> 9.68</td><td align="left">0.938 <inline-formula id="IEq56"><alternatives><tex-math id="M131">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\pm$$\end{document}</tex-math><mml:math id="M132"><mml:mo>±</mml:mo></mml:math><inline-graphic xlink:href="41598_2022_20108_Article_IEq56.gif"/></alternatives></inline-formula> 0.02</td><td align="left">0.03*</td></tr><tr><td align="left">Li et al.<sup><xref ref-type="bibr" rid="CR24">24</xref></sup></td><td align="left">2015</td><td align="left">3DIRCADb</td><td align="left">9.15 <inline-formula id="IEq57"><alternatives><tex-math id="M133">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\pm$$\end{document}</tex-math><mml:math id="M134"><mml:mo>±</mml:mo></mml:math><inline-graphic xlink:href="41598_2022_20108_Article_IEq57.gif"/></alternatives></inline-formula> 1.44</td><td align="left">− 0.07 <inline-formula id="IEq58"><alternatives><tex-math id="M135">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\pm$$\end{document}</tex-math><mml:math id="M136"><mml:mo>±</mml:mo></mml:math><inline-graphic xlink:href="41598_2022_20108_Article_IEq58.gif"/></alternatives></inline-formula> 3.64</td><td align="left">1.55 <inline-formula id="IEq59"><alternatives><tex-math id="M137">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\pm$$\end{document}</tex-math><mml:math id="M138"><mml:mo>±</mml:mo></mml:math><inline-graphic xlink:href="41598_2022_20108_Article_IEq59.gif"/></alternatives></inline-formula> 0.39</td><td align="left">3.15 <inline-formula id="IEq60"><alternatives><tex-math id="M139">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\pm$$\end{document}</tex-math><mml:math id="M140"><mml:mo>±</mml:mo></mml:math><inline-graphic xlink:href="41598_2022_20108_Article_IEq60.gif"/></alternatives></inline-formula> 0.98</td><td align="left">–</td><td align="left">–</td></tr><tr><td align="left">Moghbel et al.<sup><xref ref-type="bibr" rid="CR25">25</xref></sup></td><td align="left">2016</td><td align="left">3DIRCADb</td><td align="left">5.95</td><td align="left">7.49</td><td align="left">–</td><td align="left">–</td><td align="left">0.911</td><td align="left">–</td></tr><tr><td align="left">Lu et al.<sup><xref ref-type="bibr" rid="CR26">26</xref></sup></td><td align="left">2017</td><td align="left">3DIRCADb</td><td align="left">9.36 <inline-formula id="IEq61"><alternatives><tex-math id="M141">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\pm$$\end{document}</tex-math><mml:math id="M142"><mml:mo>±</mml:mo></mml:math><inline-graphic xlink:href="41598_2022_20108_Article_IEq61.gif"/></alternatives></inline-formula> 3.34</td><td align="left">0.97 <inline-formula id="IEq62"><alternatives><tex-math id="M143">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\pm$$\end{document}</tex-math><mml:math id="M144"><mml:mo>±</mml:mo></mml:math><inline-graphic xlink:href="41598_2022_20108_Article_IEq62.gif"/></alternatives></inline-formula> 3.26</td><td align="left">1.89 <inline-formula id="IEq63"><alternatives><tex-math id="M145">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\pm$$\end{document}</tex-math><mml:math id="M146"><mml:mo>±</mml:mo></mml:math><inline-graphic xlink:href="41598_2022_20108_Article_IEq63.gif"/></alternatives></inline-formula> 1.08</td><td align="left">4.15 <inline-formula id="IEq64"><alternatives><tex-math id="M147">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\pm$$\end{document}</tex-math><mml:math id="M148"><mml:mo>±</mml:mo></mml:math><inline-graphic xlink:href="41598_2022_20108_Article_IEq64.gif"/></alternatives></inline-formula> 3.1atio6</td><td align="left">–</td><td align="left">–</td></tr><tr><td align="left">U-net + GAN<sup><xref ref-type="bibr" rid="CR27">27</xref></sup></td><td align="left">2018</td><td align="left">3DIRCADb</td><td align="left">–</td><td align="left">–</td><td align="left">–</td><td align="left">–</td><td align="left">0.94</td><td align="left">–</td></tr><tr><td align="left">Zhang et al.<sup><xref ref-type="bibr" rid="CR28">28</xref></sup></td><td align="left">2020</td><td align="left">3DIRCADb</td><td align="left">–</td><td align="left">–</td><td align="left">–</td><td align="left">–</td><td align="left">0.958</td><td align="left">–</td></tr><tr><td align="left">DFS U-Net<sup><xref ref-type="bibr" rid="CR29">29</xref></sup></td><td align="left">2021</td><td align="left">LiTS</td><td align="left">–</td><td align="left">–</td><td align="left">–</td><td align="left">–</td><td align="left">0.949 <inline-formula id="IEq65"><alternatives><tex-math id="M149">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\pm$$\end{document}</tex-math><mml:math id="M150"><mml:mo>±</mml:mo></mml:math><inline-graphic xlink:href="41598_2022_20108_Article_IEq65.gif"/></alternatives></inline-formula> 0.031</td><td align="left">–</td></tr><tr><td align="left">MSN-Net<sup><xref ref-type="bibr" rid="CR30">30</xref></sup></td><td align="left">2021</td><td align="left">LiTS</td><td align="left">4.41 <inline-formula id="IEq66"><alternatives><tex-math id="M151">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\pm$$\end{document}</tex-math><mml:math id="M152"><mml:mo>±</mml:mo></mml:math><inline-graphic xlink:href="41598_2022_20108_Article_IEq66.gif"/></alternatives></inline-formula> 0.06</td><td align="left">–</td><td align="left">–</td><td align="left">–</td><td align="left">0.942 <inline-formula id="IEq67"><alternatives><tex-math id="M153">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\pm$$\end{document}</tex-math><mml:math id="M154"><mml:mo>±</mml:mo></mml:math><inline-graphic xlink:href="41598_2022_20108_Article_IEq67.gif"/></alternatives></inline-formula> 0.01</td><td align="left">–</td></tr><tr><td align="left">Araújo et al.<sup><xref ref-type="bibr" rid="CR31">31</xref></sup></td><td align="left">2022</td><td align="left">LiTS</td><td align="left">8.28</td><td align="left">− 0.41</td><td align="left">–</td><td align="left">–</td><td align="left">0.9564</td><td align="left">–</td></tr><tr><td align="left">DALU-Net<sup><xref ref-type="bibr" rid="CR32">32</xref></sup></td><td align="left">2022</td><td align="left">Custom</td><td align="left">–</td><td align="left">–</td><td align="left">–</td><td align="left">–</td><td align="left">0.899 <inline-formula id="IEq68"><alternatives><tex-math id="M155">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\pm$$\end{document}</tex-math><mml:math id="M156"><mml:mo>±</mml:mo></mml:math><inline-graphic xlink:href="41598_2022_20108_Article_IEq68.gif"/></alternatives></inline-formula> 0.201</td><td align="left">–</td></tr><tr><td align="left">PADLLS</td><td align="left">2022</td><td align="left">3DIRCADb</td><td align="left">6.66 <inline-formula id="IEq69"><alternatives><tex-math id="M157">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\pm$$\end{document}</tex-math><mml:math id="M158"><mml:mo>±</mml:mo></mml:math><inline-graphic xlink:href="41598_2022_20108_Article_IEq69.gif"/></alternatives></inline-formula> 2.89</td><td align="left">− 0.0421 <inline-formula id="IEq70"><alternatives><tex-math id="M159">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\pm$$\end{document}</tex-math><mml:math id="M160"><mml:mo>±</mml:mo></mml:math><inline-graphic xlink:href="41598_2022_20108_Article_IEq70.gif"/></alternatives></inline-formula> 0.033</td><td align="left">1.31 <inline-formula id="IEq71"><alternatives><tex-math id="M161">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\pm$$\end{document}</tex-math><mml:math id="M162"><mml:mo>±</mml:mo></mml:math><inline-graphic xlink:href="41598_2022_20108_Article_IEq71.gif"/></alternatives></inline-formula> 0.83</td><td align="left">1.94 <inline-formula id="IEq72"><alternatives><tex-math id="M163">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\pm$$\end{document}</tex-math><mml:math id="M164"><mml:mo>±</mml:mo></mml:math><inline-graphic xlink:href="41598_2022_20108_Article_IEq72.gif"/></alternatives></inline-formula> 1.85</td><td align="left">0.965 <inline-formula id="IEq73"><alternatives><tex-math id="M165">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\pm$$\end{document}</tex-math><mml:math id="M166"><mml:mo>±</mml:mo></mml:math><inline-graphic xlink:href="41598_2022_20108_Article_IEq73.gif"/></alternatives></inline-formula> 0.016</td><td align="left"/></tr></tbody></table><table-wrap-foot><p>An asterisk indicates a statistically significant difference in Dice score between our pipeline and another model (<italic>p</italic> &lt; 0.05). A dash indicates inability to assess for statistical significance due to the absence of reported Dice score and standard deviations.</p></table-wrap-foot></table-wrap></p>
    <p id="Par55">Normal livers have a wide range of morphological configurations (6 classifications according to Netter<sup><xref ref-type="bibr" rid="CR18">18</xref></sup>, with an even larger number based on recent cadaveric studies<sup><xref ref-type="bibr" rid="CR19">19</xref></sup>), thus the potential for oversegmentation by adjacent abdominal organs (particularly the stomach and spleen) is a challenge with current top performing segmentation models. We solved this issue by removing abdominal organs with similar density and close proximity to the liver or touch the liver using the V-net. In this case, we removed the spleen and stomach. These improvements are likely to be even more significant in the analysis of patients with pathological disease or anatomic variations. Abdominal ascites, commonly seen in patients with chronic liver disease resulting in cirrhosis for example, can present a significant challenge for fully automated liver segmentation models. We solved this problem by constructing an initial liver segmentation map, then using an optimized threshold to remove ascites.</p>
    <p id="Par56">Despite the improved accuracy and precision of the pipeline, limitations exist, particularly with respect to scans with significant pathology or post-operative alterations in anatomy. There remain challenges and improvements to be made including addressing pathological aspects of liver disease, such as cirrhotic contours, fatty liver, and mass detection.</p>
    <p id="Par57">One notable limitation of PADLLS is the computational cost incurred due to cascading networks. Once segmentation accuracies exceed 0.9, the incremental computational cost for improvement may be significant. For instance, PADLLS’ modest improvement over Zhang et al’s Dial-3DResUnet in the 3DIRCADb challenge (Table <xref rid="Tab4" ref-type="table">4</xref>), comes with having nearly 80 million learnable parameters relative to approximately 8.4 million in the latter. Most of the computational cost in PADLLS comes from the H-DenseUnet, which has 80 million parameters and takes 64.30 min per case on an 8 GB GPU. In contrast, the V-net only has about 12 million parameters and takes 4.44 s to segment every case. However when we ran PADLLS on the Hoffman2 cluster, segmentation only cost 162 s (32 GB GPU) per case, highlighting the point that over time due to improvements in hardware, the contribution of computational complexity to the overall computational cost decreases, thus the gains for improved accuracy (e.g. better liver segmentation resulting in improved accuracy and diagnostic capabilities for downstream applications) may offset the transiently increased computational costs (that will decrease over time).</p>
    <p id="Par58">In conclusion, we successfully developed a novel liver segmentation pipeline with a plethora of potential applications that are dependent on having a high quality, automated liver segmentation tool. The effectiveness of our pipeline in radiomics and clinical practice ought to be verified in future studies. In the hope that other investigators will benefit from this tool, we have made the source code freely available. We provide a fully automated CT liver segmentation algorithm that combines multiple DCNN architectures and provide it as a freely available tool that we hope will enable further biomedical imaging applications including radiomics<sup><xref ref-type="bibr" rid="CR20">20</xref></sup> and radiogenomics<sup><xref ref-type="bibr" rid="CR21">21</xref></sup>.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Information</title>
    <sec id="Sec17">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="41598_2022_20108_MOESM1_ESM.pdf">
            <caption>
              <p>Supplementary Information.</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <glossary>
    <title>Abbreviations</title>
    <def-list>
      <def-item>
        <term>ASD</term>
        <def>
          <p id="Par2">Average symmetric surface distance</p>
        </def>
      </def-item>
      <def-item>
        <term>BTCV</term>
        <def>
          <p id="Par3">Beyond the cranial vault</p>
        </def>
      </def-item>
      <def-item>
        <term>CT</term>
        <def>
          <p id="Par4">Computed tomography</p>
        </def>
      </def-item>
      <def-item>
        <term>DCNN</term>
        <def>
          <p id="Par5">Deep convolutional neural network</p>
        </def>
      </def-item>
      <def-item>
        <term>HD</term>
        <def>
          <p id="Par6">Hausdorff distance</p>
        </def>
      </def-item>
      <def-item>
        <term>kNN</term>
        <def>
          <p id="Par7">K-nearest neighbor</p>
        </def>
      </def-item>
      <def-item>
        <term>HF</term>
        <def>
          <p id="Par8">Hybrid fusion</p>
        </def>
      </def-item>
      <def-item>
        <term>HU</term>
        <def>
          <p id="Par9">Hounsfield units</p>
        </def>
      </def-item>
      <def-item>
        <term>LiTS</term>
        <def>
          <p id="Par10">Liver tumor segmentation</p>
        </def>
      </def-item>
      <def-item>
        <term>PADLLS</term>
        <def>
          <p id="Par11">Pipeline for automated deep learning liver segmentation</p>
        </def>
      </def-item>
      <def-item>
        <term>RMSD</term>
        <def>
          <p id="Par12">Root mean square symmetric surface distance</p>
        </def>
      </def-item>
      <def-item>
        <term>ROC</term>
        <def>
          <p id="Par13">Receiver operating characteristic</p>
        </def>
      </def-item>
      <def-item>
        <term>ROI</term>
        <def>
          <p id="Par14">Region of interest</p>
        </def>
      </def-item>
      <def-item>
        <term>RVD</term>
        <def>
          <p id="Par15">Relative volume difference</p>
        </def>
      </def-item>
      <def-item>
        <term>SLIVER07</term>
        <def>
          <p id="Par16">Segmentation of the liver competition 2007</p>
        </def>
      </def-item>
      <def-item>
        <term>VOE</term>
        <def>
          <p id="Par17">Volumetric overlap error</p>
        </def>
      </def-item>
      <def-item>
        <term>WL</term>
        <def>
          <p id="Par18">Window length</p>
        </def>
      </def-item>
      <def-item>
        <term>WW</term>
        <def>
          <p id="Par19">Window width</p>
        </def>
      </def-item>
    </def-list>
  </glossary>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher's note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <sec>
    <title>Supplementary Information</title>
    <p>The online version contains supplementary material available at 10.1038/s41598-022-20108-8.</p>
  </sec>
  <ack>
    <title>Acknowledgements</title>
    <p>N.J. was supported by an NIH NCATS and NIBIB UCLA CTSI Grant Number KL2TR001882 (PD: Wong). The authors appreciatively acknowledge the computational and storage services associated with the Hoffman2 Shared Cluster provided by UCLA Institute for Digital Research and Education’s Research Technology Group at UCLA. The scientific guarantor of this publication is Neema Jamshidi. The authors of this manuscript declare no relationships with any companies, whose products or services may be related to the subject matter of the article.</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Author contributions</title>
    <p>J.S. drafted the manuscript, carried out studies, prepared the figures, and performed analyses. N.J. conceived of the study, revised the manuscript, and performed analyses. All authors reviewed the manuscript and agree with the final content.</p>
  </notes>
  <notes id="FPar1" notes-type="COI-statement">
    <title>Competing interests</title>
    <p id="Par59">The authors declare no competing interests.</p>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gotra</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Sivakumaran</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Chartrand</surname>
            <given-names>G</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Liver segmentation: Indications, techniques and future directions</article-title>
        <source>Insights Imaging</source>
        <year>2017</year>
        <volume>8</volume>
        <fpage>377</fpage>
        <lpage>392</lpage>
        <pub-id pub-id-type="doi">10.1007/s13244-017-0558-1</pub-id>
        <?supplied-pmid 28616760?>
        <pub-id pub-id-type="pmid">28616760</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tapper</surname>
            <given-names>EB</given-names>
          </name>
          <name>
            <surname>Lok</surname>
            <given-names>AS-F</given-names>
          </name>
        </person-group>
        <article-title>Use of liver imaging and biopsy in clinical practice</article-title>
        <source>N. Engl. J. Med.</source>
        <year>2017</year>
        <volume>377</volume>
        <fpage>756</fpage>
        <lpage>768</lpage>
        <pub-id pub-id-type="doi">10.1056/NEJMra1610570</pub-id>
        <?supplied-pmid 28834467?>
        <pub-id pub-id-type="pmid">28834467</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Elsayes</surname>
            <given-names>KM</given-names>
          </name>
          <name>
            <surname>Kielar</surname>
            <given-names>AZ</given-names>
          </name>
          <name>
            <surname>Chernyak</surname>
            <given-names>V</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>LI-RADS: A conceptual and historical review from its beginning to its recent integration into AASLD clinical practice guidance</article-title>
        <source>J. Hepatocell Carcinoma</source>
        <year>2019</year>
        <volume>6</volume>
        <fpage>49</fpage>
        <lpage>69</lpage>
        <pub-id pub-id-type="doi">10.2147/JHC.S186239</pub-id>
        <?supplied-pmid 30788336?>
        <pub-id pub-id-type="pmid">30788336</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Norouzi</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Rahim</surname>
            <given-names>MSM</given-names>
          </name>
          <name>
            <surname>Altameem</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Medical image segmentation methods, algorithms, and applications</article-title>
        <source>IETE Tech. Rev.</source>
        <year>2014</year>
        <volume>31</volume>
        <fpage>199</fpage>
        <lpage>213</lpage>
        <pub-id pub-id-type="doi">10.1080/02564602.2014.906861</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rabottino</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Mencattini</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Salmeri</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Performance evaluation of a region growing procedure for mammographic breast lesion identification</article-title>
        <source>Comput. Stand. Interfaces</source>
        <year>2011</year>
        <volume>33</volume>
        <fpage>128</fpage>
        <lpage>135</lpage>
        <pub-id pub-id-type="doi">10.1016/j.csi.2010.06.003</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Clarke</surname>
            <given-names>LP</given-names>
          </name>
          <name>
            <surname>Velthuizen</surname>
            <given-names>RP</given-names>
          </name>
          <name>
            <surname>Phuphanich</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>MRI: Stability of three supervised segmentation techniques</article-title>
        <source>Magn. Reson. Imaging</source>
        <year>1993</year>
        <volume>11</volume>
        <fpage>95</fpage>
        <lpage>106</lpage>
        <pub-id pub-id-type="doi">10.1016/0730-725X(93)90417-C</pub-id>
        <?supplied-pmid 8423729?>
        <pub-id pub-id-type="pmid">8423729</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Boykov</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Funka-Lea</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>Graph cuts and efficient N-D image segmentation</article-title>
        <source>Int. J. Comput. Vis.</source>
        <year>2006</year>
        <volume>70</volume>
        <fpage>109</fpage>
        <lpage>131</lpage>
        <pub-id pub-id-type="doi">10.1007/s11263-006-7934-5</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hu</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Peng</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Automatic 3D liver segmentation based on deep learning and globally optimized surface evolution</article-title>
        <source>Phys. Med. Biol.</source>
        <year>2016</year>
        <volume>61</volume>
        <fpage>8676</fpage>
        <lpage>8698</lpage>
        <pub-id pub-id-type="doi">10.1088/1361-6560/61/24/8676</pub-id>
        <?supplied-pmid 27880735?>
        <pub-id pub-id-type="pmid">27880735</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <mixed-citation publication-type="other">Bilic, P., Christ, P. F., Vorontsov, E. <italic>et al.</italic> The liver tumor segmentation benchmark (LiTS). arXiv:190104056 [cs] (2019).</mixed-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gibson</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Giganti</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Hu</surname>
            <given-names>Y</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Automatic multi-organ segmentation on abdominal CT with dense V-networks</article-title>
        <source>IEEE Trans. Med. Imaging</source>
        <year>2018</year>
        <volume>37</volume>
        <fpage>1822</fpage>
        <lpage>1834</lpage>
        <pub-id pub-id-type="doi">10.1109/TMI.2018.2806309</pub-id>
        <?supplied-pmid 29994628?>
        <pub-id pub-id-type="pmid">29994628</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <mixed-citation publication-type="other">Li, X., Chen, H., Qi, X. <italic>et al.</italic> H-DenseUNet: Hybrid densely connected UNet for liver and tumor segmentation from CT volumes. arXiv:170907330 [cs] (2018).</mixed-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Heimann</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>van Ginneken</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Styner</surname>
            <given-names>MA</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Comparison and evaluation of methods for liver segmentation from CT datasets</article-title>
        <source>IEEE Trans. Med. Imaging</source>
        <year>2009</year>
        <volume>28</volume>
        <fpage>1251</fpage>
        <lpage>1265</lpage>
        <pub-id pub-id-type="doi">10.1109/TMI.2009.2013851</pub-id>
        <?supplied-pmid 19211338?>
        <pub-id pub-id-type="pmid">19211338</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <mixed-citation publication-type="other">3Dircadb | IRCAD France. <ext-link ext-link-type="uri" xlink:href="https://www.ircad.fr/research/3dircadb/">https://www.ircad.fr/research/3dircadb/</ext-link>. Accessed 26 Aug 2020.</mixed-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <mixed-citation publication-type="other">Roth, H., Farag, A., Turkbey, E. B. <italic>et al.</italic> Data from pancreas-CT (2016).</mixed-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <mixed-citation publication-type="other">Landman, B., Xu, Z., Igelsias, J. E. Segmentation outside the cranial vault challenge. 10.7303/SYN3193805 (2015).</mixed-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Gibson</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Giganti</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Hu</surname>
            <given-names>Y</given-names>
          </name>
          <etal/>
          <etal/>
        </person-group>
        <person-group person-group-type="editor">
          <name>
            <surname>Descoteaux</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Maier-Hein</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Franz</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
          <etal/>
        </person-group>
        <article-title>Towards image-guided pancreas and biliary endoscopy: Automatic multi-organ segmentation on abdominal CT with dense dilated networks</article-title>
        <source>Medical Image Computing and Computer Assisted Intervention—MICCAI 2017</source>
        <year>2017</year>
        <publisher-name>Springer International Publishing</publisher-name>
        <fpage>728</fpage>
        <lpage>736</lpage>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Seo</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Huang</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Bassenne</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Modified U-Net (mU-Net) with incorporation of object-dependent high level features for improved liver and liver-tumor segmentation in CT images</article-title>
        <source>IEEE Trans. Med. Imaging</source>
        <year>2020</year>
        <volume>39</volume>
        <fpage>1316</fpage>
        <lpage>1325</lpage>
        <pub-id pub-id-type="doi">10.1109/TMI.2019.2948320</pub-id>
        <?supplied-pmid 31634827?>
        <pub-id pub-id-type="pmid">31634827</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Netter</surname>
            <given-names>F</given-names>
          </name>
        </person-group>
        <source>Atlas of Human Anatomy</source>
        <year>2006</year>
        <edition>18</edition>
        <publisher-loc>Philadelphia, PA</publisher-loc>
        <publisher-name>Saunders/Elsevier</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chaudhari</surname>
            <given-names>HJ</given-names>
          </name>
          <name>
            <surname>Ravat</surname>
            <given-names>MK</given-names>
          </name>
          <name>
            <surname>Vaniya</surname>
            <given-names>VH</given-names>
          </name>
          <name>
            <surname>Bhedi</surname>
            <given-names>AN</given-names>
          </name>
        </person-group>
        <article-title>Morphological study of human liver and its surgical importance</article-title>
        <source>J. Clin. Diagn. Res.</source>
        <year>2017</year>
        <volume>11</volume>
        <fpage>AC09</fpage>
        <lpage>AC12</lpage>
        <pub-id pub-id-type="doi">10.7860/JCDR/2017/24467.10020</pub-id>
        <?supplied-pmid 28764141?>
        <pub-id pub-id-type="pmid">28764141</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gillies</surname>
            <given-names>RJ</given-names>
          </name>
          <name>
            <surname>Kinahan</surname>
            <given-names>PE</given-names>
          </name>
          <name>
            <surname>Hricak</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>Radiomics: Images are more than pictures, they are data</article-title>
        <source>Radiology</source>
        <year>2016</year>
        <volume>278</volume>
        <fpage>563</fpage>
        <lpage>577</lpage>
        <pub-id pub-id-type="doi">10.1148/radiol.2015151169</pub-id>
        <?supplied-pmid 26579733?>
        <pub-id pub-id-type="pmid">26579733</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kuo</surname>
            <given-names>MD</given-names>
          </name>
          <name>
            <surname>Jamshidi</surname>
            <given-names>N</given-names>
          </name>
        </person-group>
        <article-title>Behind the numbers: Decoding molecular phenotypes with radiogenomics–guiding principles and technical considerations</article-title>
        <source>Radiology</source>
        <year>2014</year>
        <volume>270</volume>
        <fpage>320</fpage>
        <lpage>325</lpage>
        <pub-id pub-id-type="doi">10.1148/radiol.13132195</pub-id>
        <?supplied-pmid 24471381?>
        <pub-id pub-id-type="pmid">24471381</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <mixed-citation publication-type="other">Chlebus, G., Meine, H., Moltz, J. H., Schenk, A. Neural network-based automatic liver tumor segmentation with random forest-based candidate filtering. arXiv:170600842 [cs] (2017).</mixed-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <mixed-citation publication-type="other">Han, X. Automatic liver lesion segmentation using a deep convolutional neural network method. arXiv preprint arXiv:170407239 (2017).</mixed-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Shi</surname>
            <given-names>F</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Automatic liver segmentation based on shape constraints and deformable graph cut in CT images</article-title>
        <source>IEEE Trans. Image Process.</source>
        <year>2015</year>
        <volume>24</volume>
        <fpage>5315</fpage>
        <lpage>5329</lpage>
        <pub-id pub-id-type="doi">10.1109/TIP.2015.2481326</pub-id>
        <pub-id pub-id-type="pmid">26415173</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Moghbel</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Mashohor</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Mahmud</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Saripan</surname>
            <given-names>MIB</given-names>
          </name>
        </person-group>
        <article-title>Automatic liver segmentation on computed tomography using random walkers for treatment planning</article-title>
        <source>EXCLI J.</source>
        <year>2016</year>
        <volume>15</volume>
        <fpage>500</fpage>
        <?supplied-pmid 28096782?>
        <pub-id pub-id-type="pmid">28096782</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lu</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Hu</surname>
            <given-names>P</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Automatic 3D liver location and segmentation via convolutional neural network and graph cut</article-title>
        <source>Int. J. Comput. Assist. Radiol. Surg.</source>
        <year>2017</year>
        <volume>12</volume>
        <fpage>171</fpage>
        <lpage>182</lpage>
        <pub-id pub-id-type="doi">10.1007/s11548-016-1467-3</pub-id>
        <pub-id pub-id-type="pmid">27604760</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Enokiya</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Iwamoto</surname>
            <given-names>Y</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Automatic liver segmentation using U-Net with wasserstein GANs</article-title>
        <source>JOIG</source>
        <year>2018</year>
        <volume>6</volume>
        <fpage>152</fpage>
        <lpage>159</lpage>
        <pub-id pub-id-type="doi">10.18178/joig.6.2.152-159</pub-id>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <mixed-citation publication-type="other">Zhang, C., Ai, D. &amp; Feng, C. <italic>et al.</italic> Dial/Hybrid cascade 3DResUNet for liver and tumor segmentation. <italic>In Proceedings of the 2020 4th International Conference on Digital Signal Processing</italic> 92–96 (2020).</mixed-citation>
    </ref>
    <ref id="CR29">
      <label>29.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Liu</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Han</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>Z</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Automatic liver segmentation from abdominal CT volumes using improved convolution neural networks</article-title>
        <source>Multimedia Syst.</source>
        <year>2021</year>
        <volume>27</volume>
        <fpage>111</fpage>
        <lpage>124</lpage>
        <pub-id pub-id-type="doi">10.1007/s00530-020-00709-x</pub-id>
      </element-citation>
    </ref>
    <ref id="CR30">
      <label>30.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Fan</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>X</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>MSN-Net: A multi-scale context nested U-Net for liver segmentation</article-title>
        <source>SIViP</source>
        <year>2021</year>
        <volume>15</volume>
        <fpage>1089</fpage>
        <lpage>1097</lpage>
        <pub-id pub-id-type="doi">10.1007/s11760-020-01835-9</pub-id>
      </element-citation>
    </ref>
    <ref id="CR31">
      <label>31.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Araújo</surname>
            <given-names>JDL</given-names>
          </name>
          <name>
            <surname>da Cruz</surname>
            <given-names>LB</given-names>
          </name>
          <name>
            <surname>Diniz</surname>
            <given-names>JOB</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Liver segmentation from computed tomography images using cascade deep learning</article-title>
        <source>Comput. Biol. Med.</source>
        <year>2021</year>
        <volume>140</volume>
        <fpage>105095</fpage>
        <pub-id pub-id-type="doi">10.1016/j.compbiomed.2021.105095</pub-id>
        <?supplied-pmid 34902610?>
        <pub-id pub-id-type="pmid">34902610</pub-id>
      </element-citation>
    </ref>
    <ref id="CR32">
      <label>32.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jeong</surname>
            <given-names>JG</given-names>
          </name>
          <name>
            <surname>Choi</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Kim</surname>
            <given-names>YJ</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Deep 3D attention CLSTM U-Net based automated liver segmentation and volumetry for the liver transplantation in abdominal CT volumes</article-title>
        <source>Sci. Rep.</source>
        <year>2022</year>
        <volume>12</volume>
        <fpage>6370</fpage>
        <pub-id pub-id-type="doi">10.1038/s41598-022-09978-0</pub-id>
        <?supplied-pmid 35430594?>
        <pub-id pub-id-type="pmid">35430594</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
