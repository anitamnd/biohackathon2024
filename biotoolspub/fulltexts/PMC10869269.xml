<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Nat Biotechnol</journal-id>
    <journal-id journal-id-type="iso-abbrev">Nat Biotechnol</journal-id>
    <journal-title-group>
      <journal-title>Nature Biotechnology</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1087-0156</issn>
    <issn pub-type="epub">1546-1696</issn>
    <publisher>
      <publisher-name>Nature Publishing Group US</publisher-name>
      <publisher-loc>New York</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10869269</article-id>
    <article-id pub-id-type="pmid">37156916</article-id>
    <article-id pub-id-type="publisher-id">1773</article-id>
    <article-id pub-id-type="doi">10.1038/s41587-023-01773-0</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Brief Communication</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Fast and accurate protein structure search with Foldseek</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" equal-contrib="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-2720-5714</contrib-id>
        <name>
          <surname>van Kempen</surname>
          <given-names>Michel</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author" equal-contrib="yes">
        <name>
          <surname>Kim</surname>
          <given-names>Stephanie S.</given-names>
        </name>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Tumescheit</surname>
          <given-names>Charlotte</given-names>
        </name>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0001-8637-6719</contrib-id>
        <name>
          <surname>Mirdita</surname>
          <given-names>Milot</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-5732-3009</contrib-id>
        <name>
          <surname>Lee</surname>
          <given-names>Jeongjae</given-names>
        </name>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Gilchrist</surname>
          <given-names>Cameron L. M.</given-names>
        </name>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0001-9642-8244</contrib-id>
        <name>
          <surname>Söding</surname>
          <given-names>Johannes</given-names>
        </name>
        <address>
          <email>soeding@mpinat.mpg.de</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0001-8781-9753</contrib-id>
        <name>
          <surname>Steinegger</surname>
          <given-names>Martin</given-names>
        </name>
        <address>
          <email>martin.steinegger@snu.ac.kr</email>
        </address>
        <xref ref-type="aff" rid="Aff2">2</xref>
        <xref ref-type="aff" rid="Aff4">4</xref>
        <xref ref-type="aff" rid="Aff5">5</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/03av75f26</institution-id><institution>Quantitative and Computational Biology Group, </institution><institution>Max Planck Institute for Multidisciplinary Sciences, </institution></institution-wrap>Göttingen, Germany </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/04h9pn542</institution-id><institution-id institution-id-type="GRID">grid.31501.36</institution-id><institution-id institution-id-type="ISNI">0000 0004 0470 5905</institution-id><institution>School of Biological Sciences, </institution><institution>Seoul National University, </institution></institution-wrap>Seoul, South Korea </aff>
      <aff id="Aff3"><label>3</label>Campus Institute Data Science (CIDAS), Göttingen, Germany </aff>
      <aff id="Aff4"><label>4</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/04h9pn542</institution-id><institution-id institution-id-type="GRID">grid.31501.36</institution-id><institution-id institution-id-type="ISNI">0000 0004 0470 5905</institution-id><institution>Artificial Intelligence Institute, </institution><institution>Seoul National University, </institution></institution-wrap>Seoul, South Korea </aff>
      <aff id="Aff5"><label>5</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/04h9pn542</institution-id><institution-id institution-id-type="GRID">grid.31501.36</institution-id><institution-id institution-id-type="ISNI">0000 0004 0470 5905</institution-id><institution>Institute of Molecular Biology and Genetics, </institution><institution>Seoul National University, </institution></institution-wrap>Seoul, South Korea </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>8</day>
      <month>5</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>8</day>
      <month>5</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="ppub">
      <year>2024</year>
    </pub-date>
    <volume>42</volume>
    <issue>2</issue>
    <fpage>243</fpage>
    <lpage>246</lpage>
    <history>
      <date date-type="received">
        <day>17</day>
        <month>2</month>
        <year>2022</year>
      </date>
      <date date-type="accepted">
        <day>30</day>
        <month>3</month>
        <year>2023</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2023</copyright-statement>
      <license>
        <ali:license_ref specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p><bold>Open Access</bold> This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The images or other third party material in this article are included in the article’s Creative Commons license, unless indicated otherwise in a credit line to the material. If material is not included in the article’s Creative Commons license and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this license, visit <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <p id="Par1">As structure prediction methods are generating millions of publicly available protein structures, searching these databases is becoming a bottleneck. Foldseek aligns the structure of a query protein against a database by describing tertiary amino acid interactions within proteins as sequences over a structural alphabet. Foldseek decreases computation times by four to five orders of magnitude with 86%, 88% and 133% of the sensitivities of Dali, TM-align and CE, respectively.</p>
    </abstract>
    <abstract id="Abs2" abstract-type="web-summary">
      <p id="Par2">Foldseek speeds up protein structural search by four to five orders of magnitude.</p>
    </abstract>
    <kwd-group kwd-group-type="npg-subject">
      <title>Subject terms</title>
      <kwd>Computational biology and bioinformatics</kwd>
      <kwd>Structural biology</kwd>
      <kwd>Software</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">https://doi.org/10.13039/501100003725</institution-id>
            <institution>National Research Foundation of Korea (NRF)</institution>
          </institution-wrap>
        </funding-source>
        <award-id>2019R1-A6A1-A10073437</award-id>
        <award-id>2019R1A6A1A10073437, 2020M3A9G7103933, 2021R1C1C102065, 2021M3A9I4021220</award-id>
        <principal-award-recipient>
          <name>
            <surname>Kim</surname>
            <given-names>Stephanie S.</given-names>
          </name>
          <name>
            <surname>Steinegger</surname>
            <given-names>Martin</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>German ministry for education and research (BMBF) (horizontal4meta)</institution>
        </funding-source>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>Samsung DS research fund, Creative-Pioneering Researchers Program through Seoul National University</institution>
        </funding-source>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© Springer Nature America, Inc. 2024</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Main</title>
    <p id="Par3">The recent developments in in silico protein structure prediction at near-experimental quality<sup><xref ref-type="bibr" rid="CR1">1</xref>,<xref ref-type="bibr" rid="CR2">2</xref></sup> are advancing structural biology and bioinformatics. The European Bioinformatics Institute already holds over 214 million structures predicted by AlphaFold2 (ref. <sup><xref ref-type="bibr" rid="CR3">3</xref></sup>), and the ESM Atlas contains over 617 million metagenomic structures predicted by ESMFold<sup><xref ref-type="bibr" rid="CR4">4</xref></sup>. The scale of these databases poses challenges to state-of-the-art analysis methods.</p>
    <p id="Par4">The most widely used approach to protein annotation and analysis is based on sequence similarity search<sup><xref ref-type="bibr" rid="CR5">5</xref>–<xref ref-type="bibr" rid="CR8">8</xref></sup>. The goal is to find homologous sequences from which properties of the query sequence can be inferred, such as molecular and cellular functions and structure. Despite the success of sequence-based homology inference, many proteins cannot be annotated because detecting distant evolutionary relationships from sequences alone remains challenging<sup><xref ref-type="bibr" rid="CR9">9</xref></sup>.</p>
    <p id="Par5">Detecting similarity between protein structures by three-dimensional (3D) superposition offers higher sensitivity for identifying homologous proteins<sup><xref ref-type="bibr" rid="CR10">10</xref></sup>. The availability of high-quality structures for any protein of interest allows us to use structure comparison to improve homology inference and structural, functional and evolutionary analyses. However, despite decades of effort to improve speed and sensitivity of structural aligners, current tools are much too slow to cope with today’s scale of structure databases.</p>
    <p id="Par6">Searching with a single query structure through a database with 100 million protein structures would take the popular TM-align<sup><xref ref-type="bibr" rid="CR11">11</xref></sup> tool a month on one CPU core, and an all-versus-all comparison would take 10 millennia on a 1,000-core cluster. Sequence searching is four to five orders of magnitude faster: an all-versus-all comparison of 100 million sequences would take MMseqs2 (ref. <sup><xref ref-type="bibr" rid="CR6">6</xref></sup>) only around a week on the same cluster.</p>
    <p id="Par7">Structural alignment tools (reviewed in ref. <sup><xref ref-type="bibr" rid="CR12">12</xref></sup>) are slower for two reasons. First, whereas sequence search tools employ fast and sensitive prefilter algorithms to gain orders of magnitude in speed, no similar prefilters exist for structure alignment. Second, structural similarity scores are non-local: changing the alignment in one part affects the similarity in all other parts. Most structural aligners, such as the popular TM-align, Dali and CE<sup><xref ref-type="bibr" rid="CR11">11</xref>,<xref ref-type="bibr" rid="CR13">13</xref>,<xref ref-type="bibr" rid="CR14">14</xref></sup>, solve the alignment optimization problem by iterative or stochastic optimization.</p>
    <p id="Par8">To increase speed, a crucial idea is to describe the amino acid backbone of proteins as sequences over a structural alphabet and compare structures using sequence alignments<sup><xref ref-type="bibr" rid="CR15">15</xref></sup>. Structural alphabets thus reduce structure comparisons to much faster sequence alignments. Many ways to discretize the local amino acid backbone have been proposed<sup><xref ref-type="bibr" rid="CR16">16</xref></sup>. Most, such as CLE, 3D-BLAST and Protein Blocks, discretize the conformations of short stretches of usually 3–5 C<sub><italic>α</italic></sub> atoms<sup><xref ref-type="bibr" rid="CR17">17</xref>–<xref ref-type="bibr" rid="CR19">19</xref></sup>.</p>
    <p id="Par9">For Foldseek, we developed a type of structural alphabet that does not describe the backbone but, rather, tertiary interactions. The 20 states of the 3D interaction (3Di) alphabet describe for each residue <italic>i</italic> the geometric conformation with its spatially closest residue <italic>j</italic>. 3Di has three key advantages over traditional backbone structural alphabets. (1) Weaker dependency between consecutive letters and (2) more evenly distributed state frequencies, both enhancing information density and reducing false positives (FPs) (Supplementary Table <xref rid="MOESM1" ref-type="media">1)</xref>. (3) The highest information density is encoded in conserved protein cores and the lowest in non-conserved coil/loop regions, whereas the opposite is true for backbone structural alphabets.</p>
    <p id="Par10">Foldseek (<ext-link ext-link-type="uri" xlink:href="https://foldseek.com/">https://foldseek.com/</ext-link>) (Fig. <xref rid="Fig1" ref-type="fig">1a</xref>) (1) discretizes the query structures into sequences over the 3Di alphabet and then uses a pre-trained 3Di substitution matrix (Supplementary Table <xref rid="MOESM1" ref-type="media">2)</xref> to search through the 3Di sequences of the target structures using the double-diagonal <italic>k</italic>-mer-based prefilter and gapless alignment prefilter modules from MMseqs2, our open-source sequence search software<sup><xref ref-type="bibr" rid="CR6">6</xref></sup>. (2) High-scoring hits are aligned locally using 3Di (default) or globally with TM-align (Foldseek-TM). The local alignment stage combines 3Di and amino acid substitution scores. The construction of the 3Di alphabet is summarized in Fig. <xref rid="Fig1" ref-type="fig">1b</xref> and Supplementary Figs. <xref rid="MOESM1" ref-type="media">1</xref>–<xref rid="MOESM1" ref-type="media">3</xref>.<fig id="Fig1"><label>Fig. 1</label><caption><title>Foldseek workflow.</title><p><bold>a</bold>, Foldseek searches a set of query structures through a set of target structures. (1) Query and target structures are discretized into 3Di sequences (see <bold>b</bold>). To detect candidate structures, we apply the fast and sensitive <italic>k</italic>-mer and ungapped alignment prefilter of MMseqs2 to the 3Di sequences, (2) followed by vectorized Smith–Waterman local alignment combining 3Di and amino acid substitution scores. Alternatively, a global alignment is computed with a 1.7-times accelerated TM-align version (Supplementary Fig. <xref rid="MOESM1" ref-type="media">12)</xref>. <bold>b</bold>, Learning the 3Di alphabet. (1) 3Di states describe tertiary interaction between a residue <italic>i</italic> and its nearest neighbor <italic>j</italic>. Nearest neighbors have the closest virtual center distance (yellow). Virtual center positions (Supplementary Fig. <xref rid="MOESM1" ref-type="media">1)</xref> were optimized for maximum search sensitivity. (2) To describe the interaction geometry of residues <italic>i</italic> and <italic>j</italic>, we extract seven angles, the Euclidean C<sub><italic>α</italic></sub> distance and two sequence distance features from the six C<sub><italic>α</italic></sub> coordinates of the two backbone fragments (blue and red). (3) These 10 features are used to define 20 3Di states by training a VQ-VAE<sup><xref ref-type="bibr" rid="CR28">28</xref></sup> modified to learn states that are maximally evolutionary conserved. For structure searches, the encoder predicts the best-matching 3Di state for each residue.</p></caption><graphic xlink:href="41587_2023_1773_Fig1_HTML" id="d32e430"/></fig></p>
    <p id="Par11">To reduce high-scoring FPs and provide reliable <italic>E</italic> values, we subtracted the reversed query alignment score from the original score and applied a compositional bias correction within a local 40-residue sequence window (see the ‘Pairwise local structural alignments’ subsection). <italic>E</italic> values are calculated using an extreme-value score distribution, with parameters predicted by a neural network based on 3Di sequence composition and query length (see the ‘<italic>E</italic> values’ subsection). Ranking of hits is determined by alignment bit score multiplied by the geometric mean of alignment TM-score and local distance difference test (LDDT). Foldseek also reports the probability for each match to be homologous, based on a fit of true and false matches on SCOPe.</p>
    <p id="Par12">We measured the sensitivity and speed of Foldseek, six protein structure alignment tools, an alignment-free structure search tool (Geometricus<sup><xref ref-type="bibr" rid="CR20">20</xref></sup>) and a sequence search tool (MMseqs2 (ref. <sup><xref ref-type="bibr" rid="CR6">6</xref></sup>)) on the SCOPe dataset of manually classified single-domain structures<sup><xref ref-type="bibr" rid="CR21">21</xref></sup>. Clustering SCOPe 2.01 at 40% sequence identity yielded 11,211 non-redundant protein sequences (SCOPe40). We performed an all-versus-all search and compared the tools’ performance for finding members of the same SCOPe family, superfamily and fold (true-positive (TP) matches) by measuring for each query the fraction of TPs out of all possible correct matches until the first FP, a match to a different fold (see the ‘SCOPe benchmark’ subsection).</p>
    <p id="Par13">We first measured the sensitivity to detect relationships at family and superfamily level by the area under the curve (AUC) of the cumulative receiver operating characteristic (ROC) curve up to the first FP (Fig. <xref rid="Fig2" ref-type="fig">2a</xref> and Supplementary Fig. <xref rid="MOESM1" ref-type="media">4)</xref>. Foldseek’s sensitivity is below Dali and TM-align, higher than the structural aligner CE and much above the structural alphabet-based search tools 3D-BLAST and CLE-SW (Fig. <xref rid="Fig2" ref-type="fig">2a</xref>). In a precision-recall analysis, Foldseek-TM and Foldseek have the highest and third-highest area under the precision-recall curve on each of the three levels (Fig. <xref rid="Fig2" ref-type="fig">2b</xref> and Supplementary Fig. <xref rid="MOESM1" ref-type="media">4)</xref>. Notably, Foldseek-TM improves over TM-align because its prefilter suppresses high-scoring FPs. Both sort hits by the average query and target length normalized TM-scores for best performance in the SCOPe benchmark.<fig id="Fig2"><label>Fig. 2</label><caption><title>Foldseek reaches similar sensitivities as structural aligners at thousands of times their speed.</title><p><bold>a</bold>, Cumulative distributions of sensitivity for homology detection on the SCOPe40 database of single-domain structures. TPs are matches within the same superfamily; FPs are matches between different folds. Sensitivity is the area under the ROC (AUROC) curve up to the first FP (see Supplementary Fig. <xref rid="MOESM1" ref-type="media">4</xref> for family and fold). <bold>b</bold>, Precision-recall curve of SCOPe40 superfamilies (see Supplementary Fig. <xref rid="MOESM1" ref-type="media">4</xref> for family and fold). <bold>c</bold>, Average sensitivity up to the first FP for family, superfamily and fold versus total runtime on an AMD EPYC 7702P 64-core CPU for the all-versus-all searches of 11,211 structures of SCOPe40. <bold>d</bold>, Search sensitivity on multi-domain, full-length AlphaFold2 protein models. One hundred queries, randomly selected from AlphaFoldDB (version 1), were searched against this database. Per-residue query coverage (<italic>y</italic> axis) is the fraction of residues covered by at least <italic>x</italic> (<italic>x</italic> axis) TP matches ranked before the first FP match. <bold>e</bold>, Alignment quality for alignments of AlphaFoldDB (version 1) protein models (top panel), averaged over the top five matches of each of the 100 queries. Sensitivity = TP residues in alignment / query length; precision = TP residues / alignment length. Reference-based alignment quality benchmark on HOMSTRAD alignments. <bold>f</bold>, Alignment quality comparison between Foldseek and Dali for each HOMSTRAD family. The <italic>F</italic><sub>1</sub> score is the harmonic mean between sensitivity and precision.</p></caption><graphic xlink:href="41587_2023_1773_Fig2_HTML" id="d32e521"/></fig></p>
    <p id="Par14">Foldseek’s performance is similar across all six secondary structure classes in SCOPe (Supplementary Fig. <xref rid="MOESM1" ref-type="media">5)</xref>. On this small SCOPe40 benchmark set, Foldseek is more than 4,000 times faster than TM-align and Dali and over 21,000 times faster than CE (Fig. <xref rid="Fig2" ref-type="fig">2c</xref>). On the much larger AlphaFoldDB (version 1), where Foldseek approaches its full speed, it is around 184,600 and 23,000 times faster than Dali and TM-align, respectively (see below).</p>
    <p id="Par15">We devised a reference-free benchmark to assess search sensitivity and alignment quality of structural aligners (Fig. <xref rid="Fig2" ref-type="fig">2d</xref>) on a realistic set of full-length, multi-domain proteins. We clustered the AlphaFoldDB (version 1) to 34,270 structures using BLAST and SPICi<sup><xref ref-type="bibr" rid="CR22">22</xref></sup>. We randomly selected 100 query structures from this set and aligned them against the remaining structures. TP matches are those with an LDDT score<sup><xref ref-type="bibr" rid="CR23">23</xref></sup> of at least 0.6 and FPs below 0.25, ignoring matches in between. We set the LDDT thresholds according to the median inter-fold and intra-fold superfamily and family LDDT scores of SCOPe40 alignments (Supplementary Fig. <xref rid="MOESM1" ref-type="media">6</xref>). For other thresholds, see Supplementary Fig. <xref rid="MOESM1" ref-type="media">7</xref>. A domain-based sensitivity assessment would require a reference-based prediction of domains. To avoid it, we evaluated the sensitivity per residue. Figure <xref rid="Fig2" ref-type="fig">2d</xref> shows the distribution of the fraction of query residues that were part of alignments with at least <italic>x</italic> TP targets with better scores than the first FP match. Again, Foldseek has similar sensitivity as Dali, CE and TM-align and much higher sensitivity than CLE-SW and MMseqs2.</p>
    <p id="Par16">We analyzed the quality of alignments produced by the top five matches per query. We computed the alignment sensitivity as the number of TP residues divided by the query length and the precision as the number of TP residues divided by the alignment length. TP residues are those with residue-specific LDDT score above 0.6; FP residues are below 0.25; and residues with other scores are ignored. Figure <xref rid="Fig2" ref-type="fig">2e</xref> shows the average sensitivity versus precision of the 100 × 5 structure alignments. Foldseek alignments are more accurate and sensitive than MMseqs2, CLE-SW and TM-align, similarly accurate as Dali and 13% less precise but 15% more sensitive than CE. In the reference-based HOMSTRAD alignment quality benchmark<sup><xref ref-type="bibr" rid="CR24">24</xref></sup>, Foldseek performs slightly below CE, Dali and TM-align (Fig. <xref rid="Fig2" ref-type="fig">2e</xref>). Figure <xref rid="Fig2" ref-type="fig">2f</xref> shows the comparison between Foldseek and Dali in alignment quality for all HOMSTRAD families (see Supplementary Fig. <xref rid="MOESM1" ref-type="media">8</xref> for example alignments).</p>
    <p id="Par17">To find potentially problematic high-scoring Foldseek FPs, we searched the set of unfragmented models in AlphaFoldDB (version 1) with average predicted LDDT<sup><xref ref-type="bibr" rid="CR1">1</xref></sup>≥80 against itself. We inspected the 1,675 (of 133,813) high-scoring FPs (score per aligned column ≥ 1.0, TM-score &lt; 0.5), revealing queries with multiple structured segments but with incorrect relative orientations (Supplementary Table <xref rid="MOESM1" ref-type="media">3</xref> and Supplementary Fig. <xref rid="MOESM1" ref-type="media">9)</xref>. The folded segments were correctly aligned by Foldseek. This illustrates that 3D aligners such as TM-align may overlook homologous structures that are not globally superposable, whereas Foldseek (as well as the two-dimensional (2D) aligner Dali) is independent of relative domain orientations and excels at detecting homologous multi-domain structures<sup><xref ref-type="bibr" rid="CR12">12</xref></sup>.</p>
    <p id="Par18">We developed a webserver (<ext-link ext-link-type="uri" xlink:href="https://search.foldseek.com">https://search.foldseek.com</ext-link>) for multi-database searches, including AlphaFoldDB (version 4: Proteomes and Swiss-Prot), AlphaFoldDB (version 4) and CATH<sup><xref ref-type="bibr" rid="CR25">25</xref></sup> clustered at 50% sequence identity, ESM Atlas-HQ and Protein Data Bank (PDB)<sup><xref ref-type="bibr" rid="CR26">26</xref></sup>.</p>
    <p id="Par19">We compared Foldseek webserver, TM-align and Dali using SARS-CoV-2 RdRp (PDB: <ext-link ext-link-type="uri" xlink:href="https://www.rcsb.org/structure/6M71">6M71</ext-link>, chain A (ref. <sup><xref ref-type="bibr" rid="CR27">27</xref></sup>); 942 residues) in AlphaFoldDB (version 1). Search times were 10 d for Dali, 33 h for TM-align and 6 s for Foldseek, making it 180,000 and 23,000 times faster. All top 10 hits were known RdRp homologs (Supplementary Table <xref rid="MOESM1" ref-type="media">4)</xref>.</p>
    <p id="Par20">The availability of high-quality structures for nearly every folded protein is transformative for biology and bioinformatics. Sequence-based analyses will soon be largely superseded by structure-based analyses. The main limitation in our view—the four orders of magnitude slower speed of structure comparisons—is removed by Foldseek.</p>
  </sec>
  <sec id="Sec2">
    <title>Methods</title>
    <sec id="Sec3">
      <title>Overview</title>
      <p id="Par21">Foldseek enables fast and sensitive comparison of large structure sets. It encodes structures as sequences over the 20-state 3Di alphabet and, thereby, reduces structural alignments to 3Di sequence alignments. The 3Di alphabet developed for Foldseek describes tertiary residue–residue interactions instead of backbone conformations and proved critical for reaching high sensitivities. Foldseek’s prefilter finds two <italic>similar</italic>, spaced 3Di <italic>k</italic>-mer matches in the same diagonal of the dynamic programming matrix. By not restricting itself to exact matches, the prefilter achieves high sensitivity while reducing the number of sequences for which full alignments are computed by several orders of magnitude. Further speed-ups are achieved by multi-threading and using single instruction, multiple data (SIMD) vector units. Owing to the SIMDe library (<ext-link ext-link-type="uri" xlink:href="https://github.com/simd-everywhere/simde">https://github.com/simd-everywhere/simde</ext-link>), Foldseek runs on a wide range of CPU architectures (x86_64, arm64 and ppc64le) and operating systems (Linux and macOS). The core modules of Foldseek, which build on the MMseqs2 framework<sup><xref ref-type="bibr" rid="CR6">6</xref></sup>, are described in the following paragraphs.</p>
    </sec>
    <sec id="Sec4">
      <title>Create database</title>
      <p id="Par22">The createdb module converts a set of PDB (ref. <sup><xref ref-type="bibr" rid="CR29">29</xref></sup>), macromolecular crystallographic information file (mmCIF) formatted files or Foldcomp compressed structure (FCZ (ref. <sup><xref ref-type="bibr" rid="CR30">30</xref></sup>)) files into an internal Foldseek database format using the Gemmi package (<ext-link ext-link-type="uri" xlink:href="https://gemmi.readthedocs.io/en/latest/">https://gemmi.readthedocs.io/en/latest/</ext-link>) or the Foldcomp library. The format is compatible with the MMseqs2 database format, which is optimized for parallel access. We store each chain as a separate entry in the database. The module follows the MMseqs2 createdb module logic. However, in addition to the amino acid sequence, it computes the 3Di sequence from the 3D atom coordinates of the backbone atom and C<sub><italic>β</italic></sub> coordinates (see the ‘Descriptors for 3Di structural alphabet’ and ‘Optimize nearest-neighbor selection’ subsections). Backbone atom and C<sub><italic>β</italic></sub> coordinates are needed only for the nearest-neighbor selection. For C<sub><italic>α</italic></sub>-only structures, Foldseek reconstructs backbone atom coordinates using PULCHRA<sup><xref ref-type="bibr" rid="CR31">31</xref></sup>. Missing C<sub><italic>β</italic></sub> coordinates (for example, in glycines) are defined such that the four groups attached to the C<sub><italic>α</italic></sub> are arranged at the vertices of a regular tetrahedron. The 3Di and amino acid sequences and the C<sub><italic>α</italic></sub> coordinates are stored in the Foldseek database. To save disk space, we optionally compress the C<sub><italic>α</italic></sub> coordinates losslessly, beginning with three uncompressed 4-byte floating-point C<sub><italic>α</italic></sub> coordinates and storing all subsequent coordinates as 2-byte signed integer differences<sup><xref ref-type="bibr" rid="CR32">32</xref></sup>. If any difference is too large to be represented with a 2-byte signed integer, we fall back to 4-byte floats for all C<sub><italic>α</italic></sub> coordinates.</p>
    </sec>
    <sec id="Sec5">
      <title>Prefilter</title>
      <p id="Par23">The prefilter module detects double matches of similar, spaced words (<italic>k</italic>-mers) that occur on the same diagonal. The <italic>k</italic>-mer size is dynamically set to <italic>k</italic> = 6 or <italic>k</italic> = 7 depending on the size of the target database. Similar <italic>k</italic>-mers are those with a 3Di substitution matrix score above a certain threshold, whereas MMseqs2 uses an amino acid substitution matrix to compute the similarity (see the ‘3Di substitution score matrix’ subsection). The gapless double-match criterion suppresses hits to non-homologous structures effectively, as they are less likely to have consecutive <italic>k</italic>-mer matches on the same diagonal by chance. To avoid FP matches due to regions with biased 3Di sequence composition, a compositional bias correction is applied in a way analogous to MMseqs2 (ref. <sup><xref ref-type="bibr" rid="CR33">33</xref></sup>). For each hit, we perform an ungapped alignment over the diagonals with double, consecutive, similar <italic>k</italic>-mer matches and sort those by the maximum ungapped diagonal score. Alignments with a score of at least 15 bits are passed on to the next stage. We implemented an optional taxonomy filter within the prefiltering step to help users search through taxonomic subsets of the target database. After the gapless double-diagonal matching stage and before the ungapped alignment stage, we reject all potential target hits that do not lie within a taxonomic clade specified by the user.</p>
    </sec>
    <sec id="Sec6">
      <title>Pairwise local structural alignments</title>
      <p id="Par24">After the prefilter has removed the vast majority of non-homologous sequences, the structurealign module computes pairwise alignments for the remaining sequences using an SIMD-accelerated Smith–Waterman algorithm<sup><xref ref-type="bibr" rid="CR34">34</xref>,<xref ref-type="bibr" rid="CR35">35</xref></sup>. We extended this implementation to support amino acid and 3Di scoring, compositional bias correction and 256-bit-wide vectorization. The score linearly combines amino acid and 3Di substitution scores with weights 1.4 and 2.1, respectively. We optimized these two weights and the ratio of gap extend to gap open penalty on ~1% of alignments (all-versus-all on 10% of randomly selected SCOPe40 domains). A compositional bias correction is applied to the amino acid and 3Di scores. To further suppress high-scoring FP matches, for each match we align the reversed query sequence against the target and subtract the reverse bit score from the forward bit score.</p>
    </sec>
    <sec id="Sec7">
      <title>Structural bit score</title>
      <p id="Par25">We rank hits by a ‘structural bit’ score—that is, the product of the bit score produce by the Smith–Waterman algorithm and the geometric mean of average alignment LDDT and the alignment TM-score.</p>
    </sec>
    <sec id="Sec8">
      <title>Fast alignment LDDT computation</title>
      <p id="Par26">To improve the LDDT score computation speed, we store the 3D coordinates of the query in a grid using spatial hashing. Each grid cell spans 15 Å, which is the default radius considered for the LDDT computation. For each aligned query residue <italic>i</italic>, we compute the distances to all C<sub><italic>α</italic></sub> atoms within a 15 Å radius by searching all neighboring grid cells of the query residue’s grid cell. For each residue <italic>j</italic>, we compute the distance between the C<sub><italic>α</italic></sub> atoms of <italic>i</italic> and <italic>j</italic> and the distance of the corresponding aligned target residues. Query and target distances for the aligned pairs are subtracted, and the differences <italic>d</italic> are transformed into LDDT scores <italic>s</italic> = 0.25 × ((<italic>d</italic> &lt; 0.5) + (<italic>d</italic> &lt; 1.0) + (<italic>d</italic> &lt; 2.0) + (<italic>d</italic> &lt; 4.0)). For each <italic>i</italic>, we obtain the means of the scores for all C<italic>α</italic> atoms <italic>j</italic> within the 15 Å radius of <italic>i</italic>. The LDDT score is the mean of these means over all query residues <italic>i</italic>.</p>
    </sec>
    <sec id="Sec9">
      <title><italic>E</italic> values</title>
      <p id="Par27">To estimate <italic>E</italic> values for each match, we trained a neural network to predict the mean <italic>μ</italic> and scale parameter <italic>λ</italic> of the extreme value distribution for each query. The module computemulambda takes a query and database structures as input and aligns the query against a randomly shuffled version of the database sequences. For each query sequence, the module produces <italic>N</italic> random alignments and fits to their scores an extreme value (Gumbel) distribution. The maximum likelihood fitting is done using the Gumbel fitting function taken from HMMER3 (hmmcalibrate)<sup><xref ref-type="bibr" rid="CR36">36</xref></sup>. To train the neural network, it is critical to use query and target proteins that include problematic regions, such as structurally biased, disordered or badly modeled regions that occur ubiquitously in full-length proteins or modeled structures. We, therefore, trained the network on 100,000 structures sampled from the AlphaFoldDB (version 1). We trained a neural network to predict <italic>μ</italic> and <italic>λ</italic> from the amino acid composition of the query and its length (so a scrambled version of the query sequence would produce the same <italic>μ</italic> and <italic>λ</italic>). The network has 22 input nodes, two fully connected layers with 32 nodes each (ReLU activation) and two linear output nodes. The optimizer Adam with learning rate 0.001 was used for training. When testing the resulting <italic>E</italic> values on searches with scrambled sequences, the log of the mean number of FPs per query turned out to have an accurately linear dependence on the log of the reported <italic>E</italic> values, albeit with a slope of 0.32 instead of 1. We, therefore, correct the <italic>E</italic> values from the neural network by taking them to the power of 0.32. We compared how well the mean number of FPs at a given <italic>E</italic> value agreed with the <italic>E</italic> values reported by Foldseek, MMseqs2 and 3D-Blast (Supplementary Fig. <xref rid="MOESM1" ref-type="media">10</xref>; see Supplementary Fig. <xref rid="MOESM1" ref-type="media">11</xref> for AlphaFoldDB). We considered a hit as FP if it was in a different fold and had a TM-score lower than 0.3. Furthermore, we ignored all cross-fold hits within the four-bladed to eight-bladed <italic>β</italic>-propeller superfamilies (SCOPe b.66-b.70) and within the Rossman-like folds (c.2–c.5, c.27, c.28, c.30 and c.31) because of the extensive cross-fold homologies within these groups<sup><xref ref-type="bibr" rid="CR37">37</xref></sup>.</p>
    </sec>
    <sec id="Sec10">
      <title>Probability of TP match</title>
      <p id="Par28">Foldseek computes for each match a simple estimate for the probability that the match is a TP match given its structural bit score. Here, hits within the same superfamily are TP; hits to another fold are FP; and hits to the same family or to another superfamily are ignored. We estimate the structural bit score distributions of TP and FP hits (<italic>p</italic>(<italic>s</italic><italic>c</italic><italic>o</italic><italic>r</italic><italic>e</italic>∣<italic>T</italic><italic>P</italic>) and <italic>p</italic>(<italic>s</italic><italic>c</italic><italic>o</italic><italic>r</italic><italic>e</italic>∣<italic>F</italic><italic>P</italic>)), which allow us to calculate the probability of a TP <inline-formula id="IEq1"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p(TP| score)=\frac{p(\,{{\mbox{score}}}\,| TP)\,p(TP)}{p(\,{{\mbox{score}}}\,| TP)\,p(TP)+p(\,{{\mbox{score}}}\,| FP)\,p(FP)}$$\end{document}</tex-math><mml:math id="M2"><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>T</mml:mi><mml:mi>P</mml:mi><mml:mo>∣</mml:mo><mml:mi>s</mml:mi><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mspace width="0.25em"/><mml:mstyle><mml:mtext>score</mml:mtext></mml:mstyle><mml:mspace width="0.25em"/><mml:mo>∣</mml:mo><mml:mi>T</mml:mi><mml:mi>P</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mspace width="0.25em"/><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>T</mml:mi><mml:mi>P</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mspace width="0.25em"/><mml:mstyle><mml:mtext>score</mml:mtext></mml:mstyle><mml:mspace width="0.25em"/><mml:mo>∣</mml:mo><mml:mi>T</mml:mi><mml:mi>P</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mspace width="0.25em"/><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>T</mml:mi><mml:mi>P</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mspace width="0.25em"/><mml:mstyle><mml:mtext>score</mml:mtext></mml:mstyle><mml:mspace width="0.25em"/><mml:mo>∣</mml:mo><mml:mi>F</mml:mi><mml:mi>P</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mspace width="0.25em"/><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>F</mml:mi><mml:mi>P</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mrow></mml:math><inline-graphic xlink:href="41587_2023_1773_Article_IEq1.gif"/></alternatives></inline-formula>. Both score distributions were fitted on SCOPe40 with a mixture model consisting of two gamma distributions (resulting in five parameters for each function). For the fitting, the function gammamixEM from the R package mixtools<sup><xref ref-type="bibr" rid="CR38">38</xref></sup> was used. We excluded cross-fold hits between certain folds as in the <italic>E</italic> value estimation. For example, Foldseek finds around the same number of FPs and TPs with a score of 51 in SCOPe40. The probability for a hit with score 51 is, therefore, 50%.</p>
    </sec>
    <sec id="Sec11">
      <title>Pairwise global structural alignments using TM-align</title>
      <p id="Par29">We also offer the option to use TM-align for pairwise structure alignment instead of the 3Di-based alignment. We implemented TM-align based on the C<sub><italic>α</italic></sub> atom coordinates and made adjustments to improve the (1) speed and (2) memory usage. (1) TM-align performs multiple floating-point-based Needleman–Wunsch (NW) alignment steps while applying different scoring functions (for example, score secondary structure, Euclidean distance of superposed structures or fragments). TM-align’s NW code did not take advantage of SIMD instructions; therefore, we replaced it by parasail’s<sup><xref ref-type="bibr" rid="CR39">39</xref></sup> SIMD-based NW implementation and extended it to support the different scoring functions. We also replaced the TM-score computation using fast_protein_cluster’s SIMD-based implementation<sup><xref ref-type="bibr" rid="CR40">40</xref></sup>. Our NW implementation does not compute exactly the same alignment because we apply affine gap costs, whereas TM-align does not (Supplementary Fig. <xref rid="MOESM1" ref-type="media">12)</xref>. (2) TM-align requires 17 bytes × query length × target length of memory, and we reduce the constant overhead from 17 bytes to 4 bytes. If Foldseek is used in TM-align mode (parameter --alignment-type 1), TM-align is used for the alignment stage after the prefilter step, where we replace the reported <italic>E</italic> value column with TM-scores normalized by the query length. The results are ordered in descending order by average TM-score by default.</p>
    </sec>
    <sec id="Sec12">
      <title>Descriptors for 3Di structural alphabet</title>
      <p id="Par30">The 3Di alphabet describes the tertiary contacts between residues and their nearest neighbors in 3D space. For each residue <italic>i</italic>, the conformation of the local backbone around <italic>i</italic>, together with the local backbone around its nearest neighbor <italic>j</italic>, is approximated by 20 discrete states (Supplementary Fig. <xref rid="MOESM1" ref-type="media">3)</xref>. We chose the alphabet size <italic>A</italic> = 20 as a tradeoff between encoding as much information as possible (large <italic>A</italic>; Supplementary Fig. <xref rid="MOESM1" ref-type="media">13)</xref> and limiting the number of similar 3Di <italic>k</italic>-mers that we need to generate in the <italic>k</italic>-mer-based prefilter, which scales with <italic>A</italic><sup><italic>k</italic></sup>. The discrete single-letter states are formed from neighborhood descriptors containing 10 features encoding the conformation of backbones around residues <italic>i</italic> and <italic>j</italic> represented by the C<sub><italic>α</italic></sub> atoms (C<sub><italic>α</italic>,<italic>i</italic>−1</sub>, C<sub><italic>α</italic>,<italic>i</italic></sub>, C<sub><italic>α</italic>,<italic>i</italic>+1</sub>) and (C<sub><italic>α</italic>, <italic>j</italic>−1</sub>, C<sub><italic>α</italic>, <italic>j</italic></sub>, C<sub><italic>α</italic>, <italic>j</italic>+1</sub>). The descriptors use the five unit vectors along the following directions:<disp-formula id="Equa"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{array}{ll}\mathbf{{u}_{1}}:{{{\mbox{C}}}}_{\alpha ,i-1}\to {{{\mbox{C}}}}_{\alpha ,\,i}&amp;\mathbf{{u}_{4}}:{{{\mbox{C}}}}_{\alpha ,\,j}\to {{{\mbox{C}}}}_{\alpha ,\,j+1}\\ \mathbf{{u}_{2}}:{{{\mbox{C}}}}_{\alpha ,\,i}\to {{{\mbox{C}}}}_{\alpha ,\,i+1}&amp;\mathbf{{u}_{5}}:{{{\mbox{C}}}}_{\alpha ,\,i}\to {{{\mbox{C}}}}_{\alpha ,\,j}\\ \mathbf{{u}_{3}}:{{{\mbox{C}}}}_{\alpha ,\,j-1}\to {{{\mbox{C}}}}_{\alpha ,\,j}.&amp;\end{array}$$\end{document}</tex-math><mml:math id="M4"><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:msub><mml:mrow><mml:mi mathvariant="bold">u</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>:</mml:mo><mml:msub><mml:mrow><mml:mstyle><mml:mtext>C</mml:mtext></mml:mstyle></mml:mrow><mml:mrow><mml:mi>α</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>→</mml:mo><mml:msub><mml:mrow><mml:mstyle><mml:mtext>C</mml:mtext></mml:mstyle></mml:mrow><mml:mrow><mml:mi>α</mml:mi><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mtd><mml:mtd columnalign="left"><mml:msub><mml:mrow><mml:mi mathvariant="bold">u</mml:mi></mml:mrow><mml:mrow><mml:mn>4</mml:mn></mml:mrow></mml:msub><mml:mo>:</mml:mo><mml:msub><mml:mrow><mml:mstyle><mml:mtext>C</mml:mtext></mml:mstyle></mml:mrow><mml:mrow><mml:mi>α</mml:mi><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>→</mml:mo><mml:msub><mml:mrow><mml:mstyle><mml:mtext>C</mml:mtext></mml:mstyle></mml:mrow><mml:mrow><mml:mi>α</mml:mi><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:mi>j</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:msub><mml:mrow><mml:mi mathvariant="bold">u</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>:</mml:mo><mml:msub><mml:mrow><mml:mstyle><mml:mtext>C</mml:mtext></mml:mstyle></mml:mrow><mml:mrow><mml:mi>α</mml:mi><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>→</mml:mo><mml:msub><mml:mrow><mml:mstyle><mml:mtext>C</mml:mtext></mml:mstyle></mml:mrow><mml:mrow><mml:mi>α</mml:mi><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mtd><mml:mtd columnalign="left"><mml:msub><mml:mrow><mml:mi mathvariant="bold">u</mml:mi></mml:mrow><mml:mrow><mml:mn>5</mml:mn></mml:mrow></mml:msub><mml:mo>:</mml:mo><mml:msub><mml:mrow><mml:mstyle><mml:mtext>C</mml:mtext></mml:mstyle></mml:mrow><mml:mrow><mml:mi>α</mml:mi><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>→</mml:mo><mml:msub><mml:mrow><mml:mstyle><mml:mtext>C</mml:mtext></mml:mstyle></mml:mrow><mml:mrow><mml:mi>α</mml:mi><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:msub><mml:mrow><mml:mi mathvariant="bold">u</mml:mi></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:mo>:</mml:mo><mml:msub><mml:mrow><mml:mstyle><mml:mtext>C</mml:mtext></mml:mstyle></mml:mrow><mml:mrow><mml:mi>α</mml:mi><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:mi>j</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>→</mml:mo><mml:msub><mml:mrow><mml:mstyle><mml:mtext>C</mml:mtext></mml:mstyle></mml:mrow><mml:mrow><mml:mi>α</mml:mi><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>.</mml:mo></mml:mtd><mml:mtd columnalign="left"/></mml:mtr></mml:mtable></mml:math><graphic xlink:href="41587_2023_1773_Article_Equa.gif" position="anchor"/></alternatives></disp-formula>We define the angle between <italic>u</italic><sub><italic>k</italic></sub> and <italic>u</italic><sub><italic>l</italic></sub> as <italic>ϕ</italic><sub><italic>k</italic><italic>l</italic></sub>, so <inline-formula id="IEq2"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\cos {\phi }_{kl}=\mathbf{{u}_{k}}^{T}\mathbf{{u}_{l}}$$\end{document}</tex-math><mml:math id="M6"><mml:mrow><mml:mi>cos</mml:mi><mml:msub><mml:mrow><mml:mi>ϕ</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">u</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:msub><mml:mrow><mml:mi mathvariant="bold">u</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="41587_2023_1773_Article_IEq2.gif"/></alternatives></inline-formula>. The seven features <inline-formula id="IEq3"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\cos {\phi }_{12},\cos {\phi }_{34},\cos {\phi }_{15},\cos {\phi }_{35},\cos {\phi }_{14},\cos {\phi }_{23},\cos {\phi }_{13}$$\end{document}</tex-math><mml:math id="M8"><mml:mrow><mml:mi>cos</mml:mi><mml:msub><mml:mrow><mml:mi>ϕ</mml:mi></mml:mrow><mml:mrow><mml:mn>12</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>cos</mml:mi><mml:msub><mml:mrow><mml:mi>ϕ</mml:mi></mml:mrow><mml:mrow><mml:mn>34</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>cos</mml:mi><mml:msub><mml:mrow><mml:mi>ϕ</mml:mi></mml:mrow><mml:mrow><mml:mn>15</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>cos</mml:mi><mml:msub><mml:mrow><mml:mi>ϕ</mml:mi></mml:mrow><mml:mrow><mml:mn>35</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>cos</mml:mi><mml:msub><mml:mrow><mml:mi>ϕ</mml:mi></mml:mrow><mml:mrow><mml:mn>14</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>cos</mml:mi><mml:msub><mml:mrow><mml:mi>ϕ</mml:mi></mml:mrow><mml:mrow><mml:mn>23</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>cos</mml:mi><mml:msub><mml:mrow><mml:mi>ϕ</mml:mi></mml:mrow><mml:mrow><mml:mn>13</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="41587_2023_1773_Article_IEq3.gif"/></alternatives></inline-formula> and the distance ∣C<sub><italic>α</italic>,<italic>i</italic></sub> − C<sub><italic>α</italic>, <italic>j</italic></sub>∣ describe the conformation between the backbone fragments. In addition, we encode the sequence distance with the two features <inline-formula id="IEq4"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\,{{\mbox{sign}}}\,(i-j)\,\min (| i-j| ,4)$$\end{document}</tex-math><mml:math id="M10"><mml:mrow><mml:mspace width="0.25em"/><mml:mstyle><mml:mtext>sign</mml:mtext></mml:mstyle><mml:mspace width="0.25em"/><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>−</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mspace width="0.25em"/><mml:mi>min</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>∣</mml:mo><mml:mi>i</mml:mi><mml:mo>−</mml:mo><mml:mi>j</mml:mi><mml:mo>∣</mml:mo><mml:mo>,</mml:mo><mml:mn>4</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="41587_2023_1773_Article_IEq4.gif"/></alternatives></inline-formula> and <inline-formula id="IEq5"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\,{{\mbox{sign}}}\,(i-j)\,\log (| i-j| +1)$$\end{document}</tex-math><mml:math id="M12"><mml:mrow><mml:mspace width="0.25em"/><mml:mstyle><mml:mtext>sign</mml:mtext></mml:mstyle><mml:mspace width="0.25em"/><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>−</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mspace width="0.25em"/><mml:mi>log</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>∣</mml:mo><mml:mi>i</mml:mi><mml:mo>−</mml:mo><mml:mi>j</mml:mi><mml:mo>∣</mml:mo><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="41587_2023_1773_Article_IEq5.gif"/></alternatives></inline-formula>.</p>
    </sec>
    <sec id="Sec13">
      <title>Learning the 3Di states using a vector quantized variational autoencoder</title>
      <p id="Par31">The 10-dimensional descriptors were discretized into an alphabet of 20 states using a vector quantized variational autoencoder (VQ-VAE)<sup><xref ref-type="bibr" rid="CR28">28</xref></sup>. In contrast to standard clustering approaches such as <italic>k</italic>-means, VQ-VAE is a nonlinear approach that can optimize decision surfaces for each of its states. In contrast to the standard VQ-VAE, we trained the VQ-VAE not as a simple generative model but, rather, to learn states that are maximally conserved in evolution. To that end, we trained it with pairs of descriptors <inline-formula id="IEq6"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{\bf{x}}}}}_{n},{{{{\bf{y}}}}}_{n}\in {{\mathbb{R}}}^{10}$$\end{document}</tex-math><mml:math id="M14"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">x</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">y</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="41587_2023_1773_Article_IEq6.gif"/></alternatives></inline-formula> from structurally aligned residues, to predict the distribution of y<sub><italic>n</italic></sub> from x<sub><italic>n</italic></sub>.</p>
      <p id="Par32">The VQ-VAE consists of an encoder and decoder network with the discrete latent 3Di state as a bottleneck in between. The encoder network embeds the 10-dimensional descriptor x<sub><italic>n</italic></sub> into a 2D continuous latent space, where the embedding is then discretized by the nearest centroid, each centroid representing a 3Di state. Given the centroid, the decoder predicts the probability distribution of the descriptor y<sub><italic>n</italic></sub> of the aligned residue. After training, only encoder and centroids are used to discretize descriptors. Encoder and decoder networks are both fully connected with two hidden layers of dimension 10, a batch normalization after each hidden layer and ReLU as activation functions. The encoder, centroids and decoder have 242, 40 and 352 parameters, respectively. The output layer of the decoder consists of 20 units predicting <italic>μ</italic> and <italic>σ</italic><sup>2</sup> of the descriptors <italic>x</italic> of the aligned residue, such that the decoder predicts <inline-formula id="IEq7"><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{\mathcal{N}}}}(\mathbf{x}| \mathbf{\mu} ,I\mathbf{{\sigma }^{2}})$$\end{document}</tex-math><mml:math id="M16"><mml:mrow><mml:mi class="MJX-tex-caligraphic" mathvariant="script">N</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="bold">x</mml:mi><mml:mo>∣</mml:mo><mml:mi mathvariant="bold">μ</mml:mi><mml:mo>,</mml:mo><mml:mi>I</mml:mi><mml:msup><mml:mrow><mml:mi mathvariant="bold">σ</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="41587_2023_1773_Article_IEq7.gif"/></alternatives></inline-formula> (with diagonal covariance).</p>
      <p id="Par33">We trained the VQ-VAE on the loss function defined in Equation (3) in ref. <sup><xref ref-type="bibr" rid="CR28">28</xref></sup> (with commitment loss = 0.25) using the deep learning framework PyTorch (version 1.9.0), the Adam optimizer, with a batch size of 512, and a learning rate of 10<sup>−3</sup> over four epochs. Using Kerasify (<ext-link ext-link-type="uri" xlink:href="https://github.com/moof2k/kerasify">https://github.com/moof2k/kerasify</ext-link>), we integrated the encoder network into Foldseek. The domains from SCOPe40 were split 80%/20% by fold into training and validation sets. For the training, we aligned the structures with TM-align, removed all alignments with a TM-score below 0.6 and removed all aligned residue pairs with a distance between their C<sub><italic>α</italic></sub> atoms of more than 5 Å. We trained the VQ-VAE with 100 different initial parameters and chose the model that was performing best in the benchmark on the validation dataset (the highest sum of ratios between 3Di AUC and TM-align AUC for family, superfamily and fold level).</p>
    </sec>
    <sec id="Sec14">
      <title>3Di substitution score matrix</title>
      <p id="Par34">We trained a BLOSUM-like substitution matrix for 3Di sequences from pairs of structurally aligned residues used for the ‘VQ-VAE training’. First, we determined the 3Di states of all residues. Next, the substitution frequencies among 3Di states were calculated by counting how often two 3Di states were structurally aligned. (Note that the substitution frequencies from state A to state B and the opposite direction are equal.) Finally, the score <inline-formula id="IEq8"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\,{{\mbox{S}}}\,(x,y)=2\,{\log }_{2}\frac{p(x,y)}{p(x)\,p(y)}$$\end{document}</tex-math><mml:math id="M18"><mml:mrow><mml:mspace width="0.25em"/><mml:mstyle><mml:mtext>S</mml:mtext></mml:mstyle><mml:mspace width="0.25em"/><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:mspace width="0.25em"/><mml:msub><mml:mrow><mml:mi>log</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mfrac><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mspace width="0.25em"/><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mrow></mml:math><inline-graphic xlink:href="41587_2023_1773_Article_IEq8.gif"/></alternatives></inline-formula> for substituting state x through state y is the log-ratio between the substitution frequency <italic>p</italic>(<italic>x</italic>, <italic>y</italic>) and the probability that the two states occur independently, scaled by the factor 2.</p>
    </sec>
    <sec id="Sec15">
      <title>3Di alphabet cross-validation</title>
      <p id="Par35">We trained the 3Di alphabet (the VQ-VAE weights) and the substitution matrix by four-fold cross-validation on SCOPe40. We split the SCOPe40 dataset into four parts, such that all domains of each fold ended up in the same part of the four parts. 3Di alphabets were trained on three parts and tested on the remaining part, selecting each of the four parts in turn as a test set. The 80:20 split between training and validation sets to select the best alphabet out of the 100 VQ-VAE runs happens within the 3/4 of the cross-validation training data. Supplementary Fig. <xref rid="MOESM1" ref-type="media">14</xref> shows the mean sensitivity (black) and the standard deviation (gray area) in comparison to the final 3Di alphabet, for which we trained the 3Di alphabet on the entire SCOPe40 (red). No overfitting was observed, despite training 492 parameters (282 neural network and 210 substitution matrix entries). In Fig. <xref rid="Fig2" ref-type="fig">2</xref>, we, therefore, show the benchmark results for the final 3Di alphabet, trained on the entire SCOPe40.</p>
    </sec>
    <sec id="Sec16">
      <title>Nearest-neighbor selection</title>
      <p id="Par36">To select nearest-neighbor residues that maximize the performance of the resulting 3Di alphabet in finding and aligning homologous structures, we introduced the virtual center <italic>V</italic> of a residue. The virtual center position is defined by the angle <italic>θ</italic> (<italic>V</italic>-C<sub><italic>α</italic></sub>-C<sub><italic>β</italic></sub>), the dihedral angle <italic>τ</italic> (<italic>V</italic>-C<sub><italic>α</italic></sub>-C<sub><italic>β</italic></sub>-N) and the length <italic>l</italic> (∣<italic>V</italic> − C<sub><italic>α</italic></sub>∣) (Supplementary Fig. <xref rid="MOESM1" ref-type="media">1)</xref>. For each residue <italic>i</italic>, we selected the residue <italic>j</italic> with the smallest distance between their virtual centers. The virtual center was optimized on the training and validation structure sets used for the VQ-VAE training by creating alphabets for positions with <italic>θ</italic> ∈ [0, 2<italic>π</italic>], <italic>τ</italic> ∈ [ − <italic>π</italic>, <italic>π</italic>] in 45<sup>∘</sup> steps and <italic>l</italic> ∈ {1.53 Å <italic>k</italic>: <italic>k</italic> ∈ {1, 1.5, 2, 2.5, 3}} (1.53 Å is the distance between C<sub><italic>α</italic></sub> and C<sub><italic>β</italic></sub>). The virtual center defined by <italic>θ</italic> = 270<sup>∘</sup>, <italic>τ</italic> = 0<sup>∘</sup> and <italic>l</italic> = 2 performed best in the SCOPe benchmark.</p>
      <p id="Par37">This virtual center preferably selects long-range, tertiary interactions and only falls back to selecting interactions to <italic>i</italic> + 1 or <italic>i</italic> − 1 when no other residues are nearby. In that case, the interaction captures only the backbone conformation.</p>
    </sec>
    <sec id="Sec17">
      <title>SCOPe benchmark</title>
      <p id="Par38">We downloaded the SCOPe40 structures (available at <ext-link ext-link-type="uri" xlink:href="https://wwwuser.gwdg.de/~compbiol/foldseek/scop40pdb.tar.gz">https://wwwuser.gwdg.de/~compbiol/foldseek/scop40pdb.tar.gz</ext-link>).</p>
      <p id="Par39">The SCOPe benchmark set consists of single domains with an average length of 174 residues. In our benchmark, we compare the domains all-versus-all. Per domain, we measured the fraction of detected TPs up to the first FP. For family-level, superfamily-level and fold-level recognition, TPs were defined as same family, same superfamily and not same family and same fold and not same superfamily, respectively. Hits from different folds are FPs.</p>
    </sec>
    <sec id="Sec18">
      <title>Evaluation SCOPe benchmark</title>
      <p id="Par40">After sorting the alignment result of each query (described in the ‘Tools and options for benchmark comparison’ subsection), we calculated the sensitivity as the fraction of TPs in the sorted list up to the first FP, all excluding self-hits. For comparison, we took the mean sensitivity over all queries for family-level, superfamily-level and fold-level classifications. We evaluated only SCOPe members with at least one other family, superfamily and fold member. We measure the sensitivity up to the 1st FP (ROC1) instead, for example, up to the 5th FP, because ROC1 better reflects the requirements for low false discovery rates in automatic searches.</p>
      <p id="Par41">Additionally, we plotted precision-recall curves for each tool (Fig. <xref rid="Fig2" ref-type="fig">2b</xref> and Supplementary Fig. <xref rid="MOESM1" ref-type="media">4)</xref>. After sorting the alignment results by the structural similarity scores (as described in the ‘Tools and options for benchmark comparison’ subsection) and excluding self-matches, we generated a weighted precision-recall curve for family-level, superfamily-level and fold-level classifications (precision = TP / (TP + FP) and recall = TP / (TP + FN)). All counts (TP, FP and FN) were weighted by the reciprocal of their family, superfamily or fold size. In this way, folds, superfamilies and families contribute linearly with their size instead of quadratically<sup><xref ref-type="bibr" rid="CR36">36</xref></sup>.</p>
    </sec>
    <sec id="Sec19">
      <title>Runtime evaluations on SCOPe and AlphaFoldDB</title>
      <p id="Par42">We measured the speed of structural aligners on a server with an AMD EPYC 7702P 64-core CPU and 1,024 GB RAM memory. On SCOPe40, we measured or estimated the runtime for an all-versus-all comparison. To avoid excessive runtimes for TM-align, Dali and CE, we estimated the runtime by randomly selecting 10% of the 11,211 SCOPe domains as queries. We measured runtimes on AlphaFoldDB for searches with the same 100 randomly selected queries used for the sensitivity and alignment quality benchmarks (Fig. <xref rid="Fig2" ref-type="fig">2d,e</xref>). Tools with multi-threading support (MMseqs2 and Foldseek) were executed with 64 threads; tools without were parallelized by breaking the query set into 64 equally sized chunks and executing them in parallel.</p>
    </sec>
    <sec id="Sec20">
      <title>Reference-free multi-domain benchmarks</title>
      <p id="Par43">We devised two reference-free benchmarks that do not rely on any reference structural alignments. We clustered the AlphaFoldDB (version 1)<sup><xref ref-type="bibr" rid="CR3">3</xref></sup> using SPICi<sup><xref ref-type="bibr" rid="CR22">22</xref></sup>. For this, we first aligned all protein sequences all against all using an <italic>E</italic> value threshold &lt;10<sup>−3</sup> using BLAST (2.5.0+)<sup><xref ref-type="bibr" rid="CR5">5</xref></sup>. SPICi produced 34,270 clusters from the search result. For each cluster, we picked the longest protein as representative. We randomly selected 100 representatives as queries and searched the set of remaining structures. The top five alignments of all queries are listed at <ext-link ext-link-type="uri" xlink:href="https://wwwuser.gwdg.de/~compbiol/foldseek/multi_domain_top5_alignments/">https://wwwuser.gwdg.de/~compbiol/foldseek/multi_domain_top5_alignments/</ext-link>.</p>
      <p id="Par44">For the evaluation, we needed to adjust the LDDT score function taken from AlphaFold2 (ref. <sup><xref ref-type="bibr" rid="CR1">1</xref></sup>). LDDT calculates for each residue <italic>i</italic> in the query the fraction of residues in the 15 Å neighborhood that have a distance within 0.5, 1, 2 or 4 Å of the distance between the corresponding residues in the target<sup><xref ref-type="bibr" rid="CR23">23</xref></sup>. The denominator of the fraction is the number of 15 Å neighbors of <italic>i</italic> that are aligned to some residue in the target. This does not properly penalize non-compact models in which each residue has few neighbors within 15 Å. We, therefore, use as denominator the <italic>total</italic> number of neighboring residues within 15 Å of <italic>i</italic>.</p>
      <p id="Par45">For the alignment quality benchmark (Fig. <xref rid="Fig2" ref-type="fig">2e</xref>), we classified each aligned residue pair as TP or FP depending on its residue-wise LDDT score—that is, the fraction of distances to its 15 Å neighbors that are within 0.5, 1, 2 and 4 Å of the distance to the corresponding residues in the query, averaged over the four distance thresholds. TP residues are those with a residue-wise LDDT score of at least 0.6 and FPs below 0.25, ignoring matches in between. For the search sensitivity benchmark (Fig. <xref rid="Fig2" ref-type="fig">2d</xref>), TP residue–residue matches are those with an LDDT score of the query-target alignment of at least 0.6 and FPs below 0.25, ignoring matches in between. (The LDDT score of the query-target alignment is the average of the residue-wise LDDT score over all aligned residue pairs.) The choice of thresholds is illustrated in Supplementary Fig. <xref rid="MOESM1" ref-type="media">6</xref>. The benchmark for other thresholds is shown in Supplementary Fig. <xref rid="MOESM1" ref-type="media">7</xref>.</p>
    </sec>
    <sec id="Sec21">
      <title>All-versus-all search of AlphaFoldDB with Foldseek</title>
      <p id="Par46">We downloaded the AlphaFoldDB (version 1)<sup><xref ref-type="bibr" rid="CR3">3</xref></sup> containing 365,198 protein models and searched it all-versus-all using Foldseek -s 9.5 –max-seqs 2000. For our second-best hit analysis, we consider only models with (1) an average C<sub><italic>α</italic></sub>ʼs predicted LDDT (pLDDT) greater than or equal to 80 and (2) models of non-fragmented domains. We also computed the structural similarity for each pair using TM-align (default options).</p>
    </sec>
    <sec id="Sec22">
      <title>Tools and options for benchmark comparison</title>
      <p id="Par47">Owing to dataset overlap, we excluded methods from the benchmark that are likely to be overfitted on SCOPe. This applies to methods that trained many thousands of parameters (for example, deep neural networks) with strong data leakage among training, validation and test sets. For example, several tools allowed up to 40% sequence identity between sets. The following command lines were used in the SCOPe as well as the multi-domain benchmark:</p>
    </sec>
    <sec id="Sec23">
      <title>Foldseek</title>
      <p id="Par48">We used Foldseek commit aeb5e during this analysis. Foldseek was run with the following parameters: --threads 64 -s 9.5 -e 10 --max-seqs 2000.</p>
    </sec>
    <sec id="Sec24">
      <title>Foldseek-TM</title>
      <p id="Par49">For the Foldseek-TM benchmark, we first run a regular 3Di/AA-based Foldseek search using the following parameters: --threads 64 -s 9.5 -e 10 --max-seqs 4000 --alignment-mode 1. All hits passing are then aligned by Foldseeks’s tmalign --tmalign-fast 1 --tmscore-threshold 0.0 -a. We used Foldseek commit aeb5e during this analysis. We expose Foldseek-TM in our command-line interface as a search mode that combines regular Foldseek 3Di/AA-based workflow with our TM-align implementation within the tmalign module.</p>
    </sec>
    <sec id="Sec25">
      <title>MMseqs2</title>
      <p id="Par50">We used the default MMseqs2 (release 13-45111) search algorithm to obtain the sequence-based alignment result. MMseqs2 sorts the results by <italic>E</italic> value and score. We searched with: --threads 64 -s 7.5 -e 10000 --max-seqs 2000.</p>
    </sec>
    <sec id="Sec26">
      <title>CLE-Smith–Waterman</title>
      <p id="Par51">We used PDB Tool version 4.80 (<ext-link ext-link-type="uri" xlink:href="https://github.com/realbigws/PDB_Tool">https://github.com/realbigws/PDB_Tool</ext-link>) to convert the benchmark structure set to CLE sequences. After the conversion, we used SSW<sup><xref ref-type="bibr" rid="CR35">35</xref></sup> (commit ad452e) to align CLE sequences all-versus-all. We sorted the results by alignment score. The following parameters were used to run SSW: (1) protein alignment mode (-p); (2) gap open penalty of 100 (-o 100); (3) gap extend penalty of 10 (-e 10); (4) CLE’s optimized substitution matrix (-a cle.shen.mat); and (5) returning alignment (-c). The gap open and extend values were inferred from DeepAlign<sup><xref ref-type="bibr" rid="CR41">41</xref></sup>. The results are sorted by score in descending order.</p>
      <p id="Par52">
        <code>ssw_test -p -o 100 -e 10 -a cle.shen.mat -c</code>
      </p>
    </sec>
    <sec id="Sec27">
      <title>3D-BLAST</title>
      <p id="Par53">We used 3D-BLAST (beta102) with BLAST+ (2.2.26) and SSW<sup><xref ref-type="bibr" rid="CR34">34</xref></sup> (version ad452e). We first converted the PDB structures to a 3D-BLAST database using 3d-blast -sq_write and 3d-blast -sq_append. We searched the structural sequences against the database using blastp with the following parameters: (1) 3D-BLAST’s optimized substitution matrix (-M 3DBLAST); (2) number of hits and alignments shown of 12,000 (-v 12000 -b 12000); (3) <italic>E</italic> value threshold of 1,000 (-e 1000); (4) disabling query sequence filter (-F F); (5) gap open of 8 (-G 8); and (6) gap extend of 2 (-E 2). 3D-BLAST’s results are sorted by <italic>E</italic> value in ascending order:</p>
      <p id="Par54">
        <code>blastall -p blastp -M 3DBLAST -v 12000 -b 12000 -e 1000 -F F -G 8 -E 2</code>
      </p>
      <p id="Par55">For Smith–Waterman, we used (1) gap open of 8; (2) gap extend of 2; (3) returning alignments (-c); (4) 3D-BLAST’s optimized substitution matrix (-a 3DBLAST); and (5) protein alignment mode (-p): ssw_test -o 8 -e 2 -c -a 3DBLAST -p. We noticed that the 3D-BLAST matrix with Smith–Waterman resulted in a similar performance to CLE: 0.717, 0.230 and 0.011 for family classification, superfamily classification and fold classification, respectively. We excluded 3D-BLAST’s measurement from the multi-domain benchmark because it produced occasionally high scores (&gt;10<sup>7</sup>) for single residue alignments.</p>
    </sec>
    <sec id="Sec28">
      <title>TM-align</title>
      <p id="Par56">We downloaded and compiled the TMalign.cpp source code (version 2019/08/22) from the Zhang group website. We ran the benchmark using default parameters and -fast for the fast version. TM-align reports two TM-scores: (1) normalized by the length of 1st chain (query) or (2) normalized by the length of the 2nd chain (target). We used the average of TM-scores normalized by the 1st chain (query) and 2nd chain (target) in all our analyses. We evaluated TM-align’s performance by sorting the results based on both the query TM-score and the minimum, maximum and average TM-score for both the query and target. Our results showed that the average TM-score performed the best in our single-domain benchmark.</p>
      <p id="Par57">Default: TMalign query.pdb target.pdb</p>
      <p id="Par58">Fast: TMalign query.pdb target.pdb -fast</p>
    </sec>
    <sec id="Sec29">
      <title>Dali</title>
      <p id="Par59">We installed the standalone DaliLite.v5. For the SCOPe40 benchmark set, input files were formatted in DAT files with Dali’s import.pl. The conversion to DAT format produced 11,137 valid structures out of the 11,211 initial structures for the SCOPe benchmark and 34,252 structures out of 34,270 SPICi clusters. After formatting the input files, we calculated the protein alignment with Dali’s structural alignment algorithm. The results were sorted by Dali’s <italic>z</italic>-score in descending order:</p>
      <p id="Par60">
        <code>import.pl –pdbfile query.pdb –pdbid PDBid –dat DATdali.pl –cd1 queryDATid –db targetDB.list –TITLE systematic –dat1 DAT –dat2 DAT –outfmt "summary" –clean</code>
      </p>
    </sec>
    <sec id="Sec30">
      <title>CE</title>
      <p id="Par61">We used BioJava’s<sup><xref ref-type="bibr" rid="CR42">42</xref></sup> (version 5.4.0) implementation of the combinatorial extension (CE) alignment algorithm. We modified one of the modules of BioJava under shape configuration to calculate the CE value. Our modified CEalign.jar file requires a list of query files, path to the target PDB files and an output path as input parameters. This Java module runs an all-versus-all CE calculation with unlimited gap size (maxGapSize -1) to improve alignment results<sup><xref ref-type="bibr" rid="CR14">14</xref></sup>. The results were sorted by <italic>z</italic>-score in descending order. For the multi-domain benchmark, we excluded one query that was running over 16 d. The Jar file of our implementation of CE calculation is provided (see ‘Code availability’).</p>
      <p id="Par62">
        <code>java -jar CEalign.jar querylist.txt TargetPDBDirectory OutputDirectory</code>
      </p>
    </sec>
    <sec id="Sec31">
      <title>Geometricus</title>
      <p id="Par63">We included Geometricus<sup><xref ref-type="bibr" rid="CR20">20</xref></sup> in the SCOPe benchmark as a representative of alignment-free tools, which are fast but can find only globally similar structures. Geometricus discretizes fixed-length backbone fragments (shape-mers) using their 3D moment invariants and represents structures as a fixed-length count vector over the shape-mers. To calculate the shape-mer-based structural similarity of the benchmark set, we used Caretta-shape’s Python implementation (1e3adb0) of multiple structure alignment (<ext-link ext-link-type="uri" xlink:href="https://github.com/TurtleTools/caretta/caretta/multiple_alignment.py">https://github.com/TurtleTools/caretta/caretta/multiple_alignment.py</ext-link>), which computes the Bray–Curtis similarity between the Geometricus shape-mer vectors. Our modified version extracts structural information from the input files and generates all-versus-all pairwise structural similarity score as an output. We ran Geometricus on a single core because it would require substantial engineering efforts to implement parallelization on multiple cores. With an efficient multi-core implementation, Geometricus might be as fast as MMseqs2 on 64 cores. The Python code of our implementation of Geometricus is provided:</p>
      <p id="Par64">
        <code>python runGeometricus_caretta.py -i querylist.txt -o OutputDirectory</code>
      </p>
    </sec>
    <sec id="Sec32">
      <title>HOMSTRAD alignment benchmark</title>
      <p id="Par65">The HOMSTRAD database contains expert-curated homologous structural alignments for 1,032 protein families<sup><xref ref-type="bibr" rid="CR24">24</xref></sup>. We downloaded the latest HOMSTRAD version (<ext-link ext-link-type="uri" xlink:href="https://mizuguchilab.org/homstrad/data/homstrad_with_PDB_2022_Aug_1.tar.gz">https://mizuguchilab.org/homstrad/data/homstrad_with_PDB_2022_Aug_1.tar.gz</ext-link>) and picked the pairwise alignments between the first and last members of each family, which resulted in structures of a median length of 182 residues. We used the same parameters as in the SCOPe and multi-domain benchmark. We forced Foldseek, MMseqs2 and CLE-Smith–Waterman to return an alignment by switching off the prefilter and <italic>E</italic> value threshold. With the HOMSTRAD alignments as reference, we measured for each pairwise alignment the sensitivity (fraction of residue pairs of the HOMSTRAD alignment that were correctly aligned) and the precision (fraction of correctly aligned residue pairs in the predicted alignment). Dali, CE and CLE-Smith–Waterman failed to produce an alignment for 35, 1 and 1 out of 1,032 pairs, respectively, which were rated with a sensitivity of 0. The mean sensitivity and precision are shown in Fig. <xref rid="Fig2" ref-type="fig">2e</xref>, and all individual alignments are listed in homstrad_alignments.txt at <ext-link ext-link-type="uri" xlink:href="https://wwwuser.gwdg.de/~compbiol/foldseek/">https://wwwuser.gwdg.de/~compbiol/foldseek/</ext-link>.</p>
    </sec>
    <sec id="Sec33">
      <title>Limitations of benchmarks</title>
      <p id="Par66">The SCOPe benchmark to measure search sensitivity uses only single-domain proteins as queries and targets (Fig. <xref rid="Fig2" ref-type="fig">2a–c</xref>). It, therefore, cannot assess the ability of tools to find local similarities—for example, finding homologous domains shared between two multi-domain proteins. The alignment benchmark based on HOMSTRAD (Fig. <xref rid="Fig2" ref-type="fig">2e</xref>) has the same limitation, as the vast majority of proteins in HOMSTRAD have a single domain (median length = 182 residues). A drawback of our reference-free multi-domain benchmark is the need to choose thresholds for TPs and FPs (Supplementary Fig. <xref rid="MOESM1" ref-type="media">6</xref>).</p>
    </sec>
    <sec id="Sec34">
      <title>Pre-built and ready-to-download databases</title>
      <p id="Par67">Foldseek includes the databases module to aid users with the download and setup of structural databases. Currently, we include the four variants of the AlphaFoldDB (version 4): UniProt (214 million structures), UniProt50, a clustered database to 50% sequence identity and 90% bi-directional coverage using MMseqs2 (parameters -c 0.9 --min-seq-id 0.5 --cluster-reassign; 54 million structures), Proteome (564,000 structures) and Swiss-Prot (542,000 structures). Additionally, we regularly build and offer a 100% sequence identity clustered PDB. The update pipeline is available in the util/update_webserver_pdb folder in the main Foldseek repository. These databases are hosted on Cloudflare R2 for fast downloading. We additionally link to and provide an automatic setup procedure for the ESM Atlas High-Quality Clu30<sup><xref ref-type="bibr" rid="CR4">4</xref></sup> database.</p>
    </sec>
    <sec id="Sec35">
      <title>Webserver</title>
      <p id="Par68">The Foldseek webserver is based on the MMseqs2 webserver<sup><xref ref-type="bibr" rid="CR43">43</xref></sup>. To allow for searches in seconds, we implemented MMseqs2ʼs pre-computed database indexing capabilities in Foldseek. Using these, the search databases can be fully cached in system memory by the operating system and instantly accessed by each Foldseek process, thus avoiding expensive accesses to slow disk drives. A similar mechanism was used to store and read the associated taxonomic information. The AlpaFoldDB/UniProt50 (version 4), AlphaFoldDB/Proteome (version 4), AlphaFoldDB/Swiss-Prot (version 4), CATH50, ESM Atlas High-Quality Clu30 and PDB100 require 191 GB, 3.8 GB, 3.4 GB, 1.4 GB, 110 GB and 2.0 GB RAM, respectively. The databases are kept in memory using vmtouch (<ext-link ext-link-type="uri" xlink:href="https://github.com/hoytech/vmtouch">https://github.com/hoytech/vmtouch</ext-link>). Databases are only required to remain resident in RAM if Foldseek is used as a webserver. During batch searches, Foldseek adapts its memory use to the available RAM of the machine. We implemented a structural visualization using the NGL viewer<sup><xref ref-type="bibr" rid="CR44">44</xref></sup> to aid the investigation of pairwise hits. Because we only store C<sub><italic>α</italic></sub> traces of the database proteins, we use PULCHRA<sup><xref ref-type="bibr" rid="CR30">30</xref></sup> to complete the backbone of these sequences, and also of the query if necessary, to enable a ribbon visualization<sup><xref ref-type="bibr" rid="CR45">45</xref></sup> of the proteins. For a high-quality superposition, we use TM-align<sup><xref ref-type="bibr" rid="CR11">11</xref></sup> to superpose the structures based on the Foldseek alignment. Both PULCHRA and TM-align are executed within the users’ browser using WebAssembly. They are available as pulchra-wasm and tmalign-wasm on the npm package repository as free open-source software.</p>
    </sec>
    <sec id="Sec36">
      <title>Structure prediction in the webserver</title>
      <p id="Par69">We use the ESM Atlas API to predict structures of user-supplied sequences that are, at most, 400 residues long. This enables sequence-to-structure searches in the webserver.</p>
    </sec>
    <sec id="Sec37">
      <title>Reporting summary</title>
      <p id="Par70">Further information on research design is available in the <xref rid="MOESM2" ref-type="media">Nature Portfolio Reporting Summary</xref> linked to this article.</p>
    </sec>
  </sec>
  <sec id="Sec38" sec-type="materials|methods">
    <title>Online content</title>
    <p id="Par71">Any methods, additional references, Nature Portfolio reporting summaries, source data, extended data, supplementary information, acknowledgements, peer review information; details of author contributions and competing interests; and statements of data and code availability are available at 10.1038/s41587-023-01773-0.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <sec id="Sec39">
      <title>Supplementary information</title>
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="41587_2023_1773_MOESM1_ESM.pdf">
            <label>Supplementary Information</label>
            <caption>
              <p>Supplementary Tables 1–4 and Supplementary Figs. 1–14.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM2">
          <media xlink:href="41587_2023_1773_MOESM2_ESM.pdf">
            <caption>
              <p>Reporting Summary</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <fn-group>
    <fn>
      <p><bold>Publisher’s note</bold> Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
    <fn>
      <p>These authors contributed equally: Michel van Kempen, Stephanie S. Kim.</p>
    </fn>
  </fn-group>
  <sec>
    <title>Supplementary information</title>
    <p>The online version contains supplementary material available at 10.1038/s41587-023-01773-0.</p>
  </sec>
  <ack>
    <title>Acknowledgements</title>
    <p>We thank N. Bordin, I. Sillitoe and C. Orengo for reporting issues and providing valuable feedback; Y. Zhang, P. Rotkiewicz and M. Wojdyr for making TM-align, PULCHRA and the Gemmi library freely accessible; and D.-Y. Kim for creating the Foldseek logo.</p>
    <p>M.S. acknowledges support from the National Research Foundation of Korea (NRF) (grants 2019R1A6A1A10073437, 2020M3A9G7103933, 2021R1C1C102065 and 2021M3A9I4021220), the Samsung DS Research Fund and the Creative-Pioneering Researchers Program through Seoul National University. S.K. acknowledges support by NRF grant 2019R1A6A1A10073437. J.S. acknowledges support by the German Ministry for Education and Research (horizontal4meta). We used the compute cluster at the Gesellschaft für wissenschaftliche Datenverarbeitung mbH Göttingen (GWDG).</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Author contributions</title>
    <p>M.K., S.K., J.S. and M.S. designed the research. M.K., S.K., C.T., M.M. and M.S. developed code and performed analyses. M.K. and J.S. developed the 3Di alphabet. J.L. implemented the fast LDDT code. M.M. and C.L.M.G. developed the webserver. M.K., S.K., C.T., M.M., J.S. and M.S. wrote the manuscript.</p>
  </notes>
  <notes notes-type="peer-review">
    <title>Peer review</title>
    <sec id="FPar1">
      <title>Peer review information</title>
      <p id="Par72"><italic>Nature Biotechnology</italic> thanks the anonymous reviewers for their contribution to the peer review of this work.</p>
    </sec>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>Open access funding provided by Max Planck Society.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Data availability</title>
    <p>Benchmark data are available at <ext-link ext-link-type="uri" xlink:href="https://wwwuser.gwdg.de/~compbiol/foldseek">https://wwwuser.gwdg.de/~compbiol/foldseek</ext-link>.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Code availability</title>
    <p>Foldseek is GPLv3-licensed free open-source software. The source code and binaries for Foldseek can be downloaded at <ext-link ext-link-type="uri" xlink:href="https://github.com/steineggerlab/foldseek">https://github.com/steineggerlab/foldseek</ext-link>. The webserver code is available at <ext-link ext-link-type="uri" xlink:href="https://github.com/soedinglab/mmseqs2-app">https://github.com/soedinglab/mmseqs2-app</ext-link>. The analysis scripts are available at <ext-link ext-link-type="uri" xlink:href="https://github.com/steineggerlab/foldseek-analysis">https://github.com/steineggerlab/foldseek-analysis</ext-link>.</p>
  </notes>
  <notes id="FPar2" notes-type="COI-statement">
    <title>Competing interests</title>
    <p id="Par73">The authors declare no competing interests.</p>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jumper</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Highly accurate protein structure prediction with AlphaFold</article-title>
        <source>Nature</source>
        <year>2021</year>
        <volume>596</volume>
        <fpage>583</fpage>
        <lpage>589</lpage>
        <?supplied-pmid 34265844?>
        <pub-id pub-id-type="pmid">34265844</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Baek</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Accurate prediction of protein structures and interactions using a three-track neural network</article-title>
        <source>Science</source>
        <year>2021</year>
        <volume>373</volume>
        <fpage>871</fpage>
        <lpage>876</lpage>
        <?supplied-pmid 34282049?>
        <pub-id pub-id-type="pmid">34282049</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Varadi</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>AlphaFold Protein Structure Database: massively expanding the structural coverage of protein–sequence space with high-accuracy models</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2022</year>
        <volume>50</volume>
        <fpage>D439</fpage>
        <lpage>D444</lpage>
        <?supplied-pmid 34791371?>
        <pub-id pub-id-type="pmid">34791371</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lin</surname>
            <given-names>Z</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Evolutionary-scale prediction of atomic-level protein structure with a language model</article-title>
        <source>Science</source>
        <year>2023</year>
        <volume>379</volume>
        <fpage>1123</fpage>
        <lpage>1130</lpage>
        <?supplied-pmid 36927031?>
        <pub-id pub-id-type="pmid">36927031</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Altschul</surname>
            <given-names>SF</given-names>
          </name>
          <name>
            <surname>Gish</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Miller</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Myers</surname>
            <given-names>EW</given-names>
          </name>
          <name>
            <surname>Lipman</surname>
            <given-names>DJ</given-names>
          </name>
        </person-group>
        <article-title>Basic local alignment search tool</article-title>
        <source>J. Mol. Biol.</source>
        <year>1990</year>
        <volume>215</volume>
        <fpage>403</fpage>
        <lpage>410</lpage>
        <?supplied-pmid 2231712?>
        <pub-id pub-id-type="pmid">2231712</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Steinegger</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Söding</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>MMseqs2 enables sensitive protein sequence searching for the analysis of massive data sets</article-title>
        <source>Nat. Biotechnol.</source>
        <year>2017</year>
        <volume>35</volume>
        <fpage>1026</fpage>
        <lpage>1028</lpage>
        <?supplied-pmid 29035372?>
        <pub-id pub-id-type="pmid">29035372</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Steinegger</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>HH-suite3 for fast remote homology detection and deep protein annotation</article-title>
        <source>BMC Bioinformatics</source>
        <year>2019</year>
        <volume>20</volume>
        <fpage>473</fpage>
        <?supplied-pmid 31521110?>
        <pub-id pub-id-type="pmid">31521110</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Buchfink</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Reuter</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Drost</surname>
            <given-names>H-G</given-names>
          </name>
        </person-group>
        <article-title>Sensitive protein alignments at tree-of-life scale using DIAMOND</article-title>
        <source>Nat. Methods</source>
        <year>2021</year>
        <volume>18</volume>
        <fpage>366</fpage>
        <lpage>368</lpage>
        <?supplied-pmid 33828273?>
        <pub-id pub-id-type="pmid">33828273</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mahlich</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Steinegger</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Rost</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Bromberg</surname>
            <given-names>Y</given-names>
          </name>
        </person-group>
        <article-title>HFSP: high speed homology-driven function annotation of proteins</article-title>
        <source>Bioinformatics</source>
        <year>2018</year>
        <volume>34</volume>
        <fpage>i304</fpage>
        <lpage>i312</lpage>
        <?supplied-pmid 29950013?>
        <pub-id pub-id-type="pmid">29950013</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Illergård</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Ardell</surname>
            <given-names>DH</given-names>
          </name>
          <name>
            <surname>Elofsson</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Structure is three to ten times more conserved than sequence—a study of structural response in protein cores</article-title>
        <source>Proteins</source>
        <year>2009</year>
        <volume>77</volume>
        <fpage>499</fpage>
        <lpage>508</lpage>
        <?supplied-pmid 19507241?>
        <pub-id pub-id-type="pmid">19507241</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhang</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Skolnick</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>TM-align: a protein structure alignment algorithm based on the TM-score</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2005</year>
        <volume>33</volume>
        <fpage>2302</fpage>
        <lpage>2309</lpage>
        <?supplied-pmid 15849316?>
        <pub-id pub-id-type="pmid">15849316</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hasegawa</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Holm</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <article-title>Advances and pitfalls of protein structural alignment</article-title>
        <source>Curr. Opin. Struct. Biol.</source>
        <year>2009</year>
        <volume>19</volume>
        <fpage>341</fpage>
        <lpage>348</lpage>
        <?supplied-pmid 19481444?>
        <pub-id pub-id-type="pmid">19481444</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Holm</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <article-title>Using Dali for protein structure comparison</article-title>
        <source>Methods Mol. Biol.</source>
        <year>2020</year>
        <volume>2112</volume>
        <fpage>29</fpage>
        <lpage>42</lpage>
        <?supplied-pmid 32006276?>
        <pub-id pub-id-type="pmid">32006276</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Shindyalov</surname>
            <given-names>IN</given-names>
          </name>
          <name>
            <surname>Bourne</surname>
            <given-names>PE</given-names>
          </name>
        </person-group>
        <article-title>Protein structure alignment by incremental combinatorial extension (CE) of the optimal path</article-title>
        <source>Protein Eng.</source>
        <year>1998</year>
        <volume>11</volume>
        <fpage>739</fpage>
        <lpage>747</lpage>
        <?supplied-pmid 9796821?>
        <pub-id pub-id-type="pmid">9796821</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Guyon</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Camproux</surname>
            <given-names>A-C</given-names>
          </name>
          <name>
            <surname>Hochez</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Tuffery</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>SA-Search: a web tool for protein structure mining based on a structural alphabet</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2004</year>
        <volume>32</volume>
        <fpage>W545</fpage>
        <lpage>W548</lpage>
        <?supplied-pmid 15215446?>
        <pub-id pub-id-type="pmid">15215446</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ma</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Algorithms, applications, and challenges of protein structure alignment</article-title>
        <source>Adv. Protein Chem. Struct. Biol.</source>
        <year>2014</year>
        <volume>94</volume>
        <fpage>121</fpage>
        <lpage>175</lpage>
        <?supplied-pmid 24629187?>
        <pub-id pub-id-type="pmid">24629187</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Zheng</surname>
            <given-names>W-M</given-names>
          </name>
        </person-group>
        <article-title>CLePAPS: fast pair alignment of protein structures based on conformational letters</article-title>
        <source>J. Bioinform. Comput. Biol.</source>
        <year>2008</year>
        <volume>6</volume>
        <fpage>347</fpage>
        <lpage>366</lpage>
        <?supplied-pmid 18464327?>
        <pub-id pub-id-type="pmid">18464327</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yang</surname>
            <given-names>J-M</given-names>
          </name>
          <name>
            <surname>Tung</surname>
            <given-names>C-H</given-names>
          </name>
        </person-group>
        <article-title>Protein structure database search and evolutionary classification</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2006</year>
        <volume>34</volume>
        <fpage>3646</fpage>
        <lpage>3659</lpage>
        <?supplied-pmid 16885238?>
        <pub-id pub-id-type="pmid">16885238</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>de Brevern</surname>
            <given-names>AG</given-names>
          </name>
          <name>
            <surname>Etchebest</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Hazout</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Bayesian probabilistic approach for predicting backbone structures in terms of protein blocks</article-title>
        <source>Proteins</source>
        <year>2000</year>
        <volume>41</volume>
        <fpage>271</fpage>
        <lpage>287</lpage>
        <?supplied-pmid 11025540?>
        <pub-id pub-id-type="pmid">11025540</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Durairaj</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Akdel</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>de Ridder</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>van Dijk</surname>
            <given-names>ADJ</given-names>
          </name>
        </person-group>
        <article-title>Geometricus represents protein structures as shape-mers derived from moment invariants</article-title>
        <source>Bioinformatics</source>
        <year>2020</year>
        <volume>36</volume>
        <fpage>i718</fpage>
        <lpage>i725</lpage>
        <?supplied-pmid 33381814?>
        <pub-id pub-id-type="pmid">33381814</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chandonia</surname>
            <given-names>J-M</given-names>
          </name>
          <name>
            <surname>Fox</surname>
            <given-names>NK</given-names>
          </name>
          <name>
            <surname>Brenner</surname>
            <given-names>SE</given-names>
          </name>
        </person-group>
        <article-title>SCOPe: classification of large macromolecular structures in the structural classification of proteins—extended database</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2019</year>
        <volume>47</volume>
        <fpage>D475</fpage>
        <lpage>D481</lpage>
        <?supplied-pmid 30500919?>
        <pub-id pub-id-type="pmid">30500919</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jiang</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Singh</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>SPICi: a fast clustering algorithm for large biological networks</article-title>
        <source>Bioinformatics</source>
        <year>2010</year>
        <volume>26</volume>
        <fpage>1105</fpage>
        <lpage>1111</lpage>
        <?supplied-pmid 20185405?>
        <pub-id pub-id-type="pmid">20185405</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mariani</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Biasini</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Barbato</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Schwede</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>lDDT: a local superposition-free score for comparing protein structures and models using distance difference tests</article-title>
        <source>Bioinformatics</source>
        <year>2013</year>
        <volume>29</volume>
        <fpage>2722</fpage>
        <lpage>2728</lpage>
        <?supplied-pmid 23986568?>
        <pub-id pub-id-type="pmid">23986568</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mizuguchi</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Deane</surname>
            <given-names>CM</given-names>
          </name>
          <name>
            <surname>Blundell</surname>
            <given-names>TL</given-names>
          </name>
          <name>
            <surname>Overington</surname>
            <given-names>JP</given-names>
          </name>
        </person-group>
        <article-title>HOMSTRAD: a database of protein structure alignments for homologous families</article-title>
        <source>Protein Sci.</source>
        <year>1998</year>
        <volume>7</volume>
        <fpage>2469</fpage>
        <lpage>2471</lpage>
        <?supplied-pmid 9828015?>
        <pub-id pub-id-type="pmid">9828015</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bordin</surname>
            <given-names>N</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>AlphaFold2 reveals commonalities and novelties in protein structure space for 21 model organisms</article-title>
        <source>Commun. Biol.</source>
        <year>2023</year>
        <volume>6</volume>
        <fpage>160</fpage>
        <?supplied-pmid 36755055?>
        <pub-id pub-id-type="pmid">36755055</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Burley</surname>
            <given-names>SK</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>RCSB Protein Data Bank: powerful new tools for exploring 3D structures of biological macromolecules for basic and applied research and education in fundamental biology, biomedicine, biotechnology, bioengineering and energy sciences</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2021</year>
        <volume>49</volume>
        <fpage>D437</fpage>
        <lpage>D451</lpage>
        <?supplied-pmid 33211854?>
        <pub-id pub-id-type="pmid">33211854</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gao</surname>
            <given-names>Y</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Structure of the RNA-dependent RNA polymerase from COVID-19 virus</article-title>
        <source>Science</source>
        <year>2020</year>
        <volume>368</volume>
        <fpage>779</fpage>
        <lpage>782</lpage>
        <?supplied-pmid 32277040?>
        <pub-id pub-id-type="pmid">32277040</pub-id>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <mixed-citation publication-type="other">Van den Oord, A., Vinyals, O. &amp; Kavukcuoglu, K. Neural discrete representation learning. <italic>Proc. of the 31st Conference on Neural Information Processing Systems</italic>. <ext-link ext-link-type="uri" xlink:href="https://proceedings.neurips.cc/paper_files/paper/2017/file/7a98af17e63a0ac09ce2e96d03992fbc-Paper.pdf">https://proceedings.neurips.cc/paper_files/paper/2017/file/7a98af17e63a0ac09ce2e96d03992fbc-Paper.pdf</ext-link> (NIPS, 2017).</mixed-citation>
    </ref>
    <ref id="CR29">
      <label>29.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Burley</surname>
            <given-names>SK</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Protein Data Bank: the single global archive for 3D macromolecular structure data</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2019</year>
        <volume>47</volume>
        <fpage>D520</fpage>
        <lpage>D528</lpage>
        <pub-id pub-id-type="pmid">30357364</pub-id>
      </element-citation>
    </ref>
    <ref id="CR30">
      <label>30.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kim</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Mirdita</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Steinegger</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Foldcomp: a library and format for compressing and indexing large protein structure sets</article-title>
        <source>Bioinformatics</source>
        <year>2023</year>
        <volume>39</volume>
        <fpage>btad153</fpage>
        <?supplied-pmid 36961332?>
        <pub-id pub-id-type="pmid">36961332</pub-id>
      </element-citation>
    </ref>
    <ref id="CR31">
      <label>31.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rotkiewicz</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Skolnick</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Fast procedure for reconstruction of full-atom protein models from reduced representations</article-title>
        <source>J. Comput. Chem.</source>
        <year>2008</year>
        <volume>29</volume>
        <fpage>1460</fpage>
        <lpage>1465</lpage>
        <?supplied-pmid 18196502?>
        <pub-id pub-id-type="pmid">18196502</pub-id>
      </element-citation>
    </ref>
    <ref id="CR32">
      <label>32.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Valasatava</surname>
            <given-names>Y</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Towards an efficient compression of 3D coordinates of macromolecular structures</article-title>
        <source>PLoS ONE</source>
        <year>2017</year>
        <volume>12</volume>
        <fpage>e0174846</fpage>
        <?supplied-pmid 28362865?>
        <pub-id pub-id-type="pmid">28362865</pub-id>
      </element-citation>
    </ref>
    <ref id="CR33">
      <label>33.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hauser</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Steinegger</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Söding</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>MMseqs software suite for fast and deep clustering and searching of large protein sequence sets</article-title>
        <source>Bioinformatics</source>
        <year>2016</year>
        <volume>32</volume>
        <fpage>1323</fpage>
        <lpage>1330</lpage>
        <?supplied-pmid 26743509?>
        <pub-id pub-id-type="pmid">26743509</pub-id>
      </element-citation>
    </ref>
    <ref id="CR34">
      <label>34.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Farrar</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Striped Smith–Waterman speeds database searches six times over other SIMD implementations</article-title>
        <source>Bioinformatics</source>
        <year>2007</year>
        <volume>23</volume>
        <fpage>156</fpage>
        <lpage>161</lpage>
        <?supplied-pmid 17110365?>
        <pub-id pub-id-type="pmid">17110365</pub-id>
      </element-citation>
    </ref>
    <ref id="CR35">
      <label>35.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhao</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>W-P</given-names>
          </name>
          <name>
            <surname>Garrison</surname>
            <given-names>EP</given-names>
          </name>
          <name>
            <surname>Marth</surname>
            <given-names>GT</given-names>
          </name>
        </person-group>
        <article-title>SSW library: an SIMD Smith–Waterman C/C++ library for use in genomic applications</article-title>
        <source>PLoS ONE</source>
        <year>2013</year>
        <volume>8</volume>
        <fpage>e82138</fpage>
        <?supplied-pmid 24324759?>
        <pub-id pub-id-type="pmid">24324759</pub-id>
      </element-citation>
    </ref>
    <ref id="CR36">
      <label>36.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Eddy</surname>
            <given-names>SR</given-names>
          </name>
        </person-group>
        <article-title>Accelerated profile HMM searches</article-title>
        <source>PLoS Comput. Biol.</source>
        <year>2011</year>
        <volume>7</volume>
        <fpage>e1002195</fpage>
        <?supplied-pmid 22039361?>
        <pub-id pub-id-type="pmid">22039361</pub-id>
      </element-citation>
    </ref>
    <ref id="CR37">
      <label>37.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Söding</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Remmert</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Protein sequence comparison and fold recognition: progress and good-practice benchmarking</article-title>
        <source>Curr. Opin. Struct. Biol.</source>
        <year>2011</year>
        <volume>21</volume>
        <fpage>404</fpage>
        <lpage>411</lpage>
        <?supplied-pmid 21458982?>
        <pub-id pub-id-type="pmid">21458982</pub-id>
      </element-citation>
    </ref>
    <ref id="CR38">
      <label>38.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Benaglia</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Chauveau</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Hunter</surname>
            <given-names>DR</given-names>
          </name>
          <name>
            <surname>Young</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>mixtools: an R package for analyzing finite mixture models</article-title>
        <source>J. Stat. Softw.</source>
        <year>2009</year>
        <volume>32</volume>
        <fpage>1</fpage>
        <lpage>29</lpage>
      </element-citation>
    </ref>
    <ref id="CR39">
      <label>39.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Daily</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Parasail: SIMD C library for global, semi-global, and local pairwise sequence alignments</article-title>
        <source>BMC Bioinformatics</source>
        <year>2016</year>
        <volume>17</volume>
        <fpage>81</fpage>
        <?supplied-pmid 26864881?>
        <pub-id pub-id-type="pmid">26864881</pub-id>
      </element-citation>
    </ref>
    <ref id="CR40">
      <label>40.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hung</surname>
            <given-names>L-H</given-names>
          </name>
          <name>
            <surname>Samudrala</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>fast_protein_cluster: parallel and optimized clustering of large-scale protein modeling data</article-title>
        <source>Bioinformatics</source>
        <year>2014</year>
        <volume>30</volume>
        <fpage>1774</fpage>
        <lpage>1776</lpage>
        <?supplied-pmid 24532722?>
        <pub-id pub-id-type="pmid">24532722</pub-id>
      </element-citation>
    </ref>
    <ref id="CR41">
      <label>41.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jiménez-Moreno</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Strelák</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Filipovic</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Carazo</surname>
            <given-names>JM</given-names>
          </name>
          <name>
            <surname>Sorzano</surname>
            <given-names>COS</given-names>
          </name>
        </person-group>
        <article-title>DeepAlign, a 3D alignment method based on regionalized deep learning for Cryo-EM</article-title>
        <source>J. Struct. Biol.</source>
        <year>2021</year>
        <volume>213</volume>
        <fpage>107712</fpage>
        <?supplied-pmid 33676034?>
        <pub-id pub-id-type="pmid">33676034</pub-id>
      </element-citation>
    </ref>
    <ref id="CR42">
      <label>42.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lafita</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>BioJava 5: a community driven open-source bioinformatics library</article-title>
        <source>PLoS Comput. Biol.</source>
        <year>2019</year>
        <volume>15</volume>
        <fpage>e1006791</fpage>
        <?supplied-pmid 30735498?>
        <pub-id pub-id-type="pmid">30735498</pub-id>
      </element-citation>
    </ref>
    <ref id="CR43">
      <label>43.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mirdita</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Steinegger</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Söding</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>MMseqs2 desktop and local web server app for fast, interactive sequence searches</article-title>
        <source>Bioinformatics</source>
        <year>2019</year>
        <volume>35</volume>
        <fpage>2856</fpage>
        <lpage>2858</lpage>
        <?supplied-pmid 30615063?>
        <pub-id pub-id-type="pmid">30615063</pub-id>
      </element-citation>
    </ref>
    <ref id="CR44">
      <label>44.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rose</surname>
            <given-names>AS</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>NGL viewer: web-based molecular graphics for large complexes</article-title>
        <source>Bioinformatics</source>
        <year>2018</year>
        <volume>34</volume>
        <fpage>3755</fpage>
        <lpage>3758</lpage>
        <?supplied-pmid 29850778?>
        <pub-id pub-id-type="pmid">29850778</pub-id>
      </element-citation>
    </ref>
    <ref id="CR45">
      <label>45.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Richardson</surname>
            <given-names>JS</given-names>
          </name>
        </person-group>
        <article-title>Early ribbon drawings of proteins</article-title>
        <source>Nat. Struct. Biol.</source>
        <year>2000</year>
        <volume>7</volume>
        <fpage>624</fpage>
        <lpage>625</lpage>
        <?supplied-pmid 10932243?>
        <pub-id pub-id-type="pmid">10932243</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
