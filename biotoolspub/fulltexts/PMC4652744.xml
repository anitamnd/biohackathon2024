<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD Journal Publishing DTD v2.3 20070202//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName journalpublishing.dtd?>
<?SourceDTD.Version 2.3?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 2?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Nucleic Acids Res</journal-id>
    <journal-id journal-id-type="iso-abbrev">Nucleic Acids Res</journal-id>
    <journal-id journal-id-type="hwp">nar</journal-id>
    <journal-id journal-id-type="publisher-id">nar</journal-id>
    <journal-title-group>
      <journal-title>Nucleic Acids Research</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">0305-1048</issn>
    <issn pub-type="epub">1362-4962</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">4652744</article-id>
    <article-id pub-id-type="pmid">25990729</article-id>
    <article-id pub-id-type="doi">10.1093/nar/gkv478</article-id>
    <article-categories>
      <subj-group subj-group-type="hwp-journal-coll">
        <subject>7</subject>
      </subj-group>
      <subj-group subj-group-type="heading">
        <subject>Methods Online</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Frequency-based haplotype reconstruction from deep sequencing data of bacterial populations</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Pulido-Tamayo</surname>
          <given-names>Sergio</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="AFF2">
          <sup>2</sup>
        </xref>
        <xref ref-type="aff" rid="AFF3">
          <sup>3</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Sánchez-Rodríguez</surname>
          <given-names>Aminael</given-names>
        </name>
        <xref ref-type="aff" rid="AFF2">
          <sup>2</sup>
        </xref>
        <xref ref-type="aff" rid="AFF4">
          <sup>4</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Swings</surname>
          <given-names>Toon</given-names>
        </name>
        <xref ref-type="aff" rid="AFF2">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Van den Bergh</surname>
          <given-names>Bram</given-names>
        </name>
        <xref ref-type="aff" rid="AFF2">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Dubey</surname>
          <given-names>Akanksha</given-names>
        </name>
        <xref ref-type="aff" rid="AFF2">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Steenackers</surname>
          <given-names>Hans</given-names>
        </name>
        <xref ref-type="aff" rid="AFF2">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Michiels</surname>
          <given-names>Jan</given-names>
        </name>
        <xref ref-type="aff" rid="AFF2">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Fostier</surname>
          <given-names>Jan</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Marchal</surname>
          <given-names>Kathleen</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="AFF2">
          <sup>2</sup>
        </xref>
        <xref ref-type="aff" rid="AFF3">
          <sup>3</sup>
        </xref>
        <xref ref-type="corresp" rid="COR1">*</xref>
      </contrib>
      <aff id="AFF1"><label>1</label>Department of Information Technology, Ghent University, iMinds, 9050 Gent, Belgium</aff>
      <aff id="AFF2"><label>2</label>Department of Microbial and Molecular Systems, Centre of Microbial and Plant Genetics, KU Leuven, Kasteelpark Arenberg 20, 3001 Leuven, Belgium</aff>
      <aff id="AFF3"><label>3</label>Department of Plant Biotechnology and Bioinformatics, Ghent University, 9052 Ghent, Belgium</aff>
      <aff id="AFF4"><label>4</label>Departamento de Ciencias Naturales, Universidad Técnica Particular de Loja, San Cayetano Alto S/N, EC1101608 Loja, Ecuador</aff>
    </contrib-group>
    <author-notes>
      <corresp id="COR1"><label>*</label>To whom correspondence should be addressed. Tel: +32 9 331 49 86; Fax: +32 9 331 48 99; Email: <email>kathleen.marchal@ugent.be</email></corresp>
    </author-notes>
    <pub-date pub-type="ppub">
      <day>18</day>
      <month>9</month>
      <year>2015</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>18</day>
      <month>5</month>
      <year>2015</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>18</day>
      <month>5</month>
      <year>2015</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the
							<pub-date pub-type="epub"/>. -->
    <volume>43</volume>
    <issue>16</issue>
    <fpage>e105</fpage>
    <lpage>e105</lpage>
    <history>
      <date date-type="accepted">
        <day>29</day>
        <month>4</month>
        <year>2015</year>
      </date>
      <date date-type="rev-recd">
        <day>26</day>
        <month>4</month>
        <year>2015</year>
      </date>
      <date date-type="received">
        <day>20</day>
        <month>2</month>
        <year>2015</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2015. Published by Oxford University Press on behalf of Nucleic Acids Research.</copyright-statement>
      <copyright-year>2015</copyright-year>
      <license license-type="creative-commons" xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<uri xlink:type="simple" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</uri>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:title="pdf" xlink:type="simple" xlink:href="gkv478.pdf"/>
    <abstract>
      <p>Clonal populations accumulate mutations over time, resulting in different haplotypes. Deep sequencing of such a population in principle provides information to reconstruct these haplotypes and the frequency at which the haplotypes occur. However, this reconstruction is technically not trivial, especially not in clonal systems with a relatively low mutation frequency. The low number of segregating sites in those systems adds ambiguity to the haplotype phasing and thus obviates the reconstruction of genome-wide haplotypes based on sequence overlap information.</p>
      <p>Therefore, we present EVORhA, a haplotype reconstruction method that complements phasing information in the non-empty read overlap with the frequency estimations of inferred local haplotypes. As was shown with simulated data, as soon as read lengths and/or mutation rates become restrictive for state-of-the-art methods, the use of this additional frequency information allows EVORhA to still reliably reconstruct genome-wide haplotypes. On real data, we show the applicability of the method in reconstructing the population composition of evolved bacterial populations and in decomposing mixed bacterial infections from clinical samples.</p>
    </abstract>
    <counts>
      <page-count count="13"/>
    </counts>
    <custom-meta-group>
      <custom-meta>
        <meta-name>cover-date</meta-name>
        <meta-value>18 September 2015</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec sec-type="intro" id="SEC1">
    <title>INTRODUCTION</title>
    <p>The genetic heterogeneity of clonal populations is key to their adaptive behavior. Environment-specific genes, subject to relaxed selection in a non-inducing environment, build up cryptic variation, that enhances the adaptive potential (<xref rid="B1" ref-type="bibr">1</xref>,<xref rid="B2" ref-type="bibr">2</xref>). Even when starting evolution from a single clone (haplotype) under severe selection pressure, the combination of mutation rate and population size appears to be sufficiently high to build up genetic variation in the population (<xref rid="B3" ref-type="bibr">3</xref>,<xref rid="B4" ref-type="bibr">4</xref>), resulting in a mixture of closely related haplotypes (or quasispecies). As a result, a population is not genetically uniform most of the time (<xref rid="B5" ref-type="bibr">5</xref>). Although single cell sequencing would be ideal to determine the composition of such a heterogeneous population, it is still technically very difficult and cost-inefficient (<xref rid="B6" ref-type="bibr">6</xref>–<xref rid="B8" ref-type="bibr">8</xref>). However, deep sequencing a clonal population in its entirety, referred to as pooled or metagenomic sequencing (<xref rid="B9" ref-type="bibr">9</xref>) inherently contains information to determine the haplotypic variation of the population, i.e. the identity of the occurring haplotypes and their frequencies.</p>
    <p>However, resolving haplotypes from deep sequencing data of clonal populations, also referred to as haplotype reconstruction or quasi-species assembly is technically not trivial and methods to do so are still lacking for most clonal species, other than viruses.</p>
    <p>At first because the problem of error correction is confounded with the haplotype reconstruction itself (<xref rid="B10" ref-type="bibr">10</xref>) and therefore error correction and haplotype reconstruction should ideally be performed simultaneously. The reconstruction problem itself is non-trivial either. For this reconstruction step all current haplotype reconstruction methods rely on the presence of a sufficient number of segregating sites and relatively long reads to allow phasing the segregating polymorphic sites into unique haplotypes using either single end (<xref rid="B11" ref-type="bibr">11</xref>–<xref rid="B16" ref-type="bibr">16</xref>) or paired end read information (<xref rid="B17" ref-type="bibr">17</xref>). This strategy implies that most reads should contain segregating sites and that a sufficient amount of overlap between reads is available to resolve the reconstruction problem. As a result, current methods are restricted to haplotype reconstruction from relatively long-read population sequencing (mainly Roche 454) of clonal organisms with a high mutation frequency (<xref rid="B18" ref-type="bibr">18</xref>), such as viruses: a high mutation frequency guarantees a large number of segregating sites and long-read based sequencing allows for a large degree of overlap between the reads.</p>
    <p>However, for most clonal populations the number of observed segregating sites is much lower than what is observed in viral populations. In a bacterial setting, for instance, haplotypes consist of millions of base pairs corresponding to the size of a bacterial genome, but populations typically contain less than a few hundreds of mutations even in the presence of a mutator phenotype (e.g. bacterial populations originating from a mutator phenotype accumulate after 300 generations approximately 1000 mutations). This relatively low mutation frequency implies an average distance between segregating sites that is in the order of kilobases, which is a lot larger than the maximal read length for Illumina and Roche 454 technologies. Due to the lack of segregating sites, phasing becomes extremely difficult. As a result, state-of-the-art viral haplotype reconstruction methods cannot infer haplotypes from bacterial population samples.</p>
    <p>With EVORhA (Evolutionary Reconstruction of Haplotypes) we propose to the best of our knowledge the first bacterial haplotype reconstruction method. EVORhA combines local haplotype inference with error correction and uses a probabilistic approach for the genome-wide reconstruction. Key to the method is the use of the inferred frequency ratios of the contributing haplotypes to improve the extension of local haplotypes into genome-wide ones, particularly in those cases where the non-empty overlap between reads does not allow for a non-ambiguous phasing or where partially reconstructed regions have no sequence overlap at all. Because of this key step EVORhA is applicable to the analysis of pooled sequence data obtained from populations of clonal organisms with a low mutation frequency and/or to data obtained with a short-read based technology. We demonstrated the performance of EVORhA under different settings on simulated data. In addition, we showed its ability to reconstruct genome-wide haplotypes in a real setting by analyzing data obtained from a mixed bacterial infection and from pooled sequence samples of an evolving bacterial population. The implementation can be downloaded from <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.intec.ugent.be/kmarchal/EVORhA/">http://bioinformatics.intec.ugent.be/kmarchal/EVORhA/</ext-link>. The source code is available upon request.</p>
  </sec>
  <sec sec-type="materials|methods" id="SEC2">
    <title>MATERIALS AND METHODS</title>
    <sec id="SEC2-1">
      <title>EVORhA</title>
      <p>Our method uses a two-step procedure: the first step reconstructs haplotypes at the local level and joins locally reconstructed haplotypes into so-called extended haplotypes based on information contained within the read overlap. The second step assigns these extended haplotypes to haplotype sets by using a mixture model of Gaussian distributions that describes for each set the frequency at which the haplotypes assigned to the set are observed. These haplotype sets are eventually joined into genome-wide haplotypes, following a procedure that explicitly assumes that the different haplotypes in the population have evolved from a common ancestor by clonal reproduction. The procedure is outlined in Figure <xref ref-type="fig" rid="F1">1</xref>.</p>
      <fig id="F1" position="float">
        <label>Figure 1.</label>
        <caption>
          <p>Method Overview. A clonal community where three descendant haplotypes evolved from a reference genome is depicted. The haplotypes are present at respectively 60%, 25% and 15% in the population. A total of 10 different mutations accumulated in the evolving population. Mutations ‘1’ and ‘2’ were acquired by the last common ancestor of extant haplotypes and are therefore shared by all haplotypes in the population. Mutations ‘3’ and ‘4’ were acquired before the origin of the <italic>blue</italic> and <italic>purple</italic> haplotypes, whereas the remaining mutations are unique to one of the haplotypes. Small colored horizontal bars represent the reads obtained by deep sequencing the aforementioned population. The coloring of the reads corresponds to the colors of the haplotypes from which they originated. Reads are mapped to the ancestral reference genome. Step 1: Local haplotype reconstruction and window extension. (<bold>A</bold>) Haplotype templates and their frequencies are first inferred per window. Windows are represented by gray rectangles. A window is defined as a genomic region that is covered by a sufficient number of reads and that contains a set of one or more consecutive tentative polymorphic sites. Tentative polymorphisms can refer to both sequencing errors (red crosses) and true polymorphisms. Per window, accepted template windows will be defined by performing a local haplotype reconstruction simultaneously with the error correction (see Supplementary Figure S1). (<bold>B</bold>) Template haplotypes are extended over flanking windows with overlapping polymorphic sites based on the consistency in the polymorphisms present in the non-empty read overlap of these flanking windows and in the frequencies of the extended template haplotypes. Two windows for which the ‘window extension’ will be performed are indicated by gray rectangles. In the example the template haplotypes within these flanking windows will be merged into 3 extended haplotypes (the <italic>purple</italic>, <italic>green</italic> and <italic>blue</italic> one, see Supplementary Figure S2). (<bold>C</bold>) Step 2: Genome-wide haplotype reconstruction. Extended haplotypes from the different concatenated windows will be merged into genome-wide haplotypes based on the frequency information. To this end, we use a mixture model approach in which extended haplotypes occurring at similar frequencies in the population, referred to as haplotype sets are represented by a different mixture component in the model (distributions drawn at the right of the picture). Haplotype sets containing polymorphisms unique for the haplotype will occur at a lower frequency than haplotype sets that contain polymorphisms shared by several genome-wide haplotypes (indicated in pink, see also Supplementary Figure S3). The genome-wide haplotype reconstruction searches for combinations of haplotype sets that provide the best explanation for the observed frequencies of all haplotype sets.</p>
        </caption>
        <graphic xlink:href="gkv478fig1"/>
      </fig>
      <sec id="SEC2-1-1">
        <title>Step 1: Local haplotype reconstruction and window extension</title>
        <sec id="SEC2-1-1-1">
          <title>Window definition</title>
          <p>A window is defined as a genomic region that is covered by a sufficient number of reads and that contains a set of one or more consecutive tentative polymorphic sites. As at this point, variation observed at these sites can refer to both sequencing errors and true polymorphisms, we refer to them as ‘tentative’. All windows that contain a unique combination of consecutive (tentative) polymorphic sites are enumerated, with the restriction that windows should be shorter than a pre-specified maximal window length (60% of the read length by default) and that windows should be entirely covered by a certain minimum number of reads (30 reads by default). Regions that are not covered by the minimal number of reads will be ignored. Both window-defining parameters could be adjusted if necessary.</p>
        </sec>
        <sec id="SEC2-1-1-2">
          <title>Inferring template haplotypes and their frequencies per window</title>
          <p>A list of possible template haplotypes is generated per window (see Supplementary Figure S1). A template haplotype is defined as a unique combination of one or more consecutive (tentative) polymorphisms observed in at least one of the reads that fully covers the window. For each template haplotype <italic><bold>h</bold></italic> = {<italic>h</italic><sub>1</sub>, <italic>h</italic><sub>2</sub>, …} found in window <italic>W</italic> a corresponding ‘support’ <inline-formula><tex-math id="M1">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\tau = \left\{ {\tau _1 ,\tau _2 , \ldots } \right\}$\end{document}</tex-math></inline-formula> is based on all reads that are consistent with that template haplotype. First, we consider only the reads that fully overlap with the window and calculate a <italic>base support</italic>
<inline-formula><tex-math id="M2">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\tau _i^0$\end{document}</tex-math></inline-formula> for template haplotype <italic>h<sub>i</sub></italic> as follows:
<disp-formula><tex-math id="M3">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}\begin{equation*} \tau _i^0 = \mathop \sum \limits_{r\, \in \,F_i } w\left( r \right)\end{equation*}\end{document}</tex-math></disp-formula>
where <italic>F<sub>i</sub></italic> denotes the set of reads that fully overlap with the window and that are consistent with template haplotype <italic>h<sub>i</sub></italic> and where <italic>w</italic>(<italic>r</italic>) is given by
<disp-formula><tex-math id="M4">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}\begin{equation*} w\left( r \right) = \mathop {\min }\limits_{j = 1,l} P\left( {r\left[ j \right]} \right)\end{equation*}\end{document}</tex-math></disp-formula>
with <inline-formula><tex-math id="M5">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$P\left( {r[j]} \right)$\end{document}</tex-math></inline-formula> the base call accuracy at tentative polymorphic site <italic>j</italic> of read <italic>r</italic> containing <italic>l</italic> tentative polymorphisms. It is related to the Phred quality score <inline-formula><tex-math id="M6">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$Q(r[j])$\end{document}</tex-math></inline-formula> as follows:
<disp-formula><tex-math id="M7">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}\begin{equation*} P\left( {r\left[ j \right]} \right) = 1 - 10^{\frac{{ - Q\left( {r\left[ j \right]} \right)}}{{10}}} \end{equation*}\end{document}</tex-math></disp-formula></p>
          <p>We choose w(r) to depend on min <inline-formula><tex-math id="M8">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$P(r[j])$\end{document}</tex-math></inline-formula>, assuming that the contribution of the read to the support depends on its lowest quality polymorphism. This allows to have a scoring independent of the window length.</p>
          <p>Additional support <inline-formula><tex-math id="M9">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\tau _i^1$\end{document}</tex-math></inline-formula> for template haplotype <italic>h<sub>i</sub></italic> is derived from reads that only partially overlap with window <italic>W</italic>.
<disp-formula><tex-math id="M10">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}\begin{equation*} \tau _i^1 = \mathop \sum \limits_{r \in P_i } \frac{{\tau _i^0 }}{{\mathop \sum \nolimits_{j|r \in P_j } \tau _j^0 }}w\left( r \right)\end{equation*}\end{document}</tex-math></disp-formula>
Where <italic>P<sub>i</sub></italic> denotes the set of reads that partially overlap with the window and that are consistent with template haplotype <italic>h<sub>i</sub></italic>. Note that partially overlapping reads can be consistent with multiple template haplotypes. The fraction within the summation therefore denotes that a given read gives a support to the haplotype it is compatible with, weighted proportionally to the base support of that haplotype. The total support of a template haplotype <inline-formula><tex-math id="M11">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\tau _i$\end{document}</tex-math></inline-formula> is then given by
<disp-formula><tex-math id="M12">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}\begin{equation*} \tau _i = \tau _i^0 + \tau _i^1 \end{equation*}\end{document}</tex-math></disp-formula></p>
          <p>The template haplotypes <bold><italic>h</italic></bold> might contain errors, i.e. tentative polymorphisms that arose due to sequencing errors. To prune templates in the windows, we retain per window only the template haplotypes with support <inline-formula><tex-math id="M13">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\tau _i$\end{document}</tex-math></inline-formula> greater than the template haplotype threshold. The threshold for the support is different for different templates and is determined by the following equation:
<disp-formula><tex-math id="M14">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}\begin{equation*} \tau _{{\rm threshold}} = - 11.86 + 4.24\ln \left( f \right) + E\left( c \right)\end{equation*}\end{document}</tex-math></disp-formula>
<disp-formula><tex-math id="M15">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}\begin{equation*} E\left( c \right) = \left\{ {\begin{array}{*{20}c} {0\,if\,InterGenic{\mathop{Region}\nolimits}} \\ {0\,\,{if}\,\,{BLOSUM} \ge 0} \\ { - 1 \times {BLOSUM}\,\,{if}\,\,{BLOSUM} &lt; 0} \\ \end{array}} \right.\end{equation*}\end{document}</tex-math></disp-formula>
Where <italic>f</italic> represents the average fold coverage in the considered window to which a polymorphism belongs and <italic>c</italic> the codon in the same window with the lowest BLOSUM score. The BLOSUM matrix used is obtained by comparing already calculated matrices against the analyzed data. In most cases, the most similar matrix is the BLOSUM100. The equation describes that the minimal threshold on the support for accepting template haplotypes will increase with the coverage of the window and with the severity of the amino acid changes induced by the polymorphisms, i.e. template haplotypes with a higher coverage and more unlikely amino acid changes need more support to be retained. The parameters in this formula, being the contribution of the window coverage and the codon changes, were determined by maximizing the accuracy of reconstructing true haplotypes in a simulated setting (see simulated data).</p>
          <p>A haplotype with a support below the threshold is assumed to be a ‘false positive’ and will no longer be considered as a possible template. Reads that contributed to the support of a rejected template will be reassigned to the accepted template haplotype that is evolutionary most related to it (using the BLOSUM matrix mentioned above). Note that sequence error correction is performed simultaneously with haplotype reconstruction: rather than filtering upfront tentative polymorphisms that occur infrequently (i.e. standard error correction), polymorphisms are filtered when they belong to template haplotypes with insufficient support. This prevents the deletion of infrequently observed polymorphisms when they belong to a template haplotype with sufficient support.</p>
        </sec>
        <sec id="SEC2-1-1-3">
          <title>Window extension: concatenating windows that share polymorphisms</title>
          <p>Here, we start with a set of windows and their respective accepted template haplotypes. Some windows will share polymorphic sites and will be extended (see Supplementary Figure S2). The extension is performed window by window, starting from a so called seed window which corresponds to the window with the largest number of ‘accepted’ template haplotypes, the largest number of polymorphic sites and the highest coverage. If no window meets all criteria simultaneously, we select the seed window by prioritizing first on the number of template haplotypes, then on the number of polymorphic sites and, lastly, on coverage. The goal of the extension is to find the best combination of haplotypes from the first and second window that can be concatenated to generate an extended haplotype, where ‘best’ is defined in terms of matching frequencies and shared polymorphisms.</p>
          <p>The extension, which is conceptually very similar to what is referred to as the ‘global reconstruction’ in graph-based haplotype reconstruction approaches (<xref rid="B11" ref-type="bibr">11</xref>–<xref rid="B13" ref-type="bibr">13</xref>,<xref rid="B16" ref-type="bibr">16</xref>), is performed as follows: for each pair of overlapping windows <inline-formula><tex-math id="M16">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$W = \left\{ {W_a ,W_b } \right\}$\end{document}</tex-math></inline-formula>, a set of <italic>groups G</italic> is declared where one group <italic>g<sub>i</sub></italic> is defined per unique combination of consecutive polymorphisms in the overlap of both windows. The template haplotypes in the windows are then assigned to those groups. Note that a specific template haplotype can only be assigned to a single group; however, a certain group can contain multiple template haplotypes. We can now distinguish three cases:
<list list-type="order"><list-item><p>If a group contains a single template haplotype in one window and at least one template haplotype in the other window, the extension is straightforward and the extended haplotypes consist of the concatenation of the sequences of the template haplotypes in both windows.</p></list-item><list-item><p>If a group contains multiple template haplotypes in both windows, the extension is ambiguous. In that case, first, it is assumed that the number of extended haplotypes equals the maximum number of template haplotypes present in either window. The assignment of template haplotypes to the extended haplotypes and the frequencies of the extended haplotypes <inline-formula><tex-math id="M17">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\theta = \left\{ {\theta _1 ,\theta _2 , \ldots } \right\}$\end{document}</tex-math></inline-formula> are determined using an expectation maximization algorithm. First, the frequencies <italic>θ</italic> are initialized randomly. During the expectation step, template haplotypes in both windows are assigned to the extended haplotypes such that the observed frequencies <italic>f</italic> of the template haplotypes best match the frequencies <italic>θ</italic>. In case a template haplotype can be assigned to multiple extended haplotypes, the frequency of the template haplotype is split according to the frequencies <italic>θ</italic> of the extended haplotypes to which it was assigned. All possible combinations of assignments are exhaustively enumerated and the one that maximizes the log-likelihood according to the Poisson distribution is selected:</p></list-item></list>
<disp-formula><tex-math id="M18">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}\begin{equation*} L = \mathop \sum \limits_{x \in X} \left[ {\log \frac{{\lambda _{x,a} ^{k_{x,a} } }}{{k_{x,a} !}}e^{ - \lambda _{x,a} } + \log \frac{{\lambda _{x,b} ^{k_{x,b} } }}{{k_{x,b} !}}e^{ - \lambda _{x,b} } } \right]\end{equation*}\end{document}</tex-math></disp-formula>
where <inline-formula><tex-math id="M19">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\lambda _{x,a} = c_a \theta _x$\end{document}</tex-math></inline-formula> and <inline-formula><tex-math id="M20">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\lambda _{x,b}$\end{document}</tex-math></inline-formula> = <inline-formula><tex-math id="M21">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$c_b \theta _x$\end{document}</tex-math></inline-formula> denote the expected number of reads matching extended haplotype <italic>x</italic> in windows <italic>a</italic> and <italic>b</italic>, respectively. Here, <italic>c<sub>a</sub></italic> and <italic>c<sub>b</sub></italic> are the coverages in windows <italic>a</italic> and <italic>b</italic>, respectively and <italic>θ<sub>x</sub></italic> is the frequency of extended haplotype <italic>x</italic>. Similarly, <inline-formula><tex-math id="M22">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$k_{x,a} = c_a f_x$\end{document}</tex-math></inline-formula> and <inline-formula><tex-math id="M23">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$k_{x,b}$\end{document}</tex-math></inline-formula> = <inline-formula><tex-math id="M24">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$c_b f_x$\end{document}</tex-math></inline-formula> denote the observed number of reads matching extended haplotype <italic>x</italic> in windows <italic>a</italic> and <italic>b</italic>, respectively, with <italic>f<sub>x</sub></italic> being the observed frequency of the template haplotypes.</p>
          <p>The maximization step then computes the new frequencies <italic>θ</italic> for extended haplotypes by computing the average frequencies of the contributing template haplotypes.</p>
          <p>This process is repeated until the likelihood difference between consecutive iterations becomes sufficiently small or until a maximum number of iterations has been reached. We perform multiple starts with random initial frequencies to avoid local maxima.
<list list-type="simple"><list-item><p>If a certain group only contains template haplotypes from one window (not both), the template haplotypes in the group are moved to a different group that contains the haplotypes for which the evolutionary distance (BLOSUM) to the haplotypes under consideration is the smallest. This situation can occur with low frequency haplotypes where reads derived from these haplotype might not be available for all windows. After reassigning the haplotypes to another the procedure is as described in (1) and (2).</p></list-item></list></p>
          <p>The concatenated window containing the extended haplotypes is subsequently used as a seed to concatenate the next set of flanking windows. If no more flanking windows exist for the current concatenated window, a new initial window is defined. The procedure continues until all windows that display overlapping polymorphisms have been concatenated.</p>
          <p>The window extension thus produces a set of extended windows and their respective extended haplotypes. An extended window by definition does not share any polymorphic sites with other windows and cannot be further extended (phased) by analyzing read overlap.</p>
        </sec>
      </sec>
      <sec id="SEC2-1-2">
        <title>Step 2: Genome-wide haplotype reconstruction</title>
        <p>Extended haplotypes are those that can no further be concatenated, because they do not longer contain polymorphisms in their read overlap. This occurs when either the read overlap between two extended haplotypes is empty or non-informative. The latter situation arises in case of low mutation frequency when the genomic distances between segregating sites are usually larger than the median read length. To compensate for this lack of information, we will use the frequency information of each of these extended haplotypes, to infer a possible genome-wide haplotype. To combine extended haplotypes into genome-wide haplotypes, we first perform a frequency analysis by grouping together extended haplotypes that occur at similar frequency (referred to as haplotype sets) and subsequently use a power set approach to search for a final genome-wide haplotype that can explain the frequencies of the observed sets of ‘extended haplotypes’.</p>
        <sec id="SEC2-1-2-1">
          <title>Frequency analysis</title>
          <p>Let <bold><italic>R</italic></bold> = {<italic>R</italic><sub>1</sub>, <italic>R</italic><sub>2</sub>, …, <italic>R<sub>n</sub></italic>} denote the number of reads that correspond to the extended haplotypes <bold><italic>h</italic></bold> = {<italic>h</italic><sub>1</sub>, <italic>h</italic><sub>2</sub>, …, <italic>h<sub>n</sub></italic>}, observed in a concatenated window. <bold><italic>R</italic></bold> then follows a multinomial distribution:
<disp-formula><tex-math id="M25">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}\begin{equation*} {\boldsymbol{R}}\sim{\rm Multi}\left( {C,{\boldsymbol{P}}} \right)\end{equation*}\end{document}</tex-math></disp-formula>
where <italic>C</italic> denotes the number of reads observed in the concatenated window and <bold><italic>P</italic></bold> = {<italic>P</italic><sub>1</sub>, <italic>P</italic><sub>2</sub>, …, <italic>P<sub>n</sub></italic>} denotes the true frequencies of the haplotypes. If the window coverage is sufficiently high, the multinomial distribution <bold><italic>R</italic></bold> can be approximated by <italic>n</italic> normal distributions:
<disp-formula><tex-math id="M26">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}\begin{equation*} R_i = CX_i \sim {\rm N}\left( {CP_i ,CP_i \left( {1 - P_i } \right)} \right)\end{equation*}\end{document}</tex-math></disp-formula>
where <bold><italic>X</italic></bold> = {<italic>X</italic><sub>1</sub>, <italic>X</italic><sub>2</sub>, …, <italic>X<sub>n</sub></italic>} are the observed frequencies of the extended haplotypes in the concatenated window. It then follows that:
<disp-formula><tex-math id="M27">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}\begin{equation*} X_i \sim {\rm N}\left( {P_i ,\frac{{P_i \left( {1 - P_i } \right)}}{C}} \right)\end{equation*}\end{document}</tex-math></disp-formula>
Given that the extended haplotypes and the frequencies <bold><italic>X</italic></bold> at which they are observed, should be consistent over at least several windows, the frequencies at which extended haplotypes are observed in each of the windows can be assumed to be generated by a mixture model of Gaussian distributions (see Supplementary Figure S3). If polymorphisms occurring at the same site are shared by different haplotypes, they will occur at a frequency (or Gaussian) different than polymorphisms that are unique to a single haplotype.</p>
          <p>This mixture model is inferred as follows: the method starts by assigning one Gaussian distribution to each of the extended haplotypes observed in an initially selected concatenated window (using the same initialization criteria defined above i.e. the concatenated window with the largest number of ‘accepted’ template haplotypes, the largest number of polymorphisms and the highest coverage is selected as a seed. If no window meets all criteria simultaneously, we select the seed prioritizing first on the number of template haplotypes, then on the number of polymorphisms and, lastly, on coverage). Subsequently we assign per concatenated window each extended haplotype to the Gaussian that currently best explains its observed frequency provided the mean of this Gaussian is located less than one standard deviation from the observed haplotype frequency. If the mean of the best explaining distribution is more than one standard deviation away from the observed frequency of the given haplotype, we create a new Gaussian in the mixture model and we continue until all haplotypes have been assigned to a Gaussian distribution that is less than one standard deviation away from the observed frequency of the given haplotype. The resulting model is referred to as the full mixture model.</p>
          <p>As this is a very relaxed way of extending the mixture, we include a final Bregman hierarchical clustering step (<xref rid="B19" ref-type="bibr">19</xref>) to reduce the model complexity and find an optimal mixture model for which the difference with the full mixture model in fitting the observed frequencies of the haplotypes is less than 1%. By considering the frequencies of all extended haplotypes in all extended windows, the frequency analysis results in a mixture model of Gaussian distributions that groups all extended haplotypes, occurring at a similar frequency in haplotype sets.</p>
        </sec>
        <sec id="SEC2-1-2-2">
          <title>Inferring the final genome-wide haplotype</title>
          <p>Each inferred distribution in the mixture model corresponds to a set of extended haplotypes that are likely to co-occur in one or more genome-wide haplotypes (referred to as a haplotype set). At this moment each true haplotype can still be characterized by several Gaussians from the mixture (see Supplementary Figure S3). This is because haplotype sets containing polymorphisms unique for the haplotype will occur at a lower frequency than haplotype sets that contain polymorphisms shared by several genome-wide haplotypes.</p>
          <p>To join haplotype sets that can safely be assumed to belong to the same haplotype we use the following approach: a distance matrix <italic>D</italic> is calculated between all pairs <italic>i,j</italic> of haplotype sets, where <inline-formula><tex-math id="M28">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$D_{i,j} = \left| {P_i \mathop \cup \nolimits^ P_j } \right| - \left| {P_i \mathop \cap \nolimits^ P_j } \right|$\end{document}</tex-math></inline-formula> and <italic>P<sub>i</sub></italic>, <italic>P<sub>j</sub></italic> are the polymorphisms composing each haplotype set, respectively. Obviously, different polymorphisms at the same polymorphic site are considered as different objects in the haplotype sets.</p>
          <p>Subsequently, for each haplotype set <italic>h</italic> from the full list of haplotype sets <inline-formula><tex-math id="M29">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${\cal H}$\end{document}</tex-math></inline-formula> (always starting with the haplotype set with the highest observed frequency) we construct a subset <inline-formula><tex-math id="M30">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${\cal H}_h = \left\{ {g \in {\cal H}|\mu _g &lt; \mu _h \wedge D_{h,g} = 0} \right\}$\end{document}</tex-math></inline-formula> where <italic>μ<sub>g</sub></italic> and <italic>μ<sub>h</sub></italic> are the means of the Gaussian distributions representing haplotypes sets <italic>g</italic> and <italic>h</italic>, respectively. Then, for the power set <inline-formula><tex-math id="M31">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$P\left( {{\cal H}_h } \right)$\end{document}</tex-math></inline-formula> we construct <inline-formula><tex-math id="M32">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$P\prime \left( {{\cal H}_h } \right) = \{ {\rm \omega } \in P\left( {{\cal H}_h } \right)|f\left( {\rm \omega } \right) &lt; 2 \times \sigma _h \}$\end{document}</tex-math></inline-formula> where <italic>σ<sub>h</sub></italic> is the standard deviation of the Gaussian distribution representing haplotype set <italic>h</italic> (i.e. those subsets where the sum of the frequencies of the haplotype sets is in the 95% confidence interval of the Gaussian distribution of <italic>h</italic>):
<disp-formula><tex-math id="M33">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}\begin{equation*} \varpi = \mathop {{\rm argmin}}\limits_{{\rm \omega } \in P' \left( {{\cal H}_h } \right)} f\left( {\rm \omega } \right)\end{equation*}\end{document}</tex-math></disp-formula>
<disp-formula><tex-math id="M34">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}\begin{equation*} f\left( {\rm \omega } \right) = \left[ {\mu _g - \mathop \sum \limits_{{\rm i} \in {\rm \omega }} \mu _i } \right]\end{equation*}\end{document}</tex-math></disp-formula></p>
          <p>If <italic>ϖ</italic> exists, we conclude that haplotype set <italic>h</italic> contains a set of polymorphisms shared by all haplotypes in <italic>ϖ</italic> and therefore will no longer be considered as an individual haplotype. Therefore, we remove <italic>h</italic> from the list of haplotypes and add the polymorphisms in <italic>h</italic> to all haplotype sets in <italic>ϖ</italic>. This final step in the analysis results in the reconstructed genome-wide haplotypes, their inferred frequencies and polymorphisms.</p>
          <p>The following running parameters are used for EVORhA by default:</p>
          <p>The parameters of the method are those that define valid windows, being the ‘maximal window length’ and the ‘minimal read coverage’. For the minimal read coverage a default value of 30 reads was chosen. This, to guarantee a sufficient number of reads in each window so that the distribution of the reads corresponding to template haplotypes in the window can be approximated by a multinomial, and therefore can be modeled as a mixture model of Gaussian distributions, such as described in step 2. The default of the maximum window length was chosen at 60% of the read length so that the template haplotypes and their <italic>base support</italic>, both derived from reads that fully overlap with the window, are representative for the true haplotypes present in the window.</p>
        </sec>
      </sec>
    </sec>
    <sec id="SEC2-2">
      <title>Simulation experiments</title>
      <sec id="SEC2-2-1">
        <title>Performance assessment of EVORhA</title>
        <p>To test EVORhA, a first set of population sequence data was generated using the sequence of <italic>Salmonella Typhimurium</italic> 14028S (Accession number CP001362) as the ancestral reference strain. In the simulated populations, the number of polymorphisms varied between 100, 1000 and 2500, the number of haplotypes varied from 2 to 7 and their frequencies were set randomly. For each simulated population a random phylogeny was constructed prior to assigning polymorphisms to haplotypes. Polymorphisms were added at a random branch of the phylogeny and propagated to all haplotypes descending from that branch, ensuring the simulation of evolutionary related haplotypes (assuming that the different haplotypes in the population have developed by clonal reproduction from a common ancestor). For each of these populations we simulated reads at the polymorphic sites for different sequence coverages (ranging between 50, 200 and 500) and using a sequencing error probability of 1%. Per parameter combination (number of haplotypes, number of mutations and coverage), 100 data sets were generated.</p>
        <p>The degree to which an inferred haplotype could correctly be reconstructed was assessed by a ‘reliability score’, which is the proportion of shared polymorphisms between the reconstructed haplotype and its most similar true counterpart i.e. the simulated haplotype.
<disp-formula><tex-math id="M35">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}\begin{equation*} Reliability = \frac{{\left| {P_h \mathop \cap P_s } \right|}}{{\left| {P_h } \right| + \left| {P_s } \right|}}\end{equation*}\end{document}</tex-math></disp-formula>
where <italic>P<sub>h</sub></italic> and <italic>P<sub>s</sub></italic> are the polymorphisms present in the reconstructed haplotype and its most similar true counterpart, respectively.</p>
        <p>To test the extent to which the true frequencies of the reconstructed haplotypes could be inferred, we used the mean absolute error (MAE) between the true frequencies at which a haplotypes occurred (<italic>y<sub>i</sub></italic>) in the simulated population and the estimated frequencies of the matching reconstructed haplotypes (<inline-formula><tex-math id="M36">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\hat y_i$\end{document}</tex-math></inline-formula>) divided by the number of true haplotypes (<italic>N</italic>).
<disp-formula><tex-math id="M37">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}\begin{equation*} MAE = \frac{1}{N}\sum {(|y_i - \hat y_i |)} \end{equation*}\end{document}</tex-math></disp-formula></p>
      </sec>
      <sec id="SEC2-2-2">
        <title>Comparison with state-of-the-art haplotype reconstruction methods</title>
        <p>To perform a comparison with ShoRAH (<xref rid="B11" ref-type="bibr">11</xref>), QuasiRecomb (<xref rid="B16" ref-type="bibr">16</xref>) and Predicthaplo (<xref rid="B15" ref-type="bibr">15</xref>) we simulated a second set, this time consisting of raw population sequence data (as we need an alignment file as input for each of the respective algorithms we compared with). Raw data sets were generated using GemSIM v1.6 (<xref rid="B20" ref-type="bibr">20</xref>), derived from a single gene of 2562 bp long, flanked on both sides by 700 bp regions. The number of haplotypes ranged between 2 and 4. The number of polymorphisms in the simulation was varied between 7, 10, 20 and 50. The same phylogenetic approach mentioned above was used to generate evolutionary related haplotypes. Raw data mimicked 100 and 700 bp reads, produced under respectively an Illumina and a Roche 454 error model provided by the simulator. The coverage varied between 50, 100, 200 and 500. One hundred (100) data sets were generated for each combination of parameters. Note that we focused on simulating one gene rather than a full bacterial genome in order to design a set up optimized for the state-of-the-art methods we intended to compare with (as these cannot handle a genome-wide haplotype reconstruction).</p>
        <p>The latest version of ShoRAH was downloaded from: <ext-link ext-link-type="uri" xlink:href="http://www.bsse.ethz.ch/cbg/software/shorah">http://www.bsse.ethz.ch/cbg/software/shorah</ext-link>. ShoRAH was run according to the authors’ recommendations with a window size that is about one third of the read length, i.e. with a window of 30 bp for simulations with a read length of 100 bp reads and of 252 bp for simulations with read lengths of 700 bp. The latest version of PredictHaplo was obtained from: <ext-link ext-link-type="uri" xlink:href="http://bmda.cs.unibas.ch/HivHaploTyper/">http://bmda.cs.unibas.ch/HivHaploTyper/</ext-link>. In our hands, most of the simulated data sets could not be processed with PredictHaplo, preventing us from comparing its performance with that of the other methods. The latest version of QuasiRecomb was obtained from: <ext-link ext-link-type="uri" xlink:href="http://www.silva.bsse.ethz.ch/cbg/software/quasirecomb">http://www.silva.bsse.ethz.ch/cbg/software/quasirecomb</ext-link>. The method was run with flags ‘noRecomb’, ‘conservative’ and ‘unpaired’ as recommended by the authors for a comparable setting. All tools were run on the same simulated data sets.</p>
      </sec>
    </sec>
    <sec id="SEC2-3">
      <title>Haplotype reconstruction to infer evolutionary trajectories</title>
      <p>The data used for haplotype reconstruction during bacterial evolution were generated as follows: <italic>Escherichia coli</italic> SX4 was grown under selective pressure (high concentration of ethanol) in a serial transfer experiment in which the concentration of ethanol was gradually increased over time (0.5% each time) as soon as the population resumed growth under a current selection pressure. At three consecutive time points, population samples and individual clones, selected from these sampled populations were subjected to Illumina sequencing HiSeq2000 (using 100 bp paired end read mode, with a coverage of approximately 200-fold for the population samples). Sampling and DNA isolation were done according to standard procedures (Qiagen® Blood &amp; Tissue kit). Sequences are stored under BioProject PRJNA262000. Read mapping of both the sequenced pooled samples and individual clones was performed with Burrows–Wheeler Aligner BWA-MEM using the sequence of the original unevolved ancestral clone as a reference. For the sampled clones variants were called after alignment using SAMtools (<xref rid="B21" ref-type="bibr">21</xref>) with default parameters. As a control we confirmed that the called variants were also obtained using the CLC Bio pipeline (<ext-link ext-link-type="uri" xlink:href="http://www.clcbio.com">http://www.clcbio.com</ext-link>) with default parameters.</p>
      <p>The true haplotypes of the individual clones sampled from the pool were compared with the haplotypes reconstructed from the pooled data. To this end we calculated the ratio of the number of polymorphisms shared between an individual clone and its best matching reconstructed haplotype versus their total number of polymorphisms. Polymorphisms that reached fixation in the population were not taken into account as they are present in all haplotypes and therefore not informative.</p>
      <p>The phylogenetic relations between the haplotypes reconstructed at different time points was inferred using a Levenshtein distance measure between a haplotype observed at a current time point and the ones observed at the closest preceding time point, hereby assuming that the closest haplotype in the preceding time point is the evolutionary ancestor of the haplotype observed at the current time point.</p>
    </sec>
    <sec id="SEC2-4">
      <title>Haplotype reconstruction to identify mixed infections</title>
      <p>Publicly available read mapping data of in-vitro mixed infections were obtained from Eyre et al. (<xref rid="B22" ref-type="bibr">22</xref>). They generated 36 mixed infections by pairwisely combining the DNA obtained from different clones in three different proportions—50%/50%, 70%/30% and 90%/10%. For each proportion 12 mixed infections were generated, each consisting of different pairwise combinations of clones. The pools of the <italic>in vitro</italic> generated mixed infections were subjected to Illumina sequencing at 150-fold coverage. We performed a genome-wide reconstruction using all variant loci detected in the population sequencing data of the mixed infection and, as an alternative, we also performed a reconstruction by using a preselected set of 151 polymorphic sites present in 3 different genes as outlined in Eyre et al. (<xref rid="B22" ref-type="bibr">22</xref>). For both reconstructions the root-mean-square error (RMSE) was calculated to assess the correctness of predicting the correct haplotype frequencies in the mixed infection. We use the RMSE rather than the above mentioned MAE to be consistent with the original paper of Eyre et al. (<xref rid="B22" ref-type="bibr">22</xref>). The reliability of the reconstruction was assessed as described in section ‘performance assessment’ by comparing the polymorphisms present in the reconstructed haplotypes with the polymorphisms observed in the sequences of the single clones.</p>
    </sec>
  </sec>
  <sec sec-type="results" id="SEC3">
    <title>RESULTS</title>
    <p>Our method consist of two steps: a first step comprising a local haplotype reconstruction followed by a window extension, in which haplotypes are defined at the local level, sequencing errors are removed and overlapping regions sharing polymorphisms are extended into longer haplotypes; a second genome-wide reconstruction, during which the final haplotypes and their relative frequencies are inferred by using the frequency observations of the extended haplotypes.</p>
    <p>Based on concepts developed in the context of viral haplotype reconstruction (<xref rid="B11" ref-type="bibr">11</xref>,<xref rid="B12" ref-type="bibr">12</xref>,<xref rid="B15" ref-type="bibr">15</xref>,<xref rid="B16" ref-type="bibr">16</xref>), the first step of our method performs the error correction simultaneously with the haplotype inference on a local scale (Figure <xref ref-type="fig" rid="F1">1A</xref> and <xref ref-type="fig" rid="F1">B</xref>). The local scale is defined by a set of consecutive polymorphic sites that map on a single genomic region of the reference genome and that are ‘covered’ by a sufficient number of reads (referred to as a window). The simultaneous estimation of the sequence errors with the local haplotype inference is based on a method that iterates between assigning reads to haplotypes and using these read-to-haplotype assignments to infer the probabilities that either the observed reads were the result of random sequence error or originated through mutations in the ancestral genome. We used information contained in BLOSUM substitution matrices to lower the allowance of mutations in coding regions, occurring rarely in nature. This local reconstruction step results per genomic window in haplotypes and their observed frequencies in the pooled sample (referred to as local haplotypes, consistent with the literature (<xref rid="B10" ref-type="bibr">10</xref>)). Subsequently, these local haplotypes are extended using a heuristic approach that takes into account both phasing information in the non-empty read overlap between flanking windows, and also the inferred local haplotype frequencies. Because of the sparse number of expected segregating sites between the individuals in the population, the haplotype extension step results in slightly larger contigs, but rarely covers more than a few hundred base pairs.</p>
    <p>Therefore, in the second step, referred to as the genome-wide haplotype reconstruction, extended haplotypes are joined into genome-wide haplotypes that ideally cover a full haplotype in the population (Figure <xref ref-type="fig" rid="F1">1C</xref>). This step is entirely dependent on the frequency information of the extended haplotypes: sets of extended haplotypes that occur at a similar frequency in the population and that do not show any inconsistencies in their polymorphisms (i.e. do not have a different mutation at exactly the same genomic position) are assumed to belong to the same genome-wide haplotypes. This genome-wide haplotype reconstruction step is solved by first estimating sets of locally extended haplotypes that occur at a similar frequency and subsequently searching for the set of genome-wide haplotypes and their frequencies that best explain the observed frequencies of the extended haplotypes. This latter step assumes that the haplotypes in the population have developed by clonal reproduction from a common ancestor and therefore haplotype sets that are shared by at least two genome-wide haplotypes should occur at a frequency in the population that approximates the sum of the frequencies of each of the individual genome-wide haplotypes containing the shared haplotype set.</p>
    <sec id="SEC3-1">
      <title>Performance of EVORhA on simulated data</title>
      <p>To test the performance of EVORhA in reconstructing haplotypes, whole genome sequencing data sets were simulated for clonal populations, differing from each other in the number of haplotypes (ranging from 2–7), the frequencies at which the haplotypes occur in each of these populations, the number of polymorphisms (ranging between 100, 1000 and 2500) and the sequencing coverage (ranging between 50-, 200- and 500-fold). For each simulation setting, 100 simulations were performed.</p>
      <p>To assess the reliability of the reconstruction, we compared the reconstructed haplotypes with the simulated ones. At the same time we assessed the ability of the reconstruction to correctly estimate the true frequencies at which the haplotypes occurred in the population. As expected, the reliability of the reconstruction increases with the coverage and this effect was most pronounced for haplotypes occurring at low frequencies (Figure <xref ref-type="fig" rid="F2">2A</xref>), as especially for those haplotypes an increase in coverage has a relatively larger effect on the ability to distinguish a true polymorphism from a sequencing error. Figure <xref ref-type="fig" rid="F2">2A</xref> also shows that even at low coverage (50-fold), haplotypes were reconstructed with an average reliability of 70%. For the same coverage the performance improves with a decrease in the complexity of the pool (less polymorphisms and less haplotypes), with a maximum of 92% in average reliability observed for the least complex problem (100 polymorphisms, 2 haplotypes, at the highest coverage of 500-fold) (Supplementary Figure S4).</p>
      <fig id="F2" position="float">
        <label>Figure 2.</label>
        <caption>
          <p>Reliability of haplotype reconstruction by EVORhA on simulated data. The X-axis displays the different combinations of coverage (respectively 50, 200, 500) and number of polymorphisms in the population (respectively 100, 1000, 2500) used for each simulated set up, hereby collapsing the results obtained for simulations with a different number of haplotypes (for the uncollapsed results see Supplementary Figure S4). The degree to which the simulated haplotypes was correctly reconstructed was assessed by the reliability. The correctness of the frequency estimation of the reconstructed haplotypes was assessed by the MAE. (<bold>A</bold>) Average reliability of the haplotype reconstruction, derived by either considering the results of all reconstructed haplotypes (dark bars) or only the results obtained for haplotypes that occur in the population at a frequency below 5% (light bars). Y-axis: average reliability; values are obtained by averaging the reliability scores of the considered haplotypes resulting from simulations obtained with the same coverage and same number of polymorphisms, irrespective of the number of haplotypes (so showing the average reliability of haplotypes obtained from 500 simulations). Error bars indicate the 90% confidence interval of the reconstruction. (<bold>B</bold>) Y-axis: MAE of the frequency estimation of all haplotypes resulting from simulations obtained with the same coverage and same number of polymorphisms, irrespective of the number of the haplotypes (see panel (A)). Error bars indicate the MAE 90% confidence interval.</p>
        </caption>
        <graphic xlink:href="gkv478fig2"/>
      </fig>
      <p>Supplementary Figure S4 shows for the different simulated set ups, the degree to which EVORhA could correctly estimate the true haplotype frequencies in the population (expressed by the MAE). The ability to estimate true frequencies seems largely independent of the number of haplotypes in the population or the number of polymorphisms. The latter is to be expected as the total number of polymorphisms in the simulation is sparse anyhow and does confer little information to the final frequency estimation. Figure <xref ref-type="fig" rid="F2">2B</xref> shows how the true frequency estimation is largely affected by the coverage: when the coverage is low (50-fold), the average error rate on estimating the true frequency of the haplotypes is around 10%. This is understandable given that at low coverage the sampling that produces the reads is more prone to random effects.</p>
    </sec>
    <sec id="SEC3-2">
      <title>Comparison of EVORhA with state-of-the-art haplotype reconstruction</title>
      <p>Because our method builds for its initial step on concepts that were first described in the context of viral haplotype reconstruction, we compared our tool with state-of-the-art viral haplotype reconstruction tools. As representatives of read-graph based tools we used ShoRAH (<xref rid="B11" ref-type="bibr">11</xref>) and QuasiRecomb (<xref rid="B16" ref-type="bibr">16</xref>), both widely used for viral haplotype reconstruction. In addition, we used PredictHaplo (<xref rid="B15" ref-type="bibr">15</xref>) as a representative of probabilistic haplotype reconstruction methods.</p>
      <p>As none of the above mentioned viral haplotype reconstruction tools (ShoRAH, QuasiRecomb and PredictHaplo) was able to run in the bacterial setting, we compared our method in a setting more appropriate for these state-of-the-art tools (reconstruction of viral sized haplotypes in the presence of a large number of polymorphisms). Hereto, we designed a simulation experiment, mimicking the data resulting from the population sequencing of a small region obtained with either a relatively short or long read sequencing technology (respectively mimicking Illumina and Roche 454 reads). Simulated populations differed from each other in the number of haplotypes (ranging from 2 to 4), the used sequence coverage (50-, 100-, 200- and 500-fold) and the number of polymorphisms in the population (7, 10, 20 and 50 sites). For each experimental setup 100 different data sets were simulated and performances of respectively EVORhA, ShoRAH and QuasiRecomb were assessed as outlined above and in the material and methods.</p>
      <p>Figure <xref ref-type="fig" rid="F3">3</xref> shows that in general, and irrespective of the read length used for sequencing, using an increased sequencing coverage and having intrinsically more polymorphic sites in the population positively influences the performance of all methods, mainly in terms of reliability i.e. correctly reconstructing the true haplotypes in the population. Only for ShoRAH the reconstruction reliability seems to decrease with the coverage in case haplotypes were obtained from populations with few polymorphisms (&lt;10).</p>
      <fig id="F3" position="float">
        <label>Figure 3.</label>
        <caption>
          <p>Performance comparison of EVORhA, ShoRAH and QuasiRecomb on simulated data. (<bold>A</bold>) Comparison of the reconstruction reliability using long read sequencing (700 bp), hereby collapsing the results obtained for simulations with a different number of haplotypes. Data sets were obtained by simulating long read sequencing. The X-axis displays the different combinations of coverage (respectively 50, 100, 200, 500) and number of polymorphisms in the population (respectively 7, 10, 20, 50) used for each experimental set up. The Y-axis shows the average reliability of the reconstruction. Bars indicate the performance per method. Reliability values are obtained by averaging the reliability scores of all haplotypes resulting from simulations obtained with the same coverage and same number of polymorphic sites, irrespective of the number of haplotypes. Error bars indicate the 90% confidence interval of the reconstruction. (<bold>B</bold>) Comparison of the frequency estimation of the haplotypes using long read sequencing. Experimental set up and legend as in panel (A) except for the Y-axis which displays the MAE of the frequency estimation for all haplotypes resulting from simulations obtained with the same coverage and same number of polymorphic sites, irrespective of the number of haplotypes. Error bars indicate the MAE 90% confidence interval. (<bold>C</bold>) Comparison of the reconstruction reliability using short read sequencing (100 bp). Legend and experimental set up as in panel (A), but displaying results obtained on data simulating short reads. (<bold>D</bold>) Comparison of the reconstruction reliability using short read sequencing. Legend and experimental set up as in panel (B), but displaying results obtained on data simulating short reads.</p>
        </caption>
        <graphic xlink:href="gkv478fig3"/>
      </fig>
      <p>For relatively long reads (700 bp), EVORhA reaches performances similar to those of QuasiRecomb and ShoRAH: in the tested setting the reconstruction reliability obtained with QuasiRecomb was slightly higher than the one obtained with EVORhA, but this came at the expense of QuasiRecomb having a relatively lower performance in terms of the frequency estimation (relatively higher MAE) than EVORhA.</p>
      <p>For shorter reads (100 bp) EVORhA consistently outperforms QuasiRecomb and ShoRAH, both in terms of having a higher reconstruction reliability and having a better frequency estimation.</p>
    </sec>
    <sec id="SEC3-3">
      <title>Haplotype reconstruction to reconstruct evolutionary trajectories</title>
      <p>To test EVORhA in a real setting, we reconstructed haplotypes from pooled sequencing data of population samples, taken during an evolution experiment. In this experiment a lab <italic>E. coli</italic> strain was subjected to high ethanol concentrations and growth in the presence of ethanol, referred to as ethanol tolerance was estimated as a focal phenotype. The trajectory of the population phenotype clearly showed that after about 100 days, the cell's ethanol tolerance steadily increased from 7% to 7.5% after which a plateau was reached (Figure <xref ref-type="fig" rid="F4">4A</xref>). To evaluate the evolutionary trajectories of the haplotypes during this switch in the population phenotype, samples were taken at three consecutive time points: at T0, the beginning of a 40 days stationary phase when no increased tolerance against ethanol was observed yet, at T1 right before the phenotypic switch and at T2 the focal end point after which no further increase in ethanol tolerance was observed (Figure <xref ref-type="fig" rid="F4">4A</xref>). Population samples were subjected to Illumina pooled sequencing and applying EVORhA to the data obtained for each of the pooled samples allowed reconstructing per population its composition i.e. the different haplotypes that were present and the frequencies at which they were present in the respective populations. As haplotypes present in consecutive time points are related to each other through their common ancestry, the phylogenetic relations between the reconstructed haplotypes was inferred, the evolutionary history is represented by means of a concept map using CmapTools (<xref rid="B23" ref-type="bibr">23</xref>) (Figure <xref ref-type="fig" rid="F4">4B</xref>).</p>
      <fig id="F4" position="float">
        <label>Figure 4.</label>
        <caption>
          <p>Haplotype reconstruction to infer evolutionary trajectories. (<bold>A</bold>) shows the phenotypic trajectory of a population during an evolution experiment in which <italic>E. coli</italic> strains were subjected to increasing ethanol concentrations. The measured focal phenotype is the ethanol tolerance of the population (i.e. the % of ethanol at which growth still occurs). Arrows indicate the time points at which population samples were taken that were subjected to sequencing and haplotype reconstruction. Y-axis indicates the % of Ethanol to which the population was subjected. (<bold>B</bold>) concept map illustrating the evolutionary relations between the haplotypes reconstructed from each of sampled time points described in panel (A). Ref indicates the unevolved parental strain of which the genomic sequence was used as a reference. TP0, TP1 and TP2 represent the 3 time points at which population samples were taken (see panel (A)), i.e. TP0 is Time Point Zero (0). Each square corresponds to a different reconstructed haplotype and ‘%’ indicates the frequency at which this haplotype was estimated to occur in the population. Arrows indicate the phylogenetic relatedness between the reconstructed haplotypes (or ancestry). Indicated with a lighter gray border are the reconstructed haplotypes that best match the individual clones, sampled at each time point.</p>
        </caption>
        <graphic xlink:href="gkv478fig4"/>
      </fig>
      <p>To verify the correctness of the haplotype reconstruction, we sampled and sequenced one clone per time point and determined their polymorphisms. Per time point each sampled clone was assigned to its ‘best matching reconstructed haplotype’ based on a minimal number of inconsistencies between polymorphisms of the sampled clone and polymorphisms present in the inferred haplotypes. At TP0, the genome of the sampled clone contained 296 polymorphisms that were still rising to fixation in the population. 295 of these polymorphisms could uniquely be assigned to one of the reconstructed haplotypes (i.e. with a reliability of 99.7%). At TP1 the sampled clone contained 152 polymorphisms rising to fixation in the population, of which 151 could uniquely be assigned to a reconstructed haplotype (with 99.3% reliability). At TP2, the sequenced clone contained 122 polymorphisms still rising to fixation in the population of which 111 could uniquely be assigned (with 91% reliability). The haplotypes best matching the genomic sequences of the sampled clones are indicated in Figure <xref ref-type="fig" rid="F4">4B</xref>.</p>
      <p>Although the sampled clones did most often correspond to the haplotypes that were high in frequency at the time of sampling, reconstructing the evolutionary trajectory of the focal end point clone would not have been possible using the sequence information from the sampled clones only. This because, although phenotypically the population undergoes a clear increase in ethanol tolerance (Figure <xref ref-type="fig" rid="F4">4A</xref>), it remains at each single time point largely heterogeneous (Figure <xref ref-type="fig" rid="F4">4B</xref>). The two haplotypes dominating at TP0, before the sweep with a frequency of respectively 31% and 37%, of which one was sampled as an individual clone, seem to have been dead ends and therefore were not ancestral. In contrast, a minor haplotype rapidly increasing in frequency between TP0 and TP1 (from 9% to 44%) took over the population and eventually gave rise to all haplotypes at TP2, the focal end point.</p>
      <p>Note that in Figure <xref ref-type="fig" rid="F4">4B</xref>, frequencies inferred at a single time point do not sum to one. This because, we intentionally choose to only perform a partial haplotype reconstruction in case the genome-wide reconstruction was still ambiguous (if a haplotype set occurs at a low frequency and has no conflicts with more than one haplotypes occurring at higher frequency, we have insufficient information to decide to which genome-wide haplotype the haplotype set at low frequency belongs).</p>
    </sec>
    <sec id="SEC3-4">
      <title>Haplotype reconstruction to identify mixed infections</title>
      <p>Currently, tracing the origin of an infectious disease during an outbreak is based on determining the genetic similarity between individual strains sampled from different infected entities (individuals), hereby assuming that the contaminating population isolated from each entity is largely homogenous. However, in case of mixed infections such approach might fail (<xref rid="B22" ref-type="bibr">22</xref>) unless the different contaminators within one individual can be disentangled.</p>
      <p>To assess the applicability of EVORhA in identifying mixed infections, we used the benchmark data generated by Eyre et al. (<xref rid="B22" ref-type="bibr">22</xref>). These authors mimicked <italic>in vitro</italic> 36 mixed <italic>Clostridium difficile</italic> infections by pairwisely combining in different proportions (50%/50%, 70%/30% and 90%/10%) DNA extracted from single clones. We reconstructed genome-wide haplotypes from the Illumina based sequence data of these mixed samples. To this end, we used EVORhA either in combination with ‘all’ polymorphisms detected in the population or as an alternative, and consistent with the original approach described in Eyre et al., in combination with a preselected set of polymorphisms a priori known to be discriminative for the haplotypes in the mixture (<xref rid="B22" ref-type="bibr">22</xref>). Also here, the reliability of the haplotype reconstruction was assessed by comparing the reconstructed genomes with the ones known to be present in the mixtures. The correctness of the inferred haplotype frequencies was assessed by the RMSE. Results for the reconstruction are displayed in Figure <xref ref-type="fig" rid="F5">5</xref>.</p>
      <fig id="F5" position="float">
        <label>Figure 5.</label>
        <caption>
          <p>Haplotype reconstruction to identify mixed infections. (<bold>A</bold>) Reliability of the haplotype reconstruction of the mixed infection set up when using a selection of polymorphisms. The X-axis contains the three different <italic>in vitro</italic> proportions at which the mixed infection set ups were generated (50–50%, 30–70% and 10–90%). For each of the three proportions, 12 mixtures were obtained by mixing two different clonal DNA samples according to the indicated frequencies. The Y-axis indicates the average reliability of the two reconstructed haplotypes compared to the known haplotypes at the polymorphic sites. (<bold>B</bold> and <bold>C</bold>) Correctness of the frequency estimation in the mixed infection set up. For panels (B) and (C) the X-axis represents the known frequency of this haplotype in the mixture, whereas the Y-axis represents the estimated frequencies of the most frequent haplotype in each combination (the least frequent haplotype is not displayed as it would have a frequency of 1—the shown frequency). (B) Correctness of the frequency estimation based on a haplotype reconstructing using the 151 selected polymorphisms only (RMSE = 0.037, MAE = 0.030). (C) Correctness of the frequency estimation based on a haplotype reconstructing using all polymorphisms (RMSE = 0.047, MAE = 0.038).</p>
        </caption>
        <graphic xlink:href="gkv478fig5"/>
      </fig>
      <p>For both approaches, it is clear that reconstructing haplotypes from a mixed infection improves if the haplotypes in the mixture occur at different frequencies (such as observed at 90%/10% or 70%/30%). This is reflected by the high reliabilities (Figure <xref ref-type="fig" rid="F5">5A</xref>) and good frequency estimates (Figure <xref ref-type="fig" rid="F5">5B</xref> and <xref ref-type="fig" rid="F5">C</xref>) obtained at these frequency ratios in the mixture. This is not unexpected as in this bacterial setting (low mutation frequency) the haplotype reconstruction largely relies on the frequency information: the more the frequencies differ between the haplotypes in the mixture, the more discriminative this feature is in assigning polymorphisms to correct haplotypes. Although in 50%/50% mixtures many ambiguous assignments are expected to occur, resulting in the lowering of the reconstruction reliability, it is remarkable that EVORhA is still able to reconstruct the haplotypes relatively well in the 50%/50% mixture (a reliability of at least 85% which is significantly higher than what would be expected from randomly combining contigs occurring at 50% into two haplotypes). At the given sequencing coverage, the mixture model underlying EVORhA seems to have a rather high resolution (allowing to separate a haplotype occurring at 53% from a haplotype occurring at 47%). Although this deviation from 50% is now penalized in the RMSE, which assumes that in the <italic>in vitro</italic> mixed sample the haplotypes truly occur at 50%/50%, experimental and sampling biases might have resulted in the inferred small deviations of this intended 50%/50%. Despite being very small, these frequency deviations can still be captured by the haplotype reconstruction, resulting in a correct reconstruction.</p>
    </sec>
  </sec>
  <sec sec-type="discussion" id="SEC4">
    <title>DISCUSSION</title>
    <p>In this work we present EVORhA, a method for reconstructing haplotypes from deep sequencing data of clonal populations that have a relatively low mutation rate, such as bacteria.</p>
    <p>Haplotype reconstruction in general is complicated because polymorphisms of infrequent haplotypes are difficult to distinguish from sequencing errors. The solution to this problem, referred to as local haplotype reconstruction has been proposed in the context of viral haplotype reconstruction and relies on simultaneously, rather than sequentially identifying sequencing errors and reconstructing haplotypes (<xref rid="B11" ref-type="bibr">11</xref>–<xref rid="B16" ref-type="bibr">16</xref>). EVORhA uses a local haplotype reconstruction based on similar principles, but in addition exploits the information contained in a BLOSUM matrix to better distinguish true polymorphisms from likely sequencing errors.</p>
    <p>In contrast to viral reconstruction, however, in our bacterial setting read lengths are short compared to the average distance between polymorphic sites. This prevents us from using viral haplotype reconstruction approaches to infer bacterial haplotypes, because in order to extend locally inferred haplotypes into more global ones, all viral methods rely on the presence of a sufficient number of segregating sites to reconstruct haplotypes from phasing information (<xref rid="B10" ref-type="bibr">10</xref>).</p>
    <p>Key to our method, therefore, is the use of the frequency ratios of the inferred haplotypes, not only to improve the extension of haplotypes for which the non-empty overlap between flanking windows results in an ambiguous phasing (i.e. the window extension) (<xref rid="B17" ref-type="bibr">17</xref>), but also to further link distant phased regions that have no sequence overlap at all (i.e. during the genome-wide reconstruction step).</p>
    <p>As was shown on the simulated data, as soon as read lengths and/or mutation rates become restrictive for state-of-the-art methods, the additional frequency information, mainly through the genome-wide reconstruction step allows EVORhA to still reliably reconstruct haplotypes.</p>
    <p>This frequency-based genome-wide reconstruction is also the key enabling step to resolve the bacterial haplotypes in the real data applications. This step, based on using a mixture model assumes that locally extended haplotypes observed at similar frequencies are likely to belong to the same global haplotype. This assumption gets violated however, if two haplotypes occur at similar frequencies, in which case the haplotype reconstruction might result in hybrids. However, our results on the mixed infection data set showed that even marginal frequency deviations between haplotypes allow the mixture model to resolve these haplotypes with high accuracy, provided the sequencing coverage of the sample is sufficiently high.</p>
    <p>As was shown in the results, sequencing coverage highly impacts the reconstruction performance of EVORhA: at first indirectly because it affects the correctness of the reference-based assembly which is used as input. More directly because a too low coverage complicates distinguishing sequencing errors from true polymorphisms. In addition, the coverage determines the maximum number of haplotypes that can be detected. This is mainly because the standard deviation used when inferring the mixture model is dependent on the coverage, i.e. a lower coverage implies larger standard deviations of the Gaussian distributions of the mixture model which may cause haplotypes occurring at similar frequencies to become confounded.</p>
    <p>Conclusively, EVORhA, by enabling bacterial haplotype reconstruction opens a whole new area of applications for bacterial population sequencing (or metagenome sequencing). As was illustrated by the real data examples, bacterial haplotype reconstruction can aid in resolving mixed infections or in reconstructing the dynamics of evolving clonal populations. In addition, it can potentially be useful to further resolve genomes from reads with similar sequence composition in bacterial metagenomics data sets of which the complexity has been reduced with binning approaches (<xref rid="B24" ref-type="bibr">24</xref>–<xref rid="B26" ref-type="bibr">26</xref>).</p>
    <p>Haplotype reconstruction thus provides a quick view on the composition of a mixed sample and allows pinpointing haplotypes with interesting characteristics that can be further focused on by downstream molecular analysis.</p>
  </sec>
  <sec sec-type="supplementary-material" id="SEC5">
    <title>SUPPLEMENTARY DATA</title>
    <p><ext-link ext-link-type="uri" xlink:href="http://nar.oxfordjournals.org/lookup/suppl/doi:10.1093/nar/gkv478/-/DC1">Supplementary Data</ext-link> are available at NAR Online.</p>
    <supplementary-material id="PMC_1" content-type="local-data">
      <caption>
        <title>SUPPLEMENTARY DATA</title>
      </caption>
      <media mimetype="text" mime-subtype="html" xlink:href="supp_43_16_e105__index.html"/>
      <media xlink:role="associated-file" mimetype="application" mime-subtype="msword" xlink:href="supp_gkv478_nar-00532-met-n-2015-File007.docx"/>
      <media xlink:role="associated-file" mimetype="application" mime-subtype="pdf" xlink:href="supp_gkv478_nar-00532-met-n-2015-File008.pdf"/>
      <media xlink:role="associated-file" mimetype="application" mime-subtype="pdf" xlink:href="supp_gkv478_nar-00532-met-n-2015-File009.pdf"/>
      <media xlink:role="associated-file" mimetype="application" mime-subtype="pdf" xlink:href="supp_gkv478_nar-00532-met-n-2015-File010.pdf"/>
      <media xlink:role="associated-file" mimetype="application" mime-subtype="pdf" xlink:href="supp_gkv478_nar-00532-met-n-2015-File011.pdf"/>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <p>We are grateful to J. Vanderleyden for the useful discussions and two anonymous reviewers for their useful comments.</p>
  </ack>
  <sec id="SEC6">
    <title>FUNDING</title>
    <p>Ghent University Multidisciplinary Research Partnership ‘Bioinformatics: from nucleotides to networks’; Fonds Wetenschappelijk Onderzoek-Vlaanderen (FWO) G.0329.09, G0A5315N; Agentschap voor Innovatie door Wetenschap en Technologie (IWT): NEMOA; PF/10/010 (NATAR); Universidad Técnica Particular de Loja, SmartLand initiative PROY_CCNN_849. Funding for open access charge: PF/10/010 (NATAR).</p>
    <p><italic>Conflict of interest statement</italic>. None declared.</p>
  </sec>
  <ref-list>
    <title>REFERENCES</title>
    <ref id="B1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pfennig</surname>
            <given-names>D.W.</given-names>
          </name>
          <name>
            <surname>Wund</surname>
            <given-names>M.A.</given-names>
          </name>
          <name>
            <surname>Snell-Rood</surname>
            <given-names>E.C.</given-names>
          </name>
          <name>
            <surname>Cruickshank</surname>
            <given-names>T.</given-names>
          </name>
          <name>
            <surname>Schlichting</surname>
            <given-names>C.D.</given-names>
          </name>
          <name>
            <surname>Moczek</surname>
            <given-names>A.P.</given-names>
          </name>
        </person-group>
        <article-title>Phenotypic plasticity's impacts on diversification and speciation</article-title>
        <source>Trends Ecol. Evol.</source>
        <year>2010</year>
        <volume>25</volume>
        <fpage>459</fpage>
        <lpage>467</lpage>
        <pub-id pub-id-type="pmid">20557976</pub-id>
      </element-citation>
    </ref>
    <ref id="B2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hayden</surname>
            <given-names>E.J.</given-names>
          </name>
          <name>
            <surname>Ferrada</surname>
            <given-names>E.</given-names>
          </name>
          <name>
            <surname>Wagner</surname>
            <given-names>A.</given-names>
          </name>
        </person-group>
        <article-title>Cryptic genetic variation promotes rapid evolutionary adaptation in an RNA enzyme</article-title>
        <source>Nature</source>
        <year>2011</year>
        <volume>474</volume>
        <fpage>92</fpage>
        <lpage>95</lpage>
        <pub-id pub-id-type="pmid">21637259</pub-id>
      </element-citation>
    </ref>
    <ref id="B3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Barrick</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Lenski</surname>
            <given-names>R.</given-names>
          </name>
        </person-group>
        <article-title>Genome-wide mutational diversity in an evolving population of Escherichia coli</article-title>
        <source>Cold Spring Harb Symp Quant Biol</source>
        <year>2009</year>
        <volume>74</volume>
        <fpage>119</fpage>
        <lpage>129</lpage>
        <pub-id pub-id-type="pmid">19776167</pub-id>
      </element-citation>
    </ref>
    <ref id="B4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lang</surname>
            <given-names>G.I.</given-names>
          </name>
          <name>
            <surname>Botstein</surname>
            <given-names>D.</given-names>
          </name>
          <name>
            <surname>Desai</surname>
            <given-names>M.M.</given-names>
          </name>
        </person-group>
        <article-title>Genetic variation and the fate of beneficial mutations in asexual populations</article-title>
        <source>Genetics</source>
        <year>2011</year>
        <volume>188</volume>
        <fpage>647</fpage>
        <lpage>661</lpage>
        <pub-id pub-id-type="pmid">21546542</pub-id>
      </element-citation>
    </ref>
    <ref id="B5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kao</surname>
            <given-names>K.C.</given-names>
          </name>
          <name>
            <surname>Sherlock</surname>
            <given-names>G.</given-names>
          </name>
        </person-group>
        <article-title>Molecular characterization of clonal interference during adaptive evolution in asexual populations of Saccharomyces cerevisiae</article-title>
        <source>Nat. Genet.</source>
        <year>2008</year>
        <volume>40</volume>
        <fpage>1499</fpage>
        <lpage>1504</lpage>
        <pub-id pub-id-type="pmid">19029899</pub-id>
      </element-citation>
    </ref>
    <ref id="B6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Heywood</surname>
            <given-names>J.L.</given-names>
          </name>
          <name>
            <surname>Sieracki</surname>
            <given-names>M.E.</given-names>
          </name>
          <name>
            <surname>Bellows</surname>
            <given-names>W.</given-names>
          </name>
          <name>
            <surname>Poulton</surname>
            <given-names>N.J.</given-names>
          </name>
          <name>
            <surname>Stepanauskas</surname>
            <given-names>R.</given-names>
          </name>
        </person-group>
        <article-title>Capturing diversity of marine heterotrophic protists: one cell at a time</article-title>
        <source>ISME J.</source>
        <year>2011</year>
        <volume>5</volume>
        <fpage>674</fpage>
        <lpage>684</lpage>
        <pub-id pub-id-type="pmid">20962875</pub-id>
      </element-citation>
    </ref>
    <ref id="B7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Stepanauskas</surname>
            <given-names>R.</given-names>
          </name>
        </person-group>
        <article-title>Single cell genomics: an individual look at microbes</article-title>
        <source>Curr. Opin. Microbiol.</source>
        <year>2012</year>
        <volume>15</volume>
        <fpage>613</fpage>
        <lpage>620</lpage>
        <pub-id pub-id-type="pmid">23026140</pub-id>
      </element-citation>
    </ref>
    <ref id="B8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lasken</surname>
            <given-names>R.S.</given-names>
          </name>
          <name>
            <surname>McLean</surname>
            <given-names>J.S.</given-names>
          </name>
        </person-group>
        <article-title>Recent advances in genomic DNA sequencing of microbial species from single cells</article-title>
        <source>Nat. Rev. Genet.</source>
        <year>2014</year>
        <volume>15</volume>
        <fpage>577</fpage>
        <lpage>584</lpage>
        <pub-id pub-id-type="pmid">25091868</pub-id>
      </element-citation>
    </ref>
    <ref id="B9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Barrick</surname>
            <given-names>J.E.</given-names>
          </name>
          <name>
            <surname>Lenski</surname>
            <given-names>R.E.</given-names>
          </name>
        </person-group>
        <article-title>Genome dynamics during experimental evolution</article-title>
        <source>Nat. Rev. Genet.</source>
        <year>2013</year>
        <volume>14</volume>
        <fpage>827</fpage>
        <lpage>839</lpage>
        <pub-id pub-id-type="pmid">24166031</pub-id>
      </element-citation>
    </ref>
    <ref id="B10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Beerenwinkel</surname>
            <given-names>N.</given-names>
          </name>
          <name>
            <surname>Günthard</surname>
            <given-names>H.F.</given-names>
          </name>
          <name>
            <surname>Roth</surname>
            <given-names>V.</given-names>
          </name>
          <name>
            <surname>Metzner</surname>
            <given-names>K.J.</given-names>
          </name>
        </person-group>
        <article-title>Challenges and opportunities in estimating viral genetic diversity from next-generation sequencing data</article-title>
        <source>Front. Microbiol.</source>
        <year>2012</year>
        <volume>3</volume>
        <comment>doi:10.3389/fmicb.2012.00329</comment>
      </element-citation>
    </ref>
    <ref id="B11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zagordi</surname>
            <given-names>O.</given-names>
          </name>
          <name>
            <surname>Bhattacharya</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Eriksson</surname>
            <given-names>N.</given-names>
          </name>
          <name>
            <surname>Beerenwinkel</surname>
            <given-names>N.</given-names>
          </name>
        </person-group>
        <article-title>ShoRAH: estimating the genetic diversity of a mixed sample from next-generation sequencing data</article-title>
        <source>BMC Bioinformatics</source>
        <year>2011</year>
        <volume>12</volume>
        <comment>doi:10.1186/1471-2105-12-119</comment>
      </element-citation>
    </ref>
    <ref id="B12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Astrovskaya</surname>
            <given-names>I.</given-names>
          </name>
          <name>
            <surname>Tork</surname>
            <given-names>B.</given-names>
          </name>
          <name>
            <surname>Mangul</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Westbrooks</surname>
            <given-names>K.</given-names>
          </name>
          <name>
            <surname>Măndoiu</surname>
            <given-names>I.</given-names>
          </name>
          <name>
            <surname>Balfe</surname>
            <given-names>P.</given-names>
          </name>
          <name>
            <surname>Zelikovsky</surname>
            <given-names>A.</given-names>
          </name>
        </person-group>
        <article-title>Inferring viral quasispecies spectra from 454 pyrosequencing reads</article-title>
        <source>BMC Bioinformatics</source>
        <year>2011</year>
        <volume>12</volume>
        <fpage>90</fpage>
        <lpage>101</lpage>
        <pub-id pub-id-type="pmid">21453511</pub-id>
      </element-citation>
    </ref>
    <ref id="B13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Prosperi</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Salemi</surname>
            <given-names>M.</given-names>
          </name>
        </person-group>
        <article-title>QuRe: software for viral quasispecies reconstruction from next-generation sequencing data</article-title>
        <source>Bioinformatics</source>
        <year>2012</year>
        <volume>21</volume>
        <fpage>132</fpage>
        <lpage>133</lpage>
        <pub-id pub-id-type="pmid">22088846</pub-id>
      </element-citation>
    </ref>
    <ref id="B14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Huang</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Kantor</surname>
            <given-names>R.</given-names>
          </name>
          <name>
            <surname>Delong</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Schreier</surname>
            <given-names>L.</given-names>
          </name>
          <name>
            <surname>Istrail</surname>
            <given-names>S.</given-names>
          </name>
        </person-group>
        <article-title>QColors: an algorithm for conservative viral quasispecies reconstruction from short and non-contiguous next generation sequencing reads</article-title>
        <source>IEEE Int. Conf. Bioinforma. Biomed. Work.</source>
        <year>2011</year>
        <volume>11</volume>
        <fpage>193</fpage>
        <lpage>201</lpage>
      </element-citation>
    </ref>
    <ref id="B15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Prabhakaran</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Rey</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Zagordi</surname>
            <given-names>O.</given-names>
          </name>
          <name>
            <surname>Beerenwinkel</surname>
            <given-names>N.</given-names>
          </name>
          <name>
            <surname>Roth</surname>
            <given-names>V.</given-names>
          </name>
        </person-group>
        <article-title>HIV Haplotype Inference Using a Propagating Dirichlet Process Mixture Model</article-title>
        <source>IEEE/ACM Trans. Comput. Biol. Bioinform.</source>
        <year>2013</year>
        <volume>6</volume>
        <fpage>182</fpage>
        <lpage>191</lpage>
      </element-citation>
    </ref>
    <ref id="B16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Töpfer</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Zagordi</surname>
            <given-names>O.</given-names>
          </name>
          <name>
            <surname>Prabhakaran</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Roth</surname>
            <given-names>V.</given-names>
          </name>
          <name>
            <surname>Halperin</surname>
            <given-names>E.</given-names>
          </name>
          <name>
            <surname>Beerenwinkel</surname>
            <given-names>N.</given-names>
          </name>
        </person-group>
        <article-title>Probabilistic inference of viral quasispecies subject to recombination</article-title>
        <source>J. Comput. Biol.</source>
        <year>2013</year>
        <volume>20</volume>
        <fpage>113</fpage>
        <lpage>123</lpage>
        <pub-id pub-id-type="pmid">23383997</pub-id>
      </element-citation>
    </ref>
    <ref id="B17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Töpfer</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Marschall</surname>
            <given-names>T.</given-names>
          </name>
          <name>
            <surname>Bull</surname>
            <given-names>R.A.</given-names>
          </name>
          <name>
            <surname>Luciani</surname>
            <given-names>F.</given-names>
          </name>
          <name>
            <surname>Schönhuth</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Beerenwinkel</surname>
            <given-names>N.</given-names>
          </name>
        </person-group>
        <article-title>Viral quasispecies assembly via maximal clique enumeration</article-title>
        <source>PLoS Comput. Biol.</source>
        <year>2014</year>
        <volume>10</volume>
        <fpage>e1003515</fpage>
        <pub-id pub-id-type="pmid">24675810</pub-id>
      </element-citation>
    </ref>
    <ref id="B18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Di Giallonardo</surname>
            <given-names>F.</given-names>
          </name>
          <name>
            <surname>Töpfer</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Rey</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Prabhakaran</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Duport</surname>
            <given-names>Y.</given-names>
          </name>
          <name>
            <surname>Leemann</surname>
            <given-names>C.</given-names>
          </name>
          <name>
            <surname>Schmutz</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Campbell</surname>
            <given-names>N.K.</given-names>
          </name>
          <name>
            <surname>Joos</surname>
            <given-names>B.</given-names>
          </name>
          <name>
            <surname>Lecca</surname>
            <given-names>M.R.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Full-length haplotype reconstruction to infer the structure of heterogeneous virus populations</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2014</year>
        <volume>42</volume>
        <fpage>e115</fpage>
        <pub-id pub-id-type="pmid">24972832</pub-id>
      </element-citation>
    </ref>
    <ref id="B19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Banerjee</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Merugu</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Dhillon</surname>
            <given-names>I.S.</given-names>
          </name>
          <name>
            <surname>Ghosh</surname>
            <given-names>J.</given-names>
          </name>
        </person-group>
        <article-title>Clustering with Bregman divergences</article-title>
        <source>J. Mach. Learn. Res.</source>
        <year>2005</year>
        <volume>6</volume>
        <fpage>1705</fpage>
        <lpage>1749</lpage>
      </element-citation>
    </ref>
    <ref id="B20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>McElroy</surname>
            <given-names>K.E.</given-names>
          </name>
          <name>
            <surname>Luciani</surname>
            <given-names>F.</given-names>
          </name>
          <name>
            <surname>Thomas</surname>
            <given-names>T.</given-names>
          </name>
        </person-group>
        <article-title>GemSIM: general, error-model based simulator of next-generation sequencing data</article-title>
        <source>BMC Genomics</source>
        <year>2012</year>
        <volume>13</volume>
        <comment>doi:10.1186/1471-2164-13-74</comment>
      </element-citation>
    </ref>
    <ref id="B21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>H.</given-names>
          </name>
          <name>
            <surname>Handsaker</surname>
            <given-names>B.</given-names>
          </name>
          <name>
            <surname>Wysoker</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Fennell</surname>
            <given-names>T.</given-names>
          </name>
          <name>
            <surname>Ruan</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Homer</surname>
            <given-names>N.</given-names>
          </name>
          <name>
            <surname>Marth</surname>
            <given-names>G.</given-names>
          </name>
          <name>
            <surname>Abecasis</surname>
            <given-names>G.</given-names>
          </name>
          <name>
            <surname>Durbin</surname>
            <given-names>R.</given-names>
          </name>
        </person-group>
        <article-title>The Sequence Alignment/Map format and SAMtools</article-title>
        <source>Bioinformatics</source>
        <year>2009</year>
        <volume>25</volume>
        <fpage>2078</fpage>
        <lpage>2079</lpage>
        <pub-id pub-id-type="pmid">19505943</pub-id>
      </element-citation>
    </ref>
    <ref id="B22">
      <label>22.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Eyre</surname>
            <given-names>D.W.</given-names>
          </name>
          <name>
            <surname>Cule</surname>
            <given-names>M.L.</given-names>
          </name>
          <name>
            <surname>Griffiths</surname>
            <given-names>D.</given-names>
          </name>
          <name>
            <surname>Crook</surname>
            <given-names>D.W.</given-names>
          </name>
          <name>
            <surname>Peto</surname>
            <given-names>T.E.A.</given-names>
          </name>
          <name>
            <surname>Walker</surname>
            <given-names>A.S.</given-names>
          </name>
          <name>
            <surname>Wilson</surname>
            <given-names>D.J.</given-names>
          </name>
        </person-group>
        <article-title>Detection of mixed infection from bacterial whole genome sequence data allows assessment of its role in Clostridium difficile transmission</article-title>
        <source>PLoS Comput. Biol.</source>
        <year>2013</year>
        <volume>9</volume>
        <fpage>e1003059</fpage>
        <pub-id pub-id-type="pmid">23658511</pub-id>
      </element-citation>
    </ref>
    <ref id="B23">
      <label>23.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Novak</surname>
            <given-names>J.D.</given-names>
          </name>
          <name>
            <surname>Cañas</surname>
            <given-names>A.J.</given-names>
          </name>
        </person-group>
        <article-title>The theory underlying concept maps and how to construct and use them</article-title>
        <year>2008</year>
        <comment>Tech. Rep. IHMC C. 2006-01 Rev 01-2008</comment>
      </element-citation>
    </ref>
    <ref id="B24">
      <label>24.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Alneberg</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Bjarnason</surname>
            <given-names>B.S.</given-names>
          </name>
          <name>
            <surname>de Bruijn</surname>
            <given-names>I.</given-names>
          </name>
          <name>
            <surname>Schirmer</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Quick</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Ijaz</surname>
            <given-names>U.Z.</given-names>
          </name>
          <name>
            <surname>Lahti</surname>
            <given-names>L.</given-names>
          </name>
          <name>
            <surname>Loman</surname>
            <given-names>N.J.</given-names>
          </name>
          <name>
            <surname>Andersson</surname>
            <given-names>A.F.</given-names>
          </name>
          <name>
            <surname>Quince</surname>
            <given-names>C.</given-names>
          </name>
        </person-group>
        <article-title>Binning metagenomic contigs by coverage and composition</article-title>
        <source>Nat. Methods</source>
        <year>2014</year>
        <volume>11</volume>
        <fpage>1144</fpage>
        <lpage>1146</lpage>
        <pub-id pub-id-type="pmid">25218180</pub-id>
      </element-citation>
    </ref>
    <ref id="B25">
      <label>25.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Albertsen</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Hugenholtz</surname>
            <given-names>P.</given-names>
          </name>
          <name>
            <surname>Skarshewski</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Nielsen</surname>
            <given-names>K.L.</given-names>
          </name>
          <name>
            <surname>Tyson</surname>
            <given-names>G.W.</given-names>
          </name>
          <name>
            <surname>Nielsen</surname>
            <given-names>P.H.</given-names>
          </name>
        </person-group>
        <article-title>Genome sequences of rare, uncultured bacteria obtained by differential coverage binning of multiple metagenomes</article-title>
        <source>Nat. Biotechnol.</source>
        <year>2013</year>
        <volume>31</volume>
        <fpage>533</fpage>
        <lpage>538</lpage>
        <pub-id pub-id-type="pmid">23707974</pub-id>
      </element-citation>
    </ref>
    <ref id="B26">
      <label>26.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nielsen</surname>
            <given-names>H.B.</given-names>
          </name>
          <name>
            <surname>Almeida</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Juncker</surname>
            <given-names>A.S.</given-names>
          </name>
          <name>
            <surname>Rasmussen</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Sunagawa</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Plichta</surname>
            <given-names>D.R.</given-names>
          </name>
          <name>
            <surname>Gautier</surname>
            <given-names>L.</given-names>
          </name>
          <name>
            <surname>Pedersen</surname>
            <given-names>A.G.</given-names>
          </name>
          <name>
            <surname>Le Chatelier</surname>
            <given-names>E.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Identification and assembly of genomes and genetic elements in complex metagenomic samples without using reference genomes</article-title>
        <source>Nat. Biotechnol.</source>
        <year>2014</year>
        <volume>32</volume>
        <fpage>822</fpage>
        <lpage>828</lpage>
        <pub-id pub-id-type="pmid">24997787</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
