<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d3 20150301//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 39.96?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?subarticle pcbi.1008380.r001?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
    <journal-id journal-id-type="iso-abbrev">PLoS Comput Biol</journal-id>
    <journal-id journal-id-type="publisher-id">plos</journal-id>
    <journal-title-group>
      <journal-title>PLoS Computational Biology</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1553-734X</issn>
    <issn pub-type="epub">1553-7358</issn>
    <publisher>
      <publisher-name>Public Library of Science</publisher-name>
      <publisher-loc>San Francisco, CA USA</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">8445492</article-id>
    <article-id pub-id-type="pmid">34478440</article-id>
    <article-id pub-id-type="publisher-id">PCOMPBIOL-D-20-01799</article-id>
    <article-id pub-id-type="doi">10.1371/journal.pcbi.1008380</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research Article</subject>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Evolutionary Biology</subject>
          <subj-group>
            <subject>Evolutionary Systematics</subject>
            <subj-group>
              <subject>Phylogenetics</subject>
              <subj-group>
                <subject>Phylogenetic Analysis</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Taxonomy</subject>
          <subj-group>
            <subject>Evolutionary Systematics</subject>
            <subj-group>
              <subject>Phylogenetics</subject>
              <subj-group>
                <subject>Phylogenetic Analysis</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Computer and Information Sciences</subject>
        <subj-group>
          <subject>Data Management</subject>
          <subj-group>
            <subject>Taxonomy</subject>
            <subj-group>
              <subject>Evolutionary Systematics</subject>
              <subj-group>
                <subject>Phylogenetics</subject>
                <subj-group>
                  <subject>Phylogenetic Analysis</subject>
                </subj-group>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Computer and Information Sciences</subject>
        <subj-group>
          <subject>Network Analysis</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Evolutionary Biology</subject>
          <subj-group>
            <subject>Evolutionary Systematics</subject>
            <subj-group>
              <subject>Phylogenetics</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Taxonomy</subject>
          <subj-group>
            <subject>Evolutionary Systematics</subject>
            <subj-group>
              <subject>Phylogenetics</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Computer and Information Sciences</subject>
        <subj-group>
          <subject>Data Management</subject>
          <subj-group>
            <subject>Taxonomy</subject>
            <subj-group>
              <subject>Evolutionary Systematics</subject>
              <subj-group>
                <subject>Phylogenetics</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Organisms</subject>
          <subj-group>
            <subject>Eukaryota</subject>
            <subj-group>
              <subject>Plants</subject>
              <subj-group>
                <subject>Grasses</subject>
                <subj-group>
                  <subject>Rice</subject>
                </subj-group>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and Analysis Methods</subject>
        <subj-group>
          <subject>Animal Studies</subject>
          <subj-group>
            <subject>Experimental Organism Systems</subject>
            <subj-group>
              <subject>Plant and Algal Models</subject>
              <subj-group>
                <subject>Rice</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Genetics</subject>
          <subj-group>
            <subject>Genomics</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Evolutionary Biology</subject>
          <subj-group>
            <subject>Evolutionary Genetics</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Genetics</subject>
          <subj-group>
            <subject>Gene Identification and Analysis</subject>
            <subj-group>
              <subject>Genetic Networks</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Computer and Information Sciences</subject>
        <subj-group>
          <subject>Network Analysis</subject>
          <subj-group>
            <subject>Genetic Networks</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Physical Sciences</subject>
        <subj-group>
          <subject>Mathematics</subject>
          <subj-group>
            <subject>Applied Mathematics</subject>
            <subj-group>
              <subject>Algorithms</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and Analysis Methods</subject>
        <subj-group>
          <subject>Simulation and Modeling</subject>
          <subj-group>
            <subject>Algorithms</subject>
          </subj-group>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>On the inference of complex phylogenetic networks by Markov Chain Monte-Carlo</article-title>
      <alt-title alt-title-type="running-head">On the inference of complex phylogenetic networks by MCMC</alt-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-6736-877X</contrib-id>
        <name>
          <surname>Rabier</surname>
          <given-names>Charles-Elie</given-names>
        </name>
        <role content-type="https://casrai.org/credit/">Formal analysis</role>
        <role content-type="https://casrai.org/credit/">Investigation</role>
        <role content-type="https://casrai.org/credit/">Methodology</role>
        <role content-type="https://casrai.org/credit/">Resources</role>
        <role content-type="https://casrai.org/credit/">Software</role>
        <role content-type="https://casrai.org/credit/">Validation</role>
        <role content-type="https://casrai.org/credit/">Visualization</role>
        <role content-type="https://casrai.org/credit/">Writing – original draft</role>
        <role content-type="https://casrai.org/credit/">Writing – review &amp; editing</role>
        <xref rid="aff001" ref-type="aff">
          <sup>1</sup>
        </xref>
        <xref rid="aff002" ref-type="aff">
          <sup>2</sup>
        </xref>
        <xref rid="aff003" ref-type="aff">
          <sup>3</sup>
        </xref>
        <xref rid="cor001" ref-type="corresp">*</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Berry</surname>
          <given-names>Vincent</given-names>
        </name>
        <role content-type="https://casrai.org/credit/">Data curation</role>
        <role content-type="https://casrai.org/credit/">Formal analysis</role>
        <role content-type="https://casrai.org/credit/">Funding acquisition</role>
        <role content-type="https://casrai.org/credit/">Investigation</role>
        <role content-type="https://casrai.org/credit/">Methodology</role>
        <role content-type="https://casrai.org/credit/">Project administration</role>
        <role content-type="https://casrai.org/credit/">Resources</role>
        <role content-type="https://casrai.org/credit/">Software</role>
        <role content-type="https://casrai.org/credit/">Supervision</role>
        <role content-type="https://casrai.org/credit/">Validation</role>
        <role content-type="https://casrai.org/credit/">Writing – original draft</role>
        <role content-type="https://casrai.org/credit/">Writing – review &amp; editing</role>
        <xref rid="aff002" ref-type="aff">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-5118-5223</contrib-id>
        <name>
          <surname>Stoltz</surname>
          <given-names>Marnus</given-names>
        </name>
        <role content-type="https://casrai.org/credit/">Validation</role>
        <role content-type="https://casrai.org/credit/">Visualization</role>
        <role content-type="https://casrai.org/credit/">Writing – review &amp; editing</role>
        <xref rid="aff001" ref-type="aff">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-4548-4606</contrib-id>
        <name>
          <surname>Santos</surname>
          <given-names>João D.</given-names>
        </name>
        <role content-type="https://casrai.org/credit/">Data curation</role>
        <xref rid="aff004" ref-type="aff">
          <sup>4</sup>
        </xref>
        <xref rid="aff005" ref-type="aff">
          <sup>5</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-8842-3432</contrib-id>
        <name>
          <surname>Wang</surname>
          <given-names>Wensheng</given-names>
        </name>
        <role content-type="https://casrai.org/credit/">Data curation</role>
        <xref rid="aff006" ref-type="aff">
          <sup>6</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Glaszmann</surname>
          <given-names>Jean-Christophe</given-names>
        </name>
        <role content-type="https://casrai.org/credit/">Data curation</role>
        <role content-type="https://casrai.org/credit/">Supervision</role>
        <role content-type="https://casrai.org/credit/">Validation</role>
        <role content-type="https://casrai.org/credit/">Writing – original draft</role>
        <role content-type="https://casrai.org/credit/">Writing – review &amp; editing</role>
        <xref rid="aff004" ref-type="aff">
          <sup>4</sup>
        </xref>
        <xref rid="aff005" ref-type="aff">
          <sup>5</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0001-8084-1464</contrib-id>
        <name>
          <surname>Pardi</surname>
          <given-names>Fabio</given-names>
        </name>
        <role content-type="https://casrai.org/credit/">Conceptualization</role>
        <role content-type="https://casrai.org/credit/">Formal analysis</role>
        <role content-type="https://casrai.org/credit/">Investigation</role>
        <role content-type="https://casrai.org/credit/">Methodology</role>
        <role content-type="https://casrai.org/credit/">Supervision</role>
        <role content-type="https://casrai.org/credit/">Validation</role>
        <role content-type="https://casrai.org/credit/">Visualization</role>
        <role content-type="https://casrai.org/credit/">Writing – original draft</role>
        <role content-type="https://casrai.org/credit/">Writing – review &amp; editing</role>
        <xref rid="aff002" ref-type="aff">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Scornavacca</surname>
          <given-names>Celine</given-names>
        </name>
        <role content-type="https://casrai.org/credit/">Formal analysis</role>
        <role content-type="https://casrai.org/credit/">Funding acquisition</role>
        <role content-type="https://casrai.org/credit/">Investigation</role>
        <role content-type="https://casrai.org/credit/">Methodology</role>
        <role content-type="https://casrai.org/credit/">Project administration</role>
        <role content-type="https://casrai.org/credit/">Resources</role>
        <role content-type="https://casrai.org/credit/">Supervision</role>
        <role content-type="https://casrai.org/credit/">Validation</role>
        <role content-type="https://casrai.org/credit/">Visualization</role>
        <role content-type="https://casrai.org/credit/">Writing – original draft</role>
        <role content-type="https://casrai.org/credit/">Writing – review &amp; editing</role>
        <xref rid="aff001" ref-type="aff">
          <sup>1</sup>
        </xref>
        <xref rid="cor001" ref-type="corresp">*</xref>
      </contrib>
    </contrib-group>
    <aff id="aff001">
      <label>1</label>
      <addr-line>Institut des Sciences de l’Evolution (ISEM), Université de Montpellier, CNRS, EPHE, IRD, Montpellier, France</addr-line>
    </aff>
    <aff id="aff002">
      <label>2</label>
      <addr-line>Laboratoire d’Informatique, de Robotique et de Microélectronique de Montpellier (LIRMM), Université de Montpellier, CNRS, Montpellier, France</addr-line>
    </aff>
    <aff id="aff003">
      <label>3</label>
      <addr-line>Institut Montpelliérain Alexander Grothendieck (IMAG), Université de Montpellier, CNRS, Montpellier, France</addr-line>
    </aff>
    <aff id="aff004">
      <label>4</label>
      <addr-line>CIRAD, UMR AGAP, Montpellier, France</addr-line>
    </aff>
    <aff id="aff005">
      <label>5</label>
      <addr-line>Amélioration Génétique et Adaptation des Plantes méditerranéennes et tropicales (AGAP), Université de Montpellier, CIRAD, INRAE, Institut Agro, Montpellier, France</addr-line>
    </aff>
    <aff id="aff006">
      <label>6</label>
      <addr-line>Institute of Crop Sciences (ICS), Chinese Academy of Agricultural Sciences, Beijing, China</addr-line>
    </aff>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Kosakovsky Pond</surname>
          <given-names>Sergei L.</given-names>
        </name>
        <role>Editor</role>
        <xref rid="edit1" ref-type="aff"/>
      </contrib>
    </contrib-group>
    <aff id="edit1">
      <addr-line>Temple University, UNITED STATES</addr-line>
    </aff>
    <author-notes>
      <fn fn-type="COI-statement" id="coi001">
        <p>The authors have declared that no competing interests exist.</p>
      </fn>
      <corresp id="cor001">* E-mail: <email>charles-elie.rabier@umontpellier.fr</email> (C-ER); <email>celine.scornavacca@umontpellier.fr</email> (CS)</corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <month>9</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>3</day>
      <month>9</month>
      <year>2021</year>
    </pub-date>
    <volume>17</volume>
    <issue>9</issue>
    <elocation-id>e1008380</elocation-id>
    <history>
      <date date-type="received">
        <day>4</day>
        <month>10</month>
        <year>2020</year>
      </date>
      <date date-type="accepted">
        <day>13</day>
        <month>7</month>
        <year>2021</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© 2021 Rabier et al</copyright-statement>
      <copyright-year>2021</copyright-year>
      <copyright-holder>Rabier et al</copyright-holder>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an open access article distributed under the terms of the <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <self-uri xmlns:xlink="http://www.w3.org/1999/xlink" content-type="pdf" xlink:href="pcbi.1008380.pdf"/>
    <abstract>
      <p>For various species, high quality sequences and complete genomes are nowadays available for many individuals. This makes data analysis challenging, as methods need not only to be accurate, but also time efficient given the tremendous amount of data to process. In this article, we introduce an efficient method to infer the evolutionary history of individuals under the multispecies coalescent model in networks (MSNC). Phylogenetic networks are an extension of phylogenetic trees that can contain <italic toggle="yes">reticulate</italic> nodes, which allow to model complex biological events such as horizontal gene transfer, hybridization and introgression. We present a novel way to compute the likelihood of <italic toggle="yes">biallelic</italic> markers sampled along genomes whose evolution involved such events. This likelihood computation is at the heart of a Bayesian network inference method called S<sc>napp</sc>N<sc>et</sc>, as it extends the S<sc>napp</sc> method inferring evolutionary trees under the multispecies coalescent model, to networks. S<sc>napp</sc>N<sc>et</sc> is available as a package of the well-known <sc>beast</sc> 2 software.</p>
      <p>Recently, the <monospace>MCMC_BiMarkers</monospace> method, implemented in PhyloNet, also extended S<sc>napp</sc> to networks. Both methods take biallelic markers as input, rely on the same model of evolution and sample networks in a Bayesian framework, though using different methods for computing priors. However, S<sc>napp</sc>N<sc>et</sc> relies on algorithms that are exponentially more time-efficient on non-trivial networks. Using simulations, we compare performances of S<sc>napp</sc>N<sc>et</sc> and <monospace>MCMC_BiMarkers</monospace>. We show that both methods enjoy similar abilities to recover simple networks, but S<sc>napp</sc>N<sc>et</sc> is more accurate than <monospace>MCMC_BiMarkers</monospace> on more complex network scenarios. Also, on complex networks, S<sc>napp</sc>N<sc>et</sc> is found to be extremely faster than <monospace>MCMC_BiMarkers</monospace> in terms of time required for the likelihood computation. We finally illustrate S<sc>napp</sc>N<sc>et</sc> performances on a rice data set. S<sc>napp</sc>N<sc>et</sc> infers a scenario that is consistent with previous results and provides additional understanding of rice evolution.</p>
    </abstract>
    <abstract abstract-type="summary">
      <title>Author summary</title>
      <p>Nowadays, to make the best use of the vast amount of genomic data at our disposal, there is a real need for methods able to model complex biological mechanisms such as hybridization and introgression. Understanding such mechanisms can help geneticists to elaborate strategies in crop improvement that may help reducing poverty and dealing with climate change. However, reconstructing such evolution scenarios is challenging. Indeed, the inference of phylogenetic networks, which explicitly model reticulation events such as hybridization and introgression, requires high computational resources. Thus, on large data sets, biologists generally deduce reticulation events indirectly using species tree inference tools.</p>
      <p>In this context, we present a new Bayesian method, called S<sc>napp</sc>N<sc>et</sc>, dedicated to phylogenetic network inference. Our method is competitive in terms of execution speed with respect to its competitors. This speed gain enables us to consider more complex evolution scenarios during Bayesian analyses. When applied to rice genomic data, S<sc>napp</sc>N<sc>et</sc> retrieved an evolution scenario that confirms the global triple foundation of the species and the origin of <italic toggle="yes">circum</italic> Basmati as a hybrid derivative between Japonica cultivars and a local Indian form. It suggests that this hybridization is ancient and probably precedes the domestication of <italic toggle="yes">circum</italic> Aus.</p>
    </abstract>
    <funding-group>
      <award-group id="award001">
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/501100001665</institution-id>
            <institution>Agence Nationale de la Recherche</institution>
          </institution-wrap>
        </funding-source>
        <award-id>ANR-10-LABX-0001-01</award-id>
        <principal-award-recipient>
          <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-6736-877X</contrib-id>
          <name>
            <surname>Rabier</surname>
            <given-names>Charles-Elie</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group id="award002">
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/501100001665</institution-id>
            <institution>Agence Nationale de la Recherche</institution>
          </institution-wrap>
        </funding-source>
        <award-id>ANR-16-IDEX-0006</award-id>
        <principal-award-recipient>
          <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-6736-877X</contrib-id>
          <name>
            <surname>Rabier</surname>
            <given-names>Charles-Elie</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group id="award003">
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/501100001665</institution-id>
            <institution>Agence Nationale de la Recherche</institution>
          </institution-wrap>
        </funding-source>
        <award-id>ANR-19-CE45-0012</award-id>
        <principal-award-recipient>
          <name>
            <surname>Scornavacca</surname>
            <given-names>Celine</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group id="award004">
        <funding-source>
          <institution>ATGC bioinformatic platform</institution>
        </funding-source>
        <award-id>ANR-10-INBS-0009</award-id>
        <principal-award-recipient>
          <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-6736-877X</contrib-id>
          <name>
            <surname>Rabier</surname>
            <given-names>Charles-Elie</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group id="award005">
        <funding-source>
          <institution>ATGC bioinformatic platform</institution>
        </funding-source>
        <award-id>ANR-11-INBS-0013</award-id>
        <principal-award-recipient>
          <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-6736-877X</contrib-id>
          <name>
            <surname>Rabier</surname>
            <given-names>Charles-Elie</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group id="award006">
        <funding-source>
          <institution>Agence Nationale de la Recherche</institution>
        </funding-source>
        <award-id>ANR-10-LABX-04-01</award-id>
        <principal-award-recipient>
          <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-6736-877X</contrib-id>
          <name>
            <surname>Rabier</surname>
            <given-names>Charles-Elie</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group id="award007">
        <funding-source>
          <institution>High Performance Computing Platform MESO@LR</institution>
        </funding-source>
        <principal-award-recipient>
          <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-6736-877X</contrib-id>
          <name>
            <surname>Rabier</surname>
            <given-names>Charles-Elie</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group id="award008">
        <funding-source>
          <institution>CIRAD - UMR AGAP HPC Data Center of the South Green Bioinformatics platform</institution>
        </funding-source>
        <principal-award-recipient>
          <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-6736-877X</contrib-id>
          <name>
            <surname>Rabier</surname>
            <given-names>Charles-Elie</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group id="award009">
        <funding-source>
          <institution>CGIAR Research Program</institution>
        </funding-source>
        <principal-award-recipient>
          <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-8842-3432</contrib-id>
          <name>
            <surname>Wang</surname>
            <given-names>Wensheng</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <funding-statement>C.E.R., C.S., J.G., J.S., V.B. were partially funded by the Genome Harvest project (reference ID 1504-006, Labex Agro: ANR-10-LABX-0001-01) for study design, data collection, data analysis. C.E.R., C.S. and V.B. were also partially funded by a KIM Data &amp; Life Sciences project (I-SITE MUSE: ANR-16-IDEX-0006) for data collection, data analysis. C.S. and M.S. were funded by the French Agence Nationale de la Recherche, through the CoCoAlSeq project (ANR-19-CE45-0012) for study design, data collection, data analysis. C.E.R., F.P. and V.B. were funded by the ATGC bioinformatic platform, a member of both the “France Génomique”network (ANR-10-INBS-0009) and the Institut Français de Bioinformatique (ANR-11-INBS-0013) for data collection and data analysis. C.E.R., C.S., M.S. and V.B. were funded by the French Agence Nationale de la Recherche, “Investissements d’Avenir” program, through the Montpellier Bioinformatics Biodiversity platform supported by the LabEx CeMEB (ANR-10-LABX-04-01) for data collection and data analysis. C.E.R. was also funded by the High Performance Computing Platform MESO@LR, financed by the Occitanie /Pyrénées-Méditerranée Region, Montpellier Mediterranean Metropole and the University of Montpellier for data collection and data analysis. C.E.R., J.G. and V.B. were also funded by the CIRAD - UMR AGAP HPC Data Center of the South Green Bioinformatics platform (<ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://www.south-green.fr/" ext-link-type="uri">http://www.south-green.fr/</ext-link>). for data collection and data analysis. J.G. was also funded by the French Agence Nationale de la Recherche, “Investissements d’Avenir” program, through the AdaptGrass project (reference ID170544IA, I-SITE MUSE: ANR-16-IDEX-0006) for study design, data collection and data analysis. W.W. was funded by the CGIAR Research Program on Rice Agrifood Systems (RICE) for study design and data collection.</funding-statement>
    </funding-group>
    <counts>
      <fig-count count="18"/>
      <table-count count="4"/>
      <page-count count="39"/>
    </counts>
    <custom-meta-group>
      <custom-meta>
        <meta-name>PLOS Publication Stage</meta-name>
        <meta-value>vor-update-to-uncorrected-proof</meta-value>
      </custom-meta>
      <custom-meta>
        <meta-name>Publication Update</meta-name>
        <meta-value>2021-09-16</meta-value>
      </custom-meta>
      <custom-meta id="data-availability">
        <meta-name>Data Availability</meta-name>
        <meta-value>All data files are available from the github public repository located at <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://github.com/rabier/MySnappNet" ext-link-type="uri">https://github.com/rabier/MySnappNet</ext-link>.</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
  <notes>
    <title>Data Availability</title>
    <p>All data files are available from the github public repository located at <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://github.com/rabier/MySnappNet" ext-link-type="uri">https://github.com/rabier/MySnappNet</ext-link>.</p>
  </notes>
</front>
<body>
  <disp-quote>
    <p>This is a <italic toggle="yes">PLOS Computational Biology</italic> Methods paper.</p>
  </disp-quote>
  <sec sec-type="intro" id="sec001">
    <title>Introduction</title>
    <p>Complete genomes for numerous species in various life domains [<xref rid="pcbi.1008380.ref001" ref-type="bibr">1</xref>–<xref rid="pcbi.1008380.ref005" ref-type="bibr">5</xref>], and even for several individuals for some species [<xref rid="pcbi.1008380.ref006" ref-type="bibr">6</xref>, <xref rid="pcbi.1008380.ref007" ref-type="bibr">7</xref>] are nowadays available thanks to next generation sequencing. This flow of data finds applications in various fields such as pathogenecity [<xref rid="pcbi.1008380.ref008" ref-type="bibr">8</xref>], crop improvement [<xref rid="pcbi.1008380.ref009" ref-type="bibr">9</xref>], evolutionary genetics [<xref rid="pcbi.1008380.ref010" ref-type="bibr">10</xref>] or population migration and history [<xref rid="pcbi.1008380.ref011" ref-type="bibr">11</xref>–<xref rid="pcbi.1008380.ref013" ref-type="bibr">13</xref>]. Generally, phylogenomic studies use as input thousands to millions genomic fragments sampled across different species. To process such a large amount of data, methods need not only to be accurate, but also time efficient. The availability of numerous genomes at both the intra and inter species levels has been a fertile ground for studies at the interface of population genetics and phylogenetics [<xref rid="pcbi.1008380.ref014" ref-type="bibr">14</xref>] that aim to estimate the evolutionary history of closely related species. In particular, the well-known coalescent model from population genetics [<xref rid="pcbi.1008380.ref015" ref-type="bibr">15</xref>] has been extended to the <italic toggle="yes">multispecies coalescent</italic> (MSC) model [<xref rid="pcbi.1008380.ref016" ref-type="bibr">16</xref>, <xref rid="pcbi.1008380.ref017" ref-type="bibr">17</xref>] to handle studies involving populations or individuals from several species. Recent works show how to incorporate sequence evolution processes into the MSC [<xref rid="pcbi.1008380.ref018" ref-type="bibr">18</xref>, <xref rid="pcbi.1008380.ref019" ref-type="bibr">19</xref>]. As a result, it is now possible to reconstruct evolutionary histories while accounting for both incomplete lineage sorting (ILS) and sequence evolution [<xref rid="pcbi.1008380.ref020" ref-type="bibr">20</xref>, <xref rid="pcbi.1008380.ref021" ref-type="bibr">21</xref>].</p>
    <p>For a given locus, ILS leads different individuals in a same population to have different alleles that can trace back to different ancestors. Then, if speciation occurs before the different alleles get sorted in the population, the locus tree topology can differ from the species history [<xref rid="pcbi.1008380.ref022" ref-type="bibr">22</xref>]. But incongruence between these trees can also result from biological phenomena that can cause a species to inherit lineages and/or genomic fragments from more than one parent species. Examples of such phenomena include hybrid speciation [<xref rid="pcbi.1008380.ref023" ref-type="bibr">23</xref>–<xref rid="pcbi.1008380.ref026" ref-type="bibr">26</xref>], introgression [<xref rid="pcbi.1008380.ref027" ref-type="bibr">27</xref>–<xref rid="pcbi.1008380.ref029" ref-type="bibr">29</xref>] and horizontal gene transfer [<xref rid="pcbi.1008380.ref030" ref-type="bibr">30</xref>, <xref rid="pcbi.1008380.ref031" ref-type="bibr">31</xref>] (the latter is not addressed in this paper). As a consequence of these reticulate events, trees are not suited to represent species history, and should be replaced by phylogenetic networks. A rooted phylogenetic network is mainly a directed acyclic graph whose internal nodes can have several children, as in trees, but can also have several parents [<xref rid="pcbi.1008380.ref032" ref-type="bibr">32</xref>–<xref rid="pcbi.1008380.ref034" ref-type="bibr">34</xref>]. Various models of phylogenetic network have been proposed over time to explicitly represent reticulate evolution, such as hybridization networks [<xref rid="pcbi.1008380.ref035" ref-type="bibr">35</xref>] or ancestral recombination graphs [<xref rid="pcbi.1008380.ref036" ref-type="bibr">36</xref>], along with dozens of inference methods [<xref rid="pcbi.1008380.ref037" ref-type="bibr">37</xref>, <xref rid="pcbi.1008380.ref038" ref-type="bibr">38</xref>].</p>
    <p>Model-based methods have been proposed to handle simultaneously ILS and reticulate evolution, which is a desired feature to avoid bias in the inference [<xref rid="pcbi.1008380.ref039" ref-type="bibr">39</xref>–<xref rid="pcbi.1008380.ref041" ref-type="bibr">41</xref>]. These methods postulate a probabilistic model of evolution and then estimate its parameters –including the underlying network– from the data. The estimation of parameters such as branch lengths (hence speciation dates) and population sizes makes them more versatile than combinatorial methods [<xref rid="pcbi.1008380.ref042" ref-type="bibr">42</xref>]. On the down side, they usually involve high running times as they explore large parameter spaces. Two probabilistic models differentiate regarding the way a locus tree can be embedded within a network. In Kubatko’s model [<xref rid="pcbi.1008380.ref043" ref-type="bibr">43</xref>, <xref rid="pcbi.1008380.ref044" ref-type="bibr">44</xref>], all lineages of a given locus tree coalesce within a single species tree <italic toggle="yes">displayed</italic> by the network. The model of Yu et al. [<xref rid="pcbi.1008380.ref045" ref-type="bibr">45</xref>] is more general as, at each reticulation node, a lineage of the locus tree is allowed to descend from a parental ancestor independently of which ancestors provide the other lineages. Works on the latter model extend in various ways the MSC model to consider network-like evolution, giving rise to the <italic toggle="yes">multispecies network coalescent</italic> (MSNC), intensively studied in recent years [<xref rid="pcbi.1008380.ref038" ref-type="bibr">38</xref>, <xref rid="pcbi.1008380.ref041" ref-type="bibr">41</xref>, <xref rid="pcbi.1008380.ref046" ref-type="bibr">46</xref>–<xref rid="pcbi.1008380.ref055" ref-type="bibr">55</xref>]. For this model, Yu et al. have shown how to compute the probability of a non-recombinant locus (<italic toggle="yes">gene</italic>) tree evolving inside a network, given the branch lengths and inheritance probabilities at each reticulation node of the network [<xref rid="pcbi.1008380.ref046" ref-type="bibr">46</xref>, <xref rid="pcbi.1008380.ref048" ref-type="bibr">48</xref>]. This opened the way to infer networks according to the well-known maximum likelihood and Bayesian statistical frameworks.</p>
    <p>When the input data consists of multi-locus alignments, a first idea is to decompose the inference process in two steps: first, infer locus trees from their respective alignments, then look for networks that assign high probability to these trees. Following this principle, Yu et al. devised a maximum likelihood method [<xref rid="pcbi.1008380.ref048" ref-type="bibr">48</xref>], then a Bayesian sampling technique [<xref rid="pcbi.1008380.ref051" ref-type="bibr">51</xref>]. However, using locus trees as a proxy for molecular sequences loses some information contained in the alignments [<xref rid="pcbi.1008380.ref016" ref-type="bibr">16</xref>] and is subject to tree reconstruction errors. For this reasons, recent work considers jointly estimating the locus trees and the underlying network. This brings the extra advantage that better locus trees are likely to be obtained [<xref rid="pcbi.1008380.ref056" ref-type="bibr">56</xref>], but running time may become prohibitive already for inferences on few species. Wen et al. in the P<sc>hylo</sc>N<sc>et</sc> software [<xref rid="pcbi.1008380.ref052" ref-type="bibr">52</xref>] and Zhang et al. with the S<sc>pecies</sc>N<sc>etwork</sc> method [<xref rid="pcbi.1008380.ref053" ref-type="bibr">53</xref>] both proposed Bayesian methods following this principle.</p>
    <p>Though a number of trees for a same locus are considered during such inference processes, they are still considered one at a time, which may lead to a precision loss (and a time loss) compared to an inference process that would consider all possible trees for a given locus at once. When data consists of a set of <italic toggle="yes">biallelic</italic> markers (e.g., SNPs), the ground-breaking work of Bryant et al. [<xref rid="pcbi.1008380.ref019" ref-type="bibr">19</xref>] allows to compute likelihoods while integrating over all gene trees, under the MSC model (<italic toggle="yes">i.e.</italic>, when representing the history as a tree). This work was recently extended to the MSNC context by Zhu et al [<xref rid="pcbi.1008380.ref054" ref-type="bibr">54</xref>].</p>
    <p>In this paper, we present a novel way to compute the probability of biallelic markers, given a network. This likelihood computation is at the heart of a Bayesian network inference method we called S<sc>napp</sc>N<sc>et</sc>, as it extends the S<sc>napp</sc> method [<xref rid="pcbi.1008380.ref019" ref-type="bibr">19</xref>] to networks. S<sc>napp</sc>N<sc>et</sc> is available at <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://github.com/rabier/MySnappNet" ext-link-type="uri">https://github.com/rabier/MySnappNet</ext-link> and distributed as a package of the well-known B<sc>east</sc> 2 software [<xref rid="pcbi.1008380.ref057" ref-type="bibr">57</xref>, <xref rid="pcbi.1008380.ref058" ref-type="bibr">58</xref>]. This package partly relies on code from S<sc>napp</sc> [<xref rid="pcbi.1008380.ref019" ref-type="bibr">19</xref>] to handle sequence evolution and on code from S<sc>pecies</sc>N<sc>etwork</sc> [<xref rid="pcbi.1008380.ref053" ref-type="bibr">53</xref>] to modify the network during the MCMC as well as to compute network priors.</p>
    <p>Our approach differs from that of Zhang et al. [<xref rid="pcbi.1008380.ref053" ref-type="bibr">53</xref>] in that S<sc>napp</sc>N<sc>et</sc> takes a matrix of biallelic markers as input while S<sc>pecies</sc>N<sc>etwork</sc> expects a set of alignments. Thus, the substitution models differ, as we consider only two states (alleles) while S<sc>pecies</sc>N<sc>etwork</sc> deals with nucleotides. The computational approaches also differ as our MCMC integrates over all locus trees for each sampled network, while S<sc>pecies</sc>N<sc>etwork</sc> jointly samples networks and gene trees. Though summarizing the alignments by gene trees might be less flexible, this allows S<sc>pecies</sc>N<sc>etwork</sc> to provide embeddings of the gene trees into the sampled networks, while in our approach this needs to be done in a complementary step after running S<sc>napp</sc>N<sc>et</sc>. However, managing the embeddings can also lead to computational issues as Zhang et al. report, since a topological change for the network usually requires a recomputation of the embeddings for all gene trees [<xref rid="pcbi.1008380.ref053" ref-type="bibr">53</xref>].</p>
    <p>The S<sc>napp</sc>N<sc>et</sc> method we present here is much closer to the <monospace>MCMC_BiMarkers</monospace> method of Zhu et al. [<xref rid="pcbi.1008380.ref054" ref-type="bibr">54</xref>], which also extends the S<sc>napp</sc> method [<xref rid="pcbi.1008380.ref019" ref-type="bibr">19</xref>] to network inference. Both methods take biallelic markers as input, rely on the same model of evolution and both sample networks in a Bayesian framework. However, they differ in two important respects: the way the Bayesian inference is conducted and, most importantly, in the algorithm to compute the likelihoods. The results we present here show that this often leads to tremendous differences in running time, but also to differences in convergence.</p>
    <p>We note that reducing running times of model-based methods can also be done by approximating likelihoods, as done by <italic toggle="yes">pseudo-likelihood</italic> methods: the network likelihood is computed for subparts of its topology, these values being then assembled to approximate the likelihood of the full network. A decomposition of the network into rooted networks on three taxa (trinets) is proposed in the P<sc>hylo</sc>N<sc>et</sc> software [<xref rid="pcbi.1008380.ref049" ref-type="bibr">49</xref>, <xref rid="pcbi.1008380.ref059" ref-type="bibr">59</xref>] and one into semi-directed networks on four taxa in the SN<sc>a</sc>Q method of the P<sc>hylo</sc>N<sc>etwork</sc> package [<xref rid="pcbi.1008380.ref050" ref-type="bibr">50</xref>]. Since pseudo-likelihood methods are approximate heuristics to compute a likelihood, they are usually much faster than full likelihood methods and can handle large genomic data sets. On the downside, these methods face, more often than the full-likelihood methods, serious identifiability problems since some networks simply cannot be recovered from topological substructures such as rooted triples, quartets or even embedded trees [<xref rid="pcbi.1008380.ref049" ref-type="bibr">49</xref>, <xref rid="pcbi.1008380.ref050" ref-type="bibr">50</xref>, <xref rid="pcbi.1008380.ref060" ref-type="bibr">60</xref>]. Here we focus on the <italic toggle="yes">exact</italic> computation of the <italic toggle="yes">full</italic> likelihood, for which identifiability issues are likely to be less serious [<xref rid="pcbi.1008380.ref041" ref-type="bibr">41</xref>, <xref rid="pcbi.1008380.ref061" ref-type="bibr">61</xref>].</p>
    <p>In the following, we first detail the mathematical model considered, then explain the S<sc>napp</sc>N<sc>et</sc> method, before illustrating its performances on simulated and real data.</p>
  </sec>
  <sec sec-type="materials|methods" id="sec002">
    <title>Materials and methods</title>
    <sec id="sec003">
      <title>Input data</title>
      <p>
S<sc>napp</sc>N<sc>et</sc> considers as input data a matrix <italic toggle="yes">D</italic> containing an alignment of <italic toggle="yes">m</italic> biallelic markers sampled from a number of individuals. Each individual belongs to a given species. These species are in a 1-to-1 correspondence with the leaves of an unknown phylogenetic network, which is the main parameter that we wish to estimate. The markers can be SNPs or random sites sampled from chromosomes, including invariant sites. All markers are considered to be independent, so a certain distance must be preserved between genomic locations included in the matrix. We identify the two alleles with the red and green colors.</p>
      <p>Each column <italic toggle="yes">D</italic><sub><italic toggle="yes">i</italic></sub> of the alignment corresponds to a different marker. The only information that is relevant to S<sc>napp</sc>N<sc>et</sc>’s computations are the numbers of red and green alleles observed in <italic toggle="yes">D</italic><sub><italic toggle="yes">i</italic></sub> for the individuals of a given species. This implies that unphased data can be analyzed with S<sc>napp</sc>N<sc>et</sc>, as long as it is translated in the input format expected by the software.</p>
    </sec>
    <sec id="sec004">
      <title>Mathematical model</title>
      <p>In this paper, we refer to phylogenetic networks as directed acyclic graphs with branches oriented as the time flows, see <xref rid="pcbi.1008380.g001" ref-type="fig">Fig 1</xref>. At their extremities, networks have a single node with no incoming branch and a single outgoing branch —the <italic toggle="yes">origin</italic>— and a number of nodes with a single incoming branch and no outgoing branches —the <italic toggle="yes">leaves</italic>. All other nodes either have a single incoming branch and two outgoing branches —the <italic toggle="yes">tree</italic> nodes— or two incoming branches and a single outgoing branch —the <italic toggle="yes">reticulation</italic> nodes. Tree nodes and reticulation nodes represent speciations and hybridization events, respectively. For consistency with Zhang et al. [<xref rid="pcbi.1008380.ref053" ref-type="bibr">53</xref>], the immediate descendant of the origin—that is, the tree node representing the first speciation in the network—is called the <italic toggle="yes">root</italic>.</p>
      <fig position="float" id="pcbi.1008380.g001">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1008380.g001</object-id>
        <label>Fig 1</label>
        <caption>
          <title>Example of a phylogenetic network.</title>
          <p>The top node represents the origin and its child node is called the root of the network. Time flows from the origin node to the leaves (here <italic toggle="yes">A</italic>, <italic toggle="yes">B</italic>, <italic toggle="yes">C</italic>, <italic toggle="yes">D</italic>) so branches are directed from the top to the leaves. Each branch <italic toggle="yes">x</italic> is associated to a length <italic toggle="yes">t</italic><sub><italic toggle="yes">x</italic></sub>, and to a population size <italic toggle="yes">θ</italic><sub><italic toggle="yes">x</italic></sub>. Additionally, branches <italic toggle="yes">x</italic> on top of a reticulation node have an inheritance probability <italic toggle="yes">γ</italic><sub><italic toggle="yes">x</italic></sub> representing their probability to have contributed to any individual at the top of the branch just below.</p>
        </caption>
        <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1008380.g001" position="float"/>
      </fig>
      <p>Each branch <italic toggle="yes">x</italic> in the network represents a population, and is associated to two parameters: a scaled population size <italic toggle="yes">θ</italic><sub><italic toggle="yes">x</italic></sub> and a branch length <italic toggle="yes">t</italic><sub><italic toggle="yes">x</italic></sub>. Any branch <italic toggle="yes">x</italic> on top of a reticulation node <italic toggle="yes">h</italic> is further associated with a probability <italic toggle="yes">γ</italic><sub><italic toggle="yes">x</italic></sub> ∈ (0, 1), under the constraint that the probabilities of the two parent branches of <italic toggle="yes">h</italic> sum to 1. These probabilities are called <italic toggle="yes">inheritance probabilities</italic>. All these parameters have a role in determining how gene trees are generated by the model, and how markers evolve along these gene trees, as described in the next two subsections, respectively.</p>
      <sec id="sec005">
        <title>Gene tree model</title>
        <p>Gene trees are obtained according to the MSNC model. The process starts at the leaves of the network, where a given number of lineages is sampled for each leaf, each lineage going backwards in time, until all lineages coalesce. Along the way, this process determines a gene tree whose branch lengths are each determined as the amount of time between two coalescences affecting a same lineage. Here and in what follows, “times” —and therefore branch lengths— are always measured in terms of expected number of mutations per site.</p>
        <p>Within each branch <italic toggle="yes">x</italic> of the network, the model applies a standard coalescent process governed by <italic toggle="yes">θ</italic><sub><italic toggle="yes">x</italic></sub>. In detail, any two lineages within <italic toggle="yes">x</italic> coalesce at rate 2/<italic toggle="yes">θ</italic><sub><italic toggle="yes">x</italic></sub>, meaning that the first coalescent time among <italic toggle="yes">k</italic> lineages follows an exponential distribution <inline-formula id="pcbi.1008380.e001"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1008380.e001.jpg" id="pcbi.1008380.e001g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M1" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="script">E</mml:mi><mml:mo>(</mml:mo><mml:mi>k</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>k</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow><mml:mo>/</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>, since the coalescence of each combination of 2 lineages is equiprobable. Naturally, if the waiting time to coalescence exceeds the branch length <italic toggle="yes">t</italic><sub><italic toggle="yes">x</italic></sub>, the lineages are passed to the network branch(es) above <italic toggle="yes">x</italic> without coalescence. If there are two such branches, say <italic toggle="yes">y</italic>, <italic toggle="yes">z</italic> (i.e., the origin of <italic toggle="yes">x</italic> is a reticulation node) then each lineage that has arrived at the top of branch <italic toggle="yes">x</italic> chooses independently whether it goes to <italic toggle="yes">y</italic> or <italic toggle="yes">z</italic> with probabilities <italic toggle="yes">γ</italic><sub><italic toggle="yes">y</italic></sub> and <italic toggle="yes">γ</italic><sub><italic toggle="yes">z</italic></sub> = 1 − <italic toggle="yes">γ</italic><sub><italic toggle="yes">y</italic></sub>, respectively [<xref rid="pcbi.1008380.ref045" ref-type="bibr">45</xref>]. The process terminates when all lineages have coalesced and only one ancestral lineage remains.</p>
      </sec>
      <sec id="sec006">
        <title>Mutation model</title>
        <p>As is customary for unlinked loci, we assume that the data is generated by a different gene tree for each biallelic marker. The evolution of a marker along the branches of this gene tree follows a two-states asymmetric continuous-time Markov model, scaled so as to ensure that 1 mutation is expected per time unit. This is the same model as Bryant et al. [<xref rid="pcbi.1008380.ref019" ref-type="bibr">19</xref>]. For completeness, we describe this mutation model below.</p>
        <p>We represent the two alleles by red and green colors. Let <italic toggle="yes">u</italic> and <italic toggle="yes">v</italic> denote the instantaneous rates of mutating from red to green, and from green to red, respectively. Then, for a single lineage, <inline-formula id="pcbi.1008380.e002"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1008380.e002.jpg" id="pcbi.1008380.e002g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M2" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="double-struck">P</mml:mi><mml:mo>(</mml:mo><mml:mtext>red</mml:mtext><mml:mspace width="4pt"/><mml:mtext>at</mml:mtext><mml:mspace width="4pt"/><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mo>Δ</mml:mo><mml:mi>t</mml:mi></mml:mrow><mml:mo>∣</mml:mo><mml:mtext>green</mml:mtext><mml:mspace width="4pt"/><mml:mtext>at</mml:mtext><mml:mspace width="4pt"/><mml:mi>t</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mi>v</mml:mi><mml:mo>Δ</mml:mo><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mi>o</mml:mi><mml:mo>(</mml:mo><mml:mo>Δ</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>, and <inline-formula id="pcbi.1008380.e003"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1008380.e003.jpg" id="pcbi.1008380.e003g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M3" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="double-struck">P</mml:mi><mml:mo>(</mml:mo><mml:mtext>green</mml:mtext><mml:mspace width="4pt"/><mml:mtext>at</mml:mtext><mml:mspace width="4pt"/><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mo>Δ</mml:mo><mml:mi>t</mml:mi></mml:mrow><mml:mo>∣</mml:mo><mml:mtext>red</mml:mtext><mml:mspace width="4pt"/><mml:mtext>at</mml:mtext><mml:mspace width="4pt"/><mml:mi>t</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mi>u</mml:mi><mml:mo>Δ</mml:mo><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mi>o</mml:mi><mml:mo>(</mml:mo><mml:mo>Δ</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>, where <italic toggle="yes">o</italic>(Δ<italic toggle="yes">t</italic>) is negligible when Δ<italic toggle="yes">t</italic> tends to zero. The stationary distribution for the allele at the root of the gene tree is green with probability <italic toggle="yes">u</italic>/(<italic toggle="yes">u</italic> + <italic toggle="yes">v</italic>) and red with probability <italic toggle="yes">v</italic>/(<italic toggle="yes">u</italic> + <italic toggle="yes">v</italic>). Under this model, the expected number of mutations per time unit is 2<italic toggle="yes">uv</italic>/(<italic toggle="yes">u</italic> + <italic toggle="yes">v</italic>). In order to measure time (branch lengths) in terms of expected mutations per site (i.e. genetic distance), we impose the constraint 2<italic toggle="yes">uv</italic>/(<italic toggle="yes">u</italic> + <italic toggle="yes">v</italic>) = 1 as in [<xref rid="pcbi.1008380.ref019" ref-type="bibr">19</xref>]. When <italic toggle="yes">u</italic> and <italic toggle="yes">v</italic> are set to 1, the model is also known as the Haldane model [<xref rid="pcbi.1008380.ref062" ref-type="bibr">62</xref>] or the Cavender-Farris-Neyman model [<xref rid="pcbi.1008380.ref063" ref-type="bibr">63</xref>].</p>
      </sec>
    </sec>
    <sec id="sec007">
      <title>Bayesian framework</title>
      <sec id="sec008">
        <title>Posterior distribution</title>
        <p>Let <italic toggle="yes">D</italic><sub><italic toggle="yes">i</italic></sub> be the data for the <italic toggle="yes">i</italic>-th marker. The posterior distribution of the phylogenetic network Ψ can be expressed as:
<disp-formula id="pcbi.1008380.e004"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1008380.e004.jpg" id="pcbi.1008380.e004g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M4" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi mathvariant="double-struck">P</mml:mi><mml:mo>(</mml:mo><mml:mo>Ψ</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>∝</mml:mo><mml:mi mathvariant="double-struck">P</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo>∣</mml:mo><mml:mo>Ψ</mml:mo><mml:mo>)</mml:mo><mml:mo>·</mml:mo><mml:mi mathvariant="double-struck">P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mo>Ψ</mml:mo><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mi mathvariant="double-struck">P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mo>Ψ</mml:mo><mml:mo>)</mml:mo></mml:mrow><mml:mo>·</mml:mo><mml:munderover><mml:mo>∏</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>m</mml:mi></mml:munderover><mml:mi mathvariant="double-struck">P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:mo>Ψ</mml:mo><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(1)</label></disp-formula>
where ∝ means “is proportional to”, and where <inline-formula id="pcbi.1008380.e005"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1008380.e005.jpg" id="pcbi.1008380.e005g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M5" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="double-struck">P</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo>∣</mml:mo><mml:mo>Ψ</mml:mo><mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1008380.e006"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1008380.e006.jpg" id="pcbi.1008380.e006g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M6" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="double-struck">P</mml:mi><mml:mo>(</mml:mo><mml:mo>Ψ</mml:mo><mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> refer to the likelihood and the network prior, respectively.</p>
        <p><xref rid="pcbi.1008380.e004" ref-type="disp-formula">Eq 1</xref>—which relies on the independence of the data at different markers— allows us to compute a quantity proportional to the posterior by only using the prior of Ψ and the likelihoods of Ψ with respect to each marker, that is <inline-formula id="pcbi.1008380.e007"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1008380.e007.jpg" id="pcbi.1008380.e007g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M7" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="double-struck">P</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:mo>Ψ</mml:mo><mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>. While we could approximate <inline-formula id="pcbi.1008380.e008"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1008380.e008.jpg" id="pcbi.1008380.e008g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M8" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="double-struck">P</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:mo>Ψ</mml:mo><mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> by sampling gene trees from the distribution determined by the species network, this is time-consuming and not necessary. Similarly to the work by Bryant et al. [<xref rid="pcbi.1008380.ref019" ref-type="bibr">19</xref>] for inferring phylogenetic <italic toggle="yes">trees</italic>, we show below that <inline-formula id="pcbi.1008380.e009"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1008380.e009.jpg" id="pcbi.1008380.e009g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M9" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="double-struck">P</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:mo>Ψ</mml:mo><mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> can be computed for <italic toggle="yes">networks</italic> using dynamic programming.</p>
        <p>
S<sc>napp</sc>N<sc>et</sc> samples networks from their posterior distribution by using Markov chain Monte-Carlo (MCMC) based on <xref rid="pcbi.1008380.e004" ref-type="disp-formula">Eq 1</xref>.</p>
      </sec>
      <sec id="sec009">
        <title>Priors</title>
        <p>Before describing the network prior, let us recall the network components: the topology, the branch lengths, the inheritance probabilities and the populations sizes. In this context, we used the birth-hybridization process of Zhang et al. [<xref rid="pcbi.1008380.ref053" ref-type="bibr">53</xref>] to model the network topology and its branch lengths. This process depends on the speciation rate λ, on the hybridization rate nu and on the time of origin <italic toggle="yes">τ</italic><sub>0</sub>. Hyperpriors are imposed onto these parameters. An exponential distribution is used for the hyperparameters <italic toggle="yes">d</italic> ≔ λ − nu and <italic toggle="yes">τ</italic><sub>0</sub>. The hyperparameter <italic toggle="yes">r</italic> ≔ nu/λ is assigned a Beta distribution. We refer to [<xref rid="pcbi.1008380.ref053" ref-type="bibr">53</xref>] for more details. The inheritance probabilities are modeled according to a uniform distribution. Moreover, like S<sc>napp</sc>, S<sc>napp</sc>N<sc>et</sc> considers independent and identically distributed Gamma distributions as priors on population sizes <italic toggle="yes">θ</italic><sub><italic toggle="yes">x</italic></sub> associated to each network branch. This prior on each population size induces a prior on the corresponding coalescence rate (see [<xref rid="pcbi.1008380.ref019" ref-type="bibr">19</xref>] and S<sc>napp</sc>’s code). Last, as in S<sc>napp</sc>, the user can specify fixed values for the <italic toggle="yes">u</italic> and <italic toggle="yes">v</italic> mutation rates, or impose a prior for these rates and let them be sampled within the MCMC.</p>
      </sec>
      <sec id="sec010">
        <title>Partial likelihoods</title>
        <p>In the next section we describe a few recursive formulae that we use to calculate the likelihood <inline-formula id="pcbi.1008380.e010"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1008380.e010.jpg" id="pcbi.1008380.e010g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M10" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="double-struck">P</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:mo>Ψ</mml:mo><mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> using a dynamic programming algorithm. Here we introduce the notations that allow us to define the quantities involved in our computations. Unless otherwise stated, notations that follow are relative to the <italic toggle="yes">i</italic>th biallelic marker. To keep the notations light, the dependence on <italic toggle="yes">i</italic> is not explicit.</p>
        <p>Given a branch <italic toggle="yes">x</italic>, we denote by <inline-formula id="pcbi.1008380.e011"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1008380.e011.jpg" id="pcbi.1008380.e011g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M11" display="inline" overflow="scroll"><mml:mover><mml:mi>x</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1008380.e012"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1008380.e012.jpg" id="pcbi.1008380.e012g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M12" display="inline" overflow="scroll"><mml:munder><mml:mi>x</mml:mi><mml:mo>_</mml:mo></mml:munder></mml:math></alternatives></inline-formula> the top and bottom of that branch. We call <inline-formula id="pcbi.1008380.e013"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1008380.e013.jpg" id="pcbi.1008380.e013g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M13" display="inline" overflow="scroll"><mml:mover><mml:mi>x</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1008380.e014"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1008380.e014.jpg" id="pcbi.1008380.e014g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M14" display="inline" overflow="scroll"><mml:munder><mml:mi>x</mml:mi><mml:mo>_</mml:mo></mml:munder></mml:math></alternatives></inline-formula>
<italic toggle="yes">population interfaces</italic>. We say that two population interfaces are <italic toggle="yes">incomparable</italic> if neither is a descendant of the other (which also excludes them being equal). <inline-formula id="pcbi.1008380.e015"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1008380.e015.jpg" id="pcbi.1008380.e015g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M15" display="inline" overflow="scroll"><mml:msub><mml:mi>N</mml:mi><mml:mover><mml:mi>x</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:msub></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1008380.e016"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1008380.e016.jpg" id="pcbi.1008380.e016g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M16" display="inline" overflow="scroll"><mml:msub><mml:mi>N</mml:mi><mml:munder><mml:mi>x</mml:mi><mml:mo>_</mml:mo></mml:munder></mml:msub></mml:math></alternatives></inline-formula> are random variables denoting the number of gene tree lineages at the top and at the bottom of <italic toggle="yes">x</italic>, respectively. Similarly, <inline-formula id="pcbi.1008380.e017"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1008380.e017.jpg" id="pcbi.1008380.e017g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M17" display="inline" overflow="scroll"><mml:msub><mml:mi>R</mml:mi><mml:mover><mml:mi>x</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:msub></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1008380.e018"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1008380.e018.jpg" id="pcbi.1008380.e018g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M18" display="inline" overflow="scroll"><mml:msub><mml:mi>R</mml:mi><mml:munder><mml:mi>x</mml:mi><mml:mo>_</mml:mo></mml:munder></mml:msub></mml:math></alternatives></inline-formula> denote the number of red lineages at the top and bottom of <italic toggle="yes">x</italic>, respectively. See <xref rid="pcbi.1008380.g002" ref-type="fig">Fig 2</xref> for illustration of these concepts and of the notation that we introduce in the following.</p>
        <fig position="float" id="pcbi.1008380.g002">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1008380.g002</object-id>
          <label>Fig 2</label>
          <caption>
            <title>Illustration of the concepts and notation employed to describe likelihood computations.</title>
            <p>The species network topology is the same as that in <xref rid="pcbi.1008380.g001" ref-type="fig">Fig 1</xref>, but branches (populations) are now represented as grey parallelograms. A gene tree is drawn inside the species network (green and red lines). One mutation occurs in the branch above <italic toggle="yes">D</italic>. We focus on three branches: <italic toggle="yes">x</italic>, <italic toggle="yes">y</italic> and <italic toggle="yes">z</italic>. Colored horizontal bars represent the population interfaces <inline-formula id="pcbi.1008380.e019"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1008380.e019" id="pcbi.1008380.e019g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M19" display="inline" overflow="scroll"><mml:munder><mml:mi>x</mml:mi><mml:mo>_</mml:mo></mml:munder></mml:math></alternatives></inline-formula>, <inline-formula id="pcbi.1008380.e020"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1008380.e020" id="pcbi.1008380.e020g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M20" display="inline" overflow="scroll"><mml:mover><mml:mi>y</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:math></alternatives></inline-formula>, <inline-formula id="pcbi.1008380.e021"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1008380.e021" id="pcbi.1008380.e021g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M21" display="inline" overflow="scroll"><mml:munder><mml:mi>y</mml:mi><mml:mo>_</mml:mo></mml:munder></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1008380.e022"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1008380.e022" id="pcbi.1008380.e022g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M22" display="inline" overflow="scroll"><mml:mover><mml:mi>z</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:math></alternatives></inline-formula>. Note that <inline-formula id="pcbi.1008380.e023"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1008380.e023" id="pcbi.1008380.e023g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M23" display="inline" overflow="scroll"><mml:mrow><mml:mo>(</mml:mo><mml:munder><mml:mi>x</mml:mi><mml:mo>_</mml:mo></mml:munder><mml:mo>,</mml:mo><mml:mover><mml:mi>y</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> (blue) is a vector of incomparable population interfaces, while <inline-formula id="pcbi.1008380.e024"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1008380.e024" id="pcbi.1008380.e024g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M24" display="inline" overflow="scroll"><mml:mrow><mml:mo>(</mml:mo><mml:munder><mml:mi>y</mml:mi><mml:mo>_</mml:mo></mml:munder><mml:mo>,</mml:mo><mml:mover><mml:mi>z</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> (orange) is not, as <inline-formula id="pcbi.1008380.e025"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1008380.e025" id="pcbi.1008380.e025g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M25" display="inline" overflow="scroll"><mml:mover><mml:mi>z</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:math></alternatives></inline-formula> is a descendant of <inline-formula id="pcbi.1008380.e026"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1008380.e026" id="pcbi.1008380.e026g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M26" display="inline" overflow="scroll"><mml:munder><mml:mi>y</mml:mi><mml:mo>_</mml:mo></mml:munder></mml:math></alternatives></inline-formula>. Here, <italic toggle="yes">n</italic><sub><italic toggle="yes">A</italic></sub> = <italic toggle="yes">n</italic><sub><italic toggle="yes">B</italic></sub> = <italic toggle="yes">n</italic><sub><italic toggle="yes">C</italic></sub> = <italic toggle="yes">n</italic><sub><italic toggle="yes">D</italic></sub> = 2, <italic toggle="yes">r</italic><sub><italic toggle="yes">A</italic></sub> = 2, <italic toggle="yes">r</italic><sub><italic toggle="yes">B</italic></sub> = 1, <italic toggle="yes">r</italic><sub><italic toggle="yes">C</italic></sub> = 0, <italic toggle="yes">r</italic><sub><italic toggle="yes">D</italic></sub> = 2 are known, whereas the values of <inline-formula id="pcbi.1008380.e027"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1008380.e027" id="pcbi.1008380.e027g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M27" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:munder><mml:mi>x</mml:mi><mml:mo>_</mml:mo></mml:munder></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mover><mml:mi>y</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:munder><mml:mi>y</mml:mi><mml:mo>_</mml:mo></mml:munder></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mover><mml:mi>z</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1008380.e028"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1008380.e028" id="pcbi.1008380.e028g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M28" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:munder><mml:mi>x</mml:mi><mml:mo>_</mml:mo></mml:munder></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mover><mml:mi>y</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:munder><mml:mi>y</mml:mi><mml:mo>_</mml:mo></mml:munder></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mover><mml:mi>z</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> are not observed, and depend on the gene tree generated by the MSNC process. For the gene tree shown, <inline-formula id="pcbi.1008380.e029"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1008380.e029" id="pcbi.1008380.e029g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M29" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:munder><mml:mi>x</mml:mi><mml:mo>_</mml:mo></mml:munder><mml:mo>,</mml:mo><mml:mover><mml:mi>y</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mo>)</mml:mo></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1008380.e030"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1008380.e030" id="pcbi.1008380.e030g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M30" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:munder><mml:mi>x</mml:mi><mml:mo>_</mml:mo></mml:munder><mml:mo>,</mml:mo><mml:mover><mml:mi>y</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mo>)</mml:mo></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>. Since <italic toggle="yes">z</italic> is incident to leaf <italic toggle="yes">B</italic>, we have <inline-formula id="pcbi.1008380.e031"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1008380.e031" id="pcbi.1008380.e031g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M31" display="inline" overflow="scroll"><mml:mrow><mml:munder><mml:mi>z</mml:mi><mml:mo>_</mml:mo></mml:munder><mml:mo>=</mml:mo><mml:mi>B</mml:mi></mml:mrow></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1008380.e032"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1008380.e032" id="pcbi.1008380.e032g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M32" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:munder><mml:mi>z</mml:mi><mml:mo>_</mml:mo></mml:munder></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mi>B</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>. Now note <inline-formula id="pcbi.1008380.e033"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1008380.e033" id="pcbi.1008380.e033g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M33" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="bold">L</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:munder><mml:mi>x</mml:mi><mml:mo>_</mml:mo></mml:munder><mml:mo>,</mml:mo><mml:mover><mml:mi>y</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mo>)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>C</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>. Then, <inline-formula id="pcbi.1008380.e034"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1008380.e034" id="pcbi.1008380.e034g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M34" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi mathvariant="bold">F</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:munder><mml:mi>x</mml:mi><mml:mo>_</mml:mo></mml:munder><mml:mo>,</mml:mo><mml:mover><mml:mi>y</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mo>)</mml:mo></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>n</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>)</mml:mo></mml:mrow><mml:mo>;</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>r</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>)</mml:mo></mml:mrow><mml:mo>)</mml:mo><mml:mo>=</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="double-struck">P</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mi>A</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mi>A</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mi>B</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mi>B</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mi>C</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mi>C</mml:mi></mml:msub><mml:mo>∣</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:munder><mml:mi>x</mml:mi><mml:mo>_</mml:mo></mml:munder></mml:msub><mml:mo>=</mml:mo><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mover><mml:mi>y</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mi>n</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:munder><mml:mi>x</mml:mi><mml:mo>_</mml:mo></mml:munder></mml:msub><mml:mo>=</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mover><mml:mi>y</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mi>r</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>)</mml:mo><mml:mi mathvariant="double-struck">P</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:munder><mml:mi>x</mml:mi><mml:mo>_</mml:mo></mml:munder></mml:msub><mml:mo>=</mml:mo><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mover><mml:mi>y</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mi>n</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>.</p>
          </caption>
          <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1008380.g002" position="float"/>
        </fig>
        <p>For simplicity, when <italic toggle="yes">x</italic> is a branch incident to a leaf, we identify <inline-formula id="pcbi.1008380.e035"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1008380.e035.jpg" id="pcbi.1008380.e035g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M35" display="inline" overflow="scroll"><mml:munder><mml:mi>x</mml:mi><mml:mo>_</mml:mo></mml:munder></mml:math></alternatives></inline-formula> with that leaf. Two quantities that are known about each leaf are <inline-formula id="pcbi.1008380.e036"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1008380.e036.jpg" id="pcbi.1008380.e036g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M36" display="inline" overflow="scroll"><mml:msub><mml:mi>r</mml:mi><mml:munder><mml:mi>x</mml:mi><mml:mo>_</mml:mo></mml:munder></mml:msub></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1008380.e037"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1008380.e037.jpg" id="pcbi.1008380.e037g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M37" display="inline" overflow="scroll"><mml:msub><mml:mi>n</mml:mi><mml:munder><mml:mi>x</mml:mi><mml:mo>_</mml:mo></mml:munder></mml:msub></mml:math></alternatives></inline-formula>, which denote the number of red lineages sampled at <inline-formula id="pcbi.1008380.e038"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1008380.e038.jpg" id="pcbi.1008380.e038g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M38" display="inline" overflow="scroll"><mml:munder><mml:mi>x</mml:mi><mml:mo>_</mml:mo></mml:munder></mml:math></alternatives></inline-formula> and the total number of lineages sampled at <inline-formula id="pcbi.1008380.e039"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1008380.e039.jpg" id="pcbi.1008380.e039g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M39" display="inline" overflow="scroll"><mml:munder><mml:mi>x</mml:mi><mml:mo>_</mml:mo></mml:munder></mml:math></alternatives></inline-formula>, respectively. Note that <inline-formula id="pcbi.1008380.e040"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1008380.e040.jpg" id="pcbi.1008380.e040g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M40" display="inline" overflow="scroll"><mml:msub><mml:mi>N</mml:mi><mml:munder><mml:mi>x</mml:mi><mml:mo>_</mml:mo></mml:munder></mml:msub></mml:math></alternatives></inline-formula>, in this case, is non-random: indeed, it must necessarily equal <inline-formula id="pcbi.1008380.e041"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1008380.e041.jpg" id="pcbi.1008380.e041g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M41" display="inline" overflow="scroll"><mml:msub><mml:mi>n</mml:mi><mml:munder><mml:mi>x</mml:mi><mml:mo>_</mml:mo></mml:munder></mml:msub></mml:math></alternatives></inline-formula>, which is determined by the number of individuals sampled from that species. On the other hand, the model we adopt determines a distribution for the <inline-formula id="pcbi.1008380.e042"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1008380.e042.jpg" id="pcbi.1008380.e042g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M42" display="inline" overflow="scroll"><mml:msub><mml:mi>R</mml:mi><mml:munder><mml:mi>x</mml:mi><mml:mo>_</mml:mo></mml:munder></mml:msub></mml:math></alternatives></inline-formula>. The probability of the observed values <inline-formula id="pcbi.1008380.e043"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1008380.e043.jpg" id="pcbi.1008380.e043g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M43" display="inline" overflow="scroll"><mml:msub><mml:mi>r</mml:mi><mml:munder><mml:mi>x</mml:mi><mml:mo>_</mml:mo></mml:munder></mml:msub></mml:math></alternatives></inline-formula> for these random variables equals <inline-formula id="pcbi.1008380.e044"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1008380.e044.jpg" id="pcbi.1008380.e044g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M44" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="double-struck">P</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:mo>Ψ</mml:mo><mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>.</p>
        <p>Now let <bold>x</bold> be an ordered collection (i.e. a vector) of population interfaces. We use <bold>n</bold><sub><bold>x</bold></sub> (or <bold>r</bold><sub><bold>x</bold></sub>) to denote a vector of non-negative integers in a 1-to-1 correspondence with the elements of <bold>x</bold>. Then <italic toggle="yes">N</italic><sub><bold>x</bold></sub> = <bold>n</bold><sub><bold>x</bold></sub> is a shorthand for the equations expressing that the numbers of lineages in <bold>n</bold><sub><bold>x</bold></sub> are observed at the respective interfaces in <bold>x</bold>. For example, if <inline-formula id="pcbi.1008380.e045"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1008380.e045.jpg" id="pcbi.1008380.e045g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M45" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="bold">x</mml:mi><mml:mo>=</mml:mo><mml:mo>(</mml:mo><mml:munder><mml:mi>x</mml:mi><mml:mo>_</mml:mo></mml:munder><mml:mo>,</mml:mo><mml:mover><mml:mi>y</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> and <bold>n</bold><sub><bold>x</bold></sub> = (<italic toggle="yes">m</italic>, <italic toggle="yes">n</italic>), then <italic toggle="yes">N</italic><sub><bold>x</bold></sub> = <bold>n</bold><sub><bold>x</bold></sub> is a shorthand for <inline-formula id="pcbi.1008380.e046"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1008380.e046.jpg" id="pcbi.1008380.e046g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M46" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:munder><mml:mi>x</mml:mi><mml:mo>_</mml:mo></mml:munder></mml:msub><mml:mo>=</mml:mo><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mover><mml:mi>y</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:msub><mml:mo>=</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>. We use <italic toggle="yes">R</italic><sub><bold>x</bold></sub> = <bold>r</bold><sub><bold>x</bold></sub> analogously to express the observation of the numbers of red lineages in <bold>r</bold><sub><bold>x</bold></sub> at <bold>x</bold>.</p>
        <p>In order to calculate the likelihood <inline-formula id="pcbi.1008380.e047"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1008380.e047.jpg" id="pcbi.1008380.e047g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M47" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="double-struck">P</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:mo>Ψ</mml:mo><mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>, we subdivide the problem into that of calculating quantities that are analogous to partial likelihoods. Given a vector of population interfaces <bold>x</bold>, let <bold>L</bold>(<bold>x</bold>) denote a vector containing the leaves that descend from any element of <bold>x</bold>, and let <bold>r</bold><sub><bold>L</bold>(<bold>x</bold>)</sub> be the vector containing the numbers of red lineages <inline-formula id="pcbi.1008380.e048"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1008380.e048.jpg" id="pcbi.1008380.e048g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M48" display="inline" overflow="scroll"><mml:msub><mml:mi>r</mml:mi><mml:munder><mml:mi>x</mml:mi><mml:mo>_</mml:mo></mml:munder></mml:msub></mml:math></alternatives></inline-formula> observed at each leaf <inline-formula id="pcbi.1008380.e049"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1008380.e049.jpg" id="pcbi.1008380.e049g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M49" display="inline" overflow="scroll"><mml:munder><mml:mi>x</mml:mi><mml:mo>_</mml:mo></mml:munder></mml:math></alternatives></inline-formula> in <bold>L</bold>(<bold>x</bold>). Then we define:
<disp-formula id="pcbi.1008380.e050"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1008380.e050.jpg" id="pcbi.1008380.e050g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M50" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi mathvariant="bold">F</mml:mi><mml:mi mathvariant="bold">x</mml:mi></mml:msub><mml:mo>(</mml:mo><mml:msub><mml:mi mathvariant="bold">n</mml:mi><mml:mi mathvariant="bold">x</mml:mi></mml:msub><mml:mo>;</mml:mo><mml:msub><mml:mi mathvariant="bold">r</mml:mi><mml:mi mathvariant="bold">x</mml:mi></mml:msub><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mi mathvariant="double-struck">P</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mrow><mml:mi mathvariant="bold">L</mml:mi><mml:mo>(</mml:mo><mml:mi mathvariant="bold">x</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi mathvariant="bold">r</mml:mi><mml:mrow><mml:mi mathvariant="bold">L</mml:mi><mml:mo>(</mml:mo><mml:mi mathvariant="bold">x</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msub><mml:mo>∣</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi mathvariant="bold">x</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi mathvariant="bold">n</mml:mi><mml:mi mathvariant="bold">x</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mi mathvariant="bold">x</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi mathvariant="bold">r</mml:mi><mml:mi mathvariant="bold">x</mml:mi></mml:msub><mml:mo>)</mml:mo><mml:mo>·</mml:mo><mml:mi mathvariant="double-struck">P</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi mathvariant="bold">x</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi mathvariant="bold">n</mml:mi><mml:mi mathvariant="bold">x</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(2)</label></disp-formula>
(see <xref rid="pcbi.1008380.g002" ref-type="fig">Fig 2</xref>). These quantities are generalizations of similar quantities defined by Bryant et al. [<xref rid="pcbi.1008380.ref019" ref-type="bibr">19</xref>]. We will call them partial likelihoods, although, as noted by these authors, strictly speaking this is an abuse of language.</p>
      </sec>
      <sec id="sec011">
        <title>Computing partial likelihoods: The rules</title>
        <p>Here we show a set of rules that can be applied to compute partial likelihoods in a recursive way. Derivations and detailed proofs of the correctness of these rules can be found in Section 1 in <xref rid="pcbi.1008380.s001" ref-type="supplementary-material">S1 Text</xref>.</p>
        <p>We use the following conventions. In all the rules that follow, vectors of population interfaces <bold>x</bold>,<bold>y</bold>,<bold>z</bold> are allowed to be empty. The comma operator is used to concatenate vectors or append new elements at the end of vectors, for example, if <bold>a</bold> = (<italic toggle="yes">a</italic><sub>1</sub>, <italic toggle="yes">a</italic><sub>2</sub>, …, <italic toggle="yes">a</italic><sub><italic toggle="yes">k</italic></sub>) and <bold>b</bold> = (<italic toggle="yes">b</italic><sub>1</sub>, <italic toggle="yes">b</italic><sub>2</sub>, …, <italic toggle="yes">b</italic><sub><italic toggle="yes">h</italic></sub>), then <bold>a</bold>, <bold>b</bold> = (<italic toggle="yes">a</italic><sub>1</sub>, …, <italic toggle="yes">a</italic><sub><italic toggle="yes">k</italic></sub>, <italic toggle="yes">b</italic><sub>1</sub>, …, <italic toggle="yes">b</italic><sub><italic toggle="yes">h</italic></sub>) and <bold>a</bold>, <italic toggle="yes">c</italic> = (<italic toggle="yes">a</italic><sub>1</sub>, <italic toggle="yes">a</italic><sub>2</sub>, …, <italic toggle="yes">a</italic><sub><italic toggle="yes">k</italic></sub>, <italic toggle="yes">c</italic>). Trivially, if <bold>a</bold> is empty, then <bold>a</bold>, <bold>b</bold> = <bold>b</bold> and <bold>a</bold>, <italic toggle="yes">c</italic> = (<italic toggle="yes">c</italic>). A vector <bold>x</bold> of incomparable population interfaces is one where all pairs of population interfaces are incomparable. Finally, for any branch <italic toggle="yes">x</italic>, let <italic toggle="yes">m</italic><sub><italic toggle="yes">x</italic></sub> denote the number of lineages sampled in the descendant leaves of <italic toggle="yes">x</italic>.</p>
        <list list-type="simple">
          <list-item>
            <p><bold>Rule 0:</bold> Let <italic toggle="yes">x</italic> be a branch incident to a leaf. Then,
<disp-formula id="pcbi.1008380.e051"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1008380.e051.jpg" id="pcbi.1008380.e051g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M51" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi mathvariant="bold">F</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:munder><mml:mi>x</mml:mi><mml:mo>_</mml:mo></mml:munder><mml:mo>)</mml:mo></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mo>(</mml:mo><mml:mi>n</mml:mi><mml:mo>)</mml:mo><mml:mo>;</mml:mo><mml:mo>(</mml:mo><mml:mi>r</mml:mi><mml:mo>)</mml:mo><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mn mathvariant="double-struck">1</mml:mn><mml:mrow><mml:mo>{</mml:mo><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:munder><mml:mi>x</mml:mi><mml:mo>_</mml:mo></mml:munder></mml:msub><mml:mo>}</mml:mo></mml:mrow><mml:mo>·</mml:mo><mml:mn mathvariant="double-struck">1</mml:mn><mml:mrow><mml:mo>{</mml:mo><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:munder><mml:mi>x</mml:mi><mml:mo>_</mml:mo></mml:munder></mml:msub><mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula></p>
          </list-item>
          <list-item>
            <p><bold>Rule 1:</bold> Let <inline-formula id="pcbi.1008380.e052"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1008380.e052.jpg" id="pcbi.1008380.e052g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M52" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="bold">x</mml:mi><mml:mo>,</mml:mo><mml:munder><mml:mi>x</mml:mi><mml:mo>_</mml:mo></mml:munder></mml:mrow></mml:math></alternatives></inline-formula> be a vector of incomparable population interfaces. Then,
<disp-formula id="pcbi.1008380.e053"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1008380.e053.jpg" id="pcbi.1008380.e053g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M53" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi mathvariant="bold">F</mml:mi><mml:mrow><mml:mi mathvariant="bold">x</mml:mi><mml:mo>,</mml:mo><mml:mover><mml:mi>x</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:msub><mml:mi mathvariant="bold">n</mml:mi><mml:mi mathvariant="bold">x</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mover><mml:mi>x</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:msub><mml:mo>;</mml:mo><mml:msub><mml:mi mathvariant="bold">r</mml:mi><mml:mi mathvariant="bold">x</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mover><mml:mi>x</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:msub><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mover><mml:mi>x</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:msub></mml:mrow><mml:msub><mml:mi>m</mml:mi><mml:mi>x</mml:mi></mml:msub></mml:munderover><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:munderover><mml:msub><mml:mi mathvariant="bold">F</mml:mi><mml:mrow><mml:mi mathvariant="bold">x</mml:mi><mml:mo>,</mml:mo><mml:munder><mml:mi>x</mml:mi><mml:mo>_</mml:mo></mml:munder></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:msub><mml:mi mathvariant="bold">n</mml:mi><mml:mi mathvariant="bold">x</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi>n</mml:mi><mml:mo>;</mml:mo><mml:msub><mml:mi mathvariant="bold">r</mml:mi><mml:mi mathvariant="bold">x</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi>r</mml:mi><mml:mo>)</mml:mo><mml:mo form="prefix">exp</mml:mo><mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi mathvariant="double-struck">Q</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:msub><mml:mi>t</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>r</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>;</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mover><mml:mi>x</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mover><mml:mi>x</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
where <italic toggle="yes">t</italic><sub><italic toggle="yes">x</italic></sub> denotes the length of branch <italic toggle="yes">x</italic>, and <inline-formula id="pcbi.1008380.e054"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1008380.e054.jpg" id="pcbi.1008380.e054g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M54" display="inline" overflow="scroll"><mml:msub><mml:mi mathvariant="double-struck">Q</mml:mi><mml:mi>x</mml:mi></mml:msub></mml:math></alternatives></inline-formula> is the rate matrix defined by Bryant et al. [<xref rid="pcbi.1008380.ref019" ref-type="bibr">19</xref>, p. 1922] that accounts for both coalescence and mutation (see also Section 1 in <xref rid="pcbi.1008380.s001" ref-type="supplementary-material">S1 Text</xref>).</p>
          </list-item>
          <list-item>
            <p><bold>Rule 2:</bold> Let <inline-formula id="pcbi.1008380.e055"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1008380.e055.jpg" id="pcbi.1008380.e055g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M55" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="bold">x</mml:mi><mml:mo>,</mml:mo><mml:mover><mml:mi>x</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:mrow></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1008380.e056"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1008380.e056.jpg" id="pcbi.1008380.e056g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M56" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="bold">y</mml:mi><mml:mo>,</mml:mo><mml:mover><mml:mi>y</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:mrow></mml:math></alternatives></inline-formula> be two vectors of incomparable population interfaces, such that <inline-formula id="pcbi.1008380.e057"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1008380.e057.jpg" id="pcbi.1008380.e057g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M57" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="bold">L</mml:mi><mml:mo>(</mml:mo><mml:mi mathvariant="bold">x</mml:mi><mml:mo>,</mml:mo><mml:mover><mml:mi>x</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1008380.e058"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1008380.e058.jpg" id="pcbi.1008380.e058g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M58" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="bold">L</mml:mi><mml:mo>(</mml:mo><mml:mi mathvariant="bold">y</mml:mi><mml:mo>,</mml:mo><mml:mover><mml:mi>y</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> have no leaf in common. If <italic toggle="yes">x</italic> and <italic toggle="yes">y</italic> are the immediate descendants of a branch <italic toggle="yes">z</italic>, as in <xref rid="pcbi.1008380.g003" ref-type="fig">Fig 3</xref>, then,
<disp-formula id="pcbi.1008380.e059"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1008380.e059.jpg" id="pcbi.1008380.e059g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M59" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi mathvariant="bold">F</mml:mi><mml:mrow><mml:mi mathvariant="bold">x</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">y</mml:mi><mml:mo>,</mml:mo><mml:munder><mml:mi>z</mml:mi><mml:mo>_</mml:mo></mml:munder></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:msub><mml:mi mathvariant="bold">n</mml:mi><mml:mi mathvariant="bold">x</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="bold">n</mml:mi><mml:mi mathvariant="bold">y</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:munder><mml:mi>z</mml:mi><mml:mo>_</mml:mo></mml:munder></mml:msub><mml:mo>;</mml:mo><mml:msub><mml:mi mathvariant="bold">r</mml:mi><mml:mi mathvariant="bold">x</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="bold">r</mml:mi><mml:mi mathvariant="bold">y</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:munder><mml:mi>z</mml:mi><mml:mo>_</mml:mo></mml:munder></mml:msub><mml:mo>)</mml:mo><mml:mo>=</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mover><mml:mi>x</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:msub></mml:munder><mml:munder><mml:mo>∑</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mover><mml:mi>x</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:msub></mml:munder><mml:msub><mml:mi mathvariant="bold">F</mml:mi><mml:mrow><mml:mi mathvariant="bold">x</mml:mi><mml:mo>,</mml:mo><mml:mover><mml:mi>x</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:msub><mml:mi mathvariant="bold">n</mml:mi><mml:mi mathvariant="bold">x</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mover><mml:mi>x</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:msub><mml:mo>;</mml:mo><mml:msub><mml:mi mathvariant="bold">r</mml:mi><mml:mi mathvariant="bold">x</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mover><mml:mi>x</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:msub><mml:mo>)</mml:mo><mml:msub><mml:mi mathvariant="bold">F</mml:mi><mml:mrow><mml:mi mathvariant="bold">y</mml:mi><mml:mo>,</mml:mo><mml:mover><mml:mi>y</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:msub><mml:mi mathvariant="bold">n</mml:mi><mml:mi mathvariant="bold">y</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:munder><mml:mi>z</mml:mi><mml:mo>_</mml:mo></mml:munder></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mover><mml:mi>x</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:msub><mml:mo>;</mml:mo><mml:msub><mml:mi mathvariant="bold">r</mml:mi><mml:mi mathvariant="bold">y</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:munder><mml:mi>z</mml:mi><mml:mo>_</mml:mo></mml:munder></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mover><mml:mi>x</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:msub><mml:mo>)</mml:mo><mml:mrow><mml:mfenced><mml:mrow><mml:msubsup><mml:mrow/><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:msub></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced><mml:mfenced><mml:mrow><mml:msubsup><mml:mrow/><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:munder accentunder="true"><mml:mi>z</mml:mi><mml:mo>_</mml:mo></mml:munder></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:munder accentunder="true"><mml:mi>z</mml:mi><mml:mo>_</mml:mo></mml:munder></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:msub></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced><mml:msup><mml:mrow><mml:mfenced><mml:mrow><mml:msubsup><mml:mrow/><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:munder accentunder="true"><mml:mi>z</mml:mi><mml:mo>_</mml:mo></mml:munder></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:munder accentunder="true"><mml:mi>z</mml:mi><mml:mo>_</mml:mo></mml:munder></mml:msub></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula></p>
            <p>The ranges of <inline-formula id="pcbi.1008380.e060"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1008380.e060.jpg" id="pcbi.1008380.e060g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M60" display="inline" overflow="scroll"><mml:msub><mml:mi>n</mml:mi><mml:mover><mml:mi>x</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:msub></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1008380.e061"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1008380.e061.jpg" id="pcbi.1008380.e061g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M61" display="inline" overflow="scroll"><mml:msub><mml:mi>r</mml:mi><mml:mover><mml:mi>x</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:msub></mml:math></alternatives></inline-formula> in the summation terms are defined by <inline-formula id="pcbi.1008380.e062"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1008380.e062.jpg" id="pcbi.1008380.e062g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M62" display="inline" overflow="scroll"><mml:mrow><mml:mo form="prefix" movablelimits="true">max</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:munder><mml:mi>z</mml:mi><mml:mo>_</mml:mo></mml:munder></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mi>y</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>≤</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mover><mml:mi>x</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:msub><mml:mo>≤</mml:mo><mml:mo form="prefix" movablelimits="true">min</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:munder><mml:mi>z</mml:mi><mml:mo>_</mml:mo></mml:munder></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1008380.e063"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1008380.e063.jpg" id="pcbi.1008380.e063g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M63" display="inline" overflow="scroll"><mml:mrow><mml:mo form="prefix" movablelimits="true">max</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mover><mml:mi>x</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:munder><mml:mi>z</mml:mi><mml:mo>_</mml:mo></mml:munder></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:munder><mml:mi>z</mml:mi><mml:mo>_</mml:mo></mml:munder></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>≤</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mover><mml:mi>x</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:msub><mml:mo>≤</mml:mo><mml:mo form="prefix" movablelimits="true">min</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mover><mml:mi>x</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:munder><mml:mi>z</mml:mi><mml:mo>_</mml:mo></mml:munder></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>.</p>
          </list-item>
          <list-item>
            <p><bold>Rule 3:</bold> Let <inline-formula id="pcbi.1008380.e064"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1008380.e064.jpg" id="pcbi.1008380.e064g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M64" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="bold">x</mml:mi><mml:mo>,</mml:mo><mml:mover><mml:mi>x</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:mrow></mml:math></alternatives></inline-formula> be a vector of incomparable population interfaces, such that branch <italic toggle="yes">x</italic>’s top node is a reticulation node. Let <italic toggle="yes">y</italic>, <italic toggle="yes">z</italic> be the branches immediately ancestral to <italic toggle="yes">x</italic>, as in <xref rid="pcbi.1008380.g004" ref-type="fig">Fig 4</xref>. Then,
<disp-formula id="pcbi.1008380.e065"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1008380.e065.jpg" id="pcbi.1008380.e065g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M65" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mspace width="-28.45274pt"/><mml:msub><mml:mi mathvariant="bold">F</mml:mi><mml:mrow><mml:mi mathvariant="bold">x</mml:mi><mml:mo>,</mml:mo><mml:munder><mml:mi>y</mml:mi><mml:mo>_</mml:mo></mml:munder><mml:mo>,</mml:mo><mml:munder><mml:mi>z</mml:mi><mml:mo>_</mml:mo></mml:munder></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:msub><mml:mi mathvariant="bold">n</mml:mi><mml:mi mathvariant="bold">x</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:munder><mml:mi>y</mml:mi><mml:mo>_</mml:mo></mml:munder></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:munder><mml:mi>z</mml:mi><mml:mo>_</mml:mo></mml:munder></mml:msub><mml:mo>;</mml:mo><mml:msub><mml:mi mathvariant="bold">r</mml:mi><mml:mi mathvariant="bold">x</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:munder><mml:mi>y</mml:mi><mml:mo>_</mml:mo></mml:munder></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:munder><mml:mi>z</mml:mi><mml:mo>_</mml:mo></mml:munder></mml:msub><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mi mathvariant="bold">F</mml:mi><mml:mrow><mml:mi mathvariant="bold">x</mml:mi><mml:mo>,</mml:mo><mml:mover><mml:mi>x</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:msub><mml:mi mathvariant="bold">n</mml:mi><mml:mi mathvariant="bold">x</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:munder><mml:mi>y</mml:mi><mml:mo>_</mml:mo></mml:munder></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:munder><mml:mi>z</mml:mi><mml:mo>_</mml:mo></mml:munder></mml:msub><mml:mo>;</mml:mo><mml:msub><mml:mi mathvariant="bold">r</mml:mi><mml:mi mathvariant="bold">x</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:munder><mml:mi>y</mml:mi><mml:mo>_</mml:mo></mml:munder></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:munder><mml:mi>z</mml:mi><mml:mo>_</mml:mo></mml:munder></mml:msub><mml:mo>)</mml:mo><mml:mrow><mml:msubsup><mml:mi>γ</mml:mi><mml:mrow><mml:msub><mml:mrow/><mml:mi>y</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:munder accentunder="true"><mml:mi>y</mml:mi><mml:mo>_</mml:mo></mml:munder></mml:msub></mml:mrow></mml:msubsup><mml:mo>·</mml:mo><mml:msubsup><mml:mi>γ</mml:mi><mml:mi>z</mml:mi><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:munder accentunder="true"><mml:mi>z</mml:mi><mml:mo>_</mml:mo></mml:munder></mml:msub></mml:mrow></mml:msubsup></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula></p>
          </list-item>
          <list-item>
            <p><bold>Rule 4:</bold> Let <inline-formula id="pcbi.1008380.e066"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1008380.e066.jpg" id="pcbi.1008380.e066g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M66" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="bold">z</mml:mi><mml:mo>,</mml:mo><mml:mover><mml:mi>x</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mo>,</mml:mo><mml:mover><mml:mi>y</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:mrow></mml:math></alternatives></inline-formula> be a vector of incomparable population interfaces, and let <italic toggle="yes">x</italic>, <italic toggle="yes">y</italic> be immediate descendants of branch <italic toggle="yes">z</italic>, as in <xref rid="pcbi.1008380.g005" ref-type="fig">Fig 5</xref>. Then,
<disp-formula id="pcbi.1008380.e067"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1008380.e067.jpg" id="pcbi.1008380.e067g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M67" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi mathvariant="bold">F</mml:mi><mml:mrow><mml:mi mathvariant="bold">z</mml:mi><mml:mo>,</mml:mo><mml:munder><mml:mi>z</mml:mi><mml:mo>_</mml:mo></mml:munder></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:msub><mml:mi mathvariant="bold">n</mml:mi><mml:mi mathvariant="bold">z</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:munder><mml:mi>z</mml:mi><mml:mo>_</mml:mo></mml:munder></mml:msub><mml:mo>;</mml:mo><mml:msub><mml:mi mathvariant="bold">r</mml:mi><mml:mi mathvariant="bold">z</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:munder><mml:mi>z</mml:mi><mml:mo>_</mml:mo></mml:munder></mml:msub><mml:mo>)</mml:mo><mml:mo>=</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mover><mml:mi>x</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:msub></mml:munder><mml:munder><mml:mo>∑</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mover><mml:mi>x</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:msub></mml:munder><mml:msub><mml:mi mathvariant="bold">F</mml:mi><mml:mrow><mml:mi mathvariant="bold">z</mml:mi><mml:mo>,</mml:mo><mml:mover><mml:mi>x</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mo>,</mml:mo><mml:mover><mml:mi>y</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:msub><mml:mi mathvariant="bold">n</mml:mi><mml:mi mathvariant="bold">z</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mover><mml:mi>x</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:munder><mml:mi>z</mml:mi><mml:mo>_</mml:mo></mml:munder></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mover><mml:mi>x</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:msub><mml:mo>;</mml:mo><mml:msub><mml:mi mathvariant="bold">r</mml:mi><mml:mi mathvariant="bold">z</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mover><mml:mi>x</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:munder><mml:mi>z</mml:mi><mml:mo>_</mml:mo></mml:munder></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mover><mml:mi>x</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:msub><mml:mo>)</mml:mo><mml:mrow><mml:mfenced><mml:mrow><mml:msubsup><mml:mrow/><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:msub></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced><mml:mfenced><mml:mrow><mml:msubsup><mml:mrow/><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:munder accentunder="true"><mml:mi>z</mml:mi><mml:mo>_</mml:mo></mml:munder></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:munder accentunder="true"><mml:mi>z</mml:mi><mml:mo>_</mml:mo></mml:munder></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:msub></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced><mml:msup><mml:mrow><mml:mfenced><mml:mrow><mml:msubsup><mml:mrow/><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:munder accentunder="true"><mml:mi>z</mml:mi><mml:mo>_</mml:mo></mml:munder></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:munder accentunder="true"><mml:mi>z</mml:mi><mml:mo>_</mml:mo></mml:munder></mml:msub></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula></p>
            <p>The ranges of <inline-formula id="pcbi.1008380.e068"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1008380.e068.jpg" id="pcbi.1008380.e068g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M68" display="inline" overflow="scroll"><mml:msub><mml:mi>n</mml:mi><mml:mover><mml:mi>x</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:msub></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1008380.e069"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1008380.e069.jpg" id="pcbi.1008380.e069g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M69" display="inline" overflow="scroll"><mml:msub><mml:mi>r</mml:mi><mml:mover><mml:mi>x</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:msub></mml:math></alternatives></inline-formula> in the sums are the same as those in Rule 2.</p>
          </list-item>
        </list>
        <fig position="float" id="pcbi.1008380.g003">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1008380.g003</object-id>
          <label>Fig 3</label>
          <caption>
            <title>Illustration of Rule 2.</title>
            <p>Given (a) the partial likelihoods for the <inline-formula id="pcbi.1008380.e070"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1008380.e070" id="pcbi.1008380.e070g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M70" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="bold">x</mml:mi><mml:mo>,</mml:mo><mml:mover><mml:mi>x</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:mrow></mml:math></alternatives></inline-formula> (red) vector of population interfaces and the partial likelihoods for the <inline-formula id="pcbi.1008380.e071"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1008380.e071" id="pcbi.1008380.e071g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M71" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="bold">y</mml:mi><mml:mo>,</mml:mo><mml:mover><mml:mi>y</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:mrow></mml:math></alternatives></inline-formula> (blue) vector of population interfaces, Rule 2 allows us to compute the partial likelihoods for the (green) vector <inline-formula id="pcbi.1008380.e072"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1008380.e072" id="pcbi.1008380.e072g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M72" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="bold">x</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">y</mml:mi><mml:mo>,</mml:mo><mml:munder><mml:mi>z</mml:mi><mml:mo>_</mml:mo></mml:munder></mml:mrow></mml:math></alternatives></inline-formula> (b).</p>
          </caption>
          <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1008380.g003" position="float"/>
        </fig>
        <fig position="float" id="pcbi.1008380.g004">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1008380.g004</object-id>
          <label>Fig 4</label>
          <caption>
            <title>Illustration of Rule 3.</title>
            <p>Given (a) the partial likelihoods for the <inline-formula id="pcbi.1008380.e073"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1008380.e073" id="pcbi.1008380.e073g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M73" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="bold">x</mml:mi><mml:mo>,</mml:mo><mml:mover><mml:mi>x</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:mrow></mml:math></alternatives></inline-formula> (red) vector of population interfaces, Rule 3 allows us to compute the partial likelihoods for the (green) vector <inline-formula id="pcbi.1008380.e074"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1008380.e074" id="pcbi.1008380.e074g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M74" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="bold">x</mml:mi><mml:mo>,</mml:mo><mml:munder><mml:mi>y</mml:mi><mml:mo>_</mml:mo></mml:munder><mml:mo>,</mml:mo><mml:munder><mml:mi>z</mml:mi><mml:mo>_</mml:mo></mml:munder></mml:mrow></mml:math></alternatives></inline-formula> (b).</p>
          </caption>
          <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1008380.g004" position="float"/>
        </fig>
        <fig position="float" id="pcbi.1008380.g005">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1008380.g005</object-id>
          <label>Fig 5</label>
          <caption>
            <title>Illustration of Rule 4.</title>
            <p>Given (a) the partial likelihoods for the <inline-formula id="pcbi.1008380.e075"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1008380.e075" id="pcbi.1008380.e075g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M75" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="bold">z</mml:mi><mml:mo>,</mml:mo><mml:mover><mml:mi>x</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mo>,</mml:mo><mml:mover><mml:mi>y</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:mrow></mml:math></alternatives></inline-formula> (red) vector of population interfaces, Rule 4 allows us to compute the partial likelihoods for the (green) vector <inline-formula id="pcbi.1008380.e076"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1008380.e076" id="pcbi.1008380.e076g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M76" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="bold">z</mml:mi><mml:mo>,</mml:mo><mml:munder><mml:mi>z</mml:mi><mml:mo>_</mml:mo></mml:munder></mml:mrow></mml:math></alternatives></inline-formula> (b).</p>
          </caption>
          <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1008380.g005" position="float"/>
        </fig>
        <p>Note that, in the rules above, we assume that the vectors of population interfaces (<italic toggle="yes">VPIs</italic> from here on) on the right-hand side of each equation only contain incomparable population interfaces. This is necessary to ensure the validity of the rules (see Section 1 in <xref rid="pcbi.1008380.s001" ref-type="supplementary-material">S1 Text</xref>). It is easy to verify that, as a consequence of that assumption, also the VPIs on the left-hand side of each equation only contain incomparable population interfaces. Therefore, repeated application of the rules can only result in a partial likelihood <bold>F</bold><sub><bold>x</bold></sub>(<bold>n</bold><sub><bold>x</bold></sub>;<bold>r</bold><sub><bold>x</bold></sub>) where <bold>x</bold> is a vector of incomparable population interfaces. Thus, all VPIs that we will deal with only contain incomparable population interfaces.</p>
        <p>Repeated application of the rules above, performed by an algorithm described in the next subsection, leads eventually to the partial likelihoods for <inline-formula id="pcbi.1008380.e077"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1008380.e077.jpg" id="pcbi.1008380.e077g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M77" display="inline" overflow="scroll"><mml:munder><mml:mi>ρ</mml:mi><mml:mo>_</mml:mo></mml:munder></mml:math></alternatives></inline-formula>, the population interface immediately above the root of the network (i.e, <italic toggle="yes">ρ</italic> is the branch linking the origin to the root). From these partial likelihoods, the full likelihood <inline-formula id="pcbi.1008380.e078"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1008380.e078.jpg" id="pcbi.1008380.e078g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M78" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="double-struck">P</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:mo>Ψ</mml:mo><mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> is computed as follows:
<disp-formula id="pcbi.1008380.e079"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1008380.e079.jpg" id="pcbi.1008380.e079g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M79" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi mathvariant="double-struck">P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>∣</mml:mo><mml:mo>Ψ</mml:mo><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:msub><mml:mi>m</mml:mi><mml:mi>ρ</mml:mi></mml:msub></mml:munderover><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:munderover><mml:msub><mml:mi mathvariant="bold">F</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:munder><mml:mi>ρ</mml:mi><mml:mo>_</mml:mo></mml:munder><mml:mo>)</mml:mo></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>n</mml:mi><mml:mo>;</mml:mo><mml:mi>r</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>·</mml:mo><mml:mi mathvariant="double-struck">P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:munder><mml:mi>ρ</mml:mi><mml:mo>_</mml:mo></mml:munder></mml:msub><mml:mo>=</mml:mo><mml:mi>r</mml:mi><mml:mo>∣</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:munder><mml:mi>ρ</mml:mi><mml:mo>_</mml:mo></mml:munder></mml:msub><mml:mo>=</mml:mo><mml:mi>n</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(3)</label></disp-formula>
where the conditional probabilities <inline-formula id="pcbi.1008380.e080"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1008380.e080.jpg" id="pcbi.1008380.e080g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M80" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="double-struck">P</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:munder><mml:mi>ρ</mml:mi><mml:mo>_</mml:mo></mml:munder></mml:msub><mml:mo>=</mml:mo><mml:mi>r</mml:mi><mml:mo>∣</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:munder><mml:mi>ρ</mml:mi><mml:mo>_</mml:mo></mml:munder></mml:msub><mml:mo>=</mml:mo><mml:mi>n</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> are obtained as described by Bryant et al. [<xref rid="pcbi.1008380.ref019" ref-type="bibr">19</xref>]. Note that the length of branch <italic toggle="yes">ρ</italic> does not play any role in the computation of the likelihood, so it is not identifiable.</p>
      </sec>
      <sec id="sec012">
        <title>Likelihood computation</title>
        <p>We now describe the algorithm that allows S<sc>napp</sc>N<sc>et</sc> to derive the full likelihood <inline-formula id="pcbi.1008380.e081"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1008380.e081.jpg" id="pcbi.1008380.e081g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M81" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="double-struck">P</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:mo>Ψ</mml:mo><mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> using the rules introduced above. We refer to Section 2 in <xref rid="pcbi.1008380.s001" ref-type="supplementary-material">S1 Text</xref> for detailed pseudocode.</p>
        <p>The central ingredient of this algorithm are the partial likelihoods for a VPI <bold>x</bold>, which are stored in a matrix with potentially high dimension, denoted <bold>F</bold><sub><bold>x</bold></sub>. We say that a VPI <bold>x</bold> is <italic toggle="yes">active</italic> at some point during the execution of the algorithm, if: (1) <bold>F</bold><sub><bold>x</bold></sub> has been computed by the algorithm, (2) <bold>F</bold><sub><bold>x</bold></sub> has not yet been used to compute the partial likelihoods for another VPI. To reduce memory usage, we only store <bold>F</bold><sub><bold>x</bold></sub> for active VPIs.</p>
        <p>In a nutshell, the algorithm traverses each node in the network following a topological sort [<xref rid="pcbi.1008380.ref064" ref-type="bibr">64</xref>], that is, in an order ensuring that a node is only traversed after all its descendants have been traversed. Every node traversal involves deriving the partial likelihoods of a newly active VPI from those of at most two VPIs that, as a result, become inactive. Eventually, the root of the network is traversed, at which point the only active VPI is <inline-formula id="pcbi.1008380.e082"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1008380.e082.jpg" id="pcbi.1008380.e082g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M82" display="inline" overflow="scroll"><mml:mrow><mml:mo>(</mml:mo><mml:munder><mml:mi>ρ</mml:mi><mml:mo>_</mml:mo></mml:munder><mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> and the full likelihood of the network is computed from <inline-formula id="pcbi.1008380.e083"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1008380.e083.jpg" id="pcbi.1008380.e083g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M83" display="inline" overflow="scroll"><mml:msub><mml:mi mathvariant="bold">F</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:munder><mml:mi>ρ</mml:mi><mml:mo>_</mml:mo></mml:munder><mml:mo>)</mml:mo></mml:mrow></mml:msub></mml:math></alternatives></inline-formula> using <xref rid="pcbi.1008380.e079" ref-type="disp-formula">Eq 3</xref>.</p>
        <p>In more detail, a node is ready to be traversed when all its child nodes have been traversed. At the beginning, only leaves can be traversed and their partial likelihoods <inline-formula id="pcbi.1008380.e084"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1008380.e084.jpg" id="pcbi.1008380.e084g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M84" display="inline" overflow="scroll"><mml:msub><mml:mi mathvariant="bold">F</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:munder><mml:mi>x</mml:mi><mml:mo>_</mml:mo></mml:munder><mml:mo>)</mml:mo></mml:mrow></mml:msub></mml:math></alternatives></inline-formula> are obtained by application of Rule 0, followed by Rule 1 to obtain <inline-formula id="pcbi.1008380.e085"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1008380.e085.jpg" id="pcbi.1008380.e085g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M85" display="inline" overflow="scroll"><mml:msub><mml:mi mathvariant="bold">F</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mover><mml:mi>x</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mo>)</mml:mo></mml:mrow></mml:msub></mml:math></alternatives></inline-formula>. Every subsequent traversal of a node <italic toggle="yes">d</italic> entails application of one rule among Rules 2, 3 or 4, depending on whether <italic toggle="yes">d</italic> is a tree node and on whether the branch(es) topped by <italic toggle="yes">d</italic> correspond to more than one VPI (see Figs <xref rid="pcbi.1008380.g003" ref-type="fig">3</xref>–<xref rid="pcbi.1008380.g005" ref-type="fig">5</xref>). The selected rule computes <bold>F</bold><sub><bold>x</bold></sub> for a newly active VPI <bold>x</bold>. This is then followed by application of Rule 1 to replace every occurrence of any population interface <inline-formula id="pcbi.1008380.e086"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1008380.e086.jpg" id="pcbi.1008380.e086g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M86" display="inline" overflow="scroll"><mml:munder><mml:mi>x</mml:mi><mml:mo>_</mml:mo></mml:munder></mml:math></alternatives></inline-formula> in <bold>x</bold> with <inline-formula id="pcbi.1008380.e087"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1008380.e087.jpg" id="pcbi.1008380.e087g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M87" display="inline" overflow="scroll"><mml:mover><mml:mi>x</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:math></alternatives></inline-formula>.</p>
        <p>It is helpful to note that at any moment, the set of active VPIs forms a frontier separating the nodes that have already been traversed, from those that have not yet been traversed (i.e., if branch <italic toggle="yes">x</italic> = (<italic toggle="yes">d</italic>, <italic toggle="yes">e</italic>) with <italic toggle="yes">d</italic> not traversed and <italic toggle="yes">e</italic> traversed, then there must be an active VPI with <inline-formula id="pcbi.1008380.e088"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1008380.e088.jpg" id="pcbi.1008380.e088g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M88" display="inline" overflow="scroll"><mml:munder><mml:mi>x</mml:mi><mml:mo>_</mml:mo></mml:munder></mml:math></alternatives></inline-formula> or <inline-formula id="pcbi.1008380.e089"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1008380.e089.jpg" id="pcbi.1008380.e089g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M89" display="inline" overflow="scroll"><mml:mover><mml:mi>x</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:math></alternatives></inline-formula> among its population interfaces). Any node that lies immediately above this frontier can be the next one to be traversed. Thus, there is some latitude in the choice of the complete order in which nodes are traversed. Different orders will lead to different VPIs being activated by the algorithm, which in turn will lead to different running times. In fact, running times are largely determined by the sizes of the VPIs encountered. This point is explored further in the next section.</p>
        <p>The correctness of our implementation of the algorithm above was confirmed by comparing the likelihoods we obtain to those computed with <monospace>MCMC_BiMarkers</monospace>, which also relies on biallelic marker data [<xref rid="pcbi.1008380.ref054" ref-type="bibr">54</xref>].</p>
      </sec>
      <sec id="sec013">
        <title>Time complexity of computing the likelihood</title>
        <p>Our approach improves the running times by several orders of magnitude with respect to <monospace>MCMC_BiMarkers</monospace> [<xref rid="pcbi.1008380.ref054" ref-type="bibr">54</xref>]. This is clearly apparent for some experiments detailed in the <xref rid="sec022" ref-type="sec">Results</xref> section, but it can also be understood by comparing computational complexities.</p>
        <p>Here, let <italic toggle="yes">n</italic> be the total number of individuals sampled, and let <italic toggle="yes">s</italic> denote the size of the species network Ψ (i.e. its number of branches or its number of nodes). Let us first examine the running time to process one node in Ψ. For any of Rules 0–4, let <italic toggle="yes">K</italic> be the number of population interfaces in the VPI for which partial likelihoods are being computed, that is, <italic toggle="yes">K</italic> is the number of elements of <inline-formula id="pcbi.1008380.e090"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1008380.e090.jpg" id="pcbi.1008380.e090g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M90" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="bold">x</mml:mi><mml:mo>,</mml:mo><mml:mover><mml:mi>x</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:mrow></mml:math></alternatives></inline-formula> for Rule 1, that of <inline-formula id="pcbi.1008380.e091"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1008380.e091.jpg" id="pcbi.1008380.e091g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M91" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="bold">x</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">y</mml:mi><mml:mo>,</mml:mo><mml:munder><mml:mi>z</mml:mi><mml:mo>_</mml:mo></mml:munder></mml:mrow></mml:math></alternatives></inline-formula> for Rule 2, and so on. These partial likelihoods are stored in a 2<italic toggle="yes">K</italic>-dimensional matrix, with <italic toggle="yes">O</italic>(<italic toggle="yes">n</italic><sup>2<italic toggle="yes">K</italic></sup>) elements. Each rule specifies how to compute an element of this matrix in at most <italic toggle="yes">O</italic>(<italic toggle="yes">n</italic><sup>2</sup>) operations (in fact rules 0 and 3 only require <italic toggle="yes">O</italic>(1) operations). Thus, any node in the network can be processed in <italic toggle="yes">O</italic>(<italic toggle="yes">n</italic><sup>2<italic toggle="yes">K</italic>+2</sup>) time.</p>
        <p>Since the running time of any other step—i.e. computing <xref rid="pcbi.1008380.e079" ref-type="disp-formula">Eq 3</xref>, and <inline-formula id="pcbi.1008380.e092"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1008380.e092.jpg" id="pcbi.1008380.e092g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M92" display="inline" overflow="scroll"><mml:mrow><mml:mo form="prefix">exp</mml:mo><mml:mo>(</mml:mo><mml:msub><mml:mi mathvariant="double-struck">Q</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:msub><mml:mi>t</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>—is dominated by these terms, the total running time is <inline-formula id="pcbi.1008380.e093"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1008380.e093.jpg" id="pcbi.1008380.e093g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M93" display="inline" overflow="scroll"><mml:mrow><mml:mi>O</mml:mi><mml:mo>(</mml:mo><mml:mi>s</mml:mi><mml:msup><mml:mi>n</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mover><mml:mi>K</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mo>+</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>, where <inline-formula id="pcbi.1008380.e094"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1008380.e094.jpg" id="pcbi.1008380.e094g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M94" display="inline" overflow="scroll"><mml:mover><mml:mi>K</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:math></alternatives></inline-formula> is the maximum number of population interfaces in a VPI activated by the given traversal, and where s is the size of the species network.</p>
        <p>Let us now compare this to the complexity of the likelihood computations described by Zhu et al. [<xref rid="pcbi.1008380.ref054" ref-type="bibr">54</xref>]. Processing a node <italic toggle="yes">d</italic> of the network in their algorithm involves at most <inline-formula id="pcbi.1008380.e133"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1008380.e133.jpg" id="pcbi.1008380.e133g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M133" display="inline" overflow="scroll"><mml:mrow><mml:mi>O</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>n</mml:mi><mml:mrow><mml:mn>4</mml:mn><mml:msub><mml:mi>r</mml:mi><mml:mi>d</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> time, where <italic toggle="yes">r</italic><sub><italic toggle="yes">d</italic></sub> is the number of reticulation nodes which descend from <italic toggle="yes">d</italic>, and for which there exists a path from <italic toggle="yes">d</italic> that does not pass via a <italic toggle="yes">lowest articulation node</italic> (see definitions in Zhu et al. [<xref rid="pcbi.1008380.ref054" ref-type="bibr">54</xref>]). In Section 3 of <xref rid="pcbi.1008380.s001" ref-type="supplementary-material">S1 Text</xref>, we show that this entails a total running time of <italic toggle="yes">O</italic>(<italic toggle="yes">sn</italic><sup>4<italic toggle="yes">ℓ</italic>+4</sup>), where <italic toggle="yes">ℓ</italic> is the <italic toggle="yes">level</italic> of the network [<xref rid="pcbi.1008380.ref032" ref-type="bibr">32</xref>, <xref rid="pcbi.1008380.ref065" ref-type="bibr">65</xref>].</p>
        <p>Thus, the improvement in running times with respect to the algorithm by Zhu et al. [<xref rid="pcbi.1008380.ref054" ref-type="bibr">54</xref>] relies on the fact that <inline-formula id="pcbi.1008380.e095"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1008380.e095.jpg" id="pcbi.1008380.e095g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M95" display="inline" overflow="scroll"><mml:mrow><mml:mn>2</mml:mn><mml:mover><mml:mi>K</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mo>+</mml:mo><mml:mn>2</mml:mn><mml:mo>≪</mml:mo><mml:mn>4</mml:mn><mml:mi>ℓ</mml:mi><mml:mo>+</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>. One way of seeing this is to remark that, for any traversal of the network, <inline-formula id="pcbi.1008380.e096"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1008380.e096.jpg" id="pcbi.1008380.e096g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M96" display="inline" overflow="scroll"><mml:mrow><mml:mover><mml:mi>K</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mo>≤</mml:mo><mml:mi>ℓ</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>. We refer to Section 3 in <xref rid="pcbi.1008380.s001" ref-type="supplementary-material">S1 Text</xref> for a proof of this result. Assuming that <inline-formula id="pcbi.1008380.e097"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1008380.e097.jpg" id="pcbi.1008380.e097g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M97" display="inline" overflow="scroll"><mml:mover><mml:mi>K</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:math></alternatives></inline-formula> and <italic toggle="yes">ℓ</italic> are close, this would imply that the exponent of <italic toggle="yes">n</italic> in the worst-case time complexity is roughly halved with respect to Zhu et al. [<xref rid="pcbi.1008380.ref054" ref-type="bibr">54</xref>]. However, <inline-formula id="pcbi.1008380.e098"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1008380.e098.jpg" id="pcbi.1008380.e098g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M98" display="inline" overflow="scroll"><mml:mover><mml:mi>K</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:math></alternatives></inline-formula> is potentially much smaller than the level <italic toggle="yes">ℓ</italic>, as depicted in <xref rid="pcbi.1008380.g006" ref-type="fig">Fig 6</xref>.</p>
        <fig position="float" id="pcbi.1008380.g006">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1008380.g006</object-id>
          <label>Fig 6</label>
          <caption>
            <title>Example of a phylogenetic network where the level <italic toggle="yes">ℓ</italic> is equal to 6 (the reticulation nodes are depicted in grey), while <inline-formula id="pcbi.1008380.e099"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1008380.e099" id="pcbi.1008380.e099g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M99" display="inline" overflow="scroll"><mml:mrow><mml:mover><mml:mi>K</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mo>∈</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mn>3</mml:mn><mml:mo>,</mml:mo><mml:mn>4</mml:mn><mml:mo>,</mml:mo><mml:mn>5</mml:mn><mml:mo>,</mml:mo><mml:mn>6</mml:mn><mml:mo>,</mml:mo><mml:mn>7</mml:mn><mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>, depending on the traversal algorithm (not shown).</title>
            <p>A traversal ensuring that <inline-formula id="pcbi.1008380.e100"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1008380.e100" id="pcbi.1008380.e100g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M100" display="inline" overflow="scroll"><mml:mover><mml:mi>K</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:math></alternatives></inline-formula> remains close to the lower end of this interval (the <italic toggle="yes">scanwidth</italic> of the network [<xref rid="pcbi.1008380.ref066" ref-type="bibr">66</xref>]) will be several orders of magnitude faster than algorithms whose complexity depends exponentially on <italic toggle="yes">ℓ</italic>. Increasing the number of reticulation nodes while keeping a “ladder” topology as above can make <italic toggle="yes">ℓ</italic> arbitrarily large, while the scanwidth remains constant. This topology may seem odd but it is intended as the backbone of a more complex and realistic network with subtrees hanging from the different internal branches of the ladder, in which case the complexity issue remains.</p>
          </caption>
          <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1008380.g006" position="float"/>
        </fig>
        <p>We call the minimum value of <inline-formula id="pcbi.1008380.e101"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1008380.e101.jpg" id="pcbi.1008380.e101g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M101" display="inline" overflow="scroll"><mml:mover><mml:mi>K</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:math></alternatives></inline-formula> over all possible traversals of the network the <italic toggle="yes">scanwidth</italic> of the network [<xref rid="pcbi.1008380.ref066" ref-type="bibr">66</xref>]. The current implementation of S<sc>napp</sc>N<sc>et</sc> chooses an arbitrary traversal of the network, but research is ongoing to further lower running times by relying on more involved traversal algorithms producing VPIs with sizes closer to the scanwidth [<xref rid="pcbi.1008380.ref066" ref-type="bibr">66</xref>].</p>
      </sec>
      <sec id="sec014">
        <title>MCMC operators</title>
        <p>
S<sc>napp</sc>N<sc>et</sc> incorporates the MCMC operators of S<sc>pecies</sc>N<sc>etwork</sc> [<xref rid="pcbi.1008380.ref053" ref-type="bibr">53</xref>] to move through the network space, and also benefits from operators specific to the mathematical model behind S<sc>napp</sc> [<xref rid="pcbi.1008380.ref019" ref-type="bibr">19</xref>] (e.g. population sizes, mutation rates, etc.).</p>
        <p>In order to explore the network space, we used the following topological operators from S<sc>pecies</sc>N<sc>etwork</sc>: (a) <italic toggle="yes">addReticulation</italic> and (b) <italic toggle="yes">deleteReticulation</italic> add and delete reticulation nodes respectively, (c) <italic toggle="yes">flipReticulation</italic> flips the direction of a reticulation branch and finally (d) <italic toggle="yes">relocateBranch</italic> and (e) <italic toggle="yes">relocateBranchNarrow</italic> relocate either the source or the destination of random branch. The operators on gene trees from S<sc>pecies</sc>N<sc>etwork</sc> have been discarded since in S<sc>napp</sc>N<sc>et</sc> gene trees are integrated out. The following S<sc>napp</sc> operators acting on continuous parameters are incorporated within S<sc>napp</sc>N<sc>et</sc>: (a) <italic toggle="yes">changeUAndV</italic> changes the values of the instantaneous rates <italic toggle="yes">u</italic> and <italic toggle="yes">v</italic>, (b) <italic toggle="yes">changeGamma</italic> and (c) <italic toggle="yes">changeAllGamma</italic> scale a single population size or all population sizes, respectively.</p>
        <p>Last, S<sc>napp</sc>N<sc>et</sc> takes also advantage of a few S<sc>pecies</sc>N<sc>etwork</sc> operators for continuous parameters: (a) <italic toggle="yes">turnOverScale</italic> and (b) <italic toggle="yes">divRateScale</italic> allow to change respectively the hyperparameters <italic toggle="yes">r</italic> and <italic toggle="yes">d</italic> for the birth-hybridization process, (c) <italic toggle="yes">inheritanceProbUniform</italic> and (d) <italic toggle="yes">inheritanceProbRndWalk</italic> transform the inheritance probability <italic toggle="yes">γ</italic> at a random reticulation node by drawing either a uniformly distributed number or by applying a uniform sliding window to the logit of <italic toggle="yes">γ</italic>, (e) <italic toggle="yes">networkMultiplier</italic> and (f) <italic toggle="yes">originMultiplier</italic> scale respectively the heights of all internal nodes or of the origin node, (g) <italic toggle="yes">nodeUniform</italic> and (h) <italic toggle="yes">nodeSlider</italic> move the height of a random node uniformly or using a sliding window.</p>
        <p>In summary, S<sc>napp</sc>N<sc>et</sc> relies on 16 MCMC operators, described in S<sc>napp</sc>N<sc>et</sc>’s manual (<ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://github.com/rabier/MySnappNet" ext-link-type="uri">https://github.com/rabier/MySnappNet</ext-link>). We refer to the original publications introducing these operators for more details [<xref rid="pcbi.1008380.ref019" ref-type="bibr">19</xref>, <xref rid="pcbi.1008380.ref053" ref-type="bibr">53</xref>].</p>
      </sec>
    </sec>
    <sec id="sec015">
      <title>Simulation study</title>
      <sec id="sec016">
        <title>Simulated data</title>
        <p>We implemented a simulator called S<sc>im</sc>S<sc>napp</sc>N<sc>et</sc>, an extension to networks of the S<sc>im</sc>S<sc>napp</sc> software [<xref rid="pcbi.1008380.ref019" ref-type="bibr">19</xref>]. S<sc>im</sc>S<sc>napp</sc>N<sc>et</sc> handles the MSNC model whereas S<sc>im</sc>S<sc>napp</sc> relies on the MSC model. S<sc>im</sc>S<sc>napp</sc>N<sc>et</sc> is available at <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://github.com/rabier/SimSnappNet" ext-link-type="uri">https://github.com/rabier/SimSnappNet</ext-link>. In all simulations, we considered a given phylogenetic network, and a gene tree was simulated inside the network, according to the MSNC model. Next, a Markov process was generated along the branches of the gene tree, in order to simulate the evolution of a marker. Note that markers at different sites rely on different gene trees. In all cases, we set both the <italic toggle="yes">u</italic> and <italic toggle="yes">v</italic> rates to 1. Moreover, we used the same <italic toggle="yes">θ</italic> = 0.005 value, for all network branches. Our configuration differs slightly from the one of [<xref rid="pcbi.1008380.ref054" ref-type="bibr">54</xref>]. These authors considered <italic toggle="yes">θ</italic> = 0.006 for external branches and <italic toggle="yes">θ</italic> = 0.005 for internal branches. Indeed, since S<sc>napp</sc>N<sc>et</sc> considers the same prior distribution Γ(<italic toggle="yes">α</italic>, <italic toggle="yes">β</italic>) for all <italic toggle="yes">θ</italic>’s, we found it more appropriate to generate data under S<sc>napp</sc>N<sc>et</sc>’s assumptions.</p>
        <p>Three numbers of markers were studied: 1,000, 10,000 or 100,000 biallelic sites were generated. Unless otherwise stated, constant sites were not discarded since S<sc>napp</sc>N<sc>et</sc>’s mathematical formulas rely on random markers. When the analysis relied only on polymorphic sites, the gene tree and the associated marker were regenerated until it resulted in a polymorphic site. We considered 20 replicates for each simulation set up.</p>
      </sec>
      <sec id="sec017">
        <title>Phylogenetic networks studied</title>
        <p>We studied the three phylogenetic networks shown in <xref rid="pcbi.1008380.g007" ref-type="fig">Fig 7</xref>. Networks A and B are rather simple networks that we wish our tool to be able to infer. They have been taken from [<xref rid="pcbi.1008380.ref054" ref-type="bibr">54</xref>] and this allowed us to compare the performances of S<sc>napp</sc>N<sc>et</sc> and <monospace>MCMC_BiMarkers</monospace> on these networks, without having to rerun the latter. Networks A and B have one and two reticulations, respectively. Network C, like B, has two reticulations, but their relative positions are different: in C they are on top of one another, allowing us to investigate the influence of nested reticulations on the inference. In order to fully describe these networks, we give their extended Newick representation [<xref rid="pcbi.1008380.ref067" ref-type="bibr">67</xref>] in Section 4 in <xref rid="pcbi.1008380.s001" ref-type="supplementary-material">S1 Text</xref>.</p>
        <fig position="float" id="pcbi.1008380.g007">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1008380.g007</object-id>
          <label>Fig 7</label>
          <caption>
            <title>The three phylogenetic networks used for simulating data.</title>
            <p>Networks A and B are taken from [<xref rid="pcbi.1008380.ref054" ref-type="bibr">54</xref>]. Branch lengths are measured in units of expected number of mutations per site (i.e. substitutions per site). Displayed values represent inheritance probabilities.</p>
          </caption>
          <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1008380.g007" position="float"/>
        </fig>
        <p>We also studied networks C(3) and C(4), which are variants of network C (see <xref rid="pcbi.1008380.g008" ref-type="fig">Fig 8</xref>). Network C(<italic toggle="yes">k</italic>)—containing <italic toggle="yes">k</italic> reticulation nodes—is obtained by splitting species <italic toggle="yes">C</italic> into <italic toggle="yes">k</italic> − 1 species, named <italic toggle="yes">C</italic><sub>1</sub>, <italic toggle="yes">C</italic><sub>2</sub>, …, <italic toggle="yes">C</italic><sub><italic toggle="yes">k</italic>−1</sub>, and by adding reticulations between them in the way depicted in <xref rid="pcbi.1008380.g008" ref-type="fig">Fig 8</xref>. The relative positions of reticulation nodes in these networks represents a significant computational challenge for network inference tools, and were therefore used to evaluate the efficiency of a single likelihood computation performed by S<sc>napp</sc>N<sc>et</sc> and <monospace>MCMC_BiMarkers</monospace>.</p>
        <fig position="float" id="pcbi.1008380.g008">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1008380.g008</object-id>
          <label>Fig 8</label>
          <caption>
            <title>The networks from the C family, with either 3 or 4 reticulation nodes, and with or without outgroup O.</title>
          </caption>
          <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1008380.g008" position="float"/>
        </fig>
      </sec>
      <sec id="sec018">
        <title>Bayesian analysis</title>
        <p>In the experiments on networks A, B and C, we used a single tree as initial state of the MCMC. None of the starting trees were subtrees of the correct network topology. A few alternative starting trees were used to check the convergence of the MCMC, showing a limited effect of the starting tree on the posterior probabilities. All relevant Newick representations are reported in <xref rid="pcbi.1008380.s001" ref-type="supplementary-material">S1 Text</xref>.</p>
        <p>As priors on population sizes, we considered <italic toggle="yes">θ</italic> ∼ Γ(1,200) for all branches. Since simulated data were generated by setting <italic toggle="yes">θ</italic> = 0.005, the expected value of this prior distribution is exactly matching the true value (<inline-formula id="pcbi.1008380.e102"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1008380.e102.jpg" id="pcbi.1008380.e102g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M102" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="double-struck">E</mml:mi><mml:mo>(</mml:mo><mml:mi>θ</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>.</mml:mo><mml:mn>005</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>). For calibrating the network prior, we chose the same distributions as suggested in [<xref rid="pcbi.1008380.ref053" ref-type="bibr">53</xref>]: <inline-formula id="pcbi.1008380.e103"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1008380.e103.jpg" id="pcbi.1008380.e103g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M103" display="inline" overflow="scroll"><mml:mrow><mml:mi>d</mml:mi><mml:mo>∼</mml:mo><mml:mi mathvariant="script">E</mml:mi><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>.</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>, <italic toggle="yes">r</italic> ∼ Beta(1, 1), <inline-formula id="pcbi.1008380.e104"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1008380.e104.jpg" id="pcbi.1008380.e104g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M104" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>∼</mml:mo><mml:mi mathvariant="script">E</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mn>10</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>. This network prior enables to explore a large network space, while imposing more weights on networks with 1 or 2 reticulations (see Fig A of <xref rid="pcbi.1008380.s001" ref-type="supplementary-material">S1 Text</xref>). Recall that network A is a 1-reticulation network, whereas networks B and C are 2-reticulation networks. However, in order to limit the computational burden for network C (and for estimating continuous parameters on network A), we slightly modified the prior by bounding the number of reticulations to 2. Last, on network B, the analysis was performed by bounding the number of reticulations to 3 in order to compare S<sc>napp</sc>N<sc>et</sc>’s results with those obtained by <monospace>MCMC_BiMarkers</monospace> [<xref rid="pcbi.1008380.ref054" ref-type="bibr">54</xref>]. We refer to Figs B and C in <xref rid="pcbi.1008380.s001" ref-type="supplementary-material">S1 Text</xref> for illustrations of the “bounded” prior.</p>
      </sec>
      <sec id="sec019">
        <title>MCMC convergence</title>
        <p>To track the behaviour of the Bayesian algorithm, we used the Effective Sample Size (ESS) criterion [<xref rid="pcbi.1008380.ref068" ref-type="bibr">68</xref>]. We assumed that MCMC convergence was reached and that enough “independent” observations were sampled, when the ESS values for all model parameters are greater than 200 (see <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://beast.community/ess_tutorial" ext-link-type="uri">https://beast.community/ess_tutorial</ext-link>). This threshold is commonly adopted in the MCMC community. The first 10% samples were discarded as burn-in and the ESSs were computed on the remaining observations, using the Tracer software [<xref rid="pcbi.1008380.ref069" ref-type="bibr">69</xref>]. When we could not reach ESSs of 200, the ESS threshold is specified in the text. In the following, when speaking of a specific ESS value, we refer to the ESS computed for the posterior density function of the sampled networks (first value reported by Tracer). In order to estimate posterior distributions, we only sampled the MCMC every 1000 iterations. This was done to reduce autocorrelation across the sampled networks.</p>
        <p>Note that here we do not attempt to measure an ESS of the network topologies sampled by the MCMC. While approaches to do this have been proposed for tree topologies [<xref rid="pcbi.1008380.ref070" ref-type="bibr">70</xref>], adapting such approaches to network topologies lies beyond the scope of this paper (see also the <xref rid="sec027" ref-type="sec">Discussion</xref>). Topological convergence was only assessed by inspecting the similarity between the results obtained for different MCMC replicates.</p>
      </sec>
      <sec id="sec020">
        <title>Accuracy of S<sc>napp</sc>N<sc>et</sc></title>
        <p>In order to evaluate S<sc>napp</sc>N<sc>et</sc>’s ability to recover the true network topology, the posterior probability of the true topology was estimated by taking the proportion of sampled network topologies matching the true topology. Note that unlike previous works [<xref rid="pcbi.1008380.ref054" ref-type="bibr">54</xref>], we did not use a measure of topological dissimilarity, because most of the proposed measures can equal 0 even when the network topologies are different [<xref rid="pcbi.1008380.ref038" ref-type="bibr">38</xref>, <xref rid="pcbi.1008380.ref071" ref-type="bibr">71</xref>]. In order to verify whether a sampled network and the true network have the same topologies, we used the isomorphism tester program available at <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://github.com/igel-kun/phylo_tools" ext-link-type="uri">https://github.com/igel-kun/phylo_tools</ext-link>. We report the average (estimated) posterior probability of the true network topology over the different replicates.</p>
        <p>For some networks, we also investigated the ability to estimate continuous parameters, including network length (the sum of all branch lengths) and network height (the distance between the root and the leaves).</p>
      </sec>
    </sec>
    <sec id="sec021">
      <title>Real data study on rice</title>
      <p>In order to assess the performance of our method on real data, we addressed the case of rice, both a prominent crop and a well-studied advanced plant model for which extensive data is available. We used genomic data extracted from [<xref rid="pcbi.1008380.ref072" ref-type="bibr">72</xref>] and [<xref rid="pcbi.1008380.ref073" ref-type="bibr">73</xref>]. We focused on 24 representative varieties (see Table C and Fig M in <xref rid="pcbi.1008380.s001" ref-type="supplementary-material">S1 Text</xref>) spanning the four main rice subpopulations of cultivars (Indica, Japonica, cAus and cBasmati) as well as the different types of wild rice <italic toggle="yes">O. rufipogon</italic> that are suspected to have been involved in the origin of cultivated rice. We built three random data sets, keeping a large panel of Asian countries. Data set 1 contains only one variety per subpopulation, whereas data sets 2 and 3 contain two varieties per subpopulation (cf. Tables D and E in <xref rid="pcbi.1008380.s001" ref-type="supplementary-material">S1 Text</xref>). For each of the 12 chromosomes, we sampled 1k SNPs having only homozygous alleles. Following recommendations of [<xref rid="pcbi.1008380.ref019" ref-type="bibr">19</xref>], the SNPs were chosen for each of the 12 chromosomes to be as separated as possible from one another to avoid linkage between loci, though [<xref rid="pcbi.1008380.ref054" ref-type="bibr">54</xref>] has shown this kind of analysis is quite robust to this bias. The concatenation of these SNPs lead to 12k whole-genome SNP data sets on the selected rice varieties.</p>
      <p>
S<sc>napp</sc>N<sc>et</sc> was run again discarding the first 10% of samples as burn-in and sampling the MCMC every 1000 iterations. The number of reticulations was bounded by two for data sets 1 and 3. On data set 2, in order to obtain results in a reasonable amount of time (cf. the Results section), only one reticulation was finally allowed.</p>
    </sec>
  </sec>
  <sec sec-type="results" id="sec022">
    <title>Results</title>
    <sec id="sec023">
      <title>Simulations</title>
      <p>First, we compare the performances of S<sc>napp</sc>N<sc>et</sc> and <monospace>MCMC_BiMarkers</monospace> on data simulated with networks A and B (cf. <xref rid="pcbi.1008380.g007" ref-type="fig">Fig 7</xref>), already studied in [<xref rid="pcbi.1008380.ref054" ref-type="bibr">54</xref>], and the more complex C network. Second, we compare the two tools in terms of CPU time and memory required to compute the likelihood of network C and its variants. This step is usually repeated million times in an MCMC analysis, and is therefore critical for its overall efficiency. Note that focusing on a single likelihood calculation allows us to exclude the effect of the prior on the overall efficiency of the MCMC, and to only test the computational efficiency of the new algorithm to compute the likelihood implemented in S<sc>napp</sc>N<sc>et</sc>.</p>
      <sec id="sec024">
        <title>Study of networks A and B</title>
        <p>
          <italic toggle="yes">1) Ability to recover the network topology</italic>
        </p>
        <p><xref rid="pcbi.1008380.t001" ref-type="table">Table 1</xref> reports on the ability of S<sc>napp</sc>N<sc>et</sc> to recover the correct topology of networks A and B. As in [<xref rid="pcbi.1008380.ref054" ref-type="bibr">54</xref>], we simulated one individual for each species. Note that under this setting, population sizes <italic toggle="yes">θ</italic> corresponding to external branches are unidentifiable, as there is no coalescence event occurring along these branches. We studied different densities of markers and different priors on <italic toggle="yes">θ</italic>. Besides, we focused on either a) the true prior Γ(1,200) with <inline-formula id="pcbi.1008380.e105"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1008380.e105.jpg" id="pcbi.1008380.e105g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M105" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="double-struck">E</mml:mi><mml:mo>(</mml:mo><mml:mi>θ</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>.</mml:mo><mml:mn>005</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>, b) the incorrect prior Γ(1,1000) with <inline-formula id="pcbi.1008380.e106"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1008380.e106.jpg" id="pcbi.1008380.e106g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M106" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="double-struck">E</mml:mi><mml:mo>(</mml:mo><mml:mi>θ</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>.</mml:mo><mml:mn>001</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>, or c) the incorrect prior Γ(1,2000) with <inline-formula id="pcbi.1008380.e107"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1008380.e107.jpg" id="pcbi.1008380.e107g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M107" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="double-struck">E</mml:mi><mml:mo>(</mml:mo><mml:mi>θ</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mn>5</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></alternatives></inline-formula>. Last, in order to compare our results with [<xref rid="pcbi.1008380.ref054" ref-type="bibr">54</xref>], we considered <italic toggle="yes">u</italic> and <italic toggle="yes">v</italic>, the mutation rates, as known parameters. Indeed, <monospace>MCMC_BiMarkers</monospace> relies on the operators of [<xref rid="pcbi.1008380.ref052" ref-type="bibr">52</xref>] that do not allow changes of these rates.</p>
        <table-wrap position="float" id="pcbi.1008380.t001">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1008380.t001</object-id>
          <label>Table 1</label>
          <caption>
            <title>Average posterior probability of the correct topology (for networks A and B, see <xref rid="pcbi.1008380.g007" ref-type="fig">Fig 7</xref>) obtained by running S<sc>napp</sc>N<sc>et</sc> on simulated data.</title>
            <p>Results are given as a function of the number of sites and as a function of the hyperparameter values <italic toggle="yes">α</italic> and <italic toggle="yes">β</italic> for the prior on <italic toggle="yes">θ</italic> (<italic toggle="yes">θ</italic> ∼ Γ(<italic toggle="yes">α</italic>, <italic toggle="yes">β</italic>) and <inline-formula id="pcbi.1008380.e108"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1008380.e108" id="pcbi.1008380.e108g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M108" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="double-struck">E</mml:mi><mml:mo>(</mml:mo><mml:mi>θ</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mi>α</mml:mi><mml:mi>β</mml:mi></mml:mfrac></mml:mrow></mml:math></alternatives></inline-formula>). Here, one lineage was simulated per species. Constant sites are included in the analysis, the rates <italic toggle="yes">u</italic> and <italic toggle="yes">v</italic> are considered as known, and 20 replicates are considered for each simulation set up (criterion ESS &gt; 200; <inline-formula id="pcbi.1008380.e109"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1008380.e109" id="pcbi.1008380.e109g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M109" display="inline" overflow="scroll"><mml:mrow><mml:mi>d</mml:mi><mml:mo>∼</mml:mo><mml:mi mathvariant="script">E</mml:mi><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>.</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>, <italic toggle="yes">r</italic> ∼ Beta(1, 1), <inline-formula id="pcbi.1008380.e110"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1008380.e110" id="pcbi.1008380.e110g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M110" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>∼</mml:mo><mml:mi mathvariant="script">E</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mn>10</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> for the network prior).</p>
          </caption>
          <alternatives>
            <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1008380.t001" id="pcbi.1008380.t001g" position="float"/>
            <table frame="box" rules="all" border="0">
              <colgroup span="1">
                <col align="left" valign="middle" span="1"/>
                <col align="left" valign="middle" span="1"/>
                <col align="left" valign="middle" span="1"/>
                <col align="left" valign="middle" span="1"/>
                <col align="left" valign="middle" span="1"/>
                <col align="left" valign="middle" span="1"/>
                <col align="left" valign="middle" span="1"/>
              </colgroup>
              <thead>
                <tr>
                  <th align="center" style="border-bottom-width:thick;border-right-width:thick" rowspan="1" colspan="1"/>
                  <th align="center" colspan="3" style="border-bottom-width:thick;border-right-width:thick" rowspan="1">Network A</th>
                  <th align="center" colspan="3" style="border-bottom-width:thick" rowspan="1">Network B</th>
                </tr>
                <tr>
                  <th align="center" style="border-right-width:thick" rowspan="1" colspan="1">Number of sites</th>
                  <th align="center" rowspan="2" style="border-bottom-width:thick" colspan="1">1,000</th>
                  <th align="center" rowspan="2" style="border-bottom-width:thick" colspan="1">10,000</th>
                  <th align="center" rowspan="2" style="border-bottom-width:thick;border-right-width:thick" colspan="1">100,000</th>
                  <th align="center" rowspan="2" style="border-bottom-width:thick" colspan="1">1,000</th>
                  <th align="center" rowspan="2" style="border-bottom-width:thick" colspan="1">10,000</th>
                  <th align="center" rowspan="2" style="border-bottom-width:thick" colspan="1">100,000</th>
                </tr>
                <tr>
                  <th align="center" style="border-bottom-width:thick;border-right-width:thick" rowspan="1" colspan="1">Hyperparameters</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td align="center" style="border-right-width:thick" rowspan="1" colspan="1"><bold>True</bold> (<italic toggle="yes">α</italic> = 1, <italic toggle="yes">β</italic> = 200, <inline-formula id="pcbi.1008380.e111"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1008380.e111" id="pcbi.1008380.e111g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M111" display="inline" overflow="scroll"><mml:mrow><mml:mfrac><mml:mi>α</mml:mi><mml:mi>β</mml:mi></mml:mfrac><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>.</mml:mo><mml:mn>005</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>)</td>
                  <td align="center" rowspan="1" colspan="1">0%</td>
                  <td align="center" rowspan="1" colspan="1">100%</td>
                  <td align="center" style="border-right-width:thick" rowspan="1" colspan="1">100%</td>
                  <td align="center" rowspan="1" colspan="1">0%</td>
                  <td align="center" rowspan="1" colspan="1">81.25%</td>
                  <td align="center" rowspan="1" colspan="1">100%</td>
                </tr>
                <tr>
                  <td align="center" style="border-right-width:thick" rowspan="1" colspan="1"><bold>Incorrect</bold> (<italic toggle="yes">α</italic> = 1, <italic toggle="yes">β</italic> = 1000, <inline-formula id="pcbi.1008380.e112"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1008380.e112" id="pcbi.1008380.e112g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M112" display="inline" overflow="scroll"><mml:mrow><mml:mfrac><mml:mi>α</mml:mi><mml:mi>β</mml:mi></mml:mfrac><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>.</mml:mo><mml:mn>001</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>)</td>
                  <td align="center" rowspan="1" colspan="1">0%</td>
                  <td align="center" rowspan="1" colspan="1">94.73%</td>
                  <td align="center" style="border-right-width:thick" rowspan="1" colspan="1">91.30%</td>
                  <td align="center" rowspan="1" colspan="1">0%</td>
                  <td align="center" rowspan="1" colspan="1">80%</td>
                  <td align="center" rowspan="1" colspan="1">95.65%</td>
                </tr>
                <tr>
                  <td align="center" style="border-right-width:thick" rowspan="1" colspan="1"><bold>Incorrect</bold> (<italic toggle="yes">α</italic> = 1, <italic toggle="yes">β</italic> = 2000, <inline-formula id="pcbi.1008380.e113"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1008380.e113" id="pcbi.1008380.e113g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M113" display="inline" overflow="scroll"><mml:mrow><mml:mfrac><mml:mi>α</mml:mi><mml:mi>β</mml:mi></mml:mfrac><mml:mo>=</mml:mo><mml:mn>5</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></alternatives></inline-formula>)</td>
                  <td align="center" rowspan="1" colspan="1">0%</td>
                  <td align="center" rowspan="1" colspan="1">100%</td>
                  <td align="center" style="border-right-width:thick" rowspan="1" colspan="1">80%</td>
                  <td align="center" rowspan="1" colspan="1">0%</td>
                  <td align="center" rowspan="1" colspan="1">85%</td>
                  <td align="center" rowspan="1" colspan="1">85.71%</td>
                </tr>
              </tbody>
            </table>
          </alternatives>
        </table-wrap>
        <p>First consider simulations under the true prior. As shown in <xref rid="pcbi.1008380.t001" ref-type="table">Table 1</xref>, in presence of a large number of markers, S<sc>napp</sc>N<sc>et</sc> recovered networks A and B with high posterior probability. In particular, when <italic toggle="yes">m</italic> = 100,000 sites were used, the posterior distributions were only concentrated on the true networks. For <italic toggle="yes">m</italic> = 10,000, the average posterior probability of network A is again 100%, whereas that of B is lower (81.25%). This is not surprising since network B is more complex than network A. Our results are consistent with those of [<xref rid="pcbi.1008380.ref054" ref-type="bibr">54</xref>], who found that <monospace>MCMC_BiMarkers</monospace> required 10,000 sites to infer precisely networks A and B. (Recall that we did not rerun <monospace>MCMC_BiMarkers</monospace> on data simulated from networks A and B).</p>
        <p>However, for a small number of sites (<italic toggle="yes">m</italic> = 1,000), we observed differences between S<sc>napp</sc>N<sc>et</sc> and <monospace>MCMC_BiMarkers</monospace>: S<sc>napp</sc>N<sc>et</sc> always inferred trees (see <xref rid="pcbi.1008380.g009" ref-type="fig">Fig 9</xref>), whereas <monospace>MCMC_BiMarkers</monospace> inferred networks. For instance, on Network A, <monospace>MCMC_BiMarkers</monospace> inferred a network in approximately 75% of cases, whereas S<sc>napp</sc>N<sc>et</sc> supported the tree ((((Q,A),L),R),C) with average posterior probability 78.71%. Interestingly, this tree can be obtained from network A by removing the hybridization branch with smallest inheritance probability. Details on the trees inferred by S<sc>napp</sc>N<sc>et</sc> for this setting are given in Table A of <xref rid="pcbi.1008380.s001" ref-type="supplementary-material">S1 Text</xref>.</p>
        <fig position="float" id="pcbi.1008380.g009">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1008380.g009</object-id>
          <label>Fig 9</label>
          <caption>
            <title>The ratio of trees (black), 1-reticulation networks (dark grey), 2-reticulations networks (light gray), sampled by S<sc>napp</sc>N<sc>et</sc>, under the different simulations settings studied in <xref rid="pcbi.1008380.t001" ref-type="table">Table 1</xref>.</title>
            <p>Recall that networks A and B contain 1 and 2 reticulations, respectively.</p>
          </caption>
          <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1008380.g009" position="float"/>
        </fig>
        <p>Similarly, on network B that hosts 2 reticulations, for <italic toggle="yes">m</italic> = 1,000 <monospace>MCMC_BiMarkers</monospace> almost always inferred a 1-reticulation network [<xref rid="pcbi.1008380.ref054" ref-type="bibr">54</xref>], whereas S<sc>napp</sc>N<sc>et</sc> hesitated mainly between two trees, (((Q,R),L),(A,C)) and (((Q,L),R),(A,C)), with average posterior probabilities 35.28% and 28.54%, respectively. This different behavior among the two tools is most likely due to the fact that their prior models differ. With only 1,000 markers, <monospace>MCMC_BiMarkers</monospace> and S<sc>napp</sc>N<sc>et</sc> were both unable to recover network B.</p>
        <p>Now consider simulations based on incorrect priors. This mimics real cases where there is no or little information on the network underlying the data. Recall that these priors are incorrect since <inline-formula id="pcbi.1008380.e114"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1008380.e114.jpg" id="pcbi.1008380.e114g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M114" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="double-struck">E</mml:mi><mml:mo>(</mml:mo><mml:mi>θ</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> is either fixed to 0.001 or 5 × 10<sup>−4</sup>, instead of being equal to the true value 0.005. In other words, these priors underestimate the number of ILS events in the data. When considering as few as 1,000 sites, S<sc>napp</sc>N<sc>et</sc> only inferred trees (cf. Table A in <xref rid="pcbi.1008380.s001" ref-type="supplementary-material">S1 Text</xref>), whereas <monospace>MCMC_BiMarkers</monospace> mostly inferred networks [<xref rid="pcbi.1008380.ref054" ref-type="bibr">54</xref>]. For <italic toggle="yes">m</italic> = 10,000 and <italic toggle="yes">m</italic> = 100,000 sites, S<sc>napp</sc>N<sc>et</sc> inferred network A with high posterior probability. In the rare cases where the true network was not sampled, S<sc>napp</sc>N<sc>et</sc> inferred a network with two reticulations (see <xref rid="pcbi.1008380.g009" ref-type="fig">Fig 9</xref>). The bias induced by incorrect priors (underestimating ILS) led the method to fit the data by adding supplementary edges to the network. On network B, S<sc>napp</sc>N<sc>et</sc>’s posterior distribution remained concentrated on the correct topology, and interestingly, for <italic toggle="yes">m</italic> = 10,000 and <italic toggle="yes">m</italic> = 100,000 sites, S<sc>napp</sc>N<sc>et</sc> sampled exclusively 2-reticulation networks (see <xref rid="pcbi.1008380.g009" ref-type="fig">Fig 9</xref>). To sum up, S<sc>napp</sc>N<sc>et</sc>’s ability to recover the correct network topology did not really deteriorate with incorrect priors.</p>
        <p>
          <italic toggle="yes">2) Ability to estimate continuous parameters for network A</italic>
        </p>
        <p>Recall that in our modelling, the continuous parameters are branch lengths, inheritance probabilities <italic toggle="yes">γ</italic>, population sizes <italic toggle="yes">θ</italic> and instantaneous rates (<italic toggle="yes">u</italic> and <italic toggle="yes">v</italic>). As in [<xref rid="pcbi.1008380.ref053" ref-type="bibr">53</xref>], we also studied the network length and the network height, that is the sum of the branch lengths and the distance between the root node and the leaves, respectively. In order to evaluate S<sc>napp</sc>N<sc>et</sc>’s ability to estimate continuous parameters, we will focus here exclusively on network A (following [<xref rid="pcbi.1008380.ref054" ref-type="bibr">54</xref>]). Analogous results for networks B and C can be found in Figs D-G in <xref rid="pcbi.1008380.s001" ref-type="supplementary-material">S1 Text</xref>.</p>
        <p>For network A, we considered the case of two lineages in each species. Indeed, under this setting, <italic toggle="yes">θ</italic> values are now identifiable for external branches: the expected coalescent time is here <italic toggle="yes">θ</italic>/2, that is to say 2.5 × 10<sup>−3</sup>, which is a smaller value than all external branch lengths. In other words, a few coalescent events should happen along external branches. For these analyses, we considered exclusively the true prior on <italic toggle="yes">θ</italic> and we bounded the number of reticulations to 2 (as in [<xref rid="pcbi.1008380.ref054" ref-type="bibr">54</xref>]) in order to limit the computational burden. In the following, we consider the cases where a) input markers can be invariant or polymorphic, and b) only polymorphic sites are considered.</p>
        <p>
          <italic toggle="yes">2a) Constant sites included in the analysis</italic>
        </p>
        <p>Before describing results on continuous parameters, let us first mention results regarding the topology. Although the number of lineages was increased in comparison with the previous experiment, S<sc>napp</sc>N<sc>et</sc> still sampled exclusively trees for <italic toggle="yes">m</italic> = 1,000, and always recovered the correct topology for <italic toggle="yes">m</italic> = 10,000 and <italic toggle="yes">m</italic> = 100,000. Note that for <italic toggle="yes">m</italic> = 1,000, we observed that generated data sets contained 78% invariant sites on average given the parameters of the simulation, so that such simulated data sets only contained on average 220 variable sites.</p>
        <p>In order to limit the computational burden, the analysis for <italic toggle="yes">m</italic> = 100,000 relied only on 17 replicates with ESS &gt; 200. <xref rid="pcbi.1008380.g010" ref-type="fig">Fig 10</xref> reports on the estimated network height and the estimated network length. As expected, the accuracy increased with the number of sites. <xref rid="pcbi.1008380.g011" ref-type="fig">Fig 11</xref> shows the same behaviour, regarding the inheritance probability <italic toggle="yes">γ</italic>, the rates <italic toggle="yes">u</italic> and <italic toggle="yes">v</italic>. <xref rid="pcbi.1008380.g012" ref-type="fig">Fig 12</xref> is complementary to <xref rid="pcbi.1008380.g010" ref-type="fig">Fig 10</xref>, since it reports on the estimated node heights. All node heights were estimated quite accurately, which is not surprising in view of the results on the network length. <xref rid="pcbi.1008380.g013" ref-type="fig">Fig 13</xref> is dedicated to population sizes. For external branches, S<sc>napp</sc>N<sc>et</sc>’s was able to estimate <italic toggle="yes">θ</italic> values very precisely. Performances slightly deteriorated on internal branches (see the box plots, from number 6 to number 12) whose <italic toggle="yes">θ</italic> values were underestimated (see the medians) and showed a higher posterior variance. This phenomenon was also observed for <monospace>MCMC_BiMarkers</monospace> [<xref rid="pcbi.1008380.ref054" ref-type="bibr">54</xref>, Fig 7 obtained under a different setting].</p>
        <fig position="float" id="pcbi.1008380.g010">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1008380.g010</object-id>
          <label>Fig 10</label>
          <caption>
            <title>Estimated height and length for network A (see <xref rid="pcbi.1008380.g007" ref-type="fig">Fig 7</xref>), as a function of the number of sites.</title>
            <p>Heights and lengths are measured in units of expected number of mutations per site. True values are given by the dashed horizontal lines. Two lineages per species were simulated. Constant sites are included in the analysis, and 20 replicates are considered for each simulation set up (criterion ESS &gt; 200; θ ∼ Γ(1, 200), <inline-formula id="pcbi.1008380.e115"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1008380.e115" id="pcbi.1008380.e115g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M115" display="inline" overflow="scroll"><mml:mrow><mml:mi>d</mml:mi><mml:mo>∼</mml:mo><mml:mi mathvariant="script">E</mml:mi><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>.</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>, <italic toggle="yes">r</italic> ∼ Beta(1,1), <inline-formula id="pcbi.1008380.e116"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1008380.e116" id="pcbi.1008380.e116g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M116" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>∼</mml:mo><mml:mi mathvariant="script">E</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mn>10</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> for the priors, number of reticulations bounded by 2 when exploring the network space).</p>
          </caption>
          <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1008380.g010" position="float"/>
        </fig>
        <fig position="float" id="pcbi.1008380.g011">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1008380.g011</object-id>
          <label>Fig 11</label>
          <caption>
            <title>Estimated inheritance probability and instantaneous rates for network A (see <xref rid="pcbi.1008380.g007" ref-type="fig">Fig 7</xref>), as a function of the number of sites. True values are given by the dashed horizontal lines.</title>
            <p>Same framework as in <xref rid="pcbi.1008380.g010" ref-type="fig">Fig 10</xref>.</p>
          </caption>
          <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1008380.g011" position="float"/>
        </fig>
        <fig position="float" id="pcbi.1008380.g012">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1008380.g012</object-id>
          <label>Fig 12</label>
          <caption>
            <title>Estimated node heights of network A (see <xref rid="pcbi.1008380.g007" ref-type="fig">Fig 7</xref>), as a function of the number of sites.</title>
            <p>Heights are measured in units of expected number of mutations per site. True values are given by the dashed horizontal lines. Same framework as in <xref rid="pcbi.1008380.g010" ref-type="fig">Fig 10</xref>. The initials MRCA stand for “Most Recent Common Ancestor”.</p>
          </caption>
          <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1008380.g012" position="float"/>
        </fig>
        <fig position="float" id="pcbi.1008380.g013">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1008380.g013</object-id>
          <label>Fig 13</label>
          <caption>
            <title>Estimated population sizes <italic toggle="yes">θ</italic> for each branch of network A (see <xref rid="pcbi.1008380.g007" ref-type="fig">Fig 7</xref>), as a function of the number of sites.</title>
            <p>True values are given by the dashed horizontal lines. Same framework as in <xref rid="pcbi.1008380.g010" ref-type="fig">Fig 10</xref>. The initials MRCA stand for “Most Recent Common Ancestor”.</p>
          </caption>
          <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1008380.g013" position="float"/>
        </fig>
        <p>
          <italic toggle="yes">2b) Only polymorphic sites included in the analysis</italic>
        </p>
        <p>In order to control for the fact that this analysis relies only on polymorphic sites, the likelihood of the data for a network Ψ becomes a conditional likelihood equal to <inline-formula id="pcbi.1008380.e117"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1008380.e117.jpg" id="pcbi.1008380.e117g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M117" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="double-struck">P</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo>∣</mml:mo><mml:mo>Ψ</mml:mo><mml:mo>)</mml:mo><mml:mo>/</mml:mo><mml:mspace width="0.166667em"/><mml:mi mathvariant="double-struck">P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mo>“</mml:mo><mml:mtext>the</mml:mtext><mml:mspace width="4pt"/><mml:mtext>m</mml:mtext><mml:mspace width="4pt"/><mml:mtext>sites</mml:mtext><mml:mspace width="4pt"/><mml:mtext>are</mml:mtext><mml:mspace width="4pt"/><mml:mtext>polymorphic</mml:mtext><mml:mo>”</mml:mo><mml:mo>|</mml:mo><mml:mo>Ψ</mml:mo><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>, due to Bayes’ rule.</p>
        <p>Before focusing on continuous parameters, let us describe results regarding the topology. As mentioned in [<xref rid="pcbi.1008380.ref054" ref-type="bibr">54</xref>], polymorphic sites are considered as most informative to recover the topology. For <italic toggle="yes">m</italic> = 1,000, S<sc>napp</sc>N<sc>et</sc> now recovers the correct topology of network A with high frequency in 94.45% of samples. S<sc>napp</sc>N<sc>et</sc> always sampled the true network for <italic toggle="yes">m</italic> = 10,000 and <italic toggle="yes">m</italic> = 100,000. In order to reduce the computational burden for <italic toggle="yes">m</italic> = 100,000, our analysis relied on the 12 replicates that achieved ESS &gt; 100.</p>
        <p>Next, the same analysis was performed without applying the correction factor <inline-formula id="pcbi.1008380.e118"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1008380.e118.jpg" id="pcbi.1008380.e118g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M118" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="double-struck">P</mml:mi><mml:mo>(</mml:mo><mml:mo>“</mml:mo><mml:mtext>the</mml:mtext><mml:mspace width="4pt"/><mml:mtext>m</mml:mtext><mml:mspace width="4pt"/><mml:mtext>sites</mml:mtext><mml:mspace width="4pt"/><mml:mtext>are</mml:mtext><mml:mspace width="4pt"/><mml:mtext>polymorphic</mml:mtext><mml:mo>”</mml:mo><mml:mo>|</mml:mo><mml:mo>Ψ</mml:mo><mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>, which is done by toggling an option within the software. For <italic toggle="yes">m</italic> = 1,000, the average posterior probability of network A dropped to 23.81%, while for <italic toggle="yes">m</italic> = 10,000 and <italic toggle="yes">m</italic> = 100,000, it remained relatively high (i.e., 95.24% and 95.65%, respectively). Using the correct likelihood computation is important here.</p>
        <p>We also highlight that for <italic toggle="yes">m</italic> = 100,000, the sampler efficiency (i.e. the ratio ESS/nb iterations without burn-in) was much larger when the additional term was omitted (1.75 × 10<sup>−4</sup> vs. 2.55 × 10<sup>−5</sup>). It enabled us to consider 20 replicates with ESS &gt; 200 in this new experiment.</p>
        <p>Let us move on to the estimation of continuous parameters. Figs H-K in <xref rid="pcbi.1008380.s001" ref-type="supplementary-material">S1 Text</xref> illustrate results obtained from the experiment incorporating the correction factor. As previously, the network height, the network length, the rates <italic toggle="yes">u</italic> and <italic toggle="yes">v</italic>, the inheritance probability <italic toggle="yes">γ</italic> and the node heights were estimated very precisely. As expected, the accuracy increased with the number of sites. Estimated <italic toggle="yes">θ</italic> values were very satisfactory for external branches, whereas a slight bias was still introduced on internal branches. Last, for the analysis without the correction factor, we observed a huge bias regarding network height and network length (cf Fig L in <xref rid="pcbi.1008380.s001" ref-type="supplementary-material">S1 Text</xref>). Surprisingly, the rates <italic toggle="yes">u</italic> and <italic toggle="yes">v</italic> were still very accurately estimated.</p>
      </sec>
      <sec id="sec025">
        <title>Study of network C and its variants</title>
        <p>We focus here on network C (<xref rid="pcbi.1008380.g007" ref-type="fig">Fig 7</xref>) and its variants (<xref rid="pcbi.1008380.g008" ref-type="fig">Fig 8</xref>).</p>
        <p>
          <italic toggle="yes">1) Ability to recover the network topology</italic>
        </p>
        <p>Tables <xref rid="pcbi.1008380.t002" ref-type="table">2</xref> and <xref rid="pcbi.1008380.t003" ref-type="table">3</xref> report the ability of S<sc>napp</sc>N<sc>et</sc> and <monospace>MCMC_BiMarkers</monospace>, respectively, to recover the correct topology of network C. We considered one lineage in species O, A and D, and let the number of lineages in species B and C vary. We studied either a) 1 lineage, or b) 4 lineages, in these hybrid species. In order to limit the computational burden for S<sc>napp</sc>N<sc>et</sc>, the ESS criterion was decreased to 100 and the number of reticulations was also bounded by 2.</p>
        <table-wrap position="float" id="pcbi.1008380.t002">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1008380.t002</object-id>
          <label>Table 2</label>
          <caption>
            <title>Average posterior probability (PP) of the topology of network C obtained by running S<sc>napp</sc>N<sc>et</sc> on data simulated from network C.</title>
            <p>Results are given as a function of the number of sites and as a function of the number of lineages sampled in hybrid species B and C (either both 1 or both 4). Only one lineage was sampled in every other species. Constant sites are included in the analysis and the rates <italic toggle="yes">u</italic> and <italic toggle="yes">v</italic> are considered as known. Posterior probabilities are computed on the basis of replicates for which the criterion ESS &gt; 100 is fulfilled. The sampler efficiency (SE) is also indicated (true hyperparameter values for the prior on <italic toggle="yes">θ</italic>, i.e. <italic toggle="yes">θ</italic> ∼ Γ(1, 200); as a network prior <inline-formula id="pcbi.1008380.e119"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1008380.e119" id="pcbi.1008380.e119g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M119" display="inline" overflow="scroll"><mml:mrow><mml:mi>d</mml:mi><mml:mo>∼</mml:mo><mml:mi mathvariant="script">E</mml:mi><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>.</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>, <italic toggle="yes">r</italic> ∼ Beta(1, 1), <inline-formula id="pcbi.1008380.e120"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1008380.e120" id="pcbi.1008380.e120g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M120" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>∼</mml:mo><mml:mi mathvariant="script">E</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mn>10</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>; number of reticulations bounded by 2 when exploring the network space).</p>
          </caption>
          <alternatives>
            <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1008380.t002" id="pcbi.1008380.t002g" position="float"/>
            <table frame="box" rules="all" border="0">
              <colgroup span="1">
                <col align="left" valign="middle" span="1"/>
                <col align="left" valign="middle" span="1"/>
                <col align="left" valign="middle" span="1"/>
                <col align="left" valign="middle" span="1"/>
                <col align="left" valign="middle" span="1"/>
              </colgroup>
              <thead>
                <tr>
                  <th align="center" colspan="2" style="border-bottom-width:thick;border-right-width:thick" rowspan="1"/>
                  <th align="center" colspan="3" style="border-bottom-width:thick" rowspan="1">Number of sites</th>
                </tr>
                <tr>
                  <th align="center" style="border-bottom-width:thick;border-right-width:thick" rowspan="1" colspan="1">Number of lineages for B and for C</th>
                  <th align="center" style="border-bottom-width:thick;border-right-width:thick" rowspan="1" colspan="1"/>
                  <th align="center" style="border-bottom-width:thick;border-right-width:thick" rowspan="1" colspan="1">1,000</th>
                  <th align="center" style="border-bottom-width:thick;border-right-width:thick" rowspan="1" colspan="1">10,000</th>
                  <th align="center" style="border-bottom-width:thick" rowspan="1" colspan="1">100,000</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td align="center" rowspan="2" style="border-right-width:thick" colspan="1">1</td>
                  <td align="center" style="border-right-width:thick" rowspan="1" colspan="1">PP</td>
                  <td align="center" style="border-right-width:thick" rowspan="1" colspan="1">0% (20 replicates)</td>
                  <td align="center" style="border-right-width:thick" rowspan="1" colspan="1">7.87% (20 replicates)</td>
                  <td align="center" rowspan="1" colspan="1">54.9% (20 replicates)</td>
                </tr>
                <tr>
                  <td align="center" style="border-right-width:thick" rowspan="1" colspan="1">SE</td>
                  <td align="center" style="border-right-width:thick" rowspan="1" colspan="1">3.18 × 10<sup>−4</sup></td>
                  <td align="center" style="border-right-width:thick" rowspan="1" colspan="1">3.47 × 10<sup>−4</sup></td>
                  <td align="center" rowspan="1" colspan="1">4.84 × 10<sup>−3</sup></td>
                </tr>
                <tr>
                  <td align="center" rowspan="2" style="border-right-width:thick" colspan="1">4</td>
                  <td align="center" style="border-right-width:thick" rowspan="1" colspan="1">PP</td>
                  <td align="center" style="border-right-width:thick" rowspan="1" colspan="1">0% (20 replicates)</td>
                  <td align="center" style="border-right-width:thick" rowspan="1" colspan="1">50.00% (18 replicates)</td>
                  <td align="center" rowspan="1" colspan="1">49.6% (8 replicates)</td>
                </tr>
                <tr>
                  <td align="center" style="border-right-width:thick" rowspan="1" colspan="1">SE</td>
                  <td align="center" style="border-right-width:thick" rowspan="1" colspan="1">7.63 × 10<sup>−3</sup></td>
                  <td align="center" style="border-right-width:thick" rowspan="1" colspan="1">3.89 × 10<sup>−4</sup></td>
                  <td align="center" rowspan="1" colspan="1">2.65 × 10<sup>−4</sup></td>
                </tr>
              </tbody>
            </table>
          </alternatives>
        </table-wrap>
        <table-wrap position="float" id="pcbi.1008380.t003">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1008380.t003</object-id>
          <label>Table 3</label>
          <caption>
            <title>Average posterior probability (PP) of the topology of network C obtained by running <monospace>MCMC_BiMarkers</monospace> on data simulated from network C.</title>
            <p>Results are given as a function of the number of sites and as a function of the number of lineages sampled in hybrid species B and C (either both 1 or both 4). Only one lineage was sampled in every other species, constant sites are included in the analysis, and the rates <italic toggle="yes">u</italic> and <italic toggle="yes">v</italic> are considered as known. 1.5 × 10<sup>6</sup> iterations are considered. <inline-formula id="pcbi.1008380.e121"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1008380.e121" id="pcbi.1008380.e121g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M121" display="inline" overflow="scroll"><mml:mover><mml:mtext>ESS</mml:mtext><mml:mo>¯</mml:mo></mml:mover></mml:math></alternatives></inline-formula> is the average ESS over the different replicates, and SE stands for the sampler efficiency.</p>
          </caption>
          <alternatives>
            <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1008380.t003" id="pcbi.1008380.t003g" position="float"/>
            <table frame="box" rules="all" border="0">
              <colgroup span="1">
                <col align="left" valign="middle" span="1"/>
                <col align="left" valign="middle" span="1"/>
                <col align="left" valign="middle" span="1"/>
                <col align="left" valign="middle" span="1"/>
                <col align="left" valign="middle" span="1"/>
              </colgroup>
              <thead>
                <tr>
                  <th align="center" colspan="2" style="border-right-width:thick;border-bottom-width:thick" rowspan="1"/>
                  <th align="center" colspan="3" style="border-bottom-width:thick" rowspan="1">Number of sites</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td align="center" style="border-bottom-width:thick;border-right-width:thick" rowspan="1" colspan="1">Number of lineages for B and for C</td>
                  <td align="center" style="border-bottom-width:thick;border-right-width:thick" rowspan="1" colspan="1"/>
                  <td align="center" style="border-bottom-width:thick;border-right-width:thick" rowspan="1" colspan="1">1,000</td>
                  <td align="center" style="border-bottom-width:thick;border-right-width:thick" rowspan="1" colspan="1">10,000</td>
                  <td align="center" style="border-bottom-width:thick" rowspan="1" colspan="1">100,000</td>
                </tr>
                <tr>
                  <td align="center" rowspan="3" style="border-right-width:thick" colspan="1">1</td>
                  <td align="center" style="border-right-width:thick" rowspan="1" colspan="1">PP</td>
                  <td align="center" style="border-right-width:thick" rowspan="1" colspan="1">0% (20 replicates)</td>
                  <td align="center" style="border-right-width:thick" rowspan="1" colspan="1">4.84% (20 replicates)</td>
                  <td align="center" rowspan="1" colspan="1">0% (20 replicates)</td>
                </tr>
                <tr>
                  <td align="center" style="border-right-width:thick" rowspan="1" colspan="1">SE</td>
                  <td align="center" style="border-right-width:thick" rowspan="1" colspan="1">9.70 × 10<sup>−5</sup></td>
                  <td align="center" style="border-right-width:thick" rowspan="1" colspan="1">3.10 × 10<sup>−5</sup></td>
                  <td align="center" rowspan="1" colspan="1">3.60 × 10<sup>−5</sup></td>
                </tr>
                <tr>
                  <td align="center" style="border-right-width:thick" rowspan="1" colspan="1">
                    <inline-formula id="pcbi.1008380.e122">
                      <alternatives>
                        <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1008380.e122" id="pcbi.1008380.e122g" position="anchor"/>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M122" display="inline" overflow="scroll">
                          <mml:mover>
                            <mml:mtext>ESS</mml:mtext>
                            <mml:mo>¯</mml:mo>
                          </mml:mover>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                  <td align="center" style="border-right-width:thick" rowspan="1" colspan="1">126.08</td>
                  <td align="center" style="border-right-width:thick" rowspan="1" colspan="1">40.38</td>
                  <td align="center" rowspan="1" colspan="1">46.80</td>
                </tr>
                <tr>
                  <td align="center" rowspan="3" style="border-right-width:thick" colspan="1">4</td>
                  <td align="center" style="border-right-width:thick" rowspan="1" colspan="1">PP</td>
                  <td align="center" style="border-right-width:thick" rowspan="1" colspan="1">0% (20 replicates)</td>
                  <td align="center" style="border-right-width:thick" rowspan="1" colspan="1">0% (12 replicates)</td>
                  <td align="center" rowspan="1" colspan="1">0% (9 replicates)</td>
                </tr>
                <tr>
                  <td align="center" style="border-right-width:thick" rowspan="1" colspan="1">SE</td>
                  <td align="center" style="border-right-width:thick" rowspan="1" colspan="1">2.38 × 10<sup>−4</sup></td>
                  <td align="center" style="border-right-width:thick" rowspan="1" colspan="1">8.53 × 10<sup>−5</sup></td>
                  <td align="center" rowspan="1" colspan="1">1.03 × 10<sup>−5</sup></td>
                </tr>
                <tr>
                  <td align="center" style="border-right-width:thick" rowspan="1" colspan="1">
                    <inline-formula id="pcbi.1008380.e123">
                      <alternatives>
                        <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1008380.e123" id="pcbi.1008380.e123g" position="anchor"/>
                        <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M123" display="inline" overflow="scroll">
                          <mml:mover>
                            <mml:mtext>ESS</mml:mtext>
                            <mml:mo>¯</mml:mo>
                          </mml:mover>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                  <td align="center" style="border-right-width:thick" rowspan="1" colspan="1">309.00</td>
                  <td align="center" style="border-right-width:thick" rowspan="1" colspan="1">110.90</td>
                  <td align="center" rowspan="1" colspan="1">159.96</td>
                </tr>
              </tbody>
            </table>
          </alternatives>
        </table-wrap>
        <p>In order to closely mimic what was done in [<xref rid="pcbi.1008380.ref054" ref-type="bibr">54</xref>] for networks A and B, we let <monospace>MCMC_BiMarkers</monospace> run for 1,500,000 iterations instead of adopting an ESS criterion. Data were simulated with <monospace>simBiMarker</monospace> [<xref rid="pcbi.1008380.ref054" ref-type="bibr">54</xref>]. Indeed, like S<sc>im</sc>S<sc>napp</sc>, S<sc>im</sc>S<sc>napp</sc>N<sc>et</sc> generates only count data (the number of alleles per site and per species). In contrast, <monospace>simBiMarker</monospace> generates actual sequences, a prerequisite for running <monospace>MCMC_BiMarkers</monospace>. The commands used under the 4 lineages scenario are given in Section 5 of <xref rid="pcbi.1008380.s001" ref-type="supplementary-material">S1 Text</xref>. Note that, to calibrate the network prior of <monospace>MCMC_BiMarkers</monospace>, the maximum number of reticulations was set to 2, and the prior Poisson distribution on the number of reticulation nodes was centered on 2.</p>
        <p>As expected, S<sc>napp</sc>N<sc>et</sc>’s ability to recover the correct network topology increased with the number of sites and with the number of lineages in the hybrid species (see <xref rid="pcbi.1008380.t002" ref-type="table">Table 2</xref>). For instance, in the presence of one lineage in hybrid species B and C, the posterior probability of network C increased from 7.87% for <italic toggle="yes">m</italic> = 10,000 to 54.90% for <italic toggle="yes">m</italic> = 100,000. In the same way, when 4 lineages were considered instead of a single lineage, we observed an increase from 7.87% to 50.00% for <italic toggle="yes">m</italic> = 10,000. Note that the average posterior probability of 49.60% reported for <italic toggle="yes">m</italic> = 100,000 and 4 lineages, is based only on 8 replicates.</p>
        <p>Surprisingly, in most cases studied, <monospace>MCMC_BiMarkers</monospace> was unable to recover the true topology of network C. The different behaviors of <monospace>MCMC_BiMarkers</monospace> and S<sc>napp</sc>N<sc>et</sc> may be due to the different network priors. Indeed, while the frequency of trees, 1-reticulation networks and 2-reticulations networks sampled by the two methods were globally similar (cf. <xref rid="pcbi.1008380.g014" ref-type="fig">Fig 14</xref>), we remarked that <monospace>MCMC_BiMarkers</monospace> seems to be unable, for these data sets, to sample networks with two reticulations on top of each other. Alternatively, we may be in the presence of failed or partial convergence of the MCMC process. Note the small ESS values for <monospace>MCMC_BiMarkers</monospace>, especially when only one lineage was sampled in hybrid species B and C. However, we attempted increasing the number of iterations from 1.5 × 10<sup>6</sup> to 12 × 10<sup>6</sup> and <monospace>MCMC_BiMarkers</monospace> was still unable to recover network C, despite larger ESS values (see Table B in <xref rid="pcbi.1008380.s001" ref-type="supplementary-material">S1 Text</xref>). We note here that S<sc>napp</sc>N<sc>et</sc> was ran for a maximum 804,000 iterations for 10,000 sites, and a maximum of 555,000 iterations for 100,000 sites.</p>
        <fig position="float" id="pcbi.1008380.g014">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1008380.g014</object-id>
          <label>Fig 14</label>
          <caption>
            <title>Frequency of trees (black), 1-reticulation networks (dark grey), 2-reticulations networks (light gray) sampled by S<sc>napp</sc>N<sc>et</sc> and <monospace>MCMC_BiMarkers</monospace>, when data were simulated from Network C (see Tables <xref rid="pcbi.1008380.t002" ref-type="table">2</xref> and <xref rid="pcbi.1008380.t003" ref-type="table">3</xref>).</title>
            <p>Recall that network C contains 2 reticulations.</p>
          </caption>
          <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1008380.g014" position="float"/>
        </fig>
        <p>
          <italic toggle="yes">2)</italic>
          <italic toggle="yes">CPU time and required memory</italic>
        </p>
        <p>To compare the CPU time and memory required by S<sc>napp</sc>N<sc>et</sc> and <monospace>MCMC_BiMarkers</monospace> on a single likelihood calculation, we focused on network C (see <xref rid="pcbi.1008380.g007" ref-type="fig">Fig 7</xref>), with and without outgroup (i.e. the species O), and networks C(3) and C(4), again with and without outgroup (see <xref rid="pcbi.1008380.g008" ref-type="fig">Fig 8</xref>). The simulations protocol used here is similar to that used in the previous sections, where here we fixed 10 lineages in species C and one lineage in the other species, <italic toggle="yes">m</italic> = 1,000 sites and 20 replicates per each network. The likelihood calculations were run on the true network.</p>
        <p>The experiments were executed on a full quad socket machine with a total of 512GB of RAM (4 * 2.3 GHz AMD Opteron 6376 with 16 Cores, each with a RDIMM 32Go Quad Rank LV 1333MHz processor). The jobs that did not finish within two weeks, or required more than 128 GB, were discarded.</p>
        <p>The results are reported in <xref rid="pcbi.1008380.t004" ref-type="table">Table 4</xref>. S<sc>napp</sc>N<sc>et</sc> managed to run for all the scenarios within the two weeks limit: on average within 2.62 minutes and using 1.67 GB on network C without outgroup, within 5.63 minutes and using 2 GB on network C with outgroup, within 14.21 minutes and using 2.19 GB on network C(3) without outgroup, within 24.69 minutes and using 2.21 GB on network C(3) with outgroup, within 45.47 minutes and using 2.63 GB on network C(4) without outgroup, and finally, within 70.98 minutes and using 3.17 GB on network C(4) with outgroup.</p>
        <table-wrap position="float" id="pcbi.1008380.t004">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1008380.t004</object-id>
          <label>Table 4</label>
          <caption>
            <title>Computational efficiency of calculating a single likelihood value in S<sc>napp</sc>N<sc>et</sc> and <monospace>MCMC_BiMarkers</monospace> for networks C, C(3) and C(4).</title>
            <p>10 lineages are sampled in species C and 1 lineage in other species. Average and standard deviation are reported.</p>
          </caption>
          <alternatives>
            <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1008380.t004" id="pcbi.1008380.t004g" position="float"/>
            <table frame="box" rules="all" border="0">
              <colgroup span="1">
                <col align="left" valign="middle" span="1"/>
                <col align="left" valign="middle" span="1"/>
                <col align="left" valign="middle" span="1"/>
                <col align="left" valign="middle" span="1"/>
                <col align="left" valign="middle" span="1"/>
              </colgroup>
              <thead>
                <tr>
                  <th align="center" style="border-bottom-width:thick" rowspan="1" colspan="1"/>
                  <th align="center" colspan="2" style="border-bottom-width:thick" rowspan="1">CPU time</th>
                  <th align="center" colspan="2" style="border-bottom-width:thick" rowspan="1">Memory</th>
                </tr>
                <tr>
                  <th align="center" style="border-bottom-width:thick" rowspan="1" colspan="1"/>
                  <th align="center" style="border-bottom-width:thick" rowspan="1" colspan="1">S<sc>napp</sc>N<sc>et</sc> (in minutes)
</th>
                  <th align="center" style="border-bottom-width:thick" rowspan="1" colspan="1"><monospace>MCMC_BiMarkers</monospace> (in hours)</th>
                  <th align="center" style="border-bottom-width:thick" rowspan="1" colspan="1">S<sc>napp</sc>N<sc>et</sc> (max in GB)</th>
                  <th align="center" style="border-bottom-width:thick" rowspan="1" colspan="1"><monospace>MCMC_BiMarkers</monospace> (max in GB)</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td align="center" rowspan="1" colspan="1">
                    <bold>Network C without outgroup</bold>
                  </td>
                  <td align="center" rowspan="1" colspan="1">2.62 ± 0.04</td>
                  <td align="center" rowspan="1" colspan="1">14.58 ± 0.50</td>
                  <td align="center" rowspan="1" colspan="1">1.67 ± 0.03</td>
                  <td align="center" rowspan="1" colspan="1">8.76 ± 0.02</td>
                </tr>
                <tr>
                  <td align="center" style="border-bottom-width:thick" rowspan="1" colspan="1">
                    <bold>Network C</bold>
                  </td>
                  <td align="center" style="border-bottom-width:thick" rowspan="1" colspan="1">5.63 ± 0.16</td>
                  <td align="center" style="border-bottom-width:thick" rowspan="1" colspan="1">33.46 ± 1.31</td>
                  <td align="center" style="border-bottom-width:thick" rowspan="1" colspan="1">2.00 ± 0.09</td>
                  <td align="center" style="border-bottom-width:thick" rowspan="1" colspan="1">8.79 ± 0.02</td>
                </tr>
                <tr>
                  <td align="center" rowspan="1" colspan="1">
                    <bold>Network C(3) without outgroup</bold>
                  </td>
                  <td align="center" rowspan="1" colspan="1">14.21 ± 0.56</td>
                  <td align="center" rowspan="1" colspan="1">?</td>
                  <td align="center" rowspan="1" colspan="1">2.19 ± 0.01</td>
                  <td align="center" rowspan="1" colspan="1">&lt; 64</td>
                </tr>
                <tr>
                  <td align="center" style="border-bottom-width:thick" rowspan="1" colspan="1">
                    <bold>Network C(3)</bold>
                  </td>
                  <td align="center" style="border-bottom-width:thick" rowspan="1" colspan="1">24.69 ± 0.64</td>
                  <td align="center" style="border-bottom-width:thick" rowspan="1" colspan="1">?</td>
                  <td align="center" style="border-bottom-width:thick" rowspan="1" colspan="1">2.21 ± 0.06</td>
                  <td align="center" style="border-bottom-width:thick" rowspan="1" colspan="1">&lt;64</td>
                </tr>
                <tr>
                  <td align="center" rowspan="1" colspan="1">
                    <bold>Network C(4) without outgroup</bold>
                  </td>
                  <td align="center" rowspan="1" colspan="1">45.47 ± 1.44</td>
                  <td align="center" rowspan="1" colspan="1">?</td>
                  <td align="center" rowspan="1" colspan="1">2.63 ± 0.60</td>
                  <td align="center" rowspan="1" colspan="1">&gt; 128</td>
                </tr>
                <tr>
                  <td align="center" rowspan="1" colspan="1">
                    <bold>Network C(4)</bold>
                  </td>
                  <td align="center" rowspan="1" colspan="1">70.98 ± 3,16</td>
                  <td align="center" rowspan="1" colspan="1">?</td>
                  <td align="center" rowspan="1" colspan="1">3.17 ± 0.81</td>
                  <td align="center" rowspan="1" colspan="1">&gt; 128</td>
                </tr>
              </tbody>
            </table>
          </alternatives>
        </table-wrap>
        <p>We were able to run <monospace>MCMC_BiMarkers</monospace> for all replicates of the network C, and we can thus compare its performance with that of S<sc>napp</sc>N<sc>et</sc>. From <xref rid="pcbi.1008380.t004" ref-type="table">Table 4</xref>, we see that S<sc>napp</sc>N<sc>et</sc> is remarkably faster that <monospace>MCMC_BiMarkers</monospace>, needing on average only 0.29% of the time and 21% of the memory required by <monospace>MCMC_BiMarkers</monospace>. <monospace>MCMC_BiMarkers</monospace> needed more than 2 weeks for all scenarios on the C(3) network (requiring less than 64 GB), thus no run time is available for these scenarios. The same holds for the C(4) network scenarios, but for a different reason: all runs needed more than 128 GB each, and were discarded.</p>
        <p>In Section 8 of <xref rid="pcbi.1008380.s001" ref-type="supplementary-material">S1 Text</xref> we provide the results of additional experiments on simulated data. In Section 8.1, we assess whether S<sc>napp</sc>N<sc>et</sc>’s MCMC sampler can adequately sample from network space. In Section 8.2 we assess how population size priors and network priors influence S<sc>napp</sc>N<sc>et</sc>’s inferences.</p>
      </sec>
    </sec>
    <sec id="sec026">
      <title>Real data analysis</title>
      <p>Real data derived from recent studies on rice were used to illustrate the application of S<sc>napp</sc>N<sc>et</sc>.</p>
      <p>Diversity among Asian rice cultivars is structured around two major types which display worldwide distributions, namely Japonica and Indica, and two types localised around the Himalayas, namely <italic toggle="yes">circum</italic> Aus (cAus) and <italic toggle="yes">circum</italic> Basmati (cBasmati) [<xref rid="pcbi.1008380.ref073" ref-type="bibr">73</xref>, <xref rid="pcbi.1008380.ref074" ref-type="bibr">74</xref>]. Japonica and Indica each have several subgroups with geographical contrast (see [<xref rid="pcbi.1008380.ref073" ref-type="bibr">73</xref>] as the most detailed description). Domestication scenarios that have been put forwards since the availability of whole genome sequences propose one to three domestications corresponding either to an early pivotal process in Japonica [<xref rid="pcbi.1008380.ref072" ref-type="bibr">72</xref>], or to multiple parallel dynamics in Japonica, Indica and cAus [<xref rid="pcbi.1008380.ref012" ref-type="bibr">12</xref>, <xref rid="pcbi.1008380.ref027" ref-type="bibr">27</xref>], depending on whether they consider the contribution of domestication alleles by the Japonica origin as predominant or as one among others. cBasmati has been posited as a specific lineage within Japonica [<xref rid="pcbi.1008380.ref072" ref-type="bibr">72</xref>] or as a secondary derivative from admixture between Japonica and a local wild rice close to cAus [<xref rid="pcbi.1008380.ref075" ref-type="bibr">75</xref>], or between Japonica and cAus with the contribution of one or several additional cryptic sources [<xref rid="pcbi.1008380.ref076" ref-type="bibr">76</xref>].</p>
      <p>The most advanced studies of wild rice [<xref rid="pcbi.1008380.ref072" ref-type="bibr">72</xref>] recognize three populations designated Or-I to Or-III (Or for <italic toggle="yes">Oryza rufipogon</italic>), of which Or-I and Or-III are closely related to cultivars and Or-II is not. Using a data set constructed in [<xref rid="pcbi.1008380.ref073" ref-type="bibr">73</xref>], we compared wild rices to cultivars on the basis of ca. 2.5 million SNPs (cf. Fig M in <xref rid="pcbi.1008380.s001" ref-type="supplementary-material">S1 Text</xref>) and we selected representatives of Japonica, Indica, cAus and cBasmati as well as wild rices Or-III, closer to Japonica and cBasmati, and Or-I, closer either to Indica (Or-Ii) or to cAus (Or-Ia). For clarity in our subsequent use, we call the wild forms Or3, Or1I and Or1A, respectively. We made data sets of different sample sizes, including either one or two varieties per subpopulation. The studied subpopulations are the 4 groups of cultivars (Japonica, Indica, cAus, cBasmati), and different types of wild rice (Or3, Or1A, Or1I), consistent with the classification by [<xref rid="pcbi.1008380.ref072" ref-type="bibr">72</xref>]. The 3 data sets we constructed are described in the <xref rid="sec002" ref-type="sec">Materials and methods</xref>.</p>
      <p>In <xref rid="pcbi.1008380.g015" ref-type="fig">Fig 15</xref>, we report results for data set 1, which includes only one variety per subpopulation (cf. Table D in <xref rid="pcbi.1008380.s001" ref-type="supplementary-material">S1 Text</xref>). We studied two different samplings of 12k SNPs along the whole genome alignment. For each sampling, we ran two independent Markov chains with different starting points, for 10 million iterations. To assess the convergence of S<sc>napp</sc>N<sc>et</sc> on data set 1, (a) the ESS of the posterior distribution was checked for each chain, (b) the trace plots of the different parameters and their associated ESS were examined and (c) the two posterior distributions corresponding to the two independent chains were compared (see Fig N and Table F in <xref rid="pcbi.1008380.s001" ref-type="supplementary-material">S1 Text</xref>). In view of these results, S<sc>napp</sc>N<sc>et</sc> reached stationarity. The ESS of the posterior distribution took the values 844 (resp. 971), 1159 (resp. 535) for the two different chains of the first (resp. second) sampling. All the networks sampled by the MCMC had the same topology with one reticulation only. For both genome samplings the lineages associate Or1I with Ind, Or1A with cAus and Or3 with Jap, respectively, while the reticulation conjugates Jap with (Or1A/cAus), the common precursor of Or1-A/cAus, with a dosage ratio close to 2:1, to yield cBas.</p>
      <fig position="float" id="pcbi.1008380.g015">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1008380.g015</object-id>
        <label>Fig 15</label>
        <caption>
          <title>The two networks obtained for data set 1 with only one variety per subpopulation.</title>
          <p>Each network corresponds to the posterior mean of the distribution sampled by S<sc>napp</sc>N<sc>et</sc>. Inheritance probabilities are reported above reticulation edges and branch lengths are given in units of expected number of mutations per site (see the scale at the top left).</p>
        </caption>
        <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1008380.g015" position="float"/>
      </fig>
      <p>Next, we tackled a larger data set, data set 2, containing two varieties per subpopulation (see Table E in <xref rid="pcbi.1008380.s001" ref-type="supplementary-material">S1 Text</xref>). Two different chains corresponding to two different samplings of 12k SNPs along the whole genome alignment were run. The number of reticulations was bounded by one in order to reach convergence in a reasonable amount of time: after three months and half of computations, the ESS took the values 227 and 201 for the first and the second chain, respectively. <xref rid="pcbi.1008380.g016" ref-type="fig">Fig 16</xref> illustrates the two networks obtained for the two different samplings. Each network corresponds to the posterior mean of the sampled distribution. Note that in both cases, the posterior distribution was concentrated on a single topology. The two genome samplings yield networks very similar to one another and remarkably close to that revealed with data set 1. The reticulation that was allowed again conjugates the Jap lineage with the common precursor of subpopulations Or1A and cAus. In contrast, after 6 months of calculations, S<sc>napp</sc>N<sc>et</sc> had still not reached the stationary regime for the two different samplings, when a maximum of 2 reticulations was imposed.</p>
      <fig position="float" id="pcbi.1008380.g016">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1008380.g016</object-id>
        <label>Fig 16</label>
        <caption>
          <title>The two networks obtained for data set 2 with two varieties per subpopulation.</title>
          <p>Each network corresponds to the posterior mean of the distribution sampled by S<sc>napp</sc>N<sc>et</sc>. Inheritance probabilities are reported above reticulation edges and branch lengths are given in units of expected number of mutations per site (see the scale at the top left).</p>
        </caption>
        <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1008380.g016" position="float"/>
      </fig>
      <p>We also investigated another data set, data set 3, including two varieties per subpopulation and 12k SNPs for a different taxon sampling (see Table E in <xref rid="pcbi.1008380.s001" ref-type="supplementary-material">S1 Text</xref>). In this case, large ESS values were observed when S<sc>napp</sc>N<sc>et</sc> was allowed to infer networks with 2 reticulations: the ESS was estimated at 373 after having let S<sc>napp</sc>N<sc>et</sc> run for 7 months. The maximum a posteriori (MAP) network is represented in <xref rid="pcbi.1008380.g017" ref-type="fig">Fig 17</xref>. For this data set, the resulting topology again features a single reticulation, although two were allowed. It also conjugates Jap with the precursor (Or1A/cAus) of Or1A and cAus to produce cBas. Yet the composition is more unbalanced towards Jap (0.85) and (Or1A/cAus) appears involved very close to the Or1A vs cAus initial divergence. Given this proximity, it was useful to describe the three networks retained by S<sc>napp</sc>N<sc>et</sc> during the MCMC process (<xref rid="pcbi.1008380.g018" ref-type="fig">Fig 18</xref>). The first one (67%) features a conjugation between Jap and (Or1A/cAus), while the second one (23%) conjugates Jap with cAus and the third one (10%) conjugates Jap with Or1A in the origin of cBas.</p>
      <fig position="float" id="pcbi.1008380.g017">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1008380.g017</object-id>
        <label>Fig 17</label>
        <caption>
          <title>The MAP phylogenetic network obtained for data set 3 with two varieties per subpopulation.</title>
          <p>Inheritance probabilities are reported above reticulation edges and branch lengths are given in units of expected number of mutations per site (see the scale at the top left).</p>
        </caption>
        <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1008380.g017" position="float"/>
      </fig>
      <fig position="float" id="pcbi.1008380.g018">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1008380.g018</object-id>
        <label>Fig 18</label>
        <caption>
          <title>The three topologies sampled by S<sc>napp</sc>N<sc>et</sc> when data set 3 was considered.</title>
          <p>Reported inheritance probabilities for each topology are averages on sampled observations.</p>
        </caption>
        <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1008380.g018" position="float"/>
      </fig>
      <p>Altogether the various networks inferred by S<sc>napp</sc>N<sc>et</sc> reveal stable features:</p>
      <list list-type="bullet">
        <list-item>
          <p>the correspondence between wild subpopulations and cultivated subpopulations which point at three pillars for rice, namely Japonica, Indica and cAus</p>
        </list-item>
        <list-item>
          <p>the early divergence of Japonica, that predates the one between Indica and cAus</p>
        </list-item>
        <list-item>
          <p>the earlier divergence between wild and cultivated forms within the Japonica pillar</p>
        </list-item>
        <list-item>
          <p>the mobilisation of early Japonica cultivars to combine with the cAus pillar to produce the fourth varietal type cBas</p>
        </list-item>
        <list-item>
          <p>the indication that this hybridization may have occured before the domestication of cAus.</p>
        </list-item>
      </list>
      <p>The latter item yet displays uneven strength levels between the various data sets. The first four items confirm the latest interpretations of massive analyses among rice specialists. Wild rice displays broad diversity and some of the wild subpopulations have been specifically involved in the emergence of cultivated forms. While the most ancient domestication occurred in China to produce Japonica cultivars, two other important foundations, namely Indica and cAus, contributed to the diversity of current rice cultivars. Early hybridization between Japonica cultivars and an ancestor, presumably wild, of current cAus cultivars and related wild forms resulted in the evolution of cBasmati cultivars.</p>
    </sec>
  </sec>
  <sec sec-type="conclusions" id="sec027">
    <title>Discussion</title>
    <p>In this paper, we introduced a new Bayesian method, S<sc>napp</sc>N<sc>et</sc>, dedicated to phylogenetic network inference. S<sc>napp</sc>N<sc>et</sc> has similar goals as <monospace>MCMC_BiMarkers</monospace>, a method recently proposed by Zhu et al. [<xref rid="pcbi.1008380.ref054" ref-type="bibr">54</xref>], but differs from this method in two main aspects. The first difference is due to the way the two methods handle the complexity of the sampled networks. Unlike binary trees that have a fixed number of branches given the number of considered species, network topologies can be of arbitrary complexity. Their complexity directly depends on the number of reticulations they contain. In MCMC processes, the complexity of sampled networks is regulated by the prior. <monospace>MCMC_BiMarkers</monospace> uses descriptive priors: more precisely, it assumes a Poisson distribution for the number of reticulation nodes and an exponential distribution for the <italic toggle="yes">diameter</italic> of reticulation nodes [<xref rid="pcbi.1008380.ref051" ref-type="bibr">51</xref>, <xref rid="pcbi.1008380.ref052" ref-type="bibr">52</xref>, <xref rid="pcbi.1008380.ref054" ref-type="bibr">54</xref>]. In contrast, S<sc>napp</sc>N<sc>et</sc>’s prior is based on that of Zhang et al., which explicitly relies on speciation and hybridization rates and is extendable to account for extinction and incomplete sampling [<xref rid="pcbi.1008380.ref053" ref-type="bibr">53</xref>].</p>
    <p>Our simulation study may provide some insight on the influence of these different priors. On two networks of moderate complexity (networks A and B), S<sc>napp</sc>N<sc>et</sc> and <monospace>MCMC_BiMarkers</monospace> presented globally similar results. Indeed, when we considered numbers of sites that are largely achieved in current phylogenomic studies (i.e. 10,000 or 100,000 sites), both methods were able to recover the true networks under this realistic framework. However, in presence of only a few sites (1,000 sites) which is unusual nowadays but still can be the case for poorly sequenced organisms, <monospace>MCMC_BiMarkers</monospace> recovered the correct topology with higher posterior probability than S<sc>napp</sc>N<sc>et</sc>. On the other hand, when focusing on a more complex network (network C) containing reticulation nodes on top of one another, the converse appeared to be true. With sufficiently large datasets, S<sc>napp</sc>N<sc>et</sc> recovered the correct scenario in approximately 50% of samples whereas <monospace>MCMC_BiMarkers</monospace> inferred this history in less than 5% of cases. Although these differences may be due to the different network priors used by the two methods, more work is needed to elucidate the reasons behind them. To conclude the discussion on priors, we also observed that, on simulated data, S<sc>napp</sc>N<sc>et</sc>’s accuracy did not really deteriorate with incorrect priors on population sizes, although assuming a prior distribution skewed towards small population sizes has a tendency to favor hybridization over ILS as an explanation for non tree-like signals. Similar robustness properties were observed by [<xref rid="pcbi.1008380.ref054" ref-type="bibr">54</xref>] for <monospace>MCMC_BiMarkers</monospace>.</p>
    <p>The second major difference between <monospace>MCMC_BiMarkers</monospace> and S<sc>napp</sc>N<sc>et</sc> lies in the way they compute the likelihood of a network. This step is at the core of the Bayesian analysis. According to the authors of <monospace>MCMC_BiMarkers</monospace>, this remains a major computational bottleneck and limits the applicability of their methods [<xref rid="pcbi.1008380.ref059" ref-type="bibr">59</xref>]. To understand the origin of this bottleneck, recall that the MCMC process of a Bayesian sampling explores a huge network space and that, at each exploration step, computing the likelihood is by far the most time consuming operation. Moreover, we need sometimes millions of runs before the chain converges. Thus, likelihood computation is a key factor on which to operate to be able to process large data sets.</p>
    <p>The likelihood computation of <monospace>MCMC_BiMarkers</monospace> consists in a bottom-up traversal, from the leaves to the root. Each time a reticulation node <italic toggle="yes">r</italic> is visited, the partial likelihoods must be decomposed following all the possible ways the lineages reaching <italic toggle="yes">r</italic> can be assigned to the two parent populations of <italic toggle="yes">r</italic>. These partial likelihoods will be merged back only when the traversal reaches a lowest articulation node [<xref rid="pcbi.1008380.ref054" ref-type="bibr">54</xref>], or in other words the root of the blob to which <italic toggle="yes">r</italic> belongs (a <italic toggle="yes">blob</italic> is a maximal biconnected subgraph [<xref rid="pcbi.1008380.ref065" ref-type="bibr">65</xref>], see also <xref rid="pcbi.1008380.s001" ref-type="supplementary-material">S1 Text</xref>). For every other reticulation <italic toggle="yes">r</italic>′ reached before the root of the blob, the decomposition above is applied again. As a result, the time required to process a blob grows exponentially with the number of reticulations it contains. More precisely, the time complexity of the likelihood computation in <monospace>MCMC_BiMarkers</monospace> is in <italic toggle="yes">O</italic>(<italic toggle="yes">sn</italic><sup>4<italic toggle="yes">ℓ</italic>+4</sup>), where <italic toggle="yes">ℓ</italic> is the <italic toggle="yes">level</italic> of the network and <italic toggle="yes">s</italic> is the size of the species network.</p>
    <p>Similarly to <monospace>MCMC_BiMarkers</monospace>, we compute the likelihood in a bottom-up traversal and when reaching a reticulation node <italic toggle="yes">r</italic>, we also take into account the various ways lineages could have split. But the originality of S<sc>napp</sc>N<sc>et</sc> is to compute <italic toggle="yes">joint conditional probabilities</italic> for branches above a same reticulation node <italic toggle="yes">r</italic> (see the <xref rid="sec002" ref-type="sec">Materials and methods</xref>). The set of branches jointly considered increases when crossing other reticulation nodes in a same blob, but it can also decrease when crossing tree-nodes in the blob (i.e. nodes having one ancestor and several children). Of course, the time to compute each partial likelihood increases in proportion with the number of branches considered together. More precisely, S<sc>napp</sc>N<sc>et</sc> runs in <inline-formula id="pcbi.1008380.e124"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1008380.e124.jpg" id="pcbi.1008380.e124g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M124" display="inline" overflow="scroll"><mml:mrow><mml:mi>O</mml:mi><mml:mo>(</mml:mo><mml:mi>s</mml:mi><mml:msup><mml:mi>n</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mover><mml:mi>K</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mo>+</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>, where <inline-formula id="pcbi.1008380.e125"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1008380.e125.jpg" id="pcbi.1008380.e125g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M125" display="inline" overflow="scroll"><mml:mover><mml:mi>K</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:math></alternatives></inline-formula> is the maximum number of branches simultaneously considered in a partial likelihood. The interest in depending on <inline-formula id="pcbi.1008380.e126"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1008380.e126.jpg" id="pcbi.1008380.e126g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M126" display="inline" overflow="scroll"><mml:mover><mml:mi>K</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:math></alternatives></inline-formula> instead of <italic toggle="yes">ℓ</italic> (the number of reticulations in a blob), is that for some blobs, we can resort to a bottom-up traversal of the blob that limits <inline-formula id="pcbi.1008380.e127"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1008380.e127.jpg" id="pcbi.1008380.e127g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M127" display="inline" overflow="scroll"><mml:mover><mml:mi>K</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:math></alternatives></inline-formula> to a small constant and process the blob in polynomial time in <italic toggle="yes">n</italic>, while <monospace>MCMC_BiMarkers</monospace> still requires an exponential time in <italic toggle="yes">ℓ</italic>.</p>
    <p>Our results from simulated data confirm the above theoretical discussion. For a single likelihood evaluation, S<sc>napp</sc>N<sc>et</sc> was found to be orders of magnitude faster than <monospace>MCMC_BiMarkers</monospace> on networks containing reticulation nodes on top of one another. Besides, S<sc>napp</sc>N<sc>et</sc> required substantially less memory than <monospace>MCMC_BiMarkers</monospace>. These gains enable us to consider complex evolution scenarios in our Bayesian analyses.</p>
    <p>In practice, S<sc>napp</sc>N<sc>et</sc> is a very useful tool for analyzing complex genomic data, as evidenced by our study about rice. Indeed, the most recent extensive genetic studies on this crop confirm and document the extent of genetic exchanges in various directions. Yet the same species consistently displays the reality of a simple classification scheme with only a few predominant types. Thus rice appears as a chance and a challenge for testing methods aiming to tackle phylogenetic resolution within a hybrid swarm. The application of S<sc>napp</sc>N<sc>et</sc> proves very efficient in resolving the three main phylogenetic pillars of current diversity in Asian rice [<xref rid="pcbi.1008380.ref012" ref-type="bibr">12</xref>, <xref rid="pcbi.1008380.ref077" ref-type="bibr">77</xref>] and revealing a hybrid origin for the iconic varietal group cBasmati [<xref rid="pcbi.1008380.ref075" ref-type="bibr">75</xref>, <xref rid="pcbi.1008380.ref076" ref-type="bibr">76</xref>]. The various data sets treated here suggest a contribution of Japonica cultivars at a high level, between 0.6 and 0.85. This rather broad range is not surprising given that this hybrid origin probably reflects numerous recent individual stories for very specific varieties rather than an old common story for a homogeneous lineage. On the other side, the second component of cBasmati derived from local sources in the North of the Indian subcontinent seems to date from before the evolution of cAus varieties. Here again, it is likely that many diverse events occurred resulting in a very rich diversity. Full resolution of the origin of cBasmati may require further investigation given the vast diversity it encompasses [<xref rid="pcbi.1008380.ref078" ref-type="bibr">78</xref>, <xref rid="pcbi.1008380.ref079" ref-type="bibr">79</xref>]. S<sc>napp</sc>N<sc>et</sc> provides here a consistent and convincing set of results. Its integration in B<sc>east</sc> may provide easier applicability than previous methods, potentially making it a method of choice to expand analysis of complex pictures generated by crop evolution and adaptation. Further applicability advantages may come from the fact that S<sc>napp</sc>N<sc>et</sc> can be used to compute the likelihoods of a set of networks of interest, and then to penalize more complex models with the AIC [<xref rid="pcbi.1008380.ref080" ref-type="bibr">80</xref>] and BIC [<xref rid="pcbi.1008380.ref081" ref-type="bibr">81</xref>] criteria.</p>
    <p>In the future, in order to handle more sites in practice, the MSNC model should be extended to allow recombination events between loci. Recall that we have limited our rice study to 12,000 markers sampled along the genome because our model assumes independence between sampled sites, as does also S<sc>napp</sc>’s model, from which we inherit. As mentioned in the review of [<xref rid="pcbi.1008380.ref038" ref-type="bibr">38</xref>], in order to model recombination properly, the study of gene networks within species networks is an area for future research. A possibility would be to exploit previous work on Ancestral Recombination Graphs (see for instance [<xref rid="pcbi.1008380.ref082" ref-type="bibr">82</xref>]).</p>
    <p>Another important research topic for MCMC inference of phylogenetic networks is the question of how to properly assess the autocorrelation between the topologies of the sampled networks, or, in other words, how to estimate the effective sample size (ESS) of the sampled topologies. Indeed, a large ESS for continuous parameters in a phylogenetic model does not necessarily imply a large ESS for the sampled topologies. Methods to estimate the ESS of a sample of tree topologies have been recently proposed [<xref rid="pcbi.1008380.ref070" ref-type="bibr">70</xref>]. They rely on measures of the distance between pairs of trees in the sample—which enable to assess autocorrelation—or on translating tree topologies into numbers (e.g., the distance from a focal tree), which are then treated as continuous parameters—for which an ESS can then be computed using standard approaches. These methods to estimate topological ESS can be in principle adapted to networks. However some research will be needed for this, as standard tree metrics (e.g. the Robinson-Foulds distance [<xref rid="pcbi.1008380.ref083" ref-type="bibr">83</xref>] or the path-lengths difference [<xref rid="pcbi.1008380.ref084" ref-type="bibr">84</xref>]) do not have unique, easy to compute, natural extensions for networks (see [<xref rid="pcbi.1008380.ref038" ref-type="bibr">38</xref>] for a discussion on this). In the present work, different MCMC replicates led to consistent results, but we have not attempted to evaluate autocorrelation for the sampled topologies and/or their ESS. This is a limitation of all Bayesian approaches for network inference proposed so far [<xref rid="pcbi.1008380.ref051" ref-type="bibr">51</xref>, <xref rid="pcbi.1008380.ref053" ref-type="bibr">53</xref>, <xref rid="pcbi.1008380.ref054" ref-type="bibr">54</xref>].</p>
    <p>Related to the issue above, it would be useful to conduct an in-depth investigation of the efficiency of the MCMC operators for the exploration of network topology space. In this work, we rely on the operators by Zhang et al. [<xref rid="pcbi.1008380.ref053" ref-type="bibr">53</xref>], who identified this as a major bottleneck of their approach (but they also had operators to change the gene tree embeddings, a feature that we do not need here). Although some important progress has been made in the last 20 years [<xref rid="pcbi.1008380.ref085" ref-type="bibr">85</xref>], in 2004 Felsenstein aptly wrote (speaking about trees): “At the moment the choice of a good proposal distribution involves the burning of incense, casting of chicken bones, magical incantations and invoking the opinions of more prestigious colleagues” [<xref rid="pcbi.1008380.ref014" ref-type="bibr">14</xref>]. Since network space is significantly more complex than tree space, it is easy to predict that this topic will keep researchers busy for a long time. A good starting point to address convergence issues in S<sc>napp</sc>N<sc>et</sc> would be to integrate it to the new B<sc>east</sc> 2 package <sc>coupled</sc> MCMC [<xref rid="pcbi.1008380.ref086" ref-type="bibr">86</xref>], which tackles local optima issues thanks to heated chains.</p>
    <p>Also note that in this work we limited our experiments to relatively simple networks, with few reticulations and few species (leaves). While the number of reticulations represents a strong limitation of all existing Bayesian approaches, the number of species is a much weaker limiting factor. Networks over more species can already be inferred by S<sc>napp</sc>N<sc>et</sc> and related approaches, but MCMC inference for such networks will then necessitate much more complex downstream analyses than the ones used here. For example, the posterior probability of any single network topology will be very small, and thus it will be much more interesting to look at the probability of individual splits, or to develop a network analog of consensus trees. These are not simple tasks, because all the underlying algorithmic problems (checking the presence of a split/clade in a network, or that of a subtree etc.) are computationally hard to solve on large networks [<xref rid="pcbi.1008380.ref087" ref-type="bibr">87</xref>].</p>
    <p>Last, it would be interesting to study the identifiability of the model underlying S<sc>napp</sc>N<sc>et</sc>. For example, it is easy to see that if only one lineage is sampled from a given species at each locus, then the population size <italic toggle="yes">θ</italic> of that species is non-identifiable (because no coalescence can ever occur in it, and thus the likelihood does not depend on <italic toggle="yes">θ</italic>). Similarly, if only one lineage is sampled below a reticulation node, then the height of that node is non-identifiable [<xref rid="pcbi.1008380.ref041" ref-type="bibr">41</xref>, <xref rid="pcbi.1008380.ref061" ref-type="bibr">61</xref>]. Intuitively, the more lineages can co-exist in a part of the species network, the more information there will be for the reconstruction of that part of the network. These aspects should be further investigated in future works.</p>
    <p>Many methodological questions on Bayesian inference of phylogenetic networks remain open. The present work focused on the efficient calculation of likelihood for a single network, which is the key component of any Bayesian approach. At the end of their paper, the authors of <monospace>MCMC_BiMarkers</monospace> [<xref rid="pcbi.1008380.ref054" ref-type="bibr">54</xref>] concluded by mentioning that “An important direction for future research is improving the computational requirements of the method to scale up to data sets with many taxa”. Our present work is a first answer to this demand.</p>
  </sec>
  <sec id="sec028" sec-type="supplementary-material">
    <title>Supporting information</title>
    <supplementary-material id="pcbi.1008380.s001" position="float" content-type="local-data">
      <label>S1 Text</label>
      <caption>
        <title>Supplementary material for the manuscript.</title>
        <p><bold>Fig A:</bold> Density probabilities for 5-tips networks, simulated with a prior corresponding to a birth hybridization process with parameters <italic toggle="yes">d</italic> = 10, <italic toggle="yes">r</italic> = 1/2 and <italic toggle="yes">τ</italic><sub>0</sub> = 0.1, using the S<sc>pecies</sc>N<sc>etwork</sc> package [<xref rid="pcbi.1008380.ref053" ref-type="bibr">53</xref>]. The figure is obtained for 10,000 replicates. The means are given by the dashed vertical lines. <bold>Fig B:</bold> Density probabilities for 5-tips networks with at most two reticulations, simulated with a prior corresponding to a birth hybridization process with parameters <italic toggle="yes">d</italic> = 10, <italic toggle="yes">r</italic> = 1/2 and <italic toggle="yes">τ</italic><sub>0</sub> = 0.1, using the S<sc>pecies</sc>N<sc>etwork</sc> package [<xref rid="pcbi.1008380.ref053" ref-type="bibr">53</xref>]. Figures are drawn for the 4,377 cases in 10,000 where the network had at most two reticulations. The means are given by the dashed vertical lines. <bold>Fig C:</bold> Density probabilities regarding the 5-tips network with a maximum of 3 reticulations, simulated under the birth hybridization process (<italic toggle="yes">d</italic> = 10, <italic toggle="yes">r</italic> = 1/2, <italic toggle="yes">τ</italic><sub>0</sub> = 0.1, 5,837 replicates), using the S<sc>pecies</sc>N<sc>etwork</sc> package [<xref rid="pcbi.1008380.ref053" ref-type="bibr">53</xref>]. The means are given by the dashed vertical lines. <bold>Fig D:</bold> Estimated node heights of network B. 10,000 sites are considered and 2 lineages per species. Constant sites are included in the analysis, and the estimated heights are based on the 12 replicates (over 14 replicates) for which network B was recovered by S<sc>napp</sc>N<sc>et</sc> (criterion ESS &gt; 200; <italic toggle="yes">θ</italic> ∼ Γ(1, 200), <inline-formula id="pcbi.1008380.e128"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1008380.e128.jpg" id="pcbi.1008380.e128g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M128" display="inline" overflow="scroll"><mml:mrow><mml:mi>d</mml:mi><mml:mo>∼</mml:mo><mml:mi mathvariant="script">E</mml:mi><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>.</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>, <italic toggle="yes">r</italic> ∼ Beta(1, 1), <inline-formula id="pcbi.1008380.e129"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1008380.e129.jpg" id="pcbi.1008380.e129g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M129" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>∼</mml:mo><mml:mi mathvariant="script">E</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mn>10</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> for the priors, number of reticulations bounded by 3 when exploring the network space). Heights are measured in units of expected number of mutations per site. True values are given by the dashed horizontal lines. The initials MRCA stand for “Most Recent Common Ancestor”. <bold>Fig E:</bold> Estimated population sizes <italic toggle="yes">θ</italic> for each branch of network B. Same framework as Figure D in S1 Text. True values are given by the dashed horizontal lines. The initials MRCA stand for “Most Recent Common Ancestor”. <bold>Fig F:</bold> Same framework as Figure E in S1 Text. <bold>Fig G:</bold> Estimated node heights of network C as a function of the number of sites. Same experiment as in <xref rid="pcbi.1008380.t002" ref-type="table">Table 2</xref> of the main manuscript: 1 lineage in species O, A and D, and 4 lineages in species B and C. The estimated heights are based on the replicates for which network C was recovered by S<sc>napp</sc>N<sc>et</sc>. True values are given by the dashed horizontal lines. The initials MRCA stand for “Most Recent Common Ancestor”. <bold>Fig H:</bold> Estimated height and length for network A, as a function of the number of sites. Heights and lengths are measured in units of expected number of mutations per site. True values are given by the dashed horizontal lines. Two lineages per species were simulated. Only polymorphic sites are included in the analysis, and 20 replicates are considered for each simulation set up (criterion ESS &gt; 200 for m = 1,000 and m = 10,000, and criterion ESS &gt; 100 for m = 100,000; <italic toggle="yes">θ</italic> ∼ Γ(1, 200), <inline-formula id="pcbi.1008380.e130"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1008380.e130.jpg" id="pcbi.1008380.e130g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M130" display="inline" overflow="scroll"><mml:mrow><mml:mi>d</mml:mi><mml:mo>∼</mml:mo><mml:mi mathvariant="script">E</mml:mi><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>.</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>, <italic toggle="yes">r</italic> ∼ Beta(1, 1), <inline-formula id="pcbi.1008380.e131"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1008380.e131.jpg" id="pcbi.1008380.e131g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M131" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>∼</mml:mo><mml:mi mathvariant="script">E</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mn>10</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> for the priors, number of reticulations bounded by 2 when exploring the network space). Same framework as in <xref rid="pcbi.1008380.g010" ref-type="fig">Fig 10</xref> of the main paper, except that only polymorphic sites are taken into account. <bold>Fig I:</bold> Estimated inheritance probability and instantaneous rates for network A, as a function of the number of sites. True values are given by the dashed horizontal lines. Same framework as in <xref rid="pcbi.1008380.g011" ref-type="fig">Fig 11</xref> of the main paper, except that only polymorphic sites are taken into account. <bold>Fig J:</bold> Estimated node heights of network A, as a function of the number of sites. Heights are measured in units of expected number of mutations per site. True values are given by the dashed horizontal lines. Same framework as in <xref rid="pcbi.1008380.g012" ref-type="fig">Fig 12</xref> of the main paper, except that only polymorphic sites are taken into account. The initials MRCA stand for “Most Recent Common Ancestor”. <bold>Fig K:</bold> Estimated population sizes <italic toggle="yes">θ</italic> for each branch of network A, as a function of the number of sites. True values are given by the dashed horizontal lines. Same framework as in <xref rid="pcbi.1008380.g013" ref-type="fig">Fig 13</xref> of the main paper, except that only polymorphic sites are taken into account. The initials MRCA stand for “Most Recent Common Ancestor”. <bold>Fig L:</bold> Experiments on Network A and based only on polymorphic sites. Same framework as in Figures H and I in S1 Text, except that the correction factor is not used in the calculations (criterion ESS &gt; 200 in all cases). <bold>Fig M:</bold> Summary of rice molecular diversity used for selecting our sample of rice cultivated varieties and wild types. (A) unweighted neighbour joining (UWNJ) tree reflecting dissimilarities among 899 accessions based on 2.48 million SNPs as described in [<xref rid="pcbi.1008380.ref073" ref-type="bibr">73</xref>]; the accessions are colored according to their classification into wild population types or cultivar groups. (B, C) UWNJ tree using the same data for the 24 accessions we selected for assessing S<sc>napp</sc>N<sc>et</sc> performance, and showing their accessions number (B) and their country of origin (C); the colors are as in A. <bold>Fig N:</bold> Trace plots obtained according to the Tracer software when data set 1 was analyzed with S<sc>napp</sc>N<sc>et</sc>. (a) and (b) refer to the first sampling of 12 kSNPs along the whole genome, whereas (c) and (d) focus on the second sampling. Two chains were considered for each sampling. <bold>Fig O:</bold> Birth-hybridisation model with speciation rate 20 and hybridisation rate 1 (mean number of reticulations close to zero) and a normal prior with mean 0.1 and standard deviation of 0.01 on the origin height. We plot the simulated networks (orange) against the sampled networks (blue) summarising the networks under: (a) Number of reticulations (b) Time until first reticulation (c) Height of the network (d) Length of the network. <bold>Fig P:</bold> Birth-hybridisation model with speciation rate 20 and hybridisation rate 2 (mean number of reticulations close to one) and normal prior with mean 0.1 and standard deviation of 0.01 on the origin height. We plot the simulated networks (orange) against the sampled networks (blue) summarising the networks under: (a) Number of reticulations (b) Time until first reticulation (c) Height of the network (d) Length of the network. <bold>Fig Q:</bold> Birth-hybridisation model with speciation rate 20 and hybridisation rate 3 (mean number of reticulations close to two) and normal prior with mean 0.1 and standard deviation of 0.01 on the origin height. We plot the simulated networks (orange) against the sampled networks (blue) summarising the networks under: (a) Number of reticulations (b) Time until first reticulation (c) Height of the network (d) Length of the network. <bold>Fig R:</bold> Birth-hybridisation model with speciation rate 20 and hybridisation rate 1 (mean number of reticulations close to zero) and an exponential prior with mean 0.1 on the origin height. We plot the simulated networks (orange) against the sampled networks (blue) summarising the networks under: (a) Number of reticulations (b) Time until first reticulation (c) Height of the network (d) Length of the network. <bold>Fig S:</bold> Birth-hybridisation model with speciation rate 20 and hybridisation rate 2 (mean number of reticulations close to one) and an exponential prior with mean 0.1 on the origin height. We plot the simulated networks (orange) against the sampled networks (blue) summarising the networks under: (a) Number of reticulations (b) Time until first reticulation (c) Height of the network (d) Length of the network. <bold>Fig T:</bold> Birth-hybridisation model with speciation rate 20 and hybridisation rate 3 (mean number of reticulations close to two) and an exponential prior with mean 0.1 on the origin height. We plot the simulated networks (orange) against the sampled networks (blue) summarising the networks under: (a) Number of reticulations (b) Time until first reticulation (c) Height of the network (d) Length of the network. <bold>Fig U:</bold> Summary distributions of all chains with correct population size priors (chain numbers 1,2,9,10,17,18) given data simulated from network A. We summarize the MCMC chains by combining them, that is: Chains 1 and 2 are indicated by the blue line (mean reticulations close to zero); Chains 9 and 10 are indicated by the orange line (mean reticulations close to one); Chains 17 and 18 are indicated by the green line (mean reticulations close to two); We plot the following distributions (a) Likelihood (b) Prior (c) Network height (d) Network length. Note that network height and network length used to simulate data are indicated by red lines. <bold>Fig V:</bold> Summary distributions of all chains with incorrect population size priors Gamma(1,20) (chain numbers 3,4,11,12,19,20) given data simulated from network A. We summarize the MCMC chains by combining them, that is: Chains 3 and 4 are indicated by the blue line (mean reticulations close to zero); Chains 11 and 12 are indicated by the orange line (mean reticulations close to one); Chains 19 and 20 are indicated by the green line (mean reticulations close to two); We plot the following distributions (a) Likelihood (b) Prior (c) Network height (d) Network length. Note that network height and network length used to simulate data are indicated by red lines. <bold>Fig W:</bold> Summary distributions of all chains with correct population size priors (chain numbers 1,2,9,10,17,18 given data simulated under network B. We summarize the MCMC chains by combining them, that is: Chains 1 and 2 are indicated by the blue line (mean reticulations close to zero); Chains 9 and 10 are indicated by the orange line (mean reticulations close to one); Chains 17 and 18 are indicated by the green line (mean reticulations close to two); We plot the following distributions (a) Likelihood (b) Prior (c) Network height (d) Network length. Note that network height and network length used to simulate data are indicated by red lines. <bold>Fig X:</bold> Summary distributions of all chains with incorrect population size priors (chain numbers 3,4,7,8,11,12) given data simulated from network B. We summarize the MCMC chains by combining them, that is: Chains 3 and 4 are indicated by blue line (mean reticulations close to zero); Chains 7 and 8 are indicated by orange line (mean reticulations close to one); Chains 11 and 12 are indicated by green line (mean reticulations close to two); We plot the following distributions (a) Likelihood (b) Prior (c) Network height (d) Network length. Note that network height and network length used to simulate data are indicated by red lines. <bold>Fig Y:</bold> In this we figure we plot summary distributions of all chains with incorrect population size priors Gamma(1,20) (chain numbers 5,6,13,14,21,22) given data simulated from Network B. We summarize the MCMC chains by combining them, that is: Chains 5 and 6 are indicated by blue line (mean reticulations close to zero); Chains 13 and 14 are indicated by orange line (mean reticulations close to one); Chains 21 and 22 are indicated by green line (mean reticulations close to two); We plot the following distributions (a) Likelihood (b) Prior (c) Network height (d) Network length. Note that network height and network length used to simulate data are indicated by red lines. <bold>Fig Z:</bold> In this we figure we plot summary distributions of all chains with incorrect population size priors (chain numbers 7,8,15,16,23,24) given data simulated from network B. We summarize the MCMC chains by combining them, that is: Chain 7 and 8 are indicated by blue line (mean reticulations close to zero); Chain 15 and 16 is indicated by orange line (mean reticulations close to one); Chain 23 and 24 are indicated by green line (mean reticulations close to two); We plot the following distributions (a) Likelihood (b) Prior (c) Network height (d) Network length. Note that network height and network length used to simulate data are indicated by red lines. <bold>Table A:</bold> Table linked to <xref rid="pcbi.1008380.t001" ref-type="table">Table 1</xref> of the main manuscript. Trees inferred by S<sc>napp</sc>N<sc>et</sc> when m = 1,000 sites were considered. <bold>Table B:</bold> Average posterior probability (PP) of the topology of network C obtained by running <monospace>MCMC_BiMarkers</monospace> on data simulated from network C. Same as <xref rid="pcbi.1008380.t003" ref-type="table">Table 3</xref> of the main manuscript except that 12 × 10<sup>6</sup> iterations are considered, and only one lineage is sampled in hybrid species B and C. <inline-formula id="pcbi.1008380.e132"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1008380.e132.jpg" id="pcbi.1008380.e132g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M132" display="inline" overflow="scroll"><mml:mover><mml:mtext>ESS</mml:mtext><mml:mo>¯</mml:mo></mml:mover></mml:math></alternatives></inline-formula> is the average ESS over the different replicates, and SE stands for the sampler efficiency. <bold>Table C:</bold> Description of the 24 rice varieties considered in our study. These varieties are either representative cultivars spanning the four main rice subpopulations (Indica, Japonica, <italic toggle="yes">circum</italic> Aus and <italic toggle="yes">circum</italic> Basmati), or wild types (Or1I, Or1A, Or3). <bold>Table D:</bold> Data set 1, that includes only one variety per subpopulation. These varieties were chosen from Table C in S1 Text. <bold>Table E:</bold> Data sets 2 and 3, that include two varieties per subpopulation. These varieties were chosen from Table C in S1 Text. <bold>Table F:</bold> Informations obtained according to the Tracer software, when data set 1 was analyzed with S<sc>napp</sc>N<sc>et</sc>. Two different samplings of 12 kSNPs were considered, and also two chains for each sampling. <bold>Table G:</bold> BH(birth rate, hybridisation rate) refers to the birth-hybridisation process of Zhang et al. with the specified birth and hybridisation rates. For data simulated with network A, only chains 1,2,3,4,9,10,11,12,17,18,19,20 were run. We indicate the mean number of reticulation for the Birth-Hybridization model given an exponential prior with mean 0.1 on network origin. Note that we only used the exponential prior in the experiment in Section 8.2 of S1 Text. <bold>Table H:</bold> MCMC summary statistics for network A (correct population size priors). <bold>Table I:</bold> MCMC summary statistics for network A (incorrect priors). <bold>Table J:</bold> MCMC summary statistics for Network B (correct population size priors). <bold>Table K:</bold> MCMC summary statistics for Network B (incorrect population size priors Gamma(1,20)). <bold>Table L:</bold> MCMC summary statistics for Network B (incorrect population size priors Gamma(1,1000)). <bold>Table M:</bold> MCMC summary statistics for Network B (incorrect population size priors Gamma(1,2000)). <bold>Table N:</bold> MCMC acceptance rates for Network B (correct population size priors). <bold>Table O:</bold> MCMC acceptance rates for Network B (incorrect population size priors Γ(1, 1000)). <bold>Table P:</bold> MCMC acceptance rates for Network B (incorrect population size priors Γ(1, 2000)).</p>
        <p>(PDF)</p>
      </caption>
      <media xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1008380.s001.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <p>VB thanks University Montpellier for a 6-month sabbatical period.</p>
  </ack>
  <ref-list>
    <title>References</title>
    <ref id="pcbi.1008380.ref001">
      <label>1</label>
      <mixed-citation publication-type="journal"><name><surname>Denoeud</surname><given-names>F</given-names></name>, <name><surname>Carretero-Paulet</surname><given-names>L</given-names></name>, <name><surname>Dereeper</surname><given-names>A</given-names></name>, <name><surname>Droc</surname><given-names>G</given-names></name>, <name><surname>Guyot</surname><given-names>R</given-names></name>, <name><surname>Pietrella</surname><given-names>M</given-names></name>, <etal>et al</etal>. <article-title>The coffee genome provides insight into the convergent evolution of caffeine biosynthesis</article-title>. <source>Science</source>. <year>2014</year>;<volume>345</volume>(<issue>6201</issue>):<fpage>1181</fpage>–<lpage>1184</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1126/science.1255274</pub-id><?supplied-pmid 25190796?><pub-id pub-id-type="pmid">25190796</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008380.ref002">
      <label>2</label>
      <mixed-citation publication-type="journal"><name><surname>Badouin</surname><given-names>H</given-names></name>, <name><surname>Gouzy</surname><given-names>J</given-names></name>, <name><surname>Grassa</surname><given-names>CJ</given-names></name>, <name><surname>Murat</surname><given-names>F</given-names></name>, <name><surname>Staton</surname><given-names>SE</given-names></name>, <name><surname>Cottret</surname><given-names>L</given-names></name>, <etal>et al</etal>. <article-title>The sunflower genome provides insights into oil metabolism, flowering and Asterid evolution</article-title>. <source>Nature</source>. <year>2017</year>;<volume>546</volume>(<issue>7656</issue>):<fpage>148</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/nature22380</pub-id><?supplied-pmid 28538728?><pub-id pub-id-type="pmid">28538728</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008380.ref003">
      <label>3</label>
      <mixed-citation publication-type="journal"><name><surname>Garsmeur</surname><given-names>O</given-names></name>, <name><surname>Droc</surname><given-names>G</given-names></name>, <name><surname>Antonise</surname><given-names>R</given-names></name>, <name><surname>Grimwood</surname><given-names>J</given-names></name>, <name><surname>Potier</surname><given-names>B</given-names></name>, <name><surname>Aitken</surname><given-names>K</given-names></name>, <etal>et al</etal>. <article-title>A mosaic monoploid reference sequence for the highly complex genome of sugarcane</article-title>. <source>Nature Communications</source>. <year>2018</year>;<volume>9</volume>(<issue>1</issue>):<fpage>2638</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/s41467-018-05051-5</pub-id><?supplied-pmid 29980662?><pub-id pub-id-type="pmid">29980662</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008380.ref004">
      <label>4</label>
      <mixed-citation publication-type="journal"><name><surname>Cornillot</surname><given-names>E</given-names></name>, <name><surname>Hadj-Kaddour</surname><given-names>K</given-names></name>, <name><surname>Dassouli</surname><given-names>A</given-names></name>, <name><surname>Noel</surname><given-names>B</given-names></name>, <name><surname>Ranwez</surname><given-names>V</given-names></name>, <name><surname>Vacherie</surname><given-names>B</given-names></name>, <etal>et al</etal>. <article-title>Sequencing of the smallest Apicomplexan genome from the human pathogen Babesia microti</article-title>. <source>Nucleic Acids Research</source>. <year>2012</year>;<volume>40</volume>(<issue>18</issue>):<fpage>9102</fpage>–<lpage>9114</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/nar/gks700</pub-id><?supplied-pmid 22833609?><pub-id pub-id-type="pmid">22833609</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008380.ref005">
      <label>5</label>
      <mixed-citation publication-type="journal"><name><surname>Marra</surname><given-names>NJ</given-names></name>, <name><surname>Stanhope</surname><given-names>MJ</given-names></name>, <name><surname>Jue</surname><given-names>NK</given-names></name>, <name><surname>Wang</surname><given-names>M</given-names></name>, <name><surname>Sun</surname><given-names>Q</given-names></name>, <name><surname>Bitar</surname><given-names>PP</given-names></name>, <etal>et al</etal>. <article-title>White shark genome reveals ancient elasmobranch adaptations associated with wound healing and the maintenance of genome stability</article-title>. <source>Proceedings of the National Academy of Sciences</source>. <year>2019</year>;<volume>116</volume>(<issue>10</issue>):<fpage>4446</fpage>–<lpage>4455</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1073/pnas.1819778116</pub-id><?supplied-pmid 30782839?><pub-id pub-id-type="pmid">30782839</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008380.ref006">
      <label>6</label>
      <mixed-citation publication-type="journal"><name><surname>Consortium</surname><given-names>IH</given-names></name>, <etal>et al</etal>. <article-title>The international HapMap project</article-title>. <source>Nature</source>. <year>2003</year>;<volume>426</volume>(<issue>6968</issue>):<fpage>789</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/nature02168</pub-id><pub-id pub-id-type="pmid">14685227</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008380.ref007">
      <label>7</label>
      <mixed-citation publication-type="journal"><collab>3 RGP</collab>. <article-title>The 3,000 rice genomes project</article-title>. <source>GigaScience</source>. <year>2014</year>;<volume>3</volume>(<issue>1</issue>):<fpage>2047</fpage>–<lpage>217X</lpage>.</mixed-citation>
    </ref>
    <ref id="pcbi.1008380.ref008">
      <label>8</label>
      <mixed-citation publication-type="journal"><name><surname>Bamshad</surname><given-names>MJ</given-names></name>, <name><surname>Ng</surname><given-names>SB</given-names></name>, <name><surname>Bigham</surname><given-names>AW</given-names></name>, <name><surname>Tabor</surname><given-names>HK</given-names></name>, <name><surname>Emond</surname><given-names>MJ</given-names></name>, <name><surname>Nickerson</surname><given-names>DA</given-names></name>, <etal>et al</etal>. <article-title>Exome sequencing as a tool for Mendelian disease gene discovery</article-title>. <source>Nature Reviews Genetics</source>. <year>2011</year>;<volume>12</volume>(<issue>11</issue>):<fpage>745</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/nrg3031</pub-id><?supplied-pmid 21946919?><pub-id pub-id-type="pmid">21946919</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008380.ref009">
      <label>9</label>
      <mixed-citation publication-type="journal"><name><surname>Mansueto</surname><given-names>L</given-names></name>, <name><surname>Fuentes</surname><given-names>RR</given-names></name>, <name><surname>Chebotarov</surname><given-names>D</given-names></name>, <name><surname>Borja</surname><given-names>FN</given-names></name>, <name><surname>Detras</surname><given-names>J</given-names></name>, <name><surname>Abriol-Santos</surname><given-names>JM</given-names></name>, <etal>et al</etal>. <article-title>SNP-Seek II: A resource for allele mining and analysis of big genomic data in Oryza sativa</article-title>. <source>Current Plant Biology</source>. <year>2016</year>;<volume>7</volume>:<fpage>16</fpage>–<lpage>25</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1016/j.cpb.2016.12.003</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008380.ref010">
      <label>10</label>
      <mixed-citation publication-type="journal"><name><surname>Hernandez</surname><given-names>RD</given-names></name>, <name><surname>Kelley</surname><given-names>JL</given-names></name>, <name><surname>Elyashiv</surname><given-names>E</given-names></name>, <name><surname>Melton</surname><given-names>SC</given-names></name>, <name><surname>Auton</surname><given-names>A</given-names></name>, <name><surname>McVean</surname><given-names>G</given-names></name>, <etal>et al</etal>. <article-title>Classic selective sweeps were rare in recent human evolution</article-title>. <source>Science</source>. <year>2011</year>;<volume>331</volume>(<issue>6019</issue>):<fpage>920</fpage>–<lpage>924</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1126/science.1198878</pub-id><?supplied-pmid 21330547?><pub-id pub-id-type="pmid">21330547</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008380.ref011">
      <label>11</label>
      <mixed-citation publication-type="journal"><name><surname>Gravel</surname><given-names>S</given-names></name>, <name><surname>Henn</surname><given-names>BM</given-names></name>, <name><surname>Gutenkunst</surname><given-names>RN</given-names></name>, <name><surname>Indap</surname><given-names>AR</given-names></name>, <name><surname>Marth</surname><given-names>GT</given-names></name>, <name><surname>Clark</surname><given-names>AG</given-names></name>, <etal>et al</etal>. <article-title>Demographic history and rare allele sharing among human populations</article-title>. <source>Proceedings of the National Academy of Sciences</source>. <year>2011</year>;<volume>108</volume>(<issue>29</issue>):<fpage>11983</fpage>–<lpage>11988</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1073/pnas.1019276108</pub-id><?supplied-pmid 21730125?><pub-id pub-id-type="pmid">21730125</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008380.ref012">
      <label>12</label>
      <mixed-citation publication-type="journal"><name><surname>Civáň</surname><given-names>P</given-names></name>, <name><surname>Craig</surname><given-names>H</given-names></name>, <name><surname>Cox</surname><given-names>CJ</given-names></name>, <name><surname>Brown</surname><given-names>TA</given-names></name>. <article-title>Three geographically separate domestications of Asian rice</article-title>. <source>Nature Plants</source>. <year>2015</year>;<volume>1</volume>(<issue>11</issue>):<fpage>15164</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/nplants.2015.164</pub-id><pub-id pub-id-type="pmid">27251535</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008380.ref013">
      <label>13</label>
      <mixed-citation publication-type="journal"><name><surname>Rouard</surname><given-names>M</given-names></name>, <name><surname>Droc</surname><given-names>G</given-names></name>, <name><surname>Martin</surname><given-names>G</given-names></name>, <name><surname>Sardos</surname><given-names>J</given-names></name>, <name><surname>Hueber</surname><given-names>Y</given-names></name>, <name><surname>Guignon</surname><given-names>V</given-names></name>, <etal>et al</etal>. <article-title>Three new genome assemblies support a rapid radiation in Musa acuminata (wild banana)</article-title>. <source>Genome Biology and Evolution</source>. <year>2018</year>;<volume>10</volume>(<issue>12</issue>):<fpage>3129</fpage>–<lpage>3140</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/gbe/evy227</pub-id><?supplied-pmid 30321324?><pub-id pub-id-type="pmid">30321324</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008380.ref014">
      <label>14</label>
      <mixed-citation publication-type="book"><name><surname>Felenstein</surname><given-names>J</given-names></name>. <source>Inferring phylogenies</source>. <volume>vol. 2</volume>. <publisher-name>Sinauer associates</publisher-name><publisher-loc>Sunderland, MA</publisher-loc>; <year>2004</year>.</mixed-citation>
    </ref>
    <ref id="pcbi.1008380.ref015">
      <label>15</label>
      <mixed-citation publication-type="journal"><name><surname>Kingman</surname><given-names>JF</given-names></name>. <article-title>On the genealogy of large populations</article-title>. <source>Journal of Applied Probability</source>. <year>1982</year>;<volume>19</volume>(<issue>A</issue>):<fpage>27</fpage>–<lpage>43</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.2307/3213548</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008380.ref016">
      <label>16</label>
      <mixed-citation publication-type="journal"><name><surname>Rannala</surname><given-names>B</given-names></name>, <name><surname>Yang</surname><given-names>Z</given-names></name>. <article-title>Bayes estimation of species divergence times and ancestral population sizes using DNA sequences from multiple loci</article-title>. <source>Genetics</source>. <year>2003</year>;<volume>164</volume>(<issue>4</issue>):<fpage>1645</fpage>–<lpage>1656</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/genetics/164.4.1645</pub-id><pub-id pub-id-type="pmid">12930768</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008380.ref017">
      <label>17</label>
      <mixed-citation publication-type="book"><name><surname>Knowles</surname><given-names>LL</given-names></name>, <name><surname>Kubatko</surname><given-names>LS</given-names></name>. <source>Estimating species trees: practical and theoretical aspects</source>. <publisher-name>John Wiley and Sons</publisher-name>; <year>2011</year>.</mixed-citation>
    </ref>
    <ref id="pcbi.1008380.ref018">
      <label>18</label>
      <mixed-citation publication-type="journal"><name><surname>RoyChoudhury</surname><given-names>A</given-names></name>, <name><surname>Felsenstein</surname><given-names>J</given-names></name>, <name><surname>Thompson</surname><given-names>EA</given-names></name>. <article-title>A two-stage pruning algorithm for likelihood computation for a population tree</article-title>. <source>Genetics</source>. <year>2008</year>;<volume>180</volume>(<issue>2</issue>):<fpage>1095</fpage>–<lpage>1105</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1534/genetics.107.085753</pub-id><pub-id pub-id-type="pmid">18780754</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008380.ref019">
      <label>19</label>
      <mixed-citation publication-type="journal"><name><surname>Bryant</surname><given-names>D</given-names></name>, <name><surname>Bouckaert</surname><given-names>R</given-names></name>, <name><surname>Felsenstein</surname><given-names>J</given-names></name>, <name><surname>Rosenberg</surname><given-names>NA</given-names></name>, <name><surname>RoyChoudhury</surname><given-names>A</given-names></name>. <article-title>Inferring species trees directly from biallelic genetic markers: bypassing gene trees in a full coalescent analysis</article-title>. <source>Molecular Biology and Evolution</source>. <year>2012</year>;<volume>29</volume>(<issue>8</issue>):<fpage>1917</fpage>–<lpage>1932</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/molbev/mss086</pub-id><pub-id pub-id-type="pmid">22422763</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008380.ref020">
      <label>20</label>
      <mixed-citation publication-type="journal"><name><surname>Ebersberger</surname><given-names>I</given-names></name>, <name><surname>Galgoczy</surname><given-names>P</given-names></name>, <name><surname>Taudien</surname><given-names>S</given-names></name>, <name><surname>Taenzer</surname><given-names>S</given-names></name>, <name><surname>Platzer</surname><given-names>M</given-names></name>, <name><surname>Von Haeseler</surname><given-names>A</given-names></name>. <article-title>Mapping human genetic ancestry</article-title>. <source>Molecular Biology and Evolution</source>. <year>2007</year>;<volume>24</volume>(<issue>10</issue>):<fpage>2266</fpage>–<lpage>2276</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/molbev/msm156</pub-id><pub-id pub-id-type="pmid">17660505</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008380.ref021">
      <label>21</label>
      <mixed-citation publication-type="journal"><name><surname>Degnan</surname><given-names>JH</given-names></name>, <name><surname>Rosenberg</surname><given-names>NA</given-names></name>. <article-title>Gene tree discordance, phylogenetic inference and the multispecies coalescent</article-title>. <source>Trends in Ecology &amp; Evolution</source>. <year>2009</year>;<volume>24</volume>(<issue>6</issue>):<fpage>332</fpage>–<lpage>340</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1016/j.tree.2009.01.009</pub-id><pub-id pub-id-type="pmid">19307040</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008380.ref022">
      <label>22</label>
      <mixed-citation publication-type="journal"><name><surname>Maddison</surname><given-names>WP</given-names></name>. <article-title>Gene Trees in Species Trees</article-title>. <source>Systematic Biology</source>. <year>1997</year><day>9</day>;<volume>46</volume>(<issue>3</issue>):<fpage>523</fpage>–<lpage>536</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/sysbio/46.3.523</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008380.ref023">
      <label>23</label>
      <mixed-citation publication-type="journal"><name><surname>Mallet</surname><given-names>J</given-names></name>. <article-title>Hybrid speciation</article-title>. <source>Nature</source>. <year>2007</year>;<volume>446</volume>(<issue>7133</issue>):<fpage>279</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/nature05706</pub-id><pub-id pub-id-type="pmid">17361174</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008380.ref024">
      <label>24</label>
      <mixed-citation publication-type="journal"><name><surname>Morales</surname><given-names>L</given-names></name>, <name><surname>Dujon</surname><given-names>B</given-names></name>. <article-title>Evolutionary role of interspecies hybridization and genetic exchanges in yeasts</article-title>. <source>Microbiology and Molecular Biology Reviews</source>. <year>2012</year>;<volume>76</volume>(<issue>4</issue>):<fpage>721</fpage>–<lpage>739</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1128/MMBR.00022-12</pub-id><pub-id pub-id-type="pmid">23204364</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008380.ref025">
      <label>25</label>
      <mixed-citation publication-type="journal"><name><surname>Cui</surname><given-names>R</given-names></name>, <name><surname>Schumer</surname><given-names>M</given-names></name>, <name><surname>Kruesi</surname><given-names>K</given-names></name>, <name><surname>Walter</surname><given-names>R</given-names></name>, <name><surname>Andolfatto</surname><given-names>P</given-names></name>, <name><surname>Rosenthal</surname><given-names>GG</given-names></name>. <article-title>Phylogenomics reveals extensive reticulate evolution in Xiphophorus fishes</article-title>. <source>Evolution</source>. <year>2013</year>;<volume>67</volume>(<issue>8</issue>):<fpage>2166</fpage>–<lpage>2179</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1111/evo.12099</pub-id><pub-id pub-id-type="pmid">23888843</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008380.ref026">
      <label>26</label>
      <mixed-citation publication-type="journal"><name><surname>Glemin</surname><given-names>S</given-names></name>, <name><surname>Scornavacca</surname><given-names>C</given-names></name>, <name><surname>Dainat</surname><given-names>J</given-names></name>, <name><surname>Burgarella</surname><given-names>C</given-names></name>, <name><surname>Viader</surname><given-names>V</given-names></name>, <name><surname>Ardisson</surname><given-names>M</given-names></name>, <etal>et al</etal>. <article-title>Pervasive hybridizations in the history of wheat relatives</article-title>. <source>Science Advances</source>. <year>2019</year>;<volume>5</volume>(<issue>5</issue>):<fpage>eaav9188</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1126/sciadv.aav9188</pub-id><?supplied-pmid 31049399?><pub-id pub-id-type="pmid">31049399</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008380.ref027">
      <label>27</label>
      <mixed-citation publication-type="journal"><name><surname>Civáň</surname><given-names>P</given-names></name>, <name><surname>Brown</surname><given-names>TA</given-names></name>. <article-title>Role of genetic introgression during the evolution of cultivated rice (Oryza sativa L.)</article-title>. <source>BMC Evolutionary Biology</source>. <year>2018</year>;<volume>18</volume>(<issue>1</issue>):<fpage>57</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1186/s12862-018-1180-7</pub-id><pub-id pub-id-type="pmid">29688851</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008380.ref028">
      <label>28</label>
      <mixed-citation publication-type="journal"><name><surname>Minamikawa</surname><given-names>MF</given-names></name>, <name><surname>Nonaka</surname><given-names>K</given-names></name>, <name><surname>Kaminuma</surname><given-names>E</given-names></name>, <name><surname>Kajiya-Kanegae</surname><given-names>H</given-names></name>, <name><surname>Onogi</surname><given-names>A</given-names></name>, <name><surname>Goto</surname><given-names>S</given-names></name>, <etal>et al</etal>. <article-title>Genome-wide association study and genomic prediction in citrus: potential of genomics-assisted breeding for fruit quality traits</article-title>. <source>Scientific Reports</source>. <year>2017</year>;<volume>7</volume>(<issue>1</issue>):<fpage>4721</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/s41598-017-05100-x</pub-id><?supplied-pmid 28680114?><pub-id pub-id-type="pmid">28680114</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008380.ref029">
      <label>29</label>
      <mixed-citation publication-type="journal"><name><surname>Duranton</surname><given-names>M</given-names></name>, <name><surname>Allal</surname><given-names>F</given-names></name>, <name><surname>Fraïsse</surname><given-names>C</given-names></name>, <name><surname>Bierne</surname><given-names>N</given-names></name>, <name><surname>Bonhomme</surname><given-names>F</given-names></name>, <name><surname>Gagnaire</surname><given-names>PA</given-names></name>. <article-title>The origin and remolding of genomic islands of differentiation in the European sea bass</article-title>. <source>Nature Communications</source>. <year>2018</year>;<volume>9</volume>(<issue>1</issue>):<fpage>2518</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/s41467-018-05359-2</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008380.ref030">
      <label>30</label>
      <mixed-citation publication-type="journal"><name><surname>Koonin</surname><given-names>EV</given-names></name>, <name><surname>Makarova</surname><given-names>KS</given-names></name>, <name><surname>Aravind</surname><given-names>L</given-names></name>. <article-title>Horizontal gene transfer in prokaryotes: quantification and classification</article-title>. <source>Annual Reviews in Microbiology</source>. <year>2001</year>;<volume>55</volume>(<issue>1</issue>):<fpage>709</fpage>–<lpage>742</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1146/annurev.micro.55.1.709</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008380.ref031">
      <label>31</label>
      <mixed-citation publication-type="journal"><name><surname>Szöllősi</surname><given-names>GJ</given-names></name>, <name><surname>Davín</surname><given-names>AA</given-names></name>, <name><surname>Tannier</surname><given-names>E</given-names></name>, <name><surname>Daubin</surname><given-names>V</given-names></name>, <name><surname>Boussau</surname><given-names>B</given-names></name>. <article-title>Genome-scale phylogenetic analysis finds extensive gene transfer among fungi</article-title>. <source>Phil Trans R Soc B</source>. <year>2015</year>;<volume>370</volume>(<issue>1678</issue>):<fpage>20140335</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1098/rstb.2014.0335</pub-id><pub-id pub-id-type="pmid">26323765</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008380.ref032">
      <label>32</label>
      <mixed-citation publication-type="book"><name><surname>Huson</surname><given-names>DH</given-names></name>, <name><surname>Rupp</surname><given-names>R</given-names></name>, <name><surname>Scornavacca</surname><given-names>C</given-names></name>. <source>Phylogenetic networks: concepts, algorithms and applications</source>. <publisher-name>Cambridge University Press</publisher-name>; <year>2010</year>.</mixed-citation>
    </ref>
    <ref id="pcbi.1008380.ref033">
      <label>33</label>
      <mixed-citation publication-type="book"><name><surname>Nakhleh</surname><given-names>L</given-names></name>. <part-title>Evolutionary phylogenetic networks: models and issues</part-title>. In: <source>Problem solving handbook in computational biology and bioinformatics</source>. <publisher-name>Springer</publisher-name>; <year>2010</year>. p. <fpage>125</fpage>–<lpage>158</lpage>.</mixed-citation>
    </ref>
    <ref id="pcbi.1008380.ref034">
      <label>34</label>
      <mixed-citation publication-type="book"><name><surname>Morrison</surname><given-names>DA</given-names></name>. <source>Introduction to Phylogenetic Networks</source>. <publisher-name>RJR Productions</publisher-name>; <year>2011</year>.</mixed-citation>
    </ref>
    <ref id="pcbi.1008380.ref035">
      <label>35</label>
      <mixed-citation publication-type="journal"><name><surname>Baroni</surname><given-names>M</given-names></name>, <name><surname>Semple</surname><given-names>C</given-names></name>, <name><surname>Steel</surname><given-names>M</given-names></name>. <article-title>A framework for representing reticulate evolution</article-title>. <source>Annals of Combinatorics</source>. <year>2005</year>;<volume>8</volume>(<issue>4</issue>):<fpage>391</fpage>–<lpage>408</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1007/s00026-004-0228-0</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008380.ref036">
      <label>36</label>
      <mixed-citation publication-type="journal"><name><surname>Hudson</surname><given-names>RR</given-names></name>. <article-title>Properties of a neutral allele model with intragenic recombination</article-title>. <source>Theoretical Population Biology</source>. <year>1983</year>;<volume>23</volume>(<issue>2</issue>):<fpage>183</fpage>–<lpage>201</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1016/0040-5809(83)90013-8</pub-id><pub-id pub-id-type="pmid">6612631</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008380.ref037">
      <label>37</label>
      <mixed-citation publication-type="journal"><name><surname>Huson</surname><given-names>DH</given-names></name>, <name><surname>Scornavacca</surname><given-names>C</given-names></name>. <article-title>A survey of combinatorial methods for phylogenetic networks</article-title>. <source>Genome Biology and Evolution</source>. <year>2011</year>;<volume>3</volume>:<fpage>23</fpage>–<lpage>35</lpage>.<pub-id pub-id-type="pmid">21081312</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008380.ref038">
      <label>38</label>
      <mixed-citation publication-type="journal"><name><surname>Degnan</surname><given-names>JH</given-names></name>. <article-title>Modeling hybridization under the network multispecies coalescent</article-title>. <source>Systematic Biology</source>. <year>2018</year>;<volume>67</volume>(<issue>5</issue>):<fpage>786</fpage>–<lpage>799</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/sysbio/syy040</pub-id><pub-id pub-id-type="pmid">29846734</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008380.ref039">
      <label>39</label>
      <mixed-citation publication-type="journal"><name><surname>Fontaine</surname><given-names>MC</given-names></name>, <name><surname>Pease</surname><given-names>JB</given-names></name>, <name><surname>Steele</surname><given-names>A</given-names></name>, <name><surname>Waterhouse</surname><given-names>RM</given-names></name>, <name><surname>Neafsey</surname><given-names>DE</given-names></name>, <name><surname>Sharakhov</surname><given-names>IV</given-names></name>, <etal>et al</etal>. <article-title>Extensive introgression in a malaria vector species complex revealed by phylogenomics</article-title>. <source>Science</source>. <year>2015</year>;<volume>347</volume>(<issue>6217</issue>):<fpage>1258524</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1126/science.1258524</pub-id><?supplied-pmid 25431491?><pub-id pub-id-type="pmid">25431491</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008380.ref040">
      <label>40</label>
      <mixed-citation publication-type="journal"><name><surname>Marcussen</surname><given-names>T</given-names></name>, <name><surname>Sandve</surname><given-names>SR</given-names></name>, <name><surname>Heier</surname><given-names>L</given-names></name>, <name><surname>Spannagl</surname><given-names>M</given-names></name>, <name><surname>Pfeifer</surname><given-names>M</given-names></name>, <name><surname>Jakobsen</surname><given-names>KS</given-names></name>, <etal>et al</etal>. <article-title>Ancient hybridizations among the ancestral genomes of bread wheat</article-title>. <source>Science</source>. <year>2014</year>;<volume>345</volume>(<issue>6194</issue>):<fpage>1250092</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1126/science.1250092</pub-id><?supplied-pmid 25035499?><pub-id pub-id-type="pmid">25035499</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008380.ref041">
      <label>41</label>
      <mixed-citation publication-type="journal"><name><surname>Zhu</surname><given-names>S</given-names></name>, <name><surname>Degnan</surname><given-names>JH</given-names></name>. <article-title>Displayed trees do not determine distinguishability under the network multispecies coalescent</article-title>. <source>Systematic Biology</source>. <year>2017</year>;<volume>66</volume>(<issue>2</issue>):<fpage>283</fpage>–<lpage>298</lpage>.<pub-id pub-id-type="pmid">27780899</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008380.ref042">
      <label>42</label>
      <mixed-citation publication-type="journal"><name><surname>Huson</surname><given-names>DH</given-names></name>, <name><surname>Scornavacca</surname><given-names>C</given-names></name>. <article-title>A Survey of Combinatorial Methods for Phylogenetic Networks</article-title>. <source>Genome Biology and Evolution</source>. <year>2010</year><day>11</day>;<volume>3</volume>:<fpage>23</fpage>–<lpage>35</lpage>. Available from: <pub-id pub-id-type="doi">10.1093/gbe/evq077</pub-id><?supplied-pmid 21081312?><pub-id pub-id-type="pmid">21081312</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008380.ref043">
      <label>43</label>
      <mixed-citation publication-type="journal"><name><surname>Kubatko</surname><given-names>LS</given-names></name>. <article-title>Identifying hybridization events in the presence of coalescence via model selection</article-title>. <source>Systematic Biology</source>. <year>2009</year>;<volume>58</volume>(<issue>5</issue>):<fpage>478</fpage>–<lpage>488</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/sysbio/syp055</pub-id><pub-id pub-id-type="pmid">20525602</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008380.ref044">
      <label>44</label>
      <mixed-citation publication-type="journal"><name><surname>Meng</surname><given-names>C</given-names></name>, <name><surname>Kubatko</surname><given-names>LS</given-names></name>. <article-title>Detecting hybrid speciation in the presence of incomplete lineage sorting using gene tree incongruence: a model</article-title>. <source>Theoretical Population Biology</source>. <year>2009</year>;<volume>75</volume>(<issue>1</issue>):<fpage>35</fpage>–<lpage>45</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1016/j.tpb.2008.10.004</pub-id><pub-id pub-id-type="pmid">19038278</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008380.ref045">
      <label>45</label>
      <mixed-citation publication-type="journal"><name><surname>Yu</surname><given-names>Y</given-names></name>, <name><surname>Than</surname><given-names>C</given-names></name>, <name><surname>Degnan</surname><given-names>JH</given-names></name>, <name><surname>Nakhleh</surname><given-names>L</given-names></name>. <article-title>Coalescent histories on phylogenetic networks and detection of hybridization despite incomplete lineage sorting</article-title>. <source>Systematic Biology</source>. <year>2011</year>;<volume>60</volume>(<issue>2</issue>):<fpage>138</fpage>–<lpage>149</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/sysbio/syq084</pub-id><pub-id pub-id-type="pmid">21248369</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008380.ref046">
      <label>46</label>
      <mixed-citation publication-type="journal"><name><surname>Yu</surname><given-names>Y</given-names></name>, <name><surname>Degnan</surname><given-names>JH</given-names></name>, <name><surname>Nakhleh</surname><given-names>L</given-names></name>. <article-title>The probability of a gene tree topology within a phylogenetic network with applications to hybridization detection</article-title>. <source>PLoS Genetics</source>. <year>2012</year>;<volume>8</volume>(<issue>4</issue>):<fpage>e1002660</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1371/journal.pgen.1002660</pub-id><pub-id pub-id-type="pmid">22536161</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008380.ref047">
      <label>47</label>
      <mixed-citation publication-type="journal"><name><surname>Yu</surname><given-names>Y</given-names></name>, <name><surname>Ristic</surname><given-names>N</given-names></name>, <name><surname>Nakhleh</surname><given-names>L</given-names></name>; <collab>BioMed Central</collab>. <article-title>Fast algorithms and heuristics for phylogenomics under ILS and hybridization</article-title>. <source>BMC bioinformatics</source>. <year>2013</year>;<volume>14</volume>(<issue>15</issue>):<fpage>S6</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1186/1471-2105-14-S15-S6</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008380.ref048">
      <label>48</label>
      <mixed-citation publication-type="journal"><name><surname>Yu</surname><given-names>Y</given-names></name>, <name><surname>Dong</surname><given-names>J</given-names></name>, <name><surname>Liu</surname><given-names>KJ</given-names></name>, <name><surname>Nakhleh</surname><given-names>L</given-names></name>. <article-title>Maximum likelihood inference of reticulate evolutionary histories</article-title>. <source>Proceedings of the National Academy of Sciences</source>. <year>2014</year>;<volume>111</volume>(<issue>46</issue>):<fpage>16448</fpage>–<lpage>16453</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1073/pnas.1407950111</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008380.ref049">
      <label>49</label>
      <mixed-citation publication-type="journal"><name><surname>Yu</surname><given-names>Y</given-names></name>, <name><surname>Nakhleh</surname><given-names>L</given-names></name>. <article-title>A maximum pseudo-likelihood approach for phylogenetic networks</article-title>. <source>BMC Genomics</source>. <year>2015</year>;<volume>16</volume>(<issue>10</issue>):<fpage>S10</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1186/1471-2164-16-S10-S10</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008380.ref050">
      <label>50</label>
      <mixed-citation publication-type="journal"><name><surname>Solís-Lemus</surname><given-names>C</given-names></name>, <name><surname>Ané</surname><given-names>C</given-names></name>. <article-title>Inferring phylogenetic networks with maximum pseudolikelihood under incomplete lineage sorting</article-title>. <source>PLoS Genetics</source>. <year>2016</year>;<volume>12</volume>(<issue>3</issue>):<fpage>e1005896</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1371/journal.pgen.1005896</pub-id><pub-id pub-id-type="pmid">26950302</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008380.ref051">
      <label>51</label>
      <mixed-citation publication-type="journal"><name><surname>Wen</surname><given-names>D</given-names></name>, <name><surname>Yu</surname><given-names>Y</given-names></name>, <name><surname>Nakhleh</surname><given-names>L</given-names></name>. <article-title>Bayesian inference of reticulate phylogenies under the multispecies network coalescent</article-title>. <source>PLoS Genetics</source>. <year>2016</year>;<volume>12</volume>(<issue>5</issue>):<fpage>e1006006</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1371/journal.pgen.1006006</pub-id><pub-id pub-id-type="pmid">27144273</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008380.ref052">
      <label>52</label>
      <mixed-citation publication-type="journal"><name><surname>Wen</surname><given-names>D</given-names></name>, <name><surname>Nakhleh</surname><given-names>L</given-names></name>. <article-title>Coestimating reticulate phylogenies and gene trees from multilocus sequence data</article-title>. <source>Systematic Biology</source>. <year>2018</year>;<volume>67</volume>(<issue>3</issue>):<fpage>439</fpage>–<lpage>457</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/sysbio/syx085</pub-id><pub-id pub-id-type="pmid">29088409</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008380.ref053">
      <label>53</label>
      <mixed-citation publication-type="journal"><name><surname>Zhang</surname><given-names>C</given-names></name>, <name><surname>Ogilvie</surname><given-names>HA</given-names></name>, <name><surname>Drummond</surname><given-names>AJ</given-names></name>, <name><surname>Stadler</surname><given-names>T</given-names></name>. <article-title>Bayesian inference of species networks from multilocus sequence data</article-title>. <source>Molecular Biology and Evolution</source>. <year>2017</year>;<volume>35</volume>(<issue>2</issue>):<fpage>504</fpage>–<lpage>517</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/molbev/msx307</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008380.ref054">
      <label>54</label>
      <mixed-citation publication-type="journal"><name><surname>Zhu</surname><given-names>J</given-names></name>, <name><surname>Wen</surname><given-names>D</given-names></name>, <name><surname>Yu</surname><given-names>Y</given-names></name>, <name><surname>Meudt</surname><given-names>HM</given-names></name>, <name><surname>Nakhleh</surname><given-names>L</given-names></name>. <article-title>Bayesian inference of phylogenetic networks from bi-allelic genetic markers</article-title>. <source>PLoS Computational Biology</source>. <year>2018</year>;<volume>14</volume>(<issue>1</issue>):<fpage>e1005932</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1371/journal.pcbi.1005932</pub-id><pub-id pub-id-type="pmid">29320496</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008380.ref055">
      <label>55</label>
      <mixed-citation publication-type="book"><name><surname>Elworth</surname><given-names>RL</given-names></name>, <name><surname>Ogilvie</surname><given-names>HA</given-names></name>, <name><surname>Zhu</surname><given-names>J</given-names></name>, <name><surname>Nakhleh</surname><given-names>L</given-names></name>. <part-title>Advances in computational methods for phylogenetic networks in the presence of hybridization</part-title>. In: <source>Bioinformatics and Phylogenetics</source>. <publisher-name>Springer</publisher-name>; <year>2019</year>. p. <fpage>317</fpage>–<lpage>360</lpage>.</mixed-citation>
    </ref>
    <ref id="pcbi.1008380.ref056">
      <label>56</label>
      <mixed-citation publication-type="journal"><name><surname>Bayzid</surname><given-names>MS</given-names></name>, <name><surname>Warnow</surname><given-names>T</given-names></name>. <article-title>Naive binning improves phylogenomic analyses</article-title>. <source>Bioinformatics</source>. <year>2013</year>;<volume>29</volume>(<issue>18</issue>):<fpage>2277</fpage>–<lpage>2284</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/bioinformatics/btt394</pub-id><pub-id pub-id-type="pmid">23842808</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008380.ref057">
      <label>57</label>
      <mixed-citation publication-type="journal"><name><surname>Bouckaert</surname><given-names>R</given-names></name>, <name><surname>Heled</surname><given-names>J</given-names></name>, <name><surname>Kühnert</surname><given-names>D</given-names></name>, <name><surname>Vaughan</surname><given-names>T</given-names></name>, <name><surname>Wu</surname><given-names>C</given-names></name>, <name><surname>Xie</surname><given-names>D</given-names></name>, <etal>et al</etal>. <article-title>BEAST 2: a software platform for Bayesian evolutionary analysis</article-title>. <source>PLoS Computational Biology</source>. <year>2014</year>;<volume>10</volume>(<issue>4</issue>):<fpage>e1003537</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1371/journal.pcbi.1003537</pub-id><?supplied-pmid 24722319?><pub-id pub-id-type="pmid">24722319</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008380.ref058">
      <label>58</label>
      <mixed-citation publication-type="journal"><name><surname>Bouckaert</surname><given-names>R</given-names></name>, <name><surname>Vaughan</surname><given-names>TG</given-names></name>, <name><surname>Barido-Sottani</surname><given-names>J</given-names></name>, <name><surname>Duchêne</surname><given-names>S</given-names></name>, <name><surname>Fourment</surname><given-names>M</given-names></name>, <name><surname>Gavryushkina</surname><given-names>A</given-names></name>, <etal>et al</etal>. <article-title>BEAST 2.5: An advanced software platform for Bayesian evolutionary analysis</article-title>. <source>PLoS Computational Biology</source>. <year>2019</year>;<volume>15</volume>(<issue>4</issue>):<fpage>e1006650</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1371/journal.pcbi.1006650</pub-id><?supplied-pmid 30958812?><pub-id pub-id-type="pmid">30958812</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008380.ref059">
      <label>59</label>
      <mixed-citation publication-type="journal"><name><surname>Zhu</surname><given-names>J</given-names></name>, <name><surname>Nakhleh</surname><given-names>L</given-names></name>. <article-title>Inference of species phylogenies from bi-allelic markers using pseudo-likelihood</article-title>. <source>Bioinformatics</source>. <year>2018</year>;<volume>34</volume>(<issue>13</issue>):<fpage>i376</fpage>–<lpage>i385</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/bioinformatics/bty295</pub-id><pub-id pub-id-type="pmid">29950004</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008380.ref060">
      <label>60</label>
      <mixed-citation publication-type="journal"><name><surname>Pardi</surname><given-names>F</given-names></name>, <name><surname>Scornavacca</surname><given-names>C</given-names></name>. <article-title>Reconstructible phylogenetic networks: do not distinguish the indistinguishable</article-title>. <source>PLoS Computational Biology</source>. <year>2015</year>;<volume>11</volume>(<issue>4</issue>):<fpage>e1004135</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1371/journal.pcbi.1004135</pub-id><pub-id pub-id-type="pmid">25849429</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008380.ref061">
      <label>61</label>
      <mixed-citation publication-type="journal"><name><surname>Cao</surname><given-names>Z</given-names></name>, <name><surname>Liu</surname><given-names>X</given-names></name>, <name><surname>Ogilvie</surname><given-names>HA</given-names></name>, <name><surname>Yan</surname><given-names>Z</given-names></name>, <name><surname>Nakhleh</surname><given-names>L</given-names></name>. <article-title>Practical aspects of phylogenetic network analysis using PhyloNet</article-title>. <source>bioRxiv</source>. <year>2019</year>;p. <fpage>746362</fpage>.</mixed-citation>
    </ref>
    <ref id="pcbi.1008380.ref062">
      <label>62</label>
      <mixed-citation publication-type="journal"><name><surname>Haldane</surname><given-names>J</given-names></name>. <article-title>The combination of linkage values and the calculation of distances between the loci of linked factors</article-title>. <source>Journal of Genetics</source>. <year>1919</year>;<volume>8</volume>(<issue>29</issue>):<fpage>299</fpage>–<lpage>309</lpage>.</mixed-citation>
    </ref>
    <ref id="pcbi.1008380.ref063">
      <label>63</label>
      <mixed-citation publication-type="journal"><name><surname>Cavender</surname><given-names>JA</given-names></name>. <article-title>Taxonomy with confidence</article-title>. <source>Mathematical Biosciences</source>. <year>1978</year>;<volume>40</volume>(<issue>3-4</issue>):<fpage>271</fpage>–<lpage>280</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1016/0025-5564(78)90089-5</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008380.ref064">
      <label>64</label>
      <mixed-citation publication-type="book"><name><surname>Cormen</surname><given-names>TH</given-names></name>, <name><surname>Leiserson</surname><given-names>CE</given-names></name>, <name><surname>Rivest</surname><given-names>RL</given-names></name>, <name><surname>Stein</surname><given-names>C</given-names></name>. <source>Introduction to Algorithms, Third Edition</source>. <edition designator="3">3rd ed</edition>. <publisher-name>The MIT Press</publisher-name>; <year>2009</year>.</mixed-citation>
    </ref>
    <ref id="pcbi.1008380.ref065">
      <label>65</label>
      <mixed-citation publication-type="other">Gambette P, Berry V, Paul C. The structure of level-k phylogenetic networks. In: Annual Symposium on Combinatorial Pattern Matching. Springer; 2009. p. 289–300.</mixed-citation>
    </ref>
    <ref id="pcbi.1008380.ref066">
      <label>66</label>
      <mixed-citation publication-type="other">Berry V, Scornavacca C, Weller M. Scanning Phylogenetic Networks is NP-hard. International Conference on Current Trends in Theory and Practice of Informatics. Springer; 2020. p. 519–530.</mixed-citation>
    </ref>
    <ref id="pcbi.1008380.ref067">
      <label>67</label>
      <mixed-citation publication-type="journal"><name><surname>Cardona</surname><given-names>G</given-names></name>, <name><surname>Rosselló</surname><given-names>F</given-names></name>, <name><surname>Valiente</surname><given-names>G</given-names></name>. <article-title>Extended Newick: it is time for a standard representation of phylogenetic networks</article-title>. <source>BMC Bioinformatics</source>. <year>2008</year>;<volume>9</volume>(<issue>1</issue>):<fpage>532</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1186/1471-2105-9-532</pub-id><pub-id pub-id-type="pmid">19077301</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008380.ref068">
      <label>68</label>
      <mixed-citation publication-type="book"><name><surname>Liu</surname><given-names>JS</given-names></name>. <source>Monte Carlo strategies in scientific computing</source>. <publisher-name>Springer Science &amp; Business Media</publisher-name>; <year>2008</year>.</mixed-citation>
    </ref>
    <ref id="pcbi.1008380.ref069">
      <label>69</label>
      <mixed-citation publication-type="journal"><name><surname>Rambaut</surname><given-names>A</given-names></name>, <name><surname>Drummond</surname><given-names>AJ</given-names></name>, <name><surname>Xie</surname><given-names>D</given-names></name>, <name><surname>Baele</surname><given-names>G</given-names></name>, <name><surname>Suchard</surname><given-names>MA</given-names></name>. <article-title>Posterior summarization in Bayesian phylogenetics using Tracer 1.7</article-title>. <source>Systematic Biology</source>. <year>2018</year>;<volume>67</volume>(<issue>5</issue>):<fpage>901</fpage>–<lpage>904</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/sysbio/syy032</pub-id><pub-id pub-id-type="pmid">29718447</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008380.ref070">
      <label>70</label>
      <mixed-citation publication-type="journal"><name><surname>Lanfear</surname><given-names>R</given-names></name>, <name><surname>Hua</surname><given-names>X</given-names></name>, <name><surname>Warren</surname><given-names>DL</given-names></name>. <article-title>Estimating the effective sample size of tree topologies from Bayesian phylogenetic analyses</article-title>. <source>Genome Biology and Evolution</source>. <year>2016</year>;<volume>8</volume>(<issue>8</issue>):<fpage>2319</fpage>–<lpage>2332</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/gbe/evw171</pub-id><pub-id pub-id-type="pmid">27435794</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008380.ref071">
      <label>71</label>
      <mixed-citation publication-type="journal"><name><surname>Nakhleh</surname><given-names>L</given-names></name>. <article-title>A metric on the space of reduced phylogenetic networks</article-title>. <source>IEEE/ACM Transactions on Computational Biology and Bioinformatics</source>. <year>2009</year>;<volume>7</volume>(<issue>2</issue>):<fpage>218</fpage>–<lpage>222</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1109/TCBB.2009.2</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008380.ref072">
      <label>72</label>
      <mixed-citation publication-type="journal"><name><surname>Huang</surname><given-names>X</given-names></name>, <name><surname>Kurata</surname><given-names>N</given-names></name>, <name><surname>Wang</surname><given-names>ZX</given-names></name>, <name><surname>Wang</surname><given-names>A</given-names></name>, <name><surname>Zhao</surname><given-names>Q</given-names></name>, <name><surname>Zhao</surname><given-names>Y</given-names></name>, <etal>et al</etal>. <article-title>A map of rice genome variation reveals the origin of cultivated rice</article-title>. <source>Nature</source>. <year>2012</year>;<volume>490</volume>(<issue>7421</issue>):<fpage>497</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/nature11532</pub-id><?supplied-pmid 23034647?><pub-id pub-id-type="pmid">23034647</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008380.ref073">
      <label>73</label>
      <mixed-citation publication-type="journal"><name><surname>Wang</surname><given-names>W</given-names></name>, <name><surname>Mauleon</surname><given-names>R</given-names></name>, <name><surname>Hu</surname><given-names>Z</given-names></name>, <name><surname>Chebotarov</surname><given-names>D</given-names></name>, <name><surname>Tai</surname><given-names>S</given-names></name>, <name><surname>Wu</surname><given-names>Z</given-names></name>, <etal>et al</etal>. <article-title>Genomic variation in 3,010 diverse accessions of Asian cultivated rice</article-title>. <source>Nature</source>. <year>2018</year>;<volume>557</volume>(<issue>7703</issue>):<fpage>43</fpage>–<lpage>49</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/s41586-018-0063-9</pub-id><?supplied-pmid 29695866?><pub-id pub-id-type="pmid">29695866</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008380.ref074">
      <label>74</label>
      <mixed-citation publication-type="journal"><name><surname>Glaszmann</surname><given-names>JC</given-names></name>. <article-title>Isozymes and classification of Asian rice varieties</article-title>. <source>Theoretical and Applied genetics</source>. <year>1987</year>;<volume>74</volume>(<issue>1</issue>):<fpage>21</fpage>–<lpage>30</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1007/BF00290078</pub-id><pub-id pub-id-type="pmid">24241451</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008380.ref075">
      <label>75</label>
      <mixed-citation publication-type="journal"><name><surname>Civáň</surname><given-names>P</given-names></name>, <name><surname>Ali</surname><given-names>S</given-names></name>, <name><surname>Batista-Navarro</surname><given-names>R</given-names></name>, <name><surname>Drosou</surname><given-names>K</given-names></name>, <name><surname>Ihejieto</surname><given-names>C</given-names></name>, <name><surname>Chakraborty</surname><given-names>D</given-names></name>, <etal>et al</etal>. <article-title>Origin of the aromatic group of cultivated rice (Oryza sativa L.) traced to the Indian subcontinent</article-title>. <source>Genome Biology and Evolution</source>. <year>2019</year>;<volume>11</volume>(<issue>3</issue>):<fpage>832</fpage>–<lpage>843</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/gbe/evz039</pub-id><?supplied-pmid 30793171?><pub-id pub-id-type="pmid">30793171</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008380.ref076">
      <label>76</label>
      <mixed-citation publication-type="journal"><name><surname>Santos</surname><given-names>JD</given-names></name>, <name><surname>Chebotarov</surname><given-names>D</given-names></name>, <name><surname>McNally</surname><given-names>KL</given-names></name>, <name><surname>Bartholomé</surname><given-names>J</given-names></name>, <name><surname>Droc</surname><given-names>G</given-names></name>, <name><surname>Billot</surname><given-names>C</given-names></name>, <etal>et al</etal>. <article-title>Fine scale genomic signals of admixture and alien introgression among Asian rice landraces</article-title>. <source>Genome Biology and Evolution</source>. <year>2019</year>;<volume>11</volume>(<issue>5</issue>):<fpage>1358</fpage>–<lpage>1373</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/gbe/evz084</pub-id><?supplied-pmid 31002105?><pub-id pub-id-type="pmid">31002105</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008380.ref077">
      <label>77</label>
      <mixed-citation publication-type="journal"><name><surname>Civáň</surname><given-names>P</given-names></name>, <name><surname>Brown</surname><given-names>TA</given-names></name>. <article-title>Misconceptions regarding the role of introgression in the origin of Oryza sativa subsp. indica</article-title>. <source>Frontiers in Plant Science</source>. <year>2018</year>;<volume>9</volume>:<fpage>1750</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.3389/fpls.2018.01750</pub-id><pub-id pub-id-type="pmid">30555497</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008380.ref078">
      <label>78</label>
      <mixed-citation publication-type="journal"><name><surname>Myint</surname><given-names>KM</given-names></name>, <name><surname>Courtois</surname><given-names>B</given-names></name>, <name><surname>Risterucci</surname><given-names>AM</given-names></name>, <name><surname>Frouin</surname><given-names>J</given-names></name>, <name><surname>Soe</surname><given-names>K</given-names></name>, <name><surname>Thet</surname><given-names>KM</given-names></name>, <etal>et al</etal>. <article-title>Specific patterns of genetic diversity among aromatic rice varieties in Myanmar</article-title>. <source>Rice</source>. <year>2012</year>;<volume>5</volume>(<issue>1</issue>):<fpage>1</fpage>–<lpage>13</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1186/1939-8433-5-20</pub-id><?supplied-pmid 27234242?><pub-id pub-id-type="pmid">24764501</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008380.ref079">
      <label>79</label>
      <mixed-citation publication-type="journal"><name><surname>Choi</surname><given-names>JY</given-names></name>, <name><surname>Lye</surname><given-names>ZN</given-names></name>, <name><surname>Groen</surname><given-names>SC</given-names></name>, <name><surname>Dai</surname><given-names>X</given-names></name>, <name><surname>Rughani</surname><given-names>P</given-names></name>, <name><surname>Zaaijer</surname><given-names>S</given-names></name>, <etal>et al</etal>. <article-title>Nanopore sequencing-based genome assembly and evolutionary genomics of circum-basmati rice</article-title>. <source>Genome Biology</source>. <year>2020</year>;<volume>21</volume>(<issue>1</issue>):<fpage>21</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1186/s13059-020-1938-2</pub-id><?supplied-pmid 32019604?><pub-id pub-id-type="pmid">32019604</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008380.ref080">
      <label>80</label>
      <mixed-citation publication-type="book"><name><surname>Akaike</surname><given-names>H</given-names></name>. <part-title>Information theory and an extension of the maximum likelihood principle</part-title>. In: <source>Selected papers of hirotugu akaike</source>. <publisher-name>Springer</publisher-name>; <year>1998</year>. p. <fpage>199</fpage>–<lpage>213</lpage>.</mixed-citation>
    </ref>
    <ref id="pcbi.1008380.ref081">
      <label>81</label>
      <mixed-citation publication-type="journal"><name><surname>Schwarz</surname><given-names>G</given-names></name>, <etal>et al</etal>. <article-title>Estimating the dimension of a model</article-title>. <source>The Annals of Statistics</source>. <year>1978</year>;<volume>6</volume>(<issue>2</issue>):<fpage>461</fpage>–<lpage>464</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1214/aos/1176344136</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008380.ref082">
      <label>82</label>
      <mixed-citation publication-type="book"><name><surname>Gusfield</surname><given-names>D</given-names></name>. <source>ReCombinatorics: the algorithmics of ancestral recombination graphs and explicit phylogenetic networks</source>. <publisher-name>MIT press</publisher-name>; <year>2014</year>.</mixed-citation>
    </ref>
    <ref id="pcbi.1008380.ref083">
      <label>83</label>
      <mixed-citation publication-type="journal"><name><surname>Robinson</surname><given-names>DF</given-names></name>, <name><surname>Foulds</surname><given-names>LR</given-names></name>. <article-title>Comparison of phylogenetic trees</article-title>. <source>Mathematical Biosciences</source>. <year>1981</year>;<volume>53</volume>(<issue>1-2</issue>):<fpage>131</fpage>–<lpage>147</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1016/0025-5564(81)90043-2</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008380.ref084">
      <label>84</label>
      <mixed-citation publication-type="journal"><name><surname>Steel</surname><given-names>MA</given-names></name>, <name><surname>Penny</surname><given-names>D</given-names></name>. <article-title>Distributions of tree comparison metrics—some new results</article-title>. <source>Systematic Biology</source>. <year>1993</year>;<volume>42</volume>(<issue>2</issue>):<fpage>126</fpage>–<lpage>141</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/sysbio/42.2.126</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008380.ref085">
      <label>85</label>
      <mixed-citation publication-type="journal"><name><surname>Lakner</surname><given-names>C</given-names></name>, <name><surname>Van Der Mark</surname><given-names>P</given-names></name>, <name><surname>Huelsenbeck</surname><given-names>JP</given-names></name>, <name><surname>Larget</surname><given-names>B</given-names></name>, <name><surname>Ronquist</surname><given-names>F</given-names></name>. <article-title>Efficiency of Markov chain Monte Carlo tree proposals in Bayesian phylogenetics</article-title>. <source>Systematic Biology</source>. <year>2008</year>;<volume>57</volume>(<issue>1</issue>):<fpage>86</fpage>–<lpage>103</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1080/10635150801886156</pub-id><pub-id pub-id-type="pmid">18278678</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008380.ref086">
      <label>86</label>
      <mixed-citation publication-type="journal"><name><surname>Mueller</surname><given-names>NF</given-names></name>, <name><surname>Bouckaert</surname><given-names>R</given-names></name>. <article-title>Adaptive Metropolis-coupled MCMC for BEAST 2</article-title>. <source>PeerJ</source>. <year>2020</year>;<volume>8</volume>:<fpage>e9473</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.7717/peerj.9473</pub-id><pub-id pub-id-type="pmid">32995072</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008380.ref087">
      <label>87</label>
      <mixed-citation publication-type="journal"><name><surname>Kanj</surname><given-names>IA</given-names></name>, <name><surname>Nakhleh</surname><given-names>L</given-names></name>, <name><surname>Than</surname><given-names>C</given-names></name>, <name><surname>Xia</surname><given-names>G</given-names></name>. <article-title>Seeing the trees and their branches in the network is hard</article-title>. <source>Theoretical Computer Science</source>. <year>2008</year>;<volume>401</volume>(<issue>1-3</issue>):<fpage>153</fpage>–<lpage>164</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1016/j.tcs.2008.04.019</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
<sub-article article-type="aggregated-review-documents" id="pcbi.1008380.r001" specific-use="decision-letter">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pcbi.1008380.r001</article-id>
    <title-group>
      <article-title>Decision Letter 0</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Kosakovsky Pond</surname>
          <given-names>Sergei L.</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Noble</surname>
          <given-names>William Stafford</given-names>
        </name>
        <role>Deputy Editor</role>
      </contrib>
    </contrib-group>
    <permissions>
      <copyright-statement>© 2021 Kosakovsky Pond, Noble</copyright-statement>
      <copyright-year>2021</copyright-year>
      <copyright-holder>Kosakovsky Pond, Noble</copyright-holder>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an open access article distributed under the terms of the <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <related-article xmlns:xlink="http://www.w3.org/1999/xlink" ext-link-type="doi" xlink:href="10.1371/journal.pcbi.1008380" id="rel-obj001" related-article-type="reviewed-article"/>
    <custom-meta-group>
      <custom-meta>
        <meta-name>Submission Version</meta-name>
        <meta-value>0</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>
      <named-content content-type="letter-date">3 Feb 2021</named-content>
    </p>
    <p>Dear Dr Rabier,</p>
    <p>Thank you very much for submitting your manuscript "On the inference of complex phylogenetic networks by Markov Chain Monte-Carlo" for consideration at PLOS Computational Biology.</p>
    <p>As with all papers reviewed by the journal, your manuscript was reviewed by members of the editorial board and by several independent reviewers. In light of the reviews (below this email), we would like to invite the resubmission of a significantly-revised version that takes into account the reviewers' comments.</p>
    <p>Particular attention should be paid to overhauling the "real data" analysis part of the manuscript (the reviewers were quite disappointed by the current one), and to improving the depth and clarity (although opinions differed there) of the methodological exposition.</p>
    <p>We cannot make any decision about publication until we have seen the revised manuscript and your response to the reviewers' comments. Your revised manuscript is also likely to be sent to reviewers for further evaluation.</p>
    <p>When you are ready to resubmit, please upload the following:</p>
    <p>[1] A letter containing a detailed list of your responses to the review comments and a description of the changes you have made in the manuscript. Please note while forming your response, if your article is accepted, you may have the opportunity to make the peer review history publicly available. The record will include editor decision letters (with reviews) and your responses to reviewer comments. If eligible, we will contact you to opt in or out.</p>
    <p>[2] Two versions of the revised manuscript: one with either highlights or tracked changes denoting where the text has been changed; the other a clean version (uploaded as the manuscript file).</p>
    <p>Important additional instructions are given below your reviewer comments.</p>
    <p>Please prepare and submit your revised manuscript within 60 days. If you anticipate any delay, please let us know the expected resubmission date by replying to this email. Please note that revised manuscripts received after the 60-day due date may require evaluation and peer review similar to newly submitted manuscripts.</p>
    <p>Thank you again for your submission. We hope that our editorial process has been constructive so far, and we welcome your feedback at any time. Please don't hesitate to contact us if you have any questions or comments.</p>
    <p>Sincerely,</p>
    <p>Sergei L. Kosakovsky Pond, PhD</p>
    <p>Associate Editor</p>
    <p>PLOS Computational Biology</p>
    <p>William Noble</p>
    <p>Deputy Editor</p>
    <p>PLOS Computational Biology</p>
    <p>***********************</p>
    <p>Reviewer's Responses to Questions</p>
    <p>
      <bold>Comments to the Authors:</bold>
    </p>
    <p>
      <bold>Please note here if the review is uploaded as an attachment.</bold>
    </p>
    <p>Reviewer #1: The authors presented an extremely well-written manuscript with the extension of SNAPP to networks (SnappNet) which is similar in principle to the work on Zhu et al (2018) but with two key differences: the way in which the likelihood is computed and the priors. These two differences have a huge impact on the method's computational speed and convergence.</p>
    <p>I want to thank the authors for the high quality writing and figures. It was a joy to read it!</p>
    <p># Major comments</p>
    <p>- I would appreciate a bit more details or examples (maybe figures?) to better explain two concepts: "population interfaces" and "incomparable population interfaces". The whole section on partial likelihoods relies on these two concepts and I found them very very hard to understand (perhaps given my inexperience with Snapp to begin with). For readers like me that are not familiar with these concepts, a bit more explanation will make this section much easier to digest</p>
    <p>- Did you make experiments on how the prior affects convergence and computational speed? Given that the prior is an important difference with the work in Zhu et al (and that we know that it has some weight on the mixing of the chain), it would be interesting to compare how the network priors behave in terms of convergence and speed, not just accuracy</p>
    <p>- It seems that the tests on the accuracy of the numerical parameters is done only on Network A (unless I missed this for Network B and C). I think that testing the accuracy of estimated branch lengths and network height is very important for complex networks like B and C, so I wish something could be said about this. In addition, for complex networks it seems that the number of hybridizations was bounded at the true number of hybridizations which is a good initial test, but I would be interested to know how the method performs when the prior is more lax and allows for more complex networks. What networks do you end up visiting frequently if the prior allows for more hybridizations than the true number? I know that this type of tests could easily get out of hand, but doing one or two simulations in which the prior is not bounding the number of hybridizations could provide information on accuracy and convergence under more realistic settings. In fact, perhaps this could be one of the things happening on the real data, that the number of hybridizations is not correctly guessed for the prior</p>
    <p>- It seems that Network C(3) and C(4) were only used to test CPU time and memory, which is indeed important, but if the algorithms were run anyway, it would be nice to see the accuracy of the method for these more complex networks</p>
    <p>- The real data analysis was the only disappointing part of the manuscript. The fact that the algorithm could not search adequately the space of networks and that 10 networks had to be arbitrarily chosen for comparison was very disappointing. It was also not explained what criteria was used to choose the 10 networks? I understand that real data will never behave like simulated data, but if the current algorithm is not applicable to this dataset (that appears to be quite similar, at least in terms of sample sizes to the simulated data), which real data could be used for this method? Also, do the authors have a sense for what made the real data so difficult to analyze? Because the sample size looks quite manageable (12,000 sites and 4 taxa). I think that a thorough investigation into why this dataset could not be analyzed with this method would provide users with more information regarding the limitations of the method</p>
    <p># Minor comments</p>
    <p>- Line 62: "networks that can lead to observe such trees" sounds like it is referring to the concept of displayed tree which I think is not accurate in this section related to likelihood methods</p>
    <p>- Line 228: I would add a "in this case" to the sentence of "Note that N_{\\underline{x}} is not random" because it is not random in general, right?</p>
    <p>- Line 397: how are the "starting points" for the MCMC chosen?</p>
    <p>- Line 427: why not say "estimated posterior probability" instead of "ratio", am I missing something?</p>
    <p>- Lines 450-463: It is unclear the difference between the two optimizations. In the first case, you mention that only 9 operators were used (and ignored the 7 related to network updates) but in the second case you mention that the network topology was fixed. Isn't that the same thing as the first optimization?</p>
    <p>- Lines 471-473: I don't understand the evaluation criterion, can you clarify?</p>
    <p>- Line 502: In the cases where a network with only 1 reticulation was recovered, was this at least a subnetwork of the true network?</p>
    <p>- Table 1: I was intrigued that on the third row (less ILS) the accuracy in Network A decreased from 100% to 80% as you increased more sites. Do the authors have an idea why this could be happening?</p>
    <p>- Table 2: When the number of lineages are varied for B and C, you choose the same number of lineages for both, right? Either B and C have only one lineage, or they both have 4, correct?</p>
    <p>- Table 7: there is a missing reference to a Figure</p>
    <p>- Figure 13: what do the authors refer to "Network length". I am sure this most be defined in the text, but I did not find it</p>
    <p>- Figure 14 (and others): I would repeat the caption instead of writing "Same as Figure 10" for readability</p>
    <p>Reviewer #2: Rabier et al. have developed an elegent and potentially revolutionary algorithm to compute the likelihood of biallelic data given a species network. Not only does their manuscript present the algorithm in sufficient clarity and detail, but several analyses of real and simulated data sets demonstrates its computational performance and general utility of biallelic inference of species networks.</p>
    <p>I only have a few comments regarding the manuscript.</p>
    <p>1. How was the correctness of the likelihood implementation validated? It would make sense to compare the likelihood computed by the algorithm of Zhu et al. with SnappNet for a random species network, disagreement would suggest an error in one or both implementations. Or it could possibly be computed manually for a simple network and compared with either implementation.</p>
    <p>2. The language in the introduction is a little oversimplified, especially the sentence "Mechanisms at stake lead a genome to have different parent species - in contrast with the simpler image that depicts a genome as being vertically inherited with modifications from a single ancestral genome." Under the multispecies coalescent a species can have a single parent, but inherited multiple ancestral genomes at the top of the branch. This is followed an overview of different kinds of "mechanisms leading to mix genome contents" (grammatically incorrect, maybe this should be "mechanisms leading to mixed inheritance"?), including HGT in prokaryotes. I think it would be better to remove this or make it clear that the model implemented here isn't useful to model HGT in prokaryotes, since it relies on the free recombination between sites facilitated by sexual reproduction.</p>
    <p>3. A limitation inherent to inference of species networks using biallelic markers is the apparent non-identifiability of reticulation node heights (between upper and lower bounds). This is shown in section 2.1 of Cao, Zhen, et al. "Practical aspects of phylogenetic network analysis using phylonet." bioRxiv (2019). The authors may consider including this in the discussion, as it seemingly the case that precise inference of reticulation node heights requires other kinds of methods (e.g. multilocus methods or coalescent HMMs). However this does not diminish the utility of Rabier et al.'s method for the inference of the species network topology or speciation times.</p>
    <p>I enjoyed reading the manuscript and am looking forward to seeing the method used in practice.</p>
    <p>Regards,</p>
    <p>Huw A. Ogilvie</p>
    <p>Reviewer #3: The authors developed a new Bayesian method, SnappNet for phylogenetic</p>
    <p>network inference. The authors use a faster new method based on joint</p>
    <p>conditional probabilities to compute likelihoods of phylogenetic</p>
    <p>networks resulting in faster analysis by orders of magnitude and with an</p>
    <p>order of magnitude less memory usage than the recent MCMCBiMarkers</p>
    <p>method for inferring networks.</p>
    <p>This work was inspired by the authors of MCMCBiMarkers noting that it is</p>
    <p>necessary to improve the speed of such methods. The authors leverage the</p>
    <p>improved speed to consider more complex evolutionary scenarios with an</p>
    <p>example of inferring a new evolutionary scenario on rice genomic data that</p>
    <p>is compatible with available evidence.</p>
    <p>This is an important development and will be of great interest to the</p>
    <p>readers of PLOS Computational Biology. The new fast likelihood computation</p>
    <p>method for networks is novel and useful. However, the analysis of the</p>
    <p>inferred networks needs major revisions. The treatment of</p>
    <p>the complicated topic of convergence in a Bayesian analysis needs to be</p>
    <p>substantially expanded. The authors seem to consider the inferred posterior</p>
    <p>probability of a network as an accuracy measure and there are major</p>
    <p>questions about whether the method is correctly inferring the expected</p>
    <p>network or simply stuck at that network. Finally, The paper needs a much more</p>
    <p>careful analysis of the differences between SnappNet and MCMCBiMarkers</p>
    <p>results in order to support their accuracy claims.</p>
    <p>Specific comments follow</p>
    <p>Page 12 - MCMC Operators</p>
    <p>This section is woefully short considering the great importance of MCMC</p>
    <p>operators on the convergence and accuracy of a Bayesian analysis. What</p>
    <p>to the most important operators do? How are the operators tailored to</p>
    <p>work with a network as opposed to a tree? Which operators are most used</p>
    <p>and what are the acceptance rates? Is there any possiblity that the</p>
    <p>operators have a bias towards or away from certain types of network</p>
    <p>shapes? If these questions have not been answered in specific detail yet</p>
    <p>then they should be included in the discussion and mentioned as</p>
    <p>important future work. I see that the authors cite SpeciesNetwork as the</p>
    <p>origin of the network topology operators but it is important to mention</p>
    <p>such concerns at the very least, particularly given that you are</p>
    <p>combining them with new parameters and new operators.</p>
    <p>Page 13 - Phylogenetic networks studied</p>
    <p>Why did you study these three networks? Are they representative of</p>
    <p>important type of networks or biologically important in some way?</p>
    <p>Are there any caveats to focusing on these networks or areas of future</p>
    <p>work that should be studied on larger or more complex networks?</p>
    <p>Page 13 - Bayesian Analysis</p>
    <p>I see in the commands in the supplemental material that you sampled every 1000</p>
    <p>iterations of the MCMC. This is worth mentioning in the paper proper</p>
    <p>along with an explanation that this is to prevent autocorrelation and</p>
    <p>part of the reason that computational complexity of likelihood</p>
    <p>calculations is important.</p>
    <p>Why did you use a single starting tree or network for each MCMC</p>
    <p>analysis instead of a random starting point? This is irregular in</p>
    <p>MCMC analysis and makes it difficult to generalize your results.</p>
    <p>This needs more explanation and justification.</p>
    <p>Page 14 - MCMC convergence</p>
    <p>More detail is needed on what parameters the ESS was measured on. The linked</p>
    <p>BEAST tutorial mentions that no topological ESS measures are included by</p>
    <p>default so I am not sure what ESS was measured and whether any tests of</p>
    <p>topological convergence were performed.</p>
    <p>In general the explanation of convergence needs to be expanded.</p>
    <p>Convergence is a complicated yet important topic and a threshold of ESS</p>
    <p>is most certainly not enough by itself to assume convergence, that is</p>
    <p>an ESS of each important parameter is a necessary but not sufficient</p>
    <p>requirement to assume convergence.</p>
    <p>Importantly, convergence of treelength or network length does not imply the</p>
    <p>convergence of topology. ESS measures for tree topology have been</p>
    <p>recently developed and the authors should note whether they have</p>
    <p>considered similar measures for network topology ESS or indicate that</p>
    <p>this is an important area for future work. If a topology ESS is not used</p>
    <p>(or possible) then at the very least multiple MCMC replicates should be tested and the</p>
    <p>results compared to determine if similar topologies, split frequencies,</p>
    <p>or network edges are explored before assuming convergence.</p>
    <p>page 15 - Study of networks A and B</p>
    <p>Table 1 should be closer to its usage.</p>
    <p>page 15-16 Ability to recover the network topology</p>
    <p>I am very confused about what your measure of accuracy is supposed to be</p>
    <p>for the correct network topology here and in Table 1. From the text it</p>
    <p>seems that you are reporting the percentage of total topologies sampled</p>
    <p>that matched the target/starting topology. However, in a Bayesian MCMC</p>
    <p>analysis the percentage of samples should be proportional to the</p>
    <p>posterior probability of that topology, not some measure of accuracy. We</p>
    <p>should expect the true network to be the most frequently sampled one if the</p>
    <p>model is correct but values approaching 100% do not seem worth</p>
    <p>applauding as they may indicate lackluster topology proposals and that the</p>
    <p>analysis is stuck at the initial network, or alternatively that the</p>
    <p>analysis is relatively trivial.</p>
    <p>Similarly, the accuracy on network B has not "decreased slightly to</p>
    <p>81.25%" but rather the posterior probability of network B is 81.25%</p>
    <p>indicating that other scenarios are possible.</p>
    <p>A better analysis should probably be based on some idea of consensus networks, as</p>
    <p>an analog to consensus trees, and whether the MCMC analysis can</p>
    <p>efficiently sample from the probability space and recover that</p>
    <p>consensus. Some form of consensus analysis could be used to determine the</p>
    <p>posterior probability of individual splits or network edges and I</p>
    <p>suspect, as with trees, this will be necessary for studying larger</p>
    <p>or more complex scenarios where the true network may have a relatively</p>
    <p>small probability.</p>
    <p>Page 18 - It's difficult to justify the conclusion that MCMCBiMarkers is not</p>
    <p>performing well if MCMCBiMarkers was not run to convergence. Testing</p>
    <p>with larger ESS values is not the same as running it until the MCMC has</p>
    <p>fully converged.</p>
    <p>Page 22 - You mention here that on the real datasets with free</p>
    <p>exploration of the topology space the analysis frequently got stuck in</p>
    <p>local optima. As with the simulated data this suggests that new methods</p>
    <p>are needed to sample from networks.</p>
    <p>You explain here that you focused on direct analysis of 10 specific</p>
    <p>topologies by computing their likelihoods and using AIC and BIC</p>
    <p>penalties. This is one solution but it needs to be more carefully</p>
    <p>explained to the reader what this means. You should also explain</p>
    <p>carefully here that this is not a Bayesian analysis as you have moved</p>
    <p>from posterior probablity to likelihood comparisons. The networks can be</p>
    <p>compared against each other but it is not possible to consider their</p>
    <p>probability with this type of analysis and it is possible that some</p>
    <p>other network you do not consider or specific network features have a</p>
    <p>higher probability than any of these 10 networks.</p>
    <p>Page 27 - the analysis of the candidate networks is interesting in that</p>
    <p>it discusses biologically relevant factors and the penalized likelihood</p>
    <p>ranking of the networks but I think some of the conclusions here are too strong</p>
    <p>based on just this evidence, such as suggesting that specific networks should</p>
    <p>be studied more closely based on this analysis or that</p>
    <p>specific networks should be discounted because their results would be</p>
    <p>surprising biologically.</p>
    <p>The mention of heated chains for future work seems out of place here in the results</p>
    <p>section and should likely be in the discussion or conclusion.</p>
    <p>Page 29 - the comparison of SnappNet and MCMCBiMarkers "accuracy" on</p>
    <p>network C again seems to be without context. More justification is</p>
    <p>needed to prove that the low accuracy of the expected network is a</p>
    <p>detriment. For example, I suggest discussing the posterior probability</p>
    <p>from each method that the network has a given number of reticulations</p>
    <p>to better make your claim that MCMCBiMarkers is discounting these scenarios.</p>
    <p>**********</p>
    <p>
      <bold>Have all data underlying the figures and results presented in the manuscript been provided?</bold>
    </p>
    <p>Large-scale datasets should be made available via a public repository as described in the <italic toggle="yes">PLOS Computational Biology</italic>
<ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://journals.plos.org/ploscompbiol/s/data-availability" ext-link-type="uri">data availability policy</ext-link>, and numerical data that underlies graphs or summary statistics should be provided in spreadsheet form as supporting information.</p>
    <p>Reviewer #1: Yes</p>
    <p>Reviewer #2: Yes</p>
    <p>Reviewer #3: Yes</p>
    <p>**********</p>
    <p>PLOS authors have the option to publish the peer review history of their article (<ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://journals.plos.org/ploscompbiol/s/editorial-and-peer-review-process#loc-peer-review-history" ext-link-type="uri">what does this mean?</ext-link>). If published, this will include your full peer review and any attached files.</p>
    <p>If you choose “no”, your identity will remain anonymous but your review may still be made public.</p>
    <p><bold>Do you want your identity to be public for this peer review?</bold> For information about this choice, including consent withdrawal, please see our <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://www.plos.org/privacy-policy" ext-link-type="uri">Privacy Policy</ext-link>.</p>
    <p>Reviewer #1: No</p>
    <p>Reviewer #2: <bold>Yes: </bold>Huw A. Ogilvie</p>
    <p>Reviewer #3: No</p>
    <p>
      <underline>Figure Files:</underline>
    </p>
    <p>While revising your submission, please upload your figure files to the Preflight Analysis and Conversion Engine (PACE) digital diagnostic tool, <underline><ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://pacev2.apexcovantage.com/" ext-link-type="uri">https://pacev2.apexcovantage.com</ext-link></underline>. PACE helps ensure that figures meet PLOS requirements. To use PACE, you must first register as a user. Then, login and navigate to the UPLOAD tab, where you will find detailed instructions on how to use the tool. If you encounter any issues or have any questions when using PACE, please email us at <underline><email>figures@plos.org</email></underline>.</p>
    <p>
      <underline>Data Requirements:</underline>
    </p>
    <p>Please note that, as a condition of publication, PLOS' data policy requires that you make available all data used to draw the conclusions outlined in your manuscript. Data must be deposited in an appropriate repository, included within the body of the manuscript, or uploaded as supporting information. This includes all numerical values that were used to generate graphs, histograms etc.. For an example in PLOS Biology see here: <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://www.plosbiology.org/article/info%3Adoi%2F10.1371%2Fjournal.pbio.1001908#s5" ext-link-type="uri">http://www.plosbiology.org/article/info%3Adoi%2F10.1371%2Fjournal.pbio.1001908#s5</ext-link>.</p>
    <p>
      <underline>Reproducibility:</underline>
    </p>
    <p>To enhance the reproducibility of your results, PLOS recommends that you deposit laboratory protocols in protocols.io, where a protocol can be assigned its own identifier (DOI) such that it can be cited independently in the future. For instructions, please see <underline><ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://journals.plos.org/plospathogens/s/submission-guidelines" ext-link-type="uri">http://journals.plos.org/compbiol/s/submission-guidelines#loc-materials-and-methods</ext-link></underline></p>
  </body>
</sub-article>
<sub-article article-type="author-comment" id="pcbi.1008380.r002">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pcbi.1008380.r002</article-id>
    <title-group>
      <article-title>Author response to Decision Letter 0</article-title>
    </title-group>
    <related-article xmlns:xlink="http://www.w3.org/1999/xlink" ext-link-type="doi" xlink:href="10.1371/journal.pcbi.1008380" id="rel-obj002" related-article-type="editor-report"/>
    <custom-meta-group>
      <custom-meta>
        <meta-name>Submission Version</meta-name>
        <meta-value>1</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>
      <named-content content-type="author-response-date">11 May 2021</named-content>
    </p>
    <supplementary-material id="pcbi.1008380.s002" position="float" content-type="local-data">
      <label>Attachment</label>
      <caption>
        <p>Submitted filename: <named-content content-type="submitted-filename">Answers.pdf</named-content></p>
      </caption>
      <media xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1008380.s002.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </body>
</sub-article>
<sub-article article-type="aggregated-review-documents" id="pcbi.1008380.r003" specific-use="decision-letter">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pcbi.1008380.r003</article-id>
    <title-group>
      <article-title>Decision Letter 1</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Kosakovsky Pond</surname>
          <given-names>Sergei L.</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Noble</surname>
          <given-names>William Stafford</given-names>
        </name>
        <role>Deputy Editor</role>
      </contrib>
    </contrib-group>
    <permissions>
      <copyright-statement>© 2021 Kosakovsky Pond, Noble</copyright-statement>
      <copyright-year>2021</copyright-year>
      <copyright-holder>Kosakovsky Pond, Noble</copyright-holder>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an open access article distributed under the terms of the <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <related-article xmlns:xlink="http://www.w3.org/1999/xlink" ext-link-type="doi" xlink:href="10.1371/journal.pcbi.1008380" id="rel-obj003" related-article-type="reviewed-article"/>
    <custom-meta-group>
      <custom-meta>
        <meta-name>Submission Version</meta-name>
        <meta-value>1</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>
      <named-content content-type="letter-date">13 Jul 2021</named-content>
    </p>
    <p>Dear Dr Rabier,</p>
    <p>We are pleased to inform you that your manuscript 'On the inference of complex phylogenetic networks by Markov Chain Monte-Carlo' has been provisionally accepted for publication in PLOS Computational Biology.</p>
    <p>Before your manuscript can be formally accepted you will need to complete some formatting changes, which you will receive in a follow up email. A member of our team will be in touch with a set of requests.</p>
    <p>Please note that your manuscript will not be scheduled for publication until you have made the required changes, so a swift response is appreciated.</p>
    <p>IMPORTANT: The editorial review process is now complete. PLOS will only permit corrections to spelling, formatting or significant scientific errors from this point onwards. Requests for major changes, or any which affect the scientific understanding of your work, will cause delays to the publication date of your manuscript.</p>
    <p>Should you, your institution's press office or the journal office choose to press release your paper, you will automatically be opted out of early publication. We ask that you notify us now if you or your institution is planning to press release the article. All press must be co-ordinated with PLOS.</p>
    <p>Thank you again for supporting Open Access publishing; we are looking forward to publishing your work in PLOS Computational Biology. </p>
    <p>Best regards,</p>
    <p>Sergei L. Kosakovsky Pond, PhD</p>
    <p>Associate Editor</p>
    <p>PLOS Computational Biology</p>
    <p>William Noble</p>
    <p>Deputy Editor</p>
    <p>PLOS Computational Biology</p>
    <p>***********************************************************</p>
    <p>Prior to submitting files for production, please address the remaining minor comments raised by Rev 1.</p>
    <p>Reviewer's Responses to Questions</p>
    <p>
      <bold>Comments to the Authors:</bold>
    </p>
    <p>
      <bold>Please note here if the review is uploaded as an attachment.</bold>
    </p>
    <p>Reviewer #1: I want to thank the authors for addressing all my comments and questions in a very effective manner. The description of the model is much easier to follow thanks to the additions, and the simulations are more convincing.</p>
    <p>My only minor comments relate to the real data analysis. I was excited that the chains were run to estimate the networks (as opposed to fixing the networks as in the initial version).</p>
    <p># Minor comments</p>
    <p>- Lines 719-720: can you add the reference to where we can find these convergence checks in the text (or maybe they are in the supp mat)? I could not find the trace plots or how where the posterior distributions compared</p>
    <p>- Line 724: you mention that all networks sampled had the same topology. Is this true also for the burnin period? (Side note: not sure if burnin info was included in the text). How was the starting point of the chain determined? Where different starting points used?</p>
    <p>- Paragraph starting on Line 729: do you also get the chain containing only one topology for data set 2 (as for data set 1)? How was the starting point of the chain determined? Where different starting points used?</p>
    <p>- Figure 18: Could the second and third topology be flipped so that the taxa is ordered in the same way as the first topology? This is just to facilitate comparison. I suggest flipping the 2nd and 3rd (rather than only the 1st topology) because the 1st topology agrees with the other figures</p>
    <p>- Was the real data run with PhyloNet too? Or was it prohibited?</p>
    <p>Reviewer #3: The authors developed a new Bayesian method, SnappNet for phylogenetic</p>
    <p>network inference. The authors use a faster new method based on joint</p>
    <p>conditional probabilities to compute likelihoods of phylogenetic</p>
    <p>networks resulting in faster analysis by orders of magnitude and with an</p>
    <p>order of magnitude less memory usage than the recent MCMCBiMarkers</p>
    <p>method for inferring networks.</p>
    <p>This work was inspired by the authors of MCMCBiMarkers noting that it is</p>
    <p>necessary to improve the speed of such methods. The authors leverage the</p>
    <p>improved speed to consider more complex evolutionary scenarios with an</p>
    <p>example of inferring a new evolutionary scenario on rice genomic data that</p>
    <p>is compatible with available evidence.</p>
    <p>This is an important development and will be of great interest to the</p>
    <p>readers of PLOS Computational Biology. The new fast likelihood computation</p>
    <p>method for networks is novel and useful.</p>
    <p>The authors have satisfied all of my concerns with the original submission.</p>
    <p>They now carefully explain how the model can be used with an explanation of</p>
    <p>convergence and a much better explanation of the limitations of this work.</p>
    <p>The expanded analysis of rice genomic data is much more thorough and</p>
    <p>shows the potential of their method. The authors also now explain in greater</p>
    <p>detail what new advances are needed beyond faster likelihood calculations</p>
    <p>to accurately infer larger and more complex networks.</p>
    <p>**********</p>
    <p>
      <bold>Have the authors made all data and (if applicable) computational code underlying the findings in their manuscript fully available?</bold>
    </p>
    <p>The <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://journals.plos.org/ploscompbiol/s/materials-and-software-sharing" ext-link-type="uri">PLOS Data policy</ext-link> requires authors to make all data and code underlying the findings described in their manuscript fully available without restriction, with rare exception (please refer to the Data Availability Statement in the manuscript PDF file). The data and code should be provided as part of the manuscript or its supporting information, or deposited to a public repository. For example, in addition to summary statistics, the data points behind means, medians and variance measures should be available. If there are restrictions on publicly sharing data or code —e.g. participant privacy or use of data from a third party—those must be specified.</p>
    <p>Reviewer #1: Yes</p>
    <p>Reviewer #3: Yes</p>
    <p>**********</p>
    <p>PLOS authors have the option to publish the peer review history of their article (<ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://journals.plos.org/ploscompbiol/s/editorial-and-peer-review-process#loc-peer-review-history" ext-link-type="uri">what does this mean?</ext-link>). If published, this will include your full peer review and any attached files.</p>
    <p>If you choose “no”, your identity will remain anonymous but your review may still be made public.</p>
    <p><bold>Do you want your identity to be public for this peer review?</bold> For information about this choice, including consent withdrawal, please see our <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://www.plos.org/privacy-policy" ext-link-type="uri">Privacy Policy</ext-link>.</p>
    <p>Reviewer #1: No</p>
    <p>Reviewer #3: No</p>
  </body>
</sub-article>
<sub-article article-type="editor-report" id="pcbi.1008380.r004" specific-use="acceptance-letter">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pcbi.1008380.r004</article-id>
    <title-group>
      <article-title>Acceptance letter</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Kosakovsky Pond</surname>
          <given-names>Sergei L.</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Noble</surname>
          <given-names>William Stafford</given-names>
        </name>
        <role>Deputy Editor</role>
      </contrib>
    </contrib-group>
    <permissions>
      <copyright-statement>© 2021 Kosakovsky Pond, Noble</copyright-statement>
      <copyright-year>2021</copyright-year>
      <copyright-holder>Kosakovsky Pond, Noble</copyright-holder>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an open access article distributed under the terms of the <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <related-article xmlns:xlink="http://www.w3.org/1999/xlink" ext-link-type="doi" xlink:href="10.1371/journal.pcbi.1008380" id="rel-obj004" related-article-type="reviewed-article"/>
  </front-stub>
  <body>
    <p>
      <named-content content-type="letter-date">27 Aug 2021</named-content>
    </p>
    <p>PCOMPBIOL-D-20-01799R1 </p>
    <p>On the inference of complex phylogenetic networks by Markov Chain Monte-Carlo</p>
    <p>Dear Dr Rabier,</p>
    <p>I am pleased to inform you that your manuscript has been formally accepted for publication in PLOS Computational Biology. Your manuscript is now with our production department and you will be notified of the publication date in due course.</p>
    <p>The corresponding author will soon be receiving a typeset proof for review, to ensure errors have not been introduced during production. Please review the PDF proof of your manuscript carefully, as this is the last chance to correct any errors. Please note that major changes, or those which affect the scientific understanding of the work, will likely cause delays to the publication date of your manuscript. </p>
    <p>Soon after your final files are uploaded, unless you have opted out, the early version of your manuscript will be published online. The date of the early version will be your article's publication date. The final article will be published to the same URL, and all versions of the paper will be accessible to readers.</p>
    <p>Thank you again for supporting PLOS Computational Biology and open-access publishing. We are looking forward to publishing your work! </p>
    <p>With kind regards,</p>
    <p>Livia Horvath</p>
    <p>PLOS Computational Biology | Carlyle House, Carlyle Road, Cambridge CB4 3DN | United Kingdom <email>ploscompbiol@plos.org</email> | Phone +44 (0) 1223-442824 | <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://ploscompbiol.org" ext-link-type="uri">ploscompbiol.org</ext-link> | @PLOSCompBiol</p>
  </body>
</sub-article>
