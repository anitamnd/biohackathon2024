<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">9848058</article-id>
    <article-id pub-id-type="pmid">36548380</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btac819</article-id>
    <article-id pub-id-type="publisher-id">btac819</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Original Paper</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Gene Expression</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01060</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>SCIBER: a simple method for removing batch effects from single-cell RNA-sequencing data</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0003-0535-1259</contrib-id>
        <name>
          <surname>Gan</surname>
          <given-names>Dailin</given-names>
        </name>
        <aff><institution>Department of Applied and Computational Mathematics and Statistics, University of Notre Dame</institution>, Notre Dame, IN 46556, <country country="US">USA</country></aff>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0003-4353-5761</contrib-id>
        <name>
          <surname>Li</surname>
          <given-names>Jun</given-names>
        </name>
        <xref rid="btac819-cor1" ref-type="corresp"/>
        <!--jun.li@nd.edu-->
        <aff><institution>Department of Applied and Computational Mathematics and Statistics, University of Notre Dame</institution>, Notre Dame, IN 46556, <country country="US">USA</country></aff>
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Boeva</surname>
          <given-names>Valentina</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="btac819-cor1">To whom correspondence should be addressed. <email>jun.li@nd.edu</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <month>1</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2022-12-22">
      <day>22</day>
      <month>12</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>22</day>
      <month>12</month>
      <year>2022</year>
    </pub-date>
    <volume>39</volume>
    <issue>1</issue>
    <elocation-id>btac819</elocation-id>
    <history>
      <date date-type="received">
        <day>20</day>
        <month>9</month>
        <year>2022</year>
      </date>
      <date date-type="rev-recd">
        <day>27</day>
        <month>11</month>
        <year>2022</year>
      </date>
      <date date-type="editorial-decision">
        <day>15</day>
        <month>12</month>
        <year>2022</year>
      </date>
      <date date-type="accepted">
        <day>21</day>
        <month>12</month>
        <year>2022</year>
      </date>
      <date date-type="corrected-typeset">
        <day>28</day>
        <month>12</month>
        <year>2022</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2022. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2022</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btac819.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Motivation</title>
        <p>Integrative analysis of multiple single-cell RNA-sequencing datasets allows for more comprehensive characterizations of cell types, but systematic technical differences between datasets, known as ‘batch effects’, need to be removed before integration to avoid misleading interpretation of the data. Although many batch-effect-removal methods have been developed, there is still a large room for improvement: most existing methods only give dimension-reduced data instead of expression data of individual genes, are based on computationally demanding models and are black-box models and thus difficult to interpret or tune.</p>
      </sec>
      <sec id="s2">
        <title>Results</title>
        <p>Here, we present a new batch-effect-removal method called SCIBER (Single-Cell Integrator and Batch Effect Remover) and study its performance on real datasets. SCIBER matches cell clusters across batches according to the overlap of their differentially expressed genes. As a simple algorithm that has better scalability to data with a large number of cells and is easy to tune, SCIBER shows comparable and sometimes better accuracy in removing batch effects on real datasets compared to the state-of-the-art methods, which are much more complicated. Moreover, SCIBER outputs expression data in the original space, that is, the expression of individual genes, which can be used directly for downstream analyses. Additionally, SCIBER is a reference-based method, which assigns one of the batches as the reference batch and keeps it untouched during the process, making it especially suitable for integrating user-generated datasets with standard reference data such as the Human Cell Atlas.</p>
      </sec>
      <sec id="s3">
        <title>Availability and implementation</title>
        <p>SCIBER is publicly available as an R package on CRAN: <ext-link xlink:href="https://cran.r-project.org/web/packages/SCIBER/" ext-link-type="uri">https://cran.r-project.org/web/packages/SCIBER/</ext-link>. A vignette is included in the CRAN R package.</p>
      </sec>
      <sec id="s5">
        <title>Supplementary information</title>
        <p><xref rid="sup1" ref-type="supplementary-material">Supplementary data</xref> are available at <italic toggle="yes">Bioinformatics</italic> online.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>National Institutes of Health</institution>
            <institution-id institution-id-type="DOI">10.13039/100000002</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>R01CA252878</award-id>
        <award-id>R01CA222405</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="8"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>Single-cell RNA-sequencing (scRNA-seq) enables transcriptomic profiling at a single-cell resolution in a high-throughput manner (<xref rid="btac819-B9" ref-type="bibr">Fan <italic toggle="yes">et al.</italic>, 2020</xref>; <xref rid="btac819-B20" ref-type="bibr">Klein <italic toggle="yes">et al.</italic>, 2015</xref>; <xref rid="btac819-B27" ref-type="bibr">Macosko <italic toggle="yes">et al.</italic>, 2015</xref>; <xref rid="btac819-B38" ref-type="bibr">Rosenberg <italic toggle="yes">et al.</italic>, 2018</xref>; <xref rid="btac819-B60" ref-type="bibr">Zheng <italic toggle="yes">et al.</italic>, 2017</xref>). While scRNA-seq from a single experiment can be used to describe transcriptomic heterogeneity of different cell types, combining data from multiple datasets further enhances the power. However, there are often systematic differences between datasets called ‘batch effects’ that are caused purely by technical differences between datasets instead of biological variations. These technical differences include differences in scRNA-seq protocols, platforms, technologies (<xref rid="btac819-B13" ref-type="bibr">Hashimshony <italic toggle="yes">et al.</italic>, 2012</xref>; <xref rid="btac819-B20" ref-type="bibr">Klein <italic toggle="yes">et al.</italic>, 2015</xref>; <xref rid="btac819-B27" ref-type="bibr">Macosko <italic toggle="yes">et al.</italic>, 2015</xref>; <xref rid="btac819-B33" ref-type="bibr">Picelli <italic toggle="yes">et al.</italic>, 2014</xref>; <xref rid="btac819-B35" ref-type="bibr">Ramsköld <italic toggle="yes">et al.</italic>, 2012</xref>), read processing, quality control, normalization procedures (<xref rid="btac819-B45" ref-type="bibr">Stegle <italic toggle="yes">et al.</italic>, 2015</xref>), as well as different donors, capturing time and handling personnel (<xref rid="btac819-B9" ref-type="bibr">Fan <italic toggle="yes">et al.</italic>, 2020</xref>; <xref rid="btac819-B21" ref-type="bibr">Korsunsky <italic toggle="yes">et al.</italic>, 2019</xref>; <xref rid="btac819-B49" ref-type="bibr">Tran <italic toggle="yes">et al.</italic>, 2020</xref>). Batch effects are often substantial in scRNA-seq data; they may confound meaningful biological variations, lead to false discoveries and mislead the interpretation of the data (<xref rid="btac819-B15" ref-type="bibr">Hicks <italic toggle="yes">et al.</italic>, 2018</xref>; <xref rid="btac819-B22" ref-type="bibr">Leek <italic toggle="yes">et al.</italic>, 2010</xref>). Although ingenious experimental designs have been recommended to minimize batch effects, such as pooling cells from multiple batches into a single one for sequencing (<xref rid="btac819-B7" ref-type="bibr">Cao <italic toggle="yes">et al.</italic>, 2017</xref>; <xref rid="btac819-B19" ref-type="bibr">Kang <italic toggle="yes">et al.</italic>, 2018</xref>; <xref rid="btac819-B28" ref-type="bibr">McGinnis <italic toggle="yes">et al.</italic>, 2019</xref>; <xref rid="btac819-B38" ref-type="bibr">Rosenberg <italic toggle="yes">et al.</italic>, 2018</xref>), practical issues arise from logistical and temporal limitations and sample acquisition (<xref rid="btac819-B9" ref-type="bibr">Fan <italic toggle="yes">et al.</italic>, 2020</xref>). As a result, computational methods that remove batch effects are often essential for unified single-cell transcriptomics analysis (<xref rid="btac819-B9" ref-type="bibr">Fan <italic toggle="yes">et al.</italic>, 2020</xref>; <xref rid="btac819-B54" ref-type="bibr">Welch <italic toggle="yes">et al.</italic>, 2019</xref>).</p>
    <p>Current batch-effect-removal methods can be roughly divided into five categories: anchor-based, graph-based, anchor-graph-based, deep learning-based and model-based (<xref rid="btac819-B9" ref-type="bibr">Fan <italic toggle="yes">et al.</italic>, 2020</xref>; <xref rid="btac819-B10" ref-type="bibr">Forcato <italic toggle="yes">et al.</italic>, 2021</xref>). Below, we give examples or representatives in each category and briefly describe their ideas.</p>
    <p>Anchor-based methods first decide pairs of cells that share similar expression pattern across batches, which are called ‘anchors’, and then use these pairs to simultaneously integrate batches and remove batch effects. The method mutual nearest neighbors (MNN)-Correct (<xref rid="btac819-B11" ref-type="bibr">Haghverdi <italic toggle="yes">et al.</italic>, 2018</xref>) proposes to use MNN to identify anchors, and this idea was then applied and extended by SMNN (<xref rid="btac819-B56" ref-type="bibr">Yang <italic toggle="yes">et al.</italic>, 2021</xref>), BEER (<xref rid="btac819-B57" ref-type="bibr">Zhang <italic toggle="yes">et al.</italic>, 2019a</xref>), Seurat (<xref rid="btac819-B46" ref-type="bibr">Stuart <italic toggle="yes">et al.</italic>, 2019</xref>), fastMNN (<xref rid="btac819-B26" ref-type="bibr">Lun, 2019</xref>), Scanorama (<xref rid="btac819-B16" ref-type="bibr">Hie <italic toggle="yes">et al.</italic>, 2019</xref>) and scMerge (<xref rid="btac819-B23" ref-type="bibr">Lin <italic toggle="yes">et al.</italic>, 2019</xref>).</p>
    <p>Graph-based methods construct weighted graphs between and within batches and then use community detection methods to detect shared cell populations across batches. Conos (<xref rid="btac819-B5" ref-type="bibr">Barkas <italic toggle="yes">et al.</italic>, 2019</xref>) performs pairwise comparisons of batches to establish initial graphs between cells across different batches, creates a joint graph by combining inter-batch edges with lower-weight intra-batch edges and then applies community detection methods such as Walktrap, Louvain and Leiden, to the joint graph to decide clusters of different cell types. BBKNN (<xref rid="btac819-B34" ref-type="bibr">Polański <italic toggle="yes">et al.</italic>, 2020</xref>) first constructs graphs for each cell by finding its k-nearest neighbors in each batch independently and then merges sets of cell neighbors based on the distance metrics used in UMAP (Uniform Manifold Approximation and Projection) (<xref rid="btac819-B29" ref-type="bibr">McInnes <italic toggle="yes">et al.</italic>, 2018</xref>). scPopCorn (<xref rid="btac819-B52" ref-type="bibr">Wang <italic toggle="yes">et al.</italic>, 2019</xref>) relies on a co-membership propensity graph used in Google’s PageRank algorithm (Andersen <italic toggle="yes">et al.</italic>, 2006) to compute intra-dataset edges, uses cosine similarity matrix to define inter-dataset edges and then uses k-partitioning to decide shared populations across batches.</p>
    <p>Anchor-graph-based methods make use of both anchors and graph representation. As a representative, LIGER (<xref rid="btac819-B54" ref-type="bibr">Welch <italic toggle="yes">et al.</italic>, 2019</xref>) first uses integrative non-negative matrix factorization to determine a low-dimensional space where each cell can be characterized by two sets of factors called dataset-specific factors and shared factors, and then constructs a neighborhood graph for the shared factors, which is then used to identify joint clusters across batches that serve as anchors, by connecting cells with similar factor loading.</p>
    <p>Deep learning-based methods use deep neural networks to learn patterns in datasets. MMD-ResNet (<xref rid="btac819-B41" ref-type="bibr">Shaham <italic toggle="yes">et al.</italic>, 2017</xref>) assumes that batches differ in distribution and develops a residual network to learn a map that calibrates the distribution of the source batch to match that of the target batch. By combining transfer learning with variational auto-encoders, scGen (<xref rid="btac819-B25" ref-type="bibr">Lotfollahi <italic toggle="yes">et al.</italic>, 2019</xref>) first learns a distribution from the reference batch and then uses the trained network to predict the query dataset. SAUCIE (<xref rid="btac819-B2" ref-type="bibr">Amodio <italic toggle="yes">et al.</italic>, 2019</xref>) uses a deep neural network with autoencoders to learn the cellular manifold and obtains the batch-effect corrected data by one of its hidden layers. scAlign (<xref rid="btac819-B17" ref-type="bibr">Johansen and Quon, 2019</xref>) uses encoder networks to learn mappings from gene expression spaces of individual conditions into a common alignment space. scVI (<xref rid="btac819-B24" ref-type="bibr">Lopez <italic toggle="yes">et al.</italic>, 2018</xref>) uses a hierarchical Bayesian model with conditional distributions specified by deep neural networks to embed cells into a low-dimensional space, where batch effects have been removed.</p>
    <p>Model-based methods impose assumptions on the distribution of (count or transformed) data or the clusters of cell types. ComBat (<xref rid="btac819-B18" ref-type="bibr">Johnson <italic toggle="yes">et al.</italic>, 2007</xref>) relies on an empirical Bayes framework. It assumes that the standardized gene expression of a given sample in a given batch follows a normal distribution with pre-specified prior distributions. Limma (<xref rid="btac819-B44" ref-type="bibr">Smyth and Speed, 2003</xref>) uses a linear model to fit the input data, and the linear model contains a blocking term to capture batch effects. ZINB-WaVE (<xref rid="btac819-B37" ref-type="bibr">Risso <italic toggle="yes">et al.</italic>, 2018</xref>) models the original count data by a zero-inflated negative binomial distribution. Harmony (<xref rid="btac819-B21" ref-type="bibr">Korsunsky <italic toggle="yes">et al.</italic>, 2019</xref>) develops a novel soft K-means method to cluster cells, which implicitly assumes a linear mixture model for the cell clusters.</p>
    <p>Although many methods have been developed and demonstrated their abilities to remove batch effects in real data effectively, there is still a large room for improvement. First, most existing methods, no matter which of the five categories they belong to, do not output expression data in the original space/dimension, i.e. expression of individual genes. Instead, they give dimension-reduced data, where each dimension is typically a complex combination of many or all genes. While dimension-reduced data is often good enough for visualization, many other essential tasks of single-cell data analysis, such as differential expression analysis and pseudotime analysis, require expression data of individual genes. Second, many existing methods are based on computationally demanding models. As examples, graph-based methods often have a large algorithmic complexity, mixture non-Gaussian (e.g. zero-inflated negative binomial) models often require iterations and could have convergence issues [and also, many parametric models could be unsatisfactory to model real data, see e.g. <xref rid="btac819-B47" ref-type="bibr">Svensson (2020)</xref>, <xref rid="btac819-B43" ref-type="bibr">Silverman <italic toggle="yes">et al.</italic> (2020)</xref> and <xref rid="btac819-B59" ref-type="bibr">Zhao <italic toggle="yes">et al.</italic> (2022)</xref> about the current debate on whether zeros are truly inflated in scRNA-seq data], and deep learning models are not only computationally demanding but also require GPU resources. Third, many existing algorithms rely on black-box models and thus are hard to interpret or tune. These models are complex and have a number of parameters that need to be optimized on individual datasets (e.g. the number of nodes in each hidden layer of a neural network and the learning rate when training a neural network), which can be very difficult for the user to tune, especially if these parameters do not have clear biological or statistical meanings.</p>
    <p>In this article, we present a new method for batch-effect removal called Single-Cell Integrator and Batch Effect Remover (SCIBER) (pronounced as ‘cyber’) for short. SCIBER is a simple method that outputs the batch-effect corrected expression data in the original space/dimension. These expression data of individual genes can be directly used for all follow-up analyses. SCIBER has four steps, each having a clear biological meaning. The algorithms used for the four steps are k-means clustering, <italic toggle="yes">t</italic>-test, Fisher’s exact test and linear regression, respectively, all of which are easily comprehensible. The simplicity of SCIBER also makes it computationally light and scalable to data with a large number of cells. SCIBER requires minimum tuning: it has few tuning parameters and the default values work decently on a large range of datasets. We have shown that SCIBER, as a much simpler algorithm, performs comparably on real datasets or arguably better in some real datasets compared to the state-of-the-art methods.</p>
    <p>There is one more feature of SCIBER: it is a ‘reference-based’ method. That is, one of the batches is treated as the ‘reference’ and kept untouched, and what SCIBER does is to ‘project’ other batches to the reference batch. Most existing methods are not reference-based: they are often done by projecting all batches to a new shared space, thus all batches have been changed during batch-effect removal and no batch has the luxury of staying the same. Both reference-based and non-reference-based are commonly used strategies in the literature on batch-effect removal in general, and they each have their own characteristics and advantages. For single-cell expression data, reference-based methods can be a better option when there is a natural choice of the reference batch, or when the ‘standard’ data are available and one wants to ‘add’ new data to them. For example, the Human Cell Atlas project (<xref rid="btac819-B36" ref-type="bibr">Regev <italic toggle="yes">et al.</italic>, 2017</xref>), which aims to build comprehensive reference maps of all human cells, provides high-quality data that can serve as calibrated reference batches. SCIBER can add other data, with batch-effect removed, to them. On the other hand, if a non-reference-based method is used, these ‘standard’ data, as well as other data, will be modified, and thus the visualization, differential expression, cell clusters and other results on these standard data will also change, which is often undesired.</p>
  </sec>
  <sec>
    <title>2 Materials and methods</title>
    <sec>
      <title>2.1 Overview</title>
      <p>SCIBER takes scRNA-seq data from <italic toggle="yes">B </italic>+<italic toggle="yes"> </italic>1 batches, including a reference batch and <italic toggle="yes">B</italic> query batches (<inline-formula id="IE1"><mml:math id="IM1" display="inline" overflow="scroll"><mml:mrow><mml:mi>B</mml:mi><mml:mo>≥</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>). When not given, the reference batch can be assigned as the batch generated by the most reliable sequencing technique or protocol among the <italic toggle="yes">B </italic>+<italic toggle="yes"> </italic>1 batches, the batch with the largest number of cell types or cells, the batch with the largest number of reads, etc. The scRNA-seq data is assumed to be pre-processed, e.g. normalized by the sequencing depth and log-transformed to stabilize the variance.</p>
      <p>Keeping the reference batch untouched, SCIBER projects each query batch to the space of the reference batch. The projected query batches are the batch-effect corrected data, or ‘corrected data’ for short, which can be directly compared with the untouched reference data for downstream analyses such as differential expression analysis, or directly concatenated with the untouched reference batch for downstream analyses such as cell type identification or lineage analysis.</p>
      <p>The basic idea of SCIBER, different from all other batch-effect-removal algorithms, is to match cell clusters across batches by differentially expressed (DE) genes. In another word, SCIBER assumes that cell clusters corresponding to the same cell type should have an essentially identical set of DE genes, despite the existence of batch effects. This idea is implemented in the following four steps.</p>
      <p>Assume that the expression of <italic toggle="yes">p</italic> genes is measured in <italic toggle="yes">n<sub>b</sub></italic> cells in batch <italic toggle="yes">b</italic> (<inline-formula id="IE2"><mml:math id="IM2" display="inline" overflow="scroll"><mml:mrow><mml:mi>b</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>B</mml:mi></mml:mrow></mml:math></inline-formula>, and <italic toggle="yes">b </italic>=<italic toggle="yes"> </italic>0 refers to the reference batch). Let <inline-formula id="IE3"><mml:math id="IM3" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>b</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> be the expression of gene <italic toggle="yes">i</italic> in cell <italic toggle="yes">j</italic> from batch <italic toggle="yes">b</italic>, where <inline-formula id="IE4"><mml:math id="IM4" display="inline" overflow="scroll"><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>p</mml:mi></mml:mrow></mml:math></inline-formula>, and <inline-formula id="IE5"><mml:math id="IM5" display="inline" overflow="scroll"><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mi>b</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>.</p>
    </sec>
    <sec>
      <title>2.2 Step 1: K-means clustering for each individual batch</title>
      <p>In Step 1, a K-means clustering is performed on each batch. That is, the <italic toggle="yes">n<sub>b</sub></italic> cells in batch <italic toggle="yes">b</italic> are clustered into <italic toggle="yes">K</italic> clusters using K-means clustering, based on their expression on the <italic toggle="yes">p</italic> genes. By default, <inline-formula id="IE6"><mml:math id="IM6" display="inline" overflow="scroll"><mml:mrow><mml:mi>K</mml:mi><mml:mo>=</mml:mo><mml:msqrt><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:msqrt></mml:mrow></mml:math></inline-formula>, where <italic toggle="yes">n</italic><sub>0</sub> is the number of cells in the reference batch.</p>
    </sec>
    <sec>
      <title>2.3 Step 2: Marker gene identification</title>
      <p>In Step 2, for each of the <italic toggle="yes">K</italic> clusters in each batch, DE genes are identified by a two-sample <italic toggle="yes">t</italic>-test, with one group being cells in the cluster and the other group being the other cells (i.e. all the cells not in this cluster). The <italic toggle="yes">h</italic> (by default, <italic toggle="yes">h </italic>=<italic toggle="yes"> </italic>75) genes that are up-regulated with the smallest <italic toggle="yes">P</italic>-values are claimed as the ‘marker genes’ for the cluster.</p>
    </sec>
    <sec>
      <title>2.4 Step 3: Fisher’s exact test for cluster alignment</title>
      <p>For each cluster in the query batch (‘query cluster’ for short), Step 3 finds the cluster in the reference batch (‘reference cluster’ for short) that has the largest number of shared marker genes with it. These two clusters are called a ‘matched pair’. A <italic toggle="yes">P</italic>-value is assigned to each matched pair using a Fisher’s exact test. To be more specific, for each matched pair, a two-by-two contingency table is formed, with rows being whether a gene is in or not in the marker gene set of the query cluster and columns being whether a gene is in or not in the marker gene set of the reference cluster, and a <italic toggle="yes">P</italic>-value is given by a Fisher’s exact test on this contingency table.</p>
      <p>Note that not every matched pair is ‘good enough’ or ‘true’. Biologically, some cell types are only present in the query batch but not the reference, so they should not have a match in the reference batch. SCIBER takes this into account and only keeps a subset of matched pairs, called ‘putative matches’. SCIBER keeps the <italic toggle="yes">ω</italic> proportion of matched pairs with the smallest <italic toggle="yes">P</italic>-values. Here, <italic toggle="yes">ω</italic> is a user-specified pre-fixed parameter between 0 and 1, and it has a clear biological meaning: roughly speaking, it is the proportion of cells that are present in both the query and the reference batch. SCIBER sets <inline-formula id="IE7"><mml:math id="IM7" display="inline" overflow="scroll"><mml:mrow><mml:mo>ω</mml:mo><mml:mo>=</mml:mo><mml:mn>0.5</mml:mn></mml:mrow></mml:math></inline-formula> by default.</p>
    </sec>
    <sec>
      <title>2.5 Step 4: Projection of the query batch to the reference batch</title>
      <p>Step 4 projects gene expression from each query batch to the reference batch based on the putative matches. Here is how the projection is made for each query batch. First, we compute its centroid in the query cluster and its centroid in the reference cluster. Each centroid is a vector with length <italic toggle="yes">p</italic>, with element <italic toggle="yes">i</italic> being the average expression of gene <italic toggle="yes">i</italic> for cells in the cluster.</p>
      <p>Then, for each cell <inline-formula id="IE8"><mml:math id="IM8" display="inline" overflow="scroll"><mml:mrow><mml:mi>j</mml:mi><mml:mo>∈</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mi>b</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> in the query batch, no matter whether it is in a cluster that has a putatively matched cluster or in a cluster that does not, we decompose its expression <inline-formula id="IE9"><mml:math id="IM9" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mi>j</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>b</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> (on all genes, and so it is a length <italic toggle="yes">p</italic> vector) by a linear combination of the centroids of clusters that each have a putatively matched cluster. Let <inline-formula id="IE10"><mml:math id="IM10" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow><mml:mi>c</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>b</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> be a matrix whose columns are the centroids of clusters that each have a putatively matched cluster, where subscript <italic toggle="yes">c</italic> stands for ‘centroids’, and let <inline-formula id="IE11"><mml:math id="IM11" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow><mml:mi>c</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> be the corresponding matrix of the reference batch. The decomposition can be written as <inline-formula id="IE12"><mml:math id="IM12" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mrow><mml:mi>j</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>b</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow><mml:mi>c</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>b</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:msup><mml:mrow><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold-italic">β</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>b</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> with <inline-formula id="IE13"><mml:math id="IM13" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold-italic">β</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>b</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow><mml:mi>c</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>b</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mi>T</mml:mi></mml:msup><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow><mml:mi>c</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>b</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow><mml:mi>c</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>b</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mi>T</mml:mi></mml:msup><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mi>j</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>b</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula>. Here, <inline-formula id="IE14"><mml:math id="IM14" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mrow><mml:mi>j</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>b</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> is the fitted expression. After the decomposition, the projected data for cell <italic toggle="yes">j</italic> (i.e. batch-effect removed expression of cell <italic toggle="yes">j</italic>), denoted as <inline-formula id="IE15"><mml:math id="IM15" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo stretchy="false">˜</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mrow><mml:mi>j</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>b</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula>, is obtained by <inline-formula id="IE16"><mml:math id="IM16" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow><mml:mi>c</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:msup><mml:mrow><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold-italic">β</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>b</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>.</p>
      <p>The above description is for each cell. Actually, this decomposition and projection can be done simultaneously for all cells in a batch by using a single formula <inline-formula id="IE17"><mml:math id="IM17" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold-italic">X</mml:mi><mml:mo stretchy="false">˜</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>b</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow><mml:mi>c</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:msup><mml:mrow><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow><mml:mi>c</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>b</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mi>T</mml:mi></mml:msup><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow><mml:mi>c</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>b</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow><mml:mi>c</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>b</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mi>T</mml:mi></mml:msup><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>b</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>, where <inline-formula id="IE18"><mml:math id="IM18" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>b</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>and <inline-formula id="IE19"><mml:math id="IM19" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold-italic">X</mml:mi><mml:mo stretchy="false">˜</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>b</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>(without subscript <italic toggle="yes">c</italic>) are the raw and projected data matrices of batch <italic toggle="yes">b</italic>.</p>
      <p>SCIBER is publicly available as an R package <monospace>SCIBER</monospace> on CRAN.</p>
    </sec>
    <sec>
      <title>2.6 Some considerations regarding the algorithm</title>
      <p>Setting the number of clusters <italic toggle="yes">K</italic> for the clustering algorithm (e.g. K-means) is often difficult when clustering single-cell data. For one reason, the number of cell types present in the data is often unknown. Moreover, even if the number of cell types is known, using it as <italic toggle="yes">K</italic> may still give poor clustering results. This is because different cell types often have quite unbalanced numbers of cells and there may be outliers in the data, and clustering algorithms often do not handle unbalanced clusters and outliers perfectly. For example, K-means clustering is sensitive to outliers and tends to combine small clusters and divide large clusters (<xref rid="btac819-B14" ref-type="bibr">Hastie <italic toggle="yes">et al.</italic>, 2009</xref>; <xref rid="btac819-B48" ref-type="bibr">Tan <italic toggle="yes">et al.</italic>, 2016</xref>). Fortunately, this difficulty barely matters in the K-means clustering in step 1 of SCIBER. The aim of applying K-means clustering in SCIBER is to divide cells into many small groups; within each group, the expression of cells is highly similar. In fact, SCIBER wants the number of groups to be significantly larger than the number of cell types so that a large cell type can be divided into multiple clusters, resulting in multiple centroids in Step 4 for a ‘high-resolution’ decomposition, while outliers form clusters by themselves and can then be left out from the putative matches in Step 3. SCIBER sets <inline-formula id="IE20"><mml:math id="IM20" display="inline" overflow="scroll"><mml:mrow><mml:mi>K</mml:mi><mml:mo>=</mml:mo><mml:msqrt><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:msqrt></mml:mrow></mml:math></inline-formula> by default.</p>
      <p>Before figuring out the matching of cells (Step 3), SCIBER does all analyses, including the clustering in Step 1 and the DE analysis in Step 2, strictly separately for each batch. Any clustering or DE analysis on pooled data from multiple batches can be misled by batch effects.</p>
      <p>In Step 3, SCIBER only assigns a subset of matched pairs as putative matches. This takes care of the important fact that some cell types are not present in both the reference batch and the query batch.</p>
      <p>In Step 4, we use a simple linear model to project the query batch to the reference batch. We do not use a more complicated nonlinear model, such as a deep learning-based model or an ensemble decision tree, because a complicated model is not only often hard to tune and time-consuming to train but also likely to suffer from over-correction (<xref rid="btac819-B4" ref-type="bibr">Argelaguet <italic toggle="yes">et al.</italic>, 2021</xref>). On the contrary, our linear model has a closed-form solution without any tuning parameter, a high computational efficiency and a low risk of over-correction. Moreover, its linear nature can be highly appreciated when projecting cell types in the query batch that are absent in the reference batch. For example, if such a cell type lies in the very middle of two other cell types that are present in both the query and the reference batches, it will be decomposed as a combination of half and half from the two cell types, and in the corrected data, it will still be in the very middle of the two cell types. This is ‘interpolation’ in the linear model. Similarly, outliers will also be projected into appropriate locations by ‘extrapolation’ in the linear model.</p>
    </sec>
  </sec>
  <sec>
    <title>3 Results</title>
    <sec>
      <title>3.1 SCIBER removes batch effects effectively while preserving separation between cell types</title>
      <p>We apply SCIBER in all the eight real datasets used in the review paper by <xref rid="btac819-B49" ref-type="bibr">Tran <italic toggle="yes">et al.</italic> (2020)</xref>, except for a dataset from the human cell atlas, of which the cell type information is unavailable. This review paper systematically compared 14 batch-effect-removal methods from all the five categories on these real datasets. Their results show that Harmony (<xref rid="btac819-B21" ref-type="bibr">Korsunsky <italic toggle="yes">et al.</italic>, 2019</xref>), Seurat (v3) (<xref rid="btac819-B46" ref-type="bibr">Stuart <italic toggle="yes">et al.</italic>, 2019</xref>) and LIGER (<xref rid="btac819-B54" ref-type="bibr">Welch <italic toggle="yes">et al.</italic>, 2019</xref>) are the best methods in terms of accuracy. A summary of these eight datasets is given in <xref rid="btac819-T1" ref-type="table">Table 1</xref>, and details are given in <xref rid="sup1" ref-type="supplementary-material">Supplementary Material</xref>. It is worth noting that Dataset 5, which we downloaded from the review paper and contains 83 323 cells, is a subsampled dataset (the subsampling was done by the review paper) from the original dataset sequenced by <xref rid="btac819-B38" ref-type="bibr">Rosenberg <italic toggle="yes">et al.</italic> (2018)</xref> and <xref rid="btac819-B39" ref-type="bibr">Saunders <italic toggle="yes">et al.</italic> (2018)</xref>, which contains 833 206 cells.</p>
      <table-wrap position="float" id="btac819-T1">
        <label>Table 1.</label>
        <caption>
          <p>Description of the eight datasets on which the batch correction algorithms were tested</p>
        </caption>
        <table frame="hsides" rules="groups">
          <colgroup span="1">
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="char" char="." span="1"/>
            <col valign="top" align="center" span="1"/>
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="left" span="1"/>
          </colgroup>
          <thead>
            <tr>
              <th rowspan="1" colspan="1">No.</th>
              <th rowspan="1" colspan="1">Dataset</th>
              <th rowspan="1" colspan="1">No. of batches</th>
              <th rowspan="1" colspan="1">No. of cells</th>
              <th rowspan="1" colspan="1">Technologies</th>
              <th rowspan="1" colspan="1">References</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td rowspan="1" colspan="1">1</td>
              <td rowspan="1" colspan="1">Mouse cell atlas</td>
              <td rowspan="1" colspan="1">2</td>
              <td rowspan="1" colspan="1">6954</td>
              <td rowspan="1" colspan="1">Microwell-Seq Smart-Seq2</td>
              <td rowspan="1" colspan="1"><xref rid="btac819-B8" ref-type="bibr">Tabula Muris Consortium <italic toggle="yes">et al.</italic> (2018)</xref> and <xref rid="btac819-B12" ref-type="bibr">Han <italic toggle="yes">et al.</italic> (2018)</xref></td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">2</td>
              <td rowspan="1" colspan="1">Human PBMCs</td>
              <td rowspan="1" colspan="1">2</td>
              <td rowspan="1" colspan="1">15 476</td>
              <td rowspan="1" colspan="1">10× 3′ 10× 5′</td>
              <td rowspan="1" colspan="1">
                <xref rid="btac819-B60" ref-type="bibr">Zheng <italic toggle="yes">et al.</italic> (2017)</xref>
              </td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">3</td>
              <td rowspan="1" colspan="1">Human DCs</td>
              <td rowspan="1" colspan="1">2</td>
              <td rowspan="1" colspan="1">576</td>
              <td rowspan="1" colspan="1">Smart-Seq2</td>
              <td rowspan="1" colspan="1">
                <xref rid="btac819-B51" ref-type="bibr">Villani <italic toggle="yes">et al.</italic> (2017)</xref>
              </td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">4</td>
              <td rowspan="1" colspan="1">Mouse retina</td>
              <td rowspan="1" colspan="1">2</td>
              <td rowspan="1" colspan="1">71 638</td>
              <td rowspan="1" colspan="1">Drop-seq</td>
              <td rowspan="1" colspan="1"><xref rid="btac819-B27" ref-type="bibr">Macosko <italic toggle="yes">et al.</italic> (2015)</xref> and <xref rid="btac819-B42" ref-type="bibr">Shekhar <italic toggle="yes">et al.</italic> (2016)</xref></td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">5</td>
              <td rowspan="1" colspan="1">Mouse brain</td>
              <td rowspan="1" colspan="1">2</td>
              <td rowspan="1" colspan="1">83 323</td>
              <td rowspan="1" colspan="1">Drop-seq SPLIT-seq</td>
              <td rowspan="1" colspan="1"><xref rid="btac819-B38" ref-type="bibr">Rosenberg <italic toggle="yes">et al.</italic> (2018)</xref> and <xref rid="btac819-B39" ref-type="bibr">Saunders <italic toggle="yes">et al.</italic> (2018)</xref></td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">6</td>
              <td rowspan="1" colspan="1">Mouse HSPCs</td>
              <td rowspan="1" colspan="1">2</td>
              <td rowspan="1" colspan="1">4649</td>
              <td rowspan="1" colspan="1">MARS-seq Smart-Seq2</td>
              <td rowspan="1" colspan="1"><xref rid="btac819-B31" ref-type="bibr">Nestorowa <italic toggle="yes">et al.</italic> (2016)</xref> and <xref rid="btac819-B32" ref-type="bibr">Paul <italic toggle="yes">et al.</italic> (2015)</xref></td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">7</td>
              <td rowspan="1" colspan="1">Human pancreas</td>
              <td rowspan="1" colspan="1">5</td>
              <td rowspan="1" colspan="1">14 767</td>
              <td rowspan="1" colspan="1">inDrop CEL-Seq2 Smart-Seq2 SMARTer SMARTer</td>
              <td rowspan="1" colspan="1"><xref rid="btac819-B6" ref-type="bibr">Baron <italic toggle="yes">et al.</italic> (2016)</xref>, <xref rid="btac819-B30" ref-type="bibr">Muraro <italic toggle="yes">et al.</italic> (2016)</xref>, <xref rid="btac819-B40" ref-type="bibr">Segerstolpe <italic toggle="yes">et al.</italic> (2016)</xref>, <xref rid="btac819-B53" ref-type="bibr">Wang <italic toggle="yes">et al.</italic> (2016)</xref> and <xref rid="btac819-B55" ref-type="bibr">Xin <italic toggle="yes">et al.</italic> (2016)</xref></td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">8</td>
              <td rowspan="1" colspan="1">Cell line</td>
              <td rowspan="1" colspan="1">3</td>
              <td rowspan="1" colspan="1">9531</td>
              <td rowspan="1" colspan="1">10×</td>
              <td rowspan="1" colspan="1"><xref rid="btac819-B16" ref-type="bibr">Hie <italic toggle="yes">et al.</italic> (2019)</xref> and <xref rid="btac819-B60" ref-type="bibr">Zheng <italic toggle="yes">et al.</italic> (2017)</xref></td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <fn id="tblfn1">
            <p>PBMCs, peripheral blood mononuclear cells; DCs, dendritic cells; HSPCs, hematopoietic stem and progenitor cells.</p>
          </fn>
        </table-wrap-foot>
      </table-wrap>
      <p>The raw scRNA-seq data are normalized to remove the difference in sequencing depth and log-transformed to stabilize the variance. Then high-variable genes are identified for each batch, and genes that are not identified as high-variable in any of the batches are discarded. All of these pre-processing steps are conducted using the R package <italic toggle="yes">Seurat</italic> (<xref rid="btac819-B46" ref-type="bibr">Stuart <italic toggle="yes">et al.</italic>, 2019</xref>).</p>
      <p>When applying SCIBER, we use the default values of all the parameters: <inline-formula id="IE21"><mml:math id="IM21" display="inline" overflow="scroll"><mml:mrow><mml:mi>K</mml:mi><mml:mo>=</mml:mo><mml:msqrt><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:msqrt></mml:mrow></mml:math></inline-formula> in Step 1, <italic toggle="yes">h </italic>=<italic toggle="yes"> </italic>75 in Step 2 and <inline-formula id="IE22"><mml:math id="IM22" display="inline" overflow="scroll"><mml:mrow><mml:mo>ω</mml:mo><mml:mo>=</mml:mo><mml:mn>0.5</mml:mn></mml:mrow></mml:math></inline-formula> in Step 3. That is, a common set of parameter values are used for all datasets, and no tuning of parameters are involved.</p>
      <p>We compare the performance of SCIBER with the three state-of-the-art methods reported by the review paper (<xref rid="btac819-B49" ref-type="bibr">Tran <italic toggle="yes">et al.</italic>, 2020</xref>): Harmony, Seurat and LIGER. Details of how these algorithms are used are given in <xref rid="sup1" ref-type="supplementary-material">Supplementary Material</xref>.</p>
      <p>We use cLISI proposed by <xref rid="btac819-B21" ref-type="bibr">Korsunsky <italic toggle="yes">et al.</italic> (2019)</xref> as the numeric measure of performance. cLISI measures local cell-type purity: the idea is, in clear data, the cells should cluster according to the cell types, and thus the cell types in a cell’s neighbor should be quite ‘pure’. In <xref rid="sup1" ref-type="supplementary-material">Supplementary Material</xref>, we give the mathematical definition of cLISI and why a few other measures are less appropriate. Smaller cLISI values (values closer to 1.0) indicate higher local cell-type purities and are thus preferred.</p>
      <p>However, cLISI has its limitations in measuring performance (reasons given in <xref rid="sup1" ref-type="supplementary-material">Supplementary Material</xref>). We also plot the batch-effect corrected data into a 2D space using UMAP and check the plot visually. Such a 2D plot contains much more information than any single numeric summary statistic and gives a more comprehensive picture of the performance.</p>
      <p><xref rid="sup1" ref-type="supplementary-material">Supplementary Tables S1–S8</xref> give the cLISI scores for different methods in the eight datasets. The cell type cLISI score is the averaged cLISI score for a cell type, and the overall cLISI score is the average across the batch. We see that SCIBER performs comparably to the best performer of the other three methods in six out of the eight datasets, which is Seurat in some datasets and Harmony in the others, and significantly better than all the other three methods in the other two datasets (Datasets 3 and 6). <xref rid="btac819-F1" ref-type="fig">Figure 1</xref> and <xref rid="sup1" ref-type="supplementary-material">Supplementary Figures S1–S7</xref> give the UMAP plots of all the datasets. The overall impression from the UMAP plots is consistent with that from cLISI.</p>
      <fig position="float" id="btac819-F1">
        <label>Fig. 1.</label>
        <caption>
          <p>Scatter plots of cells from all batches of the human dendritic cell data (Dataset 3) on a 2D UMAP space. Different sub-plots show corrected data from different methods (from left to right: SCIBER, Harmony, Seurat and LIGER), as well as the raw (uncorrected) data. Cells in the first row of sub-plots are colored according to their batches, while cells in the second row are colored according to their actual cell types. It is clear that only SCIBER keeps CD141 and CD1C as two separated clusters, while the other three methods mix these two different cell types</p>
        </caption>
        <graphic xlink:href="btac819f1" position="float"/>
      </fig>
      <p>Here, we use the human dendritic cells dataset (Dataset 3) as an example. The two batches of this dataset contain four different types of human dendritic cells (DCs): pDC (CD11C<inline-formula id="IE23"><mml:math id="IM23" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mrow/><mml:mo>−</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula>CD123<inline-formula id="IE24"><mml:math id="IM24" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mrow/><mml:mo>+</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula> plasmacytoid DCs), DoubleNeg (CD11C<inline-formula id="IE25"><mml:math id="IM25" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mrow/><mml:mo>+</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula>CD141<inline-formula id="IE26"><mml:math id="IM26" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mrow/><mml:mo>−</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula>CD1C<inline-formula id="IE27"><mml:math id="IM27" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mrow/><mml:mo>−</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula> DC), CD141 (CD11C<inline-formula id="IE28"><mml:math id="IM28" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mrow/><mml:mo>+</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula>CD141<inline-formula id="IE29"><mml:math id="IM29" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mrow/><mml:mo>+</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula> DC) and CD1C (CD11C<inline-formula id="IE30"><mml:math id="IM30" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mrow/><mml:mo>+</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula>CD1C<inline-formula id="IE31"><mml:math id="IM31" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mrow/><mml:mo>+</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula> DC). Both Batches 1 and 2 contain 96 pDC cells and 96 DoubleNeg cells. Other than that, Batch 1 contains 96 CD141 cells, while Batch 2 contains 96 CD1C cells. Note that CD141 and CD1C are two cell types that are quite similar, so the main challenge in this dataset is to keep these two cell types separated while merging each of the other two cell types (pDC and DoubleNeg) from the two different batches. In this dataset, SCIBER achieves a much lower cLISI value (1.12) than those from the other methods (1.29 from Harmony, 1.43 from LIGER and 1.38 from Seurat). <xref rid="btac819-F1" ref-type="fig">Figure 1</xref> gives the 2D UMAP plots of the batch-effect corrected data from different methods, as well as the raw (i.e. uncorrected) data. Cells in the first row of sub-plots are colored according to their batches, and cells in the second row of sub-plots are colored according to the cell types they belong to. Ideally, the cells should be separated according to the cell type but not the batch. In the figure, this means that points of different colors in a plot in the second row (which denote different cell types) should form separate clusters, and at the same time, points of the same color in a plot in the second row (which denote the same cell type) should not form sub-clusters that each has a different color in the corresponding plot in the first row (which denote different batches). Following this guidance, we find that while all methods successfully keep pDC and DoubleNeg separated from other cell types, only SCIBER keeps CD141 and CD1C as two well-separated clusters. Meanwhile, Harmony, Seurat and LIGER mistakenly mix CD141 and CD1C, which indicates that they likely have incorrectly aligned cells from CD141 and CD1C. The success of SCIBER in separating CD141 and CD1C could be attributed to its disinterest in aligning all cell clusters across batches (Step 3 of the algorithm). Additionally, in LIGER, the CD1C cells are further divided into two sub-clusters, determined by which batch they come from, and one of the two sub-clusters is thoroughly mixed with the CD141 cells. Interestingly, the UMAP plots of the raw data indicate that batch effects in this data might be minor; it seems that methods other than SCIBER likely have misidentified a proportion of the differences between cell types as batch effects and removed them.</p>
      <p>A detailed discussion of results on the other datasets is available in <xref rid="sup1" ref-type="supplementary-material">Supplementary Material</xref>. Overall, as we have summarized, SCIBER shows similar and sometimes better, accuracy in removing batch effects. What’s more, SCIBER has clear advantages in its computational load, etc., which are discussed in the following sections.</p>
    </sec>
    <sec>
      <title>3.2 Computational efficiency of SCIBER</title>
      <p>As a simple algorithm, SCIBER is computationally more efficient than Harmony, LIGER and Seurat, and it scales to datasets with a large number of cells. To show this, we choose the original full data of the mouse brain data (Dataset 5). We down-sample the number of cells from 833 206 to 249 000, to 83 000, to 24 900, and finally, to 8300, and record the runtime of SCIBER on an eight-core machine with 2.50 GHz CPU and 16 GB RAM. The results are shown in <xref rid="btac819-F2" ref-type="fig">Figure 2</xref>. (There is no result for Seurat on the full dataset due to memory explosion.) We find that the computational time of SCIBER increases roughly linearly with the increase in the number of cells, although this could be a little hard to see from the figure, whose x-axis is on the log scale but y-axis is not. In general, SCIBER is 2.5 times faster than Harmony and LIGER, which in turn are much faster than Seurat.</p>
      <fig position="float" id="btac819-F2">
        <label>Fig. 2.</label>
        <caption>
          <p>Runtime of different methods on the full and the down-sampled mouse brain data (Dataset 5). The full dataset contains 833 206 cells, and it is down-sampled to smaller numbers of cells. The runtime of Seurat on the full dataset is missing as it was terminated for excessive memory requests. It is clear that SCIBER has a significantly shorter runtime than all the other three methods</p>
        </caption>
        <graphic xlink:href="btac819f2" position="float"/>
      </fig>
    </sec>
    <sec>
      <title>3.3 SCIBER keeps the reference batch untouched while projecting query batches</title>
      <p>As a reference-based method, SCIBER does not change the reference batch when removing batch effects from the query batches. This facilitates adding additional batches: when the additional batches are added, all downstream analyses on the reference batch, such as visualization (dimension reduction), differential expression analysis, regulatory network construction and pseudotime analysis, will remain unchanged.</p>
      <p>Using visualization as an example, <xref rid="btac819-F3" ref-type="fig">Figure 3</xref> demonstrates this point on the human pancreas data (Dataset 7), which contains human pancreas cells from five batches. We use the batch with the largest number of cells as the reference batch and integrate it with different numbers of other batches. As the plot shows, as new query batches are added, the reference batch will not change, as well as the query batches that already have been integrated.</p>
      <fig position="float" id="btac819-F3">
        <label>Fig. 3.</label>
        <caption>
          <p>Multiple batch projection using UMAP visualization for the human pancreas data (Dataset 7). Cells in the first row of sub-plots are colored according to batch labels, while cells in the second row are colored according to cell type labels. The leftmost plots show the reference batch only, and the other plots from left to right show the batch-effect removed data when more batches are integrated by SCIBER. It is clear that the reference batch does not change when new batches are integrated</p>
        </caption>
        <graphic xlink:href="btac819f3" position="float"/>
      </fig>
    </sec>
    <sec>
      <title>3.4 SCIBER facilitates downstream analyses</title>
      <p>The batch-effect corrected data obtained by SCIBER are the expression of individual genes, which can be directly used for downstream analyses. Here, we use pseudotime analysis and marker gene analysis on the human hematopoietic stem and progenitor cell data (Dataset 6) as an example. This dataset contains mouse hematopoietic stem and progenitor cells from two batches. Each batch contains common myeloid progenitor (CMP) cells, megakaryocyte–erythrocyte progenitor (MEP) cells, granulocyte–monocyte progenitor (GMP) cells and a few other types of cells. Biologically, these three cell types are of particular interest: CMPs may differentiate into either GMPs or MEPs, which form the cells of the granulocyte/macrophage or megakaryocyte/erythroid lineages, respectively (<xref rid="btac819-B1" ref-type="bibr">Akashi <italic toggle="yes">et al.</italic>, 2000</xref>). In the expression data, the clustering of cells is expected to reflect this developmental lineage, with GMPs and MEPs forming their respective clusters that are both close to CMPs (<xref rid="btac819-B11" ref-type="bibr">Haghverdi <italic toggle="yes">et al.</italic>, 2018</xref>). However, in the raw data, the cells are clustered mainly according to the batches they come from instead of their cell types (see the last column of sub-plots in <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S5</xref>). This incorrect clustering is largely corrected by removing batch effects using any of the four methods, as shown in <xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S5</xref>, indicating the success of these four methods. However, SCIBER is the only method among them that outputs the expression of individual genes.</p>
      <p>We pool the batch-effect corrected data by SCIBER from all batches and conduct a pseudotime analysis with R package <italic toggle="yes">monocle</italic> (<xref rid="btac819-B50" ref-type="bibr">Trapnell <italic toggle="yes">et al.</italic>, 2014</xref>). The result is shown in <xref rid="btac819-F4" ref-type="fig">Figure 4 A</xref>, where each point corresponds to a cell, with its shape (circle, cross or diamond) representing the cell type and color representing the inferred pseudotime. It is clear that the cells form two branches, both starting at the CMP (the blue circles in the middle), one ending at GMP (yellow crosses on the left) and the other ending at MEP (red diamonds on the right). This correctly reflects the lineage. On the contrary, results from the same analysis in the raw data (<xref rid="btac819-F4" ref-type="fig">Fig. 4B</xref>) contradict the biological fact. For example, the MEPs (diamonds), which are supposed to have large pseudotime values, form two groups, one (blue diamonds, on the top left) having very small pseudotime and the other having very large pseudotime (red diamonds, on the bottom left).</p>
      <fig position="float" id="btac819-F4">
        <label>Fig. 4.</label>
        <caption>
          <p>Pseudotime and marker gene expression on the mouse hematopoietic stem and progenitor cell data (Dataset 6). (<bold>A</bold>) Inferred pseudotime from output data of SCIBER. Each point represents a cell. The point types represent cell types, and the colors represent the inferred pseudotime. Starting from the top blue colored cells, there are two clear branches. (<bold>B</bold>) Inferred pseudotime from the raw data. The triangle points are broken into two far apart clusters, one in blue color and the other in red color. (<bold>C, D</bold>) The expression of gene Itga2b based on (C) the output data of SCIBER and (D) the raw data. According to the annotation database, this gene is a marker gene for both cell types CMP and GMP, but not a marker gene for MEP. The points are colored according to their actual cell types and are arranged from left to right according to the inferred pseudotime. The black curves are the fitted expression level along the pseudotime. In (C), most CMPs appear at the very beginning, GMPs appear in the middle, and MEPs appear at last. Also, the black curve shows a sudden drop, indicating a much lower expression level in MEPs compared to CMPs and GMPs. In (D), such an ordered arrangement of different cell types and a drop in expression are not observed</p>
        </caption>
        <graphic xlink:href="btac819f4" position="float"/>
      </fig>
      <p>We further investigate how the expression of marker genes of these three cell types changes as a function of pseudotime. We use marker genes defined in the <italic toggle="yes">CellMarker</italic> database (<xref rid="btac819-B58" ref-type="bibr">Zhang <italic toggle="yes">et al.</italic>, 2019b</xref>). <xref rid="btac819-F4" ref-type="fig">Figure 4C</xref> shows the expression of gene Itga2b on the batch-effect corrected data along the inferred pseudotime (x-axis). In the plot, each point represents a cell, with different colors presenting different cell types, and the black curve is the fitted (averaged and smoothed) expression level. We notice that most red points (CMPs) appear at the very beginning, green points (GMPs) appear in the middle, and blue points (MEPs) appear at last. This is consistent with the two branches observed in <xref rid="btac819-F4" ref-type="fig">Figure 4A</xref>. Moreover, the black curve has a drastic drop as MEPs appear, indicating a much lower expression in MEPs. This reflects the biological truth: this gene is a marker gene (actually the only marker gene of this type in the <italic toggle="yes">CellMarker</italic> database) that is common for CMPs and GMPs but not for MEPs. <xref rid="btac819-F4" ref-type="fig">Figure 4D</xref> shows the expression of Itga2b on the raw data, where its drop in MEPs has been distorted by batch effects. <xref rid="sup1" ref-type="supplementary-material">Supplementary Figures S8–S11</xref> give plots for marker genes of other types, in which we have similar observations.</p>
    </sec>
  </sec>
  <sec>
    <title>4 Discussion</title>
    <p>We have presented SCIBER, a simple algorithm that removes batch effects from scRNA-seq data in a computationally efficient manner. While its accuracy is similar to, and sometimes better than, the state-of-the-arts, its ability to output expression data at the gene level facilitates follow-up analyses, and its reference-based nature makes it especially suitable for mapping data to standard reference datasets.</p>
    <p>Unlike existing algorithms, SCIBER identifies matched cell clusters across batches according to DE genes. The four steps of the SCIBER algorithm rely on simple algorithms and/or tests, which do not impose strong assumptions on the distribution of the data or the shape of each cluster. (Although K-means clustering implicitly assumes each cluster has a round shape with similar sizes, SCIBER uses a large <italic toggle="yes">K</italic>, which breaks up large clusters and hence accommodates virtually any shape for the cell types.) The simplicity of the algorithm also makes it computationally fast. In our current implementation of SCIBER, the most time-consuming step is K-means clustering, and thus SCIBER can be further accelerated by replacing K-means with a more efficient clustering algorithm or using a more efficient implementation of K-means.</p>
    <p>The SCIBER algorithm has three parameters: the number of clusters <italic toggle="yes">K</italic> in Step 1, the number of marker genes <italic toggle="yes">h</italic> in Step 2 and the proportion of matched clusters <italic toggle="yes">ω</italic> in Step 3. In Section 3, we have shown that no tuning of these parameters is needed for all the datasets we consider and the default values work well. To confirm the insensitivity of our method to the tuning parameters, we systematically study the effect of these tuning parameters. The results of different values of <italic toggle="yes">K</italic> (<inline-formula id="IE32"><mml:math id="IM32" display="inline" overflow="scroll"><mml:mrow><mml:mn>0.8</mml:mn><mml:msqrt><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:msqrt><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:msqrt><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:msqrt></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE33"><mml:math id="IM33" display="inline" overflow="scroll"><mml:mrow><mml:mn>1.2</mml:mn><mml:msqrt><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:msqrt></mml:mrow></mml:math></inline-formula>), <italic toggle="yes">h</italic> (50, 75 and 100) and <italic toggle="yes">ω</italic> (0.4, 0.5, 0.6 and 0.7) in all the eight datasets we consider are shown in <xref rid="sup1" ref-type="supplementary-material">Supplementary Tables S9–S11</xref>. It is clear that the performance of SCIBER changes little under different values of the parameters.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="sup1" position="float" content-type="local-data">
      <label>btac819_Supplementary_Data</label>
      <media xlink:href="btac819_supplementary_data.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack id="ack1">
    <title>Acknowledgement</title>
    <p>We thank Zixuan Song for proofreading the manuscript.</p>
    <sec>
      <title>Funding</title>
      <p>This work was supported by the National Institutes of Health [R01CA252878 and R01CA222405] and the DOD BCRP Breakthrough Award, Level 2 [W81XWH2110432] to J.L.</p>
      <p><italic toggle="yes">Conflict of Interest</italic>: none declared.</p>
    </sec>
  </ack>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="btac819-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Akashi</surname><given-names>K.</given-names></string-name></person-group><etal>et al</etal> (<year>2000</year>) <article-title>A clonogenic common myeloid progenitor that gives rise to all myeloid lineages</article-title>. <source>Nature</source>, <volume>404</volume>, <fpage>193</fpage>–<lpage>197</lpage>.<pub-id pub-id-type="pmid">10724173</pub-id></mixed-citation>
    </ref>
    <ref id="btac819-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Amodio</surname><given-names>M.</given-names></string-name></person-group><etal>et al</etal> (<year>2019</year>) <article-title>Exploring single-cell data with deep multitasking neural networks</article-title>. <source>Nat. Methods</source>, <volume>16</volume>, <fpage>1139</fpage>–<lpage>1145</lpage>.<pub-id pub-id-type="pmid">31591579</pub-id></mixed-citation>
    </ref>
    <ref id="btac819-B3">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Andersen</surname><given-names>R.</given-names></string-name></person-group><etal>et al</etal> (<year>2006</year>) Local graph partitioning using pagerank vectors. In: <italic toggle="yes">2006 47th Annual IEEE Symposium on Foundations of Computer Science (FOCS’06)</italic>, Berkeley, CA, pp. <fpage>475</fpage>–<lpage>486</lpage>. IEEE.</mixed-citation>
    </ref>
    <ref id="btac819-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Argelaguet</surname><given-names>R.</given-names></string-name></person-group><etal>et al</etal> (<year>2021</year>) <article-title>Computational principles and challenges in single-cell data integration</article-title>. <source>Nat. Biotechnol</source>., <volume>39</volume>, <fpage>1202</fpage>–<lpage>1215</lpage>.<pub-id pub-id-type="pmid">33941931</pub-id></mixed-citation>
    </ref>
    <ref id="btac819-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Barkas</surname><given-names>N.</given-names></string-name></person-group><etal>et al</etal> (<year>2019</year>) <article-title>Joint analysis of heterogeneous single-cell RNA-seq dataset collections</article-title>. <source>Nat. Methods</source>, <volume>16</volume>, <fpage>695</fpage>–<lpage>698</lpage>.<pub-id pub-id-type="pmid">31308548</pub-id></mixed-citation>
    </ref>
    <ref id="btac819-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Baron</surname><given-names>M.</given-names></string-name></person-group><etal>et al</etal> (<year>2016</year>) <article-title>A single-cell transcriptomic map of the human and mouse pancreas reveals inter- and intra-cell population structure</article-title>. <source>Cell Syst</source>., <volume>3</volume>, <fpage>346</fpage>–<lpage>360.e4</lpage>.<pub-id pub-id-type="pmid">27667365</pub-id></mixed-citation>
    </ref>
    <ref id="btac819-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Cao</surname><given-names>J.</given-names></string-name></person-group><etal>et al</etal> (<year>2017</year>) <article-title>Comprehensive single-cell transcriptional profiling of a multicellular organism</article-title>. <source>Science</source>, <volume>357</volume>, <fpage>661</fpage>–<lpage>667</lpage>.<pub-id pub-id-type="pmid">28818938</pub-id></mixed-citation>
    </ref>
    <ref id="btac819-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Fan</surname><given-names>J.</given-names></string-name></person-group><etal>et al</etal> (<year>2020</year>) <article-title>Single-cell transcriptomics in cancer: computational challenges and opportunities</article-title>. <source>Exp. Mol. Med</source>., <volume>52</volume>, <fpage>1452</fpage>–<lpage>1465</lpage>.<pub-id pub-id-type="pmid">32929226</pub-id></mixed-citation>
    </ref>
    <ref id="btac819-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Forcato</surname><given-names>M.</given-names></string-name></person-group><etal>et al</etal> (<year>2021</year>) <article-title>Computational methods for the integrative analysis of single-cell data</article-title>. <source>Brief. Bioinform</source>., <volume>22</volume>, <fpage>20</fpage>–<lpage>29</lpage>.<pub-id pub-id-type="pmid">32363378</pub-id></mixed-citation>
    </ref>
    <ref id="btac819-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Haghverdi</surname><given-names>L.</given-names></string-name></person-group><etal>et al</etal> (<year>2018</year>) <article-title>Batch effects in single-cell RNA-sequencing data are corrected by matching mutual nearest neighbors</article-title>. <source>Nat. Biotechnol</source>., <volume>36</volume>, <fpage>421</fpage>–<lpage>427</lpage>.<pub-id pub-id-type="pmid">29608177</pub-id></mixed-citation>
    </ref>
    <ref id="btac819-B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Han</surname><given-names>X.</given-names></string-name></person-group><etal>et al</etal> (<year>2018</year>) <article-title>Mapping the mouse cell atlas by Microwell-seq</article-title>. <source>Cell</source>, <volume>172</volume>, <fpage>1091</fpage>–<lpage>1107.e17</lpage>.<pub-id pub-id-type="pmid">29474909</pub-id></mixed-citation>
    </ref>
    <ref id="btac819-B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hashimshony</surname><given-names>T.</given-names></string-name></person-group><etal>et al</etal> (<year>2012</year>) <article-title>CEL-Seq: single-cell RNA-seq by multiplexed linear amplification</article-title>. <source>Cell Rep</source>., <volume>2</volume>, <fpage>666</fpage>–<lpage>673</lpage>.<pub-id pub-id-type="pmid">22939981</pub-id></mixed-citation>
    </ref>
    <ref id="btac819-B13">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Hastie</surname><given-names>T.</given-names></string-name></person-group><etal>et al</etal> (<year>2009</year>) <source>The Elements of Statistical Learning: Data Mining, Inference, and Prediction</source>, Vol. 2. <publisher-name>Springer, New York</publisher-name>.</mixed-citation>
    </ref>
    <ref id="btac819-B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hicks</surname><given-names>S.C.</given-names></string-name></person-group><etal>et al</etal> (<year>2018</year>) <article-title>Missing data and technical variability in single-cell RNA-sequencing experiments</article-title>. <source>Biostatistics</source>, <volume>19</volume>, <fpage>562</fpage>–<lpage>578</lpage>.<pub-id pub-id-type="pmid">29121214</pub-id></mixed-citation>
    </ref>
    <ref id="btac819-B15">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hie</surname><given-names>B.</given-names></string-name></person-group><etal>et al</etal> (<year>2019</year>) <article-title>Efficient integration of heterogeneous single-cell transcriptomes using scanorama</article-title>. <source>Nat. Biotechnol</source>., <volume>37</volume>, <fpage>685</fpage>–<lpage>691</lpage>.<pub-id pub-id-type="pmid">31061482</pub-id></mixed-citation>
    </ref>
    <ref id="btac819-B16">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Johansen</surname><given-names>N.</given-names></string-name>, <string-name><surname>Quon</surname><given-names>G.</given-names></string-name></person-group> (<year>2019</year>) <article-title>Scalign: a tool for alignment, integration, and rare cell identification from scRNA-seq data</article-title>. <source>Genome Biol</source>., <volume>20</volume>, <fpage>1</fpage>–<lpage>21</lpage>.<pub-id pub-id-type="pmid">30606230</pub-id></mixed-citation>
    </ref>
    <ref id="btac819-B17">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Johnson</surname><given-names>W.E.</given-names></string-name></person-group><etal>et al</etal> (<year>2007</year>) <article-title>Adjusting batch effects in microarray expression data using empirical bayes methods</article-title>. <source>Biostatistics</source>, <volume>8</volume>, <fpage>118</fpage>–<lpage>127</lpage>.<pub-id pub-id-type="pmid">16632515</pub-id></mixed-citation>
    </ref>
    <ref id="btac819-B18">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kang</surname><given-names>H.M.</given-names></string-name></person-group><etal>et al</etal> (<year>2018</year>) <article-title>Multiplexed droplet single-cell RNA-sequencing using natural genetic variation</article-title>. <source>Nat. Biotechnol</source>., <volume>36</volume>, <fpage>89</fpage>–<lpage>94</lpage>.<pub-id pub-id-type="pmid">29227470</pub-id></mixed-citation>
    </ref>
    <ref id="btac819-B19">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Klein</surname><given-names>A.M.</given-names></string-name></person-group><etal>et al</etal> (<year>2015</year>) <article-title>Droplet barcoding for single-cell transcriptomics applied to embryonic stem cells</article-title>. <source>Cell</source>, <volume>161</volume>, <fpage>1187</fpage>–<lpage>1201</lpage>.<pub-id pub-id-type="pmid">26000487</pub-id></mixed-citation>
    </ref>
    <ref id="btac819-B20">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Korsunsky</surname><given-names>I.</given-names></string-name></person-group><etal>et al</etal> (<year>2019</year>) <article-title>Fast, sensitive and accurate integration of single-cell data with harmony</article-title>. <source>Nat. Methods</source>, <volume>16</volume>, <fpage>1289</fpage>–<lpage>1296</lpage>.<pub-id pub-id-type="pmid">31740819</pub-id></mixed-citation>
    </ref>
    <ref id="btac819-B21">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Leek</surname><given-names>J.T.</given-names></string-name></person-group><etal>et al</etal> (<year>2010</year>) <article-title>Tackling the widespread and critical impact of batch effects in high-throughput data</article-title>. <source>Nat. Rev. Genet</source>., <volume>11</volume>, <fpage>733</fpage>–<lpage>739</lpage>.<pub-id pub-id-type="pmid">20838408</pub-id></mixed-citation>
    </ref>
    <ref id="btac819-B22">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lin</surname><given-names>Y.</given-names></string-name></person-group><etal>et al</etal> (<year>2019</year>) <article-title>Scmerge leverages factor analysis, stable expression, and pseudoreplication to merge multiple single-cell RNA-seq datasets</article-title>. <source>Proc. Natl. Acad. Sci. USA</source>, <volume>116</volume>, <fpage>9775</fpage>–<lpage>9784</lpage>.<pub-id pub-id-type="pmid">31028141</pub-id></mixed-citation>
    </ref>
    <ref id="btac819-B23">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lopez</surname><given-names>R.</given-names></string-name></person-group><etal>et al</etal> (<year>2018</year>) <article-title>Deep generative modeling for single-cell transcriptomics</article-title>. <source>Nat. Methods</source>, <volume>15</volume>, <fpage>1053</fpage>–<lpage>1058</lpage>.<pub-id pub-id-type="pmid">30504886</pub-id></mixed-citation>
    </ref>
    <ref id="btac819-B24">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lotfollahi</surname><given-names>M.</given-names></string-name></person-group><etal>et al</etal> (<year>2019</year>) s<article-title>cGen predicts single-cell perturbation responses</article-title>. <source>Nat. Methods</source>, <volume>16</volume>, <fpage>715</fpage>–<lpage>721</lpage>.<pub-id pub-id-type="pmid">31363220</pub-id></mixed-citation>
    </ref>
    <ref id="btac819-B25">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Lun</surname><given-names>A.</given-names></string-name></person-group> (<year>2019</year>) Further MNN Algorithm Development. Github repository, <ext-link xlink:href="https://marionilab.github.io/FurtherMNN2018/theory/description.html" ext-link-type="uri">https://marionilab.github.io/FurtherMNN2018/theory/description.html</ext-link>.</mixed-citation>
    </ref>
    <ref id="btac819-B26">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Macosko</surname><given-names>E.Z.</given-names></string-name></person-group><etal>et al</etal> (<year>2015</year>) <article-title>Highly parallel genome-wide expression profiling of individual cells using nanoliter droplets</article-title>. <source>Cell</source>, <volume>161</volume>, <fpage>1202</fpage>–<lpage>1214</lpage>.<pub-id pub-id-type="pmid">26000488</pub-id></mixed-citation>
    </ref>
    <ref id="btac819-B27">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>McGinnis</surname><given-names>C.S.</given-names></string-name></person-group><etal>et al</etal> (<year>2019</year>) <article-title>Multi-seq: sample multiplexing for single-cell RNA sequencing using lipid-tagged indices</article-title>. <source>Nat. Methods</source>, <volume>16</volume>, <fpage>619</fpage>–<lpage>626</lpage>.<pub-id pub-id-type="pmid">31209384</pub-id></mixed-citation>
    </ref>
    <ref id="btac819-B28">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>McInnes</surname><given-names>L.</given-names></string-name></person-group><etal>et al</etal> (<year>2018</year>) UMAP: uniform manifold approximation and projection for dimension reduction. <italic toggle="yes">arXiv preprint arXiv:1802.03426.</italic></mixed-citation>
    </ref>
    <ref id="btac819-B29">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Muraro</surname><given-names>M.J.</given-names></string-name></person-group><etal>et al</etal> (<year>2016</year>) <article-title>A single-cell transcriptome atlas of the human pancreas</article-title>. <source>Cell Syst</source>., <volume>3</volume>, <fpage>385</fpage>–<lpage>394.e3</lpage>.<pub-id pub-id-type="pmid">27693023</pub-id></mixed-citation>
    </ref>
    <ref id="btac819-B30">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Nestorowa</surname><given-names>S.</given-names></string-name></person-group><etal>et al</etal> (<year>2016</year>) <article-title>A single-cell resolution map of mouse hematopoietic stem and progenitor cell differentiation</article-title>. <source>Blood</source>, <volume>128</volume>, <fpage>e20</fpage>–<lpage>e31</lpage>.<pub-id pub-id-type="pmid">27365425</pub-id></mixed-citation>
    </ref>
    <ref id="btac819-B31">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Paul</surname><given-names>F.</given-names></string-name></person-group><etal>et al</etal> (<year>2015</year>) <article-title>Transcriptional heterogeneity and lineage commitment in myeloid progenitors</article-title>. <source>Cell</source>, <volume>163</volume>, <fpage>1663</fpage>–<lpage>1677</lpage>.<pub-id pub-id-type="pmid">26627738</pub-id></mixed-citation>
    </ref>
    <ref id="btac819-B32">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Picelli</surname><given-names>S.</given-names></string-name></person-group><etal>et al</etal> (<year>2014</year>) <article-title>Full-length RNA-seq from single cells using smart-seq2</article-title>. <source>Nat. Protoc</source>., <volume>9</volume>, <fpage>171</fpage>–<lpage>181</lpage>.<pub-id pub-id-type="pmid">24385147</pub-id></mixed-citation>
    </ref>
    <ref id="btac819-B33">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Polański</surname><given-names>K.</given-names></string-name></person-group><etal>et al</etal> (<year>2020</year>) <article-title>BBKNN: fast batch alignment of single cell transcriptomes</article-title>. <source>Bioinformatics</source>, <volume>36</volume>, <fpage>964</fpage>–<lpage>965</lpage>.<pub-id pub-id-type="pmid">31400197</pub-id></mixed-citation>
    </ref>
    <ref id="btac819-B34">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ramsköld</surname><given-names>D.</given-names></string-name></person-group><etal>et al</etal> (<year>2012</year>) <article-title>Full-length mRNA-seq from single-cell levels of RNA and individual circulating tumor cells</article-title>. <source>Nat. Biotechnol</source>., <volume>30</volume>, <fpage>777</fpage>–<lpage>782</lpage>.<pub-id pub-id-type="pmid">22820318</pub-id></mixed-citation>
    </ref>
    <ref id="btac819-B35">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Regev</surname><given-names>A.</given-names></string-name></person-group><etal>et al</etal>; <collab>Human Cell Atlas Meeting Participants</collab>. (<year>2017</year>) <article-title>Science forum: the human cell atlas</article-title>. <source>elife</source>, <volume>6</volume>, <fpage>e27041</fpage>.<pub-id pub-id-type="pmid">29206104</pub-id></mixed-citation>
    </ref>
    <ref id="btac819-B36">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Risso</surname><given-names>D.</given-names></string-name></person-group><etal>et al</etal> (<year>2018</year>) <article-title>A general and flexible method for signal extraction from single-cell RNA-seq data</article-title>. <source>Nat. Commun</source>., <volume>9</volume>, <fpage>1</fpage>–<lpage>17</lpage>.<pub-id pub-id-type="pmid">29317637</pub-id></mixed-citation>
    </ref>
    <ref id="btac819-B37">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Rosenberg</surname><given-names>A.B.</given-names></string-name></person-group><etal>et al</etal> (<year>2018</year>) <article-title>Single-cell profiling of the developing mouse brain and spinal cord with split-pool barcoding</article-title>. <source>Science</source>, <volume>360</volume>, <fpage>176</fpage>–<lpage>182</lpage>.<pub-id pub-id-type="pmid">29545511</pub-id></mixed-citation>
    </ref>
    <ref id="btac819-B38">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Saunders</surname><given-names>A.</given-names></string-name></person-group><etal>et al</etal> (<year>2018</year>) <article-title>Molecular diversity and specializations among the cells of the adult mouse brain</article-title>. <source>Cell</source>, <volume>174</volume>, <fpage>1015</fpage>–<lpage>1030.e16</lpage>.<pub-id pub-id-type="pmid">30096299</pub-id></mixed-citation>
    </ref>
    <ref id="btac819-B39">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Segerstolpe</surname><given-names>Å.</given-names></string-name></person-group><etal>et al</etal> (<year>2016</year>) <article-title>Single-cell transcriptome profiling of human pancreatic islets in health and type 2 diabetes</article-title>. <source>Cell Metab</source>., <volume>24</volume>, <fpage>593</fpage>–<lpage>607</lpage>.<pub-id pub-id-type="pmid">27667667</pub-id></mixed-citation>
    </ref>
    <ref id="btac819-B40">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Shaham</surname><given-names>U.</given-names></string-name></person-group><etal>et al</etal> (<year>2017</year>) <article-title>Removal of batch effects using distribution-matching residual networks</article-title>. <source>Bioinformatics</source>, <volume>33</volume>, <fpage>2539</fpage>–<lpage>2546</lpage>.<pub-id pub-id-type="pmid">28419223</pub-id></mixed-citation>
    </ref>
    <ref id="btac819-B41">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Shekhar</surname><given-names>K.</given-names></string-name></person-group><etal>et al</etal> (<year>2016</year>) <article-title>Comprehensive classification of retinal bipolar neurons by single-cell transcriptomics</article-title>. <source>Cell</source>, <volume>166</volume>, <fpage>1308</fpage>–<lpage>1323.e30</lpage>.<pub-id pub-id-type="pmid">27565351</pub-id></mixed-citation>
    </ref>
    <ref id="btac819-B42">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Silverman</surname><given-names>J.D.</given-names></string-name></person-group><etal>et al</etal> (<year>2020</year>) <article-title>Naught all zeros in sequence count data are the same</article-title>. <source>Comput. Struct. Biotechnol. J</source>., <volume>18</volume>, <fpage>2789</fpage>–<lpage>2798</lpage>.<pub-id pub-id-type="pmid">33101615</pub-id></mixed-citation>
    </ref>
    <ref id="btac819-B43">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Smyth</surname><given-names>G.K.</given-names></string-name>, <string-name><surname>Speed</surname><given-names>T.</given-names></string-name></person-group> (<year>2003</year>) <article-title>Normalization of cdna microarray data</article-title>. <source>Methods</source>, <volume>31</volume>, <fpage>265</fpage>–<lpage>273</lpage>.<pub-id pub-id-type="pmid">14597310</pub-id></mixed-citation>
    </ref>
    <ref id="btac819-B44">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Stegle</surname><given-names>O.</given-names></string-name></person-group><etal>et al</etal> (<year>2015</year>) <article-title>Computational and analytical challenges in single-cell transcriptomics</article-title>. <source>Nat. Rev. Genet</source>., <volume>16</volume>, <fpage>133</fpage>–<lpage>145</lpage>.<pub-id pub-id-type="pmid">25628217</pub-id></mixed-citation>
    </ref>
    <ref id="btac819-B45">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Stuart</surname><given-names>T.</given-names></string-name></person-group><etal>et al</etal> (<year>2019</year>) <article-title>Comprehensive integration of single-cell data</article-title>. <source>Cell</source>, <volume>177</volume>, <fpage>1888</fpage>–<lpage>1902.e21</lpage>.<pub-id pub-id-type="pmid">31178118</pub-id></mixed-citation>
    </ref>
    <ref id="btac819-B46">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Svensson</surname><given-names>V.</given-names></string-name></person-group> (<year>2020</year>) <article-title>Droplet scRNA-seq is not zero-inflated</article-title>. <source>Nat. Biotechnol</source>., <volume>38</volume>, <fpage>147</fpage>–<lpage>150</lpage>.<pub-id pub-id-type="pmid">31937974</pub-id></mixed-citation>
    </ref>
    <ref id="btac819-B47">
      <mixed-citation publication-type="journal"><collab>Tabula Muris Consortium</collab>, <etal>et al</etal> (<year>2018</year>) <article-title>Single-cell transcriptomics of 20 mouse organs creates a tabula muris</article-title>. <source>Nature</source>, <volume>562</volume>, <fpage>367</fpage>.<pub-id pub-id-type="pmid">30283141</pub-id></mixed-citation>
    </ref>
    <ref id="btac819-B48">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Tan</surname><given-names>P-.N.</given-names></string-name></person-group><etal>et al</etal> (<year>2016</year>) <source>Introduction to Data Mining</source>. <publisher-name>Pearson Education India, Delhi</publisher-name>.</mixed-citation>
    </ref>
    <ref id="btac819-B49">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Tran</surname><given-names>HT.N.</given-names></string-name></person-group><etal>et al</etal> (<year>2020</year>) <article-title>A benchmark of batch-effect correction methods for single-cell RNA sequencing data</article-title>. <source>Genome Biol</source>., <volume>21</volume>, <fpage>1</fpage>–<lpage>32</lpage>.</mixed-citation>
    </ref>
    <ref id="btac819-B50">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Trapnell</surname><given-names>C.</given-names></string-name></person-group><etal>et al</etal> (<year>2014</year>) <article-title>The dynamics and regulators of cell fate decisions are revealed by pseudotemporal ordering of single cells</article-title>. <source>Nat. Biotechnol</source>., <volume>32</volume>, <fpage>381</fpage>–<lpage>386</lpage>.<pub-id pub-id-type="pmid">24658644</pub-id></mixed-citation>
    </ref>
    <ref id="btac819-B51">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Villani</surname><given-names>A.-C.</given-names></string-name></person-group><etal>et al</etal> (<year>2017</year>) <article-title>Single-cell RNA-seq reveals new types of human blood dendritic cells, monocytes, and progenitors</article-title>. <source>Science</source>, <volume>356</volume>,</mixed-citation>
    </ref>
    <ref id="btac819-B52">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wang</surname><given-names>Y.</given-names></string-name></person-group><etal>et al</etal> (<year>2019</year>) <article-title>Subpopulation detection and their comparative analysis across single-cell experiments with scpopcorn</article-title>. <source>Cell Syst</source>., <volume>8</volume>, <fpage>506</fpage>–<lpage>513.e5</lpage>.<pub-id pub-id-type="pmid">31229559</pub-id></mixed-citation>
    </ref>
    <ref id="btac819-B53">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wang</surname><given-names>Y.J.</given-names></string-name></person-group><etal>et al</etal> (<year>2016</year>) <article-title>Single-cell transcriptomics of the human endocrine pancreas</article-title>. <source>Diabetes</source>, <volume>65</volume>, <fpage>3028</fpage>–<lpage>3038</lpage>.<pub-id pub-id-type="pmid">27364731</pub-id></mixed-citation>
    </ref>
    <ref id="btac819-B54">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Welch</surname><given-names>J.D.</given-names></string-name></person-group><etal>et al</etal> (<year>2019</year>) <article-title>Single-cell multi-omic integration compares and contrasts features of brain cell identity</article-title>. <source>Cell</source>, <volume>177</volume>, <fpage>1873</fpage>–<lpage>1887.e17</lpage>.<pub-id pub-id-type="pmid">31178122</pub-id></mixed-citation>
    </ref>
    <ref id="btac819-B55">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Xin</surname><given-names>Y.</given-names></string-name></person-group><etal>et al</etal> (<year>2016</year>) <article-title>RNA sequencing of single human islet cells reveals type 2 diabetes genes</article-title>. <source>Cell Metab</source>., <volume>24</volume>, <fpage>608</fpage>–<lpage>615</lpage>.<pub-id pub-id-type="pmid">27667665</pub-id></mixed-citation>
    </ref>
    <ref id="btac819-B56">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Yang</surname><given-names>Y.</given-names></string-name></person-group><etal>et al</etal> (<year>2021</year>) <article-title>SMNN: batch effect correction for single-cell RNA-seq data via supervised mutual nearest neighbor detection</article-title>. <source>Brief. Bioinformatics</source>, <volume>22</volume>, <fpage>bbaa097</fpage>.<pub-id pub-id-type="pmid">32591778</pub-id></mixed-citation>
    </ref>
    <ref id="btac819-B57">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zhang</surname><given-names>F.</given-names></string-name></person-group><etal>et al</etal> (<year>2019a</year>) <article-title>A novel approach to remove the batch effect of single-cell data</article-title>. <source>Cell Discov</source>., <volume>5</volume>, <fpage>1</fpage>–<lpage>4</lpage>.<pub-id pub-id-type="pmid">30603102</pub-id></mixed-citation>
    </ref>
    <ref id="btac819-B58">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zhang</surname><given-names>X.</given-names></string-name></person-group><etal>et al</etal> (<year>2019b</year>) <article-title>Cellmarker: a manually curated resource of cell markers in human and mouse</article-title>. <source>Nucleic Acids Res</source>., <volume>47</volume>, <fpage>D721</fpage>–<lpage>D728</lpage>.<pub-id pub-id-type="pmid">30289549</pub-id></mixed-citation>
    </ref>
    <ref id="btac819-B59">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zhao</surname><given-names>P.</given-names></string-name></person-group><etal>et al</etal> (<year>2022</year>) <article-title>Modeling zero inflation is not necessary for spatial transcriptomics</article-title>. <source>Genome Biol</source>., <volume>23</volume>, <fpage>1</fpage>–<lpage>19</lpage>.<pub-id pub-id-type="pmid">34980209</pub-id></mixed-citation>
    </ref>
    <ref id="btac819-B60">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zheng</surname><given-names>G.X.</given-names></string-name></person-group><etal>et al</etal> (<year>2017</year>) <article-title>Massively parallel digital transcriptional profiling of single cells</article-title>. <source>Nat. Commun</source>., <volume>8</volume>, <fpage>14049</fpage>–<lpage>14012</lpage>.<pub-id pub-id-type="pmid">28091601</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
