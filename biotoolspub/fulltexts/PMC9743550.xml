<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>BMC Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">9743550</article-id>
    <article-id pub-id-type="publisher-id">5093</article-id>
    <article-id pub-id-type="doi">10.1186/s12859-022-05093-z</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Software</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>DiviK: divisive intelligent K-means for hands-free unsupervised clustering in big biological data</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Mrukwa</surname>
          <given-names>Grzegorz</given-names>
        </name>
        <address>
          <email>Grzegorz.Mrukwa@polsl.pl</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0001-8004-9864</contrib-id>
        <name>
          <surname>Polanska</surname>
          <given-names>Joanna</given-names>
        </name>
        <address>
          <email>Joanna.Polanska@polsl.pl</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="GRID">grid.6979.1</institution-id><institution-id institution-id-type="ISNI">0000 0001 2335 3149</institution-id><institution>Department of Data Science and Engineering, </institution><institution>Silesian University of Technology, </institution></institution-wrap>Akademicka 16, 44-100 Gliwice, Poland </aff>
      <aff id="Aff2"><label>2</label>Netguru, Małe Garbary 9, 61-756 Poznań, Poland </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>12</day>
      <month>12</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>12</day>
      <month>12</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2022</year>
    </pub-date>
    <volume>23</volume>
    <elocation-id>538</elocation-id>
    <history>
      <date date-type="received">
        <day>22</day>
        <month>12</month>
        <year>2020</year>
      </date>
      <date date-type="accepted">
        <day>1</day>
        <month>12</month>
        <year>2022</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2022</copyright-statement>
      <license>
        <ali:license_ref specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p><bold>Open Access</bold>This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article's Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article's Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated in a credit line to the data.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p id="Par1">Investigating molecular heterogeneity provides insights into tumour origin and metabolomics. The increasing amount of data gathered makes manual analyses infeasible—therefore, automated unsupervised learning approaches are utilised for discovering tissue heterogeneity. However, automated analyses require experience setting the algorithms’ hyperparameters and expert knowledge about the analysed biological processes. Moreover, feature engineering is needed to obtain valuable results because of the numerous features measured.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p id="Par2">We propose DiviK: a scalable stepwise algorithm with local data-driven feature space adaptation for segmenting high-dimensional datasets. The algorithm is compared to the optional solutions (regular k-means, spatial and spectral approaches) combined with different feature engineering techniques (None, PCA, EXIMS, UMAP, Neural Ions). Three quality indices: Dice Index, Rand Index and EXIMS score, focusing on the overall composition of the clustering, coverage of the tumour region and spatial cluster consistency, are used to assess the quality of unsupervised analyses. Algorithms were validated on mass spectrometry imaging (MSI) datasets—2D human cancer tissue samples and 3D mouse kidney images. DiviK algorithm performed the best among the four clustering algorithms compared (overall quality score 1.24, 0.58 and 162 for <italic>d</italic>(0, 0, 0), <italic>d</italic>(1, 1, 1) and the sum of ranks, respectively), with spectral clustering being mostly second. Feature engineering techniques impact the overall clustering results less than the algorithms themselves (partial <inline-formula id="IEq1"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\eta ^2$$\end{document}</tex-math><mml:math id="M2"><mml:msup><mml:mi>η</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:math><inline-graphic xlink:href="12859_2022_5093_Article_IEq1.gif"/></alternatives></inline-formula> effect size: 0.141 versus 0.345, Kendall’s concordance index: 0.424 versus 0.138 for <italic>d</italic>(0, 0, 0)).</p>
      </sec>
      <sec>
        <title>Conclusions</title>
        <p id="Par3">DiviK could be the default choice in the exploration of MSI data. Thanks to its unique, GMM-based local optimisation of the feature space and deglomerative schema, DiviK results do not strongly depend on the feature engineering technique applied and can reveal the hidden structure in a tissue sample. Additionally, DiviK shows high scalability, and it can process at once the big omics data with more than 1.5 mln instances and a few thousand features. Finally, due to its simplicity, DiviK is easily generalisable to an even more flexible framework. Therefore, it is helpful for other -omics data (as single cell spatial transcriptomic) or tabular data in general (including medical images after appropriate embedding). A generic implementation is freely available under Apache 2.0 license at <ext-link ext-link-type="uri" xlink:href="https://github.com/gmrukwa/divik">https://github.com/gmrukwa/divik</ext-link>.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Machine learning</kwd>
      <kwd>Unsupervised clustering</kwd>
      <kwd>Feature engineering</kwd>
      <kwd>Local feature space adaptation</kwd>
      <kwd>High-dimensional data analysis</kwd>
      <kwd>Omics</kwd>
      <kwd>Mass spectrometry imaging</kwd>
      <kwd>Tumour heterogeneity</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100004281</institution-id>
            <institution>Narodowe Centrum Nauki</institution>
          </institution-wrap>
        </funding-source>
        <award-id>UMO-2015/19/B/ST6/01736</award-id>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100005632</institution-id>
            <institution>Narodowe Centrum Badań i Rozwoju</institution>
          </institution-wrap>
        </funding-source>
        <award-id>I029/17-POWR.03.02.00-IP.08-00-DOK/17</award-id>
        <principal-award-recipient>
          <name>
            <surname>Mrukwa</surname>
            <given-names>Grzegorz</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2022</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p id="Par15">Mass Spectrometry Imaging (MSI) is widely used for discovering molecular profiles, as it provides unparalleled insight into the metabolomics of tissue samples [<xref ref-type="bibr" rid="CR1">1</xref>–<xref ref-type="bibr" rid="CR3">3</xref>]. Applied to a tumour specimen, MSI allows investigating heterogeneities that could indicate functional differences across tissue regions, as well as varying cancer subtypes that require dedicated treatment [<xref ref-type="bibr" rid="CR4">4</xref>–<xref ref-type="bibr" rid="CR10">10</xref>].</p>
    <p id="Par16">Technically, MSI is an excellent example of big biological data, with the following characteristics:<list list-type="bullet"><list-item><p id="Par17"><italic>Volume</italic>: the spatial resolution of <inline-formula id="IEq2"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$5-100 \mu m$$\end{document}</tex-math><mml:math id="M4"><mml:mrow><mml:mn>5</mml:mn><mml:mo>-</mml:mo><mml:mn>100</mml:mn><mml:mi>μ</mml:mi><mml:mi>m</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_5093_Article_IEq2.gif"/></alternatives></inline-formula> leads to 10,000—4,000,000 spectra potentially acquired from a <inline-formula id="IEq3"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$1cm^2$$\end{document}</tex-math><mml:math id="M6"><mml:mrow><mml:mn>1</mml:mn><mml:mi>c</mml:mi><mml:msup><mml:mi>m</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_5093_Article_IEq3.gif"/></alternatives></inline-formula> tissue sample with Time-of-Flight (ToF) spectrometers and becomes an even more severe problem for 3D MSI data [<xref ref-type="bibr" rid="CR11">11</xref>];</p></list-item><list-item><p id="Par18"><italic>Velocity</italic>: the last three years have brought more than 4500 MSI datasets uploaded to the METASPACE database [<xref ref-type="bibr" rid="CR12">12</xref>, <xref ref-type="bibr" rid="CR13">13</xref>];</p></list-item><list-item><p id="Par19"><italic>Variety</italic>: a dataset may consist of more than 200,000 mass channels (features) per single spectrum (observation), representing proteins, peptides, and/or metabolites;</p></list-item><list-item><p id="Par20"><italic>Veracity</italic>: the acquisition methods and various biological phenomena introduce heavy duplication of information, thus capturing the most relevant nuances becomes complicated with dominating high-level patterns amplified [<xref ref-type="bibr" rid="CR14">14</xref>]. On the other hand, feature importance may be diverse across separate regions of interest.</p></list-item></list>Efficient analyses of thousands of MSI spectra usually require careful feature space adaptation, irrespective of the extensive preprocessing pipeline [<xref ref-type="bibr" rid="CR15">15</xref>–<xref ref-type="bibr" rid="CR18">18</xref>]. In a fully unsupervised setup, there are the following groups of methods: filtering, linear (e.g. Principal Components Analysis), and non-linear (e.g. Universal Manifold Approximation and Projection) [<xref ref-type="bibr" rid="CR19">19</xref>]. Filtering removes features according to some threshold (often constant). Linear methods produce a new set of features, a linear combination of the input features. Non-linear methods aim to find a low-dimensional representation that best approximates distances between pairs of points. All these methods are applied once globally to the entire dataset.</p>
    <p id="Par21">Many clustering methods are known, and one can divide them into a few significant groups based on their approach: centroid-based (e.g. k-means), connectivity-based (e.g. hierarchical clustering), distribution-based (e.g. Gaussian Mixture Modeling), and density-based (e.g. graph-cuts clustering). In addition, sometimes, a method is proposed that exercises more than a single property of the data (e.g. both connectivity and centroids) and such a method is called hybrid clustering.</p>
    <p id="Par22">The clustering quality can be captured via metrics like Dunn’s index [<xref ref-type="bibr" rid="CR20">20</xref>] or Adjusted Rand Index [<xref ref-type="bibr" rid="CR21">21</xref>]. These were introduced for low-dimensional data clustering, but studies [<xref ref-type="bibr" rid="CR22">22</xref>, <xref ref-type="bibr" rid="CR23">23</xref>] compare their usefulness for high-dimensional data and subspace clustering. Hundreds of features that clustering algorithms process are already seen as a high-dimensionality problem, but it is still at least an order of magnitude less severe than in MSI data analyses. Therefore domain-related work must be investigated [<xref ref-type="bibr" rid="CR18">18</xref>].</p>
    <p id="Par23">The earliest solutions for Mass Spectrometry Imaging take advantage of Principal Components Analysis (PCA), and agglomerative clustering [<xref ref-type="bibr" rid="CR24">24</xref>]. PCA transforms the data, and components explaining 70% of the variance are selected. The authors use the Euclidean metric to capture spectra similarity and Ward linkage to provide the most meaningful results. The approach is semi-supervised, as it requires the manual setting of the number of clusters based on histological examination.</p>
    <p id="Par24">Another method features high-dimensional data clustering (HDDC) [<xref ref-type="bibr" rid="CR25">25</xref>]—a hybrid approach based on the Gaussian Mixture Model (GMM). The fitting process yields locally relevant features, so the domain is independently adapted for each estimated component. The observations’ similarity is considered Euclidean metric in some subspaces of the original feature space. For MSI data, a combination of HDDC with edge-preserving denoising of <italic>m</italic>/<italic>z</italic>-images is applied [<xref ref-type="bibr" rid="CR26">26</xref>]. Oppositely to smoothing the clustering results, the authors propose an approach oriented on <italic>m</italic>/<italic>z</italic> images, so the denoising provides better quality data for the clustering method. The idea of denoising is extended [<xref ref-type="bibr" rid="CR27">27</xref>]. The Fast Map algorithm adapts the domain, and K-means clustering follows, which is more straightforward than HDDC. The denoising stage contains the main advancements, which we will omit here. The overlap of clusters and actual structures is the primary quality metric. However, both HDDC and K-means approaches [<xref ref-type="bibr" rid="CR26">26</xref>, <xref ref-type="bibr" rid="CR27">27</xref>] also compare the visual perception of cluster consistency.</p>
    <p id="Par25">Region consistency is the main idea behind EXIMS [<xref ref-type="bibr" rid="CR28">28</xref>]—a modern PCA-oriented feature engineering approach. First, histogram equalisation enhances the contrast of a molecular image. Then, the algorithm proposes a scoring method to assess whether structures exist in the enhanced molecular image. The random distribution of counts over the image leads to a low score value. Next, typical structure types like regions, curves, gradients and islets are recognised with a grey level co-occurrence matrix, resulting in a higher score value. However, the definition of the score yields unbounded values. Thus there is no clear threshold that can help discern informative peaks. Finally, the informative peaks are PCA-transformed and clustered with the fuzzy C-means algorithm.</p>
    <p id="Par26">K-means and spectral clustering are further investigated in a two-step scenario to speed up computations [<xref ref-type="bibr" rid="CR29">29</xref>]. In the first step of clustering, both methods consider several random subsets of input data independently, and then cluster representatives are grouped to form the final clusters. Algorithms use cosine distance to measure spectrum similarity. Authors manually perform hyperparameter selection (i.e. selecting the number of eigenvectors of the connectivity graph) to provide the best results (visually). Both methods isolate 7 clusters per prior settings.</p>
    <p id="Par27">Feature engineering techniques also address the increased dataset volume. For example, Hierarchical Stochastic Neighbor Embedding (HSNE) has been claimed to be superior to classical non-linear techniques [<xref ref-type="bibr" rid="CR30">30</xref>]. Reduced feature space is constructed hierarchically, with the approach <italic>Overview-First, Details-on-Demand</italic>. Firstly, characteristic points of the dataset (landmarks) are embedded to provide an overview. Then, the algorithm creates a new embedding for local neighbourhoods. Finally, each point is assigned the likelihood of being represented by a specific landmark. The authors discuss using maps of the likelihood for molecular segmentation given a landmark. However, they propose clusters of landmarks manually.</p>
    <p id="Par28">Another scalable feature engineering example is the Universal Manifold Approximation and Projection (UMAP) algorithm. It is more scalable than t-SNE and preserves more of the global structure [<xref ref-type="bibr" rid="CR31">31</xref>]. Moreover, no restriction is made on the embedding dimensions. Thus, it may be used as a more general feature engineering method in MSI than the visualizing-only capabilities of t-SNE [<xref ref-type="bibr" rid="CR32">32</xref>].</p>
    <p id="Par29">The recent years introduced a new category of unsupervised segmentation approaches based on deep learning. They form groups that correspond to dual interpretation of MSI data:<list list-type="bullet"><list-item><p id="Par30"><italic>Spectrum oriented</italic>: neural network creates a low-dimensional embedding of spectra [<xref ref-type="bibr" rid="CR33">33</xref>–<xref ref-type="bibr" rid="CR35">35</xref>] that is further analysed with classical clustering methods or visualised.</p></list-item><list-item><p id="Par31"><italic>Ion-image oriented</italic>: molecular images are analysed to find similarities in molecule distribution and enhance biologically relevant information. The neural approach extends the idea from EXIMS [<xref ref-type="bibr" rid="CR28">28</xref>] and classical community detection algorithms [<xref ref-type="bibr" rid="CR36">36</xref>]. It mimics a human recognising detailed molecular patterns and clusters the ion images based on spatial expressions [<xref ref-type="bibr" rid="CR37">37</xref>]. This way, new molecular features are obtained, simultaneously representing whole groups of ion images. These <italic>neural ion images</italic> are subject to a classical unsupervised analysis pipeline, including pixel-wise approaches.</p></list-item></list>The unsupervised analyses of MSI data via clustering outlined above follow a single schema: <italic>some</italic> domain adaptation is applied globally, and a basic clustering algorithm is applied. This approach has several drawbacks.<list list-type="bullet"><list-item><p id="Par32">PCA applied to the whole dataset can capture the most variance on a high level, but at the same time, it discards all nuances. These nuances might be crucial for hierarchical analyses. Other domain adaptation methods may partially resolve the issue, but the disproportion between low- and high-level detail is significant with thousands of dimensions.</p></list-item><list-item><p id="Par33">Non-hierarchical approaches (e.g. one-step, two-step) cannot provide insights into the internal structures unless the molecular differences dominate the whole dataset.</p></list-item><list-item><p id="Par34">Only hierarchical approaches describe the relation of subgroups as a clustering tree that captures context like <italic>parent</italic>, <italic>child</italic>, or <italic>sibling</italic>. This context provides additional insight into molecular diversity. For example, the parent-child relation of clusters could describe different functional subregions of the tumour region, while sibling clusters could represent other types of tumours.</p></list-item><list-item><p id="Par35">Agglomerative or bisecting deglomerative hierarchical algorithms provide limited information about siblings since only two objects are merged or divided on each level. Therefore, many siblings are mistreated as an artificial parent-child relation. Such mistreatment requires an additional post-processing step.</p></list-item></list><fig id="Fig1"><label>Fig. 1</label><caption><p>The proposed hierarchical framework for unsupervised clustering of MSI data with local feature domain adaptation. For each ROI, an analysis was performed on whether it contains any implicit structures. If structures were present, molecular segmentation was continued recursively for each cluster/subcluster</p></caption><graphic xlink:href="12859_2022_5093_Fig1_HTML" id="MO1"/></fig></p>
    <p id="Par36">We propose a hybrid framework that directly answers the above drawbacks: Divisive intelligent K-means (DiviK). It is a stepwise clustering procedure with feature engineering applied locally at each step (see Fig. <xref rid="Fig1" ref-type="fig">1</xref>). We implemented local feature engineering as filtering based on GMM decomposition of the feature variance across the subregion. The clustering algorithm implemented in our approach is a standard K-means algorithm with a tailored procedure for initial condition selection. One can easily substitute GMM filtering and K-means with other algorithms. Information criteria decide the number of clusters in the optimised feature space. The decision on the cluster number is two-stage: due to its numerical complexity, we use GAP at the first stage when assessing the data’s homogeneity. We use the approximate Dunn’s index to select the best local partition in the next step.</p>
    <p id="Par37">The strength of the proposed solution lies in optimising the feature space locally for data clustering according to the variability of the analysed subregion. DiviK considers separate regions independently on each step, starting from the entire input dataset feature space. It provides biologically relevant results and sustains scalability for large datasets, contrary to sophisticated approaches.</p>
    <p id="Par38">DiviK addresses the drawbacks mentioned above in the following way:<list list-type="bullet"><list-item><p id="Par39">It has a hierarchical nature to provide the most comprehensive insight.</p></list-item><list-item><p id="Par40">During the analysis, local domain adaptation is performed separately for each cluster/subcluster to avoid the excessive influence of dominating global patterns.</p></list-item><list-item><p id="Par41">Before the cluster/subcluster analysis, a check is performed on whether there is evidence that diverse groups are present in the cluster/subcluster.</p></list-item></list></p>
  </sec>
  <sec id="Sec2">
    <title>Implementation</title>
    <p id="Par42">Three main components of the DiviK algorithm: feature engineering and filtering technique, stop condition definition, and clustering algorithm, constitute its framework. All of these can be easily changed to adapt to the specificity of the analysed data.</p>
    <sec id="Sec3">
      <title>Feature space optimisation</title>
      <p id="Par43">We propose to use a feature filtering procedure based on GMM decomposition [<xref ref-type="bibr" rid="CR38">38</xref>, <xref ref-type="bibr" rid="CR39">39</xref>]. First, we average abundance and calculate abundance variance across the analysed subcluster for each peak. Then, empirical distributions of average abundances and abundance variances across all peaks, presented on the logarithmic scale (upper panel of Fig. <xref rid="Fig2" ref-type="fig">2</xref>), are decomposed into Gaussian mixtures, as shown in the middle panel of Fig. <xref rid="Fig2" ref-type="fig">2</xref>. We use the maximum conditional probability criterion to classify a particular peak into one of the mixture components. The crossing points between Gaussian components serve as the thresholds.<fig id="Fig2"><label>Fig. 2</label><caption><p>Data-driven MSI peaks selection based on a histogram decomposition. Filtering considers each MSI peak’s average abundance (left panel) and abundance variance (right panel). The histograms of these two characteristics are decomposed into a GMM. Components represent sets of features similar concerning selected characteristics, i.e., average abundance or abundance variance across a cluster. We calculate a conditional probability for each Gaussian component for each value of the selected characteristic. Then we apply the maximum classification rule, which leads to the interpretation that the crossing points of the neighbouring GMM components become filtering thresholds. We remove all the peaks represented by the first GMM component for the average abundance. For the abundance variance, we persist only the peaks represented by the topmost GMM components, but not less than 1% of all the peaks</p></caption><graphic xlink:href="12859_2022_5093_Fig2_HTML" id="MO2"/></fig></p>
      <p id="Par44">We discarded the GMM components containing less than 1% of peaks to avoid numeric artefacts.</p>
      <p id="Par45">We filter out all the peaks with the average abundance below the first crossing point of the GM model. For the abundance variance, we persisted only the peaks with the variance above the topmost crossing point, assuming it results in no less than 1% of the available features, as is shown in the bottom right panel of Fig. <xref rid="Fig2" ref-type="fig">2</xref>. If the 1% condition is not fulfilled, the second left or the second topmost threshold is used.</p>
      <p id="Par46">As we aim for a hands-free pipeline, Bayesian Information Criterion is used to select the optimal number of GMM components for both the model of average abundance distribution for global noise filtering and the model of local abundance variance distribution for discrimination of locally the most informative features.</p>
    </sec>
    <sec id="Sec4">
      <title>Stop condition</title>
      <p id="Par47">Having a feature space optimised for cluster discovery, we must assess whether there are any clusters. There exist many indices that can validate the quality of unsupervised segmentation. These take into account cluster separability, compactness or probabilistic measures. However, only a few allow for a comparison between a multi-cluster partition and no further partition (one cluster only). For the K-means algorithm, the GAP statistic [<xref ref-type="bibr" rid="CR40">40</xref>] is one of the options. It relates a data-specific partition to partitions obtained via the same method over random datasets within the same bounds (see Fig. <xref rid="Fig3" ref-type="fig">3</xref>). We stop splitting of particular ROI if GAP statistic suggests region homogeneity.<fig id="Fig3"><label>Fig. 3</label><caption><p>Flowchart of GAP statistic computation used in the two-trial scenario. Spectra belonging to an ROI are artificially clustered into a single cluster and then into two clusters. The GAP statistic was compared for both cases. If spectra form a single group, the GAP statistic tends to be greater for the artificial division. Otherwise, it tends to be greater for two clusters (but not necessarily optimal)</p></caption><graphic xlink:href="12859_2022_5093_Fig3_HTML" id="MO3"/></fig></p>
    </sec>
    <sec id="Sec5">
      <title>Clustering</title>
      <p id="Par48">In this work, we focus only on the K-means-based implementation due to its promising initial results [<xref ref-type="bibr" rid="CR9">9</xref>, <xref ref-type="bibr" rid="CR41">41</xref>] and low computational complexity. With a cluster molecular diversity confirmed, we can proceed with the clustering. For MSI data analysis, we adjusted the distance metric [<xref ref-type="bibr" rid="CR41">41</xref>] and the initialisation method.</p>
      <p id="Par49">The K-means algorithm requires the number of clusters to be specified before the analysis occurs. Since the actual number of molecularly homogeneous regions is unknown, we use unsupervised quality metrics to guide the computations. The current implementation includes Dunn’s index [<xref ref-type="bibr" rid="CR20">20</xref>] and GAP statistic [<xref ref-type="bibr" rid="CR40">40</xref>].</p>
      <sec id="Sec6">
        <title>Initialisation method</title>
        <p id="Par50">
          <fig id="Fig4">
            <label>Fig. 4</label>
            <caption>
              <p>Flowchart of K-means initialization procedure. We find a moderately outlying KD-Tree leaf centroid as the first seed and follow an iterative deterministic algorithm similar to the K-means++ algorithm. KD-Tree keeps the order of computational complexity low, while the linear model makes it more predictable than the K-means++ algorithm</p>
            </caption>
            <graphic xlink:href="12859_2022_5093_Fig4_HTML" id="MO4"/>
          </fig>
        </p>
        <p id="Par51">Since the DiviK algorithm aims to identify biologically meaningful heterogeneity in the data, we decided to implement the deterministic initialisation procedure (see Fig. <xref rid="Fig4" ref-type="fig">4</xref>). Although there are plenty of well-known algorithms for random initialisation, the deterministic approaches are usually customised to the data structure, allowing to achieve the clustering goal. As mentioned above, in the case of MSI data, we seek the most heterogeneous tissue regions independently of the cluster imbalance. To address the expected redundancy in MSI data and decrease the computational time, we compress the data by the KD-tree algorithm (with the compression factor equal to 0.01 for 2D data and 0.001 for 3D data). The obtained “boxes of spectra” are represented by their centroids and weighting factors related to the number of spectra assigned to the particular box. The next step requires computing the distances from the global dataset centroid to the box-specific centroids. We approximate the distances’ cumulative distribution function (cdf) and choose the centroid containing the <italic>k</italic>-th percentile. It serves as the first initial seed for the clustering algorithm. The procedure mentioned above repeats to obtain the second seed, but we substitute the global centroid with the first seed and the box containing that seed is not considered in the calculations. Having two initial seeds, we can search for the third one (if required). We estimate the cdf of the distance between the box-specific centroids and the line defined by already chosen two seeds to find the box containing <italic>k</italic>-th percentile. The centroid of that box is considered the third seed. One can identify the subsequent seeds similarly, substituting the line by the hyperplane defined by the already found seeds. We perform the initial seed setting in the already locally optimised feature space. The comprehensive study on the initialisation procedures (not shown in the manuscript) demonstrated the power and robustness of our approach when compared to the commonly used initialisation algorithms.</p>
      </sec>
    </sec>
    <sec id="Sec7">
      <title>Scalability</title>
      <p id="Par52">DiviK is an original stepwise deglomerative algorithm that provides scalability for big data in several ways:<list list-type="bullet"><list-item><p id="Par53">It uses a locally optimised K-means algorithm iteratively. K-means algorithm is known as one of the few highly scalable clustering algorithms.</p></list-item><list-item><p id="Par54">Filtration-based feature engineering, used in the local optimisation of the feature space step, requires conducting neither PCA nor UMAP. The Gaussian Mixture Model approach supports threshold identification necessary for the feature filtration (see Fig. <xref rid="Fig2" ref-type="fig">2</xref>). It is computationally efficient, as it requires only computing the within-cluster mean and the variance of each feature, followed by an automated data-driven threshold selection.</p></list-item><list-item><p id="Par55">To ensure computational complexity is linear with the number of samples, we developed a procedure of deterministic initialisation based on a KD-Tree algorithm.</p></list-item><list-item><p id="Par56">The automatic selection of the number of clusters in the K-means algorithm is computationally expensive by default. Therefore, we split the decision process into two steps. First, we use the sampled distribution of GAP statistics to decide if the cluster is heterogeneous (requires further splitting) or homogenous (the splitting process is finished). In the case of a heterogeneous cluster, we use Dunn’s Index to decide on the number of subclusters, which keeps the process scalable.</p></list-item></list></p>
    </sec>
    <sec id="Sec8">
      <title>Technology</title>
      <p id="Par57">DiviK was written mainly in Python, and it is distributed cross-platform under the Apache 2.0 license through Python Package Index (<ext-link ext-link-type="uri" xlink:href="https://pypi.org/project/divik/">https://pypi.org/project/divik/</ext-link>) and Docker Hub (<ext-link ext-link-type="uri" xlink:href="https://hub.docker.com/r/gmrukwa/divik">https://hub.docker.com/r/gmrukwa/divik</ext-link>). It is designed to be simple, efficient, accessible to a non-expert, and highly reusable. Thus, DiviK is accessible in Python directly and via a command-line interface (CLI). The Python API follows the scikit-learn [<xref ref-type="bibr" rid="CR42">42</xref>] design patterns and similar package organisation conventions to provide reusable building blocks. The CLI allows the construction of highly-flexible processing pipelines owing to its injection-based configuration system.</p>
    </sec>
  </sec>
  <sec id="Sec9">
    <title>Results</title>
    <p id="Par58">In order to compare the effectiveness of the DiviK framework and the existing approaches, we evaluated the tool against two MSI datasets of different characteristics:<list list-type="bullet"><list-item><p id="Par59">Oral Squamous Cell Carcinoma (OSCC). It consists of two individual slices collected from different patients suffering from OSCC, annotated by an experienced pathologist;</p></list-item><list-item><p id="Par60">Mouse kidney. It consists of 75 serial slices from a single 3D-allocated volume from a mouse kidney without annotation.</p></list-item></list>We compared DiviK to the combinations of state-of-the-art MSI data clustering and global feature engineering methods. We selected K-means, spectral and spatial clustering [<xref ref-type="bibr" rid="CR27">27</xref>] as representatives of clustering algorithms validated for MSI. All were used in a fully unsupervised setting with the number of clusters selected using the GAP statistic. For global feature engineering, we used one of the following options: no global feature engineering, PCA with the knee-based selection of the number of components [<xref ref-type="bibr" rid="CR43">43</xref>], PCA on top of EXIMS-preselected features [<xref ref-type="bibr" rid="CR28">28</xref>], UMAP [<xref ref-type="bibr" rid="CR31">31</xref>], and neural ion images obtained with Xception network [<xref ref-type="bibr" rid="CR37">37</xref>].</p>
    <p id="Par61">All the experiments were carried out in the Polyaxon environment [<xref ref-type="bibr" rid="CR44">44</xref>].</p>
    <sec id="Sec10">
      <title>Oral squamous cell carcinoma</title>
      <p id="Par62">
        <fig id="Fig5">
          <label>Fig. 5</label>
          <caption>
            <p>Microscope image of raw HNC samples (upper panel) and samples annotated by a pathologist (lower panel). Regions of interest (ROI): red = tumour; cyan = healthy epithelium; magenta = other healthy tissue. Due to medical relevance, we focused mostly on tumour and epithelium tissue—the origin of OSCC</p>
          </caption>
          <graphic xlink:href="12859_2022_5093_Fig5_HTML" id="MO5"/>
        </fig>
      </p>
      <p id="Par63">The OSCC dataset [<xref ref-type="bibr" rid="CR41">41</xref>] is a two-dimensional MALDI-ToF MSI dataset. The original dataset consists of 45,738 raw spectra with 109,568 mass channels. After pre-processing and spectra modelling, 3714 peaks/features were obtained. The spectra are provided with annotations of the tissue type, allowing for distinguishing regions of interest (ROI) of the tumour, epithelium, and healthy areas (Fig. <xref rid="Fig5" ref-type="fig">5</xref>). Therefore, the OSCC dataset can be a benchmark for classification and clustering problems. There are diverse sources of variability, including:<list list-type="bullet"><list-item><p id="Par64">inter-patient sample heterogeneity;</p></list-item><list-item><p id="Par65">tissue type heterogeneity;</p></list-item><list-item><p id="Par66">intra-tissue heterogeneity.</p></list-item></list>We selected a subset consisting of two patient samples with top tissue variety (19,874 spectra and 3714 peaks in total) and segmented the subset using all the combinations of the methods discussed in the previous section. The obtained clusters of spectra usually consisted of spectra originally annotated to different tissue subtypes, so the annotation translation from spectrum to cluster level is required. The developed reannotation procedure maximises the multi-cluster Dice similarity index related to the primary tissue subtypes (Region of Interests ROI) as presented in Fig. <xref rid="Fig6" ref-type="fig">6</xref>. First, we sort clusters according to the percentage of their area covered by the consecutive ROIs. Then, we select clusters sequentially to maximise the Dice index for a given ROI collectively. We assign one for each (<italic>cluster</italic>, <italic>ROI</italic>) pair if the cluster is included in the set maximising Dice index for a given ROI, zero otherwise. If only one pair <inline-formula id="IEq4"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(C, ROI_i)$$\end{document}</tex-math><mml:math id="M8"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>C</mml:mi><mml:mo>,</mml:mo><mml:mi>R</mml:mi><mml:mi>O</mml:mi><mml:msub><mml:mi>I</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_5093_Article_IEq4.gif"/></alternatives></inline-formula> is assigned 1 for a given cluster <italic>C</italic>, the assignment is considered final. Otherwise, we evaluate each pair (assignment scenario) in terms of the Rand index.<fig id="Fig6"><label>Fig. 6</label><caption><p>Cluster label normalisation procedure. Red = false negative; yellow = false positive; grey = true positive tumour. In the first step, a binary decision was made on whether the label should belong to one of the pathologist-defined regions. Clusters were sorted by the percentage of their area covered by the ROI. They were selected sequentially to optimise the Dice index. Secondly, all ambiguous assignments were resolved via optimising the Rand Index to form the normalised labels</p></caption><graphic xlink:href="12859_2022_5093_Fig6_HTML" id="MO6"/></fig></p>
      <p id="Par67">We used this dataset to compare ROI reconstruction capabilities across different clustering algorithms and feature engineering techniques. With clusters reassigned to the pathologist-defined ROIs, we considered the following quality metrics:<list list-type="bullet"><list-item><p id="Par68">Rand Index—to capture global multi-ROI reconstruction capabilities;</p></list-item><list-item><p id="Par69">Dice Index—to capture tumour reconstruction capabilities;</p></list-item><list-item><p id="Par70">EXIMS score—to capture the spatial consistency of the clusters.</p></list-item></list>The EXIMS score is a measure with unbounded values, useful in comparative analyses, but its magnitude is hard to interpret. Therefore we scaled and clipped the values so that the highest multi-cluster result was 1.</p>
      <p id="Par71">DiviK sweeps for up to 10 clusters on each segmentation level. It operates with correlation distance, as researchers have already proven it to work well for MSI data [<xref ref-type="bibr" rid="CR29">29</xref>, <xref ref-type="bibr" rid="CR32">32</xref>]. The minimal number of local features required to preserve is 1%. The minimal size of the cluster was set to 200 spectra. The leaf size of KD-Tree was 1%, and the algorithm started from the leaf containing the 99th percentile of the distance. We sampled ten times 1000 spectra each to compute Dunn’s and GAP indices to keep the computational complexity of quality estimation bounded. Standalone K-means clustering swept for up to 50 clusters, with the same criteria for computing the GAP index as DiviK and the correlation distance. Spatial clustering was launched with a radius of 7. Spectral clustering was used with cosine metrics during the embedding. The embedding generated the number of components equal to 1% of the number of global features (information capacity equivalent to DiviK filtering). UMAP was run with 30 neighbours, correlation distance, 500 epochs and a negative sample rate of 70 to obtain three components. We used the Xception network with a patch size of <inline-formula id="IEq5"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$71\times 71$$\end{document}</tex-math><mml:math id="M10"><mml:mrow><mml:mn>71</mml:mn><mml:mo>×</mml:mo><mml:mn>71</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_5093_Article_IEq5.gif"/></alternatives></inline-formula> pixels and an upsample rate of 4 to ensure a patch edge of 1.775<italic>mm</italic>.<fig id="Fig7"><label>Fig. 7</label><caption><p>Quality indices of ROI composability by the obtained clusters. The <italic>overall quality</italic> is defined as the vector’s length limited by the quality indices’ values and the origin of the coordinate system. The length of the vector is displayed next to the points representing the top results. The arrow indicates the best result</p></caption><graphic xlink:href="12859_2022_5093_Fig7_HTML" id="MO7"/></fig><table-wrap id="Tab1"><label>Table 1</label><caption><p>Values of quality indices measured for OSCC data</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Clustering algorithm</th><th align="left">Global feature engineering method</th><th align="left">Adjusted Rand index</th><th align="left">Dice index</th><th align="left">Relative EXIMS score</th><th align="left">Adjusted Rand index rank</th><th align="left">Dice index rank</th><th align="left">Relative EXIMS score rank</th><th align="left">Sum of ranks</th><th align="left">Overall quality <italic>d</italic>(0, 0, 0)</th><th align="left">Overall quality <italic>d</italic>(1, 1, 1)</th></tr></thead><tbody><tr><td align="left">Spectral</td><td align="left">UMAP</td><td align="left">0.2792</td><td align="left">0.4844</td><td align="left">0.5891</td><td align="left">17</td><td align="left">16</td><td align="left">20</td><td align="left">53</td><td align="left">0.8122</td><td align="left">0.9768</td></tr><tr><td align="left">Spatial</td><td align="left">UMAP</td><td align="left">0.0000</td><td align="left">0.0000</td><td align="left">1.0000</td><td align="left">19.5</td><td align="left">19</td><td align="left">2.5</td><td align="left">41</td><td align="left">1.0000</td><td align="left">1.4142</td></tr><tr><td align="left">Spectral</td><td align="left">Xception</td><td align="left">0.0000</td><td align="left">0.0000</td><td align="left">1.0000</td><td align="left">19.5</td><td align="left">19</td><td align="left">2.5</td><td align="left">41</td><td align="left">1.0000</td><td align="left">1.4142</td></tr><tr><td align="left">K-means</td><td align="left">Knee PCA</td><td align="left">0.2723</td><td align="left">0.0000</td><td align="left">1.0000</td><td align="left">18</td><td align="left">19</td><td align="left">2.5</td><td align="left">39.5</td><td align="left">1.0364</td><td align="left">1.2368</td></tr><tr><td align="left">K-means</td><td align="left">Xception</td><td align="left">0.3098</td><td align="left">0.4577</td><td align="left">0.9197</td><td align="left">16</td><td align="left">17</td><td align="left">8</td><td align="left">41</td><td align="left">1.0730</td><td align="left">0.8814</td></tr><tr><td align="left">K-means</td><td align="left">EXIMS PCA</td><td align="left">0.4827</td><td align="left">0.5129</td><td align="left">0.8323</td><td align="left">12</td><td align="left">14</td><td align="left">9</td><td align="left">35</td><td align="left">1.0903</td><td align="left">0.7300</td></tr><tr><td align="left">Spectral</td><td align="left">EXIMS PCA</td><td align="left">0.5447</td><td align="left">0.7418</td><td align="left">0.6449</td><td align="left">8</td><td align="left">8</td><td align="left">18</td><td align="left">34</td><td align="left">1.1237</td><td align="left">0.6325</td></tr><tr><td align="left">K-means</td><td align="left">none</td><td align="left">0.3364</td><td align="left">0.5043</td><td align="left">0.9712</td><td align="left">15</td><td align="left">15</td><td align="left">6</td><td align="left">36</td><td align="left">1.1449</td><td align="left">0.8288</td></tr><tr><td align="left">K-means</td><td align="left">UMAP</td><td align="left">0.5231</td><td align="left">0.7238</td><td align="left">0.7225</td><td align="left">10</td><td align="left">10</td><td align="left">13</td><td align="left">33</td><td align="left">1.1487</td><td align="left">0.6170</td></tr><tr><td align="left">Spatial</td><td align="left">Knee PCA</td><td align="left">0.4985</td><td align="left">0.7065</td><td align="left">0.7639</td><td align="left">11</td><td align="left">11</td><td align="left">10</td><td align="left">32</td><td align="left">1.1537</td><td align="left">0.6272</td></tr><tr><td align="left">DiviK</td><td align="left">EXIMS PCA</td><td align="left">0.6082</td><td align="left">0.7765</td><td align="left">0.6383</td><td align="left">4</td><td align="left">5</td><td align="left">19</td><td align="left">28</td><td align="left">1.1749</td><td align="left">0.5782</td></tr><tr><td align="left">Spectral</td><td align="left">none</td><td align="left">0.5906</td><td align="left">0.7966</td><td align="left">0.6520</td><td align="left">5</td><td align="left">4</td><td align="left">17</td><td align="left">26</td><td align="left">1.1868</td><td align="left">0.5745</td></tr><tr><td align="left">DiviK</td><td align="left">Knee PCA</td><td align="left">0.5567</td><td align="left">0.7540</td><td align="left">0.7289</td><td align="left">7</td><td align="left">7</td><td align="left">12</td><td align="left">26</td><td align="left">1.1873</td><td align="left">0.5749</td></tr><tr><td align="left">DiviK</td><td align="left">Xception</td><td align="left">0.4203</td><td align="left">0.6429</td><td align="left">0.9395</td><td align="left">14</td><td align="left">13</td><td align="left">7</td><td align="left">34</td><td align="left">1.2136</td><td align="left">0.6835</td></tr><tr><td align="left">Spatial</td><td align="left">none</td><td align="left">0.5617</td><td align="left">0.7720</td><td align="left">0.7587</td><td align="left">6</td><td align="left">6</td><td align="left">11</td><td align="left">23</td><td align="left">1.2195</td><td align="left">0.5498</td></tr><tr><td align="left">DiviK</td><td align="left">UMAP</td><td align="left">0.6534</td><td align="left">0.8369</td><td align="left">0.6568</td><td align="left">2</td><td align="left">3</td><td align="left">16</td><td align="left">21</td><td align="left">1.2485</td><td align="left"><bold><italic>0.5143</italic></bold></td></tr><tr><td align="left">Spatial</td><td align="left">Xception</td><td align="left">0.6517</td><td align="left">0.8465</td><td align="left">0.6851</td><td align="left">3</td><td align="left">2</td><td align="left">15</td><td align="left"><bold><italic>20</italic></bold></td><td align="left">1.2691</td><td align="left"><bold><italic>0.4940</italic></bold></td></tr><tr><td align="left">Spectral</td><td align="left">Knee PCA</td><td align="left">0.4594</td><td align="left">0.6897</td><td align="left">0.9891</td><td align="left">13</td><td align="left">12</td><td align="left">5</td><td align="left">30</td><td align="left"><bold><italic>1.2904</italic></bold></td><td align="left">0.6235</td></tr><tr><td align="left">Spatial</td><td align="left">EXIMS PCA</td><td align="left">0.7035</td><td align="left">0.8672</td><td align="left">0.6977</td><td align="left">1</td><td align="left">1</td><td align="left">14</td><td align="left"><bold><italic>16</italic></bold></td><td align="left"><bold><italic>1.3167</italic></bold></td><td align="left"><bold><italic>0.4438</italic></bold></td></tr><tr><td align="left">DiviK</td><td align="left">none</td><td align="left">0.5433</td><td align="left">0.7372</td><td align="left">1.0000</td><td align="left">9</td><td align="left">9</td><td align="left">2.5</td><td align="left"><bold><italic>20.5</italic></bold></td><td align="left"><bold><italic>1.3560</italic></bold></td><td align="left">0.5269</td></tr></tbody></table><table-wrap-foot><p>Top three values of a quality index among pairwise combinations of clustering methods and feature engineering procedures are presented in bold italics</p></table-wrap-foot></table-wrap></p>
      <p id="Par72">We presented the visualisation of the performance of the DiviK algorithm and remaining combinations in Fig. <xref rid="Fig7" ref-type="fig">7</xref>. Dimensions of the presented cube are the quality indices mentioned at the beginning of this section, namely Dice Index, Rand Index, and EXIMS Score. The exact values of quality metrics are available in Table <xref rid="Tab1" ref-type="table">1</xref>. In Fig. <xref rid="Fig8" ref-type="fig">8</xref> one can find a normalised map of the clusters obtained in the process. We compare the combinations of global feature engineering methods and clustering algorithms exhaustively. The proposed DiviK approach uses no global feature engineering method, yet we conducted such experiments and presented their results for comparison. Sample spatial ion heatmaps, correlated with the pathologist’s tissue subtypes and the clusters found by DiviK, are presented in Fig. <xref rid="Fig9" ref-type="fig">9</xref>. The averaged results for the used clustering methods can be seen in Table <xref rid="Tab2" ref-type="table">2</xref> whereas Table <xref rid="Tab3" ref-type="table">3</xref> presents results obtained with the used global feature engineering methods for <italic>d</italic>-based aggregations. Tables <xref rid="Tab4" ref-type="table">4</xref> and <xref rid="Tab5" ref-type="table">5</xref> present the rank-based summarisation results.<table-wrap id="Tab2"><label>Table 2</label><caption><p>Average quality indices for clustering methods with OSCC data</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Clustering algorithm</th><th align="left">Adjusted Rand index</th><th align="left">Dice index</th><th align="left">Relative EXIMS score</th><th align="left">Overall quality <italic>d</italic>(0, 0, 0)</th><th align="left">Overall quality <italic>d</italic>(1, 1, 1)</th></tr></thead><tbody><tr><td align="left">Spectral</td><td align="left">0.375 (0.241)</td><td align="left">0.543 (0.325)</td><td align="left">0.775 (0.202)</td><td align="left">1.083 (0.184)</td><td align="left">0.844 (0.357)</td></tr><tr><td align="left">K-means</td><td align="left">0.385 (0.111)</td><td align="left">0.440 (0.266)</td><td align="left"><bold><italic>0.﻿889 (0.113)</italic></bold></td><td align="left">1.099 (0.048)</td><td align="left">0.859 (0.234)</td></tr><tr><td align="left">Spatial</td><td align="left">0.483 (0.281)</td><td align="left">0.638 (0.363)</td><td align="left">0.781 (0.127)</td><td align="left">1.192 (0.123)</td><td align="left">0.706 (0.402)</td></tr><tr><td align="left">DiviK</td><td align="left"><bold><italic>0.556 (0.088)</italic></bold></td><td align="left"><bold><italic>0.750 (0.071)</italic></bold></td><td align="left">0.793(0.167)</td><td align="left"><bold><italic>1.236 (0.073)</italic></bold></td><td align="left"><bold><italic>0.576 (0.067)</italic></bold></td></tr></tbody></table><table-wrap-foot><p>Standard deviation is presented in brackets. Top value of a quality index among clustering methods is presented in bold italics</p></table-wrap-foot></table-wrap></p>
      <p id="Par73">
        <fig id="Fig8">
          <label>Fig. 8</label>
          <caption>
            <p>Results of the unsupervised analyses for OSCC data. Clusters were matched to the pathologist regions using the method described. Red = tumour region; cyan = healthy epithelium; grey = other tissue. The top <italic>overall quality</italic> is marked</p>
          </caption>
          <graphic xlink:href="12859_2022_5093_Fig8_HTML" id="MO8"/>
        </fig>
        <fig id="Fig9">
          <label>Fig. 9</label>
          <caption>
            <p>The spatial distribution of the chosen features (mass channels) in OSCC data. Peptides upregulated in tumour (represented by 1142.5 m/z and 2175.1 m/z) are putatively fragments of pyruvate kinase, an enzyme involved in the Warburg effect</p>
          </caption>
          <graphic xlink:href="12859_2022_5093_Fig9_HTML" id="MO9"/>
        </fig>
      </p>
    </sec>
    <sec id="Sec11">
      <title>Mouse kidney 3D</title>
      <p id="Par74">The mouse kidney dataset [<xref ref-type="bibr" rid="CR45">45</xref>] is a three-dimensional MALDI-ToF MSI dataset. Therefore, the dataset has a high volume and can be a benchmark for the algorithm’s scalability. The sources of variability are limited to a single source specimen. It consists of 75 sections from the central part of a mouse kidney, 1,362,830 spectra in total, and 7680 data points per spectrum. The dataset was already subject to Gaussian spectral smoothing and baseline reduction with the Top Hat algorithm.</p>
      <p id="Par75">We conduct clustering in the same scenarios as previously, except feature engineering based on neural ion images, as it lacks generalisation for 3D data. No expert-defined labels are available for the spectra; thus, one must assess the capabilities of heterogeneity detection visually. Clusters are subject to a similar reannotation procedure as depicted in Fig. <xref rid="Fig6" ref-type="fig">6</xref> to indicate the similarities between results.</p>
      <p id="Par76">The minimal number of local features that DiviK is required to preserve is set to 0.5%. We did not split the cluster further if it already was 50,000 spectra or fewer, as this dataset cannot confirm detailed internal tissue diversity. KD-Tree leaf size during the initialisation was 0.1%, and the algorithm started from the leaf containing the 95th percentile of the distance. To compute the Dunn’s and GAP indices, we sampled ten times 5000 spectra each to keep the computational complexity of quality estimation bounded.<fig id="Fig10"><label>Fig. 10</label><caption><p>Results of the unsupervised analyses for 3D mouse kidney data. All 1,362,830 spectra (75 slices) were analysed together with locally adjusted feature space. Different colours represent molecularly different tissue subtypes. We normalised the colours to correspond between experiment scenarios</p></caption><graphic xlink:href="12859_2022_5093_Fig10_HTML" id="MO10"/></fig></p>
      <p id="Par77">In Fig. <xref rid="Fig10" ref-type="fig">10</xref>, we present volumes with clusters marked. We matched cluster colours to enable visual comparison, although we used no cluster normalisation procedure, as the ground truth labels are nonexistent. Unfortunately, spectral clustering is not included in this study, as the computational complexity of the basic approach did not allow for enough scalability. On the other hand, a two-step approach [<xref ref-type="bibr" rid="CR29">29</xref>] did not lead to convergence. Additionally, spatial clustering [<xref ref-type="bibr" rid="CR27">27</xref>] does not consider modified spatial strides in the third dimension. The same clusters are presented in Fig. <xref rid="Fig11" ref-type="fig">11</xref> on each 6th consecutive slice.<fig id="Fig11"><label>Fig. 11</label><caption><p>Serial slices of the 3D mouse kidney data. Clusters are visualised on each sixth slice. Cluster colours were normalised to match between configurations for easy comparison</p></caption><graphic xlink:href="12859_2022_5093_Fig11_HTML" id="MO11"/></fig></p>
    </sec>
  </sec>
  <sec id="Sec12">
    <title>Discussion</title>
    <sec id="Sec13">
      <title>Oral squamous cell carcinoma</title>
      <p id="Par78">As shown in Fig. <xref rid="Fig8" ref-type="fig">8</xref>, it is possible to observe varying capabilities for heterogeneity detection depending on the selected methods for clustering and global feature selection. For example, UMAP combined with spatial clustering did not create clusters overlapping with biological structures (Dice index 0.00, Rand index 0.00, see Table <xref rid="Tab1" ref-type="table">1</xref>), even though both spatial clustering and UMAP tend to exhibit the potential for capturing the necessary detail (see Fig. <xref rid="Fig8" ref-type="fig">8</xref>). One can observe similar results for the Xception-based feature engineering combined with spectral clustering.</p>
      <p id="Par79">In contrast, spatial clustering with EXIMS-based global feature engineering approximated the tumour region with the highest Dice index and the top ROIs composition expressed via Rand index. Neural ion images with spatial clustering yield the second-highest Dice index and the third-highest Rand index. However, these are not the only criteria used by medical experts during the quality assessment.</p>
      <p id="Par80">A visual comparison between clusters (Fig. <xref rid="Fig8" ref-type="fig">8</xref>) and pathologist-annotated ROIs (Fig. <xref rid="Fig5" ref-type="fig">5</xref>) shows that DiviK yields relatively stable regions regardless of the global feature engineering method. Table <xref rid="Tab2" ref-type="table">2</xref> seems to support that statement, as the standard deviation of the Dice index and adjusted Rand index is the lowest of all clustering methods. Spectral clustering with the most basic features (no global feature engineering or knee PCA) seems to discover similar regions.</p>
      <p id="Par81">Xception-based feature engineering method resulted in much less consistent regions discovered with K-means and DiviK. Two hypotheses seem probable explanations for this phenomenon:<list list-type="bullet"><list-item><p id="Par82">Neural ion images amplified noise. Grouping of ion images deduplicates features; however, it increases the proportional representation of the noise-related mass channels compared to the original dataset. The results of spatial clustering seem to support this hypothesis, as its embedded bilateral filter reduces noise.</p></list-item><list-item><p id="Par83">The original ion image normalisation based on winsorisation and scaling is not sufficient for this dataset. The contrast of the patches analysed by the Xception network is too small to generate useful embedding. Since the approach proposed by the authors [<xref ref-type="bibr" rid="CR37">37</xref>] formalises the visual similarity of ion maps, it could probably be useful to apply classical ion image normalisation [<xref ref-type="bibr" rid="CR46">46</xref>] to enhance the contrast first.</p></list-item></list>The comparison of global feature engineering methods is much less conclusive than the comparison of clustering methods. There does not seem to be any simple rule that could yield outstanding stability or performance against varying clustering methods. While EXIMS PCA and no global feature engineering seem to demonstrate increased tumour reconstruction capabilities (as expressed through the Dice index), at the same time, these yield a medium EXIMS score.</p>
      <p id="Par84">Finally, the EXIMS score and the <italic>overall quality</italic> concept allow us to assess the trade-off between the agreement measures and the visual consistency of clusters. We defined the <italic>overall quality</italic> in two ways:<list list-type="bullet"><list-item><p id="Par85"><italic>overall quality d(0, 0, 0)</italic>—it is the length of the vector in 3D space defined by the values of quality indices and the origin of the coordinate system (see Fig. <xref rid="Fig7" ref-type="fig">7</xref>). The better the clustering result, the higher the value.</p></list-item><list-item><p id="Par86"><italic>overall quality d(1, 1, 1)</italic>—it is the length of the vector in 3D space defined by the values of quality indices and their maximal theoretical value in point (1, 1, 1). The better the clustering result, the lower the value.</p></list-item></list>Naturally, the most consistent segmentations achieve the top EXIMS score: cases that yield a single cluster (spatial clustering with UMAP) or completely miss one of the ROIs (K-means with PCA). Since these are not relevant from the medical point of view, we bind their relative EXIMS score at 1.0 for further consideration. The DiviK clustering without a global feature engineering technique achieved the next top EXIMS score. That renders its <italic>overall quality d(0, 0, 0)</italic> the top one. We obtained the following two best results in terms of <italic>overall quality d(0, 0, 0)</italic> using Spatial clustering with EXIMS PCA-based feature engineering and Spectral clustering with PCA. At the same time, the <italic>overall quality d(1, 1, 1)</italic> indicates Spatial clustering with EXIMS PCA-based feature engineering as the top result. Spatial clustering over Xception-generated features and DiviK clustering with UMAP feature engineering yield the next two best scores.</p>
      <p id="Par87">Table <xref rid="Tab1" ref-type="table">1</xref> ranks the individual configurations’ scores (tumour coverage, overall composition and cluster consistency) for a qualitative comparison. The lower the rank, the better the result. The lowest ranks appear consecutively for Spatial clustering with EXIMS PCA-based feature engineering, Spatial clustering over neural ion images, and DiviK with no feature engineering. Table <xref rid="Tab4" ref-type="table">4</xref> continues the ranking for clustering methods. DiviK exhibits the lowest ranks for tumour coverage and overall composition, while K-means exhibits the lowest for cluster consistency.</p>
      <p id="Par88">One can find DiviK with no feature engineering method scores within the top three in each of the aggregated overall quality measures. Sums of ranks ranged from 16 to 53. DiviK with no feature engineering was assigned a sum of ranks equal to 20.5, which is around 12% of the observed quality measure range. Overall quality <italic>d</italic>(0, 0, 0) ranged from 0.8122 to 1.3560, with a top value of 1.3560 for DiviK. Overall quality <italic>d</italic>(1, 1, 1) ranged from 0.4438 to 1.4142. DiviK with UMAP feature engineering was around 7% of the observed quality measure range.<table-wrap id="Tab3"><label>Table 3</label><caption><p>Average quality indices for global feature engineering methods with OSCC data</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Global feature engineering method</th><th align="left">Adjusted Rand index</th><th align="left">Dice index</th><th align="left">Relative EXIMS score</th><th align="left">Overall quality <italic>d</italic>(0, 0, 0)</th><th align="left">Overall quality <italic>d</italic>(1, 1, 1)</th></tr></thead><tbody><tr><td align="left">UMAP</td><td align="left">0.364 (0.288)</td><td align="left">0.511 (0.371)</td><td align="left">0.742 (0.180)</td><td align="left">1.052 (0.190)</td><td align="left">0.881 (0.407)</td></tr><tr><td align="left">Xception</td><td align="left">0.346 (0.271)</td><td align="left">0.487 (0.361)</td><td align="left"><bold><italic>0.886 (0.138)</italic></bold></td><td align="left">1.139 (0.124)</td><td align="left">0.868 (0.397)</td></tr><tr><td align="left">Knee PCA</td><td align="left">0.447 (0.123)</td><td align="left">0.538 (0.359)</td><td align="left">0.871 (0.144)</td><td align="left">1.167 (0.105)</td><td align="left">0.766 (0.315)</td></tr><tr><td align="left">EXIMS PCA</td><td align="left"><bold><italic>0.585 (0.094)</italic></bold></td><td align="left"><bold><italic>0.725 (0.151)</italic></bold></td><td align="left">0.703(0.090)</td><td align="left">1.176 (0.100)</td><td align="left"><bold><italic>0.596 (0.119)</italic></bold></td></tr><tr><td align="left">None</td><td align="left">0.508 (0.116)</td><td align="left">0.703 (0.134)</td><td align="left">0.846 (0.168)</td><td align="left"><bold><italic>1.227 (0.091)</italic></bold></td><td align="left">0.620 (0.141)</td></tr></tbody></table><table-wrap-foot><p>Standard deviation is presented in brackets. Top value of a quality index among clustering methods is presented in bold italics</p></table-wrap-foot></table-wrap></p>
      <p id="Par89">Similarly as for the basic quality measures, Table <xref rid="Tab2" ref-type="table">2</xref> and <xref rid="Tab3" ref-type="table">3</xref> summarize also both variants of <italic>overall quality</italic>. On average, DiviK appears to be the most distant from the origin (mean <inline-formula id="IEq6"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$d(0,0,0)=1.236$$\end{document}</tex-math><mml:math id="M12"><mml:mrow><mml:mi>d</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mn>1.236</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_5093_Article_IEq6.gif"/></alternatives></inline-formula>) and the closest to the theoretical maximum of quality measures (mean <inline-formula id="IEq7"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$d(1,1,1)=0.576$$\end{document}</tex-math><mml:math id="M14"><mml:mrow><mml:mi>d</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mn>0.576</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_5093_Article_IEq7.gif"/></alternatives></inline-formula>) as its good clustering results do not depend so much on the feature engineering techniques applied. The local subcluster-driven feature space adaptation allows reducing the domain significantly by filtering the less informative and noise-level signals. The second top is the spatial clustering with mean <inline-formula id="IEq8"><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$d(0,0,0)=1.192$$\end{document}</tex-math><mml:math id="M16"><mml:mrow><mml:mi>d</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mn>1.192</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_5093_Article_IEq8.gif"/></alternatives></inline-formula> and mean <inline-formula id="IEq9"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$d(1,1,1)=0.706$$\end{document}</tex-math><mml:math id="M18"><mml:mrow><mml:mi>d</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mn>0.706</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_5093_Article_IEq9.gif"/></alternatives></inline-formula>. The Cohen’s effect size in differences between these two approaches is close to medium and equals to 0.435 for <italic>d</italic>(0, 0, 0) and 0.451 for <italic>d</italic>(1, 1, 1). While the feature engineering techniques for other than DiviK methods are a concern, the first choice should be EXIMS PCA as it outperforms the other techniques tested. In the case of DiviK, no feature engineering is recommended.</p>
      <p id="Par90">We conducted a qualitative evaluation of the effect of the feature engineering method and clustering algorithm on the clustering results quality. Table <xref rid="Tab6" ref-type="table">6</xref> shows the partial <inline-formula id="IEq10"><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\eta ^2$$\end{document}</tex-math><mml:math id="M20"><mml:msup><mml:mi>η</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:math><inline-graphic xlink:href="12859_2022_5093_Article_IEq10.gif"/></alternatives></inline-formula> effect size and Kendall’s W concordance coefficient on the considered quality indices. The partial <inline-formula id="IEq11"><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\eta ^2$$\end{document}</tex-math><mml:math id="M22"><mml:msup><mml:mi>η</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:math><inline-graphic xlink:href="12859_2022_5093_Article_IEq11.gif"/></alternatives></inline-formula> effect size values exceed the 0.14 large effect size threshold. The choice of the clustering method influences the Dice and Rand indices more than the feature engineering method. The remaining quality measure (EXIMS score) is, as expected, stronger influenced by the feature engineering method, and the clustering method is less relevant. While an overall quality is considered, choice of clustering algorithm is more important than feature engineering techniques applied.</p>
    </sec>
    <sec id="Sec14">
      <title>Mouse kidney 3D</title>
      <p id="Par91">Published benchmark datasets [<xref ref-type="bibr" rid="CR45">45</xref>] are oriented explicitly on high-scale computations. The risk of missing the crucial details increases significantly for such a scale. Moreover, it renders many methods useless due to their computational complexity. Therefore, additional modifications are sometimes required [<xref ref-type="bibr" rid="CR29">29</xref>], yet insufficient.</p>
      <p id="Par92">As shown in Fig. <xref rid="Fig10" ref-type="fig">10</xref>, the high-level composition of the medical sample is generally consistent between the configurations. The most straightforward configuration of K-means clustering with no global feature engineering yields a single cluster for the whole dataset.</p>
      <p id="Par93">The structures discovered via K-means and DiviK algorithms look consistent compared to other work [<xref ref-type="bibr" rid="CR30">30</xref>, <xref ref-type="bibr" rid="CR35">35</xref>, <xref ref-type="bibr" rid="CR47">47</xref>] that has analysed this data. The detected regions share a molecular signature across the 3D volume and exhibit functional differences.</p>
      <p id="Par94">Algorithms were ranked concerning their scalability limits; Table <xref rid="Tab4" ref-type="table">4</xref> sums the ranks. K-means and DiviK were the only algorithms that completed computations and were assigned the best ranks.<table-wrap id="Tab4"><label>Table 4</label><caption><p>High-level summary of clustering algorithm characteristics</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left"/><th align="left">Spectral clustering</th><th align="left">K-means</th><th align="left">Spatial clustering</th><th align="left">DiviK</th></tr></thead><tbody><tr><td align="left">Rand index ranks</td><td align="left">62.5</td><td align="left">71</td><td align="left">40.5</td><td align="left"><bold><italic>36</italic></bold></td></tr><tr><td align="left">Dice index ranks</td><td align="left">59</td><td align="left">75</td><td align="left">39</td><td align="left"><bold><italic>37</italic></bold></td></tr><tr><td align="left">EXIMS score ranks</td><td align="left">62.5</td><td align="left"><bold><italic>38.5</italic></bold></td><td align="left">52.5</td><td align="left">56.5</td></tr><tr><td align="left">Scalability ranks</td><td align="left">72.5</td><td align="left"><bold><italic>32﻿.5</italic></bold></td><td align="left">72.5</td><td align="left"><bold><italic>32.5</italic></bold></td></tr><tr><td align="left">Total rank</td><td align="left">256.5</td><td align="left">217</td><td align="left">204.5</td><td align="left"><bold><italic>162</italic></bold></td></tr></tbody></table><table-wrap-foot><p>Contains sum of ranks for each criterion (lower is better). Top rank of a quality index across clustering methods is presented in bold italics</p></table-wrap-foot></table-wrap><table-wrap id="Tab5"><label>Table 5</label><caption><p>High-level summary of feature engineering characteristics</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left"/><th align="left">UMAP</th><th align="left">Xception</th><th align="left">Knee PCA</th><th align="left">EXIMS PCA</th><th align="left">None</th></tr></thead><tbody><tr><td align="left">Rand index ranks</td><td align="left">48.5</td><td align="left">52.5</td><td align="left">49</td><td align="left"><bold><italic>25</italic></bold></td><td align="left">35</td></tr><tr><td align="left">Dice index ranks</td><td align="left">48</td><td align="left">51</td><td align="left">49</td><td align="left"><bold><italic>28</italic></bold></td><td align="left">34</td></tr><tr><td align="left">EXIMS score ranks</td><td align="left">51.5</td><td align="left">32.5</td><td align="left"><bold><italic>29.5</italic></bold></td><td align="left">60</td><td align="left">36.5</td></tr><tr><td align="left">Scalability ranks</td><td align="left"><bold><italic>38</italic></bold></td><td align="left"><bold><italic>58</italic></bold></td><td align="left"><bold><italic>38</italic></bold></td><td align="left"><bold><italic>38</italic></bold></td><td align="left"><bold><italic>38</italic></bold></td></tr><tr><td align="left">Total rank</td><td align="left">186</td><td align="left">194</td><td align="left">165.5</td><td align="left">151</td><td align="left"><bold><italic>143.5</italic></bold></td></tr></tbody></table><table-wrap-foot><p>Contains sum of ranks for each criterion (lower is better). Top rank of a quality index per clustering method is presented in bold italics</p></table-wrap-foot></table-wrap><table-wrap id="Tab6"><label>Table 6</label><caption><p>Qualitive evaluation of the effect of the feature engineering method and clustering algorithm. We conducted Kruskal-Wallis test and effect size used in the table is partial <inline-formula id="IEq12"><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\eta ^2$$\end{document}</tex-math><mml:math id="M24"><mml:msup><mml:mi>η</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:math><inline-graphic xlink:href="12859_2022_5093_Article_IEq12.gif"/></alternatives></inline-formula>. Furthermore, we calculated Kendall’s W concordance index</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Quality measure</th><th align="left">Feature engineering</th><th align="left">Clustering</th></tr></thead><tbody><tr><td align="left" colspan="3">Partial <inline-formula id="IEq13"><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\eta ^2$$\end{document}</tex-math><mml:math id="M26"><mml:msup><mml:mi>η</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:math><inline-graphic xlink:href="12859_2022_5093_Article_IEq13.gif"/></alternatives></inline-formula></td></tr><tr><td align="left"> Rand index</td><td align="left">0.203</td><td align="left">0.258</td></tr><tr><td align="left"> Dice index</td><td align="left">0.161</td><td align="left">0.293</td></tr><tr><td align="left"> EXIMS</td><td align="left">0.262</td><td align="left">0.095</td></tr><tr><td align="left"> Overall quality <italic>d</italic>(0, 0, 0)</td><td align="left">0.141</td><td align="left">0.345</td></tr><tr><td align="left"> Overall quality <italic>d</italic>(1, 1, 1)</td><td align="left">0.122</td><td align="left">0.309</td></tr><tr><td align="left" colspan="3">Kendall’s W Concordance Index</td></tr><tr><td align="left"> Rand index</td><td align="left">0.328</td><td align="left">0.325</td></tr><tr><td align="left"> Dice index</td><td align="left">0.328</td><td align="left">0.325</td></tr><tr><td align="left"> EXIMS</td><td align="left">0.136</td><td align="left">0.375</td></tr><tr><td align="left"> Overall quality <italic>d</italic>(0, 0, 0)</td><td align="left">0.424</td><td align="left">0.138</td></tr><tr><td align="left"> Overall quality <italic>d</italic>(1, 1, 1)</td><td align="left">0.472</td><td align="left">0.138</td></tr></tbody></table></table-wrap></p>
      <p id="Par95">DiviK approach does not require applying PCA or UMAP globally. The GMM-based feature filtration/selection is applied to optimise the feature space locally. Thanks to that approach, the internal structure, dominated by the main clusters, might be revealed in the subsequent divisive steps. We used PCA and UMAP-based pipelines for reference in the comparison study, and they are not a part of the proposed DiviK algorithm. We completed these pipelines using a machine equipped with 48 CPU cores and 256 GB RAM, correspondingly in 23.8 min (PCA) and 198.5 min (UMAP).</p>
      <p id="Par96">On the contrary, the GMM-based filtering procedure for the full mouse kidney dataset completes on average within 8.66 seconds (156 ms standard deviation). Due to the deglomerative pipeline of the DiviK algorithm and local optimisation of the feature space, the filtering procedure is repeated per each splitting step, which led in the case of the mouse kidney dataset up to 60 decompositions for different subregions of this tissue sample. It gives, on average, less than 9 min (8.66) in total.</p>
    </sec>
  </sec>
  <sec id="Sec15">
    <title>Conclusions</title>
    <p id="Par97">The comprehensive comparative study considering several aspects of data exploration demonstrated that DiviK is a tool that provides a reasonable trade-off between the accuracy of unsupervised heterogeneity discovery and the consistency of obtained clusters. DiviK appears to be scalable and robust enough to cope with both small- and large-scale MSI data. Moreover, it is also insensitive to modifications of the preprocessing pipeline. Compared with other configurations already proven effective for MSI, we showed that DiviK might be feasible for real-world applications when applied to solve a complex multi-dimensional problem. DiviK provides researchers with additional insight into which features were the most important for the differentiation of a specific region, which could be a subject of an even more comprehensive analysis, crucial for doctors to understand the underlying phenomena.</p>
    <p id="Par98">One could easily extend the DiviK framework to support other kinds of -omics data, with slight adjustments to the similarity measure and local filtering schema. The heterogeneity investigations based on epigenetic, transcriptomic, proteomic and metabolomic profiles require no modifications to the algorithm. Applying the DiviK algorithm to genomics data (GWAS-type) will require the application of a data-specific similarity measure and careful selection of the characteristic for the local feature filtering scheme. Finally, it is worth noting that the DiviK algorithm does not take advantage of any specific characteristics of the MSI data. Therefore, one could apply DiviK as a generic clustering algorithm, useful for grouping images after appropriate embedding (including medical images) or any other kind of tabular data.</p>
  </sec>
</body>
<back>
  <glossary>
    <title>Abbreviations</title>
    <def-list>
      <def-item>
        <term>cdf</term>
        <def>
          <p id="Par4">Cumulative distribution function</p>
        </def>
      </def-item>
      <def-item>
        <term>CLI</term>
        <def>
          <p id="Par5">Command-line interface</p>
        </def>
      </def-item>
      <def-item>
        <term>DiviK</term>
        <def>
          <p id="Par6">Divisive intelligent K-means</p>
        </def>
      </def-item>
      <def-item>
        <term>GMM</term>
        <def>
          <p id="Par7">Gaussian mixture modeling</p>
        </def>
      </def-item>
      <def-item>
        <term>HDDC</term>
        <def>
          <p id="Par8">High-dimensional data clustering</p>
        </def>
      </def-item>
      <def-item>
        <term>MSI</term>
        <def>
          <p id="Par9">Mass spectrometry imaging</p>
        </def>
      </def-item>
      <def-item>
        <term>OSCC</term>
        <def>
          <p id="Par10">Oral squamous cell carcinoma</p>
        </def>
      </def-item>
      <def-item>
        <term>PCA</term>
        <def>
          <p id="Par11">Principal components analysis</p>
        </def>
      </def-item>
      <def-item>
        <term>ROI</term>
        <def>
          <p id="Par12">Region of interest</p>
        </def>
      </def-item>
      <def-item>
        <term>ToF</term>
        <def>
          <p id="Par13">Time-of-flight</p>
        </def>
      </def-item>
      <def-item>
        <term>UMAP</term>
        <def>
          <p id="Par14">Universal manifold approximation and projection</p>
        </def>
      </def-item>
    </def-list>
  </glossary>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher’s Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <ack>
    <title>Acknowledgements</title>
    <p>We would like to thank Piotr Widłak, Monika Pietrowska, Marta Gawin and Mykola Chekan from Maria Skłodowska-Curie National Research Institute of Oncology, Gliwice branch, for providing the necessary biological and MSI data acquisition background. Finally, we would like to thank Katarzyna Frątczak for help in data preprocessing.</p>
    <sec id="d32e2806">
      <title>Availability and requirements</title>
      <p id="Par99">Project name: DiviK; Project home page: <ext-link ext-link-type="uri" xlink:href="https://github.com/gmrukwa/divik/">https://github.com/gmrukwa/divik/</ext-link>; Operating system(s): Linux, Windows, Mac; Programming language: Python (<inline-formula id="IEq14"><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\ge$$\end{document}</tex-math><mml:math id="M28"><mml:mo>≥</mml:mo></mml:math><inline-graphic xlink:href="12859_2022_5093_Article_IEq14.gif"/></alternatives></inline-formula>3.6); License: Apache 2.0; Any restrictions to use by non-academics: none.</p>
    </sec>
  </ack>
  <notes notes-type="author-contribution">
    <title>Author contributions</title>
    <p>JP and GM designed the DiviK core algorithm. GM implemented the scripts, performed the tests, and developed the package for PyPI submission. JP and GM wrote the manuscript. JP critically revised the work. All authors read and approved the final manuscript.</p>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>Grzegorz Mrukwa was awarded the scholarship from NCBiR Grant AIDA No. I029/17-POWR.03.02.00-IP.08-00-DOK/17. This project was financially supported by NCN Grant BITIMS No. UMO-2015/19/B/ST6/01736 for data acquisition and numerical simulations.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and materials</title>
    <p>OSCC dataset is available from Zenodo repository [<xref ref-type="bibr" rid="CR48">48</xref>]. 3D Mouse Kidney dataset is available from GigaScience Database [<xref ref-type="bibr" rid="CR49">49</xref>].</p>
  </notes>
  <notes>
    <title>Declarations</title>
    <notes id="FPar1">
      <title>Ethics approval and consent to participate</title>
      <p id="Par100">Not applicable.</p>
    </notes>
    <notes id="FPar2">
      <title>Consent for publication</title>
      <p id="Par101">Not applicable.</p>
    </notes>
    <notes id="FPar4" notes-type="COI-statement">
      <title>Competing interests</title>
      <p id="Par102">The authors declare that they have no competing interests.</p>
    </notes>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Aichler</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Walch</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>MALDI imaging mass spectrometry: current frontiers and perspectives in pathology research and practice</article-title>
        <source>Lab Investig</source>
        <year>2015</year>
        <volume>95</volume>
        <issue>4</issue>
        <fpage>422</fpage>
        <lpage>31</lpage>
        <pub-id pub-id-type="doi">10.1038/labinvest.2014.156</pub-id>
        <pub-id pub-id-type="pmid">25621874</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Miura</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Fujimura</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Yamato</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Hyodo</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Utsumi</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Tachibana</surname>
            <given-names>H</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Ultrahighly sensitive in situ metabolomic imaging for visualizing spatiotemporal metabolic behaviors</article-title>
        <source>Anal Chem</source>
        <year>2010</year>
        <volume>82</volume>
        <issue>23</issue>
        <fpage>9789</fpage>
        <lpage>96</lpage>
        <pub-id pub-id-type="doi">10.1021/ac101998z</pub-id>
        <pub-id pub-id-type="pmid">21043438</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <mixed-citation publication-type="other">Hattori K, Kajimura M, Hishiki T, Nakanishi T, Kubo A, Nagahata Y, et al. Paradoxical ATP elevation in ischemic penumbra revealed by quantitative imaging mass spectrometry. NY: Mary Ann Liebert, Inc.; 2010.</mixed-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Djidja</surname>
            <given-names>MC</given-names>
          </name>
          <name>
            <surname>Claude</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Snel</surname>
            <given-names>MF</given-names>
          </name>
          <name>
            <surname>Francese</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Scriven</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Carolan</surname>
            <given-names>V</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Novel molecular tumour classification using MALDI-mass spectrometry imaging of tissue micro-array</article-title>
        <source>Anal Bioanal Chem</source>
        <year>2010</year>
        <volume>397</volume>
        <issue>2</issue>
        <fpage>587</fpage>
        <lpage>601</lpage>
        <pub-id pub-id-type="doi">10.1007/s00216-010-3554-6</pub-id>
        <pub-id pub-id-type="pmid">20204332</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Morita</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Ikegami</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Goto-Inoue</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Hayasaka</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Zaima</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Tanaka</surname>
            <given-names>H</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Imaging mass spectrometry of gastric carcinoma in formalin-fixed paraffin-embedded tissue microarray</article-title>
        <source>Cancer Sci</source>
        <year>2010</year>
        <volume>101</volume>
        <issue>1</issue>
        <fpage>267</fpage>
        <lpage>73</lpage>
        <pub-id pub-id-type="doi">10.1111/j.1349-7006.2009.01384.x</pub-id>
        <pub-id pub-id-type="pmid">19961487</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Groseclose</surname>
            <given-names>MR</given-names>
          </name>
          <name>
            <surname>Massion</surname>
            <given-names>PP</given-names>
          </name>
          <name>
            <surname>Chaurand</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Caprioli</surname>
            <given-names>RM</given-names>
          </name>
        </person-group>
        <article-title>High-throughput proteomic analysis of formalin-fixed paraffin-embedded tissue microarrays using MALDI imaging mass spectrometry</article-title>
        <source>Proteomics</source>
        <year>2008</year>
        <volume>8</volume>
        <issue>18</issue>
        <fpage>3715</fpage>
        <lpage>24</lpage>
        <pub-id pub-id-type="doi">10.1002/pmic.200800495</pub-id>
        <pub-id pub-id-type="pmid">18712763</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Quaas</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Bahar</surname>
            <given-names>AS</given-names>
          </name>
          <name>
            <surname>von Loga</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Seddiqi</surname>
            <given-names>AS</given-names>
          </name>
          <name>
            <surname>Singer</surname>
            <given-names>JM</given-names>
          </name>
          <name>
            <surname>Omidi</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>MALDI imaging on large-scale tissue microarrays identifies molecular features associated with tumour phenotype in oesophageal cancer</article-title>
        <source>Histopathology</source>
        <year>2013</year>
        <volume>63</volume>
        <issue>4</issue>
        <fpage>455</fpage>
        <lpage>62</lpage>
        <pub-id pub-id-type="pmid">23855813</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Steurer</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Borkowski</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Odinga</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Buchholz</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Koop</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Huland</surname>
            <given-names>H</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>MALDI mass spectrometric imaging based identification of clinically relevant signals in prostate cancer using large-scale tissue microarrays</article-title>
        <source>Int J Cancer</source>
        <year>2013</year>
        <volume>133</volume>
        <issue>4</issue>
        <fpage>920</fpage>
        <lpage>8</lpage>
        <pub-id pub-id-type="doi">10.1002/ijc.28080</pub-id>
        <pub-id pub-id-type="pmid">23381989</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <mixed-citation publication-type="other">Pietrowska M, Diehl HC, Mrukwa G, Kalinowska-Herok M, Gawin M, Chekan M, et al. Molecular profiles of thyroid cancer subtypes: classification based on features of tissue revealed by mass spectrometry imaging. Biochimica et Biophysica Acta (BBA) Proteins Proteom. 2017;1865(7):837–45.</mixed-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Martinez-Outschoorn</surname>
            <given-names>UE</given-names>
          </name>
          <name>
            <surname>Peiris-Pagés</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Pestell</surname>
            <given-names>RG</given-names>
          </name>
          <name>
            <surname>Sotgia</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Lisanti</surname>
            <given-names>MP</given-names>
          </name>
        </person-group>
        <article-title>Cancer metabolism: a therapeutic perspective</article-title>
        <source>Nat Rev Clin Oncol</source>
        <year>2017</year>
        <volume>14</volume>
        <issue>1</issue>
        <fpage>11</fpage>
        <lpage>31</lpage>
        <pub-id pub-id-type="doi">10.1038/nrclinonc.2016.60</pub-id>
        <pub-id pub-id-type="pmid">27141887</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Vos</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Ellis</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Balluff</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Heeren</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Experimental and data analysis considerations for three-dimensional mass spectrometry imaging in biomedical research</article-title>
        <source>Mol Imaging Biol</source>
        <year>2020</year>
        <volume>66</volume>
        <fpage>1</fpage>
        <lpage>11</lpage>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Palmer</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Phapale</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Chernyavsky</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Lavigne</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Fay</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Tarasov</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>FDR-controlled metabolite annotation for high-resolution imaging mass spectrometry</article-title>
        <source>Nat Methods</source>
        <year>2017</year>
        <volume>14</volume>
        <issue>1</issue>
        <fpage>57</fpage>
        <lpage>60</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.4072</pub-id>
        <pub-id pub-id-type="pmid">27842059</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <mixed-citation publication-type="other">METASPACE annotation platform: datasets summary. Accessed 14 June 2020. <ext-link ext-link-type="uri" xlink:href="https://metaspace2020.eu/datasets/summary">https://metaspace2020.eu/datasets/summary</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Polanski</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Marczyk</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Pietrowska</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Widlak</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Polanska</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Signal partitioning algorithm for highly efficient Gaussian mixture modeling in mass spectrometry</article-title>
        <source>PLoS ONE</source>
        <year>2015</year>
        <volume>10</volume>
        <issue>7</issue>
        <fpage>66</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0134256</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jones</surname>
            <given-names>EA</given-names>
          </name>
          <name>
            <surname>van Remoortere</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>van Zeijl</surname>
            <given-names>RJ</given-names>
          </name>
          <name>
            <surname>Hogendoorn</surname>
            <given-names>PC</given-names>
          </name>
          <name>
            <surname>Bovée</surname>
            <given-names>JV</given-names>
          </name>
          <name>
            <surname>Deelder</surname>
            <given-names>AM</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Multiple statistical analysis techniques corroborate intratumor heterogeneity in imaging mass spectrometry datasets of myxofibrosarcoma</article-title>
        <source>PLoS ONE</source>
        <year>2011</year>
        <volume>6</volume>
        <issue>9</issue>
        <fpage>e24913</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0024913</pub-id>
        <pub-id pub-id-type="pmid">21980364</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <mixed-citation publication-type="other">Thomas SA, Race AM, Steven RT, Gilmore IS, Bunch J. Dimensionality reduction of mass spectrometry imaging data using autoencoders. In: IEEE symposium series on computational intelligence (SSCI). IEEE; 2016. p. 1–7.</mixed-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Veselkov</surname>
            <given-names>KA</given-names>
          </name>
          <name>
            <surname>Mirnezami</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Strittmatter</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Goldin</surname>
            <given-names>RD</given-names>
          </name>
          <name>
            <surname>Kinross</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Speller</surname>
            <given-names>AV</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Chemo-informatic strategy for imaging mass spectrometry-based hyperspectral profiling of lipid signatures in colorectal cancer</article-title>
        <source>Proc Natl Acad Sci</source>
        <year>2014</year>
        <volume>111</volume>
        <issue>3</issue>
        <fpage>1216</fpage>
        <lpage>21</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.1310524111</pub-id>
        <pub-id pub-id-type="pmid">24398526</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Verbeeck</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Caprioli</surname>
            <given-names>RM</given-names>
          </name>
          <name>
            <surname>Van de Plas</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Unsupervised machine learning for exploratory data analysis in imaging mass spectrometry</article-title>
        <source>Mass Spectrom Rev</source>
        <year>2020</year>
        <volume>39</volume>
        <issue>3</issue>
        <fpage>245</fpage>
        <lpage>91</lpage>
        <pub-id pub-id-type="doi">10.1002/mas.21602</pub-id>
        <pub-id pub-id-type="pmid">31602691</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Postma</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>van den Herik</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>van der Maaten</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <article-title>Dimensionality reduction: a comparative review</article-title>
        <source>J Mach Learn Res</source>
        <year>2009</year>
        <volume>10</volume>
        <issue>1–41</issue>
        <fpage>66</fpage>
        <lpage>71</lpage>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dunn</surname>
            <given-names>JC</given-names>
          </name>
        </person-group>
        <article-title>Well-separated clusters and optimal fuzzy partitions</article-title>
        <source>J Cybernet</source>
        <year>1974</year>
        <volume>4</volume>
        <issue>1</issue>
        <fpage>95</fpage>
        <lpage>104</lpage>
        <pub-id pub-id-type="doi">10.1080/01969727408546059</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lawrence</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Phipps</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Comparing partitions</article-title>
        <source>J Classif</source>
        <year>1985</year>
        <volume>2</volume>
        <issue>1</issue>
        <fpage>193</fpage>
        <lpage>218</lpage>
        <pub-id pub-id-type="doi">10.1007/BF01908075</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lipor</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Balzano</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <article-title>Clustering quality metrics for subspace clustering</article-title>
        <source>Pattern Recognit</source>
        <year>2020</year>
        <volume>66</volume>
        <fpage>107</fpage>
        <lpage>328</lpage>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <mixed-citation publication-type="other">Rodriguez MZ, Comin CH, Casanova D, Bruno OM, Amancio DR, Costa LdF, et al. Clustering algorithms: a comparative approach. PLoS ONE. 2019;14(1):e0210236.</mixed-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Deininger</surname>
            <given-names>SO</given-names>
          </name>
          <name>
            <surname>Ebert</surname>
            <given-names>MP</given-names>
          </name>
          <name>
            <surname>Futterer</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Gerhard</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Rocken</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>MALDI imaging combined with hierarchical clustering as a new tool for the interpretation of complex human cancers</article-title>
        <source>J Proteome Res</source>
        <year>2008</year>
        <volume>7</volume>
        <issue>12</issue>
        <fpage>5230</fpage>
        <lpage>6</lpage>
        <pub-id pub-id-type="doi">10.1021/pr8005777</pub-id>
        <pub-id pub-id-type="pmid">19367705</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bouveyron</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Girard</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Schmid</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>High-dimensional data clustering</article-title>
        <source>Comput Stat Data Anal</source>
        <year>2007</year>
        <volume>52</volume>
        <issue>1</issue>
        <fpage>502</fpage>
        <lpage>19</lpage>
        <pub-id pub-id-type="doi">10.1016/j.csda.2007.02.009</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Alexandrov</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Becker</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>So</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Ernst</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Wehder</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Grasmair</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Spatial segmentation of imaging mass spectrometry data with edge-preserving image denoising and clustering</article-title>
        <source>J Proteome Res</source>
        <year>2010</year>
        <volume>9</volume>
        <issue>12</issue>
        <fpage>6535</fpage>
        <lpage>6546</lpage>
        <pub-id pub-id-type="doi">10.1021/pr100734z</pub-id>
        <pub-id pub-id-type="pmid">20954702</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Alexandrov</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Kobarg</surname>
            <given-names>JH</given-names>
          </name>
        </person-group>
        <article-title>Efficient spatial segmentation of large imaging mass spectrometry datasets with spatially aware clustering</article-title>
        <source>Bioinformatics</source>
        <year>2011</year>
        <volume>27</volume>
        <issue>13</issue>
        <fpage>i230</fpage>
        <lpage>8</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btr246</pub-id>
        <pub-id pub-id-type="pmid">21685075</pub-id>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wijetunge</surname>
            <given-names>CD</given-names>
          </name>
          <name>
            <surname>Saeed</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Boughton</surname>
            <given-names>BA</given-names>
          </name>
          <name>
            <surname>Spraggins</surname>
            <given-names>JM</given-names>
          </name>
          <name>
            <surname>Caprioli</surname>
            <given-names>RM</given-names>
          </name>
          <name>
            <surname>Bacic</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>EXIMS: an improved data analysis pipeline based on a new peak picking method for EXploring Imaging Mass Spectrometry data</article-title>
        <source>Bioinformatics</source>
        <year>2015</year>
        <volume>31</volume>
        <issue>19</issue>
        <fpage>3198</fpage>
        <lpage>206</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btv356</pub-id>
        <pub-id pub-id-type="pmid">26063840</pub-id>
      </element-citation>
    </ref>
    <ref id="CR29">
      <label>29.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dexter</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Race</surname>
            <given-names>AM</given-names>
          </name>
          <name>
            <surname>Steven</surname>
            <given-names>RT</given-names>
          </name>
          <name>
            <surname>Barnes</surname>
            <given-names>JR</given-names>
          </name>
          <name>
            <surname>Hulme</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Goodwin</surname>
            <given-names>RJ</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Two-phase and graph-based clustering methods for accurate and efficient segmentation of large mass spectrometry images</article-title>
        <source>Anal Chem</source>
        <year>2017</year>
        <volume>89</volume>
        <issue>21</issue>
        <fpage>11293</fpage>
        <lpage>300</lpage>
        <pub-id pub-id-type="doi">10.1021/acs.analchem.7b01758</pub-id>
        <pub-id pub-id-type="pmid">28849641</pub-id>
      </element-citation>
    </ref>
    <ref id="CR30">
      <label>30.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Abdelmoula</surname>
            <given-names>WM</given-names>
          </name>
          <name>
            <surname>Pezzotti</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Hölt</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Dijkstra</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Vilanova</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>McDonnell</surname>
            <given-names>LA</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Interactive visual exploration of 3D mass spectrometry imaging data using hierarchical stochastic neighbor embedding reveals spatiomolecular structures at full data resolution</article-title>
        <source>J Proteome Res</source>
        <year>2018</year>
        <volume>17</volume>
        <issue>3</issue>
        <fpage>1054</fpage>
        <lpage>64</lpage>
        <pub-id pub-id-type="doi">10.1021/acs.jproteome.7b00725</pub-id>
        <pub-id pub-id-type="pmid">29430923</pub-id>
      </element-citation>
    </ref>
    <ref id="CR31">
      <label>31.</label>
      <mixed-citation publication-type="other">McInnes L, Healy J, Melville J. Umap: uniform manifold approximation and projection for dimension reduction. arXiv preprint <ext-link ext-link-type="uri" xlink:href="http://arxiv.org/abs/1802.03426">arXiv:1802.03426</ext-link>. 2018;.</mixed-citation>
    </ref>
    <ref id="CR32">
      <label>32.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Smets</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Verbeeck</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Claesen</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Asperger</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Griffioen</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Tousseyn</surname>
            <given-names>T</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Evaluation of distance metrics and spatial autocorrelation in uniform manifold approximation and projection applied to mass spectrometry imaging data</article-title>
        <source>Anal Chem</source>
        <year>2019</year>
        <volume>6</volume>
        <fpage>66</fpage>
      </element-citation>
    </ref>
    <ref id="CR33">
      <label>33.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Inglese</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>McKenzie</surname>
            <given-names>JS</given-names>
          </name>
          <name>
            <surname>Mroz</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Kinross</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Veselkov</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Holmes</surname>
            <given-names>E</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Deep learning and 3D-DESI imaging reveal the hidden metabolic heterogeneity of cancer</article-title>
        <source>Chem Sci</source>
        <year>2017</year>
        <volume>8</volume>
        <issue>5</issue>
        <fpage>3500</fpage>
        <lpage>11</lpage>
        <pub-id pub-id-type="doi">10.1039/C6SC03738K</pub-id>
        <pub-id pub-id-type="pmid">28507724</pub-id>
      </element-citation>
    </ref>
    <ref id="CR34">
      <label>34.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gardner</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Cutts</surname>
            <given-names>SM</given-names>
          </name>
          <name>
            <surname>Muir</surname>
            <given-names>BW</given-names>
          </name>
          <name>
            <surname>Jones</surname>
            <given-names>RT</given-names>
          </name>
          <name>
            <surname>Pigram</surname>
            <given-names>PJ</given-names>
          </name>
        </person-group>
        <article-title>Visualizing ToF-SIMS hyperspectral imaging data using color-tagged toroidal self-organizing maps</article-title>
        <source>Anal Chem</source>
        <year>2019</year>
        <volume>91</volume>
        <issue>21</issue>
        <fpage>13855</fpage>
        <lpage>65</lpage>
        <pub-id pub-id-type="doi">10.1021/acs.analchem.9b03322</pub-id>
        <pub-id pub-id-type="pmid">31549810</pub-id>
      </element-citation>
    </ref>
    <ref id="CR35">
      <label>35.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Abdelmoula</surname>
            <given-names>WM</given-names>
          </name>
          <name>
            <surname>Lopez</surname>
            <given-names>BGC</given-names>
          </name>
          <name>
            <surname>Randall</surname>
            <given-names>EC</given-names>
          </name>
          <name>
            <surname>Kapur</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Sarkaria</surname>
            <given-names>JN</given-names>
          </name>
          <name>
            <surname>White</surname>
            <given-names>FM</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Peak learning of mass spectrometry imaging data using artificial neural networks</article-title>
        <source>Nat Commun</source>
        <year>2021</year>
        <volume>12</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <lpage>13</lpage>
        <pub-id pub-id-type="doi">10.1038/s41467-021-25744-8</pub-id>
        <pub-id pub-id-type="pmid">33397941</pub-id>
      </element-citation>
    </ref>
    <ref id="CR36">
      <label>36.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wüllems</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Kölling</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Bednarz</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Niehaus</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Hans</surname>
            <given-names>VH</given-names>
          </name>
          <name>
            <surname>Nattkemper</surname>
            <given-names>TW</given-names>
          </name>
        </person-group>
        <article-title>Detection and visualization of communities in mass spectrometry imaging data</article-title>
        <source>BMC Bioinform</source>
        <year>2019</year>
        <volume>20</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <lpage>12</lpage>
        <pub-id pub-id-type="doi">10.1186/s12859-019-2890-6</pub-id>
      </element-citation>
    </ref>
    <ref id="CR37">
      <label>37.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhang</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Claesen</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Moerman</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Groseclose</surname>
            <given-names>MR</given-names>
          </name>
          <name>
            <surname>Waelkens</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>De Moor</surname>
            <given-names>B</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Spatially aware clustering of ion images in mass spectrometry imaging data using deep learning</article-title>
        <source>Anal Bioanal Chem</source>
        <year>2021</year>
        <volume>413</volume>
        <issue>10</issue>
        <fpage>2803</fpage>
        <lpage>19</lpage>
        <pub-id pub-id-type="doi">10.1007/s00216-021-03179-w</pub-id>
        <pub-id pub-id-type="pmid">33646352</pub-id>
      </element-citation>
    </ref>
    <ref id="CR38">
      <label>38.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Marczyk</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Jaksik</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Polanski</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Polanska</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Adaptive filtering of microarray gene expression data based on Gaussian mixture decomposition</article-title>
        <source>BMC Bioinform</source>
        <year>2013</year>
        <volume>14</volume>
        <issue>1</issue>
        <fpage>101</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-14-101</pub-id>
      </element-citation>
    </ref>
    <ref id="CR39">
      <label>39.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Polanski</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Marczyk</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Pietrowska</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Widlak</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Polanska</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Initializing the EM algorithm for univariate Gaussian, multi-component, heteroscedastic mixture models by dynamic programming partitions</article-title>
        <source>Int J Comput Methods</source>
        <year>2018</year>
        <volume>15</volume>
        <issue>03</issue>
        <fpage>1850012</fpage>
        <pub-id pub-id-type="doi">10.1142/S0219876218500123</pub-id>
      </element-citation>
    </ref>
    <ref id="CR40">
      <label>40.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tibshirani</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Walther</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Hastie</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>Estimating the number of clusters in a data set via the gap statistic</article-title>
        <source>J R Stat Soc Ser B Stat Methodol</source>
        <year>2001</year>
        <volume>63</volume>
        <issue>2</issue>
        <fpage>411</fpage>
        <lpage>23</lpage>
        <pub-id pub-id-type="doi">10.1111/1467-9868.00293</pub-id>
      </element-citation>
    </ref>
    <ref id="CR41">
      <label>41.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Widlak</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Mrukwa</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Kalinowska</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Pietrowska</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Chekan</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Wierzgon</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Detection of molecular signatures of oral squamous cell carcinoma and normal epithelium-application of a novel methodology for unsupervised segmentation of imaging mass spectrometry data</article-title>
        <source>Proteomics</source>
        <year>2016</year>
        <volume>16</volume>
        <issue>11–12</issue>
        <fpage>1613</fpage>
        <lpage>21</lpage>
        <pub-id pub-id-type="doi">10.1002/pmic.201500458</pub-id>
        <pub-id pub-id-type="pmid">27168173</pub-id>
      </element-citation>
    </ref>
    <ref id="CR42">
      <label>42.</label>
      <mixed-citation publication-type="other">Buitinck L, Louppe G, Blondel M, Pedregosa F, Mueller A, Grisel O, et al. API design for machine learning software: experiences from the scikit-learn project. In: ECML PKDD workshop: languages for data mining and machine learning; 2013. p. 108–22.</mixed-citation>
    </ref>
    <ref id="CR43">
      <label>43.</label>
      <mixed-citation publication-type="other">Satopaa V, Albrecht J, Irwin D, Raghavan B, Finding a “kneedle” in a haystack: Detecting knee points in system behavior. In: 31st international conference on distributed computing systems workshops. IEEE; 2011; p. 166–71.</mixed-citation>
    </ref>
    <ref id="CR44">
      <label>44.</label>
      <mixed-citation publication-type="other">Mourafiq M. Polyaxon: cloud native machine learning automation platform; 2017. <ext-link ext-link-type="uri" xlink:href="https://github.com/polyaxon/polyaxon">https://github.com/polyaxon/polyaxon</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR45">
      <label>45.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Oetjen</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Veselkov</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Watrous</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>McKenzie</surname>
            <given-names>JS</given-names>
          </name>
          <name>
            <surname>Becker</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Hauberg-Lotte</surname>
            <given-names>L</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Benchmark datasets for 3D MALDI-and DESI-imaging mass spectrometry</article-title>
        <source>GigaScience</source>
        <year>2015</year>
        <volume>4</volume>
        <issue>1</issue>
        <fpage>s13742-015</fpage>
        <pub-id pub-id-type="doi">10.1186/s13742-015-0059-4</pub-id>
      </element-citation>
    </ref>
    <ref id="CR46">
      <label>46.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Race</surname>
            <given-names>AM</given-names>
          </name>
          <name>
            <surname>Bunch</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Optimisation of colour schemes to accurately display mass spectrometry imaging data based on human colour perception</article-title>
        <source>Anal Bioanal Chem</source>
        <year>2015</year>
        <volume>407</volume>
        <issue>8</issue>
        <fpage>2047</fpage>
        <lpage>54</lpage>
        <pub-id pub-id-type="doi">10.1007/s00216-014-8404-5</pub-id>
        <pub-id pub-id-type="pmid">25649999</pub-id>
      </element-citation>
    </ref>
    <ref id="CR47">
      <label>47.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Race</surname>
            <given-names>AM</given-names>
          </name>
          <name>
            <surname>Palmer</surname>
            <given-names>AD</given-names>
          </name>
          <name>
            <surname>Dexter</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Steven</surname>
            <given-names>RT</given-names>
          </name>
          <name>
            <surname>Styles</surname>
            <given-names>IB</given-names>
          </name>
          <name>
            <surname>Bunch</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>SpectralAnalysis: software for the masses</article-title>
        <source>Anal Chem</source>
        <year>2016</year>
        <volume>88</volume>
        <issue>19</issue>
        <fpage>9451</fpage>
        <lpage>8</lpage>
        <pub-id pub-id-type="doi">10.1021/acs.analchem.6b01643</pub-id>
        <pub-id pub-id-type="pmid">27558772</pub-id>
      </element-citation>
    </ref>
    <ref id="CR48">
      <label>48.</label>
      <mixed-citation publication-type="other">Widlak P, Mrukwa G, Kalinowska M, Pietrowska M, Chekan M, Wierzgon J, et al. Oral squamous cell carcinoma—mass spectrometry imaging dataset. 10.5281/zenodo.7377802.</mixed-citation>
    </ref>
    <ref id="CR49">
      <label>49.</label>
      <mixed-citation publication-type="other">Oetjen J, Veselkov K, Watrous J, McKenzie JS, Becker M, Hauberg-Lotte L, et al. Supporting materials for “Benchmark datasets for 3D MALDI-and DESI-imaging mass spectrometry”. 10.5524/100131.</mixed-citation>
    </ref>
  </ref-list>
</back>
