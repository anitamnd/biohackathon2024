<?properties open_access?>
<?properties manuscript?>
<?origin nihpa?>
<?iso-abbr Nat. Methods?>
<?submitter-system nihms?>
<?submitter-canonical-name Nature Publishing Group?>
<?submitter-canonical-id NATURE-STRUCTUR?>
<?submitter-userid 8068858?>
<?submitter-authority myNCBI?>
<?submitter-login nature-structure?>
<?submitter-name Nature Publishing Group?>
<?domain nihpa?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-journal-id">101215604</journal-id>
    <journal-id journal-id-type="pubmed-jr-id">32338</journal-id>
    <journal-id journal-id-type="nlm-ta">Nat Methods</journal-id>
    <journal-id journal-id-type="iso-abbrev">Nat. Methods</journal-id>
    <journal-title-group>
      <journal-title>Nature methods</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1548-7091</issn>
    <issn pub-type="epub">1548-7105</issn>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">5473255</article-id>
    <article-id pub-id-type="pmid">28418000</article-id>
    <article-id pub-id-type="doi">10.1038/nmeth.4263</article-id>
    <article-id pub-id-type="manuscript">nihpa862746</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>SCnorm: robust normalization of single-cell RNA-seq data</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Bacher</surname>
          <given-names>Rhonda</given-names>
        </name>
        <xref ref-type="aff" rid="A1">1</xref>
        <xref rid="FN2" ref-type="author-notes">5</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Chu</surname>
          <given-names>Li-Fang</given-names>
        </name>
        <xref ref-type="aff" rid="A2">2</xref>
        <xref rid="FN2" ref-type="author-notes">5</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Leng</surname>
          <given-names>Ning</given-names>
        </name>
        <xref ref-type="aff" rid="A2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Gasch</surname>
          <given-names>Audrey P.</given-names>
        </name>
        <xref ref-type="aff" rid="A3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Thomson</surname>
          <given-names>James A.</given-names>
        </name>
        <xref ref-type="aff" rid="A2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Stewart</surname>
          <given-names>Ron M.</given-names>
        </name>
        <xref ref-type="aff" rid="A2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Newton</surname>
          <given-names>Michael</given-names>
        </name>
        <xref ref-type="aff" rid="A1">1</xref>
        <xref ref-type="aff" rid="A4">4</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Kendziorski</surname>
          <given-names>Christina</given-names>
        </name>
        <xref ref-type="aff" rid="A4">4</xref>
        <xref rid="FN1" ref-type="author-notes">*</xref>
      </contrib>
    </contrib-group>
    <aff id="A1"><label>1</label>Department of Statistics, University of Wisconsin–Madison, Madison, WI</aff>
    <aff id="A2"><label>2</label>Morgridge Institute for Research, Madison, WI, USA</aff>
    <aff id="A3"><label>3</label>Laboratory of Genetics, University of Wisconsin–Madison, Madison, WI, USA</aff>
    <aff id="A4"><label>4</label>Department of Biostatistics and Medical Informatics, University of Wisconsin–Madison, Madison, Wisconsin, USA</aff>
    <author-notes>
      <corresp id="FN1"><label>*</label>Corresponding author: Christina Kendziorski: <email>kendzior@biostat.wisc.edu</email></corresp>
      <fn id="FN2" fn-type="equal">
        <label>5</label>
        <p>Equal contributors</p>
      </fn>
    </author-notes>
    <pub-date pub-type="nihms-submitted">
      <day>12</day>
      <month>4</month>
      <year>2017</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>17</day>
      <month>4</month>
      <year>2017</year>
    </pub-date>
    <pub-date pub-type="ppub">
      <month>6</month>
      <year>2017</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>17</day>
      <month>10</month>
      <year>2017</year>
    </pub-date>
    <volume>14</volume>
    <issue>6</issue>
    <fpage>584</fpage>
    <lpage>586</lpage>
    <!--elocation-id from pubmed: 10.1038/nmeth.4263-->
    <permissions>
      <license>
        <license-p>Users may view, print, copy, and download text and data-mine the content in such documents, for the purposes of academic research, subject always to the full Conditions of use:
<uri xlink:type="simple" xlink:href="http://www.nature.com/authors/editorial_policies/license.html#terms">http://www.nature.com/authors/editorial_policies/license.html#terms</uri></license-p>
      </license>
    </permissions>
    <abstract>
      <title>Summary</title>
      <p id="P2">Normalization of RNA-sequencing data is essential for accurate downstream inference, but the assumptions upon which most methods are based do not hold in the single-cell setting. Consequently, applying existing normalization methods to single-cell RNA-seq data introduces artifacts that bias downstream analyses. To address this, we introduce SCnorm for accurate and efficient normalization of scRNA-seq data.</p>
    </abstract>
  </article-meta>
</front>
<body>
  <p id="P3">Protocols to quantify mRNA abundance introduce systematic sources of variation that obscure signals of interest. Consequently, an essential first step in the majority of mRNA expression analyses is normalization, whereby systematic variations are adjusted for to make expression counts comparable across genes and/or samples. Within-sample normalization methods adjust for gene-specific features such as GC-content and gene length to facilitate comparisons across genes within an individual sample, whereas between-sample normalization methods adjust for sample-specific features such as sequencing depth to allow for comparisons of a gene’s expression across samples<sup><xref rid="R1" ref-type="bibr">1</xref></sup>. In this work, we present a method for between-sample normalization, although we note that the R implementation, R/SCnorm, also allows for adjustment of gene-specific features.</p>
  <p id="P4">A number of methods are available for between-sample normalization in bulk RNA-seq experiments<sup><xref rid="R2" ref-type="bibr">2</xref>,<xref rid="R3" ref-type="bibr">3</xref></sup>. Most methods calculate global scale factors (one for each sample applied commonly across genes in the sample) to adjust for sequencing depth. These methods demonstrate excellent performance for bulk RNA-seq, but are compromised in the single-cell setting due to an abundance of zeros and increased technical variability<sup><xref rid="R4" ref-type="bibr">4</xref></sup>.</p>
  <p id="P5">Recent methods have been developed specifically for scRNA-seq normalization<sup><xref rid="R5" ref-type="bibr">5</xref>,<xref rid="R6" ref-type="bibr">6</xref></sup>. Like bulk methods, they calculate global scale factors, and are therefore unable to accommodate a major bias that to date has been unobserved in scRNA-seq data. Specifically, scRNA-seq data show systematic variation in the relationship between transcript specific expression and sequencing depth (referred to hereinafter as the count-depth relationship) that is not accommodated by a single scale factor common to all genes in a cell (<xref rid="F1" ref-type="fig">Fig. 1</xref> and <xref rid="SD1" ref-type="supplementary-material">Supplementary Fig. S1</xref>). Global scale factors adjust for a count-depth relationship that is assumed common across genes. When this is not the case, normalization via global scale factors leads to over-correction for lowly and moderately expressed genes and, in some cases, under-normalization of highly expressed genes (<xref rid="F1" ref-type="fig">Fig. 1</xref>).</p>
  <p id="P6">To address this, we propose SCnorm which uses quantile regression to estimate the dependence of transcript expression on sequencing depth for every gene. Genes with similar dependence are then grouped, and a second quantile regression is used to estimate scale factors within each group. Within-group adjustment for sequencing depth is then performed using the estimated scale factors to provide normalized estimates of expression. Although SCnorm does not require spike-ins, performance may be improved if good spike-ins are available (<xref rid="SD1" ref-type="supplementary-material">Supplementary Note S1</xref>).</p>
  <p id="P7">SCnorm was evaluated and compared with MR<sup><xref rid="R3" ref-type="bibr">3</xref></sup>, transcripts-per-million (TPM)<sup><xref rid="R7" ref-type="bibr">7</xref></sup>, scran<sup><xref rid="R5" ref-type="bibr">5</xref></sup>, SCDE<sup><xref rid="R8" ref-type="bibr">8</xref></sup>, and BASiCS<sup><xref rid="R6" ref-type="bibr">6</xref></sup> using simulated and case study data. In SIM I, two scenarios were considered where the number of groups of genes having different count-depth relationships (<italic>K</italic>) is set to one (to mimic a bulk experiment) and four. Each simulated data set contains two conditions, the second condition having approximately four times as many reads; 20% of the genes are defined to be DE. Prior to normalization, counts in the second condition will appear four times higher on average given the increased sequencing depth. If normalization for depth is effective, fold-change estimates should be near one, and only simulated DE genes should appear DE. <xref rid="SD1" ref-type="supplementary-material">Supplementary Fig. S2a</xref> shows that when <italic>K =</italic> 1<italic>,</italic> with the exception of TPM, fold-change estimates are consistently robust among methods, and all normalization methods provide data that results in high sensitivity and specificity for identifying DE genes (<xref rid="SD1" ref-type="supplementary-material">Supplementary Fig. S2b</xref>). However, when K = 4, only SCnorm maintains good operating characteristics, whereas global scale factor based approaches overestimate fold-changes for low to moderately expressed genes due to overcorrection of sequencing depth (<xref rid="SD1" ref-type="supplementary-material">Supplementary Fig. S2c, d</xref>).</p>
  <p id="P8">In SIM II, counts are generated as in Lun <italic>et al.</italic> 2016<sup><xref rid="R5" ref-type="bibr">5</xref></sup>, following their simulation study scenarios 1, 2, 3, and 4. Briefly, scenario 1 contains no DE genes; scenarios 2, 3, and 4 contain moderate DE, strong DE, and varying magnitudes of DE, respectively. <xref rid="SD1" ref-type="supplementary-material">Supplementary Fig. S3</xref> shows that SCnorm is similar to <italic>scran</italic> with respect to fold change estimation and retains relatively high sensitivity and specificity for identifying DE genes.</p>
  <p id="P9">To further evaluate SCnorm, we conducted an experiment that, similar to the simulations, sequenced cells at very different depths. We used the Fluidigm C1 system to capture 92 H1 human embryonic stem cells (hESCs). Each cell’s fragmented, indexed cDNA was split into two groups prior to pooling for sequencing. The first group (H1-1M) was pooled at 96 cells per lane and the second (H1-4M) at 24 cells per lane, resulting in approximately 1 million and 4 million mapped reads per cell in the two groups, respectively. Prior to normalization, counts in the second group will appear four times higher on average given the increased sequencing depth. However, if normalization for depth is effective, fold-change estimates should be near one, and all genes should appear to be EE since the cells between the two groups are identical. SCnorm provides normalized data that results in fold-change estimates near one, whereas other methods show biased estimates (<xref rid="F2" ref-type="fig">Fig. 2 (a)</xref>).</p>
  <p id="P10">To evaluate the extent to which biases introduced during normalization affect the identification of DE genes, we applied MAST<sup><xref rid="R9" ref-type="bibr">9</xref></sup> (FDR = 0.05) to identify DE genes between the H1-1M and H1-4M conditions. Normalization with SCnorm resulted in the identification of no DE genes, whereas MR, TPM, scran, SCDE, and BASiCS resulted in 530, 315, 684, 401, and 1147 DE genes, respectively, being identified. The majority of DE calls made using data normalized from these latter approaches are lowly expressed genes (<xref rid="F2" ref-type="fig">Fig. 2 (b)</xref>), which appear to be over-normalized (<xref rid="F2" ref-type="fig">Fig. 2 (a)</xref>). <xref rid="SD1" ref-type="supplementary-material">Supplementary Fig. S4</xref> shows similar results using H9 cells.</p>
  <p id="P11">We also evaluated the impact of normalization on downstream analyses such as principal components analysis (PCA) and on the identification of DE genes in case study data. Specifically, we considered the H1-FUCCI data from Leng <italic>et al</italic>. 2015<sup><xref rid="R10" ref-type="bibr">10</xref></sup> where 247 H1 human embryonic stem cells were labelled with <italic>fluorescent ubiquitination-based cell cycle indicators</italic><sup><xref rid="R11" ref-type="bibr">11</xref></sup> to enable identification of cells as being in G1, S, or G2/M phase. PCA was applied to the H1-FUCCI data following normalization via SCnorm, MR, TPM, scran, and SCDE. SCnorm shows some advantage in distinguishing at least one of the groups and has the lowest misclassification rate (<xref rid="F3" ref-type="fig">Fig. 3</xref>). As a second positive control, we evaluated the ability of each normalized dataset to be used to identify DE genes. Specifically, we consider the S and G2/M phases from the H1-FUCCI data. For these two phases, we subsampled cells so that there are negligible differences in cellular detection rates (CDRs) between the two conditions and there is on average a 1.5 fold increase in sequencing depth. Without differences in CDR, we would expect an EE gene expressed at level <italic>x</italic> in S to be expressed at level 1.5*<italic>x</italic> in G2/M. Given this, we define a gold standard list to be those genes showing a fold change bigger than a threshold (or smaller than one over that threshold) for varying thresholds, adjusting for the expected increase in expression due to increased sequencing depth. <xref rid="SD1" ref-type="supplementary-material">Supplementary Fig. S5</xref> demonstrates the advantage of SCnorm over other methods.</p>
  <p id="P12">The performance of SCnorm was also evaluated on a number of other case study data sets. For these evaluations, a data set was considered well normalized if the relationship between counts and depth was removed following normalization. <xref rid="F1" ref-type="fig">Fig. 1</xref> and <xref rid="SD1" ref-type="supplementary-material">Supplementary Figs. S6–S11</xref> demonstrate that SCnorm provides for robust normalization of scRNA-seq data when the count-depth relationship is common across genes, as in a bulk RNA-seq experiment (or a deeply sequenced scRNA-seq experiment); and that SCnorm outperforms other approaches when this relationship varies systematically, as in a typical scRNA-seq experiment.</p>
  <p id="P13">The scRNA-seq technology offers unprecedented opportunity to address biological questions, but accurate data normalization is required to ensure meaningful results. Our approach allows investigators to accurately normalize data for sequencing depth, and consequently to improve downstream inference.</p>
  <sec id="S1" specific-use="web-only">
    <title>ONLINE METHODS</title>
    <sec id="S2">
      <title>Filter</title>
      <p id="P14">Genes without at least 10 cells having non-zero expression were removed prior to all analyses. They are not shown in plots.</p>
    </sec>
    <sec id="S3">
      <title>SCnorm</title>
      <p id="P15">SCnorm requires estimates of expression, but is not specific to one approach. Estimates may be obtained via RSEM<sup><xref rid="R7" ref-type="bibr">7</xref></sup>, HTSeq<sup><xref rid="R12" ref-type="bibr">12</xref></sup>, or any method providing unnormalized counts per feature. Let <italic>Y<sub>g,j</sub></italic> denote the log non-zero expression count for gene <italic>g</italic> in cell <italic>j</italic> for <italic>g</italic> = 1,…, <italic>m</italic> and <italic>j</italic> = 1,…, <italic>n; X<sub>j</sub></italic> denote log sequencing depth for cell <italic>j.</italic> Motivation for considering non-zero counts is provided in <xref rid="SD1" ref-type="supplementary-material">Supplementary Note S3</xref>.</p>
      <p id="P16">The number of groups for which the count-depth relationship varies substantially, <italic>K</italic>, is chosen sequentially. SCnorm begins with <italic>K</italic> = 1. For each gene, the gene-specific relationship between log unnormalized expression and log sequencing depth is represented by <italic>β̂<sub>g</sub></italic><sub>,1</sub> using median quantile regression with a first degree polynomial: <italic>Q</italic><sup>0.5</sup>(<italic>Y<sub>g,j</sub></italic>|<italic>X<sub>j</sub></italic>) = <italic>β<sub>g</sub></italic><sub>,0</sub> + <italic>β<sub>g</sub></italic><sub>,1</sub><italic>X<sub>j</sub></italic>. The overall relationship between log unnormalized expression and log sequencing depth for all genes in the <italic>K</italic> = 1 group is also estimated via quantile regression. Since the median might not best represent the full set of genes within the group, and since multiple genes allow for estimation of somewhat subtle effects, in this step SCnorm considers multiple quantiles τ and multiple degrees <italic>d</italic>: 
<disp-formula id="FD1"><label>(1)</label><mml:math id="M1" display="block" overflow="scroll"><mml:mrow><mml:msup><mml:mi>Q</mml:mi><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>Y</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>∣</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msubsup><mml:mi>β</mml:mi><mml:mn>0</mml:mn><mml:msub><mml:mi>τ</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi>β</mml:mi><mml:mn>1</mml:mn><mml:msub><mml:mi>τ</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:msubsup><mml:msub><mml:mi>X</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mo>⋯</mml:mo><mml:mo>+</mml:mo><mml:msubsup><mml:mi>β</mml:mi><mml:mi>d</mml:mi><mml:msub><mml:mi>τ</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:msubsup><mml:msubsup><mml:mi>X</mml:mi><mml:mi>j</mml:mi><mml:msub><mml:mi>d</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:msubsup><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p>
      <p id="P17">The specific values of <italic>τ<sub>k</sub></italic> and <italic>d<sub>k</sub></italic>, 
<inline-formula><mml:math id="M2" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>τ</mml:mi><mml:mi>k</mml:mi><mml:mo>∗</mml:mo></mml:msubsup></mml:mrow></mml:math></inline-formula> and 
<inline-formula><mml:math id="M3" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>d</mml:mi><mml:mi>k</mml:mi><mml:mo>∗</mml:mo></mml:msubsup></mml:mrow></mml:math></inline-formula>, are those that minimize 
<inline-formula><mml:math id="M4" display="inline" overflow="scroll"><mml:mrow><mml:mo>∣</mml:mo><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>η</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mn>1</mml:mn><mml:msub><mml:mi>τ</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:msubsup><mml:mo>-</mml:mo><mml:mtable><mml:mtr><mml:mtd><mml:mi mathvariant="italic">mode</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi>g</mml:mi></mml:mtd></mml:mtr></mml:mtable><mml:msub><mml:mover accent="true"><mml:mi>β</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mi mathvariant="normal">g</mml:mi><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>∣</mml:mo></mml:mrow></mml:math></inline-formula>, where 
<inline-formula><mml:math id="M5" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>η</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mn>1</mml:mn><mml:msub><mml:mi>τ</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:msubsup></mml:mrow></mml:math></inline-formula> represents the count-depth relationship among the predicted expression values as estimated by median quantile regression using a first degree polynomial: 
<inline-formula><mml:math id="M6" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mi>Q</mml:mi><mml:mn>0.5</mml:mn></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>Y</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>j</mml:mi><mml:msub><mml:mi>τ</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:msubsup><mml:mo>∣</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msubsup><mml:mi>η</mml:mi><mml:mn>0</mml:mn><mml:msub><mml:mi>τ</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi>η</mml:mi><mml:mn>1</mml:mn><mml:msub><mml:mi>τ</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:msubsup><mml:msub><mml:mi>X</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> Scale factors for each cell are defined as 
<inline-formula><mml:math id="M7" display="inline" overflow="scroll"><mml:mrow><mml:mi>S</mml:mi><mml:msub><mml:mi>F</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mstyle scriptlevel="1"><mml:mfrac><mml:msup><mml:mi>e</mml:mi><mml:msup><mml:mover accent="true"><mml:msub><mml:mi>Y</mml:mi><mml:mi>J</mml:mi></mml:msub><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mrow><mml:msubsup><mml:mi>τ</mml:mi><mml:mi>k</mml:mi><mml:mo>∗</mml:mo></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>d</mml:mi><mml:mi>k</mml:mi><mml:mo>∗</mml:mo></mml:msubsup></mml:mrow></mml:msup></mml:msup><mml:msup><mml:mi>e</mml:mi><mml:msup><mml:mi>Y</mml:mi><mml:msubsup><mml:mi>τ</mml:mi><mml:mi>k</mml:mi><mml:mo>∗</mml:mo></mml:msubsup></mml:msup></mml:msup></mml:mfrac></mml:mstyle></mml:mrow></mml:math></inline-formula> where 
<inline-formula><mml:math id="M8" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mi>Y</mml:mi><mml:msubsup><mml:mi>τ</mml:mi><mml:mi>k</mml:mi><mml:mo>∗</mml:mo></mml:msubsup></mml:msup></mml:mrow></mml:math></inline-formula> is the <italic>τ*<sup>th</sup></italic> quantile of expression counts in the <italic>k</italic><sup>th</sup> group. Normalized counts 
<inline-formula><mml:math id="M9" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>Y</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mo>′</mml:mo></mml:msubsup></mml:mrow></mml:math></inline-formula> are given by 
<inline-formula><mml:math id="M10" display="inline" overflow="scroll"><mml:mrow><mml:mstyle scriptlevel="1"><mml:mfrac><mml:msup><mml:mi>e</mml:mi><mml:msub><mml:mi>Y</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:msup><mml:mrow><mml:mi>S</mml:mi><mml:msub><mml:mi>F</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mfrac></mml:mstyle></mml:mrow></mml:math></inline-formula>.</p>
      <p id="P33">To determine if <italic>K</italic> = 1 is sufficient, the gene-specific relationship between log normalized expression and log sequencing depth is represented by the slope of a median quantile regression using a first degree polynomial as detailed above. <italic>K</italic> = 1 is considered sufficient if the modes of the slopes within each of 10 equally sized gene groups (where a gene’s group membership is determined by its median expression among non-zero un-normalized measurements) are all less than 0.1. Any mode exceeding 0.1 is taken as evidence that the normalization provided with <italic>K</italic> = 1 is not sufficient to adjust for the count-depth relationship for all genes and, consequently, <italic>K</italic> is increased by one and the count-depth relationship is estimated within each of the <italic>K</italic> groups using <xref rid="FD1" ref-type="disp-formula">equation (1)</xref>. For each increase, the <italic>K</italic>-medoids algorithm is used to cluster genes into groups based on <italic>β̂<sub>g</sub></italic><sub>,1</sub>; if a cluster has fewer than 100 genes, it is joined with the nearest cluster.</p>
      <p id="P34">When multiple biological conditions are present, SCnorm is applied within each condition and the normalized counts are then re-scaled across conditions. During rescaling, all genes are split into quartiles based on median expression among non-zero un-normalized measurements. Within each group and condition, each gene is scaled by a common scale factor defined as the median of the gene specific fold-changes between each gene’s condition-specific mean and the gene-specific mean across conditions, where means are calculated over non-zero counts. Motivation for considering non-zero counts during re-scaling is discussed in <xref rid="SD1" ref-type="supplementary-material">Supplementary Note S3</xref>. Although the focus of SCnorm is on between-sample normalization, gene-specific features may also be adjusted using the R/SCnorm package. As in Risso <italic>et al.</italic><sup><xref rid="R15" ref-type="bibr">15</xref></sup>, we implemented a two-step procedure where gene specific effects may be adjusted for prior to between-sample normalization using SCnorm. It should be noted that SCnorm is not designed to adjust for batch effects; methods such as ComBat<sup><xref rid="R13" ref-type="bibr">13</xref></sup> or sva<sup><xref rid="R14" ref-type="bibr">14</xref></sup> may be used for this purpose following normalization.</p>
    </sec>
    <sec id="S4">
      <title>SCnorm.SI</title>
      <p id="P18">SCnorm does not require spike-ins, since we find that the performance of spike-ins in scRNA-seq is often compromised (<xref rid="SD1" ref-type="supplementary-material">Supplementary Figs. S12–S13</xref>), and many labs do not use them for normalization<sup><xref rid="R16" ref-type="bibr">16</xref>,<xref rid="R17" ref-type="bibr">17</xref></sup>. However, if good spike-ins are available, performance of SCnorm may be improved in the post-normalization scaling step, which is required when multiple conditions are available. Recall that in SCnorm, during rescaling, all genes are split into quartiles based on median expression among non-zero un-normalized measurements. In SCnorm.SI, the same is done with spike-ins and, if the spike-ins are representative of the full range of expression, we expect them to be approximately evenly divided among the four groups. Within each group and condition, each gene is scaled by a common scale factor defined as the median of the spike-in specific fold-changes between each spike-in’s condition-specific mean and the spike-in’s specific mean across conditions, where means are calculated over non-zero counts. For more on SCnorm.SI, see <xref rid="SD1" ref-type="supplementary-material">Supplementary Note S1</xref>.</p>
    </sec>
    <sec id="S5">
      <title>Application of comparable methods</title>
      <p id="P19">All analyses were carried out using R version 3.3.0 unless otherwise noted. The method MR, originally described by Anders and Huber<sup><xref rid="R3" ref-type="bibr">3</xref></sup>, was implemented using the DESeq R package version 1.24.0 using the default settings of the <italic>estimateSizeFactorsForMatrix</italic> function. TPM estimates were obtained as output from RSEM version 1.2.3. Expected counts were used in SCnorm and TPM was evaluation separately. The method scran was implemented with the scran R package version 1.0.0; size factors were obtained using the function <italic>computeSumFactors</italic>. The pool sizes were set to 5, 10, 15, and 20; and size factors were constrained to be positive. SCDE was implemented in R version 3.2.2 using the SCDE R package version 1.99.1 with default parameter settings, and normalized counts were obtained using the function <italic>scde.expression.magnitude</italic>. BASiCS was implemented using the BASiCS R package version 0.4.1 using R vesion 3.2.2, obtained from Github at <ext-link ext-link-type="uri" xlink:href="https://github.com/catavallejos/BASiCS">https://github.com/catavallejos/BASiCS</ext-link>; and normalized expression estimates were obtained using the function <italic>BASiCS_DenoisedCounts</italic> where <italic>BASiCS_MCMC</italic> was run with N = 20,000, Burn = 10,000, and default parameters used otherwise. Because BASiCS requires spike-ins, results are only shown for data sets where spike-ins are available. Finally, we also evaluated NODES<sup><xref rid="R18" ref-type="bibr">18</xref></sup> (<xref rid="SD1" ref-type="supplementary-material">Supplementary Figs. S14–S16</xref>), an unpublished approach, version 0.0.0.9010.</p>
    </sec>
    <sec id="S6">
      <title>Evaluation of methods</title>
      <p id="P20">Gene-specific count depth relationships were estimated using median quantile regression as well as regression with a negative binomial generalized linear model (glm). The <italic>quantreg</italic> package in R was used with the Barrodale and Roberts algorithm to carry out the median regressions; MASS in R was used to fit the glms. Zeros are not included in the fits since our goal is to estimate the count-depth relationship present in data before and after normalization, and that relationship is obscured by dropouts, which are largely technical. Because glm’s are sensitive to outliers, an initial glm to estimate the count-depth relationship is fit on the un-normalized data and the top two and bottom two residual gene expression values were removed from each gene prior to estimating the final count-depth relationship via glm. Since the same set of putative outliers were removed for every method, excluding these values will not bias results in favor of any one method.</p>
      <p id="P21">MAST was used to identify DE genes, using the MAST R package version 0.933, obtained from Github at <ext-link ext-link-type="uri" xlink:href="https://github.com/RGLab/MAST">https://github.com/RGLab/MAST</ext-link>. The continuous component test was considered and differential zeros were not used to evaluate performance of normalization methods since all normalization methods leave zeros un-normalized. P-values from MAST were adjusted using Benjamini &amp; Hochberg<sup><xref rid="R19" ref-type="bibr">19</xref></sup>. Unless otherwise noted, a DE gene was defined as one with corrected p-value &lt; 0.05, which controls the false discovery rate at 5%. ROC curves were plot using the R package <italic>ROCR</italic>. The false positive and true positive rates were calculated by <italic>ROCR</italic>, with a positive representing a DE gene. Average ROC curves show the average true positive rate. PCA was conducted using the <italic>prcomp</italic> function in R, and confidence ellipses were drawn using the <italic>dataEllipse</italic> function in the <italic>car</italic> package in R. Outlier adjustment (values in the upper 0.995<sup>th</sup> percentile were set to the 0.995<sup>th</sup> percentile) was done prior to applying PCA for each dataset. The misclassification rate for the S phase was calculated as the percentage of G1 or G2/M cells present within the 95% confidence ellipse for S; misclassification rates for the other phases were calculated similarly.</p>
    </sec>
    <sec id="S7">
      <title>Simulation SIM I</title>
      <p id="P22">Data were simulated to match characteristics of the H1-1M and H1-4M datasets. For each gene <italic>g</italic>, gene-specific intercepts <italic>β̂<sub>g</sub></italic><sub>,0</sub>, slopes <italic>β̂<sub>g</sub></italic><sub>,1</sub>, and variance intercepts 
<inline-formula><mml:math id="M11" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mover accent="true"><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mi>g</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> were estimated using median quantile regression on the H1-1M data. Two SIM I simulation scenarios were generated: <italic>K</italic> = 1 and <italic>K</italic> = 4. In the <italic>K</italic> = 1 simulations, only genes having at least 75% non-zero expression values and <italic>β̂<sub>g</sub></italic><sub>,1</sub> ∈ (.9, 1.1) were used. For the <italic>K</italic> = 4 simulations, genes were split into four equally sized groups based on <italic>β̂<sub>g</sub></italic><sub>,1</sub>. The medians of <italic>β̂<sub>g</sub></italic><sub>,1</sub> were calculated within each group; denote these by <italic>β<sub>med</sub></italic><sub>,1</sub>, <italic>β<sub>med</sub></italic><sub>,2</sub>, <italic>β<sub>med</sub></italic><sub>,3</sub>, and <italic>β<sub>med</sub></italic><sub>,4</sub>, respectively. For genes in the <italic>k</italic><sup>th</sup> group, genes having <italic>β̂<sub>g</sub></italic><sub>,</sub><italic><sub>k</sub></italic> ∈ (<italic>β<sub>med</sub></italic><sub>,</sub><italic><sub>k</sub></italic> − 0.1, <italic>β<sub>med</sub></italic><sub>,</sub><italic><sub>k</sub></italic> + 0.1) were used, where <italic>β<sub>med</sub></italic><sub>,</sub><italic><sub>k</sub></italic> is the median <italic>β̂<sub>g</sub></italic><sub>,</sub><italic><sub>k</sub></italic> over all genes.</p>
      <p id="P23">For a given gene, counts were simulated on the log scale as <italic>β̂<sub>g</sub></italic><sub>,1</sub> log(<italic>X<sub>j</sub></italic>)+ <italic>β̂<sub>g</sub></italic><sub>,0</sub> + <italic>ε<sub>g</sub></italic><sub>,</sub><italic><sub>j</sub></italic> and then exponentiated, where 
<inline-formula><mml:math id="M12" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>ε</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>~</mml:mo><mml:mi>N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mover accent="true"><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mi>g</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>. Two biological conditions were simulated: one condition with 90 cells simulated from sequencing depths ranging from 500,000 to 1.5 million reads (<italic>X<sub>j</sub></italic> was sampled uniformly between 500,000 and 1.5 million) and a second condition with 90 cells simulated with depths ranging from 2 to 6 million reads (<italic>X<sub>j</sub></italic> was sampled uniformly between 2 and 6 million). For a randomly selected set of cells, counts were set to zero, where the proportion set to zero was defined to match the proportion observed empirically. Each simulated dataset contained 1200 genes, 80% EE and 20% DE. For approximately half of the DE genes, fold-changes were sampled uniformly between 2 and 4, and counts in the second condition were multiplied by the sampled fold-change. The other (approximately) half of DE genes were simulated similarly, but with counts in the first condition multiplied by the sampled fold change to keep the DE balanced. <xref rid="SD1" ref-type="supplementary-material">Supplementary Fig. S17</xref> shows that basic summary statistics are well preserved between the simulated and case study data.</p>
    </sec>
    <sec id="S8">
      <title>Simulation SIM II</title>
      <p id="P24">Counts are generated as in Lun <italic>et al.</italic> 2016<sup><xref rid="R5" ref-type="bibr">5</xref></sup> following their simulation study scenarios 1, 2, 3, and 4. In that simulation set up, three populations were simulated. We here consider populations 1 and 2.</p>
    </sec>
    <sec id="S9">
      <title>H1 bulk data</title>
      <p id="P25">The dataset contains 48 samples of H1 hESCs as described in detail in Hou <italic>et al.</italic> 2015<sup><xref rid="R20" ref-type="bibr">20</xref></sup>. The H1 bulk RNA-seq data have an average sequencing depth of 3 million mapped reads per sample.</p>
    </sec>
    <sec id="S10">
      <title>H1 and H9 case studies</title>
      <p id="P26">Undifferentiated H1 or H9 hESCs were cultured in E8 medium<sup><xref rid="R21" ref-type="bibr">21</xref></sup> on Matrigel-coated tissue culture plates with daily media feeding at 37 °C with 5% (vol/vol) CO<sub>2</sub>. Cells were split every 3–4 days with 0.5 mM EDTA in 1 X PBS for standard maintenance. Immediately before preparing single cell suspensions for each experiment, hESCs were individualized by Accutase (Life Technologies), washed once with E8 medium, and resuspended at densities of 5.0–8.0 × 10<sup>5</sup> cells/mL in E8 medium for cell capture. The H1 hESCs are registered in the NIH Human Embryonic Stem Cell Registry with the Approval Number: NIHhESC-10-0043. Details of the H1 cells can be found online (<ext-link ext-link-type="uri" xlink:href="http://grants.nih.gov/stem_cells/registry/current.htm?id=29">http://grants.nih.gov/stem_cells/registry/current.htm?id=29</ext-link>). The H9 hESCs are registered in the NIH Human Embryonic Stem Cell Registry with the Approval Number: NIHhESC-10-0062. Details of the H9 cells can be found online (<ext-link ext-link-type="uri" xlink:href="http://grants.nih.gov/stem_cells/registry/current.htm?id=414">http://grants.nih.gov/stem_cells/registry/current.htm?id=414</ext-link>). All the cell cultures performed in our laboratory have been routinely tested and have been found negative for mycoplasma contamination and authenticated by cytogenetic tests.</p>
      <p id="P27">Single-cell loading, capture, and library preparations were performed following the Fluidigm user manual “<italic>Using the C1 Single-Cell Auto Prep System to Generate mRNA from Single Cells and Libraries for Sequencing.</italic>” Briefly, 5,000–8,000 cells were loaded onto a medium size (10–17 <italic>μm</italic>) C1 Single-Cell Auto Prep IFC (Fluidigm), and cell-loading script was performed according to the manufacturer’s instructions. The capture efficiency was inspected using EVOS FL Auto Cell Imaging system (Life Technologies) to perform an automated area scanning of the 96 capture sites on the IFC. Empty capture sites or sites having more than one cell captured were first noted and those samples were later excluded from further library processing for RNA-seq. Immediately after capture and imaging, reverse transcription and cDNA amplification were performed in the C1 system using the SMARTer PCR cDNA Synthesis kit (Clontech) and the Advantage 2 PCR kit (Clontech) according to the instructions in the Fluidigm user manual. Full-length, single-cell cDNA libraries were harvested the next day from the C1 chip and diluted to a range of 0.1–0.3 ng/μL. Diluted single-cell cDNA libraries were fragmented and amplified using the Nextera XT DNA Sample Preparation Kit and the Nextera XT DNA Sample Preparation Index Kit (Illumina). Libraries were multiplexed either at 24 or 96 single cell cDNA libraries per lane to target 4 or 1 million mapped reads per cell, respectively, and single-end reads of 67-bp were sequenced on an Illumina HiSeq 2500 system. We refer to the data obtained from 24 libraries per lane as the H1-4M set, since approximately 4 million mapped reads per cell were generated. For similar reasons, H1-1M is used to refer to the data obtained from 96 libraries per lane.</p>
      <p id="P28">Reads were mapped against the Hg19 Refseq reference via Bowtie 0.12.8<sup><xref rid="R22" ref-type="bibr">22</xref></sup> allowing up to two mismatches and up to 20 multiple hits. The expected counts and TPM’s were estimated via RSEM 1.2.3<sup><xref rid="R7" ref-type="bibr">7</xref></sup>. Cells having less than 5,000 genes with expected counts &gt;1 or those that upon inspection of cell images displayed doublets or appeared dead were removed in quality control. 92 H1 cells passed the quality control. 91 H9 cells passed quality control.</p>
    </sec>
    <sec id="S11">
      <title>H1-FUCCI case study<sup><xref rid="R10" ref-type="bibr">10</xref></sup></title>
      <p id="P29">Single-cell RNA-seq data were downloaded from GSE64016. In this experiment, 247 H1 human embryonic stem cells were labelled with <italic>fluorescent ubiquitination-based cell cycle indicators</italic><sup><xref rid="R11" ref-type="bibr">11</xref></sup> to enable identification of cell cycle phase for each cell. For the PCA analysis, cell cycle genes were defined from GO:0007049 and from Cyclebase<sup><xref rid="R23" ref-type="bibr">23</xref></sup>. Specifically, we took genes from GO:0007049 that showed strong evidence of cell cycle association by having a rank within the top 400 Cyclebase genes (giving a total of 578 genes). For the S vs. G2/M DE analysis, we sampled 50 cells from the S phase and 50 cells from the G2/M phase to match on cellular detection rate (CDR). In the resulting dataset, the 25<sup>th</sup>, 50<sup>th</sup>, and 75<sup>th</sup> percentile of CDR for the S (G2/M) condition was 0.62, 0.63, and 0.64 (0.61, 0.63, 0.64). Sequencing depth was approximately 1.5 times higher in the G2/M condition (4 million reads on average in S and 6 million on average in G2/M; medians 4.05 and 6.1 million reads, respectively). Without differences in CDR, we would expect an EE gene expressed at level <italic>x</italic> in S to be expressed at level 1.5*<italic>x</italic> in G2/M. Given this, we define a gold standard list to be those genes showing a fold change bigger than a threshold (or smaller than one over that threshold) for varying thresholds, adjusting for the expected increase in expression due to increased sequencing depth. For example, genes with 2-fold change or greater are defined as those with empirical fold change of 3 or greater.</p>
    </sec>
    <sec id="S12">
      <title>Buettner case study<sup><xref rid="R24" ref-type="bibr">24</xref></sup></title>
      <p id="P30">Single-cell RNA-seq expression data were downloaded from ArrayExpress E-MTAB-2805. In this experiment, <italic>Mus musculus</italic> embryonic stem cells were sorted using fluorescence-activated cell sorting (FACS) to determine cell cycle phase; cells were then captured using the C1 Fluidigm system. Libraries were multiplexed and sequenced across four lanes using an Illumina HiSeq 2000 system. Gene-level read counts were generated by HTSeq version 0.6.1. Here we consider the three data sets each having 96 cells in either G1, S, or G2M phase of the cell cycle. The data have average sequencing depths of 4.9, 6.5, and 4.5 million, respectively. Cells having sequencing depths less than 10,000 were removed prior to analysis which resulted in 95 G1, 88 S, and 96 G2M cells.</p>
    </sec>
    <sec id="S13">
      <title>Islam case study<sup><xref rid="R25" ref-type="bibr">25</xref></sup></title>
      <p id="P31">Single-cell RNA-seq expression data were downloaded from GEO GSE29087. In this experiment, <italic>Mus musculus</italic> R1 embryonic stem cells (ES) and embryonic fibroblasts were captured using a semi-automated cell picker on a 96-well capture plate; libraries were generated using the STRT protocol and sequenced using on a Genome Analyzer IIx system. Gene-level counts were obtained by counting reads mapped using Bowtie<sup><xref rid="R22" ref-type="bibr">22</xref></sup> for each feature. Here we consider two datsets, one having 48 ES cells and the other having 44 EF cells. The datasets have average sequencing depths of 180,000 reads and 800,000 reads, respectively.</p>
    </sec>
    <sec id="S14">
      <title>DEC case study</title>
      <p id="P32">The dataset contains 64 H1 cells consisting of the first batch of experiments studying H1 differentiation towards definitive endodermal cells as described in detail in Chu <italic>et al.</italic> 2016<sup><xref rid="R26" ref-type="bibr">26</xref></sup>. The DEC scRNA-seq data have an average sequencing depth of 4 million mapped reads per cell. The data can be downloaded from GEO GSE75748.</p>
    </sec>
  </sec>
  <sec sec-type="supplementary-material" id="S15">
    <title>Supplementary Material</title>
    <supplementary-material content-type="local-data" id="SD1">
      <label>1</label>
      <media xlink:href="NIHMS862746-supplement-1.docx" orientation="portrait" xlink:type="simple" id="d36e1346" position="anchor"/>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack id="S16">
    <p>This work was supported by NIH GM102756 (CK), NIH U54 AI117924 (CK, MN), 1T32LM012413-01A1 (MN), and the Morgridge Institute for Research. We thank J. Bolin, A. Elwell, and B.K. Nguyen for the preparation and sequencing of the RNA-seq samples and P. Jiang and S. Swanson for performing the RNA-seq read processing.</p>
  </ack>
  <fn-group>
    <fn id="FN3">
      <p>
        <bold>ACCESSION CODES</bold>
      </p>
      <p>GSE85917</p>
    </fn>
    <fn id="FN4">
      <p>
        <bold>DATA AVAILABILITY</bold>
      </p>
      <p>The H1 bulk and the H1-1M, H1-4M, H9-1M, H9-4M case study datasets are available at the NCBI Gene Expression Omnibus: GSE85917. The R package R/SCnorm is available at <ext-link ext-link-type="uri" xlink:href="http://www.biostat.wisc.edu/~kendzior/SCNORM/">http://www.biostat.wisc.edu/~kendzior/SCNORM/</ext-link></p>
    </fn>
    <fn id="FN5" fn-type="con">
      <p>
        <bold>AUTHOR CONTRIBUTIONS</bold>
      </p>
      <p>R.B. and C.K. designed the research, developed the method, and wrote the first version of the manuscript. L.C. performed experiments and quality control on scRNA-seq data generated from H1 and H9 hESCs. R.B. analyzed all datasets. L.C., N.L., A.P.G., R.S. and M.N. analyzed results from early versions of the method which helped during method refinement. All authors contributed to writing the manuscript.</p>
    </fn>
    <fn fn-type="COI-statement" id="FN6">
      <p>
        <bold>COMPETING FINANCIAL INTERESTS</bold>
      </p>
      <p>None.</p>
    </fn>
  </fn-group>
  <ref-list>
    <ref id="R1">
      <label>1</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Conesa</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A survey of best practices for RNA-seq data analysis</article-title>
        <source>Genome Biol</source>
        <volume>17</volume>
        <fpage>13</fpage>
        <year>2016</year>
        <pub-id pub-id-type="pmid">26813401</pub-id>
      </element-citation>
    </ref>
    <ref id="R2">
      <label>2</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Robinson</surname>
            <given-names>MD</given-names>
          </name>
          <name>
            <surname>Oshlack</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>A scaling normalization method for differential expression analysis of RNA-seq data</article-title>
        <source>Genome Biol</source>
        <volume>11</volume>
        <fpage>R25</fpage>
        <year>2010</year>
        <pub-id pub-id-type="pmid">20196867</pub-id>
      </element-citation>
    </ref>
    <ref id="R3">
      <label>3</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Anders</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Huber</surname>
            <given-names>W</given-names>
          </name>
        </person-group>
        <article-title>Differential expression analysis for sequence count data</article-title>
        <source>Genome Biol</source>
        <volume>11</volume>
        <fpage>R106</fpage>
        <year>2010</year>
        <pub-id pub-id-type="pmid">20979621</pub-id>
      </element-citation>
    </ref>
    <ref id="R4">
      <label>4</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bacher</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Kendziorski</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>Design and computational analysis of single-cell RNA-sequencing experiments</article-title>
        <source>Genome Biol</source>
        <volume>17</volume>
        <fpage>63</fpage>
        <year>2016</year>
        <pub-id pub-id-type="pmid">27052890</pub-id>
      </element-citation>
    </ref>
    <ref id="R5">
      <label>5</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lun</surname>
            <given-names>LAT</given-names>
          </name>
          <name>
            <surname>Bach</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Marioni</surname>
            <given-names>JC</given-names>
          </name>
        </person-group>
        <article-title>Pooling across cells to normalize single-cell RNA sequencing data with many zero counts</article-title>
        <source>Genome Biol</source>
        <volume>17</volume>
        <fpage>75</fpage>
        <year>2016</year>
        <pub-id pub-id-type="pmid">27122128</pub-id>
      </element-citation>
    </ref>
    <ref id="R6">
      <label>6</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Vallejos</surname>
            <given-names>CA</given-names>
          </name>
          <name>
            <surname>Marioni</surname>
            <given-names>JC</given-names>
          </name>
          <name>
            <surname>Richardson</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>BASiCS: Bayesian Analysis of Single-Cell Sequencing Data</article-title>
        <source>PLOS Comput Biol</source>
        <volume>11</volume>
        <fpage>e1004333</fpage>
        <year>2015</year>
        <pub-id pub-id-type="pmid">26107944</pub-id>
      </element-citation>
    </ref>
    <ref id="R7">
      <label>7</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Dewey</surname>
            <given-names>CN</given-names>
          </name>
        </person-group>
        <article-title>RSEM: accurate transcript quantification from RNA-Seq data with or without a reference genome</article-title>
        <source>BMC Bioinformatics</source>
        <volume>12</volume>
        <fpage>323</fpage>
        <year>2011</year>
        <pub-id pub-id-type="pmid">21816040</pub-id>
      </element-citation>
    </ref>
    <ref id="R8">
      <label>8</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kharchenko</surname>
            <given-names>PV</given-names>
          </name>
          <name>
            <surname>Silberstein</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Scadden</surname>
            <given-names>DT</given-names>
          </name>
        </person-group>
        <article-title>Bayesian approach to single-cell differential expression analysis</article-title>
        <source>Nat Methods</source>
        <volume>11</volume>
        <fpage>740</fpage>
        <lpage>742</lpage>
        <year>2014</year>
        <pub-id pub-id-type="pmid">24836921</pub-id>
      </element-citation>
    </ref>
    <ref id="R9">
      <label>9</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Finak</surname>
            <given-names>G</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>MAST: a flexible statistical framework for assessing transcriptional changes and characterizing heterogeneity in single-cell RNA sequencing data</article-title>
        <source>Genome Biol</source>
        <volume>16</volume>
        <fpage>278</fpage>
        <year>2015</year>
        <pub-id pub-id-type="pmid">26653891</pub-id>
      </element-citation>
    </ref>
    <ref id="R10">
      <label>10</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Leng</surname>
            <given-names>N</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Oscope identifies oscillatory genes in unsynchronized single-cell RNA-seq experiments</article-title>
        <source>Nat Methods</source>
        <volume>12</volume>
        <fpage>947</fpage>
        <lpage>950</lpage>
        <year>2015</year>
        <pub-id pub-id-type="pmid">26301841</pub-id>
      </element-citation>
    </ref>
    <ref id="R11">
      <label>11</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sakaue-Sawano</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Visualizing spatiotemporal dynamics of multicellular cell-cycle progression</article-title>
        <source>Cell</source>
        <volume>132</volume>
        <fpage>487</fpage>
        <lpage>98</lpage>
        <year>2008</year>
        <pub-id pub-id-type="pmid">18267078</pub-id>
      </element-citation>
    </ref>
    <ref id="R12">
      <label>12</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Anders</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Pyl</surname>
            <given-names>PT</given-names>
          </name>
          <name>
            <surname>Huber</surname>
            <given-names>W</given-names>
          </name>
        </person-group>
        <article-title>HTSeq-A Python framework to work with high-throughput sequencing data</article-title>
        <source>Bioinformatics</source>
        <volume>31</volume>
        <fpage>166</fpage>
        <lpage>169</lpage>
        <year>2015</year>
        <pub-id pub-id-type="pmid">25260700</pub-id>
      </element-citation>
    </ref>
    <ref id="R13">
      <label>13</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Johnson</surname>
            <given-names>WE</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Rabinovic</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Adjusting batch effects in microarray expression data using empirical Bayes methods</article-title>
        <source>Biostatistics</source>
        <volume>8</volume>
        <fpage>118</fpage>
        <lpage>127</lpage>
        <year>2007</year>
        <pub-id pub-id-type="pmid">16632515</pub-id>
      </element-citation>
    </ref>
    <ref id="R14">
      <label>14</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Leek</surname>
            <given-names>JT</given-names>
          </name>
          <name>
            <surname>Storey</surname>
            <given-names>JD</given-names>
          </name>
        </person-group>
        <article-title>Capturing heterogeneity in gene expression studies by surrogate variable analysis</article-title>
        <source>PLoS Genet</source>
        <volume>3</volume>
        <fpage>1724</fpage>
        <lpage>1735</lpage>
        <year>2007</year>
        <pub-id pub-id-type="pmid">17907809</pub-id>
      </element-citation>
    </ref>
    <ref id="R15">
      <label>15</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Risso</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Schwartz</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Sherlock</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Dudoit</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>GC-content normalization for RNA-Seq data</article-title>
        <source>BMC Bioinformatics</source>
        <volume>12</volume>
        <fpage>480</fpage>
        <year>2011</year>
        <pub-id pub-id-type="pmid">22177264</pub-id>
      </element-citation>
    </ref>
    <ref id="R16">
      <label>16</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lin</surname>
            <given-names>Y</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Comparison of normalization and differential expression analyses using RNA-Seq data from 726 individual Drosophila melanogaster</article-title>
        <source>BMC Genomics</source>
        <volume>17</volume>
        <fpage>28</fpage>
        <year>2016</year>
        <pub-id pub-id-type="pmid">26732976</pub-id>
      </element-citation>
    </ref>
    <ref id="R17">
      <label>17</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>McDavid</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Finak</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Gottardo</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>The contribution of cell cycle to heterogeneity in single-cell RNA-seq data</article-title>
        <source>Nat Biotechnol</source>
        <volume>34</volume>
        <fpage>591</fpage>
        <lpage>593</lpage>
        <year>2016</year>
        <pub-id pub-id-type="pmid">27281413</pub-id>
      </element-citation>
    </ref>
    <ref id="R18">
      <label>18</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sengupta</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Rayan</surname>
            <given-names>NA</given-names>
          </name>
          <name>
            <surname>Lim</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Lim</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Prabhakar</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Fast, scalable and accurate differential expression analysis for single cells</article-title>
        <source>bioRxiv</source>
        <comment>49734</comment>
        <year>2016</year>
        <pub-id pub-id-type="doi">10.1101/049734</pub-id>
      </element-citation>
    </ref>
    <ref id="R19">
      <label>19</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Benjamini</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Hochberg</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Benjamini</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Hochberg</surname>
            <given-names>Y</given-names>
          </name>
        </person-group>
        <article-title>Controlling the false discovery rate: a practical and powerful approach to multiple testing</article-title>
        <source>J R Stat Soc B</source>
        <volume>57</volume>
        <fpage>289</fpage>
        <lpage>300</lpage>
        <year>1995</year>
      </element-citation>
    </ref>
    <ref id="R20">
      <label>20</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hou</surname>
            <given-names>Z</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A cost-effective RNA sequencing protocol for large-scale gene expression studies</article-title>
        <source>Sci Rep</source>
        <volume>5</volume>
        <fpage>9570</fpage>
        <year>2015</year>
        <pub-id pub-id-type="pmid">25831155</pub-id>
      </element-citation>
    </ref>
    <ref id="R21">
      <label>21</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chen</surname>
            <given-names>G</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Chemically defined conditions for human iPSC derivation and culture</article-title>
        <source>Nat Methods</source>
        <volume>8</volume>
        <fpage>424</fpage>
        <lpage>429</lpage>
        <year>2011</year>
        <pub-id pub-id-type="pmid">21478862</pub-id>
      </element-citation>
    </ref>
    <ref id="R22">
      <label>22</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Langmead</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Trapnell</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Pop</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Salzberg</surname>
            <given-names>SL</given-names>
          </name>
        </person-group>
        <article-title>Ultrafast and memory-efficient alignment of short DNA sequences to the human genome</article-title>
        <source>Genome Biol</source>
        <volume>10</volume>
        <fpage>R25</fpage>
        <year>2009</year>
        <pub-id pub-id-type="pmid">19261174</pub-id>
      </element-citation>
    </ref>
    <ref id="R23">
      <label>23</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Santos</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Wernersson</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Jensen</surname>
            <given-names>LJ</given-names>
          </name>
        </person-group>
        <article-title>Cyclebase 3.0: a multi-organism database on cell-cycle regulation and phenotypes</article-title>
        <source>Nucleic Acids Res</source>
        <volume>43</volume>
        <fpage>D1140</fpage>
        <lpage>D1144</lpage>
        <year>2015</year>
        <pub-id pub-id-type="pmid">25378319</pub-id>
      </element-citation>
    </ref>
    <ref id="R24">
      <label>24</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Buettner</surname>
            <given-names>F</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Computational analysis of cell-to-cell heterogeneity in single-cell RNA-sequencing data reveals hidden subpopulations of cells</article-title>
        <source>Nat Biotechnol</source>
        <volume>33</volume>
        <fpage>155</fpage>
        <lpage>160</lpage>
        <year>2015</year>
        <pub-id pub-id-type="pmid">25599176</pub-id>
      </element-citation>
    </ref>
    <ref id="R25">
      <label>25</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Islam</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Characterization of the single-cell transcriptional landscape by highly multiplex RNA-seq</article-title>
        <source>Genome Res</source>
        <volume>21</volume>
        <fpage>1160</fpage>
        <lpage>7</lpage>
        <year>2011</year>
        <pub-id pub-id-type="pmid">21543516</pub-id>
      </element-citation>
    </ref>
    <ref id="R26">
      <label>26</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chu</surname>
            <given-names>LF</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Single-cell RNA-seq reveals novel regulators of human embryonic stem cell differentiation to definitive endoderm</article-title>
        <source>Genome Biol</source>
        <volume>17</volume>
        <fpage>173</fpage>
        <year>2016</year>
        <pub-id pub-id-type="pmid">27534536</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
<floats-group>
  <fig id="F1" orientation="portrait" position="float">
    <label>Fig. 1</label>
    <caption>
      <p>Count-depth relationships in bulk and single-cell datasets before and after normalization. For each gene, median quantile regression was used to estimate the count-depth relationship before normalization and after normalization via MR or SCnorm for the H1 bulk RNA-seq data set (panels <bold>(a) – (f)</bold>) and the DEC scRNA-seq data set (panels <bold>(g)–(l)</bold>). Panel <bold>(a)</bold> shows log-expression vs. log-depth and estimated regression fits for three genes containing no zero measurements and having low, moderate, and high expression defined as median expression among non-zero un-normalized measurements in the 10<sup>th</sup>–20<sup>th</sup> quantile, 40<sup>th</sup>–50<sup>th</sup> quantile, and 80<sup>th</sup>–90<sup>th</sup> quantile, respectively. Panel <bold>(b)</bold> shows densities of slopes within each of ten equally sized gene groups where a gene’s group membership is determined by its median expression among non-zero un-normalized measurements. Panels <bold>(c)</bold> and <bold>(d)</bold> show the data in panels <bold>(a)</bold> and <bold>(b)</bold> normalized via MR; (<bold>e</bold>) and (<bold>f</bold>) show the data normalized by SCnorm. Panels <bold>(g)–(l)</bold> are structurally identical to <bold>(a)–(f)</bold> for the DEC scRNA-seq data set. Qualitatively similar results are observed if slopes are calculated via generalized linear models (<xref rid="SD1" ref-type="supplementary-material">Supplementary Note S2</xref> and <xref rid="SD1" ref-type="supplementary-material">Supplementary Fig. S1</xref>).</p>
    </caption>
    <graphic xlink:href="nihms862746f1"/>
  </fig>
  <fig id="F2" orientation="portrait" position="float">
    <label>Fig. 2</label>
    <caption>
      <p>Fold-changes and DE genes calculated from the H1 case study data. For each gene, the fold-change of non-zero counts between the H1-4M and H1-1M groups was computed for data following normalization via SCnorm, MR, TPM, scran, SCDE, and BASiCS. Box-plots of gene-specific fold-changes are shown in panel <bold>(a)</bold> for data normalized by each method. The number of genes identified as DE using MAST is shown in panel <bold>(b)</bold>. Genes are divided into four equally sized expression groups based on their median among non-zero un-normalized expression measurements and results are shown as a function of expression group. Motivation for considering non-zero counts to calculate fold-change is discussed in <xref rid="SD1" ref-type="supplementary-material">Supplementary Note S3</xref>.</p>
    </caption>
    <graphic xlink:href="nihms862746f2"/>
  </fig>
  <fig id="F3" orientation="portrait" position="float">
    <label>Fig. 3</label>
    <caption>
      <p>PCA applied to the H1-FUCCI case study. The upper left panel shows the first two principal components (PC1 vs. PC2) from a PCA analysis using 578 cell cycle genes normalized via SCnorm. The other panels show similar results for data normalized using MR, TPM, scran and SCDE. Cells are colored according to cell cycle phase. 95% confidence ellipses are shown for each method. Misclassification rates for SCnorm, MR, TPM, scran, and SCDE averaged across the three cell cycle phases are 0.26, 0.32, 0.38, 0.29, and 0.45, respectively.</p>
    </caption>
    <graphic xlink:href="nihms862746f3"/>
  </fig>
</floats-group>
