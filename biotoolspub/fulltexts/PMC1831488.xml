<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-title>BMC Bioinformatics</journal-title>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">1831488</article-id>
    <article-id pub-id-type="publisher-id">1471-2105-8-72</article-id>
    <article-id pub-id-type="pmid">17335588</article-id>
    <article-id pub-id-type="doi">10.1186/1471-2105-8-72</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Methodology Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Visualization of three-way comparisons of omics data</article-title>
    </title-group>
    <contrib-group>
      <contrib id="A1" contrib-type="author">
        <name>
          <surname>Baran</surname>
          <given-names>Richard</given-names>
        </name>
        <xref ref-type="aff" rid="I1">1</xref>
        <xref ref-type="aff" rid="I3">3</xref>
        <email>richard.baran@gmail.com</email>
      </contrib>
      <contrib id="A2" corresp="yes" contrib-type="author">
        <name>
          <surname>Robert</surname>
          <given-names>Martin</given-names>
        </name>
        <xref ref-type="aff" rid="I1">1</xref>
        <email>mrobert@ttck.keio.ac.jp</email>
      </contrib>
      <contrib id="A3" contrib-type="author">
        <name>
          <surname>Suematsu</surname>
          <given-names>Makoto</given-names>
        </name>
        <xref ref-type="aff" rid="I2">2</xref>
        <email>msuem@sc.itc.keio.ac.jp</email>
      </contrib>
      <contrib id="A4" contrib-type="author">
        <name>
          <surname>Soga</surname>
          <given-names>Tomoyoshi</given-names>
        </name>
        <xref ref-type="aff" rid="I1">1</xref>
        <email>soga@sfc.keio.ac.jp</email>
      </contrib>
      <contrib id="A5" contrib-type="author">
        <name>
          <surname>Tomita</surname>
          <given-names>Masaru</given-names>
        </name>
        <xref ref-type="aff" rid="I1">1</xref>
        <email>mt@sfc.keio.ac.jp</email>
      </contrib>
    </contrib-group>
    <aff id="I1"><label>1</label>Institute for Advanced Biosciences, Keio University, Tsuruoka, Yamagata 997-0017, Japan</aff>
    <aff id="I2"><label>2</label>Department of Biochemistry and Integrative Medical Biology, School of Medicine, Keio University, Shinanomachi, Shinjuku-ku, Tokyo 160-8582, Japan</aff>
    <aff id="I3"><label>3</label>Present address: Institute of Chemistry, Slovak Academy of Sciences, Dúbravská cesta 9, 845 38 Bratislava, Slovakia</aff>
    <pub-date pub-type="collection">
      <year>2007</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>5</day>
      <month>3</month>
      <year>2007</year>
    </pub-date>
    <volume>8</volume>
    <fpage>72</fpage>
    <lpage>72</lpage>
    <ext-link ext-link-type="uri" xlink:href="http://www.biomedcentral.com/1471-2105/8/72"/>
    <history>
      <date date-type="received">
        <day>22</day>
        <month>6</month>
        <year>2006</year>
      </date>
      <date date-type="accepted">
        <day>5</day>
        <month>3</month>
        <year>2007</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>Copyright © 2007 Baran et al; licensee BioMed Central Ltd.</copyright-statement>
      <copyright-year>2007</copyright-year>
      <copyright-holder>Baran et al; licensee BioMed Central Ltd.</copyright-holder>
      <license license-type="open-access" xlink:href="http://creativecommons.org/licenses/by/2.0">
        <p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/2.0"/>), which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly cited.</p>
        <!--<rdf xmlns="http://web.resource.org/cc/" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:dc="http://purl.org/dc/elements/1.1" xmlns:dcterms="http://purl.org/dc/terms"><Work xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:dcterms="http://purl.org/dc/terms/" rdf:about=""><license rdf:resource="http://creativecommons.org/licenses/by/2.0"/><dc:type rdf:resource="http://purl.org/dc/dcmitype/Text"/><dc:author>
               Baran
               Richard
               
               
               richard.baran@gmail.com
            </dc:author><dc:title>
            Visualization of three-way comparisons of omics data
         </dc:title><dc:date>2007</dc:date><dcterms:bibliographicCitation>BMC Bioinformatics 8(1): 72-. (2007)</dcterms:bibliographicCitation><dc:identifier type="sici">1471-2105(2007)8:1&#x0003c;72&#x0003e;</dc:identifier><dcterms:isPartOf>urn:ISSN:1471-2105</dcterms:isPartOf><License rdf:about="http://creativecommons.org/licenses/by/2.0"><permits rdf:resource="http://web.resource.org/cc/Reproduction" xmlns=""/><permits rdf:resource="http://web.resource.org/cc/Distribution" xmlns=""/><requires rdf:resource="http://web.resource.org/cc/Notice" xmlns=""/><requires rdf:resource="http://web.resource.org/cc/Attribution" xmlns=""/><permits rdf:resource="http://web.resource.org/cc/DerivativeWorks" xmlns=""/></License></Work></rdf>-->
      </license>
    </permissions>
    <abstract>
      <sec>
        <title>Background</title>
        <p>Density plot visualizations (also referred to as heat maps or color maps) are widely used in different fields including large-scale omics studies in biological sciences. However, the current color-codings limit the visualizations to single datasets or pairwise comparisons.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p>We propose a color-coding approach for the representation of three-way comparisons. The approach is based on the HSB (hue, saturation, brightness) color model. The three compared values are assigned specific hue values from the circular hue range (e.g. red, green, and blue). The hue value representing the three-way comparison is calculated according to the distribution of three compared values. If two of the values are identical and one is different, the resulting hue is set to the characteristic hue of the differing value. If all three compared values are different, the resulting hue is selected from a color gradient running between the hues of the two most distant values (as measured by the absolute value of their difference) according to the relative position of the third value between the two. The saturation of the color representing the three-way comparison reflects the amplitude (or extent) of the numerical difference between the two most distant values according to a scale of interest. The brightness is set to a maximum value by default but can be used to encode additional information about the three-way comparison.</p>
      </sec>
      <sec>
        <title>Conclusion</title>
        <p>We propose a novel color-coding approach for intuitive visualization of three-way comparisons of omics data.</p>
      </sec>
    </abstract>
  </article-meta>
</front>
<body>
  <sec>
    <title>Background</title>
    <p>Color-coded representations of differences between omics datasets provide an intuitive and global comparative view of the data [<xref ref-type="bibr" rid="B1">1</xref>]. Such visualizations further facilitate the use of human pattern recognition abilities to complement the automated approaches to pinpoint subtle differences [<xref ref-type="bibr" rid="B2">2</xref>]. Currently, most visualizations are limited to pairwise comparisons where differences of interest between two corresponding datapoints are mapped onto color gradients for positive or negative ranges. In addition, results of statistical tests (F ratio, <italic>z</italic>-score, quartile analysis, etc.) performed across multiple datasets can be visualized to highlight sets of corresponding datapoints containing a difference [<xref ref-type="bibr" rid="B3">3</xref>]. These results, however, do not provide information about the actual distribution of the corresponding datapoints – which of them are similar or different. Often, three (sets of) omics datasets are compared to gain insight into biological function [<xref ref-type="bibr" rid="B4">4</xref>-<xref ref-type="bibr" rid="B8">8</xref>]. Intuitive three-way comparisons can further be useful for specific applications such as in drug discovery where therapeutic equivalence studies may include a control and two different treatments, namely the tested and accepted drug and a new compound under development.</p>
    <p>Here, we propose a novel color-coding approach for the visualization of three-way comparisons. The approach is based on the HSB (hue, saturation, brightness) color model [<xref ref-type="bibr" rid="B9">9</xref>]. The hue component of the HSB color model provides a convenient way to perform smooth color transitions making it a popular choice for density plot (color map, heat map) visualizations. We also employ another feature of the hue component, namely its circular nature, to perform mappings of possible distributions of three compared values onto the color space. The proposed color-coding approach facilitates intuitive overall visualization of three-way comparisons of large datasets.</p>
  </sec>
  <sec>
    <title>Results</title>
    <p>The basic color scheme, based on the HSB model, is shown in Figure <xref ref-type="fig" rid="F1">1</xref> together with color representations for three-way comparisons of selected sets of values. The color representations were calculated according to the proposed procedure described in the Methods section. When the three compared values are identical, the resulting color is white (Figure <xref ref-type="fig" rid="F1">1</xref>, rows 1–3). If two of the values are identical and one of them is different, the resulting color corresponds to the hue characteristic of the differing value. For example, if <italic>a </italic>is the different value, the resulting color is red (rows 4–7); if <italic>b </italic>is the different value, the resulting color is green (rows 8–11); and if <italic>c </italic>is the different value, the resulting color is blue (rows 12 and 13).</p>
    <fig position="float" id="F1">
      <label>Figure 1</label>
      <caption>
        <p><bold>Examples of color-codings for three-way comparisons</bold>. Color representations for three-way comparisons of selected values <italic>a</italic>, <italic>b</italic>, and <italic>c </italic>calculated using the proposed procedure are shown in the column labeled HSB-based. Colors acquired by substituting values of <italic>a</italic>, <italic>b</italic>, and <italic>c </italic>directly for red, green, and blue or cyan, magenta, and yellow (black = 0) are shown in columns labeled RGB or CMYK, respectively. The legend is drawn as a hexagon instead of a circle for convenience. Horizontal lines separate groups of values with similar distributions.</p>
      </caption>
      <graphic xlink:href="1471-2105-8-72-1"/>
    </fig>
    <p>When all three values to be compared are different, the color representing their three-way comparison is selected from the color gradient running between the characteristic hues of the two most distant values (measured by the absolute value of their difference). The exact color depends on the relative position of the remaining value between the two most distant values. If <italic>a </italic>and <italic>b </italic>are the most distant values and <italic>c </italic>lies half way between them, the resulting color is yellow (rows 14–17). If <italic>c </italic>lies closer to <italic>b</italic>, the color becomes orange (row 29) and if <italic>c </italic>lies closer to <italic>a</italic>, the color becomes yellow-green (row 30). Similarly, if <italic>a </italic>and <italic>c </italic>are the most distant and <italic>b </italic>lies half-way between them, the resulting color is pink (rows 18–24). If <italic>b </italic>and <italic>c </italic>are the most distant and <italic>a </italic>lies half-way between them, the resulting color is cyan (rows 25–28).</p>
    <p>The saturation of the colors indicates the extent of differences between the values. When two of the compared values are identical and one is different, the saturation value corresponds to the distance between the two identical values and the unique value (e.g. rows 4–13). If all three values are different, the saturation corresponds to the distance between the two most distant values (e.g. rows 18–28).</p>
    <p>To contrast other color schemes with our proposed color-coding method, Figure <xref ref-type="fig" rid="F1">1</xref> also shows colors which result from direct substitutions of the compared values into RGB (red, green, blue) and CMYK (cyan, magenta, yellow, black) color models. Identical values lead to colors from white to black (grayscale) gradient for both color models (rows 1–3). Distributions, in which two compared values are identical and one is different (rows 4–13) can each be represented by one of two colors with varying brightness. If <italic>a </italic>≠ <italic>b </italic>= <italic>c</italic>, direct RGB coding leads to red if <italic>a </italic>&gt; <italic>b </italic>= <italic>c </italic>(rows 4 and 7) or cyan if <italic>a </italic>&lt;<italic>b </italic>= <italic>c </italic>(rows 5 and 6). For both RGB and CMYK direct coding, using two colors per distribution group (separated by horizontal lines in Figure <xref ref-type="fig" rid="F1">1</xref>) may provide additional distinguishing features for individual distributions, but also lead to undesirable ambiguities. For example, the RGB colors for rows 18–20 corresponding to <italic>a </italic>≠ <italic>b </italic>≠ <italic>c </italic>and <italic>b </italic>lies half-way between <italic>a </italic>and <italic>c </italic>are very similar to cyan, corresponding to <italic>a </italic>≠ <italic>b </italic>= <italic>c </italic>(rows 5,6) and blue corresponding to <italic>a </italic>= <italic>b </italic>≠ <italic>c </italic>(row 12). Other similar sources of ambiguity can be found in both RGB and CMYK columns of Figure <xref ref-type="fig" rid="F1">1</xref>. Moreover, the brightness of the colors given by direct RGB or CMYK coding cannot be interpreted easily. For RGB direct coding, in some cases smaller absolute differences lead to darker colors (e.g. rows 4 and 7) while in other cases identical absolute differences lead to different brightness of the color (rows 21 and 22). For all these reasons the proposed color-coding approach appears superior for intuitive visualization of three-way comparisons. </p>
    <p>To illustrate how the visualization method can be used to analyze experimental data, we applied the proposed color-coding method to direct three-way comparisons of metabolite profiles. Three groups of replicate quantitative metabolite profiles (n = 5) derived from capillary electrophoresis time-of-flight mass spectrometry (CE-TOFMS) analysis of mouse liver samples were used for the comparison. The datasets originate from our previous work [<xref ref-type="bibr" rid="B2">2</xref>]. Replicate datasets from each group were normalized and averaged into single datasets which are visualized as density plots in Figure <xref ref-type="fig" rid="F2">2</xref>. In this case the data is represented in three dimensions as a map of signals in time (x-axis), molecular mass (m/z), and intensity (color). An additional filter dataset was generated by calculating the F ratio (one-way ANOVA) for the groups of all corresponding signal intensities from the original replicate datasets. A moving average smoothing filter (window size 9) was applied to all electropherograms in the filter dataset. The averaged datasets (Figure <xref ref-type="fig" rid="F2">2</xref>) were used for the generation of an initial three-way comparison result (not shown). This preliminary comparison was then processed to remove signals for which the corresponding F ratio value in the filter dataset was below a threshold value of 3.9 (corresponding to <italic>p </italic>= 0.05 when comparing three groups of five replicate values). The final filtered three-way comparison result is shown if Figure <xref ref-type="fig" rid="F3">3a</xref>.</p>
    <fig position="float" id="F2">
      <label>Figure 2</label>
      <caption>
        <p><bold>Metabolite profiles for the three-way comparison</bold>. Mouse liver extract metabolite profiles acquired by CE-TOFMS two hours after intraperitoneal injection with (<bold>a</bold>) vehicle (Control), (<bold>b</bold>) diethylmaleate (DEM), a non-protein thiol-depleting chemical, or (<bold>c</bold>) buthionine sulfoximine (BSO), an inhibitor of γ-glutamylcysteine synthase. The plotted datasets are averages of five normalized replicate datasets for cation measurements originating from our previous work [2]. The averaged datasets are visualized as density plots. For all plots, numbered ovals (annotation labels) indicate the expected locations of peaks of a set of known chemical compounds and are used for identification of metabolites on the density plots [2,3].</p>
      </caption>
      <graphic xlink:href="1471-2105-8-72-2"/>
    </fig>
    <fig position="float" id="F3">
      <label>Figure 3</label>
      <caption>
        <p><bold>Three-way comparison of metabolite profiles</bold>. (<bold>a</bold>) Absolute × relative three-way comparison of metabolite profiles shown in Figure 2. Averages of replicate datasets (n = 5) were used for the three-way comparison. The resulting dataset was filtered using F-ratio (one-way ANOVA) to select only statistically significant differences as described in the main text. (<bold>b</bold>) The Control dataset (Figure 2a) was overlaid on the three-way comparison result shown in panel (a) via the brightness value. Darkening of the colored spots indicates the size of the corresponding peaks in the Control dataset. Gray spots show peaks which do not significantly differ among the datasets. For both plots, numbered ovals (annotation labels) indicate the expected locations of peaks of a set of known chemical compounds and are used for identification of metabolites on the density plots [2,3].</p>
      </caption>
      <graphic xlink:href="1471-2105-8-72-3"/>
    </fig>
    <p>Parts of the data corresponding to the vicinity of the most significant differences according to the three-way comparison results (Figure <xref ref-type="fig" rid="F3">3a</xref>) in the normalized replicate datasets are shown in Figure <xref ref-type="fig" rid="F4">4</xref> in the form of overlaid extracted electropherograms. These represent the mass electropherograms of metabolite profiles obtained from CE-TOFMS and are used here to confirm visually that the signals are genuine and not due to noise or other artifacts.</p>
    <fig position="float" id="F4">
      <label>Figure 4</label>
      <caption>
        <p><bold>Candidate differences</bold>. Overlaid extracted ion electropherograms for the most significant differences from the three-way comparison results shown in Figure 3. Each panel represents data in the form of signal intensity (number of ions) over time for a specific mass interval (1 Da bin). The vertical dashed line indicates the position of the most significant difference according to the three-way comparison results. When present within panels, numbers correspond to the annotation labels in Figures 2 and 3.</p>
      </caption>
      <graphic xlink:href="1471-2105-8-72-4"/>
    </fig>
    <p>Multiple types of possible distributions of compared values, as discussed above, are visible in Figure <xref ref-type="fig" rid="F3">3a</xref>. Distributions in which one specific value is different and the remaining two compared values are similar are shown as red (label 321 in Figures <xref ref-type="fig" rid="F2">2</xref> and <xref ref-type="fig" rid="F3">3</xref>, corresponding to Figure <xref ref-type="fig" rid="F4">4c</xref>), green (labels 54 and 38, Figure <xref ref-type="fig" rid="F4">4a, g</xref>), or blue (near label 245, Figure <xref ref-type="fig" rid="F4">4j</xref>). Distributions in which all three of the compared values are different and one value lies approximately half-way between the remaining two are shown as yellow (near label 320, Figure <xref ref-type="fig" rid="F4">4f</xref>), pink (near label 312), or cyan (near label 305).</p>
    <p>As described in the Methods section, the brightness value of the HSB color model is not used in the proposed color-coding method but can be used to encode additional information about the three-way comparison. For example, Figure <xref ref-type="fig" rid="F3">3b</xref> shows an overlay of one of the compared averaged datasets (Figure <xref ref-type="fig" rid="F2">2a</xref>) onto the filtered three-way comparison result (Figure <xref ref-type="fig" rid="F3">3a</xref>) via the brightness value. This results in a darkening in the color of the spots that is proportional to the size of the corresponding peaks in the overlaid dataset. Peaks, which do not differ significantly among the three compared averaged datasets, lead to no signals on the filtered three-way comparison result (Figure <xref ref-type="fig" rid="F3">3a</xref>), but appear as gray spots in Figure <xref ref-type="fig" rid="F3">3b</xref> (e.g. labels 50, 177, 300) providing both a global overview of total sample composition and instant visualization of specific differences.</p>
  </sec>
  <sec>
    <title>Discussion</title>
    <p>Visualizations using the proposed color-coding approach provide intuitive overall views for three-way comparisons of large datasets. These visualizations further allow identification of signals different specifically in one of the three datasets or signals different for all three compared datasets.</p>
    <p>One limitation of the proposed color-coding is that distributions such as <italic>a </italic>&gt; <italic>b </italic>= <italic>c </italic>and <italic>a </italic>&lt;<italic>b </italic>= <italic>c </italic>produce the same result. In other words, if red, green, and blue are the characteristic hues for the three compared values, a red coloration only indicates that <italic>b </italic>and <italic>c </italic>are identical and that <italic>a </italic>is different. It does not specify whether <italic>a </italic>is greater than or smaller than the other two. Similarly, a yellow coloration indicates that <italic>a </italic>and <italic>b </italic>are the most distant values while <italic>c </italic>lies half-way between them. It does not specify which of <italic>a </italic>or <italic>b </italic>is greater than <italic>c</italic>. However, in most cases, simply knowing which of the three values are similar or different is the main objective and may be sufficient initially. The exact distribution can be confirmed subsequently (e.g. on the chromatograms generated for candidate differences) or undesirable distributions can be filtered out from the three-way comparison results.</p>
    <p>Alternative color-coding approaches for three-way comparisons are also possible. For example, normalizing the three compared values and using these directly as specifiers for the RGB (red, green, blue) color model provides a unique color-coding. However, the resulting colors do not represent the three-way differences as intuitively as the colors generated by the proposed approach.</p>
  </sec>
  <sec>
    <title>Conclusion</title>
    <p>The proposed color-coding approach allows intuitive overall visualizations of three-way comparisons of large datasets. The approach was demonstrated with metabolomic datasets but it can equally be applied to extend the visualizations of pairwise comparisons of gene expression data [<xref ref-type="bibr" rid="B1">1</xref>,<xref ref-type="bibr" rid="B10">10</xref>,<xref ref-type="bibr" rid="B11">11</xref>] or pathway-based visualizations [<xref ref-type="bibr" rid="B12">12</xref>,<xref ref-type="bibr" rid="B13">13</xref>] to three-way comparisons. Beyond omics data visualization in biological research, the generic nature of the color-coding approach is likely to extend its applicability to an even wider array of data analysis fields where a visual comparison of any three signals is desirable.</p>
  </sec>
  <sec sec-type="methods">
    <title>Methods</title>
    <sec>
      <title>Color-coding for three-way comparisons</title>
      <p>The color-coding for the representation of a three-way difference between three corresponding datapoints (<italic>a</italic>, <italic>b</italic>, and <italic>c</italic>) is based on the HSB (hue, saturation, brightness; ranges from 0 to 1) color model. The hue value of the color representing the three-way comparison of <italic>a</italic>, <italic>b</italic>, and <italic>c </italic>is calculated using one of the following equations, according to the signals distribution:</p>
      <p>
        <inline-formula>
          <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M1" name="1471-2105-8-72-i1" overflow="scroll">
            <mml:semantics definitionURL="" encoding="">
              <mml:mrow>
                <mml:msub>
                  <mml:mi>H</mml:mi>
                  <mml:mrow>
                    <mml:mi>r</mml:mi>
                    <mml:mi>e</mml:mi>
                    <mml:mi>s</mml:mi>
                    <mml:mi>u</mml:mi>
                    <mml:mi>l</mml:mi>
                    <mml:mi>t</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:mo>=</mml:mo>
                <mml:mrow>
                  <mml:mo>{</mml:mo>
                  <mml:mrow>
                    <mml:mtable>
                      <mml:mtr>
                        <mml:mtd>
                          <mml:mrow>
                            <mml:msup>
                              <mml:mn>0</mml:mn>
                              <mml:mo>∗</mml:mo>
                            </mml:msup>
                          </mml:mrow>
                        </mml:mtd>
                        <mml:mtd>
                          <mml:mrow>
                            <mml:mtext>for</mml:mtext>
                          </mml:mrow>
                        </mml:mtd>
                        <mml:mtd>
                          <mml:mrow>
                            <mml:mi>a</mml:mi>
                            <mml:mo>=</mml:mo>
                            <mml:mi>b</mml:mi>
                            <mml:mo>=</mml:mo>
                            <mml:mi>c</mml:mi>
                          </mml:mrow>
                        </mml:mtd>
                      </mml:mtr>
                      <mml:mtr>
                        <mml:mtd>
                          <mml:mrow>
                            <mml:msub>
                              <mml:mi>H</mml:mi>
                              <mml:mi>a</mml:mi>
                            </mml:msub>
                            <mml:mo>+</mml:mo>
                            <mml:mo stretchy="false">(</mml:mo>
                            <mml:msub>
                              <mml:mi>H</mml:mi>
                              <mml:mi>b</mml:mi>
                            </mml:msub>
                            <mml:mo>−</mml:mo>
                            <mml:msub>
                              <mml:mi>H</mml:mi>
                              <mml:mi>a</mml:mi>
                            </mml:msub>
                            <mml:mo stretchy="false">)</mml:mo>
                            <mml:mfrac>
                              <mml:mrow>
                                <mml:mrow>
                                  <mml:mo>|</mml:mo>
                                  <mml:mrow>
                                    <mml:mi>b</mml:mi>
                                    <mml:mo>−</mml:mo>
                                    <mml:mi>c</mml:mi>
                                  </mml:mrow>
                                  <mml:mo>|</mml:mo>
                                </mml:mrow>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mrow>
                                  <mml:mo>|</mml:mo>
                                  <mml:mrow>
                                    <mml:mi>a</mml:mi>
                                    <mml:mo>−</mml:mo>
                                    <mml:mi>b</mml:mi>
                                  </mml:mrow>
                                  <mml:mo>|</mml:mo>
                                </mml:mrow>
                              </mml:mrow>
                            </mml:mfrac>
                          </mml:mrow>
                        </mml:mtd>
                        <mml:mtd>
                          <mml:mrow>
                            <mml:mtext>for</mml:mtext>
                          </mml:mrow>
                        </mml:mtd>
                        <mml:mtd>
                          <mml:mrow>
                            <mml:mrow>
                              <mml:mo>|</mml:mo>
                              <mml:mrow>
                                <mml:mi>a</mml:mi>
                                <mml:mo>−</mml:mo>
                                <mml:mi>b</mml:mi>
                              </mml:mrow>
                              <mml:mo>|</mml:mo>
                            </mml:mrow>
                            <mml:mo>≥</mml:mo>
                            <mml:mrow>
                              <mml:mo>|</mml:mo>
                              <mml:mrow>
                                <mml:mi>b</mml:mi>
                                <mml:mo>−</mml:mo>
                                <mml:mi>c</mml:mi>
                              </mml:mrow>
                              <mml:mo>|</mml:mo>
                            </mml:mrow>
                            <mml:mo>∧</mml:mo>
                            <mml:mrow>
                              <mml:mo>|</mml:mo>
                              <mml:mrow>
                                <mml:mi>a</mml:mi>
                                <mml:mo>−</mml:mo>
                                <mml:mi>b</mml:mi>
                              </mml:mrow>
                              <mml:mo>|</mml:mo>
                            </mml:mrow>
                            <mml:mo>≥</mml:mo>
                            <mml:mrow>
                              <mml:mo>|</mml:mo>
                              <mml:mrow>
                                <mml:mi>a</mml:mi>
                                <mml:mo>−</mml:mo>
                                <mml:mi>c</mml:mi>
                              </mml:mrow>
                              <mml:mo>|</mml:mo>
                            </mml:mrow>
                          </mml:mrow>
                        </mml:mtd>
                      </mml:mtr>
                      <mml:mtr>
                        <mml:mtd>
                          <mml:mrow>
                            <mml:msub>
                              <mml:mi>H</mml:mi>
                              <mml:mi>b</mml:mi>
                            </mml:msub>
                            <mml:mo>+</mml:mo>
                            <mml:mo stretchy="false">(</mml:mo>
                            <mml:msub>
                              <mml:mi>H</mml:mi>
                              <mml:mi>c</mml:mi>
                            </mml:msub>
                            <mml:mo>−</mml:mo>
                            <mml:msub>
                              <mml:mi>H</mml:mi>
                              <mml:mi>b</mml:mi>
                            </mml:msub>
                            <mml:mo stretchy="false">)</mml:mo>
                            <mml:mfrac>
                              <mml:mrow>
                                <mml:mrow>
                                  <mml:mo>|</mml:mo>
                                  <mml:mrow>
                                    <mml:mi>a</mml:mi>
                                    <mml:mo>−</mml:mo>
                                    <mml:mi>c</mml:mi>
                                  </mml:mrow>
                                  <mml:mo>|</mml:mo>
                                </mml:mrow>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mrow>
                                  <mml:mo>|</mml:mo>
                                  <mml:mrow>
                                    <mml:mi>b</mml:mi>
                                    <mml:mo>−</mml:mo>
                                    <mml:mi>c</mml:mi>
                                  </mml:mrow>
                                  <mml:mo>|</mml:mo>
                                </mml:mrow>
                              </mml:mrow>
                            </mml:mfrac>
                          </mml:mrow>
                        </mml:mtd>
                        <mml:mtd>
                          <mml:mrow>
                            <mml:mtext>for</mml:mtext>
                          </mml:mrow>
                        </mml:mtd>
                        <mml:mtd>
                          <mml:mrow>
                            <mml:mrow>
                              <mml:mo>|</mml:mo>
                              <mml:mrow>
                                <mml:mi>b</mml:mi>
                                <mml:mo>−</mml:mo>
                                <mml:mi>c</mml:mi>
                              </mml:mrow>
                              <mml:mo>|</mml:mo>
                            </mml:mrow>
                            <mml:mo>&gt;</mml:mo>
                            <mml:mrow>
                              <mml:mo>|</mml:mo>
                              <mml:mrow>
                                <mml:mi>a</mml:mi>
                                <mml:mo>−</mml:mo>
                                <mml:mi>b</mml:mi>
                              </mml:mrow>
                              <mml:mo>|</mml:mo>
                            </mml:mrow>
                            <mml:mo>∧</mml:mo>
                            <mml:mrow>
                              <mml:mo>|</mml:mo>
                              <mml:mrow>
                                <mml:mi>b</mml:mi>
                                <mml:mo>−</mml:mo>
                                <mml:mi>c</mml:mi>
                              </mml:mrow>
                              <mml:mo>|</mml:mo>
                            </mml:mrow>
                            <mml:mo>≥</mml:mo>
                            <mml:mrow>
                              <mml:mo>|</mml:mo>
                              <mml:mrow>
                                <mml:mi>a</mml:mi>
                                <mml:mo>−</mml:mo>
                                <mml:mi>c</mml:mi>
                              </mml:mrow>
                              <mml:mo>|</mml:mo>
                            </mml:mrow>
                          </mml:mrow>
                        </mml:mtd>
                      </mml:mtr>
                      <mml:mtr>
                        <mml:mtd>
                          <mml:mrow>
                            <mml:mtext>Mod</mml:mtext>
                            <mml:mrow>
                              <mml:mo>[</mml:mo>
                              <mml:mrow>
                                <mml:msub>
                                  <mml:mi>H</mml:mi>
                                  <mml:mi>c</mml:mi>
                                </mml:msub>
                                <mml:mo>+</mml:mo>
                                <mml:mo stretchy="false">(</mml:mo>
                                <mml:msub>
                                  <mml:mi>H</mml:mi>
                                  <mml:mi>a</mml:mi>
                                </mml:msub>
                                <mml:mo>+</mml:mo>
                                <mml:mn>1</mml:mn>
                                <mml:mo>−</mml:mo>
                                <mml:msub>
                                  <mml:mi>H</mml:mi>
                                  <mml:mi>c</mml:mi>
                                </mml:msub>
                                <mml:mo stretchy="false">)</mml:mo>
                                <mml:mfrac>
                                  <mml:mrow>
                                    <mml:mrow>
                                      <mml:mo>|</mml:mo>
                                      <mml:mrow>
                                        <mml:mi>a</mml:mi>
                                        <mml:mo>−</mml:mo>
                                        <mml:mi>b</mml:mi>
                                      </mml:mrow>
                                      <mml:mo>|</mml:mo>
                                    </mml:mrow>
                                  </mml:mrow>
                                  <mml:mrow>
                                    <mml:mrow>
                                      <mml:mo>|</mml:mo>
                                      <mml:mrow>
                                        <mml:mi>a</mml:mi>
                                        <mml:mo>−</mml:mo>
                                        <mml:mi>c</mml:mi>
                                      </mml:mrow>
                                      <mml:mo>|</mml:mo>
                                    </mml:mrow>
                                  </mml:mrow>
                                </mml:mfrac>
                                <mml:mo>,</mml:mo>
                                <mml:mn>1</mml:mn>
                              </mml:mrow>
                              <mml:mo>]</mml:mo>
                            </mml:mrow>
                          </mml:mrow>
                        </mml:mtd>
                        <mml:mtd>
                          <mml:mrow>
                            <mml:mtext>for</mml:mtext>
                          </mml:mrow>
                        </mml:mtd>
                        <mml:mtd>
                          <mml:mrow>
                            <mml:mrow>
                              <mml:mo>|</mml:mo>
                              <mml:mrow>
                                <mml:mi>a</mml:mi>
                                <mml:mo>−</mml:mo>
                                <mml:mi>c</mml:mi>
                              </mml:mrow>
                              <mml:mo>|</mml:mo>
                            </mml:mrow>
                            <mml:mo>&gt;</mml:mo>
                            <mml:mrow>
                              <mml:mo>|</mml:mo>
                              <mml:mrow>
                                <mml:mi>a</mml:mi>
                                <mml:mo>−</mml:mo>
                                <mml:mi>b</mml:mi>
                              </mml:mrow>
                              <mml:mo>|</mml:mo>
                            </mml:mrow>
                            <mml:mo>∧</mml:mo>
                            <mml:mrow>
                              <mml:mo>|</mml:mo>
                              <mml:mrow>
                                <mml:mi>a</mml:mi>
                                <mml:mo>−</mml:mo>
                                <mml:mi>c</mml:mi>
                              </mml:mrow>
                              <mml:mo>|</mml:mo>
                            </mml:mrow>
                            <mml:mo>&gt;</mml:mo>
                            <mml:mrow>
                              <mml:mo>|</mml:mo>
                              <mml:mrow>
                                <mml:mi>b</mml:mi>
                                <mml:mo>−</mml:mo>
                                <mml:mi>c</mml:mi>
                              </mml:mrow>
                              <mml:mo>|</mml:mo>
                            </mml:mrow>
                          </mml:mrow>
                        </mml:mtd>
                      </mml:mtr>
                    </mml:mtable>
                  </mml:mrow>
                </mml:mrow>
              </mml:mrow>
              <mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaacqWGibasdaWgaaWcbaGaemOCaiNaemyzauMaem4CamNaemyDauNaemiBaWMaemiDaqhabeaakiabg2da9maaceqabaqbaeqabqWaaaaabaGaeGimaaZaaWbaaSqabeaacqGHxiIkaaaakeaacqqGMbGzcqqGVbWBcqqGYbGCaeaacqWGHbqycqGH9aqpcqWGIbGycqGH9aqpcqWGJbWyaeaacqWGibasdaWgaaWcbaGaemyyaegabeaakiabgUcaRiabcIcaOiabdIeainaaBaaaleaacqWGIbGyaeqaaOGaeyOeI0IaemisaG0aaSbaaSqaaiabdggaHbqabaGccqGGPaqkdaWcaaqaamaaemaabaGaemOyaiMaeyOeI0Iaem4yamgacaGLhWUaayjcSdaabaWaaqWaaeaacqWGHbqycqGHsislcqWGIbGyaiaawEa7caGLiWoaaaaabaGaeeOzayMaee4Ba8MaeeOCaihabaWaaqWaaeaacqWGHbqycqGHsislcqWGIbGyaiaawEa7caGLiWoacqGHLjYSdaabdaqaaiabdkgaIjabgkHiTiabdogaJbGaay5bSlaawIa7aiabgEIizpaaemaabaGaemyyaeMaeyOeI0IaemOyaigacaGLhWUaayjcSdGaeyyzIm7aaqWaaeaacqWGHbqycqGHsislcqWGJbWyaiaawEa7caGLiWoaaeaacqWGibasdaWgaaWcbaGaemOyaigabeaakiabgUcaRiabcIcaOiabdIeainaaBaaaleaacqWGJbWyaeqaaOGaeyOeI0IaemisaG0aaSbaaSqaaiabdkgaIbqabaGccqGGPaqkdaWcaaqaamaaemaabaGaemyyaeMaeyOeI0Iaem4yamgacaGLhWUaayjcSdaabaWaaqWaaeaacqWGIbGycqGHsislcqWGJbWyaiaawEa7caGLiWoaaaaabaGaeeOzayMaee4Ba8MaeeOCaihabaWaaqWaaeaacqWGIbGycqGHsislcqWGJbWyaiaawEa7caGLiWoacqGH+aGpdaabdaqaaiabdggaHjabgkHiTiabdkgaIbGaay5bSlaawIa7aiabgEIizpaaemaabaGaemOyaiMaeyOeI0Iaem4yamgacaGLhWUaayjcSdGaeyyzIm7aaqWaaeaacqWGHbqycqGHsislcqWGJbWyaiaawEa7caGLiWoaaeaacqqGnbqtcqqGVbWBcqqGKbazdaWadaqaaiabdIeainaaBaaaleaacqWGJbWyaeqaaOGaey4kaSIaeiikaGIaemisaG0aaSbaaSqaaiabdggaHbqabaGccqGHRaWkcqaIXaqmcqGHsislcqWGibasdaWgaaWcbaGaem4yamgabeaakiabcMcaPmaalaaabaWaaqWaaeaacqWGHbqycqGHsislcqWGIbGyaiaawEa7caGLiWoaaeaadaabdaqaaiabdggaHjabgkHiTiabdogaJbGaay5bSlaawIa7aaaacqGGSaalcqaIXaqmaiaawUfacaGLDbaaaeaacqqGMbGzcqqGVbWBcqqGYbGCaeaadaabdaqaaiabdggaHjabgkHiTiabdogaJbGaay5bSlaawIa7aiabg6da+maaemaabaGaemyyaeMaeyOeI0IaemOyaigacaGLhWUaayjcSdGaey4jIK9aaqWaaeaacqWGHbqycqGHsislcqWGJbWyaiaawEa7caGLiWoacqGH+aGpdaabdaqaaiabdkgaIjabgkHiTiabdogaJbGaay5bSlaawIa7aaaaaiaawUhaaaaa@022C@</mml:annotation>
            </mml:semantics>
          </mml:math>
        </inline-formula>
      </p>
      <p>*value not relevant since zero saturation causes white color for any hue in this case</p>
      <p>The calculation can also be viewed as first assigning specific hue values (0 ≤ <italic>H</italic><sub><italic>a </italic></sub>&lt;<italic>H</italic><sub><italic>b </italic></sub>&lt;<italic>H</italic><sub><italic>c </italic></sub>&lt; 1) to each of the three datapoints (e.g. red to <italic>a</italic>, green to <italic>b</italic>, and blue to <italic>c</italic>). The two most distant datapoints are then found. The distance is measured as the absolute value of their difference. A color gradient is then generated according to the identity of the two most distant datapoints (e.g. red to green color gradient if <italic>a </italic>and <italic>b </italic>are the most distant). The gradient may take two possible paths between the two characteristic hue values on the circular hue scale. The gradient path is chosen so that it does not cross the characteristic hue value of the third datapoint (the red to green gradient from the above example would run via the yellow hue to avoid the blue hue). The resulting hue value is then selected from the gradient according to the relative position of the third datapoint between the two most distant datapoints. So if <italic>a </italic>(red, hue value 0) and <italic>b </italic>(green, 1/3) are the most distant datapoints, the resulting hue value would be 0 (red), 1/3 (green), 1/6 (yellow) or 1/12 (orange) if <italic>c </italic>= <italic>b</italic>, <italic>c </italic>= <italic>a</italic>, |<italic>a </italic>- <italic>b</italic>| = 2 |<italic>b </italic>- <italic>c</italic>| or |<italic>a </italic>- <italic>b</italic>| = 4 |<italic>b </italic>- <italic>c</italic>|, respectively. If the values of the three compared datapoints are identical, the hue value is irrelevant since the saturation value is set to 0 resulting in white color as described in the next paragraph.</p>
      <p>The saturation value of the color representing the three-way comparison is calculated using one of the following equations, according to the signals distribution:</p>
      <p>
        <inline-formula>
          <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M2" name="1471-2105-8-72-i2" overflow="scroll">
            <mml:semantics definitionURL="" encoding="">
              <mml:mrow>
                <mml:msub>
                  <mml:mi>S</mml:mi>
                  <mml:mrow>
                    <mml:mi>r</mml:mi>
                    <mml:mi>e</mml:mi>
                    <mml:mi>s</mml:mi>
                    <mml:mi>u</mml:mi>
                    <mml:mi>l</mml:mi>
                    <mml:mi>t</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:mo>=</mml:mo>
                <mml:mrow>
                  <mml:mo>{</mml:mo>
                  <mml:mrow>
                    <mml:mtable>
                      <mml:mtr>
                        <mml:mtd>
                          <mml:mn>0</mml:mn>
                        </mml:mtd>
                        <mml:mtd>
                          <mml:mrow>
                            <mml:mtext>for</mml:mtext>
                          </mml:mrow>
                        </mml:mtd>
                        <mml:mtd>
                          <mml:mrow>
                            <mml:mi>x</mml:mi>
                            <mml:mo>≤</mml:mo>
                            <mml:msub>
                              <mml:mi>X</mml:mi>
                              <mml:mrow>
                                <mml:mi>m</mml:mi>
                                <mml:mi>i</mml:mi>
                                <mml:mi>n</mml:mi>
                              </mml:mrow>
                            </mml:msub>
                          </mml:mrow>
                        </mml:mtd>
                      </mml:mtr>
                      <mml:mtr>
                        <mml:mtd>
                          <mml:mn>1</mml:mn>
                        </mml:mtd>
                        <mml:mtd>
                          <mml:mrow>
                            <mml:mtext>for</mml:mtext>
                          </mml:mrow>
                        </mml:mtd>
                        <mml:mtd>
                          <mml:mrow>
                            <mml:mi>x</mml:mi>
                            <mml:mo>≥</mml:mo>
                            <mml:msub>
                              <mml:mi>X</mml:mi>
                              <mml:mrow>
                                <mml:mi>m</mml:mi>
                                <mml:mi>a</mml:mi>
                                <mml:mi>x</mml:mi>
                              </mml:mrow>
                            </mml:msub>
                          </mml:mrow>
                        </mml:mtd>
                      </mml:mtr>
                      <mml:mtr>
                        <mml:mtd>
                          <mml:mrow>
                            <mml:mfrac>
                              <mml:mrow>
                                <mml:mi>x</mml:mi>
                                <mml:mo>−</mml:mo>
                                <mml:msub>
                                  <mml:mi>X</mml:mi>
                                  <mml:mrow>
                                    <mml:mi>m</mml:mi>
                                    <mml:mi>i</mml:mi>
                                    <mml:mi>n</mml:mi>
                                  </mml:mrow>
                                </mml:msub>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:msub>
                                  <mml:mi>X</mml:mi>
                                  <mml:mrow>
                                    <mml:mi>m</mml:mi>
                                    <mml:mi>a</mml:mi>
                                    <mml:mi>x</mml:mi>
                                  </mml:mrow>
                                </mml:msub>
                                <mml:mo>−</mml:mo>
                                <mml:msub>
                                  <mml:mi>X</mml:mi>
                                  <mml:mrow>
                                    <mml:mi>m</mml:mi>
                                    <mml:mi>i</mml:mi>
                                    <mml:mi>n</mml:mi>
                                  </mml:mrow>
                                </mml:msub>
                              </mml:mrow>
                            </mml:mfrac>
                          </mml:mrow>
                        </mml:mtd>
                        <mml:mtd>
                          <mml:mrow>
                            <mml:mtext>for</mml:mtext>
                          </mml:mrow>
                        </mml:mtd>
                        <mml:mtd>
                          <mml:mrow>
                            <mml:msub>
                              <mml:mi>X</mml:mi>
                              <mml:mrow>
                                <mml:mi>m</mml:mi>
                                <mml:mi>i</mml:mi>
                                <mml:mi>n</mml:mi>
                              </mml:mrow>
                            </mml:msub>
                            <mml:mo>&lt;</mml:mo>
                            <mml:mi>x</mml:mi>
                            <mml:mo>&lt;</mml:mo>
                            <mml:msub>
                              <mml:mi>X</mml:mi>
                              <mml:mrow>
                                <mml:mi>m</mml:mi>
                                <mml:mi>a</mml:mi>
                                <mml:mi>x</mml:mi>
                              </mml:mrow>
                            </mml:msub>
                          </mml:mrow>
                        </mml:mtd>
                      </mml:mtr>
                    </mml:mtable>
                  </mml:mrow>
                </mml:mrow>
              </mml:mrow>
              <mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaacqWGtbWudaWgaaWcbaGaemOCaiNaemyzauMaem4CamNaemyDauNaemiBaWMaemiDaqhabeaakiabg2da9maaceqabaqbaeqabmWaaaqaaiabicdaWaqaaiabbAgaMjabb+gaVjabbkhaYbqaaiabdIha4jabgsMiJkabdIfaynaaBaaaleaaieGacqWFTbqBcqWFPbqAcqWFUbGBaeqaaaGcbaGaeGymaedabaGaeeOzayMaee4Ba8MaeeOCaihabaGaemiEaGNaeyyzImRaemiwaG1aaSbaaSqaaiab=1gaTjab=fgaHjab=Hha4bqabaaakeaadaWcaaqaaiabdIha4jabgkHiTiabdIfaynaaBaaaleaacqWFTbqBcqWFPbqAcqWFUbGBaeqaaaGcbaGaemiwaG1aaSbaaSqaaiab=1gaTjab=fgaHjab=Hha4bqabaGccqGHsislcqWGybawdaWgaaWcbaGae8xBa0Mae8xAaKMae8NBa4gabeaaaaaakeaacqqGMbGzcqqGVbWBcqqGYbGCaeaacqWGybawdaWgaaWcbaGae8xBa0Mae8xAaKMae8NBa4gabeaakiabgYda8iabdIha4jabgYda8iabdIfaynaaBaaaleaacqWFTbqBcqWFHbqycqWF4baEaeqaaaaaaOGaay5Eaaaaaa@7B16@</mml:annotation>
            </mml:semantics>
          </mml:math>
        </inline-formula>
      </p>
      <p>where <italic>x </italic>corresponds to the distance between the two most distant signal intensities and <italic>X</italic><sub><italic>min </italic></sub>and <italic>X</italic><sub><italic>max </italic></sub>correspond to the beginning and the end of a scale of interest (0 ≤ <italic>X</italic><sub><italic>min </italic></sub>&lt;<italic>X</italic><sub><italic>max</italic></sub>). The color saturation then indicates the extent of the three-way difference between the compared signal intensities. This procedure provides what we coin as an absolute three-way difference. If the distance between the two most distant corresponding datapoints (<italic>x</italic>) in the formula above is divided by Max [|<italic>a</italic>|, |<italic>b</italic>|, |<italic>c</italic>|, <italic>x</italic>], we coin this result as a relative three-way difference. Multiplying the corresponding saturation values from the absolute and relative three-way comparison results amplifies differences significant in both absolute and relative terms (absolute × relative three-way difference). The resulting saturation values from any of the results can further be modified to suppress/enhance big/small values (by raising them to a certain power for example).</p>
      <p>The brightness value of the color representing the three-way comparison is set to 1 by default. However, the brightness can be used to encode additional information relating to the three-way comparison. One possibility is to use the brightness to extend the scale representing the extent of three-way difference. Once saturation reaches the maximum along the scale axis, the brightness could be lowered to a certain degree, causing darkening of the color. The color gradients along the signal intensity scale could thus be further extended. Another possibility is to use the brightness value to overlay additional data (e.g. one of the three compared datasets) onto the three-way comparison result (Figure <xref ref-type="fig" rid="F3">3b</xref>).</p>
      <p>The scale of interest, along which three values are compared, is not always linear. For example, the most different value among three values is not necessarily the one whose distance (absolute value of the difference) from the others is greatest, on a linear scale. In such cases, it is essential to preprocess the compared values accordingly (e.g. by taking the logarithm of the three values) prior to the calculation of a color representing the three-way comparison.</p>
    </sec>
    <sec>
      <title>Three-way comparisons of metabolite profiles</title>
      <p>A Mathematica (Wolfram Research, Inc.) package TriDAMP was implemented to facilitate direct three-way comparisons of raw metabolite profiles. This package is an extension for MathDAMP [<xref ref-type="bibr" rid="B3">3</xref>] and is available for academic use upon request to the authors. In addition to the generation of the three-way comparison visualizations, the TriDAMP package further facilitates filtering of the results according either to the extent of the difference, to the distribution of the three compared datapoints (which of them must or must not differ), or to statistical significance when comparing three groups of replicates. Overlaid extracted ion chromatograms from the compared normalized datasets corresponding to the vicinities of the most significant three-way differences can be generated in a ranked order. User modifications of the TriDAMP code could make it applicable to data other than that resulting from metabolomics analysis. More complete information about the TriDAMP package is available by referring to the online documentation [<xref ref-type="bibr" rid="B14">14</xref>].</p>
    </sec>
  </sec>
  <sec>
    <title>List of abbreviations</title>
    <p>CE – capillary electrophoresis</p>
    <p>TOFMS – time-of-flight mass spectrometry</p>
    <p>DEM – diethylmaleate</p>
    <p>BSO – buthionine sulfoximine</p>
  </sec>
  <sec>
    <title>Authors' contributions</title>
    <p>RB conceived the color-coding approach and implemented the TriDAMP package for direct three-way comparisons of raw metabolite profiles. All co-authors supported the evaluation of the color-coding approach and the TriDAMP package. The manuscript and the online documentation were written by RB and MR with inputs from all co-authors.</p>
  </sec>
</body>
<back>
  <ack>
    <sec>
      <title>Acknowledgements</title>
      <p>We thank Yuki Ueno of Human Metabolome Technologies, Inc. for technical help and support. This work was supported in parts by grants from the Ministry of Education, Culture, Sports, Science and Technology (MEXT) including the Leading Project for Biosimulation and the 21st Century COE Program entitled "Understanding and Control of Life's Function via Systems Biology" as well as research funds from Tsuruoka City and the Yamagata Prefectural Government.</p>
    </sec>
  </ack>
  <ref-list>
    <ref id="B1">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Eisen</surname>
            <given-names>MB</given-names>
          </name>
          <name>
            <surname>Spellman</surname>
            <given-names>PT</given-names>
          </name>
          <name>
            <surname>Brown</surname>
            <given-names>PO</given-names>
          </name>
          <name>
            <surname>Botstein</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>Cluster analysis and display of genome-wide expression patterns</article-title>
        <source>Proc Natl Acad Sci USA</source>
        <year>1998</year>
        <volume>95</volume>
        <fpage>14863</fpage>
        <lpage>14868</lpage>
        <pub-id pub-id-type="pmid">9843981</pub-id>
        <pub-id pub-id-type="doi">10.1073/pnas.95.25.14863</pub-id>
      </citation>
    </ref>
    <ref id="B2">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Soga</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Baran</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Suematsu</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Ueno</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Ikeda</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Sakurakawa</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Kakazu</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Ishikawa</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Robert</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Nishioka</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Tomita</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Differential metabolomics reveals ophthalmic acid as an oxidative stress biomarker indicating hepatic glutathione consumption</article-title>
        <source>J Biol Chem</source>
        <year>2006</year>
        <volume>281</volume>
        <fpage>16768</fpage>
        <lpage>16776</lpage>
        <pub-id pub-id-type="pmid">16608839</pub-id>
        <pub-id pub-id-type="doi">10.1074/jbc.M601876200</pub-id>
      </citation>
    </ref>
    <ref id="B3">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Baran</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Kochi</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Saito</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Suematsu</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Soga</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Nishioka</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Robert</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Tomita</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>MathDAMP: a package for differential analysis of metabolite profiles</article-title>
        <source>BMC Bioinformatics</source>
        <year>2006</year>
        <volume>7</volume>
        <fpage>530</fpage>
        <pub-id pub-id-type="pmid">17166258</pub-id>
        <pub-id pub-id-type="doi">10.1186/1471-2105-7-530</pub-id>
      </citation>
    </ref>
    <ref id="B4">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hedenfalk</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Duggan</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Radmacher</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Bittner</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Simon</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Meltzer</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Gusterson</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Esteller</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Kallioniemi</surname>
            <given-names>OP</given-names>
          </name>
          <name>
            <surname>Wilfond</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Borg</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Trent</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Gene-expression profiles in hereditary breast cancer</article-title>
        <source>N Engl J Med</source>
        <year>2001</year>
        <volume>344</volume>
        <fpage>539</fpage>
        <lpage>548</lpage>
        <pub-id pub-id-type="pmid">11207349</pub-id>
        <pub-id pub-id-type="doi">10.1056/NEJM200102223440801</pub-id>
      </citation>
    </ref>
    <ref id="B5">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kyng</surname>
            <given-names>KJ</given-names>
          </name>
          <name>
            <surname>May</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Kolvraa</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Bohr</surname>
            <given-names>VA</given-names>
          </name>
        </person-group>
        <article-title>Gene expression profiling in Werner syndrome closely resembles that of normal aging</article-title>
        <source>Proc Natl Acad Sci USA</source>
        <year>2003</year>
        <volume>100</volume>
        <fpage>12259</fpage>
        <lpage>12264</lpage>
        <pub-id pub-id-type="pmid">14527998</pub-id>
        <pub-id pub-id-type="doi">10.1073/pnas.2130723100</pub-id>
      </citation>
    </ref>
    <ref id="B6">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mueller</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>O'Rourke</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Chu</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Kim</surname>
            <given-names>CC</given-names>
          </name>
          <name>
            <surname>Sutton</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Falkow</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Protective immunity against Helicobacter is characterized by a unique transcriptional signature</article-title>
        <source>Proc Natl Acad Sci USA</source>
        <year>2003</year>
        <volume>100</volume>
        <fpage>12289</fpage>
        <lpage>12294</lpage>
        <pub-id pub-id-type="pmid">14528007</pub-id>
        <pub-id pub-id-type="doi">10.1073/pnas.1635231100</pub-id>
      </citation>
    </ref>
    <ref id="B7">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Laun</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Ramachandran</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Jarolim</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Herker</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Liang</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Weinberger</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Burhans</surname>
            <given-names>DT</given-names>
          </name>
          <name>
            <surname>Suter</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Madeo</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Burhans</surname>
            <given-names>WC</given-names>
          </name>
          <name>
            <surname>Breitenbach</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>A comparison of the aging and apoptotic transcriptome of Saccharomyces cerevisiae</article-title>
        <source>FEMS Yeast Res</source>
        <year>2005</year>
        <volume>5</volume>
        <fpage>1261</fpage>
        <lpage>1272</lpage>
        <pub-id pub-id-type="pmid">16168721</pub-id>
        <pub-id pub-id-type="doi">10.1016/j.femsyr.2005.07.006</pub-id>
      </citation>
    </ref>
    <ref id="B8">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Forner</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Foster</surname>
            <given-names>LJ</given-names>
          </name>
          <name>
            <surname>Campanaro</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Valle</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Mann</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Quantitative proteomic comparison of rat mitochondria from muscle, heart, and liver</article-title>
        <source>Mol Cell Proteomics</source>
        <year>2006</year>
        <volume>5</volume>
        <fpage>608</fpage>
        <lpage>619</lpage>
        <pub-id pub-id-type="pmid">16415296</pub-id>
        <pub-id pub-id-type="doi">10.1074/mcp.M500298-MCP200</pub-id>
      </citation>
    </ref>
    <ref id="B9">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Smith</surname>
            <given-names>AR</given-names>
          </name>
        </person-group>
        <article-title>Color gamut transform pairs</article-title>
        <source>ACM SIGGRAPH Computer Graphics</source>
        <year>1978</year>
        <volume>12</volume>
        <fpage>12</fpage>
        <lpage>19</lpage>
        <pub-id pub-id-type="doi">10.1145/965139.807361</pub-id>
      </citation>
    </ref>
    <ref id="B10">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wyrick</surname>
            <given-names>JJ</given-names>
          </name>
          <name>
            <surname>Holstege</surname>
            <given-names>FC</given-names>
          </name>
          <name>
            <surname>Jennings</surname>
            <given-names>EG</given-names>
          </name>
          <name>
            <surname>Causton</surname>
            <given-names>HC</given-names>
          </name>
          <name>
            <surname>Shore</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Grunstein</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Lander</surname>
            <given-names>ES</given-names>
          </name>
          <name>
            <surname>Young</surname>
            <given-names>RA</given-names>
          </name>
        </person-group>
        <article-title>Chromosomal landscape of nucleosome-dependent gene expression and silencing in yeast</article-title>
        <source>Nature</source>
        <year>1999</year>
        <volume>402</volume>
        <fpage>418</fpage>
        <lpage>421</lpage>
        <pub-id pub-id-type="pmid">10586882</pub-id>
        <pub-id pub-id-type="doi">10.1038/46567</pub-id>
      </citation>
    </ref>
    <ref id="B11">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Simon</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Barnett</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Hannett</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Harbison</surname>
            <given-names>CT</given-names>
          </name>
          <name>
            <surname>Rinaldi</surname>
            <given-names>NJ</given-names>
          </name>
          <name>
            <surname>Volkert</surname>
            <given-names>TL</given-names>
          </name>
          <name>
            <surname>Wyrick</surname>
            <given-names>JJ</given-names>
          </name>
          <name>
            <surname>Zeitlinger</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Gifford</surname>
            <given-names>DK</given-names>
          </name>
          <name>
            <surname>Jaakkola</surname>
            <given-names>TS</given-names>
          </name>
          <name>
            <surname>Young</surname>
            <given-names>RA</given-names>
          </name>
        </person-group>
        <article-title>Serial regulation of transcriptional regulators in the yeast cell cycle</article-title>
        <source>Cell</source>
        <year>2001</year>
        <volume>106</volume>
        <fpage>697</fpage>
        <lpage>708</lpage>
        <pub-id pub-id-type="pmid">11572776</pub-id>
        <pub-id pub-id-type="doi">10.1016/S0092-8674(01)00494-9</pub-id>
      </citation>
    </ref>
    <ref id="B12">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>DeRisi</surname>
            <given-names>JL</given-names>
          </name>
          <name>
            <surname>Iyer</surname>
            <given-names>VR</given-names>
          </name>
          <name>
            <surname>Brown</surname>
            <given-names>PO</given-names>
          </name>
        </person-group>
        <article-title>Exploring the metabolic and genetic control of gene expression on a genomic scale</article-title>
        <source>Science</source>
        <year>1997</year>
        <volume>278</volume>
        <fpage>680</fpage>
        <lpage>686</lpage>
        <pub-id pub-id-type="pmid">9381177</pub-id>
        <pub-id pub-id-type="doi">10.1126/science.278.5338.680</pub-id>
      </citation>
    </ref>
    <ref id="B13">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Arakawa</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Kono</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Yamada</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Mori</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Tomita</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>KEGG-based pathway visualization tool for complex omics data</article-title>
        <source>In Silico Biol</source>
        <year>2005</year>
        <volume>5</volume>
        <fpage>419</fpage>
        <lpage>423</lpage>
        <ext-link ext-link-type="uri" xlink:href="http://www.bioinfo.de/isb/2005050039/"/>
        <pub-id pub-id-type="pmid">16268787</pub-id>
      </citation>
    </ref>
    <ref id="B14">
      <citation citation-type="other">
        <article-title>TriDAMP</article-title>
        <ext-link ext-link-type="uri" xlink:href="http://mathdamp.iab.keio.ac.jp/tridamp/"/>
      </citation>
    </ref>
  </ref-list>
</back>
