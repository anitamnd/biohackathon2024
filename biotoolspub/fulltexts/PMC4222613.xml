<?DTDIdentifier.IdentifierValue article.dtd?>
<?DTDIdentifier.IdentifierType system?>
<?SourceDTD.DTDName article.dtd?>
<?SourceDTD.Version 1.0?>
<?ConverterInfo.XSLTName bmc2nlmx2.xsl?>
<?ConverterInfo.Version 2?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Syst Biol</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Syst Biol</journal-id>
    <journal-title-group>
      <journal-title>BMC Systems Biology</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1752-0509</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">4222613</article-id>
    <article-id pub-id-type="publisher-id">1752-0509-7-130</article-id>
    <article-id pub-id-type="pmid">24261882</article-id>
    <article-id pub-id-type="doi">10.1186/1752-0509-7-130</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Software</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>RaTrav: a tool for calculating mean first-passage times on biochemical networks</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" id="A1">
        <name>
          <surname>Torchala</surname>
          <given-names>Mieczyslaw</given-names>
        </name>
        <xref ref-type="aff" rid="I1">1</xref>
        <email>Mieczyslaw.Torchala@cancer.org.uk</email>
      </contrib>
      <contrib contrib-type="author" id="A2">
        <name>
          <surname>Chelminiak</surname>
          <given-names>Przemyslaw</given-names>
        </name>
        <xref ref-type="aff" rid="I2">2</xref>
        <email>geronimo@amu.edu.pl</email>
      </contrib>
      <contrib contrib-type="author" id="A3">
        <name>
          <surname>Kurzynski</surname>
          <given-names>Michal</given-names>
        </name>
        <xref ref-type="aff" rid="I2">2</xref>
        <email>kurzphys@amu.edu.pl</email>
      </contrib>
      <contrib contrib-type="author" corresp="yes" id="A4">
        <name>
          <surname>Bates</surname>
          <given-names>Paul A</given-names>
        </name>
        <xref ref-type="aff" rid="I1">1</xref>
        <email>Paul.Bates@cancer.org.uk</email>
      </contrib>
    </contrib-group>
    <aff id="I1"><label>1</label>Biomolecular Modelling Laboratory, Cancer Research UK London Research Institute, 44 Lincoln’s Inn Fields, London WC2A 3LY, UK</aff>
    <aff id="I2"><label>2</label>Adam Mickiewicz University, Faculty of Physics, Umultowska 85, 61-614 Poznan, Poland</aff>
    <pub-date pub-type="collection">
      <year>2013</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>21</day>
      <month>11</month>
      <year>2013</year>
    </pub-date>
    <volume>7</volume>
    <fpage>130</fpage>
    <lpage>130</lpage>
    <history>
      <date date-type="received">
        <day>26</day>
        <month>4</month>
        <year>2013</year>
      </date>
      <date date-type="accepted">
        <day>13</day>
        <month>11</month>
        <year>2013</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>Copyright © 2013 Torchala et al.; licensee BioMed Central Ltd.</copyright-statement>
      <copyright-year>2013</copyright-year>
      <copyright-holder>Torchala et al.; licensee BioMed Central Ltd.</copyright-holder>
      <license license-type="open-access" xlink:href="http://creativecommons.org/licenses/by/2.0">
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/2.0">http://creativecommons.org/licenses/by/2.0</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="http://www.biomedcentral.com/1752-0509/7/130"/>
    <abstract>
      <sec>
        <title>Background</title>
        <p>The concept of mean first-passage times (MFPTs) occupies an important place in the theory of stochastic processes, with the methods of their calculation being equally important in theoretical physics, chemistry and biology. We present here a software tool designed to support computational biology studies where Markovian dynamics takes place and MFPTs between initial and single or multiple final states in network-like systems are used. Two methods are made available for which their efficiency is strongly dependent on the topology of the defined network: the combinatorial Hill technique and the Monte Carlo simulation method.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p>After a brief introduction to RaTrav, we highlight the utility of MFPT calculations by providing two examples (accompanied by Additional file <xref ref-type="supplementary-material" rid="S1">1</xref>) where they are deemed to be of importance: analysis of a protein-protein docking funnel and interpretation of the free energy transduction between two coupled enzymatic reactions controlled by the dynamics of transition between enzyme conformational states.</p>
      </sec>
      <sec>
        <title>Conclusions</title>
        <p>RaTrav is a versatile and easy to use software tool for calculating MFPTs across biochemical networks. The user simply prepares a text file with the structure of a given network, along with some additional basic parameters such as transition probabilities, waiting probabilities (if any) and local times (weights of edges), which define explicitly the stochastic dynamics on the network. The RaTrav tool can then be applied in order to compute desired MFPTs. For the provided examples, we were able to find the favourable binding path within a protein-protein docking funnel and to calculate the degree of coupling for two chemical reactions catalysed simultaneously by the same protein enzyme. However, the list of possible applications is much wider.</p>
      </sec>
    </abstract>
    <kwd-group>
      <kwd>Markov processes</kwd>
      <kwd>Master equation</kwd>
      <kwd>Random walk</kwd>
      <kwd>Mean first-passage time</kwd>
      <kwd>Stationary flux</kwd>
      <kwd>Monte Carlo method</kwd>
      <kwd>Hill’s method</kwd>
      <kwd>Complex networks</kwd>
      <kwd>Chemical kinetics</kwd>
      <kwd>Protein-protein binding funnel</kwd>
      <kwd>Protein-protein interactions</kwd>
      <kwd>Protein-protein docking</kwd>
      <kwd>Free energy transduction</kwd>
    </kwd-group>
  </article-meta>
</front>
<body>
  <sec>
    <title>Background</title>
    <p>The theory of stochastic Markov processes has many applications in theoretical physics, chemistry and biology [<xref ref-type="bibr" rid="B1">1</xref>-<xref ref-type="bibr" rid="B5">5</xref>]. If a system allows transitions in time between various discrete states, we may model the system in the general language of networks and assign dynamics properties to the nodes and edges of such networks [<xref ref-type="bibr" rid="B6">6</xref>]. In early attempts to understand the dynamics of stochastic networks the term ’random walk’ was introduced [<xref ref-type="bibr" rid="B7">7</xref>], which describes the displacement of a point on a network after a sequence of random moves. Equally important to measuring displacement is the quantity called mean first-passage time (MFPT), which is defined as the time needed to reach the final state by a statistical ensemble of network walkers [<xref ref-type="bibr" rid="B8">8</xref>]. According to the alternative definition, this time is equivalent to the reciprocal steady-state flux resulting in a network in which a single walker returns instantly to the initial state every time it reaches the final state [<xref ref-type="bibr" rid="B9">9</xref>].</p>
    <p>MFPTs have been successfully used in a variety of biochemical studies, for example: the study of protein folding times [<xref ref-type="bibr" rid="B10">10</xref>], protein helix unfolding rates under mechanical forces [<xref ref-type="bibr" rid="B11">11</xref>], studies of DNA-based nanoscale walkers called molecular spiders [<xref ref-type="bibr" rid="B12">12</xref>], studies of polymer translocation [<xref ref-type="bibr" rid="B13">13</xref>], calcium spark activation times [<xref ref-type="bibr" rid="B14">14</xref>], metastatic cancer progression [<xref ref-type="bibr" rid="B15">15</xref>], and the analysis of temperature and detection-wavelength dependence of the electron transfer rates in the initial stages of photosynthesis [<xref ref-type="bibr" rid="B16">16</xref>].</p>
    <p>In general, time for random walks upon a network may be discrete or continuous. The RaTrav tool works with discrete time. To our best knowledge, there is currently no open source software available which is able to perform MFPTs calculations on a discrete time and space network of any arbitrary size. In this article we present RaTrav, an open source software tool. First, we introduce the formulation of MFPT calculations and provide details on the implementation and usage of RaTrav (Methods section). Then we focus on two biological applications and demonstrate how various biological questions may be answered using the RaTrav software tool (Results and discussion section).</p>
  </sec>
  <sec sec-type="methods">
    <title>Methods</title>
    <sec>
      <title>Mean first-passage times</title>
      <p>When considering the Markov processes, MFPT is defined as the average time (in number of steps or other units of time) for a statistical sample of random walks starting in some initial state on a network of states to reach for the first time the desired final state or any state from a collection of final states. In formal terms, the stochastic continuous time Markov process realized on a given network of states is described by a system of coupled master equations</p>
      <p>
        <disp-formula id="bmcM1">
          <label>(1)</label>
          <mml:math id="M1" name="1752-0509-7-130-i1" overflow="scroll">
            <mml:msub>
              <mml:mrow>
                <mml:mover accent="true">
                  <mml:mrow>
                    <mml:mi>p</mml:mi>
                  </mml:mrow>
                  <mml:mo>˙</mml:mo>
                </mml:mover>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>l</mml:mi>
              </mml:mrow>
            </mml:msub>
            <mml:mo>(</mml:mo>
            <mml:mi>t</mml:mi>
            <mml:mo>)</mml:mo>
            <mml:mspace width="0.3em"/>
            <mml:mo>=</mml:mo>
            <mml:mspace width="0.3em"/>
            <mml:munder>
              <mml:mrow>
                <mml:mi mathsize="big">∑</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:msup>
                  <mml:mrow>
                    <mml:mi>l</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mo>′</mml:mo>
                  </mml:mrow>
                </mml:msup>
              </mml:mrow>
            </mml:munder>
            <mml:mfenced open="[" close="]">
              <mml:mrow>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>w</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>l</mml:mi>
                    <mml:msup>
                      <mml:mrow>
                        <mml:mi>l</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mo>′</mml:mo>
                      </mml:mrow>
                    </mml:msup>
                  </mml:mrow>
                </mml:msub>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>p</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:msup>
                      <mml:mrow>
                        <mml:mi>l</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mo>′</mml:mo>
                      </mml:mrow>
                    </mml:msup>
                  </mml:mrow>
                </mml:msub>
                <mml:mo>(</mml:mo>
                <mml:mi>t</mml:mi>
                <mml:mo>)</mml:mo>
                <mml:mo>−</mml:mo>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>w</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:msup>
                      <mml:mrow>
                        <mml:mi>l</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mo>′</mml:mo>
                      </mml:mrow>
                    </mml:msup>
                    <mml:mi>l</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>p</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>l</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:mo>(</mml:mo>
                <mml:mi>t</mml:mi>
                <mml:mo>)</mml:mo>
              </mml:mrow>
            </mml:mfenced>
          </mml:math>
        </disp-formula>
      </p>
      <p>which jointly describe the time variation of the probabilities <italic>p</italic><sub><italic>l</italic></sub>(<italic>t</italic>) of the hypothetical random walker being in some state <italic>l</italic> at time <italic>t</italic>, where the over-dot denotes a time derivative. In Eq. 1, <inline-formula><mml:math id="M2" name="1752-0509-7-130-i2" overflow="scroll"><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is the transition probability per unit time along the edge from state (node) <italic>l</italic> to <italic>l</italic><sup>′</sup>, which in general needs not satisfy the detailed balance condition. Furthermore, the transition probabilities <inline-formula><mml:math id="M3" name="1752-0509-7-130-i3" overflow="scroll"><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> from a given state <italic>l</italic> to its nearest neighbours <italic>l</italic><sup>′</sup> need not sum up to unity. On establishing a discrete time <italic>t</italic> = <italic>n</italic><italic>τ</italic><sub>0</sub>, where <italic>n</italic> is the number of steps measured in some unit of time <italic>τ</italic><sub>0</sub>, the differential Eq. 1 is to be recast as the difference master equation</p>
      <p>
        <disp-formula id="bmcM2">
          <label>(2)</label>
          <mml:math id="M4" name="1752-0509-7-130-i4" overflow="scroll">
            <mml:msub>
              <mml:mrow>
                <mml:mi>p</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>l</mml:mi>
              </mml:mrow>
            </mml:msub>
            <mml:mo>(</mml:mo>
            <mml:mi>n</mml:mi>
            <mml:mo>+</mml:mo>
            <mml:mn>1</mml:mn>
            <mml:mo>)</mml:mo>
            <mml:mspace width="0.3em"/>
            <mml:mo>=</mml:mo>
            <mml:mspace width="0.3em"/>
            <mml:msub>
              <mml:mrow>
                <mml:mi>p</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>l</mml:mi>
              </mml:mrow>
            </mml:msub>
            <mml:mo>(</mml:mo>
            <mml:mi>n</mml:mi>
            <mml:mo>)</mml:mo>
            <mml:mo>+</mml:mo>
            <mml:munder>
              <mml:mrow>
                <mml:mi mathsize="big">∑</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:msup>
                  <mml:mrow>
                    <mml:mi>l</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mo>′</mml:mo>
                  </mml:mrow>
                </mml:msup>
              </mml:mrow>
            </mml:munder>
            <mml:mfenced open="[" close="]">
              <mml:mrow>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>u</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>l</mml:mi>
                    <mml:msup>
                      <mml:mrow>
                        <mml:mi>l</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mo>′</mml:mo>
                      </mml:mrow>
                    </mml:msup>
                  </mml:mrow>
                </mml:msub>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>p</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:msup>
                      <mml:mrow>
                        <mml:mi>l</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mo>′</mml:mo>
                      </mml:mrow>
                    </mml:msup>
                  </mml:mrow>
                </mml:msub>
                <mml:mo>(</mml:mo>
                <mml:mi>n</mml:mi>
                <mml:mo>)</mml:mo>
                <mml:mo>−</mml:mo>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>u</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:msup>
                      <mml:mrow>
                        <mml:mi>l</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mo>′</mml:mo>
                      </mml:mrow>
                    </mml:msup>
                    <mml:mi>l</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>p</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>l</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:mo>(</mml:mo>
                <mml:mi>n</mml:mi>
                <mml:mo>)</mml:mo>
              </mml:mrow>
            </mml:mfenced>
            <mml:mspace width="2.22144pt"/>
            <mml:mo>,</mml:mo>
          </mml:math>
        </disp-formula>
      </p>
      <p>in which, as opposed to Eq. 1, the transition probabilities <inline-formula><mml:math id="M5" name="1752-0509-7-130-i5" overflow="scroll"><mml:msub><mml:mrow><mml:mi>u</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mspace width="0.3em"/><mml:mo>=</mml:mo><mml:mspace width="0.3em"/><mml:msub><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> from the node <italic>l</italic> to the node <italic>l</italic><sup>′</sup> sum up to unity:</p>
      <p>
        <disp-formula id="bmcM3">
          <label>(3)</label>
          <mml:math id="M6" name="1752-0509-7-130-i6" overflow="scroll">
            <mml:munder>
              <mml:mrow>
                <mml:mi mathsize="big">∑</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:msup>
                  <mml:mrow>
                    <mml:mi>l</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mo>′</mml:mo>
                  </mml:mrow>
                </mml:msup>
              </mml:mrow>
            </mml:munder>
            <mml:msub>
              <mml:mrow>
                <mml:mi>u</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:msup>
                  <mml:mrow>
                    <mml:mi>l</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mo>′</mml:mo>
                  </mml:mrow>
                </mml:msup>
                <mml:mi>l</mml:mi>
              </mml:mrow>
            </mml:msub>
            <mml:mspace width="0.3em"/>
            <mml:mo>=</mml:mo>
            <mml:mspace width="0.3em"/>
            <mml:msub>
              <mml:mrow>
                <mml:mi>τ</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mn>0</mml:mn>
              </mml:mrow>
            </mml:msub>
            <mml:munder>
              <mml:mrow>
                <mml:mi mathsize="big">∑</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:msup>
                  <mml:mrow>
                    <mml:mi>l</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mo>′</mml:mo>
                  </mml:mrow>
                </mml:msup>
              </mml:mrow>
            </mml:munder>
            <mml:msub>
              <mml:mrow>
                <mml:mi>w</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:msup>
                  <mml:mrow>
                    <mml:mi>l</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mo>′</mml:mo>
                  </mml:mrow>
                </mml:msup>
                <mml:mi>l</mml:mi>
              </mml:mrow>
            </mml:msub>
            <mml:mspace width="0.3em"/>
            <mml:mo>=</mml:mo>
            <mml:mspace width="0.3em"/>
            <mml:mn>1</mml:mn>
            <mml:mspace width="2.22144pt"/>
            <mml:mi>.</mml:mi>
          </mml:math>
        </disp-formula>
      </p>
      <p>Let us note that in general the above sum includes also the waiting probabilities <italic>u</italic><sub><italic>l</italic><italic>l</italic></sub> on a given node <italic>l</italic> before a random walker performs a jump to a neighboring node <italic>l</italic><sup>′</sup>. They have efficient applications in many biological and physical problems. For example, a protein-protein complex residing in the bound conformational state while performing its function and before proceeding to the dissociation state, or the components of the complex becoming trapped in a local minimum of the free energy landscape before finding their optimal docked, and fully functional, conformational state. Moroever, the long-living metastable states are detected in various excited atomic or molecular systems before they relax to the lower-lying energy states.</p>
      <p>In developing the RaTrav code we have ensured that the definitions for the input data are as general as possible. Therefore, we have made a distinction between the exit probability from a node and the transition time to its nearest neighbour. More generally, on defining the various local times <inline-formula><mml:math id="M7" name="1752-0509-7-130-i7" overflow="scroll"><mml:msub><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, individually for each transition along a link with the probability <inline-formula><mml:math id="M8" name="1752-0509-7-130-i8" overflow="scroll"><mml:msub><mml:mrow><mml:mi>u</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, we have the alternative expression for the transition probabilities per unit time in Eq. 1:</p>
      <p>
        <disp-formula id="bmcM4">
          <label>(4)</label>
          <mml:math id="M9" name="1752-0509-7-130-i9" overflow="scroll">
            <mml:msub>
              <mml:mrow>
                <mml:mi>w</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:msup>
                  <mml:mrow>
                    <mml:mi>l</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mo>′</mml:mo>
                  </mml:mrow>
                </mml:msup>
                <mml:mi>l</mml:mi>
              </mml:mrow>
            </mml:msub>
            <mml:mspace width="0.3em"/>
            <mml:mo>=</mml:mo>
            <mml:mspace width="0.3em"/>
            <mml:mfrac>
              <mml:mrow>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>u</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:msup>
                      <mml:mrow>
                        <mml:mi>l</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mo>′</mml:mo>
                      </mml:mrow>
                    </mml:msup>
                    <mml:mi>l</mml:mi>
                  </mml:mrow>
                </mml:msub>
              </mml:mrow>
              <mml:mrow>
                <mml:munder>
                  <mml:mrow>
                    <mml:mi mathsize="big">∑</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:msup>
                      <mml:mrow>
                        <mml:mi>l</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mo>′</mml:mo>
                      </mml:mrow>
                    </mml:msup>
                  </mml:mrow>
                </mml:munder>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>τ</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:msup>
                      <mml:mrow>
                        <mml:mi>l</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mo>′</mml:mo>
                      </mml:mrow>
                    </mml:msup>
                    <mml:mi>l</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>u</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:msup>
                      <mml:mrow>
                        <mml:mi>l</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mo>′</mml:mo>
                      </mml:mrow>
                    </mml:msup>
                    <mml:mi>l</mml:mi>
                  </mml:mrow>
                </mml:msub>
              </mml:mrow>
            </mml:mfrac>
            <mml:mspace width="2.22144pt"/>
            <mml:mi>.</mml:mi>
          </mml:math>
        </disp-formula>
      </p>
      <p>In the particular case for all <inline-formula><mml:math id="M10" name="1752-0509-7-130-i10" overflow="scroll"><mml:msub><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mspace width="0.3em"/><mml:mo>=</mml:mo><mml:mspace width="0.3em"/><mml:msub><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula> we reconstruct the transition probabilities that fulfill the conditions in Eq. 3. The local times can be related to the reaction coordinates, for example, when employing molecular dynamics simulations to move between well defined protein conformational states, which might be measured on the order of microseconds.</p>
      <p>By virtue of its generality, Eq. 4 has been directly implemented only in the Hill combinatorial technique [<xref ref-type="bibr" rid="B9">9</xref>]. Nevertheless, as regards Monte Carlo simulations, it ensures a determination of the same unit of time for the both methods. The description and benchmark of the combinatorial Hill and stochastic Monte Carlo methods on basic networks (equal exit probabilities towards each neighbour, equal weights of edges) may be found in our previous paper [<xref ref-type="bibr" rid="B17">17</xref>]. In comparison to the previous results, newly developed C++ code is provided, which allows for the definition of multiple final states, different transition probabilities and local times along network edges. Moreover, the networks can be connected or disconnected structures represented as basic graphs, as directed graphs, as multigraphs and as multi-component graphs or their mutual mixtures. In order to compare MFPTs generated by these two methods we have run a series of tests on a number of network topologies studied previously [<xref ref-type="bibr" rid="B17">17</xref>]: hypercubes of various dimensions, Sierpinski gaskets of various orders, Bethe lattices with various number of shells and random tree-like networks; with equal and randomly chosen probabilities, with identical and different local transition times, and with single and multiple final states. For most of the cases, the difference between MFPTs calculated from the Hill and Monte Carlo methods, calculated as 100% (|H − MC|/H), was smaller than 0.2% when using 10<sup>7</sup> walkers.</p>
      <p>Both methods mentioned above have their benefits and drawbacks. For instance, the advantage of Hill’s over the Monte Carlo method is its speed and precision of calculation when the network is an acyclic graph, or includes a low number of cycles. On the other hand, for particularly knotted networks, the Monte Carlo method is the logical choice, providing reliable MFPT estimations in a reasonable turnaround time. The best strategy to follow using the Monte Carlo method is to start with a lower number of walkers; even if the obtained results are not particularly accurate, this helps to estimate the running time with the desired higher number of walkers and avoids the situations where calculations are indicated to be intractable in a finite time. Some indication of running times may be found in Tab. 4 of [<xref ref-type="bibr" rid="B17">17</xref>].</p>
    </sec>
    <sec>
      <title>Implementation of the Monte Carlo simulation method</title>
      <p>The Monte Carlo method relies on the simulation of random walks on a network of interest, driven by a pseudorandom number generator. Random numbers were generated in the Monte Carlo method using the Boost C++ Libraries components (<ext-link ext-link-type="uri" xlink:href="http://www.boost.org">http://www.boost.org</ext-link>) – Mersenne Twister <monospace>mt19937</monospace> random number generator (with a standard seed) and a <monospace>uniform_real_distribution</monospace> function.</p>
      <p>In our implementation (see source code), there is an outer <monospace>for</monospace> loop over the number of simulations and an inner <monospace>for</monospace> loop over the number of walkers in each simulation. Each walker is placed in an initial state (node on the network) and its first passage time set to 0. For each iteration, a random number is generated. Exit probabilities from each node sum up to one but do not have to be equal, thus forming a ranges of transition probabilities to each neighbour. Each transition is chosen as an effect of casting a random number. After a walker undergoes a transition it is placed in a new state (or stays in the same state if the waiting probability exists and the random walker chooses this transition) and its first passage time is increased by the weight of edge (local time) it passed. The walker performs its random walk until it reaches the final state or one state from the set of final states. When all random walkers finish their walk, the mean first-passage time is calculated based on first passage times for each walker. If the user chooses to perform more simulations with the given number of walkers, mean first-passage times are averaged further and standard deviation of this mean over the number of simulations, with the given number of walkers, is calculated. Please notice that if the number of walkers is large enough (in fact the user should perform some initial simulations to be sure the number of walkers is sufficient for a new network), MFPTs obtained from each simulation will be similar. However, because of the random movement of walkers, the first passage time of a single walker cannot be predicted based on e.g. first passage time of another walker.</p>
      <p>In terms of efficiency of the calculations, because the current step of a walker determines its next step, a single random walk cannot be parallelized. However, the calculation of mean first-passage time may be parallelized, because the walkers in the statistical ensemble are independent. We have shown that using parallel processing methods (Message Passing Interface), the efficiency may be increased over 90% using more than 10 CPUs or by using a few cores on a single CPU [<xref ref-type="bibr" rid="B18">18</xref>]. However, to keep the RaTrav software as portable as possible, we haven’t implemented MPI parallel processing methods in the current version of the software.</p>
    </sec>
    <sec>
      <title>Implementation of the combinatorial Hill method</title>
      <p>The Hill method relies on the idea that instead of an ensemble of walkers one can consider only a single walker that after traversing a network of states (nodes) appears instantly at the starting node every time it reaches the target node. Because this procedure is repeated many times the Hill method shows that the MFPT <italic>τ</italic> between these two nodes corresponds to the reciprocal one-way stationary flux <italic>J</italic>, <italic>τ</italic> = <italic>J</italic><sup>−1</sup>, resulting in a modified network in which the transitions to the target node have been redirected to the starting node. The steady-state flux has the following form</p>
      <p>
        <disp-formula id="bmcM5">
          <label>(5)</label>
          <mml:math id="M11" name="1752-0509-7-130-i11" overflow="scroll">
            <mml:mi>J</mml:mi>
            <mml:mspace width="0.3em"/>
            <mml:mo>=</mml:mo>
            <mml:mspace width="0.3em"/>
            <mml:munder>
              <mml:mrow>
                <mml:mi mathsize="big">∑</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:msup>
                  <mml:mrow>
                    <mml:mi>l</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mo>′</mml:mo>
                  </mml:mrow>
                </mml:msup>
              </mml:mrow>
            </mml:munder>
            <mml:msub>
              <mml:mrow>
                <mml:mi>w</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>l</mml:mi>
                <mml:msup>
                  <mml:mrow>
                    <mml:mi>l</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mo>′</mml:mo>
                  </mml:mrow>
                </mml:msup>
              </mml:mrow>
            </mml:msub>
            <mml:msubsup>
              <mml:mrow>
                <mml:mi>p</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:msup>
                  <mml:mrow>
                    <mml:mi>l</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mo>′</mml:mo>
                  </mml:mrow>
                </mml:msup>
              </mml:mrow>
              <mml:mrow>
                <mml:mtext>st</mml:mtext>
              </mml:mrow>
            </mml:msubsup>
            <mml:mspace width="2.22144pt"/>
            <mml:mo>,</mml:mo>
          </mml:math>
        </disp-formula>
      </p>
      <p>where <inline-formula><mml:math id="M12" name="1752-0509-7-130-i12" overflow="scroll"><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:msup><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:msub></mml:math></inline-formula> stands for the transition probabilities per unit time from a set of <italic>l</italic><sup>′</sup> nodes adjacent to the target node <italic>l</italic> and occupied by the walker with probabilities <inline-formula><mml:math id="M13" name="1752-0509-7-130-i13" overflow="scroll"><mml:msubsup><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mtext>st</mml:mtext></mml:mrow></mml:msubsup></mml:math></inline-formula>. We can calculate these probabilities solving the system of the stationary master equations in Eq. 1 for <inline-formula><mml:math id="M14" name="1752-0509-7-130-i14" overflow="scroll"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mo>˙</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo><mml:mspace width="0.3em"/><mml:mo>=</mml:mo><mml:mspace width="0.3em"/><mml:mn>0</mml:mn></mml:math></inline-formula>, or equivalently using the Hill algorithm [<xref ref-type="bibr" rid="B9">9</xref>] that we have now implemented in the RaTrav tool. The algorithm proceeds according to the following steps: </p>
      <p>1. Determine two nodes on the original network (graph) in order to calculate the MFPT between them.</p>
      <p>2. Modify this graph through the identification of the initial node with the final node, combined with elimination of the latter.</p>
      <p>3. Construct for such a modified graph <italic>G</italic> the complete set of its subgraphs, called maximal trees <italic>T</italic>. The maximal tree is a connected graph which contains all nodes of the graph <italic>G</italic> and no cycles.</p>
      <p>4. Make each possible maximal tree <italic>T</italic> to be a directed graph. It is obtained from <italic>T</italic> by directing all its edges (links) towards the node <italic>l</italic>. Each directed tree <italic>T</italic><sub><italic>α</italic></sub> contributes a weight <italic>W</italic><sub><italic>l</italic></sub>(<italic>T</italic><sub><italic>α</italic></sub>) as the product of transition probabilities per unit time <italic>w</italic><sub><italic>i</italic><italic>j</italic></sub> from the node <italic>j</italic> to the node <italic>i</italic>.</p>
      <p>5. Calculate the sum of these weights, <inline-formula><mml:math id="M15" name="1752-0509-7-130-i15" overflow="scroll"><mml:msub><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mspace width="0.3em"/><mml:mo>=</mml:mo><mml:mspace width="0.3em"/><mml:munder><mml:mrow><mml:mi mathsize="big">∑</mml:mi></mml:mrow><mml:mrow><mml:mtext>all</mml:mtext><mml:mspace width="2.77626pt"/><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>α</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:munder></mml:math></inline-formula><italic>W</italic><sub><italic>l</italic></sub>(<italic>T</italic><sub><italic>α</italic></sub>), which run over all maximal trees <italic>T</italic><sub><italic>α</italic></sub> directed to a given node <italic>l</italic>.</p>
      <p>Then, the steady-state occupation probability of the node <italic>l</italic> in the network (graph) <italic>G</italic> becomes</p>
      <p>
        <disp-formula>
          <mml:math id="M16" name="1752-0509-7-130-i16" overflow="scroll">
            <mml:mrow>
              <mml:msubsup>
                <mml:mrow>
                  <mml:mi>p</mml:mi>
                </mml:mrow>
                <mml:mrow>
                  <mml:mi>l</mml:mi>
                </mml:mrow>
                <mml:mrow>
                  <mml:mtext>st</mml:mtext>
                </mml:mrow>
              </mml:msubsup>
              <mml:mspace width="0.3em"/>
              <mml:mo>=</mml:mo>
              <mml:mspace width="0.3em"/>
              <mml:mfrac>
                <mml:mrow>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>W</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>l</mml:mi>
                    </mml:mrow>
                  </mml:msub>
                </mml:mrow>
                <mml:mrow>
                  <mml:munder>
                    <mml:mrow>
                      <mml:mi mathsize="big">∑</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>n</mml:mi>
                    </mml:mrow>
                  </mml:munder>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>W</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>n</mml:mi>
                    </mml:mrow>
                  </mml:msub>
                </mml:mrow>
              </mml:mfrac>
              <mml:mspace width="2.22144pt"/>
              <mml:mo>,</mml:mo>
            </mml:mrow>
          </mml:math>
        </disp-formula>
      </p>
      <p>where the expression in the denominator obeys a summation over all sum of weights generated for the graph <italic>G</italic> to ensure that <inline-formula><mml:math id="M17" name="1752-0509-7-130-i17" overflow="scroll"><mml:munder><mml:mrow><mml:mi mathsize="big">∑</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:munder><mml:msubsup><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mtext>st</mml:mtext></mml:mrow></mml:msubsup><mml:mspace width="0.3em"/><mml:mo>=</mml:mo><mml:mspace width="0.3em"/><mml:mn>1</mml:mn></mml:math></inline-formula>. The construction of these probabilities is fundamental for the calculation of the stationary flux in Eq. 5 and finally the MFPT. To this end we have applied the algorithm which for a given set of elements (the graph edges) generates its subset in lexicographical order.</p>
    </sec>
    <sec>
      <title>Input file and control keywords</title>
      <p>The user is required to prepare a text file with the structure of a given network. Upon completion of the computations, an output file is produced with computed MFPTs along with, in case of the Monte Carlo method, their estimated errors. The user needs to choose between the Hill’s and Monte Carlo methods, between using basic (just neighbouring nodes) or advanced (with transition probabilities and local times along edges), between calculating all the MFPTs or only a selection, and whether to define multiple final states.</p>
      <p>Let us start with a very simple square network for which the input file in RaTrav format takes the following form:<disp-formula><graphic xlink:href="1752-0509-7-130-i18.gif"/></disp-formula></p>
      <p>Keyword <monospace>NODE</monospace> is followed by the node number (the first numerical column, entries are counted from 0; it is important to maintain an increasing numeric order of node identities and gaps in numbering are not permitted). Subsequent numbers are the identities of neighbouring nodes and their order does not matter. In the case of performing a Monte Carlo simulation there is the requirement for <monospace>WALK</monospace> and <monospace>SIMU</monospace> keywords (number of walkers, number of simulations with <monospace>WALK</monospace> walkers). Entering <monospace>SIMU</monospace> &gt;1, the user will receive error estimates for each MFPT calculation (standard deviation of average MFPT over the number of simulations run). To establish waiting probabilities on, for example the 9th node, the NODE 9 input line may be defined as:<disp-formula><graphic xlink:href="1752-0509-7-130-i19.gif"/></disp-formula></p>
      <p>i.e. the node number is repeated. This means that the node labelled as 9 in a graph connects directly to the node labelled as 3 and to itself twice, so the transition probability from node 9 to node 3 is 1/3, whereas the waiting probability on the node 9 is 2/3. If the user chooses to use Hill’s algorithm, <monospace>WALK</monospace> and <monospace>SIMU</monospace> keywords won’t be used even if present in the input file.</p>
      <p>In advanced file format the user can define transition probabilities and weights of edges. To minimize rounding errors, in addition to the decimal format, it is possible to define the transition probabilities and weight of edges as common fractions. The same square can be defined as follows (node number, followed by a triplet containing: identity of neighbouring node, transition probability, weight of edge):<disp-formula><graphic xlink:href="1752-0509-7-130-i20.gif"/></disp-formula></p>
      <p>With transition probabilities equal to 1/2 and weights of edges equal to 1.0, this format is equivalent to the basic file format. However, in advanced file format it is possible to use different combinations of probabilities and weights. Requirements are that the probabilities in each line have to sum up to 1.0, and in the case of Hill’s method, at least one local timescale (weight of edge) must be different from 0. The last condition does not apply to the Monte Carlo method. Thus, on account of some specific problem, the advanced input file may take the following form:<disp-formula><graphic xlink:href="1752-0509-7-130-i21.gif"/></disp-formula></p>
      <p>In the above please note the different values of weights possible for two-way transitions between the same pair of nodes, for example, 1 and 3. We assume in general that a passage in either direction along a given edge does not need to correspond to the same weight or transition probability.</p>
      <p>Optional use of the <monospace>MFPT</monospace> keyword allows definition of selected MFPTs the user wants to be computed, e.g.: <monospace>MFPT 0 1</monospace> means the MFPT between states 0 and 1 will be calculated, <monospace>MFPT 0 1 2</monospace> means the MFPT between initial state 0 and two final states will be calculated – either state 1 or 2 has to be reached (it is possible to define any number of final states).</p>
      <p>The <monospace>INFO</monospace> keyword allows the user to pass any comments which will be copied to the output files.</p>
    </sec>
    <sec>
      <title>Compilation and usage</title>
      <p>There is a Makefile attached so under Linux it is sufficient to simply call <monospace>make</monospace>. However, two variables have to be set before doing so:<disp-formula><graphic xlink:href="1752-0509-7-130-i22.gif"/></disp-formula></p>
      <p>The first variable is used to choose the compiler, e.g. <monospace>icc</monospace> for Intel C Compiler or <monospace>g++</monospace> for GNU C Compiler. The Monte Carlo method uses Boost C++ Libraries (<ext-link ext-link-type="uri" xlink:href="http://www.boost.org">http://www.boost.org</ext-link>) which have to be downloaded and installed. The second variable is used to set the path to the Boost C++ Libraries so the user must change <monospace>PATH_TO_BOOST</monospace> to the local path. Alternatively the RaTrav tool may be compiled without the Makefile, e.g. with ICC, as follows:<disp-formula><graphic xlink:href="1752-0509-7-130-i23.gif"/></disp-formula></p>
      <p>The general usage is as follows:<disp-formula><graphic xlink:href="1752-0509-7-130-i24.gif"/></disp-formula></p>
      <p>The five parameters have the following meaning: <monospace>input</monospace> is a name of the input text file which defines the network; <monospace>output</monospace> is a name of the output text file generated by RaTrav; the <monospace>METHOD</monospace> parameter that should be set equal to <monospace>0</monospace> to use the Monte Carlo method or <monospace>1</monospace> for Hill’s method; the <monospace>INPUT_FORMAT</monospace> parameter should be set equal to <monospace>0</monospace> for a basic input file or <monospace>1</monospace> for an advanced input file; the <monospace>MODE</monospace> parameter should be set equal to <monospace>0</monospace> when all MPFTs are to be calculated or <monospace>1</monospace> when selected MFPTs are to be calculated (<monospace>MFPT</monospace> keyword needed as introduced above).</p>
      <p>For example: to use the Monte Carlo method, with a basic input file and for all MFPTs to be calculated, the user runs <monospace>RaTrav input.txt output.txt 0 0 0</monospace>; to use Hill’s method, with an advanced input file and for selected MFPTs to be calculated, the user runs <monospace>RaTrav input.txt output.txt 1 1 1</monospace>.</p>
    </sec>
    <sec>
      <title>A basic example</title>
      <p>To better explain the functionalities of the RaTrav tool, we present in Figure <xref ref-type="fig" rid="F1">1</xref> a simple irregular network with nine nodes (black dots) and nine edges (links between nodes). It has one cycle (edges coloured in green); nodes have different exit probabilities <inline-formula><mml:math id="M18" name="1752-0509-7-130-i25" overflow="scroll"><mml:msub><mml:mrow><mml:mi>u</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:msup><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:msub></mml:math></inline-formula> (probabilities of passing defined as common fractions; coloured in black, in case of a cycle in green, in case of waiting on a node in cyan), and local time scales <inline-formula><mml:math id="M19" name="1752-0509-7-130-i26" overflow="scroll"><mml:msub><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:msup><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:msub></mml:math></inline-formula> (the cost of passing defined as decimal fractions with arrows; coloured in red). For some nodes there are waiting probabilities (i.e. transitions to the same node; cyan circular arrows); sometimes the transition probability from an edge node is set equal to one, instead of a waiting probability with an associated waiting time (weight of self transition). Both variables <inline-formula><mml:math id="M20" name="1752-0509-7-130-i27" overflow="scroll"><mml:msub><mml:mrow><mml:mi>u</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:msup><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="M21" name="1752-0509-7-130-i28" overflow="scroll"><mml:msub><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:msup><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:msub></mml:math></inline-formula> may be symmetric or asymmetric. The weight of an edge is the time required for transition between states, whereas the waiting time is the lifetime of the molecule in a particular state. These times can be related to experimental values, for example, the half-life of a complex can be calculated from its dissociation rate <italic>k</italic><sub>off</sub>, <italic>τ</italic><sub>1/2</sub>= ln(2)/<italic>k</italic><sub>off</sub>[<xref ref-type="bibr" rid="B19">19</xref>].</p>
      <fig id="F1" position="float">
        <label>Figure 1</label>
        <caption>
          <p><bold>Dynamics on a network.</bold> A simple network with nine nodes and its properties (transition probabilities (black), local times scales (red), cycle (green), probability of waiting (cyan), initial (S) and final (E1, E2) states). See text for more details.</p>
        </caption>
        <graphic xlink:href="1752-0509-7-130-1"/>
      </fig>
      <p>The network presented in Figure <xref ref-type="fig" rid="F1">1</xref> (input and output files may be found in Additional file <xref ref-type="supplementary-material" rid="S1">1</xref>) is represented in RaTrav format as follows (nodes are numbered from the left to the right, and from top to bottom, so S=0, E1=7, E2=8):<disp-formula><graphic xlink:href="1752-0509-7-130-i29.gif"/></disp-formula></p>
      <p>Please note that node numbers must be written in increasing order, but the neighbours of each node may be written in any order. If we add the following lines to the input file:<disp-formula><graphic xlink:href="1752-0509-7-130-i30.gif"/></disp-formula></p>
      <p>the output using Hill’s method (<monospace>WALK</monospace> and <monospace>SIMU</monospace> not used) is:<disp-formula><graphic xlink:href="1752-0509-7-130-i31.gif"/></disp-formula></p>
      <p>and with the Monte Carlo method (<monospace>WALK</monospace> and <monospace>SIMU</monospace> used) is:<disp-formula><graphic xlink:href="1752-0509-7-130-i32.gif"/></disp-formula></p>
      <p>For the presented network, the MFPT between S and E1 is calculated to be 80.300, between S and E2 to be 83.233, and between S and E1 or E2 (multiple final state) to be 61.556. Two observations can be made: for the submitted network Hill’s method is faster and gives exact results; using the Monte Carlo method, with 1000000 walkers, gives similar results. In case of reducing the number of walkers to 100000 but increasing the number of simulations to 10:<disp-formula><graphic xlink:href="1752-0509-7-130-i33.gif"/></disp-formula></p>
      <p>the following results with Monte Carlo can be obtained:<disp-formula><graphic xlink:href="1752-0509-7-130-i34.gif"/></disp-formula></p>
      <p>In this case the program also returns the standard deviation for each MFPT; comparing each MFPT, and its associated error, with the equivalent but exact result from Hill’s method, we may notice that one standard deviation may be insufficient to denote each MFPT pair to match; however, within three standard deviations each MFPT pair should match. This may not always be the case for more complicated networks, since if the number of walkers in each simulation is too low, every node may not be visited by a walker from the ensemble (ergodicity issues).</p>
    </sec>
    <sec>
      <title>Important remarks</title>
      <p>1. When using the Hill method the final state must be different from the initial state. However, when using the Monte Carlo method one can identify such states and obtain the MFPT, which is in fact a return time to the origin.</p>
      <p>2. For the Hill method the number of final states cannot exceed N-2, where N is the total number of states (nodes in a graph). However, for the Monte Carlo method one can define such a configuration of states, e.g. <monospace>MFPT 0 1 2 3</monospace> for a square.</p>
      <p>3. By choosing the Monte Carlo method the user is able to define ultrafast transitions between all or selected states, for which the local passage time along an edge between such states is set equal to zero. For the Hill method at least one local time scale must be different from zero.</p>
      <p>4. A network does not have to be compact. If there is no path between states, RaTrav will return MFPT as ’Infinity (not accessible)’.</p>
    </sec>
  </sec>
  <sec>
    <title>Results and discussion</title>
    <p>In this section we provide two applications for which the use of the RaTrav tool dedicated to MFPT calculations provides meaningful results. Each subsection includes a theoretical introduction to the problem, followed by a guide for the reader as to how to construct the appropriate RaTrav input files, and finally a discussion of the RaTrav results. The files accompanying the examples are available in Additional file <xref ref-type="supplementary-material" rid="S1">1</xref>.</p>
    <sec>
      <title>Analysis of conformational pathways within a protein-protein binding funnel</title>
      <p>In the molecular machinery of life proteins are responsible for a diverse array of functions. However, the great majority of biological functions are mediated not by isolated proteins but by their interactions. In addition to predicting the correct geometry of protein-protein complexes (in 3D) from their unbound components, for which a number of fully automated servers now exist, see for example the SwarmDock server [<xref ref-type="bibr" rid="B20">20</xref>] or the ClusPro server [<xref ref-type="bibr" rid="B21">21</xref>], of equal importance is to study the dynamics of binding, i.e. how the binding partners, upon complex formation, sample the binding funnel.</p>
      <p>Studying the topological properties of protein-protein binding funnels will enable us to understand how to change the dynamics of protein-protein association in a controlled way. The importance of being able to do this relates to rational drug design, where funnel sampling becomes particularly important when designing a series of similar protein ligands (such as proteins with a few key point mutations), or blocking peptides, and ascertaining if they are likely to be more effective in inhibiting a particular receptor protein-binding site more than the wild-type protein ligand.</p>
      <p>Automatic generation of protein-protein conformational space networks (in RaTrav formatted files), for any protein receptor/ligand pair, was recently incorporated into our docking tool, the SwarmDock Server [<xref ref-type="bibr" rid="B20">20</xref>]. For this study, we chose the vitamin D-binding protein/actin complex (Brookhaven protein database code, 1KXP) [<xref ref-type="bibr" rid="B22">22</xref>], which was previously studied by us in terms of conformational occupation probabilities and their usefulness to filter away non-funnel like protein-protein energy structures, thus improving the ranking of the correct docking poses [<xref ref-type="bibr" rid="B23">23</xref>]. The above study, based on state occupancies, was useful in distinguishing between true positive and false positive binding funnels. In the example described below we focus on the properties of the true positive binding funnel and calculate mean first-passage times between distinct conformational states within the funnel, i.e. we are interested in finding the favourable transition path from the top to the bottom of the binding funnel.</p>
      <p>The initial network of 32 conformational states, generated by the SwarmDock server, is depicted in Figure <xref ref-type="fig" rid="F2">2</xref>. The assigned quality of each state, that is its similarity with the final bound complex state, was based in accordance to the CAPRI (Critical Assessment of PRediction of Interactions) criteria [<xref ref-type="bibr" rid="B24">24</xref>], on three quantities: fraction of native contacts (fnat), interface root mean square deviation (IRMSD) and ligand root mean square deviation (LRMSD). These values are used to classify the conformations as incorrect (fnat &lt; 0.1 or (LRMSD &gt; 10Å and IRMSD &gt; 4Å)), acceptable ((fnat ≥ 0.3 and LRMSD &gt; 5Å nd IRMSD &gt; 2Å) or ((fnat ≥ 0.1 and fnat &lt; 0.3) and (LRMSD ≤ 10Åor IRMSD ≤ 4Å))), medium quality ((fnat ≥ 0.5 and LRMSD &gt; 1Å and IRMSD &gt; 1Å) or ((fnat ≥ 0.3 and fnat &lt; 0.5) and (LRMSD ≤ 5Å or IRMSD ≤ 2Å))) or high quality (fnat ≥ 0.5 and (LRMSD ≤ 1Å or IRMSD ≤ 1Å)), relative to the conformation of the native bound complex (i.e. the conformation at the bottom of the binding funnel).</p>
      <fig id="F2" position="float">
        <label>Figure 2</label>
        <caption>
          <p><bold>The true positive binding funnel.</bold> The true positive binding funnel for the vitamin D-binding protein/actin complex (1KXP [<xref ref-type="bibr" rid="B22">22</xref>]) generated with the SwarmDock Server [<xref ref-type="bibr" rid="B20">20</xref>] by docking unbound receptor/ligand pair included in Benchmark 4.0 [<xref ref-type="bibr" rid="B25">25</xref>]. The protein-protein conformational states are numbered from ID 0 to 31. The letter indicates the quality of solution in accordance to CAPRI [<xref ref-type="bibr" rid="B24">24</xref>] classification as: M – medium quality (blue), A – acceptable quality (green), I – incorrect solution (red). Favourable paths are marked in red. Figure created with Gephi [<xref ref-type="bibr" rid="B26">26</xref>] based on Example1/1KXP.gml file (Additional file <xref ref-type="supplementary-material" rid="S1">1</xref>). See text for more details.</p>
        </caption>
        <graphic xlink:href="1752-0509-7-130-2"/>
      </fig>
      <p>Similarly to the previous study [<xref ref-type="bibr" rid="B23">23</xref>], the transition probability for states with ligand RMSD above 6Å was set to zero. For the remaining states, transition probabilities were assigned based on energy value (the OPUS-PSP potential [<xref ref-type="bibr" rid="B27">27</xref>]): if the energy of the state in question was higher than the neighbouring state, the exit probability was set to 1.0, otherwise it was set to exp(−<italic>Δ</italic><italic>E</italic>), where <italic>Δ</italic><italic>E</italic> is the difference in the energy between the two conformations. The exit probabilities for each node were normalized. In the present study, the weights of each edges are set equal to 1.0 (global time scale, we assume that conformational states are sampled uniformly in time), and if the transition probability is smaller than 10<sup>−6</sup> for a particular edge it is removed. PDB files (Example1/*.pdb), the RMSD matrix file (Example1/1KXP.rmsd), the MFPT matrix file (Example1/1KXP.mfpt) and characteristics of the conformational states file (Example1/1KXP.info) are deposited in Additional file <xref ref-type="supplementary-material" rid="S1">1</xref>. Here we are interested in finding the favourable path(s) between incorrect conformational states (ID 9 and 30; states on the edge of the binding funnel) and the best state found by SwarmDock (the state closest to the bottom of the binding funnel; the native complex state). The state identified as being the closest to the native complex state, based upon the CAPRI criteria described above, is M21 (see Figure <xref ref-type="fig" rid="F2">2</xref> and Example1/1KXP.info for details).</p>
      <p>The RaTrav tool was run on this network (Example1/1KXP.ratrav) with 10<sup>6</sup> random walkers. To speed up the computations we parallelized the calculations by creating a separate input file for each pair of states and by using the <monospace>MFPT</monospace> keyword (see Methods). We ran the calculations on our computational cluster (HP ProLiant BL460c) in parallel for 992 MFPTs (32∗32−32) for a maximum walltime of 14 days. A total of 291 MFPTs were reported to be not accessible; links between nodes with transition probabilities smaller than 10<sup>−6</sup>. Of the remaining 701 MFPTs a total of 372 were reported back by RaTrav, the remainder, 329 were still in the process of being computed and assumed to be essentially infinite; that is a substantial number of the network walkers were stuck in dead ends.</p>
      <p>Using the initial network (Example1/1KXP.ratrav), we assigned weights to edges based on calculated MFPTs; we removed links if MFPTs haven’t been calculated. On this MFPT weighted network (all weights are positive) we ran the Dijkstra algorithm [<xref ref-type="bibr" rid="B28">28</xref>] to find the favourable trajectories (shortest paths in units of mean first-passage times) between conformational states on the edge of the binding funnel (I9 and I30) and the medium quality structure near the bottom of the funnel (M21).</p>
      <p>The Dijkstra algorithm identified the following shortest paths: 9→20→22→21 (sum of MFPTs equals 4,624,065 steps) and 30→20→22→21 (sum of MFPTs equals 4,243,494 steps).</p>
      <p>We analyzed the trajectory in terms of changes in interface and ligand RMSD, number of native and non-native contacts and energy of each conformational state. We summarize the calculations in Table <xref ref-type="table" rid="T1">1</xref> and the values for all states are present in Additional file <xref ref-type="supplementary-material" rid="S1">1</xref> (Example1/1KXP.info).</p>
      <table-wrap position="float" id="T1">
        <label>Table 1</label>
        <caption>
          <p>Conformational states in the favourable trajectory from the edge of the binding funnel I9 or I30 to M21 near the bottom of the funnel</p>
        </caption>
        <table frame="hsides" rules="groups" border="1">
          <colgroup>
            <col align="left"/>
            <col align="center"/>
            <col align="center"/>
            <col align="center"/>
            <col align="center"/>
            <col align="center"/>
          </colgroup>
          <thead valign="top">
            <tr>
              <th align="left">
                <bold>Node ID</bold>
                <break/>
                <bold>(Figure </bold>
                <xref ref-type="fig" rid="F2">2</xref>
                <bold>)</bold>
              </th>
              <th align="left">
                <bold>IRMSD</bold>
              </th>
              <th align="left">
                <bold>LRMSD</bold>
              </th>
              <th align="left">
                <bold>fnat</bold>
              </th>
              <th align="left">
                <bold>fnonnat</bold>
              </th>
              <th align="left"><bold>OPUS-PSP</bold><break/>[<xref ref-type="bibr" rid="B27">27</xref>]</th>
            </tr>
          </thead>
          <tbody valign="top">
            <tr>
              <td align="left" valign="bottom">9 (59b.pdb)<hr/></td>
              <td align="right" valign="bottom">4.41<hr/></td>
              <td align="right" valign="bottom">15.43<hr/></td>
              <td align="right" valign="bottom">0.22<hr/></td>
              <td align="right" valign="bottom">0.78<hr/></td>
              <td align="right" valign="bottom">-335.113<hr/></td>
            </tr>
            <tr>
              <td align="left" valign="bottom">or<hr/></td>
              <td align="right" valign="bottom"> <hr/></td>
              <td align="right" valign="bottom"> <hr/></td>
              <td align="right" valign="bottom"> <hr/></td>
              <td align="right" valign="bottom"> <hr/></td>
              <td align="right" valign="bottom"> <hr/></td>
            </tr>
            <tr>
              <td align="left" valign="bottom">30 (99c.pdb)<hr/></td>
              <td align="right" valign="bottom">4.01<hr/></td>
              <td align="right" valign="bottom">14.81<hr/></td>
              <td align="right" valign="bottom">0.25<hr/></td>
              <td align="right" valign="bottom">0.77<hr/></td>
              <td align="right" valign="bottom">-385.907<hr/></td>
            </tr>
            <tr>
              <td align="left" valign="bottom">20 (79a.pdb)<hr/></td>
              <td align="right" valign="bottom">2.95<hr/></td>
              <td align="right" valign="bottom">10.60<hr/></td>
              <td align="right" valign="bottom">0.42<hr/></td>
              <td align="right" valign="bottom">0.60<hr/></td>
              <td align="right" valign="bottom">-441.811<hr/></td>
            </tr>
            <tr>
              <td align="left" valign="bottom">22 (80c.pdb)<hr/></td>
              <td align="right" valign="bottom">1.88<hr/></td>
              <td align="right" valign="bottom">5.53<hr/></td>
              <td align="right" valign="bottom">0.61<hr/></td>
              <td align="right" valign="bottom">0.42<hr/></td>
              <td align="right" valign="bottom">-405.242<hr/></td>
            </tr>
            <tr>
              <td align="left">21 (80a.pdb)</td>
              <td align="right">1.41</td>
              <td align="right">3.14</td>
              <td align="right">0.67</td>
              <td align="right">0.31</td>
              <td align="right">-406.366</td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <p>Interface RMSD (IRMSD), ligand RMSD (LRMSD), number of native contacts (fnat), number of non-native contacts (fnonnat) and OPUSPSP energy values are reported. The first four values were computed comparing with the native complex structure.</p>
        </table-wrap-foot>
      </table-wrap>
      <p>The final state is accessed slightly faster from the edge state I30 which has fnat = 25% than the edge state I9 with the slightly lower fnat = 22%. The difference in paths is only due to the MFPT for the first transition, to the state A20. Interestingly, the initial transitions (IDs 9→20 or 30→20) are down an energy gradient, at least in terms of the OPUS-PSP potential used to score protein-protein interactions. However, the next two transitions, A20→M22→M21 are movements to slightly increased energy states, indicating that the most time efficient pathways do not necessarily follow a decreasing energy gradient. Moreover, in terms of MFPTs, the transition between states A20 and M22, which looks in Figure <xref ref-type="fig" rid="F2">2</xref> to be a bottleneck (kinetic trap), is not the limiting transition when comparing MFPTs for the first transition (I9 or I30 to A20) or the last transition in the pathway (M22 to M21).</p>
      <p>In conclusion, by exploring MFPTs between conformational states within a protein-protein binding funnel, dynamic information can be obtained that may provide important complementary, and sometimes counter intuitive, information on the funnel’s physical properties, which may facilitate rational design of competitive protein ligand inhibitors.</p>
    </sec>
    <sec>
      <title>Free energy transduction between two coupled enzymatic reactions</title>
      <p>As a second example of the utility of RaTrav, we describe here a method that enables a user to determine the non-equilibrium stationary fluxes in a system of interest on the basis of MFPT calculations. To this end we consider the action of a protein enzyme that converts the free energy between two coupled chemical reactions [<xref ref-type="bibr" rid="B29">29</xref>]<bold>,</bold>[<xref ref-type="bibr" rid="B30">30</xref>]. Our primary task is to calculate the degree of coupling between the free energy-donating reaction and the free energy-accepting one, the parameter that characterizes the efficacy of this chemo-chemical machine.</p>
      <p>Let us consider the shaded box shown in Figure <xref ref-type="fig" rid="F3">3</xref> which represents the network of conformational substates of a protein macromolecule that catalyses simultaneously two, in general, reversible reactions: the free energy-donating reaction R<sub>1</sub><bold> ⇔ </bold>P<sub>1</sub> and the free energy-accepting reaction R<sub>2</sub><bold> ⇔ </bold>P<sub>2</sub>. A model structure of such a network consisting of two hundred nodes is depicted in Figure <xref ref-type="fig" rid="F4">4</xref>. A set of distinguished transition states, called the gates, underscored by enlarged black nodes, corresponds directly to the system of labels used in Figure <xref ref-type="fig" rid="F3">3</xref>. For the sake of clarity, we have limited our calculations to a rather simple network of states displaying a tree-like topology, but much more complex networks of states can also be taken into account. In this context, the actual network can be thought of as a spanning tree, a loopless subnetwork consisting of edges with the highest transition probabilities per unit time between conformational substates.</p>
      <fig id="F3" position="float">
        <label>Figure 3</label>
        <caption>
          <p><bold>Chemo-chemical molecular machine.</bold> A scheme of two coupled free energy-donating R<sub>1</sub><bold> ⇔ </bold>P<sub>1</sub> and free energy-accepting R<sub>2</sub><bold> ⇔ </bold>P<sub>2</sub> enzymatic reactions involving the intramolecular conformational dynamics of the enzyme macromolecule. The multitude of conformational transitions within the complex M is represented by the shaded box. Both coupled reactions are assumed to be gated by certain conformational substates distinguished here as the black dots. The transitions between gates are characterized by the external transition times <italic>τ</italic><sub>1</sub> and <italic>τ</italic><sub>2</sub>.</p>
        </caption>
        <graphic xlink:href="1752-0509-7-130-3"/>
      </fig>
      <fig id="F4" position="float">
        <label>Figure 4</label>
        <caption>
          <p><bold>The model network of conformational substates.</bold> The model network of stochastic transitions between conformational substates (nodes) corresponding to the shaded box M in Figure <xref ref-type="fig" rid="F3">3</xref>. Its structure displays both the scale-free topology, as well as the fractality [<xref ref-type="bibr" rid="B31">31</xref>]. The distinguished nodes (enlarged dots) symbolizes the gates which have been marked here in accordance with a system of labels used in Figure <xref ref-type="fig" rid="F3">3</xref>.</p>
        </caption>
        <graphic xlink:href="1752-0509-7-130-4"/>
      </fig>
      <p>The steady-state reaction fluxes</p>
      <p>
        <disp-formula id="bmcM6">
          <label>(6)</label>
          <mml:math id="M22" name="1752-0509-7-130-i35" overflow="scroll">
            <mml:msub>
              <mml:mrow>
                <mml:mi>J</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>i</mml:mi>
              </mml:mrow>
            </mml:msub>
            <mml:mo>≡</mml:mo>
            <mml:mspace width="0.3em"/>
            <mml:mo>[</mml:mo>
            <mml:mspace width="0.3em"/>
            <mml:msub>
              <mml:mrow>
                <mml:mover accent="true">
                  <mml:mrow>
                    <mml:mi mathvariant="normal">P</mml:mi>
                  </mml:mrow>
                  <mml:mo>˙</mml:mo>
                </mml:mover>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>i</mml:mi>
              </mml:mrow>
            </mml:msub>
            <mml:mo>]</mml:mo>
            <mml:mo>/</mml:mo>
            <mml:msub>
              <mml:mrow>
                <mml:mo>[</mml:mo>
                <mml:mspace width="0.3em"/>
                <mml:mi mathvariant="normal">E</mml:mi>
                <mml:mo>]</mml:mo>
              </mml:mrow>
              <mml:mrow>
                <mml:mn>0</mml:mn>
              </mml:mrow>
            </mml:msub>
          </mml:math>
        </disp-formula>
      </p>
      <p>(<italic>i</italic> = 1,2) determine by definition the effective reaction rates, where [ E]<sub><bold>0</bold></sub> is the total concentration of the enzyme molecule and the over-dot means a derivative with respect to time. The corresponding chemical forces</p>
      <p>
        <disp-formula id="bmcM7">
          <label>(7)</label>
          <mml:math id="M23" name="1752-0509-7-130-i36" overflow="scroll">
            <mml:mi>β</mml:mi>
            <mml:msub>
              <mml:mrow>
                <mml:mi>A</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>i</mml:mi>
              </mml:mrow>
            </mml:msub>
            <mml:mo>=</mml:mo>
            <mml:mo>ln</mml:mo>
            <mml:msub>
              <mml:mrow>
                <mml:mi>K</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>i</mml:mi>
              </mml:mrow>
            </mml:msub>
            <mml:mfrac>
              <mml:mrow>
                <mml:mo>[</mml:mo>
                <mml:mspace width="0.3em"/>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi mathvariant="normal">R</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>i</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:mo>]</mml:mo>
              </mml:mrow>
              <mml:mrow>
                <mml:mo>[</mml:mo>
                <mml:mspace width="0.3em"/>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi mathvariant="normal">P</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>i</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:mo>]</mml:mo>
              </mml:mrow>
            </mml:mfrac>
            <mml:mspace width="2.22144pt"/>
            <mml:mo>,</mml:mo>
            <mml:mspace width="2.77626pt"/>
            <mml:mspace width="2.77626pt"/>
            <mml:mspace width="2.77626pt"/>
            <mml:mspace width="2.77626pt"/>
            <mml:mspace width="2.77626pt"/>
            <mml:msub>
              <mml:mrow>
                <mml:mi>K</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>i</mml:mi>
              </mml:mrow>
            </mml:msub>
            <mml:mo>≡</mml:mo>
            <mml:mfrac>
              <mml:mrow>
                <mml:msup>
                  <mml:mrow>
                    <mml:mo>[</mml:mo>
                    <mml:mspace width="0.3em"/>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi mathvariant="normal">P</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>i</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                    <mml:mo>]</mml:mo>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mtext>eq</mml:mtext>
                  </mml:mrow>
                </mml:msup>
              </mml:mrow>
              <mml:mrow>
                <mml:msup>
                  <mml:mrow>
                    <mml:mo>[</mml:mo>
                    <mml:mspace width="0.3em"/>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi mathvariant="normal">R</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>i</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                    <mml:mo>]</mml:mo>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mtext>eq</mml:mtext>
                  </mml:mrow>
                </mml:msup>
              </mml:mrow>
            </mml:mfrac>
            <mml:mspace width="2.22144pt"/>
            <mml:mo>,</mml:mo>
          </mml:math>
        </disp-formula>
      </p>
      <p>drive both chemical reactions. The symbols enclosed in the square brackets denote the molar concentrations of the chemical compounds R<sub><italic>i</italic></sub> and P<sub><italic>i</italic></sub> in the steady state (no subscript) or in the equilibrium state (the superscript eq). Here, <italic>β</italic> = (<italic>k</italic><sub><bold>B</bold></sub><italic>T</italic>)<sup><bold>−1</bold></sup>, where <italic>k</italic><sub><bold>B</bold></sub> is the Boltzmann constant and <italic>T</italic> denotes the absolute temperature.</p>
      <p>The protein enzyme acts as a mesoscopic molecular machine, i.e. a system that enables two subsystems to perform work on one another, with the efficiency given by the ratio</p>
      <p>
        <disp-formula id="bmcM8">
          <label>(8)</label>
          <mml:math id="M24" name="1752-0509-7-130-i37" overflow="scroll">
            <mml:mi>η</mml:mi>
            <mml:mspace width="0.3em"/>
            <mml:mo>=</mml:mo>
            <mml:mspace width="0.3em"/>
            <mml:mo>−</mml:mo>
            <mml:msub>
              <mml:mrow>
                <mml:mi>J</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mn>2</mml:mn>
              </mml:mrow>
            </mml:msub>
            <mml:msub>
              <mml:mrow>
                <mml:mi>A</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mn>2</mml:mn>
              </mml:mrow>
            </mml:msub>
            <mml:mo>/</mml:mo>
            <mml:msub>
              <mml:mrow>
                <mml:mi>J</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mn>1</mml:mn>
              </mml:mrow>
            </mml:msub>
            <mml:msub>
              <mml:mrow>
                <mml:mi>A</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mn>1</mml:mn>
              </mml:mrow>
            </mml:msub>
            <mml:mspace width="2.22144pt"/>
            <mml:mo>,</mml:mo>
          </mml:math>
        </disp-formula>
      </p>
      <p>of the output power <italic>J</italic><sub>2</sub><italic>A</italic><sub>2</sub> to the input power <italic>J</italic><sub>1</sub><italic>A</italic><sub>1</sub>. The minus sign in Eq. 8 arises from the fact that the free energy transduction can be realized only if the positive flux <italic>J</italic><sub>2</sub> &gt; 0 corresponds to the negative chemical force <italic>A</italic><sub>2</sub> &lt; 0 or vice versa [<xref ref-type="bibr" rid="B9">9</xref>]. This contradicts the second law of thermodynamics according to which the flux as well as the force should be of the same sign. However, if both reactions are coupled by the protein enzyme and proceed simultaneously in a common cycle, then the first reaction can change the direction of the second reaction. Consequently, the free energy dissipation is minimized at the expense of the free energy conversion, which can be realised with higher efficacy in the system. The effectiveness of this process is characterised by a degree of coupling</p>
      <p>
        <disp-formula id="bmcM9">
          <label>(9)</label>
          <mml:math id="M25" name="1752-0509-7-130-i38" overflow="scroll">
            <mml:mi>ε</mml:mi>
            <mml:mspace width="0.3em"/>
            <mml:mo>=</mml:mo>
            <mml:mspace width="0.3em"/>
            <mml:msub>
              <mml:mrow>
                <mml:mi>J</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mn>2</mml:mn>
              </mml:mrow>
            </mml:msub>
            <mml:mo>/</mml:mo>
            <mml:msub>
              <mml:mrow>
                <mml:mi>J</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mn>1</mml:mn>
              </mml:mrow>
            </mml:msub>
            <mml:mspace width="0.3em"/>
            <mml:mi>.</mml:mi>
          </mml:math>
        </disp-formula>
      </p>
      <p>In the following, our main objective is to give some instructive hints of how to calculate a degree of coupling for the two chemical reactions controlled and gated by the network of conformational transitions depicted in Figure <xref ref-type="fig" rid="F4">4</xref>. This network forms the content of the grey box, representing the enzyme-substrate(s) complex M, shown schematically in Figure <xref ref-type="fig" rid="F3">3</xref>. We assume that the stochastic dynamics of conformational and chemical transitions within the enzymatic protein is jointly described by the system of master equations (see Eqs. 1 or 2). For the isolated network (without the chemical reactions) we assume the transition probabilities per unit time from the conformational substate <italic>l</italic> to its <italic>k</italic><sub><italic>l</italic></sub> directly adjacent substates <italic>l</italic><sup><bold>′</bold></sup> to be</p>
      <p>
        <disp-formula id="bmcM10">
          <label>(10)</label>
          <mml:math id="M26" name="1752-0509-7-130-i39" overflow="scroll">
            <mml:msub>
              <mml:mrow>
                <mml:mi>w</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:msup>
                  <mml:mrow>
                    <mml:mi>l</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mo>′</mml:mo>
                  </mml:mrow>
                </mml:msup>
                <mml:mi>l</mml:mi>
              </mml:mrow>
            </mml:msub>
            <mml:mspace width="0.3em"/>
            <mml:mo>=</mml:mo>
            <mml:mspace width="0.3em"/>
            <mml:mi>p</mml:mi>
            <mml:mo>/</mml:mo>
            <mml:msub>
              <mml:mrow>
                <mml:mi>k</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>l</mml:mi>
              </mml:mrow>
            </mml:msub>
            <mml:mi>.</mml:mi>
          </mml:math>
        </disp-formula>
      </p>
      <p><italic>p</italic> determines the probability of transition to any conformational state neighbouring <italic>l</italic>. Following the detailed balance principle</p>
      <p>
        <disp-formula id="bmcM11">
          <label>(11)</label>
          <mml:math id="M27" name="1752-0509-7-130-i40" overflow="scroll">
            <mml:msub>
              <mml:mrow>
                <mml:mi>w</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>l</mml:mi>
                <mml:msup>
                  <mml:mrow>
                    <mml:mi>l</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mo>′</mml:mo>
                  </mml:mrow>
                </mml:msup>
              </mml:mrow>
            </mml:msub>
            <mml:msubsup>
              <mml:mrow>
                <mml:mi>p</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:msup>
                  <mml:mrow>
                    <mml:mi>l</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mo>′</mml:mo>
                  </mml:mrow>
                </mml:msup>
              </mml:mrow>
              <mml:mrow>
                <mml:mtext>eq</mml:mtext>
              </mml:mrow>
            </mml:msubsup>
            <mml:mspace width="0.3em"/>
            <mml:mo>=</mml:mo>
            <mml:mspace width="0.3em"/>
            <mml:msub>
              <mml:mrow>
                <mml:mi>w</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:msup>
                  <mml:mrow>
                    <mml:mi>l</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mo>′</mml:mo>
                  </mml:mrow>
                </mml:msup>
                <mml:mi>l</mml:mi>
              </mml:mrow>
            </mml:msub>
            <mml:msubsup>
              <mml:mrow>
                <mml:mi>p</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>l</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mtext>eq</mml:mtext>
              </mml:mrow>
            </mml:msubsup>
          </mml:math>
        </disp-formula>
      </p>
      <p>the equilibrium occupation probability of the substate (node) <italic>l</italic></p>
      <p>
        <disp-formula id="bmcM12">
          <label>(12)</label>
          <mml:math id="M28" name="1752-0509-7-130-i41" overflow="scroll">
            <mml:msubsup>
              <mml:mrow>
                <mml:mi>p</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>l</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mtext>eq</mml:mtext>
              </mml:mrow>
            </mml:msubsup>
            <mml:mspace width="0.3em"/>
            <mml:mo>=</mml:mo>
            <mml:mspace width="0.3em"/>
            <mml:mfrac>
              <mml:mrow>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>k</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>l</mml:mi>
                  </mml:mrow>
                </mml:msub>
              </mml:mrow>
              <mml:mrow>
                <mml:munder>
                  <mml:mrow>
                    <mml:mi mathsize="big">∑</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:msup>
                      <mml:mrow>
                        <mml:mi>l</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mo>′</mml:mo>
                      </mml:mrow>
                    </mml:msup>
                  </mml:mrow>
                </mml:munder>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>k</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:msup>
                      <mml:mrow>
                        <mml:mi>l</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mo>′</mml:mo>
                      </mml:mrow>
                    </mml:msup>
                  </mml:mrow>
                </mml:msub>
              </mml:mrow>
            </mml:mfrac>
            <mml:mspace width="2.22144pt"/>
            <mml:mo>,</mml:mo>
          </mml:math>
        </disp-formula>
      </p>
      <p>where the summation runs over all nodes composing a network of conformational substates.</p>
      <p>The non-zero thermodynamic forces, Eqs. 7, drive the system out of equilibrium breaking simultaneously the detailed balance condition for external and in general reversible transitions between gates (the transition states), which for <italic>l</italic> = 1,2 are characterised by the external transition times <italic>τ</italic><sub><italic>l</italic></sub> (cf. Figure <xref ref-type="fig" rid="F3">3</xref>). These parameters can be compared to the longest MFPT within a network of states (nodes), which usually refers to the passage time, counted in the random walker steps, between the most distant pair of nodes. Together with the equilibrium occupation probabilities in Eq. 12 they determine the additional transition probabilities between the gates in the forward direction (exit from the gate <italic>l</italic><sup><bold>′′</bold></sup>)</p>
      <p>
        <disp-formula id="bmcM13">
          <label>(13)</label>
          <mml:math id="M29" name="1752-0509-7-130-i42" overflow="scroll">
            <mml:msub>
              <mml:mrow>
                <mml:mi>v</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mo>+</mml:mo>
                <mml:mi>l</mml:mi>
              </mml:mrow>
            </mml:msub>
            <mml:mspace width="0.3em"/>
            <mml:mo>=</mml:mo>
            <mml:mspace width="0.3em"/>
            <mml:mfrac>
              <mml:mrow>
                <mml:mi>p</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>τ</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>l</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:msubsup>
                  <mml:mrow>
                    <mml:mi>p</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:msup>
                      <mml:mrow>
                        <mml:mi>l</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>′′</mml:mi>
                      </mml:mrow>
                    </mml:msup>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mtext>eq</mml:mtext>
                  </mml:mrow>
                </mml:msubsup>
              </mml:mrow>
            </mml:mfrac>
            <mml:mspace width="2.22144pt"/>
            <mml:mo>,</mml:mo>
          </mml:math>
        </disp-formula>
      </p>
      <p>and in the backward direction (exit from the gate <italic>l</italic><sup><bold>′</bold></sup>)</p>
      <p>
        <disp-formula id="bmcM14">
          <label>(14)</label>
          <mml:math id="M30" name="1752-0509-7-130-i43" overflow="scroll">
            <mml:msub>
              <mml:mrow>
                <mml:mi>v</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mo>−</mml:mo>
                <mml:mi>l</mml:mi>
              </mml:mrow>
            </mml:msub>
            <mml:mspace width="0.3em"/>
            <mml:mo>=</mml:mo>
            <mml:mspace width="0.3em"/>
            <mml:mfrac>
              <mml:mrow>
                <mml:mi>p</mml:mi>
                <mml:mspace width="2.22144pt"/>
                <mml:msup>
                  <mml:mrow>
                    <mml:mi>e</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mo>−</mml:mo>
                    <mml:mi>β</mml:mi>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>A</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>l</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                  </mml:mrow>
                </mml:msup>
              </mml:mrow>
              <mml:mrow>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>τ</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>l</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:msubsup>
                  <mml:mrow>
                    <mml:mi>p</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:msup>
                      <mml:mrow>
                        <mml:mi>l</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mo>′</mml:mo>
                      </mml:mrow>
                    </mml:msup>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mtext>eq</mml:mtext>
                  </mml:mrow>
                </mml:msubsup>
              </mml:mrow>
            </mml:mfrac>
            <mml:mspace width="2.22144pt"/>
            <mml:mi>.</mml:mi>
          </mml:math>
        </disp-formula>
      </p>
      <p>The factor <inline-formula><mml:math id="M31" name="1752-0509-7-130-i44" overflow="scroll"><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mi>β</mml:mi><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup></mml:math></inline-formula> breaks the detailed balance symmetry. Here, the index <italic>l</italic> = 1,2 and the appropriate selection of primes and double primes is explained in Figure <xref ref-type="fig" rid="F4">4</xref>.</p>
      <p>It follows from Eq. 13 and 14 that the probability <italic>p</italic> we introduced in Eq. 10 determines the characteristic unit of time which establishes an elementary time scale for the computer machine step. Thus, it should be firmly emphasized that the adequate determination of this quantity has a decisive meaning for the computational purpose at hand. To find <italic>p</italic> we select one gate <italic>l</italic> for which the external transition probability <italic>v</italic><sub><italic>n</italic><italic>m</italic></sub> is the highest. Then, assuming that at this gate the sum <italic>p</italic> + <italic>v</italic><sub><italic>n</italic><italic>m</italic></sub> = 1, we obtain the appropriate expression for <italic>p</italic>:</p>
      <p>
        <disp-formula id="bmcM15">
          <label>(15)</label>
          <mml:math id="M32" name="1752-0509-7-130-i45" overflow="scroll">
            <mml:mi>p</mml:mi>
            <mml:mspace width="0.3em"/>
            <mml:mo>=</mml:mo>
            <mml:mspace width="0.3em"/>
            <mml:mfrac>
              <mml:mrow>
                <mml:mn>1</mml:mn>
              </mml:mrow>
              <mml:mrow>
                <mml:mn>1</mml:mn>
                <mml:mo>+</mml:mo>
                <mml:msup>
                  <mml:mrow>
                    <mml:mo>(</mml:mo>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>τ</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>l</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                    <mml:mspace width="2.22144pt"/>
                    <mml:msubsup>
                      <mml:mrow>
                        <mml:mi>p</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>l</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mtext>eq</mml:mtext>
                      </mml:mrow>
                    </mml:msubsup>
                    <mml:mo>)</mml:mo>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mo>−</mml:mo>
                    <mml:mn>1</mml:mn>
                  </mml:mrow>
                </mml:msup>
              </mml:mrow>
            </mml:mfrac>
            <mml:mspace width="2.22144pt"/>
            <mml:mi>.</mml:mi>
          </mml:math>
        </disp-formula>
      </p>
      <p>Consequently, in the case of the remaining nodes the sum of internal and possibly external transition probabilities must be complemented to unity, which means that additionally the non-zero waiting probabilities have to be taken into account on these states.</p>
      <p>For the network of states depicted in Figure <xref ref-type="fig" rid="F4">4</xref> (Example2/ratrav_fig4.in in Additional file <xref ref-type="supplementary-material" rid="S1">1</xref>) the longest MFPT, <italic>τ</italic><sub><bold>max</bold></sub>, counted in random walk steps without external transitions, equals 3261 (see Example2/HI_ratrav_fig4.out in Additional file <xref ref-type="supplementary-material" rid="S1">1</xref>); the transition state with the lowest occupation probability corresponds to the gate <italic>l</italic> = 1<sup><bold>′′</bold></sup> (although <italic>l</italic> = 1<sup><bold>′</bold></sup> is another good choice), for which <inline-formula><mml:math id="M33" name="1752-0509-7-130-i46" overflow="scroll"><mml:msubsup><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>′′</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mtext>eq</mml:mtext></mml:mrow></mml:msubsup><mml:mspace width="0.3em"/><mml:mo>=</mml:mo><mml:mspace width="0.3em"/><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mn>398</mml:mn></mml:math></inline-formula> (see Eq. 12 with <inline-formula><mml:math id="M34" name="1752-0509-7-130-i47" overflow="scroll"><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>′′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msub><mml:mspace width="0.3em"/><mml:mo>=</mml:mo><mml:mspace width="0.3em"/><mml:mn>1</mml:mn></mml:math></inline-formula>, <inline-formula><mml:math id="M35" name="1752-0509-7-130-i48" overflow="scroll"><mml:munder><mml:mrow><mml:mi mathsize="big">∑</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mspace width="0.3em"/><mml:mo>=</mml:mo><mml:mspace width="0.3em"/><mml:mn>2</mml:mn><mml:mspace width="0.3em"/><mml:mo>(</mml:mo><mml:mi>N</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:math></inline-formula> where <italic>N</italic> = 200 is the number of nodes in the network). Without loss of generality we consider in what follows only the case for <italic>τ</italic><sub><bold>1</bold></sub> = <italic>τ</italic><sub>2</sub>. Selecting <italic>τ</italic><sub>1</sub> = 40, which is far below the maximal value <italic>τ</italic><sub><bold>max</bold></sub> = 3261, we enforce the chemical reactions to be completely controlled by the internal dynamics of conformational transitions for which <italic>p</italic> ≈ 0.091 in Eq. 15. Moreover, assuming <italic>β</italic><italic>A</italic><sub>1</sub> = 10 we require that the free energy-donating reaction proceeds sufficiently far from equilibrium in the forward direction 1<sup><bold>′′</bold></sup><bold> → 1</bold><sup><bold>′</bold></sup>, while becoming almost negligible in the backward direction 1<sup><bold>′</bold></sup><bold> → 1</bold><sup><bold>′′</bold></sup>. In turn, we put <italic>β</italic><italic>A</italic><sub>2</sub> = 0 to provide the detailed balance symmetry for the free energy-accepting reaction. Such a choice of parameters <italic>τ</italic><sub><italic>l</italic></sub> and <italic>A</italic><sub><italic>l</italic></sub> for <italic>l</italic> = 1,2 assures the highest transition probability from the node <italic>l</italic> = 1<sup><bold>′′</bold></sup>.</p>
      <p>We are now in a position to determine the steady-state reaction fluxes for both chemical transitions. The net fluxes are decomposed into one-way fluxes</p>
      <p>
        <disp-formula id="bmcM16">
          <label>(16)</label>
          <mml:math id="M36" name="1752-0509-7-130-i49" overflow="scroll">
            <mml:mtable class="align" columnalign="left">
              <mml:mtr>
                <mml:mtd class="align-1">
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>J</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mn>1</mml:mn>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mspace width="0.3em"/>
                </mml:mtd>
                <mml:mtd class="align-2">
                  <mml:mo>=</mml:mo>
                  <mml:mspace width="0.3em"/>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>J</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mo>+</mml:mo>
                      <mml:mn>1</mml:mn>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mspace width="0.3em"/>
                  <mml:mo>−</mml:mo>
                  <mml:mspace width="0.3em"/>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>J</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mo>−</mml:mo>
                      <mml:mn>1</mml:mn>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mspace width="2em"/>
                </mml:mtd>
              </mml:mtr>
            </mml:mtable>
          </mml:math>
        </disp-formula>
      </p>
      <p>
        <disp-formula id="bmcM17">
          <label>(17)</label>
          <mml:math id="M37" name="1752-0509-7-130-i50" overflow="scroll">
            <mml:mtable class="align" columnalign="left">
              <mml:mtr>
                <mml:mtd class="align-1">
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>J</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mn>2</mml:mn>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mspace width="0.3em"/>
                </mml:mtd>
                <mml:mtd class="align-2">
                  <mml:mo>=</mml:mo>
                  <mml:mspace width="0.3em"/>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>J</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mo>+</mml:mo>
                      <mml:mn>2</mml:mn>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mspace width="0.3em"/>
                  <mml:mo>−</mml:mo>
                  <mml:mspace width="0.3em"/>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>J</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mo>−</mml:mo>
                      <mml:mn>2</mml:mn>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mspace width="2.22144pt"/>
                  <mml:mo>,</mml:mo>
                  <mml:mspace width="2em"/>
                </mml:mtd>
              </mml:mtr>
            </mml:mtable>
          </mml:math>
        </disp-formula>
      </p>
      <p>where the signs plus and minus refer to the forward and the backward directions, respectively. To find them we must perform four independent calculations. Following the Hill reasoning [<xref ref-type="bibr" rid="B9">9</xref>] described in Methods, instead of the one-way steady state fluxes, it is enough to calculate the MFPTs between correctly identified nodes in the modified network of states. The schemes illustrated in Figure <xref ref-type="fig" rid="F5">5</xref>, explain in a pictorial form the direct relation between the MFPT and a one-way stationary flux <italic>J</italic><sub>±<italic>l</italic></sub>. According to the Hill algorithm
</p>
      <fig id="F5" position="float">
        <label>Figure 5</label>
        <caption>
          <p><bold>Stationary reaction fluxes.</bold> Four modified versions of the network of conformational substates with the internal and external transitions between them pictured in Figure <xref ref-type="fig" rid="F3">3</xref>. The considered schematic diagrams enable calculation, by using the Hill or Monte Carlo methods, the steady-state fluxes for the input/output reactions in the forward <bold>(a)</bold>/<bold>(c)</bold> and the backward <bold>(b)</bold>/<bold>(d)</bold> directions. The successive external transitions have been redirected to the additional node connected to the network and labeled here by the symbol, ∗. For instance, the forward reaction flux <bold>(a)</bold> is equivalent to the reciprocal MFPT from the gate 1<sup><bold>′</bold></sup> to the node ∗, through the intermediate gate 1<sup><bold>′′</bold></sup>.</p>
        </caption>
        <graphic xlink:href="1752-0509-7-130-5"/>
      </fig>
      <p>
        <disp-formula id="bmcM18">
          <label>(18)</label>
          <mml:math id="M38" name="1752-0509-7-130-i51" overflow="scroll">
            <mml:mtable class="align" columnalign="left">
              <mml:mtr>
                <mml:mtd class="align-1">
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>J</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mo>+</mml:mo>
                      <mml:mi>l</mml:mi>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mspace width="0.3em"/>
                </mml:mtd>
                <mml:mtd class="align-2">
                  <mml:mo>=</mml:mo>
                  <mml:mspace width="0.3em"/>
                  <mml:mfrac>
                    <mml:mrow>
                      <mml:mn>1</mml:mn>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>τ</mml:mi>
                      <mml:mo>(</mml:mo>
                      <mml:msup>
                        <mml:mrow>
                          <mml:mi>l</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mo>′</mml:mo>
                        </mml:mrow>
                      </mml:msup>
                      <mml:mo>→</mml:mo>
                      <mml:mo>∗</mml:mo>
                      <mml:mo>)</mml:mo>
                    </mml:mrow>
                  </mml:mfrac>
                  <mml:mspace width="2em"/>
                </mml:mtd>
              </mml:mtr>
            </mml:mtable>
          </mml:math>
        </disp-formula>
      </p>
      <p>
        <disp-formula id="bmcM19">
          <label>(19)</label>
          <mml:math id="M39" name="1752-0509-7-130-i52" overflow="scroll">
            <mml:mtable class="align" columnalign="left">
              <mml:mtr>
                <mml:mtd class="align-1">
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>J</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mo>−</mml:mo>
                      <mml:mi>l</mml:mi>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mspace width="0.3em"/>
                </mml:mtd>
                <mml:mtd class="align-2">
                  <mml:mo>=</mml:mo>
                  <mml:mspace width="0.3em"/>
                  <mml:mfrac>
                    <mml:mrow>
                      <mml:mn>1</mml:mn>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>τ</mml:mi>
                      <mml:mo>(</mml:mo>
                      <mml:msup>
                        <mml:mrow>
                          <mml:mi>l</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>′′</mml:mi>
                        </mml:mrow>
                      </mml:msup>
                      <mml:mo>→</mml:mo>
                      <mml:mo>∗</mml:mo>
                      <mml:mo>)</mml:mo>
                    </mml:mrow>
                  </mml:mfrac>
                  <mml:mspace width="2.22144pt"/>
                  <mml:mo>,</mml:mo>
                  <mml:mspace width="2em"/>
                </mml:mtd>
              </mml:mtr>
            </mml:mtable>
          </mml:math>
        </disp-formula>
      </p>
      <p>where ∗ is the additional target node connected to the network in a position where the intermediate nodes (gates) <italic>l</italic><sup><bold>′′</bold></sup> for <italic>J</italic><sub>+<italic>l</italic></sub>, or <italic>l</italic><sup><bold>′</bold></sup> for <italic>J</italic><sub>−<italic>l</italic></sub> are localised (see Figure <xref ref-type="fig" rid="F5">5</xref>). The algorithm allowing a calculation of the one-way stationary flux between two directly connected states (nodes) in the arbitrary network of states proceeds in the following steps: </p>
      <p>1. Create a network (graph) with connections (links) between nodes in accordance with the RaTrav input file format (see input files in Example2).</p>
      <p>2. Select two nodes connected directly by the link. In Figure <xref ref-type="fig" rid="F5">5</xref>a it is the reversible external transition between the node 1<sup><bold>′</bold></sup> and the node 1<sup><bold>′′</bold></sup> characterized by the exit probabilities <italic>v</italic><sub><bold>±1</bold></sub>.</p>
      <p>3. Choose a direction in which the flux will be calculated. In Figure <xref ref-type="fig" rid="F5">5</xref>a the flux <italic>J</italic><sub>+1</sub> is assumed to be in the counterclockwise direction.</p>
      <p>4. Redirect one of the two (if reversible) transitions along a link to the additional node added to the original network. In Figure <xref ref-type="fig" rid="F5">5</xref>a the transition from the node 1<sup><bold>′′</bold></sup> to the node 1<sup><bold>′</bold></sup> has been redirected to the new node labeled there by the star.</p>
      <p>5. Calculate the MFPT between the initial node (1<sup><bold>′</bold></sup>) and the final node (∗).</p>
      <p>6. The inverse of this MFPT determines the one-way stationary flux.</p>
      <p>Interestingly, the MFPTs in Eqs. 18 and 19 turn out to be split into two parts</p>
      <p>
        <disp-formula id="bmcM20">
          <label>(20)</label>
          <mml:math id="M40" name="1752-0509-7-130-i53" overflow="scroll">
            <mml:mtable class="align" columnalign="left">
              <mml:mtr>
                <mml:mtd class="align-1">
                  <mml:mi>τ</mml:mi>
                  <mml:mo>(</mml:mo>
                  <mml:msup>
                    <mml:mrow>
                      <mml:mi>l</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mo>′</mml:mo>
                    </mml:mrow>
                  </mml:msup>
                  <mml:mo>→</mml:mo>
                  <mml:mo>∗</mml:mo>
                  <mml:mo>)</mml:mo>
                  <mml:mspace width="0.3em"/>
                </mml:mtd>
                <mml:mtd class="align-2">
                  <mml:mo>=</mml:mo>
                  <mml:mspace width="0.3em"/>
                  <mml:mi>τ</mml:mi>
                  <mml:mo>(</mml:mo>
                  <mml:msup>
                    <mml:mrow>
                      <mml:mi>l</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mo>′</mml:mo>
                    </mml:mrow>
                  </mml:msup>
                  <mml:mo>→</mml:mo>
                  <mml:msup>
                    <mml:mrow>
                      <mml:mi>l</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>′′</mml:mi>
                    </mml:mrow>
                  </mml:msup>
                  <mml:mo>)</mml:mo>
                  <mml:mspace width="0.3em"/>
                  <mml:mo>+</mml:mo>
                  <mml:mspace width="0.3em"/>
                  <mml:msup>
                    <mml:mrow>
                      <mml:mfenced open="(" close=")">
                        <mml:mrow>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mi>v</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mo>+</mml:mo>
                              <mml:mi>l</mml:mi>
                            </mml:mrow>
                          </mml:msub>
                          <mml:mspace width="2.22144pt"/>
                          <mml:msubsup>
                            <mml:mrow>
                              <mml:mi>p</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:msup>
                                <mml:mrow>
                                  <mml:mi>l</mml:mi>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mi>′′</mml:mi>
                                </mml:mrow>
                              </mml:msup>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mtext>st</mml:mtext>
                            </mml:mrow>
                          </mml:msubsup>
                        </mml:mrow>
                      </mml:mfenced>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mo>−</mml:mo>
                      <mml:mn>1</mml:mn>
                    </mml:mrow>
                  </mml:msup>
                  <mml:mspace width="2em"/>
                </mml:mtd>
              </mml:mtr>
            </mml:mtable>
          </mml:math>
        </disp-formula>
      </p>
      <p>
        <disp-formula id="bmcM21">
          <label>(21)</label>
          <mml:math id="M41" name="1752-0509-7-130-i54" overflow="scroll">
            <mml:mtable class="align" columnalign="left">
              <mml:mtr>
                <mml:mtd class="align-1">
                  <mml:mi>τ</mml:mi>
                  <mml:mo>(</mml:mo>
                  <mml:msup>
                    <mml:mrow>
                      <mml:mi>l</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>′′</mml:mi>
                    </mml:mrow>
                  </mml:msup>
                  <mml:mo>→</mml:mo>
                  <mml:mo>∗</mml:mo>
                  <mml:mo>)</mml:mo>
                  <mml:mspace width="0.3em"/>
                </mml:mtd>
                <mml:mtd class="align-2">
                  <mml:mo>=</mml:mo>
                  <mml:mspace width="0.3em"/>
                  <mml:mi>τ</mml:mi>
                  <mml:mo>(</mml:mo>
                  <mml:msup>
                    <mml:mrow>
                      <mml:mi>l</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>′′</mml:mi>
                    </mml:mrow>
                  </mml:msup>
                  <mml:mo>→</mml:mo>
                  <mml:msup>
                    <mml:mrow>
                      <mml:mi>l</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mo>′</mml:mo>
                    </mml:mrow>
                  </mml:msup>
                  <mml:mo>)</mml:mo>
                  <mml:mspace width="0.3em"/>
                  <mml:mo>+</mml:mo>
                  <mml:mspace width="0.3em"/>
                  <mml:msup>
                    <mml:mrow>
                      <mml:mfenced open="(" close=")">
                        <mml:mrow>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mi>v</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mo>−</mml:mo>
                              <mml:mi>l</mml:mi>
                            </mml:mrow>
                          </mml:msub>
                          <mml:mspace width="2.22144pt"/>
                          <mml:msubsup>
                            <mml:mrow>
                              <mml:mi>p</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:msup>
                                <mml:mrow>
                                  <mml:mi>l</mml:mi>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mo>′</mml:mo>
                                </mml:mrow>
                              </mml:msup>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mtext>st</mml:mtext>
                            </mml:mrow>
                          </mml:msubsup>
                        </mml:mrow>
                      </mml:mfenced>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mo>−</mml:mo>
                      <mml:mn>1</mml:mn>
                    </mml:mrow>
                  </mml:msup>
                  <mml:mspace width="2.22144pt"/>
                  <mml:mi>.</mml:mi>
                  <mml:mspace width="2em"/>
                </mml:mtd>
              </mml:mtr>
            </mml:mtable>
          </mml:math>
        </disp-formula>
      </p>
      <p>(see Theorem 2 in [<xref ref-type="bibr" rid="B30">30</xref>]). Here, the superscript ‘st’ indicates the stationary occupation probabilities of the selected gates which can be also computed by the RaTrav tool. A method of how to calculate all quantities, for example, on the r.h.s of Eq. 20 for <italic>l</italic> = 2 is explained graphically in Figure <xref ref-type="fig" rid="F6">6</xref>. The relations in Eqs. 20 and 21 offer a very useful way in which all component MFPTs from states <italic>l</italic><sup><bold>′</bold></sup> or <italic>l</italic><sup><bold>′′</bold></sup> to ∗ and hence the stationary fluxes in Eqs. 18 and 19 can be calculated. Moreover, they are of particular importance since they enable us to identify scales of two characteristic time contributions, distinguishing the conformational dynamics within the protein enzyme (the first component) and between two coupled chemical reactions each of which is gated by a single transition substate (the second component). In this second case both components, <inline-formula><mml:math id="M42" name="1752-0509-7-130-i55" overflow="scroll"><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mo>±</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mo>±</mml:mo><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mtext>st</mml:mtext></mml:mrow></mml:msubsup></mml:math></inline-formula>, can be thought of as the counterparts of the reciprocal equilibrium rate constants supposed by the transition state theory.</p>
      <fig id="F6" position="float">
        <label>Figure 6</label>
        <caption>
          <p><bold>Conformational dynamics and chemical kinetics.</bold> Calculation of the MFPT from the node 2<sup><bold>′</bold></sup> through 2<sup><bold>′′</bold></sup> to ∗ on the network shown in Figure <xref ref-type="fig" rid="F5">5</xref>c can be performed using Eqs. 20 and 21as follows. First, it is sufficient to modify the initial network <bold>(a)</bold> by replacing the directed link from the node 2<sup><bold>′′</bold></sup> to the node ∗ with the link redirecteded to the node 2<sup><bold>′′</bold></sup>. Then, we calculate in a such prepared network <bold>(b)</bold> the MFPT from the node 2<sup><bold>′</bold></sup> to the node 2<sup><bold>′′</bold></sup> using Monte Carlo or Hill’s method and simultaneously the steady-state occupation probability <inline-formula><mml:math id="M43" name="1752-0509-7-130-i56" overflow="scroll"><mml:msubsup><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>′′</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mtext>st</mml:mtext></mml:mrow></mml:msubsup></mml:math></inline-formula> of node 2<sup><bold>′′</bold></sup>, which we next multiply by the transition probability <inline-formula><mml:math id="M44" name="1752-0509-7-130-i57" overflow="scroll"><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>′′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msub></mml:math></inline-formula> to ∗. The inverse of this product plus the MFPT between nodes 2<sup><bold>′</bold></sup> and 2<sup><bold>′′</bold></sup>, sum up to the total MFPT obtained for the original network <bold>(a)</bold>.</p>
        </caption>
        <graphic xlink:href="1752-0509-7-130-6"/>
      </fig>
      <p>Input data used to compute all directed reaction fluxes in the network of states shown in Figure <xref ref-type="fig" rid="F4">4</xref>, accompanied by the outputs, are to be found in Additional file <xref ref-type="supplementary-material" rid="S1">1</xref>. The MFPTs required for a determination of the steady-state fluxes in Eqs. 18 and 19 and obtained by using of the Hill algorithm are as follows: <italic>τ</italic>(1<sup><bold>′</bold></sup>→∗) = 5050.17, <italic>τ</italic>(1<sup><bold>′′</bold></sup>→∗) = 5086078.41, <italic>τ</italic>(2<sup><bold>′</bold></sup>→∗) = 423.29 and <italic>τ</italic>(2<sup><bold>′′</bold></sup>→∗) = 461.62, whereas those obtained by application of the Monte Carlo simulations for <monospace>WALK=1000000</monospace> and <monospace>SIMU=1</monospace> are: <italic>τ</italic>(1<sup><bold>′</bold></sup>→∗) = 5048.95, <italic>τ</italic>(1<sup><bold>′′</bold></sup>→∗) = 5081053.61, <italic>τ</italic>(2<sup><bold>′</bold></sup>→∗) = 425.39 and <italic>τ</italic>(2<sup><bold>′′</bold></sup>→∗) = 463.55. Therefore, combining these numerical results, we conclude from Eqs. 16, 17, 18, 19 and 9, that the degree of coupling is</p>
      <p>
        <disp-formula id="bmcM">
          <label>()</label>
          <mml:math id="M45" name="1752-0509-7-130-i58" overflow="scroll">
            <mml:mtable class="align" columnalign="left">
              <mml:mtr>
                <mml:mtd class="align-1">
                  <mml:mi>ε</mml:mi>
                  <mml:mspace width="0.3em"/>
                </mml:mtd>
                <mml:mtd class="align-2">
                  <mml:mo>=</mml:mo>
                  <mml:mspace width="0.3em"/>
                  <mml:mn>0.992</mml:mn>
                  <mml:mo>,</mml:mo>
                  <mml:mspace width="2.77626pt"/>
                  <mml:mspace width="2.77626pt"/>
                  <mml:mtext>following the Hill method, and</mml:mtext>
                  <mml:mspace width="2em"/>
                </mml:mtd>
                <mml:mtd>
                  <mml:mspace width="2em"/>
                </mml:mtd>
              </mml:mtr>
              <mml:mtr>
                <mml:mtd class="align-1">
                  <mml:mi>ε</mml:mi>
                  <mml:mspace width="0.3em"/>
                </mml:mtd>
                <mml:mtd class="align-2">
                  <mml:mo>≈</mml:mo>
                  <mml:mspace width="0.3em"/>
                  <mml:mn>0.978</mml:mn>
                  <mml:mo>,</mml:mo>
                  <mml:mspace width="2.77626pt"/>
                  <mml:mspace width="2.77626pt"/>
                  <mml:mtext>following the Monte Carlo method.</mml:mtext>
                  <mml:mspace width="2em"/>
                </mml:mtd>
                <mml:mtd>
                  <mml:mspace width="2em"/>
                </mml:mtd>
              </mml:mtr>
            </mml:mtable>
          </mml:math>
        </disp-formula>
      </p>
      <p>It is worth emphasizing that both numbers are very close to unity and this result requires sensible interpretation. Let us recall that the degree of coupling is defined as the ratio of the free energy-accepting reaction flux and the free energy-donating reaction flux. We have assumed that both reactions are controlled (<italic>τ</italic> = 40 ≪ <italic>τ</italic><sub><bold>max</bold></sub> = 3261) and simultaneously gated by the dynamics of stochastic transitions within a network of conformational states. The system of connections in this network is not arbitrary but displays the scale-free topology and fractality. The fractality results mainly from the effective repulsion between the most connected nodes, so called hubs, which tend to link to small degree nodes and not to each other. Two main hubs are clearly visible in Figure <xref ref-type="fig" rid="F4">4</xref>. Their existence enables the most distant separation between the pairs of gates (transition states) for the output and input reactions. As a consequence, the MFPTs between the gates shown in Figure <xref ref-type="fig" rid="F4">4</xref> become comparable and hence the degree of coupling is very close to unity. We have examined that all other configurations of the gates decreases the value of this parameter. There is still an open question for scientists of how to construct the effective networks of states for the real-world protein machines to predict and explain their basic functions. We hope, at least to some extent, that our software contributes to manage this task.</p>
    </sec>
  </sec>
  <sec sec-type="conclusions">
    <title>Conclusions</title>
    <p>There is a wide range of problems related to the theory of stochastic processes where the mean first-passage time quantity may be applied to describe the dynamics of the networked system. RaTrav is a software tool for calculating MFPTs on any arbitrary network or graph representing a substrate for Markovian processes, defined by the users in accordance with their requirements. MFPTs may be calculated between a pair of states or between an initial state and multiple final states. Moreover, exit probabilities from the nodes as well as local time scales along the edges may be assigned by the user. A choice between two MFPT calculation methods is made available: a stochastic Monte Carlo method and the combinatorial Hill method. To highlight the usefulness of the RaTrav tool, we presented in this article two examples of biochemical processes where the calculation of MFPTs plays an important role. For the first example (analysis of a protein-protein binding funnel), due to the large number of cycles within the network, the Monte Carlo method was applied. For the second, a tree-like network of conformational states for an enzyme, the Hill algorithm was applied in order to return results much faster and without any approximations. To our best knowledge, RaTrav is not only the first open source computational package for computing MFPTs, but as well the first computational tool to be made available where the local transition times of the network edges have been successfully introduced into Hill’s method.</p>
    <p>We are aware that there is a substantial gap between physics and biology in terms of describing the network properties such as the proper sampling of states, assignment of transition probabilities and assignment of weights of edges (local times) in line with a chosen reaction coordinate. However, with further development in various fields, we believe that RaTrav, as a general tool, can be applied to a wide group of problems, where a biosystem or a process can be represented as a complex network.</p>
  </sec>
  <sec>
    <title>Availability and requirements</title>
    <p><bold>Project name:</bold> RaTrav<bold>Project home page:</bold> http://sourceforge.net/projects/ratrav<bold>Operating system(s):</bold> Platform independent<bold>Programming language:</bold> C++<bold>Other requirements:</bold> Boost C++ Libraries (<ext-link ext-link-type="uri" xlink:href="http://www.boost.org/">http://www.boost.org/</ext-link>)<bold>License:</bold> GNU General Public License, version 3 (<ext-link ext-link-type="uri" xlink:href="http://opensource.org/licenses/GPL-3.0">http://opensource.org/licenses/GPL-3.0</ext-link>) for RaTrav. Boost Software License (<ext-link ext-link-type="uri" xlink:href="http://www.boost.org/users/license.html">http://www.boost.org/users/license.html</ext-link>) for Boost C++ Libraries.</p>
    <p>The package contains full source code, binary version of RaTrav and manual.</p>
  </sec>
  <sec>
    <title>Competing interests</title>
    <p>The authors declare that they have no conflict of interest.</p>
  </sec>
  <sec>
    <title>Authors’ contributions</title>
    <p>MT and PC designed, wrote and tested the RaTrav C++ code. MT and PC prepared the examples and generated the data. MT, PC and PB wrote the manuscript. All authors discussed the results and approved the final version of the manuscript.</p>
  </sec>
  <sec>
    <title>Authors’ information</title>
    <p>The authors wish it to be known that, in their opinion, the first two authors should be regarded as joint first authors.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material content-type="local-data" id="S1">
      <caption>
        <title>Additional file 1</title>
        <p><bold>RaTrav examples file.</bold> File containing RaTrav input and output data for the two case studies presented.</p>
      </caption>
      <media xlink:href="1752-0509-7-130-S1.zip">
        <caption>
          <p>Click here for file</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <sec>
    <title>Acknowledgements</title>
    <p>We are grateful to Raphael Chaleil for his useful comments on software development. This work was supported by Cancer Research UK and the Polish Ministry of Science and Higher Education (project N N202 180038).</p>
  </sec>
  <ref-list>
    <ref id="B1">
      <mixed-citation publication-type="book">
        <name>
          <surname>Klipp</surname>
          <given-names>E</given-names>
        </name>
        <name>
          <surname>Liebermeister</surname>
          <given-names>W</given-names>
        </name>
        <name>
          <surname>Wierling</surname>
          <given-names>C</given-names>
        </name>
        <name>
          <surname>Kowald</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Lehrach</surname>
          <given-names>H</given-names>
        </name>
        <name>
          <surname>Herwig</surname>
          <given-names>R</given-names>
        </name>
        <source>Systems Biology: A Textbook</source>
        <year>2009</year>
        <publisher-name>Weinheim: Wiley-Blackwell</publisher-name>
      </mixed-citation>
    </ref>
    <ref id="B2">
      <mixed-citation publication-type="book">
        <name>
          <surname>van Kampen</surname>
          <given-names>NG</given-names>
        </name>
        <source>Stochastic Processes in Physics and Chemistry</source>
        <year>2007</year>
        <publisher-name>Amsterdam: Elsevier B. V</publisher-name>
      </mixed-citation>
    </ref>
    <ref id="B3">
      <mixed-citation publication-type="book">
        <name>
          <surname>Gardiner</surname>
          <given-names>CW</given-names>
        </name>
        <source>Stochastic Methods: A Handbook for the Natural and Social Sciences</source>
        <year>2009</year>
        <publisher-name>Berlin: Springer</publisher-name>
      </mixed-citation>
    </ref>
    <ref id="B4">
      <mixed-citation publication-type="book">
        <name>
          <surname>Redner</surname>
          <given-names>S</given-names>
        </name>
        <source>A Guide to First-Passage Processes</source>
        <year>2001</year>
        <publisher-name>Cambridge: Cambridge University Press</publisher-name>
      </mixed-citation>
    </ref>
    <ref id="B5">
      <mixed-citation publication-type="book">
        <name>
          <surname>Berg</surname>
          <given-names>HC</given-names>
        </name>
        <source>Random Walks in Biology</source>
        <year>1993</year>
        <publisher-name>Princeton: Princeton University Press</publisher-name>
      </mixed-citation>
    </ref>
    <ref id="B6">
      <mixed-citation publication-type="book">
        <name>
          <surname>Newman</surname>
          <given-names>MEJ</given-names>
        </name>
        <source>Networks. An Introduction</source>
        <year>2010</year>
        <publisher-name>Oxford: Oxford University Press</publisher-name>
      </mixed-citation>
    </ref>
    <ref id="B7">
      <mixed-citation publication-type="book">
        <name>
          <surname>Klafter</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Sokolov</surname>
          <given-names>IM</given-names>
        </name>
        <source>First Steps in Random Walks. From Tools to Applications</source>
        <year>2011</year>
        <publisher-name>Oxford: Oxford University Press</publisher-name>
      </mixed-citation>
    </ref>
    <ref id="B8">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Condamin</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Benichou</surname>
          <given-names>O</given-names>
        </name>
        <name>
          <surname>Tejedor</surname>
          <given-names>V</given-names>
        </name>
        <name>
          <surname>Voituriez</surname>
          <given-names>R</given-names>
        </name>
        <name>
          <surname>Klafter</surname>
          <given-names>J</given-names>
        </name>
        <article-title>First-passage times in complex scale-invariant media</article-title>
        <source>Nature</source>
        <year>2007</year>
        <volume>450</volume>
        <fpage>77</fpage>
        <lpage>80</lpage>
        <pub-id pub-id-type="pmid">17972880</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B9">
      <mixed-citation publication-type="book">
        <name>
          <surname>Hill</surname>
          <given-names>TL</given-names>
        </name>
        <source>Free Energy Transduction and Biochemical Cycle Kinetics</source>
        <year>1989</year>
        <publisher-name>New York: Springer</publisher-name>
      </mixed-citation>
    </ref>
    <ref id="B10">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Krivov</surname>
          <given-names>SV</given-names>
        </name>
        <name>
          <surname>Muff</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Caflisch</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Karplus</surname>
          <given-names>M</given-names>
        </name>
        <article-title>One-dimensional barrier-preserving free-energy projections of a β-sheet miniprotein: new insights into the folding process</article-title>
        <source>J Phys Chem B</source>
        <year>2008</year>
        <volume>112</volume>
        <fpage>8701</fpage>
        <lpage>8714</lpage>
        <pub-id pub-id-type="pmid">18590307</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B11">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Kreuzer</surname>
          <given-names>SM</given-names>
        </name>
        <name>
          <surname>Moon</surname>
          <given-names>TJ</given-names>
        </name>
        <name>
          <surname>Elber</surname>
          <given-names>R</given-names>
        </name>
        <article-title>Catch bond-like kinetics of helix cracking: network analysis by molecular dynamics and milestoning</article-title>
        <source>J Chem Phys</source>
        <year>2013</year>
        <volume>139</volume>
        <fpage>121902</fpage>
        <pub-id pub-id-type="pmid">24089714</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B12">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Mohr</surname>
          <given-names>OSD</given-names>
        </name>
        <name>
          <surname>Stefanovic</surname>
          <given-names>D</given-names>
        </name>
        <article-title>First-passage properties of molecular spiders</article-title>
        <source>Phys Rev E</source>
        <year>2013</year>
        <volume>88</volume>
        <fpage>012724</fpage>
      </mixed-citation>
    </ref>
    <ref id="B13">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Hawk</surname>
          <given-names>AT</given-names>
        </name>
        <name>
          <surname>Konda</surname>
          <given-names>SSM</given-names>
        </name>
        <name>
          <surname>Makarov</surname>
          <given-names>DE</given-names>
        </name>
        <article-title>Computation of transit times using the milestoning method with applications to polymer translocation</article-title>
        <source>J Chem Phys</source>
        <year>2013</year>
        <volume>139</volume>
        <fpage>064101</fpage>
        <pub-id pub-id-type="pmid">23947837</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B14">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Asfaw</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Alvarez-Lacalle</surname>
          <given-names>E</given-names>
        </name>
        <name>
          <surname>Shiferaw</surname>
          <given-names>Y</given-names>
        </name>
        <article-title>The timing statistics of spontaneous calcium release in cardiac myocytes</article-title>
        <source>PLoS One</source>
        <year>2013</year>
        <volume>8</volume>
        <fpage>e62967</fpage>
        <pub-id pub-id-type="pmid">23690970</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B15">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Newton</surname>
          <given-names>PK</given-names>
        </name>
        <name>
          <surname>Mason</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Bethel</surname>
          <given-names>K</given-names>
        </name>
        <name>
          <surname>Bazhenova</surname>
          <given-names>L</given-names>
        </name>
        <name>
          <surname>Nieva</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Norton</surname>
          <given-names>L</given-names>
        </name>
        <name>
          <surname>Kuhn</surname>
          <given-names>P</given-names>
        </name>
        <article-title>Spreaders and sponges define metastasis in lung cancer: a Markov chain Monte Carlo mathematical model</article-title>
        <source>Cancer Res</source>
        <year>2013</year>
        <volume>73</volume>
        <fpage>2760</fpage>
        <lpage>2769</lpage>
        <pub-id pub-id-type="pmid">23447576</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B16">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Kurzynski</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Chelminiak</surname>
          <given-names>P</given-names>
        </name>
        <article-title>Temperature and detection-wavelength dependence of the electron transfer rates in initial stages of photosynthesis</article-title>
        <source>J Phys Chem B</source>
        <year>2013</year>
        <volume>117</volume>
        <fpage>12339</fpage>
        <lpage>12346</lpage>
        <pub-id pub-id-type="pmid">24000808</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B17">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Torchala</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Chelminiak</surname>
          <given-names>P</given-names>
        </name>
        <name>
          <surname>Bates</surname>
          <given-names>PA</given-names>
        </name>
        <article-title>Mean first-passage time calculations: comparison of the deterministic Hill’s algorithm with Monte Carlo simulations</article-title>
        <source>Eur Phys J B</source>
        <year>2012</year>
        <volume>85</volume>
        <fpage>116</fpage>
      </mixed-citation>
    </ref>
    <ref id="B18">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Torchala</surname>
          <given-names>M</given-names>
        </name>
        <article-title>Efficient parallel computations using MPI in chemistry and physics</article-title>
        <source>Adv Cheminform</source>
        <year>2007</year>
        <volume>1</volume>
        <fpage>21</fpage>
        <lpage>27</lpage>
      </mixed-citation>
    </ref>
    <ref id="B19">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Copeland</surname>
          <given-names>RA</given-names>
        </name>
        <article-title>Conformational adaptation in drug-target interactions and residence time</article-title>
        <source>Future Med Chem</source>
        <year>2011</year>
        <volume>3</volume>
        <fpage>1491</fpage>
        <lpage>1501</lpage>
        <pub-id pub-id-type="pmid">21882942</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B20">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Torchala</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Moal</surname>
          <given-names>IH</given-names>
        </name>
        <name>
          <surname>Chaleil</surname>
          <given-names>RAG</given-names>
        </name>
        <name>
          <surname>Fernandez-Recio</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Bates</surname>
          <given-names>PA</given-names>
        </name>
        <article-title>SwarmDock: a server for flexible protein-protein docking</article-title>
        <source>Bioinformatics</source>
        <year>2013</year>
        <volume>29</volume>
        <fpage>807</fpage>
        <lpage>809</lpage>
        <pub-id pub-id-type="pmid">23343604</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B21">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Comeau</surname>
          <given-names>SR</given-names>
        </name>
        <name>
          <surname>Gatchell</surname>
          <given-names>DW</given-names>
        </name>
        <name>
          <surname>Vajda</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Camacho</surname>
          <given-names>CJ</given-names>
        </name>
        <article-title>ClusPro: an automated docking and discrimination method for the prediction of protein complexes</article-title>
        <source>Bioinformatics</source>
        <year>2004</year>
        <volume>20</volume>
        <fpage>45</fpage>
        <lpage>50</lpage>
        <pub-id pub-id-type="pmid">14693807</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B22">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Otterbein</surname>
          <given-names>LR</given-names>
        </name>
        <name>
          <surname>Cosio</surname>
          <given-names>C</given-names>
        </name>
        <name>
          <surname>Graceffa</surname>
          <given-names>P</given-names>
        </name>
        <name>
          <surname>Dominguez</surname>
          <given-names>R</given-names>
        </name>
        <article-title>Crystal structures of the vitamin D-binding protein and its complex with actin: structural basis of the actin-scavenger system</article-title>
        <source>Proc Natl Acad Sci USA</source>
        <year>2002</year>
        <volume>99</volume>
        <fpage>8003</fpage>
        <lpage>8008</lpage>
        <pub-id pub-id-type="pmid">12048248</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B23">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Torchala</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Moal</surname>
          <given-names>IH</given-names>
        </name>
        <name>
          <surname>Chaleil</surname>
          <given-names>RAG</given-names>
        </name>
        <name>
          <surname>Agius</surname>
          <given-names>R</given-names>
        </name>
        <name>
          <surname>Bates</surname>
          <given-names>PA</given-names>
        </name>
        <article-title>A Markov-chain model description of binding funnels to enhance the ranking of docked solutions</article-title>
        <source>Proteins</source>
        <year>2013</year>
        <volume>in press</volume>
        <comment>doi: 10.1002/prot.24369</comment>
      </mixed-citation>
    </ref>
    <ref id="B24">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Lensink</surname>
          <given-names>MF</given-names>
        </name>
        <name>
          <surname>Wodak</surname>
          <given-names>SJ</given-names>
        </name>
        <article-title>Docking, scoring and affinity prediction in CAPRI</article-title>
        <source>Proteins</source>
        <year>2013</year>
        <volume>in press</volume>
        <comment>doi: 10.1002/prot.24428</comment>
      </mixed-citation>
    </ref>
    <ref id="B25">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Hwang</surname>
          <given-names>H</given-names>
        </name>
        <name>
          <surname>Vreven</surname>
          <given-names>T</given-names>
        </name>
        <name>
          <surname>Janin</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Weng</surname>
          <given-names>Z</given-names>
        </name>
        <article-title>Protein-protein docking benchmark version 4.0</article-title>
        <source>Proteins</source>
        <year>2010</year>
        <volume>78</volume>
        <fpage>3111</fpage>
        <lpage>3114</lpage>
        <pub-id pub-id-type="pmid">20806234</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B26">
      <mixed-citation publication-type="book">
        <name>
          <surname>Bastian</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Heymann</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Jacomy</surname>
          <given-names>M</given-names>
        </name>
        <article-title>Gephi: an open source software for exploring and manipulating networks</article-title>
        <source>International AAAI Conference on Weblogs and Social Media</source>
        <year>2009</year>
        <publisher-name>San Jose, California: AAAI Publications</publisher-name>
        <fpage>361</fpage>
        <lpage>362</lpage>
      </mixed-citation>
    </ref>
    <ref id="B27">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Lu</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Dousis</surname>
          <given-names>AD</given-names>
        </name>
        <name>
          <surname>Ma</surname>
          <given-names>J</given-names>
        </name>
        <article-title>OPUS-PSP: an orientation-dependent statistical all-atom potential derived from side-chain packing</article-title>
        <source>J Mol Biol</source>
        <year>2008</year>
        <volume>376</volume>
        <fpage>288</fpage>
        <lpage>301</lpage>
        <pub-id pub-id-type="pmid">18177896</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B28">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Dijkstra</surname>
          <given-names>EW</given-names>
        </name>
        <article-title>A note on two problems in connexion with graphs</article-title>
        <source>Numer Math</source>
        <year>1959</year>
        <volume>1</volume>
        <fpage>269</fpage>
        <lpage>271</lpage>
      </mixed-citation>
    </ref>
    <ref id="B29">
      <mixed-citation publication-type="book">
        <name>
          <surname>Kurzynski</surname>
          <given-names>M</given-names>
        </name>
        <source>The Thermodynamic Machinery of Life</source>
        <year>2006</year>
        <publisher-name>Berlin: Springer-Verlag</publisher-name>
      </mixed-citation>
    </ref>
    <ref id="B30">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Kurzynski</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Chelminiak</surname>
          <given-names>P</given-names>
        </name>
        <article-title>Mean first-passage time in the stochastic theory of biochemical processes. Application to actomyosin molecular motor</article-title>
        <source>J Stat Phys</source>
        <year>2003</year>
        <volume>110</volume>
        <fpage>137</fpage>
        <lpage>181</lpage>
      </mixed-citation>
    </ref>
    <ref id="B31">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Song</surname>
          <given-names>C</given-names>
        </name>
        <name>
          <surname>Havlin</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Makse</surname>
          <given-names>HA</given-names>
        </name>
        <article-title>Origins of fractality in the growth of complex networks</article-title>
        <source>Nature</source>
        <year>2006</year>
        <volume>2</volume>
        <fpage>275</fpage>
        <lpage>281</lpage>
      </mixed-citation>
    </ref>
  </ref-list>
</back>
