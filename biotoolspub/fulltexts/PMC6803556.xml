<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD Journal Publishing DTD v2.3 20070202//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName journalpublishing.dtd?>
<?SourceDTD.Version 2.3?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Front Neuroinform</journal-id>
    <journal-id journal-id-type="iso-abbrev">Front Neuroinform</journal-id>
    <journal-id journal-id-type="publisher-id">Front. Neuroinform.</journal-id>
    <journal-title-group>
      <journal-title>Frontiers in Neuroinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1662-5196</issn>
    <publisher>
      <publisher-name>Frontiers Media S.A.</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">6803556</article-id>
    <article-id pub-id-type="doi">10.3389/fninf.2019.00064</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Neuroscience</subject>
        <subj-group>
          <subject>Original Research</subject>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>The Dmipy Toolbox: Diffusion MRI Multi-Compartment Modeling and Microstructure Recovery Made Easy</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Fick</surname>
          <given-names>Rutger H. J.</given-names>
        </name>
        <xref ref-type="aff" rid="aff1">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="aff2">
          <sup>2</sup>
        </xref>
        <xref ref-type="corresp" rid="c001">
          <sup>*</sup>
        </xref>
        <uri xlink:type="simple" xlink:href="http://loop.frontiersin.org/people/732520/overview"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Wassermann</surname>
          <given-names>Demian</given-names>
        </name>
        <xref ref-type="aff" rid="aff3">
          <sup>3</sup>
        </xref>
        <uri xlink:type="simple" xlink:href="http://loop.frontiersin.org/people/52941/overview"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Deriche</surname>
          <given-names>Rachid</given-names>
        </name>
        <xref ref-type="aff" rid="aff2">
          <sup>2</sup>
        </xref>
        <uri xlink:type="simple" xlink:href="http://loop.frontiersin.org/people/813343/overview"/>
      </contrib>
    </contrib-group>
    <aff id="aff1"><sup>1</sup><institution>TheraPanacea</institution>, <addr-line>Paris</addr-line>, <country>France</country></aff>
    <aff id="aff2"><sup>2</sup><institution>Inria Sophia Antipolis-Méditerranée, Université Côte d'Azur</institution>, <addr-line>Sophia Antipolis</addr-line>, <country>France</country></aff>
    <aff id="aff3"><sup>3</sup><institution>INRIA, CEA, Université Paris-Saclay</institution>, <addr-line>Paris</addr-line>, <country>France</country></aff>
    <author-notes>
      <fn fn-type="edited-by">
        <p>Edited by: Ludovico Minati, Tokyo Institute of Technology, Japan</p>
      </fn>
      <fn fn-type="edited-by">
        <p>Reviewed by: Mara Cercignani, Brighton and Sussex Medical School, United Kingdom; Władysław Piotr Weglarz, Institute of Nuclear Physics (PAN), Poland</p>
      </fn>
      <corresp id="c001">*Correspondence: Rutger H. J. Fick <email>fick.rutger@gmail.com</email></corresp>
    </author-notes>
    <pub-date pub-type="epub">
      <day>15</day>
      <month>10</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2019</year>
    </pub-date>
    <volume>13</volume>
    <elocation-id>64</elocation-id>
    <history>
      <date date-type="received">
        <day>21</day>
        <month>6</month>
        <year>2019</year>
      </date>
      <date date-type="accepted">
        <day>04</day>
        <month>9</month>
        <year>2019</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>Copyright © 2019 Fick, Wassermann and Deriche.</copyright-statement>
      <copyright-year>2019</copyright-year>
      <copyright-holder>Fick, Wassermann and Deriche</copyright-holder>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open-access article distributed under the terms of the Creative Commons Attribution License (CC BY). The use, distribution or reproduction in other forums is permitted, provided the original author(s) and the copyright owner(s) are credited and that the original publication in this journal is cited, in accordance with accepted academic practice. No use, distribution or reproduction is permitted which does not comply with these terms.</license-p>
      </license>
    </permissions>
    <abstract>
      <p>Non-invasive estimation of brain microstructure features using diffusion MRI (dMRI)—known as Microstructure Imaging—has become an increasingly diverse and complicated field over the last decades. Multi-compartment (MC)-models, representing the measured diffusion signal as a linear combination of signal models of distinct tissue types, have been developed in many forms to estimate these features. However, a generalized implementation of MC-modeling as a whole, providing deeper insights in its capabilities, remains missing. To address this fact, we present Diffusion Microstructure Imaging in Python (Dmipy), an open-source toolbox implementing PGSE-based MC-modeling in its most general form. Dmipy allows on-the-fly implementation, signal modeling, and optimization of any user-defined MC-model, for any PGSE acquisition scheme. Dmipy follows a “building block”-based philosophy to Microstructure Imaging, meaning MC-models are modularly constructed to include any number and type of tissue models, allowing simultaneous representation of a tissue's diffusivity, orientation, volume fractions, axon orientation dispersion, and axon diameter distribution. In particular, Dmipy is geared toward facilitating reproducible, reliable MC-modeling pipelines, often allowing the whole process from model construction to parameter map recovery in fewer than 10 lines of code. To demonstrate Dmipy's ease of use and potential, we implement a wide range of well-known MC-models, including IVIM, AxCaliber, NODDI(x), Bingham-NODDI, the spherical mean-based SMT and MC-MDI, and spherical convolution-based single- and multi-tissue CSD. By allowing parameter cascading between MC-models, Dmipy also facilitates implementation of advanced approaches like CSD with voxel-varying kernels and single-shell 3-tissue CSD. By providing a well-tested, user-friendly toolbox that simplifies the interaction with the otherwise complicated field of dMRI-based Microstructure Imaging, Dmipy contributes to more reproducible, high-quality research.</p>
    </abstract>
    <kwd-group>
      <kwd>diffusion MRI</kwd>
      <kwd>multi-compartment modeling</kwd>
      <kwd>microstructure estimation</kwd>
      <kwd>reproducible research</kwd>
      <kwd>neuroimaging</kwd>
      <kwd>optimization</kwd>
      <kwd>open-source</kwd>
      <kwd>PGSE</kwd>
    </kwd-group>
    <counts>
      <fig-count count="9"/>
      <table-count count="3"/>
      <equation-count count="29"/>
      <ref-count count="83"/>
      <page-count count="26"/>
      <word-count count="14464"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec sec-type="intro" id="s1">
    <title>1. Introduction</title>
    <p>For over three decades, multi-compartment (MC) modeling has played a major role in driving diffusion MRI (dMRI)-based microstructure research. It has enabled breakthroughs in our understanding of the orientation of white matter pathways in the brain (e.g., Basser et al., <xref rid="B8" ref-type="bibr">1994</xref>; Behrens et al., <xref rid="B9" ref-type="bibr">2003</xref>; Tournier et al., <xref rid="B72" ref-type="bibr">2007</xref>), axon bundle dispersion (e.g., Kaden et al., <xref rid="B43" ref-type="bibr">2007</xref>; Zhang et al., <xref rid="B83" ref-type="bibr">2012</xref>), axon diameter (e.g., Assaf et al., <xref rid="B4" ref-type="bibr">2008</xref>), extra-axonal diffusivity (e.g., Novikov et al., <xref rid="B58" ref-type="bibr">2018</xref>), and tumor composition (e.g., Le Bihan et al., <xref rid="B47" ref-type="bibr">1988</xref>; Panagiotaki et al., <xref rid="B62" ref-type="bibr">2014</xref>). Importantly, in all these works, the valid interpretation of estimated model parameters with respect to tissue composition always hinges on:</p>
    <list list-type="bullet">
      <list-item>
        <p>The appropriateness of the MC-model composition in terms of <italic>biophysical models</italic> for the tissue of interest (Panagiotaki et al., <xref rid="B61" ref-type="bibr">2012</xref>; Ferizi et al., <xref rid="B29" ref-type="bibr">2016</xref>);</p>
      </list-item>
      <list-item>
        <p>The sensitivity of the dMRI acquisition to the tissue feature of interest (Ning et al., <xref rid="B56" ref-type="bibr">2015</xref>);</p>
      </list-item>
      <list-item>
        <p>The specificity of the MC-model's parameters to the tissue feature of interest (Jelescu et al., <xref rid="B39" ref-type="bibr">2016</xref>);</p>
      </list-item>
      <list-item>
        <p>Given an MC-model, the robustness and accuracy of the optimization approach that estimates the model parameters from the measured data (Harms et al., <xref rid="B37" ref-type="bibr">2017</xref>; Canales-Rodríguez et al., <xref rid="B14" ref-type="bibr">2019</xref>).</p>
      </list-item>
    </list>
    <p>To leverage and showcase the reproducibility of published works, several platforms have released <italic>application-specific</italic> toolboxes for particular MC-model implementations. Well-known examples are UCL's collected works on MC-based microstructure estimation (Cook et al., <xref rid="B17" ref-type="bibr">2006</xref>)<xref ref-type="fn" rid="fn0001"><sup>1</sup></xref>, MRtrix's works aimed at fiber tractography (Tournier et al., <xref rid="B73" ref-type="bibr">2012</xref>)<xref ref-type="fn" rid="fn0002"><sup>2</sup></xref>, and Dipy's wide variety of dMRI-based signal models (Garyfallidis et al., <xref rid="B33" ref-type="bibr">2014</xref>)<xref ref-type="fn" rid="fn0003"><sup>3</sup></xref>. While valuable, static implementations of MC-models are limited in that they cannot be easily adjusted for use case specific tissue configurations, data acquisitions, or desired optimization algorithms. On the other hand, implementing your own MC-modeling approach from scratch requires non-trivial knowledge of computer science and optimization theory, often leaving the user no choice but to use what is available.</p>
    <p>Dmipy (<italic>Diffusion Microstructure Imaging in Python</italic>) is an open-source software solution based on the idea that MC-modeling—and all that involves—should be transparent, reproducible, and most of all <italic>easy</italic>. To this end, Dmipy facilitates the on-the-fly design, optimization and analysis of custom MC-models for any PGSE-based dMRI acquisition. Dmipy enables having only high-level interaction with model design and parameter recovery, which in turn highly simplifies the implementation of complex state-of-the-art MC-models. In fact, most MC-models in literature can be reproduced in around 10 lines of code, which we demonstrate in this work for IVIM (Le Bihan et al., <xref rid="B47" ref-type="bibr">1988</xref>), ActiveAx (Alexander et al., <xref rid="B3" ref-type="bibr">2010</xref>), AxCaliber (Assaf and Pasternak, <xref rid="B6" ref-type="bibr">2008</xref>), Ball and Stick (Behrens et al., <xref rid="B9" ref-type="bibr">2003</xref>), NODDI(-x) (Zhang et al., <xref rid="B83" ref-type="bibr">2012</xref>), NODDI-Bingham (Tariq et al., <xref rid="B70" ref-type="bibr">2016</xref>), MC-MDI (Kaden et al., <xref rid="B42" ref-type="bibr">2016</xref>), Multi-Tissue CSD (Jeurissen et al., <xref rid="B40" ref-type="bibr">2014</xref>), and Single-Shell Multi-Tissue CSD (Dhollander and Connelly, <xref rid="B22" ref-type="bibr">2016</xref>).</p>
    <p>We provide the graphical abstract Dmipy in <xref ref-type="fig" rid="F1">Figure 1</xref>. Dmipy's design is based on the observation that one can view different formulations biophysical models as “building blocks,” which could be assembled in any combination, and whose meaning can change depending on the application (e.g., Panagiotaki et al., <xref rid="B61" ref-type="bibr">2012</xref>; Fick, <xref rid="B30" ref-type="bibr">2017</xref>). This is despite the fact that the individual tissue models, such as various approximations of restricted geometries like cylinders and spheres (e.g., Balinov et al., <xref rid="B7" ref-type="bibr">1993</xref>; Vangelderen et al., <xref rid="B78" ref-type="bibr">1994</xref>; Callaghan, <xref rid="B13" ref-type="bibr">1995</xref>), can have quite complex mathematical formulations. To some extent, several open-source solutions have already taken advantage of this observation for applications such as modular signal generation with generalized acquisition parameters in MISST (Ianuş et al., <xref rid="B38" ref-type="bibr">2016</xref>), or GPU-accelerated model generation and optimization in MDT (Harms et al., <xref rid="B37" ref-type="bibr">2017</xref>).</p>
    <fig id="F1" position="float">
      <label>Figure 1</label>
      <caption>
        <p>Dmipy workflow: Modular microstructure model setup and parameter estimation. Different biophysical tissue models (see <xref ref-type="fig" rid="F3">Figure 3</xref>) are dispersed and/or distributed and combined together in a multi-compartment model, which is then fit to diffusion data using a chosen optimization algorithm to estimate tissue feature parameters, reconstruct FODs, and quantify the quality of the fitting.</p>
      </caption>
      <graphic xlink:href="fninf-13-00064-g0001"/>
    </fig>
    <p>In this work, however, we observe that this notion of modularity goes much further than previously explored, and includes alternative dMRI representation frameworks such as the multi-compartment <italic>spherical mean</italic> (MC-SM) models (e.g., Kaden et al., <xref rid="B44" ref-type="bibr">2015</xref>) and multi-compartment <italic>spherical harmonics</italic> (MC-SH) models (e.g., Jeurissen et al., <xref rid="B40" ref-type="bibr">2014</xref>). As a consequence, this also implies the generalization of optimization strategies that have been specifically proposed for fitting the dMRI signal, such as Microstructure Imaging in Crossings (MIX) (Farooq et al., <xref rid="B27" ref-type="bibr">2016</xref>), and multi-tissue CSD (Jeurissen et al., <xref rid="B40" ref-type="bibr">2014</xref>), to any MC-model composition. In particular, by generalizing MC, MC-SM, and MC-SH models to use the same biophysical models, it becomes natural to start exploring <italic>cross-MC-modeling</italic> approaches, where one set of parameters is estimated in one framework and then used to initiate the optimization in another framework or model composition (e.g., Nath et al., <xref rid="B54" ref-type="bibr">2019</xref>; Pizzolato et al., <xref rid="B64" ref-type="bibr">2018</xref>).</p>
    <p>In Dmipy, we take this “building-block”-based philosophy on MC-modeling to the next level, and have implemented a “model-agnostic” MC-model-generation and estimation framework that can:</p>
    <list list-type="bullet">
      <list-item>
        <p>Assemble any combination of biophysical models into any of these three MC-model frameworks on-the-fly;</p>
      </list-item>
      <list-item>
        <p>Add parametric and non-parametric parameter distributions to model <italic>axon orientation dispersion</italic> and/or <italic>axon diameter distribution</italic> effects for any appropriate tissue model;</p>
      </list-item>
      <list-item>
        <p>Impose any predefined or custom parameter constraints or relations;</p>
      </list-item>
      <list-item>
        <p>Optimize models using generalized, open-source implementations of various optimization strategies;</p>
      </list-item>
      <list-item>
        <p>Simulate the signal and estimate parameters from any user-defined PGSE-dMRI acquisition, varying over gradient strengths (multi-shell), diffusion times, and echo times.</p>
      </list-item>
    </list>
    <p>Dmipy is freely available under open-source MIT license at <ext-link ext-link-type="uri" xlink:href="https://github.com/AthenaEPI/dmipy">https://github.com/AthenaEPI/dmipy</ext-link>, where detailed tutorials and implementations of many MC-models in literature are provided in the form of Jupyter Notebooks. As for dependencies, Dmipy's dynamic modeling design is based on numpy (Oliphant, <xref rid="B59" ref-type="bibr">2006</xref>), non-linear optimization on scipy (Jones et al., <xref rid="B41" ref-type="bibr">2001</xref>), convex optimization on cvxpy (Diamond and Boyd, <xref rid="B24" ref-type="bibr">2016</xref>; Agrawal et al., <xref rid="B2" ref-type="bibr">2018</xref>) and for signal-based subroutines (e.g., DTI) and visualization we use dipy (Garyfallidis et al., <xref rid="B33" ref-type="bibr">2014</xref>). As optional dependencies, we speed up code use Numba's just-in-time compilation (Lam et al., <xref rid="B45" ref-type="bibr">2015</xref>), and allow multi-core CPU processing using pathos (McKerns et al., <xref rid="B50" ref-type="bibr">2012</xref>).</p>
    <p>The structure of this paper is as follows: in section 2, we explain the theory and basic interaction behind generalizing MC-modeling over the three modeling frameworks, for any PGSE acquisition scheme and biophysical model composition. In particular, we provide Dmipy's technical aspects and workflow, explaining how the generalized signal simulation, parameter linking and optimization can be used. In section 3 we then show Dmipy in action, implementing, and demonstrating various state-of-the-art MC-modeling approaches. Finally, we discuss Dmipy's contribution to dMRI microstructure imaging and further opportunities in section 4, and provide concluding remarks in section 5.</p>
  </sec>
  <sec id="s2">
    <title>2. Theory and Implementation</title>
    <p>The goal of the Dmipy framework is to allow for the natural, generalized implementation of MC-based microstructure recovery, based on the PGSE-dMRI sequence. In this section, we explain both the theory of MC-modeling and how it is implemented in Dmipy. Note, however, that we only consider the analytic description of any algorithms we introduce, leaving the numerical implementation for the <xref ref-type="supplementary-material" rid="SM1">Supplementary Material</xref>. As this section describes and implements a considerably large part of the literature, we provide a table of contents in <xref rid="T1" ref-type="table">Table 1</xref>.</p>
    <table-wrap id="T1" position="float">
      <label>Table 1</label>
      <caption>
        <p>Table of contents of sections.</p>
      </caption>
      <table frame="hsides" rules="groups">
        <thead>
          <tr>
            <th valign="top" align="left" rowspan="1" colspan="1">
              <bold>Section description</bold>
            </th>
            <th valign="top" align="center" rowspan="1" colspan="1">
              <bold>Section</bold>
            </th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td valign="top" align="left" rowspan="1" colspan="1">PGSE Diffusion Contrast</td>
            <td valign="top" align="center" rowspan="1" colspan="1">2.1</td>
          </tr>
          <tr>
            <td valign="top" align="left" rowspan="1" colspan="1">DmipyAcquisitionScheme</td>
            <td valign="top" align="center" rowspan="1" colspan="1">2.2</td>
          </tr>
          <tr>
            <td valign="top" align="left" rowspan="1" colspan="1">Multi-Compartment Modeling</td>
            <td valign="top" align="center" rowspan="1" colspan="1">2.3</td>
          </tr>
          <tr>
            <td valign="top" align="left" rowspan="1" colspan="1">Generalized 3D Signal Representations</td>
            <td valign="top" align="center" rowspan="1" colspan="1">2.4</td>
          </tr>
          <tr>
            <td valign="top" align="left" rowspan="1" colspan="1">Microscopic Compartment Models</td>
            <td valign="top" align="center" rowspan="1" colspan="1">2.5</td>
          </tr>
          <tr>
            <td valign="top" align="left" rowspan="1" colspan="1">Gaussian Compartment Models</td>
            <td valign="top" align="center" rowspan="1" colspan="1">2.5.1</td>
          </tr>
          <tr>
            <td valign="top" align="left" rowspan="1" colspan="1">Restricted CompartmentModels</td>
            <td valign="top" align="center" rowspan="1" colspan="1">2.5.2</td>
          </tr>
          <tr>
            <td valign="top" align="left" rowspan="1" colspan="1">Macroscopic Distibuted Models</td>
            <td valign="top" align="center" rowspan="1" colspan="1">2.6</td>
          </tr>
          <tr>
            <td valign="top" align="left" rowspan="1" colspan="1">Parameter Distributed Models</td>
            <td valign="top" align="center" rowspan="1" colspan="1">2.6.1</td>
          </tr>
          <tr>
            <td valign="top" align="left" rowspan="1" colspan="1">Spherical Distributed Models</td>
            <td valign="top" align="center" rowspan="1" colspan="1">2.6.2</td>
          </tr>
          <tr>
            <td valign="top" align="left" rowspan="1" colspan="1">Tissue Response Models</td>
            <td valign="top" align="center" rowspan="1" colspan="1">2.6.3</td>
          </tr>
          <tr>
            <td valign="top" align="left" rowspan="1" colspan="1">Multi-Compartment Model Variants</td>
            <td valign="top" align="center" rowspan="1" colspan="1">2.7</td>
          </tr>
          <tr>
            <td valign="top" align="left" rowspan="1" colspan="1">Multi-Compartment Spherical Mean</td>
            <td valign="top" align="center" rowspan="1" colspan="1">2.7.1</td>
          </tr>
          <tr>
            <td valign="top" align="left" rowspan="1" colspan="1">Multi-Compartment Spherical Harmonics</td>
            <td valign="top" align="center" rowspan="1" colspan="1">2.7.2</td>
          </tr>
          <tr>
            <td valign="top" align="left" rowspan="1" colspan="1">Parameter Linking</td>
            <td valign="top" align="center" rowspan="1" colspan="1">2.8</td>
          </tr>
          <tr>
            <td valign="top" align="left" rowspan="1" colspan="1">Generalized Optimization</td>
            <td valign="top" align="center" rowspan="1" colspan="1">2.9</td>
          </tr>
          <tr>
            <td valign="top" align="left" rowspan="1" colspan="1">Optimizing MC and MC-SM Models</td>
            <td valign="top" align="center" rowspan="1" colspan="1">2.9.1</td>
          </tr>
          <tr>
            <td valign="top" align="left" rowspan="1" colspan="1">Optimizing MC-SH Models</td>
            <td valign="top" align="center" rowspan="1" colspan="1">2.9.2</td>
          </tr>
          <tr>
            <td valign="top" align="left" rowspan="1" colspan="1">Fitting the Signal: Multi-tissue modeling</td>
            <td valign="top" align="center" rowspan="1" colspan="1">2.9.3</td>
          </tr>
        </tbody>
      </table>
    </table-wrap>
    <sec>
      <title>2.1. PGSE Diffusion Contrast</title>
      <p>In this work, we focus on probing the tissue microstructure using the standard Pulsed Gradient Spin-Echo sequence (PGSE) to obtain diffusion-weighted images (DWIs) (Stejskal, <xref rid="B67" ref-type="bibr">1965</xref>). We provide a schematic representation of a PGSE sequence in <xref ref-type="fig" rid="F2">Figure 2A</xref>. To summarize, a diffusion-weighted measurement at position <bold>x</bold> ∈ ℝ<sup>3</sup> is obtained by first applying a 90° radio-frequency pulse, after which two sensitizing diffusion gradients of pulse length δ [s], gradient strength <italic>G</italic> [T/m], and separated by separation time Δ [s], are applied to the tissue along orientation <bold>n</bold> ∈ 𝕊<sup>2</sup>. In between the two pulses, at half the Echo Time (TE), a 180° pulse is applied, resulting in a measurable spin echo signal at TE. The PGSE sequence is sensitive to diffusion in that the measured signal attenuates proportionately to the average particle motion along <bold>n</bold> in between the two gradient pulses. More precisely, in three dimensions, the signal attenuation for a PGSE sequence is given by <inline-formula><mml:math id="M1"><mml:mi>E</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>b</mml:mi><mml:mo>,</mml:mo><mml:mstyle class="text"><mml:mtext mathvariant="bold">n</mml:mtext></mml:mstyle></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mo class="qopname">exp</mml:mo><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:mo>-</mml:mo><mml:mi>b</mml:mi><mml:msup><mml:mrow><mml:mstyle class="text"><mml:mtext mathvariant="bold">n</mml:mtext></mml:mstyle></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:msub><mml:mrow><mml:mstyle class="text"><mml:mtext mathvariant="bold">D</mml:mtext></mml:mstyle></mml:mrow><mml:mrow><mml:mstyle class="text"><mml:mtext class="textrm" mathvariant="normal">app</mml:mtext></mml:mstyle></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mstyle class="text"><mml:mtext mathvariant="bold">n</mml:mtext></mml:mstyle></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:math></inline-formula>, where <inline-formula><mml:math id="M2"><mml:msub><mml:mrow><mml:mstyle class="text"><mml:mtext mathvariant="bold">D</mml:mtext></mml:mstyle></mml:mrow><mml:mrow><mml:mstyle class="text"><mml:mtext class="textrm" mathvariant="normal">app</mml:mtext></mml:mstyle></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi>ℝ</mml:mi></mml:mrow><mml:mrow><mml:mn>3</mml:mn><mml:mo>×</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msup></mml:math></inline-formula> [m<sup>2</sup>/<italic>s</italic>] is the <italic>apparent</italic> diffusion tensor at diffusion time τ = Δ − δ/3 [s], and <italic>b</italic> = <italic>G</italic><sup>2</sup>δ<sup>2</sup>γ<sup>2</sup>(Δ − δ/3) [s/m<sup>2</sup>] is the clinically used b-value with nuclear gyromagnetic ratio γ [s<sup>−1</sup>T<sup>−1</sup>] (Le Bihan et al., <xref rid="B48" ref-type="bibr">1986</xref>; Minati and Węglarz, <xref rid="B51" ref-type="bibr">2007</xref>). From these parameters, the q-value is also written as <italic>q</italic> = (<italic>Gδγ</italic>)/(2π) [m<sup>−1</sup>] (Callaghan, <xref rid="B13" ref-type="bibr">1995</xref>).</p>
      <fig id="F2" position="float">
        <label>Figure 2</label>
        <caption>
          <p><bold>(A)</bold> A schematic representation of a Pulsed-Gradient Spin Echo (PGSE) sequence, and <bold>(B)</bold> illustrates the whole-brain diffusion contrasts in a four-dimensional, spatio-temporal PGSE acquisition, varying over gradient strength, gradient direction, and diffusion time. Notice that depending on the tissue configuration, different acquisition parameter combinations result in different image contrasts.</p>
        </caption>
        <graphic xlink:href="fninf-13-00064-g0002"/>
      </fig>
      <p>Measuring the PGSE signal at multiple acquisition parameter combinations provides information on different tissue properties; a single-shell acquisitions (only varying <bold>n</bold>) allows to estimate tissue orientation (Basser et al., <xref rid="B8" ref-type="bibr">1994</xref>; Tuch, <xref rid="B76" ref-type="bibr">2004</xref>; Tournier et al., <xref rid="B72" ref-type="bibr">2007</xref>); multi-shell (varying <bold>n</bold>, <italic>G</italic>) allows to delineate the signal contribution of multiple tissue compartments and axon orientation dispersion (Wu and Alexander, <xref rid="B81" ref-type="bibr">2007</xref>; Zhang et al., <xref rid="B83" ref-type="bibr">2012</xref>); multi-diffusion time (varying <italic>G</italic>, δ, Δ) allows to estimate e.g., axon diameter distributions (Assaf et al., <xref rid="B4" ref-type="bibr">2008</xref>; De Santis et al., <xref rid="B19" ref-type="bibr">2016</xref>); and multi-Echo Time (TE) is needed to recover myelin content in white matter (Whittall and MacKay, <xref rid="B80" ref-type="bibr">1989</xref>). We illustrate the DWI diffusion contrast in a coronal brain slice over varying <bold>n</bold>, <italic>G</italic>, Δ in <xref ref-type="fig" rid="F2">Figure 2B</xref>.</p>
      <p>Given the PGSE acquisition parameters, the measured signal <italic>S</italic> is separable in terms of its non-diffusion weighted signal intensity <italic>S</italic><sub>0</sub> when <italic>G</italic> = 0, and the signal <italic>attenuation</italic>
<italic>E</italic> when <italic>G</italic> &gt; 0, such that</p>
      <disp-formula id="E1">
        <label>(1)</label>
        <mml:math id="M3">
          <mml:mtable class="eqnarray" columnalign="right center left">
            <mml:mtr>
              <mml:mtd>
                <mml:mi>S</mml:mi>
                <mml:mrow>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:mrow>
                    <mml:mstyle mathvariant="bold">
                      <mml:mtext>x</mml:mtext>
                    </mml:mstyle>
                    <mml:mo>,</mml:mo>
                    <mml:mi>G</mml:mi>
                    <mml:mo>,</mml:mo>
                    <mml:mstyle mathvariant="bold">
                      <mml:mtext>n</mml:mtext>
                    </mml:mstyle>
                    <mml:mo>,</mml:mo>
                    <mml:mo>Δ</mml:mo>
                    <mml:mo>,</mml:mo>
                    <mml:mi>δ</mml:mi>
                    <mml:mo>,</mml:mo>
                    <mml:mi>T</mml:mi>
                    <mml:mi>E</mml:mi>
                  </mml:mrow>
                  <mml:mo stretchy="false">)</mml:mo>
                </mml:mrow>
                <mml:mo>=</mml:mo>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>S</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mn>0</mml:mn>
                  </mml:mrow>
                </mml:msub>
                <mml:mrow>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:mrow>
                    <mml:mstyle mathvariant="bold">
                      <mml:mtext>x</mml:mtext>
                    </mml:mstyle>
                    <mml:mo>,</mml:mo>
                    <mml:mi>T</mml:mi>
                    <mml:mi>E</mml:mi>
                  </mml:mrow>
                  <mml:mo stretchy="false">)</mml:mo>
                </mml:mrow>
                <mml:mo>·</mml:mo>
                <mml:mi>E</mml:mi>
                <mml:mrow>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:mrow>
                    <mml:mstyle mathvariant="bold">
                      <mml:mtext>x</mml:mtext>
                    </mml:mstyle>
                    <mml:mo>,</mml:mo>
                    <mml:mi>G</mml:mi>
                    <mml:mo>,</mml:mo>
                    <mml:mstyle mathvariant="bold">
                      <mml:mtext>n</mml:mtext>
                    </mml:mstyle>
                    <mml:mo>,</mml:mo>
                    <mml:mo>Δ</mml:mo>
                    <mml:mo>,</mml:mo>
                    <mml:mi>δ</mml:mi>
                  </mml:mrow>
                  <mml:mo stretchy="false">)</mml:mo>
                </mml:mrow>
                <mml:mo>.</mml:mo>
              </mml:mtd>
            </mml:mtr>
          </mml:mtable>
        </mml:math>
      </disp-formula>
      <p>Notice that at any position <bold>x</bold> the signal amplitude <italic>S</italic><sub>0</sub> is only dependent on <italic>TE</italic>, and the signal's shape <italic>E</italic> is dependent on all other parameters except <italic>TE</italic>.</p>
    </sec>
    <sec>
      <title>2.2. Representing Any PGSE Acquisition Using a DmipyAcquisitionScheme</title>
      <p>To allow Dmipy to interact with any PGSE acquisition scheme, the DmipyAcquisitionScheme module takes the raw PGSE acquisition scheme parameters and prepares them to be used for signal generation. A DmipyAcquisitionScheme can be instantiated in three ways:</p>
      <list list-type="bullet">
        <list-item>
          <p>For clinical data, using b-values [<italic>s</italic><sup>2</sup>/<italic>m</italic>] and gradient directions (and optionally δ/Δ/TE [<italic>s</italic>]);</p>
        </list-item>
        <list-item>
          <p>Using G [<italic>T</italic>/<italic>m</italic>], gradient directions, δ and Δ (and optionally TE);</p>
        </list-item>
        <list-item>
          <p>Using q [<italic>m</italic><sup>−1</sup>], gradient directions, δ and Δ (and optionally TE).</p>
        </list-item>
      </list>
      <p>We show how to create a scheme for a clinical acquisition in python Snippet 1. Notice that pulse duration, pulse separation, and TE can be given as a single number (it does not change throughout the acquisition), or an array the same size as b-values, potentially changing for every single measurement. Once the scheme is created, a summary can be generated indicating the total number of measurements, shells, b0-measurements, and a shell-wise description of the acquisition parameters. Measurements are automatically separated into distinct acquisition shells using a simple linkage clustering algorithm (Müllner, <xref rid="B53" ref-type="bibr">2011</xref>), which clusters measurements that are closer together than a certain distance in <italic>b</italic>-space. Measurements having different δ/Δ/<italic>TE</italic> are clustered separately, ensuring measurements with similar <italic>b</italic>-value but different times are never combined into one shell.</p>
      <table-wrap id="d35e979" position="float">
        <label>Snippet 1</label>
        <caption>
          <p>Typical DmipyAcquisitionScheme creation using b-values, gradient orientations as 3D unit vectors, and optional single-value or arrays of pulse durations δ, pulse separations Δ and TEs. The DmipyAcquisitionScheme handles all interactions with the fixed acquisition parameters, meaning we only need to focus on CompartmentModel parameters afterwards. Notice that the printed acquisition information is not in SI units to avoid too small or large numbers, but the input must always be given in SI units.</p>
        </caption>
        <graphic xlink:href="fninf-13-00064-i0001"/>
      </table-wrap>
      <p>To facilitate the notation of separate DWIs per acquisition shell, let us denote the sampled acquisition scheme parameters as <bold>A</bold> = {[<italic>b</italic><sub><italic>i,s</italic></sub>, <italic>G</italic><sub><italic>i,s</italic></sub>, <bold>n</bold><sub><italic>i,s</italic></sub>, δ<sub><italic>i,s</italic></sub>, Δ<sub><italic>i,s</italic></sub>, <italic>TE</italic><sub><italic>i,s</italic></sub>]}. Here, we used double linear indexing <italic>i,s</italic>, such that <italic>s</italic> = 1, 2, …, <italic>N</italic><sub>shells</sub> is the acquisition shell index with <italic>N</italic><sub>shells</sub> the number of shells, and <italic>i</italic> = 1, 2, …, <italic>N</italic><sub>DWI</sub>[<italic>s</italic>] is the DWI index with <italic>N</italic><sub>DWI</sub>[<italic>s</italic>] the number of DWIs for shell <italic>s</italic>. We will also use a <italic>shell-wise</italic> acquisition scheme <bold>A</bold><sub><italic>s</italic></sub> = {[<italic>b</italic><sub><italic>s</italic></sub>, <italic>G</italic><sub><italic>s</italic></sub>, δ<sub><italic>s</italic></sub>, Δ<sub><italic>s</italic></sub>, <italic>TE</italic><sub><italic>s</italic></sub>]} that omits the gradient directions of that shell <bold>n</bold><sub><italic>s</italic></sub>, and only contains the unique values of the other parameters for each shell.</p>
    </sec>
    <sec>
      <title>2.3. Anatomy of dMRI Multi-Compartment Modeling</title>
      <p>To recover information on the tissue microstructure, the attenuation of the signal must first be explained in terms of the underlying diffusion process—the Ensemble Average Propagator (EAP). Using the <italic>short gradient pulse</italic> approximation (SGP), i.e., assuming that no diffusion takes place during the gradient pulse (δ → 0), the relation between the signal attenuation and the EAP is given by a Fourier transform (Stejskal, <xref rid="B67" ref-type="bibr">1965</xref>). This transforms Equation (1) into</p>
      <disp-formula id="E2">
        <label>(2)</label>
        <mml:math id="M4">
          <mml:mtable class="eqnarray" columnalign="right center left">
            <mml:mtr>
              <mml:mtd>
                <mml:mi>E</mml:mi>
                <mml:mrow>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:mrow>
                    <mml:mstyle mathvariant="bold">
                      <mml:mtext>x</mml:mtext>
                    </mml:mstyle>
                    <mml:mo>,</mml:mo>
                    <mml:mstyle mathvariant="bold">
                      <mml:mtext>A</mml:mtext>
                    </mml:mstyle>
                  </mml:mrow>
                  <mml:mo stretchy="false">)</mml:mo>
                </mml:mrow>
                <mml:mover class="overset">
                  <mml:mrow>
                    <mml:mo>=</mml:mo>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mtext class="textrm" mathvariant="normal">SGP</mml:mtext>
                  </mml:mrow>
                </mml:mover>
                <mml:mstyle displaystyle="true">
                  <mml:msub>
                    <mml:mrow>
                      <mml:mo>∫</mml:mo>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:msup>
                        <mml:mrow>
                          <mml:mi>ℝ</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mn>3</mml:mn>
                        </mml:mrow>
                      </mml:msup>
                    </mml:mrow>
                  </mml:msub>
                </mml:mstyle>
                <mml:mi>P</mml:mi>
                <mml:mrow>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:mrow>
                    <mml:mstyle mathvariant="bold">
                      <mml:mtext>x</mml:mtext>
                    </mml:mstyle>
                    <mml:mo>,</mml:mo>
                    <mml:mstyle mathvariant="bold">
                      <mml:mtext>R</mml:mtext>
                    </mml:mstyle>
                    <mml:mo>;</mml:mo>
                    <mml:mi>τ</mml:mi>
                  </mml:mrow>
                  <mml:mo stretchy="false">)</mml:mo>
                </mml:mrow>
                <mml:msup>
                  <mml:mrow>
                    <mml:mi>e</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mrow>
                      <mml:mo stretchy="false">(</mml:mo>
                      <mml:mrow>
                        <mml:mo>-</mml:mo>
                        <mml:mi>i</mml:mi>
                        <mml:mi>γ</mml:mi>
                        <mml:mi>δ</mml:mi>
                        <mml:mstyle mathvariant="bold">
                          <mml:mtext>G</mml:mtext>
                        </mml:mstyle>
                      </mml:mrow>
                      <mml:mo stretchy="false">)</mml:mo>
                    </mml:mrow>
                    <mml:mo>·</mml:mo>
                    <mml:mstyle mathvariant="bold">
                      <mml:mtext>R</mml:mtext>
                    </mml:mstyle>
                  </mml:mrow>
                </mml:msup>
                <mml:mi>d</mml:mi>
                <mml:mstyle mathvariant="bold">
                  <mml:mtext>R</mml:mtext>
                </mml:mstyle>
              </mml:mtd>
            </mml:mtr>
          </mml:mtable>
        </mml:math>
      </disp-formula>
      <p>where <italic>P</italic>(<bold>x</bold>, <bold>R</bold>; τ) describes the probability that a particle anywhere inside voxel <bold>x</bold> traveled a net distance <italic>R</italic> = ||<bold>R</bold>|| [m] <italic>given</italic> a diffusion time τ. Here, <bold>R</bold> = <italic>R</italic><bold>r</bold> where <bold>r</bold> ∈ 𝕊<sup>2</sup> and non-negative <italic>R</italic> ∈ ℝ<sup>+</sup>. Hypothetically, given sufficiently small resolution and dense measurements in <italic>G</italic>, <bold>n</bold>, τ, one can directly recover and estimate microstructure-related properties of the EAP for a single τ using an inverse Fourier transform or Fourier basis (e.g., Wedeen et al., <xref rid="B79" ref-type="bibr">2005</xref>; Özarslan et al., <xref rid="B60" ref-type="bibr">2013</xref>; Fick et al., <xref rid="B32" ref-type="bibr">2016</xref>), or over continuous τ (Fick et al., <xref rid="B31" ref-type="bibr">2018</xref>). However, such approaches still hinge on the appropriateness of the SGP approximation, and can only describe properties of the overall signal and EAP, not of specific tissues in heterogeneous environments.</p>
      <p>To estimate specific properties of the tissue microstructure, Multi-Compartment (MC)-models represent the tissue as a linear combination of single compartment models “<italic>C</italic>,” each representing the diffusion signal originating from specific tissue types. Recovering tissue microstructure information is done by finding the model parameters <bold>p</bold> that minimize the difference between modeled and the measured signal. The process of MC-modeling any model containing <italic>i</italic> ≥ 1 compartments is thus given by</p>
      <disp-formula id="E3">
        <label>(3)</label>
        <mml:math id="M5">
          <mml:mtable class="eqnarray" columnalign="right center left">
            <mml:mtr>
              <mml:mtd>
                <mml:msup>
                  <mml:mrow>
                    <mml:mstyle mathvariant="bold">
                      <mml:mtext>p</mml:mtext>
                    </mml:mstyle>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mo>*</mml:mo>
                  </mml:mrow>
                </mml:msup>
                <mml:mrow>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:mrow>
                    <mml:mstyle mathvariant="bold">
                      <mml:mtext>x</mml:mtext>
                    </mml:mstyle>
                  </mml:mrow>
                  <mml:mo stretchy="false">)</mml:mo>
                </mml:mrow>
                <mml:mo>=</mml:mo>
                <mml:msub>
                  <mml:mrow>
                    <mml:mtext class="textrm" mathvariant="normal">argmin</mml:mtext>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mstyle mathvariant="bold">
                      <mml:mtext>p</mml:mtext>
                    </mml:mstyle>
                  </mml:mrow>
                </mml:msub>
                <mml:mstyle displaystyle="true">
                  <mml:mo>∫</mml:mo>
                  <mml:msup>
                    <mml:mrow>
                      <mml:mrow>
                        <mml:mo>[</mml:mo>
                        <mml:mrow>
                          <mml:mi>E</mml:mi>
                          <mml:mrow>
                            <mml:mo stretchy="false">(</mml:mo>
                            <mml:mrow>
                              <mml:mstyle mathvariant="bold">
                                <mml:mtext>x</mml:mtext>
                              </mml:mstyle>
                              <mml:mo>,</mml:mo>
                              <mml:mstyle mathvariant="bold">
                                <mml:mtext>A</mml:mtext>
                              </mml:mstyle>
                            </mml:mrow>
                            <mml:mo stretchy="false">)</mml:mo>
                          </mml:mrow>
                          <mml:mo>-</mml:mo>
                          <mml:msup>
                            <mml:mrow>
                              <mml:mover accent="true">
                                <mml:mi>E</mml:mi>
                                <mml:mo>^</mml:mo>
                              </mml:mover>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mtext class="textrm" mathvariant="normal">MC</mml:mtext>
                            </mml:mrow>
                          </mml:msup>
                          <mml:mrow>
                            <mml:mo stretchy="false">(</mml:mo>
                            <mml:mrow>
                              <mml:mstyle mathvariant="bold">
                                <mml:mtext>A</mml:mtext>
                              </mml:mstyle>
                              <mml:mo>,</mml:mo>
                              <mml:mstyle mathvariant="bold">
                                <mml:mtext>p</mml:mtext>
                              </mml:mstyle>
                            </mml:mrow>
                            <mml:mo stretchy="false">)</mml:mo>
                          </mml:mrow>
                        </mml:mrow>
                        <mml:mo>]</mml:mo>
                      </mml:mrow>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mn>2</mml:mn>
                    </mml:mrow>
                  </mml:msup>
                </mml:mstyle>
                <mml:mi>d</mml:mi>
                <mml:mstyle mathvariant="bold">
                  <mml:mtext>A</mml:mtext>
                </mml:mstyle>
                <mml:mo>,</mml:mo>
              </mml:mtd>
            </mml:mtr>
          </mml:mtable>
        </mml:math>
      </disp-formula>
      <disp-formula id="E4">
        <label>(4)</label>
        <mml:math id="M6">
          <mml:mtable class="eqnarray" columnalign="right center left">
            <mml:mtr>
              <mml:mtd>
                <mml:mtext class="textrm" mathvariant="normal">with </mml:mtext>
                <mml:msup>
                  <mml:mrow>
                    <mml:mover accent="true">
                      <mml:mi>E</mml:mi>
                      <mml:mo>^</mml:mo>
                    </mml:mover>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mtext class="textrm" mathvariant="normal">MC</mml:mtext>
                  </mml:mrow>
                </mml:msup>
                <mml:mrow>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:mrow>
                    <mml:mstyle mathvariant="bold">
                      <mml:mtext>A</mml:mtext>
                    </mml:mstyle>
                    <mml:mo>,</mml:mo>
                    <mml:mstyle mathvariant="bold">
                      <mml:mtext>p</mml:mtext>
                    </mml:mstyle>
                  </mml:mrow>
                  <mml:mo stretchy="false">)</mml:mo>
                </mml:mrow>
                <mml:mo>=</mml:mo>
                <mml:mstyle displaystyle="true">
                  <mml:munderover accentunder="false" accent="false">
                    <mml:mrow>
                      <mml:mo>∑</mml:mo>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>i</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>N</mml:mi>
                    </mml:mrow>
                  </mml:munderover>
                </mml:mstyle>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>f</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>i</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>C</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>i</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:mrow>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:mrow>
                    <mml:mstyle mathvariant="bold">
                      <mml:mtext>A</mml:mtext>
                    </mml:mstyle>
                    <mml:mo>,</mml:mo>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mstyle mathvariant="bold">
                          <mml:mtext>p</mml:mtext>
                        </mml:mstyle>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>i</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                  </mml:mrow>
                  <mml:mo stretchy="false">)</mml:mo>
                </mml:mrow>
              </mml:mtd>
            </mml:mtr>
          </mml:mtable>
        </mml:math>
      </disp-formula>
      <p>where the parameters of each model <bold>p</bold><sub><italic>i</italic></sub> represent its tissue microstructure properties like diffusivity, orientation, axon diameter, dispersion, and others. The non-negative, normalized volume fractions <italic>f</italic><sub><italic>i</italic></sub> weight the signal contribution of each compartment model. For these parameters to accurately describe the underlying tissue configuration, it is essential that the MC-model composition in terms of compartment models is appropriate for the actual tissue composition. Notice that Equation (3) is general, and its compartments do not necessarily need to be based on the SGP condition in Equation (2). In the next sections, we show which compartment model representations are available in Dmipy, and how they can be combined into an MC-model and be prepared for optimization.</p>
    </sec>
    <sec>
      <title>2.4. Dmipy's Generalized Three-Dimensional Signal Representations</title>
      <p>In Dmipy, the single models <italic>C</italic>(<bold>A</bold>, <bold>p</bold>) that make up the MC-model in Equation (3) are represented using generalized three-dimensional signal representations, called “CompartmentModels” or “DistributedModels.” The CompartmentModel is the basic block that contains the signal representation of any single, undistributed biophysical model. CompartmentModels are either isotropic or anisotropic, but axially symmetric. Anisotropic models have an orientation <bold>μ</bold> ∈ 𝕊<sup>2</sup> and are described as a separable product of the one- and two-dimensional models, representing their parallel and perpendicular components, respectively (Assaf et al., <xref rid="B5" ref-type="bibr">2004</xref>). DistributedModels consist of other CompartmentModels or DistributedModels and apply parametric distributions on the parameters of its input models. We illustrate Dmipy's available model representations in <xref ref-type="fig" rid="F3">Figure 3</xref> with their associated parameters. By combining these models in various combinations, it is possible to construct nearly any MC-model in the literature. In <xref rid="T2" ref-type="table">Table 2</xref> we explicitly write out the unique parameters of these models, provide their cardinality, SI unit, and in which models they are present.</p>
      <fig id="F3" position="float">
        <label>Figure 3</label>
        <caption>
          <p>A schematic of most biophysical mode ls that are used in PGSE-based Microstructure Imaging. Using different combinations of these “components,” any microstructure model can be assembled using Dmipy.</p>
        </caption>
        <graphic xlink:href="fninf-13-00064-g0003"/>
      </fig>
      <table-wrap id="T2" position="float">
        <label>Table 2</label>
        <caption>
          <p>Overview of CompartmentModel parameters with their associated cardinality, SI-units, in which models they occur and description.</p>
        </caption>
        <table frame="hsides" rules="groups">
          <thead>
            <tr>
              <th valign="top" align="left" rowspan="1" colspan="1">
                <bold>Parameter name</bold>
              </th>
              <th valign="top" align="center" rowspan="1" colspan="1"><bold>Card</bold>.</th>
              <th valign="top" align="center" rowspan="1" colspan="1">
                <bold>SI unit</bold>
              </th>
              <th valign="top" align="center" rowspan="1" colspan="1">
                <bold>Present in models</bold>
              </th>
              <th valign="top" align="left" rowspan="1" colspan="1">
                <bold>Description</bold>
              </th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1">lambda_iso</td>
              <td valign="top" align="center" rowspan="1" colspan="1">1</td>
              <td valign="top" align="center" rowspan="1" colspan="1"><italic>m</italic><sup>2</sup>/<italic>s</italic></td>
              <td valign="top" align="center" rowspan="1" colspan="1">G1</td>
              <td valign="top" align="left" rowspan="1" colspan="1">Isotropic Gaussian diffusivity</td>
            </tr>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1">lambda_par</td>
              <td valign="top" align="center" rowspan="1" colspan="1">1</td>
              <td valign="top" align="center" rowspan="1" colspan="1"><italic>m</italic><sup>2</sup>/<italic>s</italic></td>
              <td valign="top" align="center" rowspan="1" colspan="1">G2-3, C1-4</td>
              <td valign="top" align="left" rowspan="1" colspan="1">Parallel Gaussian diffusivity</td>
            </tr>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1">lambda_perp</td>
              <td valign="top" align="center" rowspan="1" colspan="1">1</td>
              <td valign="top" align="center" rowspan="1" colspan="1"><italic>m</italic><sup>2</sup>/<italic>s</italic></td>
              <td valign="top" align="center" rowspan="1" colspan="1">G2</td>
              <td valign="top" align="left" rowspan="1" colspan="1">Perpendicular diffusivity</td>
            </tr>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1">lambda_inf</td>
              <td valign="top" align="center" rowspan="1" colspan="1">1</td>
              <td valign="top" align="center" rowspan="1" colspan="1"><italic>m</italic><sup>2</sup>/<italic>s</italic></td>
              <td valign="top" align="center" rowspan="1" colspan="1">G3</td>
              <td valign="top" align="left" rowspan="1" colspan="1">Bulk diffusivity</td>
            </tr>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1">lambda_intra</td>
              <td valign="top" align="center" rowspan="1" colspan="1">1</td>
              <td valign="top" align="center" rowspan="1" colspan="1"><italic>m</italic><sup>2</sup>/<italic>s</italic></td>
              <td valign="top" align="center" rowspan="1" colspan="1">C3-4, S3-4</td>
              <td valign="top" align="left" rowspan="1" colspan="1">Intra-cellular diffusivity</td>
            </tr>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1">A</td>
              <td valign="top" align="center" rowspan="1" colspan="1">1</td>
              <td valign="top" align="center" rowspan="1" colspan="1">
                <italic>m</italic>
                <sup>−2</sup>
              </td>
              <td valign="top" align="center" rowspan="1" colspan="1">G3</td>
              <td valign="top" align="left" rowspan="1" colspan="1">Characteristic coefficient</td>
            </tr>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1">mu</td>
              <td valign="top" align="center" rowspan="1" colspan="1">2</td>
              <td valign="top" align="center" rowspan="1" colspan="1">[rad]</td>
              <td valign="top" align="center" rowspan="1" colspan="1">G2-3, C1-4, SD1-2, TR2</td>
              <td valign="top" align="left" rowspan="1" colspan="1">Orientation θ/ϕ Euler angles</td>
            </tr>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1">diameter</td>
              <td valign="top" align="center" rowspan="1" colspan="1">1</td>
              <td valign="top" align="center" rowspan="1" colspan="1">
                <italic>m</italic>
              </td>
              <td valign="top" align="center" rowspan="1" colspan="1">C2-4, S2-4</td>
              <td valign="top" align="left" rowspan="1" colspan="1">Cylinder/Sphere diameter</td>
            </tr>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1">odi</td>
              <td valign="top" align="center" rowspan="1" colspan="1">1</td>
              <td valign="top" align="center" rowspan="1" colspan="1">[-]</td>
              <td valign="top" align="center" rowspan="1" colspan="1">SD1-2</td>
              <td valign="top" align="left" rowspan="1" colspan="1">Orientation Dispersion Index</td>
            </tr>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1">beta</td>
              <td valign="top" align="center" rowspan="1" colspan="1">1</td>
              <td valign="top" align="center" rowspan="1" colspan="1">[-]</td>
              <td valign="top" align="center" rowspan="1" colspan="1">SD2</td>
              <td valign="top" align="left" rowspan="1" colspan="1">Secondary Bingham dispersion</td>
            </tr>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1">alpha, beta</td>
              <td valign="top" align="center" rowspan="1" colspan="1">1</td>
              <td valign="top" align="center" rowspan="1" colspan="1">[-]</td>
              <td valign="top" align="center" rowspan="1" colspan="1">PD1</td>
              <td valign="top" align="left" rowspan="1" colspan="1">Shape/Scale of Gamma distribution</td>
            </tr>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1">sh_coeff</td>
              <td valign="top" align="center" rowspan="1" colspan="1">1<sub>max</sub></td>
              <td valign="top" align="center" rowspan="1" colspan="1">[-]</td>
              <td valign="top" align="center" rowspan="1" colspan="1">MC-SH</td>
              <td valign="top" align="left" rowspan="1" colspan="1">FOD SH-coefficients</td>
            </tr>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1">partial_volume_n</td>
              <td valign="top" align="center" rowspan="1" colspan="1">1</td>
              <td valign="top" align="center" rowspan="1" colspan="1">[-]</td>
              <td valign="top" align="center" rowspan="1" colspan="1">MC, MC-SM, MC-SH</td>
              <td valign="top" align="left" rowspan="1" colspan="1">volume fraction</td>
            </tr>
          </tbody>
        </table>
      </table-wrap>
      <p>To generate the signal representation for any input model <italic>C</italic>(<bold>A</bold>, <bold>p</bold>)—regardless of the mathematical representation—we only need values for its parameters <bold>p</bold> and the acquisition parameters <bold>A</bold>, represented in a DmipyAcquisitionScheme. Having this input, a CompartmentModel or DistributedModel can return three main signal <italic>attenuation</italic> representations to be used by the higher-level multi-compartment and distributed models:</p>
      <list list-type="bullet">
        <list-item>
          <p>A standard representation <inline-formula><mml:math id="M7"><mml:mover accent="true"><mml:mi>E</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mstyle class="text"><mml:mtext mathvariant="bold">A</mml:mtext></mml:mstyle></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>C</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mstyle class="text"><mml:mtext mathvariant="bold">A</mml:mtext></mml:mstyle><mml:mo>,</mml:mo><mml:mstyle class="text"><mml:mtext mathvariant="bold">p</mml:mtext></mml:mstyle></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi>ℝ</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mstyle class="text"><mml:mtext class="textrm" mathvariant="normal">DWI</mml:mtext></mml:mstyle></mml:mrow></mml:msub></mml:mrow></mml:msup></mml:math></inline-formula>, evaluating the biophysical model for the given acquisition parameters <inline-formula><mml:math id="M8"><mml:mover accent="true"><mml:mrow><mml:mstyle class="text"><mml:mtext mathvariant="bold">A</mml:mtext></mml:mstyle></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:math></inline-formula>, where <italic>N</italic><sub>DWI</sub> is the number of acquired DWIs.</p>
        </list-item>
        <list-item>
          <p>A spherical mean representation <inline-formula><mml:math id="M9"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>E</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>S</mml:mi><mml:mi>M</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mstyle class="text"><mml:mtext mathvariant="bold">A</mml:mtext></mml:mstyle></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>4</mml:mn><mml:mi>π</mml:mi></mml:mrow></mml:mfrac><mml:msub><mml:mrow><mml:mo>∫</mml:mo></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mo>𝕊</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mstyle class="text"><mml:mtext mathvariant="bold">A</mml:mtext></mml:mstyle></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mstyle class="text"><mml:mtext mathvariant="bold">n</mml:mtext></mml:mstyle><mml:mo>;</mml:mo><mml:mstyle class="text"><mml:mtext mathvariant="bold">p</mml:mtext></mml:mstyle></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>d</mml:mi><mml:mstyle class="text"><mml:mtext mathvariant="bold">n</mml:mtext></mml:mstyle><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi>ℝ</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mstyle class="text"><mml:mtext class="textrm" mathvariant="normal">shells</mml:mtext></mml:mstyle></mml:mrow></mml:msub></mml:mrow></mml:msup></mml:math></inline-formula>, returning the shell-wise spherical mean of the signal. If no analytic expression is available, then it is estimated numerically.</p>
        </list-item>
        <list-item>
          <p>And a multi-shell convolution kernel matrix <inline-formula><mml:math id="M10"><mml:mstyle class="text"><mml:mtext mathvariant="bold">M</mml:mtext></mml:mstyle><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mstyle class="text"><mml:mtext mathvariant="bold">A</mml:mtext></mml:mstyle></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mstyle class="text"><mml:mtext mathvariant="bold">p</mml:mtext></mml:mstyle></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi>ℝ</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mstyle class="text"><mml:mtext class="textrm" mathvariant="normal">DWIs</mml:mtext></mml:mstyle></mml:mrow></mml:msub><mml:mo>×</mml:mo><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mstyle class="text"><mml:mtext class="textrm" mathvariant="normal">SH-coef</mml:mtext></mml:mstyle></mml:mrow></mml:msub></mml:mrow></mml:msup></mml:math></inline-formula>, which enables convolution of the model's rotational harmonics representation with the spherical harmonics expansion of some spherical distributions with number of coefficients <italic>N</italic><sub>SH-coef</sub>. See details in the <xref ref-type="supplementary-material" rid="SM1">Supplementary Material</xref>.</p>
        </list-item>
      </list>
      <p>In Snippet 2, we provide the code to instantiate all the available microscopic CompartmentModels that we will present in the next section 2.5. The signal generation for the Distributed Models we present in section 2.6 is analogous.</p>
      <table-wrap id="d35e1975" position="float">
        <label>Snippet 2</label>
        <caption>
          <p>One-line instantiation of available CompartmentModel representations in Dmipy. For any of the models the parameter cardinality and names can be inspected. Signal representations for any DmipyAcquisitionScheme can be generated by providing valid values for the parameters.</p>
        </caption>
        <graphic xlink:href="fninf-13-00064-i0002"/>
      </table-wrap>
    </sec>
    <sec>
      <title>2.5. Microscopic Compartment Models</title>
      <p>Parsimonious models of the tissue microstructure are usually based on what we know the tissue looks like from histological observations. Well-known examples are using cylinders of some diameter to represent axons (Aboitiz et al., <xref rid="B1" ref-type="bibr">1992</xref>; Assaf et al., <xref rid="B4" ref-type="bibr">2008</xref>), or spheres of some diameter to represent tumor cells (Panagiotaki et al., <xref rid="B62" ref-type="bibr">2014</xref>). In this section, we describe the way Dmipy allows modular signal generation for any microscopic model, and which models are available. These include Gaussian models (G) in section 2.5.1, restricted models such as cylinders (C) and spheres (S) in section 2.5.2.</p>
      <sec>
        <title>2.5.1. Gaussian Models (G)</title>
        <p>In MC-modeling, Gaussian models are used to represent free or hindered diffusion inside tissues that are not explicitly restricting the movement of diffusing particles. Essentially, they say a particle could travel anywhere in <bold>R</bold> ∈ ℝ<sup>3</sup> with non-zero, but exponentially decreasing probability as <italic>R</italic> → ∞. They are convenient to represent the Fourier-like relationship between the signal and EAP, as the closed-form Fourier transform of a Gaussian is another Gaussian.</p>
        <p><bold>G1</bold>: The simplest Gaussian model is the Ball: an isotropic Gaussian compartment whose signal attenuation only depends on isotropic diffusivity λ<sub>iso</sub>[m<sup>2</sup>/s]. Balls usually represent the diffusion signal of free water (Behrens et al., <xref rid="B9" ref-type="bibr">2003</xref>), or tissue types that on average induce an isotropic hindrance on the EAP, like gray matter (Dell'Acqua et al., <xref rid="B20" ref-type="bibr">2010</xref>).</p>
        <p><bold>G2</bold>: The Zeppelin is an axially symmetric Gaussian distribution aligned along orientation <bold>μ</bold>, with parallel and perpendicular diffusivity λ<sub>∥</sub> ≥ λ<sub>⊥</sub>[m<sup>2</sup>/s]. It is often used to describe the diffusion signal originating from the oriented, extra-axonal space (Alexander et al., <xref rid="B3" ref-type="bibr">2010</xref>; Zhang et al., <xref rid="B83" ref-type="bibr">2012</xref>).</p>
        <p><bold>G3</bold>: To represent extra-axonal diffusion, recent works argue that hindered diffusion is actually slower-than-exponential over τ due to how the external axon boundaries still restrict diffusing particles (Novikov et al., <xref rid="B57" ref-type="bibr">2014</xref>). To account for this, Burcaw et al. (<xref rid="B10" ref-type="bibr">2015</xref>) proposed a modification to the Zeppelin we refer to as the Temporal Zeppelin, where the perpendicular diffusivity is instead given by <inline-formula><mml:math id="M11"><mml:msub><mml:mrow><mml:mo>λ</mml:mo></mml:mrow><mml:mrow><mml:mo>⊥</mml:mo></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mo>λ</mml:mo></mml:mrow><mml:mrow><mml:mi>∞</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mi>A</mml:mi><mml:mo class="qopname">ln</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mo>Δ</mml:mo><mml:mo>/</mml:mo><mml:mi>δ</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mn>3</mml:mn><mml:mo>/</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mo>Δ</mml:mo><mml:mo>-</mml:mo><mml:mi>δ</mml:mi><mml:mo>/</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:mfrac></mml:math></inline-formula>, with λ<sub>∞</sub>[m<sup>2</sup>/s] the bulk diffusivity for large diffusion times, and <italic>A</italic>[m<sup>−2</sup>] the characteristic coefficient for the packing of the axons. The Temporal Zeppelin has been used by De Santis et al. (<xref rid="B19" ref-type="bibr">2016</xref>) to characterize extra-axonal hindrance in tandem with axon diameter estimation.</p>
      </sec>
      <sec>
        <title>2.5.2. Restricted Cylinder (C) and Sphere (S) Models</title>
        <p>Diffusion <italic>restriction</italic> is the phenomenon of particles diffusing during pulse separation time Δ, exploring the geometry and finding they cannot move through boundaries at a certain distance <italic>D</italic>[m] from their origin point, i.e., <italic>P</italic>(<bold>R</bold>) &gt; 0, ∀||<bold>R</bold>|| ≤ <italic>D</italic>. The relationship between the EAP and the diffusion signal inside Cylinders (C) and Spheres (S) has been well studied (Stejskal, <xref rid="B67" ref-type="bibr">1965</xref>; Balinov et al., <xref rid="B7" ref-type="bibr">1993</xref>; Vangelderen et al., <xref rid="B78" ref-type="bibr">1994</xref>; Callaghan, <xref rid="B13" ref-type="bibr">1995</xref>). The most commonly used applications of these models are Cylinders to represent axons (Assaf et al., <xref rid="B5" ref-type="bibr">2004</xref>), and Spheres to represent cell bodies (Panagiotaki et al., <xref rid="B62" ref-type="bibr">2014</xref>), such that the diameter of the cylinder or sphere represents the diameter of axons and cells. Sphere models are isotropic with a diameter <italic>D</italic> and intra-spherical diffusivity λ<sub>intra</sub>. Cylinder models are formulated as anisotropic models, having Gaussian diffusivity λ<sub>∥</sub> along orientation <bold>μ</bold>, and Cylinder diameter <italic>D</italic> and intra-cylindrical diffusivity λ<sub>intra</sub> perpendicular to it.</p>
        <p><bold>C1, S1</bold>: Both the Cylinder and Sphere models have implementations that assume the geometry diameter is negligible and can be set to zero. This results in the well-known Stick model (C1) (Behrens et al., <xref rid="B9" ref-type="bibr">2003</xref>) and non-diffusing Dot model (S1) (Panagiotaki et al., <xref rid="B61" ref-type="bibr">2012</xref>).</p>
        <p><bold>C2-4, S2-4</bold>: To relate the EAP to the measured signal for restricted models, several assumptions on the diffusion process are used. Dmipy implements three different approximations of Cylinders and Spheres, which we order by decreasingly stringent assumptions on the diffusion process. The most stringent is the “Stejskal-Tanner” approximation (C2, S2), which simultaneously assumes the previously described SGP, and the long diffusion time limit. The “Callaghan” approximation allows finite diffusion time, only assuming the SGP (C3, S3). Finally, the “Gaussian Phase” approximation only assumes the diffusion is Gaussian during pulse length δ (C4, S4). We note that C4, S4 are examples of models that are not based on the SGP condition in Equation (2). Details can be found in the <xref ref-type="supplementary-material" rid="SM1">Supplementary Material</xref>.</p>
      </sec>
    </sec>
    <sec>
      <title>2.6. Macroscopic Distributed Models</title>
      <p>DistributedModels include features that are properties of groups of microstructural features, like the distributions of axon diameter (Assaf et al., <xref rid="B4" ref-type="bibr">2008</xref>) and axon orientation (Kaden et al., <xref rid="B43" ref-type="bibr">2007</xref>; Tournier et al., <xref rid="B72" ref-type="bibr">2007</xref>) inside the same white matter bundle. There are two types of DistributedModels in Dmipy. The first is the “ParameterDistributed” (PD) model for one-dimensional distributions over e.g., axon diameter, which we describe in section 2.6.1. The second is the “SphericalDistributed” (SD) model for parametric distributions of models on the sphere for e.g., axon dispersion (Leergaard et al., <xref rid="B49" ref-type="bibr">2010</xref>) in section 2.6.2. We also describe “TissueResponse” models, which are non-parametric representations of the macroscopic measured signal, in section 2.6.3.</p>
      <sec>
        <title>2.6.1. Parametric Distributions Over Model Parameters (PD)</title>
        <p>A parameter distributed (PD) model can apply parametric distributions over parameters of cardinality one, like diffusivity or cylinder diameter (see <xref rid="T2" ref-type="table">Table 2</xref>). We define a parametric distribution as <italic>P</italic>(ξ; <bold>Ω</bold>) with <bold>Ω</bold> ∈ ℝ its parameters and ξ ∈ ℝ<sup>+</sup> the parameter that is sampled. We can then define any parameter distributed compartment model <italic>C</italic><sub><italic>PD</italic></sub> as</p>
        <disp-formula id="E5">
          <label>(5)</label>
          <mml:math id="M12">
            <mml:mtable class="eqnarray" columnalign="right center left">
              <mml:mtr>
                <mml:mtd>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>C</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>P</mml:mi>
                      <mml:mi>D</mml:mi>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mrow>
                    <mml:mo stretchy="false">(</mml:mo>
                    <mml:mrow>
                      <mml:mstyle mathvariant="bold">
                        <mml:mtext>A</mml:mtext>
                      </mml:mstyle>
                      <mml:mo>;</mml:mo>
                      <mml:mover accent="true">
                        <mml:mrow>
                          <mml:mstyle mathvariant="bold">
                            <mml:mtext>p</mml:mtext>
                          </mml:mstyle>
                        </mml:mrow>
                        <mml:mo>~</mml:mo>
                      </mml:mover>
                      <mml:mo>,</mml:mo>
                      <mml:mstyle mathvariant="bold">
                        <mml:mo>Ω</mml:mo>
                      </mml:mstyle>
                    </mml:mrow>
                    <mml:mo stretchy="false">)</mml:mo>
                  </mml:mrow>
                  <mml:mo>=</mml:mo>
                  <mml:mfrac>
                    <mml:mrow>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mo>∫</mml:mo>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:msup>
                            <mml:mrow>
                              <mml:mi>ℝ</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mo>+</mml:mo>
                            </mml:mrow>
                          </mml:msup>
                        </mml:mrow>
                      </mml:msub>
                      <mml:mover class="msup">
                        <mml:mrow>
                          <mml:mover accent="false">
                            <mml:mrow>
                              <mml:mi>P</mml:mi>
                              <mml:mrow>
                                <mml:mo stretchy="false">(</mml:mo>
                                <mml:mrow>
                                  <mml:mi>ξ</mml:mi>
                                  <mml:mo>;</mml:mo>
                                  <mml:mstyle mathvariant="bold">
                                    <mml:mo>Ω</mml:mo>
                                  </mml:mstyle>
                                </mml:mrow>
                                <mml:mo stretchy="false">)</mml:mo>
                              </mml:mrow>
                            </mml:mrow>
                            <mml:mo>︷</mml:mo>
                          </mml:mover>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mtext class="textrm" mathvariant="normal">PDF</mml:mtext>
                        </mml:mrow>
                      </mml:mover>
                      <mml:mo>·</mml:mo>
                      <mml:mover class="msup">
                        <mml:mrow>
                          <mml:mover accent="false">
                            <mml:mrow>
                              <mml:mi>C</mml:mi>
                              <mml:mrow>
                                <mml:mo stretchy="false">(</mml:mo>
                                <mml:mrow>
                                  <mml:mstyle mathvariant="bold">
                                    <mml:mtext>A</mml:mtext>
                                  </mml:mstyle>
                                  <mml:mo>;</mml:mo>
                                  <mml:mi>ξ</mml:mi>
                                  <mml:mo>,</mml:mo>
                                  <mml:mover accent="true">
                                    <mml:mrow>
                                      <mml:mstyle mathvariant="bold">
                                        <mml:mtext>p</mml:mtext>
                                      </mml:mstyle>
                                    </mml:mrow>
                                    <mml:mo>~</mml:mo>
                                  </mml:mover>
                                </mml:mrow>
                                <mml:mo stretchy="false">)</mml:mo>
                              </mml:mrow>
                            </mml:mrow>
                            <mml:mo>︷</mml:mo>
                          </mml:mover>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mtext class="textrm" mathvariant="normal">(Restricted) Signal Attenuation</mml:mtext>
                        </mml:mrow>
                      </mml:mover>
                      <mml:mo>·</mml:mo>
                      <mml:mover class="msup">
                        <mml:mrow>
                          <mml:mover accent="false">
                            <mml:mrow>
                              <mml:mi>N</mml:mi>
                              <mml:mrow>
                                <mml:mo stretchy="false">(</mml:mo>
                                <mml:mrow>
                                  <mml:mi>ξ</mml:mi>
                                </mml:mrow>
                                <mml:mo stretchy="false">)</mml:mo>
                              </mml:mrow>
                            </mml:mrow>
                            <mml:mo>︷</mml:mo>
                          </mml:mover>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mtext class="textrm" mathvariant="normal">Volume Correction</mml:mtext>
                        </mml:mrow>
                      </mml:mover>
                      <mml:mi>d</mml:mi>
                      <mml:mi>ξ</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mstyle displaystyle="true">
                        <mml:munder class="msub">
                          <mml:mrow>
                            <mml:mstyle displaystyle="true">
                              <mml:munder accentunder="false">
                                <mml:mrow>
                                  <mml:msub>
                                    <mml:mrow>
                                      <mml:mo>∫</mml:mo>
                                    </mml:mrow>
                                    <mml:mrow>
                                      <mml:msup>
                                        <mml:mrow>
                                          <mml:mi>ℝ</mml:mi>
                                        </mml:mrow>
                                        <mml:mrow>
                                          <mml:mo>+</mml:mo>
                                        </mml:mrow>
                                      </mml:msup>
                                    </mml:mrow>
                                  </mml:msub>
                                  <mml:mi>P</mml:mi>
                                  <mml:mrow>
                                    <mml:mo stretchy="false">(</mml:mo>
                                    <mml:mrow>
                                      <mml:mi>ξ</mml:mi>
                                      <mml:mo>;</mml:mo>
                                      <mml:mstyle mathvariant="bold">
                                        <mml:mo>Ω</mml:mo>
                                      </mml:mstyle>
                                    </mml:mrow>
                                    <mml:mo stretchy="false">)</mml:mo>
                                  </mml:mrow>
                                  <mml:mo>·</mml:mo>
                                  <mml:mi>N</mml:mi>
                                  <mml:mrow>
                                    <mml:mo stretchy="false">(</mml:mo>
                                    <mml:mrow>
                                      <mml:mi>ξ</mml:mi>
                                    </mml:mrow>
                                    <mml:mo stretchy="false">)</mml:mo>
                                  </mml:mrow>
                                  <mml:mi>d</mml:mi>
                                  <mml:mi>ξ</mml:mi>
                                </mml:mrow>
                                <mml:mo>︸</mml:mo>
                              </mml:munder>
                            </mml:mstyle>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mtext class="textrm" mathvariant="normal">Normalization</mml:mtext>
                          </mml:mrow>
                        </mml:munder>
                      </mml:mstyle>
                    </mml:mrow>
                  </mml:mfrac>
                </mml:mtd>
              </mml:mtr>
            </mml:mtable>
          </mml:math>
        </disp-formula>
        <p>where <inline-formula><mml:math id="M13"><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mi>ξ</mml:mi><mml:mo>,</mml:mo><mml:mover accent="true"><mml:mrow><mml:mstyle class="text"><mml:mtext mathvariant="bold">p</mml:mtext></mml:mstyle></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mo>}</mml:mo></mml:mrow><mml:mo>∈</mml:mo><mml:mstyle class="text"><mml:mtext mathvariant="bold">p</mml:mtext></mml:mstyle></mml:math></inline-formula> together are all parameters of model <italic>C</italic>. The distributed parameter ξ is integrated out, and replaced by the distribution parameters <bold>Ω</bold>. When distributing diffusivity the normalization is <italic>N</italic>(ξ) = 1, but, in the case of distributing the radii of restricted models such as planes, cylinders, or spheres, <italic>N</italic>(ξ) is the volume function of that geometry. Briefly, <italic>N</italic><sub>plate</sub>(ξ) = ξ, <inline-formula><mml:math id="M14"><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mstyle class="text"><mml:mtext class="textrm" mathvariant="normal">cylinder</mml:mtext></mml:mstyle></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>ξ</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>π</mml:mi><mml:msup><mml:mrow><mml:mi>ξ</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:math></inline-formula> and <inline-formula><mml:math id="M15"><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mstyle class="text"><mml:mtext class="textrm" mathvariant="normal">sphere</mml:mtext></mml:mstyle></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>ξ</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>4</mml:mn></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:mfrac><mml:mi>π</mml:mi><mml:msup><mml:mrow><mml:mi>ξ</mml:mi></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msup></mml:math></inline-formula>. The reason for this is that it is not the geometries themselves, but the simulated particles diffusing inside these geometries that are contributing to the signal attenuation. In Snippet 3, line 9 it is demonstrated that any model parameter can be distributed only by providing its name upon initialization of the PD model.</p>
        <table-wrap id="d35e2562" position="float">
          <label>Snippet 3</label>
          <caption>
            <p>One-line instantiation of parameter and spherical distributions and DistributedModels. Notice DistributedModels can be seen as sub-MC-models that apply a distribution to the parameters of base CompartmentModels.</p>
          </caption>
          <graphic xlink:href="fninf-13-00064-i0003"/>
        </table-wrap>
        <p><bold>PD1</bold>: A Gamma distribution with shape parameter α and scale parameter β has been used to model the axon diameter distribution in nervous tissue (Aboitiz et al., <xref rid="B1" ref-type="bibr">1992</xref>; Assaf et al., <xref rid="B4" ref-type="bibr">2008</xref>).</p>
      </sec>
      <sec>
        <title>2.6.2. Spherical Distributions Over Model Orientation (SD)</title>
        <p>Spherical distributed (SD) models apply parametric distributions of over model orientation. The signal attenuation of a SD model is obtained by means of a spherical convolution of spherical distribution F(<bold>n</bold>; <bold>Ω</bold>):𝕊<sup>2</sup> → [0, ∞] with parameters <bold>Ω</bold>, with one or more convolution kernel models <inline-formula><mml:math id="M16"><mml:msubsup><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>K</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mstyle class="text"><mml:mtext mathvariant="bold">n</mml:mtext></mml:mstyle><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mstyle class="text"><mml:mtext mathvariant="bold">p</mml:mtext></mml:mstyle></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>C</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mstyle class="text"><mml:mtext mathvariant="bold">n</mml:mtext></mml:mstyle><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mstyle class="text"><mml:mtext mathvariant="bold">p</mml:mtext></mml:mstyle></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mstyle mathvariant="bold"><mml:mo>μ</mml:mo></mml:mstyle></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, meaning <inline-formula><mml:math id="M17"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mstyle class="text"><mml:mtext mathvariant="bold">p</mml:mtext></mml:mstyle></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mstyle mathvariant="bold"><mml:mo>μ</mml:mo></mml:mstyle></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:msub><mml:mrow><mml:mstyle class="text"><mml:mtext mathvariant="bold">p</mml:mtext></mml:mstyle></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> and the orientation <bold>μ</bold><sub><italic>i</italic></sub> is parallel to the z-axis. An SD model is thus given by</p>
        <disp-formula id="E6">
          <label>(6)</label>
          <mml:math id="M18">
            <mml:mtable class="eqnarray" columnalign="right center left">
              <mml:mtr>
                <mml:mtd>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>C</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mtext class="textrm" mathvariant="normal">SD</mml:mtext>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mrow>
                    <mml:mo stretchy="false">(</mml:mo>
                    <mml:mrow>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mstyle mathvariant="bold">
                            <mml:mtext>A</mml:mtext>
                          </mml:mstyle>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>s</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                      <mml:mo>,</mml:mo>
                      <mml:mstyle mathvariant="bold">
                        <mml:mtext>n</mml:mtext>
                      </mml:mstyle>
                      <mml:mo>;</mml:mo>
                      <mml:mrow>
                        <mml:mo>{</mml:mo>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mover accent="true">
                                <mml:mrow>
                                  <mml:mstyle mathvariant="bold">
                                    <mml:mtext>p</mml:mtext>
                                  </mml:mstyle>
                                </mml:mrow>
                                <mml:mo>~</mml:mo>
                              </mml:mover>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mi>i</mml:mi>
                            </mml:mrow>
                          </mml:msub>
                        </mml:mrow>
                        <mml:mo>}</mml:mo>
                      </mml:mrow>
                      <mml:mo>,</mml:mo>
                      <mml:mstyle mathvariant="bold">
                        <mml:mo>Ω</mml:mo>
                      </mml:mstyle>
                    </mml:mrow>
                    <mml:mo stretchy="false">)</mml:mo>
                  </mml:mrow>
                  <mml:mo>=</mml:mo>
                  <mml:mstyle displaystyle="true">
                    <mml:msub>
                      <mml:mrow>
                        <mml:mo>∫</mml:mo>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:msup>
                          <mml:mrow>
                            <mml:mo>𝕊</mml:mo>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mn>2</mml:mn>
                          </mml:mrow>
                        </mml:msup>
                      </mml:mrow>
                    </mml:msub>
                  </mml:mstyle>
                  <mml:mo class="qopname">F</mml:mo>
                  <mml:mrow>
                    <mml:mo stretchy="false">(</mml:mo>
                    <mml:mrow>
                      <mml:mstyle mathvariant="bold">
                        <mml:mtext>n</mml:mtext>
                      </mml:mstyle>
                      <mml:mo>-</mml:mo>
                      <mml:mstyle mathvariant="bold">
                        <mml:mtext>u</mml:mtext>
                      </mml:mstyle>
                      <mml:mo>;</mml:mo>
                      <mml:mstyle mathvariant="bold">
                        <mml:mo>Ω</mml:mo>
                      </mml:mstyle>
                    </mml:mrow>
                    <mml:mo stretchy="false">)</mml:mo>
                  </mml:mrow>
                  <mml:mo>·</mml:mo>
                  <mml:mstyle displaystyle="true">
                    <mml:munderover accentunder="false" accent="false">
                      <mml:mrow>
                        <mml:mo>∑</mml:mo>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>i</mml:mi>
                        <mml:mo>=</mml:mo>
                        <mml:mn>1</mml:mn>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>N</mml:mi>
                      </mml:mrow>
                    </mml:munderover>
                  </mml:mstyle>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>f</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>i</mml:mi>
                    </mml:mrow>
                  </mml:msub>
                  <mml:msubsup>
                    <mml:mrow>
                      <mml:mi>C</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>i</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>K</mml:mi>
                    </mml:mrow>
                  </mml:msubsup>
                  <mml:mrow>
                    <mml:mo stretchy="false">(</mml:mo>
                    <mml:mrow>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mstyle mathvariant="bold">
                            <mml:mtext>A</mml:mtext>
                          </mml:mstyle>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>s</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                      <mml:mo>,</mml:mo>
                      <mml:mstyle mathvariant="bold">
                        <mml:mtext>u</mml:mtext>
                      </mml:mstyle>
                      <mml:mo>;</mml:mo>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mover accent="true">
                            <mml:mrow>
                              <mml:mstyle mathvariant="bold">
                                <mml:mtext>p</mml:mtext>
                              </mml:mstyle>
                            </mml:mrow>
                            <mml:mo>~</mml:mo>
                          </mml:mover>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>i</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                    </mml:mrow>
                    <mml:mo stretchy="false">)</mml:mo>
                  </mml:mrow>
                  <mml:mi>d</mml:mi>
                  <mml:mstyle mathvariant="bold">
                    <mml:mtext>u</mml:mtext>
                  </mml:mstyle>
                </mml:mtd>
              </mml:mtr>
            </mml:mtable>
          </mml:math>
        </disp-formula>
        <disp-formula id="E7">
          <label>(7)</label>
          <mml:math id="M19">
            <mml:mtable class="eqnarray" columnalign="right center left">
              <mml:mtr>
                <mml:mtd>
                  <mml:mtext>                                   </mml:mtext>
                  <mml:mo>=</mml:mo>
                  <mml:mrow>
                    <mml:mo>[</mml:mo>
                    <mml:mrow>
                      <mml:mo class="qopname">F</mml:mo>
                      <mml:mrow>
                        <mml:mo stretchy="false">(</mml:mo>
                        <mml:mrow>
                          <mml:mstyle mathvariant="bold">
                            <mml:mo>Ω</mml:mo>
                          </mml:mstyle>
                        </mml:mrow>
                        <mml:mo stretchy="false">)</mml:mo>
                      </mml:mrow>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mo>*</mml:mo>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:msup>
                            <mml:mrow>
                              <mml:mo>𝕊</mml:mo>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mn>2</mml:mn>
                            </mml:mrow>
                          </mml:msup>
                        </mml:mrow>
                      </mml:msub>
                      <mml:mstyle displaystyle="true">
                        <mml:munderover accentunder="false" accent="false">
                          <mml:mrow>
                            <mml:mo>∑</mml:mo>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mi>i</mml:mi>
                            <mml:mo>=</mml:mo>
                            <mml:mn>1</mml:mn>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mi>N</mml:mi>
                          </mml:mrow>
                        </mml:munderover>
                      </mml:mstyle>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi>f</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>i</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                      <mml:msubsup>
                        <mml:mrow>
                          <mml:mi>C</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>i</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>K</mml:mi>
                        </mml:mrow>
                      </mml:msubsup>
                      <mml:mrow>
                        <mml:mo stretchy="false">(</mml:mo>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mstyle mathvariant="bold">
                                <mml:mtext>A</mml:mtext>
                              </mml:mstyle>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mi>s</mml:mi>
                            </mml:mrow>
                          </mml:msub>
                          <mml:mo>;</mml:mo>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mover accent="true">
                                <mml:mrow>
                                  <mml:mstyle mathvariant="bold">
                                    <mml:mtext>p</mml:mtext>
                                  </mml:mstyle>
                                </mml:mrow>
                                <mml:mo>~</mml:mo>
                              </mml:mover>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mi>i</mml:mi>
                            </mml:mrow>
                          </mml:msub>
                        </mml:mrow>
                        <mml:mo stretchy="false">)</mml:mo>
                      </mml:mrow>
                    </mml:mrow>
                    <mml:mo>]</mml:mo>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mo stretchy="false">(</mml:mo>
                    <mml:mrow>
                      <mml:mstyle mathvariant="bold">
                        <mml:mtext>n</mml:mtext>
                      </mml:mstyle>
                    </mml:mrow>
                    <mml:mo stretchy="false">)</mml:mo>
                  </mml:mrow>
                  <mml:mo>,</mml:mo>
                </mml:mtd>
              </mml:mtr>
            </mml:mtable>
          </mml:math>
        </disp-formula>
        <p>where <italic>f</italic><sub><italic>i</italic></sub> are the normalized volume fractions weighting the signal contribution of each convolution kernel, <bold>A</bold><sub><italic>s</italic></sub> the shell-wise acquisition parameters and <bold>u</bold> ∈ 𝕊<sup>2</sup> the integrated orientation variable. Notice that the spherical convolution is done separately for each shell <italic>s</italic>. We provide details on the numerical implementation of Equation (6) in the <xref ref-type="supplementary-material" rid="SM1">Supplementary Material</xref>. We will use the second shorthand in Equation (7) for spherical convolution hereafter.</p>
        <p>SD-models can be seen as a sub-MC-model, which can, in turn, be combined with other compartment models in Equation (3). In Snippet 3, lines 10 and 11, we illustrate how an SD model is instantiated given one or more input models. Note that, in this way, <italic>multiple</italic> convolution kernels are distributed by <italic>the same</italic> spherical distribution. As in PD models, in SD models the orientation parameters of the input models are removed, and the parameters of the spherical distribution are added. Note that we can stack and apply multiple distributions to parameters of input models. As a concrete example, using lines 15 and 17, we can simulate the signal from a white matter bundle whose axons are simultaneously distributed over diameter and dispersed over orientation.</p>
        <p><bold>SD1</bold>: The Watson distribution, defined as an isotropic Gaussian distribution on the sphere with orientation <bold>μ</bold> and concentration parameter κ. Following Zhang et al. (<xref rid="B83" ref-type="bibr">2012</xref>), we use the orientation dispersion index (ODI) as an optimization parameter, defining <italic>ODI</italic> = 0 as a spike function along <bold>μ</bold>, and <italic>ODI</italic> = 1 as an isotropically dispersed profile on the sphere.</p>
        <p><bold>SD2</bold> The Bingham Distribution, defined as an anisotropic Gaussian distribution on the sphere with orientation <bold>μ</bold> and primary and secondary concentration concentrations κ<sub>1</sub>, κ<sub>2</sub>. Following Tariq et al. (<xref rid="B70" ref-type="bibr">2016</xref>), analogously to SD1, we use optimization parameters <italic>ODI</italic> and β in lieu of the concentrations. The Bingham has an additional ψ “roll” parameter, which rotates the distribution about <bold>μ</bold>.</p>
      </sec>
      <sec>
        <title>2.6.3. Tissue Response Models (TR)</title>
        <p>Tissue Response (TR) models are non-parametric representations of the measured signal, which are recovered by averaging the signal in segmented voxels of specific tissue types. These models differ from the previously described parametric models in that they are not related to the “true” underlying EAP of the tissue. In Snippet 4 we provide the code to produce isotropic (TR1) and anisotropic (TR2) tissue response models, given some data segmentation. Formally, let <bold>X</bold><sub>iso</sub> and <bold>X</bold><sub>aniso</sub> be segmented voxels of isotropic and anisotropic diffusion profiles. Tissue response models are then created by first representing the signal in each voxel as rotational harmonics coefficients <bold>r</bold> with order <italic>l</italic> using a rotational harmonics transform (RHT)—see the <xref ref-type="supplementary-material" rid="SM1">Supplementary Material</xref>—and then averaging those coefficients. In doing so, we can separate the segmented tissue-specific <italic>S</italic><sub>0</sub> signal response and its shell-wise shape, allowing for so-called multi-tissue modeling (Jeurissen et al., <xref rid="B40" ref-type="bibr">2014</xref>).</p>
        <table-wrap id="d35e3117" position="float">
          <label>Snippet 4</label>
          <caption>
            <p>Instantiation of anisotropic and isotropic tissue response models, given some data segmentation. Notice that we can produce an isotropic or anisotropic TR-model regardless of the data, and that we also recover the mean signal amplitude <italic>S</italic><sub>0</sub> of the input data, which we can use later when setting up MC-models in Snippet 5.</p>
          </caption>
          <graphic xlink:href="fninf-13-00064-i0004"/>
        </table-wrap>
        <p><bold>TR1</bold>: The isotropic tissue response model is given by</p>
        <disp-formula id="E8">
          <label>(8)</label>
          <mml:math id="M20">
            <mml:mtable class="eqnarray" columnalign="left">
              <mml:mtr>
                <mml:mtd>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>S</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mn>0</mml:mn>
                    </mml:mrow>
                  </mml:msub>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>C</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mtext class="textrm" mathvariant="normal">TR1</mml:mtext>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mrow>
                    <mml:mo stretchy="false">(</mml:mo>
                    <mml:mrow>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mstyle mathvariant="bold">
                            <mml:mtext>A</mml:mtext>
                          </mml:mstyle>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>s</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                      <mml:mo>,</mml:mo>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mstyle mathvariant="bold">
                            <mml:mtext>r</mml:mtext>
                          </mml:mstyle>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>s</mml:mi>
                          <mml:mo>,</mml:mo>
                          <mml:mi>l</mml:mi>
                          <mml:mo>=</mml:mo>
                          <mml:mn>0</mml:mn>
                        </mml:mrow>
                      </mml:msub>
                    </mml:mrow>
                    <mml:mo stretchy="false">)</mml:mo>
                  </mml:mrow>
                  <mml:mo>=</mml:mo>
                  <mml:mfrac>
                    <mml:mrow>
                      <mml:mn>1</mml:mn>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi>N</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mtext class="textrm" mathvariant="normal">vox</mml:mtext>
                        </mml:mrow>
                      </mml:msub>
                    </mml:mrow>
                  </mml:mfrac>
                  <mml:mstyle displaystyle="true">
                    <mml:munderover accentunder="false" accent="false">
                      <mml:mrow>
                        <mml:mo>∑</mml:mo>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>i</mml:mi>
                        <mml:mo>=</mml:mo>
                        <mml:mn>1</mml:mn>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mi>N</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mtext class="textrm" mathvariant="normal">vox</mml:mtext>
                          </mml:mrow>
                        </mml:msub>
                      </mml:mrow>
                    </mml:munderover>
                  </mml:mstyle>
                  <mml:mtext class="textrm" mathvariant="normal">RHT</mml:mtext>
                  <mml:mrow>
                    <mml:mo>[</mml:mo>
                    <mml:mrow>
                      <mml:mi>S</mml:mi>
                      <mml:mrow>
                        <mml:mo stretchy="false">(</mml:mo>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mstyle mathvariant="bold">
                                <mml:mtext>x</mml:mtext>
                              </mml:mstyle>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mi>i</mml:mi>
                            </mml:mrow>
                          </mml:msub>
                          <mml:mo>,</mml:mo>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mstyle mathvariant="bold">
                                <mml:mtext>A</mml:mtext>
                              </mml:mstyle>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mi>s</mml:mi>
                            </mml:mrow>
                          </mml:msub>
                        </mml:mrow>
                        <mml:mo stretchy="false">)</mml:mo>
                      </mml:mrow>
                    </mml:mrow>
                    <mml:mo>]</mml:mo>
                  </mml:mrow>
                  <mml:mtext>     </mml:mtext>
                  <mml:mtext class="textrm" mathvariant="normal">for</mml:mtext>
                </mml:mtd>
              </mml:mtr>
              <mml:mtr>
                <mml:mtd>
                  <mml:mtext>                                         </mml:mtext>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mstyle mathvariant="bold">
                        <mml:mtext>x</mml:mtext>
                      </mml:mstyle>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>i</mml:mi>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mo>∈</mml:mo>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mstyle mathvariant="bold">
                        <mml:mtext>X</mml:mtext>
                      </mml:mstyle>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mtext class="textrm" mathvariant="normal">iso</mml:mtext>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mo>.</mml:mo>
                </mml:mtd>
              </mml:mtr>
            </mml:mtable>
          </mml:math>
        </disp-formula>
        <p>Notice that we recover the tissue-specific baseline intensity <italic>S</italic><sub>0, iso</sub>, and that only the <italic>l</italic> = 0 coefficients are needed to represent isotropic profiles.</p>
        <p><bold>TR2</bold>: The anisotropic tissue response model is given as</p>
        <disp-formula id="E10">
          <label>(9)</label>
          <mml:math id="M22">
            <mml:mtable class="eqnarray" columnalign="left">
              <mml:mtr>
                <mml:mtd>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>S</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mn>0</mml:mn>
                    </mml:mrow>
                  </mml:msub>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>C</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mtext class="textrm" mathvariant="normal">TR2</mml:mtext>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mrow>
                    <mml:mo stretchy="false">(</mml:mo>
                    <mml:mrow>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mstyle mathvariant="bold">
                            <mml:mtext>A</mml:mtext>
                          </mml:mstyle>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>s</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                      <mml:mo>,</mml:mo>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mstyle mathvariant="bold">
                            <mml:mtext>r</mml:mtext>
                          </mml:mstyle>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>s</mml:mi>
                          <mml:mo>,</mml:mo>
                          <mml:mi>l</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                      <mml:mo>,</mml:mo>
                      <mml:mstyle mathvariant="bold-italic">
                        <mml:mo>μ</mml:mo>
                      </mml:mstyle>
                    </mml:mrow>
                    <mml:mo stretchy="false">)</mml:mo>
                  </mml:mrow>
                  <mml:mo>=</mml:mo>
                  <mml:mfrac>
                    <mml:mrow>
                      <mml:mn>1</mml:mn>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi>N</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mtext class="textrm" mathvariant="normal">vox</mml:mtext>
                        </mml:mrow>
                      </mml:msub>
                    </mml:mrow>
                  </mml:mfrac>
                  <mml:mstyle displaystyle="true">
                    <mml:munderover accentunder="false" accent="false">
                      <mml:mrow>
                        <mml:mo>∑</mml:mo>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>i</mml:mi>
                        <mml:mo>=</mml:mo>
                        <mml:mn>1</mml:mn>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mi>N</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mtext class="textrm" mathvariant="normal">vox</mml:mtext>
                          </mml:mrow>
                        </mml:msub>
                      </mml:mrow>
                    </mml:munderover>
                  </mml:mstyle>
                  <mml:mtext class="textrm" mathvariant="normal">RHT</mml:mtext>
                  <mml:mrow>
                    <mml:mo>[</mml:mo>
                    <mml:mrow>
                      <mml:mi>S</mml:mi>
                      <mml:mrow>
                        <mml:mo stretchy="false">(</mml:mo>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mstyle mathvariant="bold">
                                <mml:mtext>x</mml:mtext>
                              </mml:mstyle>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mi>i</mml:mi>
                            </mml:mrow>
                          </mml:msub>
                          <mml:mo>,</mml:mo>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mstyle mathvariant="bold">
                                <mml:mtext>R</mml:mtext>
                              </mml:mstyle>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mi>i</mml:mi>
                            </mml:mrow>
                          </mml:msub>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mstyle mathvariant="bold">
                                <mml:mtext>A</mml:mtext>
                              </mml:mstyle>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mi>s</mml:mi>
                            </mml:mrow>
                          </mml:msub>
                        </mml:mrow>
                        <mml:mo stretchy="false">)</mml:mo>
                      </mml:mrow>
                    </mml:mrow>
                    <mml:mo>]</mml:mo>
                  </mml:mrow>
                  <mml:mtext>    </mml:mtext>
                  <mml:mtext class="textrm" mathvariant="normal">for</mml:mtext>
                </mml:mtd>
              </mml:mtr>
              <mml:mtr>
                <mml:mtd>
                  <mml:mtext>                                           </mml:mtext>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mstyle mathvariant="bold">
                        <mml:mtext>x</mml:mtext>
                      </mml:mstyle>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>i</mml:mi>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mo>∈</mml:mo>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mstyle mathvariant="bold">
                        <mml:mtext>X</mml:mtext>
                      </mml:mstyle>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mtext class="textrm" mathvariant="normal">aniso</mml:mtext>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mo>.</mml:mo>
                </mml:mtd>
              </mml:mtr>
            </mml:mtable>
          </mml:math>
        </disp-formula>
        <p>where we note that the TR2 model has an orientation <bold>μ</bold> and gradient orientations <bold>n</bold><sub><italic>s</italic></sub> are rotated with rotation matrix <bold>R</bold> such that the signal orientations (according to a DTI tensor) is pointing along the z-axis.</p>
      </sec>
    </sec>
    <sec>
      <title>2.7. Multi-Compartment Modeling Variants</title>
      <p>In section 2.3 we introduced the definition of standard MC-modeling. Dmipy, however, also implements alternative MC-modeling frameworks. In this section, we introduce the Multi-Compartment Spherical Mean (MC-SM) variant in section 2.7.1 and the Multi-Compartment Spherical Harmonics (MC-SH) variant in section 2.7.2.</p>
      <sec>
        <title>2.7.1. Multi-Compartment Spherical Mean Model (MC-SM)</title>
        <p>To estimate properties of the tissue microstructure that are independent of axon orientation dispersion and crossings, Kaden et al. (<xref rid="B44" ref-type="bibr">2015</xref>) noticed that the shell-wise spherical mean of the measured signal is invariant to these effects. Taking the spherical convolution in Equation (7), it is straightforward to show that the spherical mean of a spherical convolved convolution kernel is equal to the spherical mean of the kernel itself, by taking advantage of the fact that <inline-formula><mml:math id="M24"><mml:msub><mml:mrow><mml:mo>∫</mml:mo></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mo>𝕊</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:msub><mml:mi>F</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mstyle class="text"><mml:mtext mathvariant="bold">n</mml:mtext></mml:mstyle><mml:mo>;</mml:mo><mml:mstyle mathvariant="bold"><mml:mo>Ω</mml:mo></mml:mstyle></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>d</mml:mi><mml:mstyle class="text"><mml:mtext mathvariant="bold">n</mml:mtext></mml:mstyle><mml:mo>≡</mml:mo><mml:mn>1</mml:mn></mml:math></inline-formula>. Recalling section 2.4, we can simply use the spherical mean representation of a compartment model in Equation (3) to estimate the parameters for the generalized Multi-Compartment Spherical Mean (MC-SM) model as</p>
        <disp-formula id="E12">
          <label>(10)</label>
          <mml:math id="M25">
            <mml:mtable class="eqnarray" columnalign="right center left">
              <mml:mtr>
                <mml:mtd>
                  <mml:msup>
                    <mml:mrow>
                      <mml:mover accent="true">
                        <mml:mrow>
                          <mml:mstyle mathvariant="bold">
                            <mml:mtext>p</mml:mtext>
                          </mml:mstyle>
                        </mml:mrow>
                        <mml:mo>~</mml:mo>
                      </mml:mover>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mo>*</mml:mo>
                    </mml:mrow>
                  </mml:msup>
                  <mml:mrow>
                    <mml:mo stretchy="false">(</mml:mo>
                    <mml:mrow>
                      <mml:mstyle mathvariant="bold">
                        <mml:mtext>x</mml:mtext>
                      </mml:mstyle>
                    </mml:mrow>
                    <mml:mo stretchy="false">)</mml:mo>
                  </mml:mrow>
                  <mml:mo>=</mml:mo>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mtext class="textrm" mathvariant="normal">argmin</mml:mtext>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mover accent="true">
                        <mml:mrow>
                          <mml:mstyle mathvariant="bold">
                            <mml:mtext>p</mml:mtext>
                          </mml:mstyle>
                        </mml:mrow>
                        <mml:mo>~</mml:mo>
                      </mml:mover>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mstyle displaystyle="true">
                    <mml:mo>∫</mml:mo>
                    <mml:msup>
                      <mml:mrow>
                        <mml:mrow>
                          <mml:mo>[</mml:mo>
                          <mml:mrow>
                            <mml:msup>
                              <mml:mrow>
                                <mml:mi>E</mml:mi>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mtext class="textrm" mathvariant="normal">SM</mml:mtext>
                              </mml:mrow>
                            </mml:msup>
                            <mml:mrow>
                              <mml:mo stretchy="false">(</mml:mo>
                              <mml:mrow>
                                <mml:mstyle mathvariant="bold">
                                  <mml:mtext>x</mml:mtext>
                                </mml:mstyle>
                                <mml:mo>,</mml:mo>
                                <mml:msub>
                                  <mml:mrow>
                                    <mml:mstyle mathvariant="bold">
                                      <mml:mtext>A</mml:mtext>
                                    </mml:mstyle>
                                  </mml:mrow>
                                  <mml:mrow>
                                    <mml:mi>s</mml:mi>
                                  </mml:mrow>
                                </mml:msub>
                              </mml:mrow>
                              <mml:mo stretchy="false">)</mml:mo>
                            </mml:mrow>
                            <mml:mo>-</mml:mo>
                            <mml:msup>
                              <mml:mrow>
                                <mml:mover accent="true">
                                  <mml:mi>E</mml:mi>
                                  <mml:mo>^</mml:mo>
                                </mml:mover>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mtext class="textrm" mathvariant="normal">MC-SM</mml:mtext>
                              </mml:mrow>
                            </mml:msup>
                            <mml:mrow>
                              <mml:mo stretchy="false">(</mml:mo>
                              <mml:mrow>
                                <mml:msub>
                                  <mml:mrow>
                                    <mml:mstyle mathvariant="bold">
                                      <mml:mtext>A</mml:mtext>
                                    </mml:mstyle>
                                  </mml:mrow>
                                  <mml:mrow>
                                    <mml:mi>s</mml:mi>
                                  </mml:mrow>
                                </mml:msub>
                                <mml:mo>,</mml:mo>
                                <mml:mover accent="true">
                                  <mml:mrow>
                                    <mml:mstyle mathvariant="bold">
                                      <mml:mtext>p</mml:mtext>
                                    </mml:mstyle>
                                  </mml:mrow>
                                  <mml:mo>~</mml:mo>
                                </mml:mover>
                              </mml:mrow>
                              <mml:mo stretchy="false">)</mml:mo>
                            </mml:mrow>
                          </mml:mrow>
                          <mml:mo>]</mml:mo>
                        </mml:mrow>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mn>2</mml:mn>
                      </mml:mrow>
                    </mml:msup>
                  </mml:mstyle>
                  <mml:mi>d</mml:mi>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mstyle mathvariant="bold">
                        <mml:mtext>A</mml:mtext>
                      </mml:mstyle>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>s</mml:mi>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mo>,</mml:mo>
                </mml:mtd>
              </mml:mtr>
            </mml:mtable>
          </mml:math>
        </disp-formula>
        <disp-formula id="E13">
          <label>(11)</label>
          <mml:math id="M26">
            <mml:mtable class="eqnarray" columnalign="right center left">
              <mml:mtr>
                <mml:mtd>
                  <mml:mtext>              </mml:mtext>
                  <mml:mtext class="textrm" mathvariant="normal">with </mml:mtext>
                  <mml:msup>
                    <mml:mrow>
                      <mml:mover accent="true">
                        <mml:mi>E</mml:mi>
                        <mml:mo>^</mml:mo>
                      </mml:mover>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mtext class="textrm" mathvariant="normal">MC-SM</mml:mtext>
                    </mml:mrow>
                  </mml:msup>
                  <mml:mrow>
                    <mml:mo stretchy="false">(</mml:mo>
                    <mml:mrow>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mstyle mathvariant="bold">
                            <mml:mtext>A</mml:mtext>
                          </mml:mstyle>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>s</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                      <mml:mo>,</mml:mo>
                      <mml:mover accent="true">
                        <mml:mrow>
                          <mml:mstyle mathvariant="bold">
                            <mml:mtext>p</mml:mtext>
                          </mml:mstyle>
                        </mml:mrow>
                        <mml:mo>~</mml:mo>
                      </mml:mover>
                    </mml:mrow>
                    <mml:mo stretchy="false">)</mml:mo>
                  </mml:mrow>
                  <mml:mo>=</mml:mo>
                  <mml:mstyle displaystyle="true">
                    <mml:munderover accentunder="false" accent="false">
                      <mml:mrow>
                        <mml:mo>∑</mml:mo>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>i</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>N</mml:mi>
                      </mml:mrow>
                    </mml:munderover>
                  </mml:mstyle>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>f</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>i</mml:mi>
                    </mml:mrow>
                  </mml:msub>
                  <mml:msubsup>
                    <mml:mrow>
                      <mml:mi>C</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>i</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mtext class="textrm" mathvariant="normal">SM</mml:mtext>
                    </mml:mrow>
                  </mml:msubsup>
                  <mml:mrow>
                    <mml:mo stretchy="false">(</mml:mo>
                    <mml:mrow>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mstyle mathvariant="bold">
                            <mml:mtext>A</mml:mtext>
                          </mml:mstyle>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>s</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                      <mml:mo>,</mml:mo>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mover accent="true">
                            <mml:mrow>
                              <mml:mstyle mathvariant="bold">
                                <mml:mtext>p</mml:mtext>
                              </mml:mstyle>
                            </mml:mrow>
                            <mml:mo>~</mml:mo>
                          </mml:mover>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>i</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                    </mml:mrow>
                    <mml:mo stretchy="false">)</mml:mo>
                  </mml:mrow>
                  <mml:mo>,</mml:mo>
                </mml:mtd>
              </mml:mtr>
            </mml:mtable>
          </mml:math>
        </disp-formula>
        <p>where <inline-formula><mml:math id="M27"><mml:msup><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mstyle class="text"><mml:mtext class="textrm" mathvariant="normal">SM</mml:mtext></mml:mstyle></mml:mrow></mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mstyle class="text"><mml:mtext mathvariant="bold">x</mml:mtext></mml:mstyle><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mstyle class="text"><mml:mtext mathvariant="bold">A</mml:mtext></mml:mstyle></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> is the spherical mean of the measured signal, defined on shell-wise acquisition scheme <bold>A</bold><sub><italic>s</italic></sub>. Here <inline-formula><mml:math id="M28"><mml:mover accent="true"><mml:mrow><mml:mstyle class="text"><mml:mtext mathvariant="bold">p</mml:mtext></mml:mstyle></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:math></inline-formula> is again any model's parameters except its orientation <bold>μ</bold>, which is no longer relevant after taking the spherical mean. Using this MC-SM representation, any “standard” MC-model can be framed as a spherical mean model, enabling the creation of known models such as MC-MDI (Kaden et al., <xref rid="B42" ref-type="bibr">2016</xref>), or allowing exploration of new effects like an MC-SM version of ActiveAx (Pizzolato et al., <xref rid="B64" ref-type="bibr">2018</xref>).</p>
      </sec>
      <sec>
        <title>2.7.2. Multi-Compartment Spherical Harmonics Model (MC-SH)</title>
        <p>Using spherical harmonics (SH), it is possible to represent a spherical distribution of models non-parametrically if we know beforehand what are the convolution kernels for the included tissue types. Such an MC-SH model can again be written as a generalization of Equation (3) such that</p>
        <disp-formula id="E14">
          <label>(12)</label>
          <mml:math id="M29">
            <mml:mtable class="eqnarray" columnalign="left">
              <mml:mtr>
                <mml:mtd>
                  <mml:msup>
                    <mml:mrow>
                      <mml:mstyle mathvariant="bold">
                        <mml:mtext>c</mml:mtext>
                      </mml:mstyle>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mo>*</mml:mo>
                    </mml:mrow>
                  </mml:msup>
                  <mml:mrow>
                    <mml:mo stretchy="false">(</mml:mo>
                    <mml:mrow>
                      <mml:mstyle mathvariant="bold">
                        <mml:mtext>x</mml:mtext>
                      </mml:mstyle>
                    </mml:mrow>
                    <mml:mo stretchy="false">)</mml:mo>
                  </mml:mrow>
                  <mml:mo>=</mml:mo>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mtext class="textrm" mathvariant="normal">argmin</mml:mtext>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mstyle mathvariant="bold">
                        <mml:mtext>c</mml:mtext>
                      </mml:mstyle>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mstyle displaystyle="true">
                    <mml:mo>∫</mml:mo>
                    <mml:msup>
                      <mml:mrow>
                        <mml:mrow>
                          <mml:mo>[</mml:mo>
                          <mml:mrow>
                            <mml:mi>E</mml:mi>
                            <mml:mrow>
                              <mml:mo stretchy="false">(</mml:mo>
                              <mml:mrow>
                                <mml:mstyle mathvariant="bold">
                                  <mml:mtext>x</mml:mtext>
                                </mml:mstyle>
                                <mml:mo>,</mml:mo>
                                <mml:msub>
                                  <mml:mrow>
                                    <mml:mstyle mathvariant="bold">
                                      <mml:mtext>A</mml:mtext>
                                    </mml:mstyle>
                                  </mml:mrow>
                                  <mml:mrow>
                                    <mml:mi>s</mml:mi>
                                  </mml:mrow>
                                </mml:msub>
                              </mml:mrow>
                              <mml:mo stretchy="false">)</mml:mo>
                            </mml:mrow>
                            <mml:mo>-</mml:mo>
                            <mml:msup>
                              <mml:mrow>
                                <mml:mover accent="true">
                                  <mml:mi>E</mml:mi>
                                  <mml:mo>^</mml:mo>
                                </mml:mover>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mtext class="textrm" mathvariant="normal">MC-SH</mml:mtext>
                              </mml:mrow>
                            </mml:msup>
                            <mml:mrow>
                              <mml:mo stretchy="false">(</mml:mo>
                              <mml:mrow>
                                <mml:mstyle mathvariant="bold">
                                  <mml:mtext>A</mml:mtext>
                                </mml:mstyle>
                                <mml:mo>,</mml:mo>
                                <mml:mstyle mathvariant="bold">
                                  <mml:mtext>c</mml:mtext>
                                </mml:mstyle>
                                <mml:mo>|</mml:mo>
                                <mml:mover accent="true">
                                  <mml:mrow>
                                    <mml:mstyle mathvariant="bold">
                                      <mml:mtext>p</mml:mtext>
                                    </mml:mstyle>
                                  </mml:mrow>
                                  <mml:mo>~</mml:mo>
                                </mml:mover>
                              </mml:mrow>
                              <mml:mo stretchy="false">)</mml:mo>
                            </mml:mrow>
                          </mml:mrow>
                          <mml:mo>]</mml:mo>
                        </mml:mrow>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mn>2</mml:mn>
                      </mml:mrow>
                    </mml:msup>
                  </mml:mstyle>
                  <mml:mi>d</mml:mi>
                  <mml:mstyle mathvariant="bold">
                    <mml:mtext>A</mml:mtext>
                  </mml:mstyle>
                </mml:mtd>
              </mml:mtr>
              <mml:mtr>
                <mml:mtd>
                  <mml:mtext>                     </mml:mtext>
                  <mml:mtext class="textrm" mathvariant="normal">s.t.</mml:mtext>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mo class="qopname">F</mml:mo>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>i</mml:mi>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mrow>
                    <mml:mo stretchy="false">(</mml:mo>
                    <mml:mrow>
                      <mml:mstyle mathvariant="bold">
                        <mml:mtext>n</mml:mtext>
                      </mml:mstyle>
                      <mml:mo>;</mml:mo>
                      <mml:mstyle mathvariant="bold">
                        <mml:mtext>c</mml:mtext>
                      </mml:mstyle>
                    </mml:mrow>
                    <mml:mo stretchy="false">)</mml:mo>
                  </mml:mrow>
                  <mml:mo>≥</mml:mo>
                  <mml:mn>0</mml:mn>
                  <mml:mo>,</mml:mo>
                </mml:mtd>
              </mml:mtr>
            </mml:mtable>
          </mml:math>
        </disp-formula>
        <disp-formula id="E16">
          <label>(13)</label>
          <mml:math id="M31">
            <mml:mtable class="eqnarray" columnalign="right center left">
              <mml:mtr>
                <mml:mtd>
                  <mml:mtext>              </mml:mtext>
                  <mml:mtext class="textrm" mathvariant="normal">with </mml:mtext>
                  <mml:msup>
                    <mml:mrow>
                      <mml:mover accent="true">
                        <mml:mi>E</mml:mi>
                        <mml:mo>^</mml:mo>
                      </mml:mover>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mtext class="textrm" mathvariant="normal">MC-SH</mml:mtext>
                    </mml:mrow>
                  </mml:msup>
                  <mml:mrow>
                    <mml:mo stretchy="false">(</mml:mo>
                    <mml:mrow>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mstyle mathvariant="bold">
                            <mml:mtext>A</mml:mtext>
                          </mml:mstyle>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>s</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                      <mml:mo>,</mml:mo>
                      <mml:mstyle mathvariant="bold">
                        <mml:mtext>c</mml:mtext>
                      </mml:mstyle>
                      <mml:mo>|</mml:mo>
                      <mml:mover accent="true">
                        <mml:mrow>
                          <mml:mstyle mathvariant="bold">
                            <mml:mtext>p</mml:mtext>
                          </mml:mstyle>
                        </mml:mrow>
                        <mml:mo>~</mml:mo>
                      </mml:mover>
                    </mml:mrow>
                    <mml:mo stretchy="false">)</mml:mo>
                  </mml:mrow>
                  <mml:mo>=</mml:mo>
                  <mml:mrow>
                    <mml:mo>[</mml:mo>
                    <mml:mrow>
                      <mml:mstyle displaystyle="true">
                        <mml:munderover accentunder="false" accent="false">
                          <mml:mrow>
                            <mml:mo>∑</mml:mo>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mi>i</mml:mi>
                            <mml:mo>=</mml:mo>
                            <mml:mn>1</mml:mn>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mi>N</mml:mi>
                          </mml:mrow>
                        </mml:munderover>
                      </mml:mstyle>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mo class="qopname">F</mml:mo>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>i</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                      <mml:mrow>
                        <mml:mo stretchy="false">(</mml:mo>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mstyle mathvariant="bold">
                                <mml:mtext>c</mml:mtext>
                              </mml:mstyle>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mi>i</mml:mi>
                            </mml:mrow>
                          </mml:msub>
                        </mml:mrow>
                        <mml:mo stretchy="false">)</mml:mo>
                      </mml:mrow>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mo>*</mml:mo>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:msup>
                            <mml:mrow>
                              <mml:mo>𝕊</mml:mo>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mn>2</mml:mn>
                            </mml:mrow>
                          </mml:msup>
                        </mml:mrow>
                      </mml:msub>
                      <mml:msubsup>
                        <mml:mrow>
                          <mml:mi>C</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>i</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>K</mml:mi>
                        </mml:mrow>
                      </mml:msubsup>
                      <mml:mrow>
                        <mml:mo stretchy="false">(</mml:mo>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mstyle mathvariant="bold">
                                <mml:mtext>A</mml:mtext>
                              </mml:mstyle>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mi>s</mml:mi>
                            </mml:mrow>
                          </mml:msub>
                          <mml:mo>|</mml:mo>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mover accent="true">
                                <mml:mrow>
                                  <mml:mstyle mathvariant="bold">
                                    <mml:mtext>p</mml:mtext>
                                  </mml:mstyle>
                                </mml:mrow>
                                <mml:mo class="qopname">~</mml:mo>
                              </mml:mover>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mi>i</mml:mi>
                            </mml:mrow>
                          </mml:msub>
                        </mml:mrow>
                        <mml:mo stretchy="false">)</mml:mo>
                      </mml:mrow>
                    </mml:mrow>
                    <mml:mo>]</mml:mo>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mo stretchy="false">(</mml:mo>
                    <mml:mrow>
                      <mml:mstyle mathvariant="bold">
                        <mml:mtext>n</mml:mtext>
                      </mml:mstyle>
                    </mml:mrow>
                    <mml:mo stretchy="false">)</mml:mo>
                  </mml:mrow>
                  <mml:mo>,</mml:mo>
                </mml:mtd>
              </mml:mtr>
            </mml:mtable>
          </mml:math>
        </disp-formula>
        <p>where F(<bold>n</bold>;<bold>c</bold>) : 𝕊<sup>2</sup> → [−∞, ∞] represents a non-parametric spherical distribution given in SH coefficients <bold>c</bold>, and where <inline-formula><mml:math id="M32"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mo>·</mml:mo><mml:mo>|</mml:mo><mml:mover accent="true"><mml:mrow><mml:mstyle class="text"><mml:mtext mathvariant="bold">p</mml:mtext></mml:mstyle></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> means that kernel parameters <inline-formula><mml:math id="M33"><mml:mover accent="true"><mml:mrow><mml:mstyle class="text"><mml:mtext mathvariant="bold">p</mml:mtext></mml:mstyle></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:math></inline-formula> are known and fixed. Notice that we must impose F(<bold>n</bold>; <bold>c</bold>) ≥ 0 as the SH distribution is not positive definite by nature. In MC-SH models, the volume fractions <italic>f</italic><sub><italic>i</italic></sub> are included in <bold>c</bold><sub><italic>i</italic></sub>, and a unity constraint can be imposed if required. Note, however, that for practical reasons only one anisotropic convolution kernel may be present in Equation (13), unless their volume fractions <italic>f</italic><sub><italic>i</italic></sub> are fixed (as in Snippet 12).</p>
      </sec>
      <sec>
        <title>2.7.3. MC-Model Initialization</title>
        <p>We instantiate all three MC-models in Snippet 5. Let model_1 have one orientation and one other parameter with cardinality 1, and model_2 be isotropic with only one parameter. Inspecting the MC-model parameters, notice that they are simply an aggregation of the input parameters with the addition of volume fractions, and the inclusion of S0-responses is handled internally. To avoid duplicate parameter names, each parameter name is prepended with the input model name and its enumeration. The MC-SM model is only different from MC in that the orientation parameter of model_1 is removed, as orientations have no meaning in the spherical mean signal. For the MC-SH model, the orientation is removed as the input models are used as convolution kernels, and the SH-coefficients for the given spherical harmonics order are added as parameters. To simulate the signal for a single voxel the procedure is the same as for the CompartmentModel in Snippet 2. Simulating the signal for multiple voxels is a generalization of the single-voxel simulation, which can be handled by the mc_model.simulate_signal function.</p>
        <table-wrap id="d35e4188" position="float">
          <label>Snippet 5</label>
          <caption>
            <p>One-line instantiation of MultiCompartmentModel variants.</p>
          </caption>
          <graphic xlink:href="fninf-13-00064-i0005"/>
        </table-wrap>
      </sec>
    </sec>
    <sec>
      <title>2.8. Parameter Fixing, Linking, and Optimization Parameters</title>
      <p>After an MC-model is instantiated, the last step before the potential model fitting is the imposition of linked or fixed parameters or the addition of optimization parameters:</p>
      <list list-type="bullet">
        <list-item>
          <p>Parameter linking is used to impose certain mathematical relationships between otherwise independent parameters. Examples are setting parameters equal to each other (e.g., telling two models to have the same orientation), imposing a tortuosity constraint (e.g., Szafer et al., <xref rid="B69" ref-type="bibr">1995</xref>), or imposing that a parameter must be smaller or equal to another parameter (e.g., λ<sub>⊥</sub> ≤ λ<sub>∥</sub> for a Zeppelin);</p>
        </list-item>
        <list-item>
          <p>Parameter fixing is used to enable fixing of known global diffusion properties (e.g., CSF diffusivity), or to do parameter cascading, which is to fix voxel-wise varying parameters for a certain dataset, which have been optimized from a previous model;</p>
        </list-item>
        <list-item>
          <p>Optimization parameters are used to rescale a model parameter to a rescaled version that is more appropriate to the optimization problem, like using the Orientation Dispersion Index (ODI) in lieu of concentration parameter for a Watson distribution (Zhang et al., <xref rid="B83" ref-type="bibr">2012</xref>).</p>
        </list-item>
      </list>
      <p>In Snippet 6 we provide an example of how fixed and linked parameters can be included in instantiated distributed models and MC-models. We note that adding a tortuosity constraint can only be done at the distributed model level, and not the MC-modeling level because tortuosity turns the affected volume fraction into a non-linear parameter. At the MC-modeling level, we enforce that all volume fractions remain linear and independent, which is needed for some optimization algorithms like MIX (Farooq et al., <xref rid="B27" ref-type="bibr">2016</xref>) or AMICO (Daducci et al., <xref rid="B18" ref-type="bibr">2015</xref>).</p>
      <table-wrap id="d35e4230" position="float">
        <label>Snippet 6</label>
        <caption>
          <p>One-liners to setting fixed or linked parameters to instantiated distributed model or MC-models.</p>
        </caption>
        <graphic xlink:href="fninf-13-00064-i0006"/>
      </table-wrap>
    </sec>
    <sec>
      <title>2.9. Generalized Optimization Strategies</title>
      <p>Dmipy's generalized modeling approach also extends to implementations of standard optimization algorithms. We describe the fitting of MC and MC-SM models in section 2.9.1, and the fitting of MC-SH models in section 2.9.2. Finally, we discuss the secondary fitting of the signal (not the signal attenuation) for any MC-model variant in section 2.9.3.</p>
      <p>Regardless of the MC-model variant, choosing the optimization algorithm is straightforward, as we show in Snippet 7. It suffices to just set the optimization algorithm and potentially adjust the algorithm's parameters before fitting the data. Notice that only at the fit command does the acquisition scheme come into play—before this point the model is data independent. Fitting the data returns a fitted model representation, from which the fitted parameters can be recovered.</p>
      <table-wrap id="d35e4245" position="float">
        <label>Snippet 7</label>
        <caption>
          <p>Generalized Parameter Optimization.</p>
        </caption>
        <graphic xlink:href="fninf-13-00064-i0007"/>
      </table-wrap>
      <sec>
        <title>2.9.1. Fitting MC and MC-SM Models</title>
        <p>From the perspective of optimization, MC and MC-SM models, given in Equations (3) and (10), can be treated equally as non-convex optimization problems. Currently, we implement two optimization algorithms:</p>
        <p><bold>Brute2Fine</bold>: The standard “brute2fine” optimizer first uses brute force optimization by sampling all optimized parameters <bold>p</bold> on an equispaced grid of <italic>Ns</italic> samples between each parameter's minimum and maximum optimization bounds. Obtaining the best fitting starting position based on Equations (3) or (10), we then use the constrained optimization algorithms L-BFGS-B (Byrd et al., <xref rid="B11" ref-type="bibr">1995</xref>) of the open-source scipy package (Jones et al., <xref rid="B41" ref-type="bibr">2001</xref>) to obtain the locally best fitting parameters <bold>p</bold><sup>*</sup>. The unity constraint on <italic>f</italic><sub><italic>i</italic></sub> is enforced by nesting volume fraction following Zhang et al. (<xref rid="B83" ref-type="bibr">2012</xref>).</p>
        <p><bold>MIX</bold>: The recent Microstructure in Crossings (MIX) algorithm (Farooq et al., <xref rid="B27" ref-type="bibr">2016</xref>) is specially designed to return accurate results for highly complicated MC-models. Instead of using brute force, it uses a trick to separate the linear from non-linear parameters and uses differential evolution (Storn and Price, <xref rid="B68" ref-type="bibr">1997</xref>) to find the globally best-fitting parameters. It is accurate at the cost of being slow, so we recommend “brute2fine” for simpler models.</p>
      </sec>
      <sec>
        <title>2.9.2. MC-SH Fitting</title>
        <p>Fitting MC-SH models is different from MC or MC-SM models in that the problem can be cast in a convex optimization problem. In literature, the spherical harmonics distribution is often estimated using methods like Constrained Spherical Deconvolution (CSD) (Tournier et al., <xref rid="B72" ref-type="bibr">2007</xref>; Jeurissen et al., <xref rid="B40" ref-type="bibr">2014</xref>), although many variations of this approach have been proposed (Canales-Rodríguez et al., <xref rid="B14" ref-type="bibr">2019</xref>). Currently, we have implemented two algorithms:</p>
        <p><bold>Tournier07</bold>: This is the classical optimization algorithm for CSD following Tournier et al. (<xref rid="B72" ref-type="bibr">2007</xref>). It uses the Tikhonov regularization term to penalize negative F(<bold>n</bold>; <bold>c</bold>), but not explicitly forbid it. It is a fast implementation only based on Numpy (Oliphant, <xref rid="B59" ref-type="bibr">2006</xref>) but cannot handle multiple kernels, unless the volume fractions are fixed.</p>
        <p><bold>CVXPY</bold>: This implements the explicit multi-compartment CSD algorithm following Jeurissen et al. (<xref rid="B40" ref-type="bibr">2014</xref>) using the CVXPY package (Diamond and Boyd, <xref rid="B24" ref-type="bibr">2016</xref>; Agrawal et al., <xref rid="B2" ref-type="bibr">2018</xref>). It features a hard non-negativity constraint on the FOD, and can optionally enforce a unity constraint on the volume fractions. We note that enforcing the unity constraint is not recommended by Dell'Acqua and Tournier (<xref rid="B21" ref-type="bibr">2018</xref>) when tissue <italic>S</italic><sub>0</sub> responses are given.</p>
      </sec>
      <sec>
        <title>2.9.3. Secondary Multi-Tissue Optimization: Fitting the Signal</title>
        <p>So far, we have been considering fitting the signal attenuation only, ignoring the information that is present in the signal amplitude (see Equation 1). Recent works (Jeurissen et al., <xref rid="B40" ref-type="bibr">2014</xref>) show that including knowledge of the tissue-specific <italic>S</italic><sub>0</sub> response, and fitting the signal instead of the signal attenuation, can provide a better estimate of the linear volume fractions. We observe that this so-called Multi-Tissue modeling can be seen as a secondary convex optimization to correct the volume fractions after all non-linear parameters have been estimated. The optimization is given</p>
        <disp-formula id="E17">
          <label>(14)</label>
          <mml:math id="M34">
            <mml:mtable class="eqnarray" columnalign="right center left">
              <mml:mtr>
                <mml:mtd>
                  <mml:msup>
                    <mml:mrow>
                      <mml:mstyle mathvariant="bold">
                        <mml:mtext>f</mml:mtext>
                      </mml:mstyle>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mo>*</mml:mo>
                    </mml:mrow>
                  </mml:msup>
                  <mml:mrow>
                    <mml:mo stretchy="false">(</mml:mo>
                    <mml:mrow>
                      <mml:mstyle mathvariant="bold">
                        <mml:mtext>x</mml:mtext>
                      </mml:mstyle>
                    </mml:mrow>
                    <mml:mo stretchy="false">)</mml:mo>
                  </mml:mrow>
                  <mml:mo>=</mml:mo>
                  <mml:mtext> </mml:mtext>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mtext class="textrm" mathvariant="normal">argmin</mml:mtext>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mstyle mathvariant="bold">
                        <mml:mtext>f</mml:mtext>
                      </mml:mstyle>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mstyle displaystyle="true">
                    <mml:mo>∫</mml:mo>
                    <mml:msup>
                      <mml:mrow>
                        <mml:mrow>
                          <mml:mo>[</mml:mo>
                          <mml:mrow>
                            <mml:mi>S</mml:mi>
                            <mml:mrow>
                              <mml:mo stretchy="false">(</mml:mo>
                              <mml:mrow>
                                <mml:mstyle mathvariant="bold">
                                  <mml:mtext>x</mml:mtext>
                                </mml:mstyle>
                                <mml:mo>,</mml:mo>
                                <mml:mstyle mathvariant="bold">
                                  <mml:mtext>A</mml:mtext>
                                </mml:mstyle>
                              </mml:mrow>
                              <mml:mo stretchy="false">)</mml:mo>
                            </mml:mrow>
                            <mml:mo>-</mml:mo>
                            <mml:mstyle displaystyle="true">
                              <mml:munderover accentunder="false" accent="false">
                                <mml:mrow>
                                  <mml:mo>∑</mml:mo>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mi>i</mml:mi>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mi>N</mml:mi>
                                </mml:mrow>
                              </mml:munderover>
                            </mml:mstyle>
                            <mml:msub>
                              <mml:mrow>
                                <mml:mi>S</mml:mi>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mn>0</mml:mn>
                                <mml:mo>,</mml:mo>
                                <mml:mi>i</mml:mi>
                              </mml:mrow>
                            </mml:msub>
                            <mml:msub>
                              <mml:mrow>
                                <mml:mi>f</mml:mi>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mi>i</mml:mi>
                              </mml:mrow>
                            </mml:msub>
                            <mml:msub>
                              <mml:mrow>
                                <mml:mi>C</mml:mi>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mi>i</mml:mi>
                              </mml:mrow>
                            </mml:msub>
                            <mml:mrow>
                              <mml:mo stretchy="false">(</mml:mo>
                              <mml:mrow>
                                <mml:mstyle mathvariant="bold">
                                  <mml:mtext>A</mml:mtext>
                                </mml:mstyle>
                                <mml:mo>|</mml:mo>
                                <mml:msubsup>
                                  <mml:mrow>
                                    <mml:mstyle mathvariant="bold">
                                      <mml:mtext>p</mml:mtext>
                                    </mml:mstyle>
                                  </mml:mrow>
                                  <mml:mrow>
                                    <mml:mi>i</mml:mi>
                                  </mml:mrow>
                                  <mml:mrow>
                                    <mml:mo>*</mml:mo>
                                  </mml:mrow>
                                </mml:msubsup>
                              </mml:mrow>
                              <mml:mo stretchy="false">)</mml:mo>
                            </mml:mrow>
                          </mml:mrow>
                          <mml:mo>]</mml:mo>
                        </mml:mrow>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mn>2</mml:mn>
                      </mml:mrow>
                    </mml:msup>
                  </mml:mstyle>
                  <mml:mi>d</mml:mi>
                  <mml:mstyle mathvariant="bold">
                    <mml:mtext>A</mml:mtext>
                  </mml:mstyle>
                  <mml:mo>,</mml:mo>
                </mml:mtd>
              </mml:mtr>
            </mml:mtable>
          </mml:math>
        </disp-formula>
        <disp-formula id="E18">
          <label>(15)</label>
          <mml:math id="M35">
            <mml:mtable class="eqnarray" columnalign="right center left">
              <mml:mtr>
                <mml:mtd>
                  <mml:mtext>        </mml:mtext>
                  <mml:mo>=</mml:mo>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mtext class="textrm" mathvariant="normal">argmin</mml:mtext>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mstyle mathvariant="bold">
                        <mml:mtext>f</mml:mtext>
                      </mml:mstyle>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mo>∥</mml:mo>
                  <mml:mi>S</mml:mi>
                  <mml:mrow>
                    <mml:mo stretchy="false">(</mml:mo>
                    <mml:mrow>
                      <mml:mstyle mathvariant="bold">
                        <mml:mtext>x</mml:mtext>
                      </mml:mstyle>
                      <mml:mo>,</mml:mo>
                      <mml:mstyle mathvariant="bold">
                        <mml:mtext>A</mml:mtext>
                      </mml:mstyle>
                    </mml:mrow>
                    <mml:mo stretchy="false">)</mml:mo>
                  </mml:mrow>
                  <mml:mo>-</mml:mo>
                  <mml:mstyle mathvariant="bold">
                    <mml:mtext>B</mml:mtext>
                  </mml:mstyle>
                  <mml:mstyle mathvariant="bold">
                    <mml:mtext>f</mml:mtext>
                  </mml:mstyle>
                  <mml:msup>
                    <mml:mrow>
                      <mml:mo>∥</mml:mo>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mn>2</mml:mn>
                    </mml:mrow>
                  </mml:msup>
                </mml:mtd>
              </mml:mtr>
            </mml:mtable>
          </mml:math>
        </disp-formula>
        <p>with <inline-formula><mml:math id="M36"><mml:mstyle class="text"><mml:mtext mathvariant="bold">B</mml:mtext></mml:mstyle><mml:mo>=</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mstyle class="text"><mml:mtext mathvariant="bold">A</mml:mtext></mml:mstyle><mml:mo>|</mml:mo><mml:msubsup><mml:mrow><mml:mstyle class="text"><mml:mtext mathvariant="bold">p</mml:mtext></mml:mstyle></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>*</mml:mo></mml:mrow></mml:msubsup></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi>ℝ</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>D</mml:mi><mml:mi>W</mml:mi><mml:mi>I</mml:mi></mml:mrow></mml:msub><mml:mo>×</mml:mo><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mi>o</mml:mi><mml:mi>d</mml:mi><mml:mi>e</mml:mi><mml:mi>l</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup></mml:math></inline-formula> the model-wise evaluated parts of the MC-models at <bold>A</bold>, multiplied by the tissue-specific <italic>S</italic><sub>0</sub> intensity. Signal attenuation-based (shape only) MC-modeling—as we've been doing so far—implicitly assumes equal <italic>S</italic><sub>0, <italic>i</italic></sub> = <italic>S</italic><sub>0</sub>. This means that MC-models that model tissues with different <italic>S</italic><sub>0</sub> (e.g., CSF, white and gray matter) will always have biased volume fractions unless these effects are taken into account. In Dmipy, any MC-model can be corrected for this, as we showed in Snippet 5.</p>
      </sec>
    </sec>
    <sec>
      <title>2.10. Data Set Descriptions</title>
      <sec>
        <title>2.10.1. IVIM Data</title>
        <p>For our first demonstration, we will use a freely available dataset with an IVIM acquisition, which is downloadable from the dipy examples page (Garyfallidis et al., <xref rid="B33" ref-type="bibr">2014</xref>). It is a small dataset with only 21 DWIs at b-values spread between 0 − 1, 000<italic>s</italic>/<italic>mm</italic><sup>2</sup>, including a single <italic>b</italic><sub>0</sub> measurement. Information about diffusion times and TE are unknown for this data, but these will not be needed to fit the 2-compartment Gaussian IVIM model.</p>
      </sec>
      <sec>
        <title>2.10.2. Spatio-Temporal Cat Spinal Cord Data</title>
        <p>To illustrate MC-models that are aimed at estimating axon diameter, we use a recent dataset where both AxCaliber and multi-shell diffusion MRI acquisitions have been registered to one axial slice of cat spinal cord (Duval et al., <xref rid="B26" ref-type="bibr">2016</xref>). For each voxel, the mean axon diameter, restricted volume fraction and myelin volume fraction are known from histological measurements. The dMRI data is 64 × 64 voxels with resolution 0.16 × 0.16 × 0.16mm<sup>3</sup>. One AxCaliber acquisition was acquired (perpendicular to the axon axis) with parameters δ=3/8/8/8 ms, Δ = 7/12/25/40 ms, G = [0… 849] mT/m (199 increments) and TE minimized (36–62 ms). The data was TE-normalized by dividing the data for every TE by the G = 0 signal. The multi-shell acquisition was acquired with parameters δ = 3 ms, Δ = 30 ms, 4 shells with <italic>b</italic>-value={40, 189, 1,680, 6,720} s/mm<sup>2</sup>, TE = 47 ms, with a total of 796 diffusion-weighted images.</p>
      </sec>
      <sec>
        <title>2.10.3. Multi-Shell WU-Minn Human Connectome Project Data</title>
        <p>To illustrate MC-models that require only multi-shell data, we use the WU-Minn Human Connectome Project data (Feinberg et al., <xref rid="B28" ref-type="bibr">2010</xref>; Moeller et al., <xref rid="B52" ref-type="bibr">2010</xref>; Setsompop et al., <xref rid="B65" ref-type="bibr">2012</xref>; Xu et al., <xref rid="B82" ref-type="bibr">2012</xref>; Glasser et al., <xref rid="B34" ref-type="bibr">2013</xref>; Van Essen et al., <xref rid="B77" ref-type="bibr">2013</xref>). In this dataset, the diffusion directions were obtained such that every subset of the first M directions is still isotropic (Caruyer et al., <xref rid="B15" ref-type="bibr">2013</xref>). The data was sampled on 3 shells with <italic>b</italic>-values {0, 1,000, 2,000, 3,000}s/mm<sup>2</sup>, with {14, 90, 90, 90} directions, respectively. The diffusion time and pulse separation time in this data are δ/Δ = 10.6/43.1ms with 2 × 2 × 2mm resolution and <italic>TE</italic>/<italic>TR</italic> = 89.5/5, 520ms.</p>
      </sec>
    </sec>
  </sec>
  <sec id="s3">
    <title>3. Results: Dmipy MC-Model Implementations</title>
    <p>In this section, we demonstrate the power of Dmipy's modular MC-modeling design. We start by implementing, fitting and showing the results of many well-known MC-models known from the literature. The models we will illustrate are listed in <xref rid="T3" ref-type="table">Table 3</xref>, where we also indicate each model's composition in terms of biophysical models, the number of lines in Dmipy code it takes to implement, and the primary reference. Note that it is not the point here to deeply study each model's behavior, but to demonstrate how simple it is to create and fit any of them. Deeper, more detailed studies of each model are readily available as examples at the Dmipy Github page at <ext-link ext-link-type="uri" xlink:href="https://github.com/AthenaEPI/dmipy">https://github.com/AthenaEPI/dmipy</ext-link>. For each model, we will also denote its schematic, mathematical representation in terms of parameter dependencies, where we will use the “|” sign to separate estimated from fixed parameters during the optimization.</p>
    <table-wrap id="T3" position="float">
      <label>Table 3</label>
      <caption>
        <p>Overview and composition of implemented MC-models and the number of lines that is needed to implement them from scratch using Dmipy, along with their primary reference.</p>
      </caption>
      <table frame="hsides" rules="groups">
        <thead>
          <tr>
            <th valign="top" align="left" rowspan="1" colspan="1">
              <bold>Model acronym</bold>
            </th>
            <th valign="top" align="center" rowspan="1" colspan="1">
              <bold>Model composition</bold>
            </th>
            <th valign="top" align="center" rowspan="1" colspan="1">
              <bold>No. of lines</bold>
            </th>
            <th valign="top" align="center" rowspan="1" colspan="1">
              <bold>Primary references</bold>
            </th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td valign="top" align="left" rowspan="1" colspan="1">IVIM (Snip. 8)</td>
            <td valign="top" align="center" rowspan="1" colspan="1">2×G1</td>
            <td valign="top" align="center" rowspan="1" colspan="1">6</td>
            <td valign="top" align="left" rowspan="1" colspan="1">Le Bihan et al., <xref rid="B47" ref-type="bibr">1988</xref></td>
          </tr>
          <tr>
            <td valign="top" align="left" rowspan="1" colspan="1">AxCaliber (Snip. 9)</td>
            <td valign="top" align="center" rowspan="1" colspan="1">G1+PD1*C4</td>
            <td valign="top" align="center" rowspan="1" colspan="1">8</td>
            <td valign="top" align="left" rowspan="1" colspan="1">Assaf et al., <xref rid="B4" ref-type="bibr">2008</xref></td>
          </tr>
          <tr>
            <td valign="top" align="left" rowspan="1" colspan="1">Ball and Sticks (Snip. 10)</td>
            <td valign="top" align="center" rowspan="1" colspan="1">G1+N×C1</td>
            <td valign="top" align="center" rowspan="1" colspan="1">6</td>
            <td valign="top" align="left" rowspan="1" colspan="1">Behrens et al., <xref rid="B9" ref-type="bibr">2003</xref></td>
          </tr>
          <tr>
            <td valign="top" align="left" rowspan="1" colspan="1">NODDI(-x) (Snip. 11)</td>
            <td valign="top" align="center" rowspan="1" colspan="1">G1+SD3*(C1+G2)</td>
            <td valign="top" align="center" rowspan="1" colspan="1">12</td>
            <td valign="top" align="left" rowspan="1" colspan="1">Zhang et al., <xref rid="B83" ref-type="bibr">2012</xref></td>
          </tr>
          <tr>
            <td valign="top" align="left" rowspan="1" colspan="1">Bingham-NODDI (Snip. 11)</td>
            <td valign="top" align="center" rowspan="1" colspan="1">G1+SD2*(C1+G2)</td>
            <td valign="top" align="center" rowspan="1" colspan="1">12</td>
            <td valign="top" align="left" rowspan="1" colspan="1">Tariq et al., <xref rid="B70" ref-type="bibr">2016</xref></td>
          </tr>
          <tr>
            <td valign="top" align="left" rowspan="1" colspan="1">MC-MDI-CSD (Snip. 12)</td>
            <td valign="top" align="center" rowspan="1" colspan="1">SD1*(C1+G2)</td>
            <td valign="top" align="center" rowspan="1" colspan="1">12</td>
            <td valign="top" align="left" rowspan="1" colspan="1">Kaden et al., <xref rid="B42" ref-type="bibr">2016</xref></td>
          </tr>
          <tr>
            <td valign="top" align="left" rowspan="1" colspan="1">MT-CSD (Snip. 13)</td>
            <td valign="top" align="center" rowspan="1" colspan="1">2×TR1+TR2</td>
            <td valign="top" align="center" rowspan="1" colspan="1">6</td>
            <td valign="top" align="left" rowspan="1" colspan="1">Jeurissen et al., <xref rid="B40" ref-type="bibr">2014</xref></td>
          </tr>
          <tr style="border-bottom: thin solid #000000;">
            <td valign="top" align="left" rowspan="1" colspan="1">SS3T-CSD (Snip. 14)</td>
            <td valign="top" align="center" rowspan="1" colspan="1">2×TR1+TR2</td>
            <td valign="top" align="center" rowspan="1" colspan="1">19</td>
            <td valign="top" align="left" rowspan="1" colspan="1">Dhollander and Connelly, <xref rid="B22" ref-type="bibr">2016</xref></td>
          </tr>
          <tr>
            <td valign="top" align="left" rowspan="1" colspan="1">ActiveAx<break/>(<xref ref-type="supplementary-material" rid="SM1">Supplementary Material</xref>)</td>
            <td valign="top" align="center" rowspan="1" colspan="1">G1+G2+S1+C4</td>
            <td valign="top" align="center" rowspan="1" colspan="1">13</td>
            <td valign="top" align="left" rowspan="1" colspan="1">Alexander et al., <xref rid="B3" ref-type="bibr">2010</xref></td>
          </tr>
          <tr>
            <td valign="top" align="left" rowspan="1" colspan="1">VERDICT<break/>(<xref ref-type="supplementary-material" rid="SM1">Supplementary Material</xref>)</td>
            <td valign="top" align="center" rowspan="1" colspan="1">S4+G1+C1</td>
            <td valign="top" align="center" rowspan="1" colspan="1">8</td>
            <td valign="top" align="left" rowspan="1" colspan="1">Panagiotaki et al., <xref rid="B62" ref-type="bibr">2014</xref></td>
          </tr>
          <tr>
            <td valign="top" align="left" rowspan="1" colspan="1">SMT<break/>(<xref ref-type="supplementary-material" rid="SM1">Supplementary Material</xref>)</td>
            <td valign="top" align="center" rowspan="1" colspan="1">G2</td>
            <td valign="top" align="center" rowspan="1" colspan="1">5</td>
            <td valign="top" align="left" rowspan="1" colspan="1">Kaden et al., <xref rid="B44" ref-type="bibr">2015</xref></td>
          </tr>
          <tr>
            <td valign="top" align="left" rowspan="1" colspan="1">SMT-NODDI<break/>(<xref ref-type="supplementary-material" rid="SM1">Supplementary Material</xref>)</td>
            <td valign="top" align="center" rowspan="1" colspan="1">G1+SD3*(C1+G2)</td>
            <td valign="top" align="center" rowspan="1" colspan="1">21</td>
            <td valign="top" align="left" rowspan="1" colspan="1">Cabeen et al., <xref rid="B12" ref-type="bibr">2019</xref></td>
          </tr>
          <tr>
            <td valign="top" align="left" rowspan="1" colspan="1">CSD<break/>(<xref ref-type="supplementary-material" rid="SM1">Supplementary Material</xref>)</td>
            <td valign="top" align="center" rowspan="1" colspan="1">TR2</td>
            <td valign="top" align="center" rowspan="1" colspan="1">6</td>
            <td valign="top" align="left" rowspan="1" colspan="1">Tournier et al., <xref rid="B72" ref-type="bibr">2007</xref></td>
          </tr>
        </tbody>
      </table>
      <table-wrap-foot>
        <p><italic>The MC-models above the midline are presented in the results section of this work, while the implementations of those below the midline are provided in the <xref ref-type="supplementary-material" rid="SM1">Supplementary Material</xref></italic>.</p>
      </table-wrap-foot>
    </table-wrap>
    <sec>
      <title>3.1. IVIM</title>
      <p>Intra-voxel incoherent motion (IVIM) is one of the first MC-models used in dMRI (Le Bihan et al., <xref rid="B47" ref-type="bibr">1988</xref>). It uses a 2-compartment model that separates diffusion signal contributions originating from blood flow and Brownian diffusion. The model consists of 2 Ball compartments, each fitting the volume fractions and diffusivities of the blood flow and diffusion, respectively. Changes in e.g., blood volume fraction has been linked to many pathologies such as the vasculature in tumor tissue (Le Bihan, <xref rid="B46" ref-type="bibr">2017</xref>). We represent IVIM in terms of its parameters and the meaning that is assigned to the biophysical models it is composed of, as</p>
      <disp-formula id="E19">
        <label>(16)</label>
        <mml:math id="M37">
          <mml:mtable class="eqnarray" columnalign="right center left">
            <mml:mtr>
              <mml:mtd>
                <mml:mi>M</mml:mi>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>C</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mtext class="textrm" mathvariant="normal">IVIM</mml:mtext>
                  </mml:mrow>
                </mml:msub>
                <mml:mo>=</mml:mo>
                <mml:mstyle displaystyle="true">
                  <mml:munder class="msub">
                    <mml:mrow>
                      <mml:mstyle displaystyle="true">
                        <mml:munder accentunder="false">
                          <mml:mrow>
                            <mml:msub>
                              <mml:mrow>
                                <mml:mi>f</mml:mi>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mtext class="textrm" mathvariant="normal">blood</mml:mtext>
                              </mml:mrow>
                            </mml:msub>
                            <mml:mover class="msup">
                              <mml:mrow>
                                <mml:mover accent="false">
                                  <mml:mrow>
                                    <mml:mtext class="textrm" mathvariant="normal">G1</mml:mtext>
                                    <mml:mrow>
                                      <mml:mo stretchy="false">(</mml:mo>
                                      <mml:mrow>
                                        <mml:mo>·</mml:mo>
                                        <mml:mo>|</mml:mo>
                                        <mml:msub>
                                          <mml:mrow>
                                            <mml:mo>λ</mml:mo>
                                          </mml:mrow>
                                          <mml:mrow>
                                            <mml:mtext class="textrm" mathvariant="normal">Blood</mml:mtext>
                                          </mml:mrow>
                                        </mml:msub>
                                      </mml:mrow>
                                      <mml:mo stretchy="false">)</mml:mo>
                                    </mml:mrow>
                                  </mml:mrow>
                                  <mml:mo>︷</mml:mo>
                                </mml:mover>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mtext class="textrm" mathvariant="normal">Ball</mml:mtext>
                              </mml:mrow>
                            </mml:mover>
                          </mml:mrow>
                          <mml:mo>︸</mml:mo>
                        </mml:munder>
                      </mml:mstyle>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mtext class="textrm" mathvariant="normal">Blood</mml:mtext>
                    </mml:mrow>
                  </mml:munder>
                </mml:mstyle>
                <mml:mo>+</mml:mo>
                <mml:mstyle displaystyle="true">
                  <mml:munder class="msub">
                    <mml:mrow>
                      <mml:mstyle displaystyle="true">
                        <mml:munder accentunder="false">
                          <mml:mrow>
                            <mml:msub>
                              <mml:mrow>
                                <mml:mi>f</mml:mi>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mtext class="textrm" mathvariant="normal">Diffusion</mml:mtext>
                              </mml:mrow>
                            </mml:msub>
                            <mml:mover class="msup">
                              <mml:mrow>
                                <mml:mover accent="false">
                                  <mml:mrow>
                                    <mml:mtext class="textrm" mathvariant="normal">G1</mml:mtext>
                                    <mml:mrow>
                                      <mml:mo stretchy="false">(</mml:mo>
                                      <mml:mrow>
                                        <mml:msub>
                                          <mml:mrow>
                                            <mml:mo>λ</mml:mo>
                                          </mml:mrow>
                                          <mml:mrow>
                                            <mml:mtext class="textrm" mathvariant="normal">Diffusion</mml:mtext>
                                          </mml:mrow>
                                        </mml:msub>
                                      </mml:mrow>
                                      <mml:mo stretchy="false">)</mml:mo>
                                    </mml:mrow>
                                  </mml:mrow>
                                  <mml:mo>︷</mml:mo>
                                </mml:mover>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mtext class="textrm" mathvariant="normal">Ball</mml:mtext>
                              </mml:mrow>
                            </mml:mover>
                          </mml:mrow>
                          <mml:mo>︸</mml:mo>
                        </mml:munder>
                      </mml:mstyle>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mtext class="textrm" mathvariant="normal">Diffusion</mml:mtext>
                    </mml:mrow>
                  </mml:munder>
                </mml:mstyle>
                <mml:mo>.</mml:mo>
              </mml:mtd>
            </mml:mtr>
          </mml:mtable>
        </mml:math>
      </disp-formula>
      <p>The implementation of Equation (16) is given in Snippet 8. Following recommendations by Gurney-Champion et al. (<xref rid="B35" ref-type="bibr">2016</xref>) and Park et al. (<xref rid="B63" ref-type="bibr">2017</xref>), we can adjust IVIM's optimization bounds of the diffusion signal diffusivity between [0.5−6] × 10<sup>−9</sup><italic>m</italic><sup>2</sup>/<italic>s</italic>, and the blood flow diffusivity between [6−20] × 10<sup>−9</sup><italic>m</italic><sup>2</sup>/<italic>s</italic>. Following Gurney-Champion et al. (<xref rid="B36" ref-type="bibr">2018</xref>), we can also fix <inline-formula><mml:math id="M38"><mml:msub><mml:mrow><mml:mo>λ</mml:mo></mml:mrow><mml:mrow><mml:mstyle class="text"><mml:mtext class="textrm" mathvariant="normal">Blood</mml:mtext></mml:mstyle></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>7</mml:mn><mml:mo>×</mml:mo><mml:mn>1</mml:mn><mml:msup><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>9</mml:mn></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>/</mml:mo><mml:mi>s</mml:mi></mml:math></inline-formula> to obtain similar results for the remaining parameters. We fit the fixed IVIM model to the IVIM data described in section 2.10.1, and present the parameter maps of an axial brain slice in <xref ref-type="fig" rid="F4">Figure 4</xref>. Notice that signal contributions due to blood flow are significant near the ventricles and the sulci. For a voxel where blood flow and diffusion signal contributions were found to be approximately equal, we also demonstrate the fitted signals of the separate Ball compartments. Notice that blood flow contribution is represented by the fast-decaying, green-dashed line, and the diffusion contribution by the slow-decaying, orange-dashed line.</p>
      <table-wrap id="d35e5151" position="float">
        <label>Snippet 8</label>
        <caption>
          <p>Basic Dmipy implementation of classic IVIM model in 6 lines of code. We set optimization ranges according to suggestions by Park et al. (<xref rid="B63" ref-type="bibr">2017</xref>) and Gurney-Champion et al. (<xref rid="B36" ref-type="bibr">2018</xref>).</p>
        </caption>
        <graphic xlink:href="fninf-13-00064-i0008"/>
      </table-wrap>
      <fig id="F4" position="float">
        <label>Figure 4</label>
        <caption>
          <p>IVIM parameter maps for <italic>S</italic><sub>0</sub>
<bold>(A)</bold>, λ<sub>Diffusion</sub>
<bold>(B)</bold>, and <italic>f</italic><sub>blood</sub>
<bold>(C)</bold>, following Equation (16). Notice that the parameter maps are articulate, and the estimated blood volume fraction is significant near the corpus callosum and the sulci. In <bold>(D)</bold> we show an example IVIM fit in a corpus callosum voxel, where we illustrate that the total fitted signal is just the sum of the diffusion and blood signal contributions.</p>
        </caption>
        <graphic xlink:href="fninf-13-00064-g0004"/>
      </fig>
    </sec>
    <sec>
      <title>3.2. AxCaliber</title>
      <p>The estimation of axon diameter from the dMRI signal has been one of the main focuses of dMRI-based microstructure imaging. To this end, we implement the AxCaliber model (Assaf et al., <xref rid="B4" ref-type="bibr">2008</xref>), which models the axon diameter distribution as a set of cylinders with Gamma-distributed diameters. It is given as a two-compartment model as</p>
      <disp-formula id="E20">
        <label>(17)</label>
        <mml:math id="M39">
          <mml:mtable class="eqnarray" columnalign="right center left">
            <mml:mtr>
              <mml:mtd>
                <mml:mi>M</mml:mi>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>C</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mtext class="textrm" mathvariant="normal">AxCaliber</mml:mtext>
                  </mml:mrow>
                </mml:msub>
                <mml:mo>=</mml:mo>
                <mml:mstyle displaystyle="true">
                  <mml:munder class="msub">
                    <mml:mrow>
                      <mml:mstyle displaystyle="true">
                        <mml:munder accentunder="false">
                          <mml:mrow>
                            <mml:mrow>
                              <mml:mo stretchy="false">(</mml:mo>
                              <mml:mrow>
                                <mml:mn>1</mml:mn>
                                <mml:mo>-</mml:mo>
                                <mml:msub>
                                  <mml:mrow>
                                    <mml:mi>f</mml:mi>
                                  </mml:mrow>
                                  <mml:mrow>
                                    <mml:mtext class="textrm" mathvariant="normal">intra</mml:mtext>
                                  </mml:mrow>
                                </mml:msub>
                              </mml:mrow>
                              <mml:mo stretchy="false">)</mml:mo>
                            </mml:mrow>
                            <mml:mover class="msup">
                              <mml:mrow>
                                <mml:mover accent="false">
                                  <mml:mrow>
                                    <mml:mtext class="textrm" mathvariant="normal">G1</mml:mtext>
                                    <mml:mrow>
                                      <mml:mo stretchy="false">(</mml:mo>
                                      <mml:mrow>
                                        <mml:msub>
                                          <mml:mrow>
                                            <mml:mo>λ</mml:mo>
                                          </mml:mrow>
                                          <mml:mrow>
                                            <mml:mtext class="textrm" mathvariant="normal">h</mml:mtext>
                                          </mml:mrow>
                                        </mml:msub>
                                      </mml:mrow>
                                      <mml:mo stretchy="false">)</mml:mo>
                                    </mml:mrow>
                                  </mml:mrow>
                                  <mml:mo>︷</mml:mo>
                                </mml:mover>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mtext class="textrm" mathvariant="normal">Ball</mml:mtext>
                              </mml:mrow>
                            </mml:mover>
                          </mml:mrow>
                          <mml:mo>︸</mml:mo>
                        </mml:munder>
                      </mml:mstyle>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mtext class="textrm" mathvariant="normal">Extra-Axonal</mml:mtext>
                    </mml:mrow>
                  </mml:munder>
                </mml:mstyle>
                <mml:mo>+</mml:mo>
                <mml:mstyle displaystyle="true">
                  <mml:munder class="msub">
                    <mml:mrow>
                      <mml:mstyle displaystyle="true">
                        <mml:munder accentunder="false">
                          <mml:mrow>
                            <mml:msub>
                              <mml:mrow>
                                <mml:mi>f</mml:mi>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mtext class="textrm" mathvariant="normal">intra</mml:mtext>
                              </mml:mrow>
                            </mml:msub>
                            <mml:mover class="msup">
                              <mml:mrow>
                                <mml:mover accent="false">
                                  <mml:mrow>
                                    <mml:mtext class="textrm" mathvariant="normal">PD1</mml:mtext>
                                    <mml:mrow>
                                      <mml:mo stretchy="false">(</mml:mo>
                                      <mml:mrow>
                                        <mml:mi>α</mml:mi>
                                        <mml:mo>,</mml:mo>
                                        <mml:mi>β</mml:mi>
                                        <mml:mo>|</mml:mo>
                                        <mml:mstyle mathvariant="bold-italic">
                                          <mml:mo>μ</mml:mo>
                                        </mml:mstyle>
                                        <mml:mo>,</mml:mo>
                                        <mml:msub>
                                          <mml:mrow>
                                            <mml:mo>λ</mml:mo>
                                          </mml:mrow>
                                          <mml:mrow>
                                            <mml:mo>∥</mml:mo>
                                          </mml:mrow>
                                        </mml:msub>
                                      </mml:mrow>
                                      <mml:mo stretchy="false">)</mml:mo>
                                    </mml:mrow>
                                  </mml:mrow>
                                  <mml:mo>︷</mml:mo>
                                </mml:mover>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mtext class="textrm" mathvariant="normal">Gamma Distributed Cylinders</mml:mtext>
                              </mml:mrow>
                            </mml:mover>
                          </mml:mrow>
                          <mml:mo>︸</mml:mo>
                        </mml:munder>
                      </mml:mstyle>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mtext class="textrm" mathvariant="normal">Intra-Axonal</mml:mtext>
                    </mml:mrow>
                  </mml:munder>
                </mml:mstyle>
                <mml:mo>,</mml:mo>
              </mml:mtd>
            </mml:mtr>
          </mml:mtable>
        </mml:math>
      </disp-formula>
      <p>where the Ball captures all extra-axonal signal contributions. We note that the cylinder's perpendicular, intra-cylindrical diffusivity is fixed, but it's value is rarely important as for clinically relevant diffusion times the intra-axonal diffusion is restricted anyway (Assaf and Pasternak, <xref rid="B6" ref-type="bibr">2008</xref>). We implement the AxCaliber model in Snippet 9. We use the MIX algorithm to fit AxCaliber to the cat spinal cord data described in section 2.10.2. We chose this data because it has extremely large gradients, which are needed to get enough signal contrast for axon diameter estimation (Drobnjak et al., <xref rid="B25" ref-type="bibr">2016</xref>). As we know the axons are pointing in-plane for the spinal cord, we fixed the orientation of the cylinders to the z-axis, and the parallel diffusivity <inline-formula><mml:math id="M40"><mml:msub><mml:mrow><mml:mo>λ</mml:mo></mml:mrow><mml:mrow><mml:mo>∥</mml:mo></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>.</mml:mo><mml:mn>7</mml:mn><mml:mo>×</mml:mo><mml:mn>1</mml:mn><mml:msup><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>9</mml:mn></mml:mrow></mml:msup></mml:math></inline-formula>[<italic>m</italic><sup>2</sup>/<italic>s</italic>]. We show the resulting parameter maps in <xref ref-type="fig" rid="F5">Figure 5A</xref>. As the results show, the mean axon diameter, estimated as 2αβ of the Gamma distribution, falls within a slightly larger range 3–9 μm than what is known from histology 1–5 μm. This is similar to what Duval et al. (<xref rid="B26" ref-type="bibr">2016</xref>) previously found when studying this data with AxCaliber. Even so, even though the mean axon diameter may be similar, we do obtain different diameter distributions as illustrate in <xref ref-type="fig" rid="F5">Figure 5B</xref>.</p>
      <table-wrap id="d35e5391" position="float">
        <label>Snippet 9</label>
        <caption>
          <p>Dmipy implementation of AxCaliber model in 8 lines of code.</p>
        </caption>
        <graphic xlink:href="fninf-13-00064-i0009"/>
      </table-wrap>
      <fig id="F5" position="float">
        <label>Figure 5</label>
        <caption>
          <p><bold>(A)</bold> The estimated AxCaliber parameter maps. In the map for α, we circled three areas with somewhat different values for α, β, which we use to generate the estimated axon diameter distribution in <bold>(B)</bold>. Notice that while the mean axon diameter of these distributions is similar, the distributions themselves may be quite different.</p>
        </caption>
        <graphic xlink:href="fninf-13-00064-g0005"/>
      </fig>
    </sec>
    <sec>
      <title>3.3. Ball and Stick and NODDI Variants</title>
      <p>Another main focus of the field has been the estimation of axon orientation dispersion, which is described as the concentration with which the orientation of individual axons is centered around the main bundle axis. In some respects, this tissue property is easier to estimate from the data because it affects the signal at near-clinically feasible gradient strengths (Zhang et al., <xref rid="B83" ref-type="bibr">2012</xref>). The main hypothesis of axon dispersion-based MC-models is that at lower b-values the axon diameter has no effect on the signal, so is assumed to be negligible. The Cylinder model we used in section 3.2 is therefore replaced with a Stick model.</p>
      <p>Representing the intra-axonal signal as a Stick, and anything else as Ball, the iconic Ball and Stick (BAS) MC-model was one of the first to estimate the white matter orientation and signal contribution from the dMRI signal (Behrens et al., <xref rid="B9" ref-type="bibr">2003</xref>). Axon dispersion was then modeled by adding a parametric distribution on the orientation of the Stick (Kaden et al., <xref rid="B43" ref-type="bibr">2007</xref>; Sotiropoulos et al., <xref rid="B66" ref-type="bibr">2013</xref>). In particular, using a Watson distribution, in combination with a tortuous Zeppelin to capture the extra-axonal signal, is called the NODDI model (Zhang et al., <xref rid="B83" ref-type="bibr">2012</xref>). Adding multiple dispersed Stick and Zeppelin bundles to represent crossing tissue configurations is called NODDI in crossings (NODDIx) (Farooq et al., <xref rid="B27" ref-type="bibr">2016</xref>), and replacing the Watson with a Bingham distribution is called Bingham-NODDI (Tariq et al., <xref rid="B70" ref-type="bibr">2016</xref>). These MC-model variants are represented as</p>
      <disp-formula id="E21">
        <label>(18)</label>
        <mml:math id="M41">
          <mml:mtable class="eqnarray" columnalign="left">
            <mml:mtr>
              <mml:mtd>
                <mml:mi>M</mml:mi>
                <mml:msubsup>
                  <mml:mrow>
                    <mml:mi>C</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mtext class="textrm" mathvariant="normal">Sticks</mml:mtext>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mtext class="textrm" mathvariant="normal">Ball and</mml:mtext>
                  </mml:mrow>
                </mml:msubsup>
                <mml:mo>=</mml:mo>
                <mml:mstyle displaystyle="true">
                  <mml:munder class="msub">
                    <mml:mrow>
                      <mml:mstyle displaystyle="true">
                        <mml:munder accentunder="false">
                          <mml:mrow>
                            <mml:msub>
                              <mml:mrow>
                                <mml:mi>f</mml:mi>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mi>h</mml:mi>
                              </mml:mrow>
                            </mml:msub>
                            <mml:mover class="msup">
                              <mml:mrow>
                                <mml:mover accent="false">
                                  <mml:mrow>
                                    <mml:mtext class="textrm" mathvariant="normal">G1</mml:mtext>
                                    <mml:mrow>
                                      <mml:mo stretchy="false">(</mml:mo>
                                      <mml:mrow>
                                        <mml:msub>
                                          <mml:mrow>
                                            <mml:mo>λ</mml:mo>
                                          </mml:mrow>
                                          <mml:mrow>
                                            <mml:mtext class="textrm" mathvariant="normal">iso</mml:mtext>
                                          </mml:mrow>
                                        </mml:msub>
                                      </mml:mrow>
                                      <mml:mo stretchy="false">)</mml:mo>
                                    </mml:mrow>
                                  </mml:mrow>
                                  <mml:mo>︷</mml:mo>
                                </mml:mover>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mtext class="textrm" mathvariant="normal">Ball</mml:mtext>
                              </mml:mrow>
                            </mml:mover>
                          </mml:mrow>
                          <mml:mo>︸</mml:mo>
                        </mml:munder>
                      </mml:mstyle>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mtext class="textrm" mathvariant="normal">Extra-Axonal</mml:mtext>
                    </mml:mrow>
                  </mml:munder>
                </mml:mstyle>
                <mml:mo>+</mml:mo>
                <mml:mstyle displaystyle="true">
                  <mml:munderover accentunder="false" accent="false">
                    <mml:mrow>
                      <mml:mo>∑</mml:mo>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>i</mml:mi>
                      <mml:mo>=</mml:mo>
                      <mml:mn>1</mml:mn>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>N</mml:mi>
                    </mml:mrow>
                  </mml:munderover>
                </mml:mstyle>
                <mml:mstyle displaystyle="true">
                  <mml:munder class="msub">
                    <mml:mrow>
                      <mml:mstyle displaystyle="true">
                        <mml:munder accentunder="false">
                          <mml:mrow>
                            <mml:msub>
                              <mml:mrow>
                                <mml:mi>f</mml:mi>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mi>i</mml:mi>
                                <mml:mo>,</mml:mo>
                                <mml:mi>r</mml:mi>
                              </mml:mrow>
                            </mml:msub>
                            <mml:mover class="msup">
                              <mml:mrow>
                                <mml:mover accent="false">
                                  <mml:mrow>
                                    <mml:mtext class="textrm" mathvariant="normal">C1</mml:mtext>
                                    <mml:mrow>
                                      <mml:mo stretchy="false">(</mml:mo>
                                      <mml:mrow>
                                        <mml:msub>
                                          <mml:mrow>
                                            <mml:mstyle mathvariant="bold-italic">
                                              <mml:mo>μ</mml:mo>
                                            </mml:mstyle>
                                          </mml:mrow>
                                          <mml:mrow>
                                            <mml:mi>i</mml:mi>
                                          </mml:mrow>
                                        </mml:msub>
                                        <mml:mo>|</mml:mo>
                                        <mml:msub>
                                          <mml:mrow>
                                            <mml:mo>λ</mml:mo>
                                          </mml:mrow>
                                          <mml:mrow>
                                            <mml:mo>∥</mml:mo>
                                          </mml:mrow>
                                        </mml:msub>
                                      </mml:mrow>
                                      <mml:mo stretchy="false">)</mml:mo>
                                    </mml:mrow>
                                  </mml:mrow>
                                  <mml:mo>︷</mml:mo>
                                </mml:mover>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mtext class="textrm" mathvariant="normal">Stick</mml:mtext>
                              </mml:mrow>
                            </mml:mover>
                          </mml:mrow>
                          <mml:mo>︸</mml:mo>
                        </mml:munder>
                      </mml:mstyle>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mtext class="textrm" mathvariant="normal">Intra-Axonal</mml:mtext>
                    </mml:mrow>
                  </mml:munder>
                </mml:mstyle>
                <mml:mo>,</mml:mo>
              </mml:mtd>
            </mml:mtr>
          </mml:mtable>
        </mml:math>
      </disp-formula>
      <disp-formula id="E23">
        <label>(19)</label>
        <mml:math id="M43">
          <mml:mtable class="eqnarray" columnalign="right center left">
            <mml:mtr>
              <mml:mtd>
                <mml:mi>M</mml:mi>
                <mml:msubsup>
                  <mml:mrow>
                    <mml:mi>C</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mtext class="textrm" mathvariant="normal">Watson</mml:mtext>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mtext class="textrm" mathvariant="normal">NODDIx</mml:mtext>
                  </mml:mrow>
                </mml:msubsup>
                <mml:mo>=</mml:mo>
                <mml:mstyle displaystyle="true">
                  <mml:munder class="msub">
                    <mml:mrow>
                      <mml:mstyle displaystyle="true">
                        <mml:munder accentunder="false">
                          <mml:mrow>
                            <mml:msub>
                              <mml:mrow>
                                <mml:mi>f</mml:mi>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mtext class="textrm" mathvariant="normal">CSF</mml:mtext>
                              </mml:mrow>
                            </mml:msub>
                            <mml:mover class="msup">
                              <mml:mrow>
                                <mml:mover accent="false">
                                  <mml:mrow>
                                    <mml:mtext class="textrm" mathvariant="normal">G1</mml:mtext>
                                    <mml:mrow>
                                      <mml:mo stretchy="false">(</mml:mo>
                                      <mml:mrow>
                                        <mml:mo>·</mml:mo>
                                        <mml:mo>|</mml:mo>
                                        <mml:msub>
                                          <mml:mrow>
                                            <mml:mo>λ</mml:mo>
                                          </mml:mrow>
                                          <mml:mrow>
                                            <mml:mtext class="textrm" mathvariant="normal">CSF</mml:mtext>
                                          </mml:mrow>
                                        </mml:msub>
                                      </mml:mrow>
                                      <mml:mo stretchy="false">)</mml:mo>
                                    </mml:mrow>
                                  </mml:mrow>
                                  <mml:mo>︷</mml:mo>
                                </mml:mover>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mtext class="textrm" mathvariant="normal">Ball</mml:mtext>
                              </mml:mrow>
                            </mml:mover>
                          </mml:mrow>
                          <mml:mo>︸</mml:mo>
                        </mml:munder>
                      </mml:mstyle>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mtext class="textrm" mathvariant="normal">CSF</mml:mtext>
                    </mml:mrow>
                  </mml:munder>
                </mml:mstyle>
                <mml:mo>+</mml:mo>
                <mml:mstyle displaystyle="true">
                  <mml:munderover accentunder="false" accent="false">
                    <mml:mrow>
                      <mml:mo>∑</mml:mo>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>i</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>N</mml:mi>
                    </mml:mrow>
                  </mml:munderover>
                </mml:mstyle>
                <mml:mover class="msup">
                  <mml:mrow>
                    <mml:mover accent="false">
                      <mml:mrow>
                        <mml:mtext class="textrm" mathvariant="normal">SD1</mml:mtext>
                        <mml:mrow>
                          <mml:mo stretchy="false">(</mml:mo>
                          <mml:mrow>
                            <mml:msub>
                              <mml:mrow>
                                <mml:mi>κ</mml:mi>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mi>i</mml:mi>
                              </mml:mrow>
                            </mml:msub>
                            <mml:mo>,</mml:mo>
                            <mml:msub>
                              <mml:mrow>
                                <mml:mstyle mathvariant="bold-italic">
                                  <mml:mo>μ</mml:mo>
                                </mml:mstyle>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mi>i</mml:mi>
                              </mml:mrow>
                            </mml:msub>
                          </mml:mrow>
                          <mml:mo stretchy="false">)</mml:mo>
                        </mml:mrow>
                      </mml:mrow>
                      <mml:mo>︷</mml:mo>
                    </mml:mover>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mtext class="textrm" mathvariant="normal">Watson</mml:mtext>
                  </mml:mrow>
                </mml:mover>
                <mml:msub>
                  <mml:mrow>
                    <mml:mo>*</mml:mo>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:msup>
                      <mml:mrow>
                        <mml:mo>𝕊</mml:mo>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mn>2</mml:mn>
                      </mml:mrow>
                    </mml:msup>
                  </mml:mrow>
                </mml:msub>
              </mml:mtd>
            </mml:mtr>
            <mml:mtr>
              <mml:mtd>
                <mml:mrow>
                  <mml:mtext>                     </mml:mtext>
                  <mml:mo>[</mml:mo>
                  <mml:mrow>
                    <mml:mstyle displaystyle="true">
                      <mml:munder class="msub">
                        <mml:mrow>
                          <mml:mstyle displaystyle="true">
                            <mml:munder accentunder="false">
                              <mml:mrow>
                                <mml:msub>
                                  <mml:mrow>
                                    <mml:mi>f</mml:mi>
                                  </mml:mrow>
                                  <mml:mrow>
                                    <mml:mi>h</mml:mi>
                                    <mml:mo>,</mml:mo>
                                    <mml:mi>i</mml:mi>
                                  </mml:mrow>
                                </mml:msub>
                                <mml:mover class="msup">
                                  <mml:mrow>
                                    <mml:mover accent="false">
                                      <mml:mrow>
                                        <mml:mtext class="textrm" mathvariant="normal">G2</mml:mtext>
                                        <mml:mrow>
                                          <mml:mo stretchy="false">(</mml:mo>
                                          <mml:mrow>
                                            <mml:mo>·</mml:mo>
                                            <mml:mo>|</mml:mo>
                                            <mml:msubsup>
                                              <mml:mrow>
                                                <mml:mo>λ</mml:mo>
                                              </mml:mrow>
                                              <mml:mrow>
                                                <mml:mo>⊥</mml:mo>
                                              </mml:mrow>
                                              <mml:mrow>
                                                <mml:mtext class="textrm" mathvariant="normal">tort</mml:mtext>
                                              </mml:mrow>
                                            </mml:msubsup>
                                            <mml:mo>,</mml:mo>
                                            <mml:msub>
                                              <mml:mrow>
                                                <mml:mo>λ</mml:mo>
                                              </mml:mrow>
                                              <mml:mrow>
                                                <mml:mo>∥</mml:mo>
                                              </mml:mrow>
                                            </mml:msub>
                                          </mml:mrow>
                                          <mml:mo stretchy="false">)</mml:mo>
                                        </mml:mrow>
                                      </mml:mrow>
                                      <mml:mo>︷</mml:mo>
                                    </mml:mover>
                                  </mml:mrow>
                                  <mml:mrow>
                                    <mml:mtext class="textrm" mathvariant="normal">Zeppelin</mml:mtext>
                                  </mml:mrow>
                                </mml:mover>
                              </mml:mrow>
                              <mml:mo>︸</mml:mo>
                            </mml:munder>
                          </mml:mstyle>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mtext class="textrm" mathvariant="normal">Hindered Extra-Axonal</mml:mtext>
                        </mml:mrow>
                      </mml:munder>
                    </mml:mstyle>
                    <mml:mo>+</mml:mo>
                    <mml:mstyle displaystyle="true">
                      <mml:munder class="msub">
                        <mml:mrow>
                          <mml:mstyle displaystyle="true">
                            <mml:munder accentunder="false">
                              <mml:mrow>
                                <mml:msub>
                                  <mml:mrow>
                                    <mml:mi>f</mml:mi>
                                  </mml:mrow>
                                  <mml:mrow>
                                    <mml:mi>r</mml:mi>
                                    <mml:mo>,</mml:mo>
                                    <mml:mi>i</mml:mi>
                                  </mml:mrow>
                                </mml:msub>
                                <mml:mover class="msup">
                                  <mml:mrow>
                                    <mml:mover accent="false">
                                      <mml:mrow>
                                        <mml:mtext class="textrm" mathvariant="normal">C1</mml:mtext>
                                        <mml:mrow>
                                          <mml:mo stretchy="false">(</mml:mo>
                                          <mml:mrow>
                                            <mml:mo>·</mml:mo>
                                            <mml:mo>|</mml:mo>
                                            <mml:msub>
                                              <mml:mrow>
                                                <mml:mo>λ</mml:mo>
                                              </mml:mrow>
                                              <mml:mrow>
                                                <mml:mo>∥</mml:mo>
                                              </mml:mrow>
                                            </mml:msub>
                                          </mml:mrow>
                                          <mml:mo stretchy="false">)</mml:mo>
                                        </mml:mrow>
                                      </mml:mrow>
                                      <mml:mo>︷</mml:mo>
                                    </mml:mover>
                                  </mml:mrow>
                                  <mml:mrow>
                                    <mml:mtext class="textrm" mathvariant="normal">Stick</mml:mtext>
                                  </mml:mrow>
                                </mml:mover>
                              </mml:mrow>
                              <mml:mo>︸</mml:mo>
                            </mml:munder>
                          </mml:mstyle>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mtext class="textrm" mathvariant="normal">Intra-Axonal</mml:mtext>
                        </mml:mrow>
                      </mml:munder>
                    </mml:mstyle>
                  </mml:mrow>
                  <mml:mo>]</mml:mo>
                </mml:mrow>
                <mml:mo>,</mml:mo>
              </mml:mtd>
            </mml:mtr>
          </mml:mtable>
        </mml:math>
      </disp-formula>
      <disp-formula id="E24">
        <label>(20)</label>
        <mml:math id="M44">
          <mml:mtable class="eqnarray" columnalign="left">
            <mml:mtr>
              <mml:mtd>
                <mml:mi>M</mml:mi>
                <mml:msubsup>
                  <mml:mrow>
                    <mml:mi>C</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mtext class="textrm" mathvariant="normal">Bingham</mml:mtext>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mtext class="textrm" mathvariant="normal">NODDI</mml:mtext>
                  </mml:mrow>
                </mml:msubsup>
                <mml:mo>=</mml:mo>
                <mml:mstyle displaystyle="true">
                  <mml:munder class="msub">
                    <mml:mrow>
                      <mml:mstyle displaystyle="true">
                        <mml:munder accentunder="false">
                          <mml:mrow>
                            <mml:msub>
                              <mml:mrow>
                                <mml:mi>f</mml:mi>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mtext class="textrm" mathvariant="normal">CSF</mml:mtext>
                              </mml:mrow>
                            </mml:msub>
                            <mml:mover class="msup">
                              <mml:mrow>
                                <mml:mover accent="false">
                                  <mml:mrow>
                                    <mml:mtext class="textrm" mathvariant="normal">G1</mml:mtext>
                                    <mml:mrow>
                                      <mml:mo stretchy="false">(</mml:mo>
                                      <mml:mrow>
                                        <mml:mo>·</mml:mo>
                                        <mml:mo>|</mml:mo>
                                        <mml:msub>
                                          <mml:mrow>
                                            <mml:mo>λ</mml:mo>
                                          </mml:mrow>
                                          <mml:mrow>
                                            <mml:mtext class="textrm" mathvariant="normal">CSF</mml:mtext>
                                          </mml:mrow>
                                        </mml:msub>
                                      </mml:mrow>
                                      <mml:mo stretchy="false">)</mml:mo>
                                    </mml:mrow>
                                  </mml:mrow>
                                  <mml:mo>︷</mml:mo>
                                </mml:mover>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mtext class="textrm" mathvariant="normal">Ball</mml:mtext>
                              </mml:mrow>
                            </mml:mover>
                          </mml:mrow>
                          <mml:mo>︸</mml:mo>
                        </mml:munder>
                      </mml:mstyle>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mtext class="textrm" mathvariant="normal">CSF</mml:mtext>
                    </mml:mrow>
                  </mml:munder>
                </mml:mstyle>
                <mml:mo>+</mml:mo>
                <mml:mover class="msup">
                  <mml:mrow>
                    <mml:mover accent="false">
                      <mml:mrow>
                        <mml:mtext class="textrm" mathvariant="normal">SD2</mml:mtext>
                        <mml:mrow>
                          <mml:mo stretchy="false">(</mml:mo>
                          <mml:mrow>
                            <mml:msub>
                              <mml:mrow>
                                <mml:mi>κ</mml:mi>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mn>1</mml:mn>
                              </mml:mrow>
                            </mml:msub>
                            <mml:mo>,</mml:mo>
                            <mml:msub>
                              <mml:mrow>
                                <mml:mi>κ</mml:mi>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mn>2</mml:mn>
                              </mml:mrow>
                            </mml:msub>
                            <mml:mo>,</mml:mo>
                            <mml:mstyle mathvariant="bold-italic">
                              <mml:mo>μ</mml:mo>
                            </mml:mstyle>
                            <mml:mo>,</mml:mo>
                            <mml:mi>ψ</mml:mi>
                          </mml:mrow>
                          <mml:mo stretchy="false">)</mml:mo>
                        </mml:mrow>
                      </mml:mrow>
                      <mml:mo>︷</mml:mo>
                    </mml:mover>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mtext class="textrm" mathvariant="normal">Bingham</mml:mtext>
                  </mml:mrow>
                </mml:mover>
                <mml:msub>
                  <mml:mrow>
                    <mml:mo>*</mml:mo>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:msup>
                      <mml:mrow>
                        <mml:mo>𝕊</mml:mo>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mn>2</mml:mn>
                      </mml:mrow>
                    </mml:msup>
                  </mml:mrow>
                </mml:msub>
              </mml:mtd>
            </mml:mtr>
            <mml:mtr>
              <mml:mtd>
                <mml:mrow>
                  <mml:mtext>                     </mml:mtext>
                  <mml:mo>[</mml:mo>
                  <mml:mrow>
                    <mml:mstyle displaystyle="true">
                      <mml:munder class="msub">
                        <mml:mrow>
                          <mml:mstyle displaystyle="true">
                            <mml:munder accentunder="false">
                              <mml:mrow>
                                <mml:msub>
                                  <mml:mrow>
                                    <mml:mi>f</mml:mi>
                                  </mml:mrow>
                                  <mml:mrow>
                                    <mml:mi>h</mml:mi>
                                  </mml:mrow>
                                </mml:msub>
                                <mml:mover class="msup">
                                  <mml:mrow>
                                    <mml:mover accent="false">
                                      <mml:mrow>
                                        <mml:mtext class="textrm" mathvariant="normal">G2</mml:mtext>
                                        <mml:mrow>
                                          <mml:mo stretchy="false">(</mml:mo>
                                          <mml:mrow>
                                            <mml:mo>·</mml:mo>
                                            <mml:mo>|</mml:mo>
                                            <mml:msubsup>
                                              <mml:mrow>
                                                <mml:mo>λ</mml:mo>
                                              </mml:mrow>
                                              <mml:mrow>
                                                <mml:mo>⊥</mml:mo>
                                              </mml:mrow>
                                              <mml:mrow>
                                                <mml:mtext class="textrm" mathvariant="normal">tort</mml:mtext>
                                              </mml:mrow>
                                            </mml:msubsup>
                                            <mml:mo>,</mml:mo>
                                            <mml:msub>
                                              <mml:mrow>
                                                <mml:mo>λ</mml:mo>
                                              </mml:mrow>
                                              <mml:mrow>
                                                <mml:mo>∥</mml:mo>
                                              </mml:mrow>
                                            </mml:msub>
                                          </mml:mrow>
                                          <mml:mo stretchy="false">)</mml:mo>
                                        </mml:mrow>
                                      </mml:mrow>
                                      <mml:mo>︷</mml:mo>
                                    </mml:mover>
                                  </mml:mrow>
                                  <mml:mrow>
                                    <mml:mtext class="textrm" mathvariant="normal">Zeppelin</mml:mtext>
                                  </mml:mrow>
                                </mml:mover>
                              </mml:mrow>
                              <mml:mo>︸</mml:mo>
                            </mml:munder>
                          </mml:mstyle>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mtext class="textrm" mathvariant="normal">Hindered Extra-Axonal</mml:mtext>
                        </mml:mrow>
                      </mml:munder>
                    </mml:mstyle>
                    <mml:mo>+</mml:mo>
                    <mml:mstyle displaystyle="true">
                      <mml:munder class="msub">
                        <mml:mrow>
                          <mml:mstyle displaystyle="true">
                            <mml:munder accentunder="false">
                              <mml:mrow>
                                <mml:msub>
                                  <mml:mrow>
                                    <mml:mi>f</mml:mi>
                                  </mml:mrow>
                                  <mml:mrow>
                                    <mml:mi>r</mml:mi>
                                  </mml:mrow>
                                </mml:msub>
                                <mml:mover class="msup">
                                  <mml:mrow>
                                    <mml:mover accent="false">
                                      <mml:mrow>
                                        <mml:mtext class="textrm" mathvariant="normal">C1</mml:mtext>
                                        <mml:mrow>
                                          <mml:mo stretchy="false">(</mml:mo>
                                          <mml:mrow>
                                            <mml:mo>·</mml:mo>
                                            <mml:mo>|</mml:mo>
                                            <mml:msub>
                                              <mml:mrow>
                                                <mml:mo>λ</mml:mo>
                                              </mml:mrow>
                                              <mml:mrow>
                                                <mml:mo>∥</mml:mo>
                                              </mml:mrow>
                                            </mml:msub>
                                          </mml:mrow>
                                          <mml:mo stretchy="false">)</mml:mo>
                                        </mml:mrow>
                                      </mml:mrow>
                                      <mml:mo>︷</mml:mo>
                                    </mml:mover>
                                  </mml:mrow>
                                  <mml:mrow>
                                    <mml:mtext class="textrm" mathvariant="normal">Stick</mml:mtext>
                                  </mml:mrow>
                                </mml:mover>
                              </mml:mrow>
                              <mml:mo>︸</mml:mo>
                            </mml:munder>
                          </mml:mstyle>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mtext class="textrm" mathvariant="normal">Intra-Axonal</mml:mtext>
                        </mml:mrow>
                      </mml:munder>
                    </mml:mstyle>
                  </mml:mrow>
                  <mml:mo>]</mml:mo>
                </mml:mrow>
                <mml:mo>.</mml:mo>
              </mml:mtd>
            </mml:mtr>
          </mml:mtable>
        </mml:math>
      </disp-formula>
      <p>It is clear that in terms of MC-model configuration the models in Equations (18–20) are minor variations of each other. We implement BAS in Snippet 10 and the NODDI variants in Snippet 11, and fit them to a subsection of a coronal slice of the HCP data we described in section 2.10.3. We show the main orientation or parametric Fiber Orientation Distributions (FODs) for all models in <xref ref-type="fig" rid="F6">Figure 6</xref>. In all cases, the total signal contribution of the non-Ball compartments is used as background.</p>
      <table-wrap id="d35e6075" position="float">
        <label>Snippet 10</label>
        <caption>
          <p>Dmipy implementation of Ball and Stick in 6 lines of code.</p>
        </caption>
        <graphic xlink:href="fninf-13-00064-i0010"/>
      </table-wrap>
      <table-wrap id="d35e6082" position="float">
        <label>Snippet 11</label>
        <caption>
          <p>Dmipy implementation of NODDI or NODDIx with 2 bundles in 12 lines of code. The implementation of Bingham-NODDI is equivalent to Watson-NODDI, only replacing SD1WatsonDistributed with SD2BinghamDistributed.</p>
        </caption>
        <graphic xlink:href="fninf-13-00064-i0011"/>
      </table-wrap>
      <fig id="F6" position="float">
        <label>Figure 6</label>
        <caption>
          <p>Peak and FOD fields of Ball and Stick <bold>(A)</bold>, NODDI-Watson <bold>(B)</bold>, NODDI-Bingham <bold>(C)</bold>, and NODDIx with two Watson-distributed bundles <bold>(D)</bold> in an area near the centrum semiovale. We expect to find the corpus callosum entering on the left and joining the corona radiata on the right, where we usually find crossing bundle geometries. Models <bold>(A–C)</bold> all appear to correctly reconstruct the orientation of the corpus callosum, but due to their single-bundle design cannot reconstruct crossing structures, instead finding some “average” orientation. It is interesting that NODDI-Bingham, in fact, finds “pancake” FODs to cope with modeling crossing structures (blue circle). NODDIx <bold>(D)</bold>, having two bundles, also accurately reconstructs the corpus callosum despite being over-parameterized for single bundles, and reconstructs some crossings in the centrum semiovale. However, some crossing structures still appear poorly reconstructed (red circle).</p>
        </caption>
        <graphic xlink:href="fninf-13-00064-g0006"/>
      </fig>
    </sec>
    <sec>
      <title>3.4. Spherical Mean-Based Constrained Spherical Deconvolution</title>
      <p>As we explained in section 2.7.1, spherical mean-based MC-models can estimate dispersion-free tissue parameters by fitting the spherical mean of the measured signal with the spherical mean of the MC-model. To delineate features of the intra- and extra-axonal in the tissue micro-environment, Kaden et al. (<xref rid="B42" ref-type="bibr">2016</xref>) proposed the Multi-Compartment Microscopic Diffusion Imaging (MC-MDI) model, composed of the spherical mean of the classic Stick and Zeppelin model with tortuosity constraint. As a cross-modeling framework example, we can then use the voxel-wise estimated MC-MDI parameters to define a voxel-wise varying convolution kernel for an MC-SH model of the same model composition. We describe these two models as</p>
      <disp-formula id="E26">
        <label>(21)</label>
        <mml:math id="M46">
          <mml:mtable class="eqnarray" columnalign="right center left">
            <mml:mtr>
              <mml:mtd>
                <mml:mtable style="text-align:axis;" equalrows="false" columnlines="none" equalcolumns="false" class="array">
                  <mml:mtr>
                    <mml:mtd>
                      <mml:mtext class="textrm" mathvariant="normal">Step </mml:mtext>
                      <mml:mn>1</mml:mn>
                      <mml:mo>:</mml:mo>
                      <mml:mtext>  </mml:mtext>
                      <mml:mi>M</mml:mi>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi>C</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mtext class="textrm" mathvariant="normal">MC-MDI</mml:mtext>
                        </mml:mrow>
                      </mml:msub>
                      <mml:mo>=</mml:mo>
                      <mml:mstyle displaystyle="true">
                        <mml:munder class="msub">
                          <mml:mrow>
                            <mml:mstyle displaystyle="true">
                              <mml:munder accentunder="false">
                                <mml:mrow>
                                  <mml:msub>
                                    <mml:mrow>
                                      <mml:mi>f</mml:mi>
                                    </mml:mrow>
                                    <mml:mrow>
                                      <mml:mi>r</mml:mi>
                                    </mml:mrow>
                                  </mml:msub>
                                  <mml:mover class="msup">
                                    <mml:mrow>
                                      <mml:mover accent="false">
                                        <mml:mrow>
                                          <mml:msup>
                                            <mml:mrow>
                                              <mml:mtext class="textrm" mathvariant="normal">C1</mml:mtext>
                                            </mml:mrow>
                                            <mml:mrow>
                                              <mml:mi>S</mml:mi>
                                              <mml:mi>M</mml:mi>
                                            </mml:mrow>
                                          </mml:msup>
                                          <mml:mrow>
                                            <mml:mo stretchy="false">(</mml:mo>
                                            <mml:mrow>
                                              <mml:msub>
                                                <mml:mrow>
                                                  <mml:mo>λ</mml:mo>
                                                </mml:mrow>
                                                <mml:mrow>
                                                  <mml:mo>∥</mml:mo>
                                                </mml:mrow>
                                              </mml:msub>
                                            </mml:mrow>
                                            <mml:mo stretchy="false">)</mml:mo>
                                          </mml:mrow>
                                        </mml:mrow>
                                        <mml:mo>︷</mml:mo>
                                      </mml:mover>
                                    </mml:mrow>
                                    <mml:mrow>
                                      <mml:mtext class="textrm" mathvariant="normal">Stick</mml:mtext>
                                    </mml:mrow>
                                  </mml:mover>
                                </mml:mrow>
                                <mml:mo>︸</mml:mo>
                              </mml:munder>
                            </mml:mstyle>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mtext class="textrm" mathvariant="normal">Intra-Axonal</mml:mtext>
                          </mml:mrow>
                        </mml:munder>
                      </mml:mstyle>
                      <mml:mo>+</mml:mo>
                      <mml:mstyle displaystyle="true">
                        <mml:munder class="msub">
                          <mml:mrow>
                            <mml:mstyle displaystyle="true">
                              <mml:munder accentunder="false">
                                <mml:mrow>
                                  <mml:mrow>
                                    <mml:mo stretchy="false">(</mml:mo>
                                    <mml:mrow>
                                      <mml:mn>1</mml:mn>
                                      <mml:mo>-</mml:mo>
                                      <mml:msub>
                                        <mml:mrow>
                                          <mml:mi>f</mml:mi>
                                        </mml:mrow>
                                        <mml:mrow>
                                          <mml:mi>r</mml:mi>
                                        </mml:mrow>
                                      </mml:msub>
                                    </mml:mrow>
                                    <mml:mo stretchy="false">)</mml:mo>
                                  </mml:mrow>
                                  <mml:mover class="msup">
                                    <mml:mrow>
                                      <mml:mover accent="false">
                                        <mml:mrow>
                                          <mml:msup>
                                            <mml:mrow>
                                              <mml:mtext class="textrm" mathvariant="normal">G2</mml:mtext>
                                            </mml:mrow>
                                            <mml:mrow>
                                              <mml:mi>S</mml:mi>
                                              <mml:mi>M</mml:mi>
                                            </mml:mrow>
                                          </mml:msup>
                                          <mml:mrow>
                                            <mml:mo stretchy="false">(</mml:mo>
                                            <mml:mrow>
                                              <mml:msub>
                                                <mml:mrow>
                                                  <mml:mo>λ</mml:mo>
                                                </mml:mrow>
                                                <mml:mrow>
                                                  <mml:mo>∥</mml:mo>
                                                </mml:mrow>
                                              </mml:msub>
                                              <mml:mo>|</mml:mo>
                                              <mml:msubsup>
                                                <mml:mrow>
                                                  <mml:mo>λ</mml:mo>
                                                </mml:mrow>
                                                <mml:mrow>
                                                  <mml:mo>⊥</mml:mo>
                                                </mml:mrow>
                                                <mml:mrow>
                                                  <mml:mtext class="textrm" mathvariant="normal">tort</mml:mtext>
                                                </mml:mrow>
                                              </mml:msubsup>
                                            </mml:mrow>
                                            <mml:mo stretchy="false">)</mml:mo>
                                          </mml:mrow>
                                        </mml:mrow>
                                        <mml:mo>︷</mml:mo>
                                      </mml:mover>
                                    </mml:mrow>
                                    <mml:mrow>
                                      <mml:mtext class="textrm" mathvariant="normal">Zeppelin</mml:mtext>
                                    </mml:mrow>
                                  </mml:mover>
                                </mml:mrow>
                                <mml:mo>︸</mml:mo>
                              </mml:munder>
                            </mml:mstyle>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mtext class="textrm" mathvariant="normal">Hindered Extra-Axonal</mml:mtext>
                          </mml:mrow>
                        </mml:munder>
                      </mml:mstyle>
                      <mml:mo>,</mml:mo>
                    </mml:mtd>
                  </mml:mtr>
                </mml:mtable>
              </mml:mtd>
            </mml:mtr>
          </mml:mtable>
        </mml:math>
      </disp-formula>
      <disp-formula id="E27">
        <mml:math id="M47">
          <mml:mtable class="eqnarray" columnalign="left">
            <mml:mtr>
              <mml:mtd>
                <mml:mtext class="textrm" mathvariant="normal">Step </mml:mtext>
                <mml:mn>2</mml:mn>
                <mml:mo>:</mml:mo>
                <mml:mtext>  </mml:mtext>
                <mml:mi>M</mml:mi>
                <mml:msubsup>
                  <mml:mrow>
                    <mml:mi>C</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mtext class="textrm" mathvariant="normal">CSD</mml:mtext>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mtext class="textrm" mathvariant="normal">vox-varying</mml:mtext>
                  </mml:mrow>
                </mml:msubsup>
                <mml:mo>=</mml:mo>
                <mml:mtext class="textrm" mathvariant="normal">FOD</mml:mtext>
                <mml:mrow>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:mrow>
                    <mml:mstyle mathvariant="bold">
                      <mml:mtext>c</mml:mtext>
                    </mml:mstyle>
                  </mml:mrow>
                  <mml:mo stretchy="false">)</mml:mo>
                </mml:mrow>
                <mml:msub>
                  <mml:mrow>
                    <mml:mo>*</mml:mo>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:msup>
                      <mml:mrow>
                        <mml:mo>𝕊</mml:mo>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mn>2</mml:mn>
                      </mml:mrow>
                    </mml:msup>
                  </mml:mrow>
                </mml:msub>
              </mml:mtd>
            </mml:mtr>
            <mml:mtr>
              <mml:mtd>
                <mml:mrow>
                  <mml:mtext>                </mml:mtext>
                  <mml:mo>[</mml:mo>
                  <mml:mrow>
                    <mml:mstyle displaystyle="true">
                      <mml:munder class="msub">
                        <mml:mrow>
                          <mml:mstyle displaystyle="true">
                            <mml:munder accentunder="false">
                              <mml:mrow>
                                <mml:msubsup>
                                  <mml:mrow>
                                    <mml:mi>f</mml:mi>
                                  </mml:mrow>
                                  <mml:mrow>
                                    <mml:mi>r</mml:mi>
                                  </mml:mrow>
                                  <mml:mrow>
                                    <mml:mo>*</mml:mo>
                                  </mml:mrow>
                                </mml:msubsup>
                                <mml:mover class="msup">
                                  <mml:mrow>
                                    <mml:mover accent="false">
                                      <mml:mrow>
                                        <mml:msup>
                                          <mml:mrow>
                                            <mml:mtext class="textrm" mathvariant="normal">C1</mml:mtext>
                                          </mml:mrow>
                                          <mml:mrow>
                                            <mml:mi>K</mml:mi>
                                          </mml:mrow>
                                        </mml:msup>
                                        <mml:mrow>
                                          <mml:mo stretchy="false">(</mml:mo>
                                          <mml:mrow>
                                            <mml:mo>·</mml:mo>
                                            <mml:mo>|</mml:mo>
                                            <mml:msubsup>
                                              <mml:mrow>
                                                <mml:mo>λ</mml:mo>
                                              </mml:mrow>
                                              <mml:mrow>
                                                <mml:mo>∥</mml:mo>
                                              </mml:mrow>
                                              <mml:mrow>
                                                <mml:mo>*</mml:mo>
                                              </mml:mrow>
                                            </mml:msubsup>
                                          </mml:mrow>
                                          <mml:mo stretchy="false">)</mml:mo>
                                        </mml:mrow>
                                      </mml:mrow>
                                      <mml:mo>︷</mml:mo>
                                    </mml:mover>
                                  </mml:mrow>
                                  <mml:mrow>
                                    <mml:mtext class="textrm" mathvariant="normal">Stick</mml:mtext>
                                  </mml:mrow>
                                </mml:mover>
                              </mml:mrow>
                              <mml:mo>︸</mml:mo>
                            </mml:munder>
                          </mml:mstyle>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mtext class="textrm" mathvariant="normal">Intra-Axonal</mml:mtext>
                        </mml:mrow>
                      </mml:munder>
                    </mml:mstyle>
                    <mml:mo>+</mml:mo>
                    <mml:mstyle displaystyle="true">
                      <mml:munder class="msub">
                        <mml:mrow>
                          <mml:mstyle displaystyle="true">
                            <mml:munder accentunder="false">
                              <mml:mrow>
                                <mml:mrow>
                                  <mml:mo stretchy="false">(</mml:mo>
                                  <mml:mrow>
                                    <mml:mn>1</mml:mn>
                                    <mml:mo>-</mml:mo>
                                    <mml:msubsup>
                                      <mml:mrow>
                                        <mml:mi>f</mml:mi>
                                      </mml:mrow>
                                      <mml:mrow>
                                        <mml:mi>r</mml:mi>
                                      </mml:mrow>
                                      <mml:mrow>
                                        <mml:mo>*</mml:mo>
                                      </mml:mrow>
                                    </mml:msubsup>
                                  </mml:mrow>
                                  <mml:mo stretchy="false">)</mml:mo>
                                </mml:mrow>
                                <mml:mover class="msup">
                                  <mml:mrow>
                                    <mml:mover accent="false">
                                      <mml:mrow>
                                        <mml:msup>
                                          <mml:mrow>
                                            <mml:mtext class="textrm" mathvariant="normal">G2</mml:mtext>
                                          </mml:mrow>
                                          <mml:mrow>
                                            <mml:mi>K</mml:mi>
                                          </mml:mrow>
                                        </mml:msup>
                                        <mml:mrow>
                                          <mml:mo stretchy="false">(</mml:mo>
                                          <mml:mrow>
                                            <mml:mo>·</mml:mo>
                                            <mml:mo>|</mml:mo>
                                            <mml:msubsup>
                                              <mml:mrow>
                                                <mml:mo>λ</mml:mo>
                                              </mml:mrow>
                                              <mml:mrow>
                                                <mml:mo>∥</mml:mo>
                                              </mml:mrow>
                                              <mml:mrow>
                                                <mml:mo>*</mml:mo>
                                              </mml:mrow>
                                            </mml:msubsup>
                                            <mml:mo>,</mml:mo>
                                            <mml:msubsup>
                                              <mml:mrow>
                                                <mml:mo>λ</mml:mo>
                                              </mml:mrow>
                                              <mml:mrow>
                                                <mml:mo>⊥</mml:mo>
                                              </mml:mrow>
                                              <mml:mrow>
                                                <mml:mtext class="textrm" mathvariant="normal">tort</mml:mtext>
                                              </mml:mrow>
                                            </mml:msubsup>
                                          </mml:mrow>
                                          <mml:mo stretchy="false">)</mml:mo>
                                        </mml:mrow>
                                      </mml:mrow>
                                      <mml:mo>︷</mml:mo>
                                    </mml:mover>
                                  </mml:mrow>
                                  <mml:mrow>
                                    <mml:mtext class="textrm" mathvariant="normal">Zeppelin</mml:mtext>
                                  </mml:mrow>
                                </mml:mover>
                              </mml:mrow>
                              <mml:mo>︸</mml:mo>
                            </mml:munder>
                          </mml:mstyle>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mtext class="textrm" mathvariant="normal">Hindered Extra-Axonal</mml:mtext>
                        </mml:mrow>
                      </mml:munder>
                    </mml:mstyle>
                  </mml:mrow>
                  <mml:mo>]</mml:mo>
                </mml:mrow>
                <mml:mo>.</mml:mo>
              </mml:mtd>
            </mml:mtr>
          </mml:mtable>
        </mml:math>
      </disp-formula>
      <p>Notice that we use the superscript “*” in step 2 to indicate the fitted parameters of step 1. In the second step, only the spherical harmonics coefficients <bold>c</bold> are estimated, while all the parameters in the convolution kernel are fixed. In fact, using a voxel-varying convolution kernel for CSD-based FOD estimation was the winning approach for the ISMRM 2017 TraCED challenge for reproducible tractography <ext-link ext-link-type="uri" xlink:href="https://my.vanderbilt.edu/ismrmtraced2017/">https://my.vanderbilt.edu/ismrmtraced2017/</ext-link>. We fit the 2 steps of our model design to the same coronal slice of the HCP data, and show the FOD field in <xref ref-type="fig" rid="F7">Figure 7</xref>. Notice that on the left we show the <italic>f</italic><sub><italic>r</italic></sub>, λ<sub>∥</sub> parameters of step 1, in the middle we show the estimated FOD field of step 2, and on the right we show cross-sections of the estimated convolution kernel for three voxels containing different tissue configurations.</p>
      <fig id="F7" position="float">
        <label>Figure 7</label>
        <caption>
          <p>FODs estimated with CSD using varying convolution kernels, estimated voxel-wise using the MC-MDI spherical mean model, see the MC-MDI parameter maps for restricted volume fraction <bold>(A)</bold> and parallel diffusivity <bold>(B)</bold>. In <bold>(C)</bold>, the colored squares highlight three voxels with different tissue compositions; red for a coherent white matter bundle, green for a crossing geometry, and blue for CSF. In <bold>(D)</bold>, we show the corresponding MC-MDI estimated convolution kernels in these voxels for each b-value of the HCP acquisition scheme. Notice that the white matter kernel is more anisotropic than the crossing one, and the CSF kernel is most isotropic and much smaller than the other two. While CSF areas appear more noisy with this voxel-varying kernel approach, it does appear quite effective at resolving crossing structures.</p>
        </caption>
        <graphic xlink:href="fninf-13-00064-g0007"/>
      </fig>
    </sec>
    <sec>
      <title>3.5. Multi- and Single-Shell, Multi-Tissue Constrained Spherical Deconvolution</title>
      <p>Dmipy defines MC-SH models as those estimating the non-parametric fiber distribution of some fixed convolution kernel. Unlike the MC-models in the previous sections, the first implementations of MC-SH models were implemented using tissue response models, which are directly estimated from the data, being representative of specific tissue types like white matter (WM), gray matter (GM), and cerebrospinal fluid (CSF) (Tournier et al., <xref rid="B75" ref-type="bibr">2004</xref>, <xref rid="B72" ref-type="bibr">2007</xref>; Jeurissen et al., <xref rid="B40" ref-type="bibr">2014</xref>). In section 3.5.1 we demonstrate how we recover tissue response models directly from the dMRI data. Then, in section 3.5.2, we use these tissue responses to implement and compare Single-Shell 3-tissue CSD with standard Multi-Shell, 3-tissue CSD.</p>
      <sec>
        <title>3.5.1. Unsupervised 3-Tissue Response Model Estimation</title>
        <p>Recently, Dhollander et al. (<xref rid="B23" ref-type="bibr">2016</xref>) proposed an unsupervised method to estimate the GM, WM, and CSF tissue response function directly from the dMRI data. This method is implemented in Dmipy, and we illustrate the results, obtained from the same coronal slice as before, in <xref ref-type="fig" rid="F8">Figure 8</xref>. On the left, we show the gray matter (green), white matter (red), and CSF (blue) segmented voxels, which were found to be the best candidates to represent the three tissue types. In the middle, we show the spherical mean of the three recovered tissue responses <italic>including</italic> the tissue-specific <italic>S</italic><sub>0</sub> intensities. On the right, we show the recovered kernel cross-sections without the <italic>S</italic><sub>0</sub> intensities. Notice that the CSF <italic>S</italic><sub>0</sub> intensity makes the CSF signal contribution much larger than the others at <italic>b</italic><sub>0</sub>, but it quickly becomes negligible at higher <italic>b</italic>-values.</p>
        <fig id="F8" position="float">
          <label>Figure 8</label>
          <caption>
            <p><bold>(A)</bold> Unsupervised three-tissue segmentation algorithm according to Dhollander et al. (<xref rid="B23" ref-type="bibr">2016</xref>); <bold>(B)</bold> The spherical mean of the three recovered tissue responses <italic>including</italic> the tissue-specific <italic>S</italic><sub>0</sub>. notice that the <italic>S</italic><sub>[0, CSF]</sub> is three times higher than that of GM and WM. <bold>(C)</bold> The convolution kernels (without <italic>S</italic><sub>0</sub>) of the three tissues. Notice that WM is the only anisotropic one, and the CSF tissue response is much smaller than the other two.</p>
          </caption>
          <graphic xlink:href="fninf-13-00064-g0008"/>
        </fig>
      </sec>
      <sec>
        <title>3.5.2. Comparing Single and Multi-Shell, Multi-Tissue CSD</title>
        <p>Having recovered the tissue response functions, we can now define the standard Multi-Tissue Constrained Spherical Deconvolution (MT-CSD) model (Jeurissen et al., <xref rid="B40" ref-type="bibr">2014</xref>).</p>
        <disp-formula id="E28">
          <label>(22)</label>
          <mml:math id="M48">
            <mml:mtable class="eqnarray" columnalign="left">
              <mml:mtr>
                <mml:mtd>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>S</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mtext class="textrm" mathvariant="normal">MT-CSD</mml:mtext>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mo>=</mml:mo>
                  <mml:mstyle displaystyle="true">
                    <mml:munder class="msub">
                      <mml:mrow>
                        <mml:mstyle displaystyle="true">
                          <mml:munder accentunder="false">
                            <mml:mrow>
                              <mml:msub>
                                <mml:mrow>
                                  <mml:mi>S</mml:mi>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mn>0</mml:mn>
                                  <mml:mo>,</mml:mo>
                                  <mml:mtext class="textrm" mathvariant="normal">CSF</mml:mtext>
                                </mml:mrow>
                              </mml:msub>
                              <mml:msub>
                                <mml:mrow>
                                  <mml:mi>f</mml:mi>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mtext class="textrm" mathvariant="normal">CSF</mml:mtext>
                                </mml:mrow>
                              </mml:msub>
                              <mml:mover class="msup">
                                <mml:mrow>
                                  <mml:mover accent="false">
                                    <mml:mrow>
                                      <mml:mtext class="textrm" mathvariant="normal">TR1</mml:mtext>
                                      <mml:mrow>
                                        <mml:mo stretchy="false">(</mml:mo>
                                        <mml:mrow>
                                          <mml:mo>·</mml:mo>
                                        </mml:mrow>
                                        <mml:mo stretchy="false">)</mml:mo>
                                      </mml:mrow>
                                    </mml:mrow>
                                    <mml:mo>︷</mml:mo>
                                  </mml:mover>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mtext class="textrm" mathvariant="normal">Iso Response</mml:mtext>
                                </mml:mrow>
                              </mml:mover>
                            </mml:mrow>
                            <mml:mo>︸</mml:mo>
                          </mml:munder>
                        </mml:mstyle>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mtext class="textrm" mathvariant="normal">CSF</mml:mtext>
                      </mml:mrow>
                    </mml:munder>
                  </mml:mstyle>
                  <mml:mo>+</mml:mo>
                  <mml:mstyle displaystyle="true">
                    <mml:munder class="msub">
                      <mml:mrow>
                        <mml:mstyle displaystyle="true">
                          <mml:munder accentunder="false">
                            <mml:mrow>
                              <mml:msub>
                                <mml:mrow>
                                  <mml:mi>S</mml:mi>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mn>0</mml:mn>
                                  <mml:mo>,</mml:mo>
                                  <mml:mtext class="textrm" mathvariant="normal">GM</mml:mtext>
                                </mml:mrow>
                              </mml:msub>
                              <mml:msub>
                                <mml:mrow>
                                  <mml:mi>f</mml:mi>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mtext class="textrm" mathvariant="normal">GM</mml:mtext>
                                </mml:mrow>
                              </mml:msub>
                              <mml:mover class="msup">
                                <mml:mrow>
                                  <mml:mover accent="false">
                                    <mml:mrow>
                                      <mml:mtext class="textrm" mathvariant="normal">TR1</mml:mtext>
                                      <mml:mrow>
                                        <mml:mo stretchy="false">(</mml:mo>
                                        <mml:mrow>
                                          <mml:mo>·</mml:mo>
                                        </mml:mrow>
                                        <mml:mo stretchy="false">)</mml:mo>
                                      </mml:mrow>
                                    </mml:mrow>
                                    <mml:mo>︷</mml:mo>
                                  </mml:mover>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mtext class="textrm" mathvariant="normal">Iso Response</mml:mtext>
                                </mml:mrow>
                              </mml:mover>
                            </mml:mrow>
                            <mml:mo>︸</mml:mo>
                          </mml:munder>
                        </mml:mstyle>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mtext class="textrm" mathvariant="normal">Gray Matter</mml:mtext>
                      </mml:mrow>
                    </mml:munder>
                  </mml:mstyle>
                </mml:mtd>
              </mml:mtr>
              <mml:mtr>
                <mml:mtd>
                  <mml:mtext>             </mml:mtext>
                  <mml:mo>+</mml:mo>
                  <mml:mstyle displaystyle="true">
                    <mml:munder class="msub">
                      <mml:mrow>
                        <mml:mstyle displaystyle="true">
                          <mml:munder accentunder="false">
                            <mml:mrow>
                              <mml:msub>
                                <mml:mrow>
                                  <mml:mi>S</mml:mi>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mn>0</mml:mn>
                                  <mml:mo>,</mml:mo>
                                  <mml:mtext class="textrm" mathvariant="normal">WM</mml:mtext>
                                </mml:mrow>
                              </mml:msub>
                              <mml:msub>
                                <mml:mrow>
                                  <mml:mi>f</mml:mi>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mtext class="textrm" mathvariant="normal">WM</mml:mtext>
                                </mml:mrow>
                              </mml:msub>
                              <mml:mover class="msup">
                                <mml:mrow>
                                  <mml:mover accent="false">
                                    <mml:mrow>
                                      <mml:mo class="qopname">FOD</mml:mo>
                                      <mml:mrow>
                                        <mml:mo stretchy="false">(</mml:mo>
                                        <mml:mrow>
                                          <mml:mstyle mathvariant="bold">
                                            <mml:mtext>c</mml:mtext>
                                          </mml:mstyle>
                                        </mml:mrow>
                                        <mml:mo stretchy="false">)</mml:mo>
                                      </mml:mrow>
                                    </mml:mrow>
                                    <mml:mo>︷</mml:mo>
                                  </mml:mover>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mtext class="textrm" mathvariant="normal">Fiber Dist.</mml:mtext>
                                </mml:mrow>
                              </mml:mover>
                              <mml:msub>
                                <mml:mrow>
                                  <mml:mo>*</mml:mo>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:msup>
                                    <mml:mrow>
                                      <mml:mo>𝕊</mml:mo>
                                    </mml:mrow>
                                    <mml:mrow>
                                      <mml:mn>2</mml:mn>
                                    </mml:mrow>
                                  </mml:msup>
                                </mml:mrow>
                              </mml:msub>
                              <mml:mover class="msup">
                                <mml:mrow>
                                  <mml:mover accent="false">
                                    <mml:mrow>
                                      <mml:msub>
                                        <mml:mrow>
                                          <mml:mtext class="textrm" mathvariant="normal">TR2</mml:mtext>
                                        </mml:mrow>
                                        <mml:mrow>
                                          <mml:mtext class="textrm" mathvariant="normal">WM</mml:mtext>
                                        </mml:mrow>
                                      </mml:msub>
                                      <mml:mrow>
                                        <mml:mo stretchy="false">(</mml:mo>
                                        <mml:mrow>
                                          <mml:mo>·</mml:mo>
                                        </mml:mrow>
                                        <mml:mo stretchy="false">)</mml:mo>
                                      </mml:mrow>
                                    </mml:mrow>
                                    <mml:mo>︷</mml:mo>
                                  </mml:mover>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mtext class="textrm" mathvariant="normal">Aniso Response</mml:mtext>
                                </mml:mrow>
                              </mml:mover>
                            </mml:mrow>
                            <mml:mo>︸</mml:mo>
                          </mml:munder>
                        </mml:mstyle>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mtext class="textrm" mathvariant="normal">White Matter</mml:mtext>
                      </mml:mrow>
                    </mml:munder>
                  </mml:mstyle>
                </mml:mtd>
              </mml:mtr>
            </mml:mtable>
          </mml:math>
        </disp-formula>
        <p>Notice that in contrast to the previous models, MT-CSD is <italic>signal-based</italic>, including the tissue-specific <italic>S</italic><sub>0</sub> intensities. By not normalizing the <italic>b</italic><sub>0</sub> intensity of each model to unity, we can include the signal information in the <italic>b</italic><sub>0</sub> image as another “shell” to estimate information from. This is exactly what Dhollander and Connelly (<xref rid="B22" ref-type="bibr">2016</xref>) takes advantage of when they proposed so-called Single-Shell 3-Tissue (SS3T) CSD.</p>
        <p>In SS3T, it is possible to obtain multi-shell-like parameter maps from “single”-shell data, that resemble those of multi-shell MT-CSD. This is counter-intuitive, as it seems impossible to fit three compartments from only two shells. As we will show, the trick of the SS3T algorithm lies in that it uses an iterative, partial optimization scheme based on parameter cascading, starting from a very specific initialization of the MT-CSD. First, they fix <italic>f</italic><sub>WM</sub> = 0 and optimize only <italic>f</italic><sub>GM</sub> and <italic>f</italic><sub>CSF</sub>. Then, they fix <italic>f</italic><sub>CSF</sub> to the previous solution, and only optimize <italic>f</italic><sub>WM</sub> and <italic>f</italic><sub>GM</sub>. The process is repeated by then fixing <italic>f</italic><sub>WM</sub> to the previous solution and so on, for a <italic>fixed</italic> amount of iterations, where Dhollander and Connelly (<xref rid="B22" ref-type="bibr">2016</xref>) used 4. Dmipy implements this meta-algorithm in Snippet 14.</p>
        <table-wrap id="d35e6886" position="float">
          <label>Snippet 12</label>
          <caption>
            <p>Dmipy implementation of 2-step MC-MDI to voxel-varying CSD in 12 lines of code.</p>
          </caption>
          <graphic xlink:href="fninf-13-00064-i0012"/>
        </table-wrap>
        <table-wrap id="d35e6893" position="float">
          <label>Snippet 13</label>
          <caption>
            <p>Dmipy implementation of unsupervised tissue response estimation and Multi-Tissue CSD in 6 lines of code.</p>
          </caption>
          <graphic xlink:href="fninf-13-00064-i0013"/>
        </table-wrap>
        <table-wrap id="d35e6900" position="float">
          <label>Snippet 14</label>
          <caption>
            <p>Dmipy implementation of Single-Shell Three-Tissue (SS3T) Meta-Algorithm in 19 lines (ignoring commenting lines).</p>
          </caption>
          <graphic xlink:href="fninf-13-00064-i0014"/>
        </table-wrap>
        <p>Applying SS3T then to the whole coronal slice of the HCP data, we can visualize the volume fractions as RGB values in <xref ref-type="fig" rid="F9">Figure 9</xref>. Notice that as the single-shell data has a higher <italic>b</italic>-value, the SS3T results more closely approximate the multi-shell MT-CSD reference. On the bottom, we visualize the estimated FODs with the RGB volume fraction values as background. Notice that higher <italic>b</italic>-value SS3T results seem to resolve the crossing slightly better, but that the biggest difference can be seen in the lower GM volume fractions for lower <italic>b</italic>-values.</p>
        <fig id="F9" position="float">
          <label>Figure 9</label>
          <caption>
            <p><bold>(A1–D1)</bold> Single-shell three-tissue (SS3T) volume fraction comparison with the standard multi-shell CSD (MT-CSD) implementation. From left to right, the SS3T algorithm is applied to higher b-shell data. Notice that as higher b-value data is used, the gray matter fraction becomes more prominent, coming close to resembling the MT-CSD results for the b=[0,3,000] [s/mm<sup>2</sup>] data. In <bold>(A2–D2)</bold> we illustrate the corresponding FODs for each SS3T and MT-CSD optimization. Notice that the crossing appears better resolved at higher b-values (as expected), but the gray matter fraction is significantly suppressed at lower b-values.</p>
          </caption>
          <graphic xlink:href="fninf-13-00064-g0009"/>
        </fig>
      </sec>
    </sec>
  </sec>
  <sec sec-type="discussion" id="s4">
    <title>4. Discussion</title>
    <p>This work introduces Dmipy, an open-source software solution for generalized dMRI signal modeling and Microstructure Imaging using custom-designed multi-compartment models. The toolbox is freely available at <ext-link ext-link-type="uri" xlink:href="https://github.com/AthenaEPI/dmipy">https://github.com/AthenaEPI/dmipy</ext-link>. In this section, we discuss Dmipy's contributions to multi-compartment-based microstructure research.</p>
    <sec>
      <title>4.1. Generalized, On-the-Fly Multi-Compartment Modeling and Signal Generation</title>
      <p>Dmipy's key contribution is the way it generalizes dMRI signal modeling regardless of the MC-model composition or acquisition scheme design. In this way, Dmipy can be better seen as a “model generator,” i.e., it does not hard-code any model combinations, but can generate any one of them on the fly. By standardizing the interaction between the PGSE acquisition scheme representation and the mathematical representations of any biophysical model, all signal representations become the same from a user point of view. An MC-model can then be seen as nothing more than an aggregated set of the input model parameters, including volume fractions, which is neatly represented in Equation (3). In this way, Dmipy enables the user to have only high-level interaction in choosing which model is appropriate the chosen application and never has to worry about the underlying mathematical implementation.</p>
      <p>Throughout this work we have provided the basic commands in Snippets that allows easy interaction with all aspects of MC-modeling. In particular, we can load the acquisition parameters for any PGSE sequence (Snippet 1), generate the dMRI signal for any individual compartment model (Snippet 2), design any MC-model variant and set <italic>S</italic><sub>0</sub> responses (Snippet 5), define parameter links (Snippet 6), and fit an MC-model to data (Snippet 7), from which the fitted model parameters and fitting error can be obtained. Using these elementary commands, we can implement and fit many well-known MC-models from literature in around 10 lines of code (see <xref rid="T3" ref-type="table">Table 3</xref>). In section 3, we explicitly provided the Dmipy code and described the estimated model parameters of IVIM (Le Bihan et al., <xref rid="B47" ref-type="bibr">1988</xref>), AxCaliber (Assaf et al., <xref rid="B4" ref-type="bibr">2008</xref>), Ball and Stick (Behrens et al., <xref rid="B9" ref-type="bibr">2003</xref>), various forms of NODDI (Zhang et al., <xref rid="B83" ref-type="bibr">2012</xref>; Farooq et al., <xref rid="B27" ref-type="bibr">2016</xref>; Tariq et al., <xref rid="B70" ref-type="bibr">2016</xref>), spherical-mean-based MT-CSD (Jeurissen et al., <xref rid="B40" ref-type="bibr">2014</xref>) and spherical-harmonics-based MC-MDI (Kaden et al., <xref rid="B42" ref-type="bibr">2016</xref>). For completeness, in the <xref ref-type="supplementary-material" rid="SM1">Supplementary Material</xref>, we also provide the implementations of ActiveAx (Alexander et al., <xref rid="B3" ref-type="bibr">2010</xref>), VERDICT (Panagiotaki et al., <xref rid="B62" ref-type="bibr">2014</xref>), SMT (Kaden et al., <xref rid="B44" ref-type="bibr">2015</xref>), SMT-NODDI (Cabeen et al., <xref rid="B12" ref-type="bibr">2019</xref>), and CSD (Tournier et al., <xref rid="B72" ref-type="bibr">2007</xref>). Extended explorations of these models can also be found at the Dmipy website.</p>
    </sec>
    <sec>
      <title>4.2. Multi-Compartment Spherical Mean (MC-SM) Modeling</title>
      <p>Dmipy's generalization of MC-modeling also extends to alternative modeling frameworks, including spherical mean modeling (MC-SM) in section 2.7.1. With respect to MC-SM, its key interest is that by taking the shell-wise spherical mean of the signal and the compartment model, the effects of axon dispersion or crossing bundle geometries on the signal is obviated. Kaden et al. (<xref rid="B42" ref-type="bibr">2016</xref>) showed using such MC-SM models one could recover a voxel-varying, parametric representation of the undispersed tissue parameters. Dmipy generalizes the spherical mean representation to all three-dimensional compartment models—including those without closed-form like Cylinders and Spheres (section 2.5.2). In previous work, we explored this in the setting of spherical mean-based axon diameter estimation (Pizzolato et al., <xref rid="B64" ref-type="bibr">2018</xref>). See the <xref ref-type="supplementary-material" rid="SM1">Supplementary Material</xref> for the implementation details.</p>
    </sec>
    <sec>
      <title>4.3. Multi-Compartment Spherical Harmonics (MC-SH) Modeling</title>
      <p>In section 2.7.2, we showed that Dmipy's MC-modeling generalization also extends to models based on spherical convolution by means of spherical harmonics (SH). The key interest in such MC-SH models is that the Fiber Orientation Distribution (FOD) of any fixed convolution kernel can be estimated in a model-free way (Tournier et al., <xref rid="B75" ref-type="bibr">2004</xref>). Dmipy generalizes the interface by which the type and number of convolution kernels can be defined in MC-SH models, allowing for mixes of both parametric and non-parametric compartment models. In this way, it can be seen as a generalized implementation the Multi-Tissue Constrained Spherical Deconvolution (MT-CSD) framework by Jeurissen et al. (<xref rid="B40" ref-type="bibr">2014</xref>).</p>
    </sec>
    <sec>
      <title>4.4. Generalized Implementation of Tissue Response Models</title>
      <p>Tissue Response models are have been used in literature to get an approximation of the shape and amplitude of the signal in specific tissue segmentations—typically white matter, gray matter, and CSD (Tournier et al., <xref rid="B72" ref-type="bibr">2007</xref>; Jeurissen et al., <xref rid="B40" ref-type="bibr">2014</xref>). Different algorithms have been proposed to recover the most appropriate white matter response, either by looking at DTI's FA map (Tournier et al., <xref rid="B72" ref-type="bibr">2007</xref>) or by iterative means (Tournier et al., <xref rid="B74" ref-type="bibr">2013</xref>; Tax et al., <xref rid="B71" ref-type="bibr">2014</xref>). Dmipy implements both these approaches, including the recovery of all three tissue types directly from dMRI data using the unsupervised algorithm by Dhollander et al. (<xref rid="B23" ref-type="bibr">2016</xref>) (see <xref ref-type="fig" rid="F8">Figure 8</xref>). But, more importantly, Dmipy provides a generalized theory to create anisotropic or isotropic tissue responses, just by providing the data from segmented voxels, in section 2.6.3. In this way, both the tissue response and the tissue-specific <italic>S</italic><sub>0</sub> intensity can be recovered for any user-defined segmentation, opening the paths to multi-tissue modeling beyond the three classic WM, GM, and CSF tissues. Moreover, tissue responses can be given to all MC-modeling variants, opening the door to Multi-Tissue modeling for MC-models other than MT-CSD (Jeurissen et al., <xref rid="B40" ref-type="bibr">2014</xref>).</p>
    </sec>
    <sec>
      <title>4.5. Modular, Generalized Optimization Algorithms</title>
      <p>By unifying the theory of MC, MC-SM, and MC-SH modeling, by extension Dmipy allows generalized implementations of standard or dMRI-specific data fitting algorithms, based on Equations (3, 10, 12). Calling different optimization algorithms can be done using a single line of code (see Snippet 7). For MC and MC-SM models, Dmipy uses Scipy (Jones et al., <xref rid="B41" ref-type="bibr">2001</xref>) to implement the “brute2fine” optimizer, using standard brute-force to find a good starting point, and then using L-BFGS-B (Byrd et al., <xref rid="B11" ref-type="bibr">1995</xref>) to refine the solution to a local minimum. Enforcing the unity constraint on the volume fraction is done by nesting the volume fractions based on works by Zhang et al. (<xref rid="B83" ref-type="bibr">2012</xref>). We also implement the recent MIX algorithm by Farooq et al. (<xref rid="B27" ref-type="bibr">2016</xref>), taking advantage of Scipy's differential evolution algorithm (Storn and Price, <xref rid="B68" ref-type="bibr">1997</xref>). For MC-SH models, Dmipy uses Numpy (Oliphant, <xref rid="B59" ref-type="bibr">2006</xref>) and CVXPY (Diamond and Boyd, <xref rid="B24" ref-type="bibr">2016</xref>; Agrawal et al., <xref rid="B2" ref-type="bibr">2018</xref>) to implement classic Tikhonov-regularized CSD (Tournier et al., <xref rid="B72" ref-type="bibr">2007</xref>) and Multi-Tissue CSD (Jeurissen et al., <xref rid="B40" ref-type="bibr">2014</xref>). However, it should be noted that Dmipy's optimizers are modular, and thus alternative optimization algorithms can be easily plugged in. We provide details on the implementation of the optimization algorithms in the <xref ref-type="supplementary-material" rid="SM1">Supplementary Material</xref>.</p>
    </sec>
    <sec>
      <title>4.6. Enabling Iterative, Cross-Framework Modeling Through Uniform Parameter Definitions</title>
      <p>By generalizing the meaning of parameters over MC-modeling frameworks, it follows we can initialize the parameters to be optimized in one MC-model with the parameters obtained from another MC-model. Harms et al. (<xref rid="B37" ref-type="bibr">2017</xref>) used this concept to initialize more complicated MC-models with the obtained values of simpler MC-models. In Dmipy, we take this a step further, in that we can take advantage of the unique properties of different MC-modeling frameworks. In section 3.4, we use this concept to first estimate the parameters of spherical mean-based MC-DMI model (Kaden et al., <xref rid="B42" ref-type="bibr">2016</xref>). Then, we use optimized parameters of MC-MDI to define a spherical harmonics-based Multi-Compartment CSD model that uses a voxel-varying convolution kernel to estimate the FOD for each voxel. We illustrate the results in <xref ref-type="fig" rid="F7">Figure 7</xref>, where we can notice how well crossings are resolved. In fact, this was also the winning approach for the ISMRM 2017 TraCED challenge for reproducible tractography <ext-link ext-link-type="uri" xlink:href="https://my.vanderbilt.edu/ismrmtraced2017/">https://my.vanderbilt.edu/ismrmtraced2017/</ext-link>, which can now be easily implemented and further explored using Dmipy.</p>
      <p>This process can also be exploited within the same MC-modeling framework, even within the same MC-model. In section 3.5, we implement the state-of-the-art Single-Shell Three-Tissue (SS3T) algorithm in Snippet 14. As we illustrate in <xref ref-type="fig" rid="F9">Figure 9</xref>, the SS3T algorithm is able to obtain “multi-shell-like” MT-CSD results by only using one DWI shell (plus a <italic>b</italic><sub>0</sub>). It is based on premature termination of an iterative optimization process, whose parameters <italic>briefly</italic> look like the multi-shell solution by virtue of the chosen initialization point. Though, it appears this algorithm works better on higher b-shell data.</p>
    </sec>
    <sec>
      <title>4.7. Limitations of the Dmipy Toolbox</title>
      <p>At this moment, Dmipy only implements biophysical models designed for the PGSE-dMRI pulse sequence. The main reason for initially targeting the PGSE sequence is because it is currently still the most used sequence, and high-quality PGSE-dMRI data is widely available from excellent sources like the Human Connectome Project. However, Dmipy's modular philosophy may also be applied to MC-models based other sequences, like double-diffusion encoding (Coelho et al., <xref rid="B16" ref-type="bibr">2019</xref>), free waveforms (Ianuş et al., <xref rid="B38" ref-type="bibr">2016</xref>) or multi-dimensional MRI (Nilsson et al., <xref rid="B55" ref-type="bibr">2018</xref>), if only the appropriate acquisition scheme and biophysical model formulations were implemented. All subsequent steps, i.e., combining, fitting, and analyzing the fitted parameters of an MC-model, are already dMRI-sequence agnostic in Dmipy.</p>
    </sec>
    <sec>
      <title>4.8. Improving Research Reproducibility Through High Coding Standards</title>
      <p>Dmipy provides a concrete means by which dMRI-based microstructure researchers can easily construct and fit the models that are appropriate for their application. Furthermore, Dmipy's user-friendly, building-block-based coding style makes it easy to reliably construct and apply the same MC-model and optimization algorithm, removing the need for researchers to spend time implementing and testing the underlying algorithms. To ensure high-quality coding standards, we currently have over 83% testing coverage and follow Google's style guide for consistent readability and maintenance. In this way, Dmipy contributes to open-source, highly reproducible microstructure research.</p>
    </sec>
  </sec>
  <sec sec-type="conclusions" id="s5">
    <title>5. Conclusion</title>
    <p>The open-source Dmipy framework represents the unification and implementation of dMRI-based MC-modeling over the last decades. By adopting a “building-block” based philosophy in both the theory and the coding framework, Dmipy is highly modular and is able to construct on-the-fly MC-models in around 10 lines of code. Furthermore, “standard” MC-modeling is generalized with spherical mean-based and spherical convolution-based MC-modeling, allowing for new, cross-MC-modeling approaches. Importantly, Dmipy's key innovation is not that it proposes new methods, but that it generalizes and combines the advantages of already existing works<xref ref-type="fn" rid="fn0004"><sup>4</sup></xref>. By providing a well-tested, user-friendly toolbox that simplifies the interaction with the otherwise complicated field of dMRI-based Microstructure Imaging, Dmipy contributes to more reproducible, high-quality research.</p>
  </sec>
  <sec sec-type="data-availability" id="s6">
    <title>Data Availability Statement</title>
    <p>The code and all results in this work can be completely reproduced using the tools available at the Dmipy repository at <ext-link ext-link-type="uri" xlink:href="https://github.com/AthenaEPI/dmipy">https://github.com/AthenaEPI/dmipy</ext-link>. The Human Connectome Project (HCP) data used to illustrate several of the algorithms is available at <ext-link ext-link-type="uri" xlink:href="https://db.humanconnectome.org/">https://db.humanconnectome.org/</ext-link>. The spinal cord data is available at the White Matter Microscopy Database at <ext-link ext-link-type="uri" xlink:href="https://dipy.org">https://dipy.org</ext-link>. The IVIM dataset was downloaded through the Dipy example at <ext-link ext-link-type="uri" xlink:href="http://nipy.org/dipy/examples_built/reconst_ivim.html">http://nipy.org/dipy/examples_built/reconst_ivim.html</ext-link>.</p>
  </sec>
  <sec id="s7">
    <title>Ethics Statement</title>
    <p>Ethical review and approval was not required for the study on human participants in accordance with the local legislation and institutional requirements. The patients/participants provided their written informed consent to participate in this study.</p>
  </sec>
  <sec id="s8">
    <title>Author Contributions</title>
    <p>RF devised the project, developed the Dmipy software to its mature form, and wrote the manuscript. DW designed the seminal code for the Dmipy framework and restricted signal models. RD supported this project and co-proposed and co-supervised it with DW. RF, DW, and RD discussed the framework and results, provided critical feedback, helped shape the research, analysis, and final manuscript.</p>
    <sec>
      <title>Conflict of Interest</title>
      <p>RF was employed by company TheraPanacea. The remaining authors declare that the research was conducted in the absence of any commercial or financial relationships that could be construed as a potential conflict of interest.</p>
    </sec>
  </sec>
</body>
<back>
  <fn-group>
    <fn id="fn0001">
      <p>
        <sup>1</sup>
        <ext-link ext-link-type="uri" xlink:href="http://mig.cs.ucl.ac.uk">http://mig.cs.ucl.ac.uk</ext-link>
      </p>
    </fn>
    <fn id="fn0002">
      <p>
        <sup>2</sup>
        <ext-link ext-link-type="uri" xlink:href="http://www.mrtrix.org/">http://www.mrtrix.org/</ext-link>
      </p>
    </fn>
    <fn id="fn0003">
      <p>
        <sup>3</sup>
        <ext-link ext-link-type="uri" xlink:href="https://nipy.org/dipy/">https://nipy.org/dipy/</ext-link>
      </p>
    </fn>
    <fn id="fn0004">
      <p><sup>4</sup>Embodying Newton's famous saying “If I have seen further it is by standing on the shoulders of Giants.”</p>
    </fn>
  </fn-group>
  <fn-group>
    <fn fn-type="financial-disclosure">
      <p><bold>Funding.</bold> This work was partly supported by ANR MOSIFAH under ANR-13-MONU-0009-01, the ERC under the European Union's Horizon 2020 research and innovation program (ERC Advanced Grant agreement No. 694665:CoBCoM).</p>
    </fn>
  </fn-group>
  <sec sec-type="supplementary-material" id="s9">
    <title>Supplementary Material</title>
    <p>The Supplementary Material for this article can be found online at: <ext-link ext-link-type="uri" xlink:href="https://www.frontiersin.org/articles/10.3389/fninf.2019.00064/full#supplementary-material">https://www.frontiersin.org/articles/10.3389/fninf.2019.00064/full#supplementary-material</ext-link></p>
    <supplementary-material content-type="local-data" id="SM1">
      <media xlink:href="Data_Sheet_1.PDF">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
  <ref-list>
    <title>References</title>
    <ref id="B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Aboitiz</surname><given-names>F.</given-names></name><name><surname>Scheibel</surname><given-names>A. B.</given-names></name><name><surname>Fisher</surname><given-names>R. S.</given-names></name><name><surname>Zaidel</surname><given-names>E.</given-names></name></person-group> (<year>1992</year>). <article-title>Fiber composition of the human corpus callosum</article-title>. <source>Brain Res.</source>
<volume>598</volume>, <fpage>143</fpage>–<lpage>153</lpage>. <pub-id pub-id-type="doi">10.1016/0006-8993(92)90178-C</pub-id><pub-id pub-id-type="pmid">1486477</pub-id></mixed-citation>
    </ref>
    <ref id="B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Agrawal</surname><given-names>A.</given-names></name><name><surname>Verschueren</surname><given-names>R.</given-names></name><name><surname>Diamond</surname><given-names>S.</given-names></name><name><surname>Boyd</surname><given-names>S.</given-names></name></person-group> (<year>2018</year>). <article-title>A rewriting system for convex optimization problems</article-title>. <source>J. Control Decis.</source>
<volume>5</volume>, <fpage>42</fpage>–<lpage>60</lpage>. <pub-id pub-id-type="doi">10.1080/23307706.2017.1397554</pub-id></mixed-citation>
    </ref>
    <ref id="B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Alexander</surname><given-names>D. C.</given-names></name><name><surname>Hubbard</surname><given-names>P. L.</given-names></name><name><surname>Hall</surname><given-names>M. G.</given-names></name><name><surname>Moore</surname><given-names>E. A.</given-names></name><name><surname>Ptito</surname><given-names>M.</given-names></name><name><surname>Parker</surname><given-names>G. J.</given-names></name><etal/></person-group>. (<year>2010</year>). <article-title>Orientationally invariant indices of axon diameter and density from diffusion MRI</article-title>. <source>Neuroimage</source><volume>52</volume>, <fpage>1374</fpage>–<lpage>1389</lpage>. <pub-id pub-id-type="doi">10.1016/j.neuroimage.2010.05.043</pub-id><?supplied-pmid 20580932?><pub-id pub-id-type="pmid">20580932</pub-id></mixed-citation>
    </ref>
    <ref id="B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Assaf</surname><given-names>Y.</given-names></name><name><surname>Blumenfeld-Katzir</surname><given-names>T.</given-names></name><name><surname>Yovel</surname><given-names>Y.</given-names></name><name><surname>Basser</surname><given-names>P. J.</given-names></name></person-group> (<year>2008</year>). <article-title>Axcaliber: a method for measuring axon diameter distribution from diffusion MRI</article-title>. <source>Magn. Reson. Med.</source>
<volume>59</volume>, <fpage>1347</fpage>–<lpage>1354</lpage>. <pub-id pub-id-type="doi">10.1002/mrm.21577</pub-id><?supplied-pmid 18506799?><pub-id pub-id-type="pmid">18506799</pub-id></mixed-citation>
    </ref>
    <ref id="B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Assaf</surname><given-names>Y.</given-names></name><name><surname>Freidlin</surname><given-names>R. Z.</given-names></name><name><surname>Rohde</surname><given-names>G. K.</given-names></name><name><surname>Basser</surname><given-names>P. J.</given-names></name></person-group> (<year>2004</year>). <article-title>New modeling and experimental framework to characterize hindered and restricted water diffusion in brain white matter</article-title>. <source>Magn. Reson. Med.</source>
<volume>52</volume>, <fpage>965</fpage>–<lpage>978</lpage>. <pub-id pub-id-type="doi">10.1002/mrm.20274</pub-id><?supplied-pmid 15508168?><pub-id pub-id-type="pmid">15508168</pub-id></mixed-citation>
    </ref>
    <ref id="B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Assaf</surname><given-names>Y.</given-names></name><name><surname>Pasternak</surname><given-names>O.</given-names></name></person-group> (<year>2008</year>). <article-title>Diffusion tensor imaging (DTI)-based white matter mapping in brain research: a review</article-title>. <source>J. Mol. Neurosci.</source>
<volume>34</volume>, <fpage>51</fpage>–<lpage>61</lpage>. <pub-id pub-id-type="doi">10.1007/s12031-007-0029-0</pub-id><?supplied-pmid 18157658?><pub-id pub-id-type="pmid">18157658</pub-id></mixed-citation>
    </ref>
    <ref id="B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Balinov</surname><given-names>B.</given-names></name><name><surname>Jonsson</surname><given-names>B.</given-names></name><name><surname>Linse</surname><given-names>P.</given-names></name><name><surname>Soderman</surname><given-names>O.</given-names></name></person-group> (<year>1993</year>). <article-title>The NMR self-diffusion method applied to restricted diffusion. simulation of echo attenuation from molecules in spheres and between planes</article-title>. <source>J. Magn. Reson. Ser. A</source>
<volume>104</volume>, <fpage>17</fpage>–<lpage>25</lpage>. <pub-id pub-id-type="doi">10.1006/jmra.1993.1184</pub-id></mixed-citation>
    </ref>
    <ref id="B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Basser</surname><given-names>P. J.</given-names></name><name><surname>Mattiello</surname><given-names>J.</given-names></name><name><surname>LeBihan</surname><given-names>D.</given-names></name></person-group> (<year>1994</year>). <article-title>MR diffusion tensor spectroscopy and imaging</article-title>. <source>Biophys. J.</source>
<volume>66</volume>:<fpage>259</fpage>. <pub-id pub-id-type="doi">10.1016/S0006-3495(94)80775-1</pub-id><?supplied-pmid 8130344?><pub-id pub-id-type="pmid">8130344</pub-id></mixed-citation>
    </ref>
    <ref id="B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Behrens</surname><given-names>T.</given-names></name><name><surname>Woolrich</surname><given-names>M.</given-names></name><name><surname>Jenkinson</surname><given-names>M.</given-names></name><name><surname>Johansen-Berg</surname><given-names>H.</given-names></name><name><surname>Nunes</surname><given-names>R.</given-names></name><name><surname>Clare</surname><given-names>S.</given-names></name><etal/></person-group>. (<year>2003</year>). <article-title>Characterization and propagation of uncertainty in diffusion-weighted MR imaging</article-title>. <source>Magn. Reson. Med.</source><volume>50</volume>, <fpage>1077</fpage>–<lpage>1088</lpage>. <pub-id pub-id-type="doi">10.1002/mrm.10609</pub-id><?supplied-pmid 14587019?><pub-id pub-id-type="pmid">14587019</pub-id></mixed-citation>
    </ref>
    <ref id="B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Burcaw</surname><given-names>L. M.</given-names></name><name><surname>Fieremans</surname><given-names>E.</given-names></name><name><surname>Novikov</surname><given-names>D. S.</given-names></name></person-group> (<year>2015</year>). <article-title>Mesoscopic structure of neuronal tracts from time-dependent diffusion</article-title>. <source>NeuroImage</source>
<volume>114</volume>, <fpage>18</fpage>–<lpage>37</lpage>. <pub-id pub-id-type="doi">10.1016/j.neuroimage.2015.03.061</pub-id><?supplied-pmid 25837598?><pub-id pub-id-type="pmid">25837598</pub-id></mixed-citation>
    </ref>
    <ref id="B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Byrd</surname><given-names>R. H.</given-names></name><name><surname>Lu</surname><given-names>P.</given-names></name><name><surname>Nocedal</surname><given-names>J.</given-names></name><name><surname>Zhu</surname><given-names>C.</given-names></name></person-group> (<year>1995</year>). <article-title>A limited memory algorithm for bound constrained optimization</article-title>. <source>SIAM J. Sci. Comput.</source>
<volume>16</volume>, <fpage>1190</fpage>–<lpage>1208</lpage>. <pub-id pub-id-type="doi">10.1137/0916069</pub-id></mixed-citation>
    </ref>
    <ref id="B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cabeen</surname><given-names>R.</given-names></name><name><surname>Sepehrband</surname><given-names>F.</given-names></name><name><surname>Toga</surname><given-names>A.</given-names></name></person-group> (<year>2019</year>). <article-title>“Rapid and accurate noddi parameter estimation with the spherical mean technique,”</article-title> in <source>ISMRM 2019</source>.</mixed-citation>
    </ref>
    <ref id="B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Callaghan</surname><given-names>P. T.</given-names></name></person-group> (<year>1995</year>). <article-title>Pulsed-gradient spin-echo NMR for planar, cylindrical, and spherical pores under conditions of wall relaxation</article-title>. <source>J. Magn. Reson. Ser. A</source>
<volume>113</volume>, <fpage>53</fpage>–<lpage>59</lpage>. <pub-id pub-id-type="doi">10.1006/jmra.1995.1055</pub-id></mixed-citation>
    </ref>
    <ref id="B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Canales-Rodríguez</surname><given-names>E. J.</given-names></name><name><surname>Legarreta</surname><given-names>J. H.</given-names></name><name><surname>Pizzolato</surname><given-names>M.</given-names></name><name><surname>Rensonnet</surname><given-names>G.</given-names></name><name><surname>Girard</surname><given-names>G.</given-names></name><name><surname>Rafael-Patino</surname><given-names>J.</given-names></name><etal/></person-group>. (<year>2019</year>). <article-title>Sparse wars: a survey and comparative study of spherical deconvolution algorithms for diffusion MRI</article-title>. <source>NeuroImage</source><volume>184</volume>, <fpage>140</fpage>–<lpage>160</lpage>. <pub-id pub-id-type="doi">10.1016/j.neuroimage.2018.08.071</pub-id><?supplied-pmid 30193974?><pub-id pub-id-type="pmid">30193974</pub-id></mixed-citation>
    </ref>
    <ref id="B15">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Caruyer</surname><given-names>E.</given-names></name><name><surname>Lenglet</surname><given-names>C.</given-names></name><name><surname>Sapiro</surname><given-names>G.</given-names></name><name><surname>Deriche</surname><given-names>R.</given-names></name></person-group> (<year>2013</year>). <article-title>Design of multishell sampling schemes with uniform coverage in diffusion MRI</article-title>. <source>Magn. Reson. Med.</source>
<volume>69</volume>, <fpage>1534</fpage>–<lpage>1540</lpage>. <pub-id pub-id-type="doi">10.1002/mrm.24736</pub-id><?supplied-pmid 23625329?><pub-id pub-id-type="pmid">23625329</pub-id></mixed-citation>
    </ref>
    <ref id="B16">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Coelho</surname><given-names>S.</given-names></name><name><surname>Pozo</surname><given-names>J. M.</given-names></name><name><surname>Jespersen</surname><given-names>S. N.</given-names></name><name><surname>Jones</surname><given-names>D. K.</given-names></name><name><surname>Frangi</surname><given-names>A. F.</given-names></name></person-group> (<year>2019</year>). <article-title>Resolving degeneracy in diffusion MRI biophysical model parameter estimation using double diffusion encoding</article-title>. <source>Magn. Reson. Med.</source>
<volume>82</volume>, <fpage>395</fpage>–<lpage>410</lpage>. <pub-id pub-id-type="doi">10.1002/mrm.27714</pub-id><?supplied-pmid 30865319?><pub-id pub-id-type="pmid">30865319</pub-id></mixed-citation>
    </ref>
    <ref id="B17">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name><surname>Cook</surname><given-names>P.</given-names></name><name><surname>Bai</surname><given-names>Y.</given-names></name><name><surname>Nedjati-Gilani</surname><given-names>S.</given-names></name><name><surname>Seunarine</surname><given-names>K.</given-names></name><name><surname>Hall</surname><given-names>M.</given-names></name><name><surname>Parker</surname><given-names>G.</given-names></name><etal/></person-group> (<year>2006</year>). <article-title>“Camino: open-source diffusion-MRI reconstruction and processing,”</article-title> in <source>14th Scientific Meeting of the International Society for Magnetic Resonance in Medicine, Vol. 2759</source> (<publisher-loc>Seattle, WA</publisher-loc>).</mixed-citation>
    </ref>
    <ref id="B18">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Daducci</surname><given-names>A.</given-names></name><name><surname>Canales-Rodríguez</surname><given-names>E. J.</given-names></name><name><surname>Zhang</surname><given-names>H.</given-names></name><name><surname>Dyrby</surname><given-names>T. B.</given-names></name><name><surname>Alexander</surname><given-names>D. C.</given-names></name><name><surname>Thiran</surname><given-names>J.-P.</given-names></name></person-group> (<year>2015</year>). <article-title>Accelerated microstructure imaging via convex optimization (amico) from diffusion MRI data</article-title>. <source>NeuroImage</source>
<volume>105</volume>, <fpage>32</fpage>–<lpage>44</lpage>. <pub-id pub-id-type="doi">10.1016/j.neuroimage.2014.10.026</pub-id><?supplied-pmid 25462697?><pub-id pub-id-type="pmid">25462697</pub-id></mixed-citation>
    </ref>
    <ref id="B19">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>De Santis</surname><given-names>S.</given-names></name><name><surname>Jones</surname><given-names>D. K.</given-names></name><name><surname>Roebroeck</surname><given-names>A.</given-names></name></person-group> (<year>2016</year>). <article-title>Including diffusion time dependence in the extra-axonal space improves <italic>in vivo</italic> estimates of axonal diameter and density in human white matter</article-title>. <source>NeuroImage</source>
<volume>130</volume>, <fpage>91</fpage>–<lpage>103</lpage>. <pub-id pub-id-type="doi">10.1016/j.neuroimage.2016.01.047</pub-id><?supplied-pmid 26826514?><pub-id pub-id-type="pmid">26826514</pub-id></mixed-citation>
    </ref>
    <ref id="B20">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dell'Acqua</surname><given-names>F.</given-names></name><name><surname>Scifo</surname><given-names>P.</given-names></name><name><surname>Rizzo</surname><given-names>G.</given-names></name><name><surname>Catani</surname><given-names>M.</given-names></name><name><surname>Simmons</surname><given-names>A.</given-names></name><name><surname>Scotti</surname><given-names>G.</given-names></name><etal/></person-group>. (<year>2010</year>). <article-title>A modified damped richardson–lucy algorithm to reduce isotropic background effects in spherical deconvolution</article-title>. <source>Neuroimage</source><volume>49</volume>, <fpage>1446</fpage>–<lpage>1458</lpage>. <pub-id pub-id-type="doi">10.1016/j.neuroimage.2009.09.033</pub-id><?supplied-pmid 19781650?><pub-id pub-id-type="pmid">19781650</pub-id></mixed-citation>
    </ref>
    <ref id="B21">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dell'Acqua</surname><given-names>F.</given-names></name><name><surname>Tournier</surname><given-names>J.-D.</given-names></name></person-group> (<year>2018</year>). <article-title>Modelling white matter with spherical deconvolution: how and why?</article-title>
<source>NMR Biomed.</source>
<volume>32</volume>:<fpage>e3945</fpage>. <pub-id pub-id-type="doi">10.1002/nbm.3945</pub-id><?supplied-pmid 30113753?><pub-id pub-id-type="pmid">30113753</pub-id></mixed-citation>
    </ref>
    <ref id="B22">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name><surname>Dhollander</surname><given-names>T.</given-names></name><name><surname>Connelly</surname><given-names>A.</given-names></name></person-group> (<year>2016</year>). <article-title>“A novel iterative approach to reap the benefits of multi-tissue CSD from just single-shell (+ b= 0) diffusion MRI data,”</article-title> in <source>24th International Society of Magnetic Resonance in Medicine</source> (<publisher-loc>Singapore</publisher-loc>).</mixed-citation>
    </ref>
    <ref id="B23">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name><surname>Dhollander</surname><given-names>T.</given-names></name><name><surname>Raffelt</surname><given-names>D.</given-names></name><name><surname>Connelly</surname><given-names>A.</given-names></name></person-group> (<year>2016</year>). <article-title>“Unsupervised 3-tissue response function estimation from single-shell or multi-shell diffusion MR data without a co-registered t1 image,”</article-title> in <source>ISMRM Workshop on Breaking the Barriers of Diffusion MRI, Vol. 5</source> (<publisher-loc>Lisbon</publisher-loc>).</mixed-citation>
    </ref>
    <ref id="B24">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Diamond</surname><given-names>S.</given-names></name><name><surname>Boyd</surname><given-names>S.</given-names></name></person-group> (<year>2016</year>). <article-title>CVXPY: A Python-embedded modeling language for convex optimization</article-title>. <source>J. Mach. Learn. Res.</source>
<volume>17</volume>, <fpage>2909</fpage>–<lpage>2913</lpage>.<?supplied-pmid 27375369?><pub-id pub-id-type="pmid">27375369</pub-id></mixed-citation>
    </ref>
    <ref id="B25">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Drobnjak</surname><given-names>I.</given-names></name><name><surname>Zhang</surname><given-names>H.</given-names></name><name><surname>Ianuş</surname><given-names>A.</given-names></name><name><surname>Kaden</surname><given-names>E.</given-names></name><name><surname>Alexander</surname><given-names>D. C.</given-names></name></person-group> (<year>2016</year>). <article-title>PGSE, OGSE, and sensitivity to axon diameter in diffusion MRI: insight from a simulation study</article-title>. <source>Magn. Reson. Med.</source>
<volume>75</volume>, <fpage>688</fpage>–<lpage>700</lpage>. <pub-id pub-id-type="doi">10.1002/mrm.25631</pub-id><?supplied-pmid 25809657?><pub-id pub-id-type="pmid">25809657</pub-id></mixed-citation>
    </ref>
    <ref id="B26">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name><surname>Duval</surname><given-names>T.</given-names></name><name><surname>Perraud</surname><given-names>B.</given-names></name><name><surname>Vuong</surname><given-names>M.</given-names></name><name><surname>Rios</surname><given-names>N.</given-names></name><name><surname>Stikov</surname><given-names>N. Cohen-Adad, J.</given-names></name></person-group> (<year>2016</year>). <article-title>“Validation of quantitative MRI metrics using full slice histology with automatic axon segmentation,”</article-title> in <source>ISMRM</source> (<publisher-loc>Singapore</publisher-loc>).</mixed-citation>
    </ref>
    <ref id="B27">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Farooq</surname><given-names>H.</given-names></name><name><surname>Xu</surname><given-names>J.</given-names></name><name><surname>Nam</surname><given-names>J. W.</given-names></name><name><surname>Keefe</surname><given-names>D. F.</given-names></name><name><surname>Yacoub</surname><given-names>E.</given-names></name><name><surname>Georgiou</surname><given-names>T.</given-names></name><etal/></person-group>. (<year>2016</year>). <article-title>Microstructure imaging of crossing (mix) white matter fibers from diffusion MRI</article-title>. <source>Sci. Rep.</source><volume>6</volume>:<fpage>38927</fpage>. <pub-id pub-id-type="doi">10.1038/srep38927</pub-id><?supplied-pmid 27982056?><pub-id pub-id-type="pmid">27982056</pub-id></mixed-citation>
    </ref>
    <ref id="B28">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Feinberg</surname><given-names>D. A.</given-names></name><name><surname>Moeller</surname><given-names>S.</given-names></name><name><surname>Smith</surname><given-names>S. M.</given-names></name><name><surname>Auerbach</surname><given-names>E.</given-names></name><name><surname>Ramanna</surname><given-names>S.</given-names></name><name><surname>Gunther</surname><given-names>M.</given-names></name><etal/></person-group>. (<year>2010</year>). <article-title>Multiplexed echo planar imaging for sub-second whole brain fMRI and fast diffusion imaging</article-title>. <source>PLoS ONE</source><volume>5</volume>:<fpage>e15710</fpage>. <pub-id pub-id-type="doi">10.1371/journal.pone.0015710</pub-id><?supplied-pmid 21187930?><pub-id pub-id-type="pmid">21187930</pub-id></mixed-citation>
    </ref>
    <ref id="B29">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ferizi</surname><given-names>U.</given-names></name><name><surname>Scherrer</surname><given-names>B.</given-names></name><name><surname>Schneider</surname><given-names>T.</given-names></name><name><surname>Alipoor</surname><given-names>M.</given-names></name><name><surname>Eufracio</surname><given-names>O.</given-names></name><name><surname>Fick</surname><given-names>R. H.</given-names></name><etal/></person-group> (<year>2016</year>). <article-title>Diffusion MRI microstructure models with <italic>in vivo</italic> human brain connectom data: results from a multi-group comparison</article-title>. <source>arXiv preprint</source>
<volume>arXiv</volume>:<fpage>1604.07287</fpage>
<pub-id pub-id-type="doi">10.1002/nbm.3734</pub-id></mixed-citation>
    </ref>
    <ref id="B30">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name><surname>Fick</surname><given-names>R.</given-names></name></person-group> (<year>2017</year>). <source>Advanced dMRI signal modeling for tissue microstructure characterization</source> (Ph.D. thesis). <publisher-loc>Nice, France</publisher-loc>: <publisher-name>Université Côte d'Azur</publisher-name>.</mixed-citation>
    </ref>
    <ref id="B31">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fick</surname><given-names>R. H.</given-names></name><name><surname>Petiet</surname><given-names>A.</given-names></name><name><surname>Santin</surname><given-names>M.</given-names></name><name><surname>Philippe</surname><given-names>A.-C.</given-names></name><name><surname>Lehericy</surname><given-names>S.</given-names></name><name><surname>Deriche</surname><given-names>R.</given-names></name><etal/></person-group>. (<year>2018</year>). <article-title>Non-parametric graphnet-regularized representation of DMRI in space and time</article-title>. <source>Med. Image Analysis</source><volume>43</volume>, <fpage>37</fpage>–<lpage>53</lpage>. <pub-id pub-id-type="doi">10.1016/j.media.2017.09.002</pub-id><?supplied-pmid 28982075?><pub-id pub-id-type="pmid">28982075</pub-id></mixed-citation>
    </ref>
    <ref id="B32">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fick</surname><given-names>R. H.</given-names></name><name><surname>Wassermann</surname><given-names>D.</given-names></name><name><surname>Caruyer</surname><given-names>E.</given-names></name><name><surname>Deriche</surname><given-names>R.</given-names></name></person-group> (<year>2016</year>). <article-title>MAPL: Tissue microstructure estimation using laplacian-regularized MAP-MRI and its application to HCP data</article-title>. <source>NeuroImage</source>
<volume>134</volume>, <fpage>365</fpage>–<lpage>385</lpage>. <pub-id pub-id-type="doi">10.1016/j.neuroimage.2016.03.046</pub-id><?supplied-pmid 27043358?><pub-id pub-id-type="pmid">27043358</pub-id></mixed-citation>
    </ref>
    <ref id="B33">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Garyfallidis</surname><given-names>E.</given-names></name><name><surname>Brett</surname><given-names>M.</given-names></name><name><surname>Amirbekian</surname><given-names>B.</given-names></name><name><surname>Rokem</surname><given-names>A.</given-names></name><name><surname>Van Der Walt</surname><given-names>S.</given-names></name><name><surname>Descoteaux</surname><given-names>M.</given-names></name><etal/></person-group>. (<year>2014</year>). <article-title>Dipy, a library for the analysis of diffusion MRI data</article-title>. <source>Front. Neuroinformatics</source><volume>8</volume>:<fpage>8</fpage>. <pub-id pub-id-type="doi">10.3389/fninf.2014.00008</pub-id><?supplied-pmid 24600385?><pub-id pub-id-type="pmid">24600385</pub-id></mixed-citation>
    </ref>
    <ref id="B34">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Glasser</surname><given-names>M. F.</given-names></name><name><surname>Sotiropoulos</surname><given-names>S. N.</given-names></name><name><surname>Wilson</surname><given-names>J. A.</given-names></name><name><surname>Coalson</surname><given-names>T. S.</given-names></name><name><surname>Fischl</surname><given-names>B.</given-names></name><name><surname>Andersson</surname><given-names>J. L.</given-names></name><etal/></person-group>. (<year>2013</year>). <article-title>The minimal preprocessing pipelines for the human connectome project</article-title>. <source>Neuroimage</source><volume>80</volume>, <fpage>105</fpage>–<lpage>124</lpage>. <pub-id pub-id-type="doi">10.1016/j.neuroimage.2013.04.127</pub-id><?supplied-pmid 23668970?><pub-id pub-id-type="pmid">23668970</pub-id></mixed-citation>
    </ref>
    <ref id="B35">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gurney-Champion</surname><given-names>O. J.</given-names></name><name><surname>Froeling</surname><given-names>M.</given-names></name><name><surname>Klaassen</surname><given-names>R.</given-names></name><name><surname>Runge</surname><given-names>J. H.</given-names></name><name><surname>Bel</surname><given-names>A.</given-names></name><name><surname>van Laarhoven</surname><given-names>H. W.</given-names></name><etal/></person-group>. (<year>2016</year>). <article-title>Minimizing the acquisition time for intravoxel incoherent motion magnetic resonance imaging acquisitions in the liver and pancreas</article-title>. <source>Invest. Radiol.</source><volume>51</volume>, <fpage>211</fpage>–<lpage>220</lpage>. <pub-id pub-id-type="doi">10.1097/RLI.0000000000000225</pub-id><?supplied-pmid 26646306?><pub-id pub-id-type="pmid">26646306</pub-id></mixed-citation>
    </ref>
    <ref id="B36">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gurney-Champion</surname><given-names>O. J.</given-names></name><name><surname>Klaassen</surname><given-names>R.</given-names></name><name><surname>Froeling</surname><given-names>M.</given-names></name><name><surname>Barbieri</surname><given-names>S.</given-names></name><name><surname>Stoker</surname><given-names>J.</given-names></name><name><surname>Engelbrecht</surname><given-names>M. R.</given-names></name><etal/></person-group>. (<year>2018</year>). <article-title>Comparison of six fit algorithms for the intra-voxel incoherent motion model of diffusion-weighted magnetic resonance imaging data of pancreatic cancer patients</article-title>. <source>PLoS ONE</source><volume>13</volume>:<fpage>e0194590</fpage>. <pub-id pub-id-type="doi">10.1371/journal.pone.0194590</pub-id><?supplied-pmid 29617445?><pub-id pub-id-type="pmid">29617445</pub-id></mixed-citation>
    </ref>
    <ref id="B37">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Harms</surname><given-names>R.</given-names></name><name><surname>Fritz</surname><given-names>F.</given-names></name><name><surname>Tobisch</surname><given-names>A.</given-names></name><name><surname>Goebel</surname><given-names>R.</given-names></name><name><surname>Roebroeck</surname><given-names>A.</given-names></name></person-group> (<year>2017</year>). <article-title>Robust and fast nonlinear optimization of diffusion MRI microstructure models</article-title>. <source>Neuroimage</source>
<volume>155</volume>, <fpage>82</fpage>–<lpage>96</lpage>. <pub-id pub-id-type="doi">10.1016/j.neuroimage.2017.04.064</pub-id><?supplied-pmid 28457975?><pub-id pub-id-type="pmid">28457975</pub-id></mixed-citation>
    </ref>
    <ref id="B38">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name><surname>Ianuş</surname><given-names>A.</given-names></name><name><surname>Alexander</surname><given-names>D. C.</given-names></name><name><surname>Drobnjak</surname><given-names>I.</given-names></name></person-group> (<year>2016</year>). <article-title>“Microstructure imaging sequence simulation toolbox,”</article-title> in <source>International Workshop on Simulation and Synthesis in Medical Imaging</source> (<publisher-loc>Athens</publisher-loc>: <publisher-name>Springer</publisher-name>), <fpage>34</fpage>–<lpage>44</lpage>.</mixed-citation>
    </ref>
    <ref id="B39">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jelescu</surname><given-names>I. O.</given-names></name><name><surname>Veraart</surname><given-names>J.</given-names></name><name><surname>Fieremans</surname><given-names>E.</given-names></name><name><surname>Novikov</surname><given-names>D. S.</given-names></name></person-group> (<year>2016</year>). <article-title>Degeneracy in model parameter estimation for multi-compartmental diffusion in neuronal tissue</article-title>. <source>NMR Biomed.</source>
<volume>29</volume>, <fpage>33</fpage>–<lpage>47</lpage>. <pub-id pub-id-type="doi">10.1002/nbm.3450</pub-id><?supplied-pmid 26615981?><pub-id pub-id-type="pmid">26615981</pub-id></mixed-citation>
    </ref>
    <ref id="B40">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jeurissen</surname><given-names>B.</given-names></name><name><surname>Tournier</surname><given-names>J.-D.</given-names></name><name><surname>Dhollander</surname><given-names>T.</given-names></name><name><surname>Connelly</surname><given-names>A.</given-names></name><name><surname>Sijbers</surname><given-names>J.</given-names></name></person-group> (<year>2014</year>). <article-title>Multi-tissue constrained spherical deconvolution for improved analysis of multi-shell diffusion MRI data</article-title>. <source>NeuroImage</source>
<volume>103</volume>, <fpage>411</fpage>–<lpage>426</lpage>. <pub-id pub-id-type="doi">10.1016/j.neuroimage.2014.07.061</pub-id><?supplied-pmid 25109526?><pub-id pub-id-type="pmid">25109526</pub-id></mixed-citation>
    </ref>
    <ref id="B41">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name><surname>Jones</surname><given-names>E.</given-names></name><name><surname>Oliphant</surname><given-names>T.</given-names></name><name><surname>Peterson</surname><given-names>P.</given-names></name></person-group> (<year>2001</year>). <source>SciPy: Open Source Scientific Tools for Python.</source></mixed-citation>
    </ref>
    <ref id="B42">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kaden</surname><given-names>E.</given-names></name><name><surname>Kelm</surname><given-names>N. D.</given-names></name><name><surname>Carson</surname><given-names>R. P.</given-names></name><name><surname>Does</surname><given-names>M. D.</given-names></name><name><surname>Alexander</surname><given-names>D. C.</given-names></name></person-group> (<year>2016</year>). <article-title>Multi-compartment microscopic diffusion imaging</article-title>. <source>NeuroImage</source>
<volume>139</volume>, <fpage>346</fpage>–<lpage>359</lpage>. <pub-id pub-id-type="doi">10.1016/j.neuroimage.2016.06.002</pub-id><?supplied-pmid 27282476?><pub-id pub-id-type="pmid">27282476</pub-id></mixed-citation>
    </ref>
    <ref id="B43">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kaden</surname><given-names>E.</given-names></name><name><surname>Knösche</surname><given-names>T. R.</given-names></name><name><surname>Anwander</surname><given-names>A.</given-names></name></person-group> (<year>2007</year>). <article-title>Parametric spherical deconvolution: inferring anatomical connectivity using diffusion MR imaging</article-title>. <source>NeuroImage</source>
<volume>37</volume>, <fpage>474</fpage>–<lpage>488</lpage>. <pub-id pub-id-type="doi">10.1016/j.neuroimage.2007.05.012</pub-id><?supplied-pmid 17596967?><pub-id pub-id-type="pmid">17596967</pub-id></mixed-citation>
    </ref>
    <ref id="B44">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kaden</surname><given-names>E.</given-names></name><name><surname>Kruggel</surname><given-names>F.</given-names></name><name><surname>Alexander</surname><given-names>D. C.</given-names></name></person-group> (<year>2015</year>). <article-title>Quantitative mapping of the per-axon diffusion coefficients in brain white matter</article-title>. <source>Magn. Reson. Med</source>. <volume>75</volume>, <fpage>1752</fpage>–<lpage>1763</lpage>. <pub-id pub-id-type="doi">10.1002/mrm.25734</pub-id><?supplied-pmid 25974332?><pub-id pub-id-type="pmid">25974332</pub-id></mixed-citation>
    </ref>
    <ref id="B45">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name><surname>Lam</surname><given-names>S. K.</given-names></name><name><surname>Pitrou</surname><given-names>A.</given-names></name><name><surname>Seibert</surname><given-names>S.</given-names></name></person-group> (<year>2015</year>). <article-title>“Numba: A LLVM-based python JIT compiler,”</article-title> in <source>Proceedings of the Second Workshop on the LLVM Compiler Infrastructure in HPC</source> (<publisher-loc>Austin, TX</publisher-loc>: <publisher-name>ACM</publisher-name>).</mixed-citation>
    </ref>
    <ref id="B46">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Le Bihan</surname><given-names>D.</given-names></name></person-group> (<year>2017</year>). <article-title>What can we see with IVIM MRI?</article-title>
<source>NeuroImage</source>
<volume>187</volume>, <fpage>56</fpage>–<lpage>67</lpage>. <pub-id pub-id-type="doi">10.1016/j.neuroimage.2017.12.062</pub-id><?supplied-pmid 29277647?><pub-id pub-id-type="pmid">29277647</pub-id></mixed-citation>
    </ref>
    <ref id="B47">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Le Bihan</surname><given-names>D.</given-names></name><name><surname>Breton</surname><given-names>E.</given-names></name><name><surname>Lallemand</surname><given-names>D.</given-names></name><name><surname>Aubin</surname><given-names>M.</given-names></name><name><surname>Vignaud</surname><given-names>J.</given-names></name><name><surname>Laval-Jeantet</surname><given-names>M.</given-names></name></person-group> (<year>1988</year>). <article-title>Separation of diffusion and perfusion in intravoxel incoherent motion MR imaging</article-title>. <source>Radiology</source>
<volume>168</volume>, <fpage>497</fpage>–<lpage>505</lpage>. <pub-id pub-id-type="doi">10.1148/radiology.168.2.3393671</pub-id><?supplied-pmid 3393671?><pub-id pub-id-type="pmid">3393671</pub-id></mixed-citation>
    </ref>
    <ref id="B48">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Le Bihan</surname><given-names>D.</given-names></name><name><surname>Breton</surname><given-names>E.</given-names></name><name><surname>Lallemand</surname><given-names>D.</given-names></name><name><surname>Grenier</surname><given-names>P.</given-names></name><name><surname>Cabanis</surname><given-names>E.</given-names></name><name><surname>Laval-Jeantet</surname><given-names>M.</given-names></name></person-group> (<year>1986</year>). <article-title>MR imaging of intravoxel incoherent motions: application to diffusion and perfusion in neurologic disorders</article-title>. <source>Radiology</source>
<volume>161</volume>, <fpage>401</fpage>–<lpage>407</lpage>. <pub-id pub-id-type="doi">10.1148/radiology.161.2.3763909</pub-id><?supplied-pmid 3763909?><pub-id pub-id-type="pmid">3763909</pub-id></mixed-citation>
    </ref>
    <ref id="B49">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Leergaard</surname><given-names>T. B.</given-names></name><name><surname>White</surname><given-names>N. S.</given-names></name><name><surname>De Crespigny</surname><given-names>A.</given-names></name><name><surname>Bolstad</surname><given-names>I.</given-names></name><name><surname>D'Arceuil</surname><given-names>H.</given-names></name><name><surname>Bjaalie</surname><given-names>J. G.</given-names></name><etal/></person-group>. (<year>2010</year>). <article-title>Quantitative histological validation of diffusion MRI fiber orientation distributions in the rat brain</article-title>. <source>PLoS ONE</source><volume>5</volume>:<fpage>e8595</fpage>. <pub-id pub-id-type="doi">10.1371/journal.pone.0008595</pub-id><?supplied-pmid 20062822?><pub-id pub-id-type="pmid">20062822</pub-id></mixed-citation>
    </ref>
    <ref id="B50">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>McKerns</surname><given-names>M. M.</given-names></name><name><surname>Strand</surname><given-names>L.</given-names></name><name><surname>Sullivan</surname><given-names>T.</given-names></name><name><surname>Fang</surname><given-names>A.</given-names></name><name><surname>Aivazis</surname><given-names>M. A.</given-names></name></person-group> (<year>2012</year>). <article-title>Building a framework for predictive science</article-title>. <source>arXiv preprint arXiv:1202.1056</source>.</mixed-citation>
    </ref>
    <ref id="B51">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Minati</surname><given-names>L.</given-names></name><name><surname>Węglarz</surname><given-names>W. P.</given-names></name></person-group> (<year>2007</year>). <article-title>Physical foundations, models, and methods of diffusion magnetic resonance imaging of the brain: a review</article-title>. <source>Concepts Magn. Reson. Part A Educ. J.</source>
<volume>30</volume>, <fpage>278</fpage>–<lpage>307</lpage>. <pub-id pub-id-type="doi">10.1002/cmr.a.20094</pub-id></mixed-citation>
    </ref>
    <ref id="B52">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Moeller</surname><given-names>S.</given-names></name><name><surname>Yacoub</surname><given-names>E.</given-names></name><name><surname>Olman</surname><given-names>C. A.</given-names></name><name><surname>Auerbach</surname><given-names>E.</given-names></name><name><surname>Strupp</surname><given-names>J.</given-names></name><name><surname>Harel</surname><given-names>N.</given-names></name><etal/></person-group>. (<year>2010</year>). <article-title>Multiband multislice GE-EPI at 7 tesla, with 16-fold acceleration using partial parallel imaging with application to high spatial and temporal whole-brain fMRI</article-title>. <source>Magn. Reson. Med.</source><volume>63</volume>, <fpage>1144</fpage>–<lpage>1153</lpage>. <pub-id pub-id-type="doi">10.1002/mrm.22361</pub-id><?supplied-pmid 20432285?><pub-id pub-id-type="pmid">20432285</pub-id></mixed-citation>
    </ref>
    <ref id="B53">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Müllner</surname><given-names>D.</given-names></name></person-group> (<year>2011</year>). <article-title>Modern hierarchical, agglomerative clustering algorithms</article-title>. <source>arXiv preprint arXiv:1109.2378</source>.</mixed-citation>
    </ref>
    <ref id="B54">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Nath</surname><given-names>V.</given-names></name><name><surname>Schilling</surname><given-names>K. G.</given-names></name><name><surname>Parvathaneni</surname><given-names>P.</given-names></name><name><surname>Huo</surname><given-names>Y.</given-names></name><name><surname>Blaber</surname><given-names>J. A.</given-names></name><name><surname>Hainline</surname><given-names>A. E.</given-names></name><etal/></person-group>. (<year>2019</year>). <article-title>Tractography reproducibility challenge with empirical data (TraCED): the 2017 ISMRM diffusion study group challenge</article-title>. <source>J. Magn. Reson. Imaging</source>. <pub-id pub-id-type="doi">10.1002/jmri.26794</pub-id>. [Epub ahead of print].<?supplied-pmid 31179595?><pub-id pub-id-type="pmid">31179595</pub-id></mixed-citation>
    </ref>
    <ref id="B55">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name><surname>Nilsson</surname><given-names>M.</given-names></name><name><surname>Szczepankiewicz</surname><given-names>F.</given-names></name><name><surname>Lampinen</surname><given-names>B.</given-names></name><name><surname>Ahlgren</surname><given-names>A.</given-names></name><name><surname>De Almeida Martins</surname><given-names>J. P.</given-names></name><name><surname>Lasic</surname><given-names>S.</given-names></name><etal/></person-group> (<year>2018</year>). <article-title>“An open-source framework for analysis of multidimensional diffusion MRI data implemented in matlab,”</article-title> in <source>Proc Intl Soc Mag Reson Med, Vol. 26</source> (<publisher-loc>Paris</publisher-loc>).</mixed-citation>
    </ref>
    <ref id="B56">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ning</surname><given-names>L.</given-names></name><name><surname>Laun</surname><given-names>F.</given-names></name><name><surname>Gur</surname><given-names>Y.</given-names></name><name><surname>DiBella</surname><given-names>E. V.</given-names></name><name><surname>Deslauriers-Gauthier</surname><given-names>S.</given-names></name><name><surname>Megherbi</surname><given-names>T.</given-names></name><etal/></person-group>. (<year>2015</year>). <article-title>Sparse reconstruction challenge for diffusion MRI: Validation on a physical phantom to determine which acquisition scheme and analysis method to use?</article-title><source>Med. Image Analys.</source><volume>26</volume>, <fpage>316</fpage>–<lpage>331</lpage>. <pub-id pub-id-type="doi">10.1016/j.media.2015.10.012</pub-id><?supplied-pmid 26606457?><pub-id pub-id-type="pmid">26606457</pub-id></mixed-citation>
    </ref>
    <ref id="B57">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Novikov</surname><given-names>D. S.</given-names></name><name><surname>Jensen</surname><given-names>J. H.</given-names></name><name><surname>Helpern</surname><given-names>J. A.</given-names></name><name><surname>Fieremans</surname><given-names>E.</given-names></name></person-group> (<year>2014</year>). <article-title>Revealing mesoscopic structural universality with diffusion</article-title>. <source>Proc. Natl. Acad. Sci. U.S.A.</source>
<volume>111</volume>, <fpage>5088</fpage>–<lpage>5093</lpage>. <pub-id pub-id-type="doi">10.1073/pnas.1316944111</pub-id><?supplied-pmid 24706873?><pub-id pub-id-type="pmid">24706873</pub-id></mixed-citation>
    </ref>
    <ref id="B58">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Novikov</surname><given-names>D. S.</given-names></name><name><surname>Veraart</surname><given-names>J.</given-names></name><name><surname>Jelescu</surname><given-names>I. O.</given-names></name><name><surname>Fieremans</surname><given-names>E.</given-names></name></person-group> (<year>2018</year>). <article-title>Rotationally-invariant mapping of scalar and orientational metrics of neuronal microstructure with diffusion MRI</article-title>. <source>NeuroImage</source>
<volume>174</volume>, <fpage>518</fpage>–<lpage>538</lpage>. <pub-id pub-id-type="doi">10.1016/j.neuroimage.2018.03.006</pub-id><?supplied-pmid 29544816?><pub-id pub-id-type="pmid">29544816</pub-id></mixed-citation>
    </ref>
    <ref id="B59">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name><surname>Oliphant</surname><given-names>T.</given-names></name></person-group> (<year>2006</year>). <source>NumPy: A Guide to NumPy.</source>
<publisher-name>Trelgol Publishing</publisher-name>.</mixed-citation>
    </ref>
    <ref id="B60">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Özarslan</surname><given-names>E.</given-names></name><name><surname>Koay</surname><given-names>C. G.</given-names></name><name><surname>Shepherd</surname><given-names>T. M.</given-names></name><name><surname>Komlosh</surname><given-names>M. E.</given-names></name><name><surname>İrfanoğlu</surname><given-names>M. O.</given-names></name><name><surname>Pierpaoli</surname><given-names>C.</given-names></name><etal/></person-group>. (<year>2013</year>). <article-title>Mean apparent propagator (map) MRI: a novel diffusion imaging method for mapping tissue microstructure</article-title>. <source>NeuroImage</source><volume>78</volume>, <fpage>16</fpage>–<lpage>32</lpage>. <pub-id pub-id-type="doi">10.1016/j.neuroimage.2013.04.016</pub-id><?supplied-pmid 23587694?><pub-id pub-id-type="pmid">23587694</pub-id></mixed-citation>
    </ref>
    <ref id="B61">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Panagiotaki</surname><given-names>E.</given-names></name><name><surname>Schneider</surname><given-names>T.</given-names></name><name><surname>Siow</surname><given-names>B.</given-names></name><name><surname>Hall</surname><given-names>M. G.</given-names></name><name><surname>Lythgoe</surname><given-names>M. F.</given-names></name><name><surname>Alexander</surname><given-names>D. C.</given-names></name></person-group> (<year>2012</year>). <article-title>Compartment models of the diffusion mr signal in brain white matter: a taxonomy and comparison</article-title>. <source>Neuroimage</source>
<volume>59</volume>, <fpage>2241</fpage>–<lpage>2254</lpage>. <pub-id pub-id-type="doi">10.1016/j.neuroimage.2011.09.081</pub-id><?supplied-pmid 22001791?><pub-id pub-id-type="pmid">22001791</pub-id></mixed-citation>
    </ref>
    <ref id="B62">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Panagiotaki</surname><given-names>E.</given-names></name><name><surname>Walker-Samuel</surname><given-names>S.</given-names></name><name><surname>Siow</surname><given-names>B.</given-names></name><name><surname>Johnson</surname><given-names>S. P.</given-names></name><name><surname>Rajkumar</surname><given-names>V.</given-names></name><name><surname>Pedley</surname><given-names>R. B.</given-names></name><etal/></person-group>. (<year>2014</year>). <article-title>Noninvasive quantification of solid tumor microstructure using verdict MRI</article-title>. <source>Cancer Res</source><volume>74</volume>, <fpage>1902</fpage>–<lpage>1912</lpage>. <pub-id pub-id-type="doi">10.1158/0008-5472.CAN-13-2511</pub-id><?supplied-pmid 24491802?><pub-id pub-id-type="pmid">24491802</pub-id></mixed-citation>
    </ref>
    <ref id="B63">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Park</surname><given-names>H. J.</given-names></name><name><surname>Sung</surname><given-names>Y. S.</given-names></name><name><surname>Lee</surname><given-names>S. S.</given-names></name><name><surname>Lee</surname><given-names>Y.</given-names></name><name><surname>Cheong</surname><given-names>H.</given-names></name><name><surname>Kim</surname><given-names>Y. J.</given-names></name><etal/></person-group>. (<year>2017</year>). <article-title>Intravoxel incoherent motion diffusion-weighted mri of the abdomen: the effect of fitting algorithms on the accuracy and reliability of the parameters</article-title>. <source>J. Magn. Reson. Imaging</source><volume>45</volume>, <fpage>1637</fpage>–<lpage>1647</lpage>. <pub-id pub-id-type="doi">10.1002/jmri.25535</pub-id><?supplied-pmid 27865032?><pub-id pub-id-type="pmid">27865032</pub-id></mixed-citation>
    </ref>
    <ref id="B64">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name><surname>Pizzolato</surname><given-names>M.</given-names></name><name><surname>Wassermann</surname><given-names>D.</given-names></name><name><surname>Deriche</surname><given-names>R.</given-names></name><name><surname>Thiran</surname><given-names>J.-P.</given-names></name><name><surname>Fick</surname><given-names>R.</given-names></name></person-group> (<year>2018</year>). <article-title>“Orientation-dispersed apparent axon diameter via multi-stage spherical mean optimization,”</article-title> in <source>International Conference on Medical Image Computing and Computer-Assisted Intervention</source> (<publisher-loc>Springer</publisher-loc>), <fpage>91</fpage>–<lpage>101</lpage>.</mixed-citation>
    </ref>
    <ref id="B65">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Setsompop</surname><given-names>K.</given-names></name><name><surname>Gagoski</surname><given-names>B. A.</given-names></name><name><surname>Polimeni</surname><given-names>J. R.</given-names></name><name><surname>Witzel</surname><given-names>T.</given-names></name><name><surname>Wedeen</surname><given-names>V. J.</given-names></name><name><surname>Wald</surname><given-names>L. L.</given-names></name></person-group> (<year>2012</year>). <article-title>Blipped-controlled aliasing in parallel imaging for simultaneous multislice echo planar imaging with reduced G-factor penalty</article-title>. <source>Magn. Reson. Med.</source>
<volume>67</volume>, <fpage>1210</fpage>–<lpage>1224</lpage>. <pub-id pub-id-type="doi">10.1002/mrm.23097</pub-id><?supplied-pmid 21858868?><pub-id pub-id-type="pmid">21858868</pub-id></mixed-citation>
    </ref>
    <ref id="B66">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sotiropoulos</surname><given-names>S. N.</given-names></name><name><surname>Jbabdi</surname><given-names>S.</given-names></name><name><surname>Xu</surname><given-names>J.</given-names></name><name><surname>Andersson</surname><given-names>J. L.</given-names></name><name><surname>Moeller</surname><given-names>S.</given-names></name><name><surname>Auerbach</surname><given-names>E. J.</given-names></name><etal/></person-group>. (<year>2013</year>). <article-title>Advances in diffusion mri acquisition and processing in the human connectome project</article-title>. <source>Neuroimage</source><volume>80</volume>, <fpage>125</fpage>–<lpage>143</lpage>. <pub-id pub-id-type="doi">10.1016/j.neuroimage.2013.05.057</pub-id><?supplied-pmid 23702418?><pub-id pub-id-type="pmid">23702418</pub-id></mixed-citation>
    </ref>
    <ref id="B67">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Stejskal</surname><given-names>E.</given-names></name></person-group> (<year>1965</year>). <article-title>Use of spin echoes in a pulsed magnetic-field gradient to study anisotropic, restricted diffusion and flow</article-title>. <source>J. Chem. Phys.</source>
<volume>43</volume>, <fpage>3597</fpage>–<lpage>3603</lpage>. <pub-id pub-id-type="doi">10.1063/1.1696526</pub-id></mixed-citation>
    </ref>
    <ref id="B68">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Storn</surname><given-names>R.</given-names></name><name><surname>Price</surname><given-names>K.</given-names></name></person-group> (<year>1997</year>). <article-title>Differential evolution–a simple and efficient heuristic for global optimization over continuous spaces</article-title>. <source>J. Glob. Optimiz.</source>
<volume>11</volume>, <fpage>341</fpage>–<lpage>359</lpage>. <pub-id pub-id-type="doi">10.1023/A:1008202821328</pub-id></mixed-citation>
    </ref>
    <ref id="B69">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Szafer</surname><given-names>A.</given-names></name><name><surname>Zhong</surname><given-names>J.</given-names></name><name><surname>Gore</surname><given-names>J. C.</given-names></name></person-group> (<year>1995</year>). <article-title>Theoretical model for water diffusion in tissues</article-title>. <source>Magn. Reson. Med.</source>
<volume>33</volume>, <fpage>697</fpage>–<lpage>712</lpage>. <pub-id pub-id-type="doi">10.1002/mrm.1910330516</pub-id><?supplied-pmid 7596275?><pub-id pub-id-type="pmid">7596275</pub-id></mixed-citation>
    </ref>
    <ref id="B70">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tariq</surname><given-names>M.</given-names></name><name><surname>Schneider</surname><given-names>T.</given-names></name><name><surname>Alexander</surname><given-names>D. C.</given-names></name><name><surname>Wheeler-Kingshott</surname><given-names>C. A. G.</given-names></name><name><surname>Zhang</surname><given-names>H.</given-names></name></person-group> (<year>2016</year>). <article-title>Bingham–noddi: Mapping anisotropic orientation dispersion of neurites using diffusion MRI</article-title>. <source>NeuroImage</source>
<volume>133</volume>, <fpage>207</fpage>–<lpage>223</lpage>. <pub-id pub-id-type="doi">10.1016/j.neuroimage.2016.01.046</pub-id><?supplied-pmid 26826512?><pub-id pub-id-type="pmid">26826512</pub-id></mixed-citation>
    </ref>
    <ref id="B71">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tax</surname><given-names>C. M.</given-names></name><name><surname>Jeurissen</surname><given-names>B.</given-names></name><name><surname>Vos</surname><given-names>S. B.</given-names></name><name><surname>Viergever</surname><given-names>M. A.</given-names></name><name><surname>Leemans</surname><given-names>A.</given-names></name></person-group> (<year>2014</year>). <article-title>Recursive calibration of the fiber response function for spherical deconvolution of diffusion MRI data</article-title>. <source>Neuroimage</source>
<volume>86</volume>, <fpage>67</fpage>–<lpage>80</lpage>. <pub-id pub-id-type="doi">10.1016/j.neuroimage.2013.07.067</pub-id><?supplied-pmid 23927905?><pub-id pub-id-type="pmid">23927905</pub-id></mixed-citation>
    </ref>
    <ref id="B72">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tournier</surname><given-names>J.-D.</given-names></name><name><surname>Calamante</surname><given-names>F.</given-names></name><name><surname>Connelly</surname><given-names>A.</given-names></name></person-group> (<year>2007</year>). <article-title>Robust determination of the fibre orientation distribution in diffusion MRI: non-negativity constrained super-resolved spherical deconvolution</article-title>. <source>NeuroImage</source>
<volume>35</volume>, <fpage>1459</fpage>–<lpage>1472</lpage>. <pub-id pub-id-type="doi">10.1016/j.neuroimage.2007.02.016</pub-id><?supplied-pmid 17379540?><pub-id pub-id-type="pmid">17379540</pub-id></mixed-citation>
    </ref>
    <ref id="B73">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tournier</surname><given-names>J.-D.</given-names></name><name><surname>Calamante</surname><given-names>F.</given-names></name><name><surname>Connelly</surname><given-names>A.</given-names></name></person-group> (<year>2012</year>). <article-title>Mrtrix: diffusion tractography in crossing fiber regions</article-title>. <source>Int. J. Imaging Syst. Technol.</source>
<volume>22</volume>, <fpage>53</fpage>–<lpage>66</lpage>. <pub-id pub-id-type="doi">10.1002/ima.22005</pub-id></mixed-citation>
    </ref>
    <ref id="B74">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tournier</surname><given-names>J.-D.</given-names></name><name><surname>Calamante</surname><given-names>F.</given-names></name><name><surname>Connelly</surname><given-names>A.</given-names></name></person-group> (<year>2013</year>). <article-title>Determination of the appropriate B value and number of gradient directions for high-angular-resolution diffusion-weighted imaging</article-title>. <source>NMR Biomed.</source>
<volume>26</volume>, <fpage>1775</fpage>–<lpage>1786</lpage>. <pub-id pub-id-type="doi">10.1002/nbm.3017</pub-id><?supplied-pmid 24038308?><pub-id pub-id-type="pmid">24038308</pub-id></mixed-citation>
    </ref>
    <ref id="B75">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tournier</surname><given-names>J.-D.</given-names></name><name><surname>Calamante</surname><given-names>F.</given-names></name><name><surname>Gadian</surname><given-names>D. G.</given-names></name><name><surname>Connelly</surname><given-names>A.</given-names></name></person-group> (<year>2004</year>). <article-title>Direct estimation of the fiber orientation density function from diffusion-weighted MRI data using spherical deconvolution</article-title>. <source>NeuroImage</source>
<volume>23</volume>, <fpage>1176</fpage>–<lpage>1185</lpage>. <pub-id pub-id-type="doi">10.1016/j.neuroimage.2004.07.037</pub-id><?supplied-pmid 15528117?><pub-id pub-id-type="pmid">15528117</pub-id></mixed-citation>
    </ref>
    <ref id="B76">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tuch</surname><given-names>D. S.</given-names></name></person-group> (<year>2004</year>). <article-title>Q-ball imaging</article-title>. <source>Magn. Reson. Med.</source>
<volume>52</volume>, <fpage>1358</fpage>–<lpage>1372</lpage>. <pub-id pub-id-type="doi">10.1002/mrm.20279</pub-id><?supplied-pmid 15562495?><pub-id pub-id-type="pmid">15562495</pub-id></mixed-citation>
    </ref>
    <ref id="B77">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Van Essen</surname><given-names>D. C.</given-names></name><name><surname>Smith</surname><given-names>S. M.</given-names></name><name><surname>Barch</surname><given-names>D. M.</given-names></name><name><surname>Behrens</surname><given-names>T. E.</given-names></name><name><surname>Yacoub</surname><given-names>E.</given-names></name><name><surname>Ugurbil</surname><given-names>K.</given-names></name><etal/></person-group>. (<year>2013</year>). <article-title>The WU-MINN human connectome project: an overview</article-title>. <source>Neuroimage</source><volume>80</volume>, <fpage>62</fpage>–<lpage>79</lpage>. <pub-id pub-id-type="doi">10.1016/j.neuroimage.2013.05.041</pub-id><?supplied-pmid 23684880?><pub-id pub-id-type="pmid">23684880</pub-id></mixed-citation>
    </ref>
    <ref id="B78">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Vangelderen</surname><given-names>P.</given-names></name><name><surname>DesPres</surname><given-names>D.</given-names></name><name><surname>Vanzijl</surname><given-names>P.</given-names></name><name><surname>Moonen</surname><given-names>C.</given-names></name></person-group> (<year>1994</year>). <article-title>Evaluation of restricted diffusion in cylinders. Phosphocreatine in rabbit leg muscle</article-title>. <source>J. Magn. Reson. Ser. B</source>
<volume>103</volume>, <fpage>255</fpage>–<lpage>260</lpage>. <pub-id pub-id-type="doi">10.1006/jmrb.1994.1038</pub-id><pub-id pub-id-type="pmid">8019777</pub-id></mixed-citation>
    </ref>
    <ref id="B79">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wedeen</surname><given-names>V. J.</given-names></name><name><surname>Hagmann</surname><given-names>P.</given-names></name><name><surname>Tseng</surname><given-names>W.-Y. I.</given-names></name><name><surname>Reese</surname><given-names>T. G.</given-names></name><name><surname>Weisskoff</surname><given-names>R. M.</given-names></name></person-group> (<year>2005</year>). <article-title>Mapping complex tissue architecture with diffusion spectrum magnetic resonance imaging</article-title>. <source>Magn. Reson. Med.</source>
<volume>54</volume>, <fpage>1377</fpage>–<lpage>1386</lpage>. <pub-id pub-id-type="doi">10.1002/mrm.20642</pub-id><?supplied-pmid 16247738?><pub-id pub-id-type="pmid">16247738</pub-id></mixed-citation>
    </ref>
    <ref id="B80">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Whittall</surname><given-names>K. P.</given-names></name><name><surname>MacKay</surname><given-names>A. L.</given-names></name></person-group> (<year>1989</year>). <article-title>Quantitative interpretation of NMR relaxation data</article-title>. <source>J. Magn. Reson.</source>
<volume>84</volume>, <fpage>134</fpage>–<lpage>152</lpage>. <pub-id pub-id-type="doi">10.1016/0022-2364(89)90011-5</pub-id></mixed-citation>
    </ref>
    <ref id="B81">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wu</surname><given-names>Y.-C.</given-names></name><name><surname>Alexander</surname><given-names>A. L.</given-names></name></person-group> (<year>2007</year>). <article-title>Hybrid diffusion imaging</article-title>. <source>NeuroImage</source>
<volume>36</volume>, <fpage>617</fpage>–<lpage>629</lpage>. <pub-id pub-id-type="doi">10.1016/j.neuroimage.2007.02.050</pub-id><?supplied-pmid 17481920?><pub-id pub-id-type="pmid">17481920</pub-id></mixed-citation>
    </ref>
    <ref id="B82">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name><surname>Xu</surname><given-names>J.</given-names></name><name><surname>Moeller</surname><given-names>S.</given-names></name><name><surname>Strupp</surname><given-names>J.</given-names></name><name><surname>Auerbach</surname><given-names>E.</given-names></name><name><surname>Chen</surname><given-names>L.</given-names></name><name><surname>Feinberg</surname><given-names>D.</given-names></name><etal/></person-group> (<year>2012</year>). <article-title>“Highly accelerated whole brain imaging using aligned-blipped-controlled-aliasing multiband EPI,”</article-title> in <source>Proceedings of the 20th Annual Meeting of ISMRM</source> (<publisher-loc>Melbourne</publisher-loc>).</mixed-citation>
    </ref>
    <ref id="B83">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhang</surname><given-names>H.</given-names></name><name><surname>Schneider</surname><given-names>T.</given-names></name><name><surname>Wheeler-Kingshott</surname><given-names>C. A.</given-names></name><name><surname>Alexander</surname><given-names>D. C.</given-names></name></person-group> (<year>2012</year>). <article-title>Noddi: practical <italic>in vivo</italic> neurite orientation dispersion and density imaging of the human brain</article-title>. <source>Neuroimage</source>
<volume>61</volume>, <fpage>1000</fpage>–<lpage>1016</lpage>. <pub-id pub-id-type="doi">10.1016/j.neuroimage.2012.03.072</pub-id><?supplied-pmid 22484410?><pub-id pub-id-type="pmid">22484410</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
