<?DTDIdentifier.IdentifierValue -//NPG//DTD XML Article//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName NPG_XML_Article.dtd?>
<?SourceDTD.Version 2.7.10?>
<?ConverterInfo.XSLTName nature2nlmx2.xsl?>
<?ConverterInfo.Version 2?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Sci Rep</journal-id>
    <journal-id journal-id-type="iso-abbrev">Sci Rep</journal-id>
    <journal-title-group>
      <journal-title>Scientific Reports</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2045-2322</issn>
    <publisher>
      <publisher-name>Nature Publishing Group</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">4479802</article-id>
    <article-id pub-id-type="pii">srep11565</article-id>
    <article-id pub-id-type="doi">10.1038/srep11565</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>GDC 2: Compression of large collections of genomes</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Deorowicz</surname>
          <given-names>Sebastian</given-names>
        </name>
        <xref ref-type="corresp" rid="c1">a</xref>
        <xref ref-type="aff" rid="a1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Danek</surname>
          <given-names>Agnieszka</given-names>
        </name>
        <xref ref-type="aff" rid="a1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Niemiec</surname>
          <given-names>Marcin</given-names>
        </name>
        <xref ref-type="aff" rid="a2">2</xref>
      </contrib>
      <aff id="a1"><label>1</label><institution>Institute of Informatics, Silesian University of Technology</institution>, Akademicka 16, 44-100 Gliwice, <country>Poland</country></aff>
      <aff id="a2"><label>2</label><institution>Nubitech</institution>, 40-684 Katowice, <country>Poland</country></aff>
    </contrib-group>
    <author-notes>
      <corresp id="c1">
        <label>a</label>
        <email>sebastian.deorowicz@polsl.pl</email>
      </corresp>
    </author-notes>
    <pub-date pub-type="epub">
      <day>25</day>
      <month>06</month>
      <year>2015</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2015</year>
    </pub-date>
    <volume>5</volume>
    <elocation-id>11565</elocation-id>
    <history>
      <date date-type="received">
        <day>18</day>
        <month>03</month>
        <year>2015</year>
      </date>
      <date date-type="accepted">
        <day>28</day>
        <month>05</month>
        <year>2015</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>Copyright © 2015, Macmillan Publishers Limited</copyright-statement>
      <copyright-year>2015</copyright-year>
      <copyright-holder>Macmillan Publishers Limited</copyright-holder>
      <license xmlns:xlink="http://www.w3.org/1999/xlink" license-type="open-access" xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <!--author-paid-->
        <license-p>This work is licensed under a Creative Commons Attribution 4.0 International License. The images or other third party material in this article are included in the article’s Creative Commons license, unless indicated otherwise in the credit line; if the material is not included under the Creative Commons license, users will need to obtain permission from the license holder to reproduce the material. To view a copy of this license, visit <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link></license-p>
      </license>
    </permissions>
    <abstract>
      <p>The fall of prices of the high-throughput genome sequencing changes the landscape of modern genomics. A number of large scale projects aimed at sequencing many human genomes are in progress. Genome sequencing also becomes an important aid in the personalized medicine. One of the significant side effects of this change is a necessity of storage and transfer of huge amounts of genomic data. In this paper we deal with the problem of compression of large collections of complete genomic sequences. We propose an algorithm that is able to compress the collection of 1092 human diploid genomes about 9,500 times. This result is about 4 times better than what is offered by the other existing compressors. Moreover, our algorithm is very fast as it processes the data with speed 200 MB/s on a modern workstation. In a consequence the proposed algorithm allows storing the complete genomic collections at low cost, e.g., the examined collection of 1092 human genomes needs only about 700 MB when compressed, what can be compared to about 6.7 TB of uncompressed FASTA files. The source code is available at <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" ext-link-type="uri" xlink:href="http://sun.aei.polsl.pl/REFRESH/index.php?page=projects&amp;project=gdc&amp;subpage=about">http://sun.aei.polsl.pl/REFRESH/index.php?page=projects&amp;project=gdc&amp;subpage=about</ext-link>.</p>
    </abstract>
  </article-meta>
</front>
<body>
  <p>The genome sequencing technology has recently become so cheap that it started to be considered as a useful tool in medicine. Companies like Illumina offer whole human genome sequencing for medical purposes for five thousand U.S. dollars<xref ref-type="bibr" rid="b1">1</xref>. There are also large scale projects designed to find the common differences between individual genomes. One of the most famous is the 1000 Genome Project<xref ref-type="bibr" rid="b2">2</xref> which aims at sequencing the genomes of several thousand humans and determining the genetic variants with at least 1% frequency. There are, however, even broader attempts for human genome sequencing, to mention the UK10K project<xref ref-type="bibr" rid="b3">3</xref>, the Personal Genomes Project<xref ref-type="bibr" rid="b4">4</xref>, and the Million Veteran Project (MVP)<xref ref-type="bibr" rid="b5">5</xref>. The planned number of sequenced genomes are 10 K, 100 K, and 1 M, respectively. Large collections of genomes are built also for other species. E.g., in the 1001 Genomes Project (1001 GP)<xref ref-type="bibr" rid="b6">6</xref><xref ref-type="bibr" rid="b7">7</xref> about 1000 of genomes of <italic>Arabidopsis thaliana</italic> are to be sequenced.</p>
  <p>The sequencing is of course challenging, but due to the large amounts of produced data, the pure storage and transfer of the results becomes a challenge too. The recent papers<xref ref-type="bibr" rid="b8">8</xref><xref ref-type="bibr" rid="b9">9</xref> show that the IT costs are (or will be soon) comparable to the sequencing costs. Due to the slow progress in reducing the IT prices, the effective ways of representing genomic data in compact form are intensively investigated. Several subproblems can be identified here. The first is the compression of raw sequencing reads<xref ref-type="bibr" rid="b10">10</xref><xref ref-type="bibr" rid="b11">11</xref><xref ref-type="bibr" rid="b12">12</xref><xref ref-type="bibr" rid="b13">13</xref> The second is the compression of reads after mapping onto reference genomes<xref ref-type="bibr" rid="b10">10</xref><xref ref-type="bibr" rid="b14">14</xref><xref ref-type="bibr" rid="b15">15</xref>. The third is the compression of results of variant calling<xref ref-type="bibr" rid="b16">16</xref><xref ref-type="bibr" rid="b17">17</xref><xref ref-type="bibr" rid="b18">18</xref>. The fourth is the compression of complete genomic sequences<xref ref-type="bibr" rid="b19">19</xref><xref ref-type="bibr" rid="b20">20</xref><xref ref-type="bibr" rid="b21">21</xref><xref ref-type="bibr" rid="b22">22</xref>. These subproblems are related, nevertheless require different approaches. The recent surveys discuss most of the existing algorithms<xref ref-type="bibr" rid="b9">9</xref><xref ref-type="bibr" rid="b23">23</xref><xref ref-type="bibr" rid="b24">24</xref>.</p>
  <p>In this paper we deal with the last of the mentioned tasks, i.e., storage of collections of genomes. We propose Genome Differential Compressor 2 (GDC 2), a utility for compression of large sets of genomes of the same species. Since such genomes are highly similar, e.g., it was estimated that two humans have their genomes identical in 99.5 percent<xref ref-type="bibr" rid="b25">25</xref>, it is clear that when compressing a collection of genomes one can obtain better compression ratios than when compressing the sequences separately. Initially, the researchers tried to use the similarity between a sequence to be compressed and a reference sequence. The first impressive result was by Christley <italic>et al.</italic><xref ref-type="bibr" rid="b16">16</xref>. They showed that the description of differences between James Watson’s genome and the reference genome can be stored in as little as 4.1 MB. Taking into account that the complete haploid human genome is of size 3.1 Gbases, this translates to ~750-fold compression. This result was recently improved by Pavlichin <italic>et al.</italic><xref ref-type="bibr" rid="b17">17</xref> who reduced the space for the JW genome to about 2.5 MB (compression ratio ~1250).</p>
  <p>Such large compression ratio was possible since the data were preprocessed, i.e., precise information of all variants were available. This is not always the case, as the genomes can be obtained in different experiments with different reference genomes or the genomes can be <italic>de novo</italic> assembled. In such situations the data to be compressed are collections of complete genomic sequences. This significantly complicates the compression task, as the differences between sequences are not given explicitly; they have to be found, e.g., by multiple complete genome alignment, which is a very complex problem. Moreover, for technological reasons, the differences between <italic>de novo</italic> assembled genomes are usually larger than between the reassembled genomes.</p>
  <p>Several papers for the problem of compression of collections of genomic sequences were published<xref ref-type="bibr" rid="b19">19</xref><xref ref-type="bibr" rid="b20">20</xref><xref ref-type="bibr" rid="b22">22</xref><xref ref-type="bibr" rid="b26">26</xref><xref ref-type="bibr" rid="b27">27</xref>. In majority of them, each single sequence is compressed separately, by identifying the differences between it and a single reference genome. This allowed to obtain compression ratios for human genomes up to 400, much poorer than ~1250 obtained by Pavlichin <italic>et al.</italic><xref ref-type="bibr" rid="b17">17</xref>. This is the price for the lack of prior knowledge about the compressed data. The most successful attempts at obtaining higher compression ratios were possible by exploring the knowledge of similarities between more sequences in the collection. Since such approaches are the real competitors to the proposed algorithm, we will describe them a little more.</p>
  <p>The first attempt in this direction was GDC-ultra<xref ref-type="bibr" rid="b19">19</xref>. It takes a single reference sequence and constructs a search structure (namely, hash table) for it. Then it compresses the first sequence of the collection by looking for similarities between this sequence and the reference. When the sequence is processed, it is used as an additional reference sequence for further sequences, so a separate search structure is constructed for it. The same is for the following sequences, so for example, the 25th input sequence of the collection is compressed by looking for the differences between it and: the main reference sequence, the formerly processed 24 sequences of the collection. The number of additional reference sequences is limited to 39 (for technical reasons only, mainly to keep the necessary amount of memory at a reasonable level). If the collection consists of more than 39 sequences, the 40th, 41st, etc. sequence is compressed with the 40 references only. The differences between the current sequence and the referential sequences is finally Huffman coded. Such approach proved to be promising, since the collection of 69 human genomes were compressed with ratio ~1000.</p>
  <p>A different approach was used by Wandelt <italic>et al.</italic><xref ref-type="bibr" rid="b21">21</xref> in their FRESCO algorithm. They investigated several variants, and below we will describe the one that gave the best results. The collection is divided into two sets: (<italic>i</italic>) additional references, (<italic>ii</italic>) remaining sequences. FRESCO constructs a search structure (suffix tree) for the main reference sequence. Then it looks for similarities between the additional reference sequences and the main reference performing classical Ziv–Lempel parsing<xref ref-type="bibr" rid="b28">28</xref> of additional reference sequences. As a result it obtains for each additional reference a sequence of triples (position in the main reference, length of the identical part, next symbol). For the Ziv–Lempel-parsed additional reference sequences a search structure (hash table) is built. After that FRESCO is ready to perform the compression of the remaining sequences from the collection. Each sequence is Ziv–Lempel-parsed against the main reference sequence. Then, the sequence of triples is compressed using the additional Ziv–Lempel-parsed reference sequences serving as the second-level reference. The obtained compression ratios are impressive as they are approximately 3000 for the collection of about 1000 haploid genomes of the 1000 GP, when 70 additional reference sequences were used.</p>
  <p>The best compression ratios for the genomic collection was obtained by TGC algorithm<xref ref-type="bibr" rid="b18">18</xref>. It is, however, from a different category, since as an input it takes a Variant Call Format (VCF)<xref ref-type="bibr" rid="b29">29</xref> file describing the differences between genomes and the reference sequence, so it processes essentially the same data as Pavlichin <italic>et al.</italic><xref ref-type="bibr" rid="b17">17</xref>. In this work we deal with complete genomes stored in FASTA format. In theory it is possible to convert FASTA files into VCF files, but it would require making a close to optimal alignment of many complete genomes (i.e., finding the smallest set of differences between these genomes), which is far from being trivial, especially due to a presence of long structural variants. Nevertheless, comparing the obtained results with TGC will be interesting, as it will allow us to see how far we are from the top algorithm for the similar problem. The main idea of TGC is to split the VCF file into two files. The first (dictionary of variants) stores a description of each variant (i.e., its type, position, alternative alleles, etc.). The second file stores the binary representation of presence/absence of each single variant in each single sequence. The bit vectors (one for each sequence) are compressed using a specialized Ziv–Lempel-based algorithm. The dictionary file is also compressed using a specialized algorithm. The compression ratios of TGC for the collection of 1092 diploid human genomes (when taking only 1 reference sequence) is about 15,500.</p>
  <sec disp-level="1" sec-type="methods">
    <title>Methods</title>
    <sec disp-level="2">
      <title>Definitions</title>
      <p>For precise description of the proposed algorithm let us define some terms. As an input we have a single reference sequence <italic>R</italic> and a collection of genome sequences <inline-formula id="d33e262"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" id="d33e263" xlink:href="srep11565-m45.jpg"/></inline-formula> ={<italic>S</italic><sup>1</sup>, <italic>S</italic><sup>2</sup>, ..., <italic>S</italic><sup>n</sup>}. Each sequence is composed of symbols from some alphabet Σ, i.e, <inline-formula id="d33e281"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" id="d33e282" xlink:href="srep11565-m1.jpg"/></inline-formula> for each 1 ≤ <italic>k</italic> ≤ <italic>n</italic>, where <inline-formula id="d33e290"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" id="d33e291" xlink:href="srep11565-m2.jpg"/></inline-formula> for each valid <italic>i</italic> and <inline-formula id="d33e297"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" id="d33e298" xlink:href="srep11565-m3.jpg"/></inline-formula> denotes the length of <italic>S</italic><sup><italic>k</italic></sup>. Also <inline-formula id="d33e306"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" id="d33e307" xlink:href="srep11565-m4.jpg"/></inline-formula>, where <italic>r</italic><sub><italic>i</italic></sub> ∈ Σ for each valid <italic>i</italic> and <inline-formula id="d33e319"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" id="d33e320" xlink:href="srep11565-m5.jpg"/></inline-formula> denotes the length of <italic>R</italic>. For any sequence <italic>X</italic> (a reference or from the collection) <italic>X</italic><sub><italic>i</italic>,<italic>j</italic></sub> = <italic>x</italic><sub><italic>i</italic></sub><italic>x</italic><sub><italic>i</italic>+1</sub>…<italic>x</italic><sub><italic>j</italic></sub>.</p>
      <p>For the DNA sequences the alphabet should ideally contain only 4 symbols (<bold>A</bold>, <bold>C</bold>, <bold>G</bold>, <bold>T</bold>), but in practice <bold>N</bold> (unknown) symbols are quite frequent. Moreover, sometimes also other IUPAC codes appear. Thus in the work we assume only that the symbols are letters from the ASCII code (we also distinguish between lower- and uppercase letters).</p>
    </sec>
    <sec disp-level="2">
      <title>Compression algorithm</title>
      <p>At the beginning, the compression algorithm reads the reference sequence <italic>R</italic> and constructs a search structure <italic>HT</italic><sup>R</sup> (namely, hash table with linear probing<xref ref-type="bibr" rid="b30">30</xref>) for it. The hash value is computed for each <italic>h</italic><sub>1<italic>m</italic></sub>-symbol long substring of <italic>R</italic> (<italic>h</italic><sub>1<italic>m</italic></sub> = 15 by default, but a different value can be specified by a user), i.e., for all <italic>R</italic><sub><italic>i</italic>,<italic>i</italic>+<italic>h1m</italic>−1</sub>, where <inline-formula id="d33e419"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" id="d33e420" xlink:href="srep11565-m6.jpg"/></inline-formula>. After that, the main processing of the collection <inline-formula id="d33e422"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" id="d33e423" xlink:href="srep11565-m7.jpg"/></inline-formula> starts. The compression algorithm is two-level.</p>
      <p>At the first level, we perform the Ziv–Lempel factoring of all sequences from the collection <inline-formula id="d33e427"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" id="d33e428" xlink:href="srep11565-m8.jpg"/></inline-formula>. This means that for each sequence <italic>S</italic><sup><italic>k</italic></sup> from <inline-formula id="d33e436"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" id="d33e437" xlink:href="srep11565-m9.jpg"/></inline-formula> we produce a sequence <italic>L</italic><sup><italic>k</italic></sup> composed of tuples (the first symbol of a tuple, denoted as <italic>f</italic><sub>x</sub> (where x indicates the type of the tuple), is an identifier, as it will become clear later in the text). To this end, we start from <italic>i</italic> = 1 and look for the longest common substring <inline-formula id="d33e454"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" id="d33e455" xlink:href="srep11565-m10.jpg"/></inline-formula> present in <italic>R</italic>. Since the search structure <italic>HT</italic><sup>R</sup> contains substrings of length <italic>h</italic><sub>1<italic>m</italic></sub> it is not possible to find shorter matches. There are two possibilities here:<list id="l1" list-type="bullet"><list-item><p>No match of length at least <italic>h</italic><sub>1<italic>m</italic></sub> is found. Then, we append a tuple describing single symbol <inline-formula id="d33e483"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" id="d33e484" xlink:href="srep11565-m11.jpg"/></inline-formula>, i.e., <inline-formula id="d33e486"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" id="d33e487" xlink:href="srep11565-m12.jpg"/></inline-formula> to <italic>L</italic><sup><italic>k</italic></sup> and update the current sequence position: <italic>i</italic> ← <italic>i</italic> + 1.</p></list-item><list-item><p>Otherwise we have a match <inline-formula id="d33e504"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" id="d33e505" xlink:href="srep11565-m13.jpg"/></inline-formula> of length <italic>j</italic> − <italic>i</italic> + 1. We encode it by appending the tuple <inline-formula id="d33e513"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" id="d33e514" xlink:href="srep11565-m14.jpg"/></inline-formula> to <italic>L</italic><sup><italic>k</italic></sup>. Then, we update the current sequence position: <italic>i</italic> ← <italic>j</italic> + 1.</p></list-item></list></p>
      <p>There is, however, some exception to the general rule that no shorter than <italic>h</italic><sub>1<italic>m</italic></sub> symbols match can be found. Genomic sequences often differ by single nucleotide polymorphism (SNPs) or short indels (a few symbols long insertions or deletions). Thus, when some match is found, before looking for another match in <italic>R</italic> using the hash table <italic>HT</italic><sup>R</sup>, we do 3 (or 5, depending on the user-specified option) simple verifications. We check whether the next symbol(s) after the current match is just a single nucleotide mutation or a single-symbol (or double-symbol) indel. We allow matches found after such variation to be of length <italic>h</italic><sub>1<italic>e</italic></sub> (equal to 4 by default). The rationale for such decision is two-fold. Firstly, it speeds up the searching as for the verification we do not need to query the hash table <italic>HT</italic><sup>R</sup>. Secondly, such matches (even if they are short) can be quite efficiently encoded as the match position is easy to predict (encoding of Ziv–Lempel parsing results is described below). Thus, even if the sequence <italic>L</italic><sup><italic>k</italic></sup> will be longer when such short matches are allowed, the final compression ratio can be better.</p>
      <p>At the second level, the algorithm performs a similar Ziv–Lempel factoring of the collection <inline-formula id="d33e567"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" id="d33e568" xlink:href="srep11565-m20.jpg"/></inline-formula> = {<italic>L</italic><sup>1</sup>, <italic>L</italic><sup>2</sup>, ..., <italic>L</italic><sup><italic>n</italic></sup>} to obtain the collection <inline-formula id="d33e587"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" id="d33e588" xlink:href="srep11565-m46.jpg"/></inline-formula> = {<italic>D</italic><sup>1</sup>, <italic>D</italic><sup>2</sup>, ..., <italic>D</italic><sup><italic>n</italic></sup>}. We will use here similar notations as for the sequences <inline-formula id="d33e607"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" id="d33e608" xlink:href="srep11565-m15.jpg"/></inline-formula>, i.e., <inline-formula id="d33e610"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" id="d33e611" xlink:href="srep11565-m16.jpg"/></inline-formula> is the <italic>i</italic>th tuple of sequence <italic>L</italic><sup><italic>k</italic></sup>, <inline-formula id="d33e622"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" id="d33e623" xlink:href="srep11565-m17.jpg"/></inline-formula> is <inline-formula id="d33e626"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" id="d33e627" xlink:href="srep11565-m18.jpg"/></inline-formula>. Additionally we define the <italic>weight</italic> of a substring <inline-formula id="d33e632"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" id="d33e633" xlink:href="srep11565-m19.jpg"/></inline-formula> as the sum of weights of the tuples it is composed of, where the weight of a literal tuple is 1 and the weight of a match tuple is 7 (values chosen experimentally). A search structure <italic>HT</italic><sup>L</sup> (namely, hash table with linear probing) is used here to look for matches in <inline-formula id="d33e640"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" id="d33e641" xlink:href="srep11565-m20.jpg"/></inline-formula>. At the beginning <italic>HT</italic><sup>L</sup> is empty, but we update it by adding the already processed sequences of <inline-formula id="d33e649"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" id="d33e650" xlink:href="srep11565-m20.jpg"/></inline-formula>, i.e., when processing <italic>L</italic><sup><italic>k</italic></sup> the hash table <italic>HT</italic><sup>L</sup> contains only all substrings of tuples of weights “close” to <italic>h</italic><sub>2</sub> = 11 of <italic>L</italic><sup>1</sup>, <italic>L</italic><sup>2</sup>,…, <italic>L</italic><sup><italic>k</italic>−1</sup>. (For each position <italic>i</italic> in the tuple sequence <italic>L</italic><sup><italic>u</italic></sup> we take the shortest substring (in terms of the number of tuples) <inline-formula id="d33e696"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" id="d33e697" xlink:href="srep11565-m22.jpg"/></inline-formula> of weight not smaller than <italic>h</italic><sub>2</sub>.) The substrings of tuples of <italic>L</italic><sup><italic>k</italic></sup> are added to the hash table after <italic>L</italic><sup><italic>k</italic></sup> is processed.</p>
      <p>Now, when we process <italic>L</italic><sup><italic>k</italic></sup> starting from <italic>i</italic> = 1 to obtain <italic>D</italic><sup><italic>k</italic></sup>, we look for the match of the largest weight <inline-formula id="d33e734"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" id="d33e735" xlink:href="srep11565-m23.jpg"/></inline-formula>. There are two possible situations here:<list id="l2" list-type="bullet"><list-item><p>No match of weight at least <italic>h</italic><sub>2</sub> is found. In this case we append the tuple <inline-formula id="d33e746"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" id="d33e747" xlink:href="srep11565-m24.jpg"/></inline-formula> (describing the first-level literal or the first-level match) to <italic>D</italic><sup><italic>k</italic></sup> and update the current sequence position: <italic>i</italic> ← <italic>i</italic> + 1.</p></list-item><list-item><p>Match <inline-formula id="d33e764"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" id="d33e765" xlink:href="srep11565-m25.jpg"/></inline-formula> is found. In this case we append the tuple <inline-formula id="d33e767"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" id="d33e768" xlink:href="srep11565-m26.jpg"/></inline-formula> to <italic>D</italic><sup><italic>k</italic></sup> and update the current sequence position: <italic>i</italic> ← <italic>j</italic> + 1.</p></list-item></list></p>
      <p>The sequence <italic>D</italic><sup><italic>k</italic></sup> is composed of tuples of three kinds: first-level literal (pair), first-level match (triple), second-level match (quadruple). Since when processing <italic>L</italic><sup>1</sup> the search structure <italic>HT</italic><sup>L</sup> is empty, <italic>D</italic><sup>1</sup> = <italic>L</italic><sup>1</sup>.</p>
      <p>The reason for using two-level Ziv–Lempel factoring is that the genome sequences are usually highly similar, so in the whole collection the same series of matches and literals between the current sequence and the reference sequence can be found. Thus, instead of storing the series of tuples many times, it is beneficial to encode them once and only reference to them for other sequences. <xref ref-type="fig" rid="f1">Figure 1</xref> shows how the two-level factoring is performed.</p>
      <p>The collection <inline-formula id="d33e818"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" id="d33e819" xlink:href="srep11565-m46.jpg"/></inline-formula> is a succinct representation of the input collection <inline-formula id="d33e821"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" id="d33e822" xlink:href="srep11565-m45.jpg"/></inline-formula>. Nevertheless, it has potential to be compressed even more if we use an arithmetic coder<xref ref-type="bibr" rid="b31">31</xref>. What is important, instead of encoding the tuples as they are, we predict some of their values (e.g., matching positions) and encode only the differences between our predictions and the real values. The successive fields of the tuples are arithmetically encoded as follows.</p>
    </sec>
    <sec disp-level="2">
      <title>Flags</title>
      <p>There are only 3 different flags distinguishing between the tuple types. We encode them contextually, where the context is composed of two recently encoded flags.</p>
    </sec>
    <sec disp-level="2">
      <title>Codes of symbols in the first-level literals</title>
      <p>Codes of symbols are encoded contextually, where the context is the recently encoded symbol.</p>
    </sec>
    <sec disp-level="2">
      <title>Positions of the first-level matches</title>
      <p>These positions can be from a broad range, i.e., between 1 and <inline-formula id="d33e841"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" id="d33e842" xlink:href="srep11565-m29.jpg"/></inline-formula>. Since the genomic sequences are similar, the position of the current match is likely to be close to the position of the previous match increased by the number of symbols encoded in the meantime. Thus, before encoding the position <italic>pos</italic> we estimate its value <italic>expected</italic>_<italic>pos</italic> and encode only the difference <italic>relative</italic>_<italic>pos</italic> = <italic>expected</italic>_<italic>pos</italic>−<italic>pos</italic>. The <italic>expected</italic>_<italic>pos</italic> is calculated by increasing the recently encoded <italic>pos</italic> by: (<italic>i</italic>) the length of the last match, (<italic>ii</italic>) the number of literals encoded since the last match, (<italic>iii</italic>) the number of symbols encoded as the second-level matches seen from the recent first-level match. Then, the estimation is classified as: <italic>perfect</italic> (<italic>relative</italic>_<italic>pos</italic> = 0), <italic>good</italic>, (<inline-formula id="d33e901"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" id="d33e902" xlink:href="srep11565-m30.jpg"/></inline-formula>), poor (other values). Finally, the estimation type is encoded without a context and the necessary number of bytes (0, 1, or 4) of <italic>relative</italic>_<italic>pos</italic> are encoded with context being the estimation type and number of encoded byte. (Please note that various decisions on boundaries between, e.g., classes of estimations, length of matches, are based on preliminary experiments on parts of the input data and the exact influence of these decisions on the overall compression ratio is not presented.)</p>
    </sec>
    <sec disp-level="2">
      <title>Lengths of the first-level matches</title>
      <p>Each length is classified as: <italic>short</italic> (not longer than 2<sup>8</sup> symbols), <italic>long</italic> (of length between 2<sup>8</sup> and 2<sup>16</sup> + 2<sup>8</sup> symbols), <italic>very long</italic> (longer than 2<sup>16</sup> + 2<sup>8</sup> symbols). Then, the length type is encoded (without a context). Finally, the necessary number of bytes (1, 2, or 4) of the length are encoded with context being the length type and the number of encoded byte.</p>
    </sec>
    <sec disp-level="2">
      <title>Sequence ids of the second-level matches</title>
      <p>The value <italic>id</italic> is split into two integers: <inline-formula id="d33e951"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" id="d33e952" xlink:href="srep11565-m31.jpg"/></inline-formula> (prefix) and <inline-formula id="d33e954"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" id="d33e955" xlink:href="srep11565-m32.jpg"/></inline-formula> (suffix). The prefix is encoded without a context. The context of the suffix is the prefix.</p>
    </sec>
    <sec disp-level="2">
      <title>Positions of the second-level matches</title>
      <p>Similarly like the positions of the first-level matches, these values can be from a broad range. Thus, instead of encoding them as they are, we estimate the position and encode only the difference. Let us assume the current sequence is <italic>L</italic><sup><italic>k</italic></sup>. We need some auxiliary array <italic>A</italic>[1..k] to make the estimations possible. Now we will discuss how <italic>A</italic> is maintained when processing <italic>L</italic><sup><italic>k</italic></sup> Then, we will show how it is used to estimate the positions of the second-level matches.</p>
      <p>Let us assume that the we have a match in the sequence <italic>L</italic><sup><italic>u</italic></sup>. After encoding it we store in A[<italic>u</italic>] the pair <inline-formula id="d33e991"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" id="d33e992" xlink:href="srep11565-m33.jpg"/></inline-formula>, where <italic>p</italic><sup>A</sup> is the match position in <italic>L</italic><sup><italic>u</italic></sup> and <italic>s</italic><sup>A</sup> is the number of symbols of <italic>S</italic><sup><italic>k</italic></sup> processed before the current match.</p>
      <p>Thus, the encoding of the match positions is made as follows. For a match in the sequence <italic>L</italic><sup><italic>u</italic></sup> we calculate the difference <italic>d</italic> between the current position in <italic>S</italic><sup><italic>k</italic></sup> and the position <italic>S</italic><sup>A</sup> stored in <italic>A</italic>[<italic>u</italic>]. Then, we advance the position <italic>p</italic><sup>A</sup> (stored in <italic>A</italic>[<italic>u</italic>]) of <italic>L</italic><sup><italic>u</italic></sup> as long as the number of the symbols covered by the first-level literals and matches is not larger than <italic>d</italic>. What we obtain is the expected position in <italic>L</italic><sup><italic>u</italic></sup> for the current match.</p>
      <p>Then, we calculate the difference between the expectation and the value of the current tuple. The estimations are classified as: <italic>perfect</italic> (difference is 0), <italic>good</italic> (absolute value of the difference between 1 and 16), <italic>moderate</italic> (absolute value of the difference between 16 and 256), and <italic>poor</italic> (other values). Finally, the estimation type is encoded without a context and the necessary number of bytes of the difference are encoded with context being the estimation type and the number of the encoded byte.</p>
    </sec>
    <sec disp-level="2">
      <title>Lengths of the second-level matches</title>
      <p>The lengths are classified according the their value to: <italic>short</italic> (not longer than 2<sup>4</sup> tuples), <italic>medium-sized</italic> (between 2<sup>4</sup> and 2<sup>5</sup> + 2<sup>4</sup> tuples), <italic>long</italic> (between 2<sup>5</sup> + 2<sup>4</sup> and 2<sup>7</sup> + 2<sup>5</sup> + 2<sup>4</sup> tuples), <italic>very long</italic> (between 2<sup>7</sup> + 2<sup>5</sup> + 2<sup>4</sup> and 2<sup>8</sup> + 2<sup>7</sup> + 2<sup>5</sup> + 2<sup>4</sup> tuples), <italic>extremely long</italic> (the rest). Then, the length type is encoded (without a context). Finally, the necessary number of bytes is encoded, where the context is the length type and additionally (for extremely long lengths) also the number of encoded byte.</p>
    </sec>
    <sec disp-level="2">
      <title>Decompression algorithm</title>
      <p>Decompression is straightforward. At the beginning the <inline-formula id="d33e1163"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" id="d33e1164" xlink:href="srep11565-m46.jpg"/></inline-formula> collection is obtained by arithmetically decoding the compressed file. Then, the collection <inline-formula id="d33e1166"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" id="d33e1167" xlink:href="srep11565-m20.jpg"/></inline-formula> is decoded. Finally, the sequences of <inline-formula id="d33e1169"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" id="d33e1170" xlink:href="srep11565-m45.jpg"/></inline-formula> are constructed from <inline-formula id="d33e1172"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" id="d33e1173" xlink:href="srep11565-m20.jpg"/></inline-formula> and <italic>R</italic>.</p>
    </sec>
    <sec disp-level="2">
      <title>Access to a single compressed sequence</title>
      <p>A drawback of the proposed algorithm is that to decompress <italic>S</italic><sup><italic>n</italic></sup> we need to decompress (at least at the second level) all other sequences. More precisely, to obtain <italic>S</italic><sup><italic>m</italic></sup> we need to have <italic>L</italic><sup>1</sup>, <italic>L</italic><sup>2</sup>,…, <italic>L</italic><sup>m−1</sup> as they must be known to obtain <italic>L</italic><sup><italic>m</italic></sup>. Then, we can obtain <italic>S</italic><sup><italic>m</italic></sup> from <italic>L</italic><sup><italic>m</italic></sup> and <italic>R</italic>. This can be important especially when <italic>m</italic> is large. To partially solve this problem we implemented a variant of the compression algorithm in which we allow to set by the user (during compression) the fraction of the sequences that can be used as the second-level references. Thus, when this parameter is, e.g., 30%, in the worst case only 30% of <inline-formula id="d33e1237"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" id="d33e1238" xlink:href="srep11565-m20.jpg"/></inline-formula> must be decompressed. This deteriorates the compression ratio, so this is rather a compromise than a perfect solution.</p>
    </sec>
    <sec disp-level="2">
      <title>Real implementation</title>
      <p>To increase the speed of the compression and decompression we designed the compressor in a multithreaded fashion. There are several (user-defined) threads performing the first-level compression (and decompression) and a single thread performing the second-level compression (and decompression). For example, in the compression, each of the first-level threads reads a sequence <italic>S</italic><sup><italic>k</italic></sup> from a queue of sequences to compress and performs the Ziv–Lempel factoring of <italic>S</italic><sup><italic>k</italic></sup> according to <italic>R</italic>. The results <italic>L</italic><sup><italic>k</italic></sup> are stored in an in-memory queue <italic>Q</italic>. The second-level-compression thread reads sequences <italic>L</italic><sup><italic>k</italic></sup> from <italic>Q</italic>, performs the Ziv–Lempel factoring of it according to the already processed part of sequences from <inline-formula id="d33e1279"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" id="d33e1280" xlink:href="srep11565-m20.jpg"/></inline-formula> obtaining <italic>D</italic><sup><italic>k</italic></sup> and finally performs also the entropy coding of <italic>D</italic><sup><italic>k</italic></sup>. (We use a popular and fast arithmetic coding variant by Schindler, also known as a range coder (<ext-link xmlns:xlink="http://www.w3.org/1999/xlink" ext-link-type="uri" xlink:href="http://www.compressconsult.com/rangecoder/">http://www.compressconsult.com/rangecoder/</ext-link>).) The queue <italic>Q</italic> has FIFO (first in first out) organization, so there is no guarantee in which order the sequences of <inline-formula id="d33e1301"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" id="d33e1302" xlink:href="srep11565-m20.jpg"/></inline-formula> will be processed (it depends on the processing time of the sequences by the first-level threads). Thus, the compression ratios can slightly differ between the executions of the algorithm.</p>
      <p>The parallel design of the decompression algorithm is similar.</p>
      <p>The compression output is composed of three files. The one with extension gdc2_desc stores file names, sequence sizes, and ids of the multi-FASTA sequences. It is small, but to provide the best possible compression ratio of the whole algorithm, it is compressed using popular zlib library. The file with extension gdc2_rc contains the compressed representation of the collection <inline-formula id="d33e1308"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" id="d33e1309" xlink:href="srep11565-m45.jpg"/></inline-formula>. Finally, the file with extension gdc2_ref stores the compressed reference sequence <italic>R</italic>. As it is not a part of the collection to be compressed, its size is not counted in the experimental results. Nevertheless, we decided to compress it for the situations in which the user is interested in storing both the reference <italic>R</italic> and the collection <inline-formula id="d33e1317"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" id="d33e1318" xlink:href="srep11565-m45.jpg"/></inline-formula> in a single place in a compact form. This file is compressed by gathering symbols in triples and encoding them arithmetically.</p>
    </sec>
    <sec disp-level="2">
      <title>Relation of the proposed compressor to the existing works</title>
      <p>The proposed compressor bares some similarities to the existing works. The main concept of two-level Ziv–Lempel factoring is an extension of what was done in FRESCO<xref ref-type="bibr" rid="b21">21</xref>. There are, however, significant differences between these two approaches. FRESCO uses LZ77 factoring<xref ref-type="bibr" rid="b28">28</xref>, in which the sequences are divided into triples <inline-formula id="d33e1329"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" id="d33e1330" xlink:href="srep11565-m43.jpg"/></inline-formula>match position, match length, next symbol after the match<inline-formula id="d33e1332"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" id="d33e1333" xlink:href="srep11565-m44.jpg"/></inline-formula>, while GDC 2 uses LZSS factoring<xref ref-type="bibr" rid="b32">32</xref> (which encodes the sequence as a list of matches and literals as described in the previous section). Moreover, FRESCO looks for longer matches, while GDC 2 allows very short matches if they are close to the previous matches. These different approaches have impact on the next stage of the compression, as in FRESCO there are less factors to be entropy encoded, but each needs more bits. The concept of looking for short matches after some longer ones is an extension of what was made in our previous work<xref ref-type="bibr" rid="b19">19</xref>. In GDC 2 we, however, permit not only single-letter mismatches, but also short indels. We also do not limit the number of short matches in a series.</p>
      <p>In FRESCO, the collection of sequences is split into two sets: additional references and the remaining sequences. The additional references are compressed only according to the main reference sequence. The remaining sequences are compressed only according to the main and the additional references. Such design decision of FRESCO means that the maximal number of additional reference sequences is, in some way, limited. The reason is that if there are too many additional references, they could occupy a significant amount of space and the gain in better compression of the remaining sequences could not compensate that. In GDC 2, we do not split the collection into two sets. We just use all of the already processed sequences as the additional references for the current sequence, with significant boost in the compression ratio.</p>
      <p>The most important difference between FRESCO and GDC 2 is, however, in the compression of tuple fields. FRESCO estimates the position of the first-level matches in a similar way as GDC 2, but the positions and lengths of the second-level matches are processed as they are, without estimations. All the integers are stored using specific byte code. The whole resulting byte sequence is then Huffman coded (with no contextual statistics). In GDC 2, the positions of the second-level matches are estimated in a complex way, which allows to store only small values (differences between estimations and real positions). Moreover, the second-level matches are also taken into account for the estimation of the first-level matches. Finally, GDC 2 uses a better entropy coder and the fields are compressed contextually, to reduce the redundancy even more. The way the tuples are encoded using an arithmetic coder, especially the calculation of the expected positions for the first- and second-level matches, is novel in this context.</p>
      <p>GDC 2 and FRESCO differs also in the design of the internal data structures used for indexing sequences, which influences the processing speed.</p>
      <p>The multithreaded design of GDC 2 was not used by existing multi-reference genome compressors.</p>
    </sec>
  </sec>
  <sec disp-level="1" sec-type="results">
    <title>Results</title>
    <p>Our compressor, GDC 2, was implemented in C++11 language using C++ built-in concurrency mechanisms. The test machine was equipped with Intel i7 4930 K CPU (6 cores, clocked at 3.4 GHz), 64 GB of RAM, and two 3 TB HDDs in RAID 0 (measured average read speed about 350 MB/s).</p>
    <p>For the experiments we used two large datasets. <italic>A.thaliana</italic> dataset of total size 94 GB was obtained from the 1001 GP<xref ref-type="bibr" rid="b7">7</xref> and contains 775 sequences. <italic>H.sapiens</italic> dataset of total size 6670 GB was obtained from the 1000 GP<xref ref-type="bibr" rid="b2">2</xref> and contains 2184 sequences (from 1092 diploid human genomes). We also used one smaller dataset, <italic>H.sapiens alternate assemblies</italic>, which contains 11 alternatively assembled sequenced (haploid) human genomes. A more detailed description of all datasets (e.g., the chosen reference sequences) is given in the <xref ref-type="supplementary-material" rid="S1">supplementary material</xref>.</p>
    <p>The comparison of all of the existing genomic data compressors would be very hard due to many reasons. For example, some compressors do not support symbols other than ACGT, some cannot work with so huge data, some are very slow and performing complete experiments would take months. Thus we selected the compressors that proved to be the best (in terms of compression ratio) in the previous studies: 7z (general purpose compressor from the Ziv–Lempel family), RLZ<xref ref-type="bibr" rid="b26">26</xref>, GReEn<xref ref-type="bibr" rid="b27">27</xref>, ABRC<xref ref-type="bibr" rid="b20">20</xref>, GDC normal<xref ref-type="bibr" rid="b19">19</xref>, GDC ultra<xref ref-type="bibr" rid="b19">19</xref>, iDoComp<xref ref-type="bibr" rid="b22">22</xref>, FRESCO<xref ref-type="bibr" rid="b21">21</xref>. In the preliminary experiments (<xref ref-type="table" rid="t1">Table 1</xref>), we evaluated them on subsets of our datasets to select the candidates for more complete evaluation. As the results show, the single-reference compressors (RLZ, GReEn, ABRC, GDC-normal, iDoComp) give ratios much smaller than 1000 for <italic>H.sapiens</italic> chromosomes and smaller than 160 for <italic>A.thaliana</italic> chromosomes.</p>
    <p>The general purpose 7z can be seen as a multi-reference compressor since it looks for matches between the present sequence and the sequences seen in the past 1 GB. For <italic>H.sapiens</italic> Chromosome 21 it means about 20 recently processed sequences. Nevertheless, for <italic>H.sapiens</italic> Chromosome 1 these would be only 4 sequences. The true multi-reference compressors GDC-ultra and FRESCO give much better ratios for human chromosomes. For FRESCO we set the number of additional reference sequences to 100 as in a preliminary experiment (results not shown) this leaded to better compression ratios than the value 70 used in the original paper<xref ref-type="bibr" rid="b21">21</xref>.</p>
    <p>In a consequence, for further experiments we selected two best single-reference compressors, i.e., GDC-normal and iDoComp, and two best multi-reference compressors, i.e., GDC-ultra and FRESCO. The results of evaluation of the chosen compressors and the proposed GDC 2 are presented in <xref ref-type="table" rid="t2">Tables 2</xref> and <xref ref-type="table" rid="t3">3</xref>. For the <italic>H.sapiens</italic> dataset (<xref ref-type="table" rid="t2">Table 2</xref>) the compression ratio of GDC 2 is about 9500, which is approximately 4 times better than the best of the existing competitors. As it was mentioned earlier, GDC 2 bears some similarity to FRESCO, so it would be interesting to ask which of the changes between these algorithms have the highest influence on the GDC 2 advantage in the compression ratio. It is hard to answer precisely, as the algorithms differ in many details, and the improvements implemented in GDC 2 are not independent. Nevertheless, from the presented results and other preliminary tests, it seems that the two most important things are: careful estimation of the positions of the second-level matches and allowing more reference sequences (especially, using all the already processed sequences as the references for the current one). Most of the rest of the advantage is probably due to: allowing short matches if they are close to the previous ones and contextual encoding of integers.</p>
    <p>In the compression, the fastest is GDC 2, which works with a speed about 200 MB/s. Measuring of the speed of decompression is problematic as some of the compressors work faster than the disk speed (~350 MB/s), which in practice is more than sufficient. Nevertheless, we were interested in what is the true decompression speed of the GDC 2 algorithm, so we measured it with the output redirected to /dev/null (i.e., the sequences were decompressed but not stored) obtaining about 1000 MB/s.</p>
    <p>The experiment for the <italic>A.thaliana</italic> dataset (<xref ref-type="table" rid="t3">Table 3</xref>) shows that the compression ratios are much worse. The best ratio, almost 600 was obtained by GDC 2. This result is approximately 2.4 times better than the second best, GDC-ultra. Also the compression speeds are worse here.</p>
    <p>We also experimented with <italic>H.sapiens alternate assemblies</italic> dataset (<xref ref-type="table" rid="t4">Table 4</xref>). In contrast to previous datasets, here the sequences are much more diversified. Also the collection is much smaller as it contains only 11 individuals. Now the best compression ratios were obtained by GDC ultra algorithm. The advantage over GDC 2 is, however, rather small. Moreover, GDC ultra is more than 30 times slower. It is also important to stress that GDC ultra scales poorly, as the maximal number of reference sequences is 40, so for larger collections GDC 2 should win in the compression ratio. The fastest algorithm here was iDoComp. When running FRESCO, we selected here one-level compression because the collection was so small (or too divergent; it is hard to find the correct answer due to the small number of individuals) that two-level approach gave worse results.</p>
    <p>It is also interesting to compare the compression ratios with what is possible, when much more knowledge of the data is given (cf. TGC columns in <xref ref-type="table" rid="t2">Tables 2</xref> and <xref ref-type="table" rid="t3">3</xref>). Namely, when the input data are given as differences between the sequences and the reference (in VCF format), the best available compressor, TGC, obtained even better ratios. For human dataset they were about 15,500, on average. When we compare this with about 9,500 of GDC 2 we see that we are quite close to what is theoretically possible. Similar results are for <italic>A.thaliana</italic> dataset: ~590 ratio for GDC 2 and ~860 ratio for TGC. What is, however, worth to stress, GDC 2 is able to compress collections of sequences of the same species gathered from various sources (e.g., <italic>de novo</italic> assembled), when no alignment of them is given, while TGC input must be provided as aligned sequences described as variants between them. Therefore, TGC ratios should be seen only as a hint what in theory is possible for the examined collections of genomes, even if it would be extremely hard to obtain such results, and should not be directly compared to the ratios of the rest of examined compressors.</p>
    <p>In the next experiment, we measured the influence of the number of sequences in the input collection on the compression ratio, compression and decompression speeds, and memory usage. The results for two chromosomes are shown in <xref ref-type="fig" rid="f2">Fig. 2</xref>. As one can see for the human chromosome the compression ratio is about 8000 for 300 input sequences and increases moderately for growing number of input sequences. The same phenomenon can be observed for <italic>A.thaliana</italic> dataset, but the ratio is about an order of magnitude lower.</p>
    <p>The memory usage of GDC 2 depends mainly on the number of sequences serving as the second-level references as they must be stored (and indexed) in memory during compression. In this experiment all sequences were used as additional references, so the memory consumption grew constantly up to about 6 GB. (The most memory consuming was compression of <italic>H.sapiens</italic> Chromosome 2 for which about 24 GB of RAM was necessary.) The visible stepwise increment of the memory usage is a consequence of the assumed possible hash table size (being always a power of 2).</p>
    <p>The compression and decompression speeds for the human dataset initially grow with the increasing number of sequences and are the highest for the collection of size about 300–500. This is correlated with the growing compression ratio. Roughly speaking, the more second-level references, the better the second-level factoring (i.e., longer matches can be found) and so, there are significantly less data to process by the arithmetic coder. However, for larger collections, much more data must be analyzed during the second-level factoring, so the speed of compression falls down. A similar thing happens in the decompression. The better second-level factoring means less data to be arithmetically decoded, which increases the speed. Unfortunately, more second-level references means much more computations for the estimation of the positions of matches, which significantly influences the decompression time for large collections.</p>
    <p>In the next experiment, we measured the influence of the number of reference sequences in the second level of GDC 2 on the compression ratio, (de)compression speeds and the extraction time of a single sequence of a collection. The most important results are presented in <xref ref-type="fig" rid="f3">Fig. 3</xref> (the complete results are in <xref ref-type="supplementary-material" rid="S1">Supplementary Figure S1</xref>). Decreasing the number of second-level references by half results in a reduced RAM usage (about half less RAM is used) and a noticeable speed up of compression (24% for <italic>H.sapiens</italic> dataset and 17% for <italic>A.thaliana</italic> dataset) at a cost of some decrease of compression ratio (26% and 14%, respectively). Using even less sequences in the second level of GDC 2 leads also to significant gains in speed of decompression of complete collection or a single sequence, obviously at a cost of decreased compression ratio. For 10% of the sequences used, average single sequence access times decreased from 53 to 31 seconds for <italic>H.sapiens</italic> dataset (at a cost of 2.85 worse compression ratio) and from 63 to 21 seconds for <italic>A.thaliana</italic> dataset (at a cost of 1.79 worse compression ratio).</p>
    <p>GDC 2 is implemented in a multithreaded fashion, so it is natural to ask how its speed scales when the number of threads is increased. By default, GDC 2 uses 4 threads: 3 for the first level Ziv–Lempel factoring and 1 for the second-level factoring and arithmetic coding. The results presented in <xref ref-type="fig" rid="f4">Fig. 4</xref> show that the value 3 or 4 seems to be the best choice for the used datasets and the test machine. The speed is limited by disk speed or (for fast disks) by the single second-level compressing thread. This suggest that splitting this thread into two, e.g., one performing Ziv–Lempel factoring and other performing arithmetic compression would increase the total performance of GDC 2. Nevertheless, since the absolute values of compression speeds are high, we resigned from that in the present version of the software.</p>
  </sec>
  <sec disp-level="1" sec-type="discussion">
    <title>Discussion</title>
    <p>We proposed a new algorithm for compression of collections of complete genome sequences. The evaluation shows that its compression ratios are roughly 4 times better than the best existing competitors. Moreover, it is very fast, as the compression speed for the <italic>H.sapiens</italic> dataset is about 200 MB/s. The decompression speed is limited by the speed of the disk used in the experiments. When we measured this speed without storing the files onto disks, it was about 1000 MB/s. The algorithm is designed primarily to compress and decompress efficiently a large collection of genomes all at once. However, it also performs well for relatively small, divergent genome sets. Moreover, extraction of a single sequence is also possible. The access time, although not impressive (counted in tens of seconds), can be significantly improved at a cost of some decrease in the overall compression ratio.</p>
  </sec>
  <sec disp-level="1">
    <title>Additional Information</title>
    <p><bold>How to cite this article</bold>: Deorowicz, S. <italic>et al.</italic> GDC 2: Compression of large collections of genomes. <italic>Sci. Rep.</italic>
<bold>5</bold>, 11565; doi: 10.1038/srep11565 (2015).</p>
  </sec>
  <sec sec-type="supplementary-material" id="S1">
    <title>Supplementary Material</title>
    <supplementary-material id="d33e73" content-type="local-data">
      <caption>
        <title>Supplementary Information</title>
      </caption>
      <media xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="srep11565-s1.pdf"/>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <p>The Polish National Science Centre under the project DEC-2011/03/B/ST6/01588. The infrastructure supported by POIG.02.03.01-24-099/13 grant: ‘GeCONiI—Upper Silesian Center for Computational Science and Engineering’.</p>
  </ack>
  <ref-list>
    <ref id="b1">
      <mixed-citation publication-type="other">Illumina Inc. TruGenome Clinical Sequencing Services. (2015) Available at: <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" ext-link-type="uri" xlink:href="http://www.illumina.com/clinical/illumina_clinical_laboratory/trugenome-clinical-sequencing-services.html">http://www.illumina.com/clinical/illumina_clinical_laboratory/trugenome-clinical-sequencing-services.html</ext-link> (Accessed: 17th February 2015)</mixed-citation>
    </ref>
    <ref id="b2">
      <mixed-citation publication-type="journal">The 1000 Genome Project Consortium. <article-title>An integrated map of genetic variation from 1092 human genomes</article-title>. <source>Nature</source>. <volume>491</volume>, <fpage>56</fpage>–<lpage>65</lpage> (<year>2012</year>).<pub-id pub-id-type="pmid">23128226</pub-id></mixed-citation>
    </ref>
    <ref id="b3">
      <mixed-citation publication-type="other">The UK10K Consortium. Rare Genetic Variants in Health and Disease. (2013) Available at: <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" ext-link-type="uri" xlink:href="http://www.uk10k.org/">http://www.uk10k.org/</ext-link> (Accessed: 16th February 2015)</mixed-citation>
    </ref>
    <ref id="b4">
      <mixed-citation publication-type="journal"><name><surname>Ball</surname><given-names>M. P.</given-names></name><italic>et al.</italic><article-title>A public resource facilitating clinical use of genomes</article-title>. <source>PNAS</source>. <volume>109</volume>(30), <fpage>11920</fpage>–<lpage>11927</lpage> (<year>2012</year>).<pub-id pub-id-type="pmid">22797899</pub-id></mixed-citation>
    </ref>
    <ref id="b5">
      <mixed-citation publication-type="other">U.S. Department of Veteran Affairs. The Million Veteran Program. (2013) Available at: <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" ext-link-type="uri" xlink:href="http://www.research.va.gov/mvp/veterans.cfm">http://www.research.va.gov/mvp/veterans.cfm</ext-link> (Accessed: 16th February 2015)</mixed-citation>
    </ref>
    <ref id="b6">
      <mixed-citation publication-type="journal"><name><surname>Weigel</surname><given-names>D.</given-names></name> &amp; <name><surname>Mott</surname><given-names>R.</given-names></name>
<article-title>The 1001 Genomes Project for Arabidopsis thaliana</article-title>. <source>Genome Biology</source>. <volume>10</volume>, Article no. <fpage>107</fpage> (<year>2009</year>).<pub-id pub-id-type="pmid">19519932</pub-id></mixed-citation>
    </ref>
    <ref id="b7">
      <mixed-citation publication-type="other">Max Planck Institute for Developmental Biology. 1001 Genomes: A Catalog of Arabidopsis thaliana Genetic Variation (2012) Available at: <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" ext-link-type="uri" xlink:href="http://1001genomes.org/">http://1001genomes.org/</ext-link> (Accessed: 16th February 2015)</mixed-citation>
    </ref>
    <ref id="b8">
      <mixed-citation publication-type="journal"><name><surname>Kahn</surname><given-names>S. D.</given-names></name><article-title>On the future of genomic data</article-title>. <source>Science</source><volume>331</volume>, <fpage>728</fpage>–<lpage>729</lpage> (<year>2011</year>).<pub-id pub-id-type="pmid">21311016</pub-id></mixed-citation>
    </ref>
    <ref id="b9">
      <mixed-citation publication-type="journal"><name><surname>Deorowicz</surname><given-names>S.</given-names></name> &amp; <name><surname>Grabowski</surname><given-names>S.</given-names></name>
<article-title>Data compression for sequencing data</article-title>. <source>Algorithms for Molecular Biology</source>. <volume>8</volume>, Article no. <fpage>25</fpage> (<year>2013</year>).<pub-id pub-id-type="pmid">24252160</pub-id></mixed-citation>
    </ref>
    <ref id="b10">
      <mixed-citation publication-type="journal"><name><surname>Jones</surname><given-names>D. C.</given-names></name>, <name><surname>Ruzzo</surname><given-names>W. L.</given-names></name>, <name><surname>Peng</surname><given-names>X.</given-names></name> &amp; <name><surname>Katze</surname><given-names>M. G.</given-names></name>
<article-title>Compression of next-generation sequencing reads aided by highly efficient de novo assembly</article-title>. <source>Nucleic Acids Research</source>. <volume>40</volume>, <fpage>e171</fpage> (<year>2012</year>).<pub-id pub-id-type="pmid">22904078</pub-id></mixed-citation>
    </ref>
    <ref id="b11">
      <mixed-citation publication-type="journal"><name><surname>Bonfield</surname><given-names>J. K.</given-names></name> &amp; <name><surname>Mahoney</surname><given-names>M. V.</given-names></name>
<article-title>Compression of FASTQ and SAM format sequencing data</article-title>. <source>PloS ONE</source>. <volume>8</volume>, <fpage>e59190</fpage> (<year>2013</year>).<pub-id pub-id-type="pmid">23533605</pub-id></mixed-citation>
    </ref>
    <ref id="b12">
      <mixed-citation publication-type="journal"><name><surname>Roguski</surname><given-names>L.</given-names></name> &amp; <name><surname>Deorowicz</surname><given-names>S.</given-names></name>
<article-title>DSRC 2—Industry-oriented compression of FASTQ files</article-title>. <source>Bioinformatics</source>. <volume>30</volume>, <fpage>2213</fpage>–<lpage>2215</lpage> (<year>2014</year>).<pub-id pub-id-type="pmid">24747219</pub-id></mixed-citation>
    </ref>
    <ref id="b13">
      <mixed-citation publication-type="journal"><name><surname>Grabowski</surname><given-names>S. Deorowicz</given-names></name> &amp; <name><surname>Roguski</surname><given-names>R.</given-names></name>
<article-title>Disk-based compression of data from genome sequencing</article-title>. <source>Bioinformatics</source>. <volume>31</volume>, <fpage>1389</fpage>–<lpage>1395</lpage> (<year>2015</year>).<pub-id pub-id-type="pmid">25536966</pub-id></mixed-citation>
    </ref>
    <ref id="b14">
      <mixed-citation publication-type="journal"><name><surname>Hach</surname><given-names>F.</given-names></name>, <name><surname>Numanagic</surname><given-names>I.</given-names></name> &amp; <name><surname>Sahinalp</surname><given-names>S. C.</given-names></name>
<article-title>DeeZ: reference-based compression by local assembly</article-title>, <source>Nature Methods</source>. <volume>11</volume>, <fpage>1082</fpage>–<lpage>1084</lpage> (<year>2014</year>).<pub-id pub-id-type="pmid">25357237</pub-id></mixed-citation>
    </ref>
    <ref id="b15">
      <mixed-citation publication-type="journal"><name><surname>Fritz</surname><given-names>M. H.-Y.</given-names></name>, <name><surname>Leinonen</surname><given-names>R.</given-names></name>, <name><surname>Cochrane</surname><given-names>G.</given-names></name> &amp; <name><surname>Birney</surname><given-names>E.</given-names></name>
<article-title>Efficient storage of high throughput DNA sequencing data using reference-based compression</article-title>. <source>Genome Research</source>. <volume>21</volume>, <fpage>734</fpage>–<lpage>740</lpage> (<year>2011</year>).<pub-id pub-id-type="pmid">21245279</pub-id></mixed-citation>
    </ref>
    <ref id="b16">
      <mixed-citation publication-type="journal"><name><surname>Christley</surname><given-names>S.</given-names></name>, <name><surname>Lu</surname><given-names>Y.</given-names></name>, <name><surname>Li</surname><given-names>C.</given-names></name> &amp; <name><surname>Xie</surname><given-names>X.</given-names></name>
<article-title>Human genomes as email attachments</article-title>. <source>Bioinformatics</source>. <volume>25</volume>, <fpage>274</fpage>–<lpage>275</lpage> (<year>2009</year>).<pub-id pub-id-type="pmid">18996942</pub-id></mixed-citation>
    </ref>
    <ref id="b17">
      <mixed-citation publication-type="journal"><name><surname>Pavlichin</surname><given-names>D.</given-names></name>, <name><surname>Weissman</surname><given-names>T.</given-names></name> &amp; <name><surname>Yona</surname><given-names>G.</given-names></name>
<article-title>The human genome contracts again</article-title>. <source>Bioinformatics</source>. <volume>29</volume>, <fpage>2199</fpage>–<lpage>2202</lpage> (<year>2013</year>).<pub-id pub-id-type="pmid">23793748</pub-id></mixed-citation>
    </ref>
    <ref id="b18">
      <mixed-citation publication-type="journal"><name><surname>Deorowicz</surname><given-names>S.</given-names></name>, <name><surname>Danek</surname><given-names>A.</given-names></name> &amp; <name><surname>Grabowski</surname><given-names>S.</given-names></name>
<article-title>Genome compression: a novel approach for large collections</article-title>. <source>Bioinformatics</source>. <volume>29</volume>, <fpage>2572</fpage>–<lpage>2578</lpage> (<year>2013</year>).<pub-id pub-id-type="pmid">23969136</pub-id></mixed-citation>
    </ref>
    <ref id="b19">
      <mixed-citation publication-type="journal"><name><surname>Deorowicz</surname><given-names>S.</given-names></name> &amp; <name><surname>Grabowski</surname><given-names>S.</given-names></name>
<article-title>Robust relative compression of genomes with random access</article-title>. <source>Bioinformatics</source>. <volume>27</volume>, <fpage>2979</fpage>–<lpage>2986</lpage> (<year>2011</year>).<pub-id pub-id-type="pmid">21896510</pub-id></mixed-citation>
    </ref>
    <ref id="b20">
      <mixed-citation publication-type="journal"><name><surname>Wandelt</surname><given-names>S.</given-names></name> &amp; <name><surname>Leser</surname><given-names>U.</given-names></name>
<article-title>Adaptive efficient compression of genomes</article-title>. <source>Algorithms for Molecular Biology</source>. <volume>7</volume>, Article no. <fpage>30</fpage> (<year>2012</year>).<pub-id pub-id-type="pmid">23146997</pub-id></mixed-citation>
    </ref>
    <ref id="b21">
      <mixed-citation publication-type="journal"><name><surname>Wandelt</surname><given-names>S.</given-names></name> &amp; <name><surname>Leser</surname><given-names>U.</given-names></name>
<article-title>FRESCO: Referential Compression of Highly Similar Sequences</article-title>. <source>IEEE/ACM Transactions on Computational Biology and Bioinformatics</source>. <volume>10</volume>(5), <fpage>1275</fpage>–<lpage>1288</lpage> (<year>2013</year>).<pub-id pub-id-type="pmid">24524158</pub-id></mixed-citation>
    </ref>
    <ref id="b22">
      <mixed-citation publication-type="journal"><name><surname>Ochoa</surname><given-names>I.</given-names></name>, <name><surname>Hernaez</surname><given-names>M.</given-names></name> &amp; <name><surname>Weissman</surname><given-names>T.</given-names></name>
<article-title>iDoComp: a compression scheme for assembled genomes</article-title>. <source>Bioinformatics</source>. <pub-id pub-id-type="doi">10.1093/bioinformatics/btu698</pub-id> (<year>2014</year>).</mixed-citation>
    </ref>
    <ref id="b23">
      <mixed-citation publication-type="journal"><name><surname>Giancarlo</surname><given-names>R.</given-names></name>, <name><surname>Rombo</surname><given-names>S. E.</given-names></name> &amp; <name><surname>Utro</surname><given-names>F.</given-names></name>
<article-title>Compressive biological sequence analysis and archival in the era of high-throughput sequencing technologies</article-title>. <source>Briefings in Bioinformatics</source>. <volume>15</volume>, <fpage>390</fpage>–<lpage>406</lpage> (<year>2014</year>).<pub-id pub-id-type="pmid">24347576</pub-id></mixed-citation>
    </ref>
    <ref id="b24">
      <mixed-citation publication-type="journal"><name><surname>Zhu</surname><given-names>Z.</given-names></name>, <name><surname>Zhang</surname><given-names>Y.</given-names></name>, <name><surname>Ji</surname><given-names>Z.</given-names></name>, <name><surname>He</surname><given-names>S.</given-names></name>, <name><surname>Yang</surname><given-names>X.</given-names></name> &amp; <name><surname>High-throughput</surname><given-names>D. N. A.</given-names></name>
<article-title>sequence data</article-title>. <source>Briefings in Bioinformatics</source>. <volume>16</volume>, <fpage>1</fpage>–<lpage>15</lpage> (<year>2015</year>).<pub-id pub-id-type="pmid">24300111</pub-id></mixed-citation>
    </ref>
    <ref id="b25">
      <mixed-citation publication-type="journal"><name><surname>Levy</surname><given-names>S.</given-names></name><italic>et al.</italic><article-title>The diploid genome sequence of an individual human</article-title>. <source>PLoS Biology</source>. <volume>5</volume>, <fpage>e254</fpage> (<year>2007</year>).<pub-id pub-id-type="pmid">17803354</pub-id></mixed-citation>
    </ref>
    <ref id="b26">
      <mixed-citation publication-type="journal"><name><surname>Kuruppu</surname><given-names>S.</given-names></name>, <name><surname>Puglisi</surname><given-names>A. J.</given-names></name> &amp; <name><surname>Zobel</surname><given-names>J.</given-names></name>
<article-title>Optimized relative Lempel-Ziv compression of genomes</article-title>. In: <source>Proceedings of the ACSC Australasian Computer Science Conference</source> (ed. <name><surname>Reynolds</surname><given-names>M.</given-names></name> ). Australian Computer Society, Inc., Sydney, Australia, <fpage>91</fpage>–<lpage>98</lpage> (<year>2011</year>).</mixed-citation>
    </ref>
    <ref id="b27">
      <mixed-citation publication-type="journal"><name><surname>Pinho</surname><given-names>A. J.</given-names></name>, <name><surname>Pratas</surname><given-names>D.</given-names></name> &amp; <name><surname>Garcia</surname><given-names>S. P.</given-names></name>
<article-title>GReEn: a tool for efficient compression of genome resequencing data</article-title>. <source>Nucleic Acids Research</source>. <volume>40</volume>, <fpage>e27</fpage> (<year>2012</year>).<pub-id pub-id-type="pmid">22139935</pub-id></mixed-citation>
    </ref>
    <ref id="b28">
      <mixed-citation publication-type="journal"><name><surname>Ziv</surname><given-names>J.</given-names></name> &amp; <name><surname>Lempel</surname><given-names>A.</given-names></name>
<article-title>A universal algorithm for sequential data compression</article-title>. <source>IEEE Transactions of Information Theory</source>. <volume>23</volume>, <fpage>337</fpage>–<lpage>343</lpage> (<year>1977</year>).</mixed-citation>
    </ref>
    <ref id="b29">
      <mixed-citation publication-type="journal"><name><surname>Danecek</surname><given-names>P.</given-names></name><italic>et al.</italic><article-title>The variant call format and VCFtools</article-title>. <source>Bioinformatics</source>. <volume>27</volume>, <fpage>2156</fpage>–<lpage>2158</lpage> (<year>2011</year>).<pub-id pub-id-type="pmid">21653522</pub-id></mixed-citation>
    </ref>
    <ref id="b30">
      <mixed-citation publication-type="journal"><name><surname>Knuth</surname><given-names>D. E.</given-names></name><article-title>The art of computer programming</article-title>: <volume>Volume 3</volume>: <source>Sorting and Searching</source>. 2nd Edition. Addison-Wesley Professional, Boston (<year>1998</year>).</mixed-citation>
    </ref>
    <ref id="b31">
      <mixed-citation publication-type="journal"><name><surname>Salomon</surname><given-names>D.</given-names></name> &amp; <name><surname>Motta</surname><given-names>G.</given-names></name>
<source>Handbook of data compression</source>. Springer, London (<year>2010</year>).</mixed-citation>
    </ref>
    <ref id="b32">
      <mixed-citation publication-type="journal"><name><surname>Storer</surname><given-names>J. A.</given-names></name> &amp; <name><surname>Szymanski</surname><given-names>T. G.</given-names></name>
<article-title>Data compression via text substitution</article-title>. <source>Journal of the ACM</source>. <volume>29</volume>, <fpage>928</fpage>–<lpage>951</lpage> (<year>1982</year>).</mixed-citation>
    </ref>
  </ref-list>
  <fn-group>
    <fn>
      <p><bold>Author Contributions</bold> S.D. and A.D. designed the algorithm. S.D., A.D. and M.N. prepared the implementation. S.D. and A.D. performed the experiments. S.D. and A.D. drafted the manuscript and the <xref ref-type="supplementary-material" rid="S1">supplementary material</xref>. All authors read and approved the final manuscript.</p>
    </fn>
  </fn-group>
</back>
<floats-group>
  <fig id="f1">
    <label>Figure 1</label>
    <caption>
      <title>Example of first- and second-level factoring in GDC 2 algorithm, where: <italic>h</italic><sub>1<italic>m</italic></sub> = 3, <italic>h</italic><sub>1<italic>e</italic></sub> = 2, <italic>h</italic><sub>2</sub> = 3, weight of a literal tuple is 1 and weight of a match tuple is 2.</title>
      <p>Blue and green colors are used only to distinguish between adjacent first-level matches. The red underline is to point the second-level matches. The used abbreviations: L1L — <italic>f</italic><sub>literal</sub>, L1M — <italic>f</italic><sub>match_1st_lev</sub>, L2M — <italic>f</italic><sub>match_2nd_lev</sub>.</p>
    </caption>
    <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="srep11565-f1"/>
  </fig>
  <fig id="f2">
    <label>Figure 2</label>
    <caption>
      <title>Influence of the number of sequences in the input collection on GDC 2: compression ratio (left top), memory usage (right top), compression speed (left bottom), decompression speed (right bottom).</title>
      <p>The decompression speed was measured when the output was redirected to /dev/null, i.e., the sequences were decompressed but not stored.</p>
    </caption>
    <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="srep11565-f2"/>
  </fig>
  <fig id="f3">
    <label>Figure 3</label>
    <caption>
      <title>Influence of the percent of 2nd level references on GDC 2 compression ratio (left), decompression (access) time of a single sequence (right).</title>
      <p>In both cases the input dataset contained all available sequences.</p>
    </caption>
    <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="srep11565-f3"/>
  </fig>
  <fig id="f4">
    <label>Figure 4</label>
    <caption>
      <title>Influence of the number of threads used by GDC 2 algorithm on compression and decompression speeds.</title>
    </caption>
    <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="srep11565-f4"/>
  </fig>
  <table-wrap position="float" id="t1">
    <label>Table 1</label>
    <caption>
      <title>Compression ratios for subsets of the datasets for various compressors.</title>
    </caption>
    <table frame="hsides" rules="groups" border="1">
      <colgroup>
        <col align="center"/>
        <col align="center"/>
        <col align="center"/>
        <col align="center"/>
        <col align="center"/>
        <col align="center"/>
        <col align="center"/>
        <col align="center"/>
        <col align="center"/>
      </colgroup>
      <thead valign="bottom">
        <tr>
          <th align="center" valign="top" charoff="50">
            <bold>Dataset</bold>
          </th>
          <th align="center" valign="top" charoff="50">
            <bold>7z</bold>
          </th>
          <th align="center" valign="top" charoff="50">
            <bold>RLZ</bold>
          </th>
          <th align="center" valign="top" charoff="50">
            <bold>GReEn</bold>
          </th>
          <th align="center" valign="top" charoff="50">
            <bold>ABRC</bold>
          </th>
          <th align="center" valign="top" charoff="50">
            <bold>GDC-normal</bold>
          </th>
          <th align="center" valign="top" charoff="50">
            <bold>iDoComp</bold>
          </th>
          <th align="center" valign="top" charoff="50">
            <bold>GDC-ultra</bold>
          </th>
          <th align="center" valign="top" charoff="50">
            <bold>FRESCO</bold>
          </th>
        </tr>
      </thead>
      <tbody valign="top">
        <tr>
          <td colspan="9" align="center" valign="top" charoff="50">
            <italic>
              <bold>H.sapiens</bold>
            </italic>
          </td>
        </tr>
        <tr>
          <td align="center" valign="top" charoff="50">Chr. 14</td>
          <td align="center" valign="top" charoff="50">1,068</td>
          <td align="center" valign="top" charoff="50">270</td>
          <td align="center" valign="top" charoff="50">218</td>
          <td align="center" valign="top" charoff="50">472</td>
          <td align="center" valign="top" charoff="50">674</td>
          <td align="center" valign="top" charoff="50">625</td>
          <td align="center" valign="top" charoff="50">2,455</td>
          <td align="center" valign="top" charoff="50">1,946</td>
        </tr>
        <tr>
          <td align="center" valign="top" charoff="50">Chr. 21</td>
          <td align="center" valign="top" charoff="50">1,561</td>
          <td align="center" valign="top" charoff="50">269</td>
          <td align="center" valign="top" charoff="50">211</td>
          <td align="center" valign="top" charoff="50">460</td>
          <td align="center" valign="top" charoff="50">685</td>
          <td align="center" valign="top" charoff="50">642</td>
          <td align="center" valign="top" charoff="50">2,397</td>
          <td align="center" valign="top" charoff="50">2,545</td>
        </tr>
        <tr>
          <td colspan="9" align="center" valign="top" charoff="50">
            <italic>
              <bold>A.thaliana</bold>
            </italic>
          </td>
        </tr>
        <tr>
          <td align="center" valign="top" charoff="50">Chr. 1</td>
          <td align="center" valign="top" charoff="50">242</td>
          <td align="center" valign="top" charoff="50">86</td>
          <td align="center" valign="top" charoff="50">64</td>
          <td align="center" valign="top" charoff="50">67</td>
          <td align="center" valign="top" charoff="50">154</td>
          <td align="center" valign="top" charoff="50">156</td>
          <td align="center" valign="top" charoff="50">254</td>
          <td align="center" valign="top" charoff="50">186</td>
        </tr>
        <tr>
          <td align="center" valign="top" charoff="50">Chr. 4</td>
          <td align="center" valign="top" charoff="50">234</td>
          <td align="center" valign="top" charoff="50">80</td>
          <td align="center" valign="top" charoff="50">59</td>
          <td align="center" valign="top" charoff="50">61</td>
          <td align="center" valign="top" charoff="50">141</td>
          <td align="center" valign="top" charoff="50">145</td>
          <td align="center" valign="top" charoff="50">230</td>
          <td align="center" valign="top" charoff="50">170</td>
        </tr>
      </tbody>
    </table>
  </table-wrap>
  <table-wrap position="float" id="t2">
    <label>Table 2</label>
    <caption>
      <title>Compression ratios for <italic>H.sapiens</italic> dataset.</title>
    </caption>
    <table frame="hsides" rules="groups" border="1">
      <colgroup>
        <col align="left"/>
        <col align="char" char="."/>
        <col align="center"/>
        <col align="center"/>
        <col align="center"/>
        <col align="center"/>
        <col align="center"/>
        <col align="center"/>
      </colgroup>
      <thead valign="bottom">
        <tr>
          <th rowspan="2" align="left" valign="top" charoff="50">
            <bold>Data</bold>
          </th>
          <th align="center" valign="top" char="." charoff="50">
            <bold>Raw size</bold>
          </th>
          <th align="center" valign="top" charoff="50">
            <bold>GDC normal</bold>
          </th>
          <th align="center" valign="top" charoff="50">
            <bold>iDoComp</bold>
          </th>
          <th align="center" valign="top" charoff="50">
            <bold>GDC ultra</bold>
          </th>
          <th align="center" valign="top" charoff="50">
            <bold>FRESCO</bold>
          </th>
          <th align="center" valign="top" charoff="50">
            <bold>GDC 2</bold>
          </th>
          <th align="center" valign="top" charoff="50">
            <bold>TGC</bold>
          </th>
        </tr>
        <tr>
          <th align="center" valign="top" char="." charoff="50">
            <bold>[GB]</bold>
          </th>
          <th align="center" valign="top" charoff="50">
            <bold>ratio</bold>
          </th>
          <th align="center" valign="top" charoff="50">
            <bold>ratio</bold>
          </th>
          <th align="center" valign="top" charoff="50">
            <bold>ratio</bold>
          </th>
          <th align="center" valign="top" charoff="50">
            <bold>ratio</bold>
          </th>
          <th align="center" valign="top" charoff="50">
            <bold>ratio</bold>
          </th>
          <th align="center" valign="top" charoff="50">
            <bold>ratio</bold>
          </th>
        </tr>
      </thead>
      <tbody valign="top">
        <tr>
          <td align="left" valign="top" charoff="50">Chr. 1</td>
          <td align="char" valign="top" char="." charoff="50">551.7</td>
          <td align="center" valign="top" charoff="50">680</td>
          <td align="center" valign="top" charoff="50">659</td>
          <td align="center" valign="top" charoff="50">2,508</td>
          <td align="center" valign="top" charoff="50">2,279</td>
          <td align="center" valign="top" charoff="50">
            <bold>10,556</bold>
          </td>
          <td align="center" valign="top" charoff="50">
            <italic>17,090</italic>
          </td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50">Chr. 2</td>
          <td align="char" valign="top" char="." charoff="50">538.5</td>
          <td align="center" valign="top" charoff="50">628</td>
          <td align="center" valign="top" charoff="50">608</td>
          <td align="center" valign="top" charoff="50">2,318</td>
          <td align="center" valign="top" charoff="50">2,113</td>
          <td align="center" valign="top" charoff="50">
            <bold>9,828</bold>
          </td>
          <td align="center" valign="top" charoff="50">
            <italic>15,744</italic>
          </td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50">Chr. 3</td>
          <td align="char" valign="top" char="." charoff="50">438.4</td>
          <td align="center" valign="top" charoff="50">602</td>
          <td align="center" valign="top" charoff="50">552</td>
          <td align="center" valign="top" charoff="50">2,263</td>
          <td align="center" valign="top" charoff="50">2,044</td>
          <td align="center" valign="top" charoff="50">
            <bold>9,564</bold>
          </td>
          <td align="center" valign="top" charoff="50">
            <italic>15,513</italic>
          </td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50">Chr. 4</td>
          <td align="char" valign="top" char="." charoff="50">422.8</td>
          <td align="center" valign="top" charoff="50">547</td>
          <td align="center" valign="top" charoff="50">503</td>
          <td align="center" valign="top" charoff="50">2,202</td>
          <td align="center" valign="top" charoff="50">1,911</td>
          <td align="center" valign="top" charoff="50">
            <bold>8,979</bold>
          </td>
          <td align="center" valign="top" charoff="50">
            <italic>14,800</italic>
          </td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50">Chr. 5</td>
          <td align="char" valign="top" char="." charoff="50">400.6</td>
          <td align="center" valign="top" charoff="50">624</td>
          <td align="center" valign="top" charoff="50">576</td>
          <td align="center" valign="top" charoff="50">2,260</td>
          <td align="center" valign="top" charoff="50">1,997</td>
          <td align="center" valign="top" charoff="50">
            <bold>9,578</bold>
          </td>
          <td align="center" valign="top" charoff="50">
            <italic>15,449</italic>
          </td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50">Chr. 6</td>
          <td align="char" valign="top" char="." charoff="50">378.7</td>
          <td align="center" valign="top" charoff="50">566</td>
          <td align="center" valign="top" charoff="50">522</td>
          <td align="center" valign="top" charoff="50">2,184</td>
          <td align="center" valign="top" charoff="50">1,950</td>
          <td align="center" valign="top" charoff="50">
            <bold>8,832</bold>
          </td>
          <td align="center" valign="top" charoff="50">
            <italic>14,628</italic>
          </td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50">Chr. 7</td>
          <td align="char" valign="top" char="." charoff="50">352.3</td>
          <td align="center" valign="top" charoff="50">592</td>
          <td align="center" valign="top" charoff="50">545</td>
          <td align="center" valign="top" charoff="50">2,138</td>
          <td align="center" valign="top" charoff="50">1,918</td>
          <td align="center" valign="top" charoff="50">
            <bold>8,752</bold>
          </td>
          <td align="center" valign="top" charoff="50">
            <italic>14,344</italic>
          </td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50">Chr. 8</td>
          <td align="char" valign="top" char="." charoff="50">323.9</td>
          <td align="center" valign="top" charoff="50">584</td>
          <td align="center" valign="top" charoff="50">543</td>
          <td align="center" valign="top" charoff="50">2,137</td>
          <td align="center" valign="top" charoff="50">1,916</td>
          <td align="center" valign="top" charoff="50">
            <bold>8,817</bold>
          </td>
          <td align="center" valign="top" charoff="50">
            <italic>14,558</italic>
          </td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50">Chr. 9</td>
          <td align="char" valign="top" char="." charoff="50">312.5</td>
          <td align="center" valign="top" charoff="50">718</td>
          <td align="center" valign="top" charoff="50">666</td>
          <td align="center" valign="top" charoff="50">2,450</td>
          <td align="center" valign="top" charoff="50">2,359</td>
          <td align="center" valign="top" charoff="50">
            <bold>10,400</bold>
          </td>
          <td align="center" valign="top" charoff="50">
            <italic>17,000</italic>
          </td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50">Chr. 10</td>
          <td align="char" valign="top" char="." charoff="50">300.1</td>
          <td align="center" valign="top" charoff="50">578</td>
          <td align="center" valign="top" charoff="50">564</td>
          <td align="center" valign="top" charoff="50">2,123</td>
          <td align="center" valign="top" charoff="50">1,973</td>
          <td align="center" valign="top" charoff="50">
            <bold>9,335</bold>
          </td>
          <td align="center" valign="top" charoff="50">
            <italic>14,736</italic>
          </td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50">Chr. 11</td>
          <td align="char" valign="top" char="." charoff="50">298.8</td>
          <td align="center" valign="top" charoff="50">560</td>
          <td align="center" valign="top" charoff="50">521</td>
          <td align="center" valign="top" charoff="50">2,171</td>
          <td align="center" valign="top" charoff="50">1,967</td>
          <td align="center" valign="top" charoff="50">
            <bold>9,043</bold>
          </td>
          <td align="center" valign="top" charoff="50">
            <italic>14,825</italic>
          </td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50">Chr. 12</td>
          <td align="char" valign="top" char="." charoff="50">296.2</td>
          <td align="center" valign="top" charoff="50">595</td>
          <td align="center" valign="top" charoff="50">547</td>
          <td align="center" valign="top" charoff="50">2,167</td>
          <td align="center" valign="top" charoff="50">1,958</td>
          <td align="center" valign="top" charoff="50">
            <bold>9,127</bold>
          </td>
          <td align="center" valign="top" charoff="50">
            <italic>14,897</italic>
          </td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50">Chr. 13</td>
          <td align="char" valign="top" char="." charoff="50">255.0</td>
          <td align="center" valign="top" charoff="50">611</td>
          <td align="center" valign="top" charoff="50">564</td>
          <td align="center" valign="top" charoff="50">2,452</td>
          <td align="center" valign="top" charoff="50">1,842</td>
          <td align="center" valign="top" charoff="50">
            <bold>10,669</bold>
          </td>
          <td align="center" valign="top" charoff="50">
            <italic>17,336</italic>
          </td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50">Chr. 14</td>
          <td align="char" valign="top" char="." charoff="50">237.6</td>
          <td align="center" valign="top" charoff="50">674</td>
          <td align="center" valign="top" charoff="50">625</td>
          <td align="center" valign="top" charoff="50">2,458</td>
          <td align="center" valign="top" charoff="50">1,946</td>
          <td align="center" valign="top" charoff="50">
            <bold>10,654</bold>
          </td>
          <td align="center" valign="top" charoff="50">
            <italic>17,371</italic>
          </td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50">Chr. 15</td>
          <td align="char" valign="top" char="." charoff="50">227.0</td>
          <td align="center" valign="top" charoff="50">716</td>
          <td align="center" valign="top" charoff="50">664</td>
          <td align="center" valign="top" charoff="50">2,458</td>
          <td align="center" valign="top" charoff="50">2,020</td>
          <td align="center" valign="top" charoff="50">
            <bold>10,815</bold>
          </td>
          <td align="center" valign="top" charoff="50">
            <italic>17,556</italic>
          </td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50">Chr. 16</td>
          <td align="char" valign="top" char="." charoff="50">200.1</td>
          <td align="center" valign="top" charoff="50">647</td>
          <td align="center" valign="top" charoff="50">604</td>
          <td align="center" valign="top" charoff="50">2,068</td>
          <td align="center" valign="top" charoff="50">2,076</td>
          <td align="center" valign="top" charoff="50">
            <bold>8,980</bold>
          </td>
          <td align="center" valign="top" charoff="50">
            <italic>14,374</italic>
          </td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50">Chr. 17</td>
          <td align="char" valign="top" char="." charoff="50">179.7</td>
          <td align="center" valign="top" charoff="50">646</td>
          <td align="center" valign="top" charoff="50">594</td>
          <td align="center" valign="top" charoff="50">2,059</td>
          <td align="center" valign="top" charoff="50">2,090</td>
          <td align="center" valign="top" charoff="50">
            <bold>8,651</bold>
          </td>
          <td align="center" valign="top" charoff="50">
            <italic>14,137</italic>
          </td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50">Chr. 18</td>
          <td align="char" valign="top" char="." charoff="50">172.9</td>
          <td align="center" valign="top" charoff="50">568</td>
          <td align="center" valign="top" charoff="50">525</td>
          <td align="center" valign="top" charoff="50">2,051</td>
          <td align="center" valign="top" charoff="50">2,066</td>
          <td align="center" valign="top" charoff="50">
            <bold>9,033</bold>
          </td>
          <td align="center" valign="top" charoff="50">
            <italic>14,368</italic>
          </td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50">Chr. 19</td>
          <td align="char" valign="top" char="." charoff="50">130.8</td>
          <td align="center" valign="top" charoff="50">569</td>
          <td align="center" valign="top" charoff="50">519</td>
          <td align="center" valign="top" charoff="50">1,773</td>
          <td align="center" valign="top" charoff="50">1,828</td>
          <td align="center" valign="top" charoff="50">
            <bold>7,137</bold>
          </td>
          <td align="center" valign="top" charoff="50">
            <italic>11,931</italic>
          </td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50">Chr. 20</td>
          <td align="char" valign="top" char="." charoff="50">139.5</td>
          <td align="center" valign="top" charoff="50">633</td>
          <td align="center" valign="top" charoff="50">619</td>
          <td align="center" valign="top" charoff="50">2,014</td>
          <td align="center" valign="top" charoff="50">2,240</td>
          <td align="center" valign="top" charoff="50">
            <bold>9,150</bold>
          </td>
          <td align="center" valign="top" charoff="50">
            <italic>14,419</italic>
          </td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50">Chr. 21</td>
          <td align="char" valign="top" char="." charoff="50">106.5</td>
          <td align="center" valign="top" charoff="50">686</td>
          <td align="center" valign="top" charoff="50">642</td>
          <td align="center" valign="top" charoff="50">2,405</td>
          <td align="center" valign="top" charoff="50">2,545</td>
          <td align="center" valign="top" charoff="50">
            <bold>10,414</bold>
          </td>
          <td align="center" valign="top" charoff="50">
            <italic>16,975</italic>
          </td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50">Chr. 22</td>
          <td align="char" valign="top" char="." charoff="50">113.5</td>
          <td align="center" valign="top" charoff="50">823</td>
          <td align="center" valign="top" charoff="50">772</td>
          <td align="center" valign="top" charoff="50">2,455</td>
          <td align="center" valign="top" charoff="50">2,718</td>
          <td align="center" valign="top" charoff="50">
            <bold>10,547</bold>
          </td>
          <td align="center" valign="top" charoff="50">
            <italic>17,537</italic>
          </td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50">Chr. X-fem</td>
          <td align="char" valign="top" char="." charoff="50">178.5</td>
          <td align="center" valign="top" charoff="50">911</td>
          <td align="center" valign="top" charoff="50">826</td>
          <td align="center" valign="top" charoff="50">2,551</td>
          <td align="center" valign="top" charoff="50">2,628</td>
          <td align="center" valign="top" charoff="50">
            <bold>11,060</bold>
          </td>
          <td align="center" valign="top" charoff="50">
            <italic>17,364</italic>
          </td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50">Chr. X-mal</td>
          <td align="char" valign="top" char="." charoff="50">81.0</td>
          <td align="center" valign="top" charoff="50">945</td>
          <td align="center" valign="top" charoff="50">896</td>
          <td align="center" valign="top" charoff="50">2,740</td>
          <td align="center" valign="top" charoff="50">2,469</td>
          <td align="center" valign="top" charoff="50">
            <bold>11,546</bold>
          </td>
          <td align="center" valign="top" charoff="50">
            <italic>15,255</italic>
          </td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50">Chr. Y-mal</td>
          <td align="char" valign="top" char="." charoff="50">30.0</td>
          <td align="center" valign="top" charoff="50">38,233</td>
          <td align="center" valign="top" charoff="50">59,062</td>
          <td align="center" valign="top" charoff="50">42,870</td>
          <td align="center" valign="top" charoff="50">39,228</td>
          <td align="center" valign="top" charoff="50">
            <bold>132,123</bold>
          </td>
          <td align="center" valign="top" charoff="50">
            <italic>188,704</italic>
          </td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50">Chr. X-mal1</td>
          <td align="char" valign="top" char="." charoff="50">2.8</td>
          <td align="center" valign="top" charoff="50">312</td>
          <td align="center" valign="top" charoff="50">310</td>
          <td align="center" valign="top" charoff="50">587</td>
          <td align="center" valign="top" charoff="50">713</td>
          <td align="center" valign="top" charoff="50">
            <bold>2,423</bold>
          </td>
          <td align="center" valign="top" charoff="50">
            <italic>3,967</italic>
          </td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50">Chr. X-mal2</td>
          <td align="char" valign="top" char="." charoff="50">0.35</td>
          <td align="center" valign="top" charoff="50">280</td>
          <td align="center" valign="top" charoff="50">456</td>
          <td align="center" valign="top" charoff="50">741</td>
          <td align="center" valign="top" charoff="50">943</td>
          <td align="center" valign="top" charoff="50">
            <bold>5,914</bold>
          </td>
          <td align="center" valign="top" charoff="50">
            <italic>9,199</italic>
          </td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50">Complete</td>
          <td align="char" valign="top" char="." charoff="50">6,669.8</td>
          <td align="center" valign="top" charoff="50">627</td>
          <td align="center" valign="top" charoff="50">586</td>
          <td align="center" valign="top" charoff="50">2,262</td>
          <td align="center" valign="top" charoff="50">2,065</td>
          <td align="center" valign="top" charoff="50">
            <bold>9,557</bold>
          </td>
          <td align="center" valign="top" charoff="50">
            <italic>15,490</italic>
          </td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50">Compression speed [MB/s]</td>
          <td align="char" valign="top" char="." charoff="50"> </td>
          <td align="center" valign="top" charoff="50">73</td>
          <td align="center" valign="top" charoff="50">51</td>
          <td align="center" valign="top" charoff="50">12</td>
          <td align="center" valign="top" charoff="50">111</td>
          <td align="center" valign="top" charoff="50">
            <bold>202</bold>
          </td>
          <td align="center" valign="top" charoff="50">—</td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50">Compression time [h:m]</td>
          <td align="char" valign="top" char="." charoff="50"> </td>
          <td align="center" valign="top" charoff="50">25:23</td>
          <td align="center" valign="top" charoff="50">36:32</td>
          <td align="center" valign="top" charoff="50">154:24</td>
          <td align="center" valign="top" charoff="50">16:38</td>
          <td align="center" valign="top" charoff="50">
            <bold>9:11</bold>
          </td>
          <td align="center" valign="top" charoff="50">—</td>
        </tr>
      </tbody>
    </table>
    <table-wrap-foot>
      <fn id="t2-fn1">
        <p>The ratios are calculated as raw size divided by compressed size rounded to the integer. Compression speeds (in MB/s) and times (in hours:minutes) are given in the bottom part of the table. Raw sizes are in GBs. The rightmost column contains the ratios for TGC program<xref ref-type="bibr" rid="b18">18</xref>. The values are in italic to stress that they cannot be directly compared with ratios for the remaining algorithms, since TGC assumes that the input data are in VCF format, which explicitly stores information of all differences between aligned genomes from the collection. Nevertheless, the TGC ratios show what is possible, when much more knowledge of the data is given.</p>
      </fn>
    </table-wrap-foot>
  </table-wrap>
  <table-wrap position="float" id="t3">
    <label>Table 3</label>
    <caption>
      <title>Compression ratios for <italic>A.thaliana dataset</italic>.</title>
    </caption>
    <table frame="hsides" rules="groups" border="1">
      <colgroup>
        <col align="left"/>
        <col align="char" char="."/>
        <col align="center"/>
        <col align="center"/>
        <col align="center"/>
        <col align="center"/>
        <col align="center"/>
        <col align="center"/>
      </colgroup>
      <thead valign="bottom">
        <tr>
          <th rowspan="2" align="left" valign="top" charoff="50">
            <bold>Data</bold>
          </th>
          <th align="center" valign="top" char="." charoff="50">
            <bold>Raw size</bold>
          </th>
          <th align="center" valign="top" charoff="50">
            <bold>GDC normal</bold>
          </th>
          <th align="center" valign="top" charoff="50">
            <bold>iDoComp</bold>
          </th>
          <th align="center" valign="top" charoff="50">
            <bold>GDC ultra</bold>
          </th>
          <th align="center" valign="top" charoff="50">
            <bold>FRESCO</bold>
          </th>
          <th align="center" valign="top" charoff="50">
            <bold>GDC 2</bold>
          </th>
          <th align="center" valign="top" charoff="50">
            <bold>TGC</bold>
          </th>
        </tr>
        <tr>
          <th align="center" valign="top" char="." charoff="50">
            <bold>[GB]</bold>
          </th>
          <th align="center" valign="top" charoff="50">
            <bold>ratio</bold>
          </th>
          <th align="center" valign="top" charoff="50">
            <bold>ratio</bold>
          </th>
          <th align="center" valign="top" charoff="50">
            <bold>ratio</bold>
          </th>
          <th align="center" valign="top" charoff="50">
            <bold>ratio</bold>
          </th>
          <th align="center" valign="top" charoff="50">
            <bold>ratio</bold>
          </th>
          <th align="center" valign="top" charoff="50">
            <bold>ratio</bold>
          </th>
        </tr>
      </thead>
      <tbody valign="top">
        <tr>
          <td align="left" valign="top" charoff="50">Chr. 1</td>
          <td align="char" valign="top" char="." charoff="50">23.9</td>
          <td align="center" valign="top" charoff="50">154</td>
          <td align="center" valign="top" charoff="50">156</td>
          <td align="center" valign="top" charoff="50">254</td>
          <td align="center" valign="top" charoff="50">186</td>
          <td align="center" valign="top" charoff="50">
            <bold>621</bold>
          </td>
          <td align="center" valign="top" charoff="50">
            <italic>916</italic>
          </td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50">Chr. 2</td>
          <td align="char" valign="top" char="." charoff="50">15.5</td>
          <td align="center" valign="top" charoff="50">143</td>
          <td align="center" valign="top" charoff="50">148</td>
          <td align="center" valign="top" charoff="50">239</td>
          <td align="center" valign="top" charoff="50">175</td>
          <td align="center" valign="top" charoff="50">
            <bold>559</bold>
          </td>
          <td align="center" valign="top" charoff="50">
            <italic>807</italic>
          </td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50">Chr. 3</td>
          <td align="char" valign="top" char="." charoff="50">18.4</td>
          <td align="center" valign="top" charoff="50">147</td>
          <td align="center" valign="top" charoff="50">152</td>
          <td align="center" valign="top" charoff="50">238</td>
          <td align="center" valign="top" charoff="50">169</td>
          <td align="center" valign="top" charoff="50">
            <bold>551</bold>
          </td>
          <td align="center" valign="top" charoff="50">
            <italic>804</italic>
          </td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50">Chr. 4</td>
          <td align="char" valign="top" char="." charoff="50">14.6</td>
          <td align="center" valign="top" charoff="50">141</td>
          <td align="center" valign="top" charoff="50">145</td>
          <td align="center" valign="top" charoff="50">230</td>
          <td align="center" valign="top" charoff="50">170</td>
          <td align="center" valign="top" charoff="50">
            <bold>553</bold>
          </td>
          <td align="center" valign="top" charoff="50">
            <italic>803</italic>
          </td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50">Chr. 5</td>
          <td align="char" valign="top" char="." charoff="50">21.2</td>
          <td align="center" valign="top" charoff="50">148</td>
          <td align="center" valign="top" charoff="50">151</td>
          <td align="center" valign="top" charoff="50">254</td>
          <td align="center" valign="top" charoff="50">187</td>
          <td align="center" valign="top" charoff="50">
            <bold>624</bold>
          </td>
          <td align="center" valign="top" charoff="50">
            <italic>916</italic>
          </td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50">Chr. C</td>
          <td align="char" valign="top" char="." charoff="50">0.12</td>
          <td align="center" valign="top" charoff="50">652</td>
          <td align="center" valign="top" charoff="50">1,830</td>
          <td align="center" valign="top" charoff="50">652</td>
          <td align="center" valign="top" charoff="50">1,750</td>
          <td align="center" valign="top" charoff="50">
            <bold>25,061</bold>
          </td>
          <td align="center" valign="top" charoff="50">
            <italic>8,983</italic>
          </td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50">Chr. M</td>
          <td align="char" valign="top" char="." charoff="50">0.29</td>
          <td align="center" valign="top" charoff="50">558</td>
          <td align="center" valign="top" charoff="50">807</td>
          <td align="center" valign="top" charoff="50">600</td>
          <td align="center" valign="top" charoff="50">374</td>
          <td align="center" valign="top" charoff="50">
            <bold>1,401</bold>
          </td>
          <td align="center" valign="top" charoff="50">
            <italic>1,592</italic>
          </td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50">Complete</td>
          <td align="char" valign="top" char="." charoff="50">94.0</td>
          <td align="center" valign="top" charoff="50">148</td>
          <td align="center" valign="top" charoff="50">151</td>
          <td align="center" valign="top" charoff="50">245</td>
          <td align="center" valign="top" charoff="50">179</td>
          <td align="center" valign="top" charoff="50">
            <bold>587</bold>
          </td>
          <td align="center" valign="top" charoff="50">
            <italic>857</italic>
          </td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50">Compression speed [MB/s]</td>
          <td align="char" valign="top" char="." charoff="50"> </td>
          <td align="center" valign="top" charoff="50">
            <bold>120</bold>
          </td>
          <td align="center" valign="top" charoff="50">47</td>
          <td align="center" valign="top" charoff="50">13</td>
          <td align="center" valign="top" charoff="50">7</td>
          <td align="center" valign="top" charoff="50">94</td>
          <td align="center" valign="top" charoff="50">—</td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50">Compression time [h:m]</td>
          <td align="char" valign="top" char="." charoff="50"> </td>
          <td align="center" valign="top" charoff="50">
            <bold>0:13</bold>
          </td>
          <td align="center" valign="top" charoff="50">0:33</td>
          <td align="center" valign="top" charoff="50">1:57</td>
          <td align="center" valign="top" charoff="50">3:31</td>
          <td align="center" valign="top" charoff="50">0:17</td>
          <td align="center" valign="top" charoff="50">—</td>
        </tr>
      </tbody>
    </table>
    <table-wrap-foot>
      <fn id="t3-fn1">
        <p>The ratios are calculated as raw size divided by compressed size rounded to the integer. Compression speeds (in MB/s) and times (in hours:minutes) are given in the bottom part of the table. Raw sizes are in GBs. Please confer <xref ref-type="table" rid="t2">Table 2</xref> caption for the discussion on TGC ratios.</p>
      </fn>
    </table-wrap-foot>
  </table-wrap>
  <table-wrap position="float" id="t4">
    <label>Table 4</label>
    <caption>
      <title>Compression ratios for <italic>H.sapiens alternate assemblies</italic> dataset.</title>
    </caption>
    <table frame="hsides" rules="groups" border="1">
      <colgroup>
        <col align="left"/>
        <col align="center"/>
        <col align="center"/>
        <col align="center"/>
        <col align="center"/>
        <col align="center"/>
        <col align="center"/>
      </colgroup>
      <thead valign="bottom">
        <tr>
          <th rowspan="2" align="left" valign="top" charoff="50">
            <bold>Data</bold>
          </th>
          <th align="center" valign="top" charoff="50">
            <bold>Raw size</bold>
          </th>
          <th align="center" valign="top" charoff="50">
            <bold>GDC normal</bold>
          </th>
          <th align="center" valign="top" charoff="50">
            <bold>iDoComp</bold>
          </th>
          <th align="center" valign="top" charoff="50">
            <bold>GDC ultra</bold>
          </th>
          <th align="center" valign="top" charoff="50">
            <bold>FRESCO</bold>
          </th>
          <th align="center" valign="top" charoff="50">
            <bold>GDC 2</bold>
          </th>
        </tr>
        <tr>
          <th align="center" valign="top" charoff="50">
            <bold>[MB]</bold>
          </th>
          <th align="center" valign="top" charoff="50">
            <bold>ratio</bold>
          </th>
          <th align="center" valign="top" charoff="50">
            <bold>ratio</bold>
          </th>
          <th align="center" valign="top" charoff="50">
            <bold>ratio</bold>
          </th>
          <th align="center" valign="top" charoff="50">
            <bold>ratio</bold>
          </th>
          <th align="center" valign="top" charoff="50">
            <bold>ratio</bold>
          </th>
        </tr>
      </thead>
      <tbody valign="top">
        <tr>
          <td align="left" valign="top" charoff="50">Chr. 1</td>
          <td align="center" valign="top" charoff="50">2,647</td>
          <td align="center" valign="top" charoff="50">146</td>
          <td align="center" valign="top" charoff="50">134</td>
          <td align="center" valign="top" charoff="50">
            <bold>170</bold>
          </td>
          <td align="center" valign="top" charoff="50">118</td>
          <td align="center" valign="top" charoff="50">159</td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50">Chr. 2</td>
          <td align="center" valign="top" charoff="50">2,700</td>
          <td align="center" valign="top" charoff="50">198</td>
          <td align="center" valign="top" charoff="50">180</td>
          <td align="center" valign="top" charoff="50">
            <bold>224</bold>
          </td>
          <td align="center" valign="top" charoff="50">150</td>
          <td align="center" valign="top" charoff="50">213</td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50">Chr. 3</td>
          <td align="center" valign="top" charoff="50">2,098</td>
          <td align="center" valign="top" charoff="50">174</td>
          <td align="center" valign="top" charoff="50">159</td>
          <td align="center" valign="top" charoff="50">
            <bold>192</bold>
          </td>
          <td align="center" valign="top" charoff="50">137</td>
          <td align="center" valign="top" charoff="50">179</td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50">Chr. 4</td>
          <td align="center" valign="top" charoff="50">2,125</td>
          <td align="center" valign="top" charoff="50">145</td>
          <td align="center" valign="top" charoff="50">129</td>
          <td align="center" valign="top" charoff="50">
            <bold>158</bold>
          </td>
          <td align="center" valign="top" charoff="50">113</td>
          <td align="center" valign="top" charoff="50">147</td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50">Chr. 5</td>
          <td align="center" valign="top" charoff="50">2,018</td>
          <td align="center" valign="top" charoff="50">170</td>
          <td align="center" valign="top" charoff="50">153</td>
          <td align="center" valign="top" charoff="50">
            <bold>196</bold>
          </td>
          <td align="center" valign="top" charoff="50">135</td>
          <td align="center" valign="top" charoff="50">184</td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50">Chr. 6</td>
          <td align="center" valign="top" charoff="50">1,907</td>
          <td align="center" valign="top" charoff="50">204</td>
          <td align="center" valign="top" charoff="50">184</td>
          <td align="center" valign="top" charoff="50">
            <bold>252</bold>
          </td>
          <td align="center" valign="top" charoff="50">149</td>
          <td align="center" valign="top" charoff="50">238</td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50">Chr. 7</td>
          <td align="center" valign="top" charoff="50">1,755</td>
          <td align="center" valign="top" charoff="50">214</td>
          <td align="center" valign="top" charoff="50">191</td>
          <td align="center" valign="top" charoff="50">
            <bold>282</bold>
          </td>
          <td align="center" valign="top" charoff="50">155</td>
          <td align="center" valign="top" charoff="50">267</td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50">Chr. 8</td>
          <td align="center" valign="top" charoff="50">1,622</td>
          <td align="center" valign="top" charoff="50">217</td>
          <td align="center" valign="top" charoff="50">194</td>
          <td align="center" valign="top" charoff="50">
            <bold>248</bold>
          </td>
          <td align="center" valign="top" charoff="50">156</td>
          <td align="center" valign="top" charoff="50">236</td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50">Chr. 9</td>
          <td align="center" valign="top" charoff="50">1,478</td>
          <td align="center" valign="top" charoff="50">280</td>
          <td align="center" valign="top" charoff="50">255</td>
          <td align="center" valign="top" charoff="50">
            <bold>363</bold>
          </td>
          <td align="center" valign="top" charoff="50">202</td>
          <td align="center" valign="top" charoff="50">344</td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50">Chr. 10</td>
          <td align="center" valign="top" charoff="50">1,496</td>
          <td align="center" valign="top" charoff="50">249</td>
          <td align="center" valign="top" charoff="50">225</td>
          <td align="center" valign="top" charoff="50">
            <bold>319</bold>
          </td>
          <td align="center" valign="top" charoff="50">182</td>
          <td align="center" valign="top" charoff="50">313</td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50">Chr. 11</td>
          <td align="center" valign="top" charoff="50">1,499</td>
          <td align="center" valign="top" charoff="50">185</td>
          <td align="center" valign="top" charoff="50">168</td>
          <td align="center" valign="top" charoff="50">
            <bold>214</bold>
          </td>
          <td align="center" valign="top" charoff="50">145</td>
          <td align="center" valign="top" charoff="50">205</td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50">Chr. 12</td>
          <td align="center" valign="top" charoff="50">1,486</td>
          <td align="center" valign="top" charoff="50">166</td>
          <td align="center" valign="top" charoff="50">150</td>
          <td align="center" valign="top" charoff="50">
            <bold>186</bold>
          </td>
          <td align="center" valign="top" charoff="50">130</td>
          <td align="center" valign="top" charoff="50">175</td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50">Chr. 13</td>
          <td align="center" valign="top" charoff="50">1,206</td>
          <td align="center" valign="top" charoff="50">185</td>
          <td align="center" valign="top" charoff="50">168</td>
          <td align="center" valign="top" charoff="50">
            <bold>219</bold>
          </td>
          <td align="center" valign="top" charoff="50">146</td>
          <td align="center" valign="top" charoff="50">208</td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50">Chr. 14</td>
          <td align="center" valign="top" charoff="50">1,115</td>
          <td align="center" valign="top" charoff="50">269</td>
          <td align="center" valign="top" charoff="50">243</td>
          <td align="center" valign="top" charoff="50">
            <bold>313</bold>
          </td>
          <td align="center" valign="top" charoff="50">202</td>
          <td align="center" valign="top" charoff="50">305</td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50">Chr. 15</td>
          <td align="center" valign="top" charoff="50">1,045</td>
          <td align="center" valign="top" charoff="50">180</td>
          <td align="center" valign="top" charoff="50">164</td>
          <td align="center" valign="top" charoff="50">
            <bold>218</bold>
          </td>
          <td align="center" valign="top" charoff="50">150</td>
          <td align="center" valign="top" charoff="50">200</td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50">Chr. 16</td>
          <td align="center" valign="top" charoff="50">954</td>
          <td align="center" valign="top" charoff="50">69</td>
          <td align="center" valign="top" charoff="50">72</td>
          <td align="center" valign="top" charoff="50">
            <bold>86</bold>
          </td>
          <td align="center" valign="top" charoff="50">68</td>
          <td align="center" valign="top" charoff="50">81</td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50">Chr. 17</td>
          <td align="center" valign="top" charoff="50">892</td>
          <td align="center" valign="top" charoff="50">128</td>
          <td align="center" valign="top" charoff="50">113</td>
          <td align="center" valign="top" charoff="50">
            <bold>153</bold>
          </td>
          <td align="center" valign="top" charoff="50">107</td>
          <td align="center" valign="top" charoff="50">139</td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50">Chr. 18</td>
          <td align="center" valign="top" charoff="50">859</td>
          <td align="center" valign="top" charoff="50">157</td>
          <td align="center" valign="top" charoff="50">146</td>
          <td align="center" valign="top" charoff="50">
            <bold>174</bold>
          </td>
          <td align="center" valign="top" charoff="50">141</td>
          <td align="center" valign="top" charoff="50">173</td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50">Chr. 19</td>
          <td align="center" valign="top" charoff="50">681</td>
          <td align="center" valign="top" charoff="50">175</td>
          <td align="center" valign="top" charoff="50">155</td>
          <td align="center" valign="top" charoff="50">
            <bold>202</bold>
          </td>
          <td align="center" valign="top" charoff="50">133</td>
          <td align="center" valign="top" charoff="50">188</td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50">Chr. 20</td>
          <td align="center" valign="top" charoff="50">695</td>
          <td align="center" valign="top" charoff="50">222</td>
          <td align="center" valign="top" charoff="50">200</td>
          <td align="center" valign="top" charoff="50">263</td>
          <td align="center" valign="top" charoff="50">181</td>
          <td align="center" valign="top" charoff="50">
            <bold>264</bold>
          </td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50">Chr. 21</td>
          <td align="center" valign="top" charoff="50">475</td>
          <td align="center" valign="top" charoff="50">219</td>
          <td align="center" valign="top" charoff="50">197</td>
          <td align="center" valign="top" charoff="50">
            <bold>258</bold>
          </td>
          <td align="center" valign="top" charoff="50">179</td>
          <td align="center" valign="top" charoff="50">248</td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50">Chr. 22</td>
          <td align="center" valign="top" charoff="50">497</td>
          <td align="center" valign="top" charoff="50">153</td>
          <td align="center" valign="top" charoff="50">137</td>
          <td align="center" valign="top" charoff="50">
            <bold>168</bold>
          </td>
          <td align="center" valign="top" charoff="50">132</td>
          <td align="center" valign="top" charoff="50">163</td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50">Chr. X</td>
          <td align="center" valign="top" charoff="50">1,690</td>
          <td align="center" valign="top" charoff="50">90</td>
          <td align="center" valign="top" charoff="50">83</td>
          <td align="center" valign="top" charoff="50">
            <bold>97</bold>
          </td>
          <td align="center" valign="top" charoff="50">83</td>
          <td align="center" valign="top" charoff="50">91</td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50">Chr. Y</td>
          <td align="center" valign="top" charoff="50">404</td>
          <td align="center" valign="top" charoff="50">269</td>
          <td align="center" valign="top" charoff="50">241</td>
          <td align="center" valign="top" charoff="50">
            <bold>302</bold>
          </td>
          <td align="center" valign="top" charoff="50">225</td>
          <td align="center" valign="top" charoff="50">275</td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50">Complete</td>
          <td align="center" valign="top" charoff="50">33,346</td>
          <td align="center" valign="top" charoff="50">169</td>
          <td align="center" valign="top" charoff="50">153</td>
          <td align="center" valign="top" charoff="50">
            <bold>194</bold>
          </td>
          <td align="center" valign="top" charoff="50">134</td>
          <td align="center" valign="top" charoff="50">183</td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50">Compression speed [MB/s]</td>
          <td align="center" valign="top" charoff="50"> </td>
          <td align="center" valign="top" charoff="50">1.5</td>
          <td align="center" valign="top" charoff="50">
            <bold>27.5</bold>
          </td>
          <td align="center" valign="top" charoff="50">0.3</td>
          <td align="center" valign="top" charoff="50">4.2</td>
          <td align="center" valign="top" charoff="50">11.0</td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50">Compression time [h:m]</td>
          <td align="center" valign="top" charoff="50"> </td>
          <td align="center" valign="top" charoff="50">6:02</td>
          <td align="center" valign="top" charoff="50">
            <bold>0:20</bold>
          </td>
          <td align="center" valign="top" charoff="50">26:36</td>
          <td align="center" valign="top" charoff="50">2:11</td>
          <td align="center" valign="top" charoff="50">0:50</td>
        </tr>
      </tbody>
    </table>
    <table-wrap-foot>
      <fn id="t4-fn1">
        <p>The ratios are calculated as raw size divided by compressed size rounded to the integer. Compression speeds (in MB/s) and times (in hours:minutes) are given in the bottom part of the table. Raw sizes are in MBs.</p>
      </fn>
    </table-wrap-foot>
  </table-wrap>
</floats-group>
