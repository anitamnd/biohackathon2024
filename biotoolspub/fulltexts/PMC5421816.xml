<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d3 20150301//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 39.96?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
    <journal-id journal-id-type="iso-abbrev">PLoS Comput. Biol</journal-id>
    <journal-id journal-id-type="publisher-id">plos</journal-id>
    <journal-id journal-id-type="pmc">ploscomp</journal-id>
    <journal-title-group>
      <journal-title>PLoS Computational Biology</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1553-734X</issn>
    <issn pub-type="epub">1553-7358</issn>
    <publisher>
      <publisher-name>Public Library of Science</publisher-name>
      <publisher-loc>San Francisco, CA USA</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">5421816</article-id>
    <article-id pub-id-type="pmid">28437450</article-id>
    <article-id pub-id-type="publisher-id">PCOMPBIOL-D-16-01728</article-id>
    <article-id pub-id-type="doi">10.1371/journal.pcbi.1005518</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research Article</subject>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Physical Sciences</subject>
        <subj-group>
          <subject>Mathematics</subject>
          <subj-group>
            <subject>Applied Mathematics</subject>
            <subj-group>
              <subject>Algorithms</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and Analysis Methods</subject>
        <subj-group>
          <subject>Simulation and Modeling</subject>
          <subj-group>
            <subject>Algorithms</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and Analysis Methods</subject>
        <subj-group>
          <subject>Database and Informatics Methods</subject>
          <subj-group>
            <subject>Bioinformatics</subject>
            <subj-group>
              <subject>Sequence Analysis</subject>
              <subj-group>
                <subject>Sequence Alignment</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and Analysis Methods</subject>
        <subj-group>
          <subject>Database and Informatics Methods</subject>
          <subj-group>
            <subject>Bioinformatics</subject>
            <subj-group>
              <subject>Sequence Analysis</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and Analysis Methods</subject>
        <subj-group>
          <subject>Database and Informatics Methods</subject>
          <subj-group>
            <subject>Biological Databases</subject>
            <subj-group>
              <subject>Sequence Databases</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and Analysis Methods</subject>
        <subj-group>
          <subject>Database and Informatics Methods</subject>
          <subj-group>
            <subject>Bioinformatics</subject>
            <subj-group>
              <subject>Sequence Analysis</subject>
              <subj-group>
                <subject>Sequence Databases</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Evolutionary Biology</subject>
          <subj-group>
            <subject>Evolutionary Systematics</subject>
            <subj-group>
              <subject>Phylogenetics</subject>
              <subj-group>
                <subject>Phylogenetic Analysis</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Taxonomy</subject>
          <subj-group>
            <subject>Evolutionary Systematics</subject>
            <subj-group>
              <subject>Phylogenetics</subject>
              <subj-group>
                <subject>Phylogenetic Analysis</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Computer and Information Sciences</subject>
        <subj-group>
          <subject>Data Management</subject>
          <subj-group>
            <subject>Taxonomy</subject>
            <subj-group>
              <subject>Evolutionary Systematics</subject>
              <subj-group>
                <subject>Phylogenetics</subject>
                <subj-group>
                  <subject>Phylogenetic Analysis</subject>
                </subj-group>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and life sciences</subject>
        <subj-group>
          <subject>Biochemistry</subject>
          <subj-group>
            <subject>Nucleic acids</subject>
            <subj-group>
              <subject>RNA</subject>
              <subj-group>
                <subject>Non-coding RNA</subject>
                <subj-group>
                  <subject>Ribosomal RNA</subject>
                </subj-group>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and life sciences</subject>
        <subj-group>
          <subject>Biochemistry</subject>
          <subj-group>
            <subject>Ribosomes</subject>
            <subj-group>
              <subject>Ribosomal RNA</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and life sciences</subject>
        <subj-group>
          <subject>Cell biology</subject>
          <subj-group>
            <subject>Cellular structures and organelles</subject>
            <subj-group>
              <subject>Ribosomes</subject>
              <subj-group>
                <subject>Ribosomal RNA</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Taxonomy</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Computer and Information Sciences</subject>
        <subj-group>
          <subject>Data Management</subject>
          <subj-group>
            <subject>Taxonomy</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Microbiology</subject>
          <subj-group>
            <subject>Medical Microbiology</subject>
            <subj-group>
              <subject>Microbiome</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Genetics</subject>
          <subj-group>
            <subject>Genomics</subject>
            <subj-group>
              <subject>Microbial Genomics</subject>
              <subj-group>
                <subject>Microbiome</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Microbiology</subject>
          <subj-group>
            <subject>Microbial Genomics</subject>
            <subj-group>
              <subject>Microbiome</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>ESPRIT-Forest: Parallel clustering of massive amplicon sequence data in subquadratic time</article-title>
      <alt-title alt-title-type="running-head">Subquadratic-time parallel sequence clustering</alt-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0001-8797-4243</contrib-id>
        <name>
          <surname>Cai</surname>
          <given-names>Yunpeng</given-names>
        </name>
        <xref ref-type="aff" rid="aff001">
          <sup>1</sup>
        </xref>
        <xref ref-type="corresp" rid="cor001">*</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Zheng</surname>
          <given-names>Wei</given-names>
        </name>
        <xref ref-type="aff" rid="aff002">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Yao</surname>
          <given-names>Jin</given-names>
        </name>
        <xref ref-type="aff" rid="aff003">
          <sup>3</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Yang</surname>
          <given-names>Yujie</given-names>
        </name>
        <xref ref-type="aff" rid="aff001">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Mai</surname>
          <given-names>Volker</given-names>
        </name>
        <xref ref-type="aff" rid="aff004">
          <sup>4</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Mao</surname>
          <given-names>Qi</given-names>
        </name>
        <xref ref-type="aff" rid="aff003">
          <sup>3</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Sun</surname>
          <given-names>Yijun</given-names>
        </name>
        <xref ref-type="aff" rid="aff002">
          <sup>2</sup>
        </xref>
        <xref ref-type="aff" rid="aff003">
          <sup>3</sup>
        </xref>
        <xref ref-type="aff" rid="aff005">
          <sup>5</sup>
        </xref>
        <xref ref-type="corresp" rid="cor001">*</xref>
      </contrib>
    </contrib-group>
    <aff id="aff001">
      <label>1</label>
      <addr-line>Shenzhen Institutes of Advanced Technology, Chinese Academy of Sciences, Shenzhen, China</addr-line>
    </aff>
    <aff id="aff002">
      <label>2</label>
      <addr-line>Department of Computer Science and Engineering, The State University of New York at Buffalo, Buffalo, New York, United States of America</addr-line>
    </aff>
    <aff id="aff003">
      <label>3</label>
      <addr-line>Department of Microbiology and Immunology, The State University of New York at Buffalo, Buffalo, New York, United States of America</addr-line>
    </aff>
    <aff id="aff004">
      <label>4</label>
      <addr-line>Department of Epidemiology, University of Florida, Gainesville, Florida, United States of America</addr-line>
    </aff>
    <aff id="aff005">
      <label>5</label>
      <addr-line>Department of Biostatistics, The State University of New York at Buffalo, Buffalo, New York, United States of America</addr-line>
    </aff>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Gardner</surname>
          <given-names>Paul P</given-names>
        </name>
        <role>Editor</role>
        <xref ref-type="aff" rid="edit1"/>
      </contrib>
    </contrib-group>
    <aff id="edit1">
      <addr-line>University of Canterbury, NEW ZEALAND</addr-line>
    </aff>
    <author-notes>
      <fn fn-type="COI-statement" id="coi001">
        <p>The authors have declared that no competing interests exist.</p>
      </fn>
      <fn fn-type="con">
        <p>
          <list list-type="simple">
            <list-item>
              <p><bold>Conceptualization:</bold> YC YS.</p>
            </list-item>
            <list-item>
              <p><bold>Data curation:</bold> YC YS VM JY WZ QM.</p>
            </list-item>
            <list-item>
              <p><bold>Formal analysis:</bold> YC YS YY.</p>
            </list-item>
            <list-item>
              <p><bold>Funding acquisition:</bold> YC YS.</p>
            </list-item>
            <list-item>
              <p><bold>Investigation:</bold> YC YS VM JY WZ.</p>
            </list-item>
            <list-item>
              <p><bold>Methodology:</bold> YC YS JY.</p>
            </list-item>
            <list-item>
              <p><bold>Project administration:</bold> YC YS.</p>
            </list-item>
            <list-item>
              <p><bold>Resources:</bold> YC YS VM JY WZ QM.</p>
            </list-item>
            <list-item>
              <p><bold>Software:</bold> YC YS JY WZ QM.</p>
            </list-item>
            <list-item>
              <p><bold>Supervision:</bold> YC YS.</p>
            </list-item>
            <list-item>
              <p><bold>Validation:</bold> YC YS JY WZ QM.</p>
            </list-item>
            <list-item>
              <p><bold>Visualization:</bold> YC YS.</p>
            </list-item>
            <list-item>
              <p><bold>Writing – original draft:</bold> YC YS VM JY WZ QM JY.</p>
            </list-item>
            <list-item>
              <p><bold>Writing – review &amp; editing:</bold> YC YS VM JY WZ QM JY.</p>
            </list-item>
          </list>
        </p>
      </fn>
      <corresp id="cor001">* E-mail: <email>yp.cai@siat.ac.cn</email> (YC); <email>yijunsun@buffalo.edu</email> (YS)</corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <month>4</month>
      <year>2017</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>24</day>
      <month>4</month>
      <year>2017</year>
    </pub-date>
    <volume>13</volume>
    <issue>4</issue>
    <elocation-id>e1005518</elocation-id>
    <history>
      <date date-type="received">
        <day>23</day>
        <month>10</month>
        <year>2016</year>
      </date>
      <date date-type="accepted">
        <day>13</day>
        <month>4</month>
        <year>2017</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© 2017 Cai et al</copyright-statement>
      <copyright-year>2017</copyright-year>
      <copyright-holder>Cai et al</copyright-holder>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <self-uri content-type="pdf" xlink:href="pcbi.1005518.pdf"/>
    <abstract>
      <p>The rapid development of sequencing technology has led to an explosive accumulation of genomic sequence data. Clustering is often the first step to perform in sequence analysis, and hierarchical clustering is one of the most commonly used approaches for this purpose. However, it is currently computationally expensive to perform hierarchical clustering of extremely large sequence datasets due to its quadratic time and space complexities. In this paper we developed a new algorithm called ESPRIT-Forest for parallel hierarchical clustering of sequences. The algorithm achieves subquadratic time and space complexity and maintains a high clustering accuracy comparable to the standard method. The basic idea is to organize sequences into a pseudo-metric based partitioning tree for sub-linear time searching of nearest neighbors, and then use a new multiple-pair merging criterion to construct clusters in parallel using multiple threads. The new algorithm was tested on the human microbiome project (HMP) dataset, currently one of the largest published microbial 16S rRNA sequence dataset. Our experiment demonstrated that with the power of parallel computing it is now compu- tationally feasible to perform hierarchical clustering analysis of tens of millions of sequences. The software is available at <ext-link ext-link-type="uri" xlink:href="http://www.acsu.buffalo.edu/~yijunsun/lab/ESPRIT-Forest.html">http://www.acsu.buffalo.edu/∼yijunsun/lab/ESPRIT-Forest.html</ext-link>.</p>
    </abstract>
    <funding-group>
      <award-group id="award001">
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/100000001</institution-id>
            <institution>National Science Foundation</institution>
          </institution-wrap>
        </funding-source>
        <award-id>DBI1322212</award-id>
        <principal-award-recipient>
          <name>
            <surname>Sun</surname>
            <given-names>Yijun</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group id="award002">
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/100000009</institution-id>
            <institution>Foundation for the National Institutes of Health</institution>
          </institution-wrap>
        </funding-source>
        <award-id>1R01DE024523</award-id>
        <principal-award-recipient>
          <name>
            <surname>Sun</surname>
            <given-names>Yijun</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group id="award003">
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/501100001809</institution-id>
            <institution>National Natural Science Foundation of China</institution>
          </institution-wrap>
        </funding-source>
        <award-id>11471313</award-id>
        <principal-award-recipient>
          <contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0001-8797-4243</contrib-id>
          <name>
            <surname>Cai</surname>
            <given-names>Yunpeng</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group id="award004">
        <funding-source>
          <institution>National High Technology Research and Development Program</institution>
        </funding-source>
        <award-id>SS2015AA020109</award-id>
        <principal-award-recipient>
          <contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0001-8797-4243</contrib-id>
          <name>
            <surname>Cai</surname>
            <given-names>Yunpeng</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <funding-statement>This work was supported in part by funds from National Science Foundation grant DBI1322212 (<ext-link ext-link-type="uri" xlink:href="https://www.nsf.gov/">https://www.nsf.gov/</ext-link>), National Institutes of Health grant 1R01DE024523 (<ext-link ext-link-type="uri" xlink:href="https://www.nih.gov/">https://www.nih.gov/</ext-link>), National Science Foundation of China grant 11471313 (<ext-link ext-link-type="uri" xlink:href="http://www.nsfc.gov.cn/publish/portal1/">http://www.nsfc.gov.cn/publish/portal1/</ext-link>) and the National High Technology Research and Development Program (863 Program) SS2015AA020109 (<ext-link ext-link-type="uri" xlink:href="http://www.most.gov.cn/eng/programmes1/">http://www.most.gov.cn/eng/programmes1/</ext-link>). The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
    </funding-group>
    <counts>
      <fig-count count="5"/>
      <table-count count="3"/>
      <page-count count="16"/>
    </counts>
    <custom-meta-group>
      <custom-meta>
        <meta-name>PLOS Publication Stage</meta-name>
        <meta-value>vor-update-to-uncorrected-proof</meta-value>
      </custom-meta>
      <custom-meta>
        <meta-name>Publication Update</meta-name>
        <meta-value>2017-05-08</meta-value>
      </custom-meta>
      <custom-meta id="data-availability">
        <meta-name>Data Availability</meta-name>
        <meta-value>All data used in the paper are published third-party data whose availabilities are already described in the paper. The Human Gut Microbiome V2 and V6 datasets (Ref. [36]) are available from the NCBI SRA Project with Accession Number: PRJNA32089. The ELDERMET dataset (Ref. [40]) is available on the NCBI SRA Project with Accession Number: SRP003158. The Human Microbiome Project(HMP) Data (Ref. [41]) is available on the project official site: <ext-link ext-link-type="uri" xlink:href="http://www.hmpdacc.org">http://www.hmpdacc.org</ext-link>.</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
  <notes>
    <title>Data Availability</title>
    <p>All data used in the paper are published third-party data whose availabilities are already described in the paper. The Human Gut Microbiome V2 and V6 datasets (Ref. [36]) are available from the NCBI SRA Project with Accession Number: PRJNA32089. The ELDERMET dataset (Ref. [40]) is available on the NCBI SRA Project with Accession Number: SRP003158. The Human Microbiome Project(HMP) Data (Ref. [41]) is available on the project official site: <ext-link ext-link-type="uri" xlink:href="http://www.hmpdacc.org">http://www.hmpdacc.org</ext-link>.</p>
  </notes>
</front>
<body>
  <disp-quote>
    <p>This is a PLoS Computational Biology software paper.</p>
  </disp-quote>
  <sec sec-type="intro" id="sec001">
    <title>Introduction</title>
    <p>Genome sequencing is a common tool in biological and biomedical research. In the past few years, the data generation capacity of high-throughput sequencing technology has increased dramatically at a speed exceeding Moore’s law [<xref rid="pcbi.1005518.ref001" ref-type="bibr">1</xref>] and with sharply reduced cost. For example, the latest Illumina HiSeq 2500 platform can produce 600 million sequences of 300bp in length (2×150bp, 180GB data in total) in 40 hours. The rapid accumulation of genomic information represents a valuable source to significantly expand biological knowledge but meanwhile poses a serious challenge for data analysis, demanding new computational algorithms for efficient data processing.</p>
    <p>Shotgun and amplicon sequencing are currently two major sequencing approaches. Amplicon sequencing, which sequences a specific genome region identified by primers, is a powerful tool for in-depth analysis of phylogenetic and evolutionary details, especially for ecology studies of viruses [<xref rid="pcbi.1005518.ref002" ref-type="bibr">2</xref>] and microbial communities including bacteria [<xref rid="pcbi.1005518.ref003" ref-type="bibr">3</xref>], fungi [<xref rid="pcbi.1005518.ref004" ref-type="bibr">4</xref>] and planktons [<xref rid="pcbi.1005518.ref005" ref-type="bibr">5</xref>], and the analysis of germline and somatic mutations of human (e.g., cancer cells [<xref rid="pcbi.1005518.ref006" ref-type="bibr">6</xref>] or immune cells [<xref rid="pcbi.1005518.ref007" ref-type="bibr">7</xref>]). For example, metagenomics of human gut microbiota, where amplicon sequencing of 16S rRNA gene serves as a major probing tool, has become an exploding research area listed as one of the top ten breakthroughs in 2013 by the Science magazine [<xref rid="pcbi.1005518.ref008" ref-type="bibr">8</xref>].</p>
    <p>Usually, the first major step in processing amplicon sequencing data after quality control is to bin sequences into taxonomic or genotypic units, which forms the basis for performing ecological statistics and comparative studies [<xref rid="pcbi.1005518.ref009" ref-type="bibr">9</xref>]. Existing methods can be generally classified into taxonomy-dependent approaches, where sequences are anno- tated against a reference taxonomy database, and taxonomy-independent approaches [<xref rid="pcbi.1005518.ref010" ref-type="bibr">10</xref>], where sequences are clustered into operational taxonomy units (OTUs) based on pairwise similarities without using external references (thus also called <italic>de novo</italic> binning [<xref rid="pcbi.1005518.ref009" ref-type="bibr">9</xref>]). Since the main goal of amplicon sequencing is usually to explore uncharted biospheres where a significant portion of genetic material is contributed by previously unknown taxa, taxonomy-independent analysis is often the preferred, if not the only, choice.</p>
    <p>A dozen of methods have been proposed for the <italic>de novo</italic> binning of amplicon sequences. Yet, the computational burden of generating clusters from massive sequence data remains a serious challenge, and only a few algorithms are able to handle millions of sequences. To accurately measure the similarity between sequences and sequence clusters, sequence alignment is usually employed, which is computationally very expensive and represents a bottleneck for clustering algorithms. Hierarchical clustering (HC) is one of the most widely used approaches for sequence binning [<xref rid="pcbi.1005518.ref011" ref-type="bibr">11</xref>], which usually exhibits quadratic time and space complexity (when pairwise alignment is employed) or even higher complexity (when multiple alignment is used) due to the need of generating a pairwise similarity matrix. Various data preprocessing heuristics (e.g., removing redundant reads, using kmer distances as a filter to remove sequence pairs with large genetic distances, splitting a distance matrix) were recently proposed thatproven to be very effective in reducing the computational time of a clustering process. However, these heuristics do not fundamentally change the nature that HC is a quadratic-time algorithm. As a tradeoff between computational efficiency and accuracy, several heuristic methods including Cd-hit [<xref rid="pcbi.1005518.ref012" ref-type="bibr">12</xref>] and UCLUST [<xref rid="pcbi.1005518.ref013" ref-type="bibr">13</xref>] were recently proposed that employ greedy clustering instead of hierarchical clustering to reduce the computational complexity associated with sequence comparison. Several benchmark studies have shown that the use of greedy clustering can lead to considerable loss in clustering quality compared with hierarchical clustering [<xref rid="pcbi.1005518.ref014" ref-type="bibr">14</xref>–<xref rid="pcbi.1005518.ref016" ref-type="bibr">16</xref>]. However, due to the high computational complexity of hierarchical clustering, heuristic methods remain to date the <italic>only</italic> computationally feasible solution to process massive sequence datasets such as those generated by the human microbiome project (HMP) [<xref rid="pcbi.1005518.ref017" ref-type="bibr">17</xref>].</p>
    <p>In our previous work, we developed a sequence clustering algorithm called ESPRIT-Tree that performs hierarchical clustering efficiently with subquadratic complexity in both time and space while maintaining an accuracy comparable to the standard method [<xref rid="pcbi.1005518.ref018" ref-type="bibr">18</xref>]. It is capable of handling one million sequences with an average length of ∼250bp within less than one day on a single personal computer. Several large-scale benchmark studies have been performed by us and others on real-world datasets that identified ESPRIT-Tree as one of the best algorithms for taxonomy- independent analyses [<xref rid="pcbi.1005518.ref014" ref-type="bibr">14</xref>–<xref rid="pcbi.1005518.ref016" ref-type="bibr">16</xref>, <xref rid="pcbi.1005518.ref019" ref-type="bibr">19</xref>, <xref rid="pcbi.1005518.ref020" ref-type="bibr">20</xref>]. However, the single-thread nature of ESPRIT-Tree poses a limitation on its data processing capacity. As high performance computing clusters are becoming widely accessible, parallel computing is a feasible approach to further exploiting the computational power of subquadratic hierarchical clustering to handle even larger sequence datasets. However, efficient parallelization of hierarchical clustering is inherently difficult and only a few attempts [<xref rid="pcbi.1005518.ref021" ref-type="bibr">21</xref>–<xref rid="pcbi.1005518.ref023" ref-type="bibr">23</xref>] have been made using traditional hierarchical clustering involving quadratic complexity. Among them, HPC-Clust [<xref rid="pcbi.1005518.ref024" ref-type="bibr">24</xref>], ESPRIT [<xref rid="pcbi.1005518.ref025" ref-type="bibr">25</xref>], CRISPY [<xref rid="pcbi.1005518.ref026" ref-type="bibr">26</xref>] and LAHDC [<xref rid="pcbi.1005518.ref027" ref-type="bibr">27</xref>] are currently the only few parallel solutions for sequence clustering. HPC-Clust resorts to profile-based alignment to reduce computation burden, which we have shown to lead to inferior clustering quality when dealing with uncharted taxa [<xref rid="pcbi.1005518.ref014" ref-type="bibr">14</xref>]. Furthermore, it merely parallelizes the distance-calculation step, but not the cluster-merging step which takes a significant portion of the execution time on large datasets. Another major issue with HPC-Clust is that its memory usage grows quadratically with respect to the number of sequences, which makes it incapable of processing millions of sequences. ESPRIT and CRISPY are essentially quadratic-time algorithms, which are accurate but computa- tionally inefficient and take a couple of days to process one million reads. We recently proposed LAHDC as an attempt of parallelizing ESPRIT-Tree, which speeds up the algorithm by partitioning the data into subsets that can be clustered in parallel, with minor loss in clustering quality. However, more sophisticated solutions are still desired to efficiently parallelize the hierarchical clustering steps without sacrificing the cluster- ing quality. On the other hand, to the best of our knowledge there is still no prior work done on the parallelization of subquadratic hierarchical clustering methods.</p>
    <p>In this paper we propose a new parallel algorithm, ESPRIT-Forest, which is able to handle the problem of hierarchical clustering of tens of millions of sequences accurately, with subquadratic time and space complexity and a good scalability with respect to the number of CPUs. We utilize the basic concept behind ESPRIT-Tree that organizes sequences into a pseudo-metric based partitioning (PBP) tree structure to achieve sub-linear time complexity when searching for nearest neighbors, and propose a new multiple-pair merging algorithm that performs search on a PBP tree for parallel construction of clusters. As such, multiple computing threads can be used to perform hierarchical clustering on the same PBP tree without interfering with each other. As a result, the clustering procedure can be accelerated efficiently by using multiple processors. With the newly developed algorithm, we successfully performed a hierarchical clustering analysis of the HMP data, currently one of the largest published microbial 16S rRNA amplicon sequencing dataset, within less than 40 hours on a small computing cluster. As currently there is no hierarchical clustering method available to process such large datasets, this work represents a significant progress in algorithm development to overcome the computational bottleneck of microbial OTU binning.</p>
    <p>Hierarchical clustering is an essential tool for in-depth analyses of sequence data, including not only sequence binning but also sequence alignments [<xref rid="pcbi.1005518.ref028" ref-type="bibr">28</xref>, <xref rid="pcbi.1005518.ref029" ref-type="bibr">29</xref>] and construction of phylogenetic trees [<xref rid="pcbi.1005518.ref030" ref-type="bibr">30</xref>, <xref rid="pcbi.1005518.ref031" ref-type="bibr">31</xref>]. Thus, the algorithm proposed in this paper can help to boost the computational capacity of many sequence-processing pipelines, which in turn could enhance the contributions of bioinformatics to knowledge discovery in sequencing-based studies.</p>
  </sec>
  <sec id="sec002">
    <title>Design and implementation</title>
    <sec id="sec003">
      <title>Subquadratic time hierarchical clustering using PBP tree</title>
      <p>Hierarchical clustering is one of the most frequently used clustering methods in sequence analysis. It works by iterating a process of picking up a pair of samples or clusters with the minimal distance among all possible pairs of samples or clusters and then merging them into a new cluster, until only one single cluster is left or the distances between clusters all exceed a given threshold. Let <inline-formula id="pcbi.1005518.e001"><alternatives><graphic xlink:href="pcbi.1005518.e001.jpg" id="pcbi.1005518.e001g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M1"><mml:mrow><mml:mi mathvariant="script">D</mml:mi><mml:mo>=</mml:mo><mml:mo>{</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>N</mml:mi></mml:msub><mml:mo>}</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> be a dataset containing <italic>N</italic> samples (sequences), <inline-formula id="pcbi.1005518.e002"><alternatives><graphic xlink:href="pcbi.1005518.e002.jpg" id="pcbi.1005518.e002g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M2"><mml:mrow><mml:mo>{</mml:mo><mml:msub><mml:mi mathvariant="script">S</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>}</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> be the obtained clusters and <inline-formula id="pcbi.1005518.e003"><alternatives><graphic xlink:href="pcbi.1005518.e003.jpg" id="pcbi.1005518.e003g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M3"><mml:mrow><mml:mi>D</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mi mathvariant="script">S</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="script">S</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> be a binary function defining the distance between any two clusters, a hierarchical clustering algorithm is formally described in Algorithm 1.</p>
      <p><bold>Algorithm 1</bold>: Hierarchical Clustering</p>
      <p specific-use="line">1 <bold>Input</bold>: <inline-formula id="pcbi.1005518.e004"><alternatives><graphic xlink:href="pcbi.1005518.e004.jpg" id="pcbi.1005518.e004g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M4"><mml:mrow><mml:mi mathvariant="script">D</mml:mi><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mo>{</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>}</mml:mo></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula>, stop criterion <italic>d</italic><sub><italic>up</italic></sub>, distance function <italic>D</italic>(⋅);</p>
      <p specific-use="line">2 <bold>Initialization</bold>: <inline-formula id="pcbi.1005518.e005"><alternatives><graphic xlink:href="pcbi.1005518.e005.jpg" id="pcbi.1005518.e005g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M5"><mml:mrow><mml:msub><mml:mi mathvariant="script">S</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>}</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>≤</mml:mo><mml:mi>n</mml:mi><mml:mo>≤</mml:mo><mml:mi>N</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mo>Ω</mml:mo><mml:mn>0</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>N</mml:mi><mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>, <italic>k</italic> = 0;</p>
      <p specific-use="line">3 <bold>repeat</bold></p>
      <p specific-use="line">4  <inline-formula id="pcbi.1005518.e006"><alternatives><graphic xlink:href="pcbi.1005518.e006.jpg" id="pcbi.1005518.e006g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M6"><mml:mrow><mml:mrow><mml:mo>{</mml:mo><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>b</mml:mi><mml:mo>}</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mtext>argmin</mml:mtext><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mo>Ω</mml:mo><mml:mi>k</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mo>≠</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi mathvariant="script">S</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="script">S</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>;</p>
      <p specific-use="line">5  <italic>k</italic> = <italic>k</italic>+1;</p>
      <p specific-use="line">6  <inline-formula id="pcbi.1005518.e007"><alternatives><graphic xlink:href="pcbi.1005518.e007.jpg" id="pcbi.1005518.e007g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M7"><mml:mrow><mml:msub><mml:mi mathvariant="script">S</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mo>+</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi mathvariant="script">S</mml:mi><mml:mi>a</mml:mi></mml:msub><mml:mo>∪</mml:mo><mml:msub><mml:mi mathvariant="script">S</mml:mi><mml:mi>b</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>;</p>
      <p specific-use="line">7  Ω<sub><italic>k</italic></sub> = Ω<sub><italic>k</italic>−1</sub> ∪ {<italic>N</italic>+<italic>k</italic>}\{<italic>a</italic>, <italic>b</italic>};</p>
      <p specific-use="line">8 <bold>until</bold> |Ω<sub><italic>k</italic></sub>| = 1 or <inline-formula id="pcbi.1005518.e008"><alternatives><graphic xlink:href="pcbi.1005518.e008.jpg" id="pcbi.1005518.e008g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M8"><mml:mrow><mml:msub><mml:mo form="prefix" movablelimits="true">min</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mo>Ω</mml:mo><mml:mi>k</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mo>≠</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi mathvariant="script">S</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="script">S</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>≥</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:mi>u</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>;</p>
      <p specific-use="line">9 <bold>Output</bold>: A set of generated clusters <inline-formula id="pcbi.1005518.e009"><alternatives><graphic xlink:href="pcbi.1005518.e009.jpg" id="pcbi.1005518.e009g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M9"><mml:mrow><mml:mo>{</mml:mo><mml:msub><mml:mi mathvariant="script">S</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="script">S</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mo>+</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>}</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> and a set of existing clusters Ω<sub><italic>k</italic></sub>.</p>
      <p>The most time-consuming step in hierarchical clustering is the identification of the closest cluster pairs (line 4 in Algorithm 1) which requires computation of all <italic>N</italic>*(<italic>N</italic> − 1)/2 distance pairs in the first iteration and <italic>O</italic>(<italic>N</italic>) updates in each subsequent iterations. In our previous work [<xref rid="pcbi.1005518.ref018" ref-type="bibr">18</xref>] we proposed a data structure called pseudo-metric based partitioning (PBP) tree to enable fast searching of the closest pairs by making only a small number of distance comparisons. A PBP tree is an ordered, equal-depth tree that partitions a sequence space with a series of hyper-spheres. Each node of a PBP tree represents a hyper-sphere in the space with a selected sample as the center. The nodes in the tree are then organized as a hierarchical structure with multiple levels, with all nodes at the same level having an equal sphere radius and nodes at the upper level having a larger radius than those at the lower levels. Each leaf node at the bottom level has a radius of zero and is created for each sample in a dataset, with the sample point as the center. Each node at the same level is assigned an order number, according to the order at which the node is created in the tree. For a given node, a parent node is chosen from the nodes at the upper level whose hyper-sphere region covers the center of the given node, and has the minimal order number among all candidates. Finally, a root node is defined as the parent of all top-level nodes, without a defined center or radius. <xref ref-type="fig" rid="pcbi.1005518.g001">Fig 1</xref> illustrates a toy example of a PBP tree and how it partitions a dataset in a space.</p>
      <fig id="pcbi.1005518.g001" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1005518.g001</object-id>
        <label>Fig 1</label>
        <caption>
          <title>(a) A toy example of a PBP tree and (b) its corresponding partitioning of a dataset and a space.</title>
          <p>The colors indicate different levels of nodes and their corresponding hyper-spheres. The leaf nodes are omitted in the tree. When searching for the nearest neighbor of a point (large red dot), only a small number of sibling hyper-spheres (filled circles) need to be explored.</p>
        </caption>
        <graphic xlink:href="pcbi.1005518.g001"/>
      </fig>
      <p>By organizing sequences in a PBP tree and performing a branch-and-bound searching, we can find the nearest neighbor of any given sequence efficiently and determine the closest pair in sublinear time, avoiding the computation of the entire pairwise distance matrix. On the other hand, insertion (deletion) of a sequence into (from) the PBP tree takes almost constant computational time. Furthermore, after each modification, the new closest pair can be updated on-the-fly with sub-linear computation time. Hence, by iteratively merging the closest pair into one cluster and inserting the new cluster back to the PBP tree, we are able to perform hierarchical clustering very efficiently. In practice, ESPRIT-Tree achieved a computational complexity of <inline-formula id="pcbi.1005518.e010"><alternatives><graphic xlink:href="pcbi.1005518.e010.jpg" id="pcbi.1005518.e010g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M10"><mml:mrow><mml:mi mathvariant="script">O</mml:mi><mml:mo>(</mml:mo><mml:msup><mml:mi>N</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>.</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> to <inline-formula id="pcbi.1005518.e011"><alternatives><graphic xlink:href="pcbi.1005518.e011.jpg" id="pcbi.1005518.e011g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M11"><mml:mrow><mml:mi mathvariant="script">O</mml:mi><mml:mo>(</mml:mo><mml:msup><mml:mi>N</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>.</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msup><mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> on various benchmark datasets (<italic>N</italic> is the number of sequences) with the best clustering accuracy among existing methods. A detailed description on the branch-and-bound searching and on-the-fly maintenance of a PBP tree can be found in [<xref rid="pcbi.1005518.ref018" ref-type="bibr">18</xref>].</p>
      <p>Despite its efficiency, ESPRIT-Tree can only be executed on one computer processor due to the restriction of finding and merging closest pairs one at a time, which limits its application to ultra-large-scale data. In this paper we address this issue by allowing multiple cluster merging operations to be executed on one single PBP tree in parallel, which is described in detail below.</p>
    </sec>
    <sec id="sec004">
      <title>Multi-point parallel clustering on PBP tree</title>
      <p>Parallelizing the hierarchical clustering process is difficult because for each merging operation it is required to keep track of <italic>all</italic> previous merging results, which restricts the capability of multiple threading. We tackle this problem by exploiting the implicit independency among clustering steps. A new cluster-merging criterion is proposed that strictly replicates the results of the standard hierarchical clustering method but at the same time decouples and re-orders the cluster merging steps, enabling hierarchical clustering to be executed on several merging points in parallel. <xref ref-type="fig" rid="pcbi.1005518.g002">Fig 2</xref> illustrates the basic idea of parallel merging with a toy example showing that some clustering steps can be carried out simultaneously without violating the merging rules used in the standard hierarchical clustering process.</p>
      <fig id="pcbi.1005518.g002" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1005518.g002</object-id>
        <label>Fig 2</label>
        <caption>
          <title>A toy example illustrating single-point (left) and multiple-point (right) hierarchical clustering by parallelizing uncorrelated operations.</title>
          <p>Each filled box represents a sequence and each circle represents a cluster-merging step. The numbers in the circle denote the order of merging operations. The merging orders may change when switching from single-point to multi-point clustering.</p>
        </caption>
        <graphic xlink:href="pcbi.1005518.g002"/>
      </fig>
      <p>The key challenge of parallel merging is to design a clustering scheme that produces results identical to that generated by standard hierarchical clustering, which is important in order to preserve clustering quality. We demonstrate below that by using a proper merging criterion, multi-point clustering can achieve a clustering result equivalent to that of standard single-point hierarchical clustering. Specifically, in each step, we can merge all pairs {<italic>a</italic>, <italic>b</italic>} that satisfy <italic>NN</italic>(<italic>a</italic>) = <italic>b</italic> and <italic>NN</italic>(<italic>b</italic>) = <italic>a</italic> (Here <italic>NN</italic> denotes the nearest neighbour), without violating the rule used conventional hierarchical clustering. The modified algorithm is described in Algorithm 2.</p>
      <p>We prove that, in the case of sequence clustering and many other normal situations, a clustering result generated by Algorithm 2 is always consist with one generated by Algorithm 1. The formal statement and the proof of the theorem are provided in <xref ref-type="supplementary-material" rid="pcbi.1005518.s001">S1 Methods</xref>. With Algorithm 2 we can extend our previous ESPRIT- Tree algorithm to a parallel version called ESPRIT-Forest. <xref rid="pcbi.1005518.t001" ref-type="table">Table 1</xref> depicts the overall framework of our new algorithm, ESPRIT-Forest, and the comparison with the previous single-thread version, with the parallel execution parts underlined. It should be noted that, although the key modification (Step 3) itself is not parallelized, it is the basis for achieving high parallelization efficiency. Without the modified criterion, the parallelization step (Step 5) will be inefficient due to too few deliverable tasks.</p>
      <table-wrap id="pcbi.1005518.t001" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1005518.t001</object-id>
        <label>Table 1</label>
        <caption>
          <title>Comparison of the overall frameworks of ESPRIT-Tree and ESPRIT-Forest.</title>
          <p>The parallel execution parts are underlined.</p>
        </caption>
        <alternatives>
          <graphic id="pcbi.1005518.t001g" xlink:href="pcbi.1005518.t001"/>
          <table frame="box" rules="all" border="0">
            <colgroup span="1">
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <th align="center" colspan="2" style="border-top:thick;border-bottom:thick" rowspan="1">ESPRIT-Tree</th>
                <th align="center" colspan="2" style="border-top:thick;border-bottom:thick" rowspan="1">ESPRIT-Forest</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="left" rowspan="1" colspan="1">1.</td>
                <td align="left" rowspan="1" colspan="1">Construct a PBP tree and insert all samples</td>
                <td align="left" rowspan="1" colspan="1">1.</td>
                <td align="left" rowspan="1" colspan="1">Construct a PBP tree in each computing node and insert all samples</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">2.</td>
                <td align="left" rowspan="1" colspan="1">Find the nearest neighbor (NN) for each sample</td>
                <td align="left" rowspan="1" colspan="1">2.</td>
                <td align="left" rowspan="1" colspan="1">
                  <underline>Find the nearest neighbor (NN) for each sample in parallel</underline>
                </td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">3.</td>
                <td align="left" rowspan="1" colspan="1">Find the closest pair from a NN list, delete the pair from the PBP tree and merge them to form a new cluster</td>
                <td align="left" rowspan="1" colspan="1">3.</td>
                <td align="left" rowspan="1" colspan="1">Select <italic>all pairs</italic> {<italic>a</italic>, <italic>b</italic>} satisfying <italic>NN</italic>(<italic>a</italic>) = <italic>b</italic> and <italic>NN</italic>(<italic>b</italic>) = <italic>a</italic>, delete each pair from the PBP tree and merge each of them into a new cluster</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">4.</td>
                <td align="left" rowspan="1" colspan="1">Insert the new cluster into the PBP tree</td>
                <td align="left" rowspan="1" colspan="1">4.</td>
                <td align="left" rowspan="1" colspan="1">Insert all new clusters into the PBP tree</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">5.</td>
                <td align="left" rowspan="1" colspan="1">Update the NN list for the new cluster and all affected clusters through NN search</td>
                <td align="left" rowspan="1" colspan="1">5.</td>
                <td align="left" rowspan="1" colspan="1">
                  <underline>Update the NN list for the new clusters and all affected clusters through NN search in parallel</underline>
                </td>
              </tr>
              <tr>
                <td align="left" style="border-bottom:thick" rowspan="1" colspan="1">6.</td>
                <td align="left" style="border-bottom:thick" rowspan="1" colspan="1">Repeat Steps 3–5 until the stopping criterion is met</td>
                <td align="left" style="border-bottom:thick" rowspan="1" colspan="1">6.</td>
                <td align="left" style="border-bottom:thick" rowspan="1" colspan="1">Repeat Steps 3–5 until the stopping criterion is met</td>
              </tr>
            </tbody>
          </table>
        </alternatives>
      </table-wrap>
      <p><bold>Algorithm 2</bold>: Multi-point Hierarchical Clustering</p>
      <p specific-use="line">1 <bold>Input</bold>: <inline-formula id="pcbi.1005518.e012"><alternatives><graphic xlink:href="pcbi.1005518.e012.jpg" id="pcbi.1005518.e012g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M12"><mml:mrow><mml:mi mathvariant="script">D</mml:mi><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mo>{</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>}</mml:mo></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula>, stop criterion <italic>d</italic><sub><italic>up</italic></sub>, distance function <italic>D</italic>(⋅);</p>
      <p specific-use="line">2 <bold>Initialization</bold>: <inline-formula id="pcbi.1005518.e013"><alternatives><graphic xlink:href="pcbi.1005518.e013.jpg" id="pcbi.1005518.e013g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M13"><mml:mrow><mml:msub><mml:mi mathvariant="script">S</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>}</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>≤</mml:mo><mml:mi>n</mml:mi><mml:mo>≤</mml:mo><mml:mi>N</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mo>Ω</mml:mo><mml:mn>0</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>N</mml:mi><mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>, <italic>k</italic> = 0;</p>
      <p specific-use="line">3 <bold>repeat</bold></p>
      <p specific-use="line">4  Set <inline-formula id="pcbi.1005518.e014"><alternatives><graphic xlink:href="pcbi.1005518.e014.jpg" id="pcbi.1005518.e014g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M14"><mml:mrow><mml:mo>Φ</mml:mo><mml:mo>=</mml:mo><mml:mo>{</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>}</mml:mo></mml:mrow><mml:mo>∣</mml:mo><mml:mspace width="0.166667em"/><mml:msub><mml:mtext>NN</mml:mtext><mml:msub><mml:mo>Ω</mml:mo><mml:mi>k</mml:mi></mml:msub></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi mathvariant="script">S</mml:mi><mml:msub><mml:mi>a</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mtext>NN</mml:mtext><mml:msub><mml:mo>Ω</mml:mo><mml:mi>k</mml:mi></mml:msub></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi mathvariant="script">S</mml:mi><mml:msub><mml:mi>b</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi>D</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi mathvariant="script">S</mml:mi><mml:msub><mml:mi>a</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="script">S</mml:mi><mml:msub><mml:mi>b</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>&lt;</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:mi>u</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mo>}</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>;</p>
      <p specific-use="line">5  <bold>for</bold>
<italic>i</italic> ← 1 <bold>to</bold> |Φ| <bold>do</bold></p>
      <p specific-use="line">6   <italic>k</italic> = <italic>k</italic>+1;</p>
      <p specific-use="line">7   <inline-formula id="pcbi.1005518.e015"><alternatives><graphic xlink:href="pcbi.1005518.e015.jpg" id="pcbi.1005518.e015g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M15"><mml:mrow><mml:msub><mml:mi mathvariant="script">S</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mo>+</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi mathvariant="script">S</mml:mi><mml:msub><mml:mi>a</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:msub><mml:mo>∪</mml:mo><mml:msub><mml:mi mathvariant="script">S</mml:mi><mml:msub><mml:mi>b</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>;</p>
      <p specific-use="line">8   Ω<sub><italic>k</italic></sub> = Ω<sub><italic>k</italic>−1</sub> ∪ {<italic>N</italic>+<italic>k</italic>}\{<italic>a</italic><sub><italic>i</italic></sub>, <italic>b</italic><sub><italic>i</italic></sub>};</p>
      <p specific-use="line">9 <bold>until</bold> |Ω<sub><italic>k</italic></sub>| = 1 or <inline-formula id="pcbi.1005518.e016"><alternatives><graphic xlink:href="pcbi.1005518.e016.jpg" id="pcbi.1005518.e016g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M16"><mml:mrow><mml:msub><mml:mo form="prefix" movablelimits="true">min</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mo>Ω</mml:mo><mml:mi>k</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mo>≠</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi mathvariant="script">S</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="script">S</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>≥</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:mi>u</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>;</p>
      <p specific-use="line">10 <bold>Output</bold>: A set of generated clusters <inline-formula id="pcbi.1005518.e017"><alternatives><graphic xlink:href="pcbi.1005518.e017.jpg" id="pcbi.1005518.e017g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M17"><mml:mrow><mml:mo>{</mml:mo><mml:msub><mml:mi mathvariant="script">S</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="script">S</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mo>+</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>}</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> and a set of existing clusters Ω<sub><italic>k</italic></sub>.</p>
    </sec>
    <sec id="sec005">
      <title>Code implementation</title>
      <sec id="sec006">
        <title>Programming model</title>
        <p>A master-slave programming model was adopted in the implementation of ESPRIT- Forest. The master thread takes charge of all samples and distributes tasks to the slave threads, while the slave threads are launched by the master thread to execute required operations and become inactive after that. In a shared-memory architecture (SMA) computer, this can be easily implemented by using parallel programming modules such as OpenMP [<xref rid="pcbi.1005518.ref032" ref-type="bibr">32</xref>]. However, shared-memory computers with many CPU cores are expensive and currently many high-performance computing (HPC) centers do not have a shared-memory computer with more than 32 CPU cores. Therefore, in order to ensure the scalability of our method, we implemented it using a symmetric multi-processor (SMP) model where multiple computing nodes do not access the memory of each other, but communicate via a message passing interface (MPI). The code is implemented in C++ using OpenMPI [<xref rid="pcbi.1005518.ref032" ref-type="bibr">32</xref>] and OpenMP at the same time.</p>
        <p>An appealing property of ESPRIT-Forest is that the PBP tree does not need to be shared or synchronized among computing nodes, because the possible discrepancy of the constructed trees will not lead to inaccuracy in NN search, provided that the properties of the PBP trees are maintained. In practice, each node reads the entire sequence data, constructs a PBP tree independently, and modifies the tree by following the same instructions from the master node, which leads to almost identical tree structure (with small discrepancy caused by floating point errors). During the clustering procedure, in each iteration, the master node launches a list of NN queries and assigns each query task to a computing node (including the master node itself). Each computing node responds to the query by executing NN search tasks in its assignment list, and returns the results to the master node. The master node then determines which clusters should be merged and what new queries should be launched next. After cluster merging operations are made on the master node, it broadcasts the changes to the slave nodes and each computing node makes changes to its own PBP tree accordingly. In this way, the computing nodes are weakly coupled and the communication costs are minimized, which guarantees the efficiency of parallelization.</p>
      </sec>
      <sec id="sec007">
        <title>Tie-breaking</title>
        <p>An issue not considered in the above framework <xref rid="pcbi.1005518.t001" ref-type="table">Table 1</xref> is that there may be ties in the searching of the nearest neighbors. For example, for three clusters <italic>a</italic>, <italic>b</italic> and <italic>c</italic>, it may hold that <italic>NN</italic>(<italic>a</italic>) = <italic>b</italic>, <italic>NN</italic>(<italic>b</italic>) = <italic>c</italic> and <italic>NN</italic>(<italic>c</italic>) = <italic>a</italic>, with equal NN distances. In this case, the above proposed framework may fail to discover mergeable pairs, which causes the algorithm to be inefficient or even fail. To avoid this problem, a tie-breaking operation is carried out in each iteration that scans all unpaired clusters and check if they can be paired. For an unpaired cluster <italic>a</italic> and its counterpart <italic>b</italic> = <italic>NN</italic>(<italic>a</italic>), if <italic>b</italic> is also unpaired and <italic>D</italic>(<italic>b</italic>, <italic>NN</italic>(<italic>b</italic>)) ≥ <italic>D</italic>(<italic>a</italic>, <italic>b</italic>), then <italic>NN</italic>(<italic>b</italic>) is forced to be <italic>a</italic> to make a mergeable pair.</p>
      </sec>
      <sec id="sec008">
        <title>Delayed updating of nearest neighbors</title>
        <p>With the proposed multi-point merging criterion, a large number of merging and NN updating are generated in each iteration, which makes it possible for efficient paralle- lization. However, a potential problem is that some NN update requests may not be necessary. For example, if we search the NN of a cluster <italic>a</italic>, resulting in a solution <italic>NN</italic>(<italic>a</italic>) = <italic>b</italic>, but later <italic>b</italic> is merged with another cluster and we have to search the NN for <italic>a</italic> again, the former search effort is actually wasted and brings additional computation burden. To avert this issue, we design a delayed updating scheme that postpones a NN search until it has to be carried out. Due to the non-decreasing property of hierarchical clustering, when the NN of a cluster becomes invalid (i.e., merged into a new cluster), the old NN distance can be used as an estimate of the lower bound of a new NN distance. Two heaps [<xref rid="pcbi.1005518.ref033" ref-type="bibr">33</xref>] are created in the master nodes, with one storing a sorted list of NN pairs to be merged, and the other storing a sorted list of clusters for which a search needs to be launched to update NN information. The master node inspects each candidate NN pair in the first heap. If the distance of the candidate pair is smaller than the estimated NN distance of all pre-updated clusters, the pair can be merged regardless of the incomplete NN information. If there is at least one mergable pair in the heap, the master node carries out the merging first without launching update requests; otherwise, it launches a predefined number of updates (20 times the number of the used CPU cores) to ensure that the clustering steps can be continued with a balanced workload.</p>
      </sec>
      <sec id="sec009">
        <title>Pipeline and data pre-processing</title>
        <p>ESPRIT-Forest inherits the same pipeline of ESPRIT and ESPRIT-Tree, which takes sequences in FASTA format as inputs and performs three major operation steps: pre-processing, hierarchical clustering and statistical analysis. The pre-processing step is identical with ESPRIT and ESPRIT-Tree, which merges redundant sequences and filters out sequences with a poor match with their primers or having lengths deviated too much from the average length. Although chimera checking is not implemented in ESPRIT-Forest, it can be performed efficiently with existing tools such as UCHIME [<xref rid="pcbi.1005518.ref034" ref-type="bibr">34</xref>]. We should point out that although ESPRIT-Tree/ESPRIT-Forest does not pay lots of efforts on data pre-procesing, it is a stand-alone algorithm which can be used in couple with other data preprocessing techniques or as a basic building block in a pipeline to further speed up a clustering process. The processed sequences are fed to hierarchical clustering module and two types of clustering outputs are generated. The first output is the complete hierarchical tree described in a tetrad table format with each line representing a clustering step. The second is the cluster partitioning of sequences at various given distance thresholds, which can be customized by the users. Finally, a statistical analysis module inherited from ESPRIT/ESPRIT-Tree performs ecological statistical analysis including the ACE estimates, the CHAO1 estimates and the Rarefaction curves [<xref rid="pcbi.1005518.ref025" ref-type="bibr">25</xref>] on user-defined distance levels.</p>
      </sec>
    </sec>
  </sec>
  <sec sec-type="results" id="sec010">
    <title>Results</title>
    <p>We tested the proposed ESPRIT-Forest algorithm on several large-scale real-world datasets acquired from 16S rRNA sequencing of human microbiome, and compared with three leading sequence-clustering algorithms, ESPRIT-Tree, UPARSE (the latest version of UCLUST [<xref rid="pcbi.1005518.ref035" ref-type="bibr">35</xref>]) and HPC-Clust. For UPARSE and UCLUST, the default parameters are used per the authors’ suggestion. The tests were performed on a small HPC cluster with 32 nodes, each equipped with two Intel Xeon E5-2660 8-core CPUs and 128GB memory. Up to 256 (16×16) cores were used in the test.</p>
    <sec id="sec011">
      <title>Scalability test</title>
      <p>We first tested the parallelization efficiency of ESPRIT-Forest. To this end, a human gut microbiome dataset from an obesity study [<xref rid="pcbi.1005518.ref036" ref-type="bibr">36</xref>] was used, which contains 1.1M reads (470K unique sequences) with an average length of 233bp. <xref ref-type="fig" rid="pcbi.1005518.g003">Fig 3</xref> depicts the running time of ESPRIT-Forest performed on 1 to 128 CPU cores. For comparison, the running time of the single-thread ESPRIT-Tree algorithm is also reported. With 128 cores, ESPRIT-Forest finished the analysis of the entire dataset in 2,218 seconds, more than 20 times faster than ESPRIT-Tree. With only 2 CPU cores, ESPRIT-Forest surpasses ESPRIT-Tree in speed. This demonstrates a good scalability of the algorithm to utilize the power of parallel computing. In the single-core environment, ESPRIT-Forest is slower than ESPRIT-Tree. This is because in order to reduce the communication cost in parallel execution, we force a large number of NN updates (20 times the number of CPU cores) to be executed in a batch. Consequently, some unnecessary NN updates are carried out in the single-core case. This, however, is a necessary trade-off.</p>
      <fig id="pcbi.1005518.g003" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1005518.g003</object-id>
        <label>Fig 3</label>
        <caption>
          <title>Execution time of ESPRIT-Forest performed on a human gut microbiome dataset using a varying number of CPU cores ranging from 1 to 128.</title>
          <p>The clustering termination criterion was set to 85% sequence similarity. For comparison, the execution time of ESPRIT-Tree is also reported.</p>
        </caption>
        <graphic xlink:href="pcbi.1005518.g003"/>
      </fig>
      <p>We also tested HPC-Clust on the same dataset. However, even with 128GB memory per node and at a very high similarity threshold 0.99, HPC-Clust failed to complete the distance calculation and crashed after about one hour of execution. This suggests that HPC-Clust is not suitable to handle large datasets. In order to make the comparison feasible, we sampled a subset of 300K reads (93,269 unique reads) from the dataset and executed each algorithm on it. <xref rid="pcbi.1005518.t002" ref-type="table">Table 2</xref> reports the execution time of ESPRIT-Forest, ESPRIT-Tree, HPC-Clust and UPARSE. ESPRIT-Forest and HPC-Clust were executed on 32 CPU cores. We can see that even after excluding the time used for sequence alignments, the clustering step of HPC-Clust still took nearly twice the total time of ESPRIT-Tree (it used only one CPU core) and is 15 times slower than ESPRIT-Forest. Although UPARSE is faster, it is a greedy method and the clustering result is quite coarse as demonstrated in the next subsection.</p>
      <table-wrap id="pcbi.1005518.t002" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1005518.t002</object-id>
        <label>Table 2</label>
        <caption>
          <title>Execution time of four clustering methods performed on a subset of the human gut microbiome data.</title>
          <p>ESPRIT-Forest and HPC-Clust (including the INFERNAL alignment method it used) were executed on 32 CPU cores.</p>
        </caption>
        <alternatives>
          <graphic id="pcbi.1005518.t002g" xlink:href="pcbi.1005518.t002"/>
          <table frame="box" rules="all" border="0">
            <colgroup span="1">
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <th align="left" rowspan="1" colspan="1">Method</th>
                <th align="center" rowspan="1" colspan="1">ES-Forest</th>
                <th align="center" rowspan="1" colspan="1">ES-Tree</th>
                <th align="center" rowspan="1" colspan="1">HPC-Clust<break/>(incl. align)</th>
                <th align="center" rowspan="1" colspan="1">HPC-Clust<break/>(excl. align)</th>
                <th align="center" rowspan="1" colspan="1">UPARSE</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="left" rowspan="1" colspan="1">Time</td>
                <td align="center" rowspan="1" colspan="1">251s</td>
                <td align="center" rowspan="1" colspan="1">1942s</td>
                <td align="center" rowspan="1" colspan="1">217h</td>
                <td align="center" rowspan="1" colspan="1">3695s</td>
                <td align="center" rowspan="1" colspan="1">70s</td>
              </tr>
            </tbody>
          </table>
        </alternatives>
      </table-wrap>
    </sec>
    <sec id="sec012">
      <title>Benchmark on clustering quality</title>
      <p>In addition to computational efficiency, clustering quality is another important consideration when evaluating a clustering method. Although we have proved in theory that our parallelization method should produce results compliant with the single-thread version, the multi-solution nature of hierarchical clustering and the approximation steps taken in ESPRIT-Tree may lead to some random fluctuations. Here we carried out an experiment to demonstrate that parallelization does not affect the quality of clustering outcomes. It should be noted that the purpose of the experiments carried out in this section is to confirm that the performance of ESPRIT-Forest is similar to ESPRIT-Tree in statistical sense using other methods as anchors, rather than to compare ESPRIT-Forest with previous methods. Comprehensive comparison of 16S rRNA clustering or OTU picking methods is quite a sophisticated and controversial topic, which is out of the scope of this paper. A brief discussion on this issue will be provided later in the paper.</p>
      <p>The benchmark test protocol proposed in [<xref rid="pcbi.1005518.ref014" ref-type="bibr">14</xref>] was used. Briefly, a benchmark database comprising sequences that can be reliably annotated to a known taxon was used as the ground truth. The annotation was done using a BLAST [<xref rid="pcbi.1005518.ref037" ref-type="bibr">37</xref>] search against the RDP-II [<xref rid="pcbi.1005518.ref038" ref-type="bibr">38</xref>] database (not the RDP classifier), whose annotation was enhanced by the TaxCollector [<xref rid="pcbi.1005518.ref039" ref-type="bibr">39</xref>] tool to achieve precise species-level labeling. A test dataset was created by random sampling without replacement from the benchmark database. The test dataset was fed into a clustering algorithm, and the clustering results generated at various similarity thresholds were then compared with the true annotation using the normalized mutual information (NMI) index. The peak NMI score was used to measure the clustering quality. To remove statistical variations, twenty test sets were randomly generated in each run and box-plots were created to compare the quality of different clustering results. In this paper, four benchmark databases were used, two from the human gut microbiome dataset [<xref rid="pcbi.1005518.ref036" ref-type="bibr">36</xref>], one from the ELDERMET dataset and one from the saliva subset of the HMP project.</p>
      <p><xref ref-type="fig" rid="pcbi.1005518.g004">Fig 4</xref> reports the peak NMI scores of ESPRIT-Forest, ESPRIT-Tree, UPARSE and HPC-Clust performed on four benchmark datasets, respectively, averaged over twenty runs. ESPRIT-Forest achieved statistically identical quality compared with ESPRIT-Tree (p-value &gt; 0.2 based on Student’s t-test) and both performed significantly better than UPARSE (p-value &lt; 10<sup>−22</sup>). This result shows that hierarchical clustering indeed performs much better than heuristic methods, which is consistent with previous work [<xref rid="pcbi.1005518.ref014" ref-type="bibr">14</xref>–<xref rid="pcbi.1005518.ref016" ref-type="bibr">16</xref>, <xref rid="pcbi.1005518.ref019" ref-type="bibr">19</xref>, <xref rid="pcbi.1005518.ref020" ref-type="bibr">20</xref>]. It also empirically verifies the theoretical result that multi-point clustering does not change the nature of a clustering algorithm. To further verify this, the NMI scores achieved for ESPRIT-Tree and ESPRIT-Forest on the first dataset with different distance cut-offs are depicted in <xref ref-type="fig" rid="pcbi.1005518.g005">Fig 5</xref>. We see that the results of both algorithms agree on various distance levels. Moreover, despite the lengthy time consumed in HPC-Clust, it lead to inferior clustering quality due to the profile-based alignment method employed.</p>
      <fig id="pcbi.1005518.g004" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1005518.g004</object-id>
        <label>Fig 4</label>
        <caption>
          <title>Comparison of clustering quality of ESPRIT-Forest, ESPRIT-Tree and UPARSE performed on benchmark datasets using the species annotation as ground truth.</title>
          <p>(a) NMI scores calculated on human gut V2 dataset. (b) NMI scores calculated on human gut V6 dataset. (c) NMI scores calculated on ELDERMET dataset. (d) NMI scores calculated on HMP Saliva dataset.</p>
        </caption>
        <graphic xlink:href="pcbi.1005518.g004"/>
      </fig>
      <fig id="pcbi.1005518.g005" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1005518.g005</object-id>
        <label>Fig 5</label>
        <caption>
          <title>Comparison of clustering quality of ESPRIT-Tree (red) and ESPRIT-Forest (blue) on various distance cut-offs on the human gut V2 dataset.</title>
          <p>We see that the results of both algorithms agrees but with small variations caused by randomness in clustering.</p>
        </caption>
        <graphic xlink:href="pcbi.1005518.g005"/>
      </fig>
    </sec>
    <sec id="sec013">
      <title>Tests on large-scale real world datasets</title>
      <p>To further demonstrate the power of ESPRIT-Forest on processing large amplicon sequencing datasets, we applied the algorithm to the HMP and ELDERMET datasets [<xref rid="pcbi.1005518.ref040" ref-type="bibr">40</xref>]. The HMP dataset comprises 19.8 million raw reads sequenced from different hypervariable regions of the microbial 16S rRNA gene, including 9.6 million reads from the V1-V3 regions, 9.6 million reads from the V3-V5 regions, and 0.7 million reads from the V6-V9 regions. Since clustering sequences from different regions makes no biological sense, we partitioned the data into three subsets based on their targeted regions and clustered the two largest subsets. The ELDERMET dataset comprises 9.0 million raw reads sequenced from the V2-V3 regions. Although several studies have analyzed the above datasets [<xref rid="pcbi.1005518.ref040" ref-type="bibr">40</xref>–<xref rid="pcbi.1005518.ref042" ref-type="bibr">42</xref>], only taxonomy-dependent approaches were used. To the best of our knowledge, no taxonomy-independent analysis has been performed before using a hierarchical clustering method.</p>
      <p><xref rid="pcbi.1005518.t003" ref-type="table">Table 3</xref> reports the detailed information of the datasets and the execution time required for ESPRIT-Forest (using 256 CPU cores) to complete the analysis. By using parallel computing, the proposed algorithm is able to finish the hierarchical clustering analyses of all datasets in less than 40 hours. This experiment suggests that with the power of parallel computing it is now computationally feasible to perform hierarchical clustering of tens of millions of sequences. Considering that heuristic greedy methods with low clustering quality was the only available clustering method capable of handling extremely large sequence data, this work thus represents a significant progress in algorithm development to overcome the computational bottleneck of microbial OTU binning.</p>
      <table-wrap id="pcbi.1005518.t003" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1005518.t003</object-id>
        <label>Table 3</label>
        <caption>
          <title>Execution time of ESPRIT-Forest performed on HMP and ELDERMET datasets.</title>
          <p>The clustering termination criterion was set to 85% sequence similarity. ESPRIT preproc was used to remove low-quality reads before clustering analysis.</p>
        </caption>
        <alternatives>
          <graphic id="pcbi.1005518.t003g" xlink:href="pcbi.1005518.t003"/>
          <table frame="box" rules="all" border="0">
            <colgroup span="1">
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <th align="left" style="border-top:thick;border-bottom:thick" rowspan="1" colspan="1">Datasets</th>
                <th align="center" style="border-top:thick;border-bottom:thick" rowspan="1" colspan="1">Data size</th>
                <th align="center" style="border-top:thick;border-bottom:thick" rowspan="1" colspan="1">No. raw reads</th>
                <th align="center" style="border-top:thick;border-bottom:thick" rowspan="1" colspan="1">No. high-quality reads</th>
                <th align="center" style="border-top:thick;border-bottom:thick" rowspan="1" colspan="1">No. unique reads</th>
                <th align="center" style="border-top:thick;border-bottom:thick" rowspan="1" colspan="1">Ave. length (bp)</th>
                <th align="center" style="border-top:thick;border-bottom:thick" rowspan="1" colspan="1">Exec. time<break/>(ES-Forest)</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="left" rowspan="1" colspan="1">HMP V1-V3</td>
                <td align="center" rowspan="1" colspan="1">5.5GB</td>
                <td align="center" rowspan="1" colspan="1">9,547,737</td>
                <td align="center" rowspan="1" colspan="1">7,678,585</td>
                <td align="center" rowspan="1" colspan="1">5,063,052</td>
                <td align="center" rowspan="1" colspan="1">482</td>
                <td align="center" rowspan="1" colspan="1">33h</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">HMP V3-V5</td>
                <td align="center" rowspan="1" colspan="1">5.4GB</td>
                <td align="center" rowspan="1" colspan="1">9,547,362</td>
                <td align="center" rowspan="1" colspan="1">7,747,712</td>
                <td align="center" rowspan="1" colspan="1">4,277,831</td>
                <td align="center" rowspan="1" colspan="1">483</td>
                <td align="center" rowspan="1" colspan="1">38h</td>
              </tr>
              <tr>
                <td align="left" style="border-bottom:thick" rowspan="1" colspan="1">ELDERMET</td>
                <td align="center" style="border-bottom:thick" rowspan="1" colspan="1">2.5GB</td>
                <td align="center" style="border-bottom:thick" rowspan="1" colspan="1">8,989,448</td>
                <td align="center" style="border-bottom:thick" rowspan="1" colspan="1">7,068,272</td>
                <td align="center" style="border-bottom:thick" rowspan="1" colspan="1">3,826,973</td>
                <td align="center" style="border-bottom:thick" rowspan="1" colspan="1">254</td>
                <td align="center" style="border-bottom:thick" rowspan="1" colspan="1">8h</td>
              </tr>
            </tbody>
          </table>
        </alternatives>
      </table-wrap>
    </sec>
  </sec>
  <sec id="sec014">
    <title>Avalability and future directions</title>
    <p>The ESPRIT-Forest software is available at <ext-link ext-link-type="uri" xlink:href="http://www.acsu.buffalo.edu/~yijunsun/lab/ESPRIT-Forest.html">http://www.acsu.buffalo.edu/∼yijunsun/lab/ESPRIT-Forest.html</ext-link>, including the source code of both MPI and OpenMP implementations with pre-compiled executable codes. The software is an open-source program following the OSI certificated Adaptive Public License (<ext-link ext-link-type="uri" xlink:href="https://opensource.org/licenses/APL-1.0">https://opensource.org/licenses/APL-1.0</ext-link>). With the rapid development of sequencing technologies, the computational bottleneck hinders the efficient mining of acquired large data sets. In this paper, we described a novel efficient parallel hierarchical clustering algorithm, ESPRIT-Forest, to tackle the computational bottleneck associated with the taxonomy-independent analyses of amplicon sequencing data. Using a small HPC cluster, the proposed algorithm successfully processed the entire HMP dataset, one of the currently largest published 16S rRNA sequence dataset, within less than 40 hours, which suggests that ESPRIT-Forest is capable of handling most of the existing amplicon sequencing datasets. The source code of the algorithm is made available so that it can be incorporated with existing tools and pipelines.</p>
    <p>One severe challenge for sequence clustering for very large scale problems is that the entire dataset has to be loaded into the memory of every computation node and processed together. Hence the capacity of a single node limits the size of the problem that can be solved. In one of our previous work we proposed LAHDC [<xref rid="pcbi.1005518.ref027" ref-type="bibr">27</xref>] which enables partitioning of sequence data into subsets and each computation node conquers a subset separately, but with slight loss in clustering quality. In order to handle very large datasets, the advantages of LAHDC and ESPRIT-Forest should be fused, which would be one of our future direction.</p>
    <p>Another striking challenge brought by the advent of next-generation sequencing technology is the rapid growth of sequence length. Many third-generation sequencing technology claims to have a long read length of 10<italic>k</italic> to 100<italic>k</italic> base-pairs, which made sequence alignments more time consuming. To cope with this, parallelizing the Needleman-Wunsch algorithm for pairwise sequence alignments with GPU computation would be a feasible solution, which would require more sophisticated design on the programming architecture and the computer hardware infrastructure in order to support GPU-CPU hybrid computing.</p>
    <p>The problem of identifying microbe taxonomic groups (OTUs) from 16S rRNA sequencing has been investigated for many years with tons of algorithms and tools proposed but debates still remain on various scopes [<xref rid="pcbi.1005518.ref043" ref-type="bibr">43</xref>, <xref rid="pcbi.1005518.ref044" ref-type="bibr">44</xref>]. Due to the limitation of human knowledge on microbial communities, establishment of reliable ground truth becomes very difficult and evaluations of OTU picking often lead to controversial results with different datasets or criteria used. Moreover, recent studies have suggested that alignments and clustering methods are not the only major factors that affect the clustering quality, and sequence preprocess or denoising would largely affect the final results [<xref rid="pcbi.1005518.ref045" ref-type="bibr">45</xref>, <xref rid="pcbi.1005518.ref046" ref-type="bibr">46</xref>], which further increases the complication of this issue. For this reason, in current stage it is hard to settle the complete OTU picking problem with a single pipeline. Alternatively, a stand-alone programs that can be flexibly incorporated with existing pipelines and provides incremental improvements would be favored. On the other hand, some recent studies have suggested that a dynamic distance cut-off accounting the phylogentic topology of the entire microbe community would improve the quality of OTU picking [<xref rid="pcbi.1005518.ref047" ref-type="bibr">47</xref>, <xref rid="pcbi.1005518.ref048" ref-type="bibr">48</xref>]. Compared with greedy-based approaches, our hierarchical clustering approach provides more detailed information about the entire community, thus leaving more potential of improvements for advanced OTU-picking methods in the future. Moreover, since hierarchical clustering plays a fundamental role in many analytical procedures other than sequence binning, such as phylogenetic tree construction [<xref rid="pcbi.1005518.ref049" ref-type="bibr">49</xref>], sequence alignments [<xref rid="pcbi.1005518.ref050" ref-type="bibr">50</xref>], sequence database construction and searching [<xref rid="pcbi.1005518.ref051" ref-type="bibr">51</xref>], etc., our general approach can be used to boost the efficiency of other sequence analysis tools.</p>
  </sec>
  <sec sec-type="supplementary-material" id="sec015">
    <title>Supporting information</title>
    <supplementary-material content-type="local-data" id="pcbi.1005518.s001">
      <label>S1 Methods</label>
      <caption>
        <title>Theoretical proof for the equivalence of parallel hierarchical clustering to sequential ones.</title>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pcbi.1005518.s001.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ref-list>
    <title>References</title>
    <ref id="pcbi.1005518.ref001">
      <label>1</label>
      <mixed-citation publication-type="journal"><name><surname>Sboner</surname><given-names>A</given-names></name>, <name><surname>Mu</surname><given-names>XJ</given-names></name>, <name><surname>Greenbaum</surname><given-names>D</given-names></name>, <name><surname>Auerbach</surname><given-names>RK</given-names></name>, <name><surname>Gerstein</surname><given-names>MB</given-names></name>. <article-title>The real cost of sequencing: higher than you think!</article-title><source>Genome Biology</source>. <year>2011</year>;<volume>12</volume>(<issue>8</issue>):<fpage>125</fpage><pub-id pub-id-type="doi">10.1186/gb-2011-12-8-125</pub-id><?supplied-pmid 21867570?><pub-id pub-id-type="pmid">21867570</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1005518.ref002">
      <label>2</label>
      <mixed-citation publication-type="journal"><name><surname>Beerenwinkel</surname><given-names>N</given-names></name>, <name><surname>Zagordi</surname><given-names>O</given-names></name>. <article-title>Ultra-deep sequencing for the analysis of viral populations</article-title>. <source>Current Opinion in Virology</source>. <year>2011</year>;<volume>1</volume>(<issue>5</issue>):<fpage>413</fpage>–<lpage>418</lpage>. <pub-id pub-id-type="doi">10.1016/j.coviro.2011.07.008</pub-id><?supplied-pmid 22440844?><pub-id pub-id-type="pmid">22440844</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1005518.ref003">
      <label>3</label>
      <mixed-citation publication-type="journal"><name><surname>Sogin</surname><given-names>ML</given-names></name>, <name><surname>Morrison</surname><given-names>HG</given-names></name>, <name><surname>Huber</surname><given-names>JA</given-names></name>, <name><surname>Welch</surname><given-names>DM</given-names></name>, <name><surname>Huse</surname><given-names>SM</given-names></name>, <name><surname>Neal</surname><given-names>PR</given-names></name>, <etal>et al</etal><article-title>Microbial diversity in the deep sea and the underexplored “rare biosphere”</article-title>. <source>Proceedings of the National Academy of Sciences</source>. <year>2006</year>;<volume>103</volume>(<issue>32</issue>):<fpage>12115</fpage>–<lpage>12120</lpage>. <pub-id pub-id-type="doi">10.1073/pnas.0605127103</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1005518.ref004">
      <label>4</label>
      <mixed-citation publication-type="journal"><name><surname>O’Brien</surname><given-names>HE</given-names></name>, <name><surname>Parrent</surname><given-names>JL</given-names></name>, <name><surname>Jackson</surname><given-names>JA</given-names></name>, <name><surname>Moncalvo</surname><given-names>JM</given-names></name>, <name><surname>Vilgalys</surname><given-names>R</given-names></name>. <article-title>Fungal community analysis by large-scale sequencing of environmental samples</article-title>. <source>Applied and Environmental Microbiology</source>. <year>2005</year>;<volume>71</volume>(<issue>9</issue>):<fpage>5544</fpage>–<lpage>5550</lpage>. <pub-id pub-id-type="doi">10.1128/AEM.71.9.5544-5550.2005</pub-id><?supplied-pmid 16151147?><pub-id pub-id-type="pmid">16151147</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1005518.ref005">
      <label>5</label>
      <mixed-citation publication-type="journal"><name><surname>López-García</surname><given-names>P</given-names></name>, <name><surname>Rodríguez-Valera</surname><given-names>F</given-names></name>, <name><surname>Pedrós-Alió</surname><given-names>C</given-names></name>, <name><surname>Moreira</surname><given-names>D</given-names></name>. <article-title>Unexpected diversity of small eukaryotes in deep-sea Antarctic plankton</article-title>. <source>Nature</source>. <year>2001</year>;<volume>409</volume>(<issue>6820</issue>):<fpage>603</fpage>–<lpage>607</lpage>. <pub-id pub-id-type="doi">10.1038/35054537</pub-id><?supplied-pmid 11214316?><pub-id pub-id-type="pmid">11214316</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1005518.ref006">
      <label>6</label>
      <mixed-citation publication-type="journal"><name><surname>Kan</surname><given-names>Z</given-names></name>, <name><surname>Jaiswal</surname><given-names>BS</given-names></name>, <name><surname>Stinson</surname><given-names>J</given-names></name>, <name><surname>Janakiraman</surname><given-names>V</given-names></name>, <name><surname>Bhatt</surname><given-names>D</given-names></name>, <name><surname>Stern</surname><given-names>HM</given-names></name>, <etal>et al</etal><article-title>Diverse somatic mutation patterns and pathway alterations in human cancers</article-title>. <source>Nature</source>. <year>2010</year>;<volume>466</volume>(<issue>7308</issue>):<fpage>869</fpage>–<lpage>873</lpage>. <pub-id pub-id-type="doi">10.1038/nature09208</pub-id><?supplied-pmid 20668451?><pub-id pub-id-type="pmid">20668451</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1005518.ref007">
      <label>7</label>
      <mixed-citation publication-type="journal"><name><surname>Boyd</surname><given-names>SD</given-names></name>, <name><surname>Marshall</surname><given-names>EL</given-names></name>, <name><surname>Merker</surname><given-names>JD</given-names></name>, <name><surname>Maniar</surname><given-names>JM</given-names></name>, <name><surname>Zhang</surname><given-names>LN</given-names></name>, <name><surname>Sahaf</surname><given-names>B</given-names></name>, <etal>et al</etal><article-title>Measurement and clinical monitoring of human lymphocyte clonality by massively parallel VDJ pyrosequencing</article-title>. <source>Science Translational Medicine</source>. <year>2009</year>;<volume>1</volume>(<issue>12</issue>):<fpage>12ra23</fpage><pub-id pub-id-type="doi">10.1126/scitranslmed.3000540</pub-id><?supplied-pmid 20161664?><pub-id pub-id-type="pmid">20161664</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1005518.ref008">
      <label>8</label>
      <mixed-citation publication-type="journal"><collab>Editorial</collab>. <article-title>Your Microbes, Your Health</article-title>. <source>Science</source>. <year>2013</year>;<volume>342</volume>(<issue>6165</issue>):<fpage>1440</fpage>–<lpage>1441</lpage>. <pub-id pub-id-type="doi">10.1126/science.342.6165.1440-b</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1005518.ref009">
      <label>9</label>
      <mixed-citation publication-type="journal"><name><surname>Di Bella</surname><given-names>JM</given-names></name>, <name><surname>Bao</surname><given-names>Y</given-names></name>, <name><surname>Gloor</surname><given-names>GB</given-names></name>, <name><surname>Burton</surname><given-names>JP</given-names></name>, <name><surname>Reid</surname><given-names>G</given-names></name>. <article-title>High throughput sequencing methods and analysis for microbiome research</article-title>. <source>Journal of Microbiological Methods</source>. <year>2013</year>;<volume>95</volume>(<issue>3</issue>):<fpage>401</fpage>–<lpage>414</lpage>. <pub-id pub-id-type="doi">10.1016/j.mimet.2013.08.011</pub-id><?supplied-pmid 24029734?><pub-id pub-id-type="pmid">24029734</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1005518.ref010">
      <label>10</label>
      <mixed-citation publication-type="journal"><name><surname>Mande</surname><given-names>SS</given-names></name>, <name><surname>Mohammed</surname><given-names>MH</given-names></name>, <name><surname>Ghosh</surname><given-names>TS</given-names></name>. <article-title>Classification of metagenomic sequences: methods and challenges</article-title>. <source>Briefings in Bioinformatics</source>. <year>2012</year>;<volume>13</volume>(<issue>6</issue>):<fpage>669</fpage>–<lpage>681</lpage>. <pub-id pub-id-type="doi">10.1093/bib/bbs054</pub-id><?supplied-pmid 22962338?><pub-id pub-id-type="pmid">22962338</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1005518.ref011">
      <label>11</label>
      <mixed-citation publication-type="journal"><name><surname>Dröge</surname><given-names>J</given-names></name>, <name><surname>McHardy</surname><given-names>AC</given-names></name>. <article-title>Taxonomic binning of metagenome samples generated by next-generation sequencing technologies</article-title>. <source>Briefings in Bioinformatics</source>. <year>2012</year>;<volume>13</volume>(<issue>6</issue>):<fpage>646</fpage>–<lpage>655</lpage>. <pub-id pub-id-type="doi">10.1093/bib/bbs031</pub-id><?supplied-pmid 22851513?><pub-id pub-id-type="pmid">22851513</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1005518.ref012">
      <label>12</label>
      <mixed-citation publication-type="journal"><name><surname>Li</surname><given-names>W</given-names></name>, <name><surname>Godzik</surname><given-names>A</given-names></name>. <article-title>Cd-hit: a fast program for clustering and comparing large sets of protein or nucleotide sequences</article-title>. <source>Bioinformatics</source>. <year>2006</year>;<volume>22</volume>(<issue>13</issue>):<fpage>1658</fpage>–<lpage>1659</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/btl158</pub-id><?supplied-pmid 16731699?><pub-id pub-id-type="pmid">16731699</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1005518.ref013">
      <label>13</label>
      <mixed-citation publication-type="journal"><name><surname>Edgar</surname><given-names>RC</given-names></name>. <article-title>Search and clustering orders of magnitude faster than BLAST</article-title>. <source>Bioinformatics</source>. <year>2010</year>;<volume>26</volume>(<issue>19</issue>):<fpage>2460</fpage>–<lpage>1</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/btq461</pub-id><?supplied-pmid 20709691?><pub-id pub-id-type="pmid">20709691</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1005518.ref014">
      <label>14</label>
      <mixed-citation publication-type="journal"><name><surname>Sun</surname><given-names>Y</given-names></name>, <name><surname>Cai</surname><given-names>Y</given-names></name>, <name><surname>Huse</surname><given-names>SM</given-names></name>, <name><surname>Knight</surname><given-names>R</given-names></name>, <name><surname>Farmeric</surname><given-names>WG</given-names></name>, <name><surname>Wang</surname><given-names>X</given-names></name>, <etal>et al</etal><article-title>A large-scale benchmark study of existing algorithms for taxonomy-independnet microbial community analysis</article-title>. <source>Briefings in Bioinformatics</source>. <year>2011</year>;<volume>13</volume>(<issue>1</issue>):<fpage>107</fpage>–<lpage>121</lpage>. <pub-id pub-id-type="doi">10.1093/bib/bbr009</pub-id><?supplied-pmid 21525143?><pub-id pub-id-type="pmid">21525143</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1005518.ref015">
      <label>15</label>
      <mixed-citation publication-type="journal"><name><surname>Chen</surname><given-names>W</given-names></name>, <name><surname>Cheng</surname><given-names>Y</given-names></name>, <name><surname>Zhang</surname><given-names>C</given-names></name>, <name><surname>Zhang</surname><given-names>S</given-names></name>, <name><surname>Zhao</surname><given-names>H</given-names></name>. <article-title>MSClust: A multi-seeds based clustering algorithm for microbiome profiling using 16S rRNA sequences</article-title>. <source>Journal of Microbiological Methods</source>. <year>2013</year>;<volume>94</volume>(<issue>3</issue>):<fpage>347</fpage>–<lpage>355</lpage>. <pub-id pub-id-type="doi">10.1016/j.mimet.2013.07.004</pub-id><?supplied-pmid 23899776?><pub-id pub-id-type="pmid">23899776</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1005518.ref016">
      <label>16</label>
      <mixed-citation publication-type="journal"><name><surname>Bonder</surname><given-names>MJ</given-names></name>, <name><surname>Abeln</surname><given-names>S</given-names></name>, <name><surname>Zaura</surname><given-names>E</given-names></name>, <name><surname>Brandt</surname><given-names>BW</given-names></name>. <article-title>Comparing clustering and pre-processing in taxonomy analysis</article-title>. <source>Bioinformatics</source>. <year>2012</year>;<volume>28</volume>(<issue>22</issue>):<fpage>2891</fpage>–<lpage>2897</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/bts552</pub-id><?supplied-pmid 22962346?><pub-id pub-id-type="pmid">22962346</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1005518.ref017">
      <label>17</label>
      <mixed-citation publication-type="journal"><name><surname>Peterson</surname><given-names>J</given-names></name>, <name><surname>Garges</surname><given-names>S</given-names></name>, <name><surname>Giovanni</surname><given-names>M</given-names></name>, <name><surname>Mclnnes</surname><given-names>P</given-names></name>, <name><surname>Wang</surname><given-names>L</given-names></name>, <name><surname>Schloss</surname><given-names>JA</given-names></name>, <etal>et al</etal><article-title>The NIH Human Microbiome Project</article-title>. <source>Genome Research</source>. <year>2009</year>;<volume>19</volume>(<issue>12</issue>):<fpage>2317</fpage>–<lpage>2323</lpage>. <pub-id pub-id-type="doi">10.1101/gr.096651.109</pub-id><?supplied-pmid 19819907?><pub-id pub-id-type="pmid">19819907</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1005518.ref018">
      <label>18</label>
      <mixed-citation publication-type="journal"><name><surname>Cai</surname><given-names>Y</given-names></name>, <name><surname>Sun</surname><given-names>Y</given-names></name>. <article-title>ESPRIT-Tree: Hierarchical clustering analysis of millions of 16S rRNA Pyrosequences in quasilinear computational time</article-title>. <source>Nuclear Acids Research</source>. <year>2011</year>;<volume>39</volume>(<issue>14</issue>):<fpage>e95</fpage><pub-id pub-id-type="doi">10.1093/nar/gkr349</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1005518.ref019">
      <label>19</label>
      <mixed-citation publication-type="journal"><name><surname>Wang</surname><given-names>X</given-names></name>, <name><surname>Cai</surname><given-names>Y</given-names></name>, <name><surname>Sun</surname><given-names>Y</given-names></name>, <name><surname>Knight</surname><given-names>R</given-names></name>, <name><surname>Mai</surname><given-names>V</given-names></name>. <article-title>Secondary structure information does not improve OTU assignment for partial 16S rRNA sequences</article-title>. <source>The ISME Journal</source>. <year>2012</year>;<volume>6</volume>(<issue>7</issue>):<fpage>1277</fpage><pub-id pub-id-type="doi">10.1038/ismej.2011.187</pub-id><?supplied-pmid 22170430?><pub-id pub-id-type="pmid">22170430</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1005518.ref020">
      <label>20</label>
      <mixed-citation publication-type="journal"><name><surname>Barriuso</surname><given-names>J</given-names></name>, <name><surname>Valverde</surname><given-names>JR</given-names></name>, <name><surname>Mellado</surname><given-names>RP</given-names></name>. <article-title>Estimation of bacterial diversity using next generation sequencing of 16S rDNA: a comparison of different workflows</article-title>. <source>BMC Bioinformatics</source>. <year>2011</year>;<volume>12</volume>(<issue>1</issue>):<fpage>473</fpage><pub-id pub-id-type="doi">10.1186/1471-2105-12-473</pub-id><?supplied-pmid 22168258?><pub-id pub-id-type="pmid">22168258</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1005518.ref021">
      <label>21</label>
      <mixed-citation publication-type="journal"><name><surname>Olson</surname><given-names>CF</given-names></name>. <article-title>Parallel algorithms for hierarchical clustering</article-title>. <source>Parallel Computing</source>. <year>1995</year>;<volume>21</volume>(<issue>8</issue>):<fpage>1313</fpage>–<lpage>1325</lpage>. <pub-id pub-id-type="doi">10.1016/0167-8191(95)00017-I</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1005518.ref022">
      <label>22</label>
      <mixed-citation publication-type="book"><name><surname>Dash</surname><given-names>M</given-names></name>, <name><surname>Petrutiu</surname><given-names>S</given-names></name>, <name><surname>Scheuermann</surname><given-names>P</given-names></name>. <chapter-title>Efficient parallel hierarchical clustering</chapter-title> In: <source>Euro-Par 2004 Parallel Processing</source>. <publisher-name>Springer</publisher-name>; <year>2004</year> p. <fpage>363</fpage>–<lpage>371</lpage>.</mixed-citation>
    </ref>
    <ref id="pcbi.1005518.ref023">
      <label>23</label>
      <mixed-citation publication-type="journal"><name><surname>Feng</surname><given-names>Z</given-names></name>, <name><surname>Zhou</surname><given-names>B</given-names></name>, <name><surname>Shen</surname><given-names>J</given-names></name>. <article-title>A parallel hierarchical clustering algorithm for PCs cluster system</article-title>. <source>Neurocomputing</source>. <year>2007</year>;<volume>70</volume>(<issue>4</issue>):<fpage>809</fpage>–<lpage>818</lpage>. <pub-id pub-id-type="doi">10.1016/j.neucom.2006.10.034</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1005518.ref024">
      <label>24</label>
      <mixed-citation publication-type="journal"><name><surname>Rodrigues</surname><given-names>JFM</given-names></name>, <name><surname>von Mering</surname><given-names>C</given-names></name>. <article-title>HPC-CLUST: distributed hierarchical clustering for large sets of nucleotide sequences</article-title>. <source>Bioinformatics</source>. <year>2014</year>;<volume>30</volume>(<issue>2</issue>):<fpage>287</fpage>–<lpage>288</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/btt657</pub-id><pub-id pub-id-type="pmid">24215029</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1005518.ref025">
      <label>25</label>
      <mixed-citation publication-type="journal"><name><surname>Sun</surname><given-names>Y</given-names></name>, <name><surname>Cai</surname><given-names>Y</given-names></name>, <name><surname>Liu</surname><given-names>L</given-names></name>, <name><surname>Yu</surname><given-names>F</given-names></name>, <name><surname>Farrell</surname><given-names>ML</given-names></name>, <name><surname>McKendree</surname><given-names>W</given-names></name>, <etal>et al</etal><article-title>ESPRIT: estimating species richness using large collections of 16S rRNA pyrosequences</article-title>. <source>Nuclear Acids Research</source>. <year>2009</year>;<volume>37</volume>(<issue>10</issue>):<fpage>e76</fpage><pub-id pub-id-type="doi">10.1093/nar/gkp285</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1005518.ref026">
      <label>26</label>
      <mixed-citation publication-type="journal"><name><surname>Nguyen</surname><given-names>TD</given-names></name>, <name><surname>Schmidt</surname><given-names>B</given-names></name>, <name><surname>Zheng</surname><given-names>Z</given-names></name>, <name><surname>Kwoh</surname><given-names>CF</given-names></name>. <article-title>Efficient and Accurate OTU Clustering with GPU-Based Sequence Alignment and Dynamic Dendrogram Cutting</article-title>. <source>IEEE/ACM Transactions on Computational Biology and Bioinformatics</source>. <year>2015</year>;<volume>12</volume>:<fpage>1060</fpage>–<lpage>1073</lpage>. <pub-id pub-id-type="doi">10.1109/TCBB.2015.2407574</pub-id><?supplied-pmid 26451819?><pub-id pub-id-type="pmid">26451819</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1005518.ref027">
      <label>27</label>
      <mixed-citation publication-type="other">Mao Q, Zheng W, Wang L, Cai Y, Mai V, Sun Y. Parallel Hierarchical Clustering in Linearithmic Time for Large-Scale Sequence Analysis. In: 2015 IEEE International Conference on Data Mining; 2015. p. 310–319.</mixed-citation>
    </ref>
    <ref id="pcbi.1005518.ref028">
      <label>28</label>
      <mixed-citation publication-type="journal"><name><surname>Edgar</surname><given-names>RC</given-names></name>. <article-title>MUSCLE: multiple sequence alignment with high accuracy and high throughput</article-title>. <source>Nucleic Acids Research</source>. <year>2004</year>;<volume>32</volume>(<issue>5</issue>):<fpage>1792</fpage>–<lpage>1797</lpage>. <pub-id pub-id-type="doi">10.1093/nar/gkh340</pub-id><?supplied-pmid 15034147?><pub-id pub-id-type="pmid">15034147</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1005518.ref029">
      <label>29</label>
      <mixed-citation publication-type="journal"><name><surname>Katoh</surname><given-names>K</given-names></name>, <name><surname>Misawa</surname><given-names>K</given-names></name>, <name><surname>Kuma</surname><given-names>K</given-names></name>, <name><surname>Miyata</surname><given-names>T</given-names></name>. <article-title>MAFFT: a novel method for rapid multiple sequence alignment based on fast Fourier transform</article-title>. <source>Nucleic Acids Research</source>. <year>2002</year>;<volume>30</volume>(<issue>14</issue>):<fpage>3059</fpage>–<lpage>3066</lpage>. <pub-id pub-id-type="doi">10.1093/nar/gkf436</pub-id><?supplied-pmid 12136088?><pub-id pub-id-type="pmid">12136088</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1005518.ref030">
      <label>30</label>
      <mixed-citation publication-type="journal"><name><surname>Price</surname><given-names>MN</given-names></name>, <name><surname>Dehal</surname><given-names>PS</given-names></name>, <name><surname>Arkin</surname><given-names>AP</given-names></name>. <article-title>FastTree 2–approximately maximum-likelihood trees for large alignments</article-title>. <source>PLoS ONE</source>. <year>2010</year>;<volume>5</volume>(<issue>3</issue>):<fpage>e9490</fpage><pub-id pub-id-type="doi">10.1371/journal.pone.0009490</pub-id><?supplied-pmid 20224823?><pub-id pub-id-type="pmid">20224823</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1005518.ref031">
      <label>31</label>
      <mixed-citation publication-type="journal"><name><surname>Howe</surname><given-names>K</given-names></name>, <name><surname>Bateman</surname><given-names>A</given-names></name>, <name><surname>Durbin</surname><given-names>R</given-names></name>. <article-title>QuickTree: building huge Neighbour-Joining trees of protein sequences</article-title>. <source>Bioinformatics</source>. <year>2002</year>;<volume>18</volume>(<issue>11</issue>):<fpage>1546</fpage>–<lpage>1547</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/18.11.1546</pub-id><?supplied-pmid 12424131?><pub-id pub-id-type="pmid">12424131</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1005518.ref032">
      <label>32</label>
      <mixed-citation publication-type="book"><name><surname>Quinn</surname><given-names>MJ</given-names></name>. <source>Parallel Programming in C with MPI and OpenMP</source>. <publisher-loc>Boston</publisher-loc>: <publisher-name>McGraw-Hill</publisher-name>; <year>2004</year>.</mixed-citation>
    </ref>
    <ref id="pcbi.1005518.ref033">
      <label>33</label>
      <mixed-citation publication-type="book"><name><surname>Skiena</surname><given-names>S</given-names></name>. <source>The Algorithm Design Manual</source>. <publisher-name>Springer</publisher-name>; <year>2008</year>.</mixed-citation>
    </ref>
    <ref id="pcbi.1005518.ref034">
      <label>34</label>
      <mixed-citation publication-type="journal"><name><surname>Edgar</surname><given-names>RC</given-names></name>, <name><surname>Haas</surname><given-names>BJ</given-names></name>, <name><surname>Clemente</surname><given-names>JC</given-names></name>, <name><surname>Quince</surname><given-names>C</given-names></name>, <name><surname>Knight</surname><given-names>R</given-names></name>. <article-title>UCHIME improves sensitivity and speed of chimera detection</article-title>. <source>Bioinformatics</source>. <year>2011</year>;<volume>27</volume>(<issue>16</issue>):<fpage>2194</fpage>–<lpage>2200</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/btr381</pub-id><?supplied-pmid 21700674?><pub-id pub-id-type="pmid">21700674</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1005518.ref035">
      <label>35</label>
      <mixed-citation publication-type="journal"><name><surname>Edgar</surname><given-names>RC</given-names></name>. <article-title>UPARSE: Highly accurate OTU sequences from microbial amplicon reads</article-title>. <source>Nature Methods</source>. <year>2013</year>;<volume>10</volume>:<fpage>996</fpage>–<lpage>998</lpage>. <pub-id pub-id-type="doi">10.1038/nmeth.2604</pub-id><?supplied-pmid 23955772?><pub-id pub-id-type="pmid">23955772</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1005518.ref036">
      <label>36</label>
      <mixed-citation publication-type="journal"><name><surname>Turnbaugh</surname><given-names>PJ</given-names></name>, <name><surname>Hamady</surname><given-names>M</given-names></name>, <name><surname>Yatsunenko</surname><given-names>T</given-names></name>, <name><surname>Cantarel</surname><given-names>BL</given-names></name>, <name><surname>Duncan</surname><given-names>A</given-names></name>, <name><surname>Ley</surname><given-names>RE</given-names></name>, <etal>et al</etal><article-title>A core gut microbiome in obese and lean twins</article-title>. <source>Nature</source>. <year>2008</year>;<volume>457</volume>(<issue>7228</issue>):<fpage>480</fpage>–<lpage>484</lpage>. <pub-id pub-id-type="doi">10.1038/nature07540</pub-id><?supplied-pmid 19043404?><pub-id pub-id-type="pmid">19043404</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1005518.ref037">
      <label>37</label>
      <mixed-citation publication-type="journal"><name><surname>Ye</surname><given-names>J</given-names></name>, <name><surname>McGinnis</surname><given-names>S</given-names></name>, <name><surname>Madden</surname><given-names>TL</given-names></name>. <article-title>BLAST: improvements for better sequence analysis</article-title>. <source>Nucleic acids research</source>. <year>2006</year>;<volume>34</volume>(<issue>suppl 2</issue>):<fpage>W6</fpage>–<lpage>W9</lpage>. <pub-id pub-id-type="doi">10.1093/nar/gkl164</pub-id><?supplied-pmid 16845079?><pub-id pub-id-type="pmid">16845079</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1005518.ref038">
      <label>38</label>
      <mixed-citation publication-type="journal"><name><surname>Cole</surname><given-names>JR</given-names></name>, <name><surname>Chai</surname><given-names>B</given-names></name>, <name><surname>Farris</surname><given-names>RJ</given-names></name>, <name><surname>Wang</surname><given-names>Q</given-names></name>, <name><surname>Kulam</surname><given-names>S</given-names></name>, <name><surname>McGarrell</surname><given-names>DM</given-names></name>, <etal>et al</etal><article-title>The Ribosomal Database Project (RDP-II): sequences and tools for high-throughput rRNA analysis</article-title>. <source>Nucleic acids research</source>. <year>2005</year>;<volume>33</volume>(<issue>suppl 1</issue>):<fpage>D294</fpage>–<lpage>D296</lpage>. <pub-id pub-id-type="doi">10.1093/nar/gki038</pub-id><?supplied-pmid 15608200?><pub-id pub-id-type="pmid">15608200</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1005518.ref039">
      <label>39</label>
      <mixed-citation publication-type="journal"><name><surname>Giongo</surname><given-names>A</given-names></name>, <name><surname>Davis-Richardson</surname><given-names>AG</given-names></name>, <name><surname>Crabb</surname><given-names>DB</given-names></name>, <name><surname>Triplett</surname><given-names>EW</given-names></name>. <article-title>TaxCollector: modifying current 16S rRNA databases for the rapid classification at six taxonomic levels</article-title>. <source>Diversity</source>. <year>2010</year>;<volume>2</volume>(<issue>7</issue>):<fpage>1015</fpage>–<lpage>1025</lpage>. <pub-id pub-id-type="doi">10.3390/d2071015</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1005518.ref040">
      <label>40</label>
      <mixed-citation publication-type="journal"><name><surname>Claesson</surname><given-names>MJ</given-names></name>, <name><surname>Cusack</surname><given-names>S</given-names></name>, <name><surname>O’Sullivan</surname><given-names>O</given-names></name>, <name><surname>Greene-Diniz</surname><given-names>R</given-names></name>, <name><surname>de Weerd</surname><given-names>H</given-names></name>, <name><surname>Flannery</surname><given-names>E</given-names></name>, <etal>et al</etal><article-title>Composition, variability, and temporal stability of the intestinal microbiota of the elderly</article-title>. <source>Proceedings of the National Academy of Sciences</source>. <year>2011</year>;<volume>108</volume>(<issue>1</issue>):<fpage>4586</fpage>–<lpage>4591</lpage>. <pub-id pub-id-type="doi">10.1073/pnas.1000097107</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1005518.ref041">
      <label>41</label>
      <mixed-citation publication-type="journal"><collab>Human Microbiome Project Consortium</collab>. <article-title>Structure, function and diversity of the healthy human microbiome</article-title>. <source>Nature</source>. <year>2012</year>;<volume>486</volume>(<issue>7402</issue>):<fpage>207</fpage>–<lpage>214</lpage>. <pub-id pub-id-type="doi">10.1038/nature11234</pub-id><?supplied-pmid 22699609?><pub-id pub-id-type="pmid">22699609</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1005518.ref042">
      <label>42</label>
      <mixed-citation publication-type="journal"><name><surname>Ding</surname><given-names>T</given-names></name>, <name><surname>Schloss</surname><given-names>PD</given-names></name>. <article-title>Dynamics and associations of microbial community types across the human body</article-title>. <source>Nature</source>. <year>2014</year>;<volume>509</volume>(<issue>7500</issue>):<fpage>357</fpage>–<lpage>360</lpage>. <pub-id pub-id-type="doi">10.1038/nature13178</pub-id><?supplied-pmid 24739969?><pub-id pub-id-type="pmid">24739969</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1005518.ref043">
      <label>43</label>
      <mixed-citation publication-type="journal"><name><surname>Koeppel</surname><given-names>AF</given-names></name>, <name><surname>Wu</surname><given-names>M</given-names></name>. <article-title>Surprisingly extensive mixed phylogenetic and ecological signals among bacterial Operational Taxonomic Units</article-title>. <source>Nucleic acids research</source>. <year>2013</year>; p. <fpage>gkt241</fpage>.</mixed-citation>
    </ref>
    <ref id="pcbi.1005518.ref044">
      <label>44</label>
      <mixed-citation publication-type="journal"><name><surname>Westcott</surname><given-names>SL</given-names></name>, <name><surname>Schloss</surname><given-names>PD</given-names></name>. <article-title>De novo clustering methods outperform reference-based methods for assigning 16S rRNA gene sequences to operational taxonomic units</article-title>. <source>PeerJ</source>. <year>2015</year>;<volume>3</volume>:<fpage>e1487</fpage><pub-id pub-id-type="doi">10.7717/peerj.1487</pub-id><?supplied-pmid 26664811?><pub-id pub-id-type="pmid">26664811</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1005518.ref045">
      <label>45</label>
      <mixed-citation publication-type="journal"><name><surname>May</surname><given-names>A</given-names></name>, <name><surname>Abeln</surname><given-names>S</given-names></name>, <name><surname>Crielaard</surname><given-names>W</given-names></name>, <name><surname>Heringa</surname><given-names>J</given-names></name>, <name><surname>Brandt</surname><given-names>BW</given-names></name>. <article-title>Unraveling the outcome of 16S rDNA-based taxonomy analysis through mock data and simulations</article-title>. <source>Bioinformatics</source>. <year>2014</year>;<volume>30</volume>(<issue>11</issue>):<fpage>1530</fpage>–<lpage>1538</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/btu085</pub-id><?supplied-pmid 24519382?><pub-id pub-id-type="pmid">24519382</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1005518.ref046">
      <label>46</label>
      <mixed-citation publication-type="journal"><name><surname>Flynn</surname><given-names>JM</given-names></name>, <name><surname>Brown</surname><given-names>EA</given-names></name>, <name><surname>Chain</surname><given-names>FJ</given-names></name>, <name><surname>MacIsaac</surname><given-names>HJ</given-names></name>, <name><surname>Cristescu</surname><given-names>ME</given-names></name>. <article-title>Toward accurate molecular identification of species in complex environmental samples: testing the performance of sequence filtering and clustering methods</article-title>. <source>Ecology and evolution</source>. <year>2015</year>;<volume>5</volume>(<issue>11</issue>):<fpage>2252</fpage>–<lpage>2266</lpage>. <pub-id pub-id-type="doi">10.1002/ece3.1497</pub-id><?supplied-pmid 26078860?><pub-id pub-id-type="pmid">26078860</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1005518.ref047">
      <label>47</label>
      <mixed-citation publication-type="journal"><name><surname>White</surname><given-names>JR</given-names></name>, <name><surname>Navlakha</surname><given-names>S</given-names></name>, <name><surname>Nagarajan</surname><given-names>N</given-names></name>, <name><surname>Ghodsi</surname><given-names>MR</given-names></name>, <name><surname>Kingsford</surname><given-names>C</given-names></name>, <name><surname>Pop</surname><given-names>M</given-names></name>. <article-title>Alignment and clustering of phylogenetic markers-implications for microbial diversity studies</article-title>. <source>BMC bioinformatics</source>. <year>2010</year>;<volume>11</volume>(<issue>1</issue>):<fpage>1</fpage><pub-id pub-id-type="doi">10.1186/1471-2105-11-152</pub-id><pub-id pub-id-type="pmid">20043860</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1005518.ref048">
      <label>48</label>
      <mixed-citation publication-type="journal"><name><surname>Wang</surname><given-names>X</given-names></name>, <name><surname>Yao</surname><given-names>J</given-names></name>, <name><surname>Sun</surname><given-names>Y</given-names></name>, <name><surname>Mai</surname><given-names>V</given-names></name>. <article-title>M-pick, a modularity-based method for OTU picking of 16S rRNA sequences</article-title>. <source>BMC bioinformatics</source>. <year>2013</year>;<volume>14</volume>(<issue>1</issue>):<fpage>1</fpage><pub-id pub-id-type="doi">10.1186/1471-2105-14-43</pub-id><pub-id pub-id-type="pmid">23323762</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1005518.ref049">
      <label>49</label>
      <mixed-citation publication-type="journal"><name><surname>Lozupone</surname><given-names>C</given-names></name>, <name><surname>Knight</surname><given-names>R</given-names></name>. <article-title>UniFrac: a new phylogenetic method for comparing microbial communities</article-title>. <source>Applied and environmental microbiology</source>. <year>2005</year>;<volume>71</volume>(<issue>12</issue>):<fpage>8228</fpage>–<lpage>8235</lpage>. <pub-id pub-id-type="doi">10.1128/AEM.71.12.8228-8235.2005</pub-id><?supplied-pmid 16332807?><pub-id pub-id-type="pmid">16332807</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1005518.ref050">
      <label>50</label>
      <mixed-citation publication-type="journal"><name><surname>Corpet</surname><given-names>F</given-names></name>. <article-title>Multiple sequence alignment with hierarchical clustering</article-title>. <source>Nucleic acids research</source>. <year>1988</year>;<volume>16</volume>(<issue>22</issue>):<fpage>10881</fpage>–<lpage>10890</lpage>. <pub-id pub-id-type="doi">10.1093/nar/16.22.10881</pub-id><?supplied-pmid 2849754?><pub-id pub-id-type="pmid">2849754</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1005518.ref051">
      <label>51</label>
      <mixed-citation publication-type="journal"><name><surname>Krause</surname><given-names>A</given-names></name>, <name><surname>Stoye</surname><given-names>J</given-names></name>, <name><surname>Vingron</surname><given-names>M</given-names></name>. <article-title>Large scale hierarchical clustering of protein sequences</article-title>. <source>BMC bioinformatics</source>. <year>2005</year>;<volume>6</volume>(<issue>1</issue>):<fpage>1</fpage><pub-id pub-id-type="doi">10.1186/1471-2105-6-15</pub-id><pub-id pub-id-type="pmid">15631638</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
