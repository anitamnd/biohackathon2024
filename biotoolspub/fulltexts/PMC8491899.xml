<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d3 20150301//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 39.96?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
    <journal-id journal-id-type="iso-abbrev">PLoS Comput Biol</journal-id>
    <journal-id journal-id-type="publisher-id">plos</journal-id>
    <journal-title-group>
      <journal-title>PLoS Computational Biology</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1553-734X</issn>
    <issn pub-type="epub">1553-7358</issn>
    <publisher>
      <publisher-name>Public Library of Science</publisher-name>
      <publisher-loc>San Francisco, CA USA</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">8491899</article-id>
    <article-id pub-id-type="pmid">34516542</article-id>
    <article-id pub-id-type="doi">10.1371/journal.pcbi.1008913</article-id>
    <article-id pub-id-type="publisher-id">PCOMPBIOL-D-21-00544</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research Article</subject>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Ecology</subject>
          <subj-group>
            <subject>Community Ecology</subject>
            <subj-group>
              <subject>Community Structure</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Ecology and Environmental Sciences</subject>
        <subj-group>
          <subject>Ecology</subject>
          <subj-group>
            <subject>Community Ecology</subject>
            <subj-group>
              <subject>Community Structure</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Microbiology</subject>
          <subj-group>
            <subject>Medical Microbiology</subject>
            <subj-group>
              <subject>Microbiome</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Genetics</subject>
          <subj-group>
            <subject>Genomics</subject>
            <subj-group>
              <subject>Microbial Genomics</subject>
              <subj-group>
                <subject>Microbiome</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Microbiology</subject>
          <subj-group>
            <subject>Microbial Genomics</subject>
            <subj-group>
              <subject>Microbiome</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and Analysis Methods</subject>
        <subj-group>
          <subject>Simulation and Modeling</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Nutrition</subject>
          <subj-group>
            <subject>Diet</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Medicine and Health Sciences</subject>
        <subj-group>
          <subject>Nutrition</subject>
          <subj-group>
            <subject>Diet</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Ecology</subject>
          <subj-group>
            <subject>Community Ecology</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Ecology and Environmental Sciences</subject>
        <subj-group>
          <subject>Ecology</subject>
          <subj-group>
            <subject>Community Ecology</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Ecology</subject>
          <subj-group>
            <subject>Microbial Ecology</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Ecology and Environmental Sciences</subject>
        <subj-group>
          <subject>Ecology</subject>
          <subj-group>
            <subject>Microbial Ecology</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Microbiology</subject>
          <subj-group>
            <subject>Microbial Ecology</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Plant Science</subject>
          <subj-group>
            <subject>Plant Anatomy</subject>
            <subj-group>
              <subject>Tubers</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Computer and Information Sciences</subject>
        <subj-group>
          <subject>Data Management</subject>
          <subj-group>
            <subject>Metadata</subject>
          </subj-group>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>A statistical model for describing and simulating microbial community profiles</article-title>
      <alt-title alt-title-type="running-head">A simulation model for microbial community profiles</alt-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0003-2313-6448</contrib-id>
        <name>
          <surname>Ma</surname>
          <given-names>Siyuan</given-names>
        </name>
        <role content-type="https://casrai.org/credit/">Conceptualization</role>
        <role content-type="https://casrai.org/credit/">Formal analysis</role>
        <role content-type="https://casrai.org/credit/">Investigation</role>
        <role content-type="https://casrai.org/credit/">Methodology</role>
        <role content-type="https://casrai.org/credit/">Software</role>
        <role content-type="https://casrai.org/credit/">Validation</role>
        <role content-type="https://casrai.org/credit/">Visualization</role>
        <role content-type="https://casrai.org/credit/">Writing – original draft</role>
        <role content-type="https://casrai.org/credit/">Writing – review &amp; editing</role>
        <xref rid="aff001" ref-type="aff">
          <sup>1</sup>
        </xref>
        <xref rid="aff002" ref-type="aff">
          <sup>2</sup>
        </xref>
        <xref rid="aff003" ref-type="aff">
          <sup>3</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-5300-1184</contrib-id>
        <name>
          <surname>Ren</surname>
          <given-names>Boyu</given-names>
        </name>
        <role content-type="https://casrai.org/credit/">Conceptualization</role>
        <role content-type="https://casrai.org/credit/">Formal analysis</role>
        <role content-type="https://casrai.org/credit/">Methodology</role>
        <role content-type="https://casrai.org/credit/">Software</role>
        <role content-type="https://casrai.org/credit/">Writing – original draft</role>
        <xref rid="aff002" ref-type="aff">
          <sup>2</sup>
        </xref>
        <xref rid="aff003" ref-type="aff">
          <sup>3</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0003-4956-2429</contrib-id>
        <name>
          <surname>Mallick</surname>
          <given-names>Himel</given-names>
        </name>
        <role content-type="https://casrai.org/credit/">Investigation</role>
        <role content-type="https://casrai.org/credit/">Methodology</role>
        <role content-type="https://casrai.org/credit/">Software</role>
        <role content-type="https://casrai.org/credit/">Supervision</role>
        <role content-type="https://casrai.org/credit/">Validation</role>
        <xref rid="aff002" ref-type="aff">
          <sup>2</sup>
        </xref>
        <xref rid="aff003" ref-type="aff">
          <sup>3</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0003-3550-4607</contrib-id>
        <name>
          <surname>Moon</surname>
          <given-names>Yo Sup</given-names>
        </name>
        <role content-type="https://casrai.org/credit/">Software</role>
        <xref rid="aff002" ref-type="aff">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-7385-8994</contrib-id>
        <name>
          <surname>Schwager</surname>
          <given-names>Emma</given-names>
        </name>
        <role content-type="https://casrai.org/credit/">Methodology</role>
        <role content-type="https://casrai.org/credit/">Validation</role>
        <xref rid="aff002" ref-type="aff">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0001-8369-2804</contrib-id>
        <name>
          <surname>Maharjan</surname>
          <given-names>Sagun</given-names>
        </name>
        <role content-type="https://casrai.org/credit/">Resources</role>
        <role content-type="https://casrai.org/credit/">Software</role>
        <xref rid="aff001" ref-type="aff">
          <sup>1</sup>
        </xref>
        <xref rid="aff002" ref-type="aff">
          <sup>2</sup>
        </xref>
        <xref rid="aff003" ref-type="aff">
          <sup>3</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-6592-6272</contrib-id>
        <name>
          <surname>Tickle</surname>
          <given-names>Timothy L.</given-names>
        </name>
        <role content-type="https://casrai.org/credit/">Methodology</role>
        <role content-type="https://casrai.org/credit/">Software</role>
        <xref rid="aff002" ref-type="aff">
          <sup>2</sup>
        </xref>
        <xref rid="aff003" ref-type="aff">
          <sup>3</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Lu</surname>
          <given-names>Yiren</given-names>
        </name>
        <role content-type="https://casrai.org/credit/">Investigation</role>
        <role content-type="https://casrai.org/credit/">Validation</role>
        <xref rid="aff002" ref-type="aff">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0001-7505-9646</contrib-id>
        <name>
          <surname>Carmody</surname>
          <given-names>Rachel N.</given-names>
        </name>
        <role content-type="https://casrai.org/credit/">Data curation</role>
        <role content-type="https://casrai.org/credit/">Writing – review &amp; editing</role>
        <xref rid="aff004" ref-type="aff">
          <sup>4</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-8798-7068</contrib-id>
        <name>
          <surname>Franzosa</surname>
          <given-names>Eric A.</given-names>
        </name>
        <role content-type="https://casrai.org/credit/">Conceptualization</role>
        <role content-type="https://casrai.org/credit/">Methodology</role>
        <role content-type="https://casrai.org/credit/">Supervision</role>
        <role content-type="https://casrai.org/credit/">Writing – review &amp; editing</role>
        <xref rid="aff001" ref-type="aff">
          <sup>1</sup>
        </xref>
        <xref rid="aff002" ref-type="aff">
          <sup>2</sup>
        </xref>
        <xref rid="aff003" ref-type="aff">
          <sup>3</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Janson</surname>
          <given-names>Lucas</given-names>
        </name>
        <role content-type="https://casrai.org/credit/">Methodology</role>
        <role content-type="https://casrai.org/credit/">Writing – review &amp; editing</role>
        <xref rid="aff005" ref-type="aff">
          <sup>5</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Huttenhower</surname>
          <given-names>Curtis</given-names>
        </name>
        <role content-type="https://casrai.org/credit/">Conceptualization</role>
        <role content-type="https://casrai.org/credit/">Funding acquisition</role>
        <role content-type="https://casrai.org/credit/">Investigation</role>
        <role content-type="https://casrai.org/credit/">Methodology</role>
        <role content-type="https://casrai.org/credit/">Supervision</role>
        <role content-type="https://casrai.org/credit/">Writing – review &amp; editing</role>
        <xref rid="aff001" ref-type="aff">
          <sup>1</sup>
        </xref>
        <xref rid="aff002" ref-type="aff">
          <sup>2</sup>
        </xref>
        <xref rid="aff003" ref-type="aff">
          <sup>3</sup>
        </xref>
        <xref rid="aff006" ref-type="aff">
          <sup>6</sup>
        </xref>
        <xref rid="cor001" ref-type="corresp">*</xref>
      </contrib>
    </contrib-group>
    <aff id="aff001">
      <label>1</label>
      <addr-line>Harvard Chan Microbiome in Public Health Center, Harvard T.H. Chan School of Public Health, Boston, Massachusetts, United States of America</addr-line>
    </aff>
    <aff id="aff002">
      <label>2</label>
      <addr-line>Department of Biostatistics, Harvard T.H. Chan School of Public Health, Boston, Massachusetts, United States of America</addr-line>
    </aff>
    <aff id="aff003">
      <label>3</label>
      <addr-line>Broad Institute, Cambridge, Massachusetts, United States of America</addr-line>
    </aff>
    <aff id="aff004">
      <label>4</label>
      <addr-line>Department of Human Evolutionary Biology, Harvard University, Cambridge, Massachusetts, United States of America</addr-line>
    </aff>
    <aff id="aff005">
      <label>5</label>
      <addr-line>Department of Statistics, Harvard University, Cambridge, Massachusetts, United States of America</addr-line>
    </aff>
    <aff id="aff006">
      <label>6</label>
      <addr-line>Department of Immunology and Infectious Diseases, Harvard T.H. Chan School of Public Health, Boston, Massachusetts, United States of America</addr-line>
    </aff>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Bromberg</surname>
          <given-names>Yana</given-names>
        </name>
        <role>Editor</role>
        <xref rid="edit1" ref-type="aff"/>
      </contrib>
    </contrib-group>
    <aff id="edit1">
      <addr-line>Rutgers University, UNITED STATES</addr-line>
    </aff>
    <author-notes>
      <fn fn-type="COI-statement" id="coi001">
        <p>The authors have declared that no competing interests exist.</p>
      </fn>
      <corresp id="cor001">* E-mail: <email>chuttenh@hsph.harvard.edu</email></corresp>
    </author-notes>
    <pub-date pub-type="epub">
      <day>13</day>
      <month>9</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="collection">
      <month>9</month>
      <year>2021</year>
    </pub-date>
    <volume>17</volume>
    <issue>9</issue>
    <elocation-id>e1008913</elocation-id>
    <history>
      <date date-type="received">
        <day>23</day>
        <month>3</month>
        <year>2021</year>
      </date>
      <date date-type="accepted">
        <day>19</day>
        <month>8</month>
        <year>2021</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© 2021 Ma et al</copyright-statement>
      <copyright-year>2021</copyright-year>
      <copyright-holder>Ma et al</copyright-holder>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an open access article distributed under the terms of the <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <self-uri xmlns:xlink="http://www.w3.org/1999/xlink" content-type="pdf" xlink:href="pcbi.1008913.pdf"/>
    <abstract>
      <p>Many methods have been developed for statistical analysis of microbial community profiles, but due to the complex nature of typical microbiome measurements (e.g. sparsity, zero-inflation, non-independence, and compositionality) and of the associated underlying biology, it is difficult to compare or evaluate such methods within a single systematic framework. To address this challenge, we developed SparseDOSSA (Sparse Data Observations for the Simulation of Synthetic Abundances): a statistical model of microbial ecological population structure, which can be used to parameterize real-world microbial community profiles and to simulate new, realistic profiles of known structure for methods evaluation. Specifically, SparseDOSSA’s model captures marginal microbial feature abundances as a zero-inflated log-normal distribution, with additional model components for absolute cell counts and the sequence read generation process, microbe-microbe, and microbe-environment interactions. Together, these allow fully known covariance structure between synthetic features (i.e. “taxa”) or between features and “phenotypes” to be simulated for method benchmarking. Here, we demonstrate SparseDOSSA’s performance for 1) accurately modeling human-associated microbial population profiles; 2) generating synthetic communities with controlled population and ecological structures; 3) spiking-in true positive synthetic associations to benchmark analysis methods; and 4) recapitulating an end-to-end mouse microbiome feeding experiment. Together, these represent the most common analysis types in assessment of real microbial community environmental and epidemiological statistics, thus demonstrating SparseDOSSA’s utility as a general-purpose aid for modeling communities and evaluating quantitative methods. An open-source implementation is available at <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://huttenhower.sph.harvard.edu/sparsedossa2" ext-link-type="uri">http://huttenhower.sph.harvard.edu/sparsedossa2</ext-link>.</p>
    </abstract>
    <abstract abstract-type="summary">
      <title>Author summary</title>
      <p>Researchers have linked the human microbiome (collection of microbes residing on or within human tissues) with a wide range of health and disease conditions, establishing these microorganisms as a vital component of our well-being. However, studies on the microbiome require careful technical considerations, as invalid approaches can (and have been reported to) cause under-detections or false discoveries. To this end, a mathematical model can be used both to describe microbiomes, and to simulate how computational tools might behave for them. For example, researchers could test analysis approaches on simulated microbiomes, thus informing designs and method deployment for real-world studies. This has not previously been possible, due to multiple technical challenges with microbiome data; these are a) often constrained to sum up to a constant (“compositional"), b) enriched for zero measurements (zero-inflated), and c) composed of many, potentially interacting microbes (high-dimensional). We present a statistical model aimed at describing and simulating microbiome datasets, with components targeting all these issues, as well as the accompanying computational algorithm and implementation. The freely available implementation, named SparseDOSSA, is validated through extensive simulation and real-world examinations, and will hopefully be of broad theoretical and practical use to researchers in microbiome epidemiology and microbial ecology.</p>
    </abstract>
    <funding-group>
      <award-group id="award001">
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/100000062</institution-id>
            <institution>National Institute of Diabetes and Digestive and Kidney Diseases</institution>
          </institution-wrap>
        </funding-source>
        <award-id>R24DK110499</award-id>
        <principal-award-recipient>
          <name>
            <surname>Huttenhower</surname>
            <given-names>Curtis</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group id="award002">
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/100000060</institution-id>
            <institution>National Institute of Allergy and Infectious Diseases</institution>
          </institution-wrap>
        </funding-source>
        <award-id>U19AI110820</award-id>
      </award-group>
      <award-group id="award003">
        <funding-source>
          <institution>Army Research Laboratory (US)</institution>
        </funding-source>
        <award-id>W911NF-11-1-0473</award-id>
        <principal-award-recipient>
          <name>
            <surname>Huttenhower</surname>
            <given-names>Curtis</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group id="award004">
        <funding-source>
          <institution>Harvard Faculty of Arts and Sciences</institution>
        </funding-source>
        <award-id>Dean’s Competitive Fund</award-id>
        <principal-award-recipient>
          <name>
            <surname>Janson</surname>
            <given-names>Lucas</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <funding-statement>This work has been supported in part by National Institutes of Health grants NIDDK R24DK110499 (CH) <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://www.niddk.nih.gov/research-funding" ext-link-type="uri">https://www.niddk.nih.gov/research-funding</ext-link> NIAID U19AI110820 to David Rasko (CH) <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://www.niaid.nih.gov/grants-contracts/funding-news" ext-link-type="uri">https://www.niaid.nih.gov/grants-contracts/funding-news</ext-link> Army Research Office grant W911NF-11-1-0473 (CH) <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://umbreonsp.arl.army.mil/business/broad-agency-announcements/" ext-link-type="uri">https://umbreonsp.arl.army.mil/business/broad-agency-announcements/</ext-link> The Harvard Faculty of Arts and Sciences Dean's Competitive Fund for Promising Scholarship (LJ) <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://research.fas.harvard.edu/deans-competitive-fund-promising-scholarship" ext-link-type="uri">https://research.fas.harvard.edu/deans-competitive-fund-promising-scholarship</ext-link>. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
    </funding-group>
    <counts>
      <fig-count count="5"/>
      <table-count count="0"/>
      <page-count count="27"/>
    </counts>
    <custom-meta-group>
      <custom-meta>
        <meta-name>PLOS Publication Stage</meta-name>
        <meta-value>vor-update-to-uncorrected-proof</meta-value>
      </custom-meta>
      <custom-meta>
        <meta-name>Publication Update</meta-name>
        <meta-value>2021-10-05</meta-value>
      </custom-meta>
      <custom-meta id="data-availability">
        <meta-name>Data Availability</meta-name>
        <meta-value>Data for the HMP1-II studies ("Stool" and "Vaginal") are available at <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://portal.hmpdacc.org" ext-link-type="uri">https://portal.hmpdacc.org</ext-link>, under Project tag "Human Microbiome Project (HMP)". Data for the HMP2 study ("IBD") is available at <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://ibdmdb.org" ext-link-type="uri">https://ibdmdb.org</ext-link>, and specifically under Data type "Metagenomes". Data for the murine dietary study is stored at NCBI Sequence Read Archive under accession no. PRJNA504908. Software is available at <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://huttenhower.sph.harvard.edu/sparsedossa2" ext-link-type="uri">http://huttenhower.sph.harvard.edu/sparsedossa2</ext-link>.</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
  <notes>
    <title>Data Availability</title>
    <p>Data for the HMP1-II studies ("Stool" and "Vaginal") are available at <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://portal.hmpdacc.org" ext-link-type="uri">https://portal.hmpdacc.org</ext-link>, under Project tag "Human Microbiome Project (HMP)". Data for the HMP2 study ("IBD") is available at <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://ibdmdb.org" ext-link-type="uri">https://ibdmdb.org</ext-link>, and specifically under Data type "Metagenomes". Data for the murine dietary study is stored at NCBI Sequence Read Archive under accession no. PRJNA504908. Software is available at <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://huttenhower.sph.harvard.edu/sparsedossa2" ext-link-type="uri">http://huttenhower.sph.harvard.edu/sparsedossa2</ext-link>.</p>
  </notes>
</front>
<body>
  <disp-quote>
    <p>This is a <italic toggle="yes">PLOS Computational Biology</italic> Methods paper.</p>
  </disp-quote>
  <sec sec-type="intro" id="sec001">
    <title>Introduction</title>
    <p>Microbial community research has increasingly benefited from study designs inspired by molecular epidemiology, particularly with the goal of associating features of the human microbiome with health and disease [<xref rid="pcbi.1008913.ref001" ref-type="bibr">1</xref>]. This has enabled discoveries ranging from overall ecological dysbiosis in gut community structure during inflammatory bowel disease (IBD) [<xref rid="pcbi.1008913.ref002" ref-type="bibr">2</xref>] to specific microbial species, strains, and gene families linked to colorectal cancer (CRC) [<xref rid="pcbi.1008913.ref003" ref-type="bibr">3</xref>]. However, in almost all cases, existing statistical methods for genetic, transcriptional, metabolomic, or other molecular epidemiology cannot be accurately applied directly to microbiome measurements, due to their unique measurement error, noise, zero-inflation, compositional, and non-independence properties [<xref rid="pcbi.1008913.ref004" ref-type="bibr">4</xref>,<xref rid="pcbi.1008913.ref005" ref-type="bibr">5</xref>]. This has led to inaccuracy issues in the literature, such as confounding, uncorrected population structure, batch effects, and a high rate of false positives [<xref rid="pcbi.1008913.ref006" ref-type="bibr">6</xref>–<xref rid="pcbi.1008913.ref009" ref-type="bibr">9</xref>]. There is thus an unmet need for statistical frameworks capable of capturing all aspects of microbiome epidemiology, both for the sake of accurately parameterizing and testing real community profiles, and for “reversing” parameterized models to simulate controlled, synthetic microbiomes for accurate methodology evaluation.</p>
    <p>Transcriptional biomarker discovery has a similar history, in which early statistics to associate gene expression patterns with human phenotypes were met with challenges of noise, dimensionality, and test appropriateness [<xref rid="pcbi.1008913.ref010" ref-type="bibr">10</xref>]. This led to some of the first models for gene expression integrating features of underlying transcriptional biology, different assay platforms, and measurement noise [<xref rid="pcbi.1008913.ref011" ref-type="bibr">11</xref>]. These were in turn also “reversed” to provide simulated expression data for methods evaluation under guaranteed, controlled circumstances [<xref rid="pcbi.1008913.ref012" ref-type="bibr">12</xref>], permitting some of the first truly quantitative transcriptional epidemiology and comparative methods evaluation [<xref rid="pcbi.1008913.ref013" ref-type="bibr">13</xref>].</p>
    <p>Models of microbial community structure are similarly important, and both their biological structure and measurement technologies are quite distinct from those for other sources of short-read sequence generation [<xref rid="pcbi.1008913.ref014" ref-type="bibr">14</xref>]. Microbial community profiles can be derived roughly equivalently from either amplicon (e.g. 16S rRNA gene) or metagenomic shotgun sequencing, and they consist of the (typically compositional) counts or proportions of taxa, genes, pathways, or other features derived from the source sequencing data. Like other types of molecular epidemiology profiles, they are typically a) high-dimensional (number of features equivalent to or surpassing sample size) [<xref rid="pcbi.1008913.ref001" ref-type="bibr">1</xref>] and b) require both feature-feature and sample-sample biological interactions (i.e. correlations or population structure) to be accounted for [<xref rid="pcbi.1008913.ref015" ref-type="bibr">15</xref>].</p>
    <p>Additionally, microbiome data possess further unique properties that prohibit direct application of models from other molecular epidemiology research. They are considerably more sparse, i.e. zero-inflated, both due to low sequencing depth and biological absence [<xref rid="pcbi.1008913.ref001" ref-type="bibr">1</xref>]. As a result, in different settings, either biological presence/absence of microbial features or their abundances can be linked to phenotypes [<xref rid="pcbi.1008913.ref016" ref-type="bibr">16</xref>]. Microbial abundances from sequencing are also near-universally available only on a relative (compositional) scale, thus constrained to sum up to a constant. The combination of general high-dimensional statistical challenges with those unique to ecological profiles have impeded the development of a single, universal model of microbial feature structure.</p>
    <p>As such, most previous strategies for modeling or simulating microbial community profiles (typically for methods evaluation) have been relatively simple [<xref rid="pcbi.1008913.ref005" ref-type="bibr">5</xref>]. Here, we will use “features” and “profiles” to refer to the quantification of taxa or other entities (e.g. genes or pathways) as counts or relative abundances from microbial community sequencing. McMurdie and Holmes [<xref rid="pcbi.1008913.ref005" ref-type="bibr">5</xref>] adopted deterministic mixing and multinomial sampling for simulating microbial taxa count observations; it thus does not allow for interaction between microbial features, nor does it model biological (as opposed to technical) absences. Similarly, Thorsen <italic toggle="yes">et al</italic>. [<xref rid="pcbi.1008913.ref017" ref-type="bibr">17</xref>] adopted random resampling of real-world data for simulating “new” microbial features and samples, indirectly violating compositionality and, again, excluding possible feature-feature interactions. In recent works, metaSPARSim [<xref rid="pcbi.1008913.ref018" ref-type="bibr">18</xref>] adopted a formal statistical model specifically for simulation of 16S rRNA gene amplicon-sequenced microbial observations (here abbreviated 16S), namely, the gamma-multivariate hypergeometric (gamma-MHG) distribution. However, the gamma-MHG model, itself an over-dispersed version of the multinomial model, still does not allow for biological absences or feature-feature interactions. Additionally, the model’s sampling implementation requires iteration over read depth for a given sample, which induces impractically high computation burdens to achieve realistic sequencing depths [<xref rid="pcbi.1008913.ref001" ref-type="bibr">1</xref>]. Prost <italic toggle="yes">et al</italic>. [<xref rid="pcbi.1008913.ref019" ref-type="bibr">19</xref>] proposed a zero-inflated multivariate Gaussian copula model (see <bold><xref rid="sec009" ref-type="sec">Methods</xref></bold> section <bold>Identifiability</bold>), but for the different goal of microbial feature interaction inference and with a substantially different optimization process. None of these frameworks formally capture microbial covariation with real or simulated covariates. In addition to other uses of such models, this is perhaps the most important aspect needed for benchmarking applications, where it enables estimation of power, false discovery rates, and effect sizes for microbiome epidemiology.</p>
    <p>To address these gaps, we present SparseDOSSA (Sparse Data Observations for the Simulation of Synthetic Abundance), a statistical model that can be used to capture and, in turn, simulate realistic microbial community profiles. Motivated by the biological and technical data generation mechanisms and properties of microbial abundance observations, SparseDOSSA has model layers for a) zero-inflated marginal microbial abundances, b) penalized estimation of high-dimensional feature-feature interactions, c) enforced normalization to address compositionality, and d) spiking-in of controlled microbe-microbe and microbe-environment covariation for benchmarking. We demonstrate through validations that the current implementation version, SparseDOSSA 2, accurately captures microbial community population and ecological structures across different environments, host phenotypes, and sequencing technologies, and is capable of recapitulating comparable, realistic synthetic profiles (note that we subsequently include the version number only when indicating an implementation-version-specific feature). We also show example applications in microbiome study design power analysis and in recapitulating a complex end-to-end mouse microbiome feeding experiment. An open-source implementation of and documentation for SparseDOSSA 2 are available through R/Bioconductor and at <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://huttenhower.sph.harvard.edu/sparsedossa2" ext-link-type="uri">http://huttenhower.sph.harvard.edu/sparsedossa2</ext-link>.</p>
  </sec>
  <sec sec-type="results" id="sec002">
    <title>Results</title>
    <sec id="sec003">
      <title>A statistical model for microbial community profiles</title>
      <p>SparseDOSSA is a hierarchical model for microbial count and relative abundance profiles (<bold><xref rid="pcbi.1008913.g001" ref-type="fig">Fig 1</xref></bold>), with components specifically accommodating the major distributional characteristics of such data, namely zero-inflation, compositionality (and thus sequencing depth), feature-feature non-independence, feature-environment interactions, and high-dimensionality. Briefly (<bold><xref rid="pcbi.1008913.g001" ref-type="fig">Fig 1A</xref></bold>, details in <bold>Methods</bold>), the model a) specifies zero-inflated log-normal marginal distributions for each microbial feature to allow for both biological and technical absences, b) imposes distributions on the “absolute”, i.e. pre-normalized, microbial abundances to satisfy compositionality (similar to models such as the Dirichlet [<xref rid="pcbi.1008913.ref020" ref-type="bibr">20</xref>] or gamma-MGH [<xref rid="pcbi.1008913.ref018" ref-type="bibr">18</xref>]), c) models feature-feature correlations through a multivariate Gaussian copula [<xref rid="pcbi.1008913.ref021" ref-type="bibr">21</xref>], and d) adopts a penalized fitting procedure to address high-dimensionality [<xref rid="pcbi.1008913.ref022" ref-type="bibr">22</xref>]. Conditional on feature relative abundances and total read depth, count observations are modeled with a standard multinomial sampling procedure, and per-sample read depth is modelled with a log-normal distribution. For implementation, we adopted a penalized Expectation-Maximization procedure for model fitting, and we have evaluated and provided options for cross-validated selection of the optimal penalization parameter (<bold>Methods</bold>). SparseDOSSA 2 is implemented as an R/Bioconductor package (<ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://huttenhower.sph.harvard.edu/sparsedossa2" ext-link-type="uri">http://huttenhower.sph.harvard.edu/sparsedossa2</ext-link>). Note that this differs somewhat from our previous implementation of SparseDOSSA that was already publicly available; we provide a summary of changes between the versions in <bold>Methods</bold>. SparseDOSSA can be accurately fit to a wide variety of different microbial community structures to capture both (inferred) absolute and relative count observations (<bold><xref rid="pcbi.1008913.g001" ref-type="fig">Fig 1B and 1C</xref></bold>, details below).</p>
      <fig position="float" id="pcbi.1008913.g001">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1008913.g001</object-id>
        <label>Fig 1</label>
        <caption>
          <title>A hierarchical model for microbial community feature profiles.</title>
          <p><bold>A)</bold> SparseDOSSA comprises a hierarchical model to capture the generation mechanism of microbial sequencing counts, including components for “hidden” absolute abundances, sequencing depth (and thus compositional relative abundances), zero inflation, and feature-feature and feature-environment interactions. Notations not defined in the figure: <inline-formula id="pcbi.1008913.e001"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1008913.e001" id="pcbi.1008913.e001g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M1" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mo>·</mml:mo><mml:mo>)</mml:mo></mml:math></alternatives></inline-formula>: cumulative density function (CDF) for the absolute abundance of feature <italic toggle="yes">A</italic><sub><italic toggle="yes">j</italic></sub>. <italic toggle="yes">μ</italic><sub><italic toggle="yes">D</italic></sub>, <inline-formula id="pcbi.1008913.e002"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1008913.e002" id="pcbi.1008913.e002g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M2" display="inline" overflow="scroll"><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula>: mean and variance of the log normal sequencing depth distribution. <bold>B)</bold> SparseDOSSA can be fitted to varied microbial community types using cross-validation procedures by users; the software also provides pre-trained models are provided for human microbiome template datasets. This allows for <bold>C)</bold> simulation of either null or "true positive" association spiked-in synthetic datasets, to facilitate microbiome benchmarking or power analysis studies.</p>
        </caption>
        <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1008913.g001" position="float"/>
      </fig>
    </sec>
    <sec id="sec004">
      <title>SparseDOSSA accurately recapitulates real-world microbial community structures</title>
      <p>We validated SparseDOSSA’s ability to accurately capture realistic microbial community feature profiles by quantifying its performance across a variety of real-world datasets (<bold><xref rid="pcbi.1008913.g002" ref-type="fig">Fig 2</xref> and <xref rid="pcbi.1008913.s006" ref-type="supplementary-material">S1</xref> and <xref rid="pcbi.1008913.s007" ref-type="supplementary-material">S2</xref> Tables</bold>). The studies used include: 1,2) taxonomic profiles from shotgun sequenced metagenomes of healthy human stool and posterior fornix samples from the HMP1-II, hereafter referred to as “Stool” and “Vaginal” [<xref rid="pcbi.1008913.ref023" ref-type="bibr">23</xref>], 3) shotgun sequenced stool metagenomes of inflammatory bowel disease (IBD) patients from the HMP2 Inflammatory Bowel Disease Multi-omics Database (IBDMDB, abbreviated as “IBD”) [<xref rid="pcbi.1008913.ref002" ref-type="bibr">2</xref>], and 4) 16S rRNA gene sequenced murine distal gut communities after diet perturbation [<xref rid="pcbi.1008913.ref024" ref-type="bibr">24</xref>]. By evaluating the model in different cohorts, we established its robustness under different community phenotypes, habitats (i.e. body sites), overall ecological structures, and sequencing technologies (<bold><xref rid="pcbi.1008913.s006" ref-type="supplementary-material">S1 Table</xref></bold>).</p>
      <fig position="float" id="pcbi.1008913.g002">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1008913.g002</object-id>
        <label>Fig 2</label>
        <caption>
          <title>SparseDOSSA accurately recapitulates different microbial community structures.</title>
          <p>We compared SparseDOSSA 2 simulated microbial counts versus those of three human microbiome training template datasets (Stool, Vaginal, and IBD). <bold>A)</bold> Bray-Curtis ordination shows global agreement between SparseDOSSA simulated microbial abundance profiles and those of their originating real-world populations. <bold>B)</bold> This was quantified by PERMANOVA <italic toggle="yes">R</italic><sup>2</sup> statistics, showing that SparseDOSSA simulated samples were significantly less systematically differentiated from their targets than existing DM and metaSPARSim methods in almost all cases (Wilcoxon rank sum test p-values included in <bold><xref rid="pcbi.1008913.s008" ref-type="supplementary-material">S3 Table</xref></bold>). <italic toggle="yes">R</italic><sup>2</sup> compared against randomly split original real-world data are included as baseline controls. <bold>C)</bold> Representative features from each environment are similarly distributed between real-world and SparseDOSSA simulated samples, as shown in empirical cumulative distribution functions (CDFs) of log-10 relative abundances (with pseudo value 1e-6 to visually represent zeros). <bold>D)</bold> Per-feature Kolmogorov-Smirnov summary statistics quantify that SparseDOSSA outperforms existing methods in simulating realistic feature-level relative abundance distributions. First, the similarity between the model-simulated feature abundance distribution versus that in the real-world dataset is quantified with K-S statistics. Then, the K-S statistics for SparseDOSSA and the other two models (DM and metaSPARSim) are plotted on the x- and y-axis, respectively (each point representing one feature, smaller K-S statistics represent better approximation). Lastly, the K-S statistics of SparseDOSSA versus other models are formally tested using Wilcoxon signed rank tests (p-values are significant and included in <bold><xref rid="pcbi.1008913.s009" ref-type="supplementary-material">S4 Table</xref></bold>).</p>
        </caption>
        <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1008913.g002" position="float"/>
      </fig>
      <p>SparseDOSSA 2 captured community parameters and re-simulated microbial profiles with overall community structures that accurately reflected those of the original, real-world ecologies, better than alternative methods (<bold><xref rid="pcbi.1008913.g002" ref-type="fig">Fig 2A and 2B</xref></bold>), across all human datasets (murine study results reported in separate section). Overall, simulated communities yielded the same patterns of global beta-diversity as were contained within each modeled dataset (<bold><xref rid="pcbi.1008913.g002" ref-type="fig">Fig 2A</xref></bold>). This was quantitatively compared against alternative models (Dirichlet-multinomial, DM [<xref rid="pcbi.1008913.ref020" ref-type="bibr">20</xref>] and gamma-MGH, namely metaSPARSim [<xref rid="pcbi.1008913.ref018" ref-type="bibr">18</xref>]) with the PERMANOVA <italic toggle="yes">R</italic><sup>2</sup> statistic [<xref rid="pcbi.1008913.ref025" ref-type="bibr">25</xref>] (<bold>Methods</bold>). We calculated ecological Bray-Curtis dissimilarities between real-world microbial profiles and those simulated by each evaluated method. We then quantified the total variability in the combined dissimilarities that could be attributed to real-world versus simulation difference, expressed as the PERMANOVA <italic toggle="yes">R</italic><sup>2</sup>. Smaller <italic toggle="yes">R</italic><sup>2</sup>s thus indicate less deviation of the simulated community structures from the real-world target and better performance of the model.</p>
      <p>Across almost all evaluated community types, SparseDOSSA 2 generated significantly smaller <italic toggle="yes">R</italic><sup>2</sup> statistics over 25 simulation iterations than existing methods (Wilcoxon rank sum tests p &lt; 0.05), indicating better fit to and recapitulation of the targeted communities (<bold><xref rid="pcbi.1008913.g002" ref-type="fig">Fig 2B</xref>,</bold> testing results in <bold><xref rid="pcbi.1008913.s008" ref-type="supplementary-material">S3 Table</xref></bold>). Notably, this was consistent in both the human gut (Stool, IBD), where community structure forms continuous “gradients” of microbial composition [<xref rid="pcbi.1008913.ref009" ref-type="bibr">9</xref>], and the human vaginal environment (Vaginal), where communities are often characterized by a few discrete types with dominant species [<xref rid="pcbi.1008913.ref026" ref-type="bibr">26</xref>]. Only for the Stool dataset did SparseDOSSA slightly underperform when compared to metaSPARSim in terms of <italic toggle="yes">R</italic><sup>2</sup> statistic, while still outperforming with respect to per-feature distributions (<bold><xref rid="pcbi.1008913.g002" ref-type="fig">Fig 2D</xref></bold>). Additionally, metaSPARSim’s simulation procedure can take as much as ~10x longer than SparseDOSSA 2 (<bold><xref rid="pcbi.1008913.s001" ref-type="supplementary-material">S1 Fig</xref></bold>), which is prohibitive for realistic data sizes (especially for benchmarking or power-analysis efforts requiring multiple simulations per parameter configuration, or for Monte-Carlo calculations). Based on the above comparative performance results, we conclude that, when evaluated for overall community structures, SparseDOSSA can capture microbial feature profiles that closely resemble those of real-world microbiomes.</p>
      <p>The SparseDOSSA model also provided the best recapitulations of individual features’ relative abundances (<bold><xref rid="pcbi.1008913.g002" ref-type="fig">Fig 2C and 2D</xref></bold>). For representative features in each environment, the empirical cumulative distribution function (CDF) curves of samples show that SparseDOSSA simulated abundances closely resemble those of the real-world data (<bold><xref rid="pcbi.1008913.g002" ref-type="fig">Fig 2C</xref></bold>). Quantitatively, for each set of microbial features, we measured the difference of distributions between re-simulated and real-world (modeled) relative abundances with the Kolmogorov-Smirnov summary statistic (K-S, see <bold><xref rid="sec009" ref-type="sec">Methods</xref></bold>). The resulting K-S summaries provides a distance between the distribution of each feature’s relative abundances across simulated vs. modeled real-world communities. Smaller K-S statistics thus indicate better performance of the model. SparseDOSSA better approximated the targeted real-world per-feature distributions than existing methods across all evaluated datasets (<bold><xref rid="pcbi.1008913.g002" ref-type="fig">Fig 2D</xref></bold>), reaching statistical significance in each case (<bold><xref rid="pcbi.1008913.s009" ref-type="supplementary-material">S4 Table</xref>,</bold> Wilcoxon signed rank tests p &lt; 0.05). In addition to simulating existing microbial features, SparseDOSSA 2 also provides the functionality to simulate new features that resemble the targeted environment’s ecological characteristics (<bold>Methods</bold>) and was validated to generate “Stool-like”, “Vaginal-like”, or “IBD-like” new features in terms of prevalence, abundance, and variability for each of the tested datasets (<bold><xref rid="pcbi.1008913.s002" ref-type="supplementary-material">S2 Fig</xref></bold>). Thus both in overall community structure modeling and in per-feature models, SparseDOSSA was able to accurately capture and re-simulate realistic microbial observations better than alternative approaches.</p>
    </sec>
    <sec id="sec005">
      <title>SparseDOSSA captures covariation among microbes and with real or simulated “phenotypes”</title>
      <p>Once the SparseDOSSA model is fit to a real-world microbial community profile, the “reversed” version of the model can be used not only to simulate similar, controlled ecologies, but to introduce artificial, known feature-feature or feature-covariate associations to the simulated profiles (i.e. metadata “spike-ins”). This is implemented by first capturing the “null” state of targeted real-world studies as described above and by subsequently modifying the fit model parameters to induce artificial associations. Compared to existing spiking-in paradigms [<xref rid="pcbi.1008913.ref005" ref-type="bibr">5</xref>,<xref rid="pcbi.1008913.ref017" ref-type="bibr">17</xref>,<xref rid="pcbi.1008913.ref018" ref-type="bibr">18</xref>], the model includes two important improvements (<bold>Methods</bold>). First, SparseDOSSA can model a wide variety of covariates—discrete, continuous, or any combination thereof—with multivariable linear modelling, and can thus accommodate simulations of realistic microbiome population study designs with multiple phenotypes, exposures, or confounders [<xref rid="pcbi.1008913.ref001" ref-type="bibr">1</xref>]. Second, associations with both non-zero (abundance) and zero-inflated (prevalence) components of microbial features can be captured, along with clearly defined effect sizes (fold change or odds ratio, see <bold><xref rid="sec009" ref-type="sec">Methods</xref></bold>). This enables rigorous evaluations of, for example, differential abundance testing methods for their statistical performance (e.g. power or false positive rates).</p>
      <p>Based on models fit to the Stool and Vaginal communities, SparseDOSSA 2 accurately introduced, or “spiked-in” associations for control phenotypes in a new, simulated population (<bold>Figs <xref rid="pcbi.1008913.g003" ref-type="fig">3</xref> and <xref rid="pcbi.1008913.s003" ref-type="supplementary-material">S3</xref></bold>). Specifically, for the Stool dataset, we introduced a binary covariate (similar to e.g. a case / control contrast) with non-zero effects on 16 (5% of the total 332) microbial features’ abundances (<bold><xref rid="pcbi.1008913.g003" ref-type="fig">Fig 3A</xref></bold>) and prevalences (<bold><xref rid="pcbi.1008913.g003" ref-type="fig">Fig 3B</xref>).</bold> Features were selected to ensure the highest effective sample size (<bold>Methods</bold>). For simulated associations of the “phenotype” with feature abundances, log fold change of non-zero relative abundances largely agreed with the target effect sizes within 95% confidence levels (<bold><xref rid="pcbi.1008913.g003" ref-type="fig">Fig 3A</xref></bold>). Prevalence log odds ratios were also as targeted (<bold><xref rid="pcbi.1008913.g003" ref-type="fig">Fig 3B</xref></bold>), with effects in relative abundances mostly agreeing with the prescribed effect sizes. Similar abundance and prevalence results were consistently reproduced in the Vaginal environment (<bold><xref rid="pcbi.1008913.s003" ref-type="supplementary-material">S3 Fig</xref></bold>).</p>
      <fig position="float" id="pcbi.1008913.g003">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1008913.g003</object-id>
        <label>Fig 3</label>
        <caption>
          <title>SparseDOSSA can add feature-phenotype and feature-feature associations to modeled microbial community simulations.</title>
          <p><bold>A,B)</bold> SparseDOSSA 2 correctly simulated feature-phenotype associations targeting the prescribed non-zero relative abundance (<bold>A</bold>) and prevalence (<bold>B</bold>) effect sizes of the spiked features, while maintaining non-associations of null features. True associated (spiked) microbial features (red) are well differentiated from null features (black), through Bonferroni corrected p-values (non-significant features marked in gray; test based on linear/generalized linear regression against the spiked metadata variable, see <bold><xref rid="sec009" ref-type="sec">Methods</xref></bold> for details). The horizontal dashed lines indicate true spike-in effect sizes: red lines for the positive and negative true effect sizes, respectively, and the black line for null effect (0). <bold>C</bold>) SparseDOSSA can also prescribe feature-feature associations. Bottom right triangles are Spearman correlations in the simulated absolute abundances. As prescribed, only true association feature pairs are correlated. Top right triangles are Spearman correlations in the corresponding, simulated relative abundances. Note that in this example, Spearman correlation does not differentiate between true (“biological”) covariations versus those induced spuriously due to compositionality (as is also the case in the underlying data on which SparseDOSSA’s model is fit). As expected, both true signals and spurious correlations caused by compositionality can be observed for such data. TP: true positives.</p>
        </caption>
        <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1008913.g003" position="float"/>
      </fig>
      <p>In addition to modeling associations between microbial features and external covariates, SparseDOSSA can also model community ecological interactions (i.e. correlations between microbial features, or feature-feature “spike-ins”, <bold>Figs <xref rid="pcbi.1008913.g003" ref-type="fig">3C</xref> and <xref rid="pcbi.1008913.s004" ref-type="supplementary-material">S4</xref></bold>). First, we note that SparseDOSSA simulated microbial communities naturally recapitulate important synergies within modeled environments, such as Firmicutes-Bacteroidetes gradients in the human gut and co-exclusion of dominant Lactobacillus species in the vaginal microbiome (<bold><xref rid="pcbi.1008913.s005" ref-type="supplementary-material">S5 Fig</xref></bold>). For introducing artificial correlation among microbial features, we extended the feature-covariate spiking process above to synthetically associate multiple features with the same hidden covariate (<bold>Methods</bold>). First, a null model fit to the Stool/Vaginal communities contains no true feature-feature associations, only those that manifest spuriously due to compositionality. Starting with this, we modified the model to induce increasingly large feature-feature “ecological” interactions. SparseDOSSA 2 produced both only and exactly the expected true feature-feature associations among absolute abundance components, and the correct induced compositional correlations after simulating the sequencing assay process (<bold><xref rid="pcbi.1008913.g003" ref-type="fig">Fig 3C</xref></bold> for subset of Stool results; full Stool/Vaginal results in <bold><xref rid="pcbi.1008913.s004" ref-type="supplementary-material">S4 Fig</xref></bold>). These results support SparseDOSSA’s ability to modify baseline, null community structures by the introduction of interactions among features or with controlled covariates, which together enable the evaluation of a wide range of statistical approaches to microbiome analysis [<xref rid="pcbi.1008913.ref015" ref-type="bibr">15</xref>,<xref rid="pcbi.1008913.ref027" ref-type="bibr">27</xref>,<xref rid="pcbi.1008913.ref028" ref-type="bibr">28</xref>].</p>
    </sec>
    <sec id="sec006">
      <title>Modeling environment-specific benchmarking and power estimation</title>
      <p>Since most microbiome analysis methods make simplifying assumptions that may or may not be suited to particular ecologies, SparseDOSSA’s flexible model enables power and accuracy estimation in a habitat-specific manner (<bold><xref rid="pcbi.1008913.g004" ref-type="fig">Fig 4</xref></bold>). Specifically, by spiking only a limited set of known feature-phenotype associations into an otherwise guaranteed-null model, differential abundance methods can be compared directly to each other in a controlled setting (more details in [<xref rid="pcbi.1008913.ref029" ref-type="bibr">29</xref>]), enabling targeted method benchmarking (<bold><xref rid="pcbi.1008913.g004" ref-type="fig">Fig 4A</xref></bold>) or power analysis (<bold><xref rid="pcbi.1008913.g004" ref-type="fig">Fig 4B</xref></bold>).</p>
      <fig position="float" id="pcbi.1008913.g004">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1008913.g004</object-id>
        <label>Fig 4</label>
        <caption>
          <title>SparseDOSSA enables comparative benchmarking and power analysis of microbial community statistical association tests.</title>
          <p>For any originating community type of interest, datasets simulated based on a SparseDOSSA model fit can be spiked with known "phenotypes" and feature effect sizes to estimate methods performance (power, FPR, etc.) during (<bold>A</bold>) benchmarking as well as (<bold>B</bold>) power analysis, across controlled combinations of potential effect sizes and sample sizes. Points indicate average performance across simulation repetitions and error bars indicate standard error (<bold>Methods</bold>).</p>
        </caption>
        <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1008913.g004" position="float"/>
      </fig>
      <p>To demonstrate SparseDOSSA’s use for benchmark comparison of microbial community statistical tests, we again simulated synthetic datasets based on the Stool profiles with "phenotypic" associations spiked-in for 5% of features at varying effect sizes (as in <bold><xref rid="pcbi.1008913.g003" ref-type="fig">Fig 3A</xref></bold>). Multiple replicates of the same parameter set were performed to provide performance metric mean and standard errors (<bold>Methods</bold>). Using the resulting gold standards, the performances of three different association tests–limmaVOOM [<xref rid="pcbi.1008913.ref030" ref-type="bibr">30</xref>], ANCOM [<xref rid="pcbi.1008913.ref031" ref-type="bibr">31</xref>], and MaAsLin 2 [<xref rid="pcbi.1008913.ref029" ref-type="bibr">29</xref>]—were similar for power, but false discovery rates varied strikingly (<bold><xref rid="pcbi.1008913.g004" ref-type="fig">Fig 4A</xref></bold>). Notably, the MaAsLin 2 generalized linear model showed good FDR control at small to moderate effect sizes. At higher effect sizes, non spiked-in (“null”) features are also called by MaAsLin 2 as differentially abundant. Interestingly, this is because SparseDOSSA’s spike-in effects are imposed on features’ simulated absolute abundances (<bold>Methods</bold>), and high effect size spike-ins thus also induce relative abundance change in null features due to compositionality. This highlights the important difference between true differential abundance effects corresponding to microbes’ biological variation, versus changes post normalization that are driven by other features.</p>
      <p>In contrast, ANCOM [<xref rid="pcbi.1008913.ref031" ref-type="bibr">31</xref>] was designed to account for compositionality and draw inference about hidden absolute abundances; it successfully and maintained FDR under moderate to strong effect sizes. Arguably as a result, however, its performance suffered for small to null effects, presumably because in such cases it is difficult to distinguish between “driver” microbial features with true absolute effects versus those with changes in their relative abundances due to compositionality. Lastly, limmaVoom [<xref rid="pcbi.1008913.ref030" ref-type="bibr">30</xref>], designed primarily for RNA-Seq data, had inflated FDRs across all cases.</p>
      <p>To demonstrate SparseDOSSA’s use for power analysis during microbial community study design, we focused targeted simulation datasets with spiked-in effects on a feature modeled on <italic toggle="yes">Escherichia coli</italic>, as a microbe commonly associated with dysbiosis in the human gut [<xref rid="pcbi.1008913.ref002" ref-type="bibr">2</xref>]. Using this approach, SparseDOSSA 2 can be used to estimate each association method’s expected power for similar biomarkers and populations. In this example, MaAsLin 2 has high power to detect a two-fold abundance change in "<italic toggle="yes">E</italic>. <italic toggle="yes">coli</italic>" for a sample size of at least ~500 individuals, but greatly reduced power for smaller fold-changes (<bold><xref rid="pcbi.1008913.g004" ref-type="fig">Fig 4B</xref></bold>). Since model power for differential abundance testing in sparse, compositional data is extremely difficult to determine parametrically, SparseDOSSA thus provides a way to do so by simulation tailored to any community type or feature of interest, and we provide basic guidelines for this in <bold>Methods</bold>.</p>
    </sec>
    <sec id="sec007">
      <title>SparseDOSSA reproduces an end-to-end diet-microbiome analysis</title>
      <p>In many cases, SparseDOSSA thus captures the properties of microbial community ecologies well enough to reproduce surprisingly specific aspects of their membership and distributions, which we next demonstrated by reproducing an end-to-end example from a longitudinal, interventional diet study investigating the effects of diet on the murine gut microbiome [<xref rid="pcbi.1008913.ref024" ref-type="bibr">24</xref>] (<bold><xref rid="pcbi.1008913.g005" ref-type="fig">Fig 5</xref></bold>). Carmody <italic toggle="yes">et al</italic>. [<xref rid="pcbi.1008913.ref024" ref-type="bibr">24</xref>] used 16S rRNA gene sequencing to profile changes in the mouse distal gut microbiome under different dietary treatments (chow, raw and cooked tuber, and meat). To determine whether SparseDOSSA could accurately model the microbes, phenotypes, and associations observed over time in these settings, we fitted model parameters for each sample type at different time points and under different treatment assignments (<bold>Methods</bold>).</p>
      <fig position="float" id="pcbi.1008913.g005">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1008913.g005</object-id>
        <label>Fig 5</label>
        <caption>
          <title>SparseDOSSA correctly models the effects of diet and time on the murine gut microbiome by reproducing effects from amplicon sequencing profiles.</title>
          <p><bold>A)</bold> SparseDOSSA 2 was fitted to subsets of samples from [<xref rid="pcbi.1008913.ref024" ref-type="bibr">24</xref>] that included up to three time points each from collections of mice fed chow, raw or cooked tubers, and meat. The resulting models were then used to simulate controlled microbial community profiles, which correctly reproduced the beta-diversity structures present in the original study (MDS ordination by Bray-Curtis dissimilarities, corresponding to Fig 1A of [<xref rid="pcbi.1008913.ref024" ref-type="bibr">24</xref>]). The SparseDOSSA model was also able to model and synthetically replicate changes in "Bacteroidetes" and "Firmicutes" phyla in response to raw vs. cooked diets, including <bold>B)</bold> overall community alpha-diversity (Shannon index), <bold>C)</bold> the resulting "Firmicutes" vs. "Bacteroidetes" ratio, and <bold>D)</bold> overall whole-community effective biomass. These correspond to [<xref rid="pcbi.1008913.ref024" ref-type="bibr">24</xref>]’s <xref rid="pcbi.1008913.g001" ref-type="fig">Fig 1F–1H</xref>, respectively. TRF = raw tuber (free-fd); TCF = cooked tuber (free-fed); TCR = cooked tuber (restricted ration).</p>
        </caption>
        <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1008913.g005" position="float"/>
      </fig>
      <p>After re-simulating communities based on these models fits, ordinations of SparseDOSSA results closely mimic the originally observed clustering structure of dietary effects, and even the longitudinal effects of time under treatment (<bold><xref rid="pcbi.1008913.g005" ref-type="fig">Fig 5A</xref></bold>, corresponding to Fig 1A of [<xref rid="pcbi.1008913.ref024" ref-type="bibr">24</xref>]). For quantitative differential abundance effects, based on the observed difference of raw diet (TRF) samples when compared against cooked/free-fed (TCF) and cooked/restricted (TCR) within the tuber diet group [<xref rid="pcbi.1008913.ref024" ref-type="bibr">24</xref>], we additionally applied SparseDOSSA 2’s spike-in procedure to simulate a ~2x fold increase in the abundance of Bacteroidetes OTUs in TCF/TCR when compared to TCF samples, and a ~2x fold decrease in Firmicutes OTUs (<bold>Methods</bold>). Consequently, the simulated samples displayed similar differential outcomes in community diversity as measured by Shannon index, as well as Firmicutes/Bacteroidetes ratios, as seen in the original study (<bold><xref rid="pcbi.1008913.g005" ref-type="fig">Fig 5B and 5C</xref></bold>, corresponding Fig 1F–1G of [<xref rid="pcbi.1008913.ref024" ref-type="bibr">24</xref>]).</p>
      <p>Interestingly, even though per-feature absolute abundances are theoretically unidentifiable in the SparseDOSSA model (<bold>Methods</bold>), we note the spiking-procedure recapitulated the decreased total cell counts in TRF (<bold><xref rid="pcbi.1008913.g005" ref-type="fig">Fig 5D</xref></bold>, corresponding to Fig 1H of [<xref rid="pcbi.1008913.ref024" ref-type="bibr">24</xref>]) that [<xref rid="pcbi.1008913.ref024" ref-type="bibr">24</xref>] also observed via quantitative PCR. The difference between chow versus tuber diets, on the other hand, is completely attributable to SparseDOSSA’s framework, as one can arbitrarily modify the average absolute abundances of our fit to the chow or tuber diet samples, but still yield exactly the same relative abundance profiles. These real-world application results highlight SparseDOSSA’s adaptability to community phenotypes and treatment effects, as well as demonstrate its performance for amplicon sequence datasets and microbial communities associated with non-human hosts.</p>
    </sec>
  </sec>
  <sec sec-type="conclusions" id="sec008">
    <title>Discussion</title>
    <p>Here, we have developed a statistical model, implemented in the R package SparseDOSSA 2, for fitting and/or simulating microbial community profiles. These can comprise taxonomic abundances (i.e. relative abundances or counts) from shotgun metagenomic or amplicon sequencing; although not evaluated here, the model is in principle also appropriate for other microbial feature abundances (e.g. genes or pathways). The model can be fit to communities with different host-associated or environmental ecological structures, and it accurately captures their fundamental characteristics, including the distribution of abundances across community members and the diversities of microbial composition across populations. In addition, to support quantitative benchmarking of new methods for microbial community statistics and epidemiology, SparseDOSSA is able to reliably induce user-specified correlation structures involving feature-covariate or feature-feature associations in simulated ecologies. This was demonstrated not only <italic toggle="yes">in silico</italic>, but by end-to-end reproduction of results paralleling those in an interventional mouse feeding study. The underlying generative model thus efficiently and effectively summarizes real microbial communities and recapitulates their latent structure in a manner that is both computationally efficient and statistically principled.</p>
    <p>The SparseDOSSA model assumes that the characteristics of a template (real) microbial community are well-captured by the distributions it includes for each component (individual features, feature-feature relationships, sparsity, etc.) More specifically, this requires that 1) the non-zero component of absolute abundances is approximately log-normal, 2) that feature-feature association structure is sparse (as captured by the penalized estimation procedure), and 3) that intrinsic population substructure among samples are absent in the template dataset (i.e. before SparseDOSSA 2 itself optionally spikes-in any such structure). The last assumption 4) that sequencing depths within study are themselves log-normal typically has minimal impact on model fitting or usage. The third assumption holds reasonably well even when any correlation structure originally present is weak or rare relative to overall microbial variance, or affects only a small proportion of features, similar to the assumption of “few differential transcripts” used in most RNA-seq models [<xref rid="pcbi.1008913.ref032" ref-type="bibr">32</xref>]. Second, inasmuch as the read count of each feature depends on its own observed mean, variance, and sparsity, SparseDOSSA 2’s simulated data will replicate the marginal distribution of the originating template community. This guarantee on the null distribution of subsequently generated communities allows correlation structure (with samples or among features) to be optionally added in isolation for evaluation of microbial community analysis methods. The first assumption is most approximate—it is generally true for ecologically diverse communities, which empirically follow power-law or log-normal behaviors (with a few abundant organisms and a long tail representing the increasingly rare biosphere). However, as discussed above, its violation leads to small residual systematic biases (&lt;0.5%) in communities where tails of rare organisms are more truncated than expected.</p>
    <p>Perhaps the greatest strength of the model is its application in simulating microbial community profiles, which we have emphasized and validated here. Most previous methods for associating microbial features with covariates [<xref rid="pcbi.1008913.ref031" ref-type="bibr">31</xref>,<xref rid="pcbi.1008913.ref033" ref-type="bibr">33</xref>–<xref rid="pcbi.1008913.ref035" ref-type="bibr">35</xref>] or with each other [<xref rid="pcbi.1008913.ref015" ref-type="bibr">15</xref>,<xref rid="pcbi.1008913.ref028" ref-type="bibr">28</xref>,<xref rid="pcbi.1008913.ref036" ref-type="bibr">36</xref>,<xref rid="pcbi.1008913.ref037" ref-type="bibr">37</xref>] have relied on heterogeneous, one-off models not necessarily reflective of any one “real” microbial community type, or of the diversity of ecological configurations observed in the wild (e.g. the human gut vs. vaginal microbiome vs. soil). By providing a model that can accurately capture many different community types, remove any existing structure through null distributions, and re-introduce known, controlled structure (microbial or covariate), we hope to provide a convenient, unified framework with which statistical methods can be validated specifically for their environments of interest (e.g. human microbiome epidemiology vs. environmental ecological interactions). In addition to this application, while not emphasized here, the model’s parameterization can be used to directly inspect or compare microbial communities. For example, the estimates of absence probabilities π<sub><italic toggle="yes">j</italic></sub> for important microbes <italic toggle="yes">j</italic> of interest in specific human populations (e.g. <italic toggle="yes">Prevotella</italic> in the Westernized vs. non-Westernized gut [<xref rid="pcbi.1008913.ref038" ref-type="bibr">38</xref>]), or the relationships between π<sub><italic toggle="yes">j</italic></sub> vs. mean log-abundance μ<sub><italic toggle="yes">j</italic></sub> across microbes (i.e. prevalence vs. abundance) are directly informative as to their neutral dispersal vs. selection [<xref rid="pcbi.1008913.ref039" ref-type="bibr">39</xref>]. To some degree this is evident from the murine feeding example above, but most such applications remain to be demonstrated in broader “real-world” datasets.</p>
    <p>Relatedly, SparseDOSSA successfully reproduced reported dietary effects on the mouse gut microbiome [<xref rid="pcbi.1008913.ref024" ref-type="bibr">24</xref>], without assuming such differences <italic toggle="yes">a priori</italic> (<bold><xref rid="pcbi.1008913.g005" ref-type="fig">Fig 5</xref></bold>). By fitting our model on microbial observations of separate treatment groups and time points, we allowed SparseDOSSA to adapt to each subset independently, but without assumptions on the existence or magnitude of differences between them. The emergent reproduction of differentiation by diet in the resulting synthetic communities and features (<bold><xref rid="pcbi.1008913.g005" ref-type="fig">Fig 5A</xref></bold>) exemplifies SparseDOSSA’s utility in capturing environment- or treatment-specific dynamics of real-world microbial communities. In parallel, by introducing effects within each dietary group, SparseDOSSA’s per-feature spike-in procedure was able to reproduce structural microbial community changes such as overall diversity and whole-phylum abundance trade-offs. Together, this end-to-end real-world case study highlights SparseDOSSA’s two key functionalities while also testing a non-human, amplicon-sequenced application context: generating realistic microbial community profiles that closely mimic the targeted environment, and introducing covariate spiked-in microbial perturbations to simulate treatment effects.</p>
    <p>With respect to this second use case (covariate effects spike-in), existing simulation models often adopt the simplistic approach of modifying the abundances of taxa in the null community to introduce known associations [<xref rid="pcbi.1008913.ref005" ref-type="bibr">5</xref>,<xref rid="pcbi.1008913.ref018" ref-type="bibr">18</xref>]. SparseDOSSA, in comparison, utilizes rigorous perturbation models to explicitly specify the marginal means of taxa as functions of chosen covariates. This a) enables much more flexible applications such as the inclusion of confounders or random effects (by incorporating them as covariates), and b) yields spiked-in datasets that are strictly compatible with the standard assumptions of (generalized) linear models. Alternatively, differentiation between simple binary (case-versus-control) contrasts could be achieved with our current model by training SparseDOSSA separately on the two corresponding population subsets, given that each was sufficiently large to serve as a template.</p>
    <p>Our modeling and simulation procedure for generating feature-feature correlations is, in turn, directly based off the feature-covariate model and comparatively more restrictive; we expect to explore more rigorous and flexible approaches in future work, since any one “correct” way to model ecological associations in absolute vs. relative abundance space is not clear <italic toggle="yes">a priori</italic> [<xref rid="pcbi.1008913.ref036" ref-type="bibr">36</xref>]. Another related area for future work is in the specific model used for absolute abundances, which are not well-understood from currently available data; our current assumption holds if the total biomass of “typical” communities does not change under “typical” circumstances, but this is obviously quite qualitative. Direct measurements of microbial biomass in some environments such as the human gut have sometimes shown this within approximately one fold change [<xref rid="pcbi.1008913.ref040" ref-type="bibr">40</xref>,<xref rid="pcbi.1008913.ref041" ref-type="bibr">41</xref>], but not in all cases, and certainly not during extreme perturbations such as antibiotics [<xref rid="pcbi.1008913.ref042" ref-type="bibr">42</xref>].</p>
    <p>Thus the SparseDOSSA model simultaneously provides a conceptual framework with which to capture key aspects of microbial ecologies and their members, a simulation system for benchmarking statistical methods that assess correlation structure in microbial community profiles, and a set of marginal parameters for each community and community type of lower dimensionality and potentially reduced noise relative to raw data. The last, while again not yet explored, could allow sample metadata covariates to be more accurately tested for association with microbial features, or tested for association with microbial community features indirectly (e.g. via their prevalence or mean when present). In addition to the areas discussed above, future expansions of the model might include longitudinal structure or other interdependencies among samples (i.e. population substructure), as well as diversifying the application areas for the model (e.g. for power calculations during study design). We note that for introducing correlation among samples with the current implementation (e.g. for simulating longitudinal observations), the user can already create subject-specific “random effect” metadata variables, which then induce tunably non-independent microbial abundances through the existing metadata spike-in procedure. This creates artificial subject-specific effects for the simulated microbial profiles and thus within-subject longitudinal correlations. As currently implemented, SparseDOSSA 2 provides an end-to-end system that enables reproducible and efficient validation of quantitative methods applied to microbial community taxonomic profiles, allowing fair comparisons to be made between different methods or studies to establish a consistent baseline for statistical validation.</p>
  </sec>
  <sec sec-type="materials|methods" id="sec009">
    <title>Methods</title>
    <sec id="sec010">
      <title>The SparseDOSSA model</title>
      <p>SparseDOSSA uses the following data generation mechanism to parameterize microbial community profiles: a) environments/samples contain microbes with absolute abundances <italic toggle="yes">A</italic> b) these are normalized to relative abundances <italic toggle="yes">X</italic>, which c) can be measured via sequenced counts <italic toggle="yes">C</italic>. As detailed in <bold><xref rid="pcbi.1008913.g001" ref-type="fig">Fig 1A</xref></bold>, our model specification for these components is:</p>
      <list list-type="bullet">
        <list-item>
          <p>For the unobserved absolute abundances <italic toggle="yes">A</italic> = (<italic toggle="yes">A</italic><sub>1</sub>, <italic toggle="yes">A</italic><sub>2</sub>, …, <italic toggle="yes">A</italic><sub><italic toggle="yes">p</italic></sub>), we specify a Gaussian copula model [<xref rid="pcbi.1008913.ref021" ref-type="bibr">21</xref>] with zero-inflated log normal marginal distributions. Specifically, this involves assuming hidden multivariate Gaussian variables <italic toggle="yes">g</italic> = (<italic toggle="yes">g</italic><sub>1</sub>, <italic toggle="yes">g</italic><sub>2</sub>, …, <italic toggle="yes">g</italic><sub><italic toggle="yes">p</italic></sub>) for the microbial features and a mapping of these variables to the corresponding absolute abundances (<italic toggle="yes">A</italic><sub>1</sub>, <italic toggle="yes">A</italic><sub>2</sub>, …, <italic toggle="yes">A</italic><sub><italic toggle="yes">p</italic></sub>):
<list list-type="simple"><list-item><label>○</label><p><italic toggle="yes">g</italic> ~ <italic toggle="yes">MVN</italic>(0, <italic toggle="yes">Ω</italic><sup>−1</sup>). That is, each <italic toggle="yes">g</italic><sub><italic toggle="yes">j</italic></sub> is a standard <italic toggle="yes">N</italic>(0, 1) variable and their correlation matrix is <italic toggle="yes">Ω</italic><sup>−1</sup>.</p></list-item><list-item><label>○</label><p>Each <italic toggle="yes">g</italic><sub><italic toggle="yes">j</italic></sub> is mapped to <italic toggle="yes">A</italic><sub><italic toggle="yes">j</italic></sub> such that <italic toggle="yes">A</italic><sub><italic toggle="yes">j</italic></sub> follows a zero-inflated log-normal distribution, parameterized by absence probability (<italic toggle="yes">π</italic><sub><italic toggle="yes">j</italic></sub>) and mean and variability of non-zero log abundances (<italic toggle="yes">μ</italic><sub><italic toggle="yes">j</italic></sub>, <italic toggle="yes">σ</italic><sub><italic toggle="yes">j</italic></sub><sup>2</sup>):
<list list-type="simple"><list-item><label>■</label><p><italic toggle="yes">A</italic><sub><italic toggle="yes">j</italic></sub> = 0 if <italic toggle="yes">g</italic><sub><italic toggle="yes">j</italic></sub> &lt; <italic toggle="yes">Φ</italic><sup>−1</sup>(<italic toggle="yes">π</italic><sub><italic toggle="yes">j</italic></sub>)</p></list-item><list-item><label>■</label><p><inline-formula id="pcbi.1008913.e003"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1008913.e003.jpg" id="pcbi.1008913.e003g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M3" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:msub><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>(</mml:mo><mml:mi>Φ</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:msub><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>)</mml:mo></mml:math></alternatives></inline-formula> if <italic toggle="yes">g</italic><sub><italic toggle="yes">j</italic></sub> ≥ <italic toggle="yes">Φ</italic><sup>−1</sup>(<italic toggle="yes">π</italic><sub><italic toggle="yes">j</italic></sub>)</p></list-item></list></p></list-item></list>
Where <italic toggle="yes">Φ</italic> is the standard normal cumulative density function and <inline-formula id="pcbi.1008913.e004"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1008913.e004.jpg" id="pcbi.1008913.e004g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M4" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:math></alternatives></inline-formula> is the cumulative density function of the zero-inflated log-normal distribution, parameterized by <italic toggle="yes">π</italic><sub><italic toggle="yes">j</italic></sub>, <italic toggle="yes">μ</italic><sub><italic toggle="yes">j</italic></sub>, <italic toggle="yes">σ</italic><sub><italic toggle="yes">j</italic></sub><sup>2</sup>.</p>
        </list-item>
      </list>
      <p>It follows from our model specification that, marginally, <italic toggle="yes">A</italic><sub><italic toggle="yes">j</italic></sub> follows the prescribed zero-inflated log-normal distribution exactly:</p>
      <list list-type="simple">
        <list-item>
          <label>○</label>
          <p>With probability <italic toggle="yes">π</italic><sub><italic toggle="yes">j</italic></sub>, <italic toggle="yes">A</italic><sub><italic toggle="yes">j</italic></sub> = 0</p>
        </list-item>
        <list-item>
          <label>○</label>
          <p>With probability 1 − <italic toggle="yes">π</italic><sub><italic toggle="yes">j</italic></sub>, log <italic toggle="yes">A</italic><sub><italic toggle="yes">j</italic></sub> ~ <italic toggle="yes">N</italic>(<italic toggle="yes">μ</italic><sub><italic toggle="yes">j</italic></sub>, <italic toggle="yes">σ</italic><sub><italic toggle="yes">j</italic></sub><sup>2</sup>)</p>
        </list-item>
      </list>
      <p>Jointly, correlations between microbial features’ absolute abundances are characterized through the copula parameter <italic toggle="yes">Ω</italic>. The benefit of adopting a copula model is to separate the parameterization and estimation of a joint distribution into its marginal and correlation components; this is illustrated in the <bold>model fitting</bold> subsection below.</p>
      <list list-type="bullet">
        <list-item>
          <p>Relative abundances are directly normalized from absolute abundances: <inline-formula id="pcbi.1008913.e005"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1008913.e005.jpg" id="pcbi.1008913.e005g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M5" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mrow><mml:msubsup><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:mrow></mml:mfrac></mml:math></alternatives></inline-formula>. This by definition satisfies compositionality (<inline-formula id="pcbi.1008913.e006"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1008913.e006.jpg" id="pcbi.1008913.e006g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M6" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:math></alternatives></inline-formula>). Also note that because <italic toggle="yes">A</italic><sub><italic toggle="yes">j</italic></sub>’s are zero-inflated, this directly induces zero-inflation (i.e. biological absence) in <italic toggle="yes">X</italic><sub><italic toggle="yes">j</italic></sub>’s.</p>
        </list-item>
        <list-item>
          <p>For a given sample <italic toggle="yes">i</italic> with sequencing depth <italic toggle="yes">D</italic><sub><italic toggle="yes">i</italic></sub>, its per-feature read counts (<italic toggle="yes">C</italic><sub><italic toggle="yes">i</italic>1</sub>, <italic toggle="yes">C</italic><sub><italic toggle="yes">i</italic>2</sub>, …, <italic toggle="yes">C</italic><sub><italic toggle="yes">ip</italic></sub>) are assumed to follow a multinomial distribution with individual features’ probabilities given by <italic toggle="yes">X</italic><sub><italic toggle="yes">ij</italic></sub>. That is, (<italic toggle="yes">C</italic><sub><italic toggle="yes">i</italic>1</sub>, <italic toggle="yes">C</italic><sub><italic toggle="yes">i</italic>2</sub>, …, <italic toggle="yes">C</italic><sub><italic toggle="yes">ip</italic></sub>) ~ <italic toggle="yes">MultiNom</italic>(<italic toggle="yes">D</italic><sub><italic toggle="yes">i</italic></sub>, <italic toggle="yes">X</italic><sub><italic toggle="yes">i</italic>1</sub>, <italic toggle="yes">X</italic><sub><italic toggle="yes">i</italic>2</sub>, …, <italic toggle="yes">X</italic><sub><italic toggle="yes">ip</italic></sub>), thus also allowing technical zeros.</p>
        </list-item>
        <list-item>
          <p>Lastly, we assume the sequencing depth <italic toggle="yes">D</italic><sub><italic toggle="yes">i</italic></sub> across samples follows a log-normal distribution. That is, <italic toggle="yes">D</italic><sub><italic toggle="yes">i</italic></sub> ~ <italic toggle="yes">LogN(μ</italic><sub><italic toggle="yes">D</italic></sub>, <italic toggle="yes">σ</italic><sub><italic toggle="yes">D</italic></sub><sup>2</sup>).</p>
        </list-item>
      </list>
    </sec>
    <sec id="sec011">
      <title>Model likelihood</title>
      <p>It is helpful to clarify the likelihood of our model given its parameterization. First, we derive <italic toggle="yes">f</italic><sub><italic toggle="yes">A</italic></sub>, the likelihood for the unobserved absolute abundances <italic toggle="yes">A</italic>. The likelihood of observed data, as we show later, is an integration of <italic toggle="yes">f</italic><sub><italic toggle="yes">A</italic></sub>. For illustration purposes, we first note the special case where <italic toggle="yes">A</italic><sub><italic toggle="yes">j</italic></sub> are not zero-inflated. That is, <italic toggle="yes">π</italic><sub><italic toggle="yes">j</italic></sub> = 0 for all <italic toggle="yes">j</italic>’s. In this case, we have that:
<disp-formula id="pcbi.1008913.e007"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1008913.e007.jpg" id="pcbi.1008913.e007g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M7" display="block" overflow="scroll"><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:msub><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:msub><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mi>Ω</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:mi>Ω</mml:mi><mml:mo>)</mml:mo><mml:mo>×</mml:mo><mml:mrow><mml:munder><mml:mo stretchy="false">∏</mml:mo><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:msub><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi>ϕ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac></mml:mrow></mml:mrow></mml:math></alternatives></disp-formula></p>
      <p>Where <italic toggle="yes">g</italic><sub><italic toggle="yes">j</italic></sub> is as defined above: <inline-formula id="pcbi.1008913.e008"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1008913.e008.jpg" id="pcbi.1008913.e008g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M8" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mi>Φ</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>)</mml:mo></mml:math></alternatives></inline-formula> and <italic toggle="yes">ϕ</italic>(·) is the standard normal density function. The equality follows by noting that the second term (the product) is the Jacobian of the mapping <inline-formula id="pcbi.1008913.e009"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1008913.e009.jpg" id="pcbi.1008913.e009g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M9" display="inline" overflow="scroll"><mml:mi>g</mml:mi><mml:mo>→</mml:mo><mml:mi>A</mml:mi><mml:mo>:</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:msub><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>(</mml:mo><mml:mi>Φ</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>)</mml:mo></mml:math></alternatives></inline-formula>. When one or more <italic toggle="yes">A</italic><sub><italic toggle="yes">j</italic></sub>’s are zero-inflated, the mapping <italic toggle="yes">g</italic>→<italic toggle="yes">A</italic> is not one-to-one, and the right hand side of the equality requires integration over <italic toggle="yes">g</italic><sub><italic toggle="yes">j</italic></sub>’s that map to zero-valued <italic toggle="yes">A</italic><sub><italic toggle="yes">j</italic></sub>’s:
<disp-formula id="pcbi.1008913.e010"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1008913.e010.jpg" id="pcbi.1008913.e010g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M10" display="block" overflow="scroll"><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:msub><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:msub><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mi>Ω</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mo stretchy="false">∫</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>≤</mml:mo><mml:msup><mml:mrow><mml:mi>Φ</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>∈</mml:mo><mml:mo>{</mml:mo><mml:mi>j</mml:mi><mml:mo>:</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>}</mml:mo></mml:mrow></mml:msub><mml:mrow><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:mi>Ω</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mi>d</mml:mi><mml:mi>g</mml:mi><mml:mo>×</mml:mo><mml:mrow><mml:munder><mml:mo stretchy="false">∏</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>∈</mml:mo><mml:mo>{</mml:mo><mml:mi>j</mml:mi><mml:mo>:</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn><mml:mo>}</mml:mo></mml:mrow></mml:munder><mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:msub><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi>ϕ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac></mml:mrow></mml:mrow></mml:math></alternatives></disp-formula></p>
      <p>To derive the likelihood for relative abundances <italic toggle="yes">X</italic>, we note that <italic toggle="yes">X</italic>, jointly with the total absolute abundance <italic toggle="yes">A</italic><sup><italic toggle="yes">Σ</italic></sup> (<italic toggle="yes">A</italic><sup><italic toggle="yes">Σ</italic></sup>≔∑<sub><italic toggle="yes">j</italic></sub><italic toggle="yes">A</italic><sub><italic toggle="yes">j</italic></sub>), forms a one-to-one mapping with the absolute abundances <italic toggle="yes">A</italic> (<italic toggle="yes">A</italic> = <italic toggle="yes">A</italic><sup><italic toggle="yes">Σ</italic></sup><italic toggle="yes">X</italic>). Thus, the density function for <italic toggle="yes">X</italic>, <italic toggle="yes">f</italic><sub><italic toggle="yes">X</italic></sub>, can be obtained through integration of <inline-formula id="pcbi.1008913.e011"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1008913.e011.jpg" id="pcbi.1008913.e011g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M11" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">Σ</mml:mi></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mi>X</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula>, which is simply <italic toggle="yes">f</italic><sub><italic toggle="yes">A</italic></sub> multiplied by the Jacobian of the transformation:
<disp-formula id="pcbi.1008913.e012"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1008913.e012.jpg" id="pcbi.1008913.e012g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M12" display="block" overflow="scroll"><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>X</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:msub><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:msub><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mi>Ω</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:mstyle displaystyle="false"><mml:mo>∫</mml:mo></mml:mstyle><mml:mrow><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:msup><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>Σ</mml:mi></mml:mrow></mml:msup><mml:mi>X</mml:mi><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:msub><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:msub><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mi>Ω</mml:mi><mml:mo>)</mml:mo><mml:mo>×</mml:mo><mml:mo>(</mml:mo><mml:msup><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>Σ</mml:mi></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:mo>{</mml:mo><mml:mi>j</mml:mi><mml:mo>:</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn><mml:mo>}</mml:mo><mml:mo>|</mml:mo><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mrow><mml:mi>d</mml:mi><mml:msup><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>Σ</mml:mi></mml:mrow></mml:msup></mml:math></alternatives><label>(1)</label></disp-formula></p>
      <p>Lastly, for the observed microbial count data <italic toggle="yes">C</italic>, the proper likelihood is:
<disp-formula id="pcbi.1008913.e013"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1008913.e013.jpg" id="pcbi.1008913.e013g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M13" display="block" overflow="scroll"><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>C</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:msub><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:msub><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mi>Ω</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">∫</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>C</mml:mi><mml:mo>|</mml:mo><mml:mi>X</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>C</mml:mi><mml:mo>|</mml:mo><mml:mi>X</mml:mi><mml:mo>)</mml:mo><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>X</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>X</mml:mi><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:msub><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:msub><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mi>Ω</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mi>d</mml:mi><mml:mi>X</mml:mi></mml:math></alternatives></disp-formula></p>
      <p>Where <italic toggle="yes">f</italic><sub><italic toggle="yes">C</italic>|<italic toggle="yes">X</italic></sub>(<italic toggle="yes">C</italic>) is the multinomial likelihood for microbial counts given their relative abundances. In practice, to simplify computation, during model fitting we replace this likelihood with
<disp-formula id="pcbi.1008913.e014"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1008913.e014.jpg" id="pcbi.1008913.e014g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M14" display="block" overflow="scroll"><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>C</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:msub><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:msub><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mi>Ω</mml:mi><mml:mo>)</mml:mo><mml:mo>≈</mml:mo><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>X</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:msub><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:msub><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mi>Ω</mml:mi><mml:mo>)</mml:mo><mml:mo>×</mml:mo><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>n</mml:mi><mml:mi>s</mml:mi><mml:mi>t</mml:mi></mml:math></alternatives><label>(2)</label></disp-formula></p>
      <p>Where <inline-formula id="pcbi.1008913.e015"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1008913.e015.jpg" id="pcbi.1008913.e015g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M15" display="inline" overflow="scroll"><mml:mover accent="true"><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula> is the multinomial MLE for <italic toggle="yes">X</italic> given observed <italic toggle="yes">C</italic>, i.e., <inline-formula id="pcbi.1008913.e016"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1008913.e016.jpg" id="pcbi.1008913.e016g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M16" display="inline" overflow="scroll"><mml:mover accent="true"><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:mrow></mml:mfrac></mml:math></alternatives></inline-formula>, <italic toggle="yes">const</italic> is a normalizing constant not involving the parameters. The approximation is acceptable because with modern sequencing depth [<xref rid="pcbi.1008913.ref001" ref-type="bibr">1</xref>], <italic toggle="yes">f</italic><sub><italic toggle="yes">C</italic>|<italic toggle="yes">X</italic></sub>(<italic toggle="yes">C</italic>|<italic toggle="yes">X</italic>) (as function of <italic toggle="yes">X</italic>) is highly concentrated around <inline-formula id="pcbi.1008913.e017"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1008913.e017.jpg" id="pcbi.1008913.e017g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M17" display="inline" overflow="scroll"><mml:mover accent="true"><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula>. The right-hand side of (2) is what we aim to maximize for estimation of our model’s parameters, <italic toggle="yes">π</italic><sub>1</sub>, <italic toggle="yes">μ</italic><sub>1</sub>, <italic toggle="yes">σ</italic><sub>1</sub><sup>2</sup>,⋯,<italic toggle="yes">π</italic><sub><italic toggle="yes">p</italic></sub>,<italic toggle="yes">μ</italic><sub><italic toggle="yes">p</italic></sub>,<italic toggle="yes">σ</italic><sub><italic toggle="yes">p</italic></sub><sup>2</sup>, and <italic toggle="yes">Ω</italic>.</p>
    </sec>
    <sec id="sec012">
      <title>Identifiability</title>
      <p>It is important to note that likelihood (1) is unidentifiable. That is, there exist different values of the parameter set (<italic toggle="yes">π</italic><sub>1</sub>, <italic toggle="yes">μ</italic><sub>1</sub>, <italic toggle="yes">σ</italic><sub>1</sub><sup>2</sup>,⋯,<italic toggle="yes">π</italic><sub><italic toggle="yes">p</italic></sub>, <italic toggle="yes">μ</italic><sub><italic toggle="yes">p</italic></sub>, <italic toggle="yes">σ</italic><sub><italic toggle="yes">p</italic></sub><sup>2</sup>, <italic toggle="yes">Ω</italic>) that yield the same likelihood <italic toggle="yes">f</italic><sub><italic toggle="yes">X</italic></sub> (and consequently <italic toggle="yes">f</italic><sub><italic toggle="yes">C</italic></sub>). Intuitively, this is because <italic toggle="yes">X</italic> are normalized from absolute abundances <italic toggle="yes">A</italic>, and different <italic toggle="yes">A</italic> values can map to the same normalized relative abundances <italic toggle="yes">X</italic>—this is thus typical of any compositional setting. Regarding the identifiability of our parameters, we build on the results of [<xref rid="pcbi.1008913.ref043" ref-type="bibr">43</xref>], which is a special case of our model where <italic toggle="yes">π</italic><sub><italic toggle="yes">j</italic></sub> = 0 for all <italic toggle="yes">j</italic>’s. Specifically, we note that:</p>
      <list list-type="bullet">
        <list-item>
          <p><italic toggle="yes">π</italic><sub><italic toggle="yes">j</italic></sub>’s are identifiable, as <italic toggle="yes">X</italic><sub><italic toggle="yes">j</italic></sub> = 0 ⇔ <italic toggle="yes">A</italic><sub><italic toggle="yes">j</italic></sub> = 0</p>
        </list-item>
        <list-item>
          <p><italic toggle="yes">μ</italic><sub>1</sub>,⋯,<italic toggle="yes">μ</italic><sub><italic toggle="yes">p</italic></sub> are identifiable up to a constant. That is, <italic toggle="yes">μ</italic><sub>1</sub>,⋯,<italic toggle="yes">μ</italic><sub><italic toggle="yes">p</italic></sub> and <italic toggle="yes">μ</italic><sub>1</sub>+<italic toggle="yes">c</italic>,⋯,<italic toggle="yes">μ</italic><sub><italic toggle="yes">p</italic></sub>+<italic toggle="yes">c</italic> lead to the same likelihood, for any constant <italic toggle="yes">c</italic>. For this reason, in our model estimation we impose the (arbitrary) constraint that ∑<sub><italic toggle="yes">j</italic></sub><italic toggle="yes">μ</italic><sub><italic toggle="yes">j</italic></sub> = 0.</p>
        </list-item>
        <list-item>
          <p><italic toggle="yes">σ</italic><sub>1</sub><sup>2</sup>,⋯,<italic toggle="yes">σ</italic><sub><italic toggle="yes">p</italic></sub><sup>2</sup> are identifiable, given <italic toggle="yes">μ</italic><sub>1</sub>,⋯,<italic toggle="yes">μ</italic><sub><italic toggle="yes">p</italic></sub> and <italic toggle="yes">Ω</italic>. One can note that when <italic toggle="yes">π</italic><sub><italic toggle="yes">j</italic></sub> = 1 for all <italic toggle="yes">j</italic>’s, our likelihood degenerates to that in [<xref rid="pcbi.1008913.ref043" ref-type="bibr">43</xref>] with explicit analytical forms.</p>
        </list-item>
        <list-item>
          <p><italic toggle="yes">Ω</italic> is not identifiable. Again, consider the special case that <italic toggle="yes">π</italic><sub><italic toggle="yes">j</italic></sub> = 1 and <italic toggle="yes">σ</italic><sub><italic toggle="yes">j</italic></sub> = 1, the form of <italic toggle="yes">f</italic><sub><italic toggle="yes">X</italic></sub> is explicit and involves <inline-formula id="pcbi.1008913.e018"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1008913.e018.jpg" id="pcbi.1008913.e018g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M18" display="inline" overflow="scroll"><mml:mi>Ω</mml:mi><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mi>Ω</mml:mi><mml:msub><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mrow><mml:msub><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:mi>Ω</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:msub><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:mi>Ω</mml:mi><mml:msub><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:math></alternatives></inline-formula>, which is a multiple-to-one mapping from <italic toggle="yes">Ω</italic>. The issue of non-identifiable correlation matrices for microbiome abundance data has been noted and addressed in many previous works; refer to [<xref rid="pcbi.1008913.ref015" ref-type="bibr">15</xref>,<xref rid="pcbi.1008913.ref027" ref-type="bibr">27</xref>,<xref rid="pcbi.1008913.ref028" ref-type="bibr">28</xref>,<xref rid="pcbi.1008913.ref043" ref-type="bibr">43</xref>] for a partial list. We adopt the technique used in many of these previous works, namely <italic toggle="yes">L</italic><sub>1</sub> penalization on <italic toggle="yes">Ω</italic>, to simultaneously address the identifiability issue as well as high-dimensionality for generic estimation of large covariance matrices [<xref rid="pcbi.1008913.ref022" ref-type="bibr">22</xref>].</p>
        </list-item>
      </list>
      <p>We note that, importantly, good performance of SparseDOSSA does not require correct estimation of its non-identifiable parameters. Rather, so long as SparseDOSSA provides a configuration of estimated parameters that yields a joint distribution of relative abundances (<italic toggle="yes">X</italic><sub>1</sub>,⋯,<italic toggle="yes">X</italic><sub><italic toggle="yes">p</italic></sub>) that closely approximates that of the original data, its application case for capturing or simulating microbial observations is achieved. Thus, our proposed solution for non-identifiability, though not guaranteed to correctly estimate the unknown true parameters, does satisfy typical applications.</p>
    </sec>
    <sec id="sec013">
      <title>Model fitting</title>
      <p>Given our model specification and its (non-)identifiability, we propose to minimize the following penalized negative log-likelihood function for solving the parameter set <italic toggle="yes">Θ</italic> = (<italic toggle="yes">π</italic><sub>1</sub>, <italic toggle="yes">μ</italic><sub>1</sub>, <italic toggle="yes">σ</italic><sub>1</sub><sup>2</sup>,⋯,<italic toggle="yes">π</italic><sub><italic toggle="yes">p</italic></sub>, <italic toggle="yes">μ</italic><sub><italic toggle="yes">p</italic></sub>, <italic toggle="yes">σ</italic><sub><italic toggle="yes">p</italic></sub><sup>2</sup>, <italic toggle="yes">Ω</italic>) (the sequencing depth parameters (<italic toggle="yes">μ</italic><sub><italic toggle="yes">D</italic></sub>, <italic toggle="yes">σ</italic><sub><italic toggle="yes">D</italic></sub><sup>2</sup>) can be fitted independently on per-sample read depths with maximum likelihood):
<disp-formula id="pcbi.1008913.e019"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1008913.e019.jpg" id="pcbi.1008913.e019g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M19" display="block" overflow="scroll"><mml:mrow><mml:munderover><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:munderover><mml:mrow><mml:mo>−</mml:mo><mml:mi>l</mml:mi><mml:mi>o</mml:mi><mml:mi>g</mml:mi><mml:mspace width="0.25em"/><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>X</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mover accent="true"><mml:mrow><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>^</mml:mo></mml:mover><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:msub><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:msub><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mi>Ω</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:mi>λ</mml:mi><mml:mo>|</mml:mo><mml:mo>|</mml:mo><mml:mi>Ω</mml:mi><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math></alternatives></disp-formula></p>
      <p>Subject to the constraint for <italic toggle="yes">μ</italic><sub><italic toggle="yes">j</italic></sub> as specified above: ∑<sub><italic toggle="yes">j</italic></sub><italic toggle="yes">μ</italic><sub><italic toggle="yes">j</italic></sub> = 0. As such, <italic toggle="yes">λ</italic>&gt;0 is a penalizing tuning parameter, which we choose with K-fold cross-validation in practice (five folds by default). <inline-formula id="pcbi.1008913.e020"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1008913.e020.jpg" id="pcbi.1008913.e020g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M20" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula> can be either existing relative abundance estimations or, as specified above, normalized from count observations (<inline-formula id="pcbi.1008913.e021"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1008913.e021.jpg" id="pcbi.1008913.e021g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M21" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:mrow></mml:mfrac></mml:math></alternatives></inline-formula>).</p>
      <p>As specified in (1), the likelihood function <italic toggle="yes">f</italic><sub><italic toggle="yes">X</italic></sub> involves integration over <italic toggle="yes">A</italic><sup><italic toggle="yes">Σ</italic></sup> and is not analytically tractable. Numerically, we propose the following penalized expectation-maximization algorithm [<xref rid="pcbi.1008913.ref044" ref-type="bibr">44</xref>] for model fitting:</p>
      <list list-type="order">
        <list-item>
          <p>Initialize <inline-formula id="pcbi.1008913.e022"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1008913.e022.jpg" id="pcbi.1008913.e022g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M22" display="inline" overflow="scroll"><mml:msup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>Θ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:msub><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:msub><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi>Ω</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msup></mml:math></alternatives></inline-formula> by fitting a multivariate log-normal distribution on <inline-formula id="pcbi.1008913.e023"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1008913.e023.jpg" id="pcbi.1008913.e023g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M23" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>’</mml:mo><mml:mi mathvariant="normal">s</mml:mi></mml:math></alternatives></inline-formula>.</p>
        </list-item>
        <list-item>
          <p>During the <italic toggle="yes">r</italic>-th iteration:
<list list-type="alpha-lower"><list-item><p>E-step: calculate expectation <inline-formula id="pcbi.1008913.e024"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1008913.e024.jpg" id="pcbi.1008913.e024g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M24" display="inline" overflow="scroll"><mml:msup><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>r</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msup><mml:mo>(</mml:mo><mml:mi>X</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mi>Θ</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:msup><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>Σ</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>;</mml:mo><mml:msup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>Θ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>r</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:msub><mml:mi>l</mml:mi><mml:mi>o</mml:mi><mml:mi>g</mml:mi><mml:mspace width="0.25em"/><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:msup><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>Σ</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:mi>Θ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>×</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:msup><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>Σ</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:mo>{</mml:mo><mml:mi>j</mml:mi><mml:mo>:</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn><mml:mo>}</mml:mo><mml:mo>|</mml:mo><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>.</p></list-item><list-item><p>Penalized M-step: maximize −<italic toggle="yes">l</italic><sup>(<italic toggle="yes">r</italic>)</sup>(<italic toggle="yes">X</italic>|<italic toggle="yes">Θ</italic>)+<italic toggle="yes">λ</italic>||<italic toggle="yes">Ω</italic>||<sub>1</sub> with respect to <italic toggle="yes">Θ</italic> to obtain <inline-formula id="pcbi.1008913.e025"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1008913.e025.jpg" id="pcbi.1008913.e025g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M25" display="inline" overflow="scroll"><mml:msup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>Θ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>r</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msup></mml:math></alternatives></inline-formula>. Note that <inline-formula id="pcbi.1008913.e026"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1008913.e026.jpg" id="pcbi.1008913.e026g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M26" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>’</mml:mo><mml:mi mathvariant="normal">s</mml:mi></mml:math></alternatives></inline-formula> do not require updates. <inline-formula id="pcbi.1008913.e027"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1008913.e027.jpg" id="pcbi.1008913.e027g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M27" display="inline" overflow="scroll"><mml:msup><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>r</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msup></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1008913.e028"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1008913.e028.jpg" id="pcbi.1008913.e028g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M28" display="inline" overflow="scroll"><mml:msup><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>r</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msup></mml:math></alternatives></inline-formula> can be solved analytically. <inline-formula id="pcbi.1008913.e029"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1008913.e029.jpg" id="pcbi.1008913.e029g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M29" display="inline" overflow="scroll"><mml:msup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>Ω</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>r</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msup></mml:math></alternatives></inline-formula> can be solved with standard graphical lasso [<xref rid="pcbi.1008913.ref022" ref-type="bibr">22</xref>].</p></list-item></list></p>
        </list-item>
        <list-item>
          <p>Iterate until convergence.</p>
        </list-item>
      </list>
    </sec>
    <sec id="sec014">
      <title>Generating synthetic microbial observations and simulating new features</title>
      <p>Given that our model is fully parametric, synthetic microbial observations, including (hidden) absolute abundances, normalized relative abundances, and sequencing counts, can be generated following the same specifications as described above. To provide model parameters, the user can adopt one of the pre-trained sets included with the software or use the SparseDOSSA 2 training procedure to estimate parameters from any microbial template dataset suited for their simulation case.</p>
      <p>Users may also be interested in generating “new” microbial features from the same ecological environment. For this, SparseDOSSA additionally models the per-feature parameters (<italic toggle="yes">π</italic><sub><italic toggle="yes">j</italic></sub>, <italic toggle="yes">μ</italic><sub><italic toggle="yes">j</italic></sub>, <italic toggle="yes">σ</italic><sub><italic toggle="yes">j</italic></sub><sup>2</sup>) with a three-dimensional non-parametric distribution <italic toggle="yes">F</italic>. That is, across features, (<italic toggle="yes">π</italic><sub><italic toggle="yes">j</italic></sub>, <italic toggle="yes">μ</italic><sub><italic toggle="yes">j</italic></sub>, <italic toggle="yes">σ</italic><sub><italic toggle="yes">j</italic></sub><sup>2</sup>)~<italic toggle="yes">F</italic>. Given a set of SparseDOSSA fitted results <inline-formula id="pcbi.1008913.e030"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1008913.e030.jpg" id="pcbi.1008913.e030g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M30" display="inline" overflow="scroll"><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:math></alternatives></inline-formula>, <italic toggle="yes">F</italic> can be estimated with a three-dimensional normal kernel density estimator [<xref rid="pcbi.1008913.ref045" ref-type="bibr">45</xref>]. The estimated <inline-formula id="pcbi.1008913.e031"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1008913.e031.jpg" id="pcbi.1008913.e031g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M31" display="inline" overflow="scroll"><mml:mover accent="true"><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula> can then be used to simulate new microbial features that follow the ecological characteristics (i.e., prevalence, abundance, and variability) of the fitted environment (<bold><xref rid="pcbi.1008913.s002" ref-type="supplementary-material">S2 Fig</xref></bold>).</p>
    </sec>
    <sec id="sec015">
      <title>Association spike-in</title>
      <p>SparseDOSSA adopts linear and generalized linear models for flexible spiking-in in both microbial features’ non-zero abundances and prevalences, based on covariates. Let <italic toggle="yes">Z</italic><sub><italic toggle="yes">i</italic></sub> be the vector of covariate(s) for sample <italic toggle="yes">i</italic> and <italic toggle="yes">β</italic> be the targeted corresponding effect sizes (coefficients). To spike in associations between feature <italic toggle="yes">j</italic>’s abundance and covariates <italic toggle="yes">Z</italic><sub><italic toggle="yes">i</italic></sub>, we modify the feature’s non-zero mean log absolute abundance parameter <italic toggle="yes">μ</italic><sub><italic toggle="yes">j</italic></sub> across samples. Specifically, the post spike-in mean log abundance is modified as
<disp-formula id="pcbi.1008913.e032"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1008913.e032.jpg" id="pcbi.1008913.e032g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M32" display="block" overflow="scroll"><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi><mml:mi>b</mml:mi><mml:mi>u</mml:mi><mml:mi>n</mml:mi><mml:mi>d</mml:mi><mml:mi>a</mml:mi><mml:mi>n</mml:mi><mml:mi>c</mml:mi><mml:mi>e</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></disp-formula></p>
      <p>For the <italic toggle="yes">i</italic>-th sample, <italic toggle="yes">A</italic><sub><italic toggle="yes">ij</italic></sub> can be generated with <italic toggle="yes">ZILogN</italic>(<italic toggle="yes">π</italic><sub><italic toggle="yes">j</italic></sub>, <italic toggle="yes">μ</italic><sub><italic toggle="yes">ij</italic></sub>, <italic toggle="yes">σ</italic><sub><italic toggle="yes">j</italic></sub><sup>2</sup>) instead of the original <italic toggle="yes">ZILogN</italic>(<italic toggle="yes">π</italic><sub><italic toggle="yes">j</italic></sub>, <italic toggle="yes">μ</italic><sub><italic toggle="yes">j</italic></sub>, <italic toggle="yes">σ</italic><sub><italic toggle="yes">j</italic></sub><sup>2</sup>). This dictates that <italic toggle="yes">A</italic><sub><italic toggle="yes">ij</italic></sub>’s are associated with <italic toggle="yes">Z</italic><sub><italic toggle="yes">i</italic></sub> in their mean non-zero log abundances. As <italic toggle="yes">μ</italic><sub><italic toggle="yes">ij</italic></sub> are specified on the log scale, <italic toggle="yes">β</italic><sub><italic toggle="yes">abundance</italic></sub>, by definition, corresponds to log fold changes.</p>
      <p>The prevalence spike-in similarly is specified via the logistic model; we modify the presence probability parameter (1−<italic toggle="yes">π</italic><sub><italic toggle="yes">j</italic></sub>) across samples:
<disp-formula id="pcbi.1008913.e033"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1008913.e033.jpg" id="pcbi.1008913.e033g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M33" display="block" overflow="scroll"><mml:mi>l</mml:mi><mml:mi>o</mml:mi><mml:mi>g</mml:mi><mml:mo>(</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mi>l</mml:mi><mml:mi>o</mml:mi><mml:mi>g</mml:mi><mml:mo>(</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>)</mml:mo><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:msub><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>v</mml:mi><mml:mi>a</mml:mi><mml:mi>l</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi><mml:mi>c</mml:mi><mml:mi>e</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></disp-formula></p>
      <p>And generate <italic toggle="yes">A</italic><sub><italic toggle="yes">ij</italic></sub>’s correspondingly. This introduces an association between the covariates <italic toggle="yes">Z</italic><sub><italic toggle="yes">i</italic></sub> and feature <italic toggle="yes">j</italic>’s prevalence, with <italic toggle="yes">β</italic><sub><italic toggle="yes">prevalence</italic></sub> corresponding to log odds ratios of the feature being present. The multivariate linear modelling approach for specifying the association effects for both abundance and prevalence allows us to flexibly incorporate different variable types (e.g. binary, continuous, etc.) and study designs (e.g. existence of confounders).</p>
      <p>We note that, importantly, our spiking-in procedure is performed on the absolute abundances, <italic toggle="yes">A</italic>, which induces differential effects in relative abundances <italic toggle="yes">X</italic> (<bold><xref rid="pcbi.1008913.g003" ref-type="fig">Fig 3A and 3B</xref></bold>). The main benefit of this approach is that both the spiked-in microbial features and the “null” (i.e. non-spiked features) are clearly defined. The alternative—specifying effects for <italic toggle="yes">X</italic><sub><italic toggle="yes">j</italic></sub>—is conceptually difficult. As <italic toggle="yes">X</italic> is compositional (sums to 1), prescribing enrichment effects (higher abundance or prevalence) for some microbial features must by definition lead to depletion effects for certain other features. This renders it difficult to clearly define and separate the set of "true positive" spiked-in microbial features and the set of null features. SparseDOSSA’s definition of effects for absolute abundances in its spike-in procedure align with recent efforts to rigorously characterize microbial differential abundance effects under the constraint of compositionality [<xref rid="pcbi.1008913.ref031" ref-type="bibr">31</xref>,<xref rid="pcbi.1008913.ref046" ref-type="bibr">46</xref>]. Empirically, we note that prescribed log fold changes or odds ratios for <italic toggle="yes">A</italic><sub><italic toggle="yes">j</italic></sub> often lead to similar effect sizes in the relative abundances <italic toggle="yes">X</italic><sub><italic toggle="yes">j</italic></sub> for the spiked-in feature <italic toggle="yes">j</italic>’s (<bold><xref rid="pcbi.1008913.g003" ref-type="fig">Fig 3A and 3B</xref></bold>).</p>
      <p>Lastly, we note that the spiking-in procedure with metadata variables can be used to simulate association effects between pairs of microbial features (<bold><xref rid="pcbi.1008913.g003" ref-type="fig">Fig 3C</xref></bold>). Specifically, we first simulate a hidden covariate <italic toggle="yes">Z</italic> with standard normal distribution. For a pair of features <italic toggle="yes">j</italic><sub>1</sub>, and <italic toggle="yes">j</italic><sub>2</sub>, to enforce positive correlations between the two absolute abundances <inline-formula id="pcbi.1008913.e034"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1008913.e034.jpg" id="pcbi.1008913.e034g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M34" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1008913.e035"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1008913.e035.jpg" id="pcbi.1008913.e035g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M35" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:math></alternatives></inline-formula>, we simulate for them to be associated with <italic toggle="yes">Z</italic> in the same direction:
<disp-formula id="pcbi.1008913.e036"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1008913.e036.jpg" id="pcbi.1008913.e036g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M36" display="block" overflow="scroll"><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:msub><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi><mml:mi>b</mml:mi><mml:mi>u</mml:mi><mml:mi>n</mml:mi><mml:mi>d</mml:mi><mml:mi>a</mml:mi><mml:mi>n</mml:mi><mml:mi>c</mml:mi><mml:mi>e</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></disp-formula>
<disp-formula id="pcbi.1008913.e037"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1008913.e037.jpg" id="pcbi.1008913.e037g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M37" display="block" overflow="scroll"><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:msub><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi><mml:mi>b</mml:mi><mml:mi>u</mml:mi><mml:mi>n</mml:mi><mml:mi>d</mml:mi><mml:mi>a</mml:mi><mml:mi>n</mml:mi><mml:mi>c</mml:mi><mml:mi>e</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></disp-formula>
<disp-formula id="pcbi.1008913.e038"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1008913.e038.jpg" id="pcbi.1008913.e038g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M38" display="block" overflow="scroll"><mml:mi>l</mml:mi><mml:mi>o</mml:mi><mml:mi>g</mml:mi><mml:mo>(</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:msub><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:msub><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mi>l</mml:mi><mml:mi>o</mml:mi><mml:mi>g</mml:mi><mml:mo>(</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>)</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>v</mml:mi><mml:mi>a</mml:mi><mml:mi>l</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi><mml:mi>c</mml:mi><mml:mi>e</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></disp-formula>
<disp-formula id="pcbi.1008913.e039"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1008913.e039.jpg" id="pcbi.1008913.e039g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M39" display="block" overflow="scroll"><mml:mi>l</mml:mi><mml:mi>o</mml:mi><mml:mi>g</mml:mi><mml:mo>(</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:msub><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:msub><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mi>l</mml:mi><mml:mi>o</mml:mi><mml:mi>g</mml:mi><mml:mo>(</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>)</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>v</mml:mi><mml:mi>a</mml:mi><mml:mi>l</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi><mml:mi>c</mml:mi><mml:mi>e</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></disp-formula></p>
      <p>Where <italic toggle="yes">β</italic><sub><italic toggle="yes">abundance</italic></sub> = <italic toggle="yes">β</italic><sub><italic toggle="yes">prevalence</italic></sub> = <italic toggle="yes">β</italic> can be viewed here as the effect size specifying the strength of correlation between <inline-formula id="pcbi.1008913.e040"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1008913.e040.jpg" id="pcbi.1008913.e040g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M40" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1008913.e041"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1008913.e041.jpg" id="pcbi.1008913.e041g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M41" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:math></alternatives></inline-formula>. To spike in negative correlation between the two, we simply keep <italic toggle="yes">β</italic> as the effect for one of the features and use −<italic toggle="yes">β</italic> for the other.</p>
    </sec>
    <sec id="sec016">
      <title>Comparison between SparseDOSSA and SparseDOSSA 2</title>
      <p>A previous implementation of SparseDOSSA has also been publicly available [<xref rid="pcbi.1008913.ref047" ref-type="bibr">47</xref>]. To help the reader understand the difference between SparseDOSSA’s old and new versions, we list the major updates below:</p>
      <list list-type="order">
        <list-item>
          <p>In the new version, zero-inflated log-normal modelling of microbial feature abundances is imposed on absolute abundances <italic toggle="yes">A</italic><sub><italic toggle="yes">ij</italic></sub>, instead of directly on the relative abundances <italic toggle="yes">X</italic><sub><italic toggle="yes">ij</italic></sub>, to better satisfy compositional constraints of such data types.</p>
        </list-item>
        <list-item>
          <p>Microbial feature-feature correlations are now explicitly modelled with the Gaussian copula component; this was not present in the previous version.</p>
        </list-item>
        <list-item>
          <p>For simulating new microbial features, which requires modelling of the triplet (<italic toggle="yes">π</italic><sub><italic toggle="yes">j</italic></sub>, <italic toggle="yes">μ</italic><sub><italic toggle="yes">j</italic></sub>, <italic toggle="yes">σ</italic><sub><italic toggle="yes">j</italic></sub><sup>2</sup>), the previous implementation adopted a log-normal distribution on <italic toggle="yes">μ</italic><sub><italic toggle="yes">j</italic></sub>, with corresponding linear and logit link functions for <italic toggle="yes">σ</italic><sub><italic toggle="yes">j</italic></sub> and <italic toggle="yes">π</italic><sub><italic toggle="yes">j</italic></sub>. This is relaxed in the new version with the three-dimensional nonparametric Gaussian kernel density estimator to allow for additional flexibilities.</p>
        </list-item>
        <list-item>
          <p>For spiking-in of association microbial features and metadata variables, the previous version only allows for abundance association spike-in. It also specifies effect sizes through a non-linear transformation that can be difficult for the user to interpret. The new version expanded this functionality by allowing both abundance and presence spiking-in; it also specifies effect sizes directly through linear and generalized linear models (log fold change/odds ratio), allowing more straightforward interpretations.</p>
        </list-item>
        <list-item>
          <p>The necessary algorithm and implementation changes for the aforementioned model updates, including our new EM algorithm for model fitting, updated and expanded real-world templates for direct simulation, and software interface updates.</p>
        </list-item>
      </list>
    </sec>
    <sec id="sec017">
      <title>Evaluation with real-world datasets</title>
      <p>For evaluation and comparison of microbiome simulation methods, we examined three real-world datasets with different host environments and disease statuses (<bold><xref rid="pcbi.1008913.s006" ref-type="supplementary-material">S1 Table</xref></bold>) [<xref rid="pcbi.1008913.ref002" ref-type="bibr">2</xref>,<xref rid="pcbi.1008913.ref023" ref-type="bibr">23</xref>]. We subset publicly available species level profiles from [<xref rid="pcbi.1008913.ref023" ref-type="bibr">23</xref>] (all healthy) to baseline time point stool (Stool) and posterior fornix (Vaginal) samples, and those from [<xref rid="pcbi.1008913.ref002" ref-type="bibr">2</xref>] to baseline time point IBD samples (IBD, including Crohn’s disease and ulcerative colitis patients). We additionally removed samples with lower than ~3,000 reads mapped to identified taxa and features present in less than 3 samples. The datasets’ dimensions (sample size, number of features), post processing and filtering, are included in <bold><xref rid="pcbi.1008913.s006" ref-type="supplementary-material">S1 Table</xref></bold>. A summary of all simulation evaluations performed in this work is included in <bold><xref rid="pcbi.1008913.s007" ref-type="supplementary-material">S2 Table</xref></bold>. Evaluation scripts used are publicly available at <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://github.com/biobakery/sparsedossa_paper" ext-link-type="uri">https://github.com/biobakery/sparsedossa_paper</ext-link>.</p>
      <p>To evaluate the performance of individual methods, we randomly partitioned each dataset (Stool, Vaginal, IBD) into halves for five iterations. For each partitioning, we fit the parameterization/simulation methods (DM, metaSPARSim, and SparseDOSSA 2) on one half of the data (training). We then simulated synthetic microbial observations with the same sample size using the fitted results. Lastly, we compared the synthetic observations with the other half of the partitioned data (testing) in terms of both overall dissimilarity with PERMANOVA [<xref rid="pcbi.1008913.ref025" ref-type="bibr">25</xref>] and per-feature distribution differences (methods detailed below). Within each partitioning, this simulation was also performed five times for each method. That is, each method was used to randomly simulate five synthetic datasets for comparison with the testing half. The partitioning procedure allows us to evaluate method performance without a model overfitting effect. The DM was fitted using R package “dirmult” and metaSPARSim was fitted using the implementation referred to in its publication [<xref rid="pcbi.1008913.ref018" ref-type="bibr">18</xref>]. For metaSPARSim fitting, the percent not zero filter for features was set to 0 instead of the default 0.2. In our evaluation this led to an observed performance increase (thus a favorable assessment), likely due to the existence of many highly zero inflated microbial species.</p>
      <p>To evaluate overall dissimilarity between the original and synthetic samples, for each partitioning we combined the testing half of the original samples with the simulated datasets (five for each fitted method). We calculated the sample-to-sample Bray-Curtis dissimilarity matrix <italic toggle="yes">D</italic> on the combined dataset. The univariate PERMANOVA model, <italic toggle="yes">D</italic>~<italic toggle="yes">I</italic>{<italic toggle="yes">Sample is simulated</italic>} was fitted. The corresponding <italic toggle="yes">R</italic><sup>2</sup> statistic quantifies the percentage of variability between samples attributable to the difference between original "real-world" as compared to simulated samples. Smaller <italic toggle="yes">R</italic><sup>2</sup> statistics indicate less difference, and better performance of the simulation method. For each method, a total of 25 PERMANOVA evaluations (5 original dataset partitioning × 5 simulation) was performed for each real-world dataset. Lastly, we additionally evaluated the <italic toggle="yes">R</italic><sup>2</sup> between the training and testing halves of a dataset for each partitioning; this yields an estimation of minimum achievable <italic toggle="yes">R</italic><sup>2</sup>’s for each dataset. <italic toggle="yes">R</italic><sup>2</sup>’s between methods are compared with Wilcoxon rank sum tests (<bold><xref rid="pcbi.1008913.s008" ref-type="supplementary-material">S3 Table</xref></bold>).</p>
      <p>To evaluate the difference between distributions of individual features in the original and synthetic datasets, we simply combined the synthetic datasets generated across all partitioning and simulation repetitions. An individual feature was compared for its relative abundance distribution between the original real-world data and combined synthetic samples. This was quantified with the Kolmogorov-Smirnov (K-S) summary statistic, which is defined as the largest absolute difference between the empirical cumulative distribution functions of the real-world and synthetic abundances. Smaller K-S statistics indicate better approximation of the targeted real-world distributions with the simulation method. To compare overall per-feature performance between models, the paired K-S summary statistics between SparseDOSSA 2 and alternative models (DM and metaSPARSim) were compared using Wilcoxon signed rank tests (matched by features, <bold><xref rid="pcbi.1008913.s009" ref-type="supplementary-material">S4 Table</xref></bold>).</p>
    </sec>
    <sec id="sec018">
      <title>Association spike-in evaluation</title>
      <p>We simulated spiked-in associations between microbial features and a synthetic case/control variable, based on the SparseDOSSA 2 fitted results. A total of 1,000 synthetic samples were simulated (500 cases and 500 controls). For non-zero abundance spike-in (<bold><xref rid="pcbi.1008913.g003" ref-type="fig">Fig 3A</xref></bold>), the top 5% (16 total) most prevalent features were selected for spiking-in; this yields the highest effective sample size for the selected features because our abundance spiking-in targets only the non-zero component of a feature’s distribution. Half of the features were spiked for a targeted log fold change (<italic toggle="yes">β</italic><sub><italic toggle="yes">abundance</italic></sub>) of 1 in cases compared to controls, and the other half were spiked for a log fold change of -1. Actual log fold changes in the simulated relative abundances, along with 95% confidence intervals, were calculated by performing a linear regression on the log transformed non-zero relative abundances for each feature.</p>
      <p>Similarly, for prevalence spiking-in (<bold><xref rid="pcbi.1008913.g003" ref-type="fig">Fig 3B</xref></bold>), the top 5% features with prevalence closest to 0.5 were selected; as with abundance spike-ins, this was to ensure the spiked-in features had the highest effective sample size, as the association between a binary outcome (presence/absence here) and a binary covariate (case/control) is best-powered when the sample distribution is balanced across all different outcome/covariate combinations [<xref rid="pcbi.1008913.ref048" ref-type="bibr">48</xref>]. Again, half of these features were spiked for a targeted log odds ratio (<italic toggle="yes">β</italic><sub><italic toggle="yes">prevalence</italic></sub>) of 1 in cases compared to controls, and the other half were spiked for a log odds ratio of -1. Actual log odds ratios of the simulated feature prevalence, along with 95% confidence intervals, were calculated by performing a logistic regression on the presence for each feature.</p>
      <p>For simulation of feature-feature associations, we first set the correlation between feature pairs in SparseDOSSA 2 to zero (i.e., <italic toggle="yes">Ω</italic> = <italic toggle="yes">I</italic> where <italic toggle="yes">I</italic> is the identity matrix). This ensures that feature absolute abundances are independent in the “null” dataset (<bold><xref rid="pcbi.1008913.g003" ref-type="fig">Fig 3C</xref></bold> left panel, bottom right), whereas spurious correlation still exists in relative abundances due to compositionality. Two random pairs (four features) in the top ten most abundant features were selected for non-zero feature-feature association spike-in. As specified in <bold>Methods</bold> above, we simulated two independent normal synthetic hidden metadata variables, one for each feature pair to be associated. For the first feature pair, they were spiked in both abundance and prevalence with the same effect (<italic toggle="yes">β</italic> = <italic toggle="yes">β</italic><sub><italic toggle="yes">abundance</italic></sub> = <italic toggle="yes">β</italic><sub><italic toggle="yes">prevalence</italic></sub>) at varying sizes, for positive association. The second pair were spiked with opposing effects (<italic toggle="yes">β</italic> for one, −<italic toggle="yes">β</italic> for the other) for negative association. We used Spearman correlation to estimate the empirical association between feature pairs in the simulated absolute and relative abundances. Target association effect size was also varied (<italic toggle="yes">β</italic> of 0, 1, 2, and 5) to showcase the relative signals of “true” associations that exist for both absolute and relative abundances, and spurious associations that are only induced in relative abundances due to compositionality (<bold>Figs <xref rid="pcbi.1008913.g003" ref-type="fig">3C</xref> and <xref rid="pcbi.1008913.s004" ref-type="supplementary-material">S4</xref></bold>).</p>
    </sec>
    <sec id="sec019">
      <title>Benchmarking</title>
      <p>Since “true” associations with prescribed effect sizes are known for SparseDOSSA synthetic datasets, they can be used for benchmarking microbiome analysis methods as well as for power analysis of microbiome study designs. For benchmarking analysis (<bold><xref rid="pcbi.1008913.g004" ref-type="fig">Fig 4A</xref></bold>), we again selected the top 5% (16 total) most prevalent features in the Stool dataset to perform abundance spike-in, such that the selected features had the highest effective sample size. A total of 200 microbial profiles were simulated to be associated with a balanced binary metadata (100 cases, 100 controls). We varied effect sizes with half spiked features at <italic toggle="yes">β</italic><sub><italic toggle="yes">abundance</italic></sub> = (0, 0.5, 1.2) and the other half with <italic toggle="yes">β</italic><sub><italic toggle="yes">abundance</italic></sub> = (0, −0.5, −1, −2), correspondingly (in the effect size 0 case no spike-in was performed and microbial profiles are generated independently of metadata). A total of 500 random simulations were performed for each parameter combination. We applied existing differential abundance analysis methods to detect the spiked-in features in each simulation dataset [<xref rid="pcbi.1008913.ref029" ref-type="bibr">29</xref>–<xref rid="pcbi.1008913.ref031" ref-type="bibr">31</xref>], with individual method configurations as reported in our previous benchmarking analysis [<xref rid="pcbi.1008913.ref029" ref-type="bibr">29</xref>]. We summarized the empirical power and FDR of a method in one simulation dataset, across the twenty random replicates for each parameter configuration, and reported the mean and standard error in <bold><xref rid="pcbi.1008913.g004" ref-type="fig">Fig 4A</xref></bold>.</p>
    </sec>
    <sec id="sec020">
      <title>Power analysis</title>
      <p>For showcasing SparseDOSSA’s utility in a power analysis, we spiked in non-zero abundance associations with a balanced case-control variable for a simulated species parameterized by fitting <italic toggle="yes">Escherichia coli</italic>. This was performed at varying effect sizes (log fold change, <italic toggle="yes">β</italic><sub><italic toggle="yes">abundance</italic></sub> = (0.5, 1, 2)) and sample sizes (100 to 1000). For each parameter configuration, a total of 500 replicates were simulated. The empirical power and its standard error of using MaAsLin 2 to detect the differential abundant effect in "<italic toggle="yes">E</italic>. <italic toggle="yes">coli</italic>" was summarized across the 500 replicates and reported in <bold><xref rid="pcbi.1008913.g004" ref-type="fig">Fig 4B</xref></bold>; this was repeated for each effect size/sample size configuration.</p>
      <p>While it remains to build a more formal power analysis using these models, we recommend the following guidelines if using SparseDOSSA directly:</p>
      <list list-type="bullet">
        <list-item>
          <p>Based on the planned study design, if a pilot data set is available, the fitting functionality can be used to estimate the parameters that would generate similar data sets. Otherwise, researchers can adopt one of the pre-fitted templates that best approximate their target environment.</p>
        </list-item>
        <list-item>
          <p>Researchers can then simulate many datasets (e.g. hundreds or thousands) with the fitted parameters, across a range of spike-in effect sizes and sample sizes. We note that the SparseDOSSA 2 effect size has straightforward quantitative interpretations: log fold changes for abundance spike-in, and log odds-ratios for prevalence spike-in (details on model in <bold>Association spike-in</bold> subsection of <bold>Methods</bold>).</p>
        </list-item>
        <list-item>
          <p>This should be followed by conducting the hypothesis testing that is planned for the study on each of the simulated datasets. This allows for a measure of how often the “true” (spiked-in) associations are detected for a given sample size (i.e. statistical power). Additionally, the researcher can investigate whether other methods of testing can deliver comparable results to simulation-based estimates from SparseDOSSA 2.</p>
        </list-item>
      </list>
    </sec>
    <sec id="sec021">
      <title>Murine diet microbiome analysis</title>
      <p>We applied SparseDOSSA 2 to the longitudinal diet dataset of the mouse gut microbiome in [<xref rid="pcbi.1008913.ref024" ref-type="bibr">24</xref>], to show that our method is capable of reproducing a complex study’s findings. To recapitulate the longitudinal diet effect as reported in [<xref rid="pcbi.1008913.ref024" ref-type="bibr">24</xref>]’s <xref rid="pcbi.1008913.g001" ref-type="fig">Fig 1A</xref>, we fitted SparseDOSSA 2 separately on 1) the control Chow diet samples at baseline, 2,3) Tuber diet samples at day 1 and day 5, separately, and 4,5) Meat diet samples at day 1 and day 5, separately. This approach allows SparseDOSSA 2 to independently fit subsets of the data, without assuming <italic toggle="yes">a priori</italic> the observed differences noted in [<xref rid="pcbi.1008913.ref024" ref-type="bibr">24</xref>]. We then used SparseDOSSA 2 fitted results to simulate synthetic observations for each diet/timepoint combination, with five times the original sample size (to reduce variability due to random sampling). Bray-Curtis MDS ordination on these synthetic data displayed a striking resemblance to that observed in [<xref rid="pcbi.1008913.ref024" ref-type="bibr">24</xref>] (<bold><xref rid="pcbi.1008913.g005" ref-type="fig">Fig 5A</xref></bold>), in that a) communities cluster according to dietary treatment, and 2) this response is consistent after one day of switching from chow to whole-food diets and is strengthened at day 5.</p>
      <p>We next reproduced the differential gut microbial profiles observed in mice fed raw versus tuber diets as presented in [<xref rid="pcbi.1008913.ref024" ref-type="bibr">24</xref>]’s <xref rid="pcbi.1008913.g001" ref-type="fig">Fig 1F–1G</xref>. [<xref rid="pcbi.1008913.ref024" ref-type="bibr">24</xref>] adopted three different types of Tuber diet: the raw/free-fed (TRF), the cooked/free-fed (TCF), and the cooked/restricted (TCR). This study presented that on the phylum level, TRF induced enrichment of Bacteroidetes and depletion of Firmicutes when compared to TCF/TCR. We applied SparseDOSSA 2’s feature spike-in procedure to approximate this effect. Specifically, we generated a balanced, three category (TRF/TCF/TCR) variable. Based on our fitted model of the Tuber diet at day 5, we spiked in a two-fold (<italic toggle="yes">β</italic><sub><italic toggle="yes">abundance</italic></sub> = log 2) increase in the non-zero abundance of Bacteroidetes OTUs and a two-fold decrease in Firmicutes OTUs (<italic toggle="yes">β</italic><sub><italic toggle="yes">abundance</italic></sub> = −log 2) in TRF samples when compared to TCF/TCR samples. This roughly agrees with the presented results in [<xref rid="pcbi.1008913.ref024" ref-type="bibr">24</xref>] <xref rid="pcbi.1008913.g001" ref-type="fig">Fig 1D</xref>. We next simulated SparseDOSSA synthetic datasets for both the baseline Chow diet samples (sample size = 20), and the spiked-in Tuber diet samples (60 samples total, 20 each for TRF/TCF/TCR). We calculated the Shannon index and Firmicutes/Bacteroidetes ratios of these samples, and show in <bold><xref rid="pcbi.1008913.g005" ref-type="fig">Fig 5B</xref></bold> that they agreed with the corresponding findings presented in [<xref rid="pcbi.1008913.ref024" ref-type="bibr">24</xref>] <xref rid="pcbi.1008913.g001" ref-type="fig">Fig 1F–1G</xref>.</p>
    </sec>
  </sec>
  <sec id="sec022" sec-type="supplementary-material">
    <title>Supporting information</title>
    <supplementary-material id="pcbi.1008913.s001" position="float" content-type="local-data">
      <label>S1 Fig</label>
      <caption>
        <title>Computation time comparison between SparseDOSSA 2 and metaSPARSim, and SparseDOSSA 2’s fitting and simulation processes.</title>
        <p>All computation evaluated as run on single Intel "Cascade Lake" cores. <bold>A)</bold> SparseDOSSA 2 simulation is faster than metaSPARSim across the evaluated real-world datasets. Results were aggregated across the 25 simulation evaluations (5 original dataset partitionings × 5 simulations) for each dataset. Note that here the simulation sample size n are halved compared to the actual sample size per dataset because only half the samples were simulated according to the training-testing partitioning paradigm (<bold>Methods</bold>). <bold>B)</bold> SparseDOSSA 2 fitting requires significant computation costs up front compared to its simulation process, analogous to sequence search database indexing. These are evaluated across the grid of tuning parameter λs per real-world dataset (fitting and simulation performed for full datasets). We note that the fitting costs can be potentially alleviated by 1) the algorithm is parallelizable and implemented as such, and 2) for a target template the fitting needs to be performed only once, whereas numerous simulation repetitions are required for e.g. benchmarking or power analysis.</p>
        <p>(PDF)</p>
      </caption>
      <media xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1008913.s001.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pcbi.1008913.s002" position="float" content-type="local-data">
      <label>S2 Fig</label>
      <caption>
        <title>SparseDOSSA 2 simulated features have characteristics parameters distributed similarly to those of the real-world targets.</title>
        <p>In each case, “new” microbial features were simulated with SparseDOSA 2’s three-dimensional Gaussian kernels, and compared with the original features by examining the distribution of their absence probability <italic toggle="yes">π</italic><sub><italic toggle="yes">j</italic></sub> (logit transformed), mean log non-zero abundance <italic toggle="yes">μ</italic><sub><italic toggle="yes">j</italic></sub>, and standard deviation of log non-zero abundance <italic toggle="yes">σ</italic><sub><italic toggle="yes">j</italic></sub>.</p>
        <p>(PDF)</p>
      </caption>
      <media xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1008913.s002.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pcbi.1008913.s003" position="float" content-type="local-data">
      <label>S3 Fig</label>
      <caption>
        <title>SparseDOSSA 2’s spike-in procedure introduced targeted per-feature differential abundance and prevalence effects in the Vaginal dataset.</title>
        <p>(PDF)</p>
      </caption>
      <media xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1008913.s003.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pcbi.1008913.s004" position="float" content-type="local-data">
      <label>S4 Fig</label>
      <caption>
        <title>SparseDOSSA 2’s feature-feature correlation spike-in can induce covariation (as measured by Spearman correlation) of feature absolute abundances at different targeted effect sizes, and consequentially correlation in relative abundances while confounded by compositionality.</title>
        <p>Top row: stool community results; bottom row: vaginal community results.</p>
        <p>(PDF)</p>
      </caption>
      <media xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1008913.s004.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pcbi.1008913.s005" position="float" content-type="local-data">
      <label>S5 Fig</label>
      <caption>
        <title>SparseDOSSA simulated microbial profiles preserve important feature covariations in the human gut and vaginal environments.</title>
        <p>We simulated 100,000 microbial abundance profiles each based on the SparseDOSSA Stool and Vaginal models and examined the resulting simulated feature-feature Spearman correlations. Note that Spearman correlation does not differentiate between feature-feature correlations induced by biological interaction and compositionality; it is used purely to characterize co-variation patterns in the simulated microbial profiles, as opposed to making biological claims as to whether they are biological vs. technical. <bold>A)</bold> Simulated Spearman correlations in the top five most abundant Firmicutes-derived features (bottom left, abundance increasing top to bottom), and the top five most abundant Bacteroidetes-derived features (top right, abundance increasing bottom to top) from the Stool SparseDOSSA model. Strong positive correlations were observed among the Firmicutes species, whereas negative ones can often be observed between Firmicutes and Bacteroidetes species, as expected [<xref rid="pcbi.1008913.ref009" ref-type="bibr">9</xref>]. <bold>B)</bold> Simulated Spearman correlations in the top eight most prevalent and abundant species’ models from the Vaginal SparseDOSSA fit (bottom to top, left to right decreasing in average abundance). We observe strong co-exclusions between dominant Lactobacillus features, and positive correlations among a few less dominant species indicative of joint presence in the absence of Lactobacilli.</p>
        <p>(PDF)</p>
      </caption>
      <media xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1008913.s005.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pcbi.1008913.s006" position="float" content-type="local-data">
      <label>S1 Table</label>
      <caption>
        <title>Sample characteristics of the three real-world studies used for evaluating SparseDOSSA 2’s performance.</title>
        <p>(XLSX)</p>
      </caption>
      <media xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1008913.s006.xlsx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pcbi.1008913.s007" position="float" content-type="local-data">
      <label>S2 Table</label>
      <caption>
        <title>Summary of all simulation evaluation analyses performed in the manuscript.</title>
        <p>(XLSX)</p>
      </caption>
      <media xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1008913.s007.xlsx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pcbi.1008913.s008" position="float" content-type="local-data">
      <label>S3 Table</label>
      <caption>
        <title>Wilcoxon rank sum test p-values for the difference of <italic toggle="yes">R</italic><sup>2</sup> statistics comparing SparseDOSSA 2 against the two existing methods (corresponding to <xref rid="pcbi.1008913.g002" ref-type="fig">Fig 2B</xref>).</title>
        <p>(CSV)</p>
      </caption>
      <media xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1008913.s008.csv">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pcbi.1008913.s009" position="float" content-type="local-data">
      <label>S4 Table</label>
      <caption>
        <title>Wilcoxon signed rank test p-values for the difference of Kolmogorov-Smirnoff statistics comparing SparseDOSSA 2 against the two existing methods (corresponding to <xref rid="pcbi.1008913.g002" ref-type="fig">Fig 2D</xref>).</title>
        <p>(CSV)</p>
      </caption>
      <media xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1008913.s009.csv">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ref-list>
    <title>References</title>
    <ref id="pcbi.1008913.ref001">
      <label>1</label>
      <mixed-citation publication-type="journal"><name><surname>Mallick</surname><given-names>H</given-names></name>, <name><surname>Ma</surname><given-names>S</given-names></name>, <name><surname>Franzosa</surname><given-names>EA</given-names></name>, <name><surname>Vatanen</surname><given-names>T</given-names></name>, <name><surname>Morgan</surname><given-names>XC</given-names></name>, <name><surname>Huttenhower</surname><given-names>C</given-names></name>. <article-title>Experimental design and quantitative analysis of microbial community multiomics</article-title>. <source>Genome Biol</source>. <year>2017</year>;<volume>18</volume>(<issue>1</issue>):<fpage>228</fpage>. Epub 2017/12/01. <comment>doi: </comment><pub-id pub-id-type="doi">10.1186/s13059-017-1359-z</pub-id>; PubMed Central PMCID: PMC5708111.<?supplied-pmid 29187204?><pub-id pub-id-type="pmid">29187204</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008913.ref002">
      <label>2</label>
      <mixed-citation publication-type="journal"><name><surname>Lloyd-Price</surname><given-names>J</given-names></name>, <name><surname>Arze</surname><given-names>C</given-names></name>, <name><surname>Ananthakrishnan</surname><given-names>AN</given-names></name>, <name><surname>Schirmer</surname><given-names>M</given-names></name>, <name><surname>Avila-Pacheco</surname><given-names>J</given-names></name>, <name><surname>Poon</surname><given-names>TW</given-names></name>, <etal>et al</etal>. <article-title>Multi-omics of the gut microbial ecosystem in inflammatory bowel diseases</article-title>. <source>Nature</source>. <year>2019</year>;<volume>569</volume>(<issue>7758</issue>):<fpage>655</fpage>–<lpage>62</lpage>. Epub 2019/05/31. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/s41586-019-1237-9</pub-id> ; PubMed Central PMCID: PMC6650278.<?supplied-pmid 31142855?><pub-id pub-id-type="pmid">31142855</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008913.ref003">
      <label>3</label>
      <mixed-citation publication-type="journal"><name><surname>Wirbel</surname><given-names>J</given-names></name>, <name><surname>Pyl</surname><given-names>PT</given-names></name>, <name><surname>Kartal</surname><given-names>E</given-names></name>, <name><surname>Zych</surname><given-names>K</given-names></name>, <name><surname>Kashani</surname><given-names>A</given-names></name>, <name><surname>Milanese</surname><given-names>A</given-names></name>, <etal>et al</etal>. <article-title>Meta-analysis of fecal metagenomes reveals global microbial signatures that are specific for colorectal cancer</article-title>. <source>Nat Med</source>. <year>2019</year>;<volume>25</volume>(<issue>4</issue>):<fpage>679</fpage>–<lpage>89</lpage>. Epub 2019/04/03. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/s41591-019-0406-6</pub-id> .<?supplied-pmid 30936547?><pub-id pub-id-type="pmid">30936547</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008913.ref004">
      <label>4</label>
      <mixed-citation publication-type="journal"><name><surname>Gloor</surname><given-names>GB</given-names></name>, <name><surname>Macklaim</surname><given-names>JM</given-names></name>, <name><surname>Pawlowsky-Glahn</surname><given-names>V</given-names></name>, <name><surname>Egozcue</surname><given-names>JJ</given-names></name>. <article-title>Microbiome Datasets Are Compositional: And This Is Not Optional.</article-title><source>Front Microbiol.</source><year>2017</year>;<volume>8</volume>:<fpage>2224</fpage>. Epub 2017/12/01. <comment>doi: </comment><pub-id pub-id-type="doi">10.3389/fmicb.2017.02224</pub-id>; PubMed Central PMCID: PMC5695134.<?supplied-pmid 29187837?><pub-id pub-id-type="pmid">29187837</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008913.ref005">
      <label>5</label>
      <mixed-citation publication-type="journal"><name><surname>McMurdie</surname><given-names>PJ</given-names></name>, <name><surname>Holmes</surname><given-names>S</given-names></name>. <article-title>Waste not, want not: why rarefying microbiome data is inadmissible.</article-title><source>PLoS Comput Biol</source>. <year>2014</year>;<volume>10</volume>(<issue>4</issue>):<fpage>e1003531</fpage>. Epub 2014/04/05. <comment>doi: </comment><pub-id pub-id-type="doi">10.1371/journal.pcbi.1003531</pub-id>; PubMed Central PMCID: PMC3974642.<?supplied-pmid 24699258?><pub-id pub-id-type="pmid">24699258</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008913.ref006">
      <label>6</label>
      <mixed-citation publication-type="journal"><name><surname>Qin</surname><given-names>J</given-names></name>, <name><surname>Li</surname><given-names>Y</given-names></name>, <name><surname>Cai</surname><given-names>Z</given-names></name>, <name><surname>Li</surname><given-names>S</given-names></name>, <name><surname>Zhu</surname><given-names>J</given-names></name>, <name><surname>Zhang</surname><given-names>F</given-names></name>, <etal>et al</etal>. <article-title>A metagenome-wide association study of gut microbiota in type 2 diabetes</article-title>. <source>Nature</source>. <year>2012</year>;<volume>490</volume>(<issue>7418</issue>):<fpage>55</fpage>–<lpage>60</lpage>. Epub 2012/10/02. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/nature11450</pub-id> .<?supplied-pmid 23023125?><pub-id pub-id-type="pmid">23023125</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008913.ref007">
      <label>7</label>
      <mixed-citation publication-type="journal"><name><surname>Forslund</surname><given-names>K</given-names></name>, <name><surname>Hildebrand</surname><given-names>F</given-names></name>, <name><surname>Nielsen</surname><given-names>T</given-names></name>, <name><surname>Falony</surname><given-names>G</given-names></name>, <name><surname>Le Chatelier</surname><given-names>E</given-names></name>, <name><surname>Sunagawa</surname><given-names>S</given-names></name>, <etal>et al</etal>. <article-title>Disentangling type 2 diabetes and metformin treatment signatures in the human gut microbiota</article-title>. <source>Nature</source>. <year>2015</year>;<volume>528</volume>(<issue>7581</issue>):<fpage>262</fpage>–<lpage>6</lpage>. Epub 2015/12/04. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/nature15766</pub-id> ; PubMed Central PMCID: PMC4681099.<?supplied-pmid 26633628?><pub-id pub-id-type="pmid">26633628</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008913.ref008">
      <label>8</label>
      <mixed-citation publication-type="journal"><name><surname>Sinha</surname><given-names>R</given-names></name>, <name><surname>Abu-Ali</surname><given-names>G</given-names></name>, <name><surname>Vogtmann</surname><given-names>E</given-names></name>, <name><surname>Fodor</surname><given-names>AA</given-names></name>, <name><surname>Ren</surname><given-names>B</given-names></name>, <name><surname>Amir</surname><given-names>A</given-names></name>, <etal>et al</etal>. <article-title>Assessment of variation in microbial community amplicon sequencing by the Microbiome Quality Control (MBQC) project consortium.</article-title><source>Nat Biotechnol</source>. <year>2017</year>;<volume>35</volume>(<issue>11</issue>):<fpage>1077</fpage>–<lpage>86</lpage>. Epub 2017/10/03. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/nbt.3981</pub-id> ; PubMed Central PMCID: PMC5839636.<?supplied-pmid 28967885?><pub-id pub-id-type="pmid">28967885</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008913.ref009">
      <label>9</label>
      <mixed-citation publication-type="journal"><name><surname>Koren</surname><given-names>O</given-names></name>, <name><surname>Knights</surname><given-names>D</given-names></name>, <name><surname>Gonzalez</surname><given-names>A</given-names></name>, <name><surname>Waldron</surname><given-names>L</given-names></name>, <name><surname>Segata</surname><given-names>N</given-names></name>, <name><surname>Knight</surname><given-names>R</given-names></name>, <etal>et al</etal>. <article-title>A guide to enterotypes across the human body: meta-analysis of microbial community structures in human microbiome datasets.</article-title><source>PLoS Comput Biol</source>. <year>2013</year>;<volume>9</volume>(<issue>1</issue>):<fpage>e1002863</fpage>. Epub 2013/01/18. <comment>doi: </comment><pub-id pub-id-type="doi">10.1371/journal.pcbi.1002863</pub-id>; PubMed Central PMCID: PMC3542080.<?supplied-pmid 23326225?><pub-id pub-id-type="pmid">23326225</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008913.ref010">
      <label>10</label>
      <mixed-citation publication-type="journal"><name><surname>Tusher</surname><given-names>VG</given-names></name>, <name><surname>Tibshirani</surname><given-names>R</given-names></name>, <name><surname>Chu</surname><given-names>G</given-names></name>. <article-title>Significance analysis of microarrays applied to the ionizing radiation response</article-title>. <source>Proc Natl Acad Sci U S A</source>. <year>2001</year>;<volume>98</volume>(<issue>9</issue>):<fpage>5116</fpage>–<lpage>21</lpage>. Epub 2001/04/20. <comment>doi: </comment><pub-id pub-id-type="doi">10.1073/pnas.091062498</pub-id> ; PubMed Central PMCID: PMC33173.<?supplied-pmid 11309499?><pub-id pub-id-type="pmid">11309499</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008913.ref011">
      <label>11</label>
      <mixed-citation publication-type="journal"><name><surname>Irizarry</surname><given-names>RA</given-names></name>, <name><surname>Hobbs</surname><given-names>B</given-names></name>, <name><surname>Collin</surname><given-names>F</given-names></name>, <name><surname>Beazer-Barclay</surname><given-names>YD</given-names></name>, <name><surname>Antonellis</surname><given-names>KJ</given-names></name>, <name><surname>Scherf</surname><given-names>U</given-names></name>, <etal>et al</etal>. <article-title>Exploration, normalization, and summaries of high density oligonucleotide array probe level data.</article-title><source>Biostatistics</source>. <year>2003</year>;<volume>4</volume>(<issue>2</issue>):<fpage>249</fpage>–<lpage>64</lpage>. Epub 2003/08/20. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/biostatistics/4.2.249</pub-id> .<?supplied-pmid 12925520?><pub-id pub-id-type="pmid">12925520</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008913.ref012">
      <label>12</label>
      <mixed-citation publication-type="journal"><name><surname>Nykter</surname><given-names>M</given-names></name>, <name><surname>Aho</surname><given-names>T</given-names></name>, <name><surname>Ahdesmaki</surname><given-names>M</given-names></name>, <name><surname>Ruusuvuori</surname><given-names>P</given-names></name>, <name><surname>Lehmussola</surname><given-names>A</given-names></name>, <name><surname>Yli-Harja</surname><given-names>O</given-names></name>. <article-title>Simulation of microarray data with realistic characteristics</article-title>. <source>BMC Bioinformatics</source>. <year>2006</year>;<volume>7</volume>:<fpage>349</fpage>. Epub 2006/07/20. <comment>doi: </comment><pub-id pub-id-type="doi">10.1186/1471-2105-7-349</pub-id>; PubMed Central PMCID: PMC1574357.<?supplied-pmid 16848902?><pub-id pub-id-type="pmid">16848902</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008913.ref013">
      <label>13</label>
      <mixed-citation publication-type="journal"><name><surname>Park</surname><given-names>T</given-names></name>, <name><surname>Yi</surname><given-names>SG</given-names></name>, <name><surname>Kang</surname><given-names>SH</given-names></name>, <name><surname>Lee</surname><given-names>S</given-names></name>, <name><surname>Lee</surname><given-names>YS</given-names></name>, <name><surname>Simon</surname><given-names>R</given-names></name>. <article-title>Evaluation of normalization methods for microarray data</article-title>. <source>BMC Bioinformatics</source>. <year>2003</year>;<volume>4</volume>:<fpage>33</fpage>. Epub 2003/09/03. <comment>doi: </comment><pub-id pub-id-type="doi">10.1186/1471-2105-4-33</pub-id>; PubMed Central PMCID: PMC200968.<?supplied-pmid 12950995?><pub-id pub-id-type="pmid">12950995</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008913.ref014">
      <label>14</label>
      <mixed-citation publication-type="journal"><name><surname>Huang</surname><given-names>W</given-names></name>, <name><surname>Li</surname><given-names>L</given-names></name>, <name><surname>Myers</surname><given-names>JR</given-names></name>, <name><surname>Marth</surname><given-names>GT</given-names></name>. <article-title>ART: a next-generation sequencing read simulator</article-title>. <source>Bioinformatics</source>. <year>2012</year>;<volume>28</volume>(<issue>4</issue>):<fpage>593</fpage>–<lpage>4</lpage>. Epub 2011/12/27. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/bioinformatics/btr708</pub-id> ; PubMed Central PMCID: PMC3278762.<?supplied-pmid 22199392?><pub-id pub-id-type="pmid">22199392</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008913.ref015">
      <label>15</label>
      <mixed-citation publication-type="journal"><name><surname>Schwager</surname><given-names>E</given-names></name>, <name><surname>Mallick</surname><given-names>H</given-names></name>, <name><surname>Ventz</surname><given-names>S</given-names></name>, <name><surname>Huttenhower</surname><given-names>C</given-names></name>. <article-title>A Bayesian method for detecting pairwise associations in compositional data.</article-title><source>PLoS Comput Biol</source>. <year>2017</year>;<volume>13</volume>(<issue>11</issue>):<fpage>e1005852</fpage>. Epub 2017/11/16. <comment>doi: </comment><pub-id pub-id-type="doi">10.1371/journal.pcbi.1005852</pub-id>; PubMed Central PMCID: PMC5706738.<?supplied-pmid 29140991?><pub-id pub-id-type="pmid">29140991</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008913.ref016">
      <label>16</label>
      <mixed-citation publication-type="journal"><name><surname>Paulson</surname><given-names>JN</given-names></name>, <name><surname>Stine</surname><given-names>OC</given-names></name>, <name><surname>Bravo</surname><given-names>HC</given-names></name>, <name><surname>Pop</surname><given-names>M</given-names></name>. <article-title>Differential abundance analysis for microbial marker-gene surveys.</article-title><source>Nat Methods.</source><year>2013</year>;<volume>10</volume>(<issue>12</issue>):<fpage>1200</fpage>–<lpage>2</lpage>. Epub 2013/10/01. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/nmeth.2658</pub-id> ; PubMed Central PMCID: PMC4010126.<?supplied-pmid 24076764?><pub-id pub-id-type="pmid">24076764</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008913.ref017">
      <label>17</label>
      <mixed-citation publication-type="journal"><name><surname>Thorsen</surname><given-names>J</given-names></name>, <name><surname>Brejnrod</surname><given-names>A</given-names></name>, <name><surname>Mortensen</surname><given-names>M</given-names></name>, <name><surname>Rasmussen</surname><given-names>MA</given-names></name>, <name><surname>Stokholm</surname><given-names>J</given-names></name>, <name><surname>Al-Soud</surname><given-names>WA</given-names></name>, <etal>et al</etal>. <article-title>Large-scale benchmarking reveals false discoveries and count transformation sensitivity in 16S rRNA gene amplicon data analysis methods used in microbiome studies</article-title>. <source>Microbiome</source>. <year>2016</year>;<volume>4</volume>(<issue>1</issue>):<fpage>62</fpage>. Epub 2016/11/26. <comment>doi: </comment><pub-id pub-id-type="doi">10.1186/s40168-016-0208-8</pub-id>; PubMed Central PMCID: PMC5123278.<?supplied-pmid 27884206?><pub-id pub-id-type="pmid">27884206</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008913.ref018">
      <label>18</label>
      <mixed-citation publication-type="journal"><name><surname>Patuzzi</surname><given-names>I</given-names></name>, <name><surname>Baruzzo</surname><given-names>G</given-names></name>, <name><surname>Losasso</surname><given-names>C</given-names></name>, <name><surname>Ricci</surname><given-names>A</given-names></name>, <name><surname>Di Camillo</surname><given-names>B</given-names></name>. <article-title>metaSPARSim: a 16S rRNA gene sequencing count data simulator</article-title>. <source>BMC Bioinformatics</source>. <year>2019</year>;<volume>20</volume>(<issue>Suppl 9</issue>):<fpage>416</fpage>. Epub 2019/11/24. <comment>doi: </comment><pub-id pub-id-type="doi">10.1186/s12859-019-2882-6</pub-id>; PubMed Central PMCID: PMC6873395.<?supplied-pmid 31757204?><pub-id pub-id-type="pmid">31757204</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008913.ref019">
      <label>19</label>
      <mixed-citation publication-type="journal"><name><surname>Prost</surname><given-names>V</given-names></name>, <name><surname>Gazut</surname><given-names>S</given-names></name>, <name><surname>Bruls</surname><given-names>T</given-names></name>. <article-title>A zero inflated log-normal model for inference of sparse microbial association networks.</article-title><source>PLoS Comput Biol</source>. <year>2021</year>;<volume>17</volume>(<issue>6</issue>):<fpage>e1009089</fpage>. Epub 2021/06/19. <comment>doi: </comment><pub-id pub-id-type="doi">10.1371/journal.pcbi.1009089</pub-id>; PubMed Central PMCID: PMC8244920.<?supplied-pmid 34143768?><pub-id pub-id-type="pmid">34143768</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008913.ref020">
      <label>20</label>
      <mixed-citation publication-type="journal"><name><surname>Chen</surname><given-names>J</given-names></name>, <name><surname>Li</surname><given-names>H</given-names></name>. <article-title>Variable Selection for Sparse Dirichlet-Multinomial Regression with an Application to Microbiome Data Analysis.</article-title><source>Ann Appl Stat.</source><year>2013</year>;<volume>7</volume>(<issue>1</issue>). Epub 2013/12/07. <comment>doi: </comment><pub-id pub-id-type="doi">10.1214/12-AOAS592</pub-id>; PubMed Central PMCID: PMC3846354.<?supplied-pmid 24312162?><pub-id pub-id-type="pmid">24312162</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008913.ref021">
      <label>21</label>
      <mixed-citation publication-type="journal"><name><surname>Murray</surname><given-names>JS</given-names></name>, <name><surname>Dunson</surname><given-names>DB</given-names></name>, <name><surname>Carin</surname><given-names>L</given-names></name>, <name><surname>Lucas</surname><given-names>JE</given-names></name>. <article-title>Bayesian Gaussian Copula Factor Models for Mixed Data</article-title>. <source>J Am Stat Assoc</source>. <year>2013</year>;<volume>108</volume>(<issue>502</issue>):<fpage>656</fpage>–<lpage>65</lpage>. Epub 2013/08/31. <comment>doi: </comment><pub-id pub-id-type="doi">10.1080/01621459.2012.762328</pub-id> ; PubMed Central PMCID: PMC3753118.<?supplied-pmid 23990691?><pub-id pub-id-type="pmid">23990691</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008913.ref022">
      <label>22</label>
      <mixed-citation publication-type="journal"><name><surname>Friedman</surname><given-names>J</given-names></name>, <name><surname>Hastie</surname><given-names>T</given-names></name>, <name><surname>Tibshirani</surname><given-names>R</given-names></name>. <article-title>Sparse inverse covariance estimation with the graphical lasso.</article-title><source>Biostatistics</source>. <year>2008</year>;<volume>9</volume>(<issue>3</issue>):<fpage>432</fpage>–<lpage>41</lpage>. Epub 2007/12/15. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/biostatistics/kxm045</pub-id> ; PubMed Central PMCID: PMC3019769.<?supplied-pmid 18079126?><pub-id pub-id-type="pmid">18079126</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008913.ref023">
      <label>23</label>
      <mixed-citation publication-type="journal"><name><surname>Lloyd-Price</surname><given-names>J</given-names></name>, <name><surname>Mahurkar</surname><given-names>A</given-names></name>, <name><surname>Rahnavard</surname><given-names>G</given-names></name>, <name><surname>Crabtree</surname><given-names>J</given-names></name>, <name><surname>Orvis</surname><given-names>J</given-names></name>, <name><surname>Hall</surname><given-names>AB</given-names></name>, <etal>et al</etal>. <article-title>Strains, functions and dynamics in the expanded Human Microbiome Project</article-title>. <source>Nature</source>. <year>2017</year>;<volume>550</volume>(<issue>7674</issue>):<fpage>61</fpage>–<lpage>6</lpage>. Epub 2017/09/28. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/nature23889</pub-id> ; PubMed Central PMCID: PMC5831082.<?supplied-pmid 28953883?><pub-id pub-id-type="pmid">28953883</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008913.ref024">
      <label>24</label>
      <mixed-citation publication-type="journal"><name><surname>Carmody</surname><given-names>RN</given-names></name>, <name><surname>Bisanz</surname><given-names>JE</given-names></name>, <name><surname>Bowen</surname><given-names>BP</given-names></name>, <name><surname>Maurice</surname><given-names>CF</given-names></name>, <name><surname>Lyalina</surname><given-names>S</given-names></name>, <name><surname>Louie</surname><given-names>KB</given-names></name>, <etal>et al</etal>. <article-title>Cooking shapes the structure and function of the gut microbiome.</article-title><source>Nat Microbiol.</source><year>2019</year>;<volume>4</volume>(<issue>12</issue>):<fpage>2052</fpage>–<lpage>63</lpage>. Epub 2019/10/02. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/s41564-019-0569-4</pub-id> ; PubMed Central PMCID: PMC6886678.<?supplied-pmid 31570867?><pub-id pub-id-type="pmid">31570867</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008913.ref025">
      <label>25</label>
      <mixed-citation publication-type="journal"><name><surname>Tang</surname><given-names>ZZ</given-names></name>, <name><surname>Chen</surname><given-names>G</given-names></name>, <name><surname>Alekseyenko</surname><given-names>AV</given-names></name>. <article-title>PERMANOVA-S: association test for microbial community composition that accommodates confounders and multiple distances</article-title>. <source>Bioinformatics</source>. <year>2016</year>;<volume>32</volume>(<issue>17</issue>):<fpage>2618</fpage>–<lpage>25</lpage>. Epub 2016/05/21. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/bioinformatics/btw311</pub-id> ; PubMed Central PMCID: PMC5013911.<?supplied-pmid 27197815?><pub-id pub-id-type="pmid">27197815</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008913.ref026">
      <label>26</label>
      <mixed-citation publication-type="journal"><name><surname>Ravel</surname><given-names>J</given-names></name>, <name><surname>Gajer</surname><given-names>P</given-names></name>, <name><surname>Abdo</surname><given-names>Z</given-names></name>, <name><surname>Schneider</surname><given-names>GM</given-names></name>, <name><surname>Koenig</surname><given-names>SS</given-names></name>, <name><surname>McCulle</surname><given-names>SL</given-names></name>, <etal>et al</etal>. <article-title>Vaginal microbiome of reproductive-age women</article-title>. <source>Proc Natl Acad Sci U S A</source>. <year>2011</year>;<volume>108</volume><issue>Suppl 1</issue>:<fpage>4680</fpage>–<lpage>7</lpage>. Epub 2010/06/11. <comment>doi: </comment><pub-id pub-id-type="doi">10.1073/pnas.1002611107</pub-id> ; PubMed Central PMCID: PMC3063603.<?supplied-pmid 20534435?><pub-id pub-id-type="pmid">20534435</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008913.ref027">
      <label>27</label>
      <mixed-citation publication-type="journal"><name><surname>Cao</surname><given-names>Y</given-names></name>, <name><surname>Lin</surname><given-names>W</given-names></name>, <name><surname>Li</surname><given-names>H</given-names></name>. <article-title>Large covariance estimation for compositional data via composition-adjusted thresholding</article-title>. <source>Journal of the American Statistical Association</source>. <year>2019</year>;<volume>114</volume>(<issue>526</issue>):<fpage>759</fpage>–<lpage>72</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1080/01621459.2018.1442340</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008913.ref028">
      <label>28</label>
      <mixed-citation publication-type="journal"><name><surname>Kurtz</surname><given-names>ZD</given-names></name>, <name><surname>Muller</surname><given-names>CL</given-names></name>, <name><surname>Miraldi</surname><given-names>ER</given-names></name>, <name><surname>Littman</surname><given-names>DR</given-names></name>, <name><surname>Blaser</surname><given-names>MJ</given-names></name>, <name><surname>Bonneau</surname><given-names>RA</given-names></name>. <article-title>Sparse and compositionally robust inference of microbial ecological networks.</article-title><source>PLoS Comput Biol</source>. <year>2015</year>;<volume>11</volume>(<issue>5</issue>):<fpage>e1004226</fpage>. Epub 2015/05/08. <comment>doi: </comment><pub-id pub-id-type="doi">10.1371/journal.pcbi.1004226</pub-id>; PubMed Central PMCID: PMC4423992.<?supplied-pmid 25950956?><pub-id pub-id-type="pmid">25950956</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008913.ref029">
      <label>29</label>
      <mixed-citation publication-type="journal"><name><surname>Mallick</surname><given-names>H</given-names></name>, <name><surname>Rahnavard</surname><given-names>A</given-names></name>, <name><surname>McIver</surname><given-names>LJ</given-names></name>, <name><surname>Ma</surname><given-names>S</given-names></name>, <name><surname>Zhang</surname><given-names>Y</given-names></name>, <name><surname>Nguyen</surname><given-names>LH</given-names></name>, <etal>et al</etal>. <article-title>Multivariable Association Discovery in Population-scale Meta-omics Studies.</article-title><source>bioRxiv</source>. <year>2021</year>:<fpage>2021</fpage>.01.20.427420. <comment>doi: </comment><pub-id pub-id-type="doi">10.1101/2021.01.20.427420</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008913.ref030">
      <label>30</label>
      <mixed-citation publication-type="journal"><name><surname>Law</surname><given-names>CW</given-names></name>, <name><surname>Chen</surname><given-names>Y</given-names></name>, <name><surname>Shi</surname><given-names>W</given-names></name>, <name><surname>Smyth</surname><given-names>GK</given-names></name>. <article-title>voom: Precision weights unlock linear model analysis tools for RNA-seq read counts</article-title>. <source>Genome Biol</source>. <year>2014</year>;<volume>15</volume>(<issue>2</issue>):<fpage>R29</fpage>. Epub 2014/02/04. <comment>doi: </comment><pub-id pub-id-type="doi">10.1186/gb-2014-15-2-r29</pub-id>; PubMed Central PMCID: PMC4053721.<?supplied-pmid 24485249?><pub-id pub-id-type="pmid">24485249</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008913.ref031">
      <label>31</label>
      <mixed-citation publication-type="journal"><name><surname>Mandal</surname><given-names>S</given-names></name>, <name><surname>Van Treuren</surname><given-names>W</given-names></name>, <name><surname>White</surname><given-names>RA</given-names></name>, <name><surname>Eggesbo</surname><given-names>M</given-names></name>, <name><surname>Knight</surname><given-names>R</given-names></name>, <name><surname>Peddada</surname><given-names>SD</given-names></name>. <article-title>Analysis of composition of microbiomes: a novel method for studying microbial composition.</article-title><source>Microb Ecol Health Dis</source>. <year>2015</year>;<volume>26</volume>:<fpage>27663</fpage>. Epub 2015/06/02. <comment>doi: </comment><pub-id pub-id-type="doi">10.3402/mehd.v26.27663</pub-id>; PubMed Central PMCID: PMC4450248.<?supplied-pmid 26028277?><pub-id pub-id-type="pmid">26028277</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008913.ref032">
      <label>32</label>
      <mixed-citation publication-type="journal"><name><surname>Zhou</surname><given-names>YH</given-names></name>, <name><surname>Xia</surname><given-names>K</given-names></name>, <name><surname>Wright</surname><given-names>FA</given-names></name>. <article-title>A powerful and flexible approach to the analysis of RNA sequence count data</article-title>. <source>Bioinformatics</source>. <year>2011</year>;<volume>27</volume>(<issue>19</issue>):<fpage>2672</fpage>–<lpage>8</lpage>. Epub 2011/08/04. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/bioinformatics/btr449</pub-id> ; PubMed Central PMCID: PMC3179656.<?supplied-pmid 21810900?><pub-id pub-id-type="pmid">21810900</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008913.ref033">
      <label>33</label>
      <mixed-citation publication-type="journal"><name><surname>Morgan</surname><given-names>XC</given-names></name>, <name><surname>Tickle</surname><given-names>TL</given-names></name>, <name><surname>Sokol</surname><given-names>H</given-names></name>, <name><surname>Gevers</surname><given-names>D</given-names></name>, <name><surname>Devaney</surname><given-names>KL</given-names></name>, <name><surname>Ward</surname><given-names>DV</given-names></name>, <etal>et al</etal>. <article-title>Dysfunction of the intestinal microbiome in inflammatory bowel disease and treatment</article-title>. <source>Genome Biol</source>. <year>2012</year>;<volume>13</volume>(<issue>9</issue>):<fpage>R79</fpage>. Epub 2012/09/28. <comment>doi: </comment><pub-id pub-id-type="doi">10.1186/gb-2012-13-9-r79</pub-id>; PubMed Central PMCID: PMC3506950.<?supplied-pmid 23013615?><pub-id pub-id-type="pmid">23013615</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008913.ref034">
      <label>34</label>
      <mixed-citation publication-type="journal"><name><surname>Zhao</surname><given-names>N</given-names></name>, <name><surname>Chen</surname><given-names>J</given-names></name>, <name><surname>Carroll</surname><given-names>IM</given-names></name>, <name><surname>Ringel-Kulka</surname><given-names>T</given-names></name>, <name><surname>Epstein</surname><given-names>MP</given-names></name>, <name><surname>Zhou</surname><given-names>H</given-names></name>, <etal>et al</etal>. <article-title>Testing in Microbiome-Profiling Studies with MiRKAT, the Microbiome Regression-Based Kernel Association Test</article-title>. <source>Am J Hum Genet</source>. <year>2015</year>;<volume>96</volume>(<issue>5</issue>):<fpage>797</fpage>–<lpage>807</lpage>. Epub 2015/05/11. <comment>doi: </comment><pub-id pub-id-type="doi">10.1016/j.ajhg.2015.04.003</pub-id> ; PubMed Central PMCID: PMC4570290.<?supplied-pmid 25957468?><pub-id pub-id-type="pmid">25957468</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008913.ref035">
      <label>35</label>
      <mixed-citation publication-type="journal"><name><surname>McMurdie</surname><given-names>PJ</given-names></name>, <name><surname>Holmes</surname><given-names>S</given-names></name>. <article-title>phyloseq: an R package for reproducible interactive analysis and graphics of microbiome census data.</article-title><source>PLoS One.</source><year>2013</year>;<volume>8</volume>(<issue>4</issue>):<fpage>e61217</fpage>. Epub 2013/05/01. <comment>doi: </comment><pub-id pub-id-type="doi">10.1371/journal.pone.0061217</pub-id>; PubMed Central PMCID: PMC3632530.<?supplied-pmid 23630581?><pub-id pub-id-type="pmid">23630581</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008913.ref036">
      <label>36</label>
      <mixed-citation publication-type="journal"><name><surname>Weiss</surname><given-names>S</given-names></name>, <name><surname>Van Treuren</surname><given-names>W</given-names></name>, <name><surname>Lozupone</surname><given-names>C</given-names></name>, <name><surname>Faust</surname><given-names>K</given-names></name>, <name><surname>Friedman</surname><given-names>J</given-names></name>, <name><surname>Deng</surname><given-names>Y</given-names></name>, <etal>et al</etal>. <article-title>Correlation detection strategies in microbial data sets vary widely in sensitivity and precision.</article-title><source>ISME J.</source><year>2016</year>;<volume>10</volume>(<issue>7</issue>):<fpage>1669</fpage>–<lpage>81</lpage>. Epub 2016/02/26. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/ismej.2015.235</pub-id> ; PubMed Central PMCID: PMC4918442.<?supplied-pmid 26905627?><pub-id pub-id-type="pmid">26905627</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008913.ref037">
      <label>37</label>
      <mixed-citation publication-type="journal"><name><surname>Friedman</surname><given-names>J</given-names></name>, <name><surname>Alm</surname><given-names>EJ</given-names></name>. <article-title>Inferring correlation networks from genomic survey data.</article-title><source>PLoS Comput Biol</source>. <year>2012</year>;<volume>8</volume>(<issue>9</issue>):<fpage>e1002687</fpage>. Epub 2012/10/03. <comment>doi: </comment><pub-id pub-id-type="doi">10.1371/journal.pcbi.1002687</pub-id>; PubMed Central PMCID: PMC3447976.<?supplied-pmid 23028285?><pub-id pub-id-type="pmid">23028285</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008913.ref038">
      <label>38</label>
      <mixed-citation publication-type="journal"><name><surname>Tett</surname><given-names>A</given-names></name>, <name><surname>Huang</surname><given-names>KD</given-names></name>, <name><surname>Asnicar</surname><given-names>F</given-names></name>, <name><surname>Fehlner-Peach</surname><given-names>H</given-names></name>, <name><surname>Pasolli</surname><given-names>E</given-names></name>, <name><surname>Karcher</surname><given-names>N</given-names></name>, <etal>et al</etal>. <article-title>The Prevotella copri Complex Comprises Four Distinct Clades Underrepresented in Westernized Populations.</article-title><source>Cell Host Microbe</source>. <year>2019</year>;<volume>26</volume>(<issue>5</issue>):<fpage>666</fpage>–<lpage>79</lpage> e7. Epub 2019/10/15. <comment>doi: </comment><pub-id pub-id-type="doi">10.1016/j.chom.2019.08.018</pub-id> ; PubMed Central PMCID: PMC6854460.<?supplied-pmid 31607556?><pub-id pub-id-type="pmid">31607556</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008913.ref039">
      <label>39</label>
      <mixed-citation publication-type="journal"><name><surname>Li</surname><given-names>L</given-names></name>, <name><surname>Ma</surname><given-names>ZS</given-names></name>. <article-title>Testing the Neutral Theory of Biodiversity with Human Microbiome Datasets.</article-title><source>Sci Rep.</source><year>2016</year>;<volume>6</volume>:<fpage>31448</fpage>. Epub 2016/08/17. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/srep31448</pub-id>; PubMed Central PMCID: PMC4985628.<?supplied-pmid 27527985?><pub-id pub-id-type="pmid">27527985</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008913.ref040">
      <label>40</label>
      <mixed-citation publication-type="journal"><name><surname>Pragman</surname><given-names>AA</given-names></name>, <name><surname>Knutson</surname><given-names>KA</given-names></name>, <name><surname>Gould</surname><given-names>TJ</given-names></name>, <name><surname>Hodgson</surname><given-names>SW</given-names></name>, <name><surname>Isaacson</surname><given-names>RE</given-names></name>, <name><surname>Reilly</surname><given-names>CS</given-names></name>, <etal>et al</etal>. <article-title>Chronic obstructive pulmonary disease upper airway microbiome is associated with select clinical characteristics.</article-title><source>PLoS One.</source><year>2019</year>;<volume>14</volume>(<issue>7</issue>):<fpage>e0219962</fpage>. Epub 2019/07/25. <comment>doi: </comment><pub-id pub-id-type="doi">10.1371/journal.pone.0219962</pub-id>; PubMed Central PMCID: PMC6650084.<?supplied-pmid 31335912?><pub-id pub-id-type="pmid">31335912</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008913.ref041">
      <label>41</label>
      <mixed-citation publication-type="journal"><name><surname>Bajorek</surname><given-names>S</given-names></name>, <name><surname>Parker</surname><given-names>L</given-names></name>, <name><surname>Li</surname><given-names>N</given-names></name>, <name><surname>Winglee</surname><given-names>K</given-names></name>, <name><surname>Weaver</surname><given-names>M</given-names></name>, <name><surname>Johnson</surname><given-names>J</given-names></name>, <etal>et al</etal>. <article-title>Initial microbial community of the neonatal stomach immediately after birth</article-title>. <source>Gut Microbes</source>. <year>2019</year>;<volume>10</volume>(<issue>3</issue>):<fpage>289</fpage>–<lpage>97</lpage>. Epub 2018/11/09. <comment>doi: </comment><pub-id pub-id-type="doi">10.1080/19490976.2018.1520578</pub-id> ; PubMed Central PMCID: PMC6546338.<?supplied-pmid 30404568?><pub-id pub-id-type="pmid">30404568</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008913.ref042">
      <label>42</label>
      <mixed-citation publication-type="journal"><name><surname>Vandeputte</surname><given-names>D</given-names></name>, <name><surname>Kathagen</surname><given-names>G</given-names></name>, <name><surname>D’Hoe</surname><given-names>K</given-names></name>, <name><surname>Vieira-Silva</surname><given-names>S</given-names></name>, <name><surname>Valles-Colomer</surname><given-names>M</given-names></name>, <name><surname>Sabino</surname><given-names>J</given-names></name>, <etal>et al</etal>. <article-title>Quantitative microbiome profiling links gut community variation to microbial load</article-title>. <source>Nature</source>. <year>2017</year>;<volume>551</volume>(<issue>7681</issue>):<fpage>507</fpage>–<lpage>11</lpage>. Epub 2017/11/17. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/nature24460</pub-id> .<?supplied-pmid 29143816?><pub-id pub-id-type="pmid">29143816</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008913.ref043">
      <label>43</label>
      <mixed-citation publication-type="journal"><name><surname>Fang</surname><given-names>H</given-names></name>, <name><surname>Huang</surname><given-names>C</given-names></name>, <name><surname>Zhao</surname><given-names>H</given-names></name>, <name><surname>Deng</surname><given-names>M</given-names></name>. <article-title>gCoda: Conditional Dependence Network Inference for Compositional Data</article-title>. <source>J Comput Biol</source>. <year>2017</year>;<volume>24</volume>(<issue>7</issue>):<fpage>699</fpage>–<lpage>708</lpage>. Epub 2017/05/11. <comment>doi: </comment><pub-id pub-id-type="doi">10.1089/cmb.2017.0054</pub-id> ; PubMed Central PMCID: PMC5510714.<?supplied-pmid 28489411?><pub-id pub-id-type="pmid">28489411</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008913.ref044">
      <label>44</label>
      <mixed-citation publication-type="journal"><name><surname>Dempster</surname><given-names>AP</given-names></name>, <name><surname>Laird</surname><given-names>NM</given-names></name>, <name><surname>Rubin</surname><given-names>DB</given-names></name>. <article-title>Maximum likelihood from incomplete data via the EM algorithm</article-title>. <source>Journal of the Royal Statistical Society: Series B (Methodological).</source><year>1977</year>;<volume>39</volume>(<issue>1</issue>):<fpage>1</fpage>–<lpage>22</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1111/j.2517-6161.1977.tb01600.x</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008913.ref045">
      <label>45</label>
      <mixed-citation publication-type="book"><name><surname>Chacón</surname><given-names>JE</given-names></name>, <name><surname>Duong</surname><given-names>T</given-names></name>. <source>Multivariate kernel smoothing and its applications</source>: <publisher-name>CRC Press</publisher-name>; <year>2018</year>.</mixed-citation>
    </ref>
    <ref id="pcbi.1008913.ref046">
      <label>46</label>
      <mixed-citation publication-type="journal"><name><surname>Lin</surname><given-names>H</given-names></name>, <name><surname>Peddada</surname><given-names>SD</given-names></name>. <article-title>Analysis of compositions of microbiomes with bias correction.</article-title><source>Nat Commun.</source><year>2020</year>;<volume>11</volume>(<issue>1</issue>):<fpage>3514</fpage>. Epub 2020/07/16. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/s41467-020-17041-7</pub-id>; PubMed Central PMCID: PMC7360769.<?supplied-pmid 32665548?><pub-id pub-id-type="pmid">32665548</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008913.ref047">
      <label>47</label>
      <mixed-citation publication-type="journal"><name><surname>Ren</surname><given-names>B</given-names></name>, <name><surname>Schwager</surname><given-names>E</given-names></name>, <name><surname>Tickle</surname><given-names>TL</given-names></name>, <name><surname>Huttenhower</surname><given-names>C</given-names></name>. <source>sparseDOSSA: Sparse Data Observations for Simulating Synthetic Abundance.</source><year>2016</year>. <comment>doi: </comment><pub-id pub-id-type="doi">10.18129/B9.bioc.sparseDOSSA</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008913.ref048">
      <label>48</label>
      <mixed-citation publication-type="book"><name><surname>Hosmer</surname><given-names>DW</given-names><suffix>Jr</suffix></name>, <name><surname>Lemeshow</surname><given-names>S</given-names></name>, <name><surname>Sturdivant</surname><given-names>RX</given-names></name>. <source>Applied logistic regression</source>: <publisher-name>John Wiley &amp; Sons</publisher-name>; <year>2013</year>.</mixed-citation>
    </ref>
  </ref-list>
</back>
