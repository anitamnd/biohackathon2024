<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Genomics</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Genomics</journal-id>
    <journal-title-group>
      <journal-title>BMC Genomics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2164</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">7325150</article-id>
    <article-id pub-id-type="publisher-id">6856</article-id>
    <article-id pub-id-type="doi">10.1186/s12864-020-06856-9</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Software</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>mitch: multi-contrast pathway enrichment for multi-omics and single-cell profiling data</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Kaspi</surname>
          <given-names>Antony</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-7688-6974</contrib-id>
        <name>
          <surname>Ziemann</surname>
          <given-names>Mark</given-names>
        </name>
        <address>
          <email>m.ziemann@deakin.edu.au</email>
        </address>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="GRID">grid.1042.7</institution-id><institution>Population Health and Immunity Division, </institution><institution>The Walter and Eliza Hall Institute of Medical Research, </institution></institution-wrap>1G Royal Parade, Parkville, VIC 3052 Australia </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="GRID">grid.1008.9</institution-id><institution-id institution-id-type="ISNI">0000 0001 2179 088X</institution-id><institution>Department of Medical Biology, </institution><institution>University of Melbourne, </institution></institution-wrap>1G Royal Parade, Parkville, VIC 3052 Australia </aff>
      <aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="GRID">grid.1021.2</institution-id><institution-id institution-id-type="ISNI">0000 0001 0526 7079</institution-id><institution>School of Life and Environmental Sciences, </institution><institution>Deakin University, </institution></institution-wrap>Geelong, Australia </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>29</day>
      <month>6</month>
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>29</day>
      <month>6</month>
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2020</year>
    </pub-date>
    <volume>21</volume>
    <elocation-id>447</elocation-id>
    <history>
      <date date-type="received">
        <day>17</day>
        <month>12</month>
        <year>2019</year>
      </date>
      <date date-type="accepted">
        <day>19</day>
        <month>6</month>
        <year>2020</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2020</copyright-statement>
      <license license-type="OpenAccess">
        <license-p><bold>Open Access</bold>This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article's Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article's Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated in a credit line to the data.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p id="Par1">Inference of biological pathway activity via gene set enrichment analysis is frequently used in the interpretation of clinical and other omics data. With the proliferation of new omics profiling approaches and ever-growing size of data sets generated, there is a lack of tools available to perform and visualise gene set enrichments in analyses involving multiple contrasts.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p id="Par2">To address this, we developed mitch, an R package for multi-contrast gene set enrichment analysis. It uses a rank-MANOVA statistical approach to identify sets of genes that exhibit joint enrichment across multiple contrasts. Its unique visualisation features enable the exploration of enrichments in up to 20 contrasts. We demonstrate the utility of mitch with case studies spanning multi-contrast RNA expression profiling, integrative multi-omics, tool benchmarking and single-cell RNA sequencing. Using simulated data we show that mitch has similar accuracy to state of the art tools for single-contrast enrichment analysis, and superior accuracy in identifying multi-contrast enrichments.</p>
      </sec>
      <sec>
        <title>Conclusion</title>
        <p id="Par3">mitch is a versatile tool for rapidly and accurately identifying and visualising gene set enrichments in multi-contrast omics data. Mitch is available from Bioconductor (<ext-link ext-link-type="uri" xlink:href="https://bioconductor.org/packages/mitch">https://bioconductor.org/packages/mitch</ext-link>).</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Bioconductor package</kwd>
      <kwd>Differential expression</kwd>
      <kwd>Gene regulation</kwd>
      <kwd>Multi-omics</kwd>
      <kwd>Single-cell profiling</kwd>
      <kwd>Pathway analysis</kwd>
      <kwd>Gene set enrichment analysis</kwd>
      <kwd>Multivariate statistics</kwd>
    </kwd-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2020</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p id="Par19">Functional enrichment analysis describes the various ways that summarised omics data can be used to infer differential expression (DE) of molecular pathways, or more broadly sets of genes that are functionally linked [<xref ref-type="bibr" rid="CR1">1</xref>]. Enrichment analysis is increasingly being applied to understand patterns of regulation in diseases and may be useful in better classification of patients into subgroups that could benefit from more specific treatments [<xref ref-type="bibr" rid="CR2">2</xref>]. Indeed, it is reported that measurement of sets of genes rather than individual genes provides a better ratio of signal to noise and more accurate patient classification [<xref ref-type="bibr" rid="CR3">3</xref>]<bold>.</bold> Commonly, gene sets are curated to have similar molecular or biological function, or be part of the same biochemical or signaling pathway; but can also be derived from empirical omics and in silico studies.</p>
    <p id="Par20">Most commonly used pathway enrichment analysis methods fall into three categories; over-representation analysis (ORA), functional class sorting (FCS) and pathway topology (PT) methods [<xref ref-type="bibr" rid="CR1">1</xref>, <xref ref-type="bibr" rid="CR4">4</xref>, <xref ref-type="bibr" rid="CR5">5</xref>]. Over-representation analysis involved the intersection of genes meeting a prespecified significance and/or fold change threshold with a library of gene sets. Statistically higher or lower enrichment is determined with hypergeometric, Fisher exact or other test. Functional class scoring is different because it uses all detected genes in the calculation of pathway regulation, as it does not involve a significance cutoff. There are several valid approaches to this, but all involve scoring of genes by their differential expression, followed by a statistical test to detect enrichment at the upper and lower extremes of the range. PT methods are similar to FCS methods except they take into consideration additional information about how the genes within a set relate to one another. For example taking into account that biological pathways contain both activators and inhibitors, or that genes in a set are correlated or anticorrelated. PT methods are limited in some cases by a lack of fine-grained pathway knowledge as well as differences in pathway mechanisms in cell types under study [<xref ref-type="bibr" rid="CR4">4</xref>]. Although PT methods are extremely useful, they are not a focus of this study.</p>
    <p id="Par21">One of the first FCS tools to be described was Gene Set Enrichment Analysis (GSEA). In “preranked” mode, this method summarises DE findings (eg: fold change and/or <italic>p</italic>-value) into a single value and then detects enrichment of gene set members at the extremes of this profile. Statistical significance is established by permuting the profile, quantifying how frequent the detected enrichment is in a randomised profile [<xref ref-type="bibr" rid="CR6">6</xref>]. Pathway analysis research has since been focused on improving the usability, accuracy and efficiency of tools that analyse single omics data sets. For example, FCS tools (geneSetTest, Roast, CAMERA) have been added to the Limma package, providing a GSEA-like functionality entirely in the R/Bioconductor environment [<xref ref-type="bibr" rid="CR7">7</xref>]. CAMERA is able to estimate and correct for inter-gene correlation that biases enrichment tests [<xref ref-type="bibr" rid="CR8">8</xref>]. SetRank adjusts for false positives that arise from overlaps in gene sets [<xref ref-type="bibr" rid="CR9">9</xref>]. Algorithmic advances included in the FGSEA package have allowed a ~ 50 fold increase in permutation calculation speed in pre-ranked enrichment detection in contrast to GSEA [<xref ref-type="bibr" rid="CR10">10</xref>] which will be important as gene set databases continue to grow. It has also been shown that ensemble methods of enrichment analysis yield higher accuracy than any individual method alone [<xref ref-type="bibr" rid="CR11">11</xref>]. Furthermore, there is an emerging interest in tools that calculate pathway expression in individual samples, allowing for granular analysis of variability between samples in large groups (eg: PLAGE, GSVA and ssGSEA) [<xref ref-type="bibr" rid="CR12">12</xref>–<xref ref-type="bibr" rid="CR14">14</xref>].</p>
    <p id="Par22">Databases such as Gene Expression Omnibus (GEO) are expanding rapidly [<xref ref-type="bibr" rid="CR15">15</xref>], enabling comparison of many omics studies at the same time given the appropriate analysis tools. As omics profiling techniques continue to diversify and become more widely used, multi-omics studies are becoming more common. For example, the share of multi-omics data sets, called “Superseries” in GEO has increased, from only 4.6% of series in 2005–2009 to 8.1% in Jan 2016 to Aug 2019. In addition, single-cell profiling has grown explosively in the past 5 years thanks to developments in droplet and nanowell technology, facilitating the deconvolution of cell identities in development and in response to stimuli and disease. These trends highlight a need for tools capable of analysing high-dimensional omics data involving many contrasts, profiling technologies and cell types.</p>
    <p id="Par23">The first approach described for multi-contrast FCS analysis is based upon Hotelling’s T<sup>2</sup> statistic with two contrasts, and more generally Multiple Analysis of Variance (MANOVA) when considering more than two contrasts. With simulated data, MANOVA test compares favourably with respect to sensitivity and specificity in contrast to other multivariate tests available at the time [<xref ref-type="bibr" rid="CR16">16</xref>]. An alternative approach, Multi Dimensional Gene Set Analysis (MD-GSA) was later devised, and proposes the use of logistic regression for bidimensional FCS analysis [<xref ref-type="bibr" rid="CR17">17</xref>]. Although originally intended to analyse multiple contrasts on the same experimental platform, the MANOVA test is equally applicable to pathway level integrative analysis of multi-omics data. For example, joint FCS analysis of ranked proteome and transcriptome data [<xref ref-type="bibr" rid="CR18">18</xref>]. A MANOVA based FCS test was implemented in the MAVTgsa R package, however it is slow due to the use of a computationally intensive permutation procedure, and lacks visualisation features key to interpreting high-dimensional data [<xref ref-type="bibr" rid="CR19">19</xref>].</p>
    <p id="Par24">To overcome these limitations, we developed mitch, an R/Bioconductor package that facilitates multi-contrast FCS analysis using a rank-MANOVA approach. We demonstrate the utility of mitch in a variety of use cases including enrichment analysis of multi-omics and single cell transcriptomics. Using simulated data, we benchmark accuracy and execution time of mitch.</p>
  </sec>
  <sec id="Sec2">
    <title>Implementation</title>
    <sec id="Sec3">
      <title>Overview</title>
      <p id="Par25">We provide a schematic diagram and example code to demonstrate a typical mitch workflow from DE tables through to enrichment results (Fig. <xref rid="Fig1" ref-type="fig">1</xref>). mitch consists of five functions; mitch_import, gmt_import, mitch_calc, mitch_plots and mitch_report, which are described in the sections below.
<fig id="Fig1"><label>Fig. 1</label><caption><p>Overview of the mitch workflow. The mitch package consists of five functions (left). The mitch_import function recognises the format of commonly used differential omics tools such as DESeq2, edgeR and limma and performs ranking of each contrast, to create a multi contrast rank table. If user’s would like to use a different ranking scheme, mitch_import can be bypassed in favour of a custom ranking approach. The gmt_import function reads gene matrix transposed files (GMT). The mitch_calc function determines the degree of enrichment of each gene set in the multi contrast table, yielding a mitch result object. The mitch_report function produces a single HTML format report of results containing several tables and charts. The mitch_plots function generates high resolution PDF containing charts derived from the mitch results. Example minimal mitch analysis code (right) to determine the enrichment of gene sets obtained from a GMT file in two dimensions, represented as two edgeR top tables</p></caption><graphic xlink:href="12864_2020_6856_Fig1_HTML" id="MO1"/></fig></p>
    </sec>
    <sec id="Sec4">
      <title>DE scoring and import</title>
      <p id="Par26">To facilitate rank based FCS analysis, DE results for each gene need to be summarised into a single score. mitch_import has the ability to import data from a range of upstream DE packages used in transcriptomics, epigenetics and proteomics (Table <xref rid="Tab1" ref-type="table">1</xref>) [<xref ref-type="bibr" rid="CR7">7</xref>, <xref ref-type="bibr" rid="CR20">20</xref>–<xref ref-type="bibr" rid="CR43">43</xref>]. Where available, mitch uses the DE test statistic for each gene/protein if available, otherwise calculating the directional significance score (<italic>D</italic>) defined as:
<disp-formula id="Equa"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ D=-{\log}_{10}\left(\mathrm{nominal}\;p-\mathrm{value}\right)\times \operatorname{sign}\left({\log}_2\mathrm{FC}\right) $$\end{document}</tex-math><mml:math id="M2" display="block"><mml:mi>D</mml:mi><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:msub><mml:mo>log</mml:mo><mml:mn>10</mml:mn></mml:msub><mml:mfenced close=")" open="("><mml:mrow><mml:mtext>nominal</mml:mtext><mml:mspace width="0.12em"/><mml:mi>p</mml:mi><mml:mo>−</mml:mo><mml:mtext>value</mml:mtext></mml:mrow></mml:mfenced><mml:mo>×</mml:mo><mml:mo>sign</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mo>log</mml:mo><mml:mn>2</mml:mn></mml:msub><mml:mi>FC</mml:mi></mml:mrow></mml:mfenced></mml:math><graphic xlink:href="12864_2020_6856_Article_Equa.gif" position="anchor"/></alternatives></disp-formula><table-wrap id="Tab1"><label>Table 1</label><caption><p>mitch can import profiling data generated by a wide range of upstream tools</p></caption><table frame="hsides" rules="groups"><thead><tr><th>Target application</th><th>Tool</th><th>Reference</th><th>Function</th><th>Ranking metric</th></tr></thead><tbody><tr><td rowspan="10">RNA-seq (and other applications of count based quantification)</td><td>edgeR</td><td>[<xref ref-type="bibr" rid="CR20">20</xref>]</td><td>topTable()</td><td>“logFC” and “PValue”</td></tr><tr><td>DESeq2</td><td>[<xref ref-type="bibr" rid="CR21">21</xref>]</td><td>results()</td><td>“stat”</td></tr><tr><td>ABSSeq</td><td>[<xref ref-type="bibr" rid="CR22">22</xref>]</td><td>results()</td><td>“foldChange” and “pvalue”</td></tr><tr><td>topConfects</td><td>[<xref ref-type="bibr" rid="CR23">23</xref>]</td><td><p>edger_confects()</p><p>limma_confects()</p></td><td>“confect”</td></tr><tr><td>fishpond/Swish</td><td>[<xref ref-type="bibr" rid="CR24">24</xref>]</td><td>swish()</td><td>“stat”</td></tr><tr><td>NOIseq</td><td>[<xref ref-type="bibr" rid="CR25">25</xref>]</td><td>noiseq()</td><td>“ranking”</td></tr><tr><td>Ballgown</td><td>[<xref ref-type="bibr" rid="CR26">26</xref>]</td><td>stattest()</td><td>“fc” and “pval”</td></tr><tr><td>TCC</td><td>[<xref ref-type="bibr" rid="CR27">27</xref>]</td><td>getResult()</td><td>“m.value” and “p.value”</td></tr><tr><td>Sleuth</td><td>[<xref ref-type="bibr" rid="CR28">28</xref>]</td><td>sleuth_results()</td><td>“b” and “pval”</td></tr><tr><td>Cufflinks</td><td>[<xref ref-type="bibr" rid="CR29">29</xref>]</td><td>cuffdiff</td><td>“test_stat”</td></tr><tr><td rowspan="2">Expression microarray</td><td>limma</td><td>[<xref ref-type="bibr" rid="CR8">8</xref>]</td><td>topTable()</td><td>“t”</td></tr><tr><td>DEDS</td><td>[<xref ref-type="bibr" rid="CR30">30</xref>]</td><td>topgenes()</td><td>“t”</td></tr><tr><td rowspan="5">scRNA-seq (and other applications of barcoded cell based count quantification)</td><td>Seurat</td><td>[<xref ref-type="bibr" rid="CR31">31</xref>]</td><td>FindMarkers()</td><td>“avg_logFC” and “p_val”</td></tr><tr><td>Muscat</td><td>[<xref ref-type="bibr" rid="CR32">32</xref>]</td><td>pbDS()</td><td>“logFC” and “p_val”</td></tr><tr><td>scde</td><td>[<xref ref-type="bibr" rid="CR33">33</xref>]</td><td>scde.expression.difference()</td><td>“Z”</td></tr><tr><td>MAST</td><td>[<xref ref-type="bibr" rid="CR34">34</xref>]</td><td>zlm()</td><td>“Coef” and “Pr(&gt;Chisq)”</td></tr><tr><td>DEsingle</td><td>[<xref ref-type="bibr" rid="CR35">35</xref>]</td><td>DEtype()</td><td>“foldchange” and “pvalue”</td></tr><tr><td rowspan="2">Methylation array</td><td>missMethyl</td><td>[<xref ref-type="bibr" rid="CR36">36</xref>]</td><td>topTable()</td><td>“t”</td></tr><tr><td>DMRcate</td><td>[<xref ref-type="bibr" rid="CR37">37</xref>]</td><td>extractRanges()</td><td>“meanbetafc” and “Stouffer”</td></tr><tr><td rowspan="5">Differential proteomics</td><td>DEP</td><td>[<xref ref-type="bibr" rid="CR38">38</xref>]</td><td>get_results()</td><td>“ratio” and “p.val”</td></tr><tr><td>msmsTests</td><td>[<xref ref-type="bibr" rid="CR39">39</xref>]</td><td>msms.glm.pois(), msms.glm.qlll() or msms.edgeR()</td><td>“LogFC” and “p.value”</td></tr><tr><td>plgem</td><td>[<xref ref-type="bibr" rid="CR40">40</xref>]</td><td>plgem.deg()</td><td>“PLGEM.STN” and “p.value”</td></tr><tr><td>SDAMS</td><td>[<xref ref-type="bibr" rid="CR41">41</xref>]</td><td>SDA()</td><td>“beta” and “pv_2part”</td></tr><tr><td>DEqMS</td><td>[<xref ref-type="bibr" rid="CR42">42</xref>]</td><td>DEqMS</td><td>“t”</td></tr><tr><td>Differential binding</td><td>DiffBind</td><td>[<xref ref-type="bibr" rid="CR43">43</xref>]</td><td>dba.report()</td><td>“Fold” and “p.value”</td></tr></tbody></table></table-wrap></p>
      <p id="Par27">If a different upstream tool is used or if users prefer to use a different DE scoring approach, mitch allows import of “prescored” data. By default, only the genes that are detected in all contrasts are included, but this behaviour can be modified to accommodate sparse datasets such as single cell transcriptomics. During import, users may specify a two-column table that relates gene identifiers in the DE analysis to those in the gene sets. Genes are then ranked from most up-regulated to most down-regulated in each contrast. Gene ranks are centred around the midpoint for each contrast, where the test statistic/directional significance score is zero.</p>
    </sec>
    <sec id="Sec5">
      <title>Gene set definition</title>
      <p id="Par28">A gene set library for use with this implementation must be a named list of character vectors. The gmt_import function reads gene matrix transposed (GMT) system files and is based upon a function originally written for the clusterProfiler package [<xref ref-type="bibr" rid="CR44">44</xref>] that is interoperable with FGSEA [<xref ref-type="bibr" rid="CR10">10</xref>]<bold>.</bold></p>
    </sec>
    <sec id="Sec6">
      <title>Multi-contrast enrichment analysis</title>
      <p id="Par29">The mitch_calc function performs the calculation of multidimensional enrichment and post-hoc univariate enrichments. Only gene sets with 10 or more members present in all contrasts are included by default although the minimum set size threshold can be altered as desired. The base R manova() and summary.manova() functions are used to calculate and report the probability that genes in a set show a multidimensional enrichment as compared to genes not in the set using the Pillai–Bartlett test statistic [<xref ref-type="bibr" rid="CR45">45</xref>]. The maximum number of contrasts (dimensions) handled by this function is 69. If only one DE profile is provided, then mitch will perform an ANOVA test using the aov() function. The <italic>p</italic>-values are adjusted for multiple comparisons using the false discovery rate (FDR) method of Benjamini and Hochberg [<xref ref-type="bibr" rid="CR46">46</xref>]. Separately, the enrichment score (<italic>s</italic>) of each gene set is calculated in each contrast as described previously [<xref ref-type="bibr" rid="CR18">18</xref>].
<disp-formula id="Equb"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ s=2\ \left({\mathrm{R}}_1-{\mathrm{R}}_2\right)/\mathrm{n} $$\end{document}</tex-math><mml:math id="M4" display="block"><mml:mi>s</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:mspace width="0.25em"/><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi mathvariant="normal">R</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi mathvariant="normal">R</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:mfenced><mml:mo>/</mml:mo><mml:mi mathvariant="normal">n</mml:mi></mml:math><graphic xlink:href="12864_2020_6856_Article_Equb.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par30">Where R<sub>1</sub> is the mean rank of genes in the set, R<sub>2</sub> is the mean rank of genes not in the set and n is the number of genes overall. With two or more contrasts, <italic>S</italic> is defined as the higher dimensional but non-directional enrichment score and is calculated as the Pythagorean distance from the origin.</p>
      <p id="Par31">On Unix based systems, these calculations are distributed on multiple cores to take advantage of multi-threaded computers and save time. End users can prioritise results in three ways; (i) based on statistical significance (low <italic>p</italic>-value), (ii) effect size (large <italic>S</italic>) or (iii) standard deviation (SD) of <italic>s</italic> values across contrasts. SD prioritisation may be of use when searching for gene sets with discordant regulation. End users may also select the number of gene sets for which detailed reports are to be generated downstream; with a default of 50.</p>
    </sec>
    <sec id="Sec7">
      <title>Visualisation of results</title>
      <p id="Par32">The mitch_plots function generates several plots in high resolution PDF. The mitch_report function generates an HTML report with the same outputs, but in a lower resolution to facilitate easy sharing of results. These visualisation functions are limited to 20 or fewer contrasts. Outputs contain scatterplots of DE scores derived from the directional <italic>p</italic>-value method, filled contour plots of ranked profiles, histogram of gene set sizes, scatter plot of effect size measured by <italic>S</italic> distance and statistical significance measured as -log<sub>10</sub>(FDR MANOVA), and a pairs plot of <italic>s</italic> values for all gene sets. In addition, detailed plots are generated for a specified number of gene sets according to the prioritisation approach selected. These include pairwise filled contour plots, pairwise scatter plots and violin plots of enrichments in each contrast. These plots are generated with base R tools or ggplot2 [<xref ref-type="bibr" rid="CR45">45</xref>, <xref ref-type="bibr" rid="CR47">47</xref>]. The HTML output is a self contained report with results tables and charts. Some of these are interactive charts and are generated using the echarts4r package [<xref ref-type="bibr" rid="CR48">48</xref>].</p>
    </sec>
  </sec>
  <sec id="Sec8">
    <title>Methods</title>
    <sec id="Sec9">
      <title>Case study 1: multi-contrast enrichment analysis of RNA-seq data</title>
      <p id="Par33">RNA-seq data from a previous study with GEO accession GSE109140 [<xref ref-type="bibr" rid="CR49">49</xref>] were obtained via DEE2 [<xref ref-type="bibr" rid="CR50">50</xref>]. Transcript-level counts were aggregated to gene level counts using the Tx2gene function of the getDEE2 R package (obtained 2019-10-25). Genes with fewer than 10 reads per sample were excluded from analysis. Two DE contrasts were performed. In contrast 1, normal (5.5 mM) and high (20 mM) glucose were compared. In contrast 2, the effect of 1.0 mM valproic acid (VPA) was assessed in the high glucose condition. DE analysis was performed with DESeq2 v1.22.2 and profiles were imported with mitch. Gene sets used in this study were obtained from Reactome [<xref ref-type="bibr" rid="CR51">51</xref>]. These and all subsequent numerical analyses were performed in R (v3.6.1) [<xref ref-type="bibr" rid="CR45">45</xref>].</p>
      <p id="Par34">In order to test whether mitch controls type I errors (false positives) appropriately, three types of randomisation were performed. (i) Shuffle the names of genes in the profile. This retains the correlation structure of the profile dataset. (ii) Shuffle the profile data values. This doesn’t preserve profile correlation structure. (iii) Create random gene sets by sampling gene names from the profile. Gene sets sizes are equal to those obtained from Reactome. The above were repeated 1000 times with the set seed varied between 1 and 1000.</p>
    </sec>
    <sec id="Sec10">
      <title>Case study 2: multi-omics enrichment analysis</title>
      <p id="Par35">Datasets corresponding to A549 (adenocarcinomic human alveolar basal epithelial cell) with and without exposure to 1 h 100 nM dexamethasone were selected to showcase the application of mitch to multi-omics data (listed in Supplementary Table <xref rid="MOESM2" ref-type="media">1</xref>) [<xref ref-type="bibr" rid="CR52">52</xref>]. ChIP-seq and ATAC-seq alignment files in BAM format were downloaded from the ENCODE website. FeatureCounts v1.6.4 [<xref ref-type="bibr" rid="CR53">53</xref>] was used to count reads mapped to regions within 1 kbp of transcriptional start sites. These coordinates were generated using GTFtools [<xref ref-type="bibr" rid="CR54">54</xref>] from GENCODE v29 annotations [<xref ref-type="bibr" rid="CR55">55</xref>]. RNA-seq gene expression counts were downloaded from the ENCODE web site. ChIP-seq, ATAC-seq and RNA-seq underwent differential analysis with DESeq2 v1.22.2 after excluding genes with fewer than 10 reads per sample on average across each experiment. Data were imported with mitch and enrichment analysis was performed with Reactome gene sets as above.</p>
    </sec>
    <sec id="Sec11">
      <title>Case study 3: comparing enrichment results downstream of different DE tools</title>
      <p id="Par36">RNA-seq data from a previous study with GEO accession GSE93236 [<xref ref-type="bibr" rid="CR56">56</xref>] were obtained via DEE2. Transcript-level counts were aggregated to gene level counts as above. Non-target control and Set7 knock down datasets were compared using different DE tools; DESeq2 (v1.22.2), edgeR glmLRT and QL (v3.24.3), voom-limma (v3.38.3) and ABSSeq (v1.36.0). mitch was used for enrichment analysis using Reactome gene sets. UpSetR package v1.3.3 was used to intersect gene sets that were FDR &lt; 0.05 in each DE tool profile [<xref ref-type="bibr" rid="CR57">57</xref>]. Pairwise correlation, heatmap, violin and bar charts were generated in R.</p>
    </sec>
    <sec id="Sec12">
      <title>Case study 4: enrichment analysis of single cell sequencing data</title>
      <p id="Par37">Single cell RNA-seq expression data derived from peripheral blood mononuclear cells exposed to interferon beta or vehicle control [<xref ref-type="bibr" rid="CR58">58</xref>] were obtained, preprocessed and underwent differential state analysis using the “pseudobulk” method as described in the Muscat v0.99.9 vignette [<xref ref-type="bibr" rid="CR32">32</xref>]. Spearman correlation (<italic>ρ</italic>) of DE values are presented as a heatmap. Mitch was performed with Reactome gene sets and sets with FDR MANOVA &lt; 0.05 were prioritized based on significance, magnitude of <italic>S</italic> and SD of <italic>s</italic>.</p>
    </sec>
    <sec id="Sec13">
      <title>Accuracy of single and dual contrast enrichment detection</title>
      <p id="Par38">In order to establish the accuracy of mitch in comparison to other tools for enrichment analysis, we used a simulated RNA-seq data approach. A human RNA-seq data set with accession number ERR2539161 with 367 M reads assigned to genes was downloaded from DEE2. We simulated a typical RNA-seq experiment with a control/case design with 3 replicates. The starting dataset was downsampled repeatedly to 10 M, 40 M and 100 M reads followed by multiplication by a random noise factor. Noise factors were randomly generated by sampling with the rnorm function with a mean of 2 and a set SD between 0 and 0.6 followed by log<sub>2</sub> transformation. For enrichment analysis testing, 1000 gene sets were created by randomly sampling 50 gene names. In each simulation 25 randomly selected gene sets were set to be upregulated, and another 25 were set to be downregulated. Fold changes of 2 and − 0.5 were incorporated into the ‘case’ profiles by multiplication of the fold change with the gene counts. If a gene was selected to be both up and downregulated, then no fold change was incorporated. Count matrices then underwent differential analysis with DESeq2 and downstream enrichment analysis with hypergeometric test (phyper, base R v3.6.1), FGSEA (v1.11.1) and mitch. For hypergeometric test, genes with DESeq2 FDR values &lt; 0.05 were included in over-representation analysis. For FGSEA and mitch, the DESeq2 test statistic was used for ranking. In FGSEA, 1000 permutations were performed. Gene sets with FDR values &lt; 0.05 were considered significant and contributed to the calculation of precision, recall and F1 score. Mean results are shown after 500 simulations.</p>
      <p id="Par39">For dual contrast enrichment, data were simulated as above, one control group and two case groups were created to generate two contrasts. FGSEA, mitch and MD-GSA (v1.18.0) were compared.</p>
    </sec>
    <sec id="Sec14">
      <title>Accuracy in detecting multi-contrast enrichment</title>
      <p id="Par40">A random differential expression profile in five dimensions (contrasts) was simulated by repeatedly shuffling ranks for the hyperglycemia data. A library of 1000 gene sets, each with 50 members was created as above and 20 of these gene sets were selected for differential expression. The ranks of the gene set members were shifted based upon a prespecified <italic>s</italic> value using the equation.
<disp-formula id="Equc"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\mathrm{R}}_2-{\mathrm{R}}_1=\mathrm{n}\times s/2 $$\end{document}</tex-math><mml:math id="M6" display="block"><mml:msub><mml:mi mathvariant="normal">R</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi mathvariant="normal">R</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mi mathvariant="normal">n</mml:mi><mml:mo>×</mml:mo><mml:mi>s</mml:mi><mml:mo>/</mml:mo><mml:mn>2</mml:mn></mml:math><graphic xlink:href="12864_2020_6856_Article_Equc.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par41">Values for <italic>s</italic> in the five contrasts were generated from a normal distribution with a mean of zero and SD varied between 0 and 0.25. This equates to mean absolute values of <italic>s</italic> between 0 and 0.2. After mitch analysis, a 5% FDR threshold was applied to calculate precision, recall and F1 score. The simulation was repeated 1000 times for each value of SD.</p>
    </sec>
    <sec id="Sec15">
      <title>Execution time</title>
      <p id="Par42">A typical mitch analysis was defined as consisting of a profiling of 20,000 genes with a gene set library of 1000 sets, and each set consisting of 50 members. Gene names, data points and gene sets were randomly generated. Execution time was measured on a 3.8 GHz AMD Ryzen Threadripper 1900 × 8-core (16 thread) processor with 64 GB RAM running Ubuntu 18.04 and R v3.6.1. For comparison, FGSEA was run with 1000 or 2000 permutations. MAVTgsa v1.3 was run with 1000 permutations and MD-GSA using default parameters. Parameters including number of contrasts, number of genes in the profile, number of gene sets and size of gene sets were also varied to determine impact on mitch execution time.</p>
    </sec>
  </sec>
  <sec id="Sec16">
    <title>Results</title>
    <sec id="Sec17">
      <title>Case study 1: multi-contrast enrichment analysis of RNA-seq data</title>
      <p id="Par43">A common use case for mitch is the multi-contrast gene set enrichment analysis of transcriptome data. To demonstrate this, we applied mitch to RNA-seq data initially described by Felisbino et al. [<xref ref-type="bibr" rid="CR49">49</xref>], consisting of two contrasts; (i) low glucose (LG) versus high glucose (HG); and (ii) HG versus HG with valproic acid (HGVPA). The goal of this study was to identify individual genes and Reactome gene sets dysregulated due to high glucose stimulation in hepatocytes and attenuated with VPA, a clinically prescribed histone deacetylase inhibitor.</p>
      <p id="Par44">There were 15,240 genes with detectable expression in both contrasts. DE scoring with the Wald test statistic provided by DESeq revealed gene expression differences were larger in response to VPA (y-axis) as compared to HG (x-axis) (Fig. <xref rid="Fig2" ref-type="fig">2</xref>a), although genes were evenly distributed in all four quadrants (Fig. <xref rid="Fig2" ref-type="fig">2</xref>b) and the contrasts were not strongly correlated (Spearman’s <italic>ρ</italic> = 0.010). After exclusion of 967 gene sets with fewer than 10 detected members, 1296 gene sets underwent multi-contrast enrichment analysis with mitch. From the 1296 Reactome gene sets considered, 561 gene sets received FDR MANOVA&lt; 0.05 (Fig. <xref rid="Fig2" ref-type="fig">2</xref>c). There were 372 sets with FDR MANOVA&lt; 0.01. A plot of effect size versus statistical significance for each gene set (Fig. <xref rid="Fig2" ref-type="fig">2</xref>d) demonstrates the three gene sets with the greatest effect size, while satisfying FDR MANOVA&lt; 0.05, are not highly ranked when prioritising solely on statistical significance. Bidimensional enrichment plots for the top three gene sets based on statistical significance and effect size further show differences in types of associations identified (Fig. <xref rid="Fig2" ref-type="fig">2</xref>e). When prioritising by statistical significance, top gene sets are likely to be larger (contain more genes) but more dispersed; while prioritisation by effect size emphasizes smaller gene sets with larger magnitude changes.
<fig id="Fig2"><label>Fig. 2</label><caption><p>Multi-contrast enrichment analysis of RNA-seq with mitch. <bold>a</bold> The scoring metric, <italic>D</italic>, of every gene in the two contrasts, LG vs HG and HG vs HGVPA. <bold>b</bold> A filled contour plot of all genes after ranking. <bold>c</bold> Enrichment of Reactome gene sets in the two dimensional space. <bold>d</bold> Plot of gene set effect size (<italic>S</italic>) and significance. <italic>S</italic> is defined as the Pythagorean distance from the origin to each point in (<bold>c</bold>). Significance is measured as the -log<sub>10</sub>(FDR MANOVA). <bold>e</bold> Density plots for the three top significant gene sets (blue box) and three gene sets with largest effect size (red box)</p></caption><graphic xlink:href="12864_2020_6856_Fig2_HTML" id="MO2"/></fig></p>
      <p id="Par45">To demonstrate appropriate control of false positives, three randomisation procedures were performed on bidimensional profiling data shown in Fig. <xref rid="Fig2" ref-type="fig">2</xref>. Shuffling gene names 1000 times resulted in an average of 0.141 and 0.024 false positives per run at FDR &lt; 0.05 and FDR &lt; 0.01 respectively (Fig. <xref rid="Fig3" ref-type="fig">3</xref>a and b). Shuffling the profile data resulted in an average of 0.213 and 0.038 false positives per run at FDR &lt; 0.05 and FDR &lt; 0.01 respectively (Fig. <xref rid="Fig3" ref-type="fig">3</xref>c and d). Randomisation of gene sets resulted in an average of 0.028 and 0.007 false positives per run at FDR &lt; 0.05 and FDR &lt; 0.01 respectively (Fig. <xref rid="Fig3" ref-type="fig">3</xref>e and f). Randomisation shows mitch appropriately controls for false positives.
<fig id="Fig3"><label>Fig. 3</label><caption><p>Data randomisation demonstrates robust control of false positives. Data shown in Fig. <xref rid="Fig2" ref-type="fig">2</xref> underwent three types of randomisation. (<bold>a</bold> and <bold>b</bold>) Results of shuffling of gene names in the profile followed by mitch analysis with an FDR threshold of 0.05 and 0.01. <bold>c</bold> and <bold>d</bold> Results of shuffling profile data points, two contrasts shuffled independently. <bold>e</bold> and <bold>f</bold> Randomisation of gene sets by sampling gene names from the profile. All procedures were repeated 1000 times</p></caption><graphic xlink:href="12864_2020_6856_Fig3_HTML" id="MO3"/></fig></p>
    </sec>
    <sec id="Sec18">
      <title>Case study 2: multi-omic enrichment analysis</title>
      <p id="Par46">Another common use case for mitch is in enrichment analysis of multi-omics data. Previously, the ENCODE consortium have performed multi-omics profiling of dexamethasone (an anti-inflammatory corticosteroid drug) on adenocarcinomic human alveolar basal epithelial cell line A549 [<xref ref-type="bibr" rid="CR52">52</xref>]. We obtained RNA-seq, ATAC-seq and promoter based ChIP-seq for CTCF, H3K4me3, NR3C1 and POL2RA profiling data for dexamethasone treated and control samples (datasets listed in Supplementary Table <xref rid="MOESM1" ref-type="media">1</xref>), followed by differential analysis and then mitch. We found that overall, promoter based NR3C1 occupancy was most positively correlated with POL2RA and negatively correlated with CTCF occupancy. As expected, RNA expression differences were positively correlated with NR3C1, H3K4me3, POL2RA and ATAC-seq signal (Fig. <xref rid="Fig4" ref-type="fig">4</xref>a). Selected gene sets with the largest effect size (<italic>S</italic>) include peptide chain elongation, adenylate cyclase inhibition and common pathway of clot formation, while the gene sets with the smallest FDR adjusted <italic>p</italic>-values included metabolism of RNA, translation and infectious disease (Fig. <xref rid="Fig4" ref-type="fig">4</xref>b). Adenylate cyclase inhibition genes were associated with increased occupancy of CTCF and chromatin accessibility (inferred from ATAC-seq), but lower RNA expression, H3K4me3 and NR3C1 occupancy (Fig. <xref rid="Fig4" ref-type="fig">4</xref>c). Common pathway of fibrin clot formation genes were elevated in H3K4me3, NR3C1, and to a lesser extent in RNA expression. Metabolism of RNA and translation were elevated in POL2RA occupancy and RNA expression (Fig. <xref rid="Fig4" ref-type="fig">4</xref>d). Dysregulation of the adenylate cyclase, clot formation pathway and effect on protein synthesis are consistent with the known effects of glucocorticoids [<xref ref-type="bibr" rid="CR59">59</xref>–<xref ref-type="bibr" rid="CR62">62</xref>]. This highlights the ability of mitch to identify enrichments in multi-omics datasets, and recover known biology.
<fig id="Fig4"><label>Fig. 4</label><caption><p>Multi-omics analysis of A549 cells treated with dexamethasone. <bold>a</bold> Pairwise filled contour plots of ranked profiles shows underlying correlations. <bold>b</bold> Plot of gene set effect size and significance. <bold>c</bold> Example gene sets that have large effect sizes. <bold>d</bold> Example gene sets with small FDR values. For <bold>c</bold> and <bold>d</bold>, grey areas denote the distribution of ranks of all detected genes, with median and quartiles depicted by the wide boxplot. Distribution of gene set members is shown by the black violin, with median and interquartile ranges given by the narrow boxplot</p></caption><graphic xlink:href="12864_2020_6856_Fig4_HTML" id="MO4"/></fig></p>
    </sec>
    <sec id="Sec19">
      <title>Case study 3: comparing enrichment results downstream of different DE tools</title>
      <p id="Par47">When benchmarking an RNA-seq bioinformatic pipeline it is useful to compare the gene set level results of a single RNA-seq contrast analysed with different DE tools, to determine what effect tool selection has on final results. To demonstrate this, bulk RNA-seq data corresponding to Set7 knock-down and non-target control samples [<xref ref-type="bibr" rid="CR56">56</xref>] was processed using DESeq2, edgeR glmLRT, edgeR QL, ABSSeq and voom-limma followed by mitch analysis with Reactome gene sets. After DE analysis, there were variable numbers of DE genes at the 5% FDR cutoff (DESeq2: 5150, edgeR glmLRT: 5721, edgeR QL: 5910, voom-limma: 5903 and ABSSeq: 2253). After mitch analysis also with a 5% FDR cutoff, there were variable numbers of differentially regulated gene sets, with ABSseq showing the fewest (Fig. <xref rid="Fig5" ref-type="fig">5</xref>a). Only 56 gene sets were common to all DE tools, but the majority (108) were common to all except ABSSeq. A pairs plot of gene set <italic>s</italic> values comparing data from each tool shows the results of DESeq2, edgeR glmLRT, edgeR QL and voom-limma are virtually identical (Pearson <italic>r</italic> &gt; 0.99), while results from ABSSeq are somewhat different (Pearson <italic>r</italic> ~ 0.95) (Fig. <xref rid="Fig5" ref-type="fig">5</xref>b). Sorting gene sets by SD of <italic>s</italic> values reveals several gene sets that exhibit stronger downregulation in DESeq2, edgeR glmLRT, edgeR QL and voom-limma as compared to ABSSeq (Fig. <xref rid="Fig5" ref-type="fig">5</xref>c). The peptide chain elongation gene set is a prime example, where the majority of genes are downregulated when analysed with DESeq2, edgeR glmLRT, edgeR QL and voom-limma, but appear unchanged when analysed with ABSSeq (Fig. <xref rid="Fig5" ref-type="fig">5</xref>d). This difference in collective regulation by ABSSeq is clear when the gene set is visualised as a violin plot (Fig. <xref rid="Fig5" ref-type="fig">5</xref>e). As a consequence, the statistical significance of this gene set is lower for ABSSeq compared to the other DE tools (Fig. <xref rid="Fig5" ref-type="fig">5</xref>f). These results are generally consistent with previous findings that show ABSSeq is more conservative than other differential RNA-seq tools [<xref ref-type="bibr" rid="CR22">22</xref>]. This result highlights that choice of DE tools subtly impacts enrichment results and these can be explored using mitch.
<fig id="Fig5"><label>Fig. 5</label><caption><p>Comparison of gene set enrichment enrichment results downstream of different DE tools on the same RNA-seq dataset. <bold>a</bold> UpSet plot of gene sets produced by different DE tools FDR &lt; 0.05, as calculated by unidimensional mitch. <bold>b</bold> Pairs plot of mitch <italic>s</italic> values for each gene set as processed by different DE tools. Upper triangle shows Pearson’s <italic>r</italic>. <bold>c</bold> A heatmap of 10 gene sets with the highest SD of <italic>s</italic> values across different DE tools, scaled by row. <bold>d</bold> Heatmap of individual gene members of the peptide chain elongation gene set, scaled by row. <bold>e</bold> Violin plot of enrichments of the peptide chain elongation gene set. <bold>f</bold> Observed nominal ANOVA <italic>p</italic>-value of the peptide chain elongation gene set after analysis with different DE tools</p></caption><graphic xlink:href="12864_2020_6856_Fig5_HTML" id="MO5"/></fig></p>
    </sec>
    <sec id="Sec20">
      <title>Case study 4: enrichment analysis of single cell sequencing data</title>
      <p id="Par48">Single cell RNA sequencing (scRNA-seq) allows the parallel profiling of hundreds to thousands of individual cells in a sample. As in standard bulk RNA-seq, contrasts between experimental conditions can be made, with the major difference that scRNA-seq provides information on cell identity (also known as “cell type”). Generally, scRNA-seq DE tools provide either test statistic or fold change and <italic>p</italic>-value information for each gene of each cell identity. Here, mitch can be applied to perform enrichment analysis by considering the DE profiles of each cell identity as an independent contrast. In order to demonstrate this, scRNA-seq data derived from peripheral blood mononuclear cells exposed to interferon beta or vehicle control as described by Kang et al [<xref ref-type="bibr" rid="CR58">58</xref>] underwent clustering and differential analysis with Muscat [<xref ref-type="bibr" rid="CR30">30</xref>] to yield “pseudobulk” DE tables for each cell identity. After scoring DE values, correlation analysis identified Spearman’s <italic>ρ</italic> between 0.23 and 0.57 between cell identities, with lymphocytes grouped together, dendritic cells grouped with monocytes, and megakaryocytes appearing as an outgroup (Fig. <xref rid="Fig6" ref-type="fig">6</xref>a).
<fig id="Fig6"><label>Fig. 6</label><caption><p>Applying mitch to perform enrichment analysis of scRNA-seq data. <bold>a</bold> Heatmap of Spearman correlation values for DE scores for each cell identity. <bold>b</bold> Heatmaps of mitch <italic>s</italic> scores for top 25 Reactome gene sets after prioritisation by significance, magnitude of <italic>S</italic> and SD of <italic>s.</italic> All gene sets shown are FDR MANOVA &lt; 0.05. <bold>c</bold> Example enrichment plots for three gene sets with high SD of <italic>s</italic> values</p></caption><graphic xlink:href="12864_2020_6856_Fig6_HTML" id="MO6"/></fig></p>
      <p id="Par49">Again, mitch analysis was performed with Reactome gene sets. Of the 2263 gene sets present, 1629 were excluded due to the detection of fewer than 10 members. Of the 607 sets remaining, 77 were differentially regulated (FDR MANOVA&lt; 0.05). Next, we prioritised the results three ways; (i) significance, (ii) magnitude of <italic>S</italic>, and (iii) SD of <italic>s</italic> values (Fig. <xref rid="Fig6" ref-type="fig">6</xref>b). When prioritising by significance, interferon signaling was observed to be upregulated as expected, but there were many housekeeping gene sets that were observed to be downregulated, including TCA cycle, rRNA processing and translation. When prioritising by magnitude of <italic>S</italic>, there was a larger number of upregulated gene sets involved in immune responses observed. In general, these gene sets demonstrated coordinated regulation in response to interferon beta stimulation that was consistent between cell identities. The value of scRNA-seq over bulk is the ability to detect cell identities responding differently to a stimulus, so it may be useful to prioritise by the observed SD of <italic>s</italic> across cell identities. Using this approach, we identified several gene sets with discordant cell identity responses to interferon beta, that would be impossible to detect with bulk sequencing (Fig. <xref rid="Fig6" ref-type="fig">6</xref>c). For example “RNA polymerase III chain elongation” was downregulated in monocytes specifically, “Attenuation phase” was upregulated in monocytes and B cells but not in megakaryocytes, and “Sema4D in semaphorin signaling” was downregulated in megakaryocytes specifically. This result highlights the utility of mitch in analysing single cell profiling data and the impact of different prioritisation schemes.</p>
    </sec>
    <sec id="Sec21">
      <title>Accuracy of single and dual contrast enrichment detection</title>
      <p id="Par50">To test the accuracy of mitch to detect single-contrast enrichments, we undertook a simulation study. Our goal was to determine the performance of mitch and other enrichment tests (FGSEA and hypergeometric test) over a range of typical RNA-seq conditions by varying the sequencing depth and degree of inter-sample variation. We simulated DE to 5% of randomly generated gene sets with equal numbers of sets up and down-regulated (see Methods). Members of those gene sets were given log<sub>2</sub> fold changes of 1 and − 1 to simulate expression changes. Count matrices underwent DE analysis and gene set enrichment testing with a 5% FDR threshold to calculate precision and recall of these tools, calculated by comparing ground truth values to the observed results (Fig. <xref rid="Fig7" ref-type="fig">7</xref>a). As expected, DE results from DESeq2 yielded smaller <italic>p</italic>-values when sequencing depth was greater and inter-sample variation was smaller. This resulted in overall better precision and recall of gene set enrichment results in simulations involving greater sequencing depth and smaller inter-sample variation. In tests with low variance, the hypergeometric test was the most precise, however higher variance caused a severe reduction in recall. In contrast, FGSEA and mitch were more robust to higher variance especially with higher sequencing depth. When variance was low, the accuracy of mitch was similar to FGSEA, but with higher variance, mitch showed superior recall. Potentially, FGSEA’s recall could be improved by using a greater number of permutations.
<fig id="Fig7"><label>Fig. 7</label><caption><p>Precision, recall and F1 values for enrichment analysis of simulated RNA-seq datasets. Simulations are based on <italic>n</italic> = 3 control and case replicates with different sequencing depth (10, 40 and 100 million reads) and different degrees of added variation (SD). The mean of 500 simulations is shown. <bold>a</bold> Evaluation of single contrast enrichment. <bold>b</bold> Evaluation of dual contrast enrichment</p></caption><graphic xlink:href="12864_2020_6856_Fig7_HTML" id="MO7"/></fig></p>
      <p id="Par51">Next, we applied this approach to the problem of identifying enrichments in two contrasts. We planned to compare the accuracy of FGSEA (run twice), with mitch, mdgsa and MAVTgsa, but thoroughly evaluating MAVTgsa was impractical due to the long computational time (Fig. <xref rid="Fig9" ref-type="fig">9</xref>b). We found that FGSEA recall was lower than expected, but this was improved by increasing the number of permutations to 2000. Averaged over the 9 different conditions, mitch demonstrated the highest precision (0.956), recall (0.994) and F1 score (0.974) as compared to the other tools (Fig. <xref rid="Fig7" ref-type="fig">7</xref>b). These results demonstrate that mitch has slightly better accuracy than existing tools for single and dual contrast enrichment analysis.</p>
    </sec>
    <sec id="Sec22">
      <title>Accuracy of multi-contrast gene set enrichment detection</title>
      <p id="Par52">Next, we sought to quantify the accuracy of mitch in distinguishing DE gene sets in a simulated five-contrast dataset. Member genes of 20 gene sets were shifted by precomputed <italic>s</italic> values sampled from a range of values with a mean of zero and SD varied from 0 to 0.25 (Methods). After mitch analysis with a 5 and 1% FDR cutoff, precision, recall and F1-score were calculated (Fig. <xref rid="Fig8" ref-type="fig">8</xref>). When SD = 0, ie in completely random data, no false positive DE gene sets were found after 1000 replications. As expected, recall increased with larger SD values. False positives showed a non linear relationship with SD. In the 5% FDR trial, precision showed a minimum of 86% when SD values were set to 0.05, however at a more strict 1% FDR cutoff, the minimum precision value was 95%. F1 scores indicated high accuracy with SD values above 0.15, which corresponds to mean absolute <italic>s</italic> values of 0.08 or higher. To put this into context of a real dataset, from the 318 gene sets in case study 2 with FDR &lt; 0.05, there were 12.6% with mean absolute <italic>s</italic> values lower than 0.08 (Supplementary Figure <xref rid="MOESM1" ref-type="media">1</xref>). For trials with SD set to ≥0.15, F1 scores were 0.9991 or higher. These findings support the accuracy of mitch in identifying DE gene sets in multidimensional data.
<fig id="Fig8"><label>Fig. 8</label><caption><p>mitch accuracy in distinguishing DE gene sets in a simulated five-contrast dataset. The <italic>x</italic>-axis shows the set SD for sampling <italic>s</italic> values for each gene set for each contrast. <italic>x</italic>-axis can be interpreted as increasing enrichment strength. Values shown are the mean of 1000 replications</p></caption><graphic xlink:href="12864_2020_6856_Fig8_HTML" id="MO8"/></fig></p>
    </sec>
    <sec id="Sec23">
      <title>Execution time</title>
      <p id="Par53">As execution time is a consideration in big data applications, we measured the execution times of mitch in typical applications. Initially, single-contrast enrichment analysis was tested. A random profile consisting of 20,000 genes and queried with a gene set library of 1000 sets, and each set consisting of 50 members. On a single CPU thread, single-contrast mitch analysis was completed in 10 s; but using 8 threads this was reduced to 2.5 s. Using an additional 8 threads did not speed up execution further (Fig. <xref rid="Fig9" ref-type="fig">9</xref>a). FGSEA which is known for its speed, completed the analysis in 0.51 s using the default 1000 permutations with a single thread. Next, the speed of mitch was compared to MAVTgsa, MD-GSA and FGSEA for dual contrast enrichment. We found mitch was 16–22 times faster than MD-GSA and 2000–2500 times faster than MAVTgsa, although not as fast as running FGSEA twice (Fig. <xref rid="Fig9" ref-type="fig">9</xref>b). Next, the effect of increasing the number of genes profiled and the number of contrasts on mitch execution time was assessed. The number of genes in the profiling data had a linear effect on mitch execution time, but adding extra contrasts gave a sub-linear increase in execution time (Fig. <xref rid="Fig9" ref-type="fig">9</xref>c). When the number and size of gene sets was manipulated, we found the number of gene sets gave a linear increase in mitch execution time whereas an increase in the size of gene sets gave a sub-linear increase in execution time (Fig. <xref rid="Fig9" ref-type="fig">9</xref>d). This result indicates that although mitch is slower than FGSEA for single contrast analysis, mitch enables large-scale enrichment analyses within a reasonable time.
<fig id="Fig9"><label>Fig. 9</label><caption><p>Benchmarking mitch execution time. <bold>a</bold> single-contrast enrichment analysis with mitch and FGSEA (1000 permutations) on up to 16 CPU threads. <bold>b</bold> Comparison of mitch, MAVTgsa, MD-GSA and FGSEA execution times with two to five contrasts. <bold>c</bold> Effect of number of contrasts and genes in the profiling data. (D) Effect of gene set size and number of sets</p></caption><graphic xlink:href="12864_2020_6856_Fig9_HTML" id="MO9"/></fig></p>
    </sec>
  </sec>
  <sec id="Sec24">
    <title>Discussion</title>
    <p id="Par54">Previously, we have used the concept of rank MANOVA enrichment and visualisation in several studies of cardiovascular disease, pharmacology, aging and neurological disease <bold>(eg:</bold> [<xref ref-type="bibr" rid="CR63">63</xref>, <xref ref-type="bibr" rid="CR64">64</xref>]<bold>)</bold>, but only recently has the software become available as a package for wider use. In the process of packaging the software, we have added additional features that will enhance its utility. We have made mitch interoperable with many popular upstream analysis tools, especially those from the Bioconductor community [<xref ref-type="bibr" rid="CR65">65</xref>]. We have made use of the many and varied visualisation features available in the R environment including filled contour plots, heatmaps, violin plots and taken advantage of interactive charts made possible with HTML embedded JavaScript bindings provided by the echarts4r package [<xref ref-type="bibr" rid="CR48">48</xref>].</p>
    <p id="Par55">Although mitch was initially developed to compare gene expression signatures in a multi-contrast RNA-seq experiment, it has applications beyond this. Mitch is ideally suited to multi-omics data, as demonstrated in case study 2 above that takes advantage of ENCODE profiling data to identify pathway-level regulatory events associated with dexamethasone exposure. In case study 3, we evaluated the impact of DE tool selection on enrichment results, but this approach could equally be applied to choices of other upstream data processing steps such as choice of mapping, quality control and normalisation methods.</p>
    <p id="Par56">Perhaps the most exciting application for mitch is in the burgeoning field of single cell biology as in case study 4. After data clustering by cell identity and differential state analysis, this type of data can undergo set enrichment analysis. Although unidimensional enrichment tools such as GSEA are already being applied to scRNA-seq data, there are some limitations. The MANOVA approach of mitch is better able to detect enrichments that are subtle but consistent across profiles. Moreover mitch natively summarises the results of its multi-contrast analysis, which means less work for the end user. The different prioritisation modes allows users to focus on findings that are statistically robust, associated with large effect sizes or discordant among cell identities.</p>
    <p id="Par57">Single contrast enrichment simulations show that mitch is as accurate as FGSEA, and that both these methods have better performance over a wider range of input data than the hypergeometric over-representation test (Fig. <xref rid="Fig7" ref-type="fig">7</xref>a); similar findings have been noted previously [<xref ref-type="bibr" rid="CR66">66</xref>]. Randomisation analysis of dual-contrast data shows that mitch yields very few false positives (Fig. <xref rid="Fig3" ref-type="fig">3</xref>). In dual-contrast analysis, mitch accuracy is superior to MD-GSA and FGSEA, although FGSEA accuracy could potentially be improved by using more permutations (Fig. <xref rid="Fig7" ref-type="fig">7</xref>b).</p>
    <p id="Par58">While in this paper we have limited our analyses here to human biological pathways curated by Reactome, mitch is capable of using gene sets from any source and organism for which such sets are available (eg: [<xref ref-type="bibr" rid="CR67">67</xref>]). In summary, the functionality provided by mitch makes it a versatile and powerful tool for rapidly distilling pathway level information from large omics datasets.</p>
  </sec>
  <sec id="Sec25">
    <title>Availability and requirements</title>
    <p id="Par59">Project name: mitch.</p>
    <p id="Par60">Project home page: <ext-link ext-link-type="uri" xlink:href="http://bioconductor.org/packages/mitch">http://bioconductor.org/packages/mitch</ext-link></p>
    <p id="Par61">Operating system(s): Linux, MacOS and Windows.</p>
    <p id="Par62">Programming language: R.</p>
    <p id="Par63">Other requirements: R v4.0, Bioconductor 3.11.</p>
    <p id="Par64">License: Creative Commons Attribution-ShareAlike 4.0 International Public License.</p>
    <p id="Par65">Any restrictions to use by non-academics: None.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary information</title>
    <sec id="Sec26">
      <supplementary-material content-type="local-data" id="MOESM1">
        <media xlink:href="12864_2020_6856_MOESM1_ESM.pdf">
          <caption>
            <p><bold>Additional file 1: Supplementary Figure 1.</bold> Mean absolute s scores in case study 2. Results of the multi-omics analysis shown in Fig. <xref rid="Fig4" ref-type="fig">4</xref> underwent filtering based on a 5% FDR threshold before calculating the mean absolute s values in the six-dimensional analysis (left). Next, the number of gene sets with mean absolute s values greater or lower than 0.08 was counted (right) as below this level, mitch precision is lower than expected.</p>
          </caption>
        </media>
      </supplementary-material>
      <supplementary-material content-type="local-data" id="MOESM2">
        <media xlink:href="12864_2020_6856_MOESM2_ESM.docx">
          <caption>
            <p><bold>Additional file 2: Supplementary Table 1.</bold> Multi-omics data derived from control and dexamethasone treated A549 cells obtained from the ENCODE Project web page.</p>
          </caption>
        </media>
      </supplementary-material>
    </sec>
  </sec>
</body>
<back>
  <glossary>
    <title>Abbreviations</title>
    <def-list>
      <def-item>
        <term>BAM</term>
        <def>
          <p id="Par4">Binary alignment map</p>
        </def>
      </def-item>
      <def-item>
        <term>DE</term>
        <def>
          <p id="Par5">Differential expression</p>
        </def>
      </def-item>
      <def-item>
        <term>DEE2</term>
        <def>
          <p id="Par6">Digital Expression Explorer2</p>
        </def>
      </def-item>
      <def-item>
        <term>FDR</term>
        <def>
          <p id="Par7">False discovery rate</p>
        </def>
      </def-item>
      <def-item>
        <term>FGSEA</term>
        <def>
          <p id="Par8">Fast gene set enrichment analysis</p>
        </def>
      </def-item>
      <def-item>
        <term>GEO</term>
        <def>
          <p id="Par9">Gene Expression Omnibus</p>
        </def>
      </def-item>
      <def-item>
        <term>GMT</term>
        <def>
          <p id="Par10">Gene matrix transposed</p>
        </def>
      </def-item>
      <def-item>
        <term>GSEA</term>
        <def>
          <p id="Par11">Gene Set Enrichment Analysis</p>
        </def>
      </def-item>
      <def-item>
        <term>HG</term>
        <def>
          <p id="Par12">High glucose</p>
        </def>
      </def-item>
      <def-item>
        <term>HTML</term>
        <def>
          <p id="Par13">Hypertext markup language</p>
        </def>
      </def-item>
      <def-item>
        <term>LG</term>
        <def>
          <p id="Par14">Low glucose</p>
        </def>
      </def-item>
      <def-item>
        <term>MANOVA</term>
        <def>
          <p id="Par15">Multivariate analysis of variance</p>
        </def>
      </def-item>
      <def-item>
        <term>PDF</term>
        <def>
          <p id="Par16">Portable document format</p>
        </def>
      </def-item>
      <def-item>
        <term>SD</term>
        <def>
          <p id="Par17">Standard deviation</p>
        </def>
      </def-item>
      <def-item>
        <term>VPA</term>
        <def>
          <p id="Par18">Valproic acid</p>
        </def>
      </def-item>
    </def-list>
  </glossary>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher’s Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <sec>
    <title>Supplementary information</title>
    <p><bold>Supplementary information</bold> accompanies this paper at 10.1186/s12864-020-06856-9.</p>
  </sec>
  <ack>
    <title>Acknowledgements</title>
    <p>We acknowledge and thank Dr. Scott Maxwell and Dr. Ishant Khurana of Monash University who tested and reported bugs on earlier versions of mitch. We thank Dr. Kayla-Morrell of Roswell Park Cancer Institute who provided expert code review during the Bioconductor submission. We thank Dr. Mark Richardson of Deakin University who provided comments on the draft manuscript. We acknowledge computational infrastructure support from the Nectar Research Cloud. Nectar is supported by the Australian Government through the National Collaborative Research Infrastructure Strategy (NCRIS). This work was also supported by the Victorian Government’s Operational Infrastructure Support Program and the NHMRC Independent Research Institute Infrastructure Support Scheme (IRIISS).</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Authors’ contributions</title>
    <p>Conceived the project: AK. Wrote computer code and analysed data: AK &amp; MZ. Drafted the manuscript: MZ. Both authors revised the manuscript and approved the final version.</p>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>There are no specific sources of funding for this project.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and materials</title>
    <p>The mitch package is available from Bioconductor (<ext-link ext-link-type="uri" xlink:href="https://bioconductor.org/packages/mitch">https://bioconductor.org/packages/mitch</ext-link>). The code used to generate the results shown here has been deposited to GitHub as well (<ext-link ext-link-type="uri" xlink:href="https://github.com/markziemann/mitch_paper">https://github.com/markziemann/mitch_paper</ext-link>). Publicly available data used in this study is available from the respective data banks as outlined in the methods section.</p>
  </notes>
  <notes id="FPar1">
    <title>Ethics approval and consent to participate</title>
    <p id="Par66">Not applicable.</p>
  </notes>
  <notes id="FPar2">
    <title>Consent for publication</title>
    <p id="Par67">Not applicable.</p>
  </notes>
  <notes id="FPar3" notes-type="COI-statement">
    <title>Competing interests</title>
    <p id="Par68">The authors declare that they have no competing interests.</p>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <mixed-citation publication-type="other">García-Campos MA, Espinal-Enríquez J, Hernández-Lemus E. Pathway analysis: state of the art. Front Physiol. 2015. 10.3389/fphys.2015.00383.</mixed-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <mixed-citation publication-type="other">Liu Y, Chance MR. Pathway analyses and understanding disease associations. Curr Genet Med Rep. 2013. 10.1007/s40142-013-0025-3.</mixed-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <mixed-citation publication-type="other">Abraham G, Kowalczyk A, Loi S, Haviv I, Zobel J. Prediction of breast cancer prognosis using gene set statistics provides signature stability and biological context. BMC Bioinformatics. 2010. 10.1186/1471-2105-11-277.</mixed-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Khatri</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Sirota</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Butte</surname>
            <given-names>AJ</given-names>
          </name>
        </person-group>
        <article-title>Ten years of pathway analysis: current approaches and outstanding challenges</article-title>
        <source>PLoS Comput Biol</source>
        <year>2012</year>
        <volume>8</volume>
        <issue>2</issue>
        <fpage>e1002375</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pcbi.1002375</pub-id>
        <?supplied-pmid 22383865?>
        <pub-id pub-id-type="pmid">22383865</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nguyen</surname>
            <given-names>TM</given-names>
          </name>
          <name>
            <surname>Shafi</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Nguyen</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Draghici</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Identifying significantly impacted pathways: a comprehensive review and assessment</article-title>
        <source>Genome Biol</source>
        <year>2019</year>
        <volume>20</volume>
        <issue>1</issue>
        <fpage>203</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-019-1790-4</pub-id>
        <?supplied-pmid 31597578?>
        <pub-id pub-id-type="pmid">31597578</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <mixed-citation publication-type="other">Subramanian A, Tamayo P, Mootha VK, Mukherjee S, Ebert BL, Gillette MA, et al. Gene set enrichment analysis: a knowledge-based approach for interpreting genome-wide expression profiles. Proc Natl Acad Sci U S A. 2005. 10.1073/pnas.0506580102.</mixed-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <mixed-citation publication-type="other">Ritchie ME, Phipson B, Wu D, Hu Y, Law CW, Shi W, Smyth GK. limma powers differential expression analyses for RNA-sequencing and microarray studies. Nucleic Acids Res. 2015. 10.1093/nar/gkv007.</mixed-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <mixed-citation publication-type="other">Wu D, Smyth GK. Camera: a competitive gene set test accounting for inter-gene correlation. Nucleic Acids Res. 2012. 10.1093/nar/gks461.</mixed-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <mixed-citation publication-type="other">Simillion C, Liechti R, Lischer HE, Ioannidis V, Bruggmann R. Avoiding thepitfalls of gene set enrichment analysis with SetRank. BMC Bioinformatics. 2017. 10.1186/s12859-017-1571-6.</mixed-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <mixed-citation publication-type="other">Sergushichev A. An algorithm for fast preranked gene set enrichment analysis using cumulative statistic calculation. BioRxiv. 2016. 10.1101/060012.</mixed-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <mixed-citation publication-type="other">Alhamdoosh M, Ng M, Wilson NJ, Sheridan JM, Huynh H, Wilson MJ, Ritchie ME. Combining multiple tools outperforms individual methods in gene set enrichment analyses. Bioinformatics. 2017. 10.1093/bioinformatics/btw623.</mixed-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <mixed-citation publication-type="other">Tomfohr J, Lu J, Kepler TB. Pathway level analysis of gene expression using singular value decomposition. BMC Bioinformatics. 2005. 10.1186/1471-2105-6-225.</mixed-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <mixed-citation publication-type="other">Barbie DA, Tamayo P, Boehm JS, Kim SY, Moody SE, Dunn IF, et al. Systematic RNA interference reveals that oncogenic KRAS-driven cancers require TBK1. Nature. 2009. 10.1038/nature08460.</mixed-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <mixed-citation publication-type="other">Hänzelmann S, Castelo R, Guinney J. GSVA: gene set variation analysis for microarray and RNA-seq data. BMC Bioinformatics. 2013. 10.1186/1471-2105-14-7.</mixed-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <mixed-citation publication-type="other">Clough E, Barrett T. The gene expression omnibus database. Methods Mol Biol. 2016. 10.1007/978-1-4939-3578-9_5.</mixed-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <mixed-citation publication-type="other">Tsai CA, Chen JJ. Multivariate analysis of variance test for gene set analysis. Bioinformatics. 2009. 10.1093/bioinformatics/btp098.</mixed-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <mixed-citation publication-type="other">Montaner D, Dopazo J. Multidimensional gene set analysis of genomic data. PLoS One. 2010. 10.1371/journal.pone.0010348.</mixed-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <mixed-citation publication-type="other">Cox J, Mann M. 1D and 2D annotation enrichment: a statistical method integrating quantitative proteomics with complementary high-throughput data. BMC Bioinformatics. 2012. 10.1186/1471-2105-13-S16-S12.</mixed-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <mixed-citation publication-type="other">Chien CY, Chang CW, Tsai CA, Chen JJ. MAVTgsa: an R package for gene set (enrichment) analysis. Biomed Res Int. 2014. 10.1155/2014/346074.</mixed-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <mixed-citation publication-type="other">Robinson MD, McCarthy DJ, Smyth GK. edgeR: a Bioconductor package for differential expression analysis of digital gene expression data. Bioinformatics. 2010. 10.1093/bioinformatics/btp616.</mixed-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <mixed-citation publication-type="other">Love MI, Huber W, Anders S. Moderated estimation of fold change and dispersion for RNA-seq data with DESeq2. Genome Biol. 2014. 10.1186/s13059-014-0550-8.</mixed-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <mixed-citation publication-type="other">Yang W, Rosenstiel PC, Schulenburg H. ABSSeq: a new RNA-Seq analysis method based on modelling absolute expression differences. BMC Genomics. 2016. 10.1186/s12864-016-2848-2.</mixed-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <mixed-citation publication-type="other">Harrison PF, Pattison AD, Powell DR, Beilharz TH. Topconfects: a package for confident effect sizes in differential expression analysis provides a more biologically useful ranked gene list. Genome Biol. 2019. 10.1186/s13059-019-1674-7.</mixed-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <mixed-citation publication-type="other">Zhu A, Srivastava A, Ibrahim JG, Patro R, Love MI. Nonparametric expression analysis using inferential replicate counts. Nucleic Acids Res. 2019. 10.1093/nar/gkz622.</mixed-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <mixed-citation publication-type="other">Tarazona S, Furió-Tarí P, Turrà D, Pietro AD, Nueda MJ, Ferrer A, Conesa A. Data quality aware analysis of differential expression in RNA-seq with NOISeq R/bioc package. Nucleic Acids Res. 2015. 10.1093/nar/gkv711.</mixed-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Fu</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Frazee</surname>
            <given-names>AC</given-names>
          </name>
          <name>
            <surname>Collado-Torres</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Jaffe</surname>
            <given-names>AE</given-names>
          </name>
          <name>
            <surname>Leek</surname>
            <given-names>JT</given-names>
          </name>
        </person-group>
        <source>ballgown: Flexible, isoform-level differential expression analysis. R package version 2.18.0</source>
        <year>2019</year>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <mixed-citation publication-type="other">Sun J, Nishiyama T, Shimizu K, Kadota K. TCC: an R package for comparing tag count data with robust normalization strategies. BMC Bioinformatics. 2013. 10.1186/1471-2105-14-219.</mixed-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <mixed-citation publication-type="other">Pimentel H, Bray NL, Puente S, Melsted P, Pachter L. Differential analysis of RNA-seq incorporating quantification uncertainty. Nat Methods. 2017. 10.1038/nmeth.4324.</mixed-citation>
    </ref>
    <ref id="CR29">
      <label>29.</label>
      <mixed-citation publication-type="other">Trapnell C, Hendrickson DG, Sauvageau M, Goff L, Rinn JL, Pachter L. Differential analysis of gene regulation at transcript resolution with RNA-seq. Nat Biotechnol. 2013. 10.1038/nbt.2450.</mixed-citation>
    </ref>
    <ref id="CR30">
      <label>30.</label>
      <mixed-citation publication-type="other">Xiao Y, Yang, JYH. DEDS: Differential Expression via Distance Summary for Microarray Data. R package version 1.60.0. 2019. <ext-link ext-link-type="uri" xlink:href="https://www.bioconductor.org/packages/release/bioc/html/DEDS.html">https://www.bioconductor.org/packages/release/bioc/html/DEDS.html</ext-link>. Accessed 19 Nov 2019.</mixed-citation>
    </ref>
    <ref id="CR31">
      <label>31.</label>
      <mixed-citation publication-type="other">Butler A, Hoffman P, Smibert P, Papalexi E, Satija R. Integrating single-cell transcriptomic data across different conditions, technologies, and species. Nat Biotechnol. 2018. 10.1038/nbt.4096.</mixed-citation>
    </ref>
    <ref id="CR32">
      <label>32.</label>
      <mixed-citation publication-type="other">Crowell HL, Soneson C, Germain PL, Calini D, Collin L, Raposo C, Malhotra D, Robinson MD. On the discovery of population-specific state transitions from multi-sample multi-condition single-cell RNA sequencing data. bioRxiv. 2019. 10.1101/713412.</mixed-citation>
    </ref>
    <ref id="CR33">
      <label>33.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Kharchenko</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Fan</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <source>scde: Single Cell Differential Expression. R package version 2.14.0</source>
        <year>2019</year>
      </element-citation>
    </ref>
    <ref id="CR34">
      <label>34.</label>
      <mixed-citation publication-type="other">Finak G, McDavid A, Yajima M, Deng J, Gersuk V, Shalek AK, et al. MAST: a flexible statistical framework for assessing transcriptional changes and characterizing heterogeneity in single-cell RNA sequencing data. Genome Biol. 2015. 10.1186/s13059-015-0844-5.</mixed-citation>
    </ref>
    <ref id="CR35">
      <label>35.</label>
      <mixed-citation publication-type="other">Miao Z, Deng K, Wang X, Zhang X. DEsingle for detecting three types of differential expression in single-cell RNA-seq data. Bioinformatics. 2018. 10.1093/bioinformatics/bty332.</mixed-citation>
    </ref>
    <ref id="CR36">
      <label>36.</label>
      <mixed-citation publication-type="other">Phipson B, Maksimovic J, Oshlack A. missMethyl: an R package for analyzing data from Illumina's HumanMethylation450 platform. Bioinformatics. 2016. 10.1093/bioinformatics/btv560.</mixed-citation>
    </ref>
    <ref id="CR37">
      <label>37.</label>
      <mixed-citation publication-type="other">Peters TJ, Buckley MJ, Statham AL, Pidsley R, Samaras K, Lord RV, Clark SJ, Molloy PL. De novo identification of differentially methylated regions in the human genome. Epigenetics Chromatin. 2015. 10.1186/1756-8935-8-6.</mixed-citation>
    </ref>
    <ref id="CR38">
      <label>38.</label>
      <mixed-citation publication-type="other">Zhang X, Smits AH, van Tilburg GB, Ovaa H, Huber W, Vermeulen M. Proteome-wide identification of ubiquitin interactions using UbIA-MS. Nat Protoc. 2018. 10.1038/nprot.2017.147.</mixed-citation>
    </ref>
    <ref id="CR39">
      <label>39.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Gregori</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Sanchez</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Villanueva</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <source>msmsTests: LC-MS/MS Differential Expression Tests. R package version 1.24.0</source>
        <year>2019</year>
      </element-citation>
    </ref>
    <ref id="CR40">
      <label>40.</label>
      <mixed-citation publication-type="other">Pavelka N, Pelizzola M, Vizzardelli C, Capozzoli M, Splendiani A, Granucci F, Ricciardi-Castagnoli P. A power law global error model for the identification of differentially expressed genes in microarray data. BMC Bioinformatics. 2004. 10.1186/1471-2105-5-203.</mixed-citation>
    </ref>
    <ref id="CR41">
      <label>41.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <source>SDAMS: Differential Abundant Analysis for Metabolomics and Proteomics Data. R package version 1.6.0</source>
        <year>2019</year>
      </element-citation>
    </ref>
    <ref id="CR42">
      <label>42.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Zhu</surname>
            <given-names>Y</given-names>
          </name>
        </person-group>
        <source>DEqMS: a tool to perform statistical analysis of differential protein expression for quantitative proteomics data. R package version 1.4.0</source>
        <year>2019</year>
      </element-citation>
    </ref>
    <ref id="CR43">
      <label>43.</label>
      <mixed-citation publication-type="other">Ross-Innes CS, Stark R, Teschendorff AE, Holmes KA, Ali HR, Dunning MJ, et al. Differential oestrogen receptor binding is associated with clinical outcome in breast cancer. Nature. 2012. 10.1038/nature10730.</mixed-citation>
    </ref>
    <ref id="CR44">
      <label>44.</label>
      <mixed-citation publication-type="other">Yu G, Wang L, Han Y, He Q. clusterProfiler: an R package for comparing biological themes among gene clusters. OMICS. 2012. 10.1089/omi.2011.0118.</mixed-citation>
    </ref>
    <ref id="CR45">
      <label>45.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <collab>R Core Team</collab>
        </person-group>
        <source>R: A language and environment for statistical computing</source>
        <year>2018</year>
        <publisher-loc>Vienna</publisher-loc>
        <publisher-name>R Foundation for Statistical Computing</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR46">
      <label>46.</label>
      <mixed-citation publication-type="other">Benjamini Y, Hochberg Y. Controlling the false discovery rate: a practical and powerful approach to multiple testing. J R Stat Soc B. 1995. 10.1111/j.2517-6161.1995.tb02031.x.</mixed-citation>
    </ref>
    <ref id="CR47">
      <label>47.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Wickham</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <source>ggplot2: Elegant Graphics for Data Analysis</source>
        <year>2016</year>
        <publisher-loc>New York</publisher-loc>
        <publisher-name>Springer-Verlag</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR48">
      <label>48.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Coene</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <source>echarts4r: Create Interactive Graphs with 'Echarts JavaScript' Version 4</source>
        <year>2019</year>
      </element-citation>
    </ref>
    <ref id="CR49">
      <label>49.</label>
      <mixed-citation publication-type="other">Felisbino MB, Ziemann M, Khurana I, de Oliveira CBM, Mello MS, El-Osta A. Valproic acid attenuates hyperglycemia-induced complement and coagulation cascade gene expression. bioRxiv. 2018. 10.1101/253591.</mixed-citation>
    </ref>
    <ref id="CR50">
      <label>50.</label>
      <mixed-citation publication-type="other">Ziemann M, Kaspi A, El-Osta A. Digital expression explorer 2: a repository of uniformly processed RNA sequencing data. Gigascience. 2019. 10.1093/gigascience/giz022.</mixed-citation>
    </ref>
    <ref id="CR51">
      <label>51.</label>
      <mixed-citation publication-type="other">Fabregat A, Jupe S, Matthews L, Sidiropoulos K, Gillespie M, Garapati P, et al. The Reactome pathway knowledgebase. Nucleic Acids Res. 2018. 10.1093/nar/gkz1031.</mixed-citation>
    </ref>
    <ref id="CR52">
      <label>52.</label>
      <mixed-citation publication-type="other">ENCODE Project consortium. An integrated encyclopedia of DNA elements in the human genome. Nature. 2012. 10.1038/nature11247.</mixed-citation>
    </ref>
    <ref id="CR53">
      <label>53.</label>
      <mixed-citation publication-type="other">Liao Y, Smyth GK, Shi W. featureCounts: an efficient general purpose program for assigning sequence reads to genomic features. Bioinformatics. 2014. 10.1093/bioinformatics/btt656.</mixed-citation>
    </ref>
    <ref id="CR54">
      <label>54.</label>
      <mixed-citation publication-type="other">Li H. GTFtools: a Python package for analyzing various modes of gene models. bioRxiv. 2018. 10.1101/263517.</mixed-citation>
    </ref>
    <ref id="CR55">
      <label>55.</label>
      <mixed-citation publication-type="other">Frankish A, Diekhans M, Ferreira AM, Johnson R, Jungreis I, Loveland J, et al. GENCODE reference annotation for the human and mouse genomes. Nucleic Acids Res. 2019. 10.1093/nar/gky955.</mixed-citation>
    </ref>
    <ref id="CR56">
      <label>56.</label>
      <mixed-citation publication-type="other">Keating ST, Ziemann M, Okabe J, Khan AW, Balcerczyk A, El-Osta A. Deep sequencing reveals novel Set7 networks. Cell Mol Life Sci. 2014. 10.1007/s00018-014-1651-y.</mixed-citation>
    </ref>
    <ref id="CR57">
      <label>57.</label>
      <mixed-citation publication-type="other">Lex A, Gehlenborg N, Strobelt H, Vuillemot R, Pfister H. UpSet: visualization of intersecting sets. IEEE Trans Vis Comput Graph. 2014. 10.1109/TVCG.2014.2346248.</mixed-citation>
    </ref>
    <ref id="CR58">
      <label>58.</label>
      <mixed-citation publication-type="other">Kang HM, Subramaniam M, Targ S, Nguyen M, Maliskova L, McCarthy E, et al. Multiplexed droplet single-cell RNA-sequencing using natural genetic variation. Nat Biotechnol. 2018. 10.1038/nbt.4042.</mixed-citation>
    </ref>
    <ref id="CR59">
      <label>59.</label>
      <mixed-citation publication-type="other">Lapuk AV, Wu C, Wyatt AW, McPherson A, McConeghy BJ, Brahmbhatt S, et al. From sequence to molecular pathology, and a mechanism driving the neuroendocrine phenotype in prostate cancer. J Pathol. 2012. 10.1002/path.4047.</mixed-citation>
    </ref>
    <ref id="CR60">
      <label>60.</label>
      <mixed-citation publication-type="other">Rodan SB, Rodan GA. Dexamethasone effects on beta-adrenergic receptors and adenylate cyclase regulatory proteins Gs and Gi in ROS 17/2.8 cells. Endocrinology. 1986. 10.1210/endo-118-6-2510.</mixed-citation>
    </ref>
    <ref id="CR61">
      <label>61.</label>
      <mixed-citation publication-type="other">Johannesdottir SA, Horváth-Puhó E, Dekkers OM, Cannegieter SC, Jørgensen JO, Ehrenstein V, Vandenbroucke JP, Pedersen L, Sørensen HT. Use of glucocorticoids and risk of venous thromboembolism: a nationwide population-based case-control study. JAMA Intern Med. 2013. 10.1001/jamainternmed.2013.122.</mixed-citation>
    </ref>
    <ref id="CR62">
      <label>62.</label>
      <mixed-citation publication-type="other">Long W, Wei L, Barrett EJ. Dexamethasone inhibits the stimulation of muscle protein synthesis and PHAS-I and p70 S6-kinase phosphorylation. Am J Physiol Endocrinol Metab. 2001. 10.1152/ajpendo.2001.280.4.E570.</mixed-citation>
    </ref>
    <ref id="CR63">
      <label>63.</label>
      <mixed-citation publication-type="other">Rafehi H, Kaspi A, Ziemann M, Okabe J, Karagiannis TC, El-Osta A. Systems approach to the pharmacological actions of HDAC inhibitors reveals EP300 activities and convergent mechanisms of regulation in diabetes. Epigenetics. 2017. 10.1080/15592294.2017.1371892.</mixed-citation>
    </ref>
    <ref id="CR64">
      <label>64.</label>
      <mixed-citation publication-type="other">Marques FZ, Chu PY, Ziemann M, Kaspi A, Kiriazis H, Du XJ, El-Osta A, Kaye DM. Age-related differential structural and Transcriptomic responses in the hypertensive heart. Front Physiol. 2018. 10.3389/fphys.2018.00817.</mixed-citation>
    </ref>
    <ref id="CR65">
      <label>65.</label>
      <mixed-citation publication-type="other">Gentleman RC, Carey VJ, Bates DM, Bolstad B, Dettling M, Dudoit S, et al. Bioconductor: open software development for computational biology and bioinformatics. Genome Biol. 2004. 10.1186/gb-2004-5-10-r80.</mixed-citation>
    </ref>
    <ref id="CR66">
      <label>66.</label>
      <mixed-citation publication-type="other">Khatri P, Sirota M, Butte AJ. Ten years of pathway analysis: current approaches and outstanding challenges. PLoS Comput Biol. 2012. 10.1371/journal.pcbi.1002375.</mixed-citation>
    </ref>
    <ref id="CR67">
      <label>67.</label>
      <mixed-citation publication-type="other">Bubier J, Hill D, Mukherjee G, Reynolds T, Baker EJ, Berger A, Emerson J, Blake JA, Chesler EJ. Curating gene sets: challenges and opportunities for integrative analysis. Database (Oxford). 2019. 10.1093/database/baz036.</mixed-citation>
    </ref>
  </ref-list>
</back>
