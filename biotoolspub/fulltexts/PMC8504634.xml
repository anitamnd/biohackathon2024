<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">8504634</article-id>
    <article-id pub-id-type="pmid">33792651</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btab226</article-id>
    <article-id pub-id-type="publisher-id">btab226</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Original Papers</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Gene Expression</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01060</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Fast identification of differential distributions in single-cell RNA-sequencing data with waddR</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Schefzik</surname>
          <given-names>Roman</given-names>
        </name>
        <xref rid="btab226-cor1" ref-type="corresp"/>
        <aff><institution>German Cancer Research Center (DKFZ), Somatic Evolution and Early Detection Group, </institution> 69120 Heidelberg, <country country="DE">Germany</country></aff>
        <!--roman.schefzik@medma.uni-heidelberg.de-->
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Flesch</surname>
          <given-names>Julian</given-names>
        </name>
        <aff><institution>German Cancer Research Center (DKFZ), Somatic Evolution and Early Detection Group, </institution> 69120 Heidelberg, <country country="DE">Germany</country></aff>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-3890-7658</contrib-id>
        <name>
          <surname>Goncalves</surname>
          <given-names>Angela</given-names>
        </name>
        <xref rid="btab226-cor1" ref-type="corresp"/>
        <!--a.goncalves@dkfz.de-->
        <aff><institution>German Cancer Research Center (DKFZ), Somatic Evolution and Early Detection Group, </institution> 69120 Heidelberg, <country country="DE">Germany</country></aff>
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Mathelier</surname>
          <given-names>Anthony</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="btab226-cor1">To whom correspondence should be addressed. <email>roman.schefzik@medma.uni-heidelberg.de</email>, or <email>a.goncalves@dkfz.de</email>, Present address: Department of Anaesthesiology and Surgical Intensive Care Medicine, Medical Faculty Mannheim, Heidelberg University, 68167 Mannheim, Germany.</corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <day>01</day>
      <month>10</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2021-04-01">
      <day>01</day>
      <month>4</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>01</day>
      <month>4</month>
      <year>2021</year>
    </pub-date>
    <volume>37</volume>
    <issue>19</issue>
    <fpage>3204</fpage>
    <lpage>3211</lpage>
    <history>
      <date date-type="received">
        <day>02</day>
        <month>11</month>
        <year>2020</year>
      </date>
      <date date-type="rev-recd">
        <day>02</day>
        <month>3</month>
        <year>2021</year>
      </date>
      <date date-type="editorial-decision">
        <day>29</day>
        <month>3</month>
        <year>2021</year>
      </date>
      <date date-type="accepted">
        <day>31</day>
        <month>3</month>
        <year>2021</year>
      </date>
      <date date-type="corrected-typeset">
        <day>05</day>
        <month>7</month>
        <year>2021</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2021. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2021</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btab226.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Motivation</title>
        <p>Single-cell gene expression distributions measured by single-cell RNA-sequencing (scRNA-seq) often display complex differences between samples. These differences are biologically meaningful but cannot be identified using standard methods for differential expression.</p>
      </sec>
      <sec id="s2">
        <title>Results</title>
        <p>Here, we derive and implement a flexible and fast differential distribution testing procedure based on the 2-Wasserstein distance. Our method is able to detect any type of difference in distribution between conditions. To interpret distributional differences, we decompose the 2-Wasserstein distance into terms that capture the relative contribution of changes in mean, variance and shape to the overall difference. Finally, we derive mathematical generalizations that allow our method to be used in a broad range of disciplines other than scRNA-seq or bioinformatics.</p>
      </sec>
      <sec id="s3">
        <title>Availability and implementation</title>
        <p>Our methods are implemented in the R/Bioconductor package <monospace>waddR</monospace>, which is freely available at <ext-link xlink:href="https://github.com/goncalves-lab/waddR" ext-link-type="uri">https://github.com/goncalves-lab/waddR</ext-link>, along with documentation and examples.</p>
      </sec>
      <sec id="s5">
        <title>Supplementary information</title>
        <p><xref rid="sup1" ref-type="supplementary-material">Supplementary data</xref> are available at <italic toggle="yes">Bioinformatics</italic> online.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Helmholtz Association</institution>
            <institution-id institution-id-type="DOI">10.13039/501100001656</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>VH-NG-1010</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="8"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>A typical task in genomic analyses is to identify genes whose expression varies across biological conditions. When comparing the single-cell expression distribution of a gene between two samples measured with single-cell RNA-sequencing (scRNA-seq), complex differences can often be observed between two distributions (<xref rid="btab226-B2" ref-type="bibr">Bacher and Kendziorski, 2016</xref>), including: shifts in the mean of the distributions, differences in the variance, differences in the shape of the distribution (e.g. from unimodal to multimodal), changes in the abundance of zeros or a combination of these (<xref rid="btab226-F1" ref-type="fig">Fig. 1</xref>). Such differences may be attributable to biologically meaningful changes, including for instance the induction of novel subpopulations or transient cell-states upon treatment of an otherwise homogeneous population of cells (<xref rid="btab226-B13" ref-type="bibr">Kolodziejczyk <italic toggle="yes">et al.</italic>, 2015</xref>), changes in the proportion of zeros from transcriptional bursting (<xref rid="btab226-B19" ref-type="bibr">Marinov <italic toggle="yes">et al.</italic>, 2014</xref>) or an increase in transcriptional variance during ageing (<xref rid="btab226-B20" ref-type="bibr">Martinez-Jimenez <italic toggle="yes">et al.</italic>, 2017</xref>).</p>
    <fig position="float" id="btab226-F1">
      <label>Fig. 1.</label>
      <caption>
        <p>Probability density functions illustrating different types of DDs. The corresponding decomposition of the 2-Wasserstein distance <italic toggle="yes">d</italic> between distributions into location, shape and size terms is shown below each example</p>
      </caption>
      <graphic xlink:href="btab226f1" position="float"/>
    </fig>
    <p>Despite the potential of scRNA-seq to reveal such complex patterns, the detection of these differences is beyond the scope of traditional methods for identifying differential expression. In general, statistical tools developed for detecting differential expression, such as <monospace>DESeq2</monospace> (<xref rid="btab226-B16" ref-type="bibr">Love <italic toggle="yes">et al.</italic>, 2014</xref>), <monospace>edgeR</monospace> (<xref rid="btab226-B25" ref-type="bibr">Robinson <italic toggle="yes">et al.</italic>, 2010</xref>) and most scRNA-seq-specific methods, assume that each gene has a latent unimodal level of expression within a biological condition, and have been designed to detect shifts in the mean of these distributions across conditions only. More flexible approaches are required to better characterize differences between single cells across conditions. Some methods such as <monospace>BASiCS</monospace> (<xref rid="btab226-B29" ref-type="bibr">Vallejos <italic toggle="yes">et al.</italic>, 2016</xref>) have gone beyond testing for differences in means and additionally test for differences in variance.</p>
    <p>Here, we present a flexible method for detecting differential distributions (DDs) based on the 2-Wasserstein distance (<xref rid="btab226-B24" ref-type="bibr">Panaretos and Zemel, 2019</xref>; <xref rid="btab226-B26" ref-type="bibr">Rüschendorf, 2001</xref>), that is sensitive to testing for any type of difference between two conditions. Our method can be used to test for differences between two expression distributions of a gene, e.g. between two cell-types within a sample (variant A). Alternatively, it can be used to test for differences between two conditions, e.g. when comparing the same cell-type between treatment conditions with multiple replicates (variant B). By simulation, we validate our decomposition approach and demonstrate substantial speed improvements over alternative methods for variant A testing. To demonstrate our novel approach in variant B, we apply our methods in a case study of detecting DDs between natural killer (NK) cells resident in human decidua versus blood (<xref rid="btab226-B30" ref-type="bibr">Vento-Tormo <italic toggle="yes">et al.</italic>, 2018</xref>), and highlight instances of biologically meaningful but hitherto unseen expression complexity. Our method is implemented in the R/Bioconductor package <monospace>waddR</monospace>, and generalizations are provided for the application to continuous data.</p>
  </sec>
  <sec>
    <title>2 Materials and methods</title>
    <sec>
      <title>2.1 The 2-Wasserstein distance and its decomposition</title>
      <p>For two continuous cumulative distribution functions (CDFs) <italic toggle="yes">F<sub>A</sub></italic> (with mean <italic toggle="yes">μ<sub>A</sub></italic> and standard deviation <italic toggle="yes">σ<sub>A</sub></italic>) and <italic toggle="yes">F<sub>B</sub></italic> (with mean <italic toggle="yes">μ<sub>B</sub></italic> and standard deviation <italic toggle="yes">σ<sub>B</sub></italic>) that model the distributions for conditions <italic toggle="yes">A</italic> and <italic toggle="yes">B</italic>, respectively, the squared 2-Wasserstein distance <italic toggle="yes">d</italic>, referred to as the ‘2-Wasserstein distance’ for convenience throughout the text, is given by (<xref rid="btab226-B24" ref-type="bibr">Panaretos and Zemel, 2019</xref>; <xref rid="btab226-B26" ref-type="bibr">Rüschendorf, 2001</xref>)
<disp-formula id="E1"><mml:math id="M1" display="block" overflow="scroll"><mml:mtable><mml:mtr><mml:mtd><mml:mi>d</mml:mi><mml:mo>:</mml:mo><mml:mo>=</mml:mo><mml:mi>d</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mi>A</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mi>B</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:munderover><mml:mo>∫</mml:mo><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mn>1</mml:mn></mml:munderover><mml:mo>|</mml:mo></mml:mrow><mml:msubsup><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mi>A</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>u</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:msubsup><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mi>B</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>u</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:msup><mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mi mathvariant="normal">d</mml:mi><mml:mi>u</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>=</mml:mo><mml:munder><mml:munder><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mo>μ</mml:mo></mml:mrow><mml:mi>A</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mo>μ</mml:mo></mml:mrow><mml:mi>B</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mo stretchy="false">︸</mml:mo></mml:munder><mml:mrow><mml:mi>location</mml:mi></mml:mrow></mml:munder><mml:mo>+</mml:mo><mml:munder><mml:munder><mml:mrow><mml:munder><mml:munder><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mi>A</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mi>B</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mo stretchy="false">︸</mml:mo></mml:munder><mml:mrow><mml:mi>size</mml:mi></mml:mrow></mml:munder><mml:mo>+</mml:mo><mml:munder><mml:munder><mml:mrow><mml:mn>2</mml:mn><mml:msub><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mi>A</mml:mi></mml:msub><mml:msub><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mi>B</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mo>ρ</mml:mo></mml:mrow><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">︸</mml:mo></mml:munder><mml:mrow><mml:mi>shape</mml:mi></mml:mrow></mml:munder></mml:mrow><mml:mo stretchy="false">︸</mml:mo></mml:munder><mml:mrow><mml:mi>variability</mml:mi></mml:mrow></mml:munder><mml:mo>,</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula>where <inline-formula id="IE1"><mml:math id="IM1" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mo>ρ</mml:mo></mml:mrow><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math></inline-formula> is the Pearson correlation coefficient of the points in the quantile–quantile (Q–Q) plot of <italic toggle="yes">F<sub>A</sub></italic> and <italic toggle="yes">F<sub>B</sub></italic>. In this useful decomposition of <italic toggle="yes">d</italic>, differences in location and size are quantified by the squared differences of the means and standard deviations, respectively, while differences in shape may refer to differences with respect to modalities or skewness and are mainly covered by the correlation coefficient <inline-formula id="IE2"><mml:math id="IM2" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mo>ρ</mml:mo></mml:mrow><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> (<xref rid="btab226-B9" ref-type="bibr">Irpino and Verde, 2015</xref>). Typically, the distributions <italic toggle="yes">F<sub>A</sub></italic> and <italic toggle="yes">F<sub>B</sub></italic> are not explicitly given and information is only available in the form of samples. Here we use the corresponding empirical CDFs <inline-formula id="IE3"><mml:math id="IM3" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>F</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mi>A</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE4"><mml:math id="IM4" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>F</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mi>B</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> to approximate the distributions (<xref rid="sup1" ref-type="supplementary-material">Supplementary Material</xref> S1).</p>
    </sec>
    <sec>
      <title>2.2 Semi-parametric permutation test with generalized Pareto distribution approximation (<monospace>waddR</monospace> SP)</title>
      <p>To test whether two distributions (CDFs) <italic toggle="yes">F<sub>A</sub></italic> and <italic toggle="yes">F<sub>B</sub></italic> represented by two samples are significantly differentially distributed, we specifically test the null hypothesis <inline-formula id="IE5"><mml:math id="IM5" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mn>0</mml:mn></mml:msub><mml:mo>:</mml:mo><mml:msub><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mi>A</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mi>B</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> against the alternative <inline-formula id="IE6"><mml:math id="IM6" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>:</mml:mo><mml:msub><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mi>A</mml:mi></mml:msub><mml:mo>≠</mml:mo><mml:msub><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mi>B</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> using the 2-Wasserstein distance. In a semi-parametric (SP) testing procedure we combine a classical permutation test with a generalized Pareto distribution (GPD) approximation to derive a <italic toggle="yes">P</italic>-value (similar but not identical to <xref rid="btab226-B21" ref-type="bibr">Matsui <italic toggle="yes">et al.</italic>, 2016</xref>). We employ the sample-based 2-Wasserstein distance <inline-formula id="IE7"><mml:math id="IM7" display="inline" overflow="scroll"><mml:mrow><mml:mi>d</mml:mi><mml:mo>≥</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> as a test statistic here and test <inline-formula id="IE8"><mml:math id="IM8" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mn>0</mml:mn></mml:msub><mml:mo>:</mml:mo><mml:mi>d</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> against <inline-formula id="IE9"><mml:math id="IM9" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>:</mml:mo><mml:mi>d</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> to identify differences in distributions. As it is usually computationally infeasible to compute all permutations, we use a subset of size <inline-formula id="IE10"><mml:math id="IM10" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>sub</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> of all the permutations. Moreover, to avoid <italic toggle="yes">P</italic>-values of exactly zero we insert a pseudo-count. Consequently, the <italic toggle="yes">P</italic>-value has a lower bound of <inline-formula id="IE11"><mml:math id="IM11" display="inline" overflow="scroll"><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>sub</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>. However, in high-dimensional applications, such as in genomics, a very high resolution for the <italic toggle="yes">P</italic>-values is often required, because the threshold for statistical significance may be close to zero due to multiplicity correction (<xref rid="btab226-B3" ref-type="bibr">Benjamini and Hochberg, 1995</xref>). To address this, we use the approach in <xref rid="btab226-B12" ref-type="bibr">Knijnenburg <italic toggle="yes">et al.</italic> (2009)</xref> and model the tail of the distribution of the test statistic values obtained by permutations using a GPD (<xref rid="sup1" ref-type="supplementary-material">Supplementary Material</xref> S1).</p>
    </sec>
    <sec>
      <title>2.3 Different testing scenarios in scRNA-seq experiments</title>
      <p>We distinguish two different scenarios in the context of DD testing for discrete scRNA-seq data: in the first setting A, gene expression data are only available from one replicate per condition (e.g. when comparing two cell types within a sample), while in the second scenario B, there are expression data from multiple replicates per condition (e.g. when comparing the same cell-type under different experimental conditions). As the starting point for our <monospace>waddR</monospace> approaches, we assume a pre-processed (normalized) scRNA-seq data matrix consisting of expression values for multiple genes over multiple cells.</p>
      <sec>
        <title>2.3.1 Variant A: one replicate per condition</title>
        <p>In the setting in which expression data is only available for one replicate per condition, the aim is to test whether two expression distributions of a gene are significantly different. To incorporate the special role of zero expression in scRNA-seq data, i.e. the point mass at zero, we divide the procedure into two parts and propose the following two-stage approach: (i) test for differential proportions of zero expression (DPZ) between the two conditions using a Bayesian logistic regression model, taking account of the cellular detection rate in order to correct for differences in total counts per cell (<xref rid="btab226-B8" ref-type="bibr">Finak <italic toggle="yes">et al.</italic>, 2015</xref>; <xref rid="btab226-B15" ref-type="bibr">Korthauer <italic toggle="yes">et al.</italic>, 2016</xref>); and (ii) separately test for differences in non-zero expression by applying the semi-parametric <monospace>waddR</monospace> SP testing procedure to the non-zero expression values only. This approach yields two <italic toggle="yes">P</italic>-values, <inline-formula id="IE12"><mml:math id="IM12" display="inline" overflow="scroll"><mml:mrow><mml:mi>P</mml:mi><mml:mo>.</mml:mo><mml:mi>zero</mml:mi></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE13"><mml:math id="IM13" display="inline" overflow="scroll"><mml:mrow><mml:mi>P</mml:mi><mml:mo>.</mml:mo><mml:mi>nonzero</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>SP</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>. The <italic toggle="yes">P</italic>-values <inline-formula id="IE14"><mml:math id="IM14" display="inline" overflow="scroll"><mml:mrow><mml:mi>P</mml:mi><mml:mo>.</mml:mo><mml:mi>zero</mml:mi></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE15"><mml:math id="IM15" display="inline" overflow="scroll"><mml:mrow><mml:mi>P</mml:mi><mml:mo>.</mml:mo><mml:mi>nonzero</mml:mi></mml:mrow></mml:math></inline-formula> can be combined into an overall <italic toggle="yes">P</italic>-value <inline-formula id="IE16"><mml:math id="IM16" display="inline" overflow="scroll"><mml:mrow><mml:mi>P</mml:mi><mml:mo>.</mml:mo><mml:mi>comb</mml:mi></mml:mrow></mml:math></inline-formula> for DD using the classical Fisher method (<xref rid="sup1" ref-type="supplementary-material">Supplementary Material</xref> S1, Supplementary Fig. S2).</p>
      </sec>
      <sec>
        <title>2.3.2 Variant B: testing between two conditions with multiple replicates</title>
        <p>In our second setting, expression data is available from multiple replicates per condition. Here, data may be unpaired or paired. In the unpaired setting, data come from two separate sets of independent and identically distributed samples, e.g. when data for condition <italic toggle="yes">A</italic> stem from multiple instances that are different from those in condition <italic toggle="yes">B</italic>. In the paired setting, data for condition <italic toggle="yes">A</italic> arise from the same instances as for condition <italic toggle="yes">B</italic>. A typical example of a paired setting would be data stemming from the same individual tested under two different conditions <italic toggle="yes">A</italic> and <italic toggle="yes">B</italic>.</p>
        <list list-type="order">
          <list-item>
            <p>For DPZ testing for the paired setting we employ the Cochran-Mantel-Haenszel (CMH) test, a multi-dimensional generalization of the classical Fisher’s exact proportion test, yielding a respective <italic toggle="yes">P</italic>-value <inline-formula id="IE17"><mml:math id="IM17" display="inline" overflow="scroll"><mml:mrow><mml:mi>P</mml:mi><mml:mo>.</mml:mo><mml:mi>zero</mml:mi></mml:mrow></mml:math></inline-formula>. For DPZ testing for the unpaired setting, with possibly different numbers of replicates per condition, log-linear models may be used.</p>
          </list-item>
          <list-item>
            <p>For non-zero expression testing we employ the following procedure based on 2-Wasserstein distances, which can in principle be applied to both paired and unpaired settings. Based on <italic toggle="yes">R</italic> replicates and two conditions <italic toggle="yes">A</italic> and <italic toggle="yes">B</italic>, we calculate the 2-Wasserstein distances <inline-formula id="IE18"><mml:math id="IM18" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="script">D</mml:mi></mml:mrow><mml:mrow><mml:mi>BC</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> for all comparisons between the conditions and the 2-Wasserstein distances <inline-formula id="IE19"><mml:math id="IM19" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="script">D</mml:mi></mml:mrow><mml:mrow><mml:mi>WC</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> for all comparisons within the conditions. Finally, we employ the Wilcoxon rank sum test to test for mean differences between the distance values in <inline-formula id="IE20"><mml:math id="IM20" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="script">D</mml:mi></mml:mrow><mml:mrow><mml:mi>BC</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE21"><mml:math id="IM21" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="script">D</mml:mi></mml:mrow><mml:mrow><mml:mi>WC</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>, yielding a corresponding <italic toggle="yes">P</italic>-value <inline-formula id="IE22"><mml:math id="IM22" display="inline" overflow="scroll"><mml:mrow><mml:mi>P</mml:mi><mml:mo>.</mml:mo><mml:mi>nonzero</mml:mi></mml:mrow></mml:math></inline-formula>. An overall decomposition of the distance into location, size and shape components can be readily calculated as an average of the <inline-formula id="IE23"><mml:math id="IM23" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="script">D</mml:mi></mml:mrow><mml:mrow><mml:mi>BC</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> decomposition fractions.</p>
          </list-item>
        </list>
        <p>As for variant A, the <italic toggle="yes">P</italic>-values <italic toggle="yes">P</italic>.zero and <italic toggle="yes">P</italic>.non-zero can be combined into an overall <italic toggle="yes">P</italic>-value <italic toggle="yes">P</italic>.comb for DD using the classical Fisher method.</p>
      </sec>
    </sec>
    <sec>
      <title>2.4 Generalization to applications beyond scRNA-seq</title>
      <p><monospace>waddR</monospace> is potentially useful in a diverse range of practical applications beyond scRNA-seq, i.e. whenever the aim is to test whether there are significant differences between two distributions. Examples include methylation array experiments (<xref rid="btab226-B21" ref-type="bibr">Matsui <italic toggle="yes">et al.</italic>, 2016</xref>) or fluorescence-activated cell sorting (FACS) data, but may also go beyond bioinformatics applications, e.g. ensemble forecasts in modern weather prediction (<xref rid="btab226-B4" ref-type="bibr">Buizza, 2018</xref>). For applications which can be assumed to come from continuous distributions, we have implemented the <monospace>waddR</monospace> ASY variant that makes use of an asymptotic result for the null distribution of the 2-Wasserstein distance (<xref rid="sup1" ref-type="supplementary-material">Supplementary Material</xref> S1, Supplementary Fig. S1). This variant substitutes the computationally expensive permutation procedure SP, that is used in the context of scRNA-seq data, for continuous data.</p>
    </sec>
  </sec>
  <sec>
    <title>3 Results</title>
    <sec>
      <title>3.1 Simulation experiments to validate <monospace>waddR</monospace> SP and <monospace>waddR</monospace> ASY testing procedures</title>
      <p>To validate the decomposition of the 2-Wasserstein distance and the SP and ASY testing procedures, we demonstrate that <monospace>waddR</monospace> shows reasonable performances regarding detection power and type I error and is able to identify the causes of the differences between two distributions correctly in a set of simulations studies based on normal (<xref rid="sup1" ref-type="supplementary-material">Supplementary Material</xref> S2, Supplementary Figs S3–S9, Supplementary Tables S2 and S3) and Gamma distribution models (<xref rid="sup1" ref-type="supplementary-material">Supplementary Material</xref> S3, Supplementary Figs S10–S12, Supplementary Tables S4 and S5).</p>
    </sec>
    <sec>
      <title>3.2 Simulation experiments based on scRNA-seq data for <monospace>waddR</monospace> variant a</title>
      <p>Here we perform investigations based on simulations adapted to the context of scRNA-seq data and in comparison to two alternative methods for testing one replicate per condition (variant A).</p>
      <sec>
        <label>3.2.1</label>
        <title>Methods for comparison</title>
        <p>A number of methods specialized for scRNA-seq differential expression testing between conditions with multiple replicates have been developed in recent years [reviewed in <xref rid="btab226-B22" ref-type="bibr">Miao and Zhang (2016)</xref>, <xref rid="btab226-B10" ref-type="bibr">Jaakkola <italic toggle="yes">et al.</italic> (2017)</xref>, <xref rid="btab226-B7" ref-type="bibr">Dal Molin <italic toggle="yes">et al.</italic> (2017)</xref>, <xref rid="btab226-B27" ref-type="bibr">Soneson and Robinson (2018)</xref>, <xref rid="btab226-B32" ref-type="bibr">Wang et al. (2019)</xref> and Supplementary Table S6]. Of these, the majority tackle the problem of testing for differences in means while addressing the statistical challenges posed by high levels of technical noise and intrinsic biological variability in single-cell experiments. Some methods such as <monospace>BASiCS</monospace> (<xref rid="btab226-B29" ref-type="bibr">Vallejos <italic toggle="yes">et al.</italic>, 2016</xref>) and <monospace>DEsingle</monospace> (<xref rid="btab226-B23" ref-type="bibr">Miao <italic toggle="yes">et al.</italic>, 2018</xref>), have gone beyond testing for differences in means and additionally test for differences in variance (<monospace>BASiCS</monospace>) or differences in the proportion of zeros (<monospace>DEsingle</monospace>). Our method tests instead for any change in the full distribution, thus capturing the highly complex expression patterns frequently observed in scRNA-seq datasets (<xref rid="btab226-B15" ref-type="bibr">Korthauer <italic toggle="yes">et al.</italic>, 2016</xref>). To our knowledge, no other method is readily applicable to testing for DD shape between conditions with replicates (variant B).</p>
        <p>For variant A, we compare our approach to two previously published methods, <monospace>scDD</monospace> (<xref rid="btab226-B15" ref-type="bibr">Korthauer <italic toggle="yes">et al.</italic>, 2016</xref>) and <monospace>SigEMD</monospace> (<xref rid="btab226-B31" ref-type="bibr">Wang and Nabavi, 2018</xref>), which have been developed to explicitly test for differences in shape between two distributions. Given that both <monospace>scDD</monospace> and <monospace>SigEMD</monospace> use the same approach to detect DPZs as <monospace>waddR</monospace>, we limit our comparisons to the non-zero part.</p>
        <p><monospace>scDD</monospace> (<xref rid="btab226-B15" ref-type="bibr">Korthauer <italic toggle="yes">et al.</italic>, 2016</xref>) models non-zero, multi-modal expression using a Dirichlet process mixture of normals. It provides a characterization of the type of the DD by explicitly modelling the following patterns: traditional mean-based differential expression (DE), differential modality (DM), differential mode weights (DP) and a combination of the previous two (DB). To calculate a <italic toggle="yes">P</italic>-value, <monospace>scDD</monospace> originally uses a permutation test based on Bayes factor scores. As this procedure is computationally expensive, a second, computationally faster, option is provided which employs a KS test instead. However, the KS test as used in <monospace>scDD</monospace> is originally designed for continuous data, and is not the best choice for the scRNA-seq setting in which we have expression data derived from discrete read counts.</p>
        <p><monospace>waddR</monospace> is conceptually simpler than <monospace>scDD</monospace> and requires fewer (virtually no) assumptions or modelling, thus requiring less computation time. While for non-zero differential expression, <monospace>scDD</monospace> provides a single category of DD as an output (categorization), <monospace>waddR</monospace> provides information on differences via the decomposition of the 2-Wasserstein distance test statistic. For example, it is possible to combine results from different replicates with our method, by averaging the corresponding fractions of location, size and shape components for each replicate as discussed before. This is not directly possible with the categorical output of <monospace>scDD</monospace>.</p>
        <p>The second reference approach, <monospace>SigEMD</monospace> (<xref rid="btab226-B31" ref-type="bibr">Wang and Nabavi, 2018</xref>), employs the Earth Mover’s distance (EMD) for DD analysis of expression values distributions. Compared to <monospace>SigEMD</monospace>, <monospace>waddR</monospace> uses the 2-Wasserstein distance including its decomposition and not the EMD, which is in fact the 1-Wasserstein distance and for which there is no similar decomposition readily available. The calculation of the Wasserstein distance in <monospace>SigEMD</monospace> is based on solving an optimization problem, following an alternative, original, definition of the Wasserstein distance, which is computationally intensive. In contrast, <monospace>waddR</monospace> makes use of an equivalent quantile representation of the Wasserstein distance, which can be conveniently interpreted and directly computed, while allowing for a computationally faster implementation.</p>
      </sec>
      <sec>
        <label>3.2.2</label>
        <title>Setting of the simulation study</title>
        <p>We created simulated scRNA-seq data based on the simulation procedures in <xref rid="btab226-B15" ref-type="bibr">Korthauer <italic toggle="yes">et al.</italic> (2016)</xref>, using the example dataset, default hyperparameter choices and simulation function from the <monospace>scDD</monospace> package. In particular, we generate <inline-formula id="IE24"><mml:math id="IM24" display="inline" overflow="scroll"><mml:mrow><mml:mi>G</mml:mi><mml:mo>:</mml:mo><mml:mo>=</mml:mo><mml:mn>1000</mml:mn></mml:mrow></mml:math></inline-formula> genes across two conditions with <italic toggle="yes">C</italic> cells each, where we here employ the three different numbers of cells (i.e. sample sizes) <inline-formula id="IE25"><mml:math id="IM25" display="inline" overflow="scroll"><mml:mrow><mml:mi>C</mml:mi><mml:mo>∈</mml:mo><mml:mo>{</mml:mo><mml:mn>50</mml:mn><mml:mo>,</mml:mo><mml:mn>100</mml:mn><mml:mo>,</mml:mo><mml:mn>500</mml:mn><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula>.</p>
        <p>In each scenario, 100 of the <italic toggle="yes">G </italic>=<italic toggle="yes"> </italic>1000 genes are generated as differentially distributed and equally divided into the following four different categories of DDs (i.e. 25 genes per category):</p>
        <list list-type="bullet">
          <list-item>
            <p>traditional differential expression (DE): two unimodal distributions with different means,</p>
          </list-item>
          <list-item>
            <p>differential proportions of cells within each component (DP): two bimodal distributions with the same modes, but with different proportions of cells of each mode,</p>
          </list-item>
          <list-item>
            <p>differential modality (DM): one unimodal distribution and one bimodal distribution with one mode being identical to that of the univariate distribution,</p>
          </list-item>
          <list-item>
            <p>both differential modality and different component means (DB): one unimodal distribution and one bimodal distribution with no common modes.</p>
          </list-item>
        </list>
        <p>We generated the remaining 900 genes as non-DD genes by creating one half (i.e. 450 genes) from the same unimodal distribution [corresponds to the equivalent expression (EE) category in <monospace>scDD</monospace>] and the other half (i.e. 450 genes) from the same negative binomial model with two components [corresponds to the equivalent proportion (EP) category in <monospace>scDD</monospace>]. Finally, we consider three different degrees of DDs (weak, medium, strong) by varying the fold changes between the modes for the DP, DM and DB settings from 2 over 4 to 6, while fixing standard deviations of the fold changes to 2, see <xref rid="btab226-B15" ref-type="bibr">Korthauer <italic toggle="yes">et al.</italic> (2016)</xref> and the <monospace>scDD</monospace> package manual for details. For each method, 1000 permutations are used to obtain the respective testing results.</p>
      </sec>
      <sec>
        <label>3.2.3</label>
        <title>Simulation results</title>
        <p>We evaluate the performance of <monospace>waddR</monospace> and the reference methods by considering sensitivity, specificity, precision, accuracy and the receiver operating characteristic (ROC) curves with corresponding area under the curve (AUC) values (<xref rid="btab226-F2" ref-type="fig">Fig. 2A, C</xref> and Supplementary Figs S13 and S14). Overall, <monospace>waddR</monospace> shows good performances that typically get better with increasing number of cells and more pronounced degrees of DD (Supplementary Figs S13 and S14). In particular, <monospace>waddR</monospace> outperforms <monospace>scDD</monospace> or performs similarly well in the majority of the considered cases. In some cases, <monospace>SigEMD</monospace> performs a little better than <monospace>waddR</monospace> and <monospace>scDD</monospace>. Overall, <monospace>waddR</monospace> yields good detection powers (sensitivity) with respect to the four different <monospace>scDD</monospace> categories for simulated DD genes, especially when there is a medium or strong degree of DD and a reasonably large number of cells (<xref rid="btab226-F2" ref-type="fig">Fig. 2B</xref> and Supplementary Fig. S15). There are only certain weaknesses in detecting DDs of the type DP and DB for small numbers of cells and when the degree of DD is not very pronounced. However, this also holds for the other methods and confirms results obtained in previous simulation studies (<xref rid="btab226-B15" ref-type="bibr">Korthauer <italic toggle="yes">et al.</italic>, 2016</xref>; <xref rid="btab226-B31" ref-type="bibr">Wang and Nabavi, 2018</xref>).</p>
        <fig position="float" id="btab226-F2">
          <label>Fig. 2.</label>
          <caption>
            <p>(<bold>A–C</bold>) Performance metrics when simulating a weak degree of DD and with <italic toggle="yes">P</italic>-value threshold of 0.05: (A) Sensitivity and specificity depending on the number of cells. (B) Detection powers for the different DD categories according to <xref rid="btab226-B15" ref-type="bibr">Korthauer <italic toggle="yes">et al.</italic> (2016)</xref>, depending on number of cells <italic toggle="yes">C</italic>. (C) ROC curves with AUC values, depending on number of cells <italic toggle="yes">C</italic>. (<bold>D</bold>) Decomposition of the 2-Wasserstein distance for <italic toggle="yes">C </italic>=<italic toggle="yes"> </italic>500 and a strong degree of DD for the different DD categories, shown for those genes that have been detected as DD. Note that there is no exact one-to-one correspondence and interpretation between the <monospace>scDD</monospace> categories and the terms of the decomposition of the 2-Wasserstein distance. (<bold>E</bold>) Violin plots of the correlation coefficient <italic toggle="yes">ρ</italic> in the decomposition of the 2-Wasserstein distance for <italic toggle="yes">C </italic>=<italic toggle="yes"> </italic>500 and a strong degree of DD for the different DD categories, based on those genes that have been detected as DD</p>
          </caption>
          <graphic xlink:href="btab226f2" position="float"/>
        </fig>
        <p>The behaviour of the decomposition with respect to the different DD categories DE, DP, DM and DB is shown in <xref rid="btab226-F2" ref-type="fig">Figure 2D</xref>. Similar tendencies can also be found in the other settings (Supplementary Fig. S16). For the DE category, both differences in location and size make up the overall difference. In contrast, the shape component is negligible. This is in agreement with the definition and construction of the DE category in <monospace>scDD</monospace>, where only shifts in location and size are expected. For the DP category, each of the location, size and shape components may contribute to the overall distance, with the shape component typically taking on a more pronounced role than size, when compared to the other categories. The DM and DB categories show a similar behaviour regarding the decomposition of the 2-Wasserstein distance. In both cases, the size component is very pronounced, while the location and in particular the shape components are rather small. However, when looking at the correlation coefficients <italic toggle="yes">ρ</italic>, a difference with respect to shape is also apparent. The very strong influence of the size component, i.e. the large difference between the standard deviations, causes the shape term to become negligible in the decomposition, even though the values of the correlation coefficient <italic toggle="yes">ρ</italic> suggest that there are also differences with respect to shape (<xref rid="btab226-F2" ref-type="fig">Fig. 2E</xref> and Supplementary Fig. S16).</p>
        <p>The main advantage of <monospace>waddR</monospace> compared to the reference methods <monospace>scDD</monospace> and <monospace>SigEMD</monospace> is the reduced computational running time (<xref rid="btab226-T1" ref-type="table">Tables 1</xref> and <xref rid="btab226-T2" ref-type="table">2</xref>). In general, computation time depends on the number of genes, the number of cells, the degree of the DD and the number of the permutations employed in the analysis method. Regarding our simulation studies here, we have <inline-formula id="IE26"><mml:math id="IM26" display="inline" overflow="scroll"><mml:mrow><mml:mi>G</mml:mi><mml:mo>:</mml:mo><mml:mo>=</mml:mo><mml:mn>1000</mml:mn></mml:mrow></mml:math></inline-formula> genes and 1000 permutations. All methods were run on the same computer, using the default settings of the reference methods. We report average approximate running times over the three different degrees of DD, for each number of cells separately (<xref rid="btab226-T1" ref-type="table">Table 1</xref>). Interestingly, the running times were typically consistent across the different degrees of DDs for <monospace>scDD</monospace> and <monospace>waddR</monospace>, whereas they were considerably different for <monospace>SigEMD</monospace>, in that the stronger the degree of DD the longer the computation takes. <monospace>waddR</monospace> is by far the fastest of all considered permutation-based approaches, due to its simpler underlying concept and implementation, but also as it employs a fast and efficient C++ implementation of the permutation procedure and the calculation of the 2-Wasserstein distance(s). The benefit of <monospace>waddR</monospace> becomes more obvious when looking at the running times when using 10000 permutations, which is typically a more reasonable number of permutations to obtain reliable results. <xref rid="btab226-T2" ref-type="table">Table 2</xref> shows a comparison of the running times based on using 1000 or 10000 permutations, respectively, for the computationally cheapest setting of <italic toggle="yes">C </italic>=<italic toggle="yes"> </italic>50 with a weak degree of DD. While an increase in the number of employed permutations increases the running time of <monospace>scDD</monospace> drastically (by several days) and that of <monospace>SigEMD</monospace> considerably (by approximately a day), the increase for <monospace>waddR</monospace> is very moderately (by several minutes). Further, running times are also expected to increase with the number of genes. As typical scRNA-seq datasets comprise much more than 1000 genes as considered in our simulation studies, computational running times may get even more important, with <monospace>waddR</monospace> providing the fastest of all considered implementations.</p>
        <table-wrap position="float" id="btab226-T1">
          <label>Table 1.</label>
          <caption>
            <p>Approximate running times averaged across all degrees of DD within the simulation studies, depending on the number of cells <italic toggle="yes">C</italic></p>
          </caption>
          <table frame="hsides" rules="groups">
            <colgroup span="1">
              <col valign="top" align="left" span="1"/>
              <col valign="top" align="center" span="1"/>
              <col valign="top" align="center" span="1"/>
              <col valign="top" align="center" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <th rowspan="1" colspan="1"/>
                <th rowspan="1" colspan="1"><italic toggle="yes">C </italic>=<italic toggle="yes"> </italic>50</th>
                <th rowspan="1" colspan="1"><italic toggle="yes">C </italic>=<italic toggle="yes"> </italic>100</th>
                <th rowspan="1" colspan="1"><italic toggle="yes">C </italic>=<italic toggle="yes"> </italic>500</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td rowspan="1" colspan="1">
                  <monospace>scDD</monospace>
                </td>
                <td rowspan="1" colspan="1"><inline-formula id="IE27"><mml:math id="IM27" display="inline" overflow="scroll"><mml:mo>≈</mml:mo></mml:math></inline-formula> 10 h</td>
                <td rowspan="1" colspan="1"><inline-formula id="IE28"><mml:math id="IM28" display="inline" overflow="scroll"><mml:mo>≈</mml:mo></mml:math></inline-formula> 18 h</td>
                <td rowspan="1" colspan="1"><inline-formula id="IE29"><mml:math id="IM29" display="inline" overflow="scroll"><mml:mo>≈</mml:mo></mml:math></inline-formula> 38 h</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">
                  <monospace>SigEMD</monospace>
                </td>
                <td rowspan="1" colspan="1"><inline-formula id="IE30"><mml:math id="IM30" display="inline" overflow="scroll"><mml:mo>≈</mml:mo></mml:math></inline-formula> 41 h</td>
                <td rowspan="1" colspan="1"><inline-formula id="IE31"><mml:math id="IM31" display="inline" overflow="scroll"><mml:mo>≈</mml:mo></mml:math></inline-formula> 52 h</td>
                <td rowspan="1" colspan="1"><inline-formula id="IE32"><mml:math id="IM32" display="inline" overflow="scroll"><mml:mo>≈</mml:mo></mml:math></inline-formula> 82 h</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">
                  <monospace>waddR</monospace>
                </td>
                <td rowspan="1" colspan="1"><inline-formula id="IE33"><mml:math id="IM33" display="inline" overflow="scroll"><mml:mo>≈</mml:mo></mml:math></inline-formula> 1 min</td>
                <td rowspan="1" colspan="1"><inline-formula id="IE34"><mml:math id="IM34" display="inline" overflow="scroll"><mml:mo>≈</mml:mo></mml:math></inline-formula> 1 min</td>
                <td rowspan="1" colspan="1"><inline-formula id="IE35"><mml:math id="IM35" display="inline" overflow="scroll"><mml:mo>≈</mml:mo></mml:math></inline-formula> 1 min</td>
              </tr>
            </tbody>
          </table>
        </table-wrap>
        <table-wrap position="float" id="btab226-T2">
          <label>Table 2.</label>
          <caption>
            <p>Approximate running times for <italic toggle="yes">C </italic>=<italic toggle="yes"> </italic>50 and a weak degree of DD in the simulation study when employing 1000 and 10000 permutations, respectively</p>
          </caption>
          <table frame="hsides" rules="groups">
            <colgroup span="1">
              <col valign="top" align="left" span="1"/>
              <col valign="top" align="center" span="1"/>
              <col valign="top" align="center" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <th rowspan="1" colspan="1"/>
                <th rowspan="1" colspan="1">1000 permutations</th>
                <th rowspan="1" colspan="1">10000 permutations</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td rowspan="1" colspan="1">
                  <monospace>scDD</monospace>
                </td>
                <td rowspan="1" colspan="1"><inline-formula id="IE36"><mml:math id="IM36" display="inline" overflow="scroll"><mml:mo>≈</mml:mo></mml:math></inline-formula> 10 h</td>
                <td rowspan="1" colspan="1"><inline-formula id="IE37"><mml:math id="IM37" display="inline" overflow="scroll"><mml:mo>≈</mml:mo></mml:math></inline-formula> 3 days</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">
                  <monospace>SigEMD</monospace>
                </td>
                <td rowspan="1" colspan="1"><inline-formula id="IE38"><mml:math id="IM38" display="inline" overflow="scroll"><mml:mo>≈</mml:mo></mml:math></inline-formula> 5 h</td>
                <td rowspan="1" colspan="1"><inline-formula id="IE39"><mml:math id="IM39" display="inline" overflow="scroll"><mml:mo>≈</mml:mo></mml:math></inline-formula> 28 h</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">
                  <monospace>waddR</monospace>
                </td>
                <td rowspan="1" colspan="1"><inline-formula id="IE40"><mml:math id="IM40" display="inline" overflow="scroll"><mml:mo>≈</mml:mo></mml:math></inline-formula> 1 min</td>
                <td rowspan="1" colspan="1"><inline-formula id="IE41"><mml:math id="IM41" display="inline" overflow="scroll"><mml:mo>≈</mml:mo></mml:math></inline-formula> 8 min</td>
              </tr>
            </tbody>
          </table>
        </table-wrap>
        <p>In summary, in our simulation studies of variant A, <monospace>waddR</monospace> is equivalent or outperforms the reference methods <monospace>scDD</monospace> and <monospace>SigEMD</monospace> with respect to common performance criteria. The most obvious benefit of <monospace>waddR</monospace> is a reduced computation time, even though, as <monospace>scDD</monospace> and <monospace>SigEMD</monospace>, it is based on a permutation testing procedure. <monospace>waddR</monospace> also benefits from its conceptual simplicity, as it comes without sophisticated modelling (<monospace>scDD</monospace>) or the need to solve optimization problems (<monospace>SigEMD</monospace>) that may be computationally intense.</p>
      </sec>
    </sec>
    <sec>
      <title>3.3 Benchmarking <monospace>waddR</monospace> variant B using real scRNA-seq data</title>
      <p>To validate the performance of <monospace>waddR</monospace> variant B for multiple replicates, we apply our method to the real Fluidigm C1 platform-based scRNA-seq dataset of <xref rid="btab226-B28" ref-type="bibr">Tung <italic toggle="yes">et al.</italic> (2017)</xref>. For this dataset, there exists a matching bulk RNA-seq dataset, from which we derive a list of reference differentially expressed genes that we employ as the ground truth to compare against. Furthermore, we investigate the impact of the number of replicates and the use of some of the most widely used normalization methods on performance (<xref rid="sup1" ref-type="supplementary-material">Supplementary Material</xref> S5).</p>
      <p>In this benchmarking study, <monospace>waddR</monospace> shows adequate ROC curves (Supplementary Fig. S17) and FDR curves (Supplementary Fig. S18), with a reasonable balance between sensitivity and specificity (Supplementary Table S7). Moreover, <monospace>waddR</monospace> exhibits a good control of type I errors (Supplementary Figs S19 and S20). The results are consistent across different considered normalization methods (Supplementary Figs S17–S20, Supplementary Table S7). Moreover, the performance of <monospace>waddR</monospace> variant B meaningfully increases with the number of replicates. This is to be expected, as the powers of the involved testing procedures, in particular the Wilcoxon rank sum test, rise with increasing number of replicates (Supplementary Figs S21–S24, Supplementary Table S8). Along with the benefit of drastically reduced computation times, <monospace>waddR</monospace> variant B furthermore outperforms or is competitive to the <monospace>scDD</monospace> and <monospace>SigEMD</monospace> reference approaches, which are not explicitly designed to handle replicates, with respect to all the evaluation criteria mentioned before (Supplementary Figs S25–S29, Supplementary Table S9).</p>
    </sec>
    <sec>
      <title>3.4 Case study: detecting DDs between tissue-resident and blood NK cells</title>
      <sec>
        <label>3.4.1</label>
        <title>Details of the case study</title>
        <p>In order to test <monospace>waddR</monospace> variant B in a real-data case study, we apply it to a subset of the scRNA-seq dataset in <xref rid="btab226-B30" ref-type="bibr">Vento-Tormo <italic toggle="yes">et al.</italic> (2018)</xref> for first-trimester placentas with matched maternal blood and decidual cells. Specifically, we consider the subset of those cells that have been classified as natural killer (NK) cells in <xref rid="btab226-B30" ref-type="bibr">Vento-Tormo <italic toggle="yes">et al.</italic> (2018)</xref>, and we use the 10× Genomics sequencing platform-based scRNA-seq data of four replicates for which both measurements in decidua and blood are available. The comparison we look at is NK cells in decidua (condition <italic toggle="yes">A</italic>) versus NK cells in blood (condition <italic toggle="yes">B</italic>). After normalizing and filtering out those genes that show zero expression in all cells across both conditions and across all replicates, this dataset comprises log-normalized expression distributions for 21138 genes (<xref rid="btab226-T3" ref-type="table">Table 3</xref>).</p>
        <table-wrap position="float" id="btab226-T3">
          <label>Table 3.</label>
          <caption>
            <p>Setting of the real-data case study</p>
          </caption>
          <table frame="hsides" rules="groups">
            <colgroup span="1">
              <col valign="top" align="left" span="1"/>
              <col valign="top" align="center" span="1"/>
              <col valign="top" align="center" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <th rowspan="1" colspan="1"/>
                <th rowspan="1" colspan="1">Decidua</th>
                <th rowspan="1" colspan="1">Blood</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td rowspan="1" colspan="1">Donor F19</td>
                <td rowspan="1" colspan="1">3249 NK cells</td>
                <td rowspan="1" colspan="1">569 NK cells</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">Donor F20</td>
                <td rowspan="1" colspan="1">282 NK cells</td>
                <td rowspan="1" colspan="1">107 NK cells</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">Donor F25</td>
                <td rowspan="1" colspan="1">2245 NK cells</td>
                <td rowspan="1" colspan="1">360 NK cells</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">Donor F27</td>
                <td rowspan="1" colspan="1">4016 NK cells</td>
                <td rowspan="1" colspan="1">325 NK cells</td>
              </tr>
            </tbody>
          </table>
        </table-wrap>
        <p>Our goal is to compare the analysis results from <monospace>waddR</monospace> to those obtained when applying the <monospace>edgeR</monospace> approach (<xref rid="btab226-B25" ref-type="bibr">Robinson <italic toggle="yes">et al.</italic>, 2010</xref>), which originally has been designed for differential expression analysis for bulk RNA-seq measurements. To mimic bulk values from the single-cell dataset in <xref rid="btab226-B30" ref-type="bibr">Vento-Tormo <italic toggle="yes">et al.</italic> (2018)</xref>, we compute for each gene and for each replicate separately the sum of the expression values (counts) over all respective cells and take this as a bulk input for <monospace>edgeR</monospace>. As we want to compare a bulk to a single-cell approach here, no filtering with respect to genes or cells is done here, since otherwise the mimicked bulk counts for <monospace>edgeR</monospace> could be distorted.</p>
        <p>For the bulk <monospace>edgeR</monospace> method, we use the default normalization and the quasi-likelihood F test to check for differential expression as provided by the package, while explicitly accounting for the paired setting encountered.</p>
        <p>For the single-cell-based analysis, the <monospace>Seurat</monospace> package (<xref rid="btab226-B5" ref-type="bibr">Butler <italic toggle="yes">et al.</italic>, 2018</xref>) is used for normalizing the data, using the default settings of log-normalization with scale factor 10<sup>4</sup>. Then, the <monospace>waddR</monospace> approach for multiple replicates (variant B) is applied to this pre-processed data. Our procedure gives three different <italic toggle="yes">P</italic>-values: a <italic toggle="yes">P</italic>-value <inline-formula id="IE42"><mml:math id="IM42" display="inline" overflow="scroll"><mml:mrow><mml:mi>P</mml:mi><mml:mo>.</mml:mo><mml:mi>zero</mml:mi></mml:mrow></mml:math></inline-formula> referring to differences in proportions of zero expression (DPZ), a <italic toggle="yes">P</italic>-value <inline-formula id="IE43"><mml:math id="IM43" display="inline" overflow="scroll"><mml:mrow><mml:mi>P</mml:mi><mml:mo>.</mml:mo><mml:mi>nonzero</mml:mi></mml:mrow></mml:math></inline-formula> referring to difference in non-zero expression (non-zero DD) and a combined <italic toggle="yes">P</italic>-value <inline-formula id="IE44"><mml:math id="IM44" display="inline" overflow="scroll"><mml:mrow><mml:mi>P</mml:mi><mml:mo>.</mml:mo><mml:mi>comb</mml:mi></mml:mrow></mml:math></inline-formula> of overall DD. These <italic toggle="yes">P</italic>-values are then adjusted for multiple testing using the method of <xref rid="btab226-B3" ref-type="bibr">Benjamini and Hochberg (1995)</xref>, yielding <inline-formula id="IE45"><mml:math id="IM45" display="inline" overflow="scroll"><mml:mrow><mml:mi>P</mml:mi><mml:mo>.</mml:mo><mml:mtext>adj</mml:mtext><mml:mo>.</mml:mo><mml:mtext>zero</mml:mtext><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mi>P</mml:mi><mml:mo>.</mml:mo><mml:mtext>adj</mml:mtext><mml:mo>.</mml:mo><mml:mtext>nonzero</mml:mtext></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE46"><mml:math id="IM46" display="inline" overflow="scroll"><mml:mrow><mml:mi>P</mml:mi><mml:mo>.</mml:mo><mml:mtext>adj</mml:mtext><mml:mo>.</mml:mo><mml:mtext>comb</mml:mtext></mml:mrow></mml:math></inline-formula>, respectively. In contrast, the bulk <monospace>edgeR</monospace> method offers a single adjusted <italic toggle="yes">P</italic>-value <inline-formula id="IE47"><mml:math id="IM47" display="inline" overflow="scroll"><mml:mrow><mml:mi>P</mml:mi><mml:mo>.</mml:mo><mml:mi>adj</mml:mi></mml:mrow></mml:math></inline-formula> as an overall result for differential expression.</p>
      </sec>
      <sec>
        <label>3.4.2</label>
        <title>Genes detected by both methods</title>
        <p>Overall, <monospace>edgeR</monospace> detected 3987 differentially expressed genes [Benjamini-Hochberg (BH) adjusted <italic toggle="yes">P</italic>-value <inline-formula id="IE48"><mml:math id="IM48" display="inline" overflow="scroll"><mml:mrow><mml:mo>≤</mml:mo><mml:mn>0.05</mml:mn></mml:mrow></mml:math></inline-formula>], 99% of which were also detected by <monospace>waddR</monospace> (BH adjusted combined <italic toggle="yes">P</italic>-value <inline-formula id="IE49"><mml:math id="IM49" display="inline" overflow="scroll"><mml:mrow><mml:mo>≤</mml:mo><mml:mn>0.05</mml:mn></mml:mrow></mml:math></inline-formula>; <xref rid="btab226-F3" ref-type="fig">Fig. 3A</xref>). Of the genes detected by both tools, 99% showed a significant difference in proportion of zeros (DPZ), while 19% showed a difference in the non-zero part. For such genes, that would otherwise be discovered using conventional tools, new insights can be gained by the decomposition into location, size and shape. For instance, the activation marker CD69 has been previously proposed to be an over-expressed marker of tissue-resident NK cells when compared to conventional, peripheral blood NK cells (<xref rid="btab226-B11" ref-type="bibr">Jabrane-Ferrat, 2019</xref>). The decomposition of the distribution of CD69 indicates that the Wasserstein distance is mostly explained by size (51%), followed by location (40%, <xref rid="btab226-F3" ref-type="fig">Fig. 3B</xref>), suggesting that rather than a difference in expression, decidual NK cells are more variable with regard to CD69 expression (<xref rid="btab226-F3" ref-type="fig">Fig. 3B</xref>). Indeed, when subsetting the decidual NK cells by the 3 sub-populations of dNK cells newly identified by <xref rid="btab226-B30" ref-type="bibr">Vento-Tormo <italic toggle="yes">et al.</italic> (2018)</xref>, it becomes apparent that the expression of two sub-populations of decidual NK cells (dNK1 and dNK2) is similar to the expression of blood NK cells and that the increase in variance comes from a change in mean in the third population only (dNK3, <xref rid="btab226-F3" ref-type="fig">Fig. 3C</xref>).</p>
        <fig position="float" id="btab226-F3">
          <label>Fig. 3.</label>
          <caption>
            <p>(<bold>A</bold>) Venn diagram of the number of genes detected as DD by waddR (BH-adjusted combined <italic toggle="yes">P</italic>-value <inline-formula id="IE50"><mml:math id="IM50" display="inline" overflow="scroll"><mml:mrow><mml:mo>≤</mml:mo><mml:mn>0.05</mml:mn></mml:mrow></mml:math></inline-formula>) and by <monospace>edgeR</monospace> (BH-adjusted <italic toggle="yes">P</italic>-value <inline-formula id="IE51"><mml:math id="IM51" display="inline" overflow="scroll"><mml:mrow><mml:mo>≤</mml:mo><mml:mn>0.05</mml:mn></mml:mrow></mml:math></inline-formula>). (<bold>B</bold>) Expression of CD69 over the NK cells of four donors. Red: NK cells isolated from peripheral blood. Blue: NK cells isolated from the decidua. For purely illustrative purposes, we fit a density to the samples. However, note that the density itself is not used for the actual testing procedures, nor for the calculation of the decomposition. (<bold>C</bold>) Distribution of expression across the cells from all donors, coloured by the newly identified NK subsets from <xref rid="btab226-B30" ref-type="bibr">Vento-Tormo <italic toggle="yes">et al.</italic> (2018)</xref>. (<bold>D</bold>) Venn diagram of the number of genes detected as DD by <monospace>waddR</monospace>. (E) Histograms of expression of KIR receptors KIR3DL1 and KIR3DL2 for each of the four donors</p>
          </caption>
          <graphic xlink:href="btab226f3" position="float"/>
        </fig>
      </sec>
      <sec>
        <label>3.4.3</label>
        <title>Genes detected only by <monospace>waddR</monospace></title>
        <p>Compared to <monospace>edgeR</monospace>, <monospace>waddR</monospace> identified an additional 5233 differential genes, 63% of which showed a significant DPZ, while 30% showed a difference in the non-zero part (<xref rid="btab226-F3" ref-type="fig">Fig. 3D</xref>). Among those genes uniquely identified by <monospace>waddR</monospace>, there is an enrichment of genes known to be differentially expressed between peripheral-blood NK cells and decidua resident NK cells, including KIR3DL1, KIR3DL2 and CD53. Interestingly, while both KIRs are expected to have higher expression in decidual NK cells compared to blood (<xref rid="btab226-B14" ref-type="bibr">Koopman <italic toggle="yes">et al.</italic>, 2003</xref>), we observe the opposite: when KIRs are expressed in blood NK cells they are expressed at a higher level than in decidua NK cells (<xref rid="btab226-F3" ref-type="fig">Fig. 3E</xref>). The discrepancy between these results can be explained by the observation that proportionally fewer blood cells express KIRs compared to the decidual cells (5% average difference in proportion of zeros), a distinction that is beyond the reach of bulk expression assays.</p>
      </sec>
    </sec>
  </sec>
  <sec>
    <title>4 Discussion</title>
    <p>ScRNA-seq expression distributions typically show multi-modality, an abundance of zeros and increased variability (<xref rid="btab226-B2" ref-type="bibr">Bacher and Kendziorski, 2016</xref>). The detection of differences in such potentially biologically meaningful patterns is beyond the scope of traditional differential expression testing approaches. Here, we present methods derived from multiple, disconnected literature results for the 2-Wasserstein distance and put them into a unifying and overarching context particularly useful for single-cell applications. Our method can be used in two fundamentally different ways, to test for differences between two (and only two) distributions, treating cells as replicate observations (variant A); or to test for DDs between two conditions with replicate observations (variant B). The latter is the more important level of replication as different samples will necessarily be generated if the experiment is to be replicated (<xref rid="btab226-B1" ref-type="bibr">Amezquita <italic toggle="yes">et al.</italic>, 2020</xref>). Differential expression analyses that treat cells as replicates fail to properly model sample-to-sample variability (<xref rid="btab226-B17" ref-type="bibr">Lun and Marioni, 2017</xref>). Our method provides a framework for DD testing that can handle both variants and offers substantial speed improvements over alternative approaches for variant A testing, without compromising on detection performance.</p>
    <p>In addition to applications in scRNA-seq data, the <monospace>waddR</monospace> framework is applicable to any other domain where two distributions are compared. For continuous data in particular, a newly derived asymptotic testing procedure allows for further speed improvements.</p>
    <p>Future extensions of the <monospace>waddR</monospace> methods should deal with multiple conditions and multivariate data. In particular, log-linear models may provide an alternative to the Cochran-Mantel-Haenszel test for variant B DPZ testing. Such a frame would allow for the inclusion of covariates, for example by including the cellular detection rate as covariate in order to correct for differences in total counts per cell.</p>
    <sec>
      <title>4.1 Usage notes for the <monospace>waddR</monospace> R package</title>
      <p>We implemented our method as a package for the statistical environment R and distribute it within the Bioconductor project. As input for scRNA-seq analysis, it expects a table of pre-filtered and normalised count data. As filtering and normalisation are important steps that can have a profound impact in a scRNA-seq workflow (<xref rid="btab226-B6" ref-type="bibr">Cole <italic toggle="yes">et al.</italic>, 2019</xref>), these should be tailored to the specific question of interest before applying <monospace>waddR</monospace>. <monospace>waddR</monospace> is applicable to data from any scRNA-seq platform (demonstrated here for 10× Genomics and Fluidigm C1 Smart-Seq2) normalised using most common methods, such as those implemented in the <monospace>Seurat</monospace> (<xref rid="btab226-B5" ref-type="bibr">Butler <italic toggle="yes">et al.</italic>, 2018</xref>) or <monospace>scran</monospace> (<xref rid="btab226-B18" ref-type="bibr">Lun <italic toggle="yes">et al.</italic>, 2016</xref>) packages. Normalisation approaches that change the shape of the gene distributions (such as quantile normalization) and gene-wise scaling or standardizing should be avoided when using <monospace>waddR</monospace>.</p>
    </sec>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="sup1" position="float" content-type="local-data">
      <label>btab226_Supplementary_Data</label>
      <media xlink:href="btab226_supplementary_data.zip">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack id="ack1">
    <title>Acknowledgements</title>
    <p>Lisa Amrhein, Simon Anders, William Astle, Ernest Turro, Birgit Debrabant, Bernd Fischer, Michael Fletcher, Elisa Kasbohm, Carine Legrand, Abdelrahman Mahmoud and Marc Schwering are thanked for helpful discussions and useful comments. Sarah Teichmann, Roser Vento-Tormo and Mirjana Efremova are thanked for facilitating the dataset in <xref rid="btab226-B30" ref-type="bibr">Vento-Tormo <italic toggle="yes">et al.</italic> (2018)</xref>. Moreover, the authors thank the editor and two anonymous reviewers for their constructive comments and suggestions.</p>
    <sec>
      <title>Funding</title>
      <p>This work was fully funded by project VH-NG-1010 of the Helmholtz Association (HGF).</p>
      <p><italic toggle="yes">Conflict of Interest</italic>: none declared.</p>
    </sec>
    <sec sec-type="data-availability">
      <title>Data availability</title>
      <p>The raw data underlying the case study are available in ArrayExpress with accession number E-MTAB-6701. The differential distribution output tables for edgeR and waddR are available at <ext-link xlink:href="https://dx.doi.org/10.5281/zenodo.4680865" ext-link-type="uri">https://dx.doi.org/10.5281/zenodo.4680865</ext-link>.</p>
    </sec>
  </ack>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="btab226-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Amezquita</surname><given-names>R.A.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2020</year>) <article-title>Orchestrating single-cell analysis with Bioconductor</article-title>. <source>Nat. Methods</source>, <volume>17</volume>, <fpage>137</fpage>–<lpage>145</lpage>.<pub-id pub-id-type="pmid">31792435</pub-id></mixed-citation>
    </ref>
    <ref id="btab226-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Bacher</surname><given-names>R.</given-names></string-name>, <string-name><surname>Kendziorski</surname><given-names>C.</given-names></string-name></person-group> (<year>2016</year>) <article-title>Design and computational analysis of single-cell RNA-sequencing experiments</article-title>. <source>Genome Biol</source>., <volume>17</volume>, <fpage>63</fpage>.<pub-id pub-id-type="pmid">27052890</pub-id></mixed-citation>
    </ref>
    <ref id="btab226-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Benjamini</surname><given-names>Y.</given-names></string-name>, <string-name><surname>Hochberg</surname><given-names>Y.</given-names></string-name></person-group> (<year>1995</year>) <article-title>Controlling the false discovery rate: a practical and powerful approach to multiple testing</article-title>. <source>J. R. Stat. Soc. Ser. B</source>, <volume>57</volume>, <fpage>289</fpage>–<lpage>300</lpage>.</mixed-citation>
    </ref>
    <ref id="btab226-B4">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Buizza</surname><given-names>R.</given-names></string-name></person-group> (<year>2018</year>) <part-title>Ensemble forecasting and the need for calibration</part-title>. In: <person-group person-group-type="editor"><string-name><surname>Vannitsem</surname><given-names>S.</given-names></string-name></person-group>  <etal>et al</etal> (eds.) <source>Statistical Postprocessing of Ensemble Forecasts</source>. <publisher-name>Elsevier</publisher-name>, <publisher-loc>Amsterdam</publisher-loc>.</mixed-citation>
    </ref>
    <ref id="btab226-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Butler</surname><given-names>A.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2018</year>) <article-title>Integrating single-cell transcriptomic data across different conditions, technologies, and species</article-title>. <source>Nat. Biotechnol</source>., <volume>36</volume>, <fpage>411</fpage>–<lpage>420</lpage>.<pub-id pub-id-type="pmid">29608179</pub-id></mixed-citation>
    </ref>
    <ref id="btab226-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Cole</surname><given-names>M.B.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2019</year>) <article-title>Performance assessment and selection of normalization procedures for single-cell RNA-seq</article-title>. <source>Cell Syst</source>., <volume>8</volume>, <fpage>315</fpage>–<lpage>328</lpage>.<pub-id pub-id-type="pmid">31022373</pub-id></mixed-citation>
    </ref>
    <ref id="btab226-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Dal Molin</surname><given-names>A.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2017</year>) <article-title>Single-cell RNA-sequencing: assessment of differential expression analysis methods</article-title>. <source>Front. Genet</source>., <volume>8</volume>, <fpage>62</fpage>.<pub-id pub-id-type="pmid">28588607</pub-id></mixed-citation>
    </ref>
    <ref id="btab226-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Finak</surname><given-names>G.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2015</year>) <article-title>MAST: a flexible statistical framework for assessing transcriptional changes and characterizing heterogeneity in single-cell RNA sequencing data</article-title>. <source>Genome Biol</source>., <volume>16</volume>, <fpage>278</fpage>.<pub-id pub-id-type="pmid">26653891</pub-id></mixed-citation>
    </ref>
    <ref id="btab226-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Irpino</surname><given-names>A.</given-names></string-name>, <string-name><surname>Verde</surname><given-names>R.</given-names></string-name></person-group> (<year>2015</year>) <article-title>Basic statistics for distributional symbolic variables: a new metric-based approach</article-title>. <source>Adv. Data Anal. Classif</source>., <volume>9</volume>, <fpage>143</fpage>–<lpage>175</lpage>.</mixed-citation>
    </ref>
    <ref id="btab226-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Jaakkola</surname><given-names>M.K.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2017</year>) <article-title>Comparison of methods to detect differentially expressed genes between single-cell populations</article-title>. <source>Brief. Bioinf</source>., <volume>18</volume>, <fpage>735</fpage>–<lpage>743</lpage>.</mixed-citation>
    </ref>
    <ref id="btab226-B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Jabrane-Ferrat</surname><given-names>N.</given-names></string-name></person-group> (<year>2019</year>) <article-title>Features of human decidual NK cells in healthy pregnancy and during viral infection</article-title>. <source>Front. Immunol</source>., <volume>10</volume>, <fpage>1397</fpage>.<pub-id pub-id-type="pmid">31379803</pub-id></mixed-citation>
    </ref>
    <ref id="btab226-B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Knijnenburg</surname><given-names>T.A.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2009</year>) <article-title>Fewer permutations, more accurate <italic toggle="yes">p</italic>-values</article-title>. <source>Bioinformatics</source>, <volume>25</volume>, <fpage>i161</fpage>–<lpage>i168</lpage>.<pub-id pub-id-type="pmid">19477983</pub-id></mixed-citation>
    </ref>
    <ref id="btab226-B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kolodziejczyk</surname><given-names>A.A.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2015</year>) <article-title>Single cell RNA-sequencing of pluripotent states unlocks modular transcriptional variation</article-title>. <source>Cell Stem Cell</source>, <volume>17</volume>, <fpage>471</fpage>–<lpage>485</lpage>.<pub-id pub-id-type="pmid">26431182</pub-id></mixed-citation>
    </ref>
    <ref id="btab226-B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Koopman</surname><given-names>L.A.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2003</year>) <article-title>Human decidual natural killer cells are a unique NK cell subset with immunomodulatory potential</article-title>. <source>J. Exp. Med</source>., <volume>198</volume>, <fpage>1201</fpage>–<lpage>1212</lpage>.<pub-id pub-id-type="pmid">14568979</pub-id></mixed-citation>
    </ref>
    <ref id="btab226-B15">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Korthauer</surname><given-names>K.D.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2016</year>) <article-title>A statistical approach for identifying differential distributions in single-cell RNA-seq experiments</article-title>. <source>Genome Biol</source>., <volume>17</volume>, <fpage>222</fpage>.<pub-id pub-id-type="pmid">27782827</pub-id></mixed-citation>
    </ref>
    <ref id="btab226-B16">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Love</surname><given-names>M.I.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2014</year>) <article-title>Moderated estimation of fold change and dispersion for RNA-seq data with <monospace>DESeq2</monospace></article-title>. <source>Genome Biol</source>., <volume>15</volume>, <fpage>550</fpage>.<pub-id pub-id-type="pmid">25516281</pub-id></mixed-citation>
    </ref>
    <ref id="btab226-B17">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lun</surname><given-names>A.T.L.</given-names></string-name>, <string-name><surname>Marioni</surname><given-names>J.C.</given-names></string-name></person-group> (<year>2017</year>) <article-title>Overcoming confounding plate effects in differential expression analyses of single-cell RNA-seq data</article-title>. <source>Biostatistics</source>, <volume>18</volume>, <fpage>451</fpage>–<lpage>464</lpage>.<pub-id pub-id-type="pmid">28334062</pub-id></mixed-citation>
    </ref>
    <ref id="btab226-B18">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lun</surname><given-names>A.T.L.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2016</year>) <article-title>Pooling across cells to normalize single-cell RNA sequencing data with many zero counts</article-title>. <source>Genome Biol</source>., <volume>17</volume>, <fpage>75</fpage>.<pub-id pub-id-type="pmid">27122128</pub-id></mixed-citation>
    </ref>
    <ref id="btab226-B19">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Marinov</surname><given-names>G.K.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2014</year>) <article-title>From single-cell to cell-pool transcriptomes: stochasticity in gene expression and RNA splicing</article-title>. <source>Genome Res</source>., <volume>24</volume>, <fpage>496</fpage>–<lpage>510</lpage>.<pub-id pub-id-type="pmid">24299736</pub-id></mixed-citation>
    </ref>
    <ref id="btab226-B20">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Martinez-Jimenez</surname><given-names>C.P.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2017</year>) <article-title>Aging increases cell-to-cell transcriptional variability upon immune stimulation</article-title>. <source>Science</source>, <volume>355</volume>, <fpage>1433</fpage>–<lpage>1436</lpage>.<pub-id pub-id-type="pmid">28360329</pub-id></mixed-citation>
    </ref>
    <ref id="btab226-B21">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Matsui</surname><given-names>Y.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2016</year>) <article-title>D<sup>3</sup>M: detection of differential distributions of methylation levels</article-title>. <source>Bioinformatics</source>, <volume>32</volume>, <fpage>2248</fpage>–<lpage>2255</lpage>.<pub-id pub-id-type="pmid">27153581</pub-id></mixed-citation>
    </ref>
    <ref id="btab226-B22">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Miao</surname><given-names>Z.</given-names></string-name>, <string-name><surname>Zhang</surname><given-names>X.</given-names></string-name></person-group> (<year>2016</year>) <article-title>Differential expression analyses for single-cell RNA-Seq: old questions on new data</article-title>. <source>Quant. Biol</source>., <volume>4</volume>, <fpage>243</fpage>–<lpage>260</lpage>.</mixed-citation>
    </ref>
    <ref id="btab226-B23">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Miao</surname><given-names>Z.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2018</year>) <article-title><monospace>DEsingle</monospace> for detecting three types of differential expression in single-cell RNA-seq data</article-title>. <source>Bioinformatics</source>, <volume>34</volume>, <fpage>3223</fpage>–<lpage>3224</lpage>.<pub-id pub-id-type="pmid">29688277</pub-id></mixed-citation>
    </ref>
    <ref id="btab226-B24">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Panaretos</surname><given-names>V.M.</given-names></string-name>, <string-name><surname>Zemel</surname><given-names>Y.</given-names></string-name></person-group> (<year>2019</year>) <article-title>Statistical aspects of Wasserstein distances</article-title>. <source>Annu. Rev. Stat. Appl</source>., <volume>6</volume>, <fpage>405</fpage>–<lpage>431</lpage>.</mixed-citation>
    </ref>
    <ref id="btab226-B25">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Robinson</surname><given-names>M.D.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2010</year>) <article-title><monospace>edgeR</monospace>: a Bioconductor package for differential expression analysis of digital gene expression data</article-title>. <source>Bioinformatics</source>, <volume>26</volume>, <fpage>139</fpage>–<lpage>140</lpage>.<pub-id pub-id-type="pmid">19910308</pub-id></mixed-citation>
    </ref>
    <ref id="btab226-B26">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Rüschendorf</surname><given-names>L.</given-names></string-name></person-group> (<year>2001</year>) <part-title>Wasserstein metric</part-title>. In: <person-group person-group-type="editor"><string-name><surname>Hazewinkel</surname><given-names>M.</given-names></string-name></person-group> (ed.) <source>Encyclopaedia of Mathematics</source>. <publisher-name>Springer</publisher-name>, <publisher-loc>New York</publisher-loc>.</mixed-citation>
    </ref>
    <ref id="btab226-B27">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Soneson</surname><given-names>C.</given-names></string-name>, <string-name><surname>Robinson</surname><given-names>M.D.</given-names></string-name></person-group> (<year>2018</year>) <article-title>Bias, robustness and scalability in single-cell differential expression analysis</article-title>. <source>Nat. Methods</source>, <volume>15</volume>, <fpage>255</fpage>–<lpage>261</lpage>.<pub-id pub-id-type="pmid">29481549</pub-id></mixed-citation>
    </ref>
    <ref id="btab226-B28">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Tung</surname><given-names>P.-Y.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2017</year>) <article-title>Batch effects and the effective design of single-cell gene expression studies</article-title>. <source>Sci. Rep</source>., <volume>7</volume>, <fpage>39921</fpage>.<pub-id pub-id-type="pmid">28045081</pub-id></mixed-citation>
    </ref>
    <ref id="btab226-B29">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Vallejos</surname><given-names>C.A.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2016</year>) <article-title>Beyond comparisons of means: understanding changes in gene expression at the single-cell level</article-title>. <source>Genome Biol</source>., <volume>17</volume>, <fpage>70</fpage>.<pub-id pub-id-type="pmid">27083558</pub-id></mixed-citation>
    </ref>
    <ref id="btab226-B30">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Vento-Tormo</surname><given-names>R.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2018</year>) <article-title>Reconstructing the human first trimester fetal-maternal interface using single cell transcriptomics</article-title>. <source>Nature</source>, <volume>563</volume>, <fpage>347</fpage>–<lpage>353</lpage>.<pub-id pub-id-type="pmid">30429548</pub-id></mixed-citation>
    </ref>
    <ref id="btab226-B31">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wang</surname><given-names>T.</given-names></string-name>, <string-name><surname>Nabavi</surname><given-names>S.</given-names></string-name></person-group> (<year>2018</year>) <article-title><monospace>SigEMD</monospace>: a powerful method for differential gene expression analysis in single-cell RNA sequencing data</article-title>. <source>Methods</source>, <volume>145</volume>, <fpage>25</fpage>–<lpage>32</lpage>.<pub-id pub-id-type="pmid">29702224</pub-id></mixed-citation>
    </ref>
    <ref id="btab226-B32">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wang</surname><given-names>T.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2019</year>) <article-title>Comparative analysis of differential gene expression analysis tools for single-cell RNA sequencing data</article-title>. <source>BMC Bioinformatics</source>, <volume>20</volume>, <fpage>40</fpage>.<pub-id pub-id-type="pmid">30658573</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
