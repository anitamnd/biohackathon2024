<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1 20151215//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.1?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">5870546</article-id>
    <article-id pub-id-type="pmid">28334349</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btx099</article-id>
    <article-id pub-id-type="publisher-id">btx099</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Applications Notes</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Data and Text Mining</subject>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>DeepBlueR: large-scale epigenomic analysis in R</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Albrecht</surname>
          <given-names>Felipe</given-names>
        </name>
        <xref ref-type="aff" rid="btx099-aff1">1</xref>
        <xref ref-type="aff" rid="btx099-aff2">2</xref>
        <xref ref-type="corresp" rid="btx099-cor1"/>
        <!--<email>felipe.albrecht@mpi-inf.mpg.de</email>-->
        <xref ref-type="author-notes" rid="btx099-FM2"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>List</surname>
          <given-names>Markus</given-names>
        </name>
        <xref ref-type="aff" rid="btx099-aff1">1</xref>
        <xref ref-type="corresp" rid="btx099-cor1"/>
        <!--<email>markus.list@mpi-inf.mpg.de</email>-->
        <xref ref-type="author-notes" rid="btx099-FM2"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Bock</surname>
          <given-names>Christoph</given-names>
        </name>
        <xref ref-type="aff" rid="btx099-aff1">1</xref>
        <xref ref-type="aff" rid="btx099-aff3">3</xref>
        <xref ref-type="aff" rid="btx099-aff4">4</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Lengauer</surname>
          <given-names>Thomas</given-names>
        </name>
        <xref ref-type="aff" rid="btx099-aff1">1</xref>
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Wren</surname>
          <given-names>Jonathan</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <aff id="btx099-aff1"><label>1</label>Max Planck Institute for Informatics, Saarland Informatics Campus, Saarbrücken, Germany</aff>
    <aff id="btx099-aff2"><label>2</label>Graduate School of Computer Science, Saarland Informatics Campus, Saarbrücken, Germany</aff>
    <aff id="btx099-aff3"><label>3</label>CeMM Research Center for Molecular Medicine of the Austrian Academy of Sciences, Medical University of Vienna, Vienna, Austria</aff>
    <aff id="btx099-aff4"><label>4</label>Department of Laboratory Medicine, Medical University of Vienna, Vienna, Austria</aff>
    <author-notes>
      <corresp id="btx099-cor1">To whom correspondence should be addressed. Email: <email>felipe.albrecht@mpi-inf.mpg.de</email> or <email>markus.list@mpi-inf.mpg.de</email></corresp>
      <fn id="btx099-FM2">
        <p>The authors wish it to be known that, in their opinion, the first two authors should be regarded as Joint First Authors.</p>
      </fn>
    </author-notes>
    <pub-date pub-type="ppub">
      <day>01</day>
      <month>7</month>
      <year>2017</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2017-02-22">
      <day>22</day>
      <month>2</month>
      <year>2017</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>22</day>
      <month>2</month>
      <year>2017</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the <pub-date pub-type="epub"/>. -->
    <volume>33</volume>
    <issue>13</issue>
    <fpage>2063</fpage>
    <lpage>2064</lpage>
    <history>
      <date date-type="received">
        <day>17</day>
        <month>11</month>
        <year>2016</year>
      </date>
      <date date-type="rev-recd">
        <day>13</day>
        <month>1</month>
        <year>2017</year>
      </date>
      <date date-type="accepted">
        <day>21</day>
        <month>2</month>
        <year>2017</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author 2017. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2017</copyright-year>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/" license-type="cc-by">
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btx099.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="SA1">
        <title>Motivation</title>
        <p>While large amounts of epigenomic data are publicly available, their retrieval in a form suitable for downstream analysis is a bottleneck in current research. The DeepBlue Epigenomic Data Server provides a powerful interface and API for filtering, transforming, aggregating and downloading data from several epigenomic consortia.</p>
      </sec>
      <sec id="SA2">
        <title>Results</title>
        <p>To make public epigenomic data conveniently available for analysis in R, we developed an R/Bioconductor package that connects to the DeepBlue Epigenomic Data Server, enabling users to quickly gather and transform epigenomic data from selected experiments for analysis in the Bioconductor ecosystem.</p>
      </sec>
      <sec id="SA3">
        <title>Availability and Implementation</title>
        <p><ext-link ext-link-type="uri" xlink:href="http://deepblue.mpi-inf.mpg.de/R">http://deepblue.mpi-inf.mpg.de/R</ext-link>.</p>
      </sec>
      <sec id="SA4">
        <title>Requirements</title>
        <p>R 3.3, Bioconductor 3.4.</p>
      </sec>
      <sec id="SA5">
        <title>Supplementary information</title>
        <p><xref ref-type="supplementary-material" rid="sup1">Supplementary data</xref> are available at <italic>Bioinformatics</italic> online. </p>
      </sec>
    </abstract>
    <counts>
      <page-count count="2"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>Epigenomic mapping consortia such as the BLUEPRINT Epigenome Project (<xref rid="btx099-B1" ref-type="bibr">Adams <italic>et al.</italic>, 2012</xref>), the German Epigenome Programme (DEEP) (<ext-link ext-link-type="uri" xlink:href="http://www.deutsches-epigenom-programm.de">http://www.deutsches-epigenom-programm.de</ext-link>), The Encyclopedia of DNA Elements (ENCODE) (<xref rid="btx099-B13" ref-type="bibr">The ENCODE Project Consortium, 2004</xref>) and the NIH Roadmap Epigenomics Mapping Consortium (ROADMAP) (<xref rid="btx099-B8" ref-type="bibr">Kundaje <italic>et al.</italic>, 2015</xref>) have made substantial progress in generating epigenomic data. These individual projects cooperate under the International Human Epigenome Consortium (IHEC) (<xref rid="btx099-B12" ref-type="bibr">Stunnenberg <italic>et al.</italic>, 2016</xref>) with the goal to define standards for data quality, metadata content and processing pipelines, as well as to make processed data available to the scientific community. For the latter, a number of data portals have been developed (<xref rid="btx099-B3" ref-type="bibr">Bujold <italic>et al.</italic>, 2016</xref>; <xref rid="btx099-B5" ref-type="bibr">Fernández <italic>et al.</italic>, 2016</xref>) through which relevant experimental data can be downloaded for local analyses. However, this approach has certain disadvantages. For instance, huge files that span the entire genome need to be downloaded even if only a small portion is needed, e.g. only promoter regions. Moreover, to answer a specific research question, it is usually necessary to transform, filter and aggregate data of various types across many experimental files. Complex operations on these data are not always feasible on a local computer due to resource limitations. To facilitate the analysis of public epigenomic datasets, we previously developed the DeepBlue epigenomic data server (<xref rid="btx099-B2" ref-type="bibr">Albrecht <italic>et al.</italic>, 2016</xref>), a platform that provides programmatic access to unaltered epigenomic data provided by the aforementioned consortia and to server-side data operations through a web service.</p>
    <p>R (<xref rid="btx099-B10" ref-type="bibr">R Core Team, 2016</xref>) and the Bioconductor ecosystem (<xref rid="btx099-B7" ref-type="bibr">Huber <italic>et al.</italic>, 2015</xref>) form one of the most popular environments for downstream analysis and visualization of genomic and epigenomic data. Access to epigenomic data from various sources is already possible through the AnnotationHub package (<ext-link ext-link-type="uri" xlink:href="http://bioconductor.org/packages/AnnotationHub/">http://bioconductor.org/packages/AnnotationHub/</ext-link>), for instance. However, a general solution for extracting only relevant subsets of information as it is possible with the DeepBlue server is currently missing. Here we present a R/Bioconductor package that provides user-friendly access to DeepBlue and streamlines the workflow from data retrieval to downstream analysis.</p>
  </sec>
  <sec>
    <title>2 Overview</title>
    <p>In DeepBlueR, various commands can be combined in custom workflows operating on epigenomic data on the DeepBlue server. A list of commands available DeepBlueR is provided in the <xref ref-type="supplementary-material" rid="sup1">Supplementary Information</xref>. DeepBlueR has been optimized for speed, which included modifications of the Bioconductor XML-RPC package, use of data compression and local caching of results. Upon import, all data is converted into suitable R data structures such as GenomicRanges (<xref rid="btx099-B9" ref-type="bibr">Lawrence <italic>et al.</italic>, 2013</xref>). In a typical workflow (<xref ref-type="fig" rid="btx099-F1">Fig. 1</xref>), a set of regions is selected from various files. The selected regions are subsequently filtered and finally summarized. Each data operation command returns a <italic>Query ID</italic> that can either serve as input for the following command or can be used to trigger the execution of the workflow. In the latter case, a <italic>Request ID</italic> is returned which allows for checking if a request is completed and for downloading the results. DeepBlue incorporates commonly used annotations such as GENCODE (<xref rid="btx099-B6" ref-type="bibr">Harrow <italic>et al.</italic>, 2012</xref>) or the ENSEMBL regulatory build (<xref rid="btx099-B14" ref-type="bibr">Zerbino <italic>et al.</italic>, 2015</xref>) to simplify the selection of regions of interest.</p>
    <fig id="btx099-F1" orientation="portrait" position="float">
      <label>Fig. 1.</label>
      <caption>
        <p>DeepBlueR facilitates combining data operations into a data processing workflow. For each command, a query ID is returned and the final data is accessible through the request ID</p>
      </caption>
      <graphic xlink:href="btx099f1"/>
    </fig>
  </sec>
  <sec>
    <title>3 Conclusion</title>
    <p>Public data portals enable researchers to access to terabytes of epigenomic data. This creates a strong demand for data analysis in statistical environments such as R, which is not effective on local computers due to the volume of the data. Here we present a Bioconductor package that enables R users to tap directly into the DeepBlue epigenomic data server to operate on large epigenomic datasets. Results are conveniently transformed to R data structures that can be directly used with R/Bioconductor packages for visualization or analysis. Usage examples and documentation can be found in the <xref ref-type="supplementary-material" rid="sup1">Supplementary Information</xref>, including an example of a genome-wide cluster analysis of DNA methylation across 212 samples from the BLUEPRINT consortium. For the future, we intend to add new functionality as the DeepBlue API evolves. Moreover, we aim at providing better integration with R packages such as TCGAbiolinks (<xref rid="btx099-B4" ref-type="bibr">Colaprico <italic>et al.</italic>, 2015</xref>) or LOLA (<xref rid="btx099-B11" ref-type="bibr">Sheffield and Bock, 2016</xref>).</p>
  </sec>
  <sec>
    <title>Funding</title>
    <p>This work has been supported by the German Federal Ministry of Education and Research grant no. 01KU1216A (DEEP project) and has been performed in the context of EU FP7 grant no. HEALTH-F5-2011-282510 (BLUEPRINT project).</p>
    <p><italic>Conflict of Interest</italic>: none declared.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material content-type="local-data" id="sup1">
      <label>Supplementary Data</label>
      <media xlink:href="btx099_supp.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ref-list>
    <title>References</title>
    <ref id="btx099-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Adams</surname><given-names>D.</given-names></name></person-group><etal>et al</etal> (<year>2012</year>) 
<article-title>BLUEPRINT to decode the epigenetic signature written in blood</article-title>. <source>Nat. Biotechnol</source>., <volume>30</volume>, <fpage>224</fpage>–<lpage>226</lpage>.<pub-id pub-id-type="pmid">22398613</pub-id></mixed-citation>
    </ref>
    <ref id="btx099-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Albrecht</surname><given-names>F.</given-names></name></person-group><etal>et al</etal> (<year>2016</year>) 
<article-title>DeepBlue epigenomic data server: programmatic data retrieval and analysis of epigenome region sets</article-title>. <source>Nucleic Acids Res</source>., (i), gkw211.</mixed-citation>
    </ref>
    <ref id="btx099-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Bujold</surname><given-names>D.</given-names></name></person-group><etal>et al</etal> (<year>2016</year>) 
<article-title>The international human epigenome consortium data portal</article-title>. <source>Cell Syst</source>., <volume>3</volume>, <fpage>496</fpage>–<lpage>499</lpage>.<pub-id pub-id-type="pmid">27863956</pub-id></mixed-citation>
    </ref>
    <ref id="btx099-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Colaprico</surname><given-names>A.</given-names></name></person-group><etal>et al</etal> (<year>2015</year>) 
<article-title>Tcgabiolinks: an r/bioconductor package for integrative analysis of TCGA data</article-title>. <source>Nucleic Acids Res</source>., <fpage>gkv1507.</fpage></mixed-citation>
    </ref>
    <ref id="btx099-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Fernández</surname><given-names>J.M.</given-names></name></person-group><etal>et al</etal> (<year>2016</year>) 
<article-title>The blueprint data analysis portal</article-title>. <source>Cell Syst</source>., <volume>3</volume>, <fpage>491</fpage>–<lpage>495</lpage>.<pub-id pub-id-type="pmid">27863955</pub-id></mixed-citation>
    </ref>
    <ref id="btx099-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Harrow</surname><given-names>J.</given-names></name></person-group><etal>et al</etal> (<year>2012</year>) 
<article-title>Gencode: the reference human genome annotation for the encode project</article-title>. <source>Genome Res</source>., <volume>22</volume>, <fpage>1760</fpage>–<lpage>1774</lpage>.<pub-id pub-id-type="pmid">22955987</pub-id></mixed-citation>
    </ref>
    <ref id="btx099-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Huber</surname><given-names>W.</given-names></name></person-group><etal>et al</etal> (<year>2015</year>) 
<article-title>Orchestrating high-throughput genomic analysis with bioconductor</article-title>. <source>Nat. Methods</source>, <volume>12</volume>, <fpage>115</fpage>–<lpage>121</lpage>.<pub-id pub-id-type="pmid">25633503</pub-id></mixed-citation>
    </ref>
    <ref id="btx099-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Kundaje</surname><given-names>A.</given-names></name></person-group><etal>et al</etal> (<year>2015</year>) 
<article-title>Integrative analysis of 111 reference human epigenomes</article-title>. <source>Nature</source>, <volume>518</volume>, <fpage>317</fpage>–<lpage>330</lpage>.<pub-id pub-id-type="pmid">25693563</pub-id></mixed-citation>
    </ref>
    <ref id="btx099-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Lawrence</surname><given-names>M.</given-names></name></person-group><etal>et al</etal> (<year>2013</year>) 
<article-title>Software for computing and annotating genomic ranges</article-title>. <source>PLoS Comput. Biol</source>., <volume>9</volume>, <fpage>e1003118</fpage>.<pub-id pub-id-type="pmid">23950696</pub-id></mixed-citation>
    </ref>
    <ref id="btx099-B10">
      <mixed-citation publication-type="book"><collab>R Core Team</collab>. (<year>2016</year>) <source>R: A Language and Environment for Statistical Computing</source>. 
<publisher-name>R Foundation for Statistical Computing</publisher-name>, 
<publisher-loc>Vienna, Austria</publisher-loc>.</mixed-citation>
    </ref>
    <ref id="btx099-B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Sheffield</surname><given-names>N.C.</given-names></name>, <name name-style="western"><surname>Bock</surname><given-names>C.</given-names></name></person-group> (<year>2016</year>) 
<article-title>Lola: enrichment analysis for genomic region sets and regulatory elements in r and bioconductor</article-title>. <source>Bioinformatics</source>, <volume>32</volume>, <fpage>587</fpage>–<lpage>589</lpage>.<pub-id pub-id-type="pmid">26508757</pub-id></mixed-citation>
    </ref>
    <ref id="btx099-B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Stunnenberg</surname><given-names>H.G.</given-names></name></person-group><etal>et al</etal> (<year>2016</year>) 
<article-title>The international human epigenome consortium: a blueprint for scientific collaboration and discovery</article-title>. <source>Cell</source>, <volume>167</volume>, <fpage>1145</fpage>–<lpage>1149</lpage>.<pub-id pub-id-type="pmid">27863232</pub-id></mixed-citation>
    </ref>
    <ref id="btx099-B13">
      <mixed-citation publication-type="journal"><collab>The ENCODE Project Consortium</collab>. (<year>2004</year>) 
<article-title>The ENCODE (ENCyclopedia Of DNA Elements) Project</article-title>. <source>Science</source>, <volume>306</volume>, <fpage>636</fpage>–<lpage>640</lpage>.<pub-id pub-id-type="pmid">15499007</pub-id></mixed-citation>
    </ref>
    <ref id="btx099-B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Zerbino</surname><given-names>D.R.</given-names></name></person-group><etal>et al</etal> (<year>2015</year>) 
<article-title>The ensembl regulatory build</article-title>. <source>Genome Biol</source>., <volume>16</volume>, <fpage>1.</fpage><pub-id pub-id-type="pmid">25583448</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
