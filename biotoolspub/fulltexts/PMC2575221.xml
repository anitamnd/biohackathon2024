<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-title>BMC Bioinformatics</journal-title>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">2575221</article-id>
    <article-id pub-id-type="publisher-id">1471-2105-9-431</article-id>
    <article-id pub-id-type="pmid">18851737</article-id>
    <article-id pub-id-type="doi">10.1186/1471-2105-9-431</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Methodology Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Probabilistic base calling of Solexa sequencing data</article-title>
    </title-group>
    <contrib-group>
      <contrib id="A1" contrib-type="author">
        <name>
          <surname>Rougemont</surname>
          <given-names>Jacques</given-names>
        </name>
        <xref ref-type="aff" rid="I1">1</xref>
        <xref ref-type="aff" rid="I3">3</xref>
        <email>jacques.rougemont@epfl.ch</email>
      </contrib>
      <contrib id="A2" contrib-type="author">
        <name>
          <surname>Amzallag</surname>
          <given-names>Arnaud</given-names>
        </name>
        <xref ref-type="aff" rid="I1">1</xref>
        <xref ref-type="aff" rid="I3">3</xref>
        <email>arnaud.amzallag@epfl.ch</email>
      </contrib>
      <contrib id="A3" contrib-type="author">
        <name>
          <surname>Iseli</surname>
          <given-names>Christian</given-names>
        </name>
        <xref ref-type="aff" rid="I2">2</xref>
        <xref ref-type="aff" rid="I3">3</xref>
        <email>christian.iseli@licr.org</email>
      </contrib>
      <contrib id="A4" contrib-type="author">
        <name>
          <surname>Farinelli</surname>
          <given-names>Laurent</given-names>
        </name>
        <xref ref-type="aff" rid="I5">5</xref>
        <email>laurent.farinelli@fasteris.com</email>
      </contrib>
      <contrib id="A5" contrib-type="author">
        <name>
          <surname>Xenarios</surname>
          <given-names>Ioannis</given-names>
        </name>
        <xref ref-type="aff" rid="I3">3</xref>
        <xref ref-type="aff" rid="I4">4</xref>
        <email>ioannis.xenarios@isb-sib.ch</email>
      </contrib>
      <contrib id="A6" corresp="yes" contrib-type="author">
        <name>
          <surname>Naef</surname>
          <given-names>Felix</given-names>
        </name>
        <xref ref-type="aff" rid="I1">1</xref>
        <xref ref-type="aff" rid="I3">3</xref>
        <email>felix.naef@epfl.ch</email>
      </contrib>
    </contrib-group>
    <aff id="I1"><label>1</label>School of Life Sciences, Ecole Polytechnique Fédérale de Lausanne (EPFL), 1015 Lausanne, Switzerland</aff>
    <aff id="I2"><label>2</label>Ludwig Institute for Cancer Research (LICR), Bâtiment Génopode, Université de Lausanne, 1015 Lausanne, Switzerland</aff>
    <aff id="I3"><label>3</label>Swiss Institute of Bioinformatics (SIB), Bâtiment Génopode, Université de Lausanne, 1015 Lausanne, Switzerland</aff>
    <aff id="I4"><label>4</label>Vital-IT, Bâtiment Génopode, Université de Lausanne, 1015 Lausanne, Switzerland</aff>
    <aff id="I5"><label>5</label>Fasteris SA, P.O. box 28, 1228 Plan-les-Ouates, Switzerland</aff>
    <pub-date pub-type="collection">
      <year>2008</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>13</day>
      <month>10</month>
      <year>2008</year>
    </pub-date>
    <volume>9</volume>
    <fpage>431</fpage>
    <lpage>431</lpage>
    <ext-link ext-link-type="uri" xlink:href="http://www.biomedcentral.com/1471-2105/9/431"/>
    <history>
      <date date-type="received">
        <day>4</day>
        <month>6</month>
        <year>2008</year>
      </date>
      <date date-type="accepted">
        <day>13</day>
        <month>10</month>
        <year>2008</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>Copyright © 2008 Rougemont et al; licensee BioMed Central Ltd.</copyright-statement>
      <copyright-year>2008</copyright-year>
      <copyright-holder>Rougemont et al; licensee BioMed Central Ltd.</copyright-holder>
      <license license-type="open-access" xlink:href="http://creativecommons.org/licenses/by/2.0">
        <p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/2.0"/>), which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly cited.</p>
        <!--<rdf xmlns="http://web.resource.org/cc/" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:dc="http://purl.org/dc/elements/1.1" xmlns:dcterms="http://purl.org/dc/terms"><Work xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:dcterms="http://purl.org/dc/terms/" rdf:about=""><license rdf:resource="http://creativecommons.org/licenses/by/2.0"/><dc:type rdf:resource="http://purl.org/dc/dcmitype/Text"/><dc:author>
               Rougemont
               Jacques
               
               
               jacques.rougemont@epfl.ch
            </dc:author><dc:title>
            Probabilistic base calling of Solexa sequencing data
         </dc:title><dc:date>2008</dc:date><dcterms:bibliographicCitation>BMC Bioinformatics 9(1): 431-. (2008)</dcterms:bibliographicCitation><dc:identifier type="sici">1471-2105(2008)9:1&#x0003c;431&#x0003e;</dc:identifier><dcterms:isPartOf>urn:ISSN:1471-2105</dcterms:isPartOf><License rdf:about="http://creativecommons.org/licenses/by/2.0"><permits rdf:resource="http://web.resource.org/cc/Reproduction" xmlns=""/><permits rdf:resource="http://web.resource.org/cc/Distribution" xmlns=""/><requires rdf:resource="http://web.resource.org/cc/Notice" xmlns=""/><requires rdf:resource="http://web.resource.org/cc/Attribution" xmlns=""/><permits rdf:resource="http://web.resource.org/cc/DerivativeWorks" xmlns=""/></License></Work></rdf>-->
      </license>
    </permissions>
    <abstract>
      <sec>
        <title>Background</title>
        <p>Solexa/Illumina short-read ultra-high throughput DNA sequencing technology produces millions of short tags (up to 36 bases) by parallel sequencing-by-synthesis of DNA colonies. The processing and statistical analysis of such high-throughput data poses new challenges; currently a fair proportion of the tags are routinely discarded due to an inability to match them to a reference sequence, thereby reducing the effective throughput of the technology.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p>We propose a novel base calling algorithm using model-based clustering and probability theory to identify ambiguous bases and code them with IUPAC symbols. We also select optimal sub-tags using a score based on information content to remove uncertain bases towards the ends of the reads.</p>
      </sec>
      <sec>
        <title>Conclusion</title>
        <p>We show that the method improves genome coverage and number of usable tags as compared with Solexa's data processing pipeline by an average of 15%. An R package is provided which allows fast and accurate base calling of Solexa's fluorescence intensity files and the production of informative diagnostic plots.</p>
      </sec>
    </abstract>
  </article-meta>
</front>
<body>
  <sec>
    <title>Background</title>
    <p>Ultra-high-throughput sequencing is having a growing impact on biological research by providing a fast and high resolution access to genome-scale information. The versatile technique can be used for unbiased genotyping [<xref ref-type="bibr" rid="B1">1</xref>-<xref ref-type="bibr" rid="B3">3</xref>], transcriptome analysis [<xref ref-type="bibr" rid="B4">4</xref>-<xref ref-type="bibr" rid="B6">6</xref>], protein-DNA interactions[<xref ref-type="bibr" rid="B7">7</xref>,<xref ref-type="bibr" rid="B8">8</xref>], <italic>de-novo </italic>sequencing[<xref ref-type="bibr" rid="B9">9</xref>,<xref ref-type="bibr" rid="B10">10</xref>]. While the sample processing is relatively streamlined, innovations in data management and information processing are necessary to exploit the full potential of the technology. A standard Solexa/Illumina Genome Analyzer "classic" run produces 700 Gb of image files and 200 Gb of processed data files over 3.5 days totaling nearly 400,000 image files and 20,000 processed files. The latest GAII upgrade further increases this volume of data, mostly by acquiring larger images (although only 100 tiles) and with the ability to perform paired-end sequencing (72 bases per colony). The computing infrastructure required for managing daily sequencing runs is extremely costly to set up and maintain. Developing new algorithms to extract more information from available images and reduce the number of sequencing runs per project will therefore prove extremely valuable. Finally, well-designed quality metrics and diagnostic tools will allow a rapid assessment of the quality of the sequencing runs and decide the applicable data retention policy.</p>
    <p>The Solexa/Illumina Genome Analyzer performs sequencing-by-synthesis of a random array of clonal DNA colonies attached to the surface of a flow cell. There are about 8 million such colonies on each of the 8 lanes of the cell. At each cycle of synthesis all four nucleotides, labelled with four different fluorescent dyes and blocked at the 3'-ends, are introduced in the flow cell. Up to 36 such cycles of synthesis are performed.</p>
    <p>The data acquisition on the Genome Analyzer "classic" proceeds as follows: each lane of the cell is divided into roughly 300 tiles that are individually photographed through four different filters. The image analysis software localizes each colony on each picture and quantifies the corresponding four fluorescence intensities. The output consists of one file per tile with one row per colony made of four coordinates and up to 144 real numbers for 36 intensity quadruples. The base calling starts downstream of this quantification and reconstructs the DNA sequence that likely generated each colony. The Solexa data analysis pipeline outputs two important files for each tile in each lane: a sequence file with the sequence determined from each intensity row and a fast-q file with a quality score for each base called. This fast-q score measures the most likely base intensity relative to the three other intensities on a logarithmic scale from -5 to 40 (it is asymptotically equal to a Phred score[<xref ref-type="bibr" rid="B11">11</xref>]). Here we propose an alternative probabilistic base calling method based on the fluorescence intensity quantifications that uses the extended IUPAC alphabet to code ambiguous bases. An information criterion is used to control the length of trustable reads. We show that this methodology increases the specific mapping of the tags onto reference genomes by about 15% (typically 10–25%) on raw sequences and an increase of up to 70% after quality filtering. The method is implemented in a freely distributed software called Rolexa.</p>
    <p>Similar approaches have recently been published. Closest to ours in their use of Gaussian mixtures is the method introduced by Cokus et al. in their analysis of Arabidopsis methylation patterns[<xref ref-type="bibr" rid="B12">12</xref>]. The Alta-Cyclic base caller [<xref ref-type="bibr" rid="B13">13</xref>] uses a support vector machine that needs to be trained on a known dataset. Our approach is computationally light and modular in that it offers a set of complementary functionalities that attempt to address the various biases observed in Solexa sequence [<xref ref-type="bibr" rid="B14">14</xref>-<xref ref-type="bibr" rid="B16">16</xref>] based on simple models of the biochemistry involved.</p>
  </sec>
  <sec>
    <title>Results</title>
    <sec>
      <title>Statistical properties of the fluorescent emissions</title>
      <p>Several sources of noise perturb the acquisition step: signal over noise ratio in the images depends on the position of the colony within the imaging field (boundary effect), colonies can be hard to segment on the pictures, fluorophore emission spectra partially overlap as emissions "leak" into adjacent channels. Moreover synthesis efficiency is limited and therefore, within each colony, some DNA strands incorporate a non-complementary base or are de-synchronized because they failed to incorporate a nucleotide at a previous step. Both effects lead to the emission of a different fluorophore than the majority of the colony. These effects are possibly dependent on the base composition of the sequence[<xref ref-type="bibr" rid="B17">17</xref>] and are obviously deteriorating with each additional chemistry cycle.</p>
      <p>We use the sequencing of the phiX174 (see Material and Methods) to analyze the signal in the four color channels as the sequencing progresses. We first observe that the distribution of intensities in the individual channels shows a good separation between background noise and signal, although the shape of the histograms strongly depends on the dye used (Fig. <xref ref-type="fig" rid="F1">1A</xref> and Additional file <xref ref-type="supplementary-material" rid="S1">1</xref>). For example, <italic>G </italic>has a tighter dynamical range than <italic>T </italic>and the range generally decreases with the cycle number. The largest range spans 4–5 logs. As the sequencing progresses, dynamic range decreases, signal over noise ratios worsen and the separation between background noise and signal becomes increasingly blurred (Additional file <xref ref-type="supplementary-material" rid="S1">1</xref>). Next, we observe that the <italic>A </italic>and <italic>C </italic>channels, as well as the <italic>T </italic>and <italic>G </italic>channels, are highly correlated (Fig. <xref ref-type="fig" rid="F1">1A</xref>).</p>
      <fig position="float" id="F1">
        <label>Figure 1</label>
        <caption>
          <p><bold>Signal and noise in fluorescence intensities</bold>. Representation of the first cycle of synthesis on five concatenated tiles of the phiX174 sequencing data. <bold>A</bold>. Projection of the intensity quadruples on the axes corresponding to the <italic>A </italic>and <italic>C </italic>channels and the <italic>G </italic>and <italic>T </italic>channels at cycles 1 an 15. The ellipses represent the Gaussian mixtures (centers and the line for one standard deviation are shown). <bold>B</bold>. Same data after de-correlation transformations (see Methods). Coloring reflects the mixture component with largest probability.</p>
        </caption>
        <graphic xlink:href="1471-2105-9-431-1"/>
      </fig>
    </sec>
    <sec>
      <title>Reducing positional bias, dephasing and cross-talk</title>
      <p>As observed above, there are three main sources of systematic bias at the level of intensity data. The first is the cross-talk between color channels: for example the <italic>A </italic>and <italic>C </italic>channels are not independent. Thus we transformed the raw intensities by a linear mapping to the basis with axes at angles <italic>ϕ </italic>and <italic>θ </italic>with respect to the original axes (cf. methods). We optimize the two angles so as to minimize the overall correlation between the transformed coordinates. We repeat this operation at each cycle of sequencing as well as with the other two, <italic>G </italic>and <italic>T </italic>channels (Fig. <xref ref-type="fig" rid="F1">1B</xref>).</p>
      <p>The second important bias is the colony dephasing: the amount of fluorescence emitted in a particular channel at cycle <italic>n </italic>depends on the number of corresponding bases present in the sequence at positions <italic>1</italic>, ..., <italic>n</italic>-<italic>1 </italic>because incorporation failures accumulated from previous cycles will be partly compensated at cycle <italic>n </italic>thereby increasing the signal in all channels. This cross-cycle dependence can be modelled by a binomial distribution with parameter <italic>q </italic>which is the probability of not elongating the complementary strand at each cycle of synthesis. We assume that this rate is equal for all nucleotides and all cycles. We determine the value of <italic>q </italic>by minimizing the average correlation between intensities at cycle <italic>n </italic>and <italic>n+1</italic>.</p>
      <p>The last major source of systematic variation is due to an optical effect: on each tile, the colonies near the center of the image appear brighter than the ones near the edges (Additional file <xref ref-type="supplementary-material" rid="S2">2</xref>). We correct this by fitting a two-dimensional lowess [<xref ref-type="bibr" rid="B18">18</xref>] model to the intensities for each tile and subtracting the difference between the fit and the median intensity.</p>
      <p>The three corrections are applied sequentially (cf. Methods) to the raw intensities before applying the model-based clustering algorithm described next.</p>
    </sec>
    <sec>
      <title>Model-based clustering and information-theoretic base calling</title>
      <p>We used a model-based clustering algorithm[<xref ref-type="bibr" rid="B12">12</xref>,<xref ref-type="bibr" rid="B19">19</xref>-<xref ref-type="bibr" rid="B22">22</xref>] to classify the intensity quadruples into four groups. Clearly, four well-delineated clusters corresponding to the four bases emerge (Fig. <xref ref-type="fig" rid="F1">1A–B</xref>). Specifically, we model the intensities measured in each channel by a mixture of four 4-dimensional Gaussian random variables and we use the intensity quadruples from all colonies in one or few combined tiles to fit the model parameters. The fitted model provides four probability distributions on the space of intensity quadruples, namely the probability <italic>P</italic><sub>A</sub>(<italic>k</italic>) = <italic>P</italic>(<italic>A</italic>|<italic>I</italic><sub>1</sub>(<italic>k</italic>), ..., <italic>I</italic><sub>4</sub>(<italic>k</italic>)) that the <italic>k</italic><sup>th </sup>base to call is an <italic>A </italic>knowing the measured intensities in all four channels at cycle <italic>k</italic>, and similarly for <italic>P</italic><sub>C</sub>, <italic>P</italic><sub>G </sub>and <italic>P</italic><sub>T</sub>. We can measure the level of uncertainty in our base calling by the entropy <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M1" name="1471-2105-9-431-i1" overflow="scroll"><mml:semantics><mml:mrow><mml:mi>h</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>α</mml:mi><mml:mo>∈</mml:mo><mml:mo>{</mml:mo><mml:mtext>ACGT</mml:mtext><mml:mo>}</mml:mo></mml:mrow></mml:munder><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mi>α</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>l</mml:mi><mml:mi>o</mml:mi><mml:msub><mml:mi>g</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:msub><mml:mi>P</mml:mi><mml:mi>α</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:mrow></mml:semantics></mml:math></inline-formula> which measures the uncertainty (in bits) in the determination of the correct <italic>k</italic><sup>th </sup>base[<xref ref-type="bibr" rid="B23">23</xref>]. Knowing <italic>h </italic>and the four probabilities we then use cutoffs in the probability simplex to decide which IUPAC code to call (Figure <xref ref-type="fig" rid="F2">2A</xref>, Methods). As the sequencing progresses, we also compute the cumulative entropy of each colony, <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M2" name="1471-2105-9-431-i2" overflow="scroll"><mml:semantics><mml:mrow><mml:mi>H</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:mi>h</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:mrow></mml:semantics></mml:math></inline-formula>, which estimates the log<sub>2 </sub>of the number of actual sequences compatible with the codes called up to position <italic>n</italic>. This total entropy is used to rank tags from least to most ambiguous. Figure <xref ref-type="fig" rid="F3">3A</xref> shows that this ambiguity score correlates with, but is markedly different from the Solexa fast-q quality score. The ambiguity metric is useful for genome assembly or polymorphism identification by allowing down-weighting the low quality tags when deriving statistics from multiple alignments of tags. As shown below, this metric can also be used to optimize tag lengths and increase the chance of identifying a match on the reference genome.</p>
      <fig position="float" id="F2">
        <label>Figure 2</label>
        <caption>
          <p><bold>Base calling determined by entropy</bold>. <bold>A</bold>. Probability simplex for a 3-letter alphabet (<italic>A </italic>= blue, <italic>C </italic>= red, <italic>G </italic>= green). Each point in the triangle is a probability triplet (<italic>P</italic><sub>A</sub>, <italic>P</italic><sub>C</sub>, <italic>P</italic><sub>G</sub>) represented by the corresponding color mixture. Blue lines are iso-entropic levels, black lines are the cutoffs between the various IUPAC codes. These correspond to midpoints in the state variable (<italic>S </italic>= 2<sup><italic>h</italic></sup>). <bold>B</bold>. Distribution of entropy per base across 10 tiles on 36 bases. Red lines at the bottom indicate the IUPAC cutoffs. Mass within each segment is indicated in red.</p>
        </caption>
        <graphic xlink:href="1471-2105-9-431-2"/>
      </fig>
      <fig position="float" id="F3">
        <label>Figure 3</label>
        <caption>
          <p><bold>Quality and entropy depend on position in the sequence</bold>. <bold>A</bold>. Quantile-quantile plot of fast-q quality score against the information content per base. The two measures are loosely correlated, but clearly not equivalent. <bold>B</bold>. Boxplot of the fast-q score along the first 35 bases of the sequencing. The overall base quality decreases sharply after base 14, but the distribution still extends up to the top 40 score at bases 30–35. <bold>C</bold>. Frequency of the four categories of ambiguous IUPAC codes as a function of the position in the sequence.</p>
        </caption>
        <graphic xlink:href="1471-2105-9-431-3"/>
      </fig>
    </sec>
    <sec>
      <title>Genome coverage statistics</title>
      <p>To assess the quality of our base calling and to compare it with the sequences obtained via Solexa's analysis pipeline, we compute the mapping efficiency #{reads mapping exactly to the genome}/#{total number of reads}. We used the <italic>fetchGWI </italic>tool [<xref ref-type="bibr" rid="B24">24</xref>] to search for unique exact matches of each sequenced tag encoded in the IUPAC code on the 5386 nt reference phiX174 genome sequence [RefSeq:NC_001422]. We thus discard every tag that matches at more than one position or does not match exactly anywhere on the reference sequence. One lane (330 tiles) of the Solexa flow cell produced 8 M tags, 3 M unique tags and 3.8 mappable tags, which amounts to a throughput of 137 million immediately usable bases per run. Sorting tags by decreasing quality we see (Figure <xref ref-type="fig" rid="F4">4</xref>) that low-entropy tags are easily identified by both the Solexa and Rolexa pipelines, but that the coverage achieved by Rolexa-called tags increases significantly among the low-quality sequences and results in an increased total coverage of up to 10–25% (average 15%). We also see that ranking by quality (or entropy, data not shown) is a judicious prioritization strategy since the coverage increase is sharp in the top part of the list and subsequently plateaus off.</p>
      <fig position="float" id="F4">
        <label>Figure 4</label>
        <caption>
          <p><bold>Rolexa base-calling increases the coverage</bold>. Black: Solexa base calling, blue: Rolexa base calling using only the ACGT alphabet (most probable base calling), green: Rolexa base calling using IUPAC codes, red: Rolexa base calling with IUPAC codes and tag length optimization. Numbers in the right margin are the number of matching tags in millions. Sequence tags were sorted by decreasing quality (fast-q) and unique exact matches on the reference phiX174 genome were searched. Vertical axis shows the proportion of tags finding an exact match.</p>
        </caption>
        <graphic xlink:href="1471-2105-9-431-4"/>
      </fig>
      <p>To estimate error rates of sequencing, we used <italic>align0 </italic>[<xref ref-type="bibr" rid="B25">25</xref>] to search for an optimal match between each tag and the phiX genome, and then computed the number of mismatches between tag and reference. Figure <xref ref-type="fig" rid="F5">5A</xref> shows how the error rates increases as a function of the sequencing cycles for Solexa tags. Rolexa tags called with the most probable ACGT base showed a slower increase, and introducing IUPAC codes significantly decreased both the intercept and slope of the error rate as a function of the sequencing cycle.</p>
      <fig position="float" id="F5">
        <label>Figure 5</label>
        <caption>
          <p><bold>Disequilibrium between complementary bases ratio</bold>. <bold>A</bold>. Error rate at each cycle of sequencing. Each tag was aligned on the genome using <italic>align0 </italic>and the error rate defined by counting the number of differences between the bases called and the reference at the corresponding position. Black is the error rate for Solexa-called tags, blue for Rolexa tags called using only the ACGT alphabet and green for Rolexa-called tags with IUPAC codes. <bold>B</bold>. Proportion of bases <italic>A</italic>, <italic>C</italic>, <italic>G </italic>and <italic>T </italic>at each position in the tags for Solexa base calling (dashed lines) and Rolexa base calling (continuous line). The complementary <italic>A </italic>and <italic>T </italic>proportions are different (ratio is not 1) and are degrading along the sequences (lines drift apart). The proportions are less dependent on position with Rolexa base calling, although the ratios remain different from 1. Label on y-axis is wrong. Panels <bold>C-D </bold>focuses on tags "rescued" by Rolexa base calling, namely those tags that could not be mapped on the genome after Solexa base calling, but had a matching position via Rolexa base calling. <bold>C</bold>. The distribution of substitutions between the Solexa tags and the corresponding Rolexa tags shows a predominance of <italic>C </italic>to <italic>A </italic>and <italic>T </italic>to <italic>G </italic>substitutions which is consistent with a re-equilibration of the base complementarity.<bold>D</bold>. Introducing one to six mutations in the Solexa tags with the same frequencies as the Rolexa algorithm at random positions only rescues about 2% of the tags that were rescued by Rolexa with the same number of ambiguous bases (green bars).</p>
        </caption>
        <graphic xlink:href="1471-2105-9-431-5"/>
      </fig>
    </sec>
    <sec>
      <title>Base distribution statistics</title>
      <p>A surprising property of Solexa sequences is the imbalance between complementary <italic>A </italic>and <italic>T </italic>base counts as well as between <italic>G </italic>and <italic>C</italic>[<xref ref-type="bibr" rid="B14">14</xref>]. As shown in Figure <xref ref-type="fig" rid="F5">5B</xref>, there is progressive deterioration in the proportions as the sequencing progresses, which is likely related to the varying noise levels across fluorescent dyes for complementary base pairs as well as dye-specific chemical effects (see Fig. <xref ref-type="fig" rid="F1">1</xref>). In consequence an intensity close to the background is more likely to be called <italic>T </italic>than <italic>A</italic>, or <italic>C </italic>than <italic>G</italic>. Applying our corrections at the level of intensities stabilizes the proportions of bases, which is particularly pronounced for the T's. For reasons we do not currently understand the A/T ratio is not exactly one but stabilizes around 0.9 (Figure <xref ref-type="fig" rid="F5">5B</xref>).</p>
      <p>To ascertain whether our increased coverage is not simply the consequence of the more degenerate alphabet, we verified that introducing ambiguities at random positions does not similarly improve the mapping. We thus selected the tags that did not match on the genome based on Solexa base calling, but did match after Rolexa introduced one to five ambiguous bases. Then we introduced ambiguities in these tags, with the same frequency as Rolexa, but at random positions. Figure <xref ref-type="fig" rid="F5">5D</xref> shows that only about 2% of those randomized mutations found a match on the genome, indicating that the entropy is a specific predictor of ambiguous positions.</p>
    </sec>
    <sec>
      <title>Optimizing tag length</title>
      <p>While Solexa's quality score tends to decrease along the sequence, its distribution mostly spreads, rather than shifts, downwards (Fig. <xref ref-type="fig" rid="F3">3B</xref>). Computing a global length cutoff based on the average quality will therefore discard a lot of high-quality bases and not necessarily ensure a uniform quality. Thus we expect to increase the number of tags that can be mapped to a reference sequence by cutting them to a shorter length [<xref ref-type="bibr" rid="B26">26</xref>]. However this procedure has a downside since it will reduce the coverage length per tag and increase the probability of finding multiple matches. Similarly, standard Solexa procedures suggest selecting tags with high average fast-q. Yet, a low average can be the result of just a few uncertain bases near the end of an otherwise useful tag.</p>
      <p>We tested the different selections by applying the following quality filters. For the Solexa method we cut the tags at length 20, 25, 26, 28, 30, and then filtered all sequences with average fast-q score bellow 30, 25, or 20. In comparison, we used the following filtering procedure for Rolexa tags: we chose 3 different length-dependent entropy cutoffs <italic>IT(k) </italic>(see methods) and searched within each read for the longest <italic>k</italic>-mer with total entropy less than <italic>IT(k)</italic>. We then extended this subsequence in both directions up to the next ambiguous base and eventually removed all tags shorter than 10 bases. The coverage statistics for the different filters are summarized in Figure <xref ref-type="fig" rid="F6">6</xref>. We performed a similar analysis of the 330 tiles of the sequencing of targeted human genomic regions and found an average of 50% increase in nucleotide coverage (Additional file <xref ref-type="supplementary-material" rid="S3">3</xref>). We see that the efficiency of Rolexa is superior in all datasets as measured by the ratio of actual coverage to expected coverage as well as by the ratio of tags having a unique match on the genome. The latter criterion is important since in many application of high-throughput sequencing (such as gene expression measures or ChIP-Seq), the extent of the coverage is less important than the number of hits on the genome. Similarly, in genotyping and targeted re-sequencing, where inexact matches are expected, the ability to reliably filter out low-quality tags before doing the matching to the reference sequence is of the highest importance, since actual polymorphisms must be distinguished from sequencing errors.</p>
      <fig position="float" id="F6">
        <label>Figure 6</label>
        <caption>
          <p><bold>Tag-dependent quality filtering improves the mapping efficiency</bold>. Several entropy cutoffs were used to filter low-quality Rolexa-called tags and to reduce tags to higher scoring sub-tags. Solexa-called tags were filtered to the same length as the average length of the previous sets and to various average fast-q score. <bold>A</bold>. The actual coverage of the target genome as a function of the expected coverage (if all tags could have been mapped). <bold>B</bold>. The efficiency of the filtering in coverage ratio (actual number of nucleotides covered divided by expected number, X axis) and in tag mapping ratio (number of tags mapped to the genome divided by number of tags passing the quality filter, Y axis). Rolexa (red points) has superior efficiency to Solexa (green points) in all data sets. Points are labeled with the cutoffs used (see text): Rolexa cutoffs are either constant (2, 4, 6, 8), growing logarithmically (Log) or exponentially (Exp), Solexa cutoffs are indicated by two numbers, the length cutoff followed by the fast-q cutoff.</p>
        </caption>
        <graphic xlink:href="1471-2105-9-431-6"/>
      </fig>
    </sec>
  </sec>
  <sec>
    <title>Discussion</title>
    <p>Several points in the analysis of Solexa high throughput sequencing technology can likely benefit from further improvements. First the disequilibrium between complementary bases should be reduced. Although the phiX174 is a single-stranded DNA virus, the library was prepared from the double-stranded covalently closed circular form of the genome. As shown, the output of the sequencing shows an increasing deterioration of the equilibrium between complementary bases as the sequencing cycles proceed (Figure <xref ref-type="fig" rid="F5">5B</xref>). Our approach improves on this but does not solve the issue completely.</p>
    <p>Similar approaches have recently been Dohm et al.[<xref ref-type="bibr" rid="B14">14</xref>] have observed similar bias to the ones described here, but only proposed to correct them at the level of the sequence alignment, not at the level of the base calling. Cokus et al.[<xref ref-type="bibr" rid="B12">12</xref>] use Solexa's pre-treated data (_sig2 files) and apply a very similar EM procedure to fit a Gaussian mixture model for probabilistic base calling. They do not use information based metrics to reduce the probabilities to IUPAC codes, but rather construct position-weight matrices with which they scan the reference genome, which is computationally expensive and not directly applicable for <italic>de-novo </italic>sequencing. Erlich et al.[<xref ref-type="bibr" rid="B13">13</xref>] train a Support Vector Machine optimized on a reference sequence which is computationally highly expensive. Rolexa only needs a (nowadays common) multi-core computer and runs a complete analysis of one lane in 10 hours over 5 cores. Moreover it is based on modeling the bio-chemical properties of the system.</p>
    <p>We have not considered here the potentially important benefits of fine-tuning the image analysis algorithms. Looking at images generated by the microscopic device shows that when the density of colonies is high in some region of the images, bleeding-over occurs and assigning the correct fluorescence intensity to each colony is clearly a delicate problem (see [<xref ref-type="bibr" rid="B16">16</xref>]).</p>
    <p>Due to the large file size and format of the Solexa output data, concurrently (and randomly) accessing 20,000 text files puts a heavy strain on any standard file system, not to mention backup devices. Rolexa works with compressed inputs and outputs, which already reduces file size considerably. Still, a better suited file format could help both the storage and the processing, e.g. using suffix tables and trees[<xref ref-type="bibr" rid="B27">27</xref>,<xref ref-type="bibr" rid="B28">28</xref>]. The latest GAII upgrade to the Solexa/Illumina sequencer generates even more data, through larger acquisition area, longer reads, and paired-end sequencing. Generating longer reads require efficient and reliable algorithms for base calling with reasonable levels of accuracy up to the end of the read. Furthermore, this increased throughput requires these algorithms to be fast and be based on direct and simple methods that are re-usable without tuning from one run to the next.</p>
  </sec>
  <sec>
    <title>Conclusion</title>
    <p>Solexa/Illumina high-throughput sequencing has already and will increasingly produce vast amounts of systems scale genomics and functional genomics data. As with other high-throughput techniques, improvements in signal processing and statistical assessment of the data will prove to be a key step in the maturation of the technology and the progress towards reliable applications and new discoveries[<xref ref-type="bibr" rid="B29">29</xref>].</p>
  </sec>
  <sec sec-type="methods">
    <title>Methods</title>
    <sec>
      <title>Sample preparation and Genome Analyzer sequencing</title>
      <p>The phiX174 Control Library used was prepared by Illumina (Cat. No CT-901-1001). Briefly, the double-stranded covalently closed circular form of the viral DNA was broken into 100–400 bp fragments by nebulization; the ends repaired with Klenow, T4 DNA polymerase and PNK; and a base <italic>A </italic>was added on the 3'ends. After ligation of the double-stranded genomic adapters the sample was gel-purified to isolate fragments with "inserts" of approximately 200 bp and amplified by 18 cycles of PCR (Illumina protocol "Preparing Samples for Sequencing Genomic DNA", Part # 11251892 Rev. A). The library is quality controlled by cloning an aliquot into a TOPO plasmid and capillary sequencing 5–10 clones.</p>
      <p>DNA Colonies were prepared by using a "Standard Cluster Generation Kit" (Cat. No. FC-103-1001) and 35 cycles of isothermal amplification in the flow-cell on the "Illumina Cluster Station" using a pM dilution of the 10 nM library. After amplification, one of the strands is removed; the free 3'-ends are blocked by terminal transferase in presence of dideoxynucleotides; and the genomic sequencing primer hybridized. The flow-cell was transferred to the Genome Analyzer "classic" and sequencing was performed for 36 cycles using a "36 Cycle Sequencing Kit" (Cat. No FC-104-1003) with the version 2.0 of the scanning buffer.</p>
    </sec>
    <sec>
      <title>Sequencing of Human cells</title>
      <p>The samples used for Additional file <xref ref-type="supplementary-material" rid="S3">3</xref> came from the pooled DNA obtained by long-range PCR amplification[<xref ref-type="bibr" rid="B30">30</xref>] of a 30 kb region of chromosome 19 from 3 different individuals plus a 50 kb region of chromosome 3 from a fourth individual. Sequencing was performed as described above for the phiX174.</p>
    </sec>
    <sec>
      <title>Data analysis</title>
      <p>All data analysis for this paper has been performed with the R statistical framework <ext-link ext-link-type="uri" xlink:href="http://www.r-project.org/"/> and the Rolexa package. This package uses the <italic>mclust </italic>routines[<xref ref-type="bibr" rid="B20">20</xref>] as well as the <italic>fork </italic>package to run efficiently on multi-core architectures. Matching of short tags onto the genome have been performed with the <italic>fetchGWI </italic>tool[<xref ref-type="bibr" rid="B24">24</xref>] by first generating a comprehensive index of the phiX174 genome and matching each query with its index entry. We used <italic>align0 </italic>[<xref ref-type="bibr" rid="B25">25</xref>] to search for best matches from tags to the genome and estimate error rates (see Fig. <xref ref-type="fig" rid="F5">5A</xref>). When counting errors, an alignment of IUPAC code with one of its compatible bases was counted as correct match.</p>
      <p>Raw data analysis (image analysis, initial base calling and fast-q scores) used the <italic>Firecrest </italic>image analysis module and the <italic>Bustard </italic>base-caller from the Illumina software suite (SolexaPipeline-0.2.2.6). No filtering or analysis with <italic>Gerald </italic>was performed.</p>
    </sec>
    <sec>
      <title>Preliminary data transformation</title>
      <p>We model the measured intensities I(<italic>α</italic>, <italic>n</italic>, <italic>x</italic>) (<italic>α </italic>= <italic>A</italic>, <italic>C</italic>, <italic>G</italic>, <italic>T </italic>is the dye channel, <italic>n </italic>= 1, ..., <italic>36 </italic>is the cycle number and <italic>x </italic>denotes the colony coordinates) as the following combination of unbiased intensities <italic>J</italic>(<italic>α</italic>, <italic>n</italic>, <italic>x</italic>):</p>
      <p>
        <disp-formula>
          <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M3" name="1471-2105-9-431-i3" overflow="scroll">
            <mml:semantics>
              <mml:mrow>
                <mml:mi>I</mml:mi>
                <mml:mo stretchy="false">(</mml:mo>
                <mml:mi>α</mml:mi>
                <mml:mo>,</mml:mo>
                <mml:mi>n</mml:mi>
                <mml:mo>,</mml:mo>
                <mml:mi>x</mml:mi>
                <mml:mo stretchy="false">)</mml:mo>
                <mml:mo>=</mml:mo>
                <mml:mstyle displaystyle="true">
                  <mml:munder>
                    <mml:mo>∑</mml:mo>
                    <mml:mrow>
                      <mml:mi>m</mml:mi>
                      <mml:mo>=</mml:mo>
                      <mml:mn>1</mml:mn>
                      <mml:mo>,</mml:mo>
                      <mml:mn>...</mml:mn>
                      <mml:mo>,</mml:mo>
                      <mml:mi>n</mml:mi>
                    </mml:mrow>
                  </mml:munder>
                  <mml:mrow>
                    <mml:mstyle displaystyle="true">
                      <mml:munder>
                        <mml:mo>∑</mml:mo>
                        <mml:mrow>
                          <mml:mi>β</mml:mi>
                          <mml:mo>=</mml:mo>
                          <mml:mi>A</mml:mi>
                          <mml:mo>,</mml:mo>
                          <mml:mi>C</mml:mi>
                          <mml:mo>,</mml:mo>
                          <mml:mi>G</mml:mi>
                          <mml:mo>,</mml:mo>
                          <mml:mi>T</mml:mi>
                        </mml:mrow>
                      </mml:munder>
                      <mml:mrow>
                        <mml:mi>M</mml:mi>
                        <mml:mo stretchy="false">(</mml:mo>
                        <mml:mi>α</mml:mi>
                        <mml:mo>,</mml:mo>
                        <mml:mi>β</mml:mi>
                        <mml:mo stretchy="false">)</mml:mo>
                        <mml:mi>J</mml:mi>
                        <mml:mo stretchy="false">(</mml:mo>
                        <mml:mi>β</mml:mi>
                        <mml:mo>,</mml:mo>
                        <mml:mi>m</mml:mi>
                        <mml:mo>,</mml:mo>
                        <mml:mi>x</mml:mi>
                        <mml:mo stretchy="false">)</mml:mo>
                        <mml:mi>R</mml:mi>
                        <mml:mo stretchy="false">(</mml:mo>
                        <mml:mi>m</mml:mi>
                        <mml:mo>,</mml:mo>
                        <mml:mi>n</mml:mi>
                        <mml:mo stretchy="false">)</mml:mo>
                      </mml:mrow>
                    </mml:mstyle>
                  </mml:mrow>
                </mml:mstyle>
                <mml:mo>,</mml:mo>
              </mml:mrow>
            </mml:semantics>
          </mml:math>
        </disp-formula>
      </p>
      <p>where the 4 × 4 matrix <italic>M </italic>is a mixture matrix which is block diagonal and depends on the 4 parameters <italic>ϕ</italic><sub><italic>AC</italic></sub>, <italic>θ</italic><sub><italic>AC</italic></sub>, <italic>ϕ</italic><sub><italic>GT </italic></sub>and <italic>θ</italic><sub><italic>GT</italic></sub>:</p>
      <p>
        <disp-formula>
          <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M4" name="1471-2105-9-431-i4" overflow="scroll">
            <mml:semantics>
              <mml:mrow>
                <mml:mi>M</mml:mi>
                <mml:mrow>
                  <mml:mo>(</mml:mo>
                  <mml:mrow>
                    <mml:mrow>
                      <mml:mo>{</mml:mo>
                      <mml:mrow>
                        <mml:mi>A</mml:mi>
                        <mml:mo>,</mml:mo>
                        <mml:mi>C</mml:mi>
                      </mml:mrow>
                      <mml:mo>}</mml:mo>
                    </mml:mrow>
                    <mml:mo>,</mml:mo>
                    <mml:mrow>
                      <mml:mo>{</mml:mo>
                      <mml:mrow>
                        <mml:mi>A</mml:mi>
                        <mml:mo>,</mml:mo>
                        <mml:mi>C</mml:mi>
                      </mml:mrow>
                      <mml:mo>}</mml:mo>
                    </mml:mrow>
                  </mml:mrow>
                  <mml:mo>)</mml:mo>
                </mml:mrow>
                <mml:mo>=</mml:mo>
                <mml:mrow>
                  <mml:mo>(</mml:mo>
                  <mml:mrow>
                    <mml:mtable>
                      <mml:mtr>
                        <mml:mtd>
                          <mml:mrow>
                            <mml:mi>c</mml:mi>
                            <mml:mi>o</mml:mi>
                            <mml:mi>s</mml:mi>
                            <mml:msub>
                              <mml:mi>θ</mml:mi>
                              <mml:mrow>
                                <mml:mi>A</mml:mi>
                                <mml:mi>C</mml:mi>
                              </mml:mrow>
                            </mml:msub>
                          </mml:mrow>
                        </mml:mtd>
                        <mml:mtd>
                          <mml:mrow>
                            <mml:mi>sin</mml:mi>
                            <mml:mo>⁡</mml:mo>
                            <mml:msub>
                              <mml:mi>θ</mml:mi>
                              <mml:mrow>
                                <mml:mi>A</mml:mi>
                                <mml:mi>C</mml:mi>
                              </mml:mrow>
                            </mml:msub>
                          </mml:mrow>
                        </mml:mtd>
                      </mml:mtr>
                      <mml:mtr>
                        <mml:mtd>
                          <mml:mrow>
                            <mml:mi>cos</mml:mi>
                            <mml:mo>⁡</mml:mo>
                            <mml:msub>
                              <mml:mi>φ</mml:mi>
                              <mml:mrow>
                                <mml:mi>A</mml:mi>
                                <mml:mi>C</mml:mi>
                              </mml:mrow>
                            </mml:msub>
                          </mml:mrow>
                        </mml:mtd>
                        <mml:mtd>
                          <mml:mrow>
                            <mml:mi>sin</mml:mi>
                            <mml:mo>⁡</mml:mo>
                            <mml:msub>
                              <mml:mi>φ</mml:mi>
                              <mml:mrow>
                                <mml:mi>A</mml:mi>
                                <mml:mi>C</mml:mi>
                              </mml:mrow>
                            </mml:msub>
                          </mml:mrow>
                        </mml:mtd>
                      </mml:mtr>
                    </mml:mtable>
                  </mml:mrow>
                  <mml:mo>)</mml:mo>
                </mml:mrow>
                <mml:mo>,</mml:mo>
              </mml:mrow>
            </mml:semantics>
          </mml:math>
        </disp-formula>
      </p>
      <p>and similarly for the <italic>G</italic>, <italic>T </italic>block, and the dephasing matrix <italic>R </italic>is a function of the parameter <italic>q </italic>and has a binomial structure:</p>
      <p>
        <disp-formula>
          <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M5" name="1471-2105-9-431-i5" overflow="scroll">
            <mml:semantics>
              <mml:mrow>
                <mml:mi>R</mml:mi>
                <mml:mo stretchy="false">(</mml:mo>
                <mml:mi>m</mml:mi>
                <mml:mo>,</mml:mo>
                <mml:mi>n</mml:mi>
                <mml:mo stretchy="false">)</mml:mo>
                <mml:mo>=</mml:mo>
                <mml:mrow>
                  <mml:mo>{</mml:mo>
                  <mml:mrow>
                    <mml:mtable>
                      <mml:mtr>
                        <mml:mtd>
                          <mml:mrow>
                            <mml:mn>0</mml:mn>
                            <mml:mtext> if </mml:mtext>
                            <mml:mi>m</mml:mi>
                            <mml:mo>&gt;</mml:mo>
                            <mml:mi>n</mml:mi>
                            <mml:mo>,</mml:mo>
                          </mml:mrow>
                        </mml:mtd>
                      </mml:mtr>
                      <mml:mtr>
                        <mml:mtd>
                          <mml:mrow>
                            <mml:mrow>
                              <mml:mo>(</mml:mo>
                              <mml:mrow>
                                <mml:mtable>
                                  <mml:mtr>
                                    <mml:mtd>
                                      <mml:mi>n</mml:mi>
                                    </mml:mtd>
                                  </mml:mtr>
                                  <mml:mtr>
                                    <mml:mtd>
                                      <mml:mi>m</mml:mi>
                                    </mml:mtd>
                                  </mml:mtr>
                                </mml:mtable>
                              </mml:mrow>
                              <mml:mo>)</mml:mo>
                            </mml:mrow>
                            <mml:msup>
                              <mml:mi>q</mml:mi>
                              <mml:mrow>
                                <mml:mi>n</mml:mi>
                                <mml:mo>−</mml:mo>
                                <mml:mi>m</mml:mi>
                              </mml:mrow>
                            </mml:msup>
                            <mml:msup>
                              <mml:mrow>
                                <mml:mo stretchy="false">(</mml:mo>
                                <mml:mn>1</mml:mn>
                                <mml:mo>−</mml:mo>
                                <mml:mi>q</mml:mi>
                                <mml:mo stretchy="false">)</mml:mo>
                              </mml:mrow>
                              <mml:mi>m</mml:mi>
                            </mml:msup>
                            <mml:mtext> if </mml:mtext>
                            <mml:mi>m</mml:mi>
                            <mml:mo>≤</mml:mo>
                            <mml:mi>n</mml:mi>
                            <mml:mo>.</mml:mo>
                          </mml:mrow>
                        </mml:mtd>
                      </mml:mtr>
                    </mml:mtable>
                  </mml:mrow>
                </mml:mrow>
              </mml:mrow>
            </mml:semantics>
          </mml:math>
        </disp-formula>
      </p>
      <p>The parameters <italic>ϕ</italic><sub><italic>AC</italic></sub>, <italic>θ</italic><sub><italic>AC</italic></sub>, <italic>ϕ</italic><sub><italic>GT</italic></sub>, <italic>θ</italic><sub><italic>GT </italic></sub>are determined by minimizing the following function:</p>
      <p>
        <disp-formula><italic>F</italic><sub><italic>n</italic></sub>(<italic>θ</italic><sub><italic>AC</italic></sub>, <italic>ϕ</italic><sub><italic>AC</italic></sub>, <italic>θ</italic><sub><italic>GT</italic></sub>, <italic>ϕ</italic><sub><italic>GT</italic></sub>) = cor(<italic>M</italic><sup>-1</sup><italic>I </italic>(<italic>A</italic>, <italic>n</italic>, •), <italic>M</italic><sup>-1 </sup><italic>I</italic>(<italic>C</italic>, <italic>n</italic>, •))<sup>2 </sup>+ cor(<italic>M</italic><sup>-1 </sup><italic>I</italic>(<italic>G</italic>, <italic>n</italic>, •), <italic>M</italic><sup>-1</sup><italic>I</italic>(<italic>T</italic>, <italic>n</italic>, •))<sup>2</sup>,</disp-formula>
      </p>
      <p>which defines an intermediate intensity matrix <italic>K </italic>= <italic>M</italic><sup>-1 </sup><italic>I</italic>. This is then introduced into the function</p>
      <p>
        <disp-formula>
          <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M6" name="1471-2105-9-431-i6" overflow="scroll">
            <mml:semantics>
              <mml:mrow>
                <mml:mi>G</mml:mi>
                <mml:mo stretchy="false">(</mml:mo>
                <mml:mi>q</mml:mi>
                <mml:mo stretchy="false">)</mml:mo>
                <mml:mo>=</mml:mo>
                <mml:mstyle displaystyle="true">
                  <mml:munder>
                    <mml:mo>∑</mml:mo>
                    <mml:mrow>
                      <mml:mi>α</mml:mi>
                      <mml:mo>,</mml:mo>
                      <mml:mi>n</mml:mi>
                    </mml:mrow>
                  </mml:munder>
                  <mml:mrow>
                    <mml:mi>c</mml:mi>
                    <mml:mi>o</mml:mi>
                    <mml:mi>r</mml:mi>
                    <mml:msup>
                      <mml:mrow>
                        <mml:mrow>
                          <mml:mo>(</mml:mo>
                          <mml:mrow>
                            <mml:msup>
                              <mml:mi>R</mml:mi>
                              <mml:mrow>
                                <mml:mo>−</mml:mo>
                                <mml:mn>1</mml:mn>
                              </mml:mrow>
                            </mml:msup>
                            <mml:mi>K</mml:mi>
                            <mml:mo stretchy="false">(</mml:mo>
                            <mml:mi>α</mml:mi>
                            <mml:mo>,</mml:mo>
                            <mml:mi>n</mml:mi>
                            <mml:mo>,</mml:mo>
                            <mml:mo>•</mml:mo>
                            <mml:mo stretchy="false">)</mml:mo>
                            <mml:mo>,</mml:mo>
                            <mml:msup>
                              <mml:mi>R</mml:mi>
                              <mml:mrow>
                                <mml:mo>−</mml:mo>
                                <mml:mn>1</mml:mn>
                              </mml:mrow>
                            </mml:msup>
                            <mml:mi>K</mml:mi>
                            <mml:mo stretchy="false">(</mml:mo>
                            <mml:mi>α</mml:mi>
                            <mml:mo>,</mml:mo>
                            <mml:mi>n</mml:mi>
                            <mml:mo>+</mml:mo>
                            <mml:mn>1</mml:mn>
                            <mml:mo>,</mml:mo>
                            <mml:mo>•</mml:mo>
                            <mml:mo stretchy="false">)</mml:mo>
                          </mml:mrow>
                          <mml:mo>)</mml:mo>
                        </mml:mrow>
                      </mml:mrow>
                      <mml:mn>2</mml:mn>
                    </mml:msup>
                  </mml:mrow>
                </mml:mstyle>
                <mml:mo>,</mml:mo>
              </mml:mrow>
            </mml:semantics>
          </mml:math>
        </disp-formula>
      </p>
      <p>which is minimized to determine <italic>q</italic>.</p>
      <p>Lastly, we correct systematic bias in function of the cluster coordinate as follows: we fit a 2-dimensional lowess [<xref ref-type="bibr" rid="B18">18</xref>] as a function of <italic>(x</italic>, <italic>y) </italic>coordinates and then subtract the difference between that fit and the median intensity across all four channels, for each tile and cycle.</p>
    </sec>
    <sec>
      <title>Model-based clustering and data fitting</title>
      <p>We used the <italic>EEV </italic>model of the <italic>mclust </italic>algorithm[<xref ref-type="bibr" rid="B20">20</xref>] to fit the Gaussian mixtures used to assign base probabilities in function of the four-dimensional intensity vector, similar as what was performed in [<xref ref-type="bibr" rid="B12">12</xref>]. This model assumes Gaussian mixtures with four covariance matrices of the same shape and volume but with varying orientation. We initialize the classification by attributing each colony to the nucleotide with the highest (corrected) intensity. Given that initial classification, an M step of the <italic>mclust </italic>algorithm is performed which estimates the maximum likelihood parameters given the class attributions, where the parameters to estimate are the global scale and shape parameters as well as the centers and orientations of each class (using the covariance parameterization described in [<xref ref-type="bibr" rid="B20">20</xref>]). This is then followed by an E step of the EM algorithm to estimate the conditional probabilities of each data point belonging to each class given the parameters estimates obtained previously. Full convergence of the EM algorithm is offered as an option but occasionally runs into spurious optima due to the effect of outliers (similarly to what was observed in [<xref ref-type="bibr" rid="B12">12</xref>]). Further details of the implementation can be found in the package documentation (see Availability section).</p>
    </sec>
    <sec>
      <title>Cutoffs for base calling and tag length</title>
      <p>The Rolexa algorithms require two types of cutoffs, which can both be easily user-defined in the Rolexa package. In the analyses presented, the limits between the different IUPAC bases in the probability simplex (Figure <xref ref-type="fig" rid="F2">2A</xref>) were set to <italic>HT(n) </italic>= log<sub>2</sub>(<italic>n</italic>+0.5) with <italic>n </italic>= 1,2,3 (Figure <xref ref-type="fig" rid="F2">2B</xref>). Secondly the length-dependent cutoffs <italic>IT(n) </italic>were used to filter out uncertain bases by selecting the longest sub-tag <italic>S </italic>with total entropy smaller than <italic>IT(n </italic>= length <italic>(S))</italic>. In Figure <xref ref-type="fig" rid="F6">6</xref> we used the following 6 choices: constants <italic>IT</italic><sub><italic>c</italic></sub><italic>(n) </italic>= <italic>c </italic>with the constant <italic>c </italic>set to 2, 4, 6, or 8, and two cutoffs increasing with the tag length: <italic>IT</italic><sub>Log </sub>(<italic>n</italic>) = log<sub>2 </sub>(4 + (<italic>n </italic>- 1)/5) and <italic>IT</italic><sub>Exp </sub>(<italic>n</italic>) = 2<sup>(1+(<italic>n</italic>-1)/36)</sup>. The latter two cutoffs interpolate between 2 and approximately 4 over the length of the sequence, but the first cutoff is concave (increases faster at the beginning) and the second is convex.</p>
    </sec>
    <sec>
      <title>Availability</title>
      <p>We have developed an R package called Rolexa which is freely available from <ext-link ext-link-type="uri" xlink:href="http://bbcf.epfl.ch/Software"/>. It is distributed under the GPL license and uses the <italic>mclust </italic>package which is part of the R distribution.</p>
    </sec>
  </sec>
  <sec>
    <title>Authors' contributions</title>
    <p>JR and AA implemented the method, JR and CI analyzed the data, JR and FN wrote the manuscript, FN and IX designed and supervised the study. LF provided insight and data and performed the experiments. All authors read and approved the final manuscript.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material content-type="local-data" id="S1">
      <caption>
        <title>Additional File 1</title>
        <p><bold>Signal over noise decays with sequencing cycle number</bold>. Histograms of the raw fluorescence intensities are shown for cycles 5, 15, 25, and 35. The separation between signal and noise is increasingly blurred and faster in the <italic>A </italic>and <italic>G </italic>channels than in the <italic>C </italic>and <italic>T </italic>channels. Red lines indicate a fit by a mixture of two Gaussians distributions with blue vertical bars indicating the mean and one standard deviation for the highest component of the mixture.</p>
      </caption>
      <media xlink:href="1471-2105-9-431-S1.png" mimetype="image" mime-subtype="png">
        <caption>
          <p>Click here for file</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="S2">
      <caption>
        <title>Additional File 2</title>
        <p><bold>Correction of positional bias</bold>. <bold>A</bold>. Images show local averages of the fluorescence intensities across the area of a tile. The center of the tile is clearly brighter than the edges. <bold>B</bold>. After correction by lowess fit, the averages are visually more constant across the tile.</p>
      </caption>
      <media xlink:href="1471-2105-9-431-S2.png" mimetype="image" mime-subtype="png">
        <caption>
          <p>Click here for file</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="S3">
      <caption>
        <title>Additional File 3</title>
        <p><bold>Increased coverage of Rolexa data relative to Solexa data on a human sample</bold>. A complete sequencing lane (330 tiles) was analyzed with Rolexa and Solexa pipelines. The X axis represents the number of nucleotides covered by the sequences of a tile with Rolexa base-calling and the Y axis represents the ratio with the corresponding Solexa base-calling with tags restricted to 25 bases or the full 36 bases length.</p>
      </caption>
      <media xlink:href="1471-2105-9-431-S3.png" mimetype="image" mime-subtype="png">
        <caption>
          <p>Click here for file</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <sec>
      <title>Acknowledgements</title>
      <p>FN thanks the Swiss National Science Foundation grant no 3100A0-113617 for financial support. We are grateful to Carlo Rivolta for providing early access to his data. Part of the data analysis was performed on the Vital-IT high-performance computing facility of the Swiss Institute of Bioinformatics.</p>
    </sec>
  </ack>
  <ref-list>
    <ref id="B1">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bentley</surname>
            <given-names>DR</given-names>
          </name>
        </person-group>
        <article-title>Whole-genome re-sequencing</article-title>
        <source>Current Opinion in Genetics &amp; Development</source>
        <year>2006</year>
        <volume>16</volume>
        <fpage>545</fpage>
        <lpage>552</lpage>
        <pub-id pub-id-type="pmid">17055251</pub-id>
        <pub-id pub-id-type="doi">10.1016/j.gde.2006.10.009</pub-id>
      </citation>
    </ref>
    <ref id="B2">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chen</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Kalscheu</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Tzschach</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Menzel</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Ullmann</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Schulz</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Erdogan</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Kijas</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Arkesteijn</surname>
            <given-names>G</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Mapping translocation breakpoints by next-generation sequencing</article-title>
        <source>Genome Research</source>
        <year>2008</year>
        <pub-id pub-id-type="pmid">18326688</pub-id>
      </citation>
    </ref>
    <ref id="B3">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Korbel</surname>
            <given-names>JO</given-names>
          </name>
          <name>
            <surname>Urban</surname>
            <given-names>AE</given-names>
          </name>
          <name>
            <surname>Affourtit</surname>
            <given-names>JP</given-names>
          </name>
          <name>
            <surname>Godwin</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Grubert</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Simons</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Kim</surname>
            <given-names>PM</given-names>
          </name>
          <name>
            <surname>Palejev</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Carriero</surname>
            <given-names>NJ</given-names>
          </name>
          <name>
            <surname>Du</surname>
            <given-names>L</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Paired-end mapping reveals extensive structural variation in the human genome</article-title>
        <source>Science</source>
        <year>2007</year>
        <volume>318</volume>
        <fpage>420</fpage>
        <lpage>426</lpage>
        <pub-id pub-id-type="pmid">17901297</pub-id>
        <pub-id pub-id-type="doi">10.1126/science.1149504</pub-id>
      </citation>
    </ref>
    <ref id="B4">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hafner</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Landgraf</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Ludwig</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Rice</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Ojo</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Lin</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Holoch</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Lim</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Tuschl</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>Identification of microRNAs and other small regulatory RNAs using cDNA library sequencing</article-title>
        <source>Methods</source>
        <year>2008</year>
        <volume>44</volume>
        <fpage>3</fpage>
        <lpage>12</lpage>
        <pub-id pub-id-type="pmid">18158127</pub-id>
        <pub-id pub-id-type="doi">10.1016/j.ymeth.2007.09.009</pub-id>
      </citation>
    </ref>
    <ref id="B5">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Vera</surname>
            <given-names>JC</given-names>
          </name>
          <name>
            <surname>Wheat</surname>
            <given-names>CW</given-names>
          </name>
          <name>
            <surname>Fescemyer</surname>
            <given-names>HW</given-names>
          </name>
          <name>
            <surname>Frilander</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>Crawford</surname>
            <given-names>DL</given-names>
          </name>
          <name>
            <surname>Hanski</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Marden</surname>
            <given-names>JH</given-names>
          </name>
        </person-group>
        <article-title>Rapid transcriptome characterization for a nonmodel organism using 454 pyrosequencing</article-title>
        <source>Mol Ecol</source>
        <year>2008</year>
        <volume>17</volume>
        <fpage>1636</fpage>
        <lpage>1647</lpage>
        <pub-id pub-id-type="pmid">18266620</pub-id>
        <pub-id pub-id-type="doi">10.1111/j.1365-294X.2008.03666.x</pub-id>
      </citation>
    </ref>
    <ref id="B6">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Friedländer</surname>
            <given-names>MR</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Adamidi</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Maaskola</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Einspanier</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Knespel</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Rajewsky</surname>
            <given-names>N</given-names>
          </name>
        </person-group>
        <article-title>Discovering microRNAs from deep sequencing data using miRDeep</article-title>
        <source>Nat Biotechnol</source>
        <year>2008</year>
        <volume>26</volume>
        <fpage>407</fpage>
        <lpage>415</lpage>
        <pub-id pub-id-type="pmid">18392026</pub-id>
        <pub-id pub-id-type="doi">10.1038/nbt1394</pub-id>
      </citation>
    </ref>
    <ref id="B7">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mikkelsen</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Ku</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Jaffe</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Issac</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Lieberman</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Giannoukos</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Alvarez</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Brockman</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Kim</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Koche</surname>
            <given-names>R</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Genome-wide maps of chromatin state in pluripotent and lineage-committed cells</article-title>
        <source>Nature</source>
        <year>2007</year>
        <volume>448</volume>
        <fpage>553</fpage>
        <lpage>560</lpage>
        <pub-id pub-id-type="pmid">17603471</pub-id>
        <pub-id pub-id-type="doi">10.1038/nature06008</pub-id>
      </citation>
    </ref>
    <ref id="B8">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Barski</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Cuddapah</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Cui</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Roh</surname>
            <given-names>TY</given-names>
          </name>
          <name>
            <surname>Schones</surname>
            <given-names>DE</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Wei</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Chepelev</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Zhao</surname>
            <given-names>K</given-names>
          </name>
        </person-group>
        <article-title>High-resolution profiling of histone methylations in the human genome</article-title>
        <source>Cell</source>
        <year>2007</year>
        <volume>129</volume>
        <fpage>823</fpage>
        <lpage>837</lpage>
        <pub-id pub-id-type="pmid">17512414</pub-id>
        <pub-id pub-id-type="doi">10.1016/j.cell.2007.05.009</pub-id>
      </citation>
    </ref>
    <ref id="B9">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hernandez</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>François</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Farinelli</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Osterås</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Schrenzel</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>De novo bacterial genome sequencing: Millions of very short reads assembled on a desktop computer</article-title>
        <source>Genome Research</source>
        <year>2008</year>
        <volume>18</volume>
        <fpage>802</fpage>
        <lpage>809</lpage>
        <pub-id pub-id-type="pmid">18332092</pub-id>
        <pub-id pub-id-type="doi">10.1101/gr.072033.107</pub-id>
      </citation>
    </ref>
    <ref id="B10">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Margulies</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Egholm</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Altman</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Attiya</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Bader</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Bemben</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Berka</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Braverman</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>Z</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Genome sequencing in microfabricated high-density picolitre reactors</article-title>
        <source>Nature</source>
        <year>2005</year>
        <volume>437</volume>
        <fpage>376</fpage>
        <lpage>380</lpage>
        <pub-id pub-id-type="pmid">16056220</pub-id>
      </citation>
    </ref>
    <ref id="B11">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ewing</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Green</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>Base-calling of automated sequencer traces using phred. II. Error probabilities</article-title>
        <source>Genome Research</source>
        <year>1998</year>
        <volume>8</volume>
        <fpage>186</fpage>
        <lpage>194</lpage>
        <pub-id pub-id-type="pmid">9521922</pub-id>
      </citation>
    </ref>
    <ref id="B12">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cokus</surname>
            <given-names>SJ</given-names>
          </name>
          <name>
            <surname>Feng</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Merriman</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Haudenschild</surname>
            <given-names>CD</given-names>
          </name>
          <name>
            <surname>Pradhan</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Nelson</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Pellegrini</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Jacobsen</surname>
            <given-names>SE</given-names>
          </name>
        </person-group>
        <article-title>Shotgun bisulphite sequencing of the Arabidopsis genome reveals DNA methylation patterning</article-title>
        <source>Nature</source>
        <year>2008</year>
        <volume>452</volume>
        <fpage>215</fpage>
        <lpage>219</lpage>
        <pub-id pub-id-type="pmid">18278030</pub-id>
        <pub-id pub-id-type="doi">10.1038/nature06745</pub-id>
      </citation>
    </ref>
    <ref id="B13">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Erlich</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Mitra</surname>
            <given-names>PP</given-names>
          </name>
          <name>
            <surname>Delabastide</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>McCombie</surname>
            <given-names>WR</given-names>
          </name>
          <name>
            <surname>Hannon</surname>
            <given-names>GJ</given-names>
          </name>
        </person-group>
        <article-title>Alta-Cyclic: a self-optimizing base caller for next-generation sequencing</article-title>
        <source>Nat Methods</source>
        <year>2008</year>
        <pub-id pub-id-type="pmid">18604217</pub-id>
      </citation>
    </ref>
    <ref id="B14">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dohm</surname>
            <given-names>JC</given-names>
          </name>
          <name>
            <surname>Lottaz</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Borodina</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Himmelbauer</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>Substantial biases in ultra-short read data sets from high-throughput DNA sequencing</article-title>
        <source>Nucleic Acids Research</source>
        <year>2008</year>
        <pub-id pub-id-type="pmid">18660515</pub-id>
      </citation>
    </ref>
    <ref id="B15">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Smith</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Xuan</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Using quality scores and longer reads improves accuracy of Solexa read mapping</article-title>
        <source>BMC Bioinformatics</source>
        <year>2008</year>
        <volume>9</volume>
        <fpage>128</fpage>
        <pub-id pub-id-type="pmid">18307793</pub-id>
        <pub-id pub-id-type="doi">10.1186/1471-2105-9-128</pub-id>
      </citation>
    </ref>
    <ref id="B16">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dolan</surname>
            <given-names>PC</given-names>
          </name>
          <name>
            <surname>Denver</surname>
            <given-names>DR</given-names>
          </name>
        </person-group>
        <article-title>TileQC: a system for tile-based quality control of Solexa data</article-title>
        <source>BMC Bioinformatics</source>
        <year>2008</year>
        <volume>9</volume>
        <fpage>250</fpage>
        <pub-id pub-id-type="pmid">18507856</pub-id>
        <pub-id pub-id-type="doi">10.1186/1471-2105-9-250</pub-id>
      </citation>
    </ref>
    <ref id="B17">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yakovchuk</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Protozanova</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Frank-Kamenetskii</surname>
            <given-names>MD</given-names>
          </name>
        </person-group>
        <article-title>Base-stacking and base-pairing contributions into thermal stability of the DNA double helix</article-title>
        <source>Nucleic Acids Research</source>
        <year>2006</year>
        <volume>34</volume>
        <fpage>564</fpage>
        <lpage>574</lpage>
        <pub-id pub-id-type="pmid">16449200</pub-id>
        <pub-id pub-id-type="doi">10.1093/nar/gkj454</pub-id>
      </citation>
    </ref>
    <ref id="B18">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cleveland</surname>
            <given-names>WS</given-names>
          </name>
        </person-group>
        <article-title>Robust locally weighted regression and smoothing scatterplots</article-title>
        <source>J Amer Statist Assoc</source>
        <year>1979</year>
        <volume>74</volume>
        <fpage>829</fpage>
        <lpage>836</lpage>
        <pub-id pub-id-type="doi">10.2307/2286407</pub-id>
      </citation>
    </ref>
    <ref id="B19">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Banfield</surname>
            <given-names>JD</given-names>
          </name>
          <name>
            <surname>Raftery</surname>
            <given-names>AE</given-names>
          </name>
        </person-group>
        <article-title>Model-based Gaussian and non-Gaussian clustering</article-title>
        <source>Biometrics</source>
        <year>1993</year>
        <volume>49</volume>
        <fpage>803</fpage>
        <lpage>821</lpage>
        <pub-id pub-id-type="doi">10.2307/2532201</pub-id>
      </citation>
    </ref>
    <ref id="B20">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Fraley</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Raftery</surname>
            <given-names>AE</given-names>
          </name>
        </person-group>
        <article-title>MCLUST: Software for model-based cluster analysis</article-title>
        <source>J Classification</source>
        <year>1999</year>
        <volume>16</volume>
        <fpage>297</fpage>
        <lpage>306</lpage>
        <pub-id pub-id-type="doi">10.1007/s003579900058</pub-id>
      </citation>
    </ref>
    <ref id="B21">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Fraley</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Raftery</surname>
            <given-names>AE</given-names>
          </name>
        </person-group>
        <article-title>Model-based clustering, discriminant analysis, and density estimation</article-title>
        <source>J Amer Statist Assoc</source>
        <year>2002</year>
        <volume>97</volume>
        <fpage>611</fpage>
        <lpage>631</lpage>
        <pub-id pub-id-type="doi">10.1198/016214502760047131</pub-id>
      </citation>
    </ref>
    <ref id="B22">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Fraley</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Raftery</surname>
            <given-names>AE</given-names>
          </name>
        </person-group>
        <article-title>Enhanced model-based clustering, density estimation, and discriminant analysis software: MCLUST</article-title>
        <source>J Classification</source>
        <year>2003</year>
        <volume>20</volume>
        <fpage>263</fpage>
        <lpage>286</lpage>
        <pub-id pub-id-type="doi">10.1007/s00357-003-0015-3</pub-id>
      </citation>
    </ref>
    <ref id="B23">
      <citation citation-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Cover</surname>
            <given-names>TM</given-names>
          </name>
          <name>
            <surname>Thomas</surname>
            <given-names>JA</given-names>
          </name>
        </person-group>
        <source>Elements of Information Theory</source>
        <year>1991</year>
        <publisher-name>John Wiley</publisher-name>
      </citation>
    </ref>
    <ref id="B24">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Iseli</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Ambrosini</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Bucher</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Jongeneel</surname>
            <given-names>CV</given-names>
          </name>
        </person-group>
        <article-title>Indexing strategies for rapid searches of short words in genome sequences</article-title>
        <source>PLoS ONE</source>
        <year>2007</year>
        <volume>2</volume>
        <fpage>e579</fpage>
        <pub-id pub-id-type="pmid">17593978</pub-id>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0000579</pub-id>
      </citation>
    </ref>
    <ref id="B25">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Myers</surname>
            <given-names>EW</given-names>
          </name>
          <name>
            <surname>Miller</surname>
            <given-names>W</given-names>
          </name>
        </person-group>
        <article-title>Optimal alignments in linear space</article-title>
        <source>Comput Appl Biosci</source>
        <year>1988</year>
        <volume>4</volume>
        <fpage>11</fpage>
        <lpage>17</lpage>
        <pub-id pub-id-type="pmid">3382986</pub-id>
      </citation>
    </ref>
    <ref id="B26">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Smith</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Xuan</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Using quality scores and longer reads improves accuracy of Solexa read mapping</article-title>
        <source>BMC Bioinformatics</source>
        <year>2008</year>
        <volume>9</volume>
        <fpage>128</fpage>
        <pub-id pub-id-type="pmid">18307793</pub-id>
        <pub-id pub-id-type="doi">10.1186/1471-2105-9-128</pub-id>
      </citation>
    </ref>
    <ref id="B27">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ferragina</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Manzini</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Mäkinen</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Navarro</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>Compressed representations of sequences and full-text indexes</article-title>
        <source>ACM Transactions on Algorithms (TALG)</source>
        <year>2007</year>
        <volume>3</volume>
      </citation>
    </ref>
    <ref id="B28">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gräf</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Nielsen</surname>
            <given-names>FG</given-names>
          </name>
          <name>
            <surname>Kurtz</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Huynen</surname>
            <given-names>MA</given-names>
          </name>
          <name>
            <surname>Birney</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Stunnenberg</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Flicek</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>Optimized design and assessment of whole genome tiling arrays</article-title>
        <source>Bioinformatics</source>
        <year>2007</year>
        <volume>23</volume>
        <fpage>i195</fpage>
        <lpage>204</lpage>
        <pub-id pub-id-type="pmid">17646297</pub-id>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btm200</pub-id>
      </citation>
    </ref>
    <ref id="B29">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pop</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Salzberg</surname>
            <given-names>SL</given-names>
          </name>
        </person-group>
        <article-title>Bioinformatics challenges of new sequencing technology</article-title>
        <source>Trends Genet</source>
        <year>2008</year>
        <volume>24</volume>
        <fpage>142</fpage>
        <lpage>149</lpage>
        <pub-id pub-id-type="pmid">18262676</pub-id>
      </citation>
    </ref>
    <ref id="B30">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hinds</surname>
            <given-names>DA</given-names>
          </name>
          <name>
            <surname>Stuve</surname>
            <given-names>LL</given-names>
          </name>
          <name>
            <surname>Nilsen</surname>
            <given-names>GB</given-names>
          </name>
          <name>
            <surname>Halperin</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Eskin</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Ballinger</surname>
            <given-names>DG</given-names>
          </name>
          <name>
            <surname>Frazer</surname>
            <given-names>KA</given-names>
          </name>
          <name>
            <surname>Cox</surname>
            <given-names>DR</given-names>
          </name>
        </person-group>
        <article-title>Whole-genome patterns of common DNA variation in three human populations</article-title>
        <source>Science</source>
        <year>2005</year>
        <volume>307</volume>
        <fpage>1072</fpage>
        <lpage>1079</lpage>
        <pub-id pub-id-type="pmid">15718463</pub-id>
        <pub-id pub-id-type="doi">10.1126/science.1105436</pub-id>
      </citation>
    </ref>
  </ref-list>
</back>
