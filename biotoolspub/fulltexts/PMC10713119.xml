<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10713119</article-id>
    <article-id pub-id-type="pmid">38060267</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btad727</article-id>
    <article-id pub-id-type="publisher-id">btad727</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Original Paper</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Genome Analysis</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01060</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>LMdist: Local Manifold distance accurately measures beta diversity in ecological gradients</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0001-5273-5795</contrib-id>
        <name>
          <surname>Hoops</surname>
          <given-names>Susan L</given-names>
        </name>
        <aff><institution>Department of Computer Science and Engineering, College of Science and Engineering, University of Minnesota</institution>, Minneapolis, MN 55455, <country country="US">United States</country></aff>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-8205-2511</contrib-id>
        <name>
          <surname>Knights</surname>
          <given-names>Dan</given-names>
        </name>
        <aff><institution>Department of Computer Science and Engineering, College of Science and Engineering, University of Minnesota</institution>, Minneapolis, MN 55455, <country country="US">United States</country></aff>
        <aff><institution>BioTechnology Institute, College of Biological Sciences, University of Minnesota</institution>, Saint Paul, MN 55108, <country country="US">United States</country></aff>
        <xref rid="btad727-cor1" ref-type="corresp"/>
        <!--dknights@umn.edu-->
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Marschall</surname>
          <given-names>Tobias</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="btad727-cor1">Corresponding author. Department of Computer Science &amp; Engineering, University of Minnesota, 4-192 Keller Hall, 200 Union Street SE, Minneapolis, Minnesota 55455, United States. E-mail: <email>dknights@umn.edu</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <month>12</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2023-12-07">
      <day>07</day>
      <month>12</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>07</day>
      <month>12</month>
      <year>2023</year>
    </pub-date>
    <volume>39</volume>
    <issue>12</issue>
    <elocation-id>btad727</elocation-id>
    <history>
      <date date-type="received">
        <day>11</day>
        <month>5</month>
        <year>2023</year>
      </date>
      <date date-type="rev-recd">
        <day>07</day>
        <month>11</month>
        <year>2023</year>
      </date>
      <date date-type="editorial-decision">
        <day>08</day>
        <month>11</month>
        <year>2023</year>
      </date>
      <date date-type="accepted">
        <day>06</day>
        <month>12</month>
        <year>2023</year>
      </date>
      <date date-type="corrected-typeset">
        <day>11</day>
        <month>12</month>
        <year>2023</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2023. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2023</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btad727.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Motivation</title>
        <p>Differentiating ecosystems poses a complex, high-dimensional problem constrained by capturing relevant variation across species profiles. Researchers use pairwise distances and subsequent dimensionality reduction to highlight variation in a few dimensions. Despite popularity in analysis of ecological data, these low-dimensional visualizations can contain geometric abnormalities such as “arch” and “horseshoe” effects, potentially obscuring the impact of environmental gradients. These abnormalities appear in ordination but are in fact a product of oversaturated large pairwise distances.</p>
      </sec>
      <sec id="s2">
        <title>Results</title>
        <p>We present Local Manifold distance (LMdist), an unsupervised algorithm which adjusts pairwise beta diversity measures to better represent true ecological distances between samples. Beta diversity measures can have a bounded dynamic range in depicting long environmental gradients with high species turnover. Using a graph structure, LMdist projects pairwise distances onto a manifold and traverses the manifold surface to adjust pairwise distances at the upper end of the beta diversity measure’s dynamic range. This allows for values beyond the range of the original measure. Not all datasets will have oversaturated pairwise distances, nor will capture variation that resembles a manifold, so LMdist adjusts only those pairwise values which may be undervalued in the presence of a sampled gradient. The adjusted distances serve as input for ordination and statistical testing. We demonstrate on real and simulated data that LMdist effectively recovers distances along known gradients and along complex manifolds such as the Swiss roll dataset. LMdist enables more powerful statistical tests for gradient effects and reveals variation orthogonal to the gradient.</p>
      </sec>
      <sec id="s3">
        <title>Availability and implementation</title>
        <p>Available on GitHub at <ext-link xlink:href="https://github.com/knights-lab/LMdist" ext-link-type="uri">https://github.com/knights-lab/LMdist</ext-link>.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>NIH</institution>
            <institution-id institution-id-type="DOI">10.13039/100000002</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>R01AI121383</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Minnesota Partnership for Biotechnology and Medical Genomics</institution>
          </institution-wrap>
        </funding-source>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="8"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>Beta diversity is a standard component of microbial and community ecology analysis. Ordination plots can be found in many microbiome and ecology publications. Geometric anomalies like the arch or horseshoe effects are prevalent in ordination plots of datasets containing an ecological gradient. Ecological gradients could include geochemistry, temperature, altitude, time, or other continuous factors. The arch effect displays samples along the gradient in a curved formation during ordination such that the gradient no longer appears 1D. The horseshoe effect, also referred to as the Guttman effect, is the more extreme relative of the arch effect and displays the samples along an ecological gradient in, as the name suggests, a horseshoe-like shape. Thus, in the horseshoe effect, ends of the gradient appear attracted to one another (<xref rid="btad727-B3" ref-type="bibr">Camiz 2005</xref>). In the early 1980s, ecologists hypothesized the extreme arch was a mathematical artifact obscuring ecological gradients (<xref rid="btad727-B7" ref-type="bibr">Hill and Gauch 1980</xref>), adopting the term “horseshoe” from popular political theory discourse.</p>
    <p>The arch and horseshoe effects are of concern for beta diversity analyses because they misrepresent the true ecological distances between samples lying along ecological gradients. <xref rid="btad727-F1" ref-type="fig">Figure 1</xref> illustrates an arch in soil samples taken along a pH gradient (<xref rid="btad727-B8" ref-type="bibr">Lauber <italic toggle="yes">et al.</italic> 2009</xref>). The pH gradient is clearly visible along the arched display of samples, but the arch makes the ends of the gradient (black squares for acidic pH, white diamonds for basic pH) appear almost as closely related to each other as to the middle of the pH gradient. It has been shown previously that this arch phenomenon is not caused by the ordination or visualization (<xref rid="btad727-B10" ref-type="bibr">Morton <italic toggle="yes">et al.</italic> 2017</xref>), but is instead a problem with the pairwise dissimilarities generating the ordination. Pairwise dissimilarities are the foundation of distance-based statistical analyses for beta diversity, so statistical outcomes may be weakened by pairwise measures misrepresenting sample relationships.</p>
    <fig position="float" id="btad727-F1">
      <label>Figure 1.</label>
      <caption>
        <p>PCoA with Jaccard distances of soil samples taken along a geochemical pH gradient. An arch in the data is clearly visible, making the ends of the pH gradient appear closer than expected.</p>
      </caption>
      <graphic xlink:href="btad727f1" position="float"/>
    </fig>
    <p>Despite a relatively high frequency of arches and horseshoes present in beta diversity analyses, these artifacts remain relatively underexplored and misunderstood in microbial ecology literature. A limited body of prior work has sought to explain and exemplify the problem as it appears. Ecologists Podani and Miklós explored the tendency of various distance and dissimilarity measures to result in a horseshoe shape in PCoA plots (<xref rid="btad727-B15" ref-type="bibr">Podani and Miklós 2002</xref>). Their findings indicated that researchers should select distance and dissimilarity measures which do not result in the arch, but their work lacks specificity about the causes or a notable solution. <xref rid="btad727-B4" ref-type="bibr">Diaconis <italic toggle="yes">et al.</italic> (2008)</xref> indicate some arches may be true representations, but that PCoA is limited in portraying them, and that manifold learning methods for ordination are better suited to data portraying an arch or horseshoe. Still, reasoning about the origin of the arch artifact was lacking until the work of <xref rid="btad727-B10" ref-type="bibr">Morton <italic toggle="yes">et al.</italic> (2017)</xref> pointed to sparsity of microbiome datasets as a possible source. <xref rid="btad727-B10" ref-type="bibr">Morton <italic toggle="yes">et al.</italic> (2017)</xref> demonstrate the limitations of distance and dissimilarity metrics in sparse datasets, although their solution, the Earth Mover Band Aware Distance (EMBAD) metric, is designed to rely upon known metadata in adjusting the ordination. EMBAD starts by sorting the samples according to a predetermined environmental variable, then simulating the flow of the taxonomic features between the samples along this ordered list. The EMBAD metric resolves the arched geometry with this adjustment but requires foreknowledge of the ecological gradient and direct use of this gradient in evaluating pairwise distances.</p>
    <p>Building on this existing body of work, we hypothesize that distance and dissimilarity metrics have a bounded dynamic range in describing pairwise relationships of a dataset, leading to an oversaturation of large pairwise measures. This effect is caused by samples that are sufficiently separated along the ecological gradient such that they have few or no species in common. Pairwise relationships are more reliable with many species in common, so samples from opposite ends of the gradient will instead have less informative pairwise distances to distinguish them. Upper bounds are known for some popular measures, such as Bray–Curtis and Jaccard dissimilarity which are restricted between zero and one. In these measures, counts of a subset of features will never exceed the total feature counts for a sample. Distance metrics, among them Euclidean distance, Aitchison distances, and UniFrac distances, are unbounded but may oversaturate in the same manner as bounded measures when there are few features in common. Euclidean distances are already known to be a poor choice for sparse datasets, common for microbial ecology (<xref rid="btad727-B1" ref-type="bibr">Aggarwal <italic toggle="yes">et al.</italic> 2001</xref>). When these large pairwise distances or dissimilarities become oversaturated, ordination algorithms may be limited in differentiating samples in a reduced dimensional space, leading to arches and horseshoes.</p>
    <p>Given our hypothesis that the bounded dynamic range of beta diversity measures cause arch and horseshoe effects, we propose Local Manifold distance (LMdist) for adjusting distances and dissimilarities to overcome the limited range of ecological distance measures in sparse datasets. LMdist borrows concepts from graph theory and statistics to better represent the high dimensional geometries of gradient-based datasets. LMdist not only corrects arches and horseshoes in ordination plots but improves the reliability of the underlying pairwise measures for downstream analyses such as statistical hypothesis testing.</p>
  </sec>
  <sec>
    <title>2 Materials and methods</title>
    <sec>
      <title>2.1 Local Manifold distance (LMdist) algorithm</title>
      <p>The LMdist algorithm represents the high dimensional beta diversity matrix as a graph, then measures distances between points along the graph-defined manifold. <xref rid="btad727-F2" ref-type="fig">Figure 2</xref> visually depicts the algorithm on a small simulated gradient dataset. Beginning with an undirected graph of nodes, representing samples, edges are drawn between sample nodes and their parameter-defined neighbors. Each edge is weighted by the distance/dissimilarity between samples at either end, compatible with any pairwise beta diversity measure. Some pairwise edges will be omitted from the graph if they are above the parameterized maximum value, called the neighborhood radius. The graph is then traversed to determine adjusted pairwise values. These adjusted values become the new input for ordination and subsequent statistical analysis, resolving the arch in ordinal plots and enabling more powerful linear regression.</p>
      <fig position="float" id="btad727-F2">
        <label>Figure 2.</label>
        <caption>
          <p>Visual representation of the LMdist algorithm. (A) Simulated samples appearing in an arch during PCoA with Bray–Curtis distances, colored by a simulated ecological gradient. (B) We represent these same samples as isolated nodes and define a neighborhood size by a radius parameter, then (C) add undirected edges between nodes within the parameter-defined neighborhood. (D) Continue to add edges between nodes in common neighborhoods until the graph is fully connected, all nodes can be reached by all other nodes. (E) This graph of nodes and edges is traversed to create adjusted pairwise values, which become the new input for ordination. (F) The resulting ordination can resolve the linear gradient in PCoA.</p>
        </caption>
        <graphic xlink:href="btad727f2" position="float"/>
      </fig>
      <sec>
        <title>2.1.1 Input pairwise measures form a connected graph</title>
        <p>The only required input for the LMdist algorithm is the original pairwise beta diversity matrix; the radius parameter allows for further fine-tuning of the algorithm. The algorithm is compatible with any pairwise measure, and LMdist will adjust these measures to produce a new set of pairwise distances. The neighborhood radius parameter determines which input pairwise values will be included in forming the undirected graph (<xref rid="btad727-F2" ref-type="fig">Fig. 2B and C</xref>). For example, given a radius value of 0.25, only pairwise values under 0.25 will be used to connect sample nodes in the graph. Therefore, we can think of the radius parameter as the radius of a sphere in the original beta diversity space, centered at any given sample node. All other sample nodes falling within the bounds of this sphere will be connected to the centroid node as they are considered “neighbors.” Each sample node will be the centroid for this process, until all nodes have been considered and connected to any neighbors to form edges in the graph (<xref rid="btad727-F2" ref-type="fig">Fig. 2D</xref>).</p>
        <p>After the neighborhood edges have been determined per node using a given radius, the resulting graph may be a disconnected graph. This is expected when samples have not been collected evenly along a gradient, or if the chosen radius is small. If disconnected, a minimum spanning tree (MST) is computed using original pairwise distances for all sample nodes, which traverses all nodes in the shortest possible path. Comparing this MST to the graph of neighbor edges, we can borrow minimal edges from the MST to make the graph fully connected. As a result, we will have a fully connected graph where the minimum possible number of edges exceed the radius parameter, as needed to fully connect the graph.</p>
      </sec>
      <sec>
        <title>2.1.2 Recalculate pairwise distances by traversing the graph</title>
        <p>This connected graph is used to recalculate pairwise distances/dissimilarities between samples. We calculate a single pairwise distance by traversing from one sample node along any available edges to the other node, in the shortest possible path (<xref rid="btad727-F2" ref-type="fig">Fig. 2E</xref>). The adjusted pairwise value is then the sum of all edges traversed in this shortest path between two nodes. This traversal is completed for all pairs of sample nodes, such that we have adjusted pairwise values for any sample relationships exceeding the trusted, radius-defined neighborhood.</p>
      </sec>
      <sec>
        <title>2.1.3 Parameters can fine-tune results of LMdist</title>
        <p>Fine-tuning of LMdist can be achieved by adjusting the radius parameter, calibrating optimization criteria, or smoothing results via a Gaussian weighting. A large radius, close to the maximum distance, results in a very small adjustment to the original distance matrix. Conversely, a very small radius will cause the largest adjustment, because distant nodes will be connected in the graph only by traversing many intermediate nodes.</p>
        <p>By default, the algorithm calculates LMdist using 50 different radii, picking the largest radius which meets two optimization criteria. First, any radius which results in a graph with an average degree, the average number of connections per node, &lt;10% of the number of samples (parameterized as “phi” with default 0.10) will be excluded from the results of LMdist. This limitation is intended to avoid overfitting, resulting in a distorted graph that might exaggerate the distances between samples. The second criterion is a multi-objective function which allows LMdist to guess the best radial value for a given dataset. This multi-objective optimization maximizes both the radius and a correlation between the LMdist-adjusted distances and the Euclidean distances in resulting ordination (PCoA) space, using the first <italic toggle="yes">n</italic> dimensions, up to 10, accounting for &gt;80% variance. To give priority to trusting more original distances, a correlation for a smaller radius must exceed the previous best correlation by a parameterized value of epsilon (default 0.05).</p>
        <p>The multi-objective function works for many cases, but still places confidence in a single radius value. We therefore implemented an optional parameter (“smooth” defaulted to False) for smoothing results of multiple radii. If smoothing is preferred, a Gaussian weight centered at the chosen radius is applied to the results of up to 50 radii, such that many radial values will influence the results, generating a smoothed version of the corrected pairwise distances.</p>
      </sec>
      <sec>
        <title>2.1.4 LMdist produces an adjusted distance matrix</title>
        <p>The result of the LMdist algorithm, implemented in R (<xref rid="btad727-B16" ref-type="bibr">R Core Team 2021</xref>), is an adjusted pairwise distance object, the same format as the output of the vegdist function in the vegan package (<xref rid="btad727-B12" ref-type="bibr">Oksanen <italic toggle="yes">et al.</italic> 2022</xref>). These adjusted values can replace the original pairwise distance matrix in subsequent beta diversity analysis. In ordination, the adjusted values become the new input for ordinal methods accepting pairwise measures, such as PCoA or NMDS. Results in a simulated dataset and case studies have shown that LMdist reduces the arched appearance of the data, and if an environmental gradient is present LMdist better resolves the gradient, revealing variation orthogonal to the gradient in other ordinal dimensions.</p>
      </sec>
      <sec>
        <title>2.1.5 Use cases have oversaturated distances</title>
        <p>LMdist can be used with any pairwise distance matrix but is best utilized for uncovering gradients. While some gradients may already be well represented, an arch or horseshoe in ordination tends to appear when the pairwise distance matrices become oversaturated. We define oversaturated distances as a large left skew in the distribution of pairwise distances, because large distances are relatively oversaturated compared to the smaller pairwise distances. This oversaturation indicates a disagreement between the sampled gradient and the pairwise sample distances, as is demonstrated in implementation with a simulated dataset to follow (<xref rid="btad727-F4" ref-type="fig">Fig. 4</xref>). Therefore, we propose LMdist is most appropriately used in studies with a long underlying gradient or oversaturated distances, as these samples will be better represented when accounting for the underlying manifold. Case-control studies may not need adjustment by LMdist, most importantly if the pairwise distances are not oversaturated with large values.</p>
      </sec>
    </sec>
    <sec>
      <title>2.2 Simulated dataset</title>
      <p>For initial validation of this algorithm, we created a simulated dataset of taxonomic features evenly distributed along an artificial gradient, mimicking a gradient-driven ecosystem. The final simulated dataset contains 50 samples and 231 taxonomic features. Noisy samples added to the dataset illustrate the sensitivity of the algorithm, which has remained stable in uncovering the gradient.</p>
      <sec>
        <title>2.2.1 Coenoclines emulate species abundance along a gradient</title>
        <p>In creating a simulated dataset we utilized coenoclines, representations of species response functions along some gradient (<xref rid="btad727-B13" ref-type="bibr">Palmer 2013</xref>). We presumed a unimodal response curve for each species along the gradient, supported by further exploration of the soil dataset (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S1</xref>). For our simulated gradient, we distributed artificial species features evenly along a gradient, using Gaussian coenoclines (<xref rid="btad727-F3" ref-type="fig">Fig. 3A</xref>). For an example gradient length of 1000 (arbitrary units), the artificial species distributions are simulated as Gaussian curves centered 10 steps apart with a standard deviation of 150, allowing for density of overlap between species. Samples are obtained from these coenoclines by sampling values from the densities of the Gaussian curves at a given point, attributing the amounts of every artificial species at that point in the gradient to the sample (<xref rid="btad727-F3" ref-type="fig">Fig. 3A</xref>). A total of 50 samples are taken, evenly distributed along the full gradient length. The absolute heights of the Gaussian coenoclines are arbitrary because samples are normalized to relative abundances before analysis.</p>
        <fig position="float" id="btad727-F3">
          <label>Figure 3.</label>
          <caption>
            <p>Creation of simulated dataset. (A) Coenoclines representing roughly every 10th taxonomic feature distributed along the simulated gradient, annotated to show how sample 10 would be collected. Sample 10 would be comprised of the amounts of each feature as seen in the visual cross section of the feature coenoclines. (B) Heatmap of samples collected, displayed in order with the noise samples preceding each original sample.</p>
          </caption>
          <graphic xlink:href="btad727f3" position="float"/>
        </fig>
      </sec>
      <sec>
        <title>2.2.2 Sampling noise from a Dirichlet distribution</title>
        <p>To add noise to the simulated dataset, each mixture of sampled species values is used as the prior for a Dirichlet distribution, the generative distribution of the multinomial distribution and the multivariate generalization of the Beta distribution (<xref rid="btad727-B11" ref-type="bibr">Ng <italic toggle="yes">et al.</italic> 2011</xref>), producing 50 additional samples as noise, mimicking the original samples (<xref rid="btad727-F3" ref-type="fig">Fig. 3B</xref>). We chose the Dirichlet distribution because it allows for fine-tuning the degree of noise and because microbial ecology samples have been modeled previously using a Dirichlet distribution (<xref rid="btad727-B6" ref-type="bibr">Harrison <italic toggle="yes">et al.</italic> 2020</xref>).</p>
      </sec>
    </sec>
  </sec>
  <sec>
    <title>3 Results</title>
    <sec>
      <title>3.1 Simulated gradient</title>
      <p><xref rid="btad727-F4" ref-type="fig">Figure 4</xref> shows the simulated dataset after application of the LMdist algorithm to adjust distances. In the original Bray–Curtis distances, we can see from <xref rid="btad727-F4" ref-type="fig">Fig. 4B</xref> that the Bray–Curtis distances on the <italic toggle="yes">y</italic>-axis are distributed with the opposite skew of the known gradient distances on the <italic toggle="yes">x</italic>-axis, resulting in a plateau rather than the expected <italic toggle="yes">y</italic> = <italic toggle="yes">x</italic> line. This oversaturation of large distances results in the samples forming a horseshoe in PCoA ordination (<xref rid="btad727-F4" ref-type="fig">Fig. 4A</xref>). After applying LMdist with a radius of 0.4, the gradient distances and adjusted distances now resemble one another (<xref rid="btad727-F4" ref-type="fig">Fig. 4D</xref>) and the gradient is resolved in PCoA along the first principal component (Pearson correlation 0.999, improved from 0.967 prior to LMdist) such that the second axis may now be accounting for noise (Levene’s test of variance, <italic toggle="yes">P </italic>&lt;<italic toggle="yes"> </italic>.001) (<xref rid="btad727-F4" ref-type="fig">Fig. 4C</xref>).</p>
      <fig position="float" id="btad727-F4">
        <label>Figure 4.</label>
        <caption>
          <p>LMdist applied to the simulated gradient. (A) PCoA with Bray–Curtis distances of 100 simulated samples, colored by approximate position on gradient. (B) Comparison plot of community distances (Bray–Curtis) and gradient distances (Euclidean). We can see the community distances plateau at the top of the gradient, causing a mismatch between the density of community and gradient distances. (C) PCoA with LMdist-adjusted distances, where the horseshoe is largely resolved along the first principal component. (D) The same comparison plot between the adjusted community distances and gradient distances, the distribution of which is better balanced to one another after LMdist is applied.</p>
        </caption>
        <graphic xlink:href="btad727f4" position="float"/>
      </fig>
    </sec>
    <sec>
      <title>3.2 Simulated Swiss roll</title>
      <p>The Swiss roll dataset has been used to exemplify an obvious low-dimensional manifold structure in demonstrating manifold learning approaches. <xref rid="btad727-F5" ref-type="fig">Figure 5</xref> shows 300 samples in a Swiss roll, created using the scikit-learn python package (<xref rid="btad727-B14" ref-type="bibr">Pedregosa <italic toggle="yes">et al.</italic> 2011</xref>), in the original three dimensions. We then compare to dimensionality reduction by principal component analysis (PCA), t-distributed Stochastic Neighbor Embedding (t-SNE) (<xref rid="btad727-B17" ref-type="bibr">Van der Maaten and Hinton 2008</xref>), Isomap (<xref rid="btad727-B2" ref-type="bibr">Balasubramanian and Schwartz 2002</xref>), and LMdist. Fine-tuning of parameters was necessary for all algorithms to obtain the best possible flattening of the manifold in 2D space.</p>
      <fig position="float" id="btad727-F5">
        <label>Figure 5.</label>
        <caption>
          <p>LMdist applied to the Swiss roll dataset. (A) The Swiss roll dataset with 300 samples in the original 3 dimensions, created with the scikit-learn package in Python. (B) PCA of the Swiss roll dataset. (C) t-SNE of the Swiss roll dataset using perplexity 60. (D) Isomap of Swiss roll dataset with neighborhood size 5. (E) LMdist of Swiss roll dataset with neighborhood radius 0.62.</p>
        </caption>
        <graphic xlink:href="btad727f5" position="float"/>
      </fig>
      <p>As expected, the manifold learning approaches and LMdist outperform PCA, due to their parameter-defined perplexity and ability to recover some of the underlying structure of the data. LMdist proves particularly useful in two respects compared to these manifold learning approaches. First, LMdist appears to most reliably uncover sample relationships, as it is not overly sensitive to hyperparameters and a series of transformations as is the case of t-SNE, nor does LMdist assume neighborhoods of equal sample sizes as in Isomap. The neighborhood radius used by LMdist therefore resolves the manifold, but also more clearly resolves the variation along the manifold in the second dimension. Secondly, LMdist is advantageous as the only approach to outputs an actual distance matrix, which can then be used for distance-based statistical testing. Typically, the adjusted distance matrix is only implicit within manifold learning algorithms, precluding their use in downstream analysis such as statistical testing of beta diversity.</p>
    </sec>
    <sec>
      <title>3.3 Case studies demonstrating the arch effect</title>
      <p>To exemplify the usefulness of the LMdist algorithm, we have gathered datasets from a variety of microbiome and ecological studies (<xref rid="btad727-F6" ref-type="fig">Fig. 6</xref>). As previously described, oversaturation of the distance and dissimilarity measures is often driven by underlying ecological gradients in the dataset. Therefore, datasets were selected which have a measurable environmental gradient and which exhibited an arch or horseshoe in ordination.</p>
      <fig position="float" id="btad727-F6">
        <label>Figure 6.</label>
        <caption>
          <p>PCoAs before and after adjusting pairwise values with LMdist on default settings, displayed with fixed square perspective. (A) Soil samples along a pH gradient, Jaccard dissimilarity and LMdist with radius 0.952. (B) Microbial mat samples at various depths, Jaccard dissimilarity and LMdist with radius 0.758. (C) Longitudinal Turkey cecum samples, Bray–Curtis dissimilarity and LMdist with radius 0.599 (note: changed epsilon to 0.01 since the default epsilon was too small). (D) Herbs and shrubs community data collected by Robert Whittaker in the Siskiyou Mountains, Bray–Curtis dissimilarity and LMdist with radius 0.93.</p>
        </caption>
        <graphic xlink:href="btad727f6" position="float"/>
      </fig>
      <p>First, we return to the soil samples from across North and South America comprising a pH gradient (<xref rid="btad727-F6" ref-type="fig">Fig. 6A</xref>). Lauber <italic toggle="yes">et al.</italic> found these bacterial communities to be significantly correlated with soil pH (ANOSIM, <italic toggle="yes">P </italic>=<italic toggle="yes"> </italic>.001; Mantel test Spearman, <italic toggle="yes">r</italic> = 0.73), largely driven by the presence and absence of the phylum <italic toggle="yes">Acidobacteria</italic>, known to favor acidic environments, as well as the phyla <italic toggle="yes">Bacteroidetes</italic> and <italic toggle="yes">Actinobacteria</italic> which prefer comparatively basic environments (<xref rid="btad727-B8" ref-type="bibr">Lauber <italic toggle="yes">et al.</italic> 2009</xref>). After applying LMdist, we can see that the arch is largely resolved in the visualization, with no change in significance of distance-based testing (ANOSIM, <italic toggle="yes">P</italic> = .001; Mantel test Spearman, <italic toggle="yes">r</italic> = 0.74). Interestingly, though, we find that PC2 now resolves some variation in the data orthogonal to the pH gradient in PC1, correlating with amount of silt clay (Pearson cor = 0.51, <italic toggle="yes">P </italic>&lt;<italic toggle="yes"> </italic>.001; PERMANOVA, <italic toggle="yes">P </italic>&lt;<italic toggle="yes"> </italic>.001) and annual season temperature (Pearson cor = 0.49, <italic toggle="yes">P </italic>&lt;<italic toggle="yes"> </italic>.001; PERMANOVA, <italic toggle="yes">P </italic>&lt;<italic toggle="yes"> </italic>.001). While silt clay and annual season temperature were significant prior to LMdist using PERMANOVA (<italic toggle="yes">P </italic>&lt;<italic toggle="yes"> </italic>.05), <italic toggle="yes">F</italic>-scores for silt clay, annual season temperature, and pH all increased, implying the effect size is better represented after application of LMdist. This new finding with silt clay and annual season temperature orthogonal to the pH gradient was not mentioned in the original publication and might have been obscured by the arch in the original analysis.</p>
      <p>Sampling increasing depths of the hypersaline microbial mats of Guerrero Negro in Baja California Sur provides another gradient analysis on a smaller dataset. The authors confirm that the depths of microbial mats are phylogenetically stratified, as light and oxygen produced by photosynthesis rapidly diminishes with depth (<xref rid="btad727-B5" ref-type="bibr">Harris <italic toggle="yes">et al.</italic> 2013</xref>). Each depth from the top of the microbial mat to a depth of 34 mm is sampled twice and sequenced with 454 pyrosequencing technology. We can clearly make out that the depths follow a horseshoe pattern in the original ordination (<xref rid="btad727-F6" ref-type="fig">Fig. 6B</xref>). Using LMdist, we can resolve the horseshoe while trusting many distances (neighborhood radius 0.758 for Jaccard dissimilarity is chosen by the default algorithm) (<xref rid="btad727-F6" ref-type="fig">Fig. 6B</xref>). The correlation of the gradient with the first principal component (Spearman rho = 0.941, <italic toggle="yes">P </italic>&lt;<italic toggle="yes"> </italic>.001) improved after application of LMdist without changing significance (Pearson cor = 0.987, <italic toggle="yes">P </italic>&lt;<italic toggle="yes"> </italic>.001).</p>
      <p>Our next case study is a longitudinal, observational experiment comparing the Turkey gut when raised in an isolated hatch brood system as opposed to a commercial brood pen (<xref rid="btad727-F6" ref-type="fig">Fig. 6C</xref>) (<xref rid="btad727-B9" ref-type="bibr">Miller <italic toggle="yes">et al.</italic> 2021</xref>). Ignoring the first day samples since they formed a separate cluster, we can resolve the longitudinal changes using LMdist. The authors found that beta diversity significantly separated the samples by the collection date (PERMANOVA, F-score = 23.8, <italic toggle="yes">P </italic>&lt;<italic toggle="yes"> </italic>.001) and upbringing groups (Mantel test, <italic toggle="yes">r</italic> = 0.38, <italic toggle="yes">P </italic>=<italic toggle="yes"> </italic>.001). After applying LMdist, we found the collection day gradient improved the effect in PERMANOVA found between collection day and pairwise measures (F-score = 57.63, <italic toggle="yes">P </italic>&lt;<italic toggle="yes"> </italic>.001) without changing the significance found for raising group (PERMANOVA, <italic toggle="yes">P </italic>=<italic toggle="yes"> </italic>.007).</p>
      <p>Finally, we evaluate the usefulness of LMdist applied to herb and shrub community data collected by Robert Whittaker in the Siskiyou Mountains along an elevation gradient (<xref rid="btad727-F6" ref-type="fig">Fig. 6D</xref>) (<xref rid="btad727-B20" ref-type="bibr">Whittaker <italic toggle="yes">et al.</italic> 2022</xref>). Restricting to just the communities in diorite soil, the elevation gradient forms an arch in PCoA of Bray–Curtis dissimilarities. Again, the effect size of the elevation gradient (PERMANOVA, F-score = 36.8, <italic toggle="yes">P </italic>=<italic toggle="yes"> </italic>.001) is improved after applying LMdist (PERMANOVA, F-score = 92.4, <italic toggle="yes">P </italic>=<italic toggle="yes"> </italic>.001).</p>
      <p>These case studies exhibiting gradient-driven arches and horseshoes demonstrate how LMdist may better resolve gradient effects. Resolving gradients along one principal component enables more powerful linear statistical tests of gradient impact. LMdist also uncovers other variation orthogonal to the gradient, presenting some novel findings previously obscured by horseshoes. The optional gaussian smoothing parameter in LMdist minimally alters output for these case studies (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S2</xref>), implying LMdist with both a single radius and smoothing present similar, reasonable solutions.</p>
      <p>In cases where an underlying gradient is not present, such as a clustered dataset, we have found that in both simulated and real clustered data LMdist does not resolve an arch unless the original pairwise beta diversity values are truly oversaturated (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S3</xref>) (<xref rid="btad727-B19" ref-type="bibr">Whittaker 1956</xref>, <xref rid="btad727-B21" ref-type="bibr">Yatsunenko <italic toggle="yes">et al.</italic> 2012</xref>, <xref rid="btad727-B18" ref-type="bibr">Vangay <italic toggle="yes">et al.</italic> 2018</xref>). One can test for oversaturation by evaluating if the data presents a left skew in the distribution of pairwise distances. If no left skew is present, we expect there is no long underlying manifold, nor oversaturation of pairwise values. When we apply LMdist to simulated (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S3C</xref>) practical (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S3D</xref> and E) examples without oversaturation, we find LMdist chooses not to adjust pairwise distances as they are already the best representation of sample relationships. These experiments indicate LMdist is robust to overfitting and will not adjust already reliable pairwise values.</p>
    </sec>
  </sec>
  <sec>
    <title>4 Discussion</title>
    <p>We have demonstrated the usefulness of LMdist in a simulated gradient and in case studies of real environmental gradients across a range of published datasets. The simulated gradient can be nearly perfectly resolved with LMdist-adjusted distances. In various case studies, we find that LMdist can not only visually resolve the arched geometry of the data but can improve statistical outcomes in distance-based tests. LMdist is best used when pairwise beta diversity measures are oversaturated, presenting a left skew in the distribution of distances. These cases are typical of sampling a gradient or finding an arch in ordination, not as common for case-control or cohort studies. However, LMdist is also designed to resist overfitting, only correcting oversaturated pairwise values of which there may be none in a clustered dataset (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S3</xref>). In several gradient-based case studies, LMdist-adjusted distances improved the correlation of a known continuous gradient with the first axis of ordination, enabling more reliable use of linear regression approaches.</p>
    <p>By adjusting distance/dissimilarity measures with LMdist to decrease saturation of large pairwise distance values, and to increase trustworthiness of distances, ordination plots more accurately portray global relationships in the data. We have also demonstrated that LMdist reveals new information driving variation in the data orthogonal to the gradient, such as the second principal component in the soil dataset (<xref rid="btad727-F6" ref-type="fig">Fig. 6A</xref>). Prior to LMdist, the arch had occupied two or more dimensions instead of one, therefore leaving this orthogonal variation obscured. LMdist is therefore a powerful analysis technique in determining other interactions beyond the main environmental drivers in a study, allowing researchers to dive deeper into new explanatory variables. An important feature of this approach is that LMdist is completely unsupervised, not relying on foreknowledge of the gradient driving variation.</p>
    <p>LMdist is an efficient, data-driven algorithm for resolving arches and horseshoes driven by underlying gradients. With proper utilization, LMdist has shown promise in enabling more powerful statistical tests between environmental gradients and high-dimensional microbiome datasets. Analysis with LMdist-corrected distances may uncover new ecological variation that is orthogonal to environmental gradients, expanding the findings of previously published works.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="sup1" position="float" content-type="local-data">
      <label>btad727_Supplementary_Data</label>
      <media xlink:href="btad727_supplementary_data.docx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack id="ack1">
    <title>Acknowledgements</title>
    <p>We thank attendees of Great Lakes Bioinformatics 2023 for their valuable feedback regarding this work and the LMdist algorithm.</p>
  </ack>
  <sec>
    <title>Supplementary data</title>
    <p><xref rid="sup1" ref-type="supplementary-material">Supplementary data</xref> are available at <italic toggle="yes">Bioinformatics</italic> online.</p>
  </sec>
  <sec sec-type="COI-statement">
    <title>Conflict of interest</title>
    <p>D.K. serves as a paid Senior Scientific Advisor to Diversigen, a company involved in the commercialization of microbiome analysis.</p>
  </sec>
  <sec>
    <title>Funding</title>
    <p>This work was supported by NIH [R01AI121383 to D.K.] and Minnesota Partnership for Biotechnology and Medical Genomics [18.08 to D.K.].</p>
  </sec>
  <sec>
    <title>Data availabilty</title>
    <p>No new data were generated or analysed in support of this research. All data can be found in previously published works. Software and simulated dataset generation is available at <ext-link xlink:href="https://github.com/knights-lab/LMdist" ext-link-type="uri">https://github.com/knights-lab/LMdist</ext-link>.</p>
  </sec>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="btad727-B1">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Aggarwal</surname><given-names>CC</given-names></string-name>, <string-name><surname>Hinneburg</surname><given-names>A</given-names></string-name>, <string-name><surname>Keim</surname><given-names>DA.</given-names></string-name></person-group><part-title>On the surprising behavior of distance metrics in high dimensional space</part-title>. In: <person-group person-group-type="editor"><string-name><surname>Van den Bussche</surname><given-names>J</given-names></string-name>, <string-name><surname>Vianu</surname><given-names>V</given-names></string-name></person-group> (eds.), <source>Database Theory–ICDT 2001</source>. <publisher-loc>Berlin, Heidelberg</publisher-loc>: <publisher-name>Springer</publisher-name>, <year>2001</year>, <fpage>420</fpage>–<lpage>34</lpage>.</mixed-citation>
    </ref>
    <ref id="btad727-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Balasubramanian</surname><given-names>M</given-names></string-name>, <string-name><surname>Schwartz</surname><given-names>EL.</given-names></string-name></person-group><article-title>The isomap algorithm and topological stability</article-title>. <source>Science</source><year>2002</year>;<volume>295</volume>:<fpage>7</fpage>.<pub-id pub-id-type="pmid">11778013</pub-id></mixed-citation>
    </ref>
    <ref id="btad727-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Camiz</surname><given-names>S.</given-names></string-name></person-group><article-title>The guttman effect: its interpretation and a new redressing method</article-title>. <source>Data Anal Bull</source><year>2005</year>;<volume>5</volume>:<fpage>7</fpage>–<lpage>34</lpage>.</mixed-citation>
    </ref>
    <ref id="btad727-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Diaconis</surname><given-names>P</given-names></string-name>, <string-name><surname>Goel</surname><given-names>S</given-names></string-name>, <string-name><surname>Holmes</surname><given-names>S.</given-names></string-name></person-group><article-title>Horseshoes in multidimensional scaling and local kernel methods</article-title>. <source>Ann Appl Stat</source><year>2008</year>;<volume>2</volume>:<fpage>777</fpage>–<lpage>807</lpage>.</mixed-citation>
    </ref>
    <ref id="btad727-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Harris</surname><given-names>JK</given-names></string-name>, <string-name><surname>Caporaso</surname><given-names>JG</given-names></string-name>, <string-name><surname>Walker</surname><given-names>JJ</given-names></string-name></person-group><etal>et al</etal><article-title>Phylogenetic stratigraphy in the Guerrero Negro hypersaline microbial mat</article-title>. <source>ISME J</source><year>2013</year>;<volume>7</volume>:<fpage>50</fpage>–<lpage>60</lpage>.<pub-id pub-id-type="pmid">22832344</pub-id></mixed-citation>
    </ref>
    <ref id="btad727-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Harrison</surname><given-names>JG</given-names></string-name>, <string-name><surname>Calder</surname><given-names>WJ</given-names></string-name>, <string-name><surname>Shastry</surname><given-names>V</given-names></string-name></person-group><etal>et al</etal><article-title>Dirichlet-multinomial modelling outperforms alternatives for analysis of microbiome and other ecological count data</article-title>. <source>Mol Ecol Resour</source><year>2020</year>;<volume>20</volume>:<fpage>481</fpage>–<lpage>97</lpage>.<pub-id pub-id-type="pmid">31872949</pub-id></mixed-citation>
    </ref>
    <ref id="btad727-B7">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Hill</surname><given-names>MO</given-names></string-name>, <string-name><surname>Gauch</surname><given-names>HG.</given-names></string-name></person-group> Detrended correspondence analysis: an improved ordination technique. In: van der Maarel E (ed.), <italic toggle="yes">Classification and Ordination: Symposium on Advances in Vegetation Science, Nijmegen, The Netherlands</italic>, May 1979. Dordrecht: Springer Netherlands, <year>1980</year>, <fpage>47</fpage>–<lpage>58</lpage>.</mixed-citation>
    </ref>
    <ref id="btad727-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lauber</surname><given-names>CL</given-names></string-name>, <string-name><surname>Hamady</surname><given-names>M</given-names></string-name>, <string-name><surname>Knight</surname><given-names>R</given-names></string-name></person-group><etal>et al</etal><article-title>Pyrosequencing-based assessment of soil pH as a predictor of soil bacterial community structure at the continental scale</article-title>. <source>Appl Environ Microbiol</source><year>2009</year>;<volume>75</volume>:<fpage>5111</fpage>–<lpage>20</lpage>.<pub-id pub-id-type="pmid">19502440</pub-id></mixed-citation>
    </ref>
    <ref id="btad727-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Miller</surname><given-names>EA</given-names></string-name>, <string-name><surname>Winfield</surname><given-names>B</given-names></string-name>, <string-name><surname>Weber</surname><given-names>BP</given-names></string-name></person-group><etal>et al</etal><article-title>Convergence of the Turkey gut microbiota following cohabitation under commercial settings</article-title>. <source>J Animal Sci Biotechnol</source><year>2021</year>;<volume>12</volume>:<fpage>1</fpage>–<lpage>10</lpage>.</mixed-citation>
    </ref>
    <ref id="btad727-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Morton</surname><given-names>JT</given-names></string-name>, <string-name><surname>Toran</surname><given-names>L</given-names></string-name>, <string-name><surname>Edlund</surname><given-names>A</given-names></string-name></person-group><etal>et al</etal><article-title>Uncovering the horseshoe effect in microbial analyses</article-title>. <source>mSystems</source><year>2017</year>;<volume>2</volume>:<fpage>e00166-16</fpage>.<pub-id pub-id-type="pmid">28251186</pub-id></mixed-citation>
    </ref>
    <ref id="btad727-B11">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Ng</surname><given-names>KW</given-names></string-name>, <string-name><surname>Tian</surname><given-names>G-L</given-names></string-name>, <string-name><surname>Tang</surname><given-names>M-L.</given-names></string-name></person-group><source>Dirichlet and related distributions: theory, methods and applications</source>. Chichester, West Sussex, United Kingdom: <publisher-name>John Wiley &amp; Sons</publisher-name>, <year>2011</year>.</mixed-citation>
    </ref>
    <ref id="btad727-B12">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Oksanen</surname><given-names>J</given-names></string-name>, <string-name><surname>Simpson</surname><given-names>GL</given-names></string-name>, <string-name><surname>Blanchet</surname><given-names>FG</given-names></string-name></person-group><etal>et al</etal><italic toggle="yes">vegan: Community Ecology Package</italic>. R package version 2.6-4. <year>2022</year>. <ext-link xlink:href="https://CRAN.R-project.org/package=vegan" ext-link-type="uri">https://CRAN.R-project.org/package=vegan</ext-link>.</mixed-citation>
    </ref>
    <ref id="btad727-B13">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Palmer</surname><given-names>MW.</given-names></string-name></person-group><italic toggle="yes">Ordination Methods—An Overview: Ordination Methods for Ecologists</italic>. <ext-link xlink:href="https://ordination.okstate.edu/overview.htm" ext-link-type="uri">https://ordination.okstate.edu/overview.htm</ext-link>.</mixed-citation>
    </ref>
    <ref id="btad727-B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Pedregosa</surname><given-names>F</given-names></string-name>, <string-name><surname>Varoquaux</surname><given-names>G</given-names></string-name>, <string-name><surname>Gramfort</surname><given-names>A</given-names></string-name></person-group><etal>et al</etal><article-title>Scikit-learn: machine learning in Python</article-title>. <source>J Mach Learn Res</source><year>2011</year>;<volume>12</volume>:<fpage>2825</fpage>–<lpage>30</lpage>.</mixed-citation>
    </ref>
    <ref id="btad727-B15">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Podani</surname><given-names>J</given-names></string-name>, <string-name><surname>Miklós</surname><given-names>I.</given-names></string-name></person-group><article-title>Resemblance coefficients and the horseshoe effect in principal coordinates analysis</article-title>. <source>Ecology</source><year>2002</year>;<volume>83</volume>:<fpage>3331</fpage>–<lpage>43</lpage>.</mixed-citation>
    </ref>
    <ref id="btad727-B16">
      <mixed-citation publication-type="book"><collab>R Core Team</collab>. <source>R: A Language and Environment for Statistical Computing</source>. <publisher-loc>Vienna, Austria</publisher-loc>: <publisher-name>R Foundation for Statistical Computing</publisher-name>, <year>2021</year>.</mixed-citation>
    </ref>
    <ref id="btad727-B17">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Van der Maaten</surname><given-names>L</given-names></string-name>, <string-name><surname>Hinton</surname><given-names>G.</given-names></string-name></person-group><article-title>Visualizing data using t-SNE</article-title>. <source>J Mach Learn Res</source><year>2008</year>;<volume>9</volume>:<fpage>2579</fpage>–<lpage>605</lpage>.</mixed-citation>
    </ref>
    <ref id="btad727-B18">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Vangay</surname><given-names>P</given-names></string-name>, <string-name><surname>Johnson</surname><given-names>AJ</given-names></string-name>, <string-name><surname>Ward</surname><given-names>TL</given-names></string-name></person-group><etal>et al</etal><article-title>US immigration westernizes the human gut microbiome</article-title>. <source>Cell</source><year>2018</year>;<volume>175</volume>:<fpage>962</fpage>–<lpage>72.e10</lpage>.<pub-id pub-id-type="pmid">30388453</pub-id></mixed-citation>
    </ref>
    <ref id="btad727-B19">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Whittaker</surname><given-names>RH.</given-names></string-name></person-group><article-title>Vegetation of the great smoky mountains</article-title>. <source>Ecol Monogr</source><year>1956</year>;<volume>26</volume>:<fpage>1</fpage>–<lpage>80</lpage>.</mixed-citation>
    </ref>
    <ref id="btad727-B20">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Whittaker</surname><given-names>RH</given-names></string-name>, <string-name><surname>Damschen</surname><given-names>EI</given-names></string-name>, <string-name><surname>Harrison</surname><given-names>S.</given-names></string-name></person-group><article-title>Plant community data collected by Robert H. Whittaker in the Siskiyou Mountains, Oregon and California, USA</article-title>. <source>Ecology</source><year>2022</year>;<volume>103</volume>:<fpage>e3764</fpage>.<pub-id pub-id-type="pmid">35608560</pub-id></mixed-citation>
    </ref>
    <ref id="btad727-B21">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Yatsunenko</surname><given-names>T</given-names></string-name>, <string-name><surname>Rey</surname><given-names>FE</given-names></string-name>, <string-name><surname>Manary</surname><given-names>MJ</given-names></string-name></person-group><etal>et al</etal><article-title>Human gut microbiome viewed across age and geography</article-title>. <source>Nature</source><year>2012</year>;<volume>486</volume>:<fpage>222</fpage>–<lpage>7</lpage>.<pub-id pub-id-type="pmid">22699611</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10713119</article-id>
    <article-id pub-id-type="pmid">38060267</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btad727</article-id>
    <article-id pub-id-type="publisher-id">btad727</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Original Paper</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Genome Analysis</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01060</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>LMdist: Local Manifold distance accurately measures beta diversity in ecological gradients</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0001-5273-5795</contrib-id>
        <name>
          <surname>Hoops</surname>
          <given-names>Susan L</given-names>
        </name>
        <aff><institution>Department of Computer Science and Engineering, College of Science and Engineering, University of Minnesota</institution>, Minneapolis, MN 55455, <country country="US">United States</country></aff>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-8205-2511</contrib-id>
        <name>
          <surname>Knights</surname>
          <given-names>Dan</given-names>
        </name>
        <aff><institution>Department of Computer Science and Engineering, College of Science and Engineering, University of Minnesota</institution>, Minneapolis, MN 55455, <country country="US">United States</country></aff>
        <aff><institution>BioTechnology Institute, College of Biological Sciences, University of Minnesota</institution>, Saint Paul, MN 55108, <country country="US">United States</country></aff>
        <xref rid="btad727-cor1" ref-type="corresp"/>
        <!--dknights@umn.edu-->
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Marschall</surname>
          <given-names>Tobias</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="btad727-cor1">Corresponding author. Department of Computer Science &amp; Engineering, University of Minnesota, 4-192 Keller Hall, 200 Union Street SE, Minneapolis, Minnesota 55455, United States. E-mail: <email>dknights@umn.edu</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <month>12</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2023-12-07">
      <day>07</day>
      <month>12</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>07</day>
      <month>12</month>
      <year>2023</year>
    </pub-date>
    <volume>39</volume>
    <issue>12</issue>
    <elocation-id>btad727</elocation-id>
    <history>
      <date date-type="received">
        <day>11</day>
        <month>5</month>
        <year>2023</year>
      </date>
      <date date-type="rev-recd">
        <day>07</day>
        <month>11</month>
        <year>2023</year>
      </date>
      <date date-type="editorial-decision">
        <day>08</day>
        <month>11</month>
        <year>2023</year>
      </date>
      <date date-type="accepted">
        <day>06</day>
        <month>12</month>
        <year>2023</year>
      </date>
      <date date-type="corrected-typeset">
        <day>11</day>
        <month>12</month>
        <year>2023</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2023. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2023</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btad727.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Motivation</title>
        <p>Differentiating ecosystems poses a complex, high-dimensional problem constrained by capturing relevant variation across species profiles. Researchers use pairwise distances and subsequent dimensionality reduction to highlight variation in a few dimensions. Despite popularity in analysis of ecological data, these low-dimensional visualizations can contain geometric abnormalities such as “arch” and “horseshoe” effects, potentially obscuring the impact of environmental gradients. These abnormalities appear in ordination but are in fact a product of oversaturated large pairwise distances.</p>
      </sec>
      <sec id="s2">
        <title>Results</title>
        <p>We present Local Manifold distance (LMdist), an unsupervised algorithm which adjusts pairwise beta diversity measures to better represent true ecological distances between samples. Beta diversity measures can have a bounded dynamic range in depicting long environmental gradients with high species turnover. Using a graph structure, LMdist projects pairwise distances onto a manifold and traverses the manifold surface to adjust pairwise distances at the upper end of the beta diversity measure’s dynamic range. This allows for values beyond the range of the original measure. Not all datasets will have oversaturated pairwise distances, nor will capture variation that resembles a manifold, so LMdist adjusts only those pairwise values which may be undervalued in the presence of a sampled gradient. The adjusted distances serve as input for ordination and statistical testing. We demonstrate on real and simulated data that LMdist effectively recovers distances along known gradients and along complex manifolds such as the Swiss roll dataset. LMdist enables more powerful statistical tests for gradient effects and reveals variation orthogonal to the gradient.</p>
      </sec>
      <sec id="s3">
        <title>Availability and implementation</title>
        <p>Available on GitHub at <ext-link xlink:href="https://github.com/knights-lab/LMdist" ext-link-type="uri">https://github.com/knights-lab/LMdist</ext-link>.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>NIH</institution>
            <institution-id institution-id-type="DOI">10.13039/100000002</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>R01AI121383</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Minnesota Partnership for Biotechnology and Medical Genomics</institution>
          </institution-wrap>
        </funding-source>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="8"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>Beta diversity is a standard component of microbial and community ecology analysis. Ordination plots can be found in many microbiome and ecology publications. Geometric anomalies like the arch or horseshoe effects are prevalent in ordination plots of datasets containing an ecological gradient. Ecological gradients could include geochemistry, temperature, altitude, time, or other continuous factors. The arch effect displays samples along the gradient in a curved formation during ordination such that the gradient no longer appears 1D. The horseshoe effect, also referred to as the Guttman effect, is the more extreme relative of the arch effect and displays the samples along an ecological gradient in, as the name suggests, a horseshoe-like shape. Thus, in the horseshoe effect, ends of the gradient appear attracted to one another (<xref rid="btad727-B3" ref-type="bibr">Camiz 2005</xref>). In the early 1980s, ecologists hypothesized the extreme arch was a mathematical artifact obscuring ecological gradients (<xref rid="btad727-B7" ref-type="bibr">Hill and Gauch 1980</xref>), adopting the term “horseshoe” from popular political theory discourse.</p>
    <p>The arch and horseshoe effects are of concern for beta diversity analyses because they misrepresent the true ecological distances between samples lying along ecological gradients. <xref rid="btad727-F1" ref-type="fig">Figure 1</xref> illustrates an arch in soil samples taken along a pH gradient (<xref rid="btad727-B8" ref-type="bibr">Lauber <italic toggle="yes">et al.</italic> 2009</xref>). The pH gradient is clearly visible along the arched display of samples, but the arch makes the ends of the gradient (black squares for acidic pH, white diamonds for basic pH) appear almost as closely related to each other as to the middle of the pH gradient. It has been shown previously that this arch phenomenon is not caused by the ordination or visualization (<xref rid="btad727-B10" ref-type="bibr">Morton <italic toggle="yes">et al.</italic> 2017</xref>), but is instead a problem with the pairwise dissimilarities generating the ordination. Pairwise dissimilarities are the foundation of distance-based statistical analyses for beta diversity, so statistical outcomes may be weakened by pairwise measures misrepresenting sample relationships.</p>
    <fig position="float" id="btad727-F1">
      <label>Figure 1.</label>
      <caption>
        <p>PCoA with Jaccard distances of soil samples taken along a geochemical pH gradient. An arch in the data is clearly visible, making the ends of the pH gradient appear closer than expected.</p>
      </caption>
      <graphic xlink:href="btad727f1" position="float"/>
    </fig>
    <p>Despite a relatively high frequency of arches and horseshoes present in beta diversity analyses, these artifacts remain relatively underexplored and misunderstood in microbial ecology literature. A limited body of prior work has sought to explain and exemplify the problem as it appears. Ecologists Podani and Miklós explored the tendency of various distance and dissimilarity measures to result in a horseshoe shape in PCoA plots (<xref rid="btad727-B15" ref-type="bibr">Podani and Miklós 2002</xref>). Their findings indicated that researchers should select distance and dissimilarity measures which do not result in the arch, but their work lacks specificity about the causes or a notable solution. <xref rid="btad727-B4" ref-type="bibr">Diaconis <italic toggle="yes">et al.</italic> (2008)</xref> indicate some arches may be true representations, but that PCoA is limited in portraying them, and that manifold learning methods for ordination are better suited to data portraying an arch or horseshoe. Still, reasoning about the origin of the arch artifact was lacking until the work of <xref rid="btad727-B10" ref-type="bibr">Morton <italic toggle="yes">et al.</italic> (2017)</xref> pointed to sparsity of microbiome datasets as a possible source. <xref rid="btad727-B10" ref-type="bibr">Morton <italic toggle="yes">et al.</italic> (2017)</xref> demonstrate the limitations of distance and dissimilarity metrics in sparse datasets, although their solution, the Earth Mover Band Aware Distance (EMBAD) metric, is designed to rely upon known metadata in adjusting the ordination. EMBAD starts by sorting the samples according to a predetermined environmental variable, then simulating the flow of the taxonomic features between the samples along this ordered list. The EMBAD metric resolves the arched geometry with this adjustment but requires foreknowledge of the ecological gradient and direct use of this gradient in evaluating pairwise distances.</p>
    <p>Building on this existing body of work, we hypothesize that distance and dissimilarity metrics have a bounded dynamic range in describing pairwise relationships of a dataset, leading to an oversaturation of large pairwise measures. This effect is caused by samples that are sufficiently separated along the ecological gradient such that they have few or no species in common. Pairwise relationships are more reliable with many species in common, so samples from opposite ends of the gradient will instead have less informative pairwise distances to distinguish them. Upper bounds are known for some popular measures, such as Bray–Curtis and Jaccard dissimilarity which are restricted between zero and one. In these measures, counts of a subset of features will never exceed the total feature counts for a sample. Distance metrics, among them Euclidean distance, Aitchison distances, and UniFrac distances, are unbounded but may oversaturate in the same manner as bounded measures when there are few features in common. Euclidean distances are already known to be a poor choice for sparse datasets, common for microbial ecology (<xref rid="btad727-B1" ref-type="bibr">Aggarwal <italic toggle="yes">et al.</italic> 2001</xref>). When these large pairwise distances or dissimilarities become oversaturated, ordination algorithms may be limited in differentiating samples in a reduced dimensional space, leading to arches and horseshoes.</p>
    <p>Given our hypothesis that the bounded dynamic range of beta diversity measures cause arch and horseshoe effects, we propose Local Manifold distance (LMdist) for adjusting distances and dissimilarities to overcome the limited range of ecological distance measures in sparse datasets. LMdist borrows concepts from graph theory and statistics to better represent the high dimensional geometries of gradient-based datasets. LMdist not only corrects arches and horseshoes in ordination plots but improves the reliability of the underlying pairwise measures for downstream analyses such as statistical hypothesis testing.</p>
  </sec>
  <sec>
    <title>2 Materials and methods</title>
    <sec>
      <title>2.1 Local Manifold distance (LMdist) algorithm</title>
      <p>The LMdist algorithm represents the high dimensional beta diversity matrix as a graph, then measures distances between points along the graph-defined manifold. <xref rid="btad727-F2" ref-type="fig">Figure 2</xref> visually depicts the algorithm on a small simulated gradient dataset. Beginning with an undirected graph of nodes, representing samples, edges are drawn between sample nodes and their parameter-defined neighbors. Each edge is weighted by the distance/dissimilarity between samples at either end, compatible with any pairwise beta diversity measure. Some pairwise edges will be omitted from the graph if they are above the parameterized maximum value, called the neighborhood radius. The graph is then traversed to determine adjusted pairwise values. These adjusted values become the new input for ordination and subsequent statistical analysis, resolving the arch in ordinal plots and enabling more powerful linear regression.</p>
      <fig position="float" id="btad727-F2">
        <label>Figure 2.</label>
        <caption>
          <p>Visual representation of the LMdist algorithm. (A) Simulated samples appearing in an arch during PCoA with Bray–Curtis distances, colored by a simulated ecological gradient. (B) We represent these same samples as isolated nodes and define a neighborhood size by a radius parameter, then (C) add undirected edges between nodes within the parameter-defined neighborhood. (D) Continue to add edges between nodes in common neighborhoods until the graph is fully connected, all nodes can be reached by all other nodes. (E) This graph of nodes and edges is traversed to create adjusted pairwise values, which become the new input for ordination. (F) The resulting ordination can resolve the linear gradient in PCoA.</p>
        </caption>
        <graphic xlink:href="btad727f2" position="float"/>
      </fig>
      <sec>
        <title>2.1.1 Input pairwise measures form a connected graph</title>
        <p>The only required input for the LMdist algorithm is the original pairwise beta diversity matrix; the radius parameter allows for further fine-tuning of the algorithm. The algorithm is compatible with any pairwise measure, and LMdist will adjust these measures to produce a new set of pairwise distances. The neighborhood radius parameter determines which input pairwise values will be included in forming the undirected graph (<xref rid="btad727-F2" ref-type="fig">Fig. 2B and C</xref>). For example, given a radius value of 0.25, only pairwise values under 0.25 will be used to connect sample nodes in the graph. Therefore, we can think of the radius parameter as the radius of a sphere in the original beta diversity space, centered at any given sample node. All other sample nodes falling within the bounds of this sphere will be connected to the centroid node as they are considered “neighbors.” Each sample node will be the centroid for this process, until all nodes have been considered and connected to any neighbors to form edges in the graph (<xref rid="btad727-F2" ref-type="fig">Fig. 2D</xref>).</p>
        <p>After the neighborhood edges have been determined per node using a given radius, the resulting graph may be a disconnected graph. This is expected when samples have not been collected evenly along a gradient, or if the chosen radius is small. If disconnected, a minimum spanning tree (MST) is computed using original pairwise distances for all sample nodes, which traverses all nodes in the shortest possible path. Comparing this MST to the graph of neighbor edges, we can borrow minimal edges from the MST to make the graph fully connected. As a result, we will have a fully connected graph where the minimum possible number of edges exceed the radius parameter, as needed to fully connect the graph.</p>
      </sec>
      <sec>
        <title>2.1.2 Recalculate pairwise distances by traversing the graph</title>
        <p>This connected graph is used to recalculate pairwise distances/dissimilarities between samples. We calculate a single pairwise distance by traversing from one sample node along any available edges to the other node, in the shortest possible path (<xref rid="btad727-F2" ref-type="fig">Fig. 2E</xref>). The adjusted pairwise value is then the sum of all edges traversed in this shortest path between two nodes. This traversal is completed for all pairs of sample nodes, such that we have adjusted pairwise values for any sample relationships exceeding the trusted, radius-defined neighborhood.</p>
      </sec>
      <sec>
        <title>2.1.3 Parameters can fine-tune results of LMdist</title>
        <p>Fine-tuning of LMdist can be achieved by adjusting the radius parameter, calibrating optimization criteria, or smoothing results via a Gaussian weighting. A large radius, close to the maximum distance, results in a very small adjustment to the original distance matrix. Conversely, a very small radius will cause the largest adjustment, because distant nodes will be connected in the graph only by traversing many intermediate nodes.</p>
        <p>By default, the algorithm calculates LMdist using 50 different radii, picking the largest radius which meets two optimization criteria. First, any radius which results in a graph with an average degree, the average number of connections per node, &lt;10% of the number of samples (parameterized as “phi” with default 0.10) will be excluded from the results of LMdist. This limitation is intended to avoid overfitting, resulting in a distorted graph that might exaggerate the distances between samples. The second criterion is a multi-objective function which allows LMdist to guess the best radial value for a given dataset. This multi-objective optimization maximizes both the radius and a correlation between the LMdist-adjusted distances and the Euclidean distances in resulting ordination (PCoA) space, using the first <italic toggle="yes">n</italic> dimensions, up to 10, accounting for &gt;80% variance. To give priority to trusting more original distances, a correlation for a smaller radius must exceed the previous best correlation by a parameterized value of epsilon (default 0.05).</p>
        <p>The multi-objective function works for many cases, but still places confidence in a single radius value. We therefore implemented an optional parameter (“smooth” defaulted to False) for smoothing results of multiple radii. If smoothing is preferred, a Gaussian weight centered at the chosen radius is applied to the results of up to 50 radii, such that many radial values will influence the results, generating a smoothed version of the corrected pairwise distances.</p>
      </sec>
      <sec>
        <title>2.1.4 LMdist produces an adjusted distance matrix</title>
        <p>The result of the LMdist algorithm, implemented in R (<xref rid="btad727-B16" ref-type="bibr">R Core Team 2021</xref>), is an adjusted pairwise distance object, the same format as the output of the vegdist function in the vegan package (<xref rid="btad727-B12" ref-type="bibr">Oksanen <italic toggle="yes">et al.</italic> 2022</xref>). These adjusted values can replace the original pairwise distance matrix in subsequent beta diversity analysis. In ordination, the adjusted values become the new input for ordinal methods accepting pairwise measures, such as PCoA or NMDS. Results in a simulated dataset and case studies have shown that LMdist reduces the arched appearance of the data, and if an environmental gradient is present LMdist better resolves the gradient, revealing variation orthogonal to the gradient in other ordinal dimensions.</p>
      </sec>
      <sec>
        <title>2.1.5 Use cases have oversaturated distances</title>
        <p>LMdist can be used with any pairwise distance matrix but is best utilized for uncovering gradients. While some gradients may already be well represented, an arch or horseshoe in ordination tends to appear when the pairwise distance matrices become oversaturated. We define oversaturated distances as a large left skew in the distribution of pairwise distances, because large distances are relatively oversaturated compared to the smaller pairwise distances. This oversaturation indicates a disagreement between the sampled gradient and the pairwise sample distances, as is demonstrated in implementation with a simulated dataset to follow (<xref rid="btad727-F4" ref-type="fig">Fig. 4</xref>). Therefore, we propose LMdist is most appropriately used in studies with a long underlying gradient or oversaturated distances, as these samples will be better represented when accounting for the underlying manifold. Case-control studies may not need adjustment by LMdist, most importantly if the pairwise distances are not oversaturated with large values.</p>
      </sec>
    </sec>
    <sec>
      <title>2.2 Simulated dataset</title>
      <p>For initial validation of this algorithm, we created a simulated dataset of taxonomic features evenly distributed along an artificial gradient, mimicking a gradient-driven ecosystem. The final simulated dataset contains 50 samples and 231 taxonomic features. Noisy samples added to the dataset illustrate the sensitivity of the algorithm, which has remained stable in uncovering the gradient.</p>
      <sec>
        <title>2.2.1 Coenoclines emulate species abundance along a gradient</title>
        <p>In creating a simulated dataset we utilized coenoclines, representations of species response functions along some gradient (<xref rid="btad727-B13" ref-type="bibr">Palmer 2013</xref>). We presumed a unimodal response curve for each species along the gradient, supported by further exploration of the soil dataset (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S1</xref>). For our simulated gradient, we distributed artificial species features evenly along a gradient, using Gaussian coenoclines (<xref rid="btad727-F3" ref-type="fig">Fig. 3A</xref>). For an example gradient length of 1000 (arbitrary units), the artificial species distributions are simulated as Gaussian curves centered 10 steps apart with a standard deviation of 150, allowing for density of overlap between species. Samples are obtained from these coenoclines by sampling values from the densities of the Gaussian curves at a given point, attributing the amounts of every artificial species at that point in the gradient to the sample (<xref rid="btad727-F3" ref-type="fig">Fig. 3A</xref>). A total of 50 samples are taken, evenly distributed along the full gradient length. The absolute heights of the Gaussian coenoclines are arbitrary because samples are normalized to relative abundances before analysis.</p>
        <fig position="float" id="btad727-F3">
          <label>Figure 3.</label>
          <caption>
            <p>Creation of simulated dataset. (A) Coenoclines representing roughly every 10th taxonomic feature distributed along the simulated gradient, annotated to show how sample 10 would be collected. Sample 10 would be comprised of the amounts of each feature as seen in the visual cross section of the feature coenoclines. (B) Heatmap of samples collected, displayed in order with the noise samples preceding each original sample.</p>
          </caption>
          <graphic xlink:href="btad727f3" position="float"/>
        </fig>
      </sec>
      <sec>
        <title>2.2.2 Sampling noise from a Dirichlet distribution</title>
        <p>To add noise to the simulated dataset, each mixture of sampled species values is used as the prior for a Dirichlet distribution, the generative distribution of the multinomial distribution and the multivariate generalization of the Beta distribution (<xref rid="btad727-B11" ref-type="bibr">Ng <italic toggle="yes">et al.</italic> 2011</xref>), producing 50 additional samples as noise, mimicking the original samples (<xref rid="btad727-F3" ref-type="fig">Fig. 3B</xref>). We chose the Dirichlet distribution because it allows for fine-tuning the degree of noise and because microbial ecology samples have been modeled previously using a Dirichlet distribution (<xref rid="btad727-B6" ref-type="bibr">Harrison <italic toggle="yes">et al.</italic> 2020</xref>).</p>
      </sec>
    </sec>
  </sec>
  <sec>
    <title>3 Results</title>
    <sec>
      <title>3.1 Simulated gradient</title>
      <p><xref rid="btad727-F4" ref-type="fig">Figure 4</xref> shows the simulated dataset after application of the LMdist algorithm to adjust distances. In the original Bray–Curtis distances, we can see from <xref rid="btad727-F4" ref-type="fig">Fig. 4B</xref> that the Bray–Curtis distances on the <italic toggle="yes">y</italic>-axis are distributed with the opposite skew of the known gradient distances on the <italic toggle="yes">x</italic>-axis, resulting in a plateau rather than the expected <italic toggle="yes">y</italic> = <italic toggle="yes">x</italic> line. This oversaturation of large distances results in the samples forming a horseshoe in PCoA ordination (<xref rid="btad727-F4" ref-type="fig">Fig. 4A</xref>). After applying LMdist with a radius of 0.4, the gradient distances and adjusted distances now resemble one another (<xref rid="btad727-F4" ref-type="fig">Fig. 4D</xref>) and the gradient is resolved in PCoA along the first principal component (Pearson correlation 0.999, improved from 0.967 prior to LMdist) such that the second axis may now be accounting for noise (Levene’s test of variance, <italic toggle="yes">P </italic>&lt;<italic toggle="yes"> </italic>.001) (<xref rid="btad727-F4" ref-type="fig">Fig. 4C</xref>).</p>
      <fig position="float" id="btad727-F4">
        <label>Figure 4.</label>
        <caption>
          <p>LMdist applied to the simulated gradient. (A) PCoA with Bray–Curtis distances of 100 simulated samples, colored by approximate position on gradient. (B) Comparison plot of community distances (Bray–Curtis) and gradient distances (Euclidean). We can see the community distances plateau at the top of the gradient, causing a mismatch between the density of community and gradient distances. (C) PCoA with LMdist-adjusted distances, where the horseshoe is largely resolved along the first principal component. (D) The same comparison plot between the adjusted community distances and gradient distances, the distribution of which is better balanced to one another after LMdist is applied.</p>
        </caption>
        <graphic xlink:href="btad727f4" position="float"/>
      </fig>
    </sec>
    <sec>
      <title>3.2 Simulated Swiss roll</title>
      <p>The Swiss roll dataset has been used to exemplify an obvious low-dimensional manifold structure in demonstrating manifold learning approaches. <xref rid="btad727-F5" ref-type="fig">Figure 5</xref> shows 300 samples in a Swiss roll, created using the scikit-learn python package (<xref rid="btad727-B14" ref-type="bibr">Pedregosa <italic toggle="yes">et al.</italic> 2011</xref>), in the original three dimensions. We then compare to dimensionality reduction by principal component analysis (PCA), t-distributed Stochastic Neighbor Embedding (t-SNE) (<xref rid="btad727-B17" ref-type="bibr">Van der Maaten and Hinton 2008</xref>), Isomap (<xref rid="btad727-B2" ref-type="bibr">Balasubramanian and Schwartz 2002</xref>), and LMdist. Fine-tuning of parameters was necessary for all algorithms to obtain the best possible flattening of the manifold in 2D space.</p>
      <fig position="float" id="btad727-F5">
        <label>Figure 5.</label>
        <caption>
          <p>LMdist applied to the Swiss roll dataset. (A) The Swiss roll dataset with 300 samples in the original 3 dimensions, created with the scikit-learn package in Python. (B) PCA of the Swiss roll dataset. (C) t-SNE of the Swiss roll dataset using perplexity 60. (D) Isomap of Swiss roll dataset with neighborhood size 5. (E) LMdist of Swiss roll dataset with neighborhood radius 0.62.</p>
        </caption>
        <graphic xlink:href="btad727f5" position="float"/>
      </fig>
      <p>As expected, the manifold learning approaches and LMdist outperform PCA, due to their parameter-defined perplexity and ability to recover some of the underlying structure of the data. LMdist proves particularly useful in two respects compared to these manifold learning approaches. First, LMdist appears to most reliably uncover sample relationships, as it is not overly sensitive to hyperparameters and a series of transformations as is the case of t-SNE, nor does LMdist assume neighborhoods of equal sample sizes as in Isomap. The neighborhood radius used by LMdist therefore resolves the manifold, but also more clearly resolves the variation along the manifold in the second dimension. Secondly, LMdist is advantageous as the only approach to outputs an actual distance matrix, which can then be used for distance-based statistical testing. Typically, the adjusted distance matrix is only implicit within manifold learning algorithms, precluding their use in downstream analysis such as statistical testing of beta diversity.</p>
    </sec>
    <sec>
      <title>3.3 Case studies demonstrating the arch effect</title>
      <p>To exemplify the usefulness of the LMdist algorithm, we have gathered datasets from a variety of microbiome and ecological studies (<xref rid="btad727-F6" ref-type="fig">Fig. 6</xref>). As previously described, oversaturation of the distance and dissimilarity measures is often driven by underlying ecological gradients in the dataset. Therefore, datasets were selected which have a measurable environmental gradient and which exhibited an arch or horseshoe in ordination.</p>
      <fig position="float" id="btad727-F6">
        <label>Figure 6.</label>
        <caption>
          <p>PCoAs before and after adjusting pairwise values with LMdist on default settings, displayed with fixed square perspective. (A) Soil samples along a pH gradient, Jaccard dissimilarity and LMdist with radius 0.952. (B) Microbial mat samples at various depths, Jaccard dissimilarity and LMdist with radius 0.758. (C) Longitudinal Turkey cecum samples, Bray–Curtis dissimilarity and LMdist with radius 0.599 (note: changed epsilon to 0.01 since the default epsilon was too small). (D) Herbs and shrubs community data collected by Robert Whittaker in the Siskiyou Mountains, Bray–Curtis dissimilarity and LMdist with radius 0.93.</p>
        </caption>
        <graphic xlink:href="btad727f6" position="float"/>
      </fig>
      <p>First, we return to the soil samples from across North and South America comprising a pH gradient (<xref rid="btad727-F6" ref-type="fig">Fig. 6A</xref>). Lauber <italic toggle="yes">et al.</italic> found these bacterial communities to be significantly correlated with soil pH (ANOSIM, <italic toggle="yes">P </italic>=<italic toggle="yes"> </italic>.001; Mantel test Spearman, <italic toggle="yes">r</italic> = 0.73), largely driven by the presence and absence of the phylum <italic toggle="yes">Acidobacteria</italic>, known to favor acidic environments, as well as the phyla <italic toggle="yes">Bacteroidetes</italic> and <italic toggle="yes">Actinobacteria</italic> which prefer comparatively basic environments (<xref rid="btad727-B8" ref-type="bibr">Lauber <italic toggle="yes">et al.</italic> 2009</xref>). After applying LMdist, we can see that the arch is largely resolved in the visualization, with no change in significance of distance-based testing (ANOSIM, <italic toggle="yes">P</italic> = .001; Mantel test Spearman, <italic toggle="yes">r</italic> = 0.74). Interestingly, though, we find that PC2 now resolves some variation in the data orthogonal to the pH gradient in PC1, correlating with amount of silt clay (Pearson cor = 0.51, <italic toggle="yes">P </italic>&lt;<italic toggle="yes"> </italic>.001; PERMANOVA, <italic toggle="yes">P </italic>&lt;<italic toggle="yes"> </italic>.001) and annual season temperature (Pearson cor = 0.49, <italic toggle="yes">P </italic>&lt;<italic toggle="yes"> </italic>.001; PERMANOVA, <italic toggle="yes">P </italic>&lt;<italic toggle="yes"> </italic>.001). While silt clay and annual season temperature were significant prior to LMdist using PERMANOVA (<italic toggle="yes">P </italic>&lt;<italic toggle="yes"> </italic>.05), <italic toggle="yes">F</italic>-scores for silt clay, annual season temperature, and pH all increased, implying the effect size is better represented after application of LMdist. This new finding with silt clay and annual season temperature orthogonal to the pH gradient was not mentioned in the original publication and might have been obscured by the arch in the original analysis.</p>
      <p>Sampling increasing depths of the hypersaline microbial mats of Guerrero Negro in Baja California Sur provides another gradient analysis on a smaller dataset. The authors confirm that the depths of microbial mats are phylogenetically stratified, as light and oxygen produced by photosynthesis rapidly diminishes with depth (<xref rid="btad727-B5" ref-type="bibr">Harris <italic toggle="yes">et al.</italic> 2013</xref>). Each depth from the top of the microbial mat to a depth of 34 mm is sampled twice and sequenced with 454 pyrosequencing technology. We can clearly make out that the depths follow a horseshoe pattern in the original ordination (<xref rid="btad727-F6" ref-type="fig">Fig. 6B</xref>). Using LMdist, we can resolve the horseshoe while trusting many distances (neighborhood radius 0.758 for Jaccard dissimilarity is chosen by the default algorithm) (<xref rid="btad727-F6" ref-type="fig">Fig. 6B</xref>). The correlation of the gradient with the first principal component (Spearman rho = 0.941, <italic toggle="yes">P </italic>&lt;<italic toggle="yes"> </italic>.001) improved after application of LMdist without changing significance (Pearson cor = 0.987, <italic toggle="yes">P </italic>&lt;<italic toggle="yes"> </italic>.001).</p>
      <p>Our next case study is a longitudinal, observational experiment comparing the Turkey gut when raised in an isolated hatch brood system as opposed to a commercial brood pen (<xref rid="btad727-F6" ref-type="fig">Fig. 6C</xref>) (<xref rid="btad727-B9" ref-type="bibr">Miller <italic toggle="yes">et al.</italic> 2021</xref>). Ignoring the first day samples since they formed a separate cluster, we can resolve the longitudinal changes using LMdist. The authors found that beta diversity significantly separated the samples by the collection date (PERMANOVA, F-score = 23.8, <italic toggle="yes">P </italic>&lt;<italic toggle="yes"> </italic>.001) and upbringing groups (Mantel test, <italic toggle="yes">r</italic> = 0.38, <italic toggle="yes">P </italic>=<italic toggle="yes"> </italic>.001). After applying LMdist, we found the collection day gradient improved the effect in PERMANOVA found between collection day and pairwise measures (F-score = 57.63, <italic toggle="yes">P </italic>&lt;<italic toggle="yes"> </italic>.001) without changing the significance found for raising group (PERMANOVA, <italic toggle="yes">P </italic>=<italic toggle="yes"> </italic>.007).</p>
      <p>Finally, we evaluate the usefulness of LMdist applied to herb and shrub community data collected by Robert Whittaker in the Siskiyou Mountains along an elevation gradient (<xref rid="btad727-F6" ref-type="fig">Fig. 6D</xref>) (<xref rid="btad727-B20" ref-type="bibr">Whittaker <italic toggle="yes">et al.</italic> 2022</xref>). Restricting to just the communities in diorite soil, the elevation gradient forms an arch in PCoA of Bray–Curtis dissimilarities. Again, the effect size of the elevation gradient (PERMANOVA, F-score = 36.8, <italic toggle="yes">P </italic>=<italic toggle="yes"> </italic>.001) is improved after applying LMdist (PERMANOVA, F-score = 92.4, <italic toggle="yes">P </italic>=<italic toggle="yes"> </italic>.001).</p>
      <p>These case studies exhibiting gradient-driven arches and horseshoes demonstrate how LMdist may better resolve gradient effects. Resolving gradients along one principal component enables more powerful linear statistical tests of gradient impact. LMdist also uncovers other variation orthogonal to the gradient, presenting some novel findings previously obscured by horseshoes. The optional gaussian smoothing parameter in LMdist minimally alters output for these case studies (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S2</xref>), implying LMdist with both a single radius and smoothing present similar, reasonable solutions.</p>
      <p>In cases where an underlying gradient is not present, such as a clustered dataset, we have found that in both simulated and real clustered data LMdist does not resolve an arch unless the original pairwise beta diversity values are truly oversaturated (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S3</xref>) (<xref rid="btad727-B19" ref-type="bibr">Whittaker 1956</xref>, <xref rid="btad727-B21" ref-type="bibr">Yatsunenko <italic toggle="yes">et al.</italic> 2012</xref>, <xref rid="btad727-B18" ref-type="bibr">Vangay <italic toggle="yes">et al.</italic> 2018</xref>). One can test for oversaturation by evaluating if the data presents a left skew in the distribution of pairwise distances. If no left skew is present, we expect there is no long underlying manifold, nor oversaturation of pairwise values. When we apply LMdist to simulated (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S3C</xref>) practical (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S3D</xref> and E) examples without oversaturation, we find LMdist chooses not to adjust pairwise distances as they are already the best representation of sample relationships. These experiments indicate LMdist is robust to overfitting and will not adjust already reliable pairwise values.</p>
    </sec>
  </sec>
  <sec>
    <title>4 Discussion</title>
    <p>We have demonstrated the usefulness of LMdist in a simulated gradient and in case studies of real environmental gradients across a range of published datasets. The simulated gradient can be nearly perfectly resolved with LMdist-adjusted distances. In various case studies, we find that LMdist can not only visually resolve the arched geometry of the data but can improve statistical outcomes in distance-based tests. LMdist is best used when pairwise beta diversity measures are oversaturated, presenting a left skew in the distribution of distances. These cases are typical of sampling a gradient or finding an arch in ordination, not as common for case-control or cohort studies. However, LMdist is also designed to resist overfitting, only correcting oversaturated pairwise values of which there may be none in a clustered dataset (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S3</xref>). In several gradient-based case studies, LMdist-adjusted distances improved the correlation of a known continuous gradient with the first axis of ordination, enabling more reliable use of linear regression approaches.</p>
    <p>By adjusting distance/dissimilarity measures with LMdist to decrease saturation of large pairwise distance values, and to increase trustworthiness of distances, ordination plots more accurately portray global relationships in the data. We have also demonstrated that LMdist reveals new information driving variation in the data orthogonal to the gradient, such as the second principal component in the soil dataset (<xref rid="btad727-F6" ref-type="fig">Fig. 6A</xref>). Prior to LMdist, the arch had occupied two or more dimensions instead of one, therefore leaving this orthogonal variation obscured. LMdist is therefore a powerful analysis technique in determining other interactions beyond the main environmental drivers in a study, allowing researchers to dive deeper into new explanatory variables. An important feature of this approach is that LMdist is completely unsupervised, not relying on foreknowledge of the gradient driving variation.</p>
    <p>LMdist is an efficient, data-driven algorithm for resolving arches and horseshoes driven by underlying gradients. With proper utilization, LMdist has shown promise in enabling more powerful statistical tests between environmental gradients and high-dimensional microbiome datasets. Analysis with LMdist-corrected distances may uncover new ecological variation that is orthogonal to environmental gradients, expanding the findings of previously published works.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="sup1" position="float" content-type="local-data">
      <label>btad727_Supplementary_Data</label>
      <media xlink:href="btad727_supplementary_data.docx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack id="ack1">
    <title>Acknowledgements</title>
    <p>We thank attendees of Great Lakes Bioinformatics 2023 for their valuable feedback regarding this work and the LMdist algorithm.</p>
  </ack>
  <sec>
    <title>Supplementary data</title>
    <p><xref rid="sup1" ref-type="supplementary-material">Supplementary data</xref> are available at <italic toggle="yes">Bioinformatics</italic> online.</p>
  </sec>
  <sec sec-type="COI-statement">
    <title>Conflict of interest</title>
    <p>D.K. serves as a paid Senior Scientific Advisor to Diversigen, a company involved in the commercialization of microbiome analysis.</p>
  </sec>
  <sec>
    <title>Funding</title>
    <p>This work was supported by NIH [R01AI121383 to D.K.] and Minnesota Partnership for Biotechnology and Medical Genomics [18.08 to D.K.].</p>
  </sec>
  <sec>
    <title>Data availabilty</title>
    <p>No new data were generated or analysed in support of this research. All data can be found in previously published works. Software and simulated dataset generation is available at <ext-link xlink:href="https://github.com/knights-lab/LMdist" ext-link-type="uri">https://github.com/knights-lab/LMdist</ext-link>.</p>
  </sec>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="btad727-B1">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Aggarwal</surname><given-names>CC</given-names></string-name>, <string-name><surname>Hinneburg</surname><given-names>A</given-names></string-name>, <string-name><surname>Keim</surname><given-names>DA.</given-names></string-name></person-group><part-title>On the surprising behavior of distance metrics in high dimensional space</part-title>. In: <person-group person-group-type="editor"><string-name><surname>Van den Bussche</surname><given-names>J</given-names></string-name>, <string-name><surname>Vianu</surname><given-names>V</given-names></string-name></person-group> (eds.), <source>Database Theory–ICDT 2001</source>. <publisher-loc>Berlin, Heidelberg</publisher-loc>: <publisher-name>Springer</publisher-name>, <year>2001</year>, <fpage>420</fpage>–<lpage>34</lpage>.</mixed-citation>
    </ref>
    <ref id="btad727-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Balasubramanian</surname><given-names>M</given-names></string-name>, <string-name><surname>Schwartz</surname><given-names>EL.</given-names></string-name></person-group><article-title>The isomap algorithm and topological stability</article-title>. <source>Science</source><year>2002</year>;<volume>295</volume>:<fpage>7</fpage>.<pub-id pub-id-type="pmid">11778013</pub-id></mixed-citation>
    </ref>
    <ref id="btad727-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Camiz</surname><given-names>S.</given-names></string-name></person-group><article-title>The guttman effect: its interpretation and a new redressing method</article-title>. <source>Data Anal Bull</source><year>2005</year>;<volume>5</volume>:<fpage>7</fpage>–<lpage>34</lpage>.</mixed-citation>
    </ref>
    <ref id="btad727-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Diaconis</surname><given-names>P</given-names></string-name>, <string-name><surname>Goel</surname><given-names>S</given-names></string-name>, <string-name><surname>Holmes</surname><given-names>S.</given-names></string-name></person-group><article-title>Horseshoes in multidimensional scaling and local kernel methods</article-title>. <source>Ann Appl Stat</source><year>2008</year>;<volume>2</volume>:<fpage>777</fpage>–<lpage>807</lpage>.</mixed-citation>
    </ref>
    <ref id="btad727-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Harris</surname><given-names>JK</given-names></string-name>, <string-name><surname>Caporaso</surname><given-names>JG</given-names></string-name>, <string-name><surname>Walker</surname><given-names>JJ</given-names></string-name></person-group><etal>et al</etal><article-title>Phylogenetic stratigraphy in the Guerrero Negro hypersaline microbial mat</article-title>. <source>ISME J</source><year>2013</year>;<volume>7</volume>:<fpage>50</fpage>–<lpage>60</lpage>.<pub-id pub-id-type="pmid">22832344</pub-id></mixed-citation>
    </ref>
    <ref id="btad727-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Harrison</surname><given-names>JG</given-names></string-name>, <string-name><surname>Calder</surname><given-names>WJ</given-names></string-name>, <string-name><surname>Shastry</surname><given-names>V</given-names></string-name></person-group><etal>et al</etal><article-title>Dirichlet-multinomial modelling outperforms alternatives for analysis of microbiome and other ecological count data</article-title>. <source>Mol Ecol Resour</source><year>2020</year>;<volume>20</volume>:<fpage>481</fpage>–<lpage>97</lpage>.<pub-id pub-id-type="pmid">31872949</pub-id></mixed-citation>
    </ref>
    <ref id="btad727-B7">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Hill</surname><given-names>MO</given-names></string-name>, <string-name><surname>Gauch</surname><given-names>HG.</given-names></string-name></person-group> Detrended correspondence analysis: an improved ordination technique. In: van der Maarel E (ed.), <italic toggle="yes">Classification and Ordination: Symposium on Advances in Vegetation Science, Nijmegen, The Netherlands</italic>, May 1979. Dordrecht: Springer Netherlands, <year>1980</year>, <fpage>47</fpage>–<lpage>58</lpage>.</mixed-citation>
    </ref>
    <ref id="btad727-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lauber</surname><given-names>CL</given-names></string-name>, <string-name><surname>Hamady</surname><given-names>M</given-names></string-name>, <string-name><surname>Knight</surname><given-names>R</given-names></string-name></person-group><etal>et al</etal><article-title>Pyrosequencing-based assessment of soil pH as a predictor of soil bacterial community structure at the continental scale</article-title>. <source>Appl Environ Microbiol</source><year>2009</year>;<volume>75</volume>:<fpage>5111</fpage>–<lpage>20</lpage>.<pub-id pub-id-type="pmid">19502440</pub-id></mixed-citation>
    </ref>
    <ref id="btad727-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Miller</surname><given-names>EA</given-names></string-name>, <string-name><surname>Winfield</surname><given-names>B</given-names></string-name>, <string-name><surname>Weber</surname><given-names>BP</given-names></string-name></person-group><etal>et al</etal><article-title>Convergence of the Turkey gut microbiota following cohabitation under commercial settings</article-title>. <source>J Animal Sci Biotechnol</source><year>2021</year>;<volume>12</volume>:<fpage>1</fpage>–<lpage>10</lpage>.</mixed-citation>
    </ref>
    <ref id="btad727-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Morton</surname><given-names>JT</given-names></string-name>, <string-name><surname>Toran</surname><given-names>L</given-names></string-name>, <string-name><surname>Edlund</surname><given-names>A</given-names></string-name></person-group><etal>et al</etal><article-title>Uncovering the horseshoe effect in microbial analyses</article-title>. <source>mSystems</source><year>2017</year>;<volume>2</volume>:<fpage>e00166-16</fpage>.<pub-id pub-id-type="pmid">28251186</pub-id></mixed-citation>
    </ref>
    <ref id="btad727-B11">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Ng</surname><given-names>KW</given-names></string-name>, <string-name><surname>Tian</surname><given-names>G-L</given-names></string-name>, <string-name><surname>Tang</surname><given-names>M-L.</given-names></string-name></person-group><source>Dirichlet and related distributions: theory, methods and applications</source>. Chichester, West Sussex, United Kingdom: <publisher-name>John Wiley &amp; Sons</publisher-name>, <year>2011</year>.</mixed-citation>
    </ref>
    <ref id="btad727-B12">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Oksanen</surname><given-names>J</given-names></string-name>, <string-name><surname>Simpson</surname><given-names>GL</given-names></string-name>, <string-name><surname>Blanchet</surname><given-names>FG</given-names></string-name></person-group><etal>et al</etal><italic toggle="yes">vegan: Community Ecology Package</italic>. R package version 2.6-4. <year>2022</year>. <ext-link xlink:href="https://CRAN.R-project.org/package=vegan" ext-link-type="uri">https://CRAN.R-project.org/package=vegan</ext-link>.</mixed-citation>
    </ref>
    <ref id="btad727-B13">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Palmer</surname><given-names>MW.</given-names></string-name></person-group><italic toggle="yes">Ordination Methods—An Overview: Ordination Methods for Ecologists</italic>. <ext-link xlink:href="https://ordination.okstate.edu/overview.htm" ext-link-type="uri">https://ordination.okstate.edu/overview.htm</ext-link>.</mixed-citation>
    </ref>
    <ref id="btad727-B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Pedregosa</surname><given-names>F</given-names></string-name>, <string-name><surname>Varoquaux</surname><given-names>G</given-names></string-name>, <string-name><surname>Gramfort</surname><given-names>A</given-names></string-name></person-group><etal>et al</etal><article-title>Scikit-learn: machine learning in Python</article-title>. <source>J Mach Learn Res</source><year>2011</year>;<volume>12</volume>:<fpage>2825</fpage>–<lpage>30</lpage>.</mixed-citation>
    </ref>
    <ref id="btad727-B15">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Podani</surname><given-names>J</given-names></string-name>, <string-name><surname>Miklós</surname><given-names>I.</given-names></string-name></person-group><article-title>Resemblance coefficients and the horseshoe effect in principal coordinates analysis</article-title>. <source>Ecology</source><year>2002</year>;<volume>83</volume>:<fpage>3331</fpage>–<lpage>43</lpage>.</mixed-citation>
    </ref>
    <ref id="btad727-B16">
      <mixed-citation publication-type="book"><collab>R Core Team</collab>. <source>R: A Language and Environment for Statistical Computing</source>. <publisher-loc>Vienna, Austria</publisher-loc>: <publisher-name>R Foundation for Statistical Computing</publisher-name>, <year>2021</year>.</mixed-citation>
    </ref>
    <ref id="btad727-B17">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Van der Maaten</surname><given-names>L</given-names></string-name>, <string-name><surname>Hinton</surname><given-names>G.</given-names></string-name></person-group><article-title>Visualizing data using t-SNE</article-title>. <source>J Mach Learn Res</source><year>2008</year>;<volume>9</volume>:<fpage>2579</fpage>–<lpage>605</lpage>.</mixed-citation>
    </ref>
    <ref id="btad727-B18">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Vangay</surname><given-names>P</given-names></string-name>, <string-name><surname>Johnson</surname><given-names>AJ</given-names></string-name>, <string-name><surname>Ward</surname><given-names>TL</given-names></string-name></person-group><etal>et al</etal><article-title>US immigration westernizes the human gut microbiome</article-title>. <source>Cell</source><year>2018</year>;<volume>175</volume>:<fpage>962</fpage>–<lpage>72.e10</lpage>.<pub-id pub-id-type="pmid">30388453</pub-id></mixed-citation>
    </ref>
    <ref id="btad727-B19">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Whittaker</surname><given-names>RH.</given-names></string-name></person-group><article-title>Vegetation of the great smoky mountains</article-title>. <source>Ecol Monogr</source><year>1956</year>;<volume>26</volume>:<fpage>1</fpage>–<lpage>80</lpage>.</mixed-citation>
    </ref>
    <ref id="btad727-B20">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Whittaker</surname><given-names>RH</given-names></string-name>, <string-name><surname>Damschen</surname><given-names>EI</given-names></string-name>, <string-name><surname>Harrison</surname><given-names>S.</given-names></string-name></person-group><article-title>Plant community data collected by Robert H. Whittaker in the Siskiyou Mountains, Oregon and California, USA</article-title>. <source>Ecology</source><year>2022</year>;<volume>103</volume>:<fpage>e3764</fpage>.<pub-id pub-id-type="pmid">35608560</pub-id></mixed-citation>
    </ref>
    <ref id="btad727-B21">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Yatsunenko</surname><given-names>T</given-names></string-name>, <string-name><surname>Rey</surname><given-names>FE</given-names></string-name>, <string-name><surname>Manary</surname><given-names>MJ</given-names></string-name></person-group><etal>et al</etal><article-title>Human gut microbiome viewed across age and geography</article-title>. <source>Nature</source><year>2012</year>;<volume>486</volume>:<fpage>222</fpage>–<lpage>7</lpage>.<pub-id pub-id-type="pmid">22699611</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10713119</article-id>
    <article-id pub-id-type="pmid">38060267</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btad727</article-id>
    <article-id pub-id-type="publisher-id">btad727</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Original Paper</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Genome Analysis</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01060</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>LMdist: Local Manifold distance accurately measures beta diversity in ecological gradients</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0001-5273-5795</contrib-id>
        <name>
          <surname>Hoops</surname>
          <given-names>Susan L</given-names>
        </name>
        <aff><institution>Department of Computer Science and Engineering, College of Science and Engineering, University of Minnesota</institution>, Minneapolis, MN 55455, <country country="US">United States</country></aff>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-8205-2511</contrib-id>
        <name>
          <surname>Knights</surname>
          <given-names>Dan</given-names>
        </name>
        <aff><institution>Department of Computer Science and Engineering, College of Science and Engineering, University of Minnesota</institution>, Minneapolis, MN 55455, <country country="US">United States</country></aff>
        <aff><institution>BioTechnology Institute, College of Biological Sciences, University of Minnesota</institution>, Saint Paul, MN 55108, <country country="US">United States</country></aff>
        <xref rid="btad727-cor1" ref-type="corresp"/>
        <!--dknights@umn.edu-->
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Marschall</surname>
          <given-names>Tobias</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="btad727-cor1">Corresponding author. Department of Computer Science &amp; Engineering, University of Minnesota, 4-192 Keller Hall, 200 Union Street SE, Minneapolis, Minnesota 55455, United States. E-mail: <email>dknights@umn.edu</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <month>12</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2023-12-07">
      <day>07</day>
      <month>12</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>07</day>
      <month>12</month>
      <year>2023</year>
    </pub-date>
    <volume>39</volume>
    <issue>12</issue>
    <elocation-id>btad727</elocation-id>
    <history>
      <date date-type="received">
        <day>11</day>
        <month>5</month>
        <year>2023</year>
      </date>
      <date date-type="rev-recd">
        <day>07</day>
        <month>11</month>
        <year>2023</year>
      </date>
      <date date-type="editorial-decision">
        <day>08</day>
        <month>11</month>
        <year>2023</year>
      </date>
      <date date-type="accepted">
        <day>06</day>
        <month>12</month>
        <year>2023</year>
      </date>
      <date date-type="corrected-typeset">
        <day>11</day>
        <month>12</month>
        <year>2023</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2023. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2023</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btad727.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Motivation</title>
        <p>Differentiating ecosystems poses a complex, high-dimensional problem constrained by capturing relevant variation across species profiles. Researchers use pairwise distances and subsequent dimensionality reduction to highlight variation in a few dimensions. Despite popularity in analysis of ecological data, these low-dimensional visualizations can contain geometric abnormalities such as “arch” and “horseshoe” effects, potentially obscuring the impact of environmental gradients. These abnormalities appear in ordination but are in fact a product of oversaturated large pairwise distances.</p>
      </sec>
      <sec id="s2">
        <title>Results</title>
        <p>We present Local Manifold distance (LMdist), an unsupervised algorithm which adjusts pairwise beta diversity measures to better represent true ecological distances between samples. Beta diversity measures can have a bounded dynamic range in depicting long environmental gradients with high species turnover. Using a graph structure, LMdist projects pairwise distances onto a manifold and traverses the manifold surface to adjust pairwise distances at the upper end of the beta diversity measure’s dynamic range. This allows for values beyond the range of the original measure. Not all datasets will have oversaturated pairwise distances, nor will capture variation that resembles a manifold, so LMdist adjusts only those pairwise values which may be undervalued in the presence of a sampled gradient. The adjusted distances serve as input for ordination and statistical testing. We demonstrate on real and simulated data that LMdist effectively recovers distances along known gradients and along complex manifolds such as the Swiss roll dataset. LMdist enables more powerful statistical tests for gradient effects and reveals variation orthogonal to the gradient.</p>
      </sec>
      <sec id="s3">
        <title>Availability and implementation</title>
        <p>Available on GitHub at <ext-link xlink:href="https://github.com/knights-lab/LMdist" ext-link-type="uri">https://github.com/knights-lab/LMdist</ext-link>.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>NIH</institution>
            <institution-id institution-id-type="DOI">10.13039/100000002</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>R01AI121383</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Minnesota Partnership for Biotechnology and Medical Genomics</institution>
          </institution-wrap>
        </funding-source>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="8"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>Beta diversity is a standard component of microbial and community ecology analysis. Ordination plots can be found in many microbiome and ecology publications. Geometric anomalies like the arch or horseshoe effects are prevalent in ordination plots of datasets containing an ecological gradient. Ecological gradients could include geochemistry, temperature, altitude, time, or other continuous factors. The arch effect displays samples along the gradient in a curved formation during ordination such that the gradient no longer appears 1D. The horseshoe effect, also referred to as the Guttman effect, is the more extreme relative of the arch effect and displays the samples along an ecological gradient in, as the name suggests, a horseshoe-like shape. Thus, in the horseshoe effect, ends of the gradient appear attracted to one another (<xref rid="btad727-B3" ref-type="bibr">Camiz 2005</xref>). In the early 1980s, ecologists hypothesized the extreme arch was a mathematical artifact obscuring ecological gradients (<xref rid="btad727-B7" ref-type="bibr">Hill and Gauch 1980</xref>), adopting the term “horseshoe” from popular political theory discourse.</p>
    <p>The arch and horseshoe effects are of concern for beta diversity analyses because they misrepresent the true ecological distances between samples lying along ecological gradients. <xref rid="btad727-F1" ref-type="fig">Figure 1</xref> illustrates an arch in soil samples taken along a pH gradient (<xref rid="btad727-B8" ref-type="bibr">Lauber <italic toggle="yes">et al.</italic> 2009</xref>). The pH gradient is clearly visible along the arched display of samples, but the arch makes the ends of the gradient (black squares for acidic pH, white diamonds for basic pH) appear almost as closely related to each other as to the middle of the pH gradient. It has been shown previously that this arch phenomenon is not caused by the ordination or visualization (<xref rid="btad727-B10" ref-type="bibr">Morton <italic toggle="yes">et al.</italic> 2017</xref>), but is instead a problem with the pairwise dissimilarities generating the ordination. Pairwise dissimilarities are the foundation of distance-based statistical analyses for beta diversity, so statistical outcomes may be weakened by pairwise measures misrepresenting sample relationships.</p>
    <fig position="float" id="btad727-F1">
      <label>Figure 1.</label>
      <caption>
        <p>PCoA with Jaccard distances of soil samples taken along a geochemical pH gradient. An arch in the data is clearly visible, making the ends of the pH gradient appear closer than expected.</p>
      </caption>
      <graphic xlink:href="btad727f1" position="float"/>
    </fig>
    <p>Despite a relatively high frequency of arches and horseshoes present in beta diversity analyses, these artifacts remain relatively underexplored and misunderstood in microbial ecology literature. A limited body of prior work has sought to explain and exemplify the problem as it appears. Ecologists Podani and Miklós explored the tendency of various distance and dissimilarity measures to result in a horseshoe shape in PCoA plots (<xref rid="btad727-B15" ref-type="bibr">Podani and Miklós 2002</xref>). Their findings indicated that researchers should select distance and dissimilarity measures which do not result in the arch, but their work lacks specificity about the causes or a notable solution. <xref rid="btad727-B4" ref-type="bibr">Diaconis <italic toggle="yes">et al.</italic> (2008)</xref> indicate some arches may be true representations, but that PCoA is limited in portraying them, and that manifold learning methods for ordination are better suited to data portraying an arch or horseshoe. Still, reasoning about the origin of the arch artifact was lacking until the work of <xref rid="btad727-B10" ref-type="bibr">Morton <italic toggle="yes">et al.</italic> (2017)</xref> pointed to sparsity of microbiome datasets as a possible source. <xref rid="btad727-B10" ref-type="bibr">Morton <italic toggle="yes">et al.</italic> (2017)</xref> demonstrate the limitations of distance and dissimilarity metrics in sparse datasets, although their solution, the Earth Mover Band Aware Distance (EMBAD) metric, is designed to rely upon known metadata in adjusting the ordination. EMBAD starts by sorting the samples according to a predetermined environmental variable, then simulating the flow of the taxonomic features between the samples along this ordered list. The EMBAD metric resolves the arched geometry with this adjustment but requires foreknowledge of the ecological gradient and direct use of this gradient in evaluating pairwise distances.</p>
    <p>Building on this existing body of work, we hypothesize that distance and dissimilarity metrics have a bounded dynamic range in describing pairwise relationships of a dataset, leading to an oversaturation of large pairwise measures. This effect is caused by samples that are sufficiently separated along the ecological gradient such that they have few or no species in common. Pairwise relationships are more reliable with many species in common, so samples from opposite ends of the gradient will instead have less informative pairwise distances to distinguish them. Upper bounds are known for some popular measures, such as Bray–Curtis and Jaccard dissimilarity which are restricted between zero and one. In these measures, counts of a subset of features will never exceed the total feature counts for a sample. Distance metrics, among them Euclidean distance, Aitchison distances, and UniFrac distances, are unbounded but may oversaturate in the same manner as bounded measures when there are few features in common. Euclidean distances are already known to be a poor choice for sparse datasets, common for microbial ecology (<xref rid="btad727-B1" ref-type="bibr">Aggarwal <italic toggle="yes">et al.</italic> 2001</xref>). When these large pairwise distances or dissimilarities become oversaturated, ordination algorithms may be limited in differentiating samples in a reduced dimensional space, leading to arches and horseshoes.</p>
    <p>Given our hypothesis that the bounded dynamic range of beta diversity measures cause arch and horseshoe effects, we propose Local Manifold distance (LMdist) for adjusting distances and dissimilarities to overcome the limited range of ecological distance measures in sparse datasets. LMdist borrows concepts from graph theory and statistics to better represent the high dimensional geometries of gradient-based datasets. LMdist not only corrects arches and horseshoes in ordination plots but improves the reliability of the underlying pairwise measures for downstream analyses such as statistical hypothesis testing.</p>
  </sec>
  <sec>
    <title>2 Materials and methods</title>
    <sec>
      <title>2.1 Local Manifold distance (LMdist) algorithm</title>
      <p>The LMdist algorithm represents the high dimensional beta diversity matrix as a graph, then measures distances between points along the graph-defined manifold. <xref rid="btad727-F2" ref-type="fig">Figure 2</xref> visually depicts the algorithm on a small simulated gradient dataset. Beginning with an undirected graph of nodes, representing samples, edges are drawn between sample nodes and their parameter-defined neighbors. Each edge is weighted by the distance/dissimilarity between samples at either end, compatible with any pairwise beta diversity measure. Some pairwise edges will be omitted from the graph if they are above the parameterized maximum value, called the neighborhood radius. The graph is then traversed to determine adjusted pairwise values. These adjusted values become the new input for ordination and subsequent statistical analysis, resolving the arch in ordinal plots and enabling more powerful linear regression.</p>
      <fig position="float" id="btad727-F2">
        <label>Figure 2.</label>
        <caption>
          <p>Visual representation of the LMdist algorithm. (A) Simulated samples appearing in an arch during PCoA with Bray–Curtis distances, colored by a simulated ecological gradient. (B) We represent these same samples as isolated nodes and define a neighborhood size by a radius parameter, then (C) add undirected edges between nodes within the parameter-defined neighborhood. (D) Continue to add edges between nodes in common neighborhoods until the graph is fully connected, all nodes can be reached by all other nodes. (E) This graph of nodes and edges is traversed to create adjusted pairwise values, which become the new input for ordination. (F) The resulting ordination can resolve the linear gradient in PCoA.</p>
        </caption>
        <graphic xlink:href="btad727f2" position="float"/>
      </fig>
      <sec>
        <title>2.1.1 Input pairwise measures form a connected graph</title>
        <p>The only required input for the LMdist algorithm is the original pairwise beta diversity matrix; the radius parameter allows for further fine-tuning of the algorithm. The algorithm is compatible with any pairwise measure, and LMdist will adjust these measures to produce a new set of pairwise distances. The neighborhood radius parameter determines which input pairwise values will be included in forming the undirected graph (<xref rid="btad727-F2" ref-type="fig">Fig. 2B and C</xref>). For example, given a radius value of 0.25, only pairwise values under 0.25 will be used to connect sample nodes in the graph. Therefore, we can think of the radius parameter as the radius of a sphere in the original beta diversity space, centered at any given sample node. All other sample nodes falling within the bounds of this sphere will be connected to the centroid node as they are considered “neighbors.” Each sample node will be the centroid for this process, until all nodes have been considered and connected to any neighbors to form edges in the graph (<xref rid="btad727-F2" ref-type="fig">Fig. 2D</xref>).</p>
        <p>After the neighborhood edges have been determined per node using a given radius, the resulting graph may be a disconnected graph. This is expected when samples have not been collected evenly along a gradient, or if the chosen radius is small. If disconnected, a minimum spanning tree (MST) is computed using original pairwise distances for all sample nodes, which traverses all nodes in the shortest possible path. Comparing this MST to the graph of neighbor edges, we can borrow minimal edges from the MST to make the graph fully connected. As a result, we will have a fully connected graph where the minimum possible number of edges exceed the radius parameter, as needed to fully connect the graph.</p>
      </sec>
      <sec>
        <title>2.1.2 Recalculate pairwise distances by traversing the graph</title>
        <p>This connected graph is used to recalculate pairwise distances/dissimilarities between samples. We calculate a single pairwise distance by traversing from one sample node along any available edges to the other node, in the shortest possible path (<xref rid="btad727-F2" ref-type="fig">Fig. 2E</xref>). The adjusted pairwise value is then the sum of all edges traversed in this shortest path between two nodes. This traversal is completed for all pairs of sample nodes, such that we have adjusted pairwise values for any sample relationships exceeding the trusted, radius-defined neighborhood.</p>
      </sec>
      <sec>
        <title>2.1.3 Parameters can fine-tune results of LMdist</title>
        <p>Fine-tuning of LMdist can be achieved by adjusting the radius parameter, calibrating optimization criteria, or smoothing results via a Gaussian weighting. A large radius, close to the maximum distance, results in a very small adjustment to the original distance matrix. Conversely, a very small radius will cause the largest adjustment, because distant nodes will be connected in the graph only by traversing many intermediate nodes.</p>
        <p>By default, the algorithm calculates LMdist using 50 different radii, picking the largest radius which meets two optimization criteria. First, any radius which results in a graph with an average degree, the average number of connections per node, &lt;10% of the number of samples (parameterized as “phi” with default 0.10) will be excluded from the results of LMdist. This limitation is intended to avoid overfitting, resulting in a distorted graph that might exaggerate the distances between samples. The second criterion is a multi-objective function which allows LMdist to guess the best radial value for a given dataset. This multi-objective optimization maximizes both the radius and a correlation between the LMdist-adjusted distances and the Euclidean distances in resulting ordination (PCoA) space, using the first <italic toggle="yes">n</italic> dimensions, up to 10, accounting for &gt;80% variance. To give priority to trusting more original distances, a correlation for a smaller radius must exceed the previous best correlation by a parameterized value of epsilon (default 0.05).</p>
        <p>The multi-objective function works for many cases, but still places confidence in a single radius value. We therefore implemented an optional parameter (“smooth” defaulted to False) for smoothing results of multiple radii. If smoothing is preferred, a Gaussian weight centered at the chosen radius is applied to the results of up to 50 radii, such that many radial values will influence the results, generating a smoothed version of the corrected pairwise distances.</p>
      </sec>
      <sec>
        <title>2.1.4 LMdist produces an adjusted distance matrix</title>
        <p>The result of the LMdist algorithm, implemented in R (<xref rid="btad727-B16" ref-type="bibr">R Core Team 2021</xref>), is an adjusted pairwise distance object, the same format as the output of the vegdist function in the vegan package (<xref rid="btad727-B12" ref-type="bibr">Oksanen <italic toggle="yes">et al.</italic> 2022</xref>). These adjusted values can replace the original pairwise distance matrix in subsequent beta diversity analysis. In ordination, the adjusted values become the new input for ordinal methods accepting pairwise measures, such as PCoA or NMDS. Results in a simulated dataset and case studies have shown that LMdist reduces the arched appearance of the data, and if an environmental gradient is present LMdist better resolves the gradient, revealing variation orthogonal to the gradient in other ordinal dimensions.</p>
      </sec>
      <sec>
        <title>2.1.5 Use cases have oversaturated distances</title>
        <p>LMdist can be used with any pairwise distance matrix but is best utilized for uncovering gradients. While some gradients may already be well represented, an arch or horseshoe in ordination tends to appear when the pairwise distance matrices become oversaturated. We define oversaturated distances as a large left skew in the distribution of pairwise distances, because large distances are relatively oversaturated compared to the smaller pairwise distances. This oversaturation indicates a disagreement between the sampled gradient and the pairwise sample distances, as is demonstrated in implementation with a simulated dataset to follow (<xref rid="btad727-F4" ref-type="fig">Fig. 4</xref>). Therefore, we propose LMdist is most appropriately used in studies with a long underlying gradient or oversaturated distances, as these samples will be better represented when accounting for the underlying manifold. Case-control studies may not need adjustment by LMdist, most importantly if the pairwise distances are not oversaturated with large values.</p>
      </sec>
    </sec>
    <sec>
      <title>2.2 Simulated dataset</title>
      <p>For initial validation of this algorithm, we created a simulated dataset of taxonomic features evenly distributed along an artificial gradient, mimicking a gradient-driven ecosystem. The final simulated dataset contains 50 samples and 231 taxonomic features. Noisy samples added to the dataset illustrate the sensitivity of the algorithm, which has remained stable in uncovering the gradient.</p>
      <sec>
        <title>2.2.1 Coenoclines emulate species abundance along a gradient</title>
        <p>In creating a simulated dataset we utilized coenoclines, representations of species response functions along some gradient (<xref rid="btad727-B13" ref-type="bibr">Palmer 2013</xref>). We presumed a unimodal response curve for each species along the gradient, supported by further exploration of the soil dataset (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S1</xref>). For our simulated gradient, we distributed artificial species features evenly along a gradient, using Gaussian coenoclines (<xref rid="btad727-F3" ref-type="fig">Fig. 3A</xref>). For an example gradient length of 1000 (arbitrary units), the artificial species distributions are simulated as Gaussian curves centered 10 steps apart with a standard deviation of 150, allowing for density of overlap between species. Samples are obtained from these coenoclines by sampling values from the densities of the Gaussian curves at a given point, attributing the amounts of every artificial species at that point in the gradient to the sample (<xref rid="btad727-F3" ref-type="fig">Fig. 3A</xref>). A total of 50 samples are taken, evenly distributed along the full gradient length. The absolute heights of the Gaussian coenoclines are arbitrary because samples are normalized to relative abundances before analysis.</p>
        <fig position="float" id="btad727-F3">
          <label>Figure 3.</label>
          <caption>
            <p>Creation of simulated dataset. (A) Coenoclines representing roughly every 10th taxonomic feature distributed along the simulated gradient, annotated to show how sample 10 would be collected. Sample 10 would be comprised of the amounts of each feature as seen in the visual cross section of the feature coenoclines. (B) Heatmap of samples collected, displayed in order with the noise samples preceding each original sample.</p>
          </caption>
          <graphic xlink:href="btad727f3" position="float"/>
        </fig>
      </sec>
      <sec>
        <title>2.2.2 Sampling noise from a Dirichlet distribution</title>
        <p>To add noise to the simulated dataset, each mixture of sampled species values is used as the prior for a Dirichlet distribution, the generative distribution of the multinomial distribution and the multivariate generalization of the Beta distribution (<xref rid="btad727-B11" ref-type="bibr">Ng <italic toggle="yes">et al.</italic> 2011</xref>), producing 50 additional samples as noise, mimicking the original samples (<xref rid="btad727-F3" ref-type="fig">Fig. 3B</xref>). We chose the Dirichlet distribution because it allows for fine-tuning the degree of noise and because microbial ecology samples have been modeled previously using a Dirichlet distribution (<xref rid="btad727-B6" ref-type="bibr">Harrison <italic toggle="yes">et al.</italic> 2020</xref>).</p>
      </sec>
    </sec>
  </sec>
  <sec>
    <title>3 Results</title>
    <sec>
      <title>3.1 Simulated gradient</title>
      <p><xref rid="btad727-F4" ref-type="fig">Figure 4</xref> shows the simulated dataset after application of the LMdist algorithm to adjust distances. In the original Bray–Curtis distances, we can see from <xref rid="btad727-F4" ref-type="fig">Fig. 4B</xref> that the Bray–Curtis distances on the <italic toggle="yes">y</italic>-axis are distributed with the opposite skew of the known gradient distances on the <italic toggle="yes">x</italic>-axis, resulting in a plateau rather than the expected <italic toggle="yes">y</italic> = <italic toggle="yes">x</italic> line. This oversaturation of large distances results in the samples forming a horseshoe in PCoA ordination (<xref rid="btad727-F4" ref-type="fig">Fig. 4A</xref>). After applying LMdist with a radius of 0.4, the gradient distances and adjusted distances now resemble one another (<xref rid="btad727-F4" ref-type="fig">Fig. 4D</xref>) and the gradient is resolved in PCoA along the first principal component (Pearson correlation 0.999, improved from 0.967 prior to LMdist) such that the second axis may now be accounting for noise (Levene’s test of variance, <italic toggle="yes">P </italic>&lt;<italic toggle="yes"> </italic>.001) (<xref rid="btad727-F4" ref-type="fig">Fig. 4C</xref>).</p>
      <fig position="float" id="btad727-F4">
        <label>Figure 4.</label>
        <caption>
          <p>LMdist applied to the simulated gradient. (A) PCoA with Bray–Curtis distances of 100 simulated samples, colored by approximate position on gradient. (B) Comparison plot of community distances (Bray–Curtis) and gradient distances (Euclidean). We can see the community distances plateau at the top of the gradient, causing a mismatch between the density of community and gradient distances. (C) PCoA with LMdist-adjusted distances, where the horseshoe is largely resolved along the first principal component. (D) The same comparison plot between the adjusted community distances and gradient distances, the distribution of which is better balanced to one another after LMdist is applied.</p>
        </caption>
        <graphic xlink:href="btad727f4" position="float"/>
      </fig>
    </sec>
    <sec>
      <title>3.2 Simulated Swiss roll</title>
      <p>The Swiss roll dataset has been used to exemplify an obvious low-dimensional manifold structure in demonstrating manifold learning approaches. <xref rid="btad727-F5" ref-type="fig">Figure 5</xref> shows 300 samples in a Swiss roll, created using the scikit-learn python package (<xref rid="btad727-B14" ref-type="bibr">Pedregosa <italic toggle="yes">et al.</italic> 2011</xref>), in the original three dimensions. We then compare to dimensionality reduction by principal component analysis (PCA), t-distributed Stochastic Neighbor Embedding (t-SNE) (<xref rid="btad727-B17" ref-type="bibr">Van der Maaten and Hinton 2008</xref>), Isomap (<xref rid="btad727-B2" ref-type="bibr">Balasubramanian and Schwartz 2002</xref>), and LMdist. Fine-tuning of parameters was necessary for all algorithms to obtain the best possible flattening of the manifold in 2D space.</p>
      <fig position="float" id="btad727-F5">
        <label>Figure 5.</label>
        <caption>
          <p>LMdist applied to the Swiss roll dataset. (A) The Swiss roll dataset with 300 samples in the original 3 dimensions, created with the scikit-learn package in Python. (B) PCA of the Swiss roll dataset. (C) t-SNE of the Swiss roll dataset using perplexity 60. (D) Isomap of Swiss roll dataset with neighborhood size 5. (E) LMdist of Swiss roll dataset with neighborhood radius 0.62.</p>
        </caption>
        <graphic xlink:href="btad727f5" position="float"/>
      </fig>
      <p>As expected, the manifold learning approaches and LMdist outperform PCA, due to their parameter-defined perplexity and ability to recover some of the underlying structure of the data. LMdist proves particularly useful in two respects compared to these manifold learning approaches. First, LMdist appears to most reliably uncover sample relationships, as it is not overly sensitive to hyperparameters and a series of transformations as is the case of t-SNE, nor does LMdist assume neighborhoods of equal sample sizes as in Isomap. The neighborhood radius used by LMdist therefore resolves the manifold, but also more clearly resolves the variation along the manifold in the second dimension. Secondly, LMdist is advantageous as the only approach to outputs an actual distance matrix, which can then be used for distance-based statistical testing. Typically, the adjusted distance matrix is only implicit within manifold learning algorithms, precluding their use in downstream analysis such as statistical testing of beta diversity.</p>
    </sec>
    <sec>
      <title>3.3 Case studies demonstrating the arch effect</title>
      <p>To exemplify the usefulness of the LMdist algorithm, we have gathered datasets from a variety of microbiome and ecological studies (<xref rid="btad727-F6" ref-type="fig">Fig. 6</xref>). As previously described, oversaturation of the distance and dissimilarity measures is often driven by underlying ecological gradients in the dataset. Therefore, datasets were selected which have a measurable environmental gradient and which exhibited an arch or horseshoe in ordination.</p>
      <fig position="float" id="btad727-F6">
        <label>Figure 6.</label>
        <caption>
          <p>PCoAs before and after adjusting pairwise values with LMdist on default settings, displayed with fixed square perspective. (A) Soil samples along a pH gradient, Jaccard dissimilarity and LMdist with radius 0.952. (B) Microbial mat samples at various depths, Jaccard dissimilarity and LMdist with radius 0.758. (C) Longitudinal Turkey cecum samples, Bray–Curtis dissimilarity and LMdist with radius 0.599 (note: changed epsilon to 0.01 since the default epsilon was too small). (D) Herbs and shrubs community data collected by Robert Whittaker in the Siskiyou Mountains, Bray–Curtis dissimilarity and LMdist with radius 0.93.</p>
        </caption>
        <graphic xlink:href="btad727f6" position="float"/>
      </fig>
      <p>First, we return to the soil samples from across North and South America comprising a pH gradient (<xref rid="btad727-F6" ref-type="fig">Fig. 6A</xref>). Lauber <italic toggle="yes">et al.</italic> found these bacterial communities to be significantly correlated with soil pH (ANOSIM, <italic toggle="yes">P </italic>=<italic toggle="yes"> </italic>.001; Mantel test Spearman, <italic toggle="yes">r</italic> = 0.73), largely driven by the presence and absence of the phylum <italic toggle="yes">Acidobacteria</italic>, known to favor acidic environments, as well as the phyla <italic toggle="yes">Bacteroidetes</italic> and <italic toggle="yes">Actinobacteria</italic> which prefer comparatively basic environments (<xref rid="btad727-B8" ref-type="bibr">Lauber <italic toggle="yes">et al.</italic> 2009</xref>). After applying LMdist, we can see that the arch is largely resolved in the visualization, with no change in significance of distance-based testing (ANOSIM, <italic toggle="yes">P</italic> = .001; Mantel test Spearman, <italic toggle="yes">r</italic> = 0.74). Interestingly, though, we find that PC2 now resolves some variation in the data orthogonal to the pH gradient in PC1, correlating with amount of silt clay (Pearson cor = 0.51, <italic toggle="yes">P </italic>&lt;<italic toggle="yes"> </italic>.001; PERMANOVA, <italic toggle="yes">P </italic>&lt;<italic toggle="yes"> </italic>.001) and annual season temperature (Pearson cor = 0.49, <italic toggle="yes">P </italic>&lt;<italic toggle="yes"> </italic>.001; PERMANOVA, <italic toggle="yes">P </italic>&lt;<italic toggle="yes"> </italic>.001). While silt clay and annual season temperature were significant prior to LMdist using PERMANOVA (<italic toggle="yes">P </italic>&lt;<italic toggle="yes"> </italic>.05), <italic toggle="yes">F</italic>-scores for silt clay, annual season temperature, and pH all increased, implying the effect size is better represented after application of LMdist. This new finding with silt clay and annual season temperature orthogonal to the pH gradient was not mentioned in the original publication and might have been obscured by the arch in the original analysis.</p>
      <p>Sampling increasing depths of the hypersaline microbial mats of Guerrero Negro in Baja California Sur provides another gradient analysis on a smaller dataset. The authors confirm that the depths of microbial mats are phylogenetically stratified, as light and oxygen produced by photosynthesis rapidly diminishes with depth (<xref rid="btad727-B5" ref-type="bibr">Harris <italic toggle="yes">et al.</italic> 2013</xref>). Each depth from the top of the microbial mat to a depth of 34 mm is sampled twice and sequenced with 454 pyrosequencing technology. We can clearly make out that the depths follow a horseshoe pattern in the original ordination (<xref rid="btad727-F6" ref-type="fig">Fig. 6B</xref>). Using LMdist, we can resolve the horseshoe while trusting many distances (neighborhood radius 0.758 for Jaccard dissimilarity is chosen by the default algorithm) (<xref rid="btad727-F6" ref-type="fig">Fig. 6B</xref>). The correlation of the gradient with the first principal component (Spearman rho = 0.941, <italic toggle="yes">P </italic>&lt;<italic toggle="yes"> </italic>.001) improved after application of LMdist without changing significance (Pearson cor = 0.987, <italic toggle="yes">P </italic>&lt;<italic toggle="yes"> </italic>.001).</p>
      <p>Our next case study is a longitudinal, observational experiment comparing the Turkey gut when raised in an isolated hatch brood system as opposed to a commercial brood pen (<xref rid="btad727-F6" ref-type="fig">Fig. 6C</xref>) (<xref rid="btad727-B9" ref-type="bibr">Miller <italic toggle="yes">et al.</italic> 2021</xref>). Ignoring the first day samples since they formed a separate cluster, we can resolve the longitudinal changes using LMdist. The authors found that beta diversity significantly separated the samples by the collection date (PERMANOVA, F-score = 23.8, <italic toggle="yes">P </italic>&lt;<italic toggle="yes"> </italic>.001) and upbringing groups (Mantel test, <italic toggle="yes">r</italic> = 0.38, <italic toggle="yes">P </italic>=<italic toggle="yes"> </italic>.001). After applying LMdist, we found the collection day gradient improved the effect in PERMANOVA found between collection day and pairwise measures (F-score = 57.63, <italic toggle="yes">P </italic>&lt;<italic toggle="yes"> </italic>.001) without changing the significance found for raising group (PERMANOVA, <italic toggle="yes">P </italic>=<italic toggle="yes"> </italic>.007).</p>
      <p>Finally, we evaluate the usefulness of LMdist applied to herb and shrub community data collected by Robert Whittaker in the Siskiyou Mountains along an elevation gradient (<xref rid="btad727-F6" ref-type="fig">Fig. 6D</xref>) (<xref rid="btad727-B20" ref-type="bibr">Whittaker <italic toggle="yes">et al.</italic> 2022</xref>). Restricting to just the communities in diorite soil, the elevation gradient forms an arch in PCoA of Bray–Curtis dissimilarities. Again, the effect size of the elevation gradient (PERMANOVA, F-score = 36.8, <italic toggle="yes">P </italic>=<italic toggle="yes"> </italic>.001) is improved after applying LMdist (PERMANOVA, F-score = 92.4, <italic toggle="yes">P </italic>=<italic toggle="yes"> </italic>.001).</p>
      <p>These case studies exhibiting gradient-driven arches and horseshoes demonstrate how LMdist may better resolve gradient effects. Resolving gradients along one principal component enables more powerful linear statistical tests of gradient impact. LMdist also uncovers other variation orthogonal to the gradient, presenting some novel findings previously obscured by horseshoes. The optional gaussian smoothing parameter in LMdist minimally alters output for these case studies (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S2</xref>), implying LMdist with both a single radius and smoothing present similar, reasonable solutions.</p>
      <p>In cases where an underlying gradient is not present, such as a clustered dataset, we have found that in both simulated and real clustered data LMdist does not resolve an arch unless the original pairwise beta diversity values are truly oversaturated (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S3</xref>) (<xref rid="btad727-B19" ref-type="bibr">Whittaker 1956</xref>, <xref rid="btad727-B21" ref-type="bibr">Yatsunenko <italic toggle="yes">et al.</italic> 2012</xref>, <xref rid="btad727-B18" ref-type="bibr">Vangay <italic toggle="yes">et al.</italic> 2018</xref>). One can test for oversaturation by evaluating if the data presents a left skew in the distribution of pairwise distances. If no left skew is present, we expect there is no long underlying manifold, nor oversaturation of pairwise values. When we apply LMdist to simulated (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S3C</xref>) practical (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S3D</xref> and E) examples without oversaturation, we find LMdist chooses not to adjust pairwise distances as they are already the best representation of sample relationships. These experiments indicate LMdist is robust to overfitting and will not adjust already reliable pairwise values.</p>
    </sec>
  </sec>
  <sec>
    <title>4 Discussion</title>
    <p>We have demonstrated the usefulness of LMdist in a simulated gradient and in case studies of real environmental gradients across a range of published datasets. The simulated gradient can be nearly perfectly resolved with LMdist-adjusted distances. In various case studies, we find that LMdist can not only visually resolve the arched geometry of the data but can improve statistical outcomes in distance-based tests. LMdist is best used when pairwise beta diversity measures are oversaturated, presenting a left skew in the distribution of distances. These cases are typical of sampling a gradient or finding an arch in ordination, not as common for case-control or cohort studies. However, LMdist is also designed to resist overfitting, only correcting oversaturated pairwise values of which there may be none in a clustered dataset (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S3</xref>). In several gradient-based case studies, LMdist-adjusted distances improved the correlation of a known continuous gradient with the first axis of ordination, enabling more reliable use of linear regression approaches.</p>
    <p>By adjusting distance/dissimilarity measures with LMdist to decrease saturation of large pairwise distance values, and to increase trustworthiness of distances, ordination plots more accurately portray global relationships in the data. We have also demonstrated that LMdist reveals new information driving variation in the data orthogonal to the gradient, such as the second principal component in the soil dataset (<xref rid="btad727-F6" ref-type="fig">Fig. 6A</xref>). Prior to LMdist, the arch had occupied two or more dimensions instead of one, therefore leaving this orthogonal variation obscured. LMdist is therefore a powerful analysis technique in determining other interactions beyond the main environmental drivers in a study, allowing researchers to dive deeper into new explanatory variables. An important feature of this approach is that LMdist is completely unsupervised, not relying on foreknowledge of the gradient driving variation.</p>
    <p>LMdist is an efficient, data-driven algorithm for resolving arches and horseshoes driven by underlying gradients. With proper utilization, LMdist has shown promise in enabling more powerful statistical tests between environmental gradients and high-dimensional microbiome datasets. Analysis with LMdist-corrected distances may uncover new ecological variation that is orthogonal to environmental gradients, expanding the findings of previously published works.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="sup1" position="float" content-type="local-data">
      <label>btad727_Supplementary_Data</label>
      <media xlink:href="btad727_supplementary_data.docx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack id="ack1">
    <title>Acknowledgements</title>
    <p>We thank attendees of Great Lakes Bioinformatics 2023 for their valuable feedback regarding this work and the LMdist algorithm.</p>
  </ack>
  <sec>
    <title>Supplementary data</title>
    <p><xref rid="sup1" ref-type="supplementary-material">Supplementary data</xref> are available at <italic toggle="yes">Bioinformatics</italic> online.</p>
  </sec>
  <sec sec-type="COI-statement">
    <title>Conflict of interest</title>
    <p>D.K. serves as a paid Senior Scientific Advisor to Diversigen, a company involved in the commercialization of microbiome analysis.</p>
  </sec>
  <sec>
    <title>Funding</title>
    <p>This work was supported by NIH [R01AI121383 to D.K.] and Minnesota Partnership for Biotechnology and Medical Genomics [18.08 to D.K.].</p>
  </sec>
  <sec>
    <title>Data availabilty</title>
    <p>No new data were generated or analysed in support of this research. All data can be found in previously published works. Software and simulated dataset generation is available at <ext-link xlink:href="https://github.com/knights-lab/LMdist" ext-link-type="uri">https://github.com/knights-lab/LMdist</ext-link>.</p>
  </sec>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="btad727-B1">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Aggarwal</surname><given-names>CC</given-names></string-name>, <string-name><surname>Hinneburg</surname><given-names>A</given-names></string-name>, <string-name><surname>Keim</surname><given-names>DA.</given-names></string-name></person-group><part-title>On the surprising behavior of distance metrics in high dimensional space</part-title>. In: <person-group person-group-type="editor"><string-name><surname>Van den Bussche</surname><given-names>J</given-names></string-name>, <string-name><surname>Vianu</surname><given-names>V</given-names></string-name></person-group> (eds.), <source>Database Theory–ICDT 2001</source>. <publisher-loc>Berlin, Heidelberg</publisher-loc>: <publisher-name>Springer</publisher-name>, <year>2001</year>, <fpage>420</fpage>–<lpage>34</lpage>.</mixed-citation>
    </ref>
    <ref id="btad727-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Balasubramanian</surname><given-names>M</given-names></string-name>, <string-name><surname>Schwartz</surname><given-names>EL.</given-names></string-name></person-group><article-title>The isomap algorithm and topological stability</article-title>. <source>Science</source><year>2002</year>;<volume>295</volume>:<fpage>7</fpage>.<pub-id pub-id-type="pmid">11778013</pub-id></mixed-citation>
    </ref>
    <ref id="btad727-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Camiz</surname><given-names>S.</given-names></string-name></person-group><article-title>The guttman effect: its interpretation and a new redressing method</article-title>. <source>Data Anal Bull</source><year>2005</year>;<volume>5</volume>:<fpage>7</fpage>–<lpage>34</lpage>.</mixed-citation>
    </ref>
    <ref id="btad727-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Diaconis</surname><given-names>P</given-names></string-name>, <string-name><surname>Goel</surname><given-names>S</given-names></string-name>, <string-name><surname>Holmes</surname><given-names>S.</given-names></string-name></person-group><article-title>Horseshoes in multidimensional scaling and local kernel methods</article-title>. <source>Ann Appl Stat</source><year>2008</year>;<volume>2</volume>:<fpage>777</fpage>–<lpage>807</lpage>.</mixed-citation>
    </ref>
    <ref id="btad727-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Harris</surname><given-names>JK</given-names></string-name>, <string-name><surname>Caporaso</surname><given-names>JG</given-names></string-name>, <string-name><surname>Walker</surname><given-names>JJ</given-names></string-name></person-group><etal>et al</etal><article-title>Phylogenetic stratigraphy in the Guerrero Negro hypersaline microbial mat</article-title>. <source>ISME J</source><year>2013</year>;<volume>7</volume>:<fpage>50</fpage>–<lpage>60</lpage>.<pub-id pub-id-type="pmid">22832344</pub-id></mixed-citation>
    </ref>
    <ref id="btad727-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Harrison</surname><given-names>JG</given-names></string-name>, <string-name><surname>Calder</surname><given-names>WJ</given-names></string-name>, <string-name><surname>Shastry</surname><given-names>V</given-names></string-name></person-group><etal>et al</etal><article-title>Dirichlet-multinomial modelling outperforms alternatives for analysis of microbiome and other ecological count data</article-title>. <source>Mol Ecol Resour</source><year>2020</year>;<volume>20</volume>:<fpage>481</fpage>–<lpage>97</lpage>.<pub-id pub-id-type="pmid">31872949</pub-id></mixed-citation>
    </ref>
    <ref id="btad727-B7">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Hill</surname><given-names>MO</given-names></string-name>, <string-name><surname>Gauch</surname><given-names>HG.</given-names></string-name></person-group> Detrended correspondence analysis: an improved ordination technique. In: van der Maarel E (ed.), <italic toggle="yes">Classification and Ordination: Symposium on Advances in Vegetation Science, Nijmegen, The Netherlands</italic>, May 1979. Dordrecht: Springer Netherlands, <year>1980</year>, <fpage>47</fpage>–<lpage>58</lpage>.</mixed-citation>
    </ref>
    <ref id="btad727-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lauber</surname><given-names>CL</given-names></string-name>, <string-name><surname>Hamady</surname><given-names>M</given-names></string-name>, <string-name><surname>Knight</surname><given-names>R</given-names></string-name></person-group><etal>et al</etal><article-title>Pyrosequencing-based assessment of soil pH as a predictor of soil bacterial community structure at the continental scale</article-title>. <source>Appl Environ Microbiol</source><year>2009</year>;<volume>75</volume>:<fpage>5111</fpage>–<lpage>20</lpage>.<pub-id pub-id-type="pmid">19502440</pub-id></mixed-citation>
    </ref>
    <ref id="btad727-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Miller</surname><given-names>EA</given-names></string-name>, <string-name><surname>Winfield</surname><given-names>B</given-names></string-name>, <string-name><surname>Weber</surname><given-names>BP</given-names></string-name></person-group><etal>et al</etal><article-title>Convergence of the Turkey gut microbiota following cohabitation under commercial settings</article-title>. <source>J Animal Sci Biotechnol</source><year>2021</year>;<volume>12</volume>:<fpage>1</fpage>–<lpage>10</lpage>.</mixed-citation>
    </ref>
    <ref id="btad727-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Morton</surname><given-names>JT</given-names></string-name>, <string-name><surname>Toran</surname><given-names>L</given-names></string-name>, <string-name><surname>Edlund</surname><given-names>A</given-names></string-name></person-group><etal>et al</etal><article-title>Uncovering the horseshoe effect in microbial analyses</article-title>. <source>mSystems</source><year>2017</year>;<volume>2</volume>:<fpage>e00166-16</fpage>.<pub-id pub-id-type="pmid">28251186</pub-id></mixed-citation>
    </ref>
    <ref id="btad727-B11">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Ng</surname><given-names>KW</given-names></string-name>, <string-name><surname>Tian</surname><given-names>G-L</given-names></string-name>, <string-name><surname>Tang</surname><given-names>M-L.</given-names></string-name></person-group><source>Dirichlet and related distributions: theory, methods and applications</source>. Chichester, West Sussex, United Kingdom: <publisher-name>John Wiley &amp; Sons</publisher-name>, <year>2011</year>.</mixed-citation>
    </ref>
    <ref id="btad727-B12">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Oksanen</surname><given-names>J</given-names></string-name>, <string-name><surname>Simpson</surname><given-names>GL</given-names></string-name>, <string-name><surname>Blanchet</surname><given-names>FG</given-names></string-name></person-group><etal>et al</etal><italic toggle="yes">vegan: Community Ecology Package</italic>. R package version 2.6-4. <year>2022</year>. <ext-link xlink:href="https://CRAN.R-project.org/package=vegan" ext-link-type="uri">https://CRAN.R-project.org/package=vegan</ext-link>.</mixed-citation>
    </ref>
    <ref id="btad727-B13">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Palmer</surname><given-names>MW.</given-names></string-name></person-group><italic toggle="yes">Ordination Methods—An Overview: Ordination Methods for Ecologists</italic>. <ext-link xlink:href="https://ordination.okstate.edu/overview.htm" ext-link-type="uri">https://ordination.okstate.edu/overview.htm</ext-link>.</mixed-citation>
    </ref>
    <ref id="btad727-B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Pedregosa</surname><given-names>F</given-names></string-name>, <string-name><surname>Varoquaux</surname><given-names>G</given-names></string-name>, <string-name><surname>Gramfort</surname><given-names>A</given-names></string-name></person-group><etal>et al</etal><article-title>Scikit-learn: machine learning in Python</article-title>. <source>J Mach Learn Res</source><year>2011</year>;<volume>12</volume>:<fpage>2825</fpage>–<lpage>30</lpage>.</mixed-citation>
    </ref>
    <ref id="btad727-B15">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Podani</surname><given-names>J</given-names></string-name>, <string-name><surname>Miklós</surname><given-names>I.</given-names></string-name></person-group><article-title>Resemblance coefficients and the horseshoe effect in principal coordinates analysis</article-title>. <source>Ecology</source><year>2002</year>;<volume>83</volume>:<fpage>3331</fpage>–<lpage>43</lpage>.</mixed-citation>
    </ref>
    <ref id="btad727-B16">
      <mixed-citation publication-type="book"><collab>R Core Team</collab>. <source>R: A Language and Environment for Statistical Computing</source>. <publisher-loc>Vienna, Austria</publisher-loc>: <publisher-name>R Foundation for Statistical Computing</publisher-name>, <year>2021</year>.</mixed-citation>
    </ref>
    <ref id="btad727-B17">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Van der Maaten</surname><given-names>L</given-names></string-name>, <string-name><surname>Hinton</surname><given-names>G.</given-names></string-name></person-group><article-title>Visualizing data using t-SNE</article-title>. <source>J Mach Learn Res</source><year>2008</year>;<volume>9</volume>:<fpage>2579</fpage>–<lpage>605</lpage>.</mixed-citation>
    </ref>
    <ref id="btad727-B18">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Vangay</surname><given-names>P</given-names></string-name>, <string-name><surname>Johnson</surname><given-names>AJ</given-names></string-name>, <string-name><surname>Ward</surname><given-names>TL</given-names></string-name></person-group><etal>et al</etal><article-title>US immigration westernizes the human gut microbiome</article-title>. <source>Cell</source><year>2018</year>;<volume>175</volume>:<fpage>962</fpage>–<lpage>72.e10</lpage>.<pub-id pub-id-type="pmid">30388453</pub-id></mixed-citation>
    </ref>
    <ref id="btad727-B19">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Whittaker</surname><given-names>RH.</given-names></string-name></person-group><article-title>Vegetation of the great smoky mountains</article-title>. <source>Ecol Monogr</source><year>1956</year>;<volume>26</volume>:<fpage>1</fpage>–<lpage>80</lpage>.</mixed-citation>
    </ref>
    <ref id="btad727-B20">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Whittaker</surname><given-names>RH</given-names></string-name>, <string-name><surname>Damschen</surname><given-names>EI</given-names></string-name>, <string-name><surname>Harrison</surname><given-names>S.</given-names></string-name></person-group><article-title>Plant community data collected by Robert H. Whittaker in the Siskiyou Mountains, Oregon and California, USA</article-title>. <source>Ecology</source><year>2022</year>;<volume>103</volume>:<fpage>e3764</fpage>.<pub-id pub-id-type="pmid">35608560</pub-id></mixed-citation>
    </ref>
    <ref id="btad727-B21">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Yatsunenko</surname><given-names>T</given-names></string-name>, <string-name><surname>Rey</surname><given-names>FE</given-names></string-name>, <string-name><surname>Manary</surname><given-names>MJ</given-names></string-name></person-group><etal>et al</etal><article-title>Human gut microbiome viewed across age and geography</article-title>. <source>Nature</source><year>2012</year>;<volume>486</volume>:<fpage>222</fpage>–<lpage>7</lpage>.<pub-id pub-id-type="pmid">22699611</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
