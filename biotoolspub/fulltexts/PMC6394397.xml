<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1 20151215//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.1?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">6394397</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/bty706</article-id>
    <article-id pub-id-type="publisher-id">bty706</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Applications Notes</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Data and Text Mining</subject>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>checkMyIndex: a web-based R/Shiny interface for choosing compatible sequencing indexes</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Varet</surname>
          <given-names>Hugo</given-names>
        </name>
        <xref ref-type="aff" rid="bty706-aff1">1</xref>
        <xref ref-type="aff" rid="bty706-aff2">2</xref>
        <xref ref-type="corresp" rid="bty706-cor1"/>
        <!--<email>hugo.varet@pasteur.fr</email>-->
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Coppée</surname>
          <given-names>Jean-Yves</given-names>
        </name>
        <xref ref-type="aff" rid="bty706-aff2">2</xref>
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Wren</surname>
          <given-names>Jonathan</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <aff id="bty706-aff1"><label>1</label>Center of Bioinformatics, Biostatistics and Integrative Biology, Institut Pasteur – Bioinformatics and Biostatistics Hub – C3BI, USR 3756 IP CNRS, Paris, France</aff>
    <aff id="bty706-aff2"><label>2</label>Center for Technological Resources and Research, Institut Pasteur – Transcriptome and Epigenome Platform – Biomics Pole – C2RT, Paris, France</aff>
    <author-notes>
      <corresp id="bty706-cor1">To whom correspondence should be addressed. <email>hugo.varet@pasteur.fr</email></corresp>
    </author-notes>
    <pub-date pub-type="ppub">
      <day>01</day>
      <month>3</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2018-08-25">
      <day>25</day>
      <month>8</month>
      <year>2018</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>25</day>
      <month>8</month>
      <year>2018</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the <pub-date pub-type="epub"/>. -->
    <volume>35</volume>
    <issue>5</issue>
    <fpage>901</fpage>
    <lpage>902</lpage>
    <history>
      <date date-type="received">
        <day>15</day>
        <month>5</month>
        <year>2018</year>
      </date>
      <date date-type="rev-recd">
        <day>11</day>
        <month>8</month>
        <year>2018</year>
      </date>
      <date date-type="accepted">
        <day>23</day>
        <month>8</month>
        <year>2018</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2018. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2018</copyright-year>
      <license license-type="cc-by-nc" xlink:href="http://creativecommons.org/licenses/by-nc/4.0/">
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by-nc/4.0/">http://creativecommons.org/licenses/by-nc/4.0/</ext-link>), which permits non-commercial re-use, distribution, and reproduction in any medium, provided the original work is properly cited. For commercial re-use, please contact journals.permissions@oup.com</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="bty706.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Summary</title>
        <p>When sequencing several libraries simultaneously, the selection of compatible combinations of indexes is critical for ensuring that the sequencer will be able to decipher the short, sample-specific barcodes added to each fragment. However, researchers have few tools to help them choose optimal indexes. Here, we present checkMyIndex, an online R/Shiny application that facilitates the selection of the right indexes as a function of the experimental constraints.</p>
      </sec>
      <sec id="s2">
        <title>Availability and implementation</title>
        <p>checkMyIndex is available free of charge at <ext-link ext-link-type="uri" xlink:href="https://checkmyindex.pasteur.fr">https://checkmyindex.pasteur.fr</ext-link> as an online, web-based R/Shiny application. The source code is available on GitHub at <ext-link ext-link-type="uri" xlink:href="https://github.com/PF2-pasteur-fr/checkMyIndex">https://github.com/PF2-pasteur-fr/checkMyIndex</ext-link>.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <named-content content-type="funder-name">France Génomique consortium</named-content>
        </funding-source>
        <award-id>ANR10-INBS-09-08</award-id>
        <award-id>ANR-10-INBS-09-10</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="2"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>The sequencing of RNA and DNA libraries has become a standard experimental tool in the life sciences. It can notably be used to characterize and understand biological mechanisms (<xref rid="bty706-B2" ref-type="bibr">Goodwin <italic>et al.</italic>, 2016</xref>). For instance, knowledge of DNA sequences can help researchers to discover disease-specific single nucleotide polymorphisms, whereas transcriptome analyses can reveal differentially expressed genes or provide information for genome annotation. As sequencing capacities increase, some biological applications do not require all the reads produced by a single sequencing lane. Hence, in order to optimize costs, researchers often choose to sequence several samples simultaneously by adding short (typically 6- to 8-base-pair) sample-specific barcodes to their libraries. The indexes are then read by the sequencer, and each read is assigned to its original sample via an a posteriori demultiplexing procedure. In this context, the selection of compatible indexes is a crucial step; if the indexes are not compatible, the sequencer will not be able to read each index entirely. Indeed, the compatibility of a set of indexes depends on (i) the indexes’ sequence composition at each position, and (ii) the sequencer’s chemistry (e.g. Illumina HiSeq or NextSeq) [Illumina Index Adapters Pooling Guide, Document # 1000000041074 v02 (2018)]. By way of an example, two- or four-channel chemistry requires each color-transformed nucleotide to be present at least once at each position. Using incompatible indexes would cause the demultiplexing procedure to fail, and so the sequencing reads would not be assigned to the corresponding biological samples. Accordingly, the reads could not be used as input for any future bioinformatics analyses. Although simultaneously sequencing a pool of libraries can lower costs, this strategy must therefore be carefully planned. Several tools have been developed to check index compatibility. For instance, Illumina’s Experiment Manager (IEM) software checks the compatibility of indexes provided by the user. However, IEM is available only for computers running Windows operating systems, and cannot build combinations that fulfil complex criteria (such as the use of single indexes in several lanes). sicTool (<ext-link ext-link-type="uri" xlink:href="http://amaryllisnucleics.com/sicTool/">http://amaryllisnucleics.com/sicTool/</ext-link>) also provides a web interface with advanced options but does not handle the different Illumina chemistries. Here, we describe the checkMyIndex web-based application. When given a set of available indexes, checkMyIndex generates compatible combinations that meet the idiosyncratic experimental conditions imposed by both the research objective and the user’s preferences. Moreover, checkMyIndex can help staff in core facilities to generate good-quality, ready-to-analyze sequencing data.</p>
  </sec>
  <sec>
    <title>2 Results</title>
    <p>We used the popular R package shiny (<xref rid="bty706-B1" ref-type="bibr">Chang <italic>et al.</italic>, 2017</xref>) to develop a user-friendly application (available free of charge at checkmyindex.pasteur.fr) dedicated to searching for compatible combinations of indexes. The corresponding R source code is hosted on GitHub (<ext-link ext-link-type="uri" xlink:href="https://github.com/PF2-pasteur-fr/checkMyIndex">https://github.com/PF2-pasteur-fr/checkMyIndex</ext-link>) so that researchers can also run the application on their own computer. Note that checkMyIndex uses only native R code, and shiny is the only additional package required. An R script is also available for advanced users willing to run checkMyIndex from the command line.</p>
    <p>Our application supports single- and dual-indexing in order to achieve higher multiplexing rates and decrease error rates (<xref rid="bty706-B3" ref-type="bibr">Kircher <italic>et al.</italic>, 2012</xref>). checkMyIndex is also compatible with the various chemistries used by the Illumina HiSeq, MiSeq, NextSeq and iSeq devices. With the four-channel chemistry (HiSeq and MiSeq), for instance, a red laser detects A/C bases and a green laser detects G/T bases; the indexes are compatible if there is at least one red light and one green light at each position. We refer the reader to both the checkMyIndex help page and the Illumina documentation for more detailed information on the different chemistries.</p>
    <p>In practice, the user only needs to provide his/her available indexes as a simple, two-column, tab-separated text format file. The first column contains the index identifiers, and the second contains the corresponding short sequences (see either the GitHub repository or the checkMyIndex help page for examples). When the indexes are loaded, a dissimilarity score is attributed to each one. If the <italic>N</italic> indexes are labelled from <italic>I</italic><sub>1</sub> to <italic>I<sub>N</sub></italic>, the score for index <italic>k</italic> is defined as <inline-formula id="IE1"><mml:math id="IM1"><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mi>min</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>≠</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mi>H</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mi>k</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, where <italic>d<sub>H</sub></italic> is the Hamming distance (the number of mismatches). This enables the user to check that each index differs sufficiently from all the others, so that the demultiplexing procedure can tolerate sequencing errors. Next, several constraints have to be defined via the interface: the total number of samples, the multiplexing rate (i.e. the number of samples per pool/lane) and whether the same index or the same combination of indexes can be used several times. The latter constraint has been designed to ensure a certain level of diversity and thus avoid the same indexes from being used all the time. Moreover, using unique indexes allows one to perform a small sequencing test on a single lane by pooling all the libraries.</p>
    <p>From a technical standpoint, it is sometimes impossible or excessively length to find a solution that fulfils all the constraints. In fact, the number of index combinations to be tested can increase rapidly as the multiplexing rate rises. If <italic>n</italic> is the number of available indexes and <italic>m</italic> is the multiplexing rate, the number of possible combinations is defined by <inline-formula id="IE2"><mml:math id="IM2"><mml:mrow><mml:mi>n</mml:mi><mml:mo>!</mml:mo><mml:mo>/</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>m</mml:mi><mml:mo>!</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo>−</mml:mo><mml:mi>m</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>!</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>. For instance, when looking for combinations of <italic>m </italic>=<italic> </italic>12 indexes in a list of <italic>n </italic>=<italic> </italic>48, the program may have to generate and test the compatibility of almost <inline-formula id="IE3"><mml:math id="IM3"><mml:mrow><mml:mn>7</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:mrow><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> combinations. Since adding an index to an already compatible set does not revoke compatibility, our trick in this situation is to find a partial solution with a smaller number of samples per pool/lane and then to complete it to obtain the desired multiplexing rate. In practice, the algorithm decreases the desired multiplexing rate step by step until the number of possible combinations falls to below 2 00 000. This quickly provides an intermediate, partial solution that can then be completed with some of the remaining indexes. Using the figures above, a partial solution can be easily found with <italic>m </italic>=<italic> </italic>4 (i.e. 1 94 580 possible combinations) and completed to reach <italic>m </italic>=<italic> </italic>12. In most situations, checkMyIndex therefore returns a solution in a few seconds. It should be noted that a new score is computed for each index in the proposed solution, in order to assess its dissimilarity vs. the other indexes in the pool/lane.</p>
    <p>Lastly, the user can visualize a heat-map-like plot of the solution in the corresponding tab (<xref ref-type="fig" rid="bty706-F1">Fig. 1</xref>). Furthermore, the table containing the proposed flow cell design can be downloaded and saved for future experiments or processing.
</p>
    <fig id="bty706-F1" orientation="portrait" position="float">
      <label>Fig. 1.</label>
      <caption>
        <p>A heat-map-like plot of a proposed flow cell design for sequencing 18 samples using 3 lanes and unique indexes. Samples (in rows) are grouped by pool/lane, and each nucleotide in each index is color-coded as a function of the chosen Illumina chemistry. Sample IDs are printed on the left, and index IDs are printed on the right</p>
      </caption>
      <graphic xlink:href="bty706f1"/>
    </fig>
  </sec>
  <sec>
    <title>3 Conclusion</title>
    <p>checkMyIndex is a user-friendly, easy-to-use web application that facilitates searching for compatible indexes in sequencing experiments. Solutions are returned quickly (in a few seconds) by the underlying algorithm, and satisfy the constraints imposed by the user (such as not using the same index several times). Moreover, the structure of the R code will allow new features to be added (e.g. when new chemistries are developed).</p>
  </sec>
</body>
<back>
  <ack id="ack1">
    <title>Acknowledgements</title>
    <p>We thank Odile Sismeiro, Caroline Proux, Juliana Pipoli da Fonseca, Christiane Bouchier, Sean Kennedy and Thomas Cokelaer for assistance and helpful suggestions. We also acknowledge Céline Trébeau and Raphaël Etournay for their constructive discussions, and Emmanuel Guichard and Nicolas Maillet for their help during the virtual machine set-up.</p>
    <sec>
      <title>Funding</title>
      <p>This work was supported by the France Génomique consortium [ANR10-INBS-09-08 and ANR-10-INBS-09-10].</p>
      <p><italic>Conflict of Interest</italic>: none declared.</p>
    </sec>
  </ack>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="bty706-B1">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name name-style="western"><surname>Chang</surname><given-names>W.</given-names></name></person-group><etal>et al</etal> (<year>2017</year>) <source>Shiny: Web Application Framework for R. R Package Version 1.0.5</source>. doi: 10.1093/bioinformatics/btx308.</mixed-citation>
    </ref>
    <ref id="bty706-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Goodwin</surname><given-names>S.</given-names></name></person-group><etal>et al</etal> (<year>2016</year>) 
<article-title>Coming of age: ten years of next-generation sequencing technologies</article-title>. <source>Nat. Rev. Genet</source>., <volume>17</volume>, <fpage>333</fpage>–<lpage>351</lpage>.<pub-id pub-id-type="pmid">27184599</pub-id></mixed-citation>
    </ref>
    <ref id="bty706-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Kircher</surname><given-names>M.</given-names></name></person-group><etal>et al</etal> (<year>2012</year>) 
<article-title>Double indexing overcomes inaccuracies in multiplex sequencing on the Illumina platform</article-title>. <source>Nucleic Acids Res</source>., <volume>40</volume>, <fpage>e3.</fpage><pub-id pub-id-type="pmid">22021376</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
