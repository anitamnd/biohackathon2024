<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Sci Data</journal-id>
    <journal-id journal-id-type="iso-abbrev">Sci Data</journal-id>
    <journal-title-group>
      <journal-title>Scientific Data</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2052-4463</issn>
    <publisher>
      <publisher-name>Nature Publishing Group UK</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">9700736</article-id>
    <article-id pub-id-type="publisher-id">1833</article-id>
    <article-id pub-id-type="doi">10.1038/s41597-022-01833-1</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Data Descriptor</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title><italic>TractoInferno</italic> - A large-scale, open-source, multi-site database for machine learning dMRI tractography</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-0116-4352</contrib-id>
        <name>
          <surname>Poulin</surname>
          <given-names>Philippe</given-names>
        </name>
        <address>
          <email>philippe.poulin2@usherbrooke.ca</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Theaud</surname>
          <given-names>Guillaume</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Rheault</surname>
          <given-names>Francois</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>St-Onge</surname>
          <given-names>Etienne</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Bore</surname>
          <given-names>Arnaud</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Renauld</surname>
          <given-names>Emmanuelle</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>de Beaumont</surname>
          <given-names>Louis</given-names>
        </name>
        <xref ref-type="aff" rid="Aff2">2</xref>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0001-6990-839X</contrib-id>
        <name>
          <surname>Guay</surname>
          <given-names>Samuel</given-names>
        </name>
        <xref ref-type="aff" rid="Aff2">2</xref>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Jodoin</surname>
          <given-names>Pierre-Marc</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff4">4</xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-8191-2129</contrib-id>
        <name>
          <surname>Descoteaux</surname>
          <given-names>Maxime</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff4">4</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="GRID">grid.86715.3d</institution-id><institution-id institution-id-type="ISNI">0000 0000 9064 6198</institution-id><institution>University of Sherbrooke, Computer Science Department, </institution></institution-wrap>Sherbrooke, J1K 2R1 Canada </aff>
      <aff id="Aff2"><label>2</label>Montreal Sacred-Heart Hospital Research Centre, Montreal, H4J 1C5 Canada </aff>
      <aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="GRID">grid.14848.31</institution-id><institution-id institution-id-type="ISNI">0000 0001 2292 3357</institution-id><institution>University of Montreal, Department of Surgery, </institution></institution-wrap>Montreal, H3C 3J7 Canada </aff>
      <aff id="Aff4"><label>4</label>Imeka, Sherbrooke, J1H 4A7 Canada </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>25</day>
      <month>11</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>25</day>
      <month>11</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2022</year>
    </pub-date>
    <volume>9</volume>
    <elocation-id>725</elocation-id>
    <history>
      <date date-type="received">
        <day>21</day>
        <month>1</month>
        <year>2022</year>
      </date>
      <date date-type="accepted">
        <day>9</day>
        <month>11</month>
        <year>2022</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2022</copyright-statement>
      <license>
        <ali:license_ref specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p><bold>Open Access</bold> This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The images or other third party material in this article are included in the article’s Creative Commons license, unless indicated otherwise in a credit line to the material. If material is not included in the article’s Creative Commons license and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this license, visit <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <p id="Par1"><italic>TractoInferno</italic> is the world’s largest open-source multi-site tractography database, including both research- and clinical-like human acquisitions, aimed specifically at machine learning tractography approaches and related ML algorithms. It provides 284 samples acquired from 3 T scanners across 6 different sites. Available data includes T1-weighted images, single-shell diffusion MRI (dMRI) acquisitions, spherical harmonics fitted to the dMRI signal, fiber ODFs, and reference streamlines for 30 delineated bundles generated using 4 tractography algorithms, as well as masks needed to run tractography algorithms. Manual quality control was additionally performed at multiple steps of the pipeline. We showcase <italic>TractoInferno</italic> by benchmarking the learn2track algorithm and 5 variations of the same recurrent neural network architecture. Creating the <italic>TractoInferno</italic> database required approximately 20,000 CPU-hours of processing power, 200 man-hours of manual QC, 3,000 GPU-hours of training baseline models, and 4 Tb of storage, to produce a final database of 350 Gb. By providing a standardized training dataset and evaluation protocol, <italic>TractoInferno</italic> is an excellent tool to address common issues in machine learning tractography.</p>
    </abstract>
    <abstract id="Abs2" abstract-type="summary">
      <p id="Par2">
        <table-wrap id="Taba">
          <table frame="hsides" rules="groups">
            <tbody>
              <tr>
                <td>Measurement(s)</td>
                <td>Diffusion Weighted Imaging • Magnetic Resonance Imaging of the Brain without Contrast • Diffusion Tensor Imaging</td>
              </tr>
              <tr>
                <td>Technology Type(s)</td>
                <td>3 T MRI scanner</td>
              </tr>
              <tr>
                <td>Factor Type(s)</td>
                <td>Age • Gender</td>
              </tr>
              <tr>
                <td>Sample Characteristic - Organism</td>
                <td>Homo sapiens</td>
              </tr>
            </tbody>
          </table>
        </table-wrap>
      </p>
    </abstract>
    <kwd-group kwd-group-type="npg-subject">
      <title>Subject terms</title>
      <kwd>Computational neuroscience</kwd>
      <kwd>Computer science</kwd>
      <kwd>Neural circuits</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">https://doi.org/10.13039/501100003151</institution-id>
            <institution>Fonds de Recherche du Québec - Nature et Technologies (Quebec Fund for Research in Nature and Technology)</institution>
          </institution-wrap>
        </funding-source>
        <award-id>206270</award-id>
        <principal-award-recipient>
          <name>
            <surname>Poulin</surname>
            <given-names>Philippe</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">https://doi.org/10.13039/100013020</institution-id>
            <institution>Compute Canada (Calcul Canada)</institution>
          </institution-wrap>
        </funding-source>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2022</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background &amp; Summary</title>
    <p id="Par3">Tractography is the computerized process of reconstructing brain white matter fibers from diffusion MRI (dMRI) data. It usually consists of four steps: (i) pre-processing diffusion-weighted images (DWI), (ii) estimating local fiber directions, (iii) reconstructing white matter pathways (i.e. tractography), and (iv) delineating fiber bundles<sup><xref ref-type="bibr" rid="CR1">1</xref>,<xref ref-type="bibr" rid="CR2">2</xref></sup>.</p>
    <p id="Par4">Current “traditional” tractography approaches (deterministic and probabilistic) mostly rely on making local point-wise decisions in the fiber Orientation Distribution Function (fODF) field, iterating until termination<sup><xref ref-type="bibr" rid="CR3">3</xref>,<xref ref-type="bibr" rid="CR4">4</xref></sup>. Global methods have also been proposed<sup><xref ref-type="bibr" rid="CR5">5</xref>–<xref ref-type="bibr" rid="CR8">8</xref></sup>, but (Rheault <italic>et al</italic>.)<sup><xref ref-type="bibr" rid="CR9">9</xref></sup> mentions that “[…] global tractography methods ultimately rely on local information patched together” and “even global tractography algorithms struggle to correctly assemble a streamline”. Tractogram filtering<sup><xref ref-type="bibr" rid="CR10">10</xref>–<xref ref-type="bibr" rid="CR13">13</xref></sup> is a popular post-processing method used to remove streamlines that do not fit anatomical constraints (such as explaining the underlying signal), but requires an over-complete tractogram as it does not create new streamlines, thus effectively “wasting” computing power. Finally, streamline clustering<sup><xref ref-type="bibr" rid="CR14">14</xref>,<xref ref-type="bibr" rid="CR15">15</xref></sup> can be used to group streamlines based on similarity and remove outliers, but it suffers from the same drawback as tractogram filtering, as it requires an over-complete tractogram.</p>
    <p id="Par5">These approaches mostly rely on mathematical models or anatomical priors, and do not require histological ground truth to work. However, this is an issue for machine learning algorithms, where the training dataset is an integral part of the resulting model<sup><xref ref-type="bibr" rid="CR16">16</xref></sup>. Machine learning methods need reference streamlines to train on. Unfortunately, on real datasets, streamlines can only be generated by traditional tractography methods, which are imperfect by their very nature<sup><xref ref-type="bibr" rid="CR2">2</xref></sup>. This is an issue for testing if the predictions made by these methods are reliable or not. Luckily, by combining streamlines (both true positives and false positives) generated by several tractography algorithms and using filtering and clustering to remove as much false positives as possible, it is possible to establish a <italic>gold standard</italic> reference dataset. Even without a histologically accurate ground truth, it would be desirable to have algorithms that can reproduce a gold standard reference while generating as little false positive streamlines as possible.</p>
    <p id="Par6">In the recent years, machine learning (ML) algorithms have been proposed to improve the tractography process by some combination of (i) using the full diffusion information, (ii) generating more reliable streamlines using a reference teacher dataset, or (iii) integrating spatial context to guide the tracking process (either neighbourhood or path information)<sup><xref ref-type="bibr" rid="CR16">16</xref>–<xref ref-type="bibr" rid="CR20">20</xref></sup>. Unfortunately, these machine learning methods train and evaluate their models on different dataset which makes it difficult to compare their true generalization capabilities<sup><xref ref-type="bibr" rid="CR16">16</xref></sup>. Additionally, data pre-processing vary between proposed methods, and different algorithms and protocols are used to generate the reference tracts. Finally, evaluating the true generalizability of a model is almost impossible without diverse (aka multi-site) training and test sets. As a result, those discrepancies in methodology make it very challenging to assess the reliability of a single approach, and make it impossible to fairly compare algorithms against one another.</p>
    <p id="Par7">To our knowledge, there are few datasets that contain both diffusion MRI and gold standard tractography, and none that include multiple sites. Proposed methods in the existing literature usually use in-house (private, ad-hoc) tractography datasets to train their models, often subjects from the HCP database. (Poulin <italic>et al</italic>.)<sup><xref ref-type="bibr" rid="CR16">16</xref></sup> provides a more detailed review of existing tractography datasets and their limitations.</p>
    <p id="Par8">We propose to address this problem by building <italic>TractoInferno</italic>: the largest publicly available, multi-site, dMRI and tractography database, which provides a new baseline for training and evaluating machine learning tractography methods. It provides 284 samples acquired from 3 T scanners across 6 different sites. <italic>TractoInferno</italic> includes T1-weighted images, single-shell diffusion MRI (dMRI) acquisitions, spherical harmonics fitted to the dMRI signal, fODFs, and reference streamlines for 30 delineated bundles generated by combining 4 different tractography algorithms, as well as masks needed to run tractography algorithms.</p>
    <p id="Par9">We use <italic>TractoInferno</italic> to benchmark the 4 tractography algorithms used to create the reference tractograms, along with the learn2track<sup><xref ref-type="bibr" rid="CR18">18</xref></sup> algorithm and 5 variations of the same recurrent neural network architecture, inspired in part by the models of (Benou &amp; Riklin-Raviv)<sup><xref ref-type="bibr" rid="CR21">21</xref></sup> and (Wegmayr <italic>et al</italic>.)<sup><xref ref-type="bibr" rid="CR20">20</xref></sup>. Creating the <italic>TractoInferno</italic> database required approximately 20,000 CPU-hours of processing power, 200 man-hours of manual QC, 3,000 GPU-hours of training baseline models, and 4 Tb of storage, to produce a final database of 350 Gb.</p>
    <p id="Par10"><italic>TractoInferno</italic> is a dataset intended to promote the development of ML tractography algorithms, which generally suffer from multiple issues, such as limited datasets or inconsistent training data. Its large-scale and multi-site aspect is an undeniable benefit to best evaluate the generalization capabilities of new ML algorithms. We consider <italic>TractoInferno</italic> to be by far the best available tool for training, evaluating, and comparing future ML tractography algorithms.</p>
  </sec>
  <sec id="Sec2">
    <title>Methods</title>
    <sec id="Sec3">
      <title>Datasets</title>
      <p id="Par11">The proposed dataset is made of a combination of six dMRI databases, either publicly available or acquired through open-access data sharing agreements, and free to redistribute under a Creative Commons CC0 license. Databases were chosen with the explicit goal of having a diversity of scanner manufacturers, models, and protocols. We chose to fix certain parameters for uniformity, such as having only healthy subjects, acquired on 3 T scanners, and using b-values of around 1000 s/mm<sup>2</sup>, as we don’t know how they could affect machine learning models. The focus is effectively on assessing the reliability of algorithms under different scanner manufacturers and acquisition protocols. We obtained an initial number of data from 354 subjects, with the original metadata described in Table <xref rid="Tab1" ref-type="table">1</xref>.<table-wrap id="Tab1"><label>Table 1</label><caption><p>Original datasets metadata. Not all metadata information was available from the original datasets.</p></caption><table frame="hsides" rules="groups"><thead><tr><th>Name</th><th><italic>Mazoyer et al</italic>.<sup><xref ref-type="bibr" rid="CR22">22</xref></sup></th><th><italic>Tsushida et al</italic>.<sup><xref ref-type="bibr" rid="CR23">23</xref></sup></th><th><italic>DeLuca et al</italic>.<sup><xref ref-type="bibr" rid="CR25">25</xref></sup></th><th><italic>Poldrack et al</italic>.<sup><xref ref-type="bibr" rid="CR27">27</xref></sup></th><th><italic>Tamm et al</italic>.<sup><xref ref-type="bibr" rid="CR28">28</xref></sup></th><th><italic>Tremblay et al</italic>.<sup><xref ref-type="bibr" rid="CR30">30</xref></sup></th></tr></thead><tbody><tr><td><bold>Scanner</bold></td><td>3 T Philips Achieva</td><td>3 T Siemens Prisma</td><td>3 T Siemens Prisma</td><td>3 T Siemens Trio</td><td>3 T GE Discovery MR750</td><td>3 T Siemens Magnetom TIM Trio</td></tr><tr><td><bold># subjects</bold></td><td>39</td><td>20</td><td>64</td><td>130</td><td>86</td><td>15</td></tr><tr><td><bold>Age avg</bold></td><td>28.1</td><td>21.4</td><td>31.9</td><td>31.3</td><td>N/A</td><td>58.1</td></tr><tr><td><bold>Age std</bold></td><td>7.3</td><td>1.7</td><td>7.6</td><td>8.7</td><td>N/A</td><td>5.3</td></tr><tr><td><bold>F/M</bold></td><td>0/39</td><td>10/10</td><td>49/15</td><td>62/68</td><td>44/42</td><td>0/15</td></tr><tr><td><bold>L/R</bold></td><td>8/31</td><td>N/A</td><td>0/64</td><td>N/A</td><td>N/A</td><td>3/12</td></tr><tr><td><bold>Resolution</bold></td><td>2</td><td>1.75</td><td>2</td><td>2</td><td>2.3</td><td>2</td></tr><tr><td><bold>b-value</bold></td><td>1000</td><td>1000</td><td>1000</td><td>1000</td><td>1000</td><td>700</td></tr><tr><td><bold>TR</bold></td><td>8500</td><td>3540</td><td>1800</td><td>9000</td><td>7000</td><td>9200</td></tr><tr><td><bold>TE</bold></td><td>81</td><td>75</td><td>70</td><td>93</td><td>81</td><td>84</td></tr><tr><td><bold>Nb dirs</bold></td><td>21*</td><td>32</td><td>128**</td><td>64</td><td>45</td><td>30</td></tr></tbody></table><table-wrap-foot><p>Missing metadata is reported as {N/A}. Resolution is in mm<sup>3</sup> isotropic. b-value is in s/mm<sup>2</sup>. TR and TE are in ms.</p><p>*21 directions acquired twice by reversing the gradient polarity, then averaged over another identical acquisition (total of 84 DWI volumes).</p><p>**64 directions acquired twice, not averaged.</p></table-wrap-foot></table-wrap></p>
      <sec id="Sec4">
        <title>Mazoyer et al. - BIL &amp; GIN</title>
        <p id="Par12">We retained 39 subjects from the BIL&amp;GIN database<sup><xref ref-type="bibr" rid="CR22">22</xref></sup>, acquired on a 3 T Philips Achieva, with the following dMRI protocol: TR = 8500 ms, TE = 81 ms, angle = 90°, SENSE reduction factor = 2.5, FOV 224 mm, acquisition matrix 112 × 112, 2 mm<sup>3</sup> isotropic voxel.</p>
        <p id="Par13">The dMRI acquisition consisted of 21 gradient directions at b = 1000 s/mm<sup>2</sup>, acquired twice by reversing the polarity, and then repeated twice for a total of 84 DWI images, averaged down to a single volume with 21 directions. A single b = 0 s/mm<sup>2</sup> was also acquired alongside the DWI images. Subjects were all males, with age mean/std of 28.1 + -7.3 (Min: 20, Max: 57). 8 subjects were left-handed and 31 right-handed.</p>
        <p id="Par14">All participants gave written consent prior to participation in the study, which was approved by the local ethics committee (CCPRB Basse-Normandie).</p>
      </sec>
      <sec id="Sec5">
        <title>Tsushida et al. - MRi-Share</title>
        <p id="Par15">We obtained 20 subjects from the MRi-Share database<sup><xref ref-type="bibr" rid="CR23">23</xref></sup>, acquired on a 3 T Siemens Prisma, with a dMRI protocol designed to emulate the UKBioBank project<sup><xref ref-type="bibr" rid="CR24">24</xref></sup>, specifically: TR = 3540 ms, TE = 75 ms, 1.75 mm<sup>3</sup> isotropic voxel.</p>
        <p id="Par16">We selected the b = 1000 s/mm<sup>2</sup> DWI images only, consisting of 32 gradient directions, and 3 provided b = 0 s/mm<sup>2</sup> images. Subjects were composed of 10 females, 10 males, with age mean/std of 21.4 + -1.7. Minimum/maximum age and handed-ness metadata were not available.</p>
        <p id="Par17">The MRi-Share study protocol was approved by the ethics committee (CPP2015-A00850-49), and all participants signed an informed written consent form.</p>
      </sec>
      <sec id="Sec6">
        <title>DeLuca et al. - Bilingualism and the brain</title>
        <p id="Par18">We have 64 subjects from the <italic>Bilingualism and the Brain</italic> database<sup><xref ref-type="bibr" rid="CR25">25</xref>,<xref ref-type="bibr" rid="CR26">26</xref></sup>, acquired on a 3 T Siemens Prisma, with the following dMRI protocol: Echo planar imaging, TR = 1800 ms, TE = 70 ms, acquisition matrix 256 × 256, 2 mm<sup>3</sup> isotropic voxel.</p>
        <p id="Par19">The dMRI acquisition consisted of 64 gradient directions at b = 1000 s/mm<sup>2</sup>, acquired twice, and 4 b = 0 s/mm<sup>2</sup> images. Subjects were composed of 49 females and 15 males, with age mean/std of 31.9 + -7.6 (Min: 18, Max: 52). All subjects were right-handed.</p>
        <p id="Par20">The research procedures in this study were approved by the University of Reading Research Ethics Committee. Before taking part in the experiment, participants gave written informed consent and confirmed no contraindication to MRI scanning.</p>
      </sec>
      <sec id="Sec7">
        <title>Poldrack et al. - UCLA CNP</title>
        <p id="Par21">We got 130 healthy subjects from the <italic>UCLA Consortium for Neuropsychiatric Phenomics LA5c Study</italic><sup><xref ref-type="bibr" rid="CR27">27</xref></sup>, acquired on a 3 T Siemens Trio, with the following dMRI protocol: echo planar imaging, TR = 9000 ms, TE = 93 ms, acquisition matrix 93 × 93, 90 degree flip angle, 2 mm<sup>3</sup> isotropic voxel. DWI were corrected for eddy currents and head motion using the b0 images as reference.</p>
        <p id="Par22">The dMRI acquisition consisted of 64 gradient directions at b = 1000 s/mm<sup>2</sup>, and 1 b = 0 s/mm<sup>2</sup> image. Subjects consisted of 62 females and 68 males, with age mean/std of 31.3 + -8.7 (Min: 21, Max: 50). Handed-ness metadata was not available.</p>
        <p id="Par23">Participants of this study gave written informed consent following procedures approved by the Institutional Review Boards at UCLA and the Los Angeles County Department of Mental Health.</p>
      </sec>
      <sec id="Sec8">
        <title>Tamm et al. - The stockholm sleepy brain study</title>
        <p id="Par24">We retained 86 subjects from the Stockholm Sleepy Brain Study database<sup><xref ref-type="bibr" rid="CR28">28</xref>,<xref ref-type="bibr" rid="CR29">29</xref></sup>, acquired on a 3 T GE Discovery MR750, with the following dMRI protocol: Echo planar imaging, TR = 7000 ms, TE = 81 ms, 2.3 mm<sup>3</sup> isotropic voxel.</p>
        <p id="Par25">The dMRI acquisition consisted of 45 gradient directions at b = 1000 s/mm<sup>2</sup>, along with 5 b = 0 s/mm<sup>2</sup> images. Subjects were composed of 44 females and 42 males, with 47 subjects in the [20–30] years old bracket and 39 subjects in the [65–75] years old bracket. Handed-ness was not available.</p>
        <p id="Par26">This study was approved by the Regional Ethics Review board of Stockholm (2012/1870-32), and all participants gave written informed consent.</p>
      </sec>
      <sec id="Sec9">
        <title>Tremblay et al. - mTBI and Aging study (controls)</title>
        <p id="Par27">We obtained 15 subjects from the mTBI and Aging Study<sup><xref ref-type="bibr" rid="CR30">30</xref></sup>, all controls from the “remote” group. They were acquired on a 3 T Siemens Magnetom TIM Trio, with the following dMRI protocol: TR = 9200 ms, TE = 84 ms, 2 mm<sup>3</sup> isotropic voxel.</p>
        <p id="Par28">The dMRI acquisition consisted of 30 gradient directions at b = 700 s/mm<sup>2</sup>. along with 1 b = 0 s/mm<sup>2</sup> image. Subjects were all males, with age mean/std of 58.1 + -5.3 (Min: 52, Max: 67). 3 subjects were left-handed and 12 were right-handed.</p>
        <p id="Par29">All participants provided written informed consent in accordance with the “Comité d’éthique de la recherche vieillissement-neuroimagerie du CIUSSS du Centre-Sud-de-l’île-de-Montréal” of the CRIUGM (Montréal, H3W 1W5, Canada).</p>
      </sec>
    </sec>
    <sec id="Sec10">
      <title>Data processing</title>
      <p id="Par30">We processed the original acquisition volumes of the 354 aforementioned subjects with the same pipeline to offer a uniform database of dMRI images, derivatives, and bundle tractograms. First, all original DWI went through a manual quality control (QC) step to remove any obvious errors prior to the processing pipeline. In this case, QC is done by a thorough visual inspection of all modalities, along with a spherical representation of the acquisition scheme. Then, the <italic>TractoFlow</italic> pipeline was run to process the data and compute necessary derivatives<sup><xref ref-type="bibr" rid="CR31">31</xref>–<xref ref-type="bibr" rid="CR33">33</xref></sup>. Another QC step was executed afterwards, to remove images with artifacts that could not be corrected automatically. Next, ensemble tractography was performed using four different algorithms to extract a diverse set of streamlines: deterministic tractography<sup><xref ref-type="bibr" rid="CR34">34</xref></sup>, probabilistic tractography<sup><xref ref-type="bibr" rid="CR35">35</xref></sup>, Particle-Filtered Tractography<sup><xref ref-type="bibr" rid="CR36">36</xref></sup> and Surface-Enhanced Tractography<sup><xref ref-type="bibr" rid="CR37">37</xref></sup>. RecoBundlesX (RBX) was used subsequently to perform bundle extraction on the whole-brain tractograms, using the default suggested bundle models<sup><xref ref-type="bibr" rid="CR38">38</xref>,<xref ref-type="bibr" rid="CR39">39</xref></sup>. A final manual QC step was performed to examine the extracted bundles, and remove anything that contained obvious mistakes, or did not meet our criteria for bundle extraction. All manual quality control steps were done using dmriqcpy (<ext-link ext-link-type="uri" xlink:href="https://github.com/scilus/dmriqc_flow">https://github.com/scilus/dmriqc_flow</ext-link>). Figure <xref rid="Fig1" ref-type="fig">1</xref> shows the processing steps of <italic>TractoInferno</italic>.<fig id="Fig1"><label>Fig. 1</label><caption><p><italic>TractoInferno</italic> processing pipeline, from original DWI images to final bundles.</p></caption><graphic xlink:href="41597_2022_1833_Fig1_HTML" id="d32e1025"/></fig></p>
      <p id="Par31">From the initial 354 volumes, after all the processing steps and quality control, we were left with 284 volumes and associated bundles. The final volumes were split into training, validation and test sets with a 70%/20%/10% split for reproducibility across future experiments. References to software used in the processing pipeline are provided in Table <xref rid="Tab6" ref-type="table">6</xref>. For a final dataset size of 350 Gb, we needed approximately 20,000 CPU-hours of processing time (using a cluster of nodes, each with 40 cores across 2 Intel Gold 6148 Skylake CPUs at 2.4 GHz), 200 man-hours of manual QC, and 4 Tb of storage. The benchmarked recurrent models also required an additional 3,000 GPU-hours (using NVidia V100SXM2 GPUs with 16 Gb VRAM) for training and generating candidate tractograms. In the next sub-sections, we detail the TractoInferno processing steps.</p>
      <sec id="Sec11">
        <title>Raw data QC</title>
        <p id="Par32">We used <italic>dmriqcpy</italic> to generate QC reports. These reports are in HTML format so it is easily assessed and annotated by multiple people. The raw data reports contain multiple tabs with complementary information, as shown in Fig. <xref rid="Fig2" ref-type="fig">2</xref>. Three different raters went through the QC reports and individually rated every acquisition with a “score” (either <italic>pass, fail</italic>, or <italic>warning</italic>) and comment if necessary. Specifically, failure cases included the presence of visual artifacts (e.g. missing slices, low signal-to-noise ratio, corrupted data, high spatial distortion) and other artifacts harder to identify (such as a “broken” gradient acquisition scheme). Representative samples of failure cases are shown in Figs. <xref rid="Fig3" ref-type="fig">3</xref> and <xref rid="Fig4" ref-type="fig">4</xref>. Afterwards, all subjects tagged as “fail” were removed, and considered as impossible to repair with our available tools. All subjects tagged as “pass” or “warning” were passed on for TractoFlow, the next step in the pipeline. Subjects tagged as “warning” were re-examined after the TractoFlow processing to examine if any issues remained, or if they were compensated for by the pipeline.<fig id="Fig2"><label>Fig. 2</label><caption><p>Examples of HTML pages generated by dmriqcpy for data QC. (<bold>a</bold>) 3 slices of the T1 image (one for each axis), plus a mosaic of multiple axial slices; (<bold>b</bold>) 3 GIFs of the dMRI (one slice in each axis), plus a mosaic of multiple axial slices; (<bold>c</bold>) The gradient directions represented on a sphere.</p></caption><graphic xlink:href="41597_2022_1833_Fig2_HTML" id="d32e1072"/></fig><fig id="Fig3"><label>Fig. 3</label><caption><p>Example of a raw DWI sample that did not pass manual QC because of a slice-drop artifact.</p></caption><graphic xlink:href="41597_2022_1833_Fig3_HTML" id="d32e1081"/></fig><fig id="Fig4"><label>Fig. 4</label><caption><p>Example of a raw DWI sample that did not pass manual QC because of an acquisition protocol error.</p></caption><graphic xlink:href="41597_2022_1833_Fig4_HTML" id="d32e1090"/></fig><fig id="Fig5"><label>Fig. 5</label><caption><p>Atlas of bundles used to build <italic>TractoInferno</italic> and evaluate candidate tractograms.</p></caption><graphic xlink:href="41597_2022_1833_Fig5_HTML" id="d32e1102"/></fig></p>
      </sec>
      <sec id="Sec12">
        <title>TractoFlow pipeline</title>
        <p id="Par33">We used TractoFlow 2.1.1<sup><xref ref-type="bibr" rid="CR31">31</xref></sup> to process the raw DWI. To make sure that every processing step was traceable and reproducible, a Singularity<sup><xref ref-type="bibr" rid="CR32">32</xref></sup> image was used along with the Nextflow pipeline<sup><xref ref-type="bibr" rid="CR33">33</xref></sup>. Note however that some results may not be 100% reproducible due to the uncertain nature of registration, parallel processing, and floating point precision. We ran the full pipeline except for the <italic>Topup</italic> process, as not all reverse b0 images were available<sup><xref ref-type="bibr" rid="CR40">40</xref></sup>. Specifically, the pipeline executed the following steps:<list list-type="bullet"><list-item><p id="Par34">DWI brain extraction<sup><xref ref-type="bibr" rid="CR41">41</xref></sup>, denoising<sup><xref ref-type="bibr" rid="CR42">42</xref></sup>, eddy current correction<sup><xref ref-type="bibr" rid="CR43">43</xref></sup>, N4 bias field correction<sup><xref ref-type="bibr" rid="CR44">44</xref></sup>, cropping, normalization<sup><xref ref-type="bibr" rid="CR45">45</xref>,<xref ref-type="bibr" rid="CR46">46</xref></sup>, and resampling<sup><xref ref-type="bibr" rid="CR47">47</xref></sup>;</p></list-item><list-item><p id="Par35">T1 denoising<sup><xref ref-type="bibr" rid="CR48">48</xref></sup>, N4 bias field correction<sup><xref ref-type="bibr" rid="CR44">44</xref></sup>, registration<sup><xref ref-type="bibr" rid="CR49">49</xref></sup> and tissue segmentation<sup><xref ref-type="bibr" rid="CR50">50</xref></sup> maps for Particle-Filtered Tractography<sup><xref ref-type="bibr" rid="CR36">36</xref>,<xref ref-type="bibr" rid="CR51">51</xref></sup>;</p></list-item><list-item><p id="Par36">DTI fitting and metrics extraction<sup><xref ref-type="bibr" rid="CR52">52</xref></sup>;</p></list-item><list-item><p id="Par37">fODF fitting using constrained spherical deconvolution<sup><xref ref-type="bibr" rid="CR53">53</xref>–<xref ref-type="bibr" rid="CR55">55</xref></sup>, with a fiber response function fixed manually to [0.0015,0.0004,0.0004].</p></list-item></list></p>
      </sec>
      <sec id="Sec13">
        <title>TractoFlow results QC</title>
        <p id="Par38">Outputs from TractoFlow went through a manual QC pass to identify failure cases. Using <italic>dmriqcpy</italic>, we were able to easily and quickly look at all maps derived from DTI and fODF metrics, along with T1 registration overlay. For example, RGB maps extracted from DTI metrics allowed us to quickly identify if tensor peaks were well-aligned or if a flip was needed, and T1 registration overlays showed whether too much deformation was present.</p>
      </sec>
      <sec id="Sec14">
        <title>Ensemble tractography</title>
        <p id="Par39">Using a single tractography method as reference for a machine learning algorithm might induce unwanted biases. To avoid this, we chose to use ensemble tractography by combining 4 different algorithms to generate reference streamlines, namely deterministic<sup><xref ref-type="bibr" rid="CR34">34</xref></sup>, probabilistic<sup><xref ref-type="bibr" rid="CR35">35</xref></sup>, particle-filtered<sup><xref ref-type="bibr" rid="CR36">36</xref></sup>, and surface-enhanced<sup><xref ref-type="bibr" rid="CR37">37</xref></sup> tractography. We fixed the tracking parameters to the standard default values:<list list-type="bullet"><list-item><p id="Par40">WM + WM/GM interface seeding</p></list-item><list-item><p id="Par41">10 seeds per voxel (Det, Prob, PFT) or 10,000,000 surface seeds (SET)</p></list-item><list-item><p id="Par42">Step size 0.2 mm (Det, Prob, SET) or 0.5 mm (PFT)</p></list-item><list-item><p id="Par43">WM tracking mask (Det, Prob) or WM/GM/CSF probability maps (PFT, SET)</p></list-item></list></p>
        <p id="Par44">After tracking, we used streamline compression<sup><xref ref-type="bibr" rid="CR56">56</xref>–<xref ref-type="bibr" rid="CR58">58</xref></sup> in order to save space, which means that streamlines have a variable step size that need to be taken into account by ML tractography algorithms. We detail each algorithm in the following three subsections.</p>
        <sec id="FPar1">
          <title>Deterministic tracking</title>
          <p id="Par45">Deterministic tracking<sup><xref ref-type="bibr" rid="CR34">34</xref></sup> chooses the fODF peak most aligned with the previous direction as the next streamline step. It seems better suited to connectomics studies<sup><xref ref-type="bibr" rid="CR3">3</xref></sup>, mainly on account of the low number of false positives it produces. While it may be inadequate for spatial exploration and bundle reconstruction, deterministic tracking essentially produces smooth streamlines that follow the easiest path through the fODF field. Smooth streamlines are likely more desirable for ML algorithms rather than chaotic streamlines that often change directions locally.</p>
        </sec>
        <sec id="FPar2">
          <title>Probabilistic tracking and particle-filtered tractography</title>
          <p id="Par46">Probabilistic tracking<sup><xref ref-type="bibr" rid="CR35">35</xref></sup> samples a new streamline direction inside a cone of evaluation aligned with the previous direction, with a probability distribution proportional to the shape of the fODF within the cone.</p>
          <p id="Par47">Particle-Filtered Tractography<sup><xref ref-type="bibr" rid="CR36">36</xref></sup> is an improvement over probabilistic tracking. It takes as input probability maps for streamline continuation/stopping criteria, and allows to “go back” a few steps when a streamline terminates in a region not included in the “termination-allowed” map.</p>
          <p id="Par48">Both algorithms are better suited for spatial exploration, at the cost of producing much more false positives. They are especially effective for bundle reconstruction, in which case there are anatomical priors about both the endpoints that should be connected and the pathway that should be followed by the bundle.</p>
        </sec>
        <sec id="FPar3">
          <title>Surface-Enhanced Tracking</title>
          <p id="Par49">Finally, Surface-Enhanced Tracking<sup><xref ref-type="bibr" rid="CR37">37</xref></sup> is a state-of-the-art tractography algorithm that relies on initializing streamlines in an anatomically plausible way at the cortex, then running a PFT tracking algorithm. Indeed, gyri have been shown to be problematic regions for tractography, where low dMRI resolution can lead to a gyral bias in streamline terminations<sup><xref ref-type="bibr" rid="CR59">59</xref></sup>.</p>
          <p id="Par50">To this end, we computed the WM-GM boundary surface from the T1w image using the <italic>CIVET</italic><sup><xref ref-type="bibr" rid="CR60">60</xref></sup> tool and the CBRAIN<sup><xref ref-type="bibr" rid="CR61">61</xref></sup> platform. Then, SET uses a geometric flow method, based on surface orthogonality, to reconstruct the fanning structure of the superficial white matter streamlines. The output of this flow is used to initialize and terminate a PFT tractography algorithm. The result is a tractogram with improved cortex coverage, improved fanning structure in gyri, and reduced gyral bias.</p>
        </sec>
      </sec>
      <sec id="Sec15">
        <title>Bundle segmentation with RBX</title>
        <p id="Par51">We used RBX<sup><xref ref-type="bibr" rid="CR38">38</xref>,<xref ref-type="bibr" rid="CR39">39</xref></sup> to automatically extract WM bundles. The algorithm works by matching streamlines to an atlas of reference bundles. First, a quick registration step brings the atlas into native space using the atlas FA image. Then, a whole-brain tractogram is compared against the bundles atlas using multiple sets of parameters to extract a fixed set of bundles, listed in Table <xref rid="Tab2" ref-type="table">2</xref>. Finally, a majority voting step (label fusion) extracts the final streamlines for each bundle.<table-wrap id="Tab2"><label>Table 2</label><caption><p>List of bundles in the default RBX atlas.</p></caption><table frame="hsides" rules="groups"><tbody><tr><td>AC</td><td>Anterior commisure</td></tr><tr><td>AF</td><td>Arcuate fasciculus</td></tr><tr><td>CC_Fr_1</td><td>Corpus callosum, Frontal lobe (most anterior part)</td></tr><tr><td>CC_Fr_2</td><td>Corpus callosum, Frontal lobe (most posterior part)</td></tr><tr><td>CC_Oc</td><td>Corpus callosum, Occipital lobe</td></tr><tr><td>CC_Pa</td><td>Corpus callosum, Parietal lobe</td></tr><tr><td>CC_Pr_Po</td><td>Corpus callosum, Pre/Post central gyri</td></tr><tr><td>CC_Te</td><td>Corpus callosum, Temporal lobe</td></tr><tr><td>CG</td><td>Cingulum</td></tr><tr><td>FAT</td><td>Frontal aslant tract</td></tr><tr><td>FPT</td><td>Frontopontine tract</td></tr><tr><td>FX</td><td>Fornix</td></tr><tr><td>ICP</td><td>Inferior cerebellar peduncle</td></tr><tr><td>IFOF</td><td>Inferior fronto-occipital fasciculus</td></tr><tr><td>ILF</td><td>Inferior longitudinal fasciculus</td></tr><tr><td>MCP</td><td>Middle cerebellar peduncle</td></tr><tr><td>MdLF</td><td>Middle longitudinal fascicle</td></tr><tr><td>OR_ML</td><td>Optic radiation and Meyer’s loop</td></tr><tr><td>PC</td><td>Posterior commisure</td></tr><tr><td>POPT</td><td>Parieto-occipito pontine tract</td></tr><tr><td>PYT</td><td>Pyramidal tract</td></tr><tr><td>SCP</td><td>Superior cerebellar peduncle</td></tr><tr><td>SLF</td><td>Superior longitudinal fasciculus</td></tr><tr><td>UF</td><td>Uncinate fasciculus</td></tr></tbody></table></table-wrap></p>
        <p id="Par52">The whole pipeline was run using a Singularity container<sup><xref ref-type="bibr" rid="CR32">32</xref></sup> and Nextflow<sup><xref ref-type="bibr" rid="CR33">33</xref></sup> for reproducibility. It is freely available online (<ext-link ext-link-type="uri" xlink:href="https://github.com/scilus/rbx_flow/">https://github.com/scilus/rbx_flow/</ext-link>), along with a suggested bundles atlas (<ext-link ext-link-type="uri" xlink:href="https://zenodo.org/record/4630660#.YJvmwXVKhdU">https://zenodo.org/record/4630660#.YJvmwXVKhdU</ext-link>)<sup><xref ref-type="bibr" rid="CR62">62</xref></sup>.</p>
      </sec>
      <sec id="Sec16">
        <title>Bundle segmentation QC</title>
        <sec id="FPar4">
          <title>Automated pre-QC</title>
          <p id="Par53">To facilitate the QC procedure, we ran a pre-QC analysis to automatically rate bundles according to pre-defined criteria before manual inspection. These criteria are detailed in Table <xref rid="Tab3" ref-type="table">3</xref>. Afterwards, all bundles were looked at manually through an easier procedure that consists in confirming an already assigned rating rather than rating from scratch.<table-wrap id="Tab3"><label>Table 3</label><caption><p>Automatic rating criteria, in order of priority.</p></caption><table frame="hsides" rules="groups"><thead><tr><th>Rating</th><th>Criteria</th></tr></thead><tbody><tr><td rowspan="2">Fail</td><td><italic>x</italic> &lt; 50</td></tr><tr><td><italic>x</italic> = 0 in either hemisphere (if symmetric bundle).</td></tr><tr><td>Warning</td><td><inline-formula id="IEq1"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$x\notin [\mu -1.5\sigma ,\mu +3.5\sigma ]$$\end{document}</tex-math><mml:math id="M2"><mml:mi>x</mml:mi><mml:mo>∉</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mi>μ</mml:mi><mml:mo>−</mml:mo><mml:mn>1.5</mml:mn><mml:mi>σ</mml:mi><mml:mo>,</mml:mo><mml:mi>μ</mml:mi><mml:mo>+</mml:mo><mml:mn>3.5</mml:mn><mml:mi>σ</mml:mi></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41597_2022_1833_Article_IEq1.gif"/></alternatives></inline-formula></td></tr><tr><td>Pass</td><td><inline-formula id="IEq2"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$x\in [\mu -1.5\sigma ,\mu +3.5\sigma ]$$\end{document}</tex-math><mml:math id="M4"><mml:mi>x</mml:mi><mml:mo>∈</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mi>μ</mml:mi><mml:mo>−</mml:mo><mml:mn>1.5</mml:mn><mml:mi>σ</mml:mi><mml:mo>,</mml:mo><mml:mi>μ</mml:mi><mml:mo>+</mml:mo><mml:mn>3.5</mml:mn><mml:mi>σ</mml:mi></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41597_2022_1833_Article_IEq2.gif"/></alternatives></inline-formula></td></tr></tbody></table><table-wrap-foot><p><italic>x</italic> is the number of streamlines of the bundle of interest;</p><p><italic>μ</italic> and <italic>σ</italic> are the average and the standard deviation, respectively, of the number of streamlines for the bundle of interest, across all subjects.</p></table-wrap-foot></table-wrap></p>
        </sec>
        <sec id="FPar5">
          <title>Manual quality control using <italic>dmriqcpy</italic></title>
          <p id="Par54">A bundle was removed if it looked visually incomplete or if it deviated from the expected pathway. A poor bundle reconstruction might have an algorithmic cause, such as sub-optimal tracking parameters or improper registration in RBX. It might also have an anatomical cause, such as unknown or undisclosed neurological conditions. Furthermore, visually evaluating a bundle reconstruction is very subjective, and a rater’s evaluation can be affected by the time of day, duration of QC, or even the angle of visualization in the QC tool<sup><xref ref-type="bibr" rid="CR63">63</xref></sup>. For all those reasons, and with the goal of establishing a gold standard for ML tractography methods, we chose to be somewhat severe in the rating of bundles, in order to minimize the number of false positives, even if that meant missing out some true positive data. After QC, we chose to ignore the following bundles from the atlas due to generalized reconstruction errors: AC, CC_Te, Fx, ICP, PC, SCP. From the initial 354 volumes, after all the processing steps and quality control, we were left with 284 volumes and associated bundles. The final atlas bundles used to build <italic>TractoInferno</italic> and evaluate future candidate tractograms are shown in Fig. <xref rid="Fig5" ref-type="fig">5</xref>.</p>
        </sec>
      </sec>
    </sec>
  </sec>
  <sec id="Sec17">
    <title>Data Records</title>
    <p id="Par55">Available data include T1W images, DTI metrics maps (FA/AD/MD/RD), DWI images with bvals/bvecs, fODF maps and fODF peaks, white matter/grey matter/csf masks, DWI SH maps (SH of order 6 fitted to the DWI signal, using the descoteaux07 SH basis<sup><xref ref-type="bibr" rid="CR53">53</xref></sup>: <ext-link ext-link-type="uri" xlink:href="https://dipy.org/documentation/1.3.0./theory/sh_basis/">https://dipy.org/documentation/1.3.0./theory/sh_basis/</ext-link>, and reference tractograms for the bundles described above, if a bundle reconstruction was possible for the subject.</p>
    <p id="Par56">The data is publicly available on the OpenNeuro platform at <ext-link ext-link-type="uri" xlink:href="https://openneuro.org/datasets/ds003900/versions/1.1.1">https://openneuro.org/datasets/ds003900/versions/1.1.1</ext-link><sup><xref ref-type="bibr" rid="CR64">64</xref></sup>.</p>
  </sec>
  <sec id="Sec18">
    <title>Technical Validation</title>
    <p id="Par57">This section describes how we used <italic>TractoInferno</italic> to train machine learning models for tractography, and how we assessed each model’s performance.</p>
    <sec id="Sec19">
      <title>Evaluation pipeline for candidate tractograms</title>
      <p id="Par58">When evaluating machine learning tractography algorithms, we focus on the volume covered by the recognized bundles (compared to the gold standard bundles). We make no assumptions about the ability to “explore” the brain outside the scope of the <italic>TractoInferno</italic> dataset. Consequently, we ignore anything that is not recognized as a candidate bundle, and do not try to categorize streamlines as valid or invalid connections.</p>
      <p id="Par59">Candidate bundles are extracted in the same way that we defined the gold standard bundles. First, we run RBX to extract candidate bundles from the candidate whole-brain tractogram. Candidate bundles are then converted to binary volume coverage masks. Finally, each candidate mask is compared against its corresponding gold standard bundle mask to compute evaluation metrics.</p>
      <p id="Par60">For each subject in the testset, and for each available bundle of the given subject, we extract the following evaluation metrics: Dice score, overlap and overreach. The scores are averaged over all subjects of the testset to provide final scores. Altogether, these metrics help better understand the performance of a candidate tractography algorithm.</p>
      <p id="Par61">The evaluation pipeline is available online (<ext-link ext-link-type="uri" xlink:href="https://github.com/scil-vital/TractoInferno/">https://github.com/scil-vital/TractoInferno/</ext-link>) and should be used with the provided <italic>TractoInferno</italic> testset, along with the default RBX-flow models.</p>
    </sec>
    <sec id="Sec20">
      <title>RNN-based tractography</title>
      <p id="Par62">To gauge the performances of ML models trained on the <italic>TractoInferno</italic> dataset, we implemented an RNN model and the necessary framework to train it on a large-scale tractography database, which was used multiple times in published papers in the last few years, such as <italic>Learn2Track</italic><sup><xref ref-type="bibr" rid="CR18">18</xref></sup>, <italic>DeepTract</italic><sup><xref ref-type="bibr" rid="CR21">21</xref></sup>, and <italic>Entrack</italic><sup><xref ref-type="bibr" rid="CR20">20</xref></sup>. Using the base implementation, we can easily modify the last layer of the model and its loss function to mimic the mentioned RNN models, and a few more.</p>
      <p id="Par63">We chose the stacked Long Short-Term Memory (LSTM) network as the recurrent building block for conditional streamline prediction. The LSTM is a type of RNN designed specifically to handle long-term dependencies, with the ability to deal with exploding and vanishing gradient problems<sup><xref ref-type="bibr" rid="CR65">65</xref></sup>.</p>
      <sec id="Sec21">
        <title>Learn2track</title>
        <p id="Par64"><italic>Learn2track</italic><sup><xref ref-type="bibr" rid="CR18">18</xref></sup> proposed an RNN model for tractography, where the output of the model at each timestep is a 3D vector, used as the next direction of the streamline. The predicted vector is then scaled to the chosen step size, in order to match the lengths of the target and prediction.</p>
        <p id="Par65">From the same idea, we implemented an LSTM for deterministic tractography. As in the original <italic>learn2track</italic> paper, we used the squared error loss function between the target and prediction. The loss for a single streamline <italic>S</italic> composed of <italic>T</italic> steps is the following squared error:<disp-formula id="Equa"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathscr{L}}(S)=-\mathop{\sum }\limits_{t=1}^{T}{\left\Vert {d}_{t}-{\widehat{d}}_{t}\right\Vert }^{2}$$\end{document}</tex-math><mml:math id="M6" display="block"><mml:mi mathvariant="script">L</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mspace width="-0.25em"/><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:munderover><mml:msup><mml:mrow><mml:mfenced close="∥" open="∥"><mml:mrow><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mo>^</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:math><graphic xlink:href="41597_2022_1833_Article_Equa.gif" position="anchor"/></alternatives></disp-formula>where <italic>d</italic><sub><italic>t</italic></sub> and <inline-formula id="IEq3"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\widehat{d}}_{t}$$\end{document}</tex-math><mml:math id="M8"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mo>^</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41597_2022_1833_Article_IEq3.gif"/></alternatives></inline-formula> are the target and predicted directions. This model is noted as <italic>Det-SE</italic>.</p>
        <p id="Par66">However, to accurately reflect that only the direction of the predicted vector is important (not the magnitude), we also performed an experiment where we minimized the negative cosine similarity between the target and predicted directions:<disp-formula id="Equb"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathscr{L}}(S)=-\mathop{\sum }\limits_{t=1}^{T}{\rm{\cos }}({\theta }_{t})=-\mathop{\sum }\limits_{t=1}^{T}\frac{{d}_{t}\cdot {\widehat{d}}_{t}}{\left\Vert {d}_{t}\right\Vert \left\Vert {\widehat{d}}_{t}\right\Vert }$$\end{document}</tex-math><mml:math id="M10" display="block"><mml:mi mathvariant="script">L</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mspace width="-0.25em"/><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:munderover><mml:mi mathvariant="normal">cos</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mspace width="-0.25em"/><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:munderover><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>⋅</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mo>^</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mfenced close="∥" open="∥"><mml:mrow><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mfenced close="∥" open="∥"><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mo>^</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:mfrac></mml:math><graphic xlink:href="41597_2022_1833_Article_Equb.gif" position="anchor"/></alternatives></disp-formula>where <italic>θ</italic><sub><italic>t</italic></sub> is the angle between <italic>d</italic><sub><italic>t</italic></sub> and <inline-formula id="IEq4"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\widehat{d}}_{t}$$\end{document}</tex-math><mml:math id="M12"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mo>^</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41597_2022_1833_Article_IEq4.gif"/></alternatives></inline-formula>. This model is noted as <italic>Det-Cosine</italic>.</p>
      </sec>
      <sec id="Sec22">
        <title>DeepTract</title>
        <p id="Par67">In the same spirit as <italic>learn2track</italic>, <italic>DeepTract</italic><sup><xref ref-type="bibr" rid="CR21">21</xref></sup> is a recurrent model for probabilistic tractography. In this case, the model output is a distribution over classes, where each class corresponds to a direction on the unit sphere, i.e. a discrete conditional fODF.</p>
        <p id="Par68">As in the original paper, we implemented a cross-entropy loss function:<disp-formula id="Equc"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathscr{L}}(S)=-\mathop{\sum }\limits_{t=1}^{T}\mathop{\sum }\limits_{m=1}^{M}{y}_{tm}{\rm{\log }}\left({\widehat{y}}_{tm}\right)$$\end{document}</tex-math><mml:math id="M14" display="block"><mml:mi mathvariant="script">L</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mspace width="-0.25em"/><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:munderover><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>M</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mi mathvariant="normal">log</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mo>^</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:math><graphic xlink:href="41597_2022_1833_Article_Equc.gif" position="anchor"/></alternatives></disp-formula>where <italic>M</italic> is the number of classes, and <italic>y</italic><sub><italic>t</italic></sub> and <inline-formula id="IEq5"><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\widehat{y}}_{t}$$\end{document}</tex-math><mml:math id="M16"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mo>^</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41597_2022_1833_Article_IEq5.gif"/></alternatives></inline-formula> are vectors of target and predicted class probabilities. Note that we did not use label smoothing as in the original paper, nor entropy-based tracking termination. This model is noted as <italic>Prob-Sphere</italic>.</p>
      </sec>
      <sec id="Sec23">
        <title>Entrack</title>
        <p id="Par69"><italic>Entrack</italic><sup><xref ref-type="bibr" rid="CR20">20</xref></sup> is a non-recurrent artificial neural network for probabilistic tractography. The model is instead a feed-forward neural network, but includes the previous streamline direction as prior information to guide the tracking process. The model outputs the parameters for a von Mises-Fisher distribution, i.e. a 3D unit-length vector for the mean, and a scalar concentration parameter. The distribution is analogous to a Gaussian distribution, but defined on the unit sphere instead of euclidean space.</p>
        <p id="Par70">We chose to apply the same general idea, using a recurrent network that predicts the parameters for a von Mises-Fisher distribution on a 3D sphere. We used the negative log-likelihood of the von Mises-Fisher distribution as the loss function:<disp-formula id="Equd"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathscr{L}}(S)=-\mathop{\sum }\limits_{t=1}^{T}{\rm{\log }}\left[C({\widehat{\kappa }}_{t}){\rm{\exp }}\left({\widehat{\kappa }}_{t}{\widehat{\mu }}_{t}^{{\rm{T}}}{d}_{t}\right)\right]$$\end{document}</tex-math><mml:math id="M18" display="block"><mml:mi mathvariant="script">L</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mspace width="-0.25em"/><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:munderover><mml:mi mathvariant="normal">log</mml:mi><mml:mfenced close="]" open="["><mml:mrow><mml:mi>C</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>κ</mml:mi></mml:mrow><mml:mrow><mml:mo>^</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi mathvariant="normal">exp</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>κ</mml:mi></mml:mrow><mml:mrow><mml:mo>^</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mo>^</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">T</mml:mi></mml:mrow></mml:msubsup><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced></mml:math><graphic xlink:href="41597_2022_1833_Article_Equd.gif" position="anchor"/></alternatives></disp-formula>where the predicted parameters of the distribution are <inline-formula id="IEq6"><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\widehat{\mu }}_{t}$$\end{document}</tex-math><mml:math id="M20"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mo>^</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41597_2022_1833_Article_IEq6.gif"/></alternatives></inline-formula> (a unit-length vector) and <inline-formula id="IEq7"><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\widehat{\kappa }}_{t}$$\end{document}</tex-math><mml:math id="M22"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>κ</mml:mi></mml:mrow><mml:mrow><mml:mo>^</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41597_2022_1833_Article_IEq7.gif"/></alternatives></inline-formula> (a scalar concentration parameter), and <italic>d</italic><sub><italic>t</italic></sub> is the target unit-length vector at step <italic>t</italic>. <inline-formula id="IEq8"><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$C({\widehat{\kappa }}_{t})$$\end{document}</tex-math><mml:math id="M24"><mml:mi>C</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>κ</mml:mi></mml:mrow><mml:mrow><mml:mo>^</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41597_2022_1833_Article_IEq8.gif"/></alternatives></inline-formula> abbreviates the normalization constant associated with the distribution, defined as following in the 3-dimensional case:<disp-formula id="Eque"><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${C}_{3}(\kappa )=\frac{\kappa }{2\pi \left({e}^{\kappa }-{e}^{-\kappa }\right)}$$\end{document}</tex-math><mml:math id="M26" display="block"><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>κ</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>κ</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mi>π</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mi>κ</mml:mi></mml:mrow></mml:msup><mml:mo>−</mml:mo><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mi>κ</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mfenced></mml:mrow></mml:mfrac></mml:math><graphic xlink:href="41597_2022_1833_Article_Eque.gif" position="anchor"/></alternatives></disp-formula></p>
        <p id="Par71">Note that unlike the original method, we didn’t use an entropy maximization scheme to regularize the predicted distribution. This implementation is noted as <italic>Prob-vMF</italic>.</p>
      </sec>
      <sec id="Sec24">
        <title>Gaussian distribution output</title>
        <p id="Par72">Following <italic>Entrack</italic> and the idea of predicting the parameters of a continuous probability distribution, we implemented another model, using a multivariate Gaussian distribution instead of a von Mises-Fisher distribution. This model outputs a 3D vector for the mean, and 3 scalars for the variance, (one in each dimension). We choose to use a diagonal covariance matrix, for stability, and do not output any values for covariance.</p>
        <p id="Par73">In the 3-dimensional case, the negative log-likelihood loss function is:<disp-formula id="Equf"><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathscr{L}}(S)=-\mathop{\sum }\limits_{t=1}^{T}{\rm{\log }}\left[\frac{1}{\sqrt{{(2\pi )}^{3}| {\widehat{{\boldsymbol{\Sigma }}}}_{t}| }}{\rm{\exp }}\left(-\frac{1}{2}{\left({d}_{t}-{\widehat{\mu }}_{t}\right)}^{{\rm{T}}}{\widehat{\Sigma }}_{t}^{-1}\left({d}_{t}-{\widehat{\mu }}_{t}\right)\right)\right]$$\end{document}</tex-math><mml:math id="M28" display="block"><mml:mi mathvariant="script">L</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mspace width="-0.25em"/><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:munderover><mml:mi mathvariant="normal">log</mml:mi><mml:mfenced close="]" open="["><mml:mrow><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msqrt><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:mi>π</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msup><mml:mo>∣</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold">Σ</mml:mi></mml:mrow><mml:mrow><mml:mo>^</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>∣</mml:mo></mml:mrow></mml:msqrt></mml:mrow></mml:mfrac><mml:mi mathvariant="normal">exp</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac><mml:msup><mml:mrow><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mo>^</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mi mathvariant="normal">T</mml:mi></mml:mrow></mml:msup><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="normal">Σ</mml:mi></mml:mrow><mml:mrow><mml:mo>^</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mo>^</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced></mml:math><graphic xlink:href="41597_2022_1833_Article_Equf.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq9"><alternatives><tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\boldsymbol{\Sigma }}}_{t}=\left[\begin{array}{lll}{\sigma }_{xt}^{2} &amp; 0 &amp; 0\\ 0 &amp; {\sigma }_{yt}^{2} &amp; 0\\ 0 &amp; 0 &amp; {\sigma }_{zt}^{2}\end{array}\right]$$\end{document}</tex-math><mml:math id="M30"><mml:msub><mml:mrow><mml:mi mathvariant="bold">Σ</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfenced close="]" open="["><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>x</mml:mi><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mtd><mml:mtd columnalign="left"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="left"><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="left"><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>y</mml:mi><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mtd><mml:mtd columnalign="left"><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="left"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="left"><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>z</mml:mi><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="41597_2022_1833_Article_IEq9.gif"/></alternatives></inline-formula> is the predicted diagonal covariance matrix at streamline step <italic>t</italic>. This model is noted as <italic>Prob-Gaussian</italic>.</p>
      </sec>
      <sec id="Sec25">
        <title>Gaussian mixture distribution output</title>
        <p id="Par74">The previous Gaussian model outputs a single average direction which is appropriated in most cases. However, there may be cases of bundle fanning or forking where the single-mode assumption may be an issue. This is because the Gaussian probability density can only be spread over a large area.</p>
        <p id="Par75">As such, some regions may be better modelled with more than one location of higher density. To this end, we implemented a mixture density network<sup><xref ref-type="bibr" rid="CR66">66</xref></sup> using a mixture of 3 Gaussian distributions. For each Gaussian, the model outputs 1 mixture weight, a 3D vector for the mean, and 3 scalars for the variances (again, we fix the covariances to zero).</p>
        <p id="Par76">In the 3-dimensional case, using a mixture of 3 Gaussians, the negative log-likelihood loss function is:<disp-formula id="Equg"><alternatives><tex-math id="M31">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{array}{lll}{\mathscr{L}}(S) &amp; = &amp; -\mathop{\sum }\limits_{t=1}^{T}{\rm{\log }}\left[\mathop{\sum }\limits_{k=1}^{3}{\phi }_{kt}{\mathscr{N}}\left({d}_{t}| {\widehat{\mu }}_{kt},{\widehat{\Sigma }}_{kt}\right)\right]\\  &amp; = &amp; -\mathop{\sum }\limits_{t=1}^{T}{\rm{\log }}\left[\mathop{\sum }\limits_{k=1}^{3}{\phi }_{kt}\frac{1}{\sqrt{{(2\pi )}^{3}| {\widehat{{\boldsymbol{\Sigma }}}}_{kt}| }}{\rm{\exp }}\left(-\frac{1}{2}{\left({d}_{t}-{\widehat{\mu }}_{kt}\right)}^{{\rm{T}}}{\widehat{\Sigma }}_{kt}^{-1}\left({d}_{t}-{\widehat{\mu }}_{kt}\right)\right)\right]\end{array}$$\end{document}</tex-math><mml:math id="M32" display="block"><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mi mathvariant="script">L</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mo>=</mml:mo></mml:mtd><mml:mtd columnalign="left"><mml:mo>−</mml:mo><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:munderover><mml:mi mathvariant="normal">log</mml:mi><mml:mfenced close="]" open="["><mml:mrow><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>ϕ</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mi mathvariant="script">N</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>∣</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mo>^</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="normal">Σ</mml:mi></mml:mrow><mml:mrow><mml:mo>^</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"/><mml:mtd columnalign="left"><mml:mo>=</mml:mo></mml:mtd><mml:mtd columnalign="left"><mml:mo>−</mml:mo><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:munderover><mml:mi mathvariant="normal">log</mml:mi><mml:mfenced close="]" open="["><mml:mrow><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>ϕ</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msqrt><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:mi>π</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msup><mml:mo>∣</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold">Σ</mml:mi></mml:mrow><mml:mrow><mml:mo>^</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>∣</mml:mo></mml:mrow></mml:msqrt></mml:mrow></mml:mfrac><mml:mi mathvariant="normal">exp</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac><mml:msup><mml:mrow><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mo>^</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mi mathvariant="normal">T</mml:mi></mml:mrow></mml:msup><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="normal">Σ</mml:mi></mml:mrow><mml:mrow><mml:mo>^</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mo>^</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="41597_2022_1833_Article_Equg.gif" position="anchor"/></alternatives></disp-formula>where <italic>k</italic> denotes the number of Gaussians in the mixture, and <italic>ϕ</italic><sub><italic>kt</italic></sub> is the mixture parameter for the Gaussian <italic>k</italic> at streamline step <italic>t</italic>. This model is noted as <italic>Prob-Mixture</italic>.</p>
      </sec>
      <sec id="Sec26">
        <title>Implementation details</title>
        <p id="Par77">All models were composed of 5 hidden layers of 500 units, used dropout with a rate of 0.1, and a batch size of 50 000 streamline steps. We added skip connections from the input layer to all hidden layers, and from all hidden layers to the output layer, inspired by (Graves, 2013)<sup><xref ref-type="bibr" rid="CR67">67</xref></sup>. We applied layer normalization<sup><xref ref-type="bibr" rid="CR68">68</xref></sup> between all hidden layers, in order to stabilize the hidden state dynamics in recurrent neural networks. We used the Adam optimizer with the default parameters.</p>
        <p id="Par78">For all experiments, we used the maximal spherical harmonics (SH) coefficients of order 6 fitted to the TractoFlow-processed DWI signal as the input signal, without any other pre-processing. In all cases, the models were trained using the exact same training and validation datasets, with streamlines resampled to a fixed step size of 1.0 mm. To help guide the model, we also included as input the diffusion signal in a neighbourhood of 6 directions (two for each axis, positive and negative) at a distance of 1.2 mm.</p>
        <p id="Par79">All models were trained for a maximum of 30 epochs (corresponding to around 2 weeks of training time on a 16 Gb NVidia V100SXM2), but early stopping was used to stop training when the loss has not improved after 5 epochs. Each epoch was capped to 10 000 updates, as the sheer size of the dataset would otherwise require multiple days of training for a single epoch.</p>
      </sec>
    </sec>
    <sec id="Sec27">
      <title>Baselines benchmark results</title>
      <p id="Par80">Machine learning models were trained using the <italic>TractoInferno</italic> database, with a training set of 198 volumes and a validation set of 58 volumes. We report in Table <xref rid="Tab4" ref-type="table">4</xref> the results of the <italic>TractoInferno</italic> evaluation pipeline on the testing set of 28 volumes. Results include each individual tractography algorithm used to build the reference bundles, along with predictions for every trained ML model.<table-wrap id="Tab4"><label>Table 4</label><caption><p>Tractography evaluation results on the <italic>TractoInferno</italic> dataset. The Prob-vMF model did not produce valid results, and is noted as {N/A}.</p></caption><table frame="hsides" rules="groups"><thead><tr><th/><th>Dice</th><th>Overlap</th><th>Overreach</th></tr></thead><tbody><tr><td colspan="4"><italic>Reference methods</italic></td></tr><tr><td>Deterministic</td><td>0.397</td><td>0.267</td><td>0.029</td></tr><tr><td>Probabilistic</td><td>0.553</td><td>0.433</td><td>0.068</td></tr><tr><td>PFT</td><td>0.680</td><td>0.688</td><td>0.266</td></tr><tr><td>SET</td><td>0.624</td><td>0.570</td><td>0.184</td></tr><tr><td>Ensemble (Det + Prob + PFT + SET)</td><td>1.000</td><td>1.000</td><td>0.000</td></tr><tr><td colspan="4"><italic>RNN-based methods</italic></td></tr><tr><td>Det-SE (Learn2track)</td><td>0.580</td><td>0.495</td><td>0.172</td></tr><tr><td>Det-Cosine</td><td>0.606</td><td>0.535</td><td>0.204</td></tr><tr><td>Prob-Sphere (DeepTract)</td><td>0.601</td><td>0.534</td><td>0.202</td></tr><tr><td>Prob-vMF (Entrack)</td><td>N/A</td><td>N/A</td><td>N/A</td></tr><tr><td>Prob-Gaussian</td><td>0.624</td><td>0.585</td><td>0.264</td></tr><tr><td>Prob-Mixture</td><td>0.407</td><td>0.284</td><td>0.053</td></tr></tbody></table></table-wrap></p>
      <p id="Par81">Of all the base algorithms used to build the reference tractograms, PFT performed the best in terms of Dice score and overlap. This is consistent with the fact that it is a state-of-the-art algorithm, and works best when trying to fill the space with streamlines. However, we show that no algorithm can single-handedly account for the gold standard, and using the union of all methods provides a more complete reconstruction.</p>
      <p id="Par82">In both traditional and RNN-based variants, models with the best Dice/ overlap results also had the worst overreach score. However, in the case of bundle reconstruction, it is less of a concern, because there is always a possibility of applying post-processing techniques to filter streamlines. Also, since our gold standard is not perfect, it might not cover the whole possible space as delineated by the RBX algorithm. Furthermore, because the scores are evaluated using binary bundle masks, a small number of streamlines can easily cross a high number of overreaching voxels. Ultimately, the goal is to find a model that can cover as much space as possible, so the overreach score is an interesting information to have, but is not the best indicator of performance in our case.</p>
      <p id="Par83">Of all the RNN-based methods, the Gaussian output model obtained the best Dice score and overlap, hinting that a probabilistic model works best. This is in line with traditional probabilistic algorithms being more suited to bundle reconstruction than deterministic approaches. Given the worse performance of other probabilistic models, it seems that adding complexity is not always beneficial. Training an RNN with a more complex distribution like the mixture of Gaussians might require a different architecture, or more model capacity, to achieve better results. Unfortunately, the RNN with a von Mises-Fisher output had a hard time training, and produced erratic streamlines that mostly did not survive the evaluation pipeline. It would seem that training the vMF distribution is too unstable when using a likelihood loss function, and performing an entropy maximization procedure like the original authors might be required to have a stable training procedure.</p>
      <p id="Par84">To evaluate the out-of-distribution generalization capabilities of ML models, we additionally ran leave-one-site-out cross-validation experiments. In this case, each model was trained on 5 sites out of 6, and tested on the unseen site. We repeated the process 6 times, each time using a new site as an independent testset, effectively running 30 additional experiments (5 models × 6 leave-one-out datasets). We report the mean and standard deviation of all evaluation metrics across the 6 experiments for each model in Table <xref rid="Tab5" ref-type="table">5</xref>. Cross-validation results are overall very similar to whole-dataset training. Encouragingly, it would indicate a suitable robustness of ML tractography models to unseen scanners after training on as few as 5 different scanners.<table-wrap id="Tab5"><label>Table 5</label><caption><p>Tractography cross-validation results on the <italic>TractoInferno</italic> dataset. The Prob-vMF model did not produce valid results, and is noted as {N/A}.</p></caption><table frame="hsides" rules="groups"><thead><tr><th/><th>Dice</th><th>Overlap</th><th>Overreach</th></tr></thead><tbody><tr><td colspan="4"><italic>Reference methods</italic></td></tr><tr><td>Deterministic</td><td>0.409 ± 0.031</td><td>0.276 ± 0.027</td><td>0.027 ± 0.005</td></tr><tr><td>Probabilistic</td><td>0.571 ± 0.032</td><td>0.448 ± 0.031</td><td>0.066 ± 0.009</td></tr><tr><td>PFT</td><td>0.691 ± 0.078</td><td>0.692 ± 0.120</td><td>0.257 ± 0.062</td></tr><tr><td>SET</td><td>0.638 ± 0.044</td><td>0.590 ± 0.072</td><td>0.188 ± 0.047</td></tr><tr><td>Ensemble (Det + Prob + PFT + SET)</td><td>1.000 ± 0.000</td><td>1.000 ± 0.000</td><td>0.000 ± 0.000</td></tr><tr><td colspan="4"><italic>RNN-based methods</italic></td></tr><tr><td>Det-SE (Learn2track)</td><td>0.610 ± 0.022</td><td>0.539 ± 0.032</td><td>0.206 ± 0.039</td></tr><tr><td>Det-Cosine</td><td>0.599 ± 0.043</td><td>0.528 ± 0.052</td><td>0.198 ± 0.030</td></tr><tr><td>Prob-Sphere (DeepTract)</td><td>0.550 ± 0.051</td><td>0.449 ± 0.052</td><td>0.128 ± 0.027</td></tr><tr><td>Prob-vMF (Entrack)</td><td>N/A</td><td>N/A</td><td>N/A</td></tr><tr><td>Prob-Gaussian</td><td>0.561 ± 0.049</td><td>0.475 ± 0.059</td><td>0.166 ± 0.041</td></tr><tr><td>Prob-Mixture</td><td>0.489 ± 0.056</td><td>0.381 ± 0.059</td><td>0.101 ± 0.033</td></tr></tbody></table></table-wrap></p>
      <p id="Par85">Across all results (both reference algorithms and RNN-based methods, either whole-dataset training or cross-validation), the general trend holds that with a better Dice score and overlap, there is also more overreach. This indicates that there is still work to be done to limit the production of false positive streamlines.</p>
      <p id="Par86">To illustrate the differences between algorithms, we showcase the reconstructions of three bundles taken from a random test subject after whole-dataset training. We chose bundles of both <italic>medium</italic> and <italic>hard</italic> difficulty for tractography, as reported in (Maier-Hein <italic>et al</italic>.)<sup><xref ref-type="bibr" rid="CR2">2</xref></sup>. Figure <xref rid="Fig6" ref-type="fig">6</xref> shows a part of the <italic>Corpus Callosum</italic> (medium difficulty), while Figs. <xref rid="Fig7" ref-type="fig">7</xref> and <xref rid="Fig8" ref-type="fig">8</xref> show the <italic>Optic Radiation</italic> and the <italic>Pyramidal Tract</italic> (hard difficulty). Note that in all cases, as mentioned before, the Prob-vMF method did not produce any meaningful results, which explains why no results are shown.<fig id="Fig6"><label>Fig. 6</label><caption><p>Reconstruction of the <italic>Corpus Callosum</italic> (medium difficulty) by all algorithms, for test subject sub-1006.</p></caption><graphic xlink:href="41597_2022_1833_Fig6_HTML" id="d32e3450"/></fig><fig id="Fig7"><label>Fig. 7</label><caption><p>Reconstruction of the <italic>Optic Radiation</italic> (hard difficulty) by all algorithms, for test subject sub-1006.</p></caption><graphic xlink:href="41597_2022_1833_Fig7_HTML" id="d32e3466"/></fig><fig id="Fig8"><label>Fig. 8</label><caption><p>Reconstruction of the <italic>Pyramidal Tract</italic> (hard difficulty) by all algorithms, for test subject sub-1006.</p></caption><graphic xlink:href="41597_2022_1833_Fig8_HTML" id="d32e3481"/></fig></p>
      <p id="Par87">Also of note, RNN-based models seem to get results on par with traditional algorithms, but not quite as good as the state-of-the-art Particle-Filtered Tractography. However, (Poulin <italic>et al</italic>.)<sup><xref ref-type="bibr" rid="CR69">69</xref></sup> produced results far beyond even PFT using an RNN approach trained on a single-database, using a single-bundle per model<sup><xref ref-type="bibr" rid="CR69">69</xref></sup>. While we did not train any model with the single-bundle approach on <italic>TractoInferno</italic>, both results hint that there is a need for more data, more model capacity, or for specialization of algorithms, in order to outperform currently-used methods. We advocate that <italic>TractoInferno</italic> is one way to investigate this problem further.</p>
      <p id="Par88">In conclusion, ML tractography methods seem to reproduce (to a worse degree) what ensemble tractography finds. Possible reasons for this is that there is some noise in the gold standard streamlines used for training, and models may somewhat under-fit the data. Indeed, all standard tractography algorithms produce noisy approximations of possible white matter tracts. Furthermore, the bundle segmentation method used to produce gold standard bundles is far from perfect and can be variable from one execution to another, which affects both gold standard streamlines, and the evaluation procedure (however, it is still one the best methods available given the large-scale of TractoInferno). In addition, all ML models used in this paper were trained up to a hard time threshold of two weeks given limited computational resources, and some of those models had not yet attained a training loss minima, which points to under-fitted models. Given the still increasing computation capabilities of GPUs, future experiments would do well to train models up to completion, while also augmenting model capacity by increasing the size and number of hidden layers until one can reach overfitting conditions.</p>
    </sec>
    <sec id="Sec28">
      <title>Potential limitations</title>
      <p id="Par89">The proposed dataset and evaluation methods are not void of limitations. First, the bundle segmentation method (RecoBundlesX) is not perfect, and suffers from some degree of variability between executions, which affects both the gold standard bundles and the evaluation of candidate tractograms. Second, the <italic>TractoInferno</italic> dataset contains only healthy subjects; it is unclear how trained models might perform on unhealthy subjects, and should be used only with caution. Finally, we experimented with recurrent neural networks, while there are other model architectures that could provide useful for tractography, such as convolutional neural networks like TractSeg<sup><xref ref-type="bibr" rid="CR19">19</xref></sup> and Transformer models<sup><xref ref-type="bibr" rid="CR70">70</xref></sup>.</p>
    </sec>
  </sec>
  <sec id="Sec29">
    <title>Usage Notes</title>
    <p id="Par90">The data available on OpenNeuro contains a /derivatives directory, which contains all processed data, organized into training, validation, and testing subsets. Files are organized first by subject (sub-*/), then by file type (e.g. anat/). All files follow the same naming convention: [SUBJECT_ID]__[FILENAME].[EXT].</p>
    <p id="Par91">Tractograms contain compressed streamlines to reduce space, which means that the step size is variable. If a fixed step size is required, it is possible to manually resample the streamlines, using the public repository SCILPY (<ext-link ext-link-type="uri" xlink:href="https://github.com/scilus/scilpy">https://github.com/scilus/scilpy</ext-link>) and the scil_resample_streamlines.py script, found here: <ext-link ext-link-type="uri" xlink:href="https://github.com/scilus/scilpy/blob/master/scripts/scil_resample_streamlines.py">https://github.com/scilus/scilpy/blob/master/scripts/scil_resample_streamlines.py</ext-link> .<table-wrap id="Tab6"><label>Table 6</label><caption><p><italic>TractoInferno</italic> processing steps.</p></caption><table frame="hsides" rules="groups"><thead><tr><th>Processing step</th><th>Software/Tool</th><th>URL</th></tr></thead><tbody><tr><td rowspan="2">Quality control (DWI, TractoFlow, RBX)</td><td rowspan="2">dmriqcpy</td><td><ext-link ext-link-type="uri" xlink:href="http://github.com/scilus/dmriqcpy">github.com/scilus/dmriqcpy</ext-link></td></tr><tr><td><ext-link ext-link-type="uri" xlink:href="http://github.com/scilus/dmriqc_flow">github.com/scilus/dmriqc_flow</ext-link></td></tr><tr><td>Data processing</td><td>TractoFlow</td><td><ext-link ext-link-type="uri" xlink:href="http://github.com/scilus/tractoflow/">github.com/scilus/tractoflow/</ext-link></td></tr><tr><td>SH signal fitting</td><td>SCILPY</td><td><ext-link ext-link-type="uri" xlink:href="http://github.com/ppoulin91/tractoinferno_compute_sh_flow">github.com/ppoulin91/tractoinferno_compute_sh_flow</ext-link></td></tr><tr><td>Tractography (Det, Prob, PFT)</td><td>SCILPY</td><td><ext-link ext-link-type="uri" xlink:href="http://github.com/ppoulin91/tractoinferno_tracking_flow">github.com/ppoulin91/tractoinferno_tracking_flow</ext-link></td></tr><tr><td rowspan="2">Tractography (SET)</td><td rowspan="2">SET</td><td><ext-link ext-link-type="uri" xlink:href="http://github.com/StongeEtienne/set-nf">github.com/StongeEtienne/set-nf</ext-link></td></tr><tr><td><ext-link ext-link-type="uri" xlink:href="http://github.com/scilus/convert_set_flow">github.com/scilus/convert_set_flow</ext-link></td></tr><tr><td>Bundle delineation</td><td>RecoBundlesX (RBX)</td><td><ext-link ext-link-type="uri" xlink:href="http://github.com/scilus/rbx_flow/">github.com/scilus/rbx_flow/</ext-link></td></tr></tbody></table></table-wrap></p>
  </sec>
</body>
<back>
  <fn-group>
    <fn>
      <p><bold>Publisher’s note</bold> Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <ack>
    <title>Acknowledgements</title>
    <p>Thanks to Laurent Petit for his help with the BIL &amp; GIN database. P.P. was supported by the FRQNT, grant #206270, and a MITACS grant jointly with Imeka (<ext-link ext-link-type="uri" xlink:href="http://www.imeka.ca">www.imeka.ca</ext-link>). This research was enabled in part by Compute Canada (<ext-link ext-link-type="uri" xlink:href="http://www.computecanada.ca">www.computecanada.ca</ext-link>) and CBRAIN (<ext-link ext-link-type="uri" xlink:href="http://www.cbrain.ca">www.cbrain.ca</ext-link>)<sup><xref ref-type="bibr" rid="CR61">61</xref></sup>.</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Author contributions</title>
    <p>P.P., G.T., F.R., E.S.-O. and M.D. conceived the processing pipeline. P.P. and G.T. executed the pipeline. E.S.-O. offered support for the SET algorithm. A.B., G.T., P.P., L.d.B. and S.G. procured and organized the original data. P.P., G.T. and M.D. did manual quality control on various output steps. P.-M.J. reviewed the development of ML algorithms. All authors reviewed the manuscript.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Code availability</title>
    <p>All code used to process the database is publicly available online. References to software are provided in Table <xref rid="Tab6" ref-type="table">6</xref>.</p>
    <p>The pipeline to evaluate new candidate tractograms along with the test set is available here: <ext-link ext-link-type="uri" xlink:href="https://github.com/scil-vital/TractoInferno/">https://github.com/scil-vital/TractoInferno/</ext-link>, and should be used with the same reference atlas: <ext-link ext-link-type="uri" xlink:href="https://zenodo.org/record/4630660#.YJvmwXVKhdU">https://zenodo.org/record/4630660#.YJvmwXVKhdU</ext-link><sup><xref ref-type="bibr" rid="CR62">62</xref></sup>.</p>
  </notes>
  <notes id="FPar6" notes-type="COI-statement">
    <title>Competing interests</title>
    <p id="Par92">The authors declare no competing interests.</p>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Farquharson</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>White matter fiber tractography: why we need to move beyond DTI: Clinical article</article-title>
        <source>Journal of Neurosurgery</source>
        <year>2013</year>
        <volume>118</volume>
        <fpage>1367</fpage>
        <lpage>1377</lpage>
        <pub-id pub-id-type="doi">10.3171/2013.2.JNS121294</pub-id>
        <?supplied-pmid 23540269?>
        <pub-id pub-id-type="pmid">23540269</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Maier-Hein</surname>
            <given-names>KH</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The challenge of mapping the human connectome based on diffusion tractography</article-title>
        <source>Nature Communications</source>
        <year>2017</year>
        <volume>8</volume>
        <fpage>1349</fpage>
        <pub-id pub-id-type="doi">10.1038/s41467-017-01285-x</pub-id>
        <?supplied-pmid 29116093?>
        <pub-id pub-id-type="pmid">29116093</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sarwar</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Ramamohanarao</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Zalesky</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Mapping connectomes with diffusion MRI: deterministic or probabilistic tractography?</article-title>
        <source>Magnetic Resonance in Medicine</source>
        <year>2019</year>
        <volume>81</volume>
        <fpage>1368</fpage>
        <lpage>1384</lpage>
        <pub-id pub-id-type="doi">10.1002/mrm.27471</pub-id>
        <?supplied-pmid 30303550?>
        <pub-id pub-id-type="pmid">30303550</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schilling</surname>
            <given-names>KG</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Challenges in diffusion MRI tractography–Lessons learned from international benchmark competitions</article-title>
        <source>Magnetic Resonance Imaging</source>
        <year>2019</year>
        <volume>57</volume>
        <fpage>194</fpage>
        <lpage>209</lpage>
        <pub-id pub-id-type="doi">10.1016/j.mri.2018.11.014</pub-id>
        <?supplied-pmid 30503948?>
        <pub-id pub-id-type="pmid">30503948</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Reisert</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Global fiber reconstruction becomes practical</article-title>
        <source>NeuroImage</source>
        <year>2011</year>
        <volume>54</volume>
        <fpage>955</fpage>
        <lpage>962</lpage>
        <pub-id pub-id-type="doi">10.1016/j.neuroimage.2010.09.016</pub-id>
        <?supplied-pmid 20854913?>
        <pub-id pub-id-type="pmid">20854913</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mangin</surname>
            <given-names>JF</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Toward global tractography</article-title>
        <source>NeuroImage</source>
        <year>2013</year>
        <volume>80</volume>
        <fpage>290</fpage>
        <lpage>296</lpage>
        <pub-id pub-id-type="doi">10.1016/j.neuroimage.2013.04.009</pub-id>
        <?supplied-pmid 23587688?>
        <pub-id pub-id-type="pmid">23587688</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jbabdi</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Woolrich</surname>
            <given-names>MW</given-names>
          </name>
          <name>
            <surname>Andersson</surname>
            <given-names>JLR</given-names>
          </name>
          <name>
            <surname>Behrens</surname>
            <given-names>TEJ</given-names>
          </name>
        </person-group>
        <article-title>A Bayesian framework for global tractography</article-title>
        <source>NeuroImage</source>
        <year>2007</year>
        <volume>37</volume>
        <fpage>116</fpage>
        <lpage>129</lpage>
        <pub-id pub-id-type="doi">10.1016/j.neuroimage.2007.04.039</pub-id>
        <?supplied-pmid 17543543?>
        <pub-id pub-id-type="pmid">17543543</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lemkaddem</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Skiöldebrand</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Dal Palú</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Thiran</surname>
            <given-names>J-P</given-names>
          </name>
          <name>
            <surname>Daducci</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Global tractography with embedded anatomical priors for quantitative connectivity analysis</article-title>
        <source>Frontiers in Neurology</source>
        <year>2014</year>
        <volume>5</volume>
        <fpage>232</fpage>
        <pub-id pub-id-type="doi">10.3389/fneur.2014.00232</pub-id>
        <?supplied-pmid 25452742?>
        <pub-id pub-id-type="pmid">25452742</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rheault</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Poulin</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Valcourt Caron</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>St-Onge</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Descoteaux</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Common misconceptions, hidden biases and modern challenges of dMRI tractography</article-title>
        <source>Journal of Neural Engineering</source>
        <year>2020</year>
        <volume>17</volume>
        <fpage>011001</fpage>
        <pub-id pub-id-type="doi">10.1088/1741-2552/ab6aad</pub-id>
        <?supplied-pmid 31931484?>
        <pub-id pub-id-type="pmid">31931484</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Daducci</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Dal Palú</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Lemkaddem</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Thiran</surname>
            <given-names>J-P</given-names>
          </name>
        </person-group>
        <article-title>COMMIT: Convex Optimization Modeling for Microstructure Informed Tractography</article-title>
        <source>IEEE Transactions on Medical Imaging</source>
        <year>2015</year>
        <volume>34</volume>
        <fpage>246</fpage>
        <lpage>257</lpage>
        <pub-id pub-id-type="doi">10.1109/TMI.2014.2352414</pub-id>
        <?supplied-pmid 25167548?>
        <pub-id pub-id-type="pmid">25167548</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Smith</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Tournier</surname>
            <given-names>J-D</given-names>
          </name>
          <name>
            <surname>Calamante</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Connelly</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>&amp; Feb. SIFT: Spherical-deconvolution informed filtering of tractograms</article-title>
        <source>NeuroImage</source>
        <year>2013</year>
        <volume>67</volume>
        <fpage>298</fpage>
        <lpage>312</lpage>
        <pub-id pub-id-type="doi">10.1016/j.neuroimage.2012.11.049</pub-id>
        <?supplied-pmid 23238430?>
        <pub-id pub-id-type="pmid">23238430</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Smith</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Tournier</surname>
            <given-names>J-D</given-names>
          </name>
          <name>
            <surname>Calamante</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Connelly</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>SIFT2: Enabling dense quantitative assessment of brain white matter connectivity using streamlines tractography</article-title>
        <source>NeuroImage</source>
        <year>2015</year>
        <volume>119</volume>
        <fpage>338</fpage>
        <lpage>351</lpage>
        <pub-id pub-id-type="doi">10.1016/j.neuroimage.2015.06.092</pub-id>
        <?supplied-pmid 26163802?>
        <pub-id pub-id-type="pmid">26163802</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Legarreta</surname>
            <given-names>JH</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Filtering in tractography using autoencoders (FINTA</article-title>
        <source>Medical Image Analysis</source>
        <year>2021</year>
        <volume>72</volume>
        <fpage>102126</fpage>
        <pub-id pub-id-type="doi">10.1016/j.media.2021.102126</pub-id>
        <?supplied-pmid 34161915?>
        <pub-id pub-id-type="pmid">34161915</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <mixed-citation publication-type="other">Garyfallidis, E., Brett, M., Correia, M. M., Williams, G. B. &amp; Nimmo-Smith, I. QuickBundles, a Method for Tractography Simplification. <italic>Frontiers in Neuroscience</italic><bold>6</bold>, 10.3389/fnins.2012.00175 (2012).</mixed-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Siless</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Chang</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Fischl</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Yendiki</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>&amp; Feb. AnatomiCuts: Hierarchical clustering of tractography streamlines based on anatomical similarity</article-title>
        <source>NeuroImage</source>
        <year>2018</year>
        <volume>166</volume>
        <fpage>32</fpage>
        <lpage>45</lpage>
        <pub-id pub-id-type="doi">10.1016/j.neuroimage.2017.10.058</pub-id>
        <?supplied-pmid 29100937?>
        <pub-id pub-id-type="pmid">29100937</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Poulin</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Jörgens</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Jodoin</surname>
            <given-names>P-M</given-names>
          </name>
          <name>
            <surname>Descoteaux</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Tractography and machine learning: Current state and open challenges</article-title>
        <source>Magnetic Resonance Imaging</source>
        <year>2019</year>
        <volume>64</volume>
        <fpage>37</fpage>
        <lpage>48</lpage>
        <pub-id pub-id-type="doi">10.1016/j.mri.2019.04.013</pub-id>
        <?supplied-pmid 31078615?>
        <pub-id pub-id-type="pmid">31078615</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Neher</surname>
            <given-names>PF</given-names>
          </name>
          <name>
            <surname>Côté</surname>
            <given-names>M-A</given-names>
          </name>
          <name>
            <surname>Houde</surname>
            <given-names>J-C</given-names>
          </name>
          <name>
            <surname>Descoteaux</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Maier-Hein</surname>
            <given-names>KH</given-names>
          </name>
        </person-group>
        <article-title>Fiber tractography using machine learning</article-title>
        <source>NeuroImage</source>
        <year>2017</year>
        <volume>158</volume>
        <fpage>417</fpage>
        <lpage>429</lpage>
        <pub-id pub-id-type="doi">10.1016/j.neuroimage.2017.07.028</pub-id>
        <?supplied-pmid 28716716?>
        <pub-id pub-id-type="pmid">28716716</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <mixed-citation publication-type="other">Poulin, P. <italic>et al</italic>. Learn to Track: Deep Learning for Tractography. In Descoteaux, M. <italic>et al</italic>. (eds.) <italic>Medical Image Computing and Computer Assisted Intervention - MICCAI 2017</italic>, Lecture Notes in Computer Science, 540–547, 10.1007/978-3-319-66182-7_62 (Springer International Publishing, 2017).</mixed-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wasserthal</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Neher</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Maier-Hein</surname>
            <given-names>KH</given-names>
          </name>
        </person-group>
        <article-title>TractSeg - Fast and accurate white matter tract segmentation</article-title>
        <source>NeuroImage</source>
        <year>2018</year>
        <volume>183</volume>
        <fpage>239</fpage>
        <lpage>253</lpage>
        <pub-id pub-id-type="doi">10.1016/j.neuroimage.2018.07.070</pub-id>
        <?supplied-pmid 30086412?>
        <pub-id pub-id-type="pmid">30086412</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wegmayr</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Buhmann</surname>
            <given-names>JM</given-names>
          </name>
        </person-group>
        <article-title>Entrack: Probabilistic Spherical Regression with Entropy Regularization for Fiber Tractography</article-title>
        <source>International Journal of Computer Vision</source>
        <year>2020</year>
        <pub-id pub-id-type="doi">10.1007/s11263-020-01384-1</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <mixed-citation publication-type="other">Benou, I. &amp; Riklin Raviv, T. DeepTract: A Probabilistic Deep Learning Framework for White Matter Fiber Tractography. In Shen, D. <italic>et al</italic>. (eds.) <italic>Medical Image Computing and Computer Assisted Intervention</italic>–<italic>MICCAI 2019</italic>, Lecture Notes in Computer Science, 626–635, 10.1007/978-3-030-32248-9_70 (Springer International Publishing, 2019).</mixed-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mazoyer</surname>
            <given-names>B</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>BIL&amp;GIN: a neuroimaging, cognitive, behavioral, and genetic database for the study of human brain lateralization</article-title>
        <source>Neuroimage</source>
        <year>2016</year>
        <volume>124</volume>
        <fpage>1225</fpage>
        <lpage>1231</lpage>
        <pub-id pub-id-type="doi">10.1016/j.neuroimage.2015.02.071</pub-id>
        <?supplied-pmid 25840118?>
        <pub-id pub-id-type="pmid">25840118</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <mixed-citation publication-type="other">Tsuchida, A. <italic>et al</italic>. The MRi-Share database: brain imaging in a cross-sectional cohort of 1,870 university students. <italic>bioRxiv</italic> 2020.06.17.154666, 10.1101/2020.06.17.154666 (2020).</mixed-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bycroft</surname>
            <given-names>C</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The UK Biobank resource with deep phenotyping and genomic data</article-title>
        <source>Nature</source>
        <year>2018</year>
        <volume>562</volume>
        <fpage>203</fpage>
        <lpage>209</lpage>
        <pub-id pub-id-type="doi">10.1038/s41586-018-0579-z</pub-id>
        <?supplied-pmid 30305743?>
        <pub-id pub-id-type="pmid">30305743</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>DeLuca</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Rothman</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Bialystok</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Pliatsikas</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>Redefining bilingualism as a spectrum of experiences that differentially affects brain structure and function</article-title>
        <source>Proceedings of the National Academy of Sciences</source>
        <year>2019</year>
        <volume>116</volume>
        <fpage>7565</fpage>
        <lpage>7574</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.1811513116</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <mixed-citation publication-type="other">DeLuca, V. &amp; Pliatsikas, C. Bilingualism and the brain. OpenNeuro, Dataset ds001796, version 1.4.1, 10.18112/openneuro.ds001796.v1.4.1 (2020).</mixed-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Poldrack</surname>
            <given-names>RA</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A phenome-wide examination of neural and cognitive function</article-title>
        <source>Scientific Data</source>
        <year>2016</year>
        <volume>3</volume>
        <fpage>160110</fpage>
        <pub-id pub-id-type="doi">10.1038/sdata.2016.110</pub-id>
        <?supplied-pmid 27922632?>
        <pub-id pub-id-type="pmid">27922632</pub-id>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tamm</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The effect of sleep restriction on empathy for pain: An fMRI study in younger and older adults</article-title>
        <source>Scientific Reports</source>
        <year>2017</year>
        <volume>7</volume>
        <fpage>12236</fpage>
        <pub-id pub-id-type="doi">10.1038/s41598-017-12098-9</pub-id>
        <?supplied-pmid 28947790?>
        <pub-id pub-id-type="pmid">28947790</pub-id>
      </element-citation>
    </ref>
    <ref id="CR29">
      <label>29.</label>
      <mixed-citation publication-type="other">Nilsonne, G. <italic>et al</italic>. The stockholm sleepy brain study: Effects of sleep deprivation on cognitive and emotional processing in young and old. <italic>OpenNeuro</italic>10.18112/openneuro.ds000201.v1.0.3 (2020).</mixed-citation>
    </ref>
    <ref id="CR30">
      <label>30.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tremblay</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Mild traumatic brain injury: The effect of age at trauma onset on brain structure integrity</article-title>
        <source>NeuroImage: Clinical</source>
        <year>2019</year>
        <volume>23</volume>
        <fpage>101907</fpage>
        <pub-id pub-id-type="doi">10.1016/j.nicl.2019.101907</pub-id>
        <?supplied-pmid 31233955?>
        <pub-id pub-id-type="pmid">31233955</pub-id>
      </element-citation>
    </ref>
    <ref id="CR31">
      <label>31.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Theaud</surname>
            <given-names>G</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>TractoFlow: A robust, efficient and reproducible diffusion MRI pipeline leveraging Nextflow &amp; Singularity</article-title>
        <source>NeuroImage</source>
        <year>2020</year>
        <volume>218</volume>
        <fpage>116889</fpage>
        <pub-id pub-id-type="doi">10.1016/j.neuroimage.2020.116889</pub-id>
        <?supplied-pmid 32447016?>
        <pub-id pub-id-type="pmid">32447016</pub-id>
      </element-citation>
    </ref>
    <ref id="CR32">
      <label>32.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kurtzer</surname>
            <given-names>GM</given-names>
          </name>
          <name>
            <surname>Sochat</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Bauer</surname>
            <given-names>MW</given-names>
          </name>
        </person-group>
        <article-title>Singularity: Scientific containers for mobility of compute</article-title>
        <source>PLOS ONE</source>
        <year>2017</year>
        <volume>12</volume>
        <fpage>e0177459</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0177459</pub-id>
        <?supplied-pmid 28494014?>
        <pub-id pub-id-type="pmid">28494014</pub-id>
      </element-citation>
    </ref>
    <ref id="CR33">
      <label>33.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Di Tommaso</surname>
            <given-names>P</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Nextflow enables reproducible computational workflows</article-title>
        <source>Nature Biotechnology</source>
        <year>2017</year>
        <volume>35</volume>
        <fpage>316</fpage>
        <lpage>319</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.3820</pub-id>
        <?supplied-pmid 28398311?>
        <pub-id pub-id-type="pmid">28398311</pub-id>
      </element-citation>
    </ref>
    <ref id="CR34">
      <label>34.</label>
      <mixed-citation publication-type="other">Basser, P. J., Pajevic, S., Pierpaoli, C., Duda, J. &amp; Aldroubi, A. <italic>In vivo</italic> fiber tractography using DT-MRI data. <italic>Magnetic Resonance in Medicine</italic><bold>44</bold>, 625–632, 10.1002/1522-2594(200010)44:4&lt;625::AID-MRM17&gt;3.0.CO;2-O (2000).</mixed-citation>
    </ref>
    <ref id="CR35">
      <label>35.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tournier</surname>
            <given-names>J-D</given-names>
          </name>
          <name>
            <surname>Calamante</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Connelly</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>MRtrix: Diffusion tractography in crossing fiber regions</article-title>
        <source>International Journal of Imaging Systems and Technology</source>
        <year>2012</year>
        <volume>22</volume>
        <fpage>53</fpage>
        <lpage>66</lpage>
        <pub-id pub-id-type="doi">10.1002/ima.22005</pub-id>
      </element-citation>
    </ref>
    <ref id="CR36">
      <label>36.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Girard</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Whittingstall</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Deriche</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Descoteaux</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Towards quantitative connectivity analysis: reducing tractography biases</article-title>
        <source>NeuroImage</source>
        <year>2014</year>
        <volume>98</volume>
        <fpage>266</fpage>
        <lpage>278</lpage>
        <pub-id pub-id-type="doi">10.1016/j.neuroimage.2014.04.074</pub-id>
        <?supplied-pmid 24816531?>
        <pub-id pub-id-type="pmid">24816531</pub-id>
      </element-citation>
    </ref>
    <ref id="CR37">
      <label>37.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>St-Onge</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Daducci</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Girard</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Descoteaux</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Surface-enhanced tractography (SET)</article-title>
        <source>NeuroImage</source>
        <year>2018</year>
        <volume>169</volume>
        <fpage>524</fpage>
        <lpage>539</lpage>
        <pub-id pub-id-type="doi">10.1016/j.neuroimage.2017.12.036</pub-id>
        <?supplied-pmid 29258891?>
        <pub-id pub-id-type="pmid">29258891</pub-id>
      </element-citation>
    </ref>
    <ref id="CR38">
      <label>38.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Garyfallidis</surname>
            <given-names>E</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Recognition of white matter bundles using local and global streamline-based registration and clustering</article-title>
        <source>NeuroImage</source>
        <year>2018</year>
        <volume>170</volume>
        <fpage>283</fpage>
        <lpage>295</lpage>
        <pub-id pub-id-type="doi">10.1016/j.neuroimage.2017.07.015</pub-id>
        <?supplied-pmid 28712994?>
        <pub-id pub-id-type="pmid">28712994</pub-id>
      </element-citation>
    </ref>
    <ref id="CR39">
      <label>39.</label>
      <mixed-citation publication-type="other">Rheault, F. <italic>Analyse et reconstruction de faisceaux de la matière blanche</italic>. Ph.D. thesis, Université de Sherbrooke (2020).</mixed-citation>
    </ref>
    <ref id="CR40">
      <label>40.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Andersson</surname>
            <given-names>JLR</given-names>
          </name>
          <name>
            <surname>Skare</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Ashburner</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>How to correct susceptibility distortions in spin-echo echo-planar images: application to diffusion tensor imaging</article-title>
        <source>NeuroImage</source>
        <year>2003</year>
        <volume>20</volume>
        <fpage>870</fpage>
        <lpage>888</lpage>
        <pub-id pub-id-type="doi">10.1016/S1053-8119(03)00336-7</pub-id>
        <?supplied-pmid 14568458?>
        <pub-id pub-id-type="pmid">14568458</pub-id>
      </element-citation>
    </ref>
    <ref id="CR41">
      <label>41.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Smith</surname>
            <given-names>SM</given-names>
          </name>
        </person-group>
        <article-title>Fast robust automated brain extraction</article-title>
        <source>Human Brain Mapping</source>
        <year>2002</year>
        <volume>17</volume>
        <fpage>143</fpage>
        <lpage>155</lpage>
        <pub-id pub-id-type="doi">10.1002/hbm.10062</pub-id>
        <?supplied-pmid 12391568?>
        <pub-id pub-id-type="pmid">12391568</pub-id>
      </element-citation>
    </ref>
    <ref id="CR42">
      <label>42.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Veraart</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Denoising of diffusion MRI using random matrix theory</article-title>
        <source>NeuroImage</source>
        <year>2016</year>
        <volume>142</volume>
        <fpage>394</fpage>
        <lpage>406</lpage>
        <pub-id pub-id-type="doi">10.1016/j.neuroimage.2016.08.016</pub-id>
        <?supplied-pmid 27523449?>
        <pub-id pub-id-type="pmid">27523449</pub-id>
      </element-citation>
    </ref>
    <ref id="CR43">
      <label>43.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Andersson</surname>
            <given-names>JLR</given-names>
          </name>
          <name>
            <surname>Sotiropoulos</surname>
            <given-names>SN</given-names>
          </name>
        </person-group>
        <article-title>An integrated approach to correction for off-resonance effects and subject movement in diffusion MR imaging</article-title>
        <source>NeuroImage</source>
        <year>2016</year>
        <volume>125</volume>
        <fpage>1063</fpage>
        <lpage>1078</lpage>
        <pub-id pub-id-type="doi">10.1016/j.neuroimage.2015.10.019</pub-id>
        <?supplied-pmid 26481672?>
        <pub-id pub-id-type="pmid">26481672</pub-id>
      </element-citation>
    </ref>
    <ref id="CR44">
      <label>44.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tustison</surname>
            <given-names>NJ</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>N4ITK: Improved N3 Bias Correction</article-title>
        <source>IEEE Transactions on Medical Imaging</source>
        <year>2010</year>
        <volume>29</volume>
        <fpage>1310</fpage>
        <lpage>1320</lpage>
        <pub-id pub-id-type="doi">10.1109/TMI.2010.2046908</pub-id>
        <?supplied-pmid 20378467?>
        <pub-id pub-id-type="pmid">20378467</pub-id>
      </element-citation>
    </ref>
    <ref id="CR45">
      <label>45.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Raffelt</surname>
            <given-names>D</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Bias field correction and intensity normalisation for quantitative analysis of apparent fibre density</article-title>
        <source>Proc. Intl. Soc. Mag. Reson. Med</source>
        <year>2017</year>
        <volume>25</volume>
        <fpage>3541</fpage>
      </element-citation>
    </ref>
    <ref id="CR46">
      <label>46.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mito</surname>
            <given-names>R</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Fibre-specific white matter reductions in Alzheimer’s disease and mild cognitive impairment</article-title>
        <source>Brain</source>
        <year>2018</year>
        <volume>141</volume>
        <fpage>888</fpage>
        <lpage>902</lpage>
        <pub-id pub-id-type="doi">10.1093/brain/awx355</pub-id>
        <?supplied-pmid 29309541?>
        <pub-id pub-id-type="pmid">29309541</pub-id>
      </element-citation>
    </ref>
    <ref id="CR47">
      <label>47.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dyrby</surname>
            <given-names>TB</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Interpolation of diffusion weighted imaging datasets</article-title>
        <source>NeuroImage</source>
        <year>2014</year>
        <volume>103</volume>
        <fpage>202</fpage>
        <lpage>213</lpage>
        <pub-id pub-id-type="doi">10.1016/j.neuroimage.2014.09.005</pub-id>
        <?supplied-pmid 25219332?>
        <pub-id pub-id-type="pmid">25219332</pub-id>
      </element-citation>
    </ref>
    <ref id="CR48">
      <label>48.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Coupe</surname>
            <given-names>P</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>An Optimized Blockwise Nonlocal Means Denoising Filter for 3-D Magnetic Resonance Images</article-title>
        <source>IEEE Transactions on Medical Imaging</source>
        <year>2008</year>
        <volume>27</volume>
        <fpage>425</fpage>
        <lpage>441</lpage>
        <pub-id pub-id-type="doi">10.1109/TMI.2007.906087</pub-id>
        <?supplied-pmid 18390341?>
        <pub-id pub-id-type="pmid">18390341</pub-id>
      </element-citation>
    </ref>
    <ref id="CR49">
      <label>49.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Avants</surname>
            <given-names>BB</given-names>
          </name>
          <name>
            <surname>Epstein</surname>
            <given-names>CL</given-names>
          </name>
          <name>
            <surname>Grossman</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Gee</surname>
            <given-names>JC</given-names>
          </name>
        </person-group>
        <article-title>Symmetric diffeomorphic image registration with cross-correlation: Evaluating automated labeling of elderly and neurodegenerative brain</article-title>
        <source>Medical Image Analysis</source>
        <year>2008</year>
        <volume>12</volume>
        <fpage>26</fpage>
        <lpage>41</lpage>
        <pub-id pub-id-type="doi">10.1016/j.media.2007.06.004</pub-id>
        <?supplied-pmid 17659998?>
        <pub-id pub-id-type="pmid">17659998</pub-id>
      </element-citation>
    </ref>
    <ref id="CR50">
      <label>50.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhang</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Brady</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Smith</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Segmentation of brain MR images through a hidden Markov random field model and the expectation-maximization algorithm</article-title>
        <source>IEEE transactions on medical imaging</source>
        <year>2001</year>
        <volume>20</volume>
        <fpage>45</fpage>
        <lpage>57</lpage>
        <pub-id pub-id-type="doi">10.1109/42.906424</pub-id>
        <?supplied-pmid 11293691?>
        <pub-id pub-id-type="pmid">11293691</pub-id>
      </element-citation>
    </ref>
    <ref id="CR51">
      <label>51.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Smith</surname>
            <given-names>RE</given-names>
          </name>
          <name>
            <surname>Tournier</surname>
            <given-names>J-D</given-names>
          </name>
          <name>
            <surname>Calamante</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Connelly</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Anatomically-constrained tractography: Improved diffusion MRI streamlines tractography through effective use of anatomical information</article-title>
        <source>NeuroImage</source>
        <year>2012</year>
        <volume>62</volume>
        <fpage>1924</fpage>
        <lpage>1938</lpage>
        <pub-id pub-id-type="doi">10.1016/j.neuroimage.2012.06.005</pub-id>
        <?supplied-pmid 22705374?>
        <pub-id pub-id-type="pmid">22705374</pub-id>
      </element-citation>
    </ref>
    <ref id="CR52">
      <label>52.</label>
      <mixed-citation publication-type="other">Garyfallidis, E. <italic>et al</italic>. Dipy, a library for the analysis of diffusion MRI data. <italic>Frontiers in Neuroinformatics</italic><bold>8</bold>, 10.3389/fninf.2014.00008 (2014).</mixed-citation>
    </ref>
    <ref id="CR53">
      <label>53.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Descoteaux</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Angelino</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Fitzgibbons</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Deriche</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Regularized, fast, and robust analytical Q-ball imaging</article-title>
        <source>Magnetic Resonance in Medicine</source>
        <year>2007</year>
        <volume>58</volume>
        <fpage>497</fpage>
        <lpage>510</lpage>
        <pub-id pub-id-type="doi">10.1002/mrm.21277</pub-id>
        <?supplied-pmid 17763358?>
        <pub-id pub-id-type="pmid">17763358</pub-id>
      </element-citation>
    </ref>
    <ref id="CR54">
      <label>54.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tournier</surname>
            <given-names>J-D</given-names>
          </name>
          <name>
            <surname>Calamante</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Connelly</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Robust determination of the fibre orientation distribution in diffusion MRI: Non-negativity constrained super-resolved spherical deconvolution</article-title>
        <source>NeuroImage</source>
        <year>2007</year>
        <volume>35</volume>
        <fpage>1459</fpage>
        <lpage>1472</lpage>
        <pub-id pub-id-type="doi">10.1016/j.neuroimage.2007.02.016</pub-id>
        <?supplied-pmid 17379540?>
        <pub-id pub-id-type="pmid">17379540</pub-id>
      </element-citation>
    </ref>
    <ref id="CR55">
      <label>55.</label>
      <mixed-citation publication-type="other">Garyfallidis, E., Zucchelli, M., Houde, J. &amp; Descoteaux, M. How to perform best odf reconstruction from the human connectome project sampling scheme. In <italic>Proc. Intl. Soc. Mag. Reson. Med</italic> (2014).</mixed-citation>
    </ref>
    <ref id="CR56">
      <label>56.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Presseau</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Jodoin</surname>
            <given-names>P-M</given-names>
          </name>
          <name>
            <surname>Houde</surname>
            <given-names>J-C</given-names>
          </name>
          <name>
            <surname>Descoteaux</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>A new compression format for fiber tracking datasets</article-title>
        <source>NeuroImage</source>
        <year>2015</year>
        <volume>109</volume>
        <fpage>73</fpage>
        <lpage>83</lpage>
        <pub-id pub-id-type="doi">10.1016/j.neuroimage.2014.12.058</pub-id>
        <?supplied-pmid 25592997?>
        <pub-id pub-id-type="pmid">25592997</pub-id>
      </element-citation>
    </ref>
    <ref id="CR57">
      <label>57.</label>
      <mixed-citation publication-type="other">Rheault, F., Houde, J.-C. &amp; Descoteaux, M. Real time interaction with millions of streamlines. <italic>Proceedings of: International Society of Magnetic Resonance in Medicine (ISMRM)(Toronto, ON)</italic> (2015).</mixed-citation>
    </ref>
    <ref id="CR58">
      <label>58.</label>
      <mixed-citation publication-type="other">Houde, J.-C., Côté-Harnois, M.-A. &amp; Descoteaux, M. How to avoid biased streamlines-based metrics for streamlines with variable step sizes. <italic>Proceedings of: International Society of Magnetic Resonance in Medicine (ISMRM),(Toronto, ON)</italic> (2015).</mixed-citation>
    </ref>
    <ref id="CR59">
      <label>59.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Reveley</surname>
            <given-names>C</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Superficial white matter fiber systems impede detection of long-range cortical connections in diffusion MR tractography</article-title>
        <source>Proceedings of the National Academy of Sciences</source>
        <year>2015</year>
        <volume>112</volume>
        <fpage>E2820</fpage>
        <lpage>E2828</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.1418198112</pub-id>
      </element-citation>
    </ref>
    <ref id="CR60">
      <label>60.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kim</surname>
            <given-names>JS</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Automated 3-D extraction and evaluation of the inner and outer cortical surfaces using a Laplacian map and partial volume effect classification</article-title>
        <source>NeuroImage</source>
        <year>2005</year>
        <volume>27</volume>
        <fpage>210</fpage>
        <lpage>221</lpage>
        <pub-id pub-id-type="doi">10.1016/j.neuroimage.2005.03.036</pub-id>
        <?supplied-pmid 15896981?>
        <pub-id pub-id-type="pmid">15896981</pub-id>
      </element-citation>
    </ref>
    <ref id="CR61">
      <label>61.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sherif</surname>
            <given-names>T</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>CBRAIN: a web-based, distributed computing platform for collaborative neuroimaging research</article-title>
        <source>Frontiers in Neuroinformatics</source>
        <year>2014</year>
        <volume>8</volume>
        <fpage>54</fpage>
        <pub-id pub-id-type="doi">10.3389/fninf.2014.00054</pub-id>
        <?supplied-pmid 24904400?>
        <pub-id pub-id-type="pmid">24904400</pub-id>
      </element-citation>
    </ref>
    <ref id="CR62">
      <label>62.</label>
      <element-citation publication-type="data">
        <name>
          <surname>Rheault</surname>
          <given-names>F</given-names>
        </name>
        <year>2021</year>
        <data-title>Population average atlas for RecobundlesX (Version 1.1)</data-title>
        <source>Zenodo</source>
        <pub-id pub-id-type="doi">10.5281/ZENODO.4630660</pub-id>
      </element-citation>
    </ref>
    <ref id="CR63">
      <label>63.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rheault</surname>
            <given-names>F</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Tractostorm: The what, why, and how of tractography dissection reproducibility</article-title>
        <source>Human Brain Mapping</source>
        <year>2020</year>
        <volume>41</volume>
        <fpage>1859</fpage>
        <lpage>1874</lpage>
        <pub-id pub-id-type="doi">10.1002/hbm.24917</pub-id>
        <?supplied-pmid 31925871?>
        <pub-id pub-id-type="pmid">31925871</pub-id>
      </element-citation>
    </ref>
    <ref id="CR64">
      <label>64.</label>
      <element-citation publication-type="data">
        <name>
          <surname>Poulin</surname>
          <given-names>P</given-names>
        </name>
        <name>
          <surname>Theaud</surname>
          <given-names>G</given-names>
        </name>
        <name>
          <surname>Jodoin</surname>
          <given-names>PM</given-names>
        </name>
        <name>
          <surname>Descoteaux</surname>
          <given-names>M</given-names>
        </name>
        <year>2021</year>
        <data-title>TractoInferno: A large-scale, open-source, multi-site database for machine learning dmri tractography</data-title>
        <source>OpenNeuro</source>
        <pub-id pub-id-type="doi">10.18112/openneuro.ds003900.v1.1.1</pub-id>
      </element-citation>
    </ref>
    <ref id="CR65">
      <label>65.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hochreiter</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Schmidhuber</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Long Short-Term Memory</article-title>
        <source>Neural Computation</source>
        <year>1997</year>
        <volume>9</volume>
        <fpage>1735</fpage>
        <lpage>1780</lpage>
        <pub-id pub-id-type="doi">10.1162/neco.1997.9.8.1735</pub-id>
        <?supplied-pmid 9377276?>
        <pub-id pub-id-type="pmid">9377276</pub-id>
      </element-citation>
    </ref>
    <ref id="CR66">
      <label>66.</label>
      <mixed-citation publication-type="other">Bishop, C. M. Mixture density networks. Technical Report, Aston University, Birmingham (1994).</mixed-citation>
    </ref>
    <ref id="CR67">
      <label>67.</label>
      <mixed-citation publication-type="other">Graves, A. Generating Sequences With Recurrent Neural Networks. <italic>arXiv e-prints</italic> arXiv:1308.0850, <ext-link ext-link-type="uri" xlink:href="https://arxiv.org/abs/1308.0850v5">https://arxiv.org/abs/1308.0850v5</ext-link> (2013).</mixed-citation>
    </ref>
    <ref id="CR68">
      <label>68.</label>
      <mixed-citation publication-type="other">Lei Ba, J., Kiros, J. R. &amp; Hinton, G. E. Layer Normalization. arXiv e-prints <ext-link ext-link-type="uri" xlink:href="https://arxiv.org/abs/1607.06450">https://arxiv.org/abs/1607.06450</ext-link> (2016).</mixed-citation>
    </ref>
    <ref id="CR69">
      <label>69.</label>
      <mixed-citation publication-type="other">Poulin, P., Rheault, F., St-Onge, E., Jodoin, P.-M. &amp; Descoteaux, M. Bundle-Wise Deep Tracker: Learning to track bundle-specific streamline paths. In <italic>Proceedings of the International Society for Magnetic Resonance in Medicine</italic> (ISMRM-ESMRMB, 2018).</mixed-citation>
    </ref>
    <ref id="CR70">
      <label>70.</label>
      <mixed-citation publication-type="other">Vaswani, A. <italic>et al</italic>. Attention is all you need. <italic>Advances in neural information processing systems</italic><bold>30</bold> (2017).</mixed-citation>
    </ref>
  </ref-list>
</back>
