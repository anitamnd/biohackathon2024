<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">8545347</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btab223</article-id>
    <article-id pub-id-type="publisher-id">btab223</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Original Papers</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Genetics and Population Analysis</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01060</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>GEM: scalable and flexible gene–environment interaction analysis in millions of samples</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Westerman</surname>
          <given-names>Kenneth E</given-names>
        </name>
        <aff><institution>Department of Medicine, Clinical and Translational Epidemiology Unit, Mongan Institute, Massachusetts General Hospital</institution>, Boston, MA 02114, <country country="US">USA</country></aff>
        <aff><institution>Metabolism Program, Broad Institute of MIT and Harvard</institution>, Cambridge, MA 02142, <country country="US">USA</country></aff>
        <aff><institution>Department of Medicine, Harvard Medical School</institution>, Boston, MA 02115, <country country="US">USA</country></aff>
        <xref rid="btab223-FM1" ref-type="author-notes"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Pham</surname>
          <given-names>Duy T</given-names>
        </name>
        <aff><institution>Human Genetics Center, Department of Epidemiology, Human Genetics and Environmental Sciences, School of Public Health, The University of Texas Health Science Center at Houston</institution>, Houston, TX 77030, <country country="US">USA</country></aff>
        <xref rid="btab223-FM1" ref-type="author-notes"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Hong</surname>
          <given-names>Liang</given-names>
        </name>
        <aff><institution>Human Genetics Center, Department of Epidemiology, Human Genetics and Environmental Sciences, School of Public Health, The University of Texas Health Science Center at Houston</institution>, Houston, TX 77030, <country country="US">USA</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Chen</surname>
          <given-names>Ye</given-names>
        </name>
        <aff><institution>Department of Medicine, Clinical and Translational Epidemiology Unit, Mongan Institute, Massachusetts General Hospital</institution>, Boston, MA 02114, <country country="US">USA</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Sevilla-González</surname>
          <given-names>Magdalena</given-names>
        </name>
        <aff><institution>Department of Medicine, Clinical and Translational Epidemiology Unit, Mongan Institute, Massachusetts General Hospital</institution>, Boston, MA 02114, <country country="US">USA</country></aff>
        <aff><institution>Metabolism Program, Broad Institute of MIT and Harvard</institution>, Cambridge, MA 02142, <country country="US">USA</country></aff>
        <aff><institution>Department of Medicine, Harvard Medical School</institution>, Boston, MA 02115, <country country="US">USA</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Sung</surname>
          <given-names>Yun Ju</given-names>
        </name>
        <aff><institution>Department of Psychiatry, Washington University School of Medicine</institution>, St. Louis, MO 63130, <country country="US">USA</country></aff>
        <aff><institution>Division of Biostatistics, Washington University School of Medicine</institution>, St. Louis, MO 63130, <country country="US">USA</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Sun</surname>
          <given-names>Yan V</given-names>
        </name>
        <aff><institution>Department of Epidemiology, Emory University Rollins School of Public Health</institution>, Atlanta, GA 30322, <country country="US">USA</country></aff>
        <aff><institution>Department of Biomedical Informatics, Emory University School of Medicine</institution>, Atlanta, GA 30322, <country country="US">USA</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Morrison</surname>
          <given-names>Alanna C</given-names>
        </name>
        <aff><institution>Human Genetics Center, Department of Epidemiology, Human Genetics and Environmental Sciences, School of Public Health, The University of Texas Health Science Center at Houston</institution>, Houston, TX 77030, <country country="US">USA</country></aff>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Chen</surname>
          <given-names>Han</given-names>
        </name>
        <xref rid="btab223-cor1" ref-type="corresp"/>
        <aff><institution>Human Genetics Center, Department of Epidemiology, Human Genetics and Environmental Sciences, School of Public Health, The University of Texas Health Science Center at Houston</institution>, Houston, TX 77030, <country country="US">USA</country></aff>
        <aff><institution>Center for Precision Health, School of Public Health and School of Biomedical Informatics, The University of Texas Health Science Center at Houston</institution>, Houston, TX 77030, <country country="US">USA</country></aff>
        <!--han.chen.2@uth.tmc.edu-->
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Manning</surname>
          <given-names>Alisa K</given-names>
        </name>
        <xref rid="btab223-cor1" ref-type="corresp"/>
        <aff><institution>Department of Medicine, Clinical and Translational Epidemiology Unit, Mongan Institute, Massachusetts General Hospital</institution>, Boston, MA 02114, <country country="US">USA</country></aff>
        <aff><institution>Metabolism Program, Broad Institute of MIT and Harvard</institution>, Cambridge, MA 02142, <country country="US">USA</country></aff>
        <aff><institution>Department of Medicine, Harvard Medical School</institution>, Boston, MA 02115, <country country="US">USA</country></aff>
        <!--akmanning@mgh.harvard.edu-->
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Valencia</surname>
          <given-names>Alfonso</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <author-notes>
      <fn id="btab223-FM1">
        <p>The authors wish it to be known that, in their opinion, the first two authors should be regarded as Joint First Authors.</p>
      </fn>
      <corresp id="btab223-cor1">To whom correspondence should be addressed. <email>akmanning@mgh.harvard.edu</email> or <email>han.chen.2@uth.tmc.edu</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <day>15</day>
      <month>10</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2021-05-25">
      <day>25</day>
      <month>5</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>25</day>
      <month>5</month>
      <year>2021</year>
    </pub-date>
    <volume>37</volume>
    <issue>20</issue>
    <fpage>3514</fpage>
    <lpage>3520</lpage>
    <history>
      <date date-type="received">
        <day>12</day>
        <month>6</month>
        <year>2020</year>
      </date>
      <date date-type="rev-recd">
        <day>9</day>
        <month>3</month>
        <year>2021</year>
      </date>
      <date date-type="editorial-decision">
        <day>26</day>
        <month>3</month>
        <year>2021</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2021. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2021</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btab223.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Motivation</title>
        <p>Gene–environment interaction (GEI) studies are a general framework that can be used to identify genetic variants that modify the effects of environmental, physiological, lifestyle or treatment effects on complex traits. Moreover, accounting for GEIs can enhance our understanding of the genetic architecture of complex diseases and traits. However, commonly used statistical software programs for GEI studies are either not applicable to testing certain types of GEI hypotheses or have not been optimized for use in large samples.</p>
      </sec>
      <sec id="s2">
        <title>Results</title>
        <p>Here, we develop a new software program, GEM (Gene–Environment interaction analysis in Millions of samples), which supports the inclusion of multiple GEI terms, adjustment for GEI covariates and robust inference, while allowing multi-threading to reduce computation time. GEM can conduct GEI tests as well as joint tests of genetic main and interaction effects for both continuous and binary phenotypes. Through simulations, we demonstrate that GEM scales to millions of samples while addressing limitations of existing software programs. We additionally conduct a gene-sex interaction analysis on waist-hip ratio in 352 768 unrelated individuals from the UK Biobank, identifying 24 novel loci in the joint test that have not previously been reported in combined or sex-specific analyses. Our results demonstrate that GEM can facilitate the next generation of large-scale GEI studies and help advance our understanding of the genetic architecture of complex diseases and traits.</p>
      </sec>
      <sec id="s3">
        <title>Availability and implementation</title>
        <p>GEM is freely available as an open source project at <ext-link xlink:href="https://github.com/large-scale-gxe-methods/GEM" ext-link-type="uri">https://github.com/large-scale-gxe-methods/GEM</ext-link>.</p>
      </sec>
      <sec id="s5">
        <title>Supplementary information</title>
        <p><xref rid="sup1" ref-type="supplementary-material">Supplementary data</xref> are available at <italic toggle="yes">Bioinformatics</italic> online.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>National Institutes of Health</institution>
            <institution-id institution-id-type="DOI">10.13039/100000002</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>R01 HL145025</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>NIH</institution>
            <institution-id institution-id-type="DOI">10.13039/100000002</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>R01 HL131136</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="7"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>Genome-wide association studies (GWAS) have successfully led to many discoveries that associate genetic alleles with complex human diseases. However, many complex diseases are also influenced by non-genetic risk factors, such as lifestyle habits (e.g. cigarette smoking), environmental exposures (e.g. toxin), physiological effects (e.g. obesity) or treatment interventions (e.g. daily aspirin therapy). Most GWAS do not address the scientific question regarding how genetic effects on complex diseases may depend on these non-genetic factors. Gene–environment interaction (GEI) studies characterize the interplay of genetic and non-genetic effects on complex diseases. GEI models can further identify genetic variants with heterogeneous effects in different age, sex/gender or race/ethnic groups, improving our understanding of the genetic architecture of complex diseases and traits in the context of non-genetic risk factors that contribute to health disparities.</p>
    <p>Genomic datasets with millions of study participants are now being collected at an unprecedented scale: examples include the <italic toggle="yes">All of Us</italic> Research Program (anticipated <italic toggle="yes">N</italic> ∼ 1 000 000), the U.K. Biobank (<italic toggle="yes">N</italic> ∼ 500 000) and the Million Veteran Program (MVP, <italic toggle="yes">N</italic> ≥ 1 000 000). While such big genomic data provide excellent opportunities for GEI studies, tools for GEI analyses have remained static and have not adapted to the needs of modern epidemiological investigations. Several challenges to GEI studies were articulated in a recent review (<xref rid="btab223-B8" ref-type="bibr">Gauderman <italic toggle="yes">et al.</italic>, 2017</xref>), including the lack of power in GEI tests and lack of tools for large-scale, ‘omics-driven’ data. The emergence of exposure data from the environmental ‘exposome’ (<xref rid="btab223-B18" ref-type="bibr">Rappaport, 2011</xref>; <xref rid="btab223-B26" ref-type="bibr">Wild, 2005</xref>), methylation studies, metabolomic profiling in blood and other tissues and microbiome studies (collectively, ‘Omics exposures’) offer another axis to explore the interplay between genetic variants and complex diseases, especially in models that consider interactions with multiple exposures (<xref rid="btab223-B10" ref-type="bibr">Kim <italic toggle="yes">et al.</italic>, 2019</xref>). Furthermore, GEI effects can be biased if epidemiological confounders of the interaction effects are not properly controlled (<xref rid="btab223-B9" ref-type="bibr">Keller, 2014</xref>). The bias can be corrected, and in fact the relationships between multiple factors can be characterized, by including interaction terms for multiple exposures and covariates in the model (<xref rid="btab223-B9" ref-type="bibr">Keller, 2014</xref>). Another issue with these various continuous environmental and ‘Omics exposures’ is that model-based GEI inference is invalid when linear-model assumptions are violated (when the exposure has a non-linear relationship with the outcome and/or residual variance is not constant). Robust standard errors have been proposed as a remedy measure (<xref rid="btab223-B24" ref-type="bibr">Voorman <italic toggle="yes">et al.</italic>, 2011</xref>), but efficient analytical tools are still needed to scale up robust inference procedures to large samples.</p>
    <p>Multiple existing software programs enable genome-wide GEI testing (<xref rid="btab223-B1" ref-type="bibr">Aulchenko <italic toggle="yes">et al.</italic>, 2010</xref>; <xref rid="btab223-B11" ref-type="bibr">Kutalik <italic toggle="yes">et al.</italic>, 2011</xref>; <xref rid="btab223-B6" ref-type="bibr">Chang <italic toggle="yes">et al.</italic>, 2015</xref>; <xref rid="btab223-B12" ref-type="bibr">Lin <italic toggle="yes">et al.</italic>, 2014</xref>; <xref rid="btab223-B3" ref-type="bibr">Bi <italic toggle="yes">et al.</italic>, 2019</xref>; <xref rid="btab223-B2" ref-type="bibr">Bhattacharjee <italic toggle="yes">et al.</italic>, 2012</xref>; <xref rid="btab223-B7" ref-type="bibr">Gauderman <italic toggle="yes">et al.</italic>, 2016</xref>). Many are not optimized for analysis in hundreds of thousands or millions of individuals, with prohibitive computational resource requirements and lacking multi-threading capability to decrease runtimes. QUICKTEST, PLINK2, CGEN and GxEScan each enable efficient analysis in large samples, but none allow for robust inference and multiple interaction terms for both continuous and binary outcomes. The authors of SPAGE recently introduced a matrix projection algorithm for interaction testing, and showed that this combined with a score test improved runtimes compared to the standard Wald test, as is used in the named programs above (<xref rid="btab223-B3" ref-type="bibr">Bi <italic toggle="yes">et al.</italic>, 2019</xref>). However, SPAGE currently analyzes only binary traits, without robust standard errors or multi-threading capabilities.</p>
    <p>In an effort to enable biobank-scale analysis while supporting optimal and flexible statistical inference, we have developed an open-source software tool called GEM (Gene–Environment interaction analysis in Millions of samples). Our tool leverages a matrix projection algorithm to conduct approximate inference while accommodating important additional capabilities including robust standard errors and multiple GEI terms. The aims of this paper are to introduce the GEM methodology, benchmark GEM against existing software tools for GEI and demonstrate gains in computational efficiency from both the GEM method and our multi-threading software implementation, and finally demonstrate the use of GEM in a biobank-scale, genome-wide interaction study of waist-hip ratio, an anthropometric trait with known differences in genetic architecture between men and women (<xref rid="btab223-B16" ref-type="bibr">Pulit <italic toggle="yes">et al.</italic>, 2019</xref>).</p>
  </sec>
  <sec>
    <title>2 Materials and methods</title>
    <sec>
      <title>2.1 GEM model</title>
      <p>Briefly, GEM considers a generalized linear model for unrelated individuals:
<disp-formula id="E1"><mml:math id="M1" display="block" overflow="scroll"><mml:mi>g</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mo>μ</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mrow><mml:mi>X</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mo>β</mml:mo></mml:mrow><mml:mrow><mml:mi>G</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">C</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mrow><mml:mi>C</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">S</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mo>β</mml:mo></mml:mrow><mml:mrow><mml:mi>S</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo></mml:math></disp-formula>where <inline-formula id="IE1"><mml:math id="IM1" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mo>μ</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>E</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:math></inline-formula> is the conditional mean of the phenotype <inline-formula id="IE2"><mml:math id="IM2" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> for individual <inline-formula id="IE3"><mml:math id="IM3" display="inline" overflow="scroll"><mml:mi>i</mml:mi></mml:math></inline-formula> given covariates <inline-formula id="IE4"><mml:math id="IM4" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> (including an intercept for the model) and the genotype <inline-formula id="IE5"><mml:math id="IM5" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> of a single genetic variant. We consider two sets of gene–environment interaction terms: (i) <italic toggle="yes">c</italic> gene–environment interaction covariates <inline-formula id="IE6"><mml:math id="IM6" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">C</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> not tested in our genome-wide scan, which are the product between <inline-formula id="IE7"><mml:math id="IM7" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> and a subset of <inline-formula id="IE8"><mml:math id="IM8" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, and are important for adjusting for potential confounding effects (<xref rid="btab223-B9" ref-type="bibr">Keller, 2014</xref>); and (ii)<inline-formula id="IE9"><mml:math id="IM9" display="inline" overflow="scroll"><mml:mi mathvariant="normal"> </mml:mi><mml:mi>q</mml:mi></mml:math></inline-formula> gene–environment interaction terms of interest <inline-formula id="IE10"><mml:math id="IM10" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">S</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, which are <sub>the product of</sub>  <inline-formula id="IE11"><mml:math id="IM11" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> and another subset of <inline-formula id="IE12"><mml:math id="IM12" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>. The link function <inline-formula id="IE13"><mml:math id="IM13" display="inline" overflow="scroll"><mml:mi>g</mml:mi><mml:mo>(</mml:mo><mml:mo>·</mml:mo><mml:mo>)</mml:mo></mml:math></inline-formula> is a monotone function (usually the identity link function for continuous phenotypes, and the logit link function for binary phenotypes).</p>
      <p>The GEM method is described in detail in <xref rid="sup1" ref-type="supplementary-material">Supplementary Methods</xref>. Through projection of the gene–environment interaction matrix onto the genetic matrix, the GEM method greatly reduces repeated calculations in fitting these separate models (e.g. adjusting for the same covariates repeatedly) and scales linearly with the sample size. Robust standard errors are optionally included in the calculation of standard errors for marginal genetic effects and GEI effects. Asymptotic <italic toggle="yes">P</italic>-values are calculated for each variant using adjusted score tests corresponding to the interaction effect (<inline-formula id="IE14"><mml:math id="IM14" display="inline" overflow="scroll"><mml:mi>q</mml:mi></mml:math></inline-formula> degrees of freedom) or joint genetic effects (<inline-formula id="IE15"><mml:math id="IM15" display="inline" overflow="scroll"><mml:mi>q</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:math></inline-formula> degrees of freedom).</p>
    </sec>
    <sec>
      <title>2.2 Computational approach</title>
      <p>The GEM software tool implements the GEM model with additional multi-threading via the C++ <italic toggle="yes">Boost</italic> library to parallelize our genome-wide scan across variants when multiple computing cores are available. Docker images and cloud-computing workflows written in Workflow Description Language (WDL) are distributed on github.com/large-scale-gxe-methods and the Dockstore platform (<xref rid="btab223-B15" ref-type="bibr">O’Connor <italic toggle="yes">et al.</italic>, 2017</xref>), providing GEM through a consistent interface across a variety of computational environments.</p>
    </sec>
    <sec>
      <title>2.3 Alternative models and methods</title>
      <p>Existing software programs that implement GEI for unrelated samples and common genetic variants were compared to GEM to establish the statistical validity of our method and compare performance: ProbABEL (<xref rid="btab223-B1" ref-type="bibr">Aulchenko <italic toggle="yes">et al.</italic>, 2010</xref>), QUICKTEST (version 0.95) (<xref rid="btab223-B11" ref-type="bibr">Kutalik <italic toggle="yes">et al.</italic>, 2011</xref>), PLINK2 (version alpha 2.3) (<xref rid="btab223-B6" ref-type="bibr">Chang <italic toggle="yes">et al.</italic>, 2015</xref>), SUGEN (version 8.11) (<xref rid="btab223-B12" ref-type="bibr">Lin <italic toggle="yes">et al.</italic>, 2014</xref>) and SPAGE (version 0.1.5) (<xref rid="btab223-B3" ref-type="bibr">Bi <italic toggle="yes">et al.</italic>, 2019</xref>). A comparison of the methods and software features available from these tools can be found in <xref rid="btab223-T1" ref-type="table">Table 1</xref>.</p>
      <table-wrap position="float" id="btab223-T1">
        <label>Table 1.</label>
        <caption>
          <p>Comparison of methods and software features implemented in GEI software tools</p>
        </caption>
        <table frame="hsides" rules="groups">
          <colgroup span="1">
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="left" span="1"/>
          </colgroup>
          <thead>
            <tr>
              <th align="left" rowspan="1" colspan="1">Tool</th>
              <th align="left" rowspan="1" colspan="1">Version</th>
              <th align="left" rowspan="1" colspan="1">Algorithmic approach</th>
              <th align="left" rowspan="1" colspan="1">Multiple interactions</th>
              <th align="left" rowspan="1" colspan="1">Interaction covariates</th>
              <th align="left" rowspan="1" colspan="1">Robust SEs</th>
              <th align="left" rowspan="1" colspan="1">Multithreading available</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td rowspan="1" colspan="1">GEM</td>
              <td rowspan="1" colspan="1">1.2</td>
              <td rowspan="1" colspan="1">Matrix projection</td>
              <td rowspan="1" colspan="1">Yes</td>
              <td rowspan="1" colspan="1">Yes</td>
              <td rowspan="1" colspan="1">Yes</td>
              <td rowspan="1" colspan="1">Yes</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">ProbABEL</td>
              <td rowspan="1" colspan="1">0.5.0</td>
              <td rowspan="1" colspan="1">Classical linear/logistic model</td>
              <td rowspan="1" colspan="1">No</td>
              <td rowspan="1" colspan="1">No</td>
              <td rowspan="1" colspan="1">Yes</td>
              <td rowspan="1" colspan="1">No</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">QUICKTEST</td>
              <td rowspan="1" colspan="1">0.95</td>
              <td rowspan="1" colspan="1">Classical linear model</td>
              <td rowspan="1" colspan="1">No</td>
              <td rowspan="1" colspan="1">No</td>
              <td rowspan="1" colspan="1">Yes</td>
              <td rowspan="1" colspan="1">No</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">PLINK2</td>
              <td rowspan="1" colspan="1">Alpha 2.3</td>
              <td rowspan="1" colspan="1">Classical linear/logistic model</td>
              <td rowspan="1" colspan="1">Yes</td>
              <td rowspan="1" colspan="1">Yes</td>
              <td rowspan="1" colspan="1">No</td>
              <td rowspan="1" colspan="1">Yes</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">SUGEN</td>
              <td rowspan="1" colspan="1">8.11</td>
              <td rowspan="1" colspan="1">Classical linear/logistic model</td>
              <td rowspan="1" colspan="1">Yes</td>
              <td rowspan="1" colspan="1">No</td>
              <td rowspan="1" colspan="1">Yes</td>
              <td rowspan="1" colspan="1">No</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">SPAGE</td>
              <td rowspan="1" colspan="1">0.1.5</td>
              <td rowspan="1" colspan="1">Matrix projection</td>
              <td rowspan="1" colspan="1">No</td>
              <td rowspan="1" colspan="1">No</td>
              <td rowspan="1" colspan="1">No</td>
              <td rowspan="1" colspan="1">No</td>
            </tr>
          </tbody>
        </table>
      </table-wrap>
    </sec>
    <sec>
      <title>2.4 Simulated data for software benchmarking</title>
      <p>For the purposes of comparing computational resource usage across software tools, a series of simulated genotype datasets were created with 100 000 variants and 6 different sample sizes: 10 000, 50 000, 100 000, 500 000, 1 million and 5 million. We simulated continuous and binary traits: a continuous outcome and a binary outcome with a case-control ratio of 1:3, one binary exposure and one binary covariate and 29 continuous covariates. Workflows implementing the GEI tests were run on the Analysis Commons hosted on the DNAnexus platform using the single exposure and all combinations of the following parameters: outcome type {binary, continuous}, number of non-exposure covariates {0, 3, 30} and sample size (as above). Benchmarking runs all used a single thread for computation. Runs that took longer than 7 days or used more than 100 GB of memory were terminated and noted in the results and figures.</p>
      <p>GEM results were compared to those of ProbABEL to assess whether there were meaningful differences in their statistical output, given that ProbABEL is a commonly used program that does not use a matrix projection approach. Summary statistics were retrieved for a random subset of 5000 variants (corresponding to the 10 000-sample, robust, 3-covariate models) for both GEM and ProbABEL, and both interaction test <italic toggle="yes">P</italic>-values and main and interaction joint test <italic toggle="yes">P</italic>-values were compared.</p>
    </sec>
    <sec>
      <title>2.5 UK Biobank Data for statistical simulations and real data example</title>
      <p>UK Biobank is a cohort study containing deep phenotyping and genome-wide genetic data for approximately 500 000 participants living in the UK (<xref rid="btab223-B4" ref-type="bibr">Bycroft <italic toggle="yes">et al.</italic>, 2018</xref>). Imputed genotype data were pre-processed as described previously (<xref rid="btab223-B4" ref-type="bibr">Bycroft <italic toggle="yes">et al.</italic>, 2018</xref>) and accessed under UK Biobank projects 27892 and 42646. For this analysis, imputed genotypes (version 3) were filtered for minor allele frequency (MAF) &gt; 0.005 and imputation INFO score &gt; 0.5 based on the available variant annotation files from UK Biobank. Samples were filtered to include only those corresponding to unrelated individuals self-identifying as of white British ancestry who had not revoked consent for analysis, did not display sex chromosome aneuploidy, and had matching reported and genetically inferred sex. These filters left 352 768 UK Biobank study participants in the final dataset.</p>
    </sec>
    <sec>
      <title>2.6 Power and type I error simulations</title>
      <p>Phenotype simulations to evaluate power and type I error of the GEM method were carried out using R version 3.6.0 (<xref rid="btab223-B17" ref-type="bibr">R Core Team, 2019</xref>). A series of simulated phenotypes were generated from a subset of UK Biobank chromosome 21 and 22 imputed genotype dosages (a subset with MAF &gt; 0.005). For type I error evaluation, three exposures were simulated (continuous, binary, log-normal), each having 10% variance explained by a random 100 variants from chromosome 21. Next, 185 continuous phenotypes were simulated for each of these exposures (185 phenotypes <inline-formula id="IE16"><mml:math id="IM16" display="inline" overflow="scroll"><mml:mo>×</mml:mo></mml:math></inline-formula> 11.2 million = 2 billion <italic toggle="yes">P</italic>-values per exposure) to allow us to evaluate empirical type I error rates at genome-wide significance. Each phenotype was simulated to have 10% variance explained by the associated exposure and 10% variance explained by a random 100 variants from chromosome 22. In order to simulate exposure mis-specification, a fourth set of phenotypes was generated with the same amount of variance explained by a quadratic (rather than linear) effect of the continuous exposure. Genome-wide scans on ∼11.2 million variants for chromosomes 1–22 (MAF &gt; 0.005) were run for each phenotype (4 settings × 185 exposures = 740 total runs) using both model-based and robust standard errors. Type I error was then evaluated at genome-wide significance for chromosomes 1–20 (for which no genetic effect of any kind was present). In addition, potential inflation was visualized via quantile-quantile plots for chromosome 21 (for which a gene–environment correlation was present for a subset of variants), and chromosome 22 (for which a genetic main effect was present for a subset of variants).</p>
      <p>For power evaluation, a series of traits were generated based on a random set of 100 variants from chromosome 16. First, ten continuous exposures were simulated from a standard normal distribution. Next, ten normally distributed phenotypes were generated based on these variants and exposures for each combination of the following parameter values: <inline-formula id="IE17"><mml:math id="IM17" display="inline" overflow="scroll"><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">R</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">G</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal"> </mml:mi><mml:mi mathvariant="bold-italic">total</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:math></inline-formula> {0,10%}, <inline-formula id="IE18"><mml:math id="IM18" display="inline" overflow="scroll"><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">R</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">E</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal"> </mml:mi><mml:mi mathvariant="bold-italic">total</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:math></inline-formula> {10%}, <inline-formula id="IE19"><mml:math id="IM19" display="inline" overflow="scroll"><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">R</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">G</mml:mi><mml:mo>×</mml:mo><mml:mi mathvariant="bold-italic">E</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal"> </mml:mi><mml:mi mathvariant="bold-italic">total</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:math></inline-formula> {0.1%, 0.25%, 0.5%, 0.75%, 1%, 1.25%, 1.5%, 1.75%, 2%} and the number of exposures with GEI effects (<bold>K</bold>) {1, 2, 5, 10} (see Supplementary <xref rid="sup1" ref-type="supplementary-material">Table S1</xref>). As K was varied, GEI effects were distributed equally across the set of relevant exposures while retaining the same overall variance explained by GEIs. Finally, for each parameter combination, power was calculated as the proportion of tests reaching genome-wide significance (<inline-formula id="IE20"><mml:math id="IM20" display="inline" overflow="scroll"><mml:mo>α</mml:mo><mml:mo>=</mml:mo><mml:mn>5</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mrow><mml:mn>10</mml:mn></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>8</mml:mn></mml:mrow></mml:msup></mml:math></inline-formula>) across the ten phenotypes (1000 tests in total per combination).</p>
    </sec>
    <sec>
      <title>2.7 Application to waist–hip ratio in UK Biobank</title>
      <p>To illustrate the performance of GEM for use in a biobank-scale, genome-wide interaction study, we conducted a gene-by-environment interaction study of the differences in waist-hip ratio (WHR) between men and women in unrelated, British-ancestry UK Biobank participants. We used sex (confirmed by genotype) as our exposure of interest. WHR was inverse-normal transformed prior to analysis. Additional covariates included age, age<sup>2</sup>, 10 genetic principal components (<italic toggle="yes">PC1</italic>-<italic toggle="yes">PC10</italic>), microarray used for genotyping (<italic toggle="yes">array</italic>) and body mass index (<italic toggle="yes">BMI</italic>):
<disp-formula id="E2"><mml:math id="M2" display="block" overflow="scroll"><mml:mi mathvariant="italic">WHR</mml:mi><mml:mi mathvariant="normal"> </mml:mi><mml:mo>∼</mml:mo><mml:mi mathvariant="normal"> </mml:mi><mml:mi>G</mml:mi><mml:mo>+</mml:mo><mml:mi mathvariant="italic">sex</mml:mi><mml:mo>+</mml:mo><mml:mi mathvariant="italic">age</mml:mi><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="italic">age</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:mi mathvariant="italic">BMI</mml:mi><mml:mo>+</mml:mo><mml:mi mathvariant="italic">array</mml:mi><mml:mo>+</mml:mo><mml:mi>P</mml:mi><mml:mi>C</mml:mi><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mo>⋯</mml:mo><mml:mo>+</mml:mo><mml:mi>P</mml:mi><mml:mi>C</mml:mi><mml:mn>10</mml:mn><mml:mo>+</mml:mo><mml:mi>G</mml:mi><mml:mi mathvariant="normal"> </mml:mi><mml:mo>×</mml:mo><mml:mi mathvariant="italic">sex</mml:mi><mml:mo>+</mml:mo><mml:mi>G</mml:mi><mml:mo>×</mml:mo><mml:mi mathvariant="italic">BMI</mml:mi></mml:math></disp-formula></p>
      <p>The significance of the interaction effect was derived from the <inline-formula id="IE21"><mml:math id="IM21" display="inline" overflow="scroll"><mml:mi>G</mml:mi><mml:mo>×</mml:mo><mml:mi mathvariant="italic">sex</mml:mi></mml:math></inline-formula> term and joint tests were conducted with the <inline-formula id="IE22"><mml:math id="IM22" display="inline" overflow="scroll"><mml:mi>G</mml:mi></mml:math></inline-formula> and <inline-formula id="IE23"><mml:math id="IM23" display="inline" overflow="scroll"><mml:mi>G</mml:mi><mml:mo>×</mml:mo><mml:mi mathvariant="italic">sex</mml:mi></mml:math></inline-formula> coefficient estimates. The <inline-formula id="IE24"><mml:math id="IM24" display="inline" overflow="scroll"><mml:mi>G</mml:mi><mml:mo>×</mml:mo><mml:mi mathvariant="italic">BMI</mml:mi></mml:math></inline-formula> interaction covariate term controlled for potential confounding by <italic toggle="yes">BMI</italic> in this model. An additional analysis was performed in which age, coded as a binary variable of less than or greater than 50 years old, was added as a covariate and additional <inline-formula id="IE25"><mml:math id="IM25" display="inline" overflow="scroll"><mml:mi>G</mml:mi><mml:mo>×</mml:mo><mml:mi mathvariant="italic">age</mml:mi></mml:math></inline-formula> interaction term. The resulting interaction effects (<inline-formula id="IE26"><mml:math id="IM26" display="inline" overflow="scroll"><mml:mi>G</mml:mi><mml:mo>×</mml:mo><mml:mi mathvariant="italic">sex</mml:mi></mml:math></inline-formula> and <inline-formula id="IE27"><mml:math id="IM27" display="inline" overflow="scroll"><mml:mi>G</mml:mi><mml:mo>×</mml:mo><mml:mi mathvariant="italic">age</mml:mi></mml:math></inline-formula>) were tested jointly using two degrees of freedom.</p>
      <p>Results from the UK Biobank analysis were processed using the FUMA web tool (<xref rid="btab223-B25" ref-type="bibr">Watanabe <italic toggle="yes">et al.</italic>, 2017</xref>), which defines loci using linkage disequilibrium (LD). Variants with <italic toggle="yes">P</italic> &lt; 5 <inline-formula id="IE28"><mml:math id="IM28" display="inline" overflow="scroll"><mml:mo>×</mml:mo></mml:math></inline-formula> 10<sup>−8</sup> were used as index variants, and additional variants with <italic toggle="yes">P</italic> &lt; 0.05, within 250 kb of the index variant and having LD <italic toggle="yes">r</italic><sup>2</sup> &gt; 0.2 with the index variant were merged into a single locus. We used this LD-based procedure to obtain the list of significant loci from the <inline-formula id="IE29"><mml:math id="IM29" display="inline" overflow="scroll"><mml:mi>G</mml:mi><mml:mo>×</mml:mo><mml:mi mathvariant="italic">sex</mml:mi></mml:math></inline-formula> interaction test statistics and the joint test statistics. These loci were then compared to a recent genome-wide association study (GWAS) meta-analysis for BMI-adjusted WHR that included UK Biobank as one of the component datasets (<xref rid="btab223-B16" ref-type="bibr">Pulit <italic toggle="yes">et al.</italic>, 2019</xref>). Summary statistics from this analysis were retrieved (<ext-link xlink:href="https://github.com/lindgrengroup/fatdistnGWAS" ext-link-type="uri">https://github.com/lindgrengroup/fatdistnGWAS</ext-link>; accessed April 13, 2020) for genome-wide significant marginal genetic effects in the entire sample, the female sample and the male sample. A subset of these variants were noted as having effect differences between males and females at a significance threshold adjusting for the number of index variants tested for interaction (P<sub>GIANT; WHR; interaction</sub> &lt; 3.3 <inline-formula id="IE30"><mml:math id="IM30" display="inline" overflow="scroll"><mml:mo>×</mml:mo></mml:math></inline-formula> 10<sup>−5</sup>.) We re-derived these genome-wide tests for sex dimorphism using the EasyStrata R package (<xref rid="btab223-B28" ref-type="bibr">Winkler <italic toggle="yes">et al.</italic>, 2015</xref>). We assessed the value of the interaction approach implemented in GEM by annotating our significant loci with the presence or absence of the locus in the list of significant loci from <xref rid="btab223-B16" ref-type="bibr">Pulit <italic toggle="yes">et al.</italic> (2019)</xref>. We extended each locus identified in our clumping procedure by 100 kb on each side and labeled each as novel if the region did not contain a variant with P<sub>GIANT; WHR; interaction</sub> less than 5 <inline-formula id="IE31"><mml:math id="IM31" display="inline" overflow="scroll"><mml:mo>×</mml:mo></mml:math></inline-formula> 10<sup>−8</sup> or 3.3 <inline-formula id="IE32"><mml:math id="IM32" display="inline" overflow="scroll"><mml:mo>×</mml:mo></mml:math></inline-formula> 10<sup>−5</sup> from the <xref rid="btab223-B16" ref-type="bibr">Pulit <italic toggle="yes">et al.</italic> (2019)</xref> meta-analysis at either genome-wide or regional significance level, respectively. We similarly assessed the value of the joint test by expanding our loci by 100 kb and labeling them as novel if they did not contain a significant variant from the <xref rid="btab223-B16" ref-type="bibr">Pulit <italic toggle="yes">et al.</italic> (2019)</xref> summary statistics in either the entire sample meta-analysis, the female sample meta-analysis or the male sample meta-analysis.</p>
      <p>To better understand the influence of including the <inline-formula id="IE33"><mml:math id="IM33" display="inline" overflow="scroll"><mml:mi>G</mml:mi><mml:mo>×</mml:mo><mml:mi mathvariant="italic">BMI</mml:mi></mml:math></inline-formula> interaction covariate, we assessed which loci were significant (<italic toggle="yes">P</italic> &lt; 5 <inline-formula id="IE34"><mml:math id="IM34" display="inline" overflow="scroll"><mml:mo>×</mml:mo></mml:math></inline-formula> 10<sup>−8</sup>) in either the <xref rid="btab223-B16" ref-type="bibr">Pulit <italic toggle="yes">et al.</italic> (2019)</xref> meta-analysis or our analysis, but not both. For these variants, a second analysis was run with GEM without the <inline-formula id="IE35"><mml:math id="IM35" display="inline" overflow="scroll"><mml:mi>G</mml:mi><mml:mo>×</mml:mo><mml:mi mathvariant="italic">BMI</mml:mi></mml:math></inline-formula> interaction covariate term and <italic toggle="yes">P</italic>-values at index variants for each of these loci were compared to those from the primary analysis.</p>
      <p>To address concerns about genomic inflation, and considering prior conclusions that GEI analyses require approximately four times the sample size for equivalent power to a marginal genetic analysis of equal magnitude (<xref rid="btab223-B21" ref-type="bibr">Smith and Day, 1984</xref>; <xref rid="btab223-B22" ref-type="bibr">Thomas, 2010</xref>), the UK Biobank analysis was repeated three times after a random down-sampling to 87 695 individuals (24.859%, calculated as the product of the proportions of males and females in the dataset). Genomic inflation lambda values for the marginal genetic effects were calculated from GEM test statistics and compared to the primary (full-sample) GEM test statistics.</p>
    </sec>
  </sec>
  <sec>
    <title>3 Results</title>
    <sec>
      <title>3.1 Type 1 error and power of GEM</title>
      <p>A series of genome-wide interaction scans were performed to assess type I error rates of the GEM algorithm. Using robust standard errors, no inflation of test statistics was observed (at significance level <inline-formula id="IE36"><mml:math id="IM36" display="inline" overflow="scroll"><mml:mo>α</mml:mo></mml:math></inline-formula> = 5 <inline-formula id="IE37"><mml:math id="IM37" display="inline" overflow="scroll"><mml:mo>×</mml:mo></mml:math></inline-formula> 10<sup>−8</sup>) for genetic variants on chromosomes 1-20 for which no genetic effects were simulated (<xref rid="btab223-T2" ref-type="table">Table 2</xref>). An inflated type I error rate was observed for both interaction and joint tests in the presence of a mis-specified (quadratic) environmental effect when robust standard errors were not used, in agreement with a known result (<xref rid="btab223-B24" ref-type="bibr">Voorman <italic toggle="yes">et al.</italic>, 2011</xref>). Supplementary Figures S1–S3 display quantile-quantile plots for these variants, as well as those for variants correlated with the exposure and with the phenotype. No unexpected inflation of <italic toggle="yes">P</italic>-values was observed for tests using robust standard errors other than in the context of both gene–environment correlation and a mis-specified exposure effect, as expected based on previous results (<xref rid="btab223-B30" ref-type="bibr">Zhang <italic toggle="yes">et al.</italic>, 2020</xref>).</p>
      <table-wrap position="float" id="btab223-T2">
        <label>Table 2.</label>
        <caption>
          <p>Type I error rates of GEM at <inline-formula id="IE38"><mml:math id="IM38" display="inline" overflow="scroll"><mml:mo>α</mml:mo></mml:math></inline-formula> = 5 <inline-formula id="IE39"><mml:math id="IM39" display="inline" overflow="scroll"><mml:mo>×</mml:mo></mml:math></inline-formula> 10<sup>−8</sup></p>
        </caption>
        <table frame="hsides" rules="groups">
          <colgroup span="1">
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="center" span="1"/>
            <col valign="top" align="center" span="1"/>
            <col valign="top" align="center" span="1"/>
            <col valign="top" align="center" span="1"/>
          </colgroup>
          <thead>
            <tr>
              <th rowspan="2" colspan="1">Simulated exposure distribution</th>
              <th colspan="2" rowspan="1">Interaction test<hr/></th>
              <th colspan="2" rowspan="1">Joint test<hr/></th>
            </tr>
            <tr>
              <th rowspan="1" colspan="1">Type I error (model-based SEs)</th>
              <th rowspan="1" colspan="1">Type I error (robust SEs)</th>
              <th rowspan="1" colspan="1">Type I error (model-based SEs)</th>
              <th rowspan="1" colspan="1">Type I error (robust SEs)</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td rowspan="1" colspan="1">Binary exposure</td>
              <td rowspan="1" colspan="1">3.14 <inline-formula id="IE40"><mml:math id="IM40" display="inline" overflow="scroll"><mml:mo>×</mml:mo></mml:math></inline-formula> 10<sup>-8</sup></td>
              <td rowspan="1" colspan="1">3.04 <inline-formula id="IE41"><mml:math id="IM41" display="inline" overflow="scroll"><mml:mo>×</mml:mo></mml:math></inline-formula> 10<sup>-8</sup></td>
              <td rowspan="1" colspan="1">3.93 <inline-formula id="IE42"><mml:math id="IM42" display="inline" overflow="scroll"><mml:mo>×</mml:mo></mml:math></inline-formula> 10<sup>-8</sup></td>
              <td rowspan="1" colspan="1">3.93 <inline-formula id="IE43"><mml:math id="IM43" display="inline" overflow="scroll"><mml:mo>×</mml:mo></mml:math></inline-formula> 10<sup>-8</sup></td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Continuous exposure</td>
              <td rowspan="1" colspan="1">3.58 <inline-formula id="IE44"><mml:math id="IM44" display="inline" overflow="scroll"><mml:mo>×</mml:mo></mml:math></inline-formula> 10<sup>-8</sup></td>
              <td rowspan="1" colspan="1">3.53 <inline-formula id="IE45"><mml:math id="IM45" display="inline" overflow="scroll"><mml:mo>×</mml:mo></mml:math></inline-formula> 10<sup>-8</sup></td>
              <td rowspan="1" colspan="1">4.38 <inline-formula id="IE46"><mml:math id="IM46" display="inline" overflow="scroll"><mml:mo>×</mml:mo></mml:math></inline-formula> 10<sup>-8</sup></td>
              <td rowspan="1" colspan="1"><inline-formula id="IE47"><mml:math id="IM47" display="inline" overflow="scroll"><mml:mn>4.28</mml:mn><mml:mo/><mml:mo>×</mml:mo><mml:mo/></mml:math></inline-formula>10<sup>-8</sup></td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Log-normal exposure</td>
              <td rowspan="1" colspan="1">4.98 <inline-formula id="IE48"><mml:math id="IM48" display="inline" overflow="scroll"><mml:mo>×</mml:mo></mml:math></inline-formula> 10<sup>-8</sup></td>
              <td rowspan="1" colspan="1"><inline-formula id="IE49"><mml:math id="IM49" display="inline" overflow="scroll"><mml:mn>3.33</mml:mn><mml:mo/><mml:mo>×</mml:mo><mml:mo/></mml:math></inline-formula>10<sup>-8</sup></td>
              <td rowspan="1" colspan="1"><inline-formula id="IE50"><mml:math id="IM50" display="inline" overflow="scroll"><mml:mn>2.24</mml:mn><mml:mo/><mml:mo>×</mml:mo><mml:mo/></mml:math></inline-formula>10<sup>-8</sup></td>
              <td rowspan="1" colspan="1">2.64 <inline-formula id="IE51"><mml:math id="IM51" display="inline" overflow="scroll"><mml:mo>×</mml:mo></mml:math></inline-formula> 10<sup>-8</sup></td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Continuous exposure with quadratic effect</td>
              <td rowspan="1" colspan="1">3.29 <inline-formula id="IE52"><mml:math id="IM52" display="inline" overflow="scroll"><mml:mo>×</mml:mo></mml:math></inline-formula> 10<sup>-6</sup></td>
              <td rowspan="1" colspan="1">3.43 <inline-formula id="IE53"><mml:math id="IM53" display="inline" overflow="scroll"><mml:mo>×</mml:mo></mml:math></inline-formula> 10<sup>-8</sup></td>
              <td rowspan="1" colspan="1"><inline-formula id="IE54"><mml:math id="IM54" display="inline" overflow="scroll"><mml:mn>1.57</mml:mn><mml:mo/><mml:mo>×</mml:mo><mml:mo/></mml:math></inline-formula>10<sup>-6</sup></td>
              <td rowspan="1" colspan="1"><inline-formula id="IE55"><mml:math id="IM55" display="inline" overflow="scroll"><mml:mn>2.44</mml:mn><mml:mo/><mml:mo>×</mml:mo><mml:mo/></mml:math></inline-formula>10<sup>-8</sup></td>
            </tr>
          </tbody>
        </table>
      </table-wrap>
      <p>A power analysis was undertaken using a subset of independent variants from UKB chromosome 16. Using a subset of 100 variants and up to 10 random, continuous environmental factors, phenotypes were simulated to contain pre-specified signals reflecting genetic main effects, environmental main effects and GEI effects (see Methods; Supplementary <xref rid="sup1" ref-type="supplementary-material">Table S1</xref>). Statistical power from the simulations is shown in <xref rid="btab223-F1" ref-type="fig">Figure 1</xref>. Power to detect single-exposure interaction effects was just over 70% for an overall <inline-formula id="IE56"><mml:math id="IM56" display="inline" overflow="scroll"><mml:msubsup><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>G</mml:mi><mml:mo>×</mml:mo><mml:mi>E</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal"> </mml:mi><mml:mi mathvariant="italic">total</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:math></inline-formula> of 1% (corresponding to a per-variant <inline-formula id="IE57"><mml:math id="IM57" display="inline" overflow="scroll"><mml:msubsup><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>G</mml:mi><mml:mo>×</mml:mo><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:math></inline-formula> of 0.01%), consistent with expectation based on theoretical power calculations. Power was reduced somewhat when the interaction test degrees of freedom increased, by either spreading the interaction effect across multiple exposures (<xref rid="btab223-F1" ref-type="fig">Fig. 1a</xref>) or conducting multi-exposure interaction tests with only one true active environment (<xref rid="btab223-F1" ref-type="fig">Fig. 1b</xref>). We note that these two simulations result in the same total variance explained by interaction effects from the generative models, with the same number of degrees of freedom in the tests, and thus have highly similar results. Power was decreased in the setting where true interaction signal was spread over 10 exposures but only a subset of these were included in multi-exposure interaction tests (<xref rid="btab223-F1" ref-type="fig">Fig. 1c</xref>). A minor reduction in power was observed when variants contained a main-effect signal (per-variant <inline-formula id="IE58"><mml:math id="IM58" display="inline" overflow="scroll"><mml:msubsup><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:math></inline-formula> of 0.1%; <xref rid="btab223-F1" ref-type="fig">Fig. 1d</xref>).</p>
      <fig position="float" id="btab223-F1">
        <label>Fig. 1.</label>
        <caption>
          <p>Power of the interaction test from the GEM method. Statistical power is shown on the <italic toggle="yes">y</italic>-axis reflecting the fraction of interaction tests with <italic toggle="yes">P</italic> &lt; 5 <inline-formula id="IE59"><mml:math id="IM59" display="inline" overflow="scroll"><mml:mo>×</mml:mo></mml:math></inline-formula> 10<sup>−8</sup> (calculated based on 1000 tests). (<bold>a</bold>) Total interaction effect (<italic toggle="yes">x</italic>-axis), in terms of phenotypic variance explained, is partitioned equally among <italic toggle="yes">K</italic> exposures (<italic toggle="yes">K</italic> = 1, 2, 5 and 10), and an interaction test for <italic toggle="yes">q</italic> exposures jointly, the exact set of <italic toggle="yes">K</italic> exposures, is performed (<italic toggle="yes">q</italic> = <italic toggle="yes">K</italic>). (<bold>b</bold>) One exposure is responsible for the full interaction effect (<italic toggle="yes">K</italic> = 1), and <italic toggle="yes">q</italic> is varied (<italic toggle="yes">q</italic> = 1, 2, 5 and 10). (<bold>c</bold>) Total interaction effect is partitioned equally among 10 exposures (<italic toggle="yes">K</italic> = 10), and <italic toggle="yes">q</italic> is varied within subsets of these 10 exposures (<italic toggle="yes">q</italic> = 1, 2, 5 and 10). (<bold>d</bold>) As in (a), with a single exposure simulated and tested, but varying the strength of the genetic main effect. GEI, gene–environment interaction; % V.E., percent variance explained</p>
        </caption>
        <graphic xlink:href="btab223f1" position="float"/>
      </fig>
    </sec>
    <sec>
      <title>3.2 Benchmarking for resource usage</title>
      <p>We compared run times and memory usage of the GEM software tool in comparison to the other software programs when adjusting for 3 covariates and using model-based (non-robust) standard errors (<xref rid="btab223-F2" ref-type="fig">Fig. 2</xref><bold>)</bold>. We also show the results of equivalent runs in terms of run time (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S4</xref>) and memory (Supplementary <xref rid="sup1" ref-type="supplementary-material">Fig. S5</xref>) using different numbers of covariates and robust standard errors. GEM run times were substantially faster than those of QUICKTEST, ProbABEL, SUGEN and SPAGE. GEM runtimes were similar to those of PLINK2 for continuous outcomes and somewhat faster for binary outcomes, and this advantage increased with the number of covariates (Supplementary <xref rid="sup1" ref-type="supplementary-material">Fig. S4</xref>). Though GEM and SPAGE both implement a matrix projection algorithm, GEM may be substantially faster due to its native implementation in C++. The low runtimes for PLINK2, despite implementing the classical model, are likely also due to a highly efficient C++ implementation rather than differences in the mathematical model. This interpretation is supported by the increasing advantage of both GEM and SPAGE compared to PLINK2 when many covariates are used (Supplementary <xref rid="sup1" ref-type="supplementary-material">Fig. S4</xref>). Memory usage was modest for all programs other than ProbABEL, whose memory requirements we found to be &gt;100 GB for sample sizes greater than 100 000 in this analysis setup. Use of robust standard errors (where possible) did not change resource usages considerably other than for QUICKTEST, where run times approximately doubled (Supplementary <xref rid="sup1" ref-type="supplementary-material">Fig. S4</xref>). We further used a subset of this benchmarking dataset to compare <italic toggle="yes">P</italic>-values calculated using GEM versus ProbABEL, finding very high concordance for a random subset of 5000 variants (Supplementary <xref rid="sup1" ref-type="supplementary-material">Fig. S6</xref>).</p>
      <fig position="float" id="btab223-F2">
        <label>Fig. 2.</label>
        <caption>
          <p>Benchmarking of GEM and other tools for GEI. Runtime (<bold>a, b</bold>) and maximum memory footprint (<bold>c, d</bold>) are shown as a function of sample size (<italic toggle="yes">N</italic>) and interaction testing program, using 100 000 simulated variants with the number of covariates held constant at three. The single exposure and outcome for each run were randomly simulated, with the outcome being either continuous (a, c) or binary with a case-control ratio of 1:3 (b, d). Circles and triangles correspond to programs compiled without or with Intel MKL, respectively. ‘GEM-opt’ refers to GEM runs using optimal parameters for speed, including compilation with MKL and pgen file inputs. All programs were run using a single thread and without robust standard errors. Results for ProbABEL at <italic toggle="yes">N</italic> &gt; 100k were excluded because memory usage exceeded 100 GB</p>
        </caption>
        <graphic xlink:href="btab223f2" position="float"/>
      </fig>
    </sec>
    <sec>
      <title>3.3 Application to the GEI study for sex dimorphic genetic effects of WHR in UK Biobank</title>
      <p>A genome-wide scan was then performed to test <inline-formula id="IE60"><mml:math id="IM60" display="inline" overflow="scroll"><mml:mi>G</mml:mi><mml:mo>×</mml:mo><mml:mi mathvariant="italic">sex</mml:mi></mml:math></inline-formula> interactions influencing WHR in the UKB (<xref rid="btab223-F3" ref-type="fig">Fig. 3</xref>, QQ plots in Supplementary <xref rid="sup1" ref-type="supplementary-material">Fig. S7</xref>). At a genome-wide significance threshold of 5×10<sup>−8</sup>, 257 independent loci were significant using the joint test (Supplementary <xref rid="sup1" ref-type="supplementary-material">Table S1</xref>; Supplementary <xref rid="sup1" ref-type="supplementary-material">Fig. S8</xref>). Of these, 29 did not have significant effects in the marginal test and 24 were not previously reported in the recently published BMI-adjusted WHR GWAS from the GIANT Consortium (<xref rid="btab223-B16" ref-type="bibr">Pulit <italic toggle="yes">et al.</italic>, 2019</xref>). This included loci at which neither the interaction effect test nor the marginal test were significant, such as that on chromosome 4 with the index variant rs10025536 (joint test <italic toggle="yes">P</italic> = 2.4×10<sup>−9</sup>), in an intron of <italic toggle="yes">PDE5A</italic>. When applying a more stringent multiple-testing threshold as in the meta-analysis (<italic toggle="yes">P</italic> &lt; 5×10<sup>−9</sup>), 11 of these novel signals remained. Many variants showed a much lower association <italic toggle="yes">P</italic>-value from the joint test compared to that from the marginal test of genetic effect (<xref rid="btab223-F3" ref-type="fig">Fig. 3b</xref>), though for 63% of the variants, the <italic toggle="yes">P</italic>-value for marginal association was lower than that for the joint test, as expected under the null hypothesis of no interaction.</p>
      <fig position="float" id="btab223-F3">
        <label>Fig. 3.</label>
        <caption>
          <p>Results from genome-wide interaction analysis of WHR in the UK Biobank. (<bold>a</bold>) Two-sided Manhattan plot displays association strengths for the interaction test (here, <inline-formula id="IE61"><mml:math id="IM61" display="inline" overflow="scroll"><mml:mi>G</mml:mi><mml:mo>×</mml:mo><mml:mi mathvariant="italic">sex</mml:mi></mml:math></inline-formula> interaction; top) and the marginal genetic effect test (from a model with no interaction; bottom). <italic toggle="yes">x</italic>-axis represents genomic position and <italic toggle="yes">y</italic>-axis represents the negative logarithm of the <italic toggle="yes">P</italic>-value for association at that locus. (<bold>b</bold>) Comparison of marginal and joint association strengths. The <italic toggle="yes">x</italic>-axis and <italic toggle="yes">y</italic>-axis show the negative logarithm of the association <italic toggle="yes">P</italic>-value using the marginal test (with no interaction) and the joint test, respectively. Dotted line corresponds to <italic toggle="yes">y </italic>=<italic toggle="yes"> x</italic>. For both panels, dashed lines denote genome-wide significance thresholds (<italic toggle="yes">P</italic> &lt; 5 <inline-formula id="IE62"><mml:math id="IM62" display="inline" overflow="scroll"><mml:mo>×</mml:mo></mml:math></inline-formula> 10<sup>−8</sup>). Variants shown in orange passed a genome-wide significance threshold for both interaction and marginal effects. Variants shown in purple passed a genome-wide significance threshold for interaction effect, but not the marginal effect. Variants shown in green passed a genome-wide significance threshold using the joint test, but not for interaction nor marginal effects. For visualization purposes, variants with <italic toggle="yes">P</italic> &lt; 1 <inline-formula id="IE63"><mml:math id="IM63" display="inline" overflow="scroll"><mml:mo>×</mml:mo></mml:math></inline-formula> 10<sup>−100</sup> were excluded from the Manhattan plot (from a single locus on chromosome 6 only), and variants with <italic toggle="yes">P</italic> &lt; 1 <inline-formula id="IE64"><mml:math id="IM64" display="inline" overflow="scroll"><mml:mo>×</mml:mo></mml:math></inline-formula> 10<sup>−50</sup> were excluded from the joint plot</p>
        </caption>
        <graphic xlink:href="btab223f3" position="float"/>
      </fig>
      <p>In addition, 54 independent loci were uncovered using the <inline-formula id="IE65"><mml:math id="IM65" display="inline" overflow="scroll"><mml:mi>G</mml:mi><mml:mo>×</mml:mo><mml:mi mathvariant="italic">sex</mml:mi></mml:math></inline-formula> interaction effect test (Supplementary <xref rid="sup1" ref-type="supplementary-material">Table S2</xref>). Of these, 9 were not detected with the marginal test (marginal <italic toggle="yes">P</italic>-values ranged from 2.7×10<sup>−4</sup> to 0.25), and 6 were not previously reported as sex dimorphic in <xref rid="btab223-B16" ref-type="bibr">Pulit <italic toggle="yes">et al.</italic> (2019)</xref>. Sensitivity analysis at these loci demonstrated excellent concordance with alternative software programs (Supplementary <xref rid="sup1" ref-type="supplementary-material">Fig. S9</xref>). The lowest interaction <italic toggle="yes">P</italic>-value was found on chromosome 2 at rs13389219 (<italic toggle="yes">P</italic> = 2.6×10<sup>−71</sup>), near the <italic toggle="yes">SLC38A11</italic> gene. As shown in Supplementary Figure S10 and Supplementary <xref rid="sup1" ref-type="supplementary-material">Table S4</xref>, the effect of this variant is more pronounced in females than males.</p>
      <p>We also evaluated the impact of the interaction covariate (<inline-formula id="IE66"><mml:math id="IM66" display="inline" overflow="scroll"><mml:mi>G</mml:mi><mml:mo>×</mml:mo><mml:mi mathvariant="italic">BMI</mml:mi></mml:math></inline-formula> term) on the genetic architecture of the <inline-formula id="IE67"><mml:math id="IM67" display="inline" overflow="scroll"><mml:mi>G</mml:mi><mml:mo>×</mml:mo><mml:mi mathvariant="italic">sex</mml:mi></mml:math></inline-formula> interaction effect. We present a comparison between the <italic toggle="yes">P</italic>-values of the <inline-formula id="IE68"><mml:math id="IM68" display="inline" overflow="scroll"><mml:mi>G</mml:mi><mml:mo>×</mml:mo><mml:mi mathvariant="italic">sex</mml:mi></mml:math></inline-formula> interaction test with and without the covariate in Supplementary Figure S11. Interaction covariate adjustment did not notably affect interaction strengths for these variants, though it did modestly strengthen the significance for interactions that were uniquely discovered in this analysis. To explore the impact of sample size on the genomic inflation observed here and assess polygenicity of interaction effects, the WHR analysis was re-run on three random down-sampled UK Biobank datasets (approximately 25% the size of the full sample; see Methods). Genomic inflation lambda values for marginal genetic effects in these down-sampled datasets were approximately equal to that of the GEI effects in the full sample (Supplementary <xref rid="sup1" ref-type="supplementary-material">Fig. S12</xref>).</p>
      <p>Motivated by the investigation conducted by <xref rid="btab223-B27" ref-type="bibr">Winkler et al. (2018)</xref>, which analyzed WHR interactions with both sex and age in stratified approach, we conducted an additional genome-wide scan to jointly test genetic interactions with sex and age (dichotomized as greater or less than 50 years old). We did not identify any additional loci using this approach, finding 41 significant loci after pruning (a strict subset of the 54 that were identified when using sex alone as an interaction). This observation illustrates the impact of using additional degrees of freedom in multiple-exposure interaction testing in the absence of substantial expected interaction effects. Thus, while the importance of simultaneous multi-exposure testing in some settings has been described previously (<xref rid="btab223-B10" ref-type="bibr">Kim <italic toggle="yes">et al.</italic>, 2019</xref>), users should take this statistical power cost into consideration when designing interaction analyses.</p>
    </sec>
  </sec>
  <sec>
    <title>4 Discussion</title>
    <p>GEI testing is becoming increasingly important for improving biological understanding and enabling precision medicine, but current tools do not typically enable an optimal set of statistical methods while retaining scalability to millions of samples. To approach this problem, we have introduced GEM, a software program intended for large-scale, genome-wide GEI analysis using a single variant testing approach. We showed that GEM maintains reasonable power and type I error under a variety of simulation settings, and that GEM performs well compared to existing programs for GEI studies in terms of both runtime and memory usage while including important statistical capabilities. We further used GEM to conduct a genome-wide analysis of <inline-formula id="IE69"><mml:math id="IM69" display="inline" overflow="scroll"><mml:mi>G</mml:mi><mml:mo>×</mml:mo><mml:mi mathvariant="italic">sex</mml:mi></mml:math></inline-formula> interaction influencing WHR in the UK Biobank, and found that the inclusion of explicit interactions in the statistical model enhanced discovery in comparison to a stratified approach.</p>
    <p>One major advantage of GEM is its ability to incorporate multiple interaction terms. This enables proper control for genotype-covariate effects (<xref rid="btab223-B9" ref-type="bibr">Keller, 2014</xref>) as well as multi-exposure interaction tests. These are conducted as <italic toggle="yes">q</italic>-degrees of freedom Chi-square tests, where <italic toggle="yes">q</italic> is the number of environmental exposures whose interaction terms are to be included. Interaction analysis incorporating contributions from multiple exposures has been described previously, using both fixed effects (‘omnibus’ test) (<xref rid="btab223-B10" ref-type="bibr">Kim <italic toggle="yes">et al.</italic>, 2019</xref>) and random effects (flexibly summarizing the contributions of multiple environments as a similarity matrix) (<xref rid="btab223-B13" ref-type="bibr">Moore <italic toggle="yes">et al.</italic>, 2019</xref>) approaches. Each of these approaches show an increase in statistical power when the underlying model indeed included multiple active environments, an observation which was replicated in the current study with the multi-exposure test implemented in GEM. We further demonstrated that power loss was modest when performing multi-exposure tests with only one true active environment interaction (<xref rid="btab223-F1" ref-type="fig">Fig. 1b</xref>). This suggests that the inclusion of multiple exposures in interaction studies with very large sample sizes may be a promising approach to discover additional loci and expand the genetic architecture of complex diseases.</p>
    <p>In benchmarking tests using simulated data, GEM demonstrated the feasibility of genome-wide GEI scans in large-scale cohorts of up to millions of samples. For example, it took less than one hour to conduct a robust analysis of a continuous phenotype for 100 000 variants in 1 million samples using a single thread, while requiring approximately 1 GB of memory. Based on the benchmarking results and current program specifications (<xref rid="btab223-T1" ref-type="table">Table 1</xref>), we found that GEM is the only option that permits efficient GEI analyses in millions of samples while allowing for robust standard errors and the inclusion of multiple interaction terms. We also note that the run times of GEM and PLINK2 can be improved considerably through the use of multithreading when multiple computing cores are available.</p>
    <p>We used anthropometric traits from the UK Biobank to conduct a genome-wide interaction analysis with GEM and evaluated <inline-formula id="IE70"><mml:math id="IM70" display="inline" overflow="scroll"><mml:mi>G</mml:mi><mml:mo>×</mml:mo><mml:mi mathvariant="italic">sex</mml:mi></mml:math></inline-formula> interactions influencing WHR. We report 54 independent loci supporting interactions with sex, with the strongest near the <italic toggle="yes">SLC38A11</italic> gene which has been previously linked to impedance-based body fat distribution in the UK Biobank (<xref rid="btab223-B20" ref-type="bibr">Rask-Andersen <italic toggle="yes">et al.</italic>, 2019</xref>). Interaction analyses have been performed in the UK Biobank for anthropometric traits (primarily BMI), but have generally used polygenic marginal-effect scores as the genetic effect, possibly due to the computational limitations described here (<xref rid="btab223-B19" ref-type="bibr">Rask-Andersen <italic toggle="yes">et al.</italic>, 2017</xref>; <xref rid="btab223-B5" ref-type="bibr">Calvin <italic toggle="yes">et al.</italic>, 2019</xref>; <xref rid="btab223-B23" ref-type="bibr">Tyrrell et al., 2017</xref>). This polygenic score-based approach may improve power when marginal and interaction effects are correlated, but otherwise may impair discovery (<xref rid="btab223-B10" ref-type="bibr">Kim <italic toggle="yes">et al.</italic>, 2019</xref>). The largest GWAS meta-analysis of BMI-adjusted WHR to date includes the UK Biobank to reach a total sample size of 694 649 and reports many genetic effect differences between males and females using a stratified approach (<xref rid="btab223-B16" ref-type="bibr">Pulit <italic toggle="yes">et al.</italic>, 2019</xref>). While sex-dimorphism of genetic effects has been reported for many traits, such as type 2 diabetes (<xref rid="btab223-B14" ref-type="bibr">Morris <italic toggle="yes">et al.</italic>, 2012</xref>) and longevity (<xref rid="btab223-B29" ref-type="bibr">Zeng <italic toggle="yes">et al.</italic>, 2018</xref>), such effects are stronger and more numerous for WHR.</p>
    <p>We demonstrate the value of the GEM method by detecting 6 additional loci with the interaction test among 352 768 participants from the UK Biobank study and detecting an additional 24 loci with the joint test that did not pass the genome-wide significance threshold in either the combined or stratified main-effect analyses from <xref rid="btab223-B16" ref-type="bibr">Pulit <italic toggle="yes">et al.</italic> (2019)</xref>. This increased discovery could be due to the fact that the joint approach implemented in GEM is equivalent to testing the hypothesis: <inline-formula id="IE71"><mml:math id="IM71" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mo>β</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="italic">male</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mo>β</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="italic">female</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:math></inline-formula>, which is more powerful in the presence of <inline-formula id="IE72"><mml:math id="IM72" display="inline" overflow="scroll"><mml:mi>G</mml:mi><mml:mo>×</mml:mo><mml:mi mathvariant="italic">sex</mml:mi></mml:math></inline-formula> interaction than tests of the of the combined (<inline-formula id="IE73"><mml:math id="IM73" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mo>β</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="italic">combined</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>)</mml:mo></mml:math></inline-formula> or stratified (<inline-formula id="IE74"><mml:math id="IM74" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mo>β</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="italic">male</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:math></inline-formula> and <inline-formula id="IE75"><mml:math id="IM75" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mo>β</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="italic">female</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:math></inline-formula> separately) effects. This added value is particularly notable, given that the present analysis was conducted in a subset of individuals (UKB) contributing only approximately half of the total meta-analysis sample size. While adjustment for interaction covariates (such as the <inline-formula id="IE76"><mml:math id="IM76" display="inline" overflow="scroll"><mml:mi>G</mml:mi><mml:mo>×</mml:mo><mml:mi mathvariant="italic">BMI</mml:mi></mml:math></inline-formula> term included here) may theoretically enhance discovery by reducing residual noise or reduce false positive findings due to confounding, we did not observe a major influence of this adjustment in our analysis. In addition, our analysis of genomic inflation in down-sampled UK Biobank subsets provides preliminary empirical evidence that the genetic architecture of marginal and GEI effects is similar, while confirming prior findings that approximately four times the sample size may be required to detect GEI effects with the same power as an equivalent marginal analysis.</p>
    <p>In its current form, GEM does not account for relatedness, so it may produce biased estimates unless the population is filtered for unrelated individuals. Another limitation is the known invalidity of asymptotic tests from logistic models for binary traits in the presence of substantial case-control imbalance. The authors of SPAGE found that for common variants, type I error rates under the same basic matrix projection model deteriorate with case-control ratios less than roughly 1:9 (<xref rid="btab223-B3" ref-type="bibr">Bi <italic toggle="yes">et al.</italic>, 2019</xref>). For more extreme case-control imbalance, we suggest the use of SPAGE, which uses a saddlepoint approximation to calibrate score test statistics.</p>
    <p>In summary, we have described a new software program, GEM, for conducting genome-wide GEI testing in datasets of up to millions of individuals, while allowing for multiple exposures and robust standard errors. We have made the software (<ext-link xlink:href="https://github.com/large-scale-gxe-methods/GEM" ext-link-type="uri">https://github.com/large-scale-gxe-methods/GEM</ext-link>) and workflows (<ext-link xlink:href="https://github.com/large-scale-gxe-methods/gem-workflow" ext-link-type="uri">https://github.com/large-scale-gxe-methods/gem-workflow</ext-link>) available in publicly available repositories. GEM facilitates the next generation of large-scale and consortium-based GEI studies and thus enables important discoveries for genomic understanding and personalized medicine.</p>
  </sec>
  <sec>
    <title>Acknowledgements</title>
    <p>This research was conducted using the UK Biobank Resource under Application Numbers 27892 and 42646. K.E.W. and A.K.M. completed the analysis of UK Biobank data independently of their capacity as employees of Mass General Brigham. Some simulation studies were performed in the Analysis Commons on DNAnexus, a hosting platform that uses Amazon Web Services (AWS) to provide a cloud data management and computing environment for large genomic data projects.</p>
    <sec>
      <title>Author Contributions</title>
      <p>D.T.P., L.H., H.C. and A.K.M. developed the GEM algorithm. D.T.P., L.H. and H.C. implemented the GEM software program. K.E.W., D.T.P., Y.C., M.S.-G and A.K.M. implemented software programs as cloud workflows. K.E.W., H.C. and A.K.M. designed the simulations and experiments. K.E.W. and D.T.P. carried out the simulations and data analyses. Y.J.S., Y.V.S. and A.C.M. provided guidance on experimental design and data analyses. K.E.W., H.C. and A.K.M. wrote the manuscript. All authors critically read the manuscript.</p>
    </sec>
  </sec>
  <sec>
    <title>Funding</title>
    <p>This work was supported by National Institutes of Health (NIH) [grant number R01 HL145025]. The Analysis Commons was funded by NIH [grant number R01 HL131136].</p>
    <p><italic toggle="yes">Conflict of Interest</italic>: none declared.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="sup1" position="float" content-type="local-data">
      <label>btab223_Supplementary_Data</label>
      <media xlink:href="btab223_supplementary_data.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="btab223-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Aulchenko</surname><given-names>Y.S.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2010</year>) <article-title>ProbABEL package for genome-wide association analysis of imputed data</article-title>. <source>BMC Bioinformatics</source>, <volume>11</volume>, <fpage>134</fpage>.<pub-id pub-id-type="pmid">20233392</pub-id></mixed-citation>
    </ref>
    <ref id="btab223-B2">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Bhattacharjee</surname><given-names>S.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2012</year>) <italic toggle="yes">CGEN: An R Package for Analysis of Case-Control Studies in Genetic Epidemiology</italic>. R package version 3.28.0.</mixed-citation>
    </ref>
    <ref id="btab223-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Bi</surname><given-names>W.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2019</year>) <article-title>A fast and accurate method for genome-wide scale phenome-wide G × E analysis and its application to UK Biobank</article-title>. <source>Am. J. Hum. Genet</source>., <volume>105</volume>, <fpage>1182</fpage>–<lpage>1192</lpage>.<pub-id pub-id-type="pmid">31735295</pub-id></mixed-citation>
    </ref>
    <ref id="btab223-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Bycroft</surname><given-names>C.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2018</year>) <article-title>The UK Biobank resource with deep phenotyping and genomic data</article-title>. <source>Nature</source>, <volume>562</volume>, <fpage>203</fpage>–<lpage>209</lpage>.<pub-id pub-id-type="pmid">30305743</pub-id></mixed-citation>
    </ref>
    <ref id="btab223-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Calvin</surname><given-names>C.M.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2019</year>) <article-title>Sex-specific moderation by lifestyle and psychosocial factors on the genetic contributions to adiposity in 112,151 individuals from UK Biobank</article-title>. <source>Sci. Rep</source>., <volume>9</volume>, <fpage>363</fpage>.<pub-id pub-id-type="pmid">30675005</pub-id></mixed-citation>
    </ref>
    <ref id="btab223-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Chang</surname><given-names>C.C.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2015</year>) <article-title>Second-generation PLINK: rising to the challenge of larger and richer datasets</article-title>. <source>Gigascience</source>, <volume>4</volume>, <fpage>7</fpage>.<pub-id pub-id-type="pmid">25722852</pub-id></mixed-citation>
    </ref>
    <ref id="btab223-B7">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Gauderman</surname><given-names>W.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2016</year>) <italic toggle="yes">GxEScan: A Program for Detecting GxE Interaction in a Genome-wide Association Study</italic>. <ext-link xlink:href="http://biostats.usc.edu/software" ext-link-type="uri">http://biostats.usc.edu/software</ext-link>.</mixed-citation>
    </ref>
    <ref id="btab223-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Gauderman</surname><given-names>W.J.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2017</year>) <article-title>Update on the state of the science for analytical methods for gene–environment interactions</article-title>. <source>Am. J. Epidemiol</source>., <volume>186</volume>, <fpage>762</fpage>–<lpage>770</lpage>.<pub-id pub-id-type="pmid">28978192</pub-id></mixed-citation>
    </ref>
    <ref id="btab223-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Keller</surname><given-names>M.C.</given-names></string-name></person-group> (<year>2014</year>) <article-title>Gene × environment interaction studies have not properly controlled for potential confounders: the problem and the (simple) solution</article-title>. <source>Biol. Psychiatry</source>, <volume>75</volume>, <fpage>18</fpage>–<lpage>24</lpage>.<pub-id pub-id-type="pmid">24135711</pub-id></mixed-citation>
    </ref>
    <ref id="btab223-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kim</surname><given-names>J.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2019</year>) <article-title>Joint analysis of multiple interaction parameters in genetic association studies</article-title>. <source>Genetics</source>, <volume>211</volume>, <fpage>483</fpage>–<lpage>494</lpage>.<pub-id pub-id-type="pmid">30578273</pub-id></mixed-citation>
    </ref>
    <ref id="btab223-B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kutalik</surname><given-names>Z.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2011</year>) <article-title>Methods for testing association between uncertain genotypes and quantitative traits</article-title>. <source>Biostatistics</source>, <volume>12</volume>, <fpage>1</fpage>–<lpage>17</lpage>.<pub-id pub-id-type="pmid">20543033</pub-id></mixed-citation>
    </ref>
    <ref id="btab223-B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lin</surname><given-names>D.-Y.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2014</year>) <article-title>Genetic association analysis under complex survey sampling: the Hispanic Community Health Study/Study of Latinos</article-title>. <source>Am. J. Hum. Genet</source>., <volume>95</volume>, <fpage>675</fpage>–<lpage>688</lpage>.<pub-id pub-id-type="pmid">25480034</pub-id></mixed-citation>
    </ref>
    <ref id="btab223-B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Moore</surname><given-names>R.</given-names></string-name></person-group>  <etal>et al</etal>; BIOS Consortium. (<year>2019</year>) <article-title>A linear mixed-model approach to study multivariate gene–environment interactions</article-title>. <source>Nat. Genet</source>., <volume>51</volume>, <fpage>180</fpage>–<lpage>186</lpage>.<pub-id pub-id-type="pmid">30478441</pub-id></mixed-citation>
    </ref>
    <ref id="btab223-B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Morris</surname><given-names>A.P.</given-names></string-name></person-group>  <etal>et al</etal>; DIAbetes Genetics Replication And Meta-analysis (DIAGRAM) Consortium. (<year>2012</year>) <article-title>Large-scale association analysis provides insights into the genetic architecture and pathophysiology of type 2 diabetes</article-title>. <source>Nat. Genet</source>., <volume>44</volume>, <fpage>981</fpage>–<lpage>990</lpage>.<pub-id pub-id-type="pmid">22885922</pub-id></mixed-citation>
    </ref>
    <ref id="btab223-B15">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>O’Connor</surname><given-names>B.D.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2017</year>) <article-title>The Dockstore: enabling modular, community-focused sharing of Docker-based genomics tools and workflows</article-title>. <source>F1000Research</source>, <volume>6</volume>, <fpage>52</fpage>.<pub-id pub-id-type="pmid">28344774</pub-id></mixed-citation>
    </ref>
    <ref id="btab223-B16">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Pulit</surname><given-names>S.L.</given-names></string-name></person-group>  <etal>et al</etal>; GIANT Consortium. (<year>2019</year>) <article-title>Meta-analysis of genome-wide association studies for body fat distribution in 694 649 individuals of European ancestry</article-title>. <source>Hum. Mol. Genet</source>., <volume>28</volume>, <fpage>166</fpage>–<lpage>174</lpage>.<pub-id pub-id-type="pmid">30239722</pub-id></mixed-citation>
    </ref>
    <ref id="btab223-B17">
      <mixed-citation publication-type="other">R Core Team. (<year>2019</year>) <italic toggle="yes">R: A Language and Environment for Statistical Computing</italic>. R Foundation for Statistical Computing, Vienna, Austria. <ext-link xlink:href="https://www.R-project.org/" ext-link-type="uri">https://www.R-project.org/</ext-link>.</mixed-citation>
    </ref>
    <ref id="btab223-B18">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Rappaport</surname><given-names>S.M.</given-names></string-name></person-group> (<year>2011</year>) <article-title>Implications of the exposome for exposure science</article-title>. <source>J. Exp. Sci. Environ. Epidemiol</source>., <volume>21</volume>, <fpage>5</fpage>–<lpage>9</lpage>.</mixed-citation>
    </ref>
    <ref id="btab223-B19">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Rask-Andersen</surname><given-names>M.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2017</year>) <article-title>Gene–environment interaction study for BMI reveals interactions between genetic factors and physical activity, alcohol consumption and socioeconomic status</article-title>. <source>PLoS Genet</source>., <volume>13</volume>, <fpage>e1006977</fpage>.<pub-id pub-id-type="pmid">28873402</pub-id></mixed-citation>
    </ref>
    <ref id="btab223-B20">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Rask-Andersen</surname><given-names>M.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2019</year>) <article-title>Genome-wide association study of body fat distribution identifies adiposity loci and sex-specific genetic effects</article-title>. <source>Nat. Commun</source>., <volume>10</volume>, <fpage>339</fpage>.<pub-id pub-id-type="pmid">30664634</pub-id></mixed-citation>
    </ref>
    <ref id="btab223-B21">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Smith</surname><given-names>P.G.</given-names></string-name>, <string-name><surname>Day</surname><given-names>N.E.</given-names></string-name></person-group> (<year>1984</year>) <article-title>The design of case–control studies: the influence of confounding and interaction effects</article-title>. <source>Int. J. Epidemiol</source>., <volume>13</volume>, <fpage>356</fpage>–<lpage>365</lpage>.<pub-id pub-id-type="pmid">6386716</pub-id></mixed-citation>
    </ref>
    <ref id="btab223-B22">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Thomas</surname><given-names>D.</given-names></string-name></person-group> (<year>2010</year>) <article-title>Methods for investigating gene–environment interactions in Candidate Pathway and Genome-Wide Association Studies</article-title>. <source>Annu. Rev. Public Health</source>, <volume>31</volume>, <fpage>21</fpage>–<lpage>36</lpage>.<pub-id pub-id-type="pmid">20070199</pub-id></mixed-citation>
    </ref>
    <ref id="btab223-B23">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Tyrrell</surname><given-names>J.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2017</year>) <article-title>Gene–obesogenic environment interactions in the UK Biobank study</article-title>. <source>Int. J. Epidemiol</source>., <volume>46</volume>, <fpage>559</fpage>–<lpage>575</lpage>.<pub-id pub-id-type="pmid">28073954</pub-id></mixed-citation>
    </ref>
    <ref id="btab223-B24">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Voorman</surname><given-names>A.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2011</year>) <article-title>Behavior of QQ-plots and genomic control in studies of gene–environment interaction</article-title>. <source>PLoS One</source>, <volume>6</volume>, <fpage>e19416</fpage>.<pub-id pub-id-type="pmid">21589913</pub-id></mixed-citation>
    </ref>
    <ref id="btab223-B25">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Watanabe</surname><given-names>K.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2017</year>) <article-title>Functional mapping and annotation of genetic associations with FUMA</article-title>. <source>Nat. Commun</source>., <volume>8</volume>, <fpage>1826</fpage>.<pub-id pub-id-type="pmid">29184056</pub-id></mixed-citation>
    </ref>
    <ref id="btab223-B26">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wild</surname><given-names>C.P.</given-names></string-name></person-group> (<year>2005</year>) <article-title>Complementing the genome with an ‘Exposome’: the outstanding challenge of environmental exposure measurement in molecular epidemiology</article-title>. <source>Cancer Epidemiol. Biomark. Prev</source>., <volume>14</volume>, <fpage>1847</fpage>–<lpage>1850</lpage>.</mixed-citation>
    </ref>
    <ref id="btab223-B27">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Winkler</surname><given-names>T.W.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2018</year>) <article-title>A joint view on genetic variants for adiposity differentiates subtypes with distinct metabolic implications</article-title>. <source>Nat. Commun</source>., <volume>9</volume>, <fpage>2018</fpage>.<pub-id pub-id-type="pmid">29789560</pub-id></mixed-citation>
    </ref>
    <ref id="btab223-B28">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Winkler</surname><given-names>T.W.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2015</year>) <article-title>EasyStrata: evaluation and visualization of stratified genome-wide association meta-analysis data</article-title>. <source>Bioinformatics</source>, <volume>31</volume>, <fpage>259</fpage>–<lpage>261</lpage>.<pub-id pub-id-type="pmid">25260699</pub-id></mixed-citation>
    </ref>
    <ref id="btab223-B29">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zeng</surname><given-names>Y.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2018</year>) <article-title>Sex differences in genetic associations with longevity</article-title>. <source>JAMA Netw. Open</source>, <volume>1</volume>, <fpage>e181670</fpage>.<pub-id pub-id-type="pmid">30294719</pub-id></mixed-citation>
    </ref>
    <ref id="btab223-B30">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zhang</surname><given-names>M.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2020</year>) <article-title>Interaction analysis under misspecification of main effects: some common mistakes and simple solutions</article-title>. <source>Stat. Med</source>., <volume>39</volume>, <fpage>1675</fpage>–<lpage>1694</lpage>.<pub-id pub-id-type="pmid">32101638</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
