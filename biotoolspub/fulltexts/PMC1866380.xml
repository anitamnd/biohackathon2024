<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-title>BMC Bioinformatics</journal-title>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">1866380</article-id>
    <article-id pub-id-type="publisher-id">1471-2105-6-S4-S5</article-id>
    <article-id pub-id-type="pmid">16351754</article-id>
    <article-id pub-id-type="doi">10.1186/1471-2105-6-S4-S5</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Query3d: a new method for high-throughput analysis of functional residues in protein structures</article-title>
    </title-group>
    <contrib-group>
      <contrib id="A1" corresp="yes" contrib-type="author">
        <name>
          <surname>Ausiello</surname>
          <given-names>Gabriele</given-names>
        </name>
        <xref ref-type="aff" rid="I1">1</xref>
        <email>ausiello@cbm.bio.uniroma2.it</email>
      </contrib>
      <contrib id="A2" contrib-type="author">
        <name>
          <surname>Via</surname>
          <given-names>Allegra</given-names>
        </name>
        <xref ref-type="aff" rid="I1">1</xref>
        <email> via@cbm.bio.uniroma2.it </email>
      </contrib>
      <contrib id="A3" contrib-type="author">
        <name>
          <surname>Helmer-Citterich</surname>
          <given-names>Manuela</given-names>
        </name>
        <xref ref-type="aff" rid="I1">1</xref>
        <email> citterich@uniroma2.it </email>
      </contrib>
    </contrib-group>
    <aff id="I1"><label>1</label>Centre for Molecular Bioinformatics, Department of Biology, University of Rome Tor Vergata, Via della Ricerca Scientifica, 00133 Rome, Italy</aff>
    <pub-date pub-type="collection">
      <year>2005</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>1</day>
      <month>12</month>
      <year>2005</year>
    </pub-date>
    <volume>6</volume>
    <issue>Suppl 4</issue>
    <supplement>
      <named-content content-type="supplement-title">Italian Society of Bioinformatics (BITS): Annual Meeting 2005</named-content>
      <named-content content-type="supplement-editor">Rita Casadio, Alessandro Guffanti, Manuela Helmer-Citterich, Giancarlo Mauri, Luciano Milanesi, Graziano Pesole, Cecilia Saccone and Giorgio Valle</named-content>
    </supplement>
    <fpage>S5</fpage>
    <lpage>S5</lpage>
    <permissions>
      <copyright-statement>Copyright © 2005 Ausiello et al; licensee BioMed Central Ltd</copyright-statement>
      <copyright-year>2005</copyright-year>
      <copyright-holder>Ausiello et al; licensee BioMed Central Ltd</copyright-holder>
      <license license-type="open-access" xlink:href="http://creativecommons.org/licenses/by/2.0">
        <p>This is an open access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/2.0"/>), which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly cited.</p>
        <!--<rdf xmlns="http://web.resource.org/cc/" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:dc="http://purl.org/dc/elements/1.1" xmlns:dcterms="http://purl.org/dc/terms"><Work xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:dcterms="http://purl.org/dc/terms/" rdf:about=""><license rdf:resource="http://creativecommons.org/licenses/by/2.0"/><dc:type rdf:resource="http://purl.org/dc/dcmitype/Text"/><dc:author>
               Ausiello
               Gabriele
               
               ausiello@cbm.bio.uniroma2.it
            </dc:author><dc:title>
            Query3d: a new method for high-throughput analysis of functional residues in protein structures
         </dc:title><dc:date>2005</dc:date><dcterms:bibliographicCitation>BMC Bioinformatics 6(Suppl 4): S5-. (2005)</dcterms:bibliographicCitation><dc:identifier type="sici">1471-2105(2005)6:Suppl 4&#x0003c;S5&#x0003e;</dc:identifier><dcterms:isPartOf>urn:ISSN:1471-2105</dcterms:isPartOf><License rdf:about="http://creativecommons.org/licenses/by/2.0"><permits rdf:resource="http://web.resource.org/cc/Reproduction" xmlns=""/><permits rdf:resource="http://web.resource.org/cc/Distribution" xmlns=""/><requires rdf:resource="http://web.resource.org/cc/Notice" xmlns=""/><requires rdf:resource="http://web.resource.org/cc/Attribution" xmlns=""/><permits rdf:resource="http://web.resource.org/cc/DerivativeWorks" xmlns=""/></License></Work></rdf>-->
      </license>
    </permissions>
    <abstract>
      <sec>
        <title>Background</title>
        <p>The identification of local similarities between two protein structures can provide clues of a common function. Many different methods exist for searching for similar subsets of residues in proteins of known structure. However, the lack of functional and structural information on single residues, together with the low level of integration of this information in comparison methods, is a limitation that prevents these methods from being fully exploited in high-throughput analyses.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p>Here we describe Query3d, a program that is both a structural DBMS (Database Management System) and a local comparison method. The method conserves a copy of all the residues of the Protein Data Bank annotated with a variety of functional and structural information. New annotations can be easily added from a variety of methods and known databases. The algorithm makes it possible to create complex queries based on the residues' function and then to compare only subsets of the selected residues. Functional information is also essential to speed up the comparison and the analysis of the results.</p>
      </sec>
      <sec>
        <title>Conclusion</title>
        <p>With Query3d, users can easily obtain statistics on how many and which residues share certain properties in all proteins of known structure. At the same time, the method also finds their structural neighbours in the whole PDB. Programs and data can be accessed through the PdbFun web interface.</p>
      </sec>
    </abstract>
    <conference>
      <conf-date>17–19 March 2005</conf-date>
      <conf-name>Italian Society of Bioinformatics (BITS): Annual Meeting 2005</conf-name>
      <conf-loc>Milan, Italy</conf-loc>
    </conference>
  </article-meta>
</front>
<body>
  <sec>
    <title>Background</title>
    <p>A lot of information on the relationship between structure and function lies hidden in the high number of known protein structures. Protein local structure comparison methods are powerful instruments in helping elucidate the mechanisms that connect protein structural features to the protein's function. Comparison methods can highlight correlations between spatial positioning of single aminoacids and their interactions with the surrounding environment.</p>
    <p>In the last ten years many new and highly effective comparison methods have been developed (for a review see [<xref ref-type="bibr" rid="B1">1</xref>]). Since speed is one of the most treated and fundamental features, some of these methods are now able to search accurately a structural motif in the whole set of known structures in a very short time.</p>
    <p>However the ability to provide and embed biological information in the comparison algorithm should be considered even more important than speed. To accomplish this, a high degree of integration of databases and functional annotation programs is needed. Many comparison methods do not treat integration aspects and, by concentrating their efforts on the comparison algorithm, consider aminoacids independently of their biological context. Often protein residues are described as set of points associated with physico-chemical characteristics, with no additional information on their real or supposed functions.</p>
    <p>The structural biologist who uses local comparison methods to find similarities between a specific protein of interest and a database of structures, needs to access residues biological function and properties in two different phases: when choosing the structural pattern of the query protein and when analyzing the comparison results in search of a biological rationale for the structural similarities.</p>
    <p>The biological information shared by comparison methods is so poor that users need to do a lot of manual browsing among different databases both before and after the structural comparison. If the comparison is not between two single proteins or motifs but between a structure and a set of structures, or between a set of motifs and a database of structures, the manual work needed for the analysis of the results increases rapidly and becomes unaffordable in the case of high-throughput analyses.</p>
    <p>Some of the developed methods in the pre-run phase provide the user a number of selected sets of structural motifs to search with. The most frequent case is the one where the user is given a single list of structural motifs automatically extracted from a single database. PDBSITESCAN [<xref ref-type="bibr" rid="B2">2</xref>] gives a list of 8000 structural motifs, some of these automatically extracted from the SITE field of the PDB [<xref ref-type="bibr" rid="B3">3</xref>] and others obtained by analyzing protein-protein contacts. TESS [<xref ref-type="bibr" rid="B4">4</xref>] uses the PROCAT database of enzyme active sites as a list of structural motifs. CAVBASE [<xref ref-type="bibr" rid="B5">5</xref>] is based on the RELIBASE database [<xref ref-type="bibr" rid="B6">6</xref>] of protein-ligand interactions. The comparison method developed by Kinoshita et al. [<xref ref-type="bibr" rid="B7">7</xref>] uses the EF-SITE database [<xref ref-type="bibr" rid="B8">8</xref>] of automatically predicted functional sites.</p>
    <p>WEBFEATURE [<xref ref-type="bibr" rid="B9">9</xref>] runs on a set of automatically predicted binding sites. PINTS [<xref ref-type="bibr" rid="B10">10</xref>] makes it possible to search for structural motifs from four different lists: SCOP families, interactions with PDB hetero-atoms, PDB SITE fields and exposed residues. Apart from the last two described methods, which are accessible through a web interface, comparison methods are not generally developed for specific applications and are not easily available for public use.</p>
    <p>None of the cited methods makes it possible to combine or integrate information coming from different lists of motifs or databases by allowing the users to search for sets of residues characterized by properties of different types (i.e.: the solvent-exposed residues of a PROSITE motif).</p>
    <p>A comparison method along this lines is ASSAM [<xref ref-type="bibr" rid="B11">11</xref>]. ASSAM gives the user many features on structural residues. Such features can be used for the search: information from the SITE field, secondary structure from DSSP [<xref ref-type="bibr" rid="B12">12</xref>], disulphide bridge from SSBOND field, and solvent accessibility calculated on biological quaternary structure. Moreover, ASSAM allows the user to partially combine different features in the same structural search. For example, secondary structure of the matching residues can be specified.</p>
    <p>Here we describe Query3d, a new method that integrates many existing databases and programs for 3D functional annotation together with a fast structural comparison algorithm. Nine data sources have been interconnected ranging from solvent exposure to ligand binding ability, location in a protein cavity, secondary structure, functional pattern, protein domain and catalytic activity. All this functional information is bound to the single residue and not to the structure as a whole, allowing the user to perform detailed queries on the features of single residue sets. All the structural and functional data are stored locally and managed by a fast and powerful database management system which is also able to perform fast and high-throughput local structural comparisons.</p>
  </sec>
  <sec>
    <title>Results</title>
    <sec>
      <title>Overview</title>
      <p>Query3d is both a database management system (DBMS) oriented to protein structural analysis and a structural comparison algorithm. These two features can be used individually or combined, giving rise to three types of analysis, as described below.</p>
      <p>The first option is the use of Query3d as a local structural comparison program. Regions of local similarity can be searched between any pair of protein structures, between a protein chain and the whole PDB or also between any two arbitrary and chosen subsets of aminoacids in a structure.</p>
      <p>The second possibility consists in the use of Query3d as a DBMS devoted to the functional analysis of protein structures. The program provides access to a rich database of functional and structural information on all PDB residues. Users can create arbitrary complex queries on all known structures. For instance, users can ask about the number and identity of the residues sharing a chosen set of properties. A typical query subset can consist of all residues that are able to bind ATP or ADP, are not hydrophobic and belong to a loop. The program returns the total number of such residues per chain in the whole PDB (useful for structural statistical studies) and selects these residues for further analysis.</p>
      <p>However, the most interesting application of our method is obtained from the combination of DBMS and the comparison algorithm. By using these two features at the same time, users can create automated and customized selections of functional residues to be searched for structural similarity with the whole PDB or with other residue selections. For instance, the previously described binding sites can be compared with all residues lying in the major cavities on the surface of a set of catalytic domains.</p>
    </sec>
    <sec>
      <title>Dataset used</title>
      <p>Structural and biological data for comparison and functional querying was derived using the PdbScan package (manuscript in prep.). PdbScan is a set of programs created to build a common interface and access method to the PDB structure database and the major existing databases and methods of proteins functional/structural annotations. PdbScan output is a residue-oriented relational database where all protein residues with their main characteristics extracted from the PDB are stored together with other information mapped from other data sources. In order to generate these data, PdbScan runs locally a variety of annotation methods or imports functional information on protein structure from different existing databases. Each different source of data information is called a feature. Examples of residue features present in PdbScan are: secondary structure, solvent accessibility, conservation, interaction with a ligand and position in a protein domain or in an enzyme active site. For each feature present in the database, a single value is assigned to each PDB residue. For example, a residue can bind ATP, can be solvent-accessible, can be present in an SH3 structural domain and share a certain conservation value in a multiple alignment of homologous proteins.</p>
    </sec>
    <sec>
      <title>Queries</title>
      <p>The program can run two types of user queries: simple or complex ones.</p>
      <p>Simple queries involve only a single feature. By using this type of query, users can select all residues sharing a single common annotation or any number of annotations belonging to the same feature. For example, with the 'binding sites' feature, users can select all residues interacting with ATP, but also all residues interacting with ATP or ADP or Phosphate. The complete selection of all the annotations of a feature is also possible, e.g., all residues involved in the binding of any ligand.</p>
      <p>Complex queries can be created by combining pairs of simple queries generated with selections in different features. Combinations are created using Boolean operators AND, OR and NOT. We propose an example of a complex query that combines, with an AND operation, a simple query on the 'binding sites' feature with a simple query on the 'secondary structures' feature. This query could select all residues in the PDB that are located in an alpha helix and are able to bind ATP or ADP. Complex queries can also combine other complex queries and not only simple ones.</p>
      <p>After each selection (simple or complex query) the DBMS can return three different levels of information: i) the total number of PDB residues selected by the query and the total number of PDB chains sharing at least one selected residue; ii) the complete list of chains with at least one selected residue together with the total number of residues selected in each chain; iii) the complete list of selected residues, together with the complete list of annotations of each residue, in each selected protein chain.</p>
    </sec>
    <sec>
      <title>Query example</title>
      <p>Selecting 'ATP' and 'ADP' in the 'binding sites' feature we obtain a list of all the 8998 residues distributed among 840 chains of the PDB that are able to bind ATP or ADP.</p>
      <p>Selecting 'hydrogen bonded turn' in the '2D structures' feature we obtain a second list of all the 1400109 residues in 49278 chains that are in a 'loop'.</p>
      <p>By operating an intersection using the 'AND' operator between the two list of residues we obtain a new list of 1164 residues in 570 chains that are in a loop and are also involved in ATP or ADP binding.</p>
    </sec>
    <sec>
      <title>Comparison algorithm</title>
      <p>The structure comparison method in Query3d is designed to find the largest subset of matching aminoacids between two complete protein chains or between two sets of selected residues. The program can search for structural local similarity between selected residues of any pair of user queries. The matching process is completely sequence independent so local similarity has to be intended between residues that are neighbours in space. The output of the program is, for each pair of compared chains, a list of the residues found to be similar. The detailed description of the comparison algorithms is given in 'Methods'.</p>
      <p>The method was found to function correctly in previous authors' works. The method was applied in different test cases and proved capable of finding significant local structural similarities, even in the absence of protein sequence or protein fold similarities. More specifically, the algorithm proved capable of recognizing five different known difficult cases of local structural similarity and has been extensively used in a structural genomics function prediction experiment [<xref ref-type="bibr" rid="B13">13</xref>]. In [<xref ref-type="bibr" rid="B13">13</xref>], the method has also been applied to the search of similarities between a complete collection of annotated surface clefts extracted from the PDB and the whole database of annotated and non annotated surface clefts. Only 2% of the high-scoring matches can be considered as possible false positive hits or not yet identified true positives.</p>
    </sec>
    <sec>
      <title>Availability</title>
      <p>Query3d is open source. It can be accessed through the web or, if special conditions of use are required, Query3d can be installed locally.</p>
      <p>A server running the program can be accessed through a web interface. The web interface is called pdbFun [<xref ref-type="bibr" rid="B14">14</xref>] and is available at the address <ext-link ext-link-type="uri" xlink:href="http://pdbfun.uniroma2.it"/>. Through the pdbFun interface, all major features of Query3d are available. Help and tutorials in the website facilitate use. Selections of residues can be created and listed in tables. Users can combine selections and manually refine them by adding and removing single residues. Structural comparisons can be launched between selections while structural matches can be visualized instantly. Moreover in pdbFun a java viewer of protein structures is provided to help the user in selecting residues and analyzing structural comparison results.</p>
      <p>There are two cases where local installation of Query3D becomes necessary: the need to perform long and computationally intensive structural comparisons or to calculate a large number of selections or comparisons. The public server cannot guarantee all the CPU time needed for an all-versus-all comparison. Or, if many different selections of residues have to be generated and compared, running a batch job on a personal computer is the fastest and most effective thing to do.</p>
      <p>The software is available for UNIX/linux platforms. Communication with the server program is carried out through text files and the PostgreSQL database.</p>
    </sec>
  </sec>
  <sec>
    <title>Conclusion</title>
    <p>We have developed Query3d. By using this program, the structural biologist can easily select a set of interesting residues according to their biological or structural properties in the whole PDB. The selected residues can be analyzed, counted and manually modified. When the user is satisfied with the selections, structural comparisons can be launched.</p>
    <p>Query3d is a new and flexible methodology dedicated to the study and analysis of protein structures. Given the amount of functional information associated to each residue, the method can give an answer to an extremely high number of possible questions of biological relevance. The number of possible combination of queries is so high that it is difficult to envisage all the possible applications of the method.</p>
    <p>Future directions include a higher degree of flexibility in the type of possible residue searches. For example, we are going to introduce pattern matching on arbitrary residue features. Possible patterns could be defined in protein-sequence or in a volume of space. These could use not only residue type but also residue features, such as secondary structure or solvent accessibility. The final goal is to transform Query3d in an instrument to search with simple operations in the space of known protein structures, for arbitrarily chosen functional and structural conformation of residues.</p>
  </sec>
  <sec sec-type="methods">
    <title>Methods</title>
    <sec>
      <title>Available features</title>
      <p>Query3d loads annotated residues data together with residue coordinates and other structural information. An important characteristic of the program is its being independent of the type of data stored. So different versions of PdbScan data can exist, containing different functional information, or even customized features. If a version of PdbScan is used where ten features are implemented, each residue can share a maximum of ten annotations.</p>
      <p>Features available are those currently generated by the PdbScan package. They embed nine data sources: solvent exposure as given by the naccess program [<xref ref-type="bibr" rid="B15">15</xref>], surface clefts calculated with the SURFNET program [<xref ref-type="bibr" rid="B16">16</xref>], protein domains from SMART database [<xref ref-type="bibr" rid="B17">17</xref>], secondary structure derived by using the dssp program, PROSITE patterns [<xref ref-type="bibr" rid="B18">18</xref>], binding hetero atoms from the PDB, active sites from the CatRes database [<xref ref-type="bibr" rid="B19">19</xref>], residue conservation from HSSP [<xref ref-type="bibr" rid="B20">20</xref>] and protein fold from CATH [<xref ref-type="bibr" rid="B21">21</xref>].</p>
    </sec>
    <sec>
      <title>Protein structure representation</title>
      <p>Each protein chain in the PDB is stored locally and described as a set of non-connected, and therefore sequence independent, residues. Each residue is characterized by a set of attributes, such as type of residue, list of neighbour residues, position in space and a list of functional/structural information. Two residues are considered neighbours if the distance between their C alpha atoms is less than 7.5 Angstroms. Two points describe the three-dimensional position of each residue: the first one corresponds to the C alpha atom, while the second is calculated as the geometric average of all the residue side chain atoms. This second set of coordinates gives information on the direction in space in which the side chains are pointing. The last type of information is a complete list of functional and structural properties of the aminoacid in this structure. This information comes from PdbScan (see previous paragraph) and is used by Query3D to permit the users to select the residues that have to be counted or considered for a structural comparison (see next paragraph).</p>
    </sec>
    <sec>
      <title>Structural matching</title>
      <p>During the comparison, the program tries to match the maximum number of residues between two protein chains. Two sets of residues are considered similar if they fulfil three criteria: neighbourhood, structural similarity and biochemical similarity.</p>
      <p>The first criterion demands that all residues present in the set of matching aminoacids are neighbours of at least one of the other residues in the set. This guarantees that all matched aminoacids are neighbours in space, saving a lot of comparison time. The biological motivation for this constraint is that local comparison algorithms are always used to find similarities between active sites, binding sites and other localized areas in protein structures. In these regions, two areas of distant residues are not expected to be conserved.</p>
      <p>The second matching criterion concerns structural similarity. This demands that all sets of matched residues have a root mean square deviation (r.m.s.d.) lower than a certain threshold. The lower the threshold, the faster the program, since a higher number of matches is excluded in the early stages of comparison without the need to explore them further (see next paragraph). However, using a too low r.m.s.d. threshold increases the probability of missing evolutionarily distant similarities (not so well structurally conserved). The present threshold is 0.7 Angstrom and represents a good compromise between speed and accuracy. The r.m.s.d of the match is calculated by using all the matched residue points, both the C alpha and the side chain points. The inclusion of a side chain point in the calculation of the global match r.m.s.d. ensures that also side chains' direction needs to be conserved between two sets of matching residues.</p>
      <p>The last criterion is based on the biochemical similarity of residue types. To evaluate this type of similarity, we use a substitution matrix. The default matrix is the Dayhoff one [<xref ref-type="bibr" rid="B22">22</xref>]. According to this matrix, if two aminoacids of different type are matched in space, a substitution value is calculated. Two aminoacids cannot be matched if their similarity according to this matrix is lower than 0.3. Moreover, the average substitution value of all the aminoacids belonging to the structural match must be lower than 1.2. Obviously if the user needs a different matrix, also those threshold values need to be changed accordingly.</p>
    </sec>
    <sec>
      <title>Comparison algorithm</title>
      <p>Given two protein structures, Query3D is guaranteed to find the two largest sets of matching residues that fulfil the matching criteria described in the previous paragraph. In order to do so, an exhaustive depth-first search is performed exploring all the possible combinations of aminoacids belonging to the two different proteins.</p>
      <p>The algorithm starts by creating all the possible length 1 matches. These are composed of a single aminoacid from the probe structure matched to a single aminoacid belonging to the target structure. For example, if the probe and target structures are composed of n and m aminoacids, respectively, n × m length 1 matches can be generated. All these matches are evaluated using the matching criteria and, in case, discarded. Only those matches that are considered valid are extended.</p>
      <p>Match extension consists of the generation of new possible length 2 matches starting from each valid length 1 match. All possible pairs of neighbour aminoacids are added to the first two. For example, let the first aminoacids in the probe structure have i neighbours and the corresponding matched aminoacid in the target structure have j neighbours. The algorithm generates i × j new matches of length 2. Again all these new matches are evaluated and, if possible, iteratively further extended to length 3 matches. The process of validation and extension is repeated until no more valid matches can be generated. At this point, the algorithm stops and saves the longest match found. By doing so, the algorithm guarantees that all possible combinations of subsets valid for a structural match have been explored.</p>
      <p>Note that in the match extension phase only residues selected by the user are considered among all the available neighbours. This simple fact ensures that structural matches can only include aminoacids that have been chosen by user queries. In order to save time when comparing very similar protein chains, the algorithm is stopped when a match reaches a certain number of residues. We noticed that a match size limit of 10 residues is enough to prevent the program from spending too much time trying all possible combinations of good matches among globally similar structures.</p>
    </sec>
    <sec>
      <title>Implementation</title>
      <p>One important feature of Query3d is its speed both in running queries and in comparing structures.</p>
      <p>All queries can be run in a few tenth of a second. PDB actual size exceeds 12 million aminoacids, and this performance would not be possible using common databases. Query3d relies on a fast queries algorithm in C that avoids all disk accesses. All the essential information necessary for performing queries and structural comparison is stored in a compressed format in less than 1 GB of RAM. We reckon that with this compression level, foreseeable size increase in PDB in the near future will remain compatible with RAM sizes available for simple desktop PCs.</p>
      <p>Protein structure superposition has been optimized. We managed to keep structural comparison time very low. The time needed to compare a protein structure composed of 200 residues with a medium size protein chain in the PDB is only 60 milliseconds on a common 3 GHz pentium4 processor. The search for a local structural similarity between a 200-residue protein and a non-redundant PDB database, at 30% identity, composed of about 4000 structures, can be completed in less than 4 minutes. To obtain these results we developed an optimized C function implementing the quaternion method for calculating the r.m.s.d. between two set of points [<xref ref-type="bibr" rid="B23">23</xref>]. We differentiate from the original method, because we do not need the eigenvector of the 4 × 4 quaternions matrix (containing the superposing rotation) but just the lowest eigenvalue that represents the s.r.s. (sum of residual squared) of the best superposition. We can find it merely by solving a quartic equation instead of using the longer algorithms used to find eigenvectors.</p>
    </sec>
  </sec>
  <sec>
    <title>Authors' contributions</title>
    <p>AV participated in the design of the work. MHC participated in the design of the work and helped to draft the manuscript. All authors read and approved the final manuscript.</p>
  </sec>
</body>
<back>
  <ack>
    <sec>
      <title>Acknowledgements</title>
      <p>We gratefully acknowledge the support of Telethon GGP04273, GENEFUN, AIRC, a PNR 2001–2003 (FIRB art.8) and a PNR 2003–2007 (FIRB art.8).</p>
    </sec>
  </ack>
  <ref-list>
    <ref id="B1">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jones</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Thornton</surname>
            <given-names>JM</given-names>
          </name>
        </person-group>
        <article-title>Searching for functional sites in protein structures</article-title>
        <source>Curr Opin Chem Biol</source>
        <year>2004</year>
        <volume>8</volume>
        <fpage>3</fpage>
        <lpage>7</lpage>
        <pub-id pub-id-type="pmid">15036149</pub-id>
        <pub-id pub-id-type="doi">10.1016/j.cbpa.2003.11.001</pub-id>
      </citation>
    </ref>
    <ref id="B2">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ivanisenko</surname>
            <given-names>VA</given-names>
          </name>
          <name>
            <surname>Pintus</surname>
            <given-names>SS</given-names>
          </name>
          <name>
            <surname>Grigorovich</surname>
            <given-names>DA</given-names>
          </name>
          <name>
            <surname>Kolchanov</surname>
            <given-names>NA</given-names>
          </name>
        </person-group>
        <article-title>PDBSiteScan: a program for searching for active, binding and posttranslational modification sites in the 3D structures of proteins</article-title>
        <source>Nucleic Acids Res</source>
        <year>2004</year>
        <volume>32</volume>
        <fpage>W549</fpage>
        <lpage>554</lpage>
        <pub-id pub-id-type="pmid">15215447</pub-id>
        <pub-id pub-id-type="doi">10.1093/nar/gkh439</pub-id>
      </citation>
    </ref>
    <ref id="B3">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Deshpande</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Addess</surname>
            <given-names>KJ</given-names>
          </name>
          <name>
            <surname>Bluhm</surname>
            <given-names>WF</given-names>
          </name>
          <name>
            <surname>Merino-Ott</surname>
            <given-names>JC</given-names>
          </name>
          <name>
            <surname>Townsend-Merino</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>Q</given-names>
          </name>
          <name>
            <surname>Knezevich</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Xie</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Feng</surname>
            <given-names>Z</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The RCSB Protein Data Bank: a redesigned query system and relational database based on the mmCIF schema</article-title>
        <source>Nucleic Acids Res</source>
        <year>2005</year>
        <volume>33</volume>
        <fpage>D233</fpage>
        <lpage>237</lpage>
        <pub-id pub-id-type="pmid">15608185</pub-id>
        <pub-id pub-id-type="doi">10.1093/nar/gki057</pub-id>
      </citation>
    </ref>
    <ref id="B4">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wallace</surname>
            <given-names>AC</given-names>
          </name>
          <name>
            <surname>Borkakoti</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Thornton</surname>
            <given-names>JM</given-names>
          </name>
        </person-group>
        <article-title>TESS: a geometric hashing algorithm for deriving 3D coordinate templates for searching structural databases. Application to enzyme active sites</article-title>
        <source>Protein Sci</source>
        <year>1997</year>
        <volume>6</volume>
        <fpage>2308</fpage>
        <lpage>2323</lpage>
        <pub-id pub-id-type="pmid">9385633</pub-id>
      </citation>
    </ref>
    <ref id="B5">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schmitt</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Kuhn</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Klebe</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>A new method to detect related function among proteins independent of sequence and fold homology</article-title>
        <source>J Mol Biol</source>
        <year>2002</year>
        <volume>323</volume>
        <fpage>387</fpage>
        <lpage>406</lpage>
        <pub-id pub-id-type="pmid">12381328</pub-id>
        <pub-id pub-id-type="doi">10.1016/S0022-2836(02)00811-2</pub-id>
      </citation>
    </ref>
    <ref id="B6">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hendlich</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Bergner</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Gunther</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Klebe</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>Relibase: design and development of a database for comprehensive analysis of protein-ligand interactions</article-title>
        <source>J Mol Biol</source>
        <year>2003</year>
        <volume>326</volume>
        <fpage>607</fpage>
        <lpage>620</lpage>
        <pub-id pub-id-type="pmid">12559926</pub-id>
        <pub-id pub-id-type="doi">10.1016/S0022-2836(02)01408-0</pub-id>
      </citation>
    </ref>
    <ref id="B7">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kinoshita</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Nakamura</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>Identification of protein biochemical functions by similarity search using the molecular surface database eF-site</article-title>
        <source>Protein Sci</source>
        <year>2003</year>
        <volume>12</volume>
        <fpage>1589</fpage>
        <lpage>1595</lpage>
        <pub-id pub-id-type="pmid">12876308</pub-id>
        <pub-id pub-id-type="doi">10.1110/ps.0368703</pub-id>
      </citation>
    </ref>
    <ref id="B8">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kinoshita</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Furui</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Nakamura</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>Identification of protein functions from a molecular surface database, eF-site</article-title>
        <source>J Struct Funct Genomics</source>
        <year>2002</year>
        <volume>2</volume>
        <fpage>9</fpage>
        <lpage>22</lpage>
        <pub-id pub-id-type="pmid">12836670</pub-id>
        <pub-id pub-id-type="doi">10.1023/A:1011318527094</pub-id>
      </citation>
    </ref>
    <ref id="B9">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Liang</surname>
            <given-names>MP</given-names>
          </name>
          <name>
            <surname>Banatao</surname>
            <given-names>DR</given-names>
          </name>
          <name>
            <surname>Klein</surname>
            <given-names>TE</given-names>
          </name>
          <name>
            <surname>Brutlag</surname>
            <given-names>DL</given-names>
          </name>
          <name>
            <surname>Altman</surname>
            <given-names>RB</given-names>
          </name>
        </person-group>
        <article-title>WebFEATURE: An interactive web tool for identifying and visualizing functional sites on macromolecular structures</article-title>
        <source>Nucleic Acids Res</source>
        <year>2003</year>
        <volume>31</volume>
        <fpage>3324</fpage>
        <lpage>3327</lpage>
        <pub-id pub-id-type="pmid">12824318</pub-id>
        <pub-id pub-id-type="doi">10.1093/nar/gkg553</pub-id>
      </citation>
    </ref>
    <ref id="B10">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Stark</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Russell</surname>
            <given-names>RB</given-names>
          </name>
        </person-group>
        <article-title>Annotation in three dimensions. PINTS: Patterns in Non-homologous Tertiary Structures</article-title>
        <source>Nucleic Acids Res</source>
        <year>2003</year>
        <volume>31</volume>
        <fpage>3341</fpage>
        <lpage>3344</lpage>
        <pub-id pub-id-type="pmid">12824322</pub-id>
        <pub-id pub-id-type="doi">10.1093/nar/gkg506</pub-id>
      </citation>
    </ref>
    <ref id="B11">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Spriggs</surname>
            <given-names>RV</given-names>
          </name>
          <name>
            <surname>Artymiuk</surname>
            <given-names>PJ</given-names>
          </name>
          <name>
            <surname>Willett</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>Searching for patterns of amino acids in 3D protein structures</article-title>
        <source>J Chem Inf Comput Sci</source>
        <year>2003</year>
        <volume>43</volume>
        <fpage>412</fpage>
        <lpage>421</lpage>
        <pub-id pub-id-type="pmid">12653503</pub-id>
        <pub-id pub-id-type="doi">10.1021/ci0255984</pub-id>
      </citation>
    </ref>
    <ref id="B12">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kabsch</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Sander</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>Dictionary of protein secondary structure: pattern recognition of hydrogen-bonded and geometrical features</article-title>
        <source>Biopolymers</source>
        <year>1983</year>
        <volume>22</volume>
        <fpage>2577</fpage>
        <lpage>2637</lpage>
        <pub-id pub-id-type="pmid">6667333</pub-id>
        <pub-id pub-id-type="doi">10.1002/bip.360221211</pub-id>
      </citation>
    </ref>
    <ref id="B13">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ferrè</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Ausiello</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Zanzoni</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Helmer-Citterich</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Functional annotation by identification of local surface similarities: a novel tool for structural genomics</article-title>
        <source>BMC Bioinformatics</source>
        <year>2005</year>
        <volume>6</volume>
        <fpage>294</fpage>
        <pub-id pub-id-type="pmid">16336691</pub-id>
        <pub-id pub-id-type="doi">10.1186/1471-2105-6-194</pub-id>
      </citation>
    </ref>
    <ref id="B14">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ausiello</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Zanzoni</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Peluso</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Via</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Helmer-Citterich</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>pdbFun: mass selection and fast comparison of annotated PDB residues</article-title>
        <source>Nucleic Acids Res</source>
        <year>2005</year>
        <volume>33</volume>
        <fpage>W133</fpage>
        <lpage>137</lpage>
        <pub-id pub-id-type="pmid">15980442</pub-id>
        <pub-id pub-id-type="doi">10.1093/nar/gki499</pub-id>
      </citation>
    </ref>
    <ref id="B15">
      <citation citation-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Hubbard</surname>
            <given-names>SJ</given-names>
          </name>
          <name>
            <surname>Thornton</surname>
            <given-names>JM</given-names>
          </name>
        </person-group>
        <source>NACCESS</source>
        <year>1993</year>
        <publisher-name>NACCESS. Department of Biochemistry and Molecular Biology, University College London.</publisher-name>
      </citation>
    </ref>
    <ref id="B16">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Laskowski</surname>
            <given-names>RA</given-names>
          </name>
        </person-group>
        <article-title>SURFNET: a program for visualizing molecular surfaces, cavities, and intermolecular interactions</article-title>
        <source>J Mol Graph</source>
        <year>1995</year>
        <volume>13</volume>
        <fpage>323</fpage>
        <lpage>330</lpage>
        <comment>307–328.</comment>
        <pub-id pub-id-type="pmid">8603061</pub-id>
        <pub-id pub-id-type="doi">10.1016/0263-7855(95)00073-9</pub-id>
      </citation>
    </ref>
    <ref id="B17">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Letunic</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Copley</surname>
            <given-names>RR</given-names>
          </name>
          <name>
            <surname>Schmidt</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Ciccarelli</surname>
            <given-names>FD</given-names>
          </name>
          <name>
            <surname>Doerks</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Schultz</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Ponting</surname>
            <given-names>CP</given-names>
          </name>
          <name>
            <surname>Bork</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>SMART 4.0: towards genomic data integration</article-title>
        <source>Nucleic Acids Res</source>
        <year>2004</year>
        <volume>32</volume>
        <fpage>D142</fpage>
        <lpage>144</lpage>
        <pub-id pub-id-type="pmid">14681379</pub-id>
        <pub-id pub-id-type="doi">10.1093/nar/gkh088</pub-id>
      </citation>
    </ref>
    <ref id="B18">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hulo</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Sigrist</surname>
            <given-names>CJ</given-names>
          </name>
          <name>
            <surname>Le Saux</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Langendijk-Genevaux</surname>
            <given-names>PS</given-names>
          </name>
          <name>
            <surname>Bordoli</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Gattiker</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>De Castro</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Bucher</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Bairoch</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Recent improvements to the PROSITE database</article-title>
        <source>Nucleic Acids Res</source>
        <year>2004</year>
        <volume>32</volume>
        <fpage>D134</fpage>
        <lpage>137</lpage>
        <pub-id pub-id-type="pmid">14681377</pub-id>
        <pub-id pub-id-type="doi">10.1093/nar/gkh044</pub-id>
      </citation>
    </ref>
    <ref id="B19">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bartlett</surname>
            <given-names>GJ</given-names>
          </name>
          <name>
            <surname>Porter</surname>
            <given-names>CT</given-names>
          </name>
          <name>
            <surname>Borkakoti</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Thornton</surname>
            <given-names>JM</given-names>
          </name>
        </person-group>
        <article-title>Analysis of catalytic residues in enzyme active sites</article-title>
        <source>J Mol Biol</source>
        <year>2002</year>
        <volume>324</volume>
        <fpage>105</fpage>
        <lpage>121</lpage>
        <pub-id pub-id-type="pmid">12421562</pub-id>
        <pub-id pub-id-type="doi">10.1016/S0022-2836(02)01036-7</pub-id>
      </citation>
    </ref>
    <ref id="B20">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sander</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Schneider</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>The HSSP database of protein structure-sequence alignments</article-title>
        <source>Nucleic Acids Res</source>
        <year>1994</year>
        <volume>22</volume>
        <fpage>3597</fpage>
        <lpage>3599</lpage>
        <pub-id pub-id-type="pmid">7937066</pub-id>
      </citation>
    </ref>
    <ref id="B21">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Orengo</surname>
            <given-names>CA</given-names>
          </name>
          <name>
            <surname>Michie</surname>
            <given-names>AD</given-names>
          </name>
          <name>
            <surname>Jones</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Jones</surname>
            <given-names>DT</given-names>
          </name>
          <name>
            <surname>Swindells</surname>
            <given-names>MB</given-names>
          </name>
          <name>
            <surname>Thornton</surname>
            <given-names>JM</given-names>
          </name>
        </person-group>
        <article-title>CATH × a hierarchic classification of protein domain structures</article-title>
        <source>Structure</source>
        <year>1997</year>
        <volume>5</volume>
        <fpage>1093</fpage>
        <lpage>1108</lpage>
        <pub-id pub-id-type="pmid">9309224</pub-id>
        <pub-id pub-id-type="doi">10.1016/S0969-2126(97)00260-8</pub-id>
      </citation>
    </ref>
    <ref id="B22">
      <citation citation-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Dayhoff</surname>
            <given-names>MO</given-names>
          </name>
          <name>
            <surname>Schwartz</surname>
            <given-names>RM</given-names>
          </name>
          <name>
            <surname>Orcutt</surname>
            <given-names>BC</given-names>
          </name>
        </person-group>
        <person-group person-group-type="editor">
          <name>
            <surname>Dayhoff MO</surname>
          </name>
        </person-group>
        <article-title>A model for evolutionary change in proteins</article-title>
        <source>Atlas of Protein Sequence and Structure</source>
        <year>1978</year>
        <volume>5</volume>
        <fpage>345</fpage>
        <lpage>352</lpage>
      </citation>
    </ref>
    <ref id="B23">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kearsley</surname>
            <given-names>SK</given-names>
          </name>
        </person-group>
        <article-title>On the orthogonal transformations used for structural comparisons</article-title>
        <source>Acta Cryst</source>
        <year>1989</year>
        <volume>A45</volume>
        <fpage>208</fpage>
        <lpage>210</lpage>
      </citation>
    </ref>
  </ref-list>
</back>
