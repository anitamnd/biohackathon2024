<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD Journal Publishing DTD v2.3 20070202//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName journalpublishing.dtd?>
<?SourceDTD.Version 2.3?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 2?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Cancer Inform</journal-id>
    <journal-id journal-id-type="publisher-id">101258149</journal-id>
    <journal-title-group>
      <journal-title>Cancer Informatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1176-9351</issn>
    <publisher>
      <publisher-name>Libertas Academica</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">3153162</article-id>
    <article-id pub-id-type="pmid">21863128</article-id>
    <article-id pub-id-type="doi">10.4137/CIN.S7473</article-id>
    <article-id pub-id-type="publisher-id">cin-10-2011-205</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Methodology</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>On Differential Gene Expression Using RNA-Seq Data</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Lee</surname>
          <given-names>Juhee</given-names>
        </name>
        <xref ref-type="aff" rid="af1-cin-10-2011-205">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Ji</surname>
          <given-names>Yuan</given-names>
        </name>
        <xref ref-type="aff" rid="af1-cin-10-2011-205">
          <sup>1</sup>
        </xref>
        <xref ref-type="corresp" rid="c1-cin-10-2011-205"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Liang</surname>
          <given-names>Shoudan</given-names>
        </name>
        <xref ref-type="aff" rid="af2-cin-10-2011-205">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Cai</surname>
          <given-names>Guoshuai</given-names>
        </name>
        <xref ref-type="aff" rid="af2-cin-10-2011-205">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Müller</surname>
          <given-names>Peter</given-names>
        </name>
        <xref ref-type="aff" rid="af3-cin-10-2011-205">
          <sup>3</sup>
        </xref>
      </contrib>
    </contrib-group>
    <aff id="af1-cin-10-2011-205"><label>1</label>Department of Biostatistics, UT M.D. Anderson Cancer Center Houston, Texas, USA</aff>
    <aff id="af2-cin-10-2011-205"><label>2</label>Department of Bioinformatics and Computational Biology, UT M.D. Anderson Cancer Center Houston, Texas, USA</aff>
    <aff id="af3-cin-10-2011-205"><label>3</label>Department of Mathematics, UT Austin, Austin, Texas, USA</aff>
    <author-notes>
      <corresp id="c1-cin-10-2011-205">Corresponding author email: <email>yuanji@mdanderson.org</email></corresp>
    </author-notes>
    <pub-date pub-type="epub">
      <day>01</day>
      <month>8</month>
      <year>2011</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2011</year>
    </pub-date>
    <volume>10</volume>
    <fpage>205</fpage>
    <lpage>215</lpage>
    <permissions>
      <copyright-statement>© the author(s), publisher and licensee Libertas Academica Ltd.</copyright-statement>
      <copyright-year>2011</copyright-year>
      <license license-type="open-access">
        <license-p>This is an open access article. Unrestricted non-commercial use is permitted provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <abstract>
      <sec>
        <title>Motivation:</title>
        <p>RNA-Seq is a novel technology that provides read counts of RNA fragments in each gene, including the mapped positions of each read within each gene. Besides many other applications it can be used to detect differentially expressed genes. Most published methods collapse the position-level read data into a single gene-specific expression measurement. Statistical inference proceeds by modeling these gene-level expression measurements.</p>
      </sec>
      <sec>
        <title>Results:</title>
        <p>We present a Bayesian method of calling differential expression (BM-DE) that directly models the position-level read counts. We demonstrate the potential advantage of the BM-DE method compared to existing approaches that rely on gene-level aggregate data. An important additional feature of the proposed approach is that BM-DE can be used to analyze RNA-Seq data from experiments without biological replicates. This becomes possible since the approach works with multiple position-level read counts for each gene. We demonstrate the importance of modeling for position-level read counts with a yeast data set and a simulation study.</p>
      </sec>
      <sec>
        <title>Availability:</title>
        <p>A public domain R package is available from <ext-link ext-link-type="uri" xlink:href="http://odin.mdacc.tmc.edu/~ylji/BMDE/">http://odin.mdacc.tmc.edu/~ylji/BMDE/</ext-link>.</p>
      </sec>
    </abstract>
    <kwd-group>
      <kwd>clustering</kwd>
      <kwd>false discovery rate</kwd>
      <kwd>mixture models</kwd>
      <kwd>next-generation sequencing</kwd>
    </kwd-group>
  </article-meta>
</front>
<body>
  <sec>
    <label>1</label>
    <title>Introduction</title>
    <sec>
      <label>1.1</label>
      <title>RNA-Seq experiments</title>
      <p>RNA-Seq is a high-throughput sequencing technology that has recently emerged as a popular methodology to measure gene expression with high accuracy. It generates millions of short reads of mRNA or cDNA. The short reads are mapped to the genome, resulting in a sequence of read counts at millions of genomic positions.<xref ref-type="bibr" rid="b1-cin-10-2011-205">1</xref>,<xref ref-type="bibr" rid="b2-cin-10-2011-205">2</xref> RNA-Seq exhibits a high level of reproducibility,<xref ref-type="bibr" rid="b1-cin-10-2011-205">1</xref> and mitigates many limitations of microarrays.<xref ref-type="bibr" rid="b3-cin-10-2011-205">3</xref> Consequently, RNA-Seq enables researchers to investigate more complex aspects of the trancriptome, such as allele-specific expression and the discovery of novel promoters and isoforms,<xref ref-type="bibr" rid="b4-cin-10-2011-205">4</xref> and to develop new approaches to old but fundamental biological questions. An example of the latter is the identification of differentially expressed genes between two conditions.</p>
      <p>RNA-Seq experiments produce data on millions of short reads. The data report the base sequence of the reads and the positions on the genome to which the reads are mapped. Most current methods collapse the position-level read counts into a single gene-level summary, such as the number of reads that map per kilobase of exon model per million mapped reads (RPKM), or simply the sum of all the read counts across positions within each gene. Simple hypothesis testing based on the gene-level summaries implements inference on differential gene expression under two biological conditions. We take a different approach. We start by modeling the position-level read counts within a gene. This enables us to account for position outliers among position-level counts. We demonstrate that failure to identify and downweight outliers can bias gene-level summaries. Our hierarchical modeling approach then proceeds with borrowing information across genes for the inference of differential expression. Furthermore, we specifically model systemic biases such as total RNA amount in each experiment to achieve better accuracy in calling differentially expressed genes.</p>
      <p>Ji and Liu<xref ref-type="bibr" rid="b5-cin-10-2011-205">5</xref> illustrated how inference with a Bayesian hierarchical model can improve statistical inference for high-throughput experiments. They also highlighted that borrowing information across loci through a hierarchical model can improve statistical inference even in the case without biological replicates. We follow this advise and propose a Bayesian hierarchical model to effectively utilizes position-level information and accounts for the variabilities in all the position-level read counts mapped to each gene. We demonstrate the superior performance of the BM-DE method, even when the RNA-seq data are generated from experiments without biological replicates. Due to the still elevated cost of RNA-Seq many studies are carried out without replicates. In such experiments, only one biological sample is prepared per condition for a single run of RNA sequencing. We show that the BM-DE method reduces the false positive findings. Note that this does not imply that the BM-DE method can account for the biological variation in such experiments. This is impossible without replicates. We recommend to use sound and efficient experimental designs<xref ref-type="bibr" rid="b6-cin-10-2011-205">6</xref> with biological replicates for RNA-Seq experiments. For existing data, some without replicates, the proposed BM-DE approach can be used to increase the precision of calling differentially expressed genes.</p>
    </sec>
    <sec sec-type="methods">
      <label>1.2</label>
      <title>Inference for RNA-Seq data</title>
      <p>RNA-Seq data are usually normalized across libraries to adjust for different total read counts by lanes or by samples. In early work, researchers simply used cumulative counts, summing up read counts across positions, followed by minor normalization to account for gene length and the total number of reads.<xref ref-type="bibr" rid="b7-cin-10-2011-205">7</xref> Recently, more sophisticated normalization methods were proposed. For example, see Robinson and Oshlack<xref ref-type="bibr" rid="b8-cin-10-2011-205">8</xref> and Balwierz et al.<xref ref-type="bibr" rid="b9-cin-10-2011-205">9</xref></p>
      <p>With the single expression summary per gene per condition, most statistical modeling and inference for differential expression has been based on classical hypothesis testing, such as Fisher’s exact test, likelihood ratio tests, or t-tests. For example, Marioni et al<xref ref-type="bibr" rid="b10-cin-10-2011-205">10</xref> modeled read counts with a Poisson distribution, and used a likelihood ratio test to identify differentially expressed genes. Similar to Marioni et al,<xref ref-type="bibr" rid="b10-cin-10-2011-205">10</xref> Wang et al<xref ref-type="bibr" rid="b1-cin-10-2011-205">1</xref> used a Poisson distribution to test differential expression for experiments without biological replicates. Robinson and Smyth<xref ref-type="bibr" rid="b11-cin-10-2011-205">11</xref> developed a negative binomial model to account for the variation across replicate samples. They estimated a common dispersion using all tags, and shrinks dispersions of tags toward the estimated common dispersion similar to empirical Bayes approach. edgeR<xref ref-type="bibr" rid="b12-cin-10-2011-205">12</xref> implemented the model for application for RNA-Seq data. Bullard et al<xref ref-type="bibr" rid="b13-cin-10-2011-205">13</xref> compared the performance of various hypothesis tests, and found poor performance of the <italic>t</italic>-test, in particular for genes with low counts. They also studied biases introduced by gene-length and the normalization procedure. They observed that the <italic>t</italic>-test tends to yield significant test statistics more frequently for longer genes. This is due to the dependence of the estimated standard error on the mean read counts.</p>
      <p>Oshlack and Wakefield<xref ref-type="bibr" rid="b14-cin-10-2011-205">14</xref> further investigated the transcript length bias in RNA-Seq data for differential expression. They illustrated that the standard approaches that use aggregate read counts for each gene in differential expression are subject to significant bias, and that a simple adjustment, dividing by the transcript length, does not entirely remove this bias. Young et al<xref ref-type="bibr" rid="b15-cin-10-2011-205">15</xref> accounted for the transcript length bias in RAN-Seq data, and developed a statistical model for gene ontology analysis.</p>
      <p>Bayesian approaches for differential expression in RNA-Seq data have been developed by many researchers, such as Anders and Huber,<xref ref-type="bibr" rid="b16-cin-10-2011-205">16</xref> Hoen et al,<xref ref-type="bibr" rid="b3-cin-10-2011-205">3</xref> Taub<xref ref-type="bibr" rid="b17-cin-10-2011-205">17</xref> and Wu et al.<xref ref-type="bibr" rid="b18-cin-10-2011-205">18</xref> Wu et al<xref ref-type="bibr" rid="b18-cin-10-2011-205">18</xref> took an empirical Bayes approach to detect differential expression for RNA-Seq data when biological replicates are not available. They developed a hierarchical model with aggregate counts at gene level to estimate log fold change in gene expression, and mitigated the limitation of experiments without replicate by borrowing strength across all genes.</p>
      <p>Differently from the previous approaches, the methods proposed in Jian and Wong,<xref ref-type="bibr" rid="b19-cin-10-2011-205">19</xref> Salzman et al,<xref ref-type="bibr" rid="b20-cin-10-2011-205">20</xref> and Li et al<xref ref-type="bibr" rid="b21-cin-10-2011-205">21</xref> used models to estimate gene expression at the isoform level. Oshlack et al<xref ref-type="bibr" rid="b4-cin-10-2011-205">4</xref> provided a broad review on current research in preprocessing RNA-Seq data and identifying differentially expressed genes.</p>
      <p>In this paper, we propose a novel method for the inference on differential gene expression with three distinct features:
<list list-type="bullet"><list-item><p>We explicitly model the read count at each genomic position within a gene. The proposed model can reduce the false positive rate by accounting for the dispersion in the position-specific counts. As another desirable consequence of position-level modeling the length bias disappears. We show significant improvements over existing models that only use gene-level summaries.</p></list-item><list-item><p>The proposed method does not require prior normalization of the mapped read counts. Instead we simultaneously carry out the normalization and the inference on differential expression.</p></list-item><list-item><p>We borrow strength across genes in a hierarchical model. Thus, the detection of differentially expressed genes is informed by the expression measurements in the entire data set.</p></list-item></list></p>
      <p>A related important feature is that borrowing strength across genes in the hierarchical model allows meaningful model-based inference without replicates, if desired.</p>
      <p>Section 2 describes the proposed Bayesian model. Section 3 reports the data analysis for the yeast data. Section 4 describes a small simulation study. The last section concludes with a final discussion. The manuscript and R programs with a simple example are available at <ext-link ext-link-type="uri" xlink:href="http://odin.mdacc.tmc.edu/~ylji">http://odin.mdacc.tmc.edu/~ylji</ext-link>.</p>
    </sec>
  </sec>
  <sec>
    <label>2</label>
    <title>Probability Model</title>
    <p>RNA-Seq data contains millions of read counts, with each read mapped to a genomic position within a gene. Such count data can be easily assembled from the standard output of upstream read alignment, eg, using SOAP or BOWTIE.<xref ref-type="bibr" rid="b22-cin-10-2011-205">22</xref> We consider counts, <italic>n<sub>ij</sub></italic> and <italic>m<sub>ij</sub></italic>, of mapped reads starting at position <italic>j</italic> of gene <italic>i</italic> under two different experimental conditions, 0 and 1, respectively. Here <italic>i</italic> = 1, …, <italic>I</italic> and <italic>j</italic> = 1, …, <italic>J<sub>i</sub></italic>. Let <italic>N<sub>ij</sub></italic> = <italic>n<sub>ij</sub></italic> + <italic>m<sub>ij</sub></italic> denote the total count over the two conditions at position <italic>j</italic> of gene <italic>i</italic>. For ad-hoc inference about differential expression we may consider the empirical fraction, <italic>r<sub>ij</sub></italic> = <italic>n<sub>ij</sub></italic> /<italic>N<sub>ij</sub></italic> as the position-level ratio or <italic>r<sub>i</sub></italic> = Σ<italic><sub>j</sub></italic> <italic>n<sub>ij</sub></italic>/Σ<italic><sub>j</sub></italic> <italic>N<sub>ij</sub></italic> as the gene-level ratio. The proposed model-based inference improves on these empirical estimates by modeling the position-level read counts.</p>
    <p>To start, we characterize sampling variation as binomial sampling. Conditional on the total count <italic>N<sub>ij</sub></italic>, we assume <italic>n<sub>ij</sub></italic> ∼ Bin(<italic>N<sub>ij</sub></italic>, <italic>p<sub>ij</sub></italic>), independently across positions <italic>j</italic>. Therefore, <italic>p<sub>ij</sub></italic> represents the true proportion of the read count under condition 0 relative to the total read count under both conditions at location <italic>j</italic> of gene <italic>i</italic>. One could use <italic>r<sub>ij</sub></italic> as an empirical estimate of <italic>p<sub>ij</sub></italic>. For example, a value of <italic>r<sub>ij</sub></italic> = 0.5 implies that the observed numbers of reads mapped into position <italic>j</italic> of gene <italic>i</italic> are the same across the two conditions. Typically, most <italic>r<sub>ij</sub></italic>’s cluster around a particular value representing a relative expression level of gene <italic>i</italic>. Often the data includes some outliers closer to 0 or 1, due to random noise. One of our modeling aims is to downweigh these outliers in quantifying the gene expression.</p>
    <p>To this end, we introduce a mechanism to down-weigh outlying <italic>p<sub>ij</sub></italic> in the inference for differential expression. We achieve this by introducing a latent indicator <italic>w<sub>ij</sub></italic> for each position, with <italic>w<sub>ij</sub></italic> = 0 representing an outlier at position <italic>j</italic>. We assume that <italic>p<sub>ij</sub></italic> follows a mixture of beta distributions Ji et al.<xref ref-type="bibr" rid="b23-cin-10-2011-205">23</xref>
<disp-formula><mml:math id="M1"><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi><mml:mo>,</mml:mo></mml:mrow></mml:msub><mml:mi> </mml:mi><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mover><mml:mo stretchy="false">∼</mml:mo><mml:mrow><mml:mtext mathvariant="italic">indep</mml:mtext><mml:mo>.</mml:mo></mml:mrow></mml:mover><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mtext>Be</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mtext>if</mml:mtext></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mtext>Be</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mtext>if</mml:mtext></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow></mml:mrow></mml:math></disp-formula>where Be(<italic>a, b</italic>) represents a beta distribution with mean <italic>a</italic> = (<italic>a</italic> + <italic>b</italic>): When <italic>w<sub>ij</sub></italic> = 0 the <italic>j</italic>-th position is an outlier, and the expected ratio is given a Be(1/2, 1/2) prior which assigns most probability mass close to 0 or 1. We assume <italic>w<sub>ij</sub></italic> follows a Bernoulli distribution with with probability 
<inline-formula><mml:math id="M2"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mi>i</mml:mi><mml:mi>w</mml:mi></mml:msubsup></mml:mrow></mml:math></inline-formula> ie, <italic>w<sub>ij</sub></italic> ∼ Ber
<inline-formula><mml:math id="M3"><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mi>t</mml:mi><mml:mi>w</mml:mi></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, in which 
<inline-formula><mml:math id="M4"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mi>i</mml:mi><mml:mi>w</mml:mi></mml:msubsup></mml:mrow></mml:math></inline-formula> represents a gene-specific proportion of outliers. The parameters (<italic>α<sub>i</sub></italic>, <italic>β<sub>i</sub></italic>) characterize the expression of gene <italic>i</italic>, excluding the outliers. This formal accounting for outliers in the mixture robustifies inference in critical ways. Later, in the application to a yeast RNA-Seq data set, we will show that failure to downweigh such outliers could even flip the reported inference on differential expression for some genes (<xref ref-type="fig" rid="f6-cin-10-2011-205">Fig. 6</xref>).</p>
    <p>We reparameterize <italic>α<sub>i</sub></italic> and <italic>β<sub>i</sub></italic> for easier interpretation and computation. We follow Robert and Rousseau,<xref ref-type="bibr" rid="b24-cin-10-2011-205">24</xref> and let <italic>η<sub>i</sub></italic> = log(<italic>α<sub>i</sub></italic> + <italic>β<sub>i</sub></italic>) and <italic>ξ<sub>i</sub></italic> = log(<italic>α<sub>i</sub></italic>/<italic>β<sub>i</sub></italic>). Note that <italic>ξ<sub>i</sub></italic> is the logit of the mean <italic>α<sub>i</sub></italic>/(<italic>α<sub>i</sub></italic> + <italic>β<sub>i</sub></italic>) of the beta distribution. In the (<italic>ξ<sub>i</sub></italic>, <italic>η<sub>i</sub></italic>) parametrization an unusually large or small value of <italic>ξ<sub>i</sub></italic> indicates differential expression, whereas <italic>η<sub>i</sub></italic> allows for varying levels of heterogeneity across genes. This interpretation leaves <italic>ξ<sub>i</sub></italic> as the main parameter of interest. <xref ref-type="fig" rid="f3-cin-10-2011-205">Figure 3(b)</xref> shows the posterior means of all <italic>ξ<sub>i</sub></italic> for a yeast RNA-Seq data set (see Section 3). While the cloud in the middle represents the majority of nondifferentially expressed genes, the genes with values <italic>ξ<sub>i</sub></italic> outside the cloud are those with differential expression. We use a mixture of normal distributions for <italic>ξ<sub>i</sub></italic> to formalize the notion of differential expression. That is,
<disp-formula id="FD1"><label>(1)</label><mml:math id="M5"><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:msub><mml:mrow><mml:mi>ξ</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:mover accent="true"><mml:mi>ξ</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mi>ξ</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mover><mml:mo>∼</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mi>i</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:mover><mml:msubsup><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mn>0</mml:mn><mml:mi>λ</mml:mi></mml:msubsup><mml:mo>⋅</mml:mo><mml:mtext>N</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mover accent="true"><mml:mi>ξ</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mi>ξ</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msubsup><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>λ</mml:mi></mml:msubsup><mml:mo>⋅</mml:mo><mml:mtext>N</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mover accent="true"><mml:mi>ξ</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>δ</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mi>ξ</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi> </mml:mi><mml:mi> </mml:mi><mml:mi> </mml:mi><mml:mi> </mml:mi><mml:mi> </mml:mi><mml:mi> </mml:mi><mml:mo>+</mml:mo><mml:msubsup><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mn>1</mml:mn><mml:mi>λ</mml:mi></mml:msubsup><mml:mo>⋅</mml:mo><mml:mtext>N</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mover accent="true"><mml:mi>ξ</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mo>,</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>δ</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mi>ξ</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula></p>
    <p>We introduce a latent trinary indicator <italic>λ<sub>i</sub></italic> ∈ {0, −1, 1} to represent normal, under-, and over-expression, and rewrite the mixture model (1) as a hierarchical model
<disp-formula><mml:math id="M6"><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:msub><mml:mrow><mml:mi>ξ</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi> </mml:mi><mml:mrow><mml:mover accent="true"><mml:mi>ξ</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mover><mml:mo stretchy="false">∼</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mi>i</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:mover></mml:mrow><mml:mtext>N</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mover accent="true"><mml:mi>ξ</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:msub><mml:mrow><mml:mi>δ</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mi>ξ</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi> </mml:mi><mml:mi> </mml:mi><mml:mi> </mml:mi><mml:mi> </mml:mi><mml:mi> </mml:mi><mml:mi> </mml:mi><mml:mi> </mml:mi><mml:mtext>Pr</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>l</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mi>l</mml:mi><mml:mi>λ</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi> </mml:mi><mml:mi> </mml:mi><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi> </mml:mi><mml:mi> </mml:mi><mml:mn>1</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula></p>
    <p>We complete the model with priors for 
<inline-formula><mml:math id="M7"><mml:mrow><mml:msup><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mi>w</mml:mi></mml:msup><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mn>1</mml:mn><mml:mi>w</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mn>1</mml:mn><mml:mi>w</mml:mi></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, 
<inline-formula><mml:math id="M8"><mml:mrow><mml:msup><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mi>λ</mml:mi></mml:msup><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>λ</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mn>0</mml:mn><mml:mi>λ</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mn>1</mml:mn><mml:mi>λ</mml:mi></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, δ<sub>−1</sub>, δ<sub>1</sub> and 
<inline-formula><mml:math id="M9"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mi>ξ</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:math></inline-formula>. We use a beta distribution 
<inline-formula><mml:math id="M10"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mi>i</mml:mi><mml:mi>w</mml:mi></mml:msubsup><mml:mo stretchy="false">∼</mml:mo><mml:mtext>Be</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mi>w</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mi>w</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, independently across <italic>i</italic>, a Dirichlet prior π<sup>λ</sup> ∼ Dir(<italic>a</italic><sub>−1,</sub> <italic>a</italic><sub>0,</sub> <italic>a</italic><sub>1</sub>), and a gamma prior 
<inline-formula><mml:math id="M11"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mi>ξ</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>∼</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mi>s</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mi>s</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. Finally, we use independent gamma priors 
<inline-formula><mml:math id="M12"><mml:mrow><mml:msub><mml:mrow><mml:mi>δ</mml:mi></mml:mrow><mml:mi>l</mml:mi></mml:msub><mml:mo>∼</mml:mo><mml:mi>G</mml:mi><mml:mi>a</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mi>l</mml:mi><mml:mi>δ</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mi>l</mml:mi><mml:mi>δ</mml:mi></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi> </mml:mi><mml:mi> </mml:mi><mml:mn>1</mml:mn><mml:mo>,</mml:mo></mml:mrow></mml:math></inline-formula> and π(ξ̄) ∝ 1.</p>
    <p>The hyperprior distribution on ξ̄, allows for imbalance between the overall counts under the two conditions.</p>
    <p>In contrast to fixing ξ̄, for example, at ξ̄ = 0.5, the hierarchical extension with the hyperprior allows for a systematic bias (such as different sequencing depth) across the two conditions. Using possibly different <italic>δ</italic><sub>−1</sub> and <italic>δ</italic><sub>1</sub> allows for varying deviation from the mean ξ̄ for of over- versus under-expressed genes. For simplicity, we fix <italic>η<sub>i</sub></italic> in the analysis for the yeast data. If a prior on <italic>η<sub>i</sub></italic> were desired, one could easily extend the model accordingly, using, for example the prior model from Robert and Rousseau.<xref ref-type="bibr" rid="b24-cin-10-2011-205">24</xref> The model is summarized in <xref ref-type="fig" rid="f1-cin-10-2011-205">Figure 1</xref>.</p>
  </sec>
  <sec>
    <label>3</label>
    <title>Yeast Data Analysis</title>
    <sec sec-type="methods">
      <label>3.1</label>
      <title>Data</title>
      <p>We illustrate the proposed approach with an RNA-Seq data set from Ingolia et al.<xref ref-type="bibr" rid="b25-cin-10-2011-205">25</xref> Specifically, mRNA were extracted from yeast, Saccharomyces cerevisiae strain BY4741, in rich growth medium (YEPD medium) and poor growth medium (amino acid starvation). The goal of the experiment was to identify genes that are differentially expressed between these two biologic conditions. The sequences of short reads were produced using an Illumina Genome Analyzer II. The short reads were mapped using the SOAP method Li et al.<xref ref-type="bibr" rid="b26-cin-10-2011-205">26</xref> The data set consists of counts under two different conditions for 1,285 genes.</p>
      <p>We considered <italic>I</italic> = 1,089 genes having <italic>J<sub>i</sub></italic> ≥ 5 positions for analysis and discarded the remaining 196 for lack of information. The read counts of those 1,089 genes, under the two growth conditions, 
<inline-formula><mml:math id="M13"><mml:mrow><mml:msubsup><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>J</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:msubsup><mml:mo>⋅</mml:mo><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> and 
<inline-formula><mml:math id="M14"><mml:mrow><mml:msubsup><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>J</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:msubsup><mml:mo>⋅</mml:mo><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> range from 1 to 9,334 and from 0 to 14,150, respectively. <xref ref-type="fig" rid="f2-cin-10-2011-205">Figure 2</xref> shows histograms of <italic>J<sub>i</sub></italic> (panel a) and 
<inline-formula><mml:math id="M15"><mml:mrow><mml:msubsup><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>J</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:msubsup><mml:mo>⋅</mml:mo><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> (panel b) on a logarithm scale (with base 10). Overall, genes have many positions with non-zero counts, and reads per position are small.</p>
    </sec>
    <sec>
      <label>3.2</label>
      <title>Markov chain Monte Carlo simulations</title>
      <p>We estimated and fixed <italic>η<sub>i</sub></italic> as follows. First, we find <italic>α̂<sub>i</sub></italic> and <italic>β̂<sub>i</sub></italic> such that and <italic>α̂<sub>i</sub></italic>/(<italic>α̂<sub>i</sub></italic> + <italic>β̂<sub>i</sub></italic>) = <italic>r<sub>i</sub></italic> and <italic>α̂<sub>i</sub></italic><italic>β̂<sub>i</sub></italic>/(<italic>α̂<sub>i</sub></italic> + <italic>β̂<sub>i</sub></italic>)<sup>2</sup>/(<italic>α̂<sub>i</sub></italic> + <italic>β̂<sub>i</sub></italic> + 1) = var(<italic>r<sub>ij</sub></italic>), the sample variance of the <italic>r<sub>ij</sub></italic>. We fix <italic>η<sub>i</sub></italic> = log (<italic>α̂<sub>i</sub></italic> + <italic>β̂<sub>i</sub></italic>). We expect that about 5% of all genes are differentially expressed and that about 5% of all positions are outliers. We therefore set (<italic>a<sub>w</sub></italic>, <italic>b<sub>w</sub></italic>) = (19, 1), (<italic>a</italic><sub>−1</sub>, <italic>a</italic><sub>0</sub>, <italic>a</italic><sub>1</sub>) = (1, 38, 1), 
<inline-formula><mml:math id="M16"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>δ</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>δ</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>5</mml:mn><mml:mo>,</mml:mo><mml:mn>0.11</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, 
<inline-formula><mml:math id="M17"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mn>1</mml:mn><mml:mi>δ</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mn>1</mml:mn><mml:mi>δ</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>5</mml:mn><mml:mo>,</mml:mo><mml:mn>0.12</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, and (<italic>a<sub>s</sub></italic>, <italic>b<sub>s</sub></italic>) = (3, 0.09). We implemented posterior inference using Markov chain Monte Carlo (MCMC) posterior simulations for the proposed model. The implementation is a standard Gibbs sampling algorithm using Metropolis-Hastings transition probabilities with random walk proposals when the complete conditional posterior distribution is not available for efficient random variate generation. We ran the MCMC simulation by iterating over all complete conditionals for 4,500 iterations, discarding the first 500 iterations as burn-in.</p>
    </sec>
    <sec sec-type="results">
      <label>3.3</label>
      <title>Results</title>
      <p><xref ref-type="fig" rid="f3-cin-10-2011-205">Figure 3(a)</xref> plots the posterior probabilities of differential expression, <italic>p̂<sub>i</sub></italic> = Pr(λ<sub>I</sub> ≠ 0 | data). Some genes report very large posterior probabilities <italic>p̂<sub>i</sub></italic>. <xref ref-type="fig" rid="f3-cin-10-2011-205">Figure 3(b)</xref> plots the posterior means <italic>ξ̂<sub>i</sub></italic> = E(<italic>ξ<sub>i</sub></italic>|data). The three dashed horizontal lines mark the posterior means of (<italic>ξ̄ + δ</italic><sub>1</sub>)<italic>, ξ̄,</italic> and (<italic>ξ̄ − δ<sub>−</sub></italic><sub>1</sub>), respectively. The genes close to or outside the boundary of the lower and upper dashed lines are reported as differentially expressed.</p>
      <p><xref ref-type="fig" rid="f4-cin-10-2011-205">Figure 4a</xref> plots the marginal posterior probabilities <italic>p̂<sub>i</sub></italic> against the empirical estimate <italic>r<sub>i</sub></italic> of relative expression. The plot illustrates that <italic>p̂<sub>i</sub></italic> agrees with the ad-hoc estimates <italic>r<sub>i</sub></italic> for most genes. But there are some genes where <italic>p̂<sub>i</sub></italic> disagrees with (we would argue, improves upon) ad-hoc inference with <italic>r<sub>i</sub></italic>. In the next two figures we explore possible reasons for this. <xref ref-type="fig" rid="f5-cin-10-2011-205">Figures 5</xref> and <xref ref-type="fig" rid="f6-cin-10-2011-205">6</xref> present summaries for some selected genes to illustrate agreement and disagreement of <italic>r<sub>i</sub></italic> and <italic>p̂<sub>i</sub></italic>. In both figures, the plots in the first column show <italic>N<sub>ij</sub></italic> (circle) and <italic>n<sub>ij</sub></italic> (cross) along positions. The second column plots <italic>r<sub>ij</sub></italic> along positions. The dashed line indicates the posterior mean <italic>ξ̂<sub>i</sub></italic>, and the dotted line shows the empirical estimate <italic>r<sub>i</sub></italic>. The line for <italic>ξ̂<sub>i</sub></italic> is plotted at logit <sup>−1</sup><italic>ξ̂<sub>i</sub></italic> to map to the unit scale. The third column plots the posterior probability <italic>ŵ<sub>ij</sub></italic> = Pr(<italic>w<sub>ij</sub></italic> = 1 | data) along positions.</p>
      <p>Comparison of the two figures explains the observed discrepancies in <italic>r<sub>i</sub></italic> and <italic>p̂<sub>i</sub></italic>. The large <italic>r<sub>i</sub></italic> in <xref ref-type="fig" rid="f6-cin-10-2011-205">Figure 6</xref> are due to outliers in <italic>r<sub>ij</sub></italic>, including some positions with small total read counts <italic>N<sub>ij</sub></italic>. In contrast, under the posterior inference, many of the <italic>ŵ<sub>ij</sub></italic> are imputed with relatively smaller values, leading to a downweighting of the corresponding <italic>r<sub>ij</sub></italic> in the inference for the gene-specific indicators λ<italic><sub>i</sub></italic> for differential expression, and thus for <italic>p̂<sub>i</sub></italic>. Except for these few outliers, most <italic>r<sub>ij</sub></italic>’s are aligned around a value close to 0.5, indicating nondifferential expression. In other words, while <italic>r<sub>i</sub></italic> is very sensitive to outliers, the model-based estimate down-weights outliers, as desired.</p>
      <p>The computation of posterior probabilities <italic>p̂<sub>i</sub></italic> = Pr(λ<italic><sub>i</sub></italic> ≠ 0 | data) is only half the desired inference. We still need to decide which genes should be reported as differentially expressed. We use a decision rule based on flagging genes with <italic>p̂<sub>i</sub></italic> &gt; κ for some threshold κ. We fix the threshold κ by setting a bound on the false discovery rate (FDR).<xref ref-type="bibr" rid="b27-cin-10-2011-205">27</xref> <xref ref-type="fig" rid="f4-cin-10-2011-205">Figure 4b</xref> summarizes the FDR implied by decision rules of reporting the genes with highest probability of differential expression. For 
<inline-formula><mml:math id="M18"><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>F</mml:mi><mml:mi>D</mml:mi><mml:mi>R</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula> ≤ 0.10 the rule reports 46 differentially expressed genes. The rule corresponds to a threshold κ = 0.618.</p>
    </sec>
  </sec>
  <sec>
    <label>4</label>
    <title>Simulation</title>
    <p>We carry out a simulation study to further examine the proposed model. The study investigates the performance of our method in the case where genes have many positions with nonzero counts. In the study, we assume small within-gene variabilities in the read counts and large across-gene variabilities. We achieve this by centering <italic>η<sub>i</sub></italic> around a small value and allowing a relative large variance for ξ<italic><sub>i</sub></italic> in our model.</p>
    <p>Since the primary goal is inference on ξ<italic><sub>i</sub></italic>, we fix <italic>η<sub>i</sub></italic> at their simulation truth. We place priors on the remaining parameters, 
<inline-formula><mml:math id="M19"><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mover accent="true"><mml:mi>ξ</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mo>,</mml:mo><mml:mi> </mml:mi><mml:mi> </mml:mi><mml:msubsup><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mi>ξ</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>,</mml:mo><mml:mi> </mml:mi><mml:mi> </mml:mi><mml:msup><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mi>w</mml:mi></mml:msup><mml:mo>,</mml:mo><mml:mi> </mml:mi><mml:mi> </mml:mi><mml:msup><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mi>λ</mml:mi></mml:msup><mml:mo>,</mml:mo><mml:mi> </mml:mi><mml:mi> </mml:mi><mml:msub><mml:mrow><mml:mi>δ</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi> </mml:mi><mml:mi> </mml:mi><mml:msub><mml:mrow><mml:mi>δ</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> as described in Section 2.</p>
    <p>We compare model-based estimates with the simulation truth, and compare the inference under the proposed model to that under two methods: (1) the Analysis of Sequence Counts (ASC) proposed by Wu et al<xref ref-type="bibr" rid="b18-cin-10-2011-205">18</xref> and (2) the MA-plot-based method with random sampling model (DEGseq) proposed in Wang et al.<xref ref-type="bibr" rid="b1-cin-10-2011-205">1</xref></p>
    <p>In the ASC, Wu et al model the aggregate read count for each gene under each condition as a binomial random variate, given the total read count summing over all the genes at each condition. The expected proportions in the binomial are compared between the two conditions for each gene. They use <italic>δ</italic> to denote the difference between the logarithms of the proportions and λ as the sum of the two log proportions. They propose unimodal prior distributions for <italic>δ</italic> and λ and compute the posterior probability P(|<italic>δ<sub>i</sub></italic>| &gt; Δ<sub>0</sub>|data), where <italic>δ<sub>i</sub></italic> is log fold change in gene expression of gene <italic>i</italic>, and Δ<sub>0</sub> is a pre-defined threshold for biological significance. In DEGseq, Wang et al. define <italic>M<sub>i</sub></italic> = log<sub>2</sub>(<italic>C</italic><sub>0i</sub>) − log<sub>2</sub>(<italic>C</italic><sub>1</sub><italic><sub>i</sub></italic>) and <italic>A<sub>i</sub></italic> = (log<sub>2</sub>(<italic>C</italic><sub>0</sub><italic><sub>i</sub></italic>) + log<sub>2</sub>(<italic>C</italic><sub>1</sub><italic><sub>i</sub></italic>))/2 where 
<inline-formula><mml:math id="M20"><mml:mrow><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>J</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> <italic>n<sub>ij</sub></italic> and 
<inline-formula><mml:math id="M21"><mml:mrow><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>J</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> <italic>m<sub>ij</sub></italic>. They assume that given <italic>A<sub>i</sub></italic> = <italic>a</italic>, <italic>M<sub>i</sub></italic> approximately follows a normal distribution with mean and variance,
<disp-formula><mml:math id="M22"><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:mi>E</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>a</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mtext>log</mml:mtext></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mn>0</mml:mn></mml:msub><mml:mo>.</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mtext>log</mml:mtext></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>.</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mtext>Var</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>a</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mn>4</mml:mn><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msqrt><mml:mrow><mml:msup><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mi>a</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="true">/</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mn>0</mml:mn></mml:msub><mml:mo>.</mml:mo><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>.</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msqrt><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mtext>log</mml:mtext></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mi>e</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi> </mml:mi><mml:mi> </mml:mi><mml:mi> </mml:mi><mml:mi> </mml:mi><mml:mi> </mml:mi><mml:mi> </mml:mi><mml:mi> </mml:mi><mml:mi> </mml:mi><mml:mi> </mml:mi><mml:mi> </mml:mi><mml:mi> </mml:mi><mml:mi> </mml:mi><mml:mi> </mml:mi><mml:mi> </mml:mi><mml:mi> </mml:mi><mml:mi> </mml:mi><mml:mi> </mml:mi><mml:mi> </mml:mi><mml:mi> </mml:mi><mml:mi> </mml:mi><mml:mi> </mml:mi><mml:mi> </mml:mi><mml:mi> </mml:mi><mml:mi> </mml:mi><mml:mi> </mml:mi><mml:mi> </mml:mi><mml:mi> </mml:mi><mml:mi> </mml:mi><mml:mi> </mml:mi><mml:mi> </mml:mi><mml:mi> </mml:mi><mml:mi> </mml:mi><mml:mi> </mml:mi><mml:mi> </mml:mi><mml:mi> </mml:mi><mml:mi> </mml:mi><mml:mi> </mml:mi><mml:mi> </mml:mi><mml:mi> </mml:mi><mml:mi> </mml:mi><mml:mi> </mml:mi><mml:mi> </mml:mi><mml:mi> </mml:mi><mml:mrow><mml:mrow/><mml:mo>/</mml:mo><mml:mrow><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mn>0</mml:mn></mml:msub><mml:mo>.</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>.</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:msqrt><mml:mrow><mml:msup><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mi>a</mml:mi></mml:mrow></mml:msup><mml:mo>/</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mn>0</mml:mn></mml:msub><mml:mo>.</mml:mo><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>.</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msqrt></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula>where 
<inline-formula><mml:math id="M23"><mml:mrow><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>κ</mml:mi><mml:mo>.</mml:mo></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>I</mml:mi></mml:msubsup><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>κ</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> for <italic>κ</italic> = 0, 1. Inference on differential gene expression is then formalized with a z-test. For this simulation study, a normalization for DEGseq and ASC is not necessary for this study since <italic>ξ̄</italic> is set at 0.</p>
    <p>We simulate a sample of <italic>I</italic> = 1,200 genes. For half of the genes we assumed <italic>J<sub>i</sub></italic> = 300 recorded positions per gene, and for the other half we use <italic>J<sub>i</sub></italic> = 100. We let λ<italic><sub>i</sub></italic> = −1 or 1 for 150 genes and λ<italic><sub>i</sub></italic> = 0 for the remaining 450 genes. Given λ<italic><sub>i</sub></italic>, we generate 
<inline-formula><mml:math id="M24"><mml:mrow><mml:msub><mml:mrow><mml:mi>η</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>∼</mml:mo><mml:mi>N</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mover accent="true"><mml:mi>η</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mi>η</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> and 
<inline-formula><mml:math id="M25"><mml:mrow><mml:msub><mml:mrow><mml:mi>ξ</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>∼</mml:mo><mml:mi>N</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mover accent="true"><mml:mi>ξ</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:msub><mml:mrow><mml:mi>δ</mml:mi></mml:mrow><mml:mrow><mml:mi>λ</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mi>ξ</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, with 
<inline-formula><mml:math id="M26"><mml:mrow><mml:mover accent="true"><mml:mi>η</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mi> </mml:mi><mml:mi> </mml:mi><mml:msubsup><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mi>η</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:math></inline-formula> = 0.25<sup>2</sup>, <italic>ξ̄</italic> = 0, 
<inline-formula><mml:math id="M27"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mi>ξ</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:math></inline-formula> = 0.1, and <italic>δ</italic><sub>−1</sub> = <italic>δ</italic><sub>1</sub> = 1. We let <italic>w<sub>ij</sub></italic> = 0 or 1 independently with probabilities 0.05 and 0.95, respectively. Conditional on <italic>w<sub>ij</sub></italic> = 0 or 1, we respectively generate <italic>p<sub>ij</sub></italic> from either a Be(α<italic><sub>I</sub></italic>, <italic>β<sub>i</sub></italic>) or Be(1/2, 1/2) prior, where α<italic><sub>i</sub></italic> = exp(<italic>η<sub>i</sub></italic>) exp(<italic>ξ<sub>i</sub></italic>)/(1 + exp(<italic>ξ<sub>i</sub></italic>)) and <italic>β<sub>i</sub></italic> = exp(<italic>η<sub>i</sub></italic>) = (1 + exp(<italic>ξ<sub>i</sub></italic>)). Finally, we generate <italic>N<sub>ij</sub></italic> ∼ Ga(1.5, 1/1.5) (rounded up to the nearest integer), and <italic>n<sub>ij</sub></italic> ∼ Bin(<italic>N<sub>ij</sub></italic>, <italic>p<sub>ij</sub></italic>), independently. We then proceed to estimate <italic>ξ<sub>i</sub></italic> and P(λ<italic><sub>I</sub></italic> ≠ 0 | data) conditional on <italic>N<sub>ij</sub></italic> and <italic>n<sub>ij</sub></italic> under the proposed model.</p>
    <p>The receiver operating characteristic (ROC) curve is commonly used to select an optimal method for classification problems. We assume a decision rule that reports genes with posterior probabilities, <italic>p</italic>(λ<italic><sub>i</sub></italic> ≠ 0 | data) and P(|<italic>δ<sub>i</sub></italic>| &gt; <italic>δ</italic><sub>0</sub>| data) (in the cases of the proposed approach and ASC) or <italic>P</italic>-value (in the case of DEGseq) beyond a threshold where we set <italic>δ</italic><sub>0</sub> = 1.8. The ROC curve plots true positive rate against the false positive rate as a parametric curve indexed by the threshold. <xref ref-type="fig" rid="f7-cin-10-2011-205">Figure 7</xref> shows the three ROC curves. The ROC curve for the proposed method compares favorably against the alternatives. It demonstrates the limitations of ASC. We believe that this is due to the strong assumptions on the shape of the priors of <italic>δ</italic> and λ. The simulation truth is that the mean expression of the genes is generated from a mixture of three distributions, which does not agree with the unimodal assumptions of the ASC model.</p>
    <p>Regarding the performance of DEGseq, we note that longer genes tend to have larger aggregate counts across positions. Therefore, DEGseq is more likely to declare long genes with small effects as differentially expressed genes since its estimated standard deviation inherently depends on the mean counts. Specifically, we observe that DEGseq tends to produce smaller <italic>p</italic>-values for nondifferentially expressed genes with <italic>J<sub>i</sub></italic> = 300 than those with <italic>J<sub>i</sub></italic> = 100 due to the gene-length bias (see <xref ref-type="fig" rid="f8-cin-10-2011-205">Fig. 8a</xref>). On the other hand, the proposed model accounts for position-specific variability while more information on relative gene expression gets accumulated as the number of positions within a gene increases (see <xref ref-type="fig" rid="f8-cin-10-2011-205">Fig. 8b</xref>). Therefore, the proposed method tends to produce smaller posterior probability of differential expression for non-differentially expressed genes with <italic>J<sub>i</sub></italic> = 300 than those with <italic>J<sub>i</sub></italic> = 100. This, coupled with vague position-specific information leads to superior performance of the proposed method for longer genes. This conveys significant implication on statistical inference of differential expression using RNA-Seq data. Since RNA-Seq experiments produce many non-zero count positions within a gene, and many reads per position, the RNA-Seq data enables us to model variability among expression levels on positions within the same gene, and the incorporation of it into a model improves the resulting inference.</p>
    <p>We note that if both <italic>N<sub>ij</sub></italic> and <italic>J<sub>i</sub></italic> are small, modeling the position-level read counts does not significantly improve inference. Also, if there is little variation across position-level counts, then the loss of information under aggregation remains negligible. We found that for cases where short reads are mapped to small number of positions, DEGseq performs well (results not shown). However, such situations are untypical for large-scale RNA-Seq experiments with usually very noisy data.</p>
  </sec>
  <sec>
    <label>5</label>
    <title>Discussion</title>
    <p>We proposed a Bayesian model-based approach for inference with RNA-Seq data. We introduced a hierarchical structure to model the position-level count data. We demonstrate through a simulation study and the analysis of a yeast experiment that the model effectively downweights outlying observations at the position level and obtains more robust estimates of gene expression.</p>
    <p>The model provides a promising framework for further development of statistical models for RNA-Seq data. One possible extension is to relax the parametric assumption for <italic>ξ<sub>i</sub></italic>. By removing the restriction to a specific parametric family of distributions, one could further robustify inference about gene expression levels. Another important extension is to incorporate dependence across genes. In the current model we assumed that <italic>ξ<sub>i</sub></italic> are independently and identically distributed. One may achieve more precise estimates and formal inference about dependence structure by generalizing the model to allow for dependence of <italic>ξ<sub>i</sub></italic> across genes. One could build on available prior information to construct informative priors for dependence at the level of the indicators λ<italic><sub>i</sub></italic>. For model with indicators at the gene level similar to λ<italic><sub>i</sub></italic> used in our model this is carried out in.<xref ref-type="bibr" rid="b29-cin-10-2011-205">29</xref> The binary nature of λ<italic><sub>i</sub></italic> greatly simplifies general modeling of dependence structure. For a recent discussion of models for dependent gene expression see, for example, Stingo et al<xref ref-type="bibr" rid="b30-cin-10-2011-205">30</xref> or Jones et al,<xref ref-type="bibr" rid="b31-cin-10-2011-205">31</xref> and references therein. Both references use a model-based Bayesian approach as in this paper.</p>
    <p>Finally, while the model was specifically developed for experiments comparing two conditions without biologic replicates, simple modification would allow the use for experiments with replicates or experiments with multiple conditions. The proposed model can be extended for experiments with replicates by replacing the binomial sampling model for <italic>n<sub>ij</sub></italic> by a model for counts across replicates. For experiments with multiple conditions, one may consider a multinomial likelihood with a Dirichlet prior.</p>
  </sec>
</body>
<back>
  <ack>
    <p>Yuan Ji and Peter Müller’s research is partially supported by NIH R01 CA132897. Shoudan Liang’s research is supported by NIH K25 CA123344.</p>
  </ack>
  <fn-group>
    <fn>
      <p>
        <bold>Disclosure</bold>
      </p>
      <p>This manuscript has been read and approved by all authors. This paper is unique and is not under consideration by any other publication and has not been published elsewhere. The authors and peer reviewers of this paper report no conflicts of interest. The authors confirm that they have permission to reproduce any copyrighted material.</p>
    </fn>
  </fn-group>
  <ref-list>
    <title>References</title>
    <ref id="b1-cin-10-2011-205">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Gerstein</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Snyder</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>RNA-Seq: a revolutionary tool for transcriptomics</article-title>
        <source>Nature Reviews Genetics</source>
        <year>2009b</year>
        <volume>10</volume>
        <fpage>57</fpage>
        <lpage>63</lpage>
      </element-citation>
    </ref>
    <ref id="b2-cin-10-2011-205">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Jiang</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Wong</surname>
            <given-names>WH</given-names>
          </name>
        </person-group>
        <article-title>Modeling non-uniformity in short-read rates in RNA-Seq data</article-title>
        <source>Genome Biology</source>
        <year>2010b</year>
        <volume>11</volume>
      </element-citation>
    </ref>
    <ref id="b3-cin-10-2011-205">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hoen</surname>
            <given-names>PAC</given-names>
          </name>
          <name>
            <surname>Ariyurek</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Thygesen</surname>
            <given-names>HH</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Deep sequencing-based expression analysis shows major advances in robustness, resolution and inter-lab portability over five microarray platforms</article-title>
        <source>Nucleic Acids Research</source>
        <year>2008</year>
        <volume>36</volume>
        <fpage>e141</fpage>
        <pub-id pub-id-type="pmid">18927111</pub-id>
      </element-citation>
    </ref>
    <ref id="b4-cin-10-2011-205">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Oshlack</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Robinson</surname>
            <given-names>MD</given-names>
          </name>
          <name>
            <surname>Young</surname>
            <given-names>MD</given-names>
          </name>
        </person-group>
        <article-title>From RNA-seq reads to differential expression results</article-title>
        <source>Genome Biology</source>
        <year>2010</year>
        <volume>11</volume>
        <fpage>12</fpage>
      </element-citation>
    </ref>
    <ref id="b5-cin-10-2011-205">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ji</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>XS</given-names>
          </name>
        </person-group>
        <article-title>Analyzing’ omics data using hierarchical models</article-title>
        <source>Nature Biotechnology</source>
        <year>2010</year>
      </element-citation>
    </ref>
    <ref id="b6-cin-10-2011-205">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Auer</surname>
            <given-names>PL</given-names>
          </name>
          <name>
            <surname>Doerge</surname>
            <given-names>RW</given-names>
          </name>
        </person-group>
        <article-title>Statistical design and analysis of RNA sequencing data</article-title>
        <source>The Genetics Society of America</source>
        <year>2010</year>
        <volume>185</volume>
        <fpage>405</fpage>
        <lpage>16</lpage>
      </element-citation>
    </ref>
    <ref id="b7-cin-10-2011-205">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mortazavi</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Williams</surname>
            <given-names>BA</given-names>
          </name>
          <name>
            <surname>McCue</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Schaefier</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Wold</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <article-title>Mapping and quantifying mammalian transcriptomes by RNA-Seq</article-title>
        <source>Nature Methods</source>
        <year>2008</year>
        <volume>5</volume>
        <fpage>621</fpage>
        <lpage>8</lpage>
        <pub-id pub-id-type="pmid">18516045</pub-id>
      </element-citation>
    </ref>
    <ref id="b8-cin-10-2011-205">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Robinson</surname>
            <given-names>MD</given-names>
          </name>
          <name>
            <surname>Oshlack</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>A scaling normalization method for differential expression analysis of RNA-seq data</article-title>
        <source>Genome Biology</source>
        <year>2010</year>
        <volume>11</volume>
        <fpage>3</fpage>
      </element-citation>
    </ref>
    <ref id="b9-cin-10-2011-205">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Balwierz</surname>
            <given-names>PJ</given-names>
          </name>
          <name>
            <surname>Carninci</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Daub</surname>
            <given-names>CO</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Methods for analyzing deep sequencing expression data: constructing the human and mouse promoterome with deepCAGE data</article-title>
        <source>Genome Biology</source>
        <year>2009</year>
        <volume>10</volume>
        <fpage>7</fpage>
      </element-citation>
    </ref>
    <ref id="b10-cin-10-2011-205">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Marioni</surname>
            <given-names>JC</given-names>
          </name>
          <name>
            <surname>Mason</surname>
            <given-names>CE</given-names>
          </name>
          <name>
            <surname>Mane</surname>
            <given-names>SM</given-names>
          </name>
          <name>
            <surname>Stephens</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Gilad</surname>
            <given-names>Y</given-names>
          </name>
        </person-group>
        <article-title>RNA-seq: an assessment of technical reproducibility and comparison with gene expression arrays</article-title>
        <source>Genome Research</source>
        <year>2008</year>
        <volume>18</volume>
        <fpage>1509</fpage>
        <lpage>17</lpage>
        <pub-id pub-id-type="pmid">18550803</pub-id>
      </element-citation>
    </ref>
    <ref id="b11-cin-10-2011-205">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Robinson</surname>
            <given-names>MD</given-names>
          </name>
          <name>
            <surname>Smyth</surname>
            <given-names>GK</given-names>
          </name>
        </person-group>
        <article-title>Moderated statistical tests for assessing differences in tag abundance</article-title>
        <source>Bioinformatics</source>
        <year>2007</year>
        <volume>23</volume>
        <issue>21</issue>
        <fpage>2881</fpage>
        <lpage>7</lpage>
        <pub-id pub-id-type="pmid">17881408</pub-id>
      </element-citation>
    </ref>
    <ref id="b12-cin-10-2011-205">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Robinson</surname>
            <given-names>MD</given-names>
          </name>
          <name>
            <surname>McCarthy</surname>
            <given-names>DJ</given-names>
          </name>
          <name>
            <surname>Smyth</surname>
            <given-names>GK</given-names>
          </name>
        </person-group>
        <article-title>edgeR: a Bioconductor package for differential expression analysis of digital gene expression data</article-title>
        <source>Bioinformatics</source>
        <year>2010</year>
        <volume>26</volume>
        <issue>1</issue>
        <fpage>139</fpage>
        <lpage>40</lpage>
        <pub-id pub-id-type="pmid">19910308</pub-id>
      </element-citation>
    </ref>
    <ref id="b13-cin-10-2011-205">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bullard</surname>
            <given-names>JH</given-names>
          </name>
          <name>
            <surname>Purdom</surname>
            <given-names>EHKD</given-names>
          </name>
          <name>
            <surname>Dudoit</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Evaluation of statistical methods for normalization and differential expression in mRNA-Seq experiments</article-title>
        <source>BMC Bioinformatics</source>
        <year>2010</year>
        <volume>11</volume>
      </element-citation>
    </ref>
    <ref id="b14-cin-10-2011-205">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Oshlack</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Wakefield</surname>
            <given-names>MJ</given-names>
          </name>
        </person-group>
        <article-title>Transcript length bias in RNA-seq data confounds systems biology</article-title>
        <source>Biology Direct</source>
        <year>2010</year>
        <volume>4</volume>
      </element-citation>
    </ref>
    <ref id="b15-cin-10-2011-205">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Young</surname>
            <given-names>MD</given-names>
          </name>
          <name>
            <surname>Wakefieldand</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>Smyth</surname>
            <given-names>GK</given-names>
          </name>
          <name>
            <surname>Oshlack</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Gene ontology analysis for RNA-seq: accounting for selection bias</article-title>
        <source>Genome Biology</source>
        <year>2010</year>
        <volume>11</volume>
        <fpage>2</fpage>
      </element-citation>
    </ref>
    <ref id="b16-cin-10-2011-205">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Anders</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Huber</surname>
            <given-names>W</given-names>
          </name>
        </person-group>
        <article-title>Differential expression analysis for sequence count data</article-title>
        <source>Genome Biology</source>
        <year>2010</year>
        <volume>11</volume>
        <fpage>10</fpage>
      </element-citation>
    </ref>
    <ref id="b17-cin-10-2011-205">
      <label>17.</label>
      <element-citation publication-type="other">
        <person-group person-group-type="author">
          <name>
            <surname>Taub</surname>
            <given-names>MA</given-names>
          </name>
        </person-group>
        <article-title>Analysis of high-throughput biological data: some statistical problems in RNA-seq and mouse genotyping</article-title>
        <comment>Ph.D. thesis. <italic>Department of Statistics</italic>, UC Berkeley.</comment>
        <year>2009</year>
      </element-citation>
    </ref>
    <ref id="b18-cin-10-2011-205">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wu</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Jenkins</surname>
            <given-names>BD</given-names>
          </name>
          <name>
            <surname>Rynearson</surname>
            <given-names>TA</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Empirical bayes analysis of sequencing-based transcriptional profiling without replicates</article-title>
        <source>BMC Bioinformatics</source>
        <year>2010</year>
        <volume>11</volume>
      </element-citation>
    </ref>
    <ref id="b19-cin-10-2011-205">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jian</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Wong</surname>
            <given-names>WH</given-names>
          </name>
        </person-group>
        <article-title>Statistical inferences for isoform expression in RNA-Seq</article-title>
        <source>Bioinformatics</source>
        <year>2009</year>
        <volume>25</volume>
        <fpage>1026</fpage>
        <lpage>32</lpage>
        <pub-id pub-id-type="pmid">19244387</pub-id>
      </element-citation>
    </ref>
    <ref id="b20-cin-10-2011-205">
      <label>20.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Salzman</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Jiang</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Wong</surname>
            <given-names>WH</given-names>
          </name>
        </person-group>
        <article-title>Statistical modeling of RNA-Seq data. Tech. rep.</article-title>
        <source>Division of Statistics</source>
        <publisher-name>Stanford University</publisher-name>
        <year>2010</year>
      </element-citation>
    </ref>
    <ref id="b21-cin-10-2011-205">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Ruotti</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Stewart</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Thomson</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Dewey</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>RNA-Seq gene expression estimation with read mapping uncertainty</article-title>
        <source>Bioinformatics</source>
        <year>2010a</year>
        <volume>26</volume>
        <fpage>493</fpage>
        <lpage>500</lpage>
        <pub-id pub-id-type="pmid">20022975</pub-id>
      </element-citation>
    </ref>
    <ref id="b22-cin-10-2011-205">
      <label>22.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Langmead</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Trapnell</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Pop</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Salzberg</surname>
            <given-names>SL</given-names>
          </name>
        </person-group>
        <article-title>Ultrafast and memory-eficient alignment of short DNA sequences to the human genome</article-title>
        <source>Genome Biology</source>
        <year>2009</year>
        <volume>10</volume>
        <fpage>R25</fpage>
        <pub-id pub-id-type="pmid">19261174</pub-id>
      </element-citation>
    </ref>
    <ref id="b23-cin-10-2011-205">
      <label>23.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ji</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Coombes</surname>
            <given-names>K</given-names>
          </name>
        </person-group>
        <article-title>Applications of beta-mixture models in bioinformatics</article-title>
        <source>Bioinformatics</source>
        <year>2005</year>
        <volume>21</volume>
        <issue>9</issue>
        <fpage>2118</fpage>
        <lpage>22</lpage>
        <pub-id pub-id-type="pmid">15713737</pub-id>
      </element-citation>
    </ref>
    <ref id="b24-cin-10-2011-205">
      <label>24.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Robert</surname>
            <given-names>CP</given-names>
          </name>
          <name>
            <surname>Rousseau</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>A Mixture Approach to Bayesian Goodness of Fit</article-title>
        <source>Les cahiers du CEREMADE</source>
        <comment>(2002–9).</comment>
        <year>2004</year>
      </element-citation>
    </ref>
    <ref id="b25-cin-10-2011-205">
      <label>25.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ingolia</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Ghaemmaghami</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Newman</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Weissman</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Genome-wide analysis in vivo of translation with nucleotide resolution using ribosome profiling</article-title>
        <source>Science</source>
        <year>2009</year>
        <volume>324</volume>
        <issue>5924</issue>
        <fpage>218</fpage>
        <lpage>23</lpage>
        <pub-id pub-id-type="pmid">19213877</pub-id>
      </element-citation>
    </ref>
    <ref id="b26-cin-10-2011-205">
      <label>26.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Kristiansen</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>SOAP: short oligonucleotide alignment program</article-title>
        <source>Bioinformatics</source>
        <year>2008</year>
      </element-citation>
    </ref>
    <ref id="b27-cin-10-2011-205">
      <label>27.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Newton</surname>
            <given-names>MA</given-names>
          </name>
          <name>
            <surname>Noueiry</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Sarkar</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Ahlquist</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>detecting differential gene expression with a semiparametric hierarchical mixture method</article-title>
        <source>Biostatistics</source>
        <year>2004</year>
        <volume>5</volume>
        <fpage>155</fpage>
        <lpage>76</lpage>
        <pub-id pub-id-type="pmid">15054023</pub-id>
      </element-citation>
    </ref>
    <ref id="b28-cin-10-2011-205">
      <label>28.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Feng</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>X</given-names>
          </name>
        </person-group>
        <article-title>DEGseq: an R package for identifying differentially expressed genes from RNA-seq data</article-title>
        <source>Bioinformatics</source>
        <year>2009a</year>
        <volume>26</volume>
        <issue>1</issue>
        <fpage>136</fpage>
        <lpage>8</lpage>
        <pub-id pub-id-type="pmid">19855105</pub-id>
      </element-citation>
    </ref>
    <ref id="b29-cin-10-2011-205">
      <label>29.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Telesca</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Müller</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Parmigiani</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Freedman</surname>
            <given-names>RS</given-names>
          </name>
        </person-group>
        <article-title>Modeling dependent gene expression. Tech. rep.</article-title>
        <publisher-name>Harvard University</publisher-name>
        <year>2010</year>
      </element-citation>
    </ref>
    <ref id="b30-cin-10-2011-205">
      <label>30.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Stingo</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Tadesse</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Vannucci</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Incorporating biological information into linear models: a bayesian approach to the selection of pathways and genes</article-title>
        <source>Annals of Applied Statistics</source>
        <year>2011</year>
      </element-citation>
    </ref>
    <ref id="b31-cin-10-2011-205">
      <label>31.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jones</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Carvalho</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Dobra</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Hans</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Carter</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>West</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Experiments in stochastic computation for high-dimensional graphical models</article-title>
        <source>Statistical Science</source>
        <year>2004</year>
        <volume>20</volume>
        <fpage>388</fpage>
        <lpage>400</lpage>
      </element-citation>
    </ref>
  </ref-list>
</back>
<floats-group>
  <fig id="f1-cin-10-2011-205" position="float">
    <label>Figure 1.</label>
    <caption>
      <p>Hierarchical model for RNA-Seq data.</p>
    </caption>
    <graphic xlink:href="cin-10-2011-205f1"/>
  </fig>
  <fig id="f2-cin-10-2011-205" position="float">
    <label>Figure 2.</label>
    <caption>
      <p>Histogram of the number of non-zero count positions (<italic>J<sub>i</sub></italic>, <italic>i</italic> = 1, …, <italic>I</italic>) (panel a) and total counts over the two conditions, 
<inline-formula><mml:math id="M28"><mml:mrow><mml:msubsup><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>J</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> <italic>N<sub>ij</sub></italic> (panel b), <italic>i</italic> = 1, …, <italic>I</italic>, on the logarithm scale with base 10.</p>
    </caption>
    <graphic xlink:href="cin-10-2011-205f2"/>
  </fig>
  <fig id="f3-cin-10-2011-205" position="float">
    <label>Figure 3.</label>
    <caption>
      <p>Posterior probability of differential expression, <italic>p̂<sub>i</sub></italic> = Pr(λ<sub>i</sub> ≠ 0 | data) (panel a) and the posterior mean of relative gene expression over the two conditions, <italic>ξ̂<sub>i</sub></italic> = <italic>E</italic> (<italic>ξ<sub>i</sub></italic> | data) (panel b).</p>
    </caption>
    <graphic xlink:href="cin-10-2011-205f3"/>
  </fig>
  <fig id="f4-cin-10-2011-205" position="float">
    <label>Figure 4.</label>
    <caption>
      <p>Posterior probabilities <italic>p̂<sub>i</sub></italic> = Pr(λ<italic><sub>i</sub></italic> ≠ 0 | data) plotted against <italic>r<sub>i</sub></italic> (panel a). The triangles and squares indicate genes for which posterior inference agrees (triangles) and disagrees (squares) with the inference based on <italic>r<sub>i</sub></italic>, respectively. They will be discussed in <xref ref-type="fig" rid="f5-cin-10-2011-205">Figures 5</xref> and <xref ref-type="fig" rid="f6-cin-10-2011-205">6</xref>. Panel (b) plots posterior expected FDR against the number <italic>D</italic> of genes reported as differentially expressed.</p>
    </caption>
    <graphic xlink:href="cin-10-2011-205f4"/>
  </fig>
  <fig id="f5-cin-10-2011-205" position="float">
    <label>Figure 5.</label>
    <caption>
      <p>Inference summaries for three genes for which inferences based on <italic>r<sub>i</sub></italic> and <italic>p̂<sub>i</sub></italic> agree. The three genes are marked as a triangle in <xref ref-type="fig" rid="f4-cin-10-2011-205">Figure 4a</xref>. The first column shows <italic>n<sub>ij</sub></italic> (crosses) and <italic>N<sub>ij</sub></italic> (circles). The second column plots <italic>r<sub>ij</sub></italic>. The dotted line indicates <italic>r<sub>i</sub></italic>. The dashed line shows the posterior mean <italic>ξ̂<sub>i</sub></italic> (plotted at logit<sup>−1</sup><italic>ξ̂<sub>i</sub></italic> to map to the unit scale). The third column plots <italic>ŵ<sub>ij</sub></italic>.</p>
    </caption>
    <graphic xlink:href="cin-10-2011-205f5"/>
  </fig>
  <fig id="f6-cin-10-2011-205" position="float">
    <label>Figure 6.</label>
    <caption>
      <p>Same as <xref ref-type="fig" rid="f5-cin-10-2011-205">Figure 5</xref> for three genes for which inference based on <italic>r<sub>i</sub></italic> and <italic>p̂<sub>i</sub></italic> disagree. The genes are marked as rectangles in <xref ref-type="fig" rid="f4-cin-10-2011-205">Figure 4a</xref>. Many of the positions are imputed to be possible outliers, and thus downweighted in the inference.</p>
    </caption>
    <graphic xlink:href="cin-10-2011-205f6"/>
  </fig>
  <fig id="f7-cin-10-2011-205" position="float">
    <label>Figure 7.</label>
    <caption>
      <p>ROC curves for identification of differential gene expression under the proposed method (black solid line), the DEGseq (red dotted line) proposed by Wang et al<xref ref-type="bibr" rid="b28-cin-10-2011-205">28</xref> and the ASC (blue dashed line) proposed by Wu et al<xref ref-type="bibr" rid="b18-cin-10-2011-205">18</xref> in the simulation study.</p>
    </caption>
    <graphic xlink:href="cin-10-2011-205f7"/>
  </fig>
  <fig id="f8-cin-10-2011-205" position="float">
    <label>Figure 8.</label>
    <caption>
      <p>Boxplots of <italic>P</italic> value under DEGseq (panel a) and <italic>p̂<sub>i</sub></italic> under the proposed method (panel b) by the number of positions within a gene, <italic>J<sub>i</sub></italic> = 100 or 300.</p>
    </caption>
    <graphic xlink:href="cin-10-2011-205f8"/>
  </fig>
</floats-group>
