<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Genome Med</journal-id>
    <journal-id journal-id-type="iso-abbrev">Genome Med</journal-id>
    <journal-title-group>
      <journal-title>Genome Medicine</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1756-994X</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10498576</article-id>
    <article-id pub-id-type="pmid">37705109</article-id>
    <article-id pub-id-type="publisher-id">1225</article-id>
    <article-id pub-id-type="doi">10.1186/s13073-023-01225-z</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>A robust deep learning workflow to predict CD8 + T-cell epitopes</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-6232-7119</contrib-id>
        <name>
          <surname>Lee</surname>
          <given-names>Chloe H.</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Huh</surname>
          <given-names>Jaesung</given-names>
        </name>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Buckley</surname>
          <given-names>Paul R.</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Jang</surname>
          <given-names>Myeongjun</given-names>
        </name>
        <xref ref-type="aff" rid="Aff4">4</xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-5759-2436</contrib-id>
        <name>
          <surname>Pinho</surname>
          <given-names>Mariana Pereira</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0001-5343-3334</contrib-id>
        <name>
          <surname>Fernandes</surname>
          <given-names>Ricardo A.</given-names>
        </name>
        <xref ref-type="aff" rid="Aff5">5</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Antanaviciute</surname>
          <given-names>Agne</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0003-3454-0710</contrib-id>
        <name>
          <surname>Simmons</surname>
          <given-names>Alison</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff6">6</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-3640-7043</contrib-id>
        <name>
          <surname>Koohy</surname>
          <given-names>Hashem</given-names>
        </name>
        <address>
          <email>hashem.koohy@rdm.ox.ac.uk</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
        <xref ref-type="aff" rid="Aff7">7</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="GRID">grid.4991.5</institution-id><institution-id institution-id-type="ISNI">0000 0004 1936 8948</institution-id><institution>MRC Human Immunology Unit, Medical Research Council (MRC) Weatherall Institute of Molecular Medicine (WIMM), John Radcliffe Hospital, </institution><institution>University of Oxford, </institution></institution-wrap>Oxford, OX3 9DS UK </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="GRID">grid.4991.5</institution-id><institution-id institution-id-type="ISNI">0000 0004 1936 8948</institution-id><institution>MRC WIMM Centre for Computational Biology, MRC Weatherall Institute of Molecular Medicine, John Radcliffe Hospital, </institution><institution>University of Oxford, </institution></institution-wrap>Oxford, OX3 9DS UK </aff>
      <aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/052gg0110</institution-id><institution-id institution-id-type="GRID">grid.4991.5</institution-id><institution-id institution-id-type="ISNI">0000 0004 1936 8948</institution-id><institution>Visual Geometry Group, Department of Engineering Science, </institution><institution>University of Oxford, </institution></institution-wrap>Oxford, OX2 6NN UK </aff>
      <aff id="Aff4"><label>4</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/052gg0110</institution-id><institution-id institution-id-type="GRID">grid.4991.5</institution-id><institution-id institution-id-type="ISNI">0000 0004 1936 8948</institution-id><institution>Intelligent Systems Lab, Department of Computer Science, </institution><institution>University of Oxford, </institution></institution-wrap>Oxford, OX1 3QG UK </aff>
      <aff id="Aff5"><label>5</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/052gg0110</institution-id><institution-id institution-id-type="GRID">grid.4991.5</institution-id><institution-id institution-id-type="ISNI">0000 0004 1936 8948</institution-id><institution>Chinese Academy of Medical Sciences (CAMS) Oxford Institute (COI), </institution><institution>University of Oxford, </institution></institution-wrap>Oxford, OX3 7BN UK </aff>
      <aff id="Aff6"><label>6</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/0080acb59</institution-id><institution-id institution-id-type="GRID">grid.8348.7</institution-id><institution-id institution-id-type="ISNI">0000 0001 2306 7492</institution-id><institution>Translational Gastroenterology Unit, </institution><institution>John Radcliffe Hospital, </institution></institution-wrap>Oxford, OX3 9DS UK </aff>
      <aff id="Aff7"><label>7</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/035dkdb55</institution-id><institution-id institution-id-type="GRID">grid.499548.d</institution-id><institution-id institution-id-type="ISNI">0000 0004 5903 3632</institution-id><institution>Alan Turning Fellow in Health and Medicine, The Alan Turing Institute, </institution></institution-wrap>London, UK </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>13</day>
      <month>9</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>13</day>
      <month>9</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2023</year>
    </pub-date>
    <volume>15</volume>
    <elocation-id>70</elocation-id>
    <history>
      <date date-type="received">
        <day>30</day>
        <month>1</month>
        <year>2023</year>
      </date>
      <date date-type="accepted">
        <day>30</day>
        <month>8</month>
        <year>2023</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© Crown 2023</copyright-statement>
      <license>
        <ali:license_ref specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p><bold>Open Access</bold> This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article's Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article's Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated in a credit line to the data.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p id="Par1">T-cells play a crucial role in the adaptive immune system by triggering responses against cancer cells and pathogens, while maintaining tolerance against self-antigens, which has sparked interest in the development of various T-cell-focused immunotherapies. However, the identification of antigens recognised by T-cells is low-throughput and laborious. To overcome some of these limitations, computational methods for predicting CD8 + T-cell epitopes have emerged. Despite recent developments, most immunogenicity algorithms struggle to learn features of peptide immunogenicity from small datasets, suffer from HLA bias and are unable to reliably predict pathology-specific CD8 + T-cell epitopes.</p>
      </sec>
      <sec>
        <title>Methods</title>
        <p id="Par2">We developed TRAP (T-cell recognition potential of HLA-I presented peptides), a robust deep learning workflow for predicting CD8 + T-cell epitopes from MHC-I presented pathogenic and self-peptides. TRAP uses transfer learning, deep learning architecture and MHC binding information to make context-specific predictions of CD8 + T-cell epitopes. TRAP also detects low-confidence predictions for peptides that differ significantly from those in the training datasets to abstain from making incorrect predictions. To estimate the immunogenicity of pathogenic peptides with low-confidence predictions, we further developed a novel metric, RSAT (relative similarity to autoantigens and tumour-associated antigens), as a complementary to ‘dissimilarity to self’ from cancer studies.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p id="Par3">TRAP was used to identify epitopes from glioblastoma patients as well as SARS-CoV-2 peptides, and it outperformed other algorithms in both cancer and pathogenic settings. TRAP was especially effective at extracting immunogenicity-associated properties from restricted data of emerging pathogens and translating them onto related species, as well as minimising the loss of likely epitopes in imbalanced datasets. We also demonstrated that the novel metric termed RSAT was able to estimate immunogenic of pathogenic peptides of various lengths and species. TRAP implementation is available at: <ext-link ext-link-type="uri" xlink:href="https://github.com/ChloeHJ/TRAP">https://github.com/ChloeHJ/TRAP</ext-link>.</p>
      </sec>
      <sec>
        <title>Conclusions</title>
        <p id="Par4">This study presents a novel computational workflow for accurately predicting CD8 + T-cell epitopes to foster a better understanding of antigen-specific T-cell response and the development of effective clinical therapeutics.</p>
      </sec>
      <sec>
        <title>Supplementary Information</title>
        <p>The online version contains supplementary material available at 10.1186/s13073-023-01225-z.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Immunogenicity</kwd>
      <kwd>CD8 + T-cell epitopes</kwd>
      <kwd>Deep learning</kwd>
      <kwd>Transfer learning</kwd>
      <kwd>Computational immunology</kwd>
      <kwd>Epitope prediction</kwd>
      <kwd>Self-antigen tolerance</kwd>
      <kwd>MHC binding</kwd>
      <kwd>Thymic selection</kwd>
      <kwd>Neoepitope identification</kwd>
      <kwd>Vaccine candidates</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100000265</institution-id>
            <institution>Medical Research Council</institution>
          </institution-wrap>
        </funding-source>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100015250</institution-id>
            <institution>NIHR Bristol Biomedical Research Centre</institution>
          </institution-wrap>
        </funding-source>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© BioMed Central Ltd., part of Springer Nature 2023</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p id="Par38">T-cells are essential for eliminating intracellular infections, triggering anti-tumour response as well as developing an immunological memory. Their ability to induce antigen-directed cytotoxicity has proven instrumental in fighting diseases, as evidenced by checkpoint blockade immunotherapy, adoptive cellular therapy, and cancer vaccinology [<xref ref-type="bibr" rid="CR1">1</xref>–<xref ref-type="bibr" rid="CR3">3</xref>]. With the growing interest in identifying the cognate antigens of antigen-specific T-cells, many efforts have been made to improve experimental and computational methods for screening, predicting or characterising T-cell epitopes. However, current experimental approaches for identifying T-cell targets are labour-intensive, low-throughput and expensive [<xref ref-type="bibr" rid="CR4">4</xref>–<xref ref-type="bibr" rid="CR6">6</xref>], and computational methods are still in their infancy [<xref ref-type="bibr" rid="CR7">7</xref>].</p>
    <p id="Par39">An effective antigen-specific CD8 + T-cell response to exogenous pathogens or endogenous threats relies on tightly regulated processing and presentation of antigenic peptides by class I MHCs, followed by recognition of the peptide-MHC (pMHC) by cognate CD8 + T-cells. Therefore, immunogenic peptides encompass features associated with MHC presentation <italic>and</italic> T-cell recognition [<xref ref-type="bibr" rid="CR8">8</xref>]. Among these, it has been demonstrated that features attributed to MHC presentation are more prominent than those attributed to TCR recognition, with strongly conserved motifs at anchor positions being one such feature [<xref ref-type="bibr" rid="CR9">9</xref>, <xref ref-type="bibr" rid="CR10">10</xref>]. Indeed, recent cutting-edge models [<xref ref-type="bibr" rid="CR11">11</xref>, <xref ref-type="bibr" rid="CR12">12</xref>], such as the widely used NetMHCpan [<xref ref-type="bibr" rid="CR12">12</xref>], have demonstrated impressive performance in predicting MHC presentation on certain alleles. On the other hand, the dual nature of the peptide-specific TCR recognition interface, comprised of both peptide and MHC, makes predicting the interaction between TCR and pMHC uniquely challenging. In addition, the scarcity of peptides tested by T-cell assays, as well as the lack of true negative datasets (i.e. presented but not recognised by T-cells), hampers our understanding of the properties underlying T-cell recognition.</p>
    <p id="Par40">Despite these challenges, a plethora of computational models have been developed to aid in the prediction of T-cell targets and to foster a better understanding of the characteristics underpinning peptide immunogenicity [<xref ref-type="bibr" rid="CR8">8</xref>, <xref ref-type="bibr" rid="CR13">13</xref>–<xref ref-type="bibr" rid="CR17">17</xref>]. These models utilise features such as amino acids at contact position, large and aromatic side chains [<xref ref-type="bibr" rid="CR13">13</xref>], hydrophobicity [<xref ref-type="bibr" rid="CR17">17</xref>–<xref ref-type="bibr" rid="CR20">20</xref>], peptide-MHC binding affinity and stability [<xref ref-type="bibr" rid="CR16">16</xref>] as correlates to T-cell recognition. Specifically for cancer neoepitopes, agretopicity (i.e. the ratio of binding affinity between neoepitope and wild-type counterpart), foreignness score (i.e. similarity of neoepitope to previously characterised epitopes) [<xref ref-type="bibr" rid="CR8">8</xref>] and dissimilarity to human proteome [<xref ref-type="bibr" rid="CR21">21</xref>, <xref ref-type="bibr" rid="CR22">22</xref>] were found to indicate T-cell recognition.</p>
    <p id="Par41">However, we previously found that cancer and pathogenic epitopes often do not share the same immunogenicity features, which may differ in directionality or magnitude [<xref ref-type="bibr" rid="CR23">23</xref>]. In addition to the context-specific differences, other factors, such as limited training data and a highly diverse T-cell receptor (TCR) repertoire contributed to the difficulty of predicting T-cell recognition potential. As a result, many existing models perform poorly against both cancer and emerging viral pathogens [<xref ref-type="bibr" rid="CR7">7</xref>], and progress in improving performance appears to be incremental, suggesting that there are still remaining challenges in predicting T-cell epitopes.</p>
    <p id="Par42">Over the last decade, deep learning and natural language processing (NLP) have transformed biomedical research and offered breakthrough discoveries [<xref ref-type="bibr" rid="CR24">24</xref>]. Because of their ability to extract complex patterns from large amounts of data, deep neural network (DNN) models have been used for predicting peptide-HLA binding [<xref ref-type="bibr" rid="CR12">12</xref>, <xref ref-type="bibr" rid="CR25">25</xref>, <xref ref-type="bibr" rid="CR26">26</xref>] as well as TCR specificity [<xref ref-type="bibr" rid="CR27">27</xref>–<xref ref-type="bibr" rid="CR29">29</xref>]. Furthermore, transformer-based pre-trained language models (PLMs) have advanced the prediction of protein structure and function [<xref ref-type="bibr" rid="CR30">30</xref>–<xref ref-type="bibr" rid="CR33">33</xref>] by combining the power of transformers, self-supervised learning and transfer learning [<xref ref-type="bibr" rid="CR34">34</xref>–<xref ref-type="bibr" rid="CR36">36</xref>]. Indeed, as a solution to data constraints, these protein PLMs, which contain knowledge learned from a large volume of protein sequences, could serve as an additional source of information for related downstream tasks.</p>
    <p id="Par43">In addition, more research has recently been conducted on providing reliable predictions for safety–critical applications. Most of DNN models are trained under the assumption that test data distribution will be similar to the training data distribution. However, when used in real-world tasks, out-of-distribution (OOD) examples that deviate from the training data are common [<xref ref-type="bibr" rid="CR37">37</xref>, <xref ref-type="bibr" rid="CR38">38</xref>], resulting in a significant drop in model performance [<xref ref-type="bibr" rid="CR39">39</xref>–<xref ref-type="bibr" rid="CR41">41</xref>]. While this may be acceptable for some applications such as movie recommendations, it can be disastrous in safety–critical applications, such as medical diagnosis [<xref ref-type="bibr" rid="CR42">42</xref>, <xref ref-type="bibr" rid="CR43">43</xref>]. Therefore, the ability to identify OOD inputs and respond appropriately, whether by abstaining, requesting human intervention or gathering additional information, has become critical [<xref ref-type="bibr" rid="CR42">42</xref>]. Recently, several methods for estimating the degree of correctness have been proposed and have been successfully applied in the Natural language Inference (NLI) and/or OOD datasets [<xref ref-type="bibr" rid="CR44">44</xref>–<xref ref-type="bibr" rid="CR48">48</xref>]. One of the major challenges in immunogenicity prediction has been the limited data and OOD generalisation problem for peptides derived from different hosts, organisms and diseases. As such, the OOD detection module would facilitate making reliable predictions on a real-world set of peptides that are often highly diverse and heterogeneous.</p>
    <p id="Par44">Here, we present TRAP (<underline>T</underline>-cell <underline>r</underline>ecognition potential of HL<underline>A</underline>-I presented <underline>p</underline>eptides), a deep learning-based workflow that addresses the current limitations and effectively captures T-cell recognition motifs from HLA-I presented pathogenic or self-peptides. Novel strategies were implemented, such as (a) building separate models for pathogenic and self-peptides to account for divergent immunogenicity-related features, (b) using transfer learning to deliver amino acid embeddings from pre-trained large-scale protein language models, (c) capturing T-cell recognition motifs with a deep learning architecture, and (d) detecting low-confidence predictions to abstain from making incorrect predictions. We further developed RSAT (relative similarity to autoantigens and tumour-associated antigens) to estimate the immunogenicity of pathogenic peptides when they are abstained due to low-confidence predictions. The TRAP was then used to identify cancer neoepitopes from glioblastoma patients and showed superior performance to other methods. While many immunogenicity algorithms are based on MHC binding, TRAP goes one step further by predicting T-cell targets from MHC-I ligands. This novel workflow will enable more accurate identification of CD8 + T-cell epitopes, facilitating the development of effective vaccines and therapeutics.</p>
  </sec>
  <sec id="Sec2">
    <title>Methods</title>
    <sec id="Sec3">
      <title>Data preparation</title>
      <sec id="Sec4">
        <title>PeptideTcell data</title>
        <p id="Par45">Peptides that bind MHC-I molecules are typically restricted to 8–10 amino acids (aa) in lengths due to closed structure of peptide-binding groove. Given the limited number of 8aa peptides in databases, peptides of lengths 9–10aa characterised by T-cells were retrieved from IEDB [<xref ref-type="bibr" rid="CR49">49</xref>]. These included cancer neoepitopes, autoantigens or pathogenic peptides. The peptides without HLA allele or serotype annotations were removed. To ensure MHC binding, peptides were subjected to NetMHCpan 4.0 prediction and only those with rank ≤ 2.0 (i.e. predicted MHC binder) were retained. Peptides having contradictory immunogenicity annotations were categorised as ‘Positive’ and we only included Negatives that were characterised negative in ≥ 3 tests. This resulted 5093 immunogenic (‘Positive’) and 6628 non-immunogenic (‘Negative’) peptides in PeptideTcell data. The dataset includes information about peptide sequence, binary immunogenicity, HLA allele, source antigen and organism. This data is the foundation for sequence pattern analysis, model development and RSAT validation.</p>
      </sec>
      <sec id="Sec5">
        <title>Pathogenic data</title>
        <p id="Par46">For the analysis of sequence patterns and the development of deep learning-based models, datasets for pathogenic and self-antigens were prepared separately. For pathogenic datasets, we subset peptides originating from non-human species, resulting 4000 Positive and 6097 Negative pathogenic peptides (Additional file <xref rid="MOESM3" ref-type="media">3</xref>: Table S1).</p>
      </sec>
      <sec id="Sec6">
        <title>Self-antigen data</title>
        <p id="Par47">For immunogenic self-peptides, autoantigens, tumour-associated antigens and cancer neoepitopes having 9–10 amino acids were collected from different databases. We gathered 162 epitopes from cancer peptide database (<ext-link ext-link-type="uri" xlink:href="https://caped.icp.ucl.ac.be">https://caped.icp.ucl.ac.be</ext-link>), 228 from dbPepNeo [<xref ref-type="bibr" rid="CR50">50</xref>], 1506 from IEDB [<xref ref-type="bibr" rid="CR49">49</xref>], 256 from McPAS-TCR [<xref ref-type="bibr" rid="CR51">51</xref>] and 256 from NEPdb [<xref ref-type="bibr" rid="CR52">52</xref>]. For Negative self-antigens, we gathered HLA-I ligands expressed in thymus suggested to be involved in the negative selection of T-cells. Two hundred forty HLA-I ligands were collected from Adamopoulou et al. [<xref ref-type="bibr" rid="CR53">53</xref>], which were expressed in negatively selecting dendritic cells, 187 HLA-I ligands from Espinosa et al. [<xref ref-type="bibr" rid="CR54">54</xref>], which were expressed in thymus, and 10,840 benign HLA-I presented peptides from HLA Ligand Atlas [<xref ref-type="bibr" rid="CR55">55</xref>] expressed in thymus. Of note, we did not include ‘Negatives’ from IEDB for self-antigen data because many were tested due to their association with tumour-associated antigens, e.g. cancer/testis antigen 1, melanoma-associated antigen 9; yet, there was little evidence that these peptides were immunogenic. Therefore, only MHC-I peptides expressed in thymus were included. After pre-processing, removing duplicates and filtering for peptides with NetMHCpan rank ≤ 2, 1260 Positive and 2868 Negative peptides were retained for the self-antigen model. Since MHC binding filter removed many peptides, we prepared another self-antigen dataset with relaxed threshold (NetMHCpan rank ≤ 10) to include as many self-epitopes as possible for model training and validation, resulting 1606 Positive and 10,915 Negative peptides (Additional file <xref rid="MOESM3" ref-type="media">3</xref>: Table S2). For all analysis, the self-antigen dataset with relaxed threshold was used, unless otherwise specified.</p>
      </sec>
      <sec id="Sec7">
        <title>Benchmarking data</title>
        <p id="Par48">The benchmarking analysis has been done in HLA-agnostic (i.e. peptide-based) or HLA-restrictive (i.e. peptide-HLA based) manner depending on the nature of different models. The TRAP makes prediction based on the peptide sequence and HLA binding rank score, which allows it to predict in both HLA-agnostic and restrictive manner. The HLA-agnostic approach was applied on all peptides in the aforementioned pathogenic and self-antigen datasets. The HLA-restricted prediction was made against epitopes that were bound to 13 HLAs for which NetTepi could be performed, which are HLA-A*02:01, HLA-B*58:01, HLA-B*15:01, HLA-B*35:01, HLA-B*07:02, HLA-A*01:01, HLA-A*03:01, HLA-A*11:01, HLA-A*24:02, HLA-A*26:01, HLA-B*27:05, HLA-B*39:01, HLA-B*40:01. The list of models conducted in HLA-restricted manner are iPred [<xref ref-type="bibr" rid="CR17">17</xref>], PRIME [<xref ref-type="bibr" rid="CR56">56</xref>], NetTepi [<xref ref-type="bibr" rid="CR16">16</xref>], IEDB [<xref ref-type="bibr" rid="CR13">13</xref>] and DeepImmuno [<xref ref-type="bibr" rid="CR57">57</xref>]. Specifically for DeepImmuno, an additional filter was applied to exclude peptides that were bound to HLAs that DeepImmuno could not process.</p>
      </sec>
      <sec id="Sec8">
        <title>DeepImmuno data</title>
        <p id="Par49">DeepImmuno training data was retrieved from GitHub repository and used for evaluating the DeepImmuno performance (<ext-link ext-link-type="uri" xlink:href="https://github.com/frankligy/DeepImmuno">https://github.com/frankligy/DeepImmuno</ext-link>).</p>
      </sec>
    </sec>
    <sec id="Sec9">
      <title>10-fold CV and cross-species comparison</title>
      <p id="Par50">The peptideTcell data was divided randomly or in cross-species manner: (i) 90% train vs. 10% test random split (i.e. representation of 10-fold cross-validation), (ii) Non-SARS-CoV-2 (Non-SARS-2) train vs. SARS-2 test, and (iii) Non-vaccinia virus (Non-VACV) train vs. VACV test.</p>
      <p id="Par51">To compare the performance of the XGBOOST classifier on random vs. cross-species datasets, amino acids at contact positions were first represented by their physicochemical properties using ‘aaDescriptors’ function in R Peptides v2.4.4 package. The amino acid descriptors included kideraFactor, zScales, tScales, vhseScales, protFP, stScales, blosumIndices, mswhimScores, crucianiProperties and fasgaiVectors, which described properties such as polarity, electronic properties, hydrophobicity, α-helix/bend preference, β-sheet, bulkiness/size of side-chains, hydrogen-bonding, isoelectric point and structural topology [<xref ref-type="bibr" rid="CR58">58</xref>]. In addition to amino acid-level embedding, the peptide-wide property was added by averaging these aaDescriptors across all positions for each peptide. The embeddings from random split and cross-species datasets were used to generate the XGBOOST classifier using ‘XGBClassifier’ function in python xgboost v0.90 package. The set of hyperparameters, such as alpha, gamma, max_depth and colsample_bytree, were optimised by grid search for each dataset. The models were trained using training datasets: 90% train, Non-SARS-2 and Non-VACV peptides by 10-fold cross-validations. The trained models were tested on 10% test, SARS-2 and VACV peptides, respectively as representatives of 10-fold CV and cross-species comparisons.</p>
      <p id="Par52">To analyse sequence homology between training vs. test datasets, differential position-specific scoring matrices (dPSSMs) were generated for each training and test datasets. The probability frequency of each amino acid in each position was represented by position-specific scoring matrices using ‘consensusMatrix’ function from R Biostrings v2.56.0 package. The PSSMs from Positive and Negative peptides were standardised by centre and scaling, and differential PSSMs were generated by subtracting the two. To estimate the discriminative power of the dPSSM scores, we generated dPSSMs using training data and used the matrices to score respective test peptides for their immunogenicity potential.</p>
    </sec>
    <sec id="Sec10">
      <title>Immunogenicity positivity score</title>
      <p id="Par53">The positivity score was computed by taking three factors into account: (1) the number of experiments conducted, (2) the percentage tested positive and (3) the number of cognate TCRs if available, using the following equations.<disp-formula id="Equ1"><label>1</label><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm{PS}=\mathrm{pr}+\left(1-{\mathrm{e}}^{-\frac{\mathrm{T}N}{\mathrm{Qp}}}\right)$$\end{document}</tex-math><mml:math id="M2" display="block"><mml:mrow><mml:mi mathvariant="normal">PS</mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="normal">pr</mml:mi><mml:mo>+</mml:mo><mml:mfenced close=")" open="("><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="normal">e</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">T</mml:mi><mml:mi>N</mml:mi></mml:mrow><mml:mi mathvariant="normal">Qp</mml:mi></mml:mfrac></mml:mrow></mml:msup></mml:mfenced></mml:mrow></mml:math><graphic xlink:href="13073_2023_1225_Article_Equ1.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ2"><label>2</label><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm{PS}=1-\left[\mathrm{pr}+\left(1-\mathrm e^{-\frac{\mathrm TN}{\mathrm{Qn}}}\right)\right]$$\end{document}</tex-math><mml:math id="M4" display="block"><mml:mrow><mml:mi mathvariant="normal">PS</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mfenced close="]" open="["><mml:mi mathvariant="normal">pr</mml:mi><mml:mo>+</mml:mo><mml:mfenced close=")" open="("><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msup><mml:mi mathvariant="normal">e</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">T</mml:mi><mml:mi>N</mml:mi></mml:mrow><mml:mi mathvariant="normal">Qn</mml:mi></mml:mfrac></mml:mrow></mml:msup></mml:mfenced></mml:mfenced></mml:mrow></mml:math><graphic xlink:href="13073_2023_1225_Article_Equ2.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ3"><label>3</label><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm{x}=\frac{1}{1+{\mathrm{e}}^{-\mathrm{nTCR}}}$$\end{document}</tex-math><mml:math id="M6" display="block"><mml:mrow><mml:mi mathvariant="normal">x</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="normal">e</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mi mathvariant="normal">nTCR</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mfrac></mml:mrow></mml:math><graphic xlink:href="13073_2023_1225_Article_Equ3.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ4"><label>4</label><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm{PS}=\mathrm{min^{\prime}}+\frac{\mathrm{max^{\prime}}-\mathrm{min^{\prime}}}{\mathrm{max}(\mathrm{x})-\mathrm{min}(\mathrm{x})}*(\mathrm{x}-\mathrm{min}\left(\mathrm{x}\right))$$\end{document}</tex-math><mml:math id="M8" display="block"><mml:mrow><mml:mi mathvariant="normal">PS</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mi mathvariant="normal">min</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mi mathvariant="normal">max</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>-</mml:mo><mml:msup><mml:mi mathvariant="normal">min</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mrow><mml:mrow><mml:mi mathvariant="normal">max</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="normal">x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>-</mml:mo><mml:mi mathvariant="normal">min</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="normal">x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac><mml:mrow/><mml:mo>∗</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="normal">x</mml:mi><mml:mo>-</mml:mo><mml:mi mathvariant="normal">min</mml:mi><mml:mfenced close=")" open="("><mml:mi mathvariant="normal">x</mml:mi></mml:mfenced><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><graphic xlink:href="13073_2023_1225_Article_Equ4.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par54">(1) computes positivity score (PS) for Positives peptides that do not have TCR information available, where pr = % responded positive, TN = total number of tests conducted and Qp = the number of tests designated as a minimum number of tests required to support positivity (Qp = 3). (2) computes PS for Negative peptides, where Qn = number of tests designated as a minimum number of tests required to support negativity (Qn = 5). (3) and (4) compute for Positives with cognate TCR information. (3) is a sigmoid function that translates the number of cognate TCR (nTCR) to values in a logistic growth curve and (4) scales the distribution to align with scores from (1), where min’ equals mean of the distribution (~ 1.28 equivalent to 1 test and 1 responded positive) and max’ = 2.0. Due to limited pool of peptides with cognate TCRs, the majority of peptides’ positivity score was computed by translating the number of experiments conducted and % tested positive, and the number of cognate TCRs was incorporated to add greater weights to positivity (all positivity scores with cognate TCR had values &gt; 1). The positivity scores were computed for each entry for each peptide-HLA pair, and ranged from 0 to 2.3, with Negatives ranging from 0 to 1 and Positives ranging from 1 to 2.3.</p>
    </sec>
    <sec id="Sec11">
      <title>Intra- and inter-HLA variability</title>
      <p id="Par55">The HLA effect was computed on 2349 peptides having entries from multiple HLA alleles. One-way ANOVA was conducted for the effect of HLA on the positivity score for each peptide-HLA pair using ‘aov’ function from R stats v4.0.5 package. The distributions show mean squared from summary output.</p>
    </sec>
    <sec id="Sec12">
      <title>Differential sequence patterns</title>
      <p id="Par56">The n-grams (i.e. contiguous sequence of n-amino acids) were generated using ‘ngram’ function from R ngram v3.1.0 package. The number of peptides containing the n-grams was counted for Positive and Negative respectively and normalised for the total number of Positive and Negative peptides, respectively. Then, we computed ratio<sub>n-gram</sub> = normalised # of Positive peptides containing the n-gram / normalised # of Negative peptides containing the n-gram, and shortlist top differential n-grams by the ratio score. Similarly, we generated all possible combinations of position-specific k-mer motifs (i.e. contiguous or non-contiguous sequence of k amino acids restricted to peptides of same lengths), where e.g..M.W. denotes MW pattern at P2 and P4 of 5 amino acid peptide. We computed ratio <sub>positional k-mer</sub> = normalised # of Positive peptides containing the positional k-mer / normalised # of Negative peptides containing the positional k-mer to shortlisted top differential position-specific k-mer motifs. For visualisation, patterns were categorised by their normalised ratios, where ‘lows’ have ¼ &lt; ratio &lt; 4, ‘high in pos’ have ratio ≥ 4, ‘high in neg’ have ratio ≤ ¼, and ‘onlys’ have motifs in either positive or negative sets, and top differential patterns from ‘high’ or ‘only’ categories were visualised by barplot. To identify shared enriched patterns between pathogenic and self-antigens, only n-grams or positional k-mer motifs having ratio ≥ 3 or ≥ 3 positive peptides (for onlys) were pre-selected for comparison. The pairwise sequence similarity between peptides was computed using ‘pairwiseAlignment’ function in Biostrings v2.56.0 package [<xref ref-type="bibr" rid="CR59">59</xref>], using BLOSUM62 substitution matrix and default parameters. For clusters of highly similar peptides, the peptides having alignment scores ≥ 22 with ≥ 3 other peptides were visualised into network graph using R ggnetwork v0.5.10 package. The toolkits for generating the sequence patterns are deposited in: <ext-link ext-link-type="uri" xlink:href="https://github.com/ChloeHJ/diffSeqPatterns">https://github.com/ChloeHJ/diffSeqPatterns</ext-link> [<xref ref-type="bibr" rid="CR60">60</xref>].</p>
    </sec>
    <sec id="Sec13">
      <title>Deep learning models for pathogenic and self-epitope prediction</title>
      <p id="Par57">The peptide sequences at contact positions, i.e. P3-P8 of 9aa and P3-P9 of 10aa peptides, were encoded either by one-hot-encoding having dimension [m, 7, 21], amino acid descriptors [m, 7, 49] or amino acid embeddings from protein transformer-based pre-trained language models (PLMs) [m, 7, 1024], where m represents the number of peptides. The amino acid descriptors included kideraFactors, tScales, protFP, BLOSUM, stScales and MSWHIM captured by ‘aaDescriptors’ function from R Peptides v2.4.4 package, and Atchley factors from ‘AAMetric.Atchley’ function in R HDMD v1.2 package. In addition, amino acids were embedded using five protein transformer-based PLMs, including prot_t5_xl_uniref50, prot_bert, prot_bert_bfd and prot_t5_xl_bfd, prot_xlnet from Rostlab using Tokenizer and EncoderModel functions from python transformers v4.19.0 package. These models are based on T5 or BERT and were pre-trained on a large corpus of protein sentences, e.g. UniRef50, a dataset consisting of 45 million protein sequences, in a semi-supervised fashion. Further details about transformer-based PLMs can be found in <ext-link ext-link-type="uri" xlink:href="https://huggingface.com/Rostlab">https://huggingface.com/Rostlab</ext-link>.</p>
      <p id="Par58">To account for peptides of varying lengths, the peptides coming from 9aa peptides were padded (i.e. adding non-relevant number to the borders of the matrix) either in the front (i.e. pre-padding) or at the back (i.e. post-padding). First, we computed all possible n-grams from 6- and 7-mer peptides and analysed if the same n-grams were present in both 6- and 7-mers. We found that many n-grams were present in both 6- and 7-mers. We then aligned by their respective positions and observed that many 3-g located in P3-P5 of 9aa peptides were positioned at P4-P6 of 10aa peptides, indicating padding in front of 6-mer peptide (i.e. pre-padding) would align with hotspots in 7-mers.</p>
      <p id="Par59">The classification accuracies of different deep learning architectures were compared between simple dense layer (i.e. classification), biRNN, biLSTM, 1D CNN, 2D CNN and transformer models. The biRNN model contained two biRNN layers each having 512 units, followed by a dense layer of 256 units and a classification layer with dropouts in-between. The biLSTM model had the same structure as the biRNN model, but LSTM cell is used instead of the RNN cell. 2D CNN model had two Conv2D layers, with filters = 16 and 32 respectively, followed by MaxPool2D, Flatten, a dense layer of 256 units and a classification layer with dropouts in-between. The transformer model for pathogenic and self-antigen data had 10 and 2 attention heads respectively and 32 hidden layers in a feed forward network, followed by GlobalAveragePooling1D, dense layer with 128 units and classification, with dropouts in-between. The 1D CNN had kernel sizes 1, 3, 5 and 7, each max pooled and concatenated to a layer. In parallel, − log transformed NetMHCpan rank and hydrophobicity (i.e. the proportion of A, V, L, M, W) have been added as a MLP layer. 1D CNN and MLP layers were concatenated and put into a dense layer of 256 units followed by classification. The hyperparameters of the final 1D CNN models were optimised by grid search. The final hyperparameters for pathogenic model are as follows: learning rate = 1e − 05, weight decay = 1e − 06, dropout rate = 0.1, batch size = 50, dense layer node = 2000 and dense layer node = 256, giving ROC-AUC of 0.764 by 10-fold cross-validation. The final hyperparameters for self-antigen model are as follows: learning rate = 0.001, weight decay = 0.01, dropout rate = 0.2, batch size = 100, MLP dense = 1500 and dense layer node = 512, giving ROC-AUC of 0.943 by 10-fold cross-validation. All deep learning architectures are implemented using python TensorFlow v2.8.0 package.</p>
    </sec>
    <sec id="Sec14">
      <title>Out of distribution (OOD) detection</title>
      <p id="Par60">The out-of-distribution was defined as test samples having different properties from the training data, and thus cannot be predicted with high accuracy. We found that one of the significant sources of out-of-distribution is the origin of the peptides, i.e. pathogenic vs. self-antigen or different pathogenic organisms, and that peptides originating from species not well represented in the training data have lower predictive accuracy. Given the limited number of biologically homogeneous (i.e. in-domain) peptide as well as technical variation coming from different T-cell assays, experimental setups and laboratories, it was difficult to collect enough peptides for in-domain analysis, so we used predictive accuracy as the proxy to build OOD classifier, trained to classify correctly vs. incorrectly predicted peptides.</p>
      <p id="Par61">Autoencoder is a type of unsupervised neural network that have a smaller number of neurons in the hidden layers than the input layer. This allows the architecture to extract essential information from the input layer, preserve in lower-dimension and employ to reconstruct output. We used the difference between the input and reconstructed output (i.e. reconstruction loss) as a metric for anomaly detection, as autoencoders cannot effectively reconstruct patterns not learnt from training data [<xref ref-type="bibr" rid="CR61">61</xref>].</p>
      <p id="Par62">For anomaly detection, peptides encoded by prot_t5_xl_uniref50 transformer-based PLM were applied onto 2D and 3D autoencoders, variational autoencoder and denoising autoencoder models, using ‘AutoEncoder’ function from python pyod v1.0.1 package. The autoencoder models were trained using 90% random train and non-SARS-CoV-2 data and were used to predict 10% test and SARS-CoV-2 data respectively. Then, we computed reconstruction loss between original and predicted test values.</p>
      <p id="Par63">For calibration methods, the 1D CNN model was trained using softmax activation function. We then computed maximum softmax probability (MaxProb) and temperature-scaled softmax probability (T = 2) for each test peptide. The MaxProb is the maximum softmax probability between class 0 (Negative) and 1 (Positive) classes. The temperature scaling softens the softmax probability with T &gt; 1, making the network slightly less confident, reflecting the true probabilities [<xref ref-type="bibr" rid="CR62">62</xref>]. For Ensemble, we used 10-folds of the training dataset to generate 10 different models. These models were then used to predict test data points, producing prediction scores for each. We averaged softmax probabilities across 10 different models and computed MaxProb of the average. For Monte Carlo dropout (MCDropout), Monte Carlo models were reiterated 100 times with stochastic dropout of 0.6. The softmax probabilities were averaged across 100 scores, and MaxProb was generated from them.</p>
      <p id="Par64">The final OOD classifier predicts correct vs. incorrect predictions by using MCDropout, which have been shown to be more robust than maximum softmax probabilities (MSP). The MSP is often not suitable when overfitting is likely, as the values will either be 0 or 1, whereas MCDropout provides a better estimate of uncertainty by combining multiple confidence scores generated by many models and providing informative statistics (e.g. mean and variation of the confidence scores) as opposed to a single scalar value. We built linear regression model with MCDropout, using the ‘LinearRegression’ function from python sklearn v1.0.2 package.</p>
    </sec>
    <sec id="Sec15">
      <title>Relative Similarity to Autoantigens or Tumour-associated antigens (RSAT)</title>
      <p id="Par65">To compute RSAT, a total of 5023 unique cancer neoepitopes, autoantigens, tumour-associated antigens and other self-epitopes were retrieved from IEDB, dbPepNeo, NEPdb, McPAS-TCR and tumour antigenic peptide database. First, only pathogenic peptides having comparable self-epitope counterparts are retrained by computing Match score [<xref ref-type="bibr" rid="CR63">63</xref>] (5) between pathogenic peptides and self-epitopes, where BL represents the global–local alignment score using BLOSUM62 matrix, p represents pathogenic peptide and se self-epitopes. Only pathogenic peptides having a match score ≥ 0.6 are retained to compute RSAT.<disp-formula id="Equ5"><label>5</label><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Match\ score=\frac{BL\left(p, se\right)}{\sqrt{BL\left(p, se\right)\ *\ BL(p, se)}}$$\end{document}</tex-math><mml:math id="M10" display="block"><mml:mrow><mml:mi>M</mml:mi><mml:mi>a</mml:mi><mml:mi>t</mml:mi><mml:mi>c</mml:mi><mml:mi>h</mml:mi><mml:mspace width="4pt"/><mml:mi>s</mml:mi><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>B</mml:mi><mml:mi>L</mml:mi><mml:mfenced close=")" open="("><mml:mi>p</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi><mml:mi>e</mml:mi></mml:mfenced></mml:mrow><mml:msqrt><mml:mrow><mml:mi>B</mml:mi><mml:mi>L</mml:mi><mml:mfenced close=")" open="("><mml:mi>p</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi><mml:mi>e</mml:mi></mml:mfenced><mml:mspace width="4pt"/><mml:mrow/><mml:mo>∗</mml:mo><mml:mspace width="4pt"/><mml:mi>B</mml:mi><mml:mi>L</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>p</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi><mml:mi>e</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:msqrt></mml:mfrac></mml:mrow></mml:math><graphic xlink:href="13073_2023_1225_Article_Equ5.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par66">For pathogenic peptides having comparable self-epitope counterparts, RSAT was computed (6). First, we computed the maximum global–local alignment score between pathogenic peptides and AATs (a set of autoimmunity, allergy tor tumour-associated antigens) using the BLOSUM62 substitution matrix. Second, we computed the maximum global alignment score between pathogenic peptide and AAT’s best counterpart in human proteome. Third, we computed the ratio between alignment scores from self-epitope and human proteome counterpart. In the Eq. (<xref rid="Equ6" ref-type="disp-formula">6</xref>) below, p = pathogenic peptide, AAT = autoimmunity, allergy tor tumour-associated antigens, hp = human proteome.<disp-formula id="Equ6"><label>6</label><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$RSAT=\frac{BL\left(p, AATs\right)}{BL\left(p,hp\right)}$$\end{document}</tex-math><mml:math id="M12" display="block"><mml:mrow><mml:mi>R</mml:mi><mml:mi>S</mml:mi><mml:mi>A</mml:mi><mml:mi>T</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>B</mml:mi><mml:mi>L</mml:mi><mml:mfenced close=")" open="("><mml:mi>p</mml:mi><mml:mo>,</mml:mo><mml:mi>A</mml:mi><mml:mi>A</mml:mi><mml:mi>T</mml:mi><mml:mi>s</mml:mi></mml:mfenced></mml:mrow><mml:mrow><mml:mi>B</mml:mi><mml:mi>L</mml:mi><mml:mfenced close=")" open="("><mml:mi>p</mml:mi><mml:mo>,</mml:mo><mml:mi>h</mml:mi><mml:mi>p</mml:mi></mml:mfenced></mml:mrow></mml:mfrac></mml:mrow></mml:math><graphic xlink:href="13073_2023_1225_Article_Equ6.gif" position="anchor"/></alternatives></disp-formula></p>
    </sec>
    <sec id="Sec16">
      <title>Application of TRAP to shortlisting glioblastoma neoantigens</title>
      <p id="Par67">In previous in-house study [<xref ref-type="bibr" rid="CR64">64</xref>], tumours of four HLA-A2 glioblastoma patients were sequenced and cancer neoepitopes were shortlisted using an in-house version of MuPeXI [<xref ref-type="bibr" rid="CR65">65</xref>] named TUNAPASTA v0.5. We then selected 153 predicted neoepitopes for functional T-cell assays, 33 of which were characterised Positive. From these 153 tested peptides, we filtered out predicted HLA*02:01 non-binders and retained 9–10 amino acid peptides that were applicable to TRAP. This left 124 GBM peptides, 25 of which were Positives and 99 Negatives. We used a pre-trained self-antigen TRAP model on this dataset to predict the immunogenicity of GBM peptides as well as the confidence of prediction by the OOD detection module. Because identifying cancer neoepitopes is thought to be a ‘needle in a haystack’ problem, we identified predicted Negatives with low-confidence prediction, and added 24 more candidates for validation, resulting in a ROC-AUC of 0.705.</p>
    </sec>
  </sec>
  <sec id="Sec17">
    <title>Results</title>
    <sec id="Sec18">
      <title>TRAP: a robust deep learning workflow to predict CD8 + T-cell recognition of MHC-I presented pathogenic and self-peptides</title>
      <p id="Par68">We present TRAP as a comprehensive workflow for predicting CD8 + T-cell immunogenicity of HLA-I presented pathogenic and self-peptides (Fig. <xref rid="Fig1" ref-type="fig">1</xref>A).<fig id="Fig1"><label>Fig. 1</label><caption><p>Schematic of TRAP workflow and cross-species variation in T-cell recognition features. <bold>A</bold> Schematic diagram of TRAP (T-cell recognition potential of HLA-I presented peptides), a robust deep learning-based workflow to predict CD8 + T-cell epitopes from MHC-I presented pathogenic or self-peptides. Once peptides have been predicted by NetMHCpan to bind HLA alleles, the TRAP uses the peptide sequence and NetMHCpan rank scores as inputs to predict the immunogenicity of the peptide with the respective HLA binding affinity. The TRAP workflow will output TRAP prediction score along with confidence in its prediction. If the prediction is detected to have a low confidence, we recommend predicting cancer neoepitopes using TESLA [<xref ref-type="bibr" rid="CR52">52</xref>], which is known to use more general features such as agretopicity and dissimilarity to self-proteome, and pathogenic peptides with RSAT (relative similarity to autoantigens or tumour-associated antigens). <bold>B</bold>, <bold>C</bold> Distribution of MHC binding rank scores predicted by NetMHCpan (<bold>B</bold>) and hydrophobicity (<bold>C</bold>) for peptides derived from different pathogenic species. CMV: cytomegalovirus; EBV: Epstein-Barr virus; HCV: hepatitis C virus; HBV: hepatitis B virus; SARS-2: SARS-CoV-2; VACV: vaccinia virus; YFV: yellow fever virus. <bold>D</bold> Statistics of peptides in cross-species dataset (i.e. non-vaccinia virus (non-VACV) peptides for training and VACV peptides for testing, non-SARS-CoV-2 (non-SARS2) peptides for training and SARS-2 peptides for testing), and data randomly divided into 90% train and 10% test, as a resemblance of 10-fold cross-validation. <bold>E</bold>, <bold>F</bold> Models trained using cross-species datasets could not effectively predict the immunogenicity of peptides derived from unseen pathogens. ROC-AUC curves of XGBOOST classifiers on training data by 10-fold cross-validations—on 90% data, non-SARS-2 and non-VACV peptides (<bold>E</bold>). ROC-AUC curves of XGBOOST classifiers on test datasets—10% data, SARS2 and VACV peptides (<bold>F</bold>). <bold>G</bold> Sequence logo of amino acids enriched in epitopes (Positive) compared to non-epitopes (Negative) in contact positions for randomly split data (i), SARS-2 data (ii) and vaccinia virus data (iii). <bold>H</bold>, <bold>I</bold> High performance may be a reflection of HLA bias. ROC curve of DeepImmuno algorithm on single HLA allele, for peptides bound on HLA-A*02:01 (<bold>H</bold>) or HLA-A*24:02 (<bold>I</bold>). <bold>J</bold> Performance of DeepImmuno algorithm on per-HLA down-sampled dataset, i.e. the number of peptides has been down</p></caption><graphic xlink:href="13073_2023_1225_Fig1_HTML" id="MO1"/></fig></p>
      <p id="Par69">In this workflow, peptide sequences of 9–10 amino acids in length are predicted to bind HLAs. The predicted HLA-I ligands are encoded using amino acid embeddings derived from protein transformer-based pre-trained language models (PLMs). TRAP then employs a 1D convolutional neural network to extract T-cell recognition motifs, which are then combined with MHC binding rank score and hydrophobicity to predict peptide immunogenicity. Following that, TRAP includes a linear regression classifier to detect low-confidence predictions to improve accuracy. The immunogenicity of pathogenic peptides with low-confidence predictions can be predicted using a novel metric called relative similarity to autoantigens or tumour-associated antigens (RSAT), which is developed as a complement to ‘dissimilarity to self’ from cancer studies.</p>
      <p id="Par70">TRAP has been developed as a user-friendly web application and is accessible from <ext-link ext-link-type="uri" xlink:href="https://github.com/ChloeHJ/TRAP">https://github.com/ChloeHJ/TRAP</ext-link> [<xref ref-type="bibr" rid="CR66">66</xref>]. Here, users can input their peptide list and select the model of interest (pathogenic or self-antigen), and the application will compute the prediction scores along with its confidence (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S1, Additional file <xref rid="MOESM2" ref-type="media">2</xref>). In the following sections, we will describe the rationales behind the model architecture and strategies for overcoming the current constraints and improving model performance.</p>
    </sec>
    <sec id="Sec19">
      <title>Out-of-distribution uncertainty and HLA bias result in poor performance</title>
      <p id="Par71">We previously reported that the existing immunogenicity algorithms showed suboptimal performance in predicting epitopes from both cancer and an emerging viral pathogen [<xref ref-type="bibr" rid="CR7">7</xref>]. We then attributed the poor performance to divergent discriminative features between cancer neoepitopes and pathogenic epitopes in directionality or magnitudes [<xref ref-type="bibr" rid="CR7">7</xref>, <xref ref-type="bibr" rid="CR23">23</xref>].</p>
      <p id="Par72">Here, we investigated additional sources of suboptimal performance to aid in the development of accurate, robust and biologically meaningful classifiers. We retrieved peptides of lengths 9–10aa, characterised by T-cell assays from IEDB and retained predicted MHC binder from NetMHCpan 4.0, resulting in 5093 immunogenic (‘Positive’) and 6628 non-immunogenic (‘Negative’) peptides (named PeptideTcell data, ‘<xref rid="Sec4" ref-type="sec">Methods</xref>’) (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S2A). Notably, no peptides may be considered truly non-immunogenic as they may be recognised by at least one TCR in the repertoire under the right physiological conditions. However, there is a continuum of immunogenicity potential where some peptides are likely to trigger greater T-cell response and/or are able to bind numerous TCRs. Therefore, we designated the ‘Negatives’ as peptides with very low putative immunogenicity potential, defined as peptides characterised negative in more than three T-cell assays.</p>
      <p id="Par73">First, we evaluated the extent to which known hallmarks of immunogenicity, such as MHC binding affinity [<xref ref-type="bibr" rid="CR12">12</xref>, <xref ref-type="bibr" rid="CR16">16</xref>] and percentage of hydrophobic amino acids in peptide sequence [<xref ref-type="bibr" rid="CR20">20</xref>], can be used to identify immunogenic peptides from different species. Notably, these features have been used as predictors in models such as TESLA [<xref ref-type="bibr" rid="CR8">8</xref>], iPred [<xref ref-type="bibr" rid="CR17">17</xref>], NetTepi [<xref ref-type="bibr" rid="CR16">16</xref>] and GAO [<xref ref-type="bibr" rid="CR67">67</xref>]. Although two features could effectively distinguish epitopes from non-epitopes at a macroscopic level, where epitopes had higher MHC binding rank (− log transformed) and hydrophobicity with medium effect sizes (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S2B-C), they no longer showed statistical significance at the species level (Fig. <xref rid="Fig1" ref-type="fig">1</xref>B,C), which was caused in part by the small sample size. For example, hydrophobicity alone could not discriminate SARS-CoV-2 epitopes from non-epitopes.</p>
      <p id="Par74">Second, we assessed the extent to which cross-species peptides (i.e. peptides derived from other species) can predict epitopes of unseen pathogens. We divided PeptideTcell data randomly or in a cross-species manner: (i) random split to 90% train vs. 10% test (i.e. representation of 10-fold cross-validation), or (ii) cross-species split to Non-SARS-CoV-2 (Non-SARS-2) train vs. SARS-2 test, and Non-vaccinia virus (Non-VACV) train vs. VACV test (Fig. <xref rid="Fig1" ref-type="fig">1</xref>D). We then compared the performance of XGBOOST classifiers on these datasets (‘<xref rid="Sec4" ref-type="sec">Methods</xref>’). While no substantial difference was observed during training (Fig. <xref rid="Fig1" ref-type="fig">1</xref>E), the cross-species model showed lower accuracy and higher root mean squared error (RMSE) on test datasets (Fig. <xref rid="Fig1" ref-type="fig">1</xref>F). This implied that cross-species peptides may not share common features in predicting immunogenicity (i.e. predictive features in training and test data are likely to be different which is known as an out-of-distribution generalisation problem), resulting in limited accuracy on unseen pathogens.</p>
      <p id="Par75">To support this, we generated differential position-specific scoring matrices (dPSSMs) to compare immunogenicity-related sequence patterns between train and test datasets (‘<xref rid="Sec4" ref-type="sec">Methods</xref>’). While random split data shared similar patterns between train and test datasets, such as enrichment of L, G/E, G, hydrophobic resides and T on P3-P8 (Fig. <xref rid="Fig1" ref-type="fig">1</xref>Gi), cross-species data showed low homology (Fig. <xref rid="Fig1" ref-type="fig">1</xref>Gii-iii), and dPSSM scores failed to predict immunogenicity on cross-species test datasets (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S2D, ‘<xref rid="Sec4" ref-type="sec">Methods</xref>’).</p>
      <p id="Par76">Third, we observed that high reported performance from the latest models incorporating peptide-HLA pairs might be driven by HLA bias from an imbalanced dataset. Recently, deep learning models incorporating peptide-HLA pairs reported ROC-AUC of ~ 0.85 by 10-fold cross-validation [<xref ref-type="bibr" rid="CR15">15</xref>] (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S2E-F). While they reported the highest accuracy to date, we observed poor performance on SARS-CoV-2 peptides in our benchmarking study [<xref ref-type="bibr" rid="CR7">7</xref>]. Here, we hypothesised that this poor agreement may be due to differences in datasets and investigated the cause of disagreement.</p>
      <p id="Par77">First, we evaluated the ability of the model to discriminate Positive vs. Negative bound on the same HLA allele. We trained and tested models in single HLA level on HLA-A*02:01 and HLA-A*24:02, which had the highest numbers of characterised peptides per HLA. We then compared them to the model trained using the same number of randomly sampled pMHCs (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S2G). Here, the model showed marginally better than random performance on the balanced HLA-A*02:01 dataset (Fig. <xref rid="Fig1" ref-type="fig">1</xref>H), and high variation on the relatively imbalanced and smaller HLA-A*24:02 dataset (Fig. <xref rid="Fig1" ref-type="fig">1</xref>I). We further found that HLA-balanced data substantially reduces classifier performance (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S2H, Fig. <xref rid="Fig1" ref-type="fig">1</xref>J), suggesting that current models are skewed towards classifying for certain over- or under-represented HLA alleles and their reported performance does not reflect their real-world accuracy.</p>
    </sec>
    <sec id="Sec20">
      <title>Mitigate HLA bias by employing peptide sequences at TCR contact positions</title>
      <p id="Par78">Previous studies reported the contribution of anchor positions (i.e. position 2 (P2) and P9 of 9aa peptide) for MHC binding [<xref ref-type="bibr" rid="CR68">68</xref>] and contact positions (i.e. P3-P8) in T-cell recognition [<xref ref-type="bibr" rid="CR13">13</xref>]. Correspondingly, HLA supertypes drove the clustering of peptides at anchor positions (Fig. <xref rid="Fig2" ref-type="fig">2</xref>A) and TCR specificities at contact positions (Fig. <xref rid="Fig2" ref-type="fig">2</xref>B,C, Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S3A-B) on our data, with peptides bound by the same TCR showing conserved motifs (Fig. <xref rid="Fig2" ref-type="fig">2</xref>D). However, because of the strong conserved pattern in anchor positions, the HLA supertype not only drove the clustering of peptides at anchor positions but also acted as the strongest covariate driving the clustering of peptides in full sequence (Fig. <xref rid="Fig2" ref-type="fig">2</xref>E, Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S3C). With such a strong conserved pattern, MHC binding features may dominate immunogenicity predictions when the full peptide sequence is used for model training. In fact, we observed that some of the existing immunogenicity classifiers were more capable of predicting dominant HLA type (i.e. whether peptides were bound to HLA-A*02:01 or not) than peptide immunogenicity [<xref ref-type="bibr" rid="CR7">7</xref>]. As we aimed to predict T-cell recognition potential once peptides are bound to HLA alleles, we incorporated contact positions only, i.e. positions 3–8 (P3-P8) of 9aa peptide and P3-P9 of 10aa peptides, not only to focus on T-cell recognition patterns, but also to rule out the need to balance the number of epitopes vs. non-epitopes by the HLA supertypes for model development.<fig id="Fig2"><label>Fig. 2</label><caption><p>Effect of anchor and contact positions on peptide immunogenicity. <bold>A</bold> t-SNE embedding of peptides, coloured by HLA supertypes. Peptides at anchor positions (i.e. P2 and P9 of 9aa peptides) were represented by amino acid descriptors (aaDescriptors) and all amino acids across the peptide sequence were averaged to compute peptide-wide aaDescriptors. Each peptide was represented by positional (only at anchor positions) and peptide-wide aaDescriptors. <bold>B</bold>, <bold>C</bold> t-SNE embedding of peptide-wide descriptors and amino acids at contact positions, coloured by cognate TCRs for 9aa peptides (<bold>B</bold>) and 10aa peptides (<bold>C</bold>). <bold>D</bold> Sequence logos of peptides recognised by the same TCR, coloured by the physicochemical properties. Notably, these are examples of TCRs having the most cognate peptides in the database. However, except for the first TCR, the low number of peptides may limit statistical confidence in representing sequence conservation. <bold>E</bold> t-SNE embeddings of peptide-wide descriptors and amino acids at all positions, coloured by HLA supertype (left), immunogenicity (middle) and species of origin (right). <bold>F</bold> Distribution of intra-HLA and inter-HLA variation for peptides having different peptide-HLA entries. The variation described by ANOVA means squared</p></caption><graphic xlink:href="13073_2023_1225_Fig2_HTML" id="MO2"/></fig></p>
      <p id="Par79">To take such an approach, we first investigated whether neglecting HLA information would not result in a significant loss of information when predicting T-cell recognition potential of MHC-presented peptides from the current dataset. First, a novel metric was developed for converting qualitative measurements (i.e. Positive or Negative) to a quantitative ‘positivity score’ that reflects confidence in the immunogenicity (‘<xref rid="Sec4" ref-type="sec">Methods</xref>’). Briefly, the metric took into account (a) the number of experiments conducted (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S4A), (b) the percentage tested positive (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S4B) and (c) the number of cognate TCRs where available (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S4C) to compute the positivity score (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S4D).</p>
      <p id="Par80">Using the positivity scores of each peptide-HLA entry, the extent of inter-HLA variation (i.e. variation across different HLA alleles) was compared to intra-HLA variation (i.e. variation within the same HLA allele) for peptides bound on multiple HLA alleles. The intra-HLA variation accounted for the majority of data variability, while inter-HLA variation contributed less (Fig. <xref rid="Fig2" ref-type="fig">2</xref>F). This is because other biological (e.g. different effector cell, antigen presenting cells etc.) or technical (e.g. assay type, culture conditions, research groups etc.) factors were causing greater discrepancies in positivity score than HLA alleles (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S4E-F). This implied that when it came to each peptide, there was not much difference in the immunogenicity based on the HLAs to which it was bound, but when it came to HLAs, each HLA had a different pool of peptides, resulting in a different distribution of positive and negative peptides, resulting in HLA bias. As a result, an HLA-generalised approach was adopted in which peptide-HLA binding information was used instead of the HLA allele itself.</p>
    </sec>
    <sec id="Sec21">
      <title>Deep learning architecture captures T-cell recognition motifs</title>
      <p id="Par81">As the potential causes of poor performance, previous sections discussed limited training dataset, HLA bias and out-of-distribution (OOD) generalisation problem. These issues were addressed in TRAP by (a) using peptide sequence at contact positions, (b) building separate models for pathogenic and self-peptides, (c) encoding peptide sequences using amino acid properties derived from protein transformer-based pre-trained language models (PLMs), (d) devising one-dimensional convolutional neural network (1D CNN) architecture designed to capture T-cell recognition motifs and (e) employing OOD detection module. These novel strategies enabled TRAP to offer more accurate and reliable predictions of CD8 + T-cell targets against cancer and viral diseases.</p>
      <p id="Par82">First, pathogenic and self-antigen datasets were prepared to build context-specific models (‘<xref rid="Sec4" ref-type="sec">Methods</xref>’). Briefly, the pathogenic dataset is a subset of the PeptideTcell data, comprising only pathogen-derived peptides (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S5A). For the self-antigen dataset, autoantigens, tumour-associated antigens and cancer neoepitopes were retrieved from Cancer peptide database, dbPepNeo, IEDB, McPAS-TCR and NEPdb databases as epitopes, and benign HLA-I ligands expressed in thymus as non-epitopes (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S5B-C).</p>
      <p id="Par83">Given the lack of non-immunogenic self-peptides, we used HLA-I ligands expressed in the thymus as ‘non-immunogenic’ peptides in the self-antigen model. T-cells are selected within the thymus to establish a repertoire that is pathogen-protective but not self-reactive. While self-peptides are used in both positive and negative selections, we reasoned that self-peptides expressed in the thymus are unlikely to be immunogenic in the periphery for the following reasons. First, self-peptides will eliminate high-affinity or strong-response T-cells, leaving no repertoire to recognise these peptides [<xref ref-type="bibr" rid="CR69">69</xref>]. Second, while T-cells may recognise self-peptides through positive selection, it is theorised that the interactions are very weak and that once T-cells leave the thymus, they will not be able to induce an immune response to that same antigen due to the low affinity, but will instead react to another peptide that was not present in the thymus and has a higher affinity [<xref ref-type="bibr" rid="CR70">70</xref>, <xref ref-type="bibr" rid="CR71">71</xref>]. Hence, we reasoned that thymus-expressing peptides would not be immunogenic, either because they cause the elimination of strong-response T-cells or because they promote the retention of low-affinity T-cells, allowing the formation of a T-cell repertoire that avoids self-reactivity in general. To our knowledge, this is the first study to use the concept of thymic selection in classifying self-epitopes from non-epitopes.</p>
      <p id="Par84">Second, because peptides vary in lengths, we investigated the optimal padding strategy for aligning 6-mer with 7-mer contact position peptides. The predictive accuracies of simple dense layer classification, 1D CNN, 2D CNN and bidirectional recurrent neural network (biRNN) models were evaluated using pre- and post-padding strategies. No significant difference was observed across pathogenic and self-antigen data, with pre-padding achieving slightly better performance in self-antigen data on the BiRNN model (Fig. <xref rid="Fig3" ref-type="fig">3</xref>A). Furthermore, the relative location of k-gram motifs was compared on 6-mer and 7-mer peptides, and many 3-g motifs found at P3 of the 9aa peptide were found at P4 of the 10aa peptide (Fig. <xref rid="Fig3" ref-type="fig">3</xref>B). Therefore, to align T-cell recognition hotspots with biological context, peptides of shorter length were pre-padded to align with longer peptides.<fig id="Fig3"><label>Fig. 3</label><caption><p>Optimise TRAP architecture. <bold>A</bold> Performance of pre- and post-padding strategies. ROC-AUC values of respective deep learning models with pre- vs. post-padding strategies for pathogenic (i) and self-antigens (ii). Each point represents the ROC-AUC value from one round of 10-fold cross-validations. <bold>B</bold> Example of n-grams found in both 9aa and 10aa peptides, coloured by the start position of the respective n-gram in the peptides. <bold>C</bold> Comparing amino acid embedding strategies. ROC-AUC values of a single dense classification prediction using different encoding strategies, including one-hot encoding (OHE), amino acid descriptors (aaDescriptors) and embeddings from protein transformer-based PLMs on pathogenic peptides (i) and self-antigens (ii). Each point represents the ROC-AUC value from one round of 10-fold cross-validations. <bold>D</bold> Comparing the performance of different deep learning architectures. ROC-AUC values comparing the performance of different machine learning and deep learning architectures using embeddings from 5 protein transformer-based PLMs for pathogenic (i) and self-peptides (ii). XGBOOST: an extreme gradient boosting. BiRNN: bidirectional recurrent neural network. BiLSTM: bidirectional Long short-term memory. 1DCNN: 1-dimensional convolutional neural network. 2DCNN: 2-dimensional CNN. Each point represents ROC-AUC value from one round of 10-fold cross-validations. <bold>E</bold> Schematic diagram of the model incorporating MHC binding and hydrophobicity. <bold>F</bold> Adding hallmarks of the immunogenicity. ROC curve comparing the performance of models after adding MHC binding rank score and/or hydrophobicity to peptide sequence-based 1D CNN model for pathogenic (i) and self-peptides (ii)</p></caption><graphic xlink:href="13073_2023_1225_Fig3_HTML" id="MO3"/></fig></p>
      <p id="Par85">Third, to address data limitation, we adopted transfer learning to encode peptides using amino acid properties derived from protein transformer-based pre-trained language models (PLMs). The protein transformer-based PLMs were trained using millions to billions of protein sequences and carry the most representative 1024 embeddings, which describe the physicochemical, structural or electrostatic properties of amino acids in protein space [<xref ref-type="bibr" rid="CR33">33</xref>]. The performance of classification models were compared when peptides were encoded by one-hot-encoding (OHE), amino acid descriptors and embeddings from five protein transformer-based PLMs (‘<xref rid="Sec4" ref-type="sec">Methods</xref>’). ProtT5-XL-UniRef showed the highest performance, with an average ROC-AUC of 0.72 for pathogenic (Fig. <xref rid="Fig3" ref-type="fig">3</xref>Ci) and 0.724 for self-antigen datasets (Fig. <xref rid="Fig3" ref-type="fig">3</xref>Cii).</p>
      <p id="Par86">Fourth, the capability of different machine learning and deep learning architectures to classify immunogenicity potential was assessed. The performances of XGBOOST, BiRNN, bidirectional long short-term memory (BiLSTM), 1D CNN, 2D CNN and transformer models were compared. Briefly, RNNs or LSTMs are popular sequential models efficient in addressing sequential text data [<xref ref-type="bibr" rid="CR72">72</xref>], whereas CNNs are suitable for scanning across text or images and detecting local patterns by using ‘kernels’. 1D CNNs have widely been used for text and 2Ds for image classifications [<xref ref-type="bibr" rid="CR73">73</xref>]. The 1D CNN model using ProtT5-XL-UniRef embeddings achieved the highest average ROC-AUC of 0.74 for pathogenic (Fig. <xref rid="Fig3" ref-type="fig">3</xref>Di) and 0.75 for self-antigens (Fig. <xref rid="Fig3" ref-type="fig">3</xref>Dii). We surmised that T-cell recognition motifs captured by the 1D CNN model have more predictive power than sequential relationship captured by the RNN-based models.</p>
      <p id="Par87">In addition to peptide sequences, we examined whether incorporating other hallmarks of immunogenicity, such as predicted MHC binding rank score [<xref ref-type="bibr" rid="CR12">12</xref>, <xref ref-type="bibr" rid="CR16">16</xref>] and hydrophobicity [<xref ref-type="bibr" rid="CR20">20</xref>], can further improve the performance. Particularly, given that the current model only takes contact positions into account, adding MHC binding rank would allow the model to accommodate peptide-MHC binding information. This strategy has several advantages. First, it feeds the binding information with a minimal HLA-associated bias, circumventing the need to balance the training data by HLAs. Second, the most accurate binding information from NetMHCpan prediction can be incorporated without having to re-train the model using a massive peptide-HLA binding data. By integrating MHC binding rank and hydrophobicity as fully connected layers (i.e. Multilayer perceptrons, MLPs) and optimising hyperparameters (Fig. <xref rid="Fig3" ref-type="fig">3</xref>E, ‘<xref rid="Sec4" ref-type="sec">Methods</xref>’), performance was improved to an average ROC-AUC of 0.76 for pathogenic (Fig. <xref rid="Fig3" ref-type="fig">3</xref>Fi) and 0.87 for self-antigens (Fig. <xref rid="Fig3" ref-type="fig">3</xref>Fii). It is worth noting that, in comparison to the pathogenic model, the number of self-epitopes is limited, and the additional MHC rank filter significantly reduced the training dataset. Therefore, we trained another self-antigen model with a relaxed threshold (MHC rank = 10 instead of 2) to account for as many self-epitopes as possible, resulting a training dataset of 12,521 peptides for accurate extraction of differential sequence patterns (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S5D).</p>
      <p id="Par88">Therefore, representing peptide sequences at contact positions by ProtT5-XL-UniRef amino acid embeddings, extracting T-cell recognition motifs by 1D CNN kernels, and adding MHC binding rank and hydrophobicity as MLPs could effectively achieve superior performance in classifying immunogenicity.</p>
    </sec>
    <sec id="Sec22">
      <title>Sequence patterns discriminating immunogenicity</title>
      <p id="Par89">Among different architectures, the 1D CNN model that captures local motifs achieved the best performance. Moreover, extensive screening of pMHC library against a single TCR revealed dominant hotspots or motifs in the cognate peptides [<xref ref-type="bibr" rid="CR74">74</xref>, <xref ref-type="bibr" rid="CR75">75</xref>]. We therefore set out to expand this observation and explore the enrichment of n-grams (i.e. contiguous sequence of n-amino acids) [<xref ref-type="bibr" rid="CR76">76</xref>] and position-specific k-mer motifs (i.e. contiguous or non-contiguous sequence of k amino acids at specific positions) in contact residues of pathogenic and self-peptides.</p>
      <p id="Par90">We first computed the ratio (in normalised frequency) of n-gram or positions-specific k-mer motifs between epitopes and non-epitopes (‘<xref rid="Sec4" ref-type="sec">Methods</xref>’). The top-ranking n-grams were GIG, GINA, GIF, LGIN, VEG and SGSP for pathogenic epitopes and SC, GIGI, IC, QC and CA for self-epitopes (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S6C). In addition, top position-specific k-mer motifs were.EG.L.,.E.IL. and.GIG… for pathogenic epitopes and GIG..,..M.P.,.G.GI.., and AGI…. for self-epitopes (Additional files <xref rid="MOESM4" ref-type="media">4</xref> and <xref rid="MOESM5" ref-type="media">5</xref>). Notably, GIG, which was previously associated with DMF5 TCR, was one of the top n-grams and position-specific k-mer motifs.</p>
      <p id="Par91">To identify sequence patterns enriched in both pathogenic and self-epitopes, we compared n-grams and position-specific k-mer motifs from each analysis. The 48 n-grams and total 298 position-specific k-mer motifs from 9 and 10aa peptides (Fig. <xref rid="Fig4" ref-type="fig">4</xref>A) were shared between pathogenic and self-epitopes. These include GIG, GINA, GMP, ALGI and APTG n-grams (Fig. <xref rid="Fig4" ref-type="fig">4</xref>B, Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S6D), and ….VP, W..P..,.G.GI.., and.GIG… position-specific k-mer motifs (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S6E-G).<fig id="Fig4"><label>Fig. 4</label><caption><p>Out-of-distribution detection using calibration methods. <bold>A</bold> Identifying motifs that are enriched in both pathogenic and self-epitopes. Venn diagram comparing the enriched n-grams (left) or position-specific k-mer motifs from 9aa (middle) or 10aa peptides (right) between pathogenic and self-peptides. <bold>B</bold> Normalised enrichment ratio of shared n-grams enriched in both pathogenic and self-epitopes. <bold>C</bold> Clusters of peptides with high sequence similarity in contact positions, demonstrated by pairwise global alignment scores. Network graph illustrating the pairwise global alignment score between 9aa pathogenic peptides. Shown are peptides having ≥ 22 alignment scores with ≥ 3 other peptides. <bold>D</bold>–<bold>G</bold> Distribution of different calibration-based metrics on pathogenic (i) and self-(ii) peptides, discriminating correctly vs. incorrectly predicted peptides. The calibration-based metrics include maximum softmax probability (MaxProb) (<bold>D</bold>), temperature scaling using different levels of temperatures that scale the logit values (<bold>E</bold>), the maximum on average softmax probability over 10 ensembled models (MaxProb on Avg) (<bold>F</bold>) and maximum on average softmax probability from Monte Carlo dropout iterations (<bold>G</bold>). The Monte Carlo models were reiterated 100 times with stochastic dropouts of 0.6. T: temperature. Statistical significance by <italic>p</italic>-values from Student’s <italic>t</italic> test. ns: non-significant. <bold>H</bold> Venn diagram comparing the pathogenic peptide predictions using different calibration metrics. MCDropout: Monte Carlo Dropout. I. ROC curve illustrating the performance of the out-of-distribution (OOD) linear regression classifiers using MCDropout on pathogenic (i) and self-peptides (ii)</p></caption><graphic xlink:href="13073_2023_1225_Fig4_HTML" id="MO4"/></fig></p>
      <p id="Par92">Furthermore, we computed pairwise global alignment scores across pathogenic peptides to identify clusters of epitopes sharing high sequence homology (‘<xref rid="Sec4" ref-type="sec">Methods</xref>’). Plotting highly similar peptides revealed clusters dominated by Positive peptides (Fig. <xref rid="Fig4" ref-type="fig">4</xref>C). These clusters contained peptides having patterns, such as YNTI… FG(Y/F)PV(F/Y). F(E/D)(K/R)S.., G.GW...DR.WC, GPG.R.P, P.DFFP.,.GIGI..,.DRGM., VALG.NA. and.LGLNA (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S5H-I).</p>
      <p id="Par93">Our analyses therefore suggest that TCR contact positions of immunogenic peptides exhibit preferences towards presenting certain motifs while disfavouring others. We also observed similarities and differences between pathogenic and self-peptides. The toolkits for analysing differential sequence patterns between peptides of the same length are developed as a R diffSeqPatterns package. We believe these shortlisted sequence patterns can be target for functional validations in identifying immune hotspots.</p>
    </sec>
    <sec id="Sec23">
      <title>Detect low-confidence predictions to improve robustness</title>
      <p id="Par94">While the DNN models could achieve higher accuracies than existing models, they are nonetheless far from making a perfect prediction. Partially due to the limited number of peptides characterised to fill the full combinatorial peptide space, the performance of sequence-based model drops substantially in predicting peptides non-homologous to those of training data, called the out-of-distribution (OOD) generalisation problem [<xref ref-type="bibr" rid="CR43">43</xref>]. In contexts where incorrect predictions can have severe consequences such as in healthcare or security, using model uncertainty to decide when to trust or abstain the prediction can facilitate rejecting false predictions and improving model accuracy.</p>
      <p id="Par95">There are generally two types of OODs: background shift (i.e. a shift in population-level features that do not depend on classification labels) and semantic shift (i.e. a shift in features that are correlated with the context and label) [<xref ref-type="bibr" rid="CR45">45</xref>]. In previous NLP studies, density or proximity-based models were found to be better at detecting background shifts, while calibration methods (i.e. using model’s prediction confidence) performed better at semantic shifts. In our study, the greatest OOD came from peptides originating from different species that have moderately different features associated with immunogenicity (i.e. semantic features). This aligns with previous findings that the majority of OOD stems from the semantic shift and thus calibration methods generally outperform proximity-based methods (i.e. autoencoder reconstruction) [<xref ref-type="bibr" rid="CR45">45</xref>].</p>
      <p id="Par96">Here, several OOD detection methods were tested to detect low-confidence predictions. Different autoencoder architectures, which are often used for anomaly detection, were first investigated [<xref ref-type="bibr" rid="CR61">61</xref>] (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S7A-F, ‘<xref rid="Sec4" ref-type="sec">Methods</xref>’). However, we observed no significant difference in reconstruction loss between correctly and incorrectly predicted peptides, implying that the autoencoder-based methods cannot effectively identify OOD inputs.</p>
      <p id="Par97">Therefore, calibration methods such as maximum softmax probability (MaxProb), temperature scaling, MaxProb from averaged softmax probability from ensemble of 10 models (called Ensemble) and MaxProb from averaged softmax probability from 100 Monte Carlo dropouts (called MCDropout) were tested, because they were reported to effectively detect semantic shifts (‘<xref rid="Sec4" ref-type="sec">Methods</xref>’). We observed that all four methods could significantly differentiate correct vs. incorrect predictions for both pathogenic and self-antigens (Fig. <xref rid="Fig4" ref-type="fig">4</xref>D–G). We also observed that these metrics produce similar profile of correctly and incorrectly predicted peptides (Fig. <xref rid="Fig4" ref-type="fig">4</xref>H, Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S7H). Therefore, we trained a linear regression model on MCDropout, which proved to be the most robust on cross-species dataset (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S7G, Method). The linear regression models could achieve average ROC-AUC of 0.65 for pathogenic and 0.82 for self-antigens (F <xref rid="Fig4" ref-type="fig">i</xref>g. <xref rid="Fig4" ref-type="fig">4</xref>I). With these, a MCDropout-based OOD detection module was introduced downstream of 1D CNN model prediction to report peptides that are likely to have a correct prediction.</p>
    </sec>
    <sec id="Sec24">
      <title>Relative Similarity to Autoantigens or Tumour-associated antigens (RSAT) as a novel feature of pathogenic peptide immunogenicity</title>
      <p id="Par98">We and others [<xref ref-type="bibr" rid="CR23">23</xref>, <xref ref-type="bibr" rid="CR77">77</xref>] have shown that some of the highly predictive metrics found from cancer neoepitope studies, such as ‘dissimilarity to self’, may not be applicable to pathogenic peptides. To address this, we present an alternative solution, termed a relative similarity to autoantigens or tumour-associated antigens (RSAT), to estimate the immunogenicity potential of pathogenic peptides. For pathogenic peptides that suffer from low-confidence prediction, RSAT can provide an additional estimate of immunogenicity potential.</p>
      <p id="Par99">The ‘dissimilarity to self’ stems from the paradigm of negative selection where T-cells that bind strongly to self-peptides should have been negatively selected and thus no T-cell repertoire should be present to bind peptides homologous to self-proteome [<xref ref-type="bibr" rid="CR21">21</xref>, <xref ref-type="bibr" rid="CR22">22</xref>] (Fig. <xref rid="Fig5" ref-type="fig">5</xref>A). However, there is another side of the story where T-cells that have low or moderate binding to self-peptides should have been positively selected. In fact, recent studies attributed the inability of the immune system to recognise a large number of pathogenic peptides—most of which are highly dissimilar to human proteome—to the mechanism of positive selection where only T-cells bound by low or moderately binding self-peptides survive to trigger an immune response [<xref ref-type="bibr" rid="CR77">77</xref>]. Therefore, we hypothesised that pathogenic peptides homologous to immunogenic self-peptides, such as autoantigens or tumour-associated antigens, may be more likely to trigger an immune response, and assessed whether relative similarity to autoantigens or tumour-associated antigens compared to reference human proteome can be a predictor of immunogenicity for pathogenic peptides.<fig id="Fig5"><label>Fig. 5</label><caption><p>Relative similarity to autoantigens and tumour-associated antigens (RSAT). <bold>A</bold> Schematic of positive and negative selection of T-cells in thymus. <bold>B</bold> Number of self-peptides, such as cancer neoepitopes, autoantigens and tumour-associated antigens, retrieved from different databases. <bold>C</bold> Distribution of Match score between pathogenic peptides and best self-peptide counterparts. Contains the Cohen’s <italic>d</italic> value showing the effect sizes differentiating positives versus negatives as well as the number of positive and negative peptides in each species. Cohen’s <italic>d</italic> values describe effective sizes, which are small (<italic>d</italic> = 0.2), medium (<italic>d</italic> = 0.5) and large (0.8). <bold>D</bold> RSAT of pathogenic peptides that have comparable self-antigen counterparts (by match score ≥ 0.6). <bold>E</bold>, <bold>F</bold> RSAT can effectively discriminate pathogenic epitopes from non-epitopes of varying lengths and species. <bold>E</bold> Distribution of RSAT for pathogenic peptides having 9aa (left) and 10aa (right) in length. <bold>F</bold> RSAT of peptides derived from different pathogens</p></caption><graphic xlink:href="13073_2023_1225_Fig5_HTML" id="MO5"/></fig></p>
      <p id="Par100">To test our hypothesis, 5023 unique Autoimmunity, Allergy or Tumour-associated antigens (AATs) were retrieved from NEPdb [<xref ref-type="bibr" rid="CR52">52</xref>], dbPepNeo [<xref ref-type="bibr" rid="CR50">50</xref>], McPAS-TCR [<xref ref-type="bibr" rid="CR51">51</xref>], IEDB [<xref ref-type="bibr" rid="CR49">49</xref>] and cancer antigenic peptide database (<ext-link ext-link-type="uri" xlink:href="https://caped.icp.ucl.ac.be">https://caped.icp.ucl.ac.be</ext-link>) (Fig. <xref rid="Fig5" ref-type="fig">5</xref>B). We then computed the similarity between pathogenic peptides and AATs, and only retained pathogenic peptides having comparable AAT counterparts (‘<xref rid="Sec4" ref-type="sec">Methods</xref>’). On these pathogenic peptides, we then computed the similarity between pathogenic peptide and AAT’s closest human proteome counterparts, and the ratio between the two, i.e. <italic>r</italic>elative <italic>s</italic>imilarity of the pathogenic peptide to <italic>a</italic>utoantigens or <italic>t</italic>umour-associated antigens (named RSAT).</p>
      <p id="Par101">From pathogenic data, 346/3793 pathogenic epitopes and 295/6080 non-epitopes had comparable AAT counterparts by a threshold match score of 0.6 (Method, Fig. <xref rid="Fig5" ref-type="fig">5</xref>C). The RSAT was computed on these peptides and found a significant difference between epitopes vs. non-epitopes (Fig. <xref rid="Fig5" ref-type="fig">5</xref>D) across peptide lengths 9 and 10aa (Fig. <xref rid="Fig5" ref-type="fig">5</xref>E), and across different pathogenic species (Fig. <xref rid="Fig5" ref-type="fig">5</xref>F), indicating that RSAT could effectively classify peptides of varying lengths and pathogen species. Despite the fact that each species had a limited number of peptides, epitopes had higher RSAT values with low (SARS-CoV-2 and <italic>M. tuberculosis</italic>), medium (EBV) or high (HCV and vaccinia virus) effect sizes.</p>
      <p id="Par102">Here, we developed a novel metric, RSAT, to estimate the immune potential of pathogenic peptides based on relative similarity to known auto- or tumour-associated epitopes. We demonstrated that RSAT can effectively discriminate epitopes of different lengths and pathogens. The RSAT is available as a separate module in the TRAP GitHub repository and is recommended to be used in conjunction with TRAP when the pathogenic peptides have low prediction confidence. We appreciate that the low number of Autoimmunity, Allergy or Tumour-associated antigens (AATs) limits the use of RSAT on a broader range of peptides. However, we envision that as data becomes more abundant, RSAT can become more popular.</p>
    </sec>
    <sec id="Sec25">
      <title>Benchmark TRAP performance to state-of-the-art algorithms</title>
      <p id="Par103">The performance of TRAP was benchmarked against existing immunogenicity models, namely NetTepi, IEDB, PRIME, DeepImmuno and TESLA by 10-fold cross-validation on the same datasets (‘<xref rid="Sec4" ref-type="sec">Methods</xref>’). Due to the nature of the existing models, HLA-agnostic predictions were performed for IEDB, iPred, NetTepi PRIME and Repitope, and HLA-restrictive prediction for DeepImmuno. TRAP was able to make both HLA-agnostic and restrictive predictions by incorporating the peptide sequence at contact positions and MHC as a rank score. The HLA-restrictive prediction was made using HLA-balanced data where the number of epitopes and non-epitopes were balanced per HLA to validate their prediction irrespective of HLA-associated bias.</p>
      <p id="Par104">TRAP was the best self-antigen model, achieving ROC-AUC of 0.931 for HLA-agnostic and 0.703 for HLA-restrictive predictions (Fig. <xref rid="Fig6" ref-type="fig">6</xref>A, Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S8A). It was also one of the best pathogenic models, with ROC-AUC of 0.751 for HLA-agnostic and 0.709 for HLA-restrictive predictions (Fig. <xref rid="Fig6" ref-type="fig">6</xref>B, Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S8B).<fig id="Fig6"><label>Fig. 6</label><caption><p>Benchmark TRAP performance and use it to identify tumour antigens in glioblastoma. <bold>A</bold>, <bold>B</bold> ROC curve comparing the performance of TRAP with existing models, such as IEDB, iPred, NetTepi, PRIME, Repitope and DeepImmuno for self- (<bold>A</bold>) and pathogenic peptides (<bold>B</bold>). Due to the nature of these models, IEDB, iPred, NetTepi PRIME and Repitope were predicted in an HLA-agnostic manner (i.e. by peptide sequence only) (i), and DeepImmuno predicted in an HLA-restrictive manner (i.e. by peptide-HLA) using HLA-balanced data (ii). <bold>C</bold> ROC curve comparing the performance of TRAP and Repitope that have been trained using 1511 Non-Wuhan SARS-CoV-2 peptides by 10-fold cross-validations. <bold>D</bold> ROC curve comparing the performance of Non-Wuhan SARS-CoV-2 trained TRAP and Repitope models in predicting 66 Wuhan SARS-CoV-2 peptides. <bold>E</bold>–<bold>J</bold> Application of TRAP in identifying glioblastoma neoepitopes. <bold>E</bold> Confusion matrix of GBM cancer neoepitope prediction using self-antigen TRAP model in reference to T-cell assay readout. <bold>F</bold> ROC curve of TRAP performance on GBM dataset. <bold>G</bold> Distribution of MCDropout values for GBM peptides predicted to be non-immunogenic. <bold>H</bold> The proportion of GBM epitopes (Positive) and non-epitopes (Negatives) predicted Positive or Negative with high or low confidence based on MCDropout. The confidence has been determined by the self-antigen out-of-distribution linear regression classifier at threshold 0.76. I. ROC curve of TRAP performance taking confidence into account, in which peptides that were predicted Negative with low confidence were removed to be considered as the potential epitope candidates. <bold>J</bold> Confusion matrix of TRAP prediction after taking the confidence into account, in which peptides that were predicted Negative with low confidence were included as Positive</p></caption><graphic xlink:href="13073_2023_1225_Fig6_HTML" id="MO6"/></fig></p>
      <p id="Par105">While Repitope slightly outperformed TRAP in pathogenic datasets, the robustness of TRAP predictions was assessed on emerging pathogens. The coronavirus TRAP and Repitope models were trained using 1511 coronavirus peptides except Wuhan SARS-CoV-2 peptides (Fig. <xref rid="Fig6" ref-type="fig">6</xref>C), and then used to predict the immunogenicity of 66 Wuhan SARS-CoV-2 peptides (Fig. <xref rid="Fig6" ref-type="fig">6</xref>D). Given that they are derived from the same family, the coronavirus peptides in the training dataset would share high homology with those in the test dataset, and we aimed to demonstrate the model’s ability to make accurate predictions on homologous peptides in comparison to other models. We found that TRAP was better at extracting immunogenicity-related features from limited data of emerging pathogens, and translating them onto related species (Fig. <xref rid="Fig6" ref-type="fig">6</xref>D).</p>
      <p id="Par106">Therefore, TRAP can predict CD8 + T-cell epitopes in both HLA-agnostic and restrictive contexts, and performed better in both. The TRAP can also make accurate predictions about emerging pathogens and is suitable for shortlisting therapeutic candidates when data is limited.</p>
    </sec>
    <sec id="Sec26">
      <title>Application of TRAP to identify glioblastoma neoantigens</title>
      <p id="Par107">Here, we demonstrate how the TRAP can be used for identifying cancer neoepitopes from glioblastoma patients. We previously sequenced the tumours of four HLA-A2 glioblastoma patients and shortlisted the cancer neoepitopes by using an in-house version of MuPeXI [<xref ref-type="bibr" rid="CR65">65</xref>] codenamed TUNAPASTA v0.5. This method ranked peptides by the immunogenicity potential, taking into account NetMHCpan affinity, gene expression level, and mutant allele frequency. We then selected 153 predicted epitopes for functional validation, of which 33 were characterised positive by T-cell assay [<xref ref-type="bibr" rid="CR64">64</xref>]. With only a small proportion of the shortlisted candidates found to be positive, the other existing models showed comparable levels of performance, PR-AUC ranging from 0.201 to 0.437 in our benchmarking study [<xref ref-type="bibr" rid="CR7">7</xref>].</p>
      <p id="Par108">Of the 153 tested peptides, we filtered out predicted HLA-A*02:01 non-binders and retained 9–10 amino acids peptides that were applicable to TRAP. This left 124 GBM peptides, of which 25 were characterised to be immunogenic and 99 non-immunogenic by T-cell assays. Of these, TRAP predicted 9/25 epitopes to be Positives and 84/99 non-epitopes to be Negatives (Fig. <xref rid="Fig6" ref-type="fig">6</xref>E), yielding 0.75 accuracy with ROC-AUC of 0.684 (Fig. <xref rid="Fig6" ref-type="fig">6</xref>F).</p>
      <p id="Par109">Identifying cancer neoepitopes is typically regarded as a ‘needle in a haystack’ problem in which an extremely small number of positives are sought from vastly imbalanced data. In this scenario, minimising the loss of true Positives from the candidate list was regarded to be more important than maximising accuracy. Therefore, we examined the confidence of predictions using the out-of-distribution detection module (Fig. <xref rid="Fig6" ref-type="fig">6</xref>G) and found that many incorrectly predicted Negatives had low-confidence predictions (Fig. <xref rid="Fig6" ref-type="fig">6</xref>H). By adding them to the candidate list, 28 more glioblastoma antigens were predicted positive, yielding 16/25 epitopes (Fig. <xref rid="Fig6" ref-type="fig">6</xref>I) and ROC-AUC of 0.734 (Fig. <xref rid="Fig6" ref-type="fig">6</xref>J).</p>
      <p id="Par110">Here, we applied TRAP for shortlisting glioblastoma cancer neoepitopes and showed that TRAP not only outperforms existing algorithms but also allow optimising candidates to minimise loss of likely epitopes.</p>
    </sec>
  </sec>
  <sec id="Sec27">
    <title>Discussion</title>
    <p id="Par111">In this study, we present TRAP, a robust deep learning workflow for predicting CD8 + T-cell epitopes from MHC-I presented pathogenic and self-peptides. To address the current limitations, we used peptide sequences only at contact positions to avoid HLA bias caused by capturing dominant HLA binding features at anchor positions. Second, we built separate models for pathogenic and self-peptides to address the out-of-distribution generalisation problem. Third, to overcome data limitations, we encoded peptide sequences using amino acid properties derived from protein transformer-based pre-trained language models (PLMs). This enabled more information about the physicochemical, electrostatic or biophysical properties of amino acids to be fed into the system. Fourth, we captured T-cell recognition motifs using a one-dimensional convolutional neural network (1D CNN) architecture. Fifth, we added the MHC binding rank score predicted by the most accurate algorithm (NetMHCpan) to provide the information about MHC binding. Lastly, we devised an out-of-distribution detection module to abstain from low-confidence predictions for peptides that are very different from those in the training dataset. By taking these novel approaches, TRAP offers a more robust prediction compared to other machine learning algorithms.</p>
    <p id="Par112">Another metric proposed to estimate immunogenicity from cancer neoepitope studies was dissimilarity to self. However, the dissimilarity to self could not be applied to pathogenic peptides because pathogens have highly heterologous sequences compared to the human proteome. Therefore, a novel metric termed RSAT (relative similarity to autoantigens or tumour-associated antigens) was developed to estimate the immunogenicity of peptides from emerging pathogens. To compensate for the high dissimilarity between pathogenic and human proteomes, this metric compares the similarity of pathogenic peptides to the reference human proteome (‘healthy’) with respect to ‘immunogenic’ self-peptides such as autoantigens or tumour-associated antigens. This allowed the identification of pathogenic epitopes despite their sequence dissimilarity to the human proteome.</p>
    <p id="Par113">The application of TRAP was demonstrated by using it to identify cancer neoepitopes from glioblastoma patients. We showed that the out-of-distribution detection module is well-suited for the ‘needle in a haystack’ problem by identifying those predicted negative with low confidence. In another study, we used TRAP to investigate the immune escape potential of SARS-CoV-2 variants [<xref ref-type="bibr" rid="CR78">78</xref>]. By combining TRAP with in silico mutagenesis, we evaluated the extent to which all possible theoretical single point mutations can give rise to variants of concern and be detrimental to T-cell immunity. Based on the groundwork of this work, using models like TRAP to systematically evaluate the impact of mutations on the emergence of deleterious pathogens will be of great interest. Emerging pathogens have posed a significant threat in recent years, and new variants and pathogens are expected to rise in the coming years [<xref ref-type="bibr" rid="CR79">79</xref>]. It is therefore critical to surveil variants of concern and assess the immune escape potential of these variants. Furthermore, in order to accurately determine deleterious variants, it is essential to assess the extent to which models trained by other pathogens can be generalised and thus used for emerging pathogens. Thus, an iterative process of refining the training data, model architecture and validating predictions should be followed to mitigate the impact of another pandemic.</p>
    <p id="Par114">For the self-antigen model, the autoantigens, tumour-associated antigens and cancer neoepitopes were collected as epitopes, and benign HLA-I ligands expressed in thymus as non-epitopes. We assumed that HLA-I ligands expressed in the thymus are involved in the selection of T-cells, and thus there is either no repertoire recognising these peptides or have weak interaction with the peptides. Notably, our novel approach of incorporating the HLA-I ligands allowed for a clearer separation of self-epitopes versus non-epitopes. When the data is limited, biological knowledge, such as thymic selection, can serve as a useful resource to bridge the data gap, and aid in the development of a more accurate classifier.</p>
    <p id="Par115">In benchmarking TRAP performance, we found that although Repitope performed well on pathogenic data, it was limited in extracting immunogenicity-related features from limited data and transferring them onto related species, resulting in poor performance on emerging pathogens. Our previous analysis revealed that Repitope was one of the models with skewed prediction for prevalent HLAs, with HLA-A*02:01-bound peptides having a higher immunogenicity score than non-HLA-A*02:01 bound peptides [<xref ref-type="bibr" rid="CR7">7</xref>]. This suggested that the model considered A02:01 binding as a superior feature to the T-cell recognition potential, skewing the prediction. While TRAP performed slightly lower on the pathogenic dataset, the HLA-generalised approach of TRAP mitigates the possibility of HLA bias. Therefore, end users should choose which model to pursue based on the peptides and HLA alleles of interest.</p>
    <p id="Par116">While these approaches improved the accuracy and robustness of the prediction, there still remains limitations. First, while the calibration methods could effectively detect incorrect prediction in a 10-fold cross-validation, they failed on the cross-species dataset (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S7G-H). We surmised this is because of ‘spurious semantic features’ (i.e. features that have discriminative power in training data but not in test data) that were driving overly confident incorrect predictions. In a recent case study, Arora et al. benchmarked calibration methods on real-world challenge data and reported that models were over-confident on the OOD examples because of spurious semantic features and often produced accuracies close to random [<xref ref-type="bibr" rid="CR45">45</xref>]. With spurious semantic shift being one of the remaining challenges in NLP, further advances in deep learning and NLP will also facilitate improving the robustness of predictions on complex biological data.</p>
    <p id="Par117">Second, following our workflow, peptides may be abstained due to low-confidence predictions. For cancer peptides, TESLA [<xref ref-type="bibr" rid="CR8">8</xref>] that incorporates generic features for neoepitope prediction could be an alternative solution. Pathogenic peptides having low-confidence predictions can be directed to RSAT to estimate the immunogenicity potential with respect to self-epitopes. However, because RSAT is only applicable to peptides with self-epitope counterparts, it has limited coverage with 346/3792 (9.1%) pathogenic epitopes currently having counterparts. Further characterisation of self-epitopes will expand RSAT coverage to embrace a broader range of pathogenic peptides.</p>
    <p id="Par118">Third, TRAP takes an HLA-generalised approach to avoid HLA bias, as the current dataset contains little intra-HLA variation in peptide immunogenicity. However, characterising peptide immunogenicity on a broader range of HLAs may provide insight into the effect of HLA on overall immunogenicity. Moreover, because the specific interaction between peptide and T-cell receptor is MHC-restricted [<xref ref-type="bibr" rid="CR80">80</xref>, <xref ref-type="bibr" rid="CR81">81</xref>], MHC-focused studies would be required to model specific TCR:pMHC recognition.</p>
    <p id="Par119">Fourth, T-cell recognition depends not only on peptide-MHC complex, but also on multiple other factors, such as cytokine microenvironment, co-stimulatory molecules in vivo and availability of TCR repertoires that are often highly stochastic and individualised [<xref ref-type="bibr" rid="CR82">82</xref>], adding complexity to T-cell activation and function [<xref ref-type="bibr" rid="CR83">83</xref>]. While there are almost no record of these determinants [<xref ref-type="bibr" rid="CR84">84</xref>], studies highlighting the influence of microenvironment on T-cell response will be pivotal to recapitulating T-cell function for therapeutic applications.</p>
    <p id="Par120">In TRAP, we incorporated peptide sequence at the contact position to gauge on T-cell recognition motifs. However, some studies showed that position 1 (P1) of 9-mer peptide may play an important role in T-cell binding, as demonstrated by P1, 3, 4, 5, 9 being critical for MAGE A3 binding by a3a-engineered T-cells [<xref ref-type="bibr" rid="CR85">85</xref>]. Although it is difficult to deconvolute the roles of different positions in MHC and T-cell binding, more studies may shed light on the role of P1.</p>
    <p id="Par121">Fifth, due to the lack of true Negative self-antigens, we retrieved benign HLA-I ligands expressed in thymus for their relevance to central tolerance. While there have been studies describing Tregs reacting to self-peptides present in the thymus [<xref ref-type="bibr" rid="CR86">86</xref>, <xref ref-type="bibr" rid="CR87">87</xref>], given that the models are targeted for CD8 + T-cells, we reasoned that majority of peptides presented by HLA class I in the thymus will be non-immunogenic. However, we acknowledge that concept of thymic selection is still evolving and that not all peptides expressed in the thymus may be involved in selection [<xref ref-type="bibr" rid="CR88">88</xref>]. On that note, some studies have shown that cTECs may generate and display distinct private self-peptides that may support the selection of T-cells with low self-reactivity in the periphery [<xref ref-type="bibr" rid="CR89">89</xref>, <xref ref-type="bibr" rid="CR90">90</xref>]. While experimental data linking the selection of ‘low self-affinity’ TCR with cTEC-displayed private peptides is still lacking, future studies characterising HLA-I ligand expressed in medulla thymic epithelial cells (mTEC) will improve confidence as ‘non-immunogenic self-antigens’.</p>
    <p id="Par122">Sixth, it will be valuable to extend the work of peptide immunogenicity to investigate the ability of peptides to be recognised by specific T-cells. Here, the peptide immunogenicity was investigated at the organismal level, i.e. whether the peptide can elicit a response from <italic>any</italic> T-cell. The limitation was largely due to the limited pool of available peptides characterised for their cognate TCRs; however, advances in screening methods will lead to availability of more comprehensive datasets in the future, thus enabling the development of more tailored immunogenicity models. It is becoming apparent that predicting specific interactions between TCR and cognate pMHCs is crucial for developing personalised therapies and tailoring vaccines or treatments to individuals’ TCR repertoire. Therefore, screening antigen-specific TCR against a larger pool of epitopes from various origins and pathologies will greatly aid in learning peptide features that allow interaction with specific TCRs.</p>
    <p id="Par123">In addition, the immunogenicity of an epitope can be altered by the presence of other epitopes, as demonstrated by immunodominance effects, in which a hierarchy exists in the magnitude of the immune response that epitopes can elicit [<xref ref-type="bibr" rid="CR91">91</xref>–<xref ref-type="bibr" rid="CR94">94</xref>]. Several factors may influence immunodominance, including competition for MHC, presentation levels, TCR affinity, timing of CTL clonal expansions, individual’s TCR diversity and/or strength of T-cell response [<xref ref-type="bibr" rid="CR95">95</xref>–<xref ref-type="bibr" rid="CR97">97</xref>]. The immunogenicity algorithms are designed to predict the peptide immunogenicity once the peptides are bound on HLA molecules. We used MHC rank as one of the parameter to describe binding affinity and relative MHC presentation levels. But, even if the peptides are stably presented, immunodominance may vary depending on an individual’s TCR diversity, T-cell affinity and/or strength of T-cell response. Therefore, while the model may serve as a useful tool to shortlist peptides for testing, additional experiments will be required to characterise their immunogenicity in presence of other epitopes. Future studies into the impact of other epitopes will aid in understanding the dynamics of immune response in the presence of multiple epitopes and foster the development of more accurate models.</p>
    <p id="Par124">Lastly, the current breadth of peptides characterised by T-cell assays is far from filling the full combinatorial peptide space, especially for CD4 + T-cell targets. Also, while this model is limited to peptide-specific binding of CD8 + T-cells, other T-cells are specific for lipid or small molecules like metabolites. As such, high-throughput screening of immune targets and antigen-specific TCRs by the help of recent technological advancement will greatly foster the process of model development.</p>
    <p id="Par125">Despite current data and model constraints, the novel computational strategies allowed TRAP to outperform existing models in predicting CD8 + T-cell epitopes and provide more robust, accurate and biologically meaningful candidates for functional validations. We believe that this workflow will foster a better understanding of TCR:pMHC interaction and aid in basic, clinical and translational research for a wide range of therapeutic applications.</p>
  </sec>
  <sec id="Sec28">
    <title>Conclusions</title>
    <p id="Par126">In summary, our study introduces TRAP, a robust deep learning framework designed to predict CD8 + T-cell epitopes from MHC-I presented pathogenic and self-peptides. Overcoming existing limitation, TRAP incorporates novel strategies to enhance predictive accuracy and confidence. Moreover, the novel metric, RSAT, addresses the challenge of immunogenicity estimation for emerging pathogens by comparing pathogenic peptides to immunogenic self-peptides. The demonstrated applications of TRAP in identifying cancer neoepitopes and assessing immune escape potential of SARS-CoV-2 variants underscored its practicality. In the face of ongoing threat posed by emerging pathogens and variants, TRAP’s ability to systematically assess the impact of mutations would be invaluable. Our study showcases the TRAP’s capacity to contribute to immunogenicity prediction, variant surveillance and neoepitope identification guided by both computational methodologies and biological understanding. Altogether, we envision models like TRAP, designed for the accurate identification of T-cell targets, will be instrumental in decoding the fundamental principles of T-cell recognition of antigens in time and space.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <sec id="Sec29">
      <title>Supplementary Information</title>
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="13073_2023_1225_MOESM1_ESM.pdf">
            <caption>
              <p><bold>Additional file 1: Fig. S1.</bold> Screnshot of TRAP web application. <bold>Fig. S2.</bold> Cross-species variation and HLA-bias. <bold>Fig. S3.</bold> Effect of anchor and contact positions on peptide immunogenicity. <bold>Fig. S4.</bold> Intra vs. Inter-HLA variability. <bold>Fig. S5.</bold> Pathogenic and self-antigen datasets. <bold>Fig. S6.</bold> Sequence patterns discriminating epitopes versus non-epitopes. <bold>Fig. S7.</bold> Out-of-distribution detection. <bold>Fig. S8.</bold> Benchmark TRAP performance.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM2">
          <media xlink:href="13073_2023_1225_MOESM2_ESM.pdf">
            <caption>
              <p><bold>Additional file 2.</bold> Includes step-by-step tutorial to TRAP web application.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM3">
          <media xlink:href="13073_2023_1225_MOESM3_ESM.xlsx">
            <caption>
              <p><bold>Additional file 3: Table S1.</bold> Pathogenic dataset. <bold>Table S2.</bold> Self-antigen dataset. <bold>Table S3.</bold> Pathogenic TRAP model hyperparameter optimisation. <bold>Table S4.</bold> Self-antigen TRAP model hyperparameter optimisation. <bold>Table S5.</bold> Pathogenic out-of-distribution model calibration metrics. <bold>Table S6.</bold> Self-antigen out-of-distribution model calibration metrics. <bold>Table S7.</bold> GBM predictions on self-antigen model.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM4">
          <media xlink:href="13073_2023_1225_MOESM4_ESM.xlsx">
            <caption>
              <p><bold>Additional file 4.</bold> Differential sequence patterns between pathogenic epitopes and non-epitopes.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM5">
          <media xlink:href="13073_2023_1225_MOESM5_ESM.xlsx">
            <caption>
              <p><bold>Additional file 5.</bold> Differential sequence patterns between self-epitopes and non-epitopes</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <glossary>
    <title>Abbreviations</title>
    <def-list>
      <def-item>
        <term>AAT</term>
        <def>
          <p id="Par5">Autoimmunity, allergy or tumour-associated antigens</p>
        </def>
      </def-item>
      <def-item>
        <term>ANOVA</term>
        <def>
          <p id="Par6">Analysis of variance</p>
        </def>
      </def-item>
      <def-item>
        <term>AUC</term>
        <def>
          <p id="Par7">Area under the ROC curve</p>
        </def>
      </def-item>
      <def-item>
        <term>BERT</term>
        <def>
          <p id="Par8">Bidirectional encoder representations from transformers</p>
        </def>
      </def-item>
      <def-item>
        <term>BL</term>
        <def>
          <p id="Par9">BLOSUM</p>
        </def>
      </def-item>
      <def-item>
        <term>BLOSUM</term>
        <def>
          <p id="Par10">Blocks of amino acid substitution matrix</p>
        </def>
      </def-item>
      <def-item>
        <term>CNN</term>
        <def>
          <p id="Par11">Convolutional neural network</p>
        </def>
      </def-item>
      <def-item>
        <term>CTL</term>
        <def>
          <p id="Par12">Cytotoxic T lymphocyte</p>
        </def>
      </def-item>
      <def-item>
        <term>DNN</term>
        <def>
          <p id="Par13">Deep neural network</p>
        </def>
      </def-item>
      <def-item>
        <term>EBV</term>
        <def>
          <p id="Par14">Epstein–Barr virus</p>
        </def>
      </def-item>
      <def-item>
        <term>GBM</term>
        <def>
          <p id="Par15">Glioblastoma</p>
        </def>
      </def-item>
      <def-item>
        <term>HCV</term>
        <def>
          <p id="Par16">Hepatitis C virus</p>
        </def>
      </def-item>
      <def-item>
        <term>HLA</term>
        <def>
          <p id="Par17">Human leukocyte antigens</p>
        </def>
      </def-item>
      <def-item>
        <term>IEDB</term>
        <def>
          <p id="Par18">Immune Epitope Database</p>
        </def>
      </def-item>
      <def-item>
        <term>LSTM</term>
        <def>
          <p id="Par19">Long short-term memory</p>
        </def>
      </def-item>
      <def-item>
        <term>MAGE</term>
        <def>
          <p id="Par20">Melanoma-associated antigen family</p>
        </def>
      </def-item>
      <def-item>
        <term>MHC</term>
        <def>
          <p id="Par21">Major histocompatibility complex</p>
        </def>
      </def-item>
      <def-item>
        <term>MLP</term>
        <def>
          <p id="Par22">Multilayer perceptron</p>
        </def>
      </def-item>
      <def-item>
        <term>NLI</term>
        <def>
          <p id="Par23">Natural Language Inference</p>
        </def>
      </def-item>
      <def-item>
        <term>NLP</term>
        <def>
          <p id="Par24">Natural Language Processing</p>
        </def>
      </def-item>
      <def-item>
        <term>OHE</term>
        <def>
          <p id="Par25">One-hot encoding</p>
        </def>
      </def-item>
      <def-item>
        <term>OOD</term>
        <def>
          <p id="Par26">Out-of-distribution</p>
        </def>
      </def-item>
      <def-item>
        <term>PLM</term>
        <def>
          <p id="Par27">Protein language model</p>
        </def>
      </def-item>
      <def-item>
        <term>PR</term>
        <def>
          <p id="Par28">Precision-recall</p>
        </def>
      </def-item>
      <def-item>
        <term>RMSE</term>
        <def>
          <p id="Par29">Root-mean-square deviation</p>
        </def>
      </def-item>
      <def-item>
        <term>RNN</term>
        <def>
          <p id="Par30">Recurrent neural network</p>
        </def>
      </def-item>
      <def-item>
        <term>ROC</term>
        <def>
          <p id="Par31">Receiver operating characteristic</p>
        </def>
      </def-item>
      <def-item>
        <term>RSAT</term>
        <def>
          <p id="Par32">Relative similarity to autoantigens and tumour-associated antigens</p>
        </def>
      </def-item>
      <def-item>
        <term>SARS-CoV</term>
        <def>
          <p id="Par33">Severe acute respiratory syndrome coronavirus</p>
        </def>
      </def-item>
      <def-item>
        <term>TCR</term>
        <def>
          <p id="Par34">T-cell receptor</p>
        </def>
      </def-item>
      <def-item>
        <term>TRAP</term>
        <def>
          <p id="Par35">T-cell recognition potential of HLA-I presented peptides</p>
        </def>
      </def-item>
      <def-item>
        <term>VACV</term>
        <def>
          <p id="Par36">Vaccinia virus</p>
        </def>
      </def-item>
      <def-item>
        <term>XGBOOST</term>
        <def>
          <p id="Par37">Extreme gradient boosting</p>
        </def>
      </def-item>
    </def-list>
  </glossary>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher’s Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <ack>
    <title>Acknowledgements</title>
    <p>HK was funded for this project by the MRC Human Immunology core funding MC_UU_00008. CL was funded by the UK National Institute of Health (NIHR).</p>
    <p>AS is funded by the Wellcome Investigating Award (219523/Z/19/Z), the UK MRC, NIHR and awards from Bristol-Myers Squibb and UCB.</p>
    <p>We thank all members of Koohy and Simmons Lab for insightful discussions. We thank MRC WIMM Centre for Computational Biology for the technical support.</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Authors’ contributions</title>
    <p>CL and HK conceived the study. CL designed and conducted all computational analysis with inputs from AA, JH, MJ, PB, MP, RF, AS and HK. CL developed deep learning model with inputs from JH and MJ. PB and CL conducted benchmarking. CL and MJ developed and deployed the web application. CL wrote the manuscript. JH, PB, MJ, MP, RF, AA, AS and HK commented and edited the manuscript. AS and HK supervised the study. All authors read and approved the final manuscript.</p>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>This work has been supported by Medical Research Council. HK is funded by MRC Human Immunology Unit core funding. CL is funded by UK National Institute for Health and Care Research (NIHR). AS is funded by a Wellcome Investigator Award (219523/Z/19/Z), the UK Medical Research Council, an NIHR Senior Investigator Award, awards from Bristol-Myers Squibb and UCB. The views expressed are those of the author(s) and not necessarily those of the NHS, the NIHR, or the Department of Health, UK.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and materials</title>
    <p>The web application is available at <ext-link ext-link-type="uri" xlink:href="https://github.com/ChloeHJ/TRAP">https://github.com/ChloeHJ/TRAP</ext-link> [<xref ref-type="bibr" rid="CR66">66</xref>]. The data, pre-trained models and notebooks are deposited in Google Drive repository [<xref ref-type="bibr" rid="CR98">98</xref>]. The ‘Tutorial for TRAP web application’ document in GitHub [<xref ref-type="bibr" rid="CR66">66</xref>] contains a detailed tutorial on how to use the web application and ‘Workflow: GBM on self-antigen model’ notebook in Google drive [<xref ref-type="bibr" rid="CR98">98</xref>] contains step-by-step workflow for using TRAP model on an example GBM dataset in python interface. The scripts for differential sequence analysis is deposited in GitHub repository [<xref ref-type="bibr" rid="CR60">60</xref>].</p>
  </notes>
  <notes>
    <title>Declarations</title>
    <notes id="FPar1">
      <title>Ethics approval and consent to participate</title>
      <p id="Par127">Not applicable.</p>
    </notes>
    <notes id="FPar2">
      <title>Consent for publication</title>
      <p id="Par128">Not applicable.</p>
    </notes>
    <notes id="FPar3" notes-type="COI-statement">
      <title>Competing interests</title>
      <p id="Par129">The authors declare that they have no competing interests.</p>
    </notes>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Krammer</surname>
            <given-names>F</given-names>
          </name>
        </person-group>
        <article-title>SARS-CoV-2 vaccines in development</article-title>
        <source>Nature</source>
        <year>2020</year>
        <volume>586</volume>
        <fpage>516</fpage>
        <lpage>527</lpage>
        <?supplied-pmid 32967006?>
        <pub-id pub-id-type="pmid">32967006</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ott</surname>
            <given-names>PA</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>An immunogenic personal neoantigen vaccine for patients with melanoma</article-title>
        <source>Nature</source>
        <year>2017</year>
        <volume>547</volume>
        <fpage>217</fpage>
        <lpage>221</lpage>
        <?supplied-pmid 28678778?>
        <pub-id pub-id-type="pmid">28678778</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zacharakis</surname>
            <given-names>N</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Immune recognition of somatic mutations leading to complete durable regression in metastatic breast cancer</article-title>
        <source>Nat Med</source>
        <year>2018</year>
        <volume>24</volume>
        <fpage>724</fpage>
        <lpage>730</lpage>
        <?supplied-pmid 29867227?>
        <pub-id pub-id-type="pmid">29867227</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <mixed-citation publication-type="other">Joglekar AV &amp; Li G. T cell antigen discovery. Nat Methods. 2020:1–8. 10.1038/s41592-020-0867-z.</mixed-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rubelt</surname>
            <given-names>F</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Adaptive immune receptor repertoire community recommendations for sharing immune-repertoire sequencing data</article-title>
        <source>Nat Immunol</source>
        <year>2017</year>
        <volume>18</volume>
        <fpage>1274</fpage>
        <lpage>1278</lpage>
        <?supplied-pmid 29144493?>
        <pub-id pub-id-type="pmid">29144493</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Birnbaum</surname>
            <given-names>ME</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Deconstructing the peptide-MHC specificity of T cell recognition</article-title>
        <source>Cell</source>
        <year>2014</year>
        <volume>157</volume>
        <fpage>1073</fpage>
        <lpage>1087</lpage>
        <?supplied-pmid 24855945?>
        <pub-id pub-id-type="pmid">24855945</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Buckley</surname>
            <given-names>PR</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Evaluating performance of existing computational models in predicting CD8+ T cell pathogenic epitopes and cancer neoantigens</article-title>
        <source>Brief Bioinform.</source>
        <year>2022</year>
        <volume>23</volume>
        <fpage>bbac141</fpage>
        <?supplied-pmid 35471658?>
        <pub-id pub-id-type="pmid">35471658</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wells</surname>
            <given-names>DK</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Key Parameters of tumor epitope immunogenicity revealed through a consortium approach improve neoantigen prediction</article-title>
        <source>Cell</source>
        <year>2020</year>
        <volume>183</volume>
        <fpage>818</fpage>
        <lpage>834.e13</lpage>
        <?supplied-pmid 33038342?>
        <pub-id pub-id-type="pmid">33038342</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <mixed-citation publication-type="other">Karnaukhov V, et al. HLA binding of self-peptides is biased towards proteins with specific molecular functions. bioRxiv. 2021:2021.02.16.431395. 10.1101/2021.02.16.431395.</mixed-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bassani-Sternberg</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Gfeller</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>Unsupervised HLA peptidome deconvolution improves ligand prediction accuracy and predicts cooperative effects in peptide–HLA interactions</article-title>
        <source>J Immunol</source>
        <year>2016</year>
        <volume>197</volume>
        <fpage>2492</fpage>
        <lpage>2499</lpage>
        <?supplied-pmid 27511729?>
        <pub-id pub-id-type="pmid">27511729</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bassani-Sternberg</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Deciphering HLA-I motifs across HLA peptidomes improves neo-antigen predictions and identifies allostery regulating HLA specificity</article-title>
        <source>PLoS Comput Biol</source>
        <year>2017</year>
        <volume>13</volume>
        <fpage>e1005725</fpage>
        <?supplied-pmid 28832583?>
        <pub-id pub-id-type="pmid">28832583</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jurtz</surname>
            <given-names>V</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>NetMHCpan-4.0: improved peptide–MHC Class I interaction predictions integrating eluted ligand and peptide binding affinity data</article-title>
        <source>J Immunol</source>
        <year>2017</year>
        <volume>199</volume>
        <fpage>3360</fpage>
        <lpage>3368</lpage>
        <?supplied-pmid 28978689?>
        <pub-id pub-id-type="pmid">28978689</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Calis</surname>
            <given-names>JJA</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Properties of MHC class I presented peptides that enhance immunogenicity</article-title>
        <source>PLoS Comput Biol</source>
        <year>2013</year>
        <volume>9</volume>
        <fpage>e1003266</fpage>
        <?supplied-pmid 24204222?>
        <pub-id pub-id-type="pmid">24204222</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ogishi</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Yotsuyanagi</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>Quantitative prediction of the landscape of T cell epitope immunogenicity in sequence space</article-title>
        <source>Front Immunol</source>
        <year>2019</year>
        <volume>10</volume>
        <fpage>827</fpage>
        <?supplied-pmid 31057550?>
        <pub-id pub-id-type="pmid">31057550</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Iyer</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Prasath</surname>
            <given-names>VBS</given-names>
          </name>
          <name>
            <surname>Ni</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Salomonis</surname>
            <given-names>N</given-names>
          </name>
        </person-group>
        <article-title>DeepImmuno: deep learning-empowered prediction and generation of immunogenic peptides for T-cell immunity</article-title>
        <source>Brief Bioinform</source>
        <year>2021</year>
        <pub-id pub-id-type="doi">10.1093/bib/bbab160</pub-id>
        <?supplied-pmid 34463709?>
        <pub-id pub-id-type="pmid">34463709</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Trolle</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Nielsen</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>NetTepi: an integrated method for the prediction of T cell epitopes</article-title>
        <source>Immunogenetics</source>
        <year>2014</year>
        <volume>66</volume>
        <fpage>449</fpage>
        <lpage>456</lpage>
        <?supplied-pmid 24863339?>
        <pub-id pub-id-type="pmid">24863339</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pogorelyy</surname>
            <given-names>MV</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Exploring the pre-immune landscape of antigen-specific T cells</article-title>
        <source>Genome Medicine</source>
        <year>2018</year>
        <volume>10</volume>
        <fpage>68</fpage>
        <?supplied-pmid 30144804?>
        <pub-id pub-id-type="pmid">30144804</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tung</surname>
            <given-names>C-W</given-names>
          </name>
          <name>
            <surname>Ziehm</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Kämper</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Kohlbacher</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Ho</surname>
            <given-names>S-Y</given-names>
          </name>
        </person-group>
        <article-title>POPISK: T-cell reactivity prediction using support vector machines and string kernels</article-title>
        <source>BMC Bioinformatics</source>
        <year>2011</year>
        <volume>12</volume>
        <fpage>446</fpage>
        <?supplied-pmid 22085524?>
        <pub-id pub-id-type="pmid">22085524</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chowell</surname>
            <given-names>D</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>TCR contact residue hydrophobicity is a hallmark of immunogenic CD8+ T cell epitopes</article-title>
        <source>PNAS</source>
        <year>2015</year>
        <volume>112</volume>
        <fpage>E1754</fpage>
        <lpage>E1762</lpage>
        <?supplied-pmid 25831525?>
        <pub-id pub-id-type="pmid">25831525</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chowell</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Krishna</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Blattman</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Anderson</surname>
            <given-names>K</given-names>
          </name>
        </person-group>
        <article-title>Hydrophobicity is a hallmark of immunogenic MHC class I T cell epitopes (APP2P.111)</article-title>
        <source>J Immunol</source>
        <year>2014</year>
        <volume>192</volume>
        <fpage>43.12</fpage>
        <lpage>43.12</lpage>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Richman</surname>
            <given-names>LP</given-names>
          </name>
          <name>
            <surname>Vonderheide</surname>
            <given-names>RH</given-names>
          </name>
          <name>
            <surname>Rech</surname>
            <given-names>AJ</given-names>
          </name>
        </person-group>
        <article-title>Neoantigen dissimilarity to the self-proteome predicts immunogenicity and response to immune checkpoint blockade</article-title>
        <source>Cell Syst</source>
        <year>2019</year>
        <volume>9</volume>
        <fpage>375</fpage>
        <lpage>382.e4</lpage>
        <?supplied-pmid 31606370?>
        <pub-id pub-id-type="pmid">31606370</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Devlin</surname>
            <given-names>JR</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Structural dissimilarity from self drives neoepitope escape from immune tolerance</article-title>
        <source>Nat Chem Biol</source>
        <year>2020</year>
        <volume>16</volume>
        <fpage>1269</fpage>
        <lpage>1276</lpage>
        <?supplied-pmid 32807968?>
        <pub-id pub-id-type="pmid">32807968</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lee</surname>
            <given-names>CH</given-names>
          </name>
          <name>
            <surname>Antanaviciute</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Buckley</surname>
            <given-names>PR</given-names>
          </name>
          <name>
            <surname>Simmons</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Koohy</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>To what extent does MHC binding translate to immunogenicity in humans?</article-title>
        <source>ImmunoInformatics</source>
        <year>2021</year>
        <volume>3–4</volume>
        <fpage>100006</fpage>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jumper</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Highly accurate protein structure prediction with AlphaFold</article-title>
        <source>Nature</source>
        <year>2021</year>
        <volume>596</volume>
        <fpage>583</fpage>
        <lpage>589</lpage>
        <?supplied-pmid 34265844?>
        <pub-id pub-id-type="pmid">34265844</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jensen</surname>
            <given-names>KK</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Improved methods for predicting peptide binding affinity to MHC class II molecules</article-title>
        <source>Immunology</source>
        <year>2018</year>
        <volume>154</volume>
        <fpage>394</fpage>
        <lpage>406</lpage>
        <?supplied-pmid 29315598?>
        <pub-id pub-id-type="pmid">29315598</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Racle</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Robust prediction of HLA class II epitopes by deep motif deconvolution of immunopeptidomes</article-title>
        <source>Nat Biotechnol</source>
        <year>2019</year>
        <volume>37</volume>
        <fpage>1283</fpage>
        <lpage>1286</lpage>
        <?supplied-pmid 31611696?>
        <pub-id pub-id-type="pmid">31611696</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <mixed-citation publication-type="other">Lu T, et al. Deep learning-based prediction of the T cell receptor–antigen binding specificity. Nat Mach Intell. 2021:1–12. 10.1038/s42256-021-00383-2.</mixed-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sidhom</surname>
            <given-names>J-W</given-names>
          </name>
          <name>
            <surname>Larman</surname>
            <given-names>HB</given-names>
          </name>
          <name>
            <surname>Pardoll</surname>
            <given-names>DM</given-names>
          </name>
          <name>
            <surname>Baras</surname>
            <given-names>AS</given-names>
          </name>
        </person-group>
        <article-title>DeepTCR is a deep learning framework for revealing sequence concepts within T-cell repertoires</article-title>
        <source>Nat Commun</source>
        <year>2021</year>
        <volume>12</volume>
        <fpage>1605</fpage>
        <?supplied-pmid 33707415?>
        <pub-id pub-id-type="pmid">33707415</pub-id>
      </element-citation>
    </ref>
    <ref id="CR29">
      <label>29.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Weber</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Born</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Rodriguez Martínez</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>TITAN: T-cell receptor specificity prediction with bimodal attention networks</article-title>
        <source>Bioinformatics</source>
        <year>2021</year>
        <volume>37</volume>
        <fpage>i237</fpage>
        <lpage>i244</lpage>
        <?supplied-pmid 34252922?>
        <pub-id pub-id-type="pmid">34252922</pub-id>
      </element-citation>
    </ref>
    <ref id="CR30">
      <label>30.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rives</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Biological structure and function emerge from scaling unsupervised learning to 250 million protein sequences</article-title>
        <source>Proc Natl Acad Sci U S A</source>
        <year>2021</year>
        <volume>118</volume>
        <fpage>e2016239118</fpage>
        <?supplied-pmid 33876751?>
        <pub-id pub-id-type="pmid">33876751</pub-id>
      </element-citation>
    </ref>
    <ref id="CR31">
      <label>31.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rao</surname>
            <given-names>R</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Evaluating protein transfer learning with TAPE</article-title>
        <source>Adv Neural Inf Process Syst</source>
        <year>2019</year>
        <volume>32</volume>
        <fpage>9689</fpage>
        <lpage>9701</lpage>
        <?supplied-pmid 33390682?>
        <pub-id pub-id-type="pmid">33390682</pub-id>
      </element-citation>
    </ref>
    <ref id="CR32">
      <label>32.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Alley</surname>
            <given-names>EC</given-names>
          </name>
          <name>
            <surname>Khimulya</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Biswas</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>AlQuraishi</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Church</surname>
            <given-names>GM</given-names>
          </name>
        </person-group>
        <article-title>Unified rational protein engineering with sequence-based deep representation learning</article-title>
        <source>Nat Methods</source>
        <year>2019</year>
        <volume>16</volume>
        <fpage>1315</fpage>
        <lpage>1322</lpage>
        <?supplied-pmid 31636460?>
        <pub-id pub-id-type="pmid">31636460</pub-id>
      </element-citation>
    </ref>
    <ref id="CR33">
      <label>33.</label>
      <mixed-citation publication-type="other">Elnaggar A, et al. ProtTrans: towards cracking the language of life’s code through self-supervised learning. 2020. 10.1101/2020.07.12.199554. <ext-link ext-link-type="uri" xlink:href="http://biorxiv.org/lookup/doi/10.1101/2020.07.12.199554">http://biorxiv.org/lookup/doi/10.1101/2020.07.12.199554</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR34">
      <label>34.</label>
      <mixed-citation publication-type="other">Kalyan KS, Rajasekharan A &amp; Sangeetha S. AMMUS : a survey of transformer-based pretrained models in natural language processing. 2021. Preprint at 10.48550/arXiv.2108.05542.</mixed-citation>
    </ref>
    <ref id="CR35">
      <label>35.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Roshanzamir</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Aghajan</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Soleymani Baghshah</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Transformer-based deep neural network language models for Alzheimer’s disease risk assessment from targeted speech</article-title>
        <source>BMC Med Inform Decis Mak</source>
        <year>2021</year>
        <volume>21</volume>
        <fpage>92</fpage>
        <?supplied-pmid 33750385?>
        <pub-id pub-id-type="pmid">33750385</pub-id>
      </element-citation>
    </ref>
    <ref id="CR36">
      <label>36.</label>
      <mixed-citation publication-type="other">Devlin J, Chang MW, Lee K, Toutanova K. BERT: Pre-training of Deep Bidirectional Transformers for Language Understanding. In: Proceedings of the 2019 Conference of the North American Chapter of the Association for Computational Linguistics: Human Language Technologies, Volume 1 (Long and Short Papers). Minneapolis: Association for Computational Linguistics; 2019. p. 4171–4186. 10.18653/v1/N19-1423.</mixed-citation>
    </ref>
    <ref id="CR37">
      <label>37.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Torralba</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Efros</surname>
            <given-names>AA</given-names>
          </name>
        </person-group>
        <article-title>Unbiased look at dataset bias</article-title>
        <source>CVPR</source>
        <year>2011</year>
        <volume>2011</volume>
        <fpage>1521</fpage>
        <lpage>1528</lpage>
        <pub-id pub-id-type="doi">10.1109/CVPR.2011.5995347</pub-id>
      </element-citation>
    </ref>
    <ref id="CR38">
      <label>38.</label>
      <mixed-citation publication-type="other">Quiñonero-Candela J, Lawrence ND, Schwaighofer A, Sugiyama M. Dataset shift in machine learning. MIT Press; 2022.</mixed-citation>
    </ref>
    <ref id="CR39">
      <label>39.</label>
      <mixed-citation publication-type="other">Eykholt K, et al. Robust Physical-World Attacks on Deep Learning Visual Classification. In: 2018 IEEE/CVF Conference on Computer Vision and Pattern Recognition; 2018:1625–1634. 10.1109/CVPR.2018.00175.</mixed-citation>
    </ref>
    <ref id="CR40">
      <label>40.</label>
      <mixed-citation publication-type="other">Ribeiro MT, Wu T, Guestrin C &amp; Singh S. Beyond Accuracy: Behavioral Testing of NLP Models with CheckList. In: Proceedings of the 58th Annual Meeting of the Association for Computational Linguistics. Association for Computational Linguistics; 2020:4902–4912. 10.18653/v1/2020.acl-main.442.</mixed-citation>
    </ref>
    <ref id="CR41">
      <label>41.</label>
      <mixed-citation publication-type="other">Jia R, Liang P. Adversarial Examples for Evaluating Reading Comprehension Systems. In: Proceedings of the 2017 Conference on Empirical Methods in Natural Language Processing. Copenhagen: Association for Computational Linguistics; 2017. p. 2021–2031. 10.18653/v1/D17-1215.</mixed-citation>
    </ref>
    <ref id="CR42">
      <label>42.</label>
      <mixed-citation publication-type="other">Amodei D et al. Concrete problems in AI Safety; 2016. Preprint at 10.48550/arXiv.1606.06565.</mixed-citation>
    </ref>
    <ref id="CR43">
      <label>43.</label>
      <mixed-citation publication-type="other">Hendrycks D &amp; Gimpel K. A baseline for detecting misclassified and out-of-distribution examples in neural networks; 2018. Preprint at 10.48550/arXiv.1610.02136.</mixed-citation>
    </ref>
    <ref id="CR44">
      <label>44.</label>
      <mixed-citation publication-type="other">Varshney N, Mishra S, Baral C. Towards Improving Selective Prediction Ability of NLP Systems. In: Proceedings of the 7th Workshop on Representation Learning for NLP. Dublin: Association for Computational Linguistics; 2022. p. 221–226. 10.18653/v1/2022.repl4nlp-1.23.</mixed-citation>
    </ref>
    <ref id="CR45">
      <label>45.</label>
      <mixed-citation publication-type="other">Arora U, Huang W, He H. Types of out-of-distribution texts and how to detect them. In: Proceedings of the 2021 Conference on Empirical Methods in Natural Language Processing. Punta Cana: Association for Computational Linguistics; 2021. p. 10687–10701. 10.18653/v1/2021.emnlp-main.835.</mixed-citation>
    </ref>
    <ref id="CR46">
      <label>46.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kim</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Jang</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Seo</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Park</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Kang</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>Intrusion detection based on sequential information preserving log embedding methods and anomaly detection algorithms</article-title>
        <source>IEEE Access</source>
        <year>2021</year>
        <volume>9</volume>
        <fpage>58088</fpage>
        <lpage>58101</lpage>
      </element-citation>
    </ref>
    <ref id="CR47">
      <label>47.</label>
      <mixed-citation publication-type="other">Schlegl T, Seeböck P, Waldstein SM, Schmidt-Erfurth U, Langs G. Unsupervised Anomaly Detection with Generative Adversarial Networks to Guide Marker Discovery. In: Niethammer M, et al, editors. Information Processing in Medical Imaging. Boone: Springer International Publishing; 2017. p. 146–157. 10.1007/978-3-319-59050-9_12.</mixed-citation>
    </ref>
    <ref id="CR48">
      <label>48.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jang</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Lukasiewicz</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>NoiER: an approach for training more reliable fine-tuned downstream task models</article-title>
        <source>EEE/ACM Trans Audio Speech Lang Process</source>
        <year>2022</year>
        <volume>30</volume>
        <fpage>2514</fpage>
        <lpage>2525</lpage>
      </element-citation>
    </ref>
    <ref id="CR49">
      <label>49.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Fleri</surname>
            <given-names>W</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The immune epitope database and analysis resource in epitope discovery and synthetic vaccine design</article-title>
        <source>Front Immunol</source>
        <year>2017</year>
        <volume>8</volume>
        <fpage>278</fpage>
        <?supplied-pmid 28352270?>
        <pub-id pub-id-type="pmid">28352270</pub-id>
      </element-citation>
    </ref>
    <ref id="CR50">
      <label>50.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tan</surname>
            <given-names>X</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>dbPepNeo: a manually curated database for human tumor neoantigen peptides</article-title>
        <source>Database</source>
        <year>2020</year>
        <volume>2020</volume>
        <fpage>baaa004</fpage>
        <?supplied-pmid 32090262?>
        <pub-id pub-id-type="pmid">32090262</pub-id>
      </element-citation>
    </ref>
    <ref id="CR51">
      <label>51.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tickotsky</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Sagiv</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Prilusky</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Shifrut</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Friedman</surname>
            <given-names>N</given-names>
          </name>
        </person-group>
        <article-title>McPAS-TCR: a manually curated catalogue of pathology-associated T cell receptor sequences</article-title>
        <source>Bioinformatics</source>
        <year>2017</year>
        <volume>33</volume>
        <fpage>2924</fpage>
        <lpage>2929</lpage>
        <?supplied-pmid 28481982?>
        <pub-id pub-id-type="pmid">28481982</pub-id>
      </element-citation>
    </ref>
    <ref id="CR52">
      <label>52.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Xia</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>NEPdb: a database of T-cell experimentally-validated neoantigens and pan-cancer predicted neoepitopes for cancer immunotherapy</article-title>
        <source>Front Immunol</source>
        <year>2021</year>
        <volume>12</volume>
        <fpage>644637</fpage>
        <?supplied-pmid 33927717?>
        <pub-id pub-id-type="pmid">33927717</pub-id>
      </element-citation>
    </ref>
    <ref id="CR53">
      <label>53.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Adamopoulou</surname>
            <given-names>E</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Exploring the MHC-peptide matrix of central tolerance in the human thymus</article-title>
        <source>Nat Commun</source>
        <year>2013</year>
        <volume>4</volume>
        <fpage>2039</fpage>
        <?supplied-pmid 23783831?>
        <pub-id pub-id-type="pmid">23783831</pub-id>
      </element-citation>
    </ref>
    <ref id="CR54">
      <label>54.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Espinosa</surname>
            <given-names>G</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Peptides presented by HLA class I molecules in the human thymus</article-title>
        <source>J Proteomics</source>
        <year>2013</year>
        <volume>94</volume>
        <fpage>23</fpage>
        <lpage>36</lpage>
        <?supplied-pmid 24029068?>
        <pub-id pub-id-type="pmid">24029068</pub-id>
      </element-citation>
    </ref>
    <ref id="CR55">
      <label>55.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Marcu</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>HLA Ligand Atlas: a benign reference of HLA-presented peptides to improve T-cell-based cancer immunotherapy</article-title>
        <source>J Immunother Cancer</source>
        <year>2021</year>
        <volume>9</volume>
        <fpage>e002071</fpage>
        <?supplied-pmid 33858848?>
        <pub-id pub-id-type="pmid">33858848</pub-id>
      </element-citation>
    </ref>
    <ref id="CR56">
      <label>56.</label>
      <mixed-citation publication-type="other">Schmidt J, et al. Prediction of neo-epitope immunogenicity reveals TCR recognition determinants and provides insight into immunoediting. Cell Rep Med. 2021;2:100194.</mixed-citation>
    </ref>
    <ref id="CR57">
      <label>57.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Iyer</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Prasath</surname>
            <given-names>VBS</given-names>
          </name>
          <name>
            <surname>Ni</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Salomonis</surname>
            <given-names>N</given-names>
          </name>
        </person-group>
        <article-title>DeepImmuno: deep learning-empowered prediction and generation of immunogenic peptides for T-cell immunity</article-title>
        <source>Brief Bioinform</source>
        <year>2021</year>
        <volume>22</volume>
        <fpage>bbab160</fpage>
        <?supplied-pmid 34009266?>
        <pub-id pub-id-type="pmid">34009266</pub-id>
      </element-citation>
    </ref>
    <ref id="CR58">
      <label>58.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Osorio</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Rondón-Villarreal</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Torres</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Peptides: a package for data mining of antimicrobial peptides</article-title>
        <source>R J</source>
        <year>2015</year>
        <volume>7</volume>
        <fpage>4</fpage>
      </element-citation>
    </ref>
    <ref id="CR59">
      <label>59.</label>
      <mixed-citation publication-type="other">Pagès H, Aboyoun P, Gentleman R &amp; DebRoy S. Biostrings: efficient manipulation of biological strings; 2022. 10.18129/B9.bioc.Biostrings.</mixed-citation>
    </ref>
    <ref id="CR60">
      <label>60.</label>
      <mixed-citation publication-type="other">Lee CH. diffSeqPatterns: R package for differential sequence pattern analysis. GitHub; 2023. <ext-link ext-link-type="uri" xlink:href="https://github.com/ChloeHJ/diffSeqPatterns">https://github.com/ChloeHJ/diffSeqPatterns</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR61">
      <label>61.</label>
      <mixed-citation publication-type="other">Zhou C, Paffenroth RC. Anomaly Detection with Robust Deep Autoencoders. In: Proceedings of the 23rd ACM SIGKDD International Conference on Knowledge Discovery and Data Mining. Halifax: Association for Computing Machinery; 2017. p. 665–674. 10.1145/3097983.3098052.</mixed-citation>
    </ref>
    <ref id="CR62">
      <label>62.</label>
      <mixed-citation publication-type="other">Guo C, Pleiss G, Sun Y, Weinberger KQ. On Calibration of Modern Neural Networks. In: Proceedings of the 34th International Conference on Machine Learning. Sydney: PMLR; 2017. p. 1321–1330.</mixed-citation>
    </ref>
    <ref id="CR63">
      <label>63.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bresciani</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>T-cell recognition is shaped by epitope sequence conservation in the host proteome and microbiome</article-title>
        <source>Immunology</source>
        <year>2016</year>
        <volume>148</volume>
        <fpage>34</fpage>
        <lpage>39</lpage>
        <?supplied-pmid 26789414?>
        <pub-id pub-id-type="pmid">26789414</pub-id>
      </element-citation>
    </ref>
    <ref id="CR64">
      <label>64.</label>
      <mixed-citation publication-type="other">Ma R, et al. Decitabine increases neoantigen and cancer testis antigen expression to enhance T-cell–mediated toxicity against glioblastoma. Neuro Oncol. 2022:noac107. 10.1093/neuonc/noac107.</mixed-citation>
    </ref>
    <ref id="CR65">
      <label>65.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bjerregaard</surname>
            <given-names>A-M</given-names>
          </name>
          <name>
            <surname>Nielsen</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Hadrup</surname>
            <given-names>SR</given-names>
          </name>
          <name>
            <surname>Szallasi</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Eklund</surname>
            <given-names>AC</given-names>
          </name>
        </person-group>
        <article-title>MuPeXI: prediction of neo-epitopes from tumor sequencing data</article-title>
        <source>Cancer Immunol Immunother</source>
        <year>2017</year>
        <volume>66</volume>
        <fpage>1123</fpage>
        <lpage>1130</lpage>
        <?supplied-pmid 28429069?>
        <pub-id pub-id-type="pmid">28429069</pub-id>
      </element-citation>
    </ref>
    <ref id="CR66">
      <label>66.</label>
      <mixed-citation publication-type="other">Lee CH. TRAP: a robust deep learning workflow to predict CD8+ T-cell epitopes. GitHub; 2023. <ext-link ext-link-type="uri" xlink:href="https://github.com/ChloeHJ/TRAP">https://github.com/ChloeHJ/TRAP</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR67">
      <label>67.</label>
      <mixed-citation publication-type="other">Gao A et al. Predicting the Immunogenicity of T cell epitopes: from HIV to SARS-CoV-2. bioRxiv. 2020:2020.05.14.095885. 10.1101/2020.05.14.095885.</mixed-citation>
    </ref>
    <ref id="CR68">
      <label>68.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ruppert</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Prominent role of secondary anchor residues in peptide binding to HLA-A2.1 molecules</article-title>
        <source>Cell</source>
        <year>1993</year>
        <volume>74</volume>
        <fpage>929</fpage>
        <lpage>937</lpage>
        <?supplied-pmid 8104103?>
        <pub-id pub-id-type="pmid">8104103</pub-id>
      </element-citation>
    </ref>
    <ref id="CR69">
      <label>69.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Liston</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Lesage</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Wilson</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Peltonen</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Goodnow</surname>
            <given-names>CC</given-names>
          </name>
        </person-group>
        <article-title>Aire regulates negative selection of organ-specific T cells</article-title>
        <source>Nat Immunol</source>
        <year>2003</year>
        <volume>4</volume>
        <fpage>350</fpage>
        <lpage>354</lpage>
        <?supplied-pmid 12612579?>
        <pub-id pub-id-type="pmid">12612579</pub-id>
      </element-citation>
    </ref>
    <ref id="CR70">
      <label>70.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Starr</surname>
            <given-names>TK</given-names>
          </name>
          <name>
            <surname>Jameson</surname>
            <given-names>SC</given-names>
          </name>
          <name>
            <surname>Hogquist</surname>
            <given-names>KA</given-names>
          </name>
        </person-group>
        <article-title>Positive and negative selection of T cells</article-title>
        <source>Annu Rev Immunol</source>
        <year>2003</year>
        <volume>21</volume>
        <fpage>139</fpage>
        <lpage>176</lpage>
        <?supplied-pmid 12414722?>
        <pub-id pub-id-type="pmid">12414722</pub-id>
      </element-citation>
    </ref>
    <ref id="CR71">
      <label>71.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jameson</surname>
            <given-names>SC</given-names>
          </name>
          <name>
            <surname>Hogquist</surname>
            <given-names>KA</given-names>
          </name>
          <name>
            <surname>Bevan</surname>
            <given-names>MJ</given-names>
          </name>
        </person-group>
        <article-title>Specificity and flexibility in thymic selection</article-title>
        <source>Nature</source>
        <year>1994</year>
        <volume>369</volume>
        <fpage>750</fpage>
        <lpage>752</lpage>
        <?supplied-pmid 8008067?>
        <pub-id pub-id-type="pmid">8008067</pub-id>
      </element-citation>
    </ref>
    <ref id="CR72">
      <label>72.</label>
      <mixed-citation publication-type="other">Cho K, et al. Learning phrase representations using rnn encoder–decoder for statistical machine translation. In: Proceedings of the 2014 Conference on Empirical Methods in Natural Language Processing (EMNLP). Doha: Association for Computational Linguistics; 2014. p. 1724–1734. 10.3115/v1/D14-1179.</mixed-citation>
    </ref>
    <ref id="CR73">
      <label>73.</label>
      <mixed-citation publication-type="other">Kim Y. Convolutional Neural Networks for Sentence Classification. In: Proceedings of the 2014 Conference on Empirical Methods in Natural Language Processing (EMNLP). Doha: Association for Computational Linguistics; 2014. p. 1746–1751. 10.3115/v1/D14-1181.</mixed-citation>
    </ref>
    <ref id="CR74">
      <label>74.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wooldridge</surname>
            <given-names>L</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>CD8 controls T cell cross-reactivity</article-title>
        <source>J Immunol</source>
        <year>2010</year>
        <volume>185</volume>
        <fpage>4625</fpage>
        <lpage>4632</lpage>
        <?supplied-pmid 20844204?>
        <pub-id pub-id-type="pmid">20844204</pub-id>
      </element-citation>
    </ref>
    <ref id="CR75">
      <label>75.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bentzen</surname>
            <given-names>AK</given-names>
          </name>
          <name>
            <surname>Hadrup</surname>
            <given-names>SR</given-names>
          </name>
        </person-group>
        <article-title>T-cell-receptor cross-recognition and strategies to select safe T-cell receptors for clinical translation</article-title>
        <source>Immunooncol Technol</source>
        <year>2019</year>
        <volume>2</volume>
        <fpage>1</fpage>
        <lpage>10</lpage>
        <?supplied-pmid 35036898?>
        <pub-id pub-id-type="pmid">35036898</pub-id>
      </element-citation>
    </ref>
    <ref id="CR76">
      <label>76.</label>
      <mixed-citation publication-type="other">Schmidt D &amp; Heckendorf C. ngram: Fast n-Gram ‘Tokenization’; 2021.</mixed-citation>
    </ref>
    <ref id="CR77">
      <label>77.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Koncz</surname>
            <given-names>B</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Self-mediated positive selection of T cells sets an obstacle to the recognition of nonself</article-title>
        <source>PNAS</source>
        <year>2021</year>
        <volume>118</volume>
        <fpage>e2100542118</fpage>
        <?supplied-pmid 34507984?>
        <pub-id pub-id-type="pmid">34507984</pub-id>
      </element-citation>
    </ref>
    <ref id="CR78">
      <label>78.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Buckley</surname>
            <given-names>PR</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>CH</given-names>
          </name>
          <name>
            <surname>Antanaviciute</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Simmons</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Koohy</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>A systems approach evaluating the impact of SARS-CoV-2 variant of concern mutations on CD8+ T cell responses</article-title>
        <source>Immunother Adv</source>
        <year>2021</year>
        <volume>3</volume>
        <fpage>ltad005</fpage>
      </element-citation>
    </ref>
    <ref id="CR79">
      <label>79.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Baker</surname>
            <given-names>RE</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Infectious disease in an era of global change</article-title>
        <source>Nat Rev Microbiol</source>
        <year>2022</year>
        <volume>20</volume>
        <fpage>193</fpage>
        <lpage>205</lpage>
        <?supplied-pmid 34646006?>
        <pub-id pub-id-type="pmid">34646006</pub-id>
      </element-citation>
    </ref>
    <ref id="CR80">
      <label>80.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zinkernagel</surname>
            <given-names>RM</given-names>
          </name>
          <name>
            <surname>Doherty</surname>
            <given-names>PC</given-names>
          </name>
        </person-group>
        <article-title>Restriction of in vitro T cell-mediated cytotoxicity in lymphocytic choriomeningitis within a syngeneic or semiallogeneic system</article-title>
        <source>Nature</source>
        <year>1974</year>
        <volume>248</volume>
        <fpage>701</fpage>
        <lpage>702</lpage>
        <?supplied-pmid 4133807?>
        <pub-id pub-id-type="pmid">4133807</pub-id>
      </element-citation>
    </ref>
    <ref id="CR81">
      <label>81.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>La Gruta</surname>
            <given-names>NL</given-names>
          </name>
          <name>
            <surname>Gras</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Daley</surname>
            <given-names>SR</given-names>
          </name>
          <name>
            <surname>Thomas</surname>
            <given-names>PG</given-names>
          </name>
          <name>
            <surname>Rossjohn</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Understanding the drivers of MHC restriction of T cell receptors</article-title>
        <source>Nat Rev Immunol</source>
        <year>2018</year>
        <volume>18</volume>
        <fpage>467</fpage>
        <lpage>478</lpage>
        <?supplied-pmid 29636542?>
        <pub-id pub-id-type="pmid">29636542</pub-id>
      </element-citation>
    </ref>
    <ref id="CR82">
      <label>82.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Duan</surname>
            <given-names>F</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Genomic and bioinformatic profiling of mutational neoepitopes reveals new rules to predict anticancer immunogenicity</article-title>
        <source>J Exp Med</source>
        <year>2014</year>
        <volume>211</volume>
        <fpage>2231</fpage>
        <lpage>2248</lpage>
        <?supplied-pmid 25245761?>
        <pub-id pub-id-type="pmid">25245761</pub-id>
      </element-citation>
    </ref>
    <ref id="CR83">
      <label>83.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chen</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Flies</surname>
            <given-names>DB</given-names>
          </name>
        </person-group>
        <article-title>Molecular mechanisms of T cell co-stimulation and co-inhibition</article-title>
        <source>Nat Rev Immunol</source>
        <year>2013</year>
        <volume>13</volume>
        <fpage>227</fpage>
        <lpage>242</lpage>
        <?supplied-pmid 23470321?>
        <pub-id pub-id-type="pmid">23470321</pub-id>
      </element-citation>
    </ref>
    <ref id="CR84">
      <label>84.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Achar</surname>
            <given-names>SR</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Universal antigen encoding of T cell activation from high-dimensional cytokine dynamics</article-title>
        <source>Science</source>
        <year>2022</year>
        <volume>376</volume>
        <fpage>880</fpage>
        <lpage>884</lpage>
        <?supplied-pmid 35587980?>
        <pub-id pub-id-type="pmid">35587980</pub-id>
      </element-citation>
    </ref>
    <ref id="CR85">
      <label>85.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cameron</surname>
            <given-names>BJ</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Identification of a titin-derived HLA-A1–presented peptide as a cross-reactive target for engineered MAGE A3–directed T cells</article-title>
        <source>Sci Transl Med</source>
        <year>2013</year>
        <volume>5</volume>
        <fpage>197ra103</fpage>
        <?supplied-pmid 23926201?>
        <pub-id pub-id-type="pmid">23926201</pub-id>
      </element-citation>
    </ref>
    <ref id="CR86">
      <label>86.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Leonard</surname>
            <given-names>JD</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Identification of natural regulatory T Cell epitopes reveals convergence on a dominant autoantigen</article-title>
        <source>Immunity</source>
        <year>2017</year>
        <volume>47</volume>
        <fpage>107</fpage>
        <lpage>117.e8</lpage>
        <?supplied-pmid 28709804?>
        <pub-id pub-id-type="pmid">28709804</pub-id>
      </element-citation>
    </ref>
    <ref id="CR87">
      <label>87.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Davis</surname>
            <given-names>MM</given-names>
          </name>
        </person-group>
        <article-title>Not-so-negative selection</article-title>
        <source>Immunity</source>
        <year>2015</year>
        <volume>43</volume>
        <fpage>833</fpage>
        <lpage>835</lpage>
        <?supplied-pmid 26588773?>
        <pub-id pub-id-type="pmid">26588773</pub-id>
      </element-citation>
    </ref>
    <ref id="CR88">
      <label>88.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Takada</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Takahama</surname>
            <given-names>Y</given-names>
          </name>
        </person-group>
        <article-title>Positive-selection-inducing self-peptides displayed by cortical thymic epithelial cells</article-title>
        <source>Adv Immunol</source>
        <year>2015</year>
        <volume>125</volume>
        <fpage>87</fpage>
        <lpage>110</lpage>
        <?supplied-pmid 25591465?>
        <pub-id pub-id-type="pmid">25591465</pub-id>
      </element-citation>
    </ref>
    <ref id="CR89">
      <label>89.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Klein</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Kyewski</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Allen</surname>
            <given-names>PM</given-names>
          </name>
          <name>
            <surname>Hogquist</surname>
            <given-names>KA</given-names>
          </name>
        </person-group>
        <article-title>Positive and negative selection of the T cell repertoire: what thymocytes see (and don’t see)</article-title>
        <source>Nat Rev Immunol</source>
        <year>2014</year>
        <volume>14</volume>
        <fpage>377</fpage>
        <lpage>391</lpage>
        <?supplied-pmid 24830344?>
        <pub-id pub-id-type="pmid">24830344</pub-id>
      </element-citation>
    </ref>
    <ref id="CR90">
      <label>90.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ebert</surname>
            <given-names>PJR</given-names>
          </name>
          <name>
            <surname>Jiang</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Xie</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>Q-J</given-names>
          </name>
          <name>
            <surname>Davis</surname>
            <given-names>MM</given-names>
          </name>
        </person-group>
        <article-title>An endogenous positively selecting peptide enhances mature T cell responses and becomes an autoantigen in the absence of microRNA miR-181a</article-title>
        <source>Nat Immunol</source>
        <year>2009</year>
        <volume>10</volume>
        <fpage>1162</fpage>
        <lpage>1169</lpage>
        <?supplied-pmid 19801983?>
        <pub-id pub-id-type="pmid">19801983</pub-id>
      </element-citation>
    </ref>
    <ref id="CR91">
      <label>91.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Freitag</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Hamdan</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Reddehase</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>Holtappels</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Immunodominant cytomegalovirus epitopes suppress subdominant epitopes in the generation of high-avidity CD8 T Cells</article-title>
        <source>Pathogens</source>
        <year>2021</year>
        <volume>10</volume>
        <fpage>956</fpage>
        <?supplied-pmid 34451420?>
        <pub-id pub-id-type="pmid">34451420</pub-id>
      </element-citation>
    </ref>
    <ref id="CR92">
      <label>92.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Peng</surname>
            <given-names>Y</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Broad and strong memory CD4+ and CD8+ T cells induced by SARS-CoV-2 in UK convalescent individuals following COVID-19</article-title>
        <source>Nat Immunol</source>
        <year>2020</year>
        <volume>21</volume>
        <fpage>1336</fpage>
        <lpage>1345</lpage>
        <?supplied-pmid 32887977?>
        <pub-id pub-id-type="pmid">32887977</pub-id>
      </element-citation>
    </ref>
    <ref id="CR93">
      <label>93.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ferretti</surname>
            <given-names>AP</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Unbiased screens show CD8+ T cells of COVID-19 patients recognize shared epitopes in SARS-CoV-2 that largely reside outside the spike protein</article-title>
        <source>Immunity</source>
        <year>2020</year>
        <volume>53</volume>
        <fpage>1095</fpage>
        <lpage>1107.e3</lpage>
        <?supplied-pmid 33128877?>
        <pub-id pub-id-type="pmid">33128877</pub-id>
      </element-citation>
    </ref>
    <ref id="CR94">
      <label>94.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mazor</surname>
            <given-names>R</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Identification and elimination of an immunodominant T-cell epitope in recombinant immunotoxins based on Pseudomonas exotoxin A</article-title>
        <source>Proc Natl Acad Sci</source>
        <year>2012</year>
        <volume>109</volume>
        <fpage>E3597</fpage>
        <lpage>E3603</lpage>
        <?supplied-pmid 23213206?>
        <pub-id pub-id-type="pmid">23213206</pub-id>
      </element-citation>
    </ref>
    <ref id="CR95">
      <label>95.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Irvine</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Bennink</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Factors influencing immunodominance hierarchies in TCD8+-mediated antiviral responses</article-title>
        <source>Expert Rev Clin Immunol</source>
        <year>2006</year>
        <volume>2</volume>
        <fpage>135</fpage>
        <lpage>147</lpage>
        <?supplied-pmid 20477094?>
        <pub-id pub-id-type="pmid">20477094</pub-id>
      </element-citation>
    </ref>
    <ref id="CR96">
      <label>96.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wellington</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Yin</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Kessler</surname>
            <given-names>BM</given-names>
          </name>
          <name>
            <surname>Dong</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>Immunodominance complexity: lessons yet to be learned from dominant T cell responses to SARS-COV-2</article-title>
        <source>Curr Opin Virol</source>
        <year>2021</year>
        <volume>50</volume>
        <fpage>183</fpage>
        <lpage>191</lpage>
        <?supplied-pmid 34534732?>
        <pub-id pub-id-type="pmid">34534732</pub-id>
      </element-citation>
    </ref>
    <ref id="CR97">
      <label>97.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kastenmuller</surname>
            <given-names>W</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Cross-competition of CD8+ T cells shapes the immunodominance hierarchy during boost vaccination</article-title>
        <source>J Exp Med</source>
        <year>2007</year>
        <volume>204</volume>
        <fpage>2187</fpage>
        <lpage>2198</lpage>
        <?supplied-pmid 17709425?>
        <pub-id pub-id-type="pmid">17709425</pub-id>
      </element-citation>
    </ref>
    <ref id="CR98">
      <label>98.</label>
      <mixed-citation publication-type="other">Lee CH. Repository for TRAP models and datasets. Google Drive; 2023. <ext-link ext-link-type="uri" xlink:href="https://drive.google.com/drive/folders/15A2P5xP2c-q48vVGPRB7h7uHEMycPYoX?usp=drive_link">https://drive.google.com/drive/folders/15A2P5xP2c-q48vVGPRB7h7uHEMycPYoX?usp=drive_link</ext-link>.</mixed-citation>
    </ref>
  </ref-list>
</back>
<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Genome Med</journal-id>
    <journal-id journal-id-type="iso-abbrev">Genome Med</journal-id>
    <journal-title-group>
      <journal-title>Genome Medicine</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1756-994X</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10498576</article-id>
    <article-id pub-id-type="pmid">37705109</article-id>
    <article-id pub-id-type="publisher-id">1225</article-id>
    <article-id pub-id-type="doi">10.1186/s13073-023-01225-z</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>A robust deep learning workflow to predict CD8 + T-cell epitopes</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-6232-7119</contrib-id>
        <name>
          <surname>Lee</surname>
          <given-names>Chloe H.</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Huh</surname>
          <given-names>Jaesung</given-names>
        </name>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Buckley</surname>
          <given-names>Paul R.</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Jang</surname>
          <given-names>Myeongjun</given-names>
        </name>
        <xref ref-type="aff" rid="Aff4">4</xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-5759-2436</contrib-id>
        <name>
          <surname>Pinho</surname>
          <given-names>Mariana Pereira</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0001-5343-3334</contrib-id>
        <name>
          <surname>Fernandes</surname>
          <given-names>Ricardo A.</given-names>
        </name>
        <xref ref-type="aff" rid="Aff5">5</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Antanaviciute</surname>
          <given-names>Agne</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0003-3454-0710</contrib-id>
        <name>
          <surname>Simmons</surname>
          <given-names>Alison</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff6">6</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-3640-7043</contrib-id>
        <name>
          <surname>Koohy</surname>
          <given-names>Hashem</given-names>
        </name>
        <address>
          <email>hashem.koohy@rdm.ox.ac.uk</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
        <xref ref-type="aff" rid="Aff7">7</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="GRID">grid.4991.5</institution-id><institution-id institution-id-type="ISNI">0000 0004 1936 8948</institution-id><institution>MRC Human Immunology Unit, Medical Research Council (MRC) Weatherall Institute of Molecular Medicine (WIMM), John Radcliffe Hospital, </institution><institution>University of Oxford, </institution></institution-wrap>Oxford, OX3 9DS UK </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="GRID">grid.4991.5</institution-id><institution-id institution-id-type="ISNI">0000 0004 1936 8948</institution-id><institution>MRC WIMM Centre for Computational Biology, MRC Weatherall Institute of Molecular Medicine, John Radcliffe Hospital, </institution><institution>University of Oxford, </institution></institution-wrap>Oxford, OX3 9DS UK </aff>
      <aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/052gg0110</institution-id><institution-id institution-id-type="GRID">grid.4991.5</institution-id><institution-id institution-id-type="ISNI">0000 0004 1936 8948</institution-id><institution>Visual Geometry Group, Department of Engineering Science, </institution><institution>University of Oxford, </institution></institution-wrap>Oxford, OX2 6NN UK </aff>
      <aff id="Aff4"><label>4</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/052gg0110</institution-id><institution-id institution-id-type="GRID">grid.4991.5</institution-id><institution-id institution-id-type="ISNI">0000 0004 1936 8948</institution-id><institution>Intelligent Systems Lab, Department of Computer Science, </institution><institution>University of Oxford, </institution></institution-wrap>Oxford, OX1 3QG UK </aff>
      <aff id="Aff5"><label>5</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/052gg0110</institution-id><institution-id institution-id-type="GRID">grid.4991.5</institution-id><institution-id institution-id-type="ISNI">0000 0004 1936 8948</institution-id><institution>Chinese Academy of Medical Sciences (CAMS) Oxford Institute (COI), </institution><institution>University of Oxford, </institution></institution-wrap>Oxford, OX3 7BN UK </aff>
      <aff id="Aff6"><label>6</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/0080acb59</institution-id><institution-id institution-id-type="GRID">grid.8348.7</institution-id><institution-id institution-id-type="ISNI">0000 0001 2306 7492</institution-id><institution>Translational Gastroenterology Unit, </institution><institution>John Radcliffe Hospital, </institution></institution-wrap>Oxford, OX3 9DS UK </aff>
      <aff id="Aff7"><label>7</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/035dkdb55</institution-id><institution-id institution-id-type="GRID">grid.499548.d</institution-id><institution-id institution-id-type="ISNI">0000 0004 5903 3632</institution-id><institution>Alan Turning Fellow in Health and Medicine, The Alan Turing Institute, </institution></institution-wrap>London, UK </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>13</day>
      <month>9</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>13</day>
      <month>9</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2023</year>
    </pub-date>
    <volume>15</volume>
    <elocation-id>70</elocation-id>
    <history>
      <date date-type="received">
        <day>30</day>
        <month>1</month>
        <year>2023</year>
      </date>
      <date date-type="accepted">
        <day>30</day>
        <month>8</month>
        <year>2023</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© Crown 2023</copyright-statement>
      <license>
        <ali:license_ref specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p><bold>Open Access</bold> This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article's Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article's Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated in a credit line to the data.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p id="Par1">T-cells play a crucial role in the adaptive immune system by triggering responses against cancer cells and pathogens, while maintaining tolerance against self-antigens, which has sparked interest in the development of various T-cell-focused immunotherapies. However, the identification of antigens recognised by T-cells is low-throughput and laborious. To overcome some of these limitations, computational methods for predicting CD8 + T-cell epitopes have emerged. Despite recent developments, most immunogenicity algorithms struggle to learn features of peptide immunogenicity from small datasets, suffer from HLA bias and are unable to reliably predict pathology-specific CD8 + T-cell epitopes.</p>
      </sec>
      <sec>
        <title>Methods</title>
        <p id="Par2">We developed TRAP (T-cell recognition potential of HLA-I presented peptides), a robust deep learning workflow for predicting CD8 + T-cell epitopes from MHC-I presented pathogenic and self-peptides. TRAP uses transfer learning, deep learning architecture and MHC binding information to make context-specific predictions of CD8 + T-cell epitopes. TRAP also detects low-confidence predictions for peptides that differ significantly from those in the training datasets to abstain from making incorrect predictions. To estimate the immunogenicity of pathogenic peptides with low-confidence predictions, we further developed a novel metric, RSAT (relative similarity to autoantigens and tumour-associated antigens), as a complementary to ‘dissimilarity to self’ from cancer studies.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p id="Par3">TRAP was used to identify epitopes from glioblastoma patients as well as SARS-CoV-2 peptides, and it outperformed other algorithms in both cancer and pathogenic settings. TRAP was especially effective at extracting immunogenicity-associated properties from restricted data of emerging pathogens and translating them onto related species, as well as minimising the loss of likely epitopes in imbalanced datasets. We also demonstrated that the novel metric termed RSAT was able to estimate immunogenic of pathogenic peptides of various lengths and species. TRAP implementation is available at: <ext-link ext-link-type="uri" xlink:href="https://github.com/ChloeHJ/TRAP">https://github.com/ChloeHJ/TRAP</ext-link>.</p>
      </sec>
      <sec>
        <title>Conclusions</title>
        <p id="Par4">This study presents a novel computational workflow for accurately predicting CD8 + T-cell epitopes to foster a better understanding of antigen-specific T-cell response and the development of effective clinical therapeutics.</p>
      </sec>
      <sec>
        <title>Supplementary Information</title>
        <p>The online version contains supplementary material available at 10.1186/s13073-023-01225-z.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Immunogenicity</kwd>
      <kwd>CD8 + T-cell epitopes</kwd>
      <kwd>Deep learning</kwd>
      <kwd>Transfer learning</kwd>
      <kwd>Computational immunology</kwd>
      <kwd>Epitope prediction</kwd>
      <kwd>Self-antigen tolerance</kwd>
      <kwd>MHC binding</kwd>
      <kwd>Thymic selection</kwd>
      <kwd>Neoepitope identification</kwd>
      <kwd>Vaccine candidates</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100000265</institution-id>
            <institution>Medical Research Council</institution>
          </institution-wrap>
        </funding-source>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100015250</institution-id>
            <institution>NIHR Bristol Biomedical Research Centre</institution>
          </institution-wrap>
        </funding-source>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© BioMed Central Ltd., part of Springer Nature 2023</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p id="Par38">T-cells are essential for eliminating intracellular infections, triggering anti-tumour response as well as developing an immunological memory. Their ability to induce antigen-directed cytotoxicity has proven instrumental in fighting diseases, as evidenced by checkpoint blockade immunotherapy, adoptive cellular therapy, and cancer vaccinology [<xref ref-type="bibr" rid="CR1">1</xref>–<xref ref-type="bibr" rid="CR3">3</xref>]. With the growing interest in identifying the cognate antigens of antigen-specific T-cells, many efforts have been made to improve experimental and computational methods for screening, predicting or characterising T-cell epitopes. However, current experimental approaches for identifying T-cell targets are labour-intensive, low-throughput and expensive [<xref ref-type="bibr" rid="CR4">4</xref>–<xref ref-type="bibr" rid="CR6">6</xref>], and computational methods are still in their infancy [<xref ref-type="bibr" rid="CR7">7</xref>].</p>
    <p id="Par39">An effective antigen-specific CD8 + T-cell response to exogenous pathogens or endogenous threats relies on tightly regulated processing and presentation of antigenic peptides by class I MHCs, followed by recognition of the peptide-MHC (pMHC) by cognate CD8 + T-cells. Therefore, immunogenic peptides encompass features associated with MHC presentation <italic>and</italic> T-cell recognition [<xref ref-type="bibr" rid="CR8">8</xref>]. Among these, it has been demonstrated that features attributed to MHC presentation are more prominent than those attributed to TCR recognition, with strongly conserved motifs at anchor positions being one such feature [<xref ref-type="bibr" rid="CR9">9</xref>, <xref ref-type="bibr" rid="CR10">10</xref>]. Indeed, recent cutting-edge models [<xref ref-type="bibr" rid="CR11">11</xref>, <xref ref-type="bibr" rid="CR12">12</xref>], such as the widely used NetMHCpan [<xref ref-type="bibr" rid="CR12">12</xref>], have demonstrated impressive performance in predicting MHC presentation on certain alleles. On the other hand, the dual nature of the peptide-specific TCR recognition interface, comprised of both peptide and MHC, makes predicting the interaction between TCR and pMHC uniquely challenging. In addition, the scarcity of peptides tested by T-cell assays, as well as the lack of true negative datasets (i.e. presented but not recognised by T-cells), hampers our understanding of the properties underlying T-cell recognition.</p>
    <p id="Par40">Despite these challenges, a plethora of computational models have been developed to aid in the prediction of T-cell targets and to foster a better understanding of the characteristics underpinning peptide immunogenicity [<xref ref-type="bibr" rid="CR8">8</xref>, <xref ref-type="bibr" rid="CR13">13</xref>–<xref ref-type="bibr" rid="CR17">17</xref>]. These models utilise features such as amino acids at contact position, large and aromatic side chains [<xref ref-type="bibr" rid="CR13">13</xref>], hydrophobicity [<xref ref-type="bibr" rid="CR17">17</xref>–<xref ref-type="bibr" rid="CR20">20</xref>], peptide-MHC binding affinity and stability [<xref ref-type="bibr" rid="CR16">16</xref>] as correlates to T-cell recognition. Specifically for cancer neoepitopes, agretopicity (i.e. the ratio of binding affinity between neoepitope and wild-type counterpart), foreignness score (i.e. similarity of neoepitope to previously characterised epitopes) [<xref ref-type="bibr" rid="CR8">8</xref>] and dissimilarity to human proteome [<xref ref-type="bibr" rid="CR21">21</xref>, <xref ref-type="bibr" rid="CR22">22</xref>] were found to indicate T-cell recognition.</p>
    <p id="Par41">However, we previously found that cancer and pathogenic epitopes often do not share the same immunogenicity features, which may differ in directionality or magnitude [<xref ref-type="bibr" rid="CR23">23</xref>]. In addition to the context-specific differences, other factors, such as limited training data and a highly diverse T-cell receptor (TCR) repertoire contributed to the difficulty of predicting T-cell recognition potential. As a result, many existing models perform poorly against both cancer and emerging viral pathogens [<xref ref-type="bibr" rid="CR7">7</xref>], and progress in improving performance appears to be incremental, suggesting that there are still remaining challenges in predicting T-cell epitopes.</p>
    <p id="Par42">Over the last decade, deep learning and natural language processing (NLP) have transformed biomedical research and offered breakthrough discoveries [<xref ref-type="bibr" rid="CR24">24</xref>]. Because of their ability to extract complex patterns from large amounts of data, deep neural network (DNN) models have been used for predicting peptide-HLA binding [<xref ref-type="bibr" rid="CR12">12</xref>, <xref ref-type="bibr" rid="CR25">25</xref>, <xref ref-type="bibr" rid="CR26">26</xref>] as well as TCR specificity [<xref ref-type="bibr" rid="CR27">27</xref>–<xref ref-type="bibr" rid="CR29">29</xref>]. Furthermore, transformer-based pre-trained language models (PLMs) have advanced the prediction of protein structure and function [<xref ref-type="bibr" rid="CR30">30</xref>–<xref ref-type="bibr" rid="CR33">33</xref>] by combining the power of transformers, self-supervised learning and transfer learning [<xref ref-type="bibr" rid="CR34">34</xref>–<xref ref-type="bibr" rid="CR36">36</xref>]. Indeed, as a solution to data constraints, these protein PLMs, which contain knowledge learned from a large volume of protein sequences, could serve as an additional source of information for related downstream tasks.</p>
    <p id="Par43">In addition, more research has recently been conducted on providing reliable predictions for safety–critical applications. Most of DNN models are trained under the assumption that test data distribution will be similar to the training data distribution. However, when used in real-world tasks, out-of-distribution (OOD) examples that deviate from the training data are common [<xref ref-type="bibr" rid="CR37">37</xref>, <xref ref-type="bibr" rid="CR38">38</xref>], resulting in a significant drop in model performance [<xref ref-type="bibr" rid="CR39">39</xref>–<xref ref-type="bibr" rid="CR41">41</xref>]. While this may be acceptable for some applications such as movie recommendations, it can be disastrous in safety–critical applications, such as medical diagnosis [<xref ref-type="bibr" rid="CR42">42</xref>, <xref ref-type="bibr" rid="CR43">43</xref>]. Therefore, the ability to identify OOD inputs and respond appropriately, whether by abstaining, requesting human intervention or gathering additional information, has become critical [<xref ref-type="bibr" rid="CR42">42</xref>]. Recently, several methods for estimating the degree of correctness have been proposed and have been successfully applied in the Natural language Inference (NLI) and/or OOD datasets [<xref ref-type="bibr" rid="CR44">44</xref>–<xref ref-type="bibr" rid="CR48">48</xref>]. One of the major challenges in immunogenicity prediction has been the limited data and OOD generalisation problem for peptides derived from different hosts, organisms and diseases. As such, the OOD detection module would facilitate making reliable predictions on a real-world set of peptides that are often highly diverse and heterogeneous.</p>
    <p id="Par44">Here, we present TRAP (<underline>T</underline>-cell <underline>r</underline>ecognition potential of HL<underline>A</underline>-I presented <underline>p</underline>eptides), a deep learning-based workflow that addresses the current limitations and effectively captures T-cell recognition motifs from HLA-I presented pathogenic or self-peptides. Novel strategies were implemented, such as (a) building separate models for pathogenic and self-peptides to account for divergent immunogenicity-related features, (b) using transfer learning to deliver amino acid embeddings from pre-trained large-scale protein language models, (c) capturing T-cell recognition motifs with a deep learning architecture, and (d) detecting low-confidence predictions to abstain from making incorrect predictions. We further developed RSAT (relative similarity to autoantigens and tumour-associated antigens) to estimate the immunogenicity of pathogenic peptides when they are abstained due to low-confidence predictions. The TRAP was then used to identify cancer neoepitopes from glioblastoma patients and showed superior performance to other methods. While many immunogenicity algorithms are based on MHC binding, TRAP goes one step further by predicting T-cell targets from MHC-I ligands. This novel workflow will enable more accurate identification of CD8 + T-cell epitopes, facilitating the development of effective vaccines and therapeutics.</p>
  </sec>
  <sec id="Sec2">
    <title>Methods</title>
    <sec id="Sec3">
      <title>Data preparation</title>
      <sec id="Sec4">
        <title>PeptideTcell data</title>
        <p id="Par45">Peptides that bind MHC-I molecules are typically restricted to 8–10 amino acids (aa) in lengths due to closed structure of peptide-binding groove. Given the limited number of 8aa peptides in databases, peptides of lengths 9–10aa characterised by T-cells were retrieved from IEDB [<xref ref-type="bibr" rid="CR49">49</xref>]. These included cancer neoepitopes, autoantigens or pathogenic peptides. The peptides without HLA allele or serotype annotations were removed. To ensure MHC binding, peptides were subjected to NetMHCpan 4.0 prediction and only those with rank ≤ 2.0 (i.e. predicted MHC binder) were retained. Peptides having contradictory immunogenicity annotations were categorised as ‘Positive’ and we only included Negatives that were characterised negative in ≥ 3 tests. This resulted 5093 immunogenic (‘Positive’) and 6628 non-immunogenic (‘Negative’) peptides in PeptideTcell data. The dataset includes information about peptide sequence, binary immunogenicity, HLA allele, source antigen and organism. This data is the foundation for sequence pattern analysis, model development and RSAT validation.</p>
      </sec>
      <sec id="Sec5">
        <title>Pathogenic data</title>
        <p id="Par46">For the analysis of sequence patterns and the development of deep learning-based models, datasets for pathogenic and self-antigens were prepared separately. For pathogenic datasets, we subset peptides originating from non-human species, resulting 4000 Positive and 6097 Negative pathogenic peptides (Additional file <xref rid="MOESM3" ref-type="media">3</xref>: Table S1).</p>
      </sec>
      <sec id="Sec6">
        <title>Self-antigen data</title>
        <p id="Par47">For immunogenic self-peptides, autoantigens, tumour-associated antigens and cancer neoepitopes having 9–10 amino acids were collected from different databases. We gathered 162 epitopes from cancer peptide database (<ext-link ext-link-type="uri" xlink:href="https://caped.icp.ucl.ac.be">https://caped.icp.ucl.ac.be</ext-link>), 228 from dbPepNeo [<xref ref-type="bibr" rid="CR50">50</xref>], 1506 from IEDB [<xref ref-type="bibr" rid="CR49">49</xref>], 256 from McPAS-TCR [<xref ref-type="bibr" rid="CR51">51</xref>] and 256 from NEPdb [<xref ref-type="bibr" rid="CR52">52</xref>]. For Negative self-antigens, we gathered HLA-I ligands expressed in thymus suggested to be involved in the negative selection of T-cells. Two hundred forty HLA-I ligands were collected from Adamopoulou et al. [<xref ref-type="bibr" rid="CR53">53</xref>], which were expressed in negatively selecting dendritic cells, 187 HLA-I ligands from Espinosa et al. [<xref ref-type="bibr" rid="CR54">54</xref>], which were expressed in thymus, and 10,840 benign HLA-I presented peptides from HLA Ligand Atlas [<xref ref-type="bibr" rid="CR55">55</xref>] expressed in thymus. Of note, we did not include ‘Negatives’ from IEDB for self-antigen data because many were tested due to their association with tumour-associated antigens, e.g. cancer/testis antigen 1, melanoma-associated antigen 9; yet, there was little evidence that these peptides were immunogenic. Therefore, only MHC-I peptides expressed in thymus were included. After pre-processing, removing duplicates and filtering for peptides with NetMHCpan rank ≤ 2, 1260 Positive and 2868 Negative peptides were retained for the self-antigen model. Since MHC binding filter removed many peptides, we prepared another self-antigen dataset with relaxed threshold (NetMHCpan rank ≤ 10) to include as many self-epitopes as possible for model training and validation, resulting 1606 Positive and 10,915 Negative peptides (Additional file <xref rid="MOESM3" ref-type="media">3</xref>: Table S2). For all analysis, the self-antigen dataset with relaxed threshold was used, unless otherwise specified.</p>
      </sec>
      <sec id="Sec7">
        <title>Benchmarking data</title>
        <p id="Par48">The benchmarking analysis has been done in HLA-agnostic (i.e. peptide-based) or HLA-restrictive (i.e. peptide-HLA based) manner depending on the nature of different models. The TRAP makes prediction based on the peptide sequence and HLA binding rank score, which allows it to predict in both HLA-agnostic and restrictive manner. The HLA-agnostic approach was applied on all peptides in the aforementioned pathogenic and self-antigen datasets. The HLA-restricted prediction was made against epitopes that were bound to 13 HLAs for which NetTepi could be performed, which are HLA-A*02:01, HLA-B*58:01, HLA-B*15:01, HLA-B*35:01, HLA-B*07:02, HLA-A*01:01, HLA-A*03:01, HLA-A*11:01, HLA-A*24:02, HLA-A*26:01, HLA-B*27:05, HLA-B*39:01, HLA-B*40:01. The list of models conducted in HLA-restricted manner are iPred [<xref ref-type="bibr" rid="CR17">17</xref>], PRIME [<xref ref-type="bibr" rid="CR56">56</xref>], NetTepi [<xref ref-type="bibr" rid="CR16">16</xref>], IEDB [<xref ref-type="bibr" rid="CR13">13</xref>] and DeepImmuno [<xref ref-type="bibr" rid="CR57">57</xref>]. Specifically for DeepImmuno, an additional filter was applied to exclude peptides that were bound to HLAs that DeepImmuno could not process.</p>
      </sec>
      <sec id="Sec8">
        <title>DeepImmuno data</title>
        <p id="Par49">DeepImmuno training data was retrieved from GitHub repository and used for evaluating the DeepImmuno performance (<ext-link ext-link-type="uri" xlink:href="https://github.com/frankligy/DeepImmuno">https://github.com/frankligy/DeepImmuno</ext-link>).</p>
      </sec>
    </sec>
    <sec id="Sec9">
      <title>10-fold CV and cross-species comparison</title>
      <p id="Par50">The peptideTcell data was divided randomly or in cross-species manner: (i) 90% train vs. 10% test random split (i.e. representation of 10-fold cross-validation), (ii) Non-SARS-CoV-2 (Non-SARS-2) train vs. SARS-2 test, and (iii) Non-vaccinia virus (Non-VACV) train vs. VACV test.</p>
      <p id="Par51">To compare the performance of the XGBOOST classifier on random vs. cross-species datasets, amino acids at contact positions were first represented by their physicochemical properties using ‘aaDescriptors’ function in R Peptides v2.4.4 package. The amino acid descriptors included kideraFactor, zScales, tScales, vhseScales, protFP, stScales, blosumIndices, mswhimScores, crucianiProperties and fasgaiVectors, which described properties such as polarity, electronic properties, hydrophobicity, α-helix/bend preference, β-sheet, bulkiness/size of side-chains, hydrogen-bonding, isoelectric point and structural topology [<xref ref-type="bibr" rid="CR58">58</xref>]. In addition to amino acid-level embedding, the peptide-wide property was added by averaging these aaDescriptors across all positions for each peptide. The embeddings from random split and cross-species datasets were used to generate the XGBOOST classifier using ‘XGBClassifier’ function in python xgboost v0.90 package. The set of hyperparameters, such as alpha, gamma, max_depth and colsample_bytree, were optimised by grid search for each dataset. The models were trained using training datasets: 90% train, Non-SARS-2 and Non-VACV peptides by 10-fold cross-validations. The trained models were tested on 10% test, SARS-2 and VACV peptides, respectively as representatives of 10-fold CV and cross-species comparisons.</p>
      <p id="Par52">To analyse sequence homology between training vs. test datasets, differential position-specific scoring matrices (dPSSMs) were generated for each training and test datasets. The probability frequency of each amino acid in each position was represented by position-specific scoring matrices using ‘consensusMatrix’ function from R Biostrings v2.56.0 package. The PSSMs from Positive and Negative peptides were standardised by centre and scaling, and differential PSSMs were generated by subtracting the two. To estimate the discriminative power of the dPSSM scores, we generated dPSSMs using training data and used the matrices to score respective test peptides for their immunogenicity potential.</p>
    </sec>
    <sec id="Sec10">
      <title>Immunogenicity positivity score</title>
      <p id="Par53">The positivity score was computed by taking three factors into account: (1) the number of experiments conducted, (2) the percentage tested positive and (3) the number of cognate TCRs if available, using the following equations.<disp-formula id="Equ1"><label>1</label><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm{PS}=\mathrm{pr}+\left(1-{\mathrm{e}}^{-\frac{\mathrm{T}N}{\mathrm{Qp}}}\right)$$\end{document}</tex-math><mml:math id="M2" display="block"><mml:mrow><mml:mi mathvariant="normal">PS</mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="normal">pr</mml:mi><mml:mo>+</mml:mo><mml:mfenced close=")" open="("><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="normal">e</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">T</mml:mi><mml:mi>N</mml:mi></mml:mrow><mml:mi mathvariant="normal">Qp</mml:mi></mml:mfrac></mml:mrow></mml:msup></mml:mfenced></mml:mrow></mml:math><graphic xlink:href="13073_2023_1225_Article_Equ1.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ2"><label>2</label><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm{PS}=1-\left[\mathrm{pr}+\left(1-\mathrm e^{-\frac{\mathrm TN}{\mathrm{Qn}}}\right)\right]$$\end{document}</tex-math><mml:math id="M4" display="block"><mml:mrow><mml:mi mathvariant="normal">PS</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mfenced close="]" open="["><mml:mi mathvariant="normal">pr</mml:mi><mml:mo>+</mml:mo><mml:mfenced close=")" open="("><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msup><mml:mi mathvariant="normal">e</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">T</mml:mi><mml:mi>N</mml:mi></mml:mrow><mml:mi mathvariant="normal">Qn</mml:mi></mml:mfrac></mml:mrow></mml:msup></mml:mfenced></mml:mfenced></mml:mrow></mml:math><graphic xlink:href="13073_2023_1225_Article_Equ2.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ3"><label>3</label><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm{x}=\frac{1}{1+{\mathrm{e}}^{-\mathrm{nTCR}}}$$\end{document}</tex-math><mml:math id="M6" display="block"><mml:mrow><mml:mi mathvariant="normal">x</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="normal">e</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mi mathvariant="normal">nTCR</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mfrac></mml:mrow></mml:math><graphic xlink:href="13073_2023_1225_Article_Equ3.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ4"><label>4</label><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm{PS}=\mathrm{min^{\prime}}+\frac{\mathrm{max^{\prime}}-\mathrm{min^{\prime}}}{\mathrm{max}(\mathrm{x})-\mathrm{min}(\mathrm{x})}*(\mathrm{x}-\mathrm{min}\left(\mathrm{x}\right))$$\end{document}</tex-math><mml:math id="M8" display="block"><mml:mrow><mml:mi mathvariant="normal">PS</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mi mathvariant="normal">min</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mi mathvariant="normal">max</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>-</mml:mo><mml:msup><mml:mi mathvariant="normal">min</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mrow><mml:mrow><mml:mi mathvariant="normal">max</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="normal">x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>-</mml:mo><mml:mi mathvariant="normal">min</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="normal">x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac><mml:mrow/><mml:mo>∗</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="normal">x</mml:mi><mml:mo>-</mml:mo><mml:mi mathvariant="normal">min</mml:mi><mml:mfenced close=")" open="("><mml:mi mathvariant="normal">x</mml:mi></mml:mfenced><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><graphic xlink:href="13073_2023_1225_Article_Equ4.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par54">(1) computes positivity score (PS) for Positives peptides that do not have TCR information available, where pr = % responded positive, TN = total number of tests conducted and Qp = the number of tests designated as a minimum number of tests required to support positivity (Qp = 3). (2) computes PS for Negative peptides, where Qn = number of tests designated as a minimum number of tests required to support negativity (Qn = 5). (3) and (4) compute for Positives with cognate TCR information. (3) is a sigmoid function that translates the number of cognate TCR (nTCR) to values in a logistic growth curve and (4) scales the distribution to align with scores from (1), where min’ equals mean of the distribution (~ 1.28 equivalent to 1 test and 1 responded positive) and max’ = 2.0. Due to limited pool of peptides with cognate TCRs, the majority of peptides’ positivity score was computed by translating the number of experiments conducted and % tested positive, and the number of cognate TCRs was incorporated to add greater weights to positivity (all positivity scores with cognate TCR had values &gt; 1). The positivity scores were computed for each entry for each peptide-HLA pair, and ranged from 0 to 2.3, with Negatives ranging from 0 to 1 and Positives ranging from 1 to 2.3.</p>
    </sec>
    <sec id="Sec11">
      <title>Intra- and inter-HLA variability</title>
      <p id="Par55">The HLA effect was computed on 2349 peptides having entries from multiple HLA alleles. One-way ANOVA was conducted for the effect of HLA on the positivity score for each peptide-HLA pair using ‘aov’ function from R stats v4.0.5 package. The distributions show mean squared from summary output.</p>
    </sec>
    <sec id="Sec12">
      <title>Differential sequence patterns</title>
      <p id="Par56">The n-grams (i.e. contiguous sequence of n-amino acids) were generated using ‘ngram’ function from R ngram v3.1.0 package. The number of peptides containing the n-grams was counted for Positive and Negative respectively and normalised for the total number of Positive and Negative peptides, respectively. Then, we computed ratio<sub>n-gram</sub> = normalised # of Positive peptides containing the n-gram / normalised # of Negative peptides containing the n-gram, and shortlist top differential n-grams by the ratio score. Similarly, we generated all possible combinations of position-specific k-mer motifs (i.e. contiguous or non-contiguous sequence of k amino acids restricted to peptides of same lengths), where e.g..M.W. denotes MW pattern at P2 and P4 of 5 amino acid peptide. We computed ratio <sub>positional k-mer</sub> = normalised # of Positive peptides containing the positional k-mer / normalised # of Negative peptides containing the positional k-mer to shortlisted top differential position-specific k-mer motifs. For visualisation, patterns were categorised by their normalised ratios, where ‘lows’ have ¼ &lt; ratio &lt; 4, ‘high in pos’ have ratio ≥ 4, ‘high in neg’ have ratio ≤ ¼, and ‘onlys’ have motifs in either positive or negative sets, and top differential patterns from ‘high’ or ‘only’ categories were visualised by barplot. To identify shared enriched patterns between pathogenic and self-antigens, only n-grams or positional k-mer motifs having ratio ≥ 3 or ≥ 3 positive peptides (for onlys) were pre-selected for comparison. The pairwise sequence similarity between peptides was computed using ‘pairwiseAlignment’ function in Biostrings v2.56.0 package [<xref ref-type="bibr" rid="CR59">59</xref>], using BLOSUM62 substitution matrix and default parameters. For clusters of highly similar peptides, the peptides having alignment scores ≥ 22 with ≥ 3 other peptides were visualised into network graph using R ggnetwork v0.5.10 package. The toolkits for generating the sequence patterns are deposited in: <ext-link ext-link-type="uri" xlink:href="https://github.com/ChloeHJ/diffSeqPatterns">https://github.com/ChloeHJ/diffSeqPatterns</ext-link> [<xref ref-type="bibr" rid="CR60">60</xref>].</p>
    </sec>
    <sec id="Sec13">
      <title>Deep learning models for pathogenic and self-epitope prediction</title>
      <p id="Par57">The peptide sequences at contact positions, i.e. P3-P8 of 9aa and P3-P9 of 10aa peptides, were encoded either by one-hot-encoding having dimension [m, 7, 21], amino acid descriptors [m, 7, 49] or amino acid embeddings from protein transformer-based pre-trained language models (PLMs) [m, 7, 1024], where m represents the number of peptides. The amino acid descriptors included kideraFactors, tScales, protFP, BLOSUM, stScales and MSWHIM captured by ‘aaDescriptors’ function from R Peptides v2.4.4 package, and Atchley factors from ‘AAMetric.Atchley’ function in R HDMD v1.2 package. In addition, amino acids were embedded using five protein transformer-based PLMs, including prot_t5_xl_uniref50, prot_bert, prot_bert_bfd and prot_t5_xl_bfd, prot_xlnet from Rostlab using Tokenizer and EncoderModel functions from python transformers v4.19.0 package. These models are based on T5 or BERT and were pre-trained on a large corpus of protein sentences, e.g. UniRef50, a dataset consisting of 45 million protein sequences, in a semi-supervised fashion. Further details about transformer-based PLMs can be found in <ext-link ext-link-type="uri" xlink:href="https://huggingface.com/Rostlab">https://huggingface.com/Rostlab</ext-link>.</p>
      <p id="Par58">To account for peptides of varying lengths, the peptides coming from 9aa peptides were padded (i.e. adding non-relevant number to the borders of the matrix) either in the front (i.e. pre-padding) or at the back (i.e. post-padding). First, we computed all possible n-grams from 6- and 7-mer peptides and analysed if the same n-grams were present in both 6- and 7-mers. We found that many n-grams were present in both 6- and 7-mers. We then aligned by their respective positions and observed that many 3-g located in P3-P5 of 9aa peptides were positioned at P4-P6 of 10aa peptides, indicating padding in front of 6-mer peptide (i.e. pre-padding) would align with hotspots in 7-mers.</p>
      <p id="Par59">The classification accuracies of different deep learning architectures were compared between simple dense layer (i.e. classification), biRNN, biLSTM, 1D CNN, 2D CNN and transformer models. The biRNN model contained two biRNN layers each having 512 units, followed by a dense layer of 256 units and a classification layer with dropouts in-between. The biLSTM model had the same structure as the biRNN model, but LSTM cell is used instead of the RNN cell. 2D CNN model had two Conv2D layers, with filters = 16 and 32 respectively, followed by MaxPool2D, Flatten, a dense layer of 256 units and a classification layer with dropouts in-between. The transformer model for pathogenic and self-antigen data had 10 and 2 attention heads respectively and 32 hidden layers in a feed forward network, followed by GlobalAveragePooling1D, dense layer with 128 units and classification, with dropouts in-between. The 1D CNN had kernel sizes 1, 3, 5 and 7, each max pooled and concatenated to a layer. In parallel, − log transformed NetMHCpan rank and hydrophobicity (i.e. the proportion of A, V, L, M, W) have been added as a MLP layer. 1D CNN and MLP layers were concatenated and put into a dense layer of 256 units followed by classification. The hyperparameters of the final 1D CNN models were optimised by grid search. The final hyperparameters for pathogenic model are as follows: learning rate = 1e − 05, weight decay = 1e − 06, dropout rate = 0.1, batch size = 50, dense layer node = 2000 and dense layer node = 256, giving ROC-AUC of 0.764 by 10-fold cross-validation. The final hyperparameters for self-antigen model are as follows: learning rate = 0.001, weight decay = 0.01, dropout rate = 0.2, batch size = 100, MLP dense = 1500 and dense layer node = 512, giving ROC-AUC of 0.943 by 10-fold cross-validation. All deep learning architectures are implemented using python TensorFlow v2.8.0 package.</p>
    </sec>
    <sec id="Sec14">
      <title>Out of distribution (OOD) detection</title>
      <p id="Par60">The out-of-distribution was defined as test samples having different properties from the training data, and thus cannot be predicted with high accuracy. We found that one of the significant sources of out-of-distribution is the origin of the peptides, i.e. pathogenic vs. self-antigen or different pathogenic organisms, and that peptides originating from species not well represented in the training data have lower predictive accuracy. Given the limited number of biologically homogeneous (i.e. in-domain) peptide as well as technical variation coming from different T-cell assays, experimental setups and laboratories, it was difficult to collect enough peptides for in-domain analysis, so we used predictive accuracy as the proxy to build OOD classifier, trained to classify correctly vs. incorrectly predicted peptides.</p>
      <p id="Par61">Autoencoder is a type of unsupervised neural network that have a smaller number of neurons in the hidden layers than the input layer. This allows the architecture to extract essential information from the input layer, preserve in lower-dimension and employ to reconstruct output. We used the difference between the input and reconstructed output (i.e. reconstruction loss) as a metric for anomaly detection, as autoencoders cannot effectively reconstruct patterns not learnt from training data [<xref ref-type="bibr" rid="CR61">61</xref>].</p>
      <p id="Par62">For anomaly detection, peptides encoded by prot_t5_xl_uniref50 transformer-based PLM were applied onto 2D and 3D autoencoders, variational autoencoder and denoising autoencoder models, using ‘AutoEncoder’ function from python pyod v1.0.1 package. The autoencoder models were trained using 90% random train and non-SARS-CoV-2 data and were used to predict 10% test and SARS-CoV-2 data respectively. Then, we computed reconstruction loss between original and predicted test values.</p>
      <p id="Par63">For calibration methods, the 1D CNN model was trained using softmax activation function. We then computed maximum softmax probability (MaxProb) and temperature-scaled softmax probability (T = 2) for each test peptide. The MaxProb is the maximum softmax probability between class 0 (Negative) and 1 (Positive) classes. The temperature scaling softens the softmax probability with T &gt; 1, making the network slightly less confident, reflecting the true probabilities [<xref ref-type="bibr" rid="CR62">62</xref>]. For Ensemble, we used 10-folds of the training dataset to generate 10 different models. These models were then used to predict test data points, producing prediction scores for each. We averaged softmax probabilities across 10 different models and computed MaxProb of the average. For Monte Carlo dropout (MCDropout), Monte Carlo models were reiterated 100 times with stochastic dropout of 0.6. The softmax probabilities were averaged across 100 scores, and MaxProb was generated from them.</p>
      <p id="Par64">The final OOD classifier predicts correct vs. incorrect predictions by using MCDropout, which have been shown to be more robust than maximum softmax probabilities (MSP). The MSP is often not suitable when overfitting is likely, as the values will either be 0 or 1, whereas MCDropout provides a better estimate of uncertainty by combining multiple confidence scores generated by many models and providing informative statistics (e.g. mean and variation of the confidence scores) as opposed to a single scalar value. We built linear regression model with MCDropout, using the ‘LinearRegression’ function from python sklearn v1.0.2 package.</p>
    </sec>
    <sec id="Sec15">
      <title>Relative Similarity to Autoantigens or Tumour-associated antigens (RSAT)</title>
      <p id="Par65">To compute RSAT, a total of 5023 unique cancer neoepitopes, autoantigens, tumour-associated antigens and other self-epitopes were retrieved from IEDB, dbPepNeo, NEPdb, McPAS-TCR and tumour antigenic peptide database. First, only pathogenic peptides having comparable self-epitope counterparts are retrained by computing Match score [<xref ref-type="bibr" rid="CR63">63</xref>] (5) between pathogenic peptides and self-epitopes, where BL represents the global–local alignment score using BLOSUM62 matrix, p represents pathogenic peptide and se self-epitopes. Only pathogenic peptides having a match score ≥ 0.6 are retained to compute RSAT.<disp-formula id="Equ5"><label>5</label><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Match\ score=\frac{BL\left(p, se\right)}{\sqrt{BL\left(p, se\right)\ *\ BL(p, se)}}$$\end{document}</tex-math><mml:math id="M10" display="block"><mml:mrow><mml:mi>M</mml:mi><mml:mi>a</mml:mi><mml:mi>t</mml:mi><mml:mi>c</mml:mi><mml:mi>h</mml:mi><mml:mspace width="4pt"/><mml:mi>s</mml:mi><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>B</mml:mi><mml:mi>L</mml:mi><mml:mfenced close=")" open="("><mml:mi>p</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi><mml:mi>e</mml:mi></mml:mfenced></mml:mrow><mml:msqrt><mml:mrow><mml:mi>B</mml:mi><mml:mi>L</mml:mi><mml:mfenced close=")" open="("><mml:mi>p</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi><mml:mi>e</mml:mi></mml:mfenced><mml:mspace width="4pt"/><mml:mrow/><mml:mo>∗</mml:mo><mml:mspace width="4pt"/><mml:mi>B</mml:mi><mml:mi>L</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>p</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi><mml:mi>e</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:msqrt></mml:mfrac></mml:mrow></mml:math><graphic xlink:href="13073_2023_1225_Article_Equ5.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par66">For pathogenic peptides having comparable self-epitope counterparts, RSAT was computed (6). First, we computed the maximum global–local alignment score between pathogenic peptides and AATs (a set of autoimmunity, allergy tor tumour-associated antigens) using the BLOSUM62 substitution matrix. Second, we computed the maximum global alignment score between pathogenic peptide and AAT’s best counterpart in human proteome. Third, we computed the ratio between alignment scores from self-epitope and human proteome counterpart. In the Eq. (<xref rid="Equ6" ref-type="disp-formula">6</xref>) below, p = pathogenic peptide, AAT = autoimmunity, allergy tor tumour-associated antigens, hp = human proteome.<disp-formula id="Equ6"><label>6</label><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$RSAT=\frac{BL\left(p, AATs\right)}{BL\left(p,hp\right)}$$\end{document}</tex-math><mml:math id="M12" display="block"><mml:mrow><mml:mi>R</mml:mi><mml:mi>S</mml:mi><mml:mi>A</mml:mi><mml:mi>T</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>B</mml:mi><mml:mi>L</mml:mi><mml:mfenced close=")" open="("><mml:mi>p</mml:mi><mml:mo>,</mml:mo><mml:mi>A</mml:mi><mml:mi>A</mml:mi><mml:mi>T</mml:mi><mml:mi>s</mml:mi></mml:mfenced></mml:mrow><mml:mrow><mml:mi>B</mml:mi><mml:mi>L</mml:mi><mml:mfenced close=")" open="("><mml:mi>p</mml:mi><mml:mo>,</mml:mo><mml:mi>h</mml:mi><mml:mi>p</mml:mi></mml:mfenced></mml:mrow></mml:mfrac></mml:mrow></mml:math><graphic xlink:href="13073_2023_1225_Article_Equ6.gif" position="anchor"/></alternatives></disp-formula></p>
    </sec>
    <sec id="Sec16">
      <title>Application of TRAP to shortlisting glioblastoma neoantigens</title>
      <p id="Par67">In previous in-house study [<xref ref-type="bibr" rid="CR64">64</xref>], tumours of four HLA-A2 glioblastoma patients were sequenced and cancer neoepitopes were shortlisted using an in-house version of MuPeXI [<xref ref-type="bibr" rid="CR65">65</xref>] named TUNAPASTA v0.5. We then selected 153 predicted neoepitopes for functional T-cell assays, 33 of which were characterised Positive. From these 153 tested peptides, we filtered out predicted HLA*02:01 non-binders and retained 9–10 amino acid peptides that were applicable to TRAP. This left 124 GBM peptides, 25 of which were Positives and 99 Negatives. We used a pre-trained self-antigen TRAP model on this dataset to predict the immunogenicity of GBM peptides as well as the confidence of prediction by the OOD detection module. Because identifying cancer neoepitopes is thought to be a ‘needle in a haystack’ problem, we identified predicted Negatives with low-confidence prediction, and added 24 more candidates for validation, resulting in a ROC-AUC of 0.705.</p>
    </sec>
  </sec>
  <sec id="Sec17">
    <title>Results</title>
    <sec id="Sec18">
      <title>TRAP: a robust deep learning workflow to predict CD8 + T-cell recognition of MHC-I presented pathogenic and self-peptides</title>
      <p id="Par68">We present TRAP as a comprehensive workflow for predicting CD8 + T-cell immunogenicity of HLA-I presented pathogenic and self-peptides (Fig. <xref rid="Fig1" ref-type="fig">1</xref>A).<fig id="Fig1"><label>Fig. 1</label><caption><p>Schematic of TRAP workflow and cross-species variation in T-cell recognition features. <bold>A</bold> Schematic diagram of TRAP (T-cell recognition potential of HLA-I presented peptides), a robust deep learning-based workflow to predict CD8 + T-cell epitopes from MHC-I presented pathogenic or self-peptides. Once peptides have been predicted by NetMHCpan to bind HLA alleles, the TRAP uses the peptide sequence and NetMHCpan rank scores as inputs to predict the immunogenicity of the peptide with the respective HLA binding affinity. The TRAP workflow will output TRAP prediction score along with confidence in its prediction. If the prediction is detected to have a low confidence, we recommend predicting cancer neoepitopes using TESLA [<xref ref-type="bibr" rid="CR52">52</xref>], which is known to use more general features such as agretopicity and dissimilarity to self-proteome, and pathogenic peptides with RSAT (relative similarity to autoantigens or tumour-associated antigens). <bold>B</bold>, <bold>C</bold> Distribution of MHC binding rank scores predicted by NetMHCpan (<bold>B</bold>) and hydrophobicity (<bold>C</bold>) for peptides derived from different pathogenic species. CMV: cytomegalovirus; EBV: Epstein-Barr virus; HCV: hepatitis C virus; HBV: hepatitis B virus; SARS-2: SARS-CoV-2; VACV: vaccinia virus; YFV: yellow fever virus. <bold>D</bold> Statistics of peptides in cross-species dataset (i.e. non-vaccinia virus (non-VACV) peptides for training and VACV peptides for testing, non-SARS-CoV-2 (non-SARS2) peptides for training and SARS-2 peptides for testing), and data randomly divided into 90% train and 10% test, as a resemblance of 10-fold cross-validation. <bold>E</bold>, <bold>F</bold> Models trained using cross-species datasets could not effectively predict the immunogenicity of peptides derived from unseen pathogens. ROC-AUC curves of XGBOOST classifiers on training data by 10-fold cross-validations—on 90% data, non-SARS-2 and non-VACV peptides (<bold>E</bold>). ROC-AUC curves of XGBOOST classifiers on test datasets—10% data, SARS2 and VACV peptides (<bold>F</bold>). <bold>G</bold> Sequence logo of amino acids enriched in epitopes (Positive) compared to non-epitopes (Negative) in contact positions for randomly split data (i), SARS-2 data (ii) and vaccinia virus data (iii). <bold>H</bold>, <bold>I</bold> High performance may be a reflection of HLA bias. ROC curve of DeepImmuno algorithm on single HLA allele, for peptides bound on HLA-A*02:01 (<bold>H</bold>) or HLA-A*24:02 (<bold>I</bold>). <bold>J</bold> Performance of DeepImmuno algorithm on per-HLA down-sampled dataset, i.e. the number of peptides has been down</p></caption><graphic xlink:href="13073_2023_1225_Fig1_HTML" id="MO1"/></fig></p>
      <p id="Par69">In this workflow, peptide sequences of 9–10 amino acids in length are predicted to bind HLAs. The predicted HLA-I ligands are encoded using amino acid embeddings derived from protein transformer-based pre-trained language models (PLMs). TRAP then employs a 1D convolutional neural network to extract T-cell recognition motifs, which are then combined with MHC binding rank score and hydrophobicity to predict peptide immunogenicity. Following that, TRAP includes a linear regression classifier to detect low-confidence predictions to improve accuracy. The immunogenicity of pathogenic peptides with low-confidence predictions can be predicted using a novel metric called relative similarity to autoantigens or tumour-associated antigens (RSAT), which is developed as a complement to ‘dissimilarity to self’ from cancer studies.</p>
      <p id="Par70">TRAP has been developed as a user-friendly web application and is accessible from <ext-link ext-link-type="uri" xlink:href="https://github.com/ChloeHJ/TRAP">https://github.com/ChloeHJ/TRAP</ext-link> [<xref ref-type="bibr" rid="CR66">66</xref>]. Here, users can input their peptide list and select the model of interest (pathogenic or self-antigen), and the application will compute the prediction scores along with its confidence (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S1, Additional file <xref rid="MOESM2" ref-type="media">2</xref>). In the following sections, we will describe the rationales behind the model architecture and strategies for overcoming the current constraints and improving model performance.</p>
    </sec>
    <sec id="Sec19">
      <title>Out-of-distribution uncertainty and HLA bias result in poor performance</title>
      <p id="Par71">We previously reported that the existing immunogenicity algorithms showed suboptimal performance in predicting epitopes from both cancer and an emerging viral pathogen [<xref ref-type="bibr" rid="CR7">7</xref>]. We then attributed the poor performance to divergent discriminative features between cancer neoepitopes and pathogenic epitopes in directionality or magnitudes [<xref ref-type="bibr" rid="CR7">7</xref>, <xref ref-type="bibr" rid="CR23">23</xref>].</p>
      <p id="Par72">Here, we investigated additional sources of suboptimal performance to aid in the development of accurate, robust and biologically meaningful classifiers. We retrieved peptides of lengths 9–10aa, characterised by T-cell assays from IEDB and retained predicted MHC binder from NetMHCpan 4.0, resulting in 5093 immunogenic (‘Positive’) and 6628 non-immunogenic (‘Negative’) peptides (named PeptideTcell data, ‘<xref rid="Sec4" ref-type="sec">Methods</xref>’) (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S2A). Notably, no peptides may be considered truly non-immunogenic as they may be recognised by at least one TCR in the repertoire under the right physiological conditions. However, there is a continuum of immunogenicity potential where some peptides are likely to trigger greater T-cell response and/or are able to bind numerous TCRs. Therefore, we designated the ‘Negatives’ as peptides with very low putative immunogenicity potential, defined as peptides characterised negative in more than three T-cell assays.</p>
      <p id="Par73">First, we evaluated the extent to which known hallmarks of immunogenicity, such as MHC binding affinity [<xref ref-type="bibr" rid="CR12">12</xref>, <xref ref-type="bibr" rid="CR16">16</xref>] and percentage of hydrophobic amino acids in peptide sequence [<xref ref-type="bibr" rid="CR20">20</xref>], can be used to identify immunogenic peptides from different species. Notably, these features have been used as predictors in models such as TESLA [<xref ref-type="bibr" rid="CR8">8</xref>], iPred [<xref ref-type="bibr" rid="CR17">17</xref>], NetTepi [<xref ref-type="bibr" rid="CR16">16</xref>] and GAO [<xref ref-type="bibr" rid="CR67">67</xref>]. Although two features could effectively distinguish epitopes from non-epitopes at a macroscopic level, where epitopes had higher MHC binding rank (− log transformed) and hydrophobicity with medium effect sizes (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S2B-C), they no longer showed statistical significance at the species level (Fig. <xref rid="Fig1" ref-type="fig">1</xref>B,C), which was caused in part by the small sample size. For example, hydrophobicity alone could not discriminate SARS-CoV-2 epitopes from non-epitopes.</p>
      <p id="Par74">Second, we assessed the extent to which cross-species peptides (i.e. peptides derived from other species) can predict epitopes of unseen pathogens. We divided PeptideTcell data randomly or in a cross-species manner: (i) random split to 90% train vs. 10% test (i.e. representation of 10-fold cross-validation), or (ii) cross-species split to Non-SARS-CoV-2 (Non-SARS-2) train vs. SARS-2 test, and Non-vaccinia virus (Non-VACV) train vs. VACV test (Fig. <xref rid="Fig1" ref-type="fig">1</xref>D). We then compared the performance of XGBOOST classifiers on these datasets (‘<xref rid="Sec4" ref-type="sec">Methods</xref>’). While no substantial difference was observed during training (Fig. <xref rid="Fig1" ref-type="fig">1</xref>E), the cross-species model showed lower accuracy and higher root mean squared error (RMSE) on test datasets (Fig. <xref rid="Fig1" ref-type="fig">1</xref>F). This implied that cross-species peptides may not share common features in predicting immunogenicity (i.e. predictive features in training and test data are likely to be different which is known as an out-of-distribution generalisation problem), resulting in limited accuracy on unseen pathogens.</p>
      <p id="Par75">To support this, we generated differential position-specific scoring matrices (dPSSMs) to compare immunogenicity-related sequence patterns between train and test datasets (‘<xref rid="Sec4" ref-type="sec">Methods</xref>’). While random split data shared similar patterns between train and test datasets, such as enrichment of L, G/E, G, hydrophobic resides and T on P3-P8 (Fig. <xref rid="Fig1" ref-type="fig">1</xref>Gi), cross-species data showed low homology (Fig. <xref rid="Fig1" ref-type="fig">1</xref>Gii-iii), and dPSSM scores failed to predict immunogenicity on cross-species test datasets (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S2D, ‘<xref rid="Sec4" ref-type="sec">Methods</xref>’).</p>
      <p id="Par76">Third, we observed that high reported performance from the latest models incorporating peptide-HLA pairs might be driven by HLA bias from an imbalanced dataset. Recently, deep learning models incorporating peptide-HLA pairs reported ROC-AUC of ~ 0.85 by 10-fold cross-validation [<xref ref-type="bibr" rid="CR15">15</xref>] (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S2E-F). While they reported the highest accuracy to date, we observed poor performance on SARS-CoV-2 peptides in our benchmarking study [<xref ref-type="bibr" rid="CR7">7</xref>]. Here, we hypothesised that this poor agreement may be due to differences in datasets and investigated the cause of disagreement.</p>
      <p id="Par77">First, we evaluated the ability of the model to discriminate Positive vs. Negative bound on the same HLA allele. We trained and tested models in single HLA level on HLA-A*02:01 and HLA-A*24:02, which had the highest numbers of characterised peptides per HLA. We then compared them to the model trained using the same number of randomly sampled pMHCs (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S2G). Here, the model showed marginally better than random performance on the balanced HLA-A*02:01 dataset (Fig. <xref rid="Fig1" ref-type="fig">1</xref>H), and high variation on the relatively imbalanced and smaller HLA-A*24:02 dataset (Fig. <xref rid="Fig1" ref-type="fig">1</xref>I). We further found that HLA-balanced data substantially reduces classifier performance (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S2H, Fig. <xref rid="Fig1" ref-type="fig">1</xref>J), suggesting that current models are skewed towards classifying for certain over- or under-represented HLA alleles and their reported performance does not reflect their real-world accuracy.</p>
    </sec>
    <sec id="Sec20">
      <title>Mitigate HLA bias by employing peptide sequences at TCR contact positions</title>
      <p id="Par78">Previous studies reported the contribution of anchor positions (i.e. position 2 (P2) and P9 of 9aa peptide) for MHC binding [<xref ref-type="bibr" rid="CR68">68</xref>] and contact positions (i.e. P3-P8) in T-cell recognition [<xref ref-type="bibr" rid="CR13">13</xref>]. Correspondingly, HLA supertypes drove the clustering of peptides at anchor positions (Fig. <xref rid="Fig2" ref-type="fig">2</xref>A) and TCR specificities at contact positions (Fig. <xref rid="Fig2" ref-type="fig">2</xref>B,C, Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S3A-B) on our data, with peptides bound by the same TCR showing conserved motifs (Fig. <xref rid="Fig2" ref-type="fig">2</xref>D). However, because of the strong conserved pattern in anchor positions, the HLA supertype not only drove the clustering of peptides at anchor positions but also acted as the strongest covariate driving the clustering of peptides in full sequence (Fig. <xref rid="Fig2" ref-type="fig">2</xref>E, Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S3C). With such a strong conserved pattern, MHC binding features may dominate immunogenicity predictions when the full peptide sequence is used for model training. In fact, we observed that some of the existing immunogenicity classifiers were more capable of predicting dominant HLA type (i.e. whether peptides were bound to HLA-A*02:01 or not) than peptide immunogenicity [<xref ref-type="bibr" rid="CR7">7</xref>]. As we aimed to predict T-cell recognition potential once peptides are bound to HLA alleles, we incorporated contact positions only, i.e. positions 3–8 (P3-P8) of 9aa peptide and P3-P9 of 10aa peptides, not only to focus on T-cell recognition patterns, but also to rule out the need to balance the number of epitopes vs. non-epitopes by the HLA supertypes for model development.<fig id="Fig2"><label>Fig. 2</label><caption><p>Effect of anchor and contact positions on peptide immunogenicity. <bold>A</bold> t-SNE embedding of peptides, coloured by HLA supertypes. Peptides at anchor positions (i.e. P2 and P9 of 9aa peptides) were represented by amino acid descriptors (aaDescriptors) and all amino acids across the peptide sequence were averaged to compute peptide-wide aaDescriptors. Each peptide was represented by positional (only at anchor positions) and peptide-wide aaDescriptors. <bold>B</bold>, <bold>C</bold> t-SNE embedding of peptide-wide descriptors and amino acids at contact positions, coloured by cognate TCRs for 9aa peptides (<bold>B</bold>) and 10aa peptides (<bold>C</bold>). <bold>D</bold> Sequence logos of peptides recognised by the same TCR, coloured by the physicochemical properties. Notably, these are examples of TCRs having the most cognate peptides in the database. However, except for the first TCR, the low number of peptides may limit statistical confidence in representing sequence conservation. <bold>E</bold> t-SNE embeddings of peptide-wide descriptors and amino acids at all positions, coloured by HLA supertype (left), immunogenicity (middle) and species of origin (right). <bold>F</bold> Distribution of intra-HLA and inter-HLA variation for peptides having different peptide-HLA entries. The variation described by ANOVA means squared</p></caption><graphic xlink:href="13073_2023_1225_Fig2_HTML" id="MO2"/></fig></p>
      <p id="Par79">To take such an approach, we first investigated whether neglecting HLA information would not result in a significant loss of information when predicting T-cell recognition potential of MHC-presented peptides from the current dataset. First, a novel metric was developed for converting qualitative measurements (i.e. Positive or Negative) to a quantitative ‘positivity score’ that reflects confidence in the immunogenicity (‘<xref rid="Sec4" ref-type="sec">Methods</xref>’). Briefly, the metric took into account (a) the number of experiments conducted (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S4A), (b) the percentage tested positive (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S4B) and (c) the number of cognate TCRs where available (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S4C) to compute the positivity score (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S4D).</p>
      <p id="Par80">Using the positivity scores of each peptide-HLA entry, the extent of inter-HLA variation (i.e. variation across different HLA alleles) was compared to intra-HLA variation (i.e. variation within the same HLA allele) for peptides bound on multiple HLA alleles. The intra-HLA variation accounted for the majority of data variability, while inter-HLA variation contributed less (Fig. <xref rid="Fig2" ref-type="fig">2</xref>F). This is because other biological (e.g. different effector cell, antigen presenting cells etc.) or technical (e.g. assay type, culture conditions, research groups etc.) factors were causing greater discrepancies in positivity score than HLA alleles (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S4E-F). This implied that when it came to each peptide, there was not much difference in the immunogenicity based on the HLAs to which it was bound, but when it came to HLAs, each HLA had a different pool of peptides, resulting in a different distribution of positive and negative peptides, resulting in HLA bias. As a result, an HLA-generalised approach was adopted in which peptide-HLA binding information was used instead of the HLA allele itself.</p>
    </sec>
    <sec id="Sec21">
      <title>Deep learning architecture captures T-cell recognition motifs</title>
      <p id="Par81">As the potential causes of poor performance, previous sections discussed limited training dataset, HLA bias and out-of-distribution (OOD) generalisation problem. These issues were addressed in TRAP by (a) using peptide sequence at contact positions, (b) building separate models for pathogenic and self-peptides, (c) encoding peptide sequences using amino acid properties derived from protein transformer-based pre-trained language models (PLMs), (d) devising one-dimensional convolutional neural network (1D CNN) architecture designed to capture T-cell recognition motifs and (e) employing OOD detection module. These novel strategies enabled TRAP to offer more accurate and reliable predictions of CD8 + T-cell targets against cancer and viral diseases.</p>
      <p id="Par82">First, pathogenic and self-antigen datasets were prepared to build context-specific models (‘<xref rid="Sec4" ref-type="sec">Methods</xref>’). Briefly, the pathogenic dataset is a subset of the PeptideTcell data, comprising only pathogen-derived peptides (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S5A). For the self-antigen dataset, autoantigens, tumour-associated antigens and cancer neoepitopes were retrieved from Cancer peptide database, dbPepNeo, IEDB, McPAS-TCR and NEPdb databases as epitopes, and benign HLA-I ligands expressed in thymus as non-epitopes (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S5B-C).</p>
      <p id="Par83">Given the lack of non-immunogenic self-peptides, we used HLA-I ligands expressed in the thymus as ‘non-immunogenic’ peptides in the self-antigen model. T-cells are selected within the thymus to establish a repertoire that is pathogen-protective but not self-reactive. While self-peptides are used in both positive and negative selections, we reasoned that self-peptides expressed in the thymus are unlikely to be immunogenic in the periphery for the following reasons. First, self-peptides will eliminate high-affinity or strong-response T-cells, leaving no repertoire to recognise these peptides [<xref ref-type="bibr" rid="CR69">69</xref>]. Second, while T-cells may recognise self-peptides through positive selection, it is theorised that the interactions are very weak and that once T-cells leave the thymus, they will not be able to induce an immune response to that same antigen due to the low affinity, but will instead react to another peptide that was not present in the thymus and has a higher affinity [<xref ref-type="bibr" rid="CR70">70</xref>, <xref ref-type="bibr" rid="CR71">71</xref>]. Hence, we reasoned that thymus-expressing peptides would not be immunogenic, either because they cause the elimination of strong-response T-cells or because they promote the retention of low-affinity T-cells, allowing the formation of a T-cell repertoire that avoids self-reactivity in general. To our knowledge, this is the first study to use the concept of thymic selection in classifying self-epitopes from non-epitopes.</p>
      <p id="Par84">Second, because peptides vary in lengths, we investigated the optimal padding strategy for aligning 6-mer with 7-mer contact position peptides. The predictive accuracies of simple dense layer classification, 1D CNN, 2D CNN and bidirectional recurrent neural network (biRNN) models were evaluated using pre- and post-padding strategies. No significant difference was observed across pathogenic and self-antigen data, with pre-padding achieving slightly better performance in self-antigen data on the BiRNN model (Fig. <xref rid="Fig3" ref-type="fig">3</xref>A). Furthermore, the relative location of k-gram motifs was compared on 6-mer and 7-mer peptides, and many 3-g motifs found at P3 of the 9aa peptide were found at P4 of the 10aa peptide (Fig. <xref rid="Fig3" ref-type="fig">3</xref>B). Therefore, to align T-cell recognition hotspots with biological context, peptides of shorter length were pre-padded to align with longer peptides.<fig id="Fig3"><label>Fig. 3</label><caption><p>Optimise TRAP architecture. <bold>A</bold> Performance of pre- and post-padding strategies. ROC-AUC values of respective deep learning models with pre- vs. post-padding strategies for pathogenic (i) and self-antigens (ii). Each point represents the ROC-AUC value from one round of 10-fold cross-validations. <bold>B</bold> Example of n-grams found in both 9aa and 10aa peptides, coloured by the start position of the respective n-gram in the peptides. <bold>C</bold> Comparing amino acid embedding strategies. ROC-AUC values of a single dense classification prediction using different encoding strategies, including one-hot encoding (OHE), amino acid descriptors (aaDescriptors) and embeddings from protein transformer-based PLMs on pathogenic peptides (i) and self-antigens (ii). Each point represents the ROC-AUC value from one round of 10-fold cross-validations. <bold>D</bold> Comparing the performance of different deep learning architectures. ROC-AUC values comparing the performance of different machine learning and deep learning architectures using embeddings from 5 protein transformer-based PLMs for pathogenic (i) and self-peptides (ii). XGBOOST: an extreme gradient boosting. BiRNN: bidirectional recurrent neural network. BiLSTM: bidirectional Long short-term memory. 1DCNN: 1-dimensional convolutional neural network. 2DCNN: 2-dimensional CNN. Each point represents ROC-AUC value from one round of 10-fold cross-validations. <bold>E</bold> Schematic diagram of the model incorporating MHC binding and hydrophobicity. <bold>F</bold> Adding hallmarks of the immunogenicity. ROC curve comparing the performance of models after adding MHC binding rank score and/or hydrophobicity to peptide sequence-based 1D CNN model for pathogenic (i) and self-peptides (ii)</p></caption><graphic xlink:href="13073_2023_1225_Fig3_HTML" id="MO3"/></fig></p>
      <p id="Par85">Third, to address data limitation, we adopted transfer learning to encode peptides using amino acid properties derived from protein transformer-based pre-trained language models (PLMs). The protein transformer-based PLMs were trained using millions to billions of protein sequences and carry the most representative 1024 embeddings, which describe the physicochemical, structural or electrostatic properties of amino acids in protein space [<xref ref-type="bibr" rid="CR33">33</xref>]. The performance of classification models were compared when peptides were encoded by one-hot-encoding (OHE), amino acid descriptors and embeddings from five protein transformer-based PLMs (‘<xref rid="Sec4" ref-type="sec">Methods</xref>’). ProtT5-XL-UniRef showed the highest performance, with an average ROC-AUC of 0.72 for pathogenic (Fig. <xref rid="Fig3" ref-type="fig">3</xref>Ci) and 0.724 for self-antigen datasets (Fig. <xref rid="Fig3" ref-type="fig">3</xref>Cii).</p>
      <p id="Par86">Fourth, the capability of different machine learning and deep learning architectures to classify immunogenicity potential was assessed. The performances of XGBOOST, BiRNN, bidirectional long short-term memory (BiLSTM), 1D CNN, 2D CNN and transformer models were compared. Briefly, RNNs or LSTMs are popular sequential models efficient in addressing sequential text data [<xref ref-type="bibr" rid="CR72">72</xref>], whereas CNNs are suitable for scanning across text or images and detecting local patterns by using ‘kernels’. 1D CNNs have widely been used for text and 2Ds for image classifications [<xref ref-type="bibr" rid="CR73">73</xref>]. The 1D CNN model using ProtT5-XL-UniRef embeddings achieved the highest average ROC-AUC of 0.74 for pathogenic (Fig. <xref rid="Fig3" ref-type="fig">3</xref>Di) and 0.75 for self-antigens (Fig. <xref rid="Fig3" ref-type="fig">3</xref>Dii). We surmised that T-cell recognition motifs captured by the 1D CNN model have more predictive power than sequential relationship captured by the RNN-based models.</p>
      <p id="Par87">In addition to peptide sequences, we examined whether incorporating other hallmarks of immunogenicity, such as predicted MHC binding rank score [<xref ref-type="bibr" rid="CR12">12</xref>, <xref ref-type="bibr" rid="CR16">16</xref>] and hydrophobicity [<xref ref-type="bibr" rid="CR20">20</xref>], can further improve the performance. Particularly, given that the current model only takes contact positions into account, adding MHC binding rank would allow the model to accommodate peptide-MHC binding information. This strategy has several advantages. First, it feeds the binding information with a minimal HLA-associated bias, circumventing the need to balance the training data by HLAs. Second, the most accurate binding information from NetMHCpan prediction can be incorporated without having to re-train the model using a massive peptide-HLA binding data. By integrating MHC binding rank and hydrophobicity as fully connected layers (i.e. Multilayer perceptrons, MLPs) and optimising hyperparameters (Fig. <xref rid="Fig3" ref-type="fig">3</xref>E, ‘<xref rid="Sec4" ref-type="sec">Methods</xref>’), performance was improved to an average ROC-AUC of 0.76 for pathogenic (Fig. <xref rid="Fig3" ref-type="fig">3</xref>Fi) and 0.87 for self-antigens (Fig. <xref rid="Fig3" ref-type="fig">3</xref>Fii). It is worth noting that, in comparison to the pathogenic model, the number of self-epitopes is limited, and the additional MHC rank filter significantly reduced the training dataset. Therefore, we trained another self-antigen model with a relaxed threshold (MHC rank = 10 instead of 2) to account for as many self-epitopes as possible, resulting a training dataset of 12,521 peptides for accurate extraction of differential sequence patterns (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S5D).</p>
      <p id="Par88">Therefore, representing peptide sequences at contact positions by ProtT5-XL-UniRef amino acid embeddings, extracting T-cell recognition motifs by 1D CNN kernels, and adding MHC binding rank and hydrophobicity as MLPs could effectively achieve superior performance in classifying immunogenicity.</p>
    </sec>
    <sec id="Sec22">
      <title>Sequence patterns discriminating immunogenicity</title>
      <p id="Par89">Among different architectures, the 1D CNN model that captures local motifs achieved the best performance. Moreover, extensive screening of pMHC library against a single TCR revealed dominant hotspots or motifs in the cognate peptides [<xref ref-type="bibr" rid="CR74">74</xref>, <xref ref-type="bibr" rid="CR75">75</xref>]. We therefore set out to expand this observation and explore the enrichment of n-grams (i.e. contiguous sequence of n-amino acids) [<xref ref-type="bibr" rid="CR76">76</xref>] and position-specific k-mer motifs (i.e. contiguous or non-contiguous sequence of k amino acids at specific positions) in contact residues of pathogenic and self-peptides.</p>
      <p id="Par90">We first computed the ratio (in normalised frequency) of n-gram or positions-specific k-mer motifs between epitopes and non-epitopes (‘<xref rid="Sec4" ref-type="sec">Methods</xref>’). The top-ranking n-grams were GIG, GINA, GIF, LGIN, VEG and SGSP for pathogenic epitopes and SC, GIGI, IC, QC and CA for self-epitopes (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S6C). In addition, top position-specific k-mer motifs were.EG.L.,.E.IL. and.GIG… for pathogenic epitopes and GIG..,..M.P.,.G.GI.., and AGI…. for self-epitopes (Additional files <xref rid="MOESM4" ref-type="media">4</xref> and <xref rid="MOESM5" ref-type="media">5</xref>). Notably, GIG, which was previously associated with DMF5 TCR, was one of the top n-grams and position-specific k-mer motifs.</p>
      <p id="Par91">To identify sequence patterns enriched in both pathogenic and self-epitopes, we compared n-grams and position-specific k-mer motifs from each analysis. The 48 n-grams and total 298 position-specific k-mer motifs from 9 and 10aa peptides (Fig. <xref rid="Fig4" ref-type="fig">4</xref>A) were shared between pathogenic and self-epitopes. These include GIG, GINA, GMP, ALGI and APTG n-grams (Fig. <xref rid="Fig4" ref-type="fig">4</xref>B, Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S6D), and ….VP, W..P..,.G.GI.., and.GIG… position-specific k-mer motifs (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S6E-G).<fig id="Fig4"><label>Fig. 4</label><caption><p>Out-of-distribution detection using calibration methods. <bold>A</bold> Identifying motifs that are enriched in both pathogenic and self-epitopes. Venn diagram comparing the enriched n-grams (left) or position-specific k-mer motifs from 9aa (middle) or 10aa peptides (right) between pathogenic and self-peptides. <bold>B</bold> Normalised enrichment ratio of shared n-grams enriched in both pathogenic and self-epitopes. <bold>C</bold> Clusters of peptides with high sequence similarity in contact positions, demonstrated by pairwise global alignment scores. Network graph illustrating the pairwise global alignment score between 9aa pathogenic peptides. Shown are peptides having ≥ 22 alignment scores with ≥ 3 other peptides. <bold>D</bold>–<bold>G</bold> Distribution of different calibration-based metrics on pathogenic (i) and self-(ii) peptides, discriminating correctly vs. incorrectly predicted peptides. The calibration-based metrics include maximum softmax probability (MaxProb) (<bold>D</bold>), temperature scaling using different levels of temperatures that scale the logit values (<bold>E</bold>), the maximum on average softmax probability over 10 ensembled models (MaxProb on Avg) (<bold>F</bold>) and maximum on average softmax probability from Monte Carlo dropout iterations (<bold>G</bold>). The Monte Carlo models were reiterated 100 times with stochastic dropouts of 0.6. T: temperature. Statistical significance by <italic>p</italic>-values from Student’s <italic>t</italic> test. ns: non-significant. <bold>H</bold> Venn diagram comparing the pathogenic peptide predictions using different calibration metrics. MCDropout: Monte Carlo Dropout. I. ROC curve illustrating the performance of the out-of-distribution (OOD) linear regression classifiers using MCDropout on pathogenic (i) and self-peptides (ii)</p></caption><graphic xlink:href="13073_2023_1225_Fig4_HTML" id="MO4"/></fig></p>
      <p id="Par92">Furthermore, we computed pairwise global alignment scores across pathogenic peptides to identify clusters of epitopes sharing high sequence homology (‘<xref rid="Sec4" ref-type="sec">Methods</xref>’). Plotting highly similar peptides revealed clusters dominated by Positive peptides (Fig. <xref rid="Fig4" ref-type="fig">4</xref>C). These clusters contained peptides having patterns, such as YNTI… FG(Y/F)PV(F/Y). F(E/D)(K/R)S.., G.GW...DR.WC, GPG.R.P, P.DFFP.,.GIGI..,.DRGM., VALG.NA. and.LGLNA (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S5H-I).</p>
      <p id="Par93">Our analyses therefore suggest that TCR contact positions of immunogenic peptides exhibit preferences towards presenting certain motifs while disfavouring others. We also observed similarities and differences between pathogenic and self-peptides. The toolkits for analysing differential sequence patterns between peptides of the same length are developed as a R diffSeqPatterns package. We believe these shortlisted sequence patterns can be target for functional validations in identifying immune hotspots.</p>
    </sec>
    <sec id="Sec23">
      <title>Detect low-confidence predictions to improve robustness</title>
      <p id="Par94">While the DNN models could achieve higher accuracies than existing models, they are nonetheless far from making a perfect prediction. Partially due to the limited number of peptides characterised to fill the full combinatorial peptide space, the performance of sequence-based model drops substantially in predicting peptides non-homologous to those of training data, called the out-of-distribution (OOD) generalisation problem [<xref ref-type="bibr" rid="CR43">43</xref>]. In contexts where incorrect predictions can have severe consequences such as in healthcare or security, using model uncertainty to decide when to trust or abstain the prediction can facilitate rejecting false predictions and improving model accuracy.</p>
      <p id="Par95">There are generally two types of OODs: background shift (i.e. a shift in population-level features that do not depend on classification labels) and semantic shift (i.e. a shift in features that are correlated with the context and label) [<xref ref-type="bibr" rid="CR45">45</xref>]. In previous NLP studies, density or proximity-based models were found to be better at detecting background shifts, while calibration methods (i.e. using model’s prediction confidence) performed better at semantic shifts. In our study, the greatest OOD came from peptides originating from different species that have moderately different features associated with immunogenicity (i.e. semantic features). This aligns with previous findings that the majority of OOD stems from the semantic shift and thus calibration methods generally outperform proximity-based methods (i.e. autoencoder reconstruction) [<xref ref-type="bibr" rid="CR45">45</xref>].</p>
      <p id="Par96">Here, several OOD detection methods were tested to detect low-confidence predictions. Different autoencoder architectures, which are often used for anomaly detection, were first investigated [<xref ref-type="bibr" rid="CR61">61</xref>] (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S7A-F, ‘<xref rid="Sec4" ref-type="sec">Methods</xref>’). However, we observed no significant difference in reconstruction loss between correctly and incorrectly predicted peptides, implying that the autoencoder-based methods cannot effectively identify OOD inputs.</p>
      <p id="Par97">Therefore, calibration methods such as maximum softmax probability (MaxProb), temperature scaling, MaxProb from averaged softmax probability from ensemble of 10 models (called Ensemble) and MaxProb from averaged softmax probability from 100 Monte Carlo dropouts (called MCDropout) were tested, because they were reported to effectively detect semantic shifts (‘<xref rid="Sec4" ref-type="sec">Methods</xref>’). We observed that all four methods could significantly differentiate correct vs. incorrect predictions for both pathogenic and self-antigens (Fig. <xref rid="Fig4" ref-type="fig">4</xref>D–G). We also observed that these metrics produce similar profile of correctly and incorrectly predicted peptides (Fig. <xref rid="Fig4" ref-type="fig">4</xref>H, Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S7H). Therefore, we trained a linear regression model on MCDropout, which proved to be the most robust on cross-species dataset (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S7G, Method). The linear regression models could achieve average ROC-AUC of 0.65 for pathogenic and 0.82 for self-antigens (F <xref rid="Fig4" ref-type="fig">i</xref>g. <xref rid="Fig4" ref-type="fig">4</xref>I). With these, a MCDropout-based OOD detection module was introduced downstream of 1D CNN model prediction to report peptides that are likely to have a correct prediction.</p>
    </sec>
    <sec id="Sec24">
      <title>Relative Similarity to Autoantigens or Tumour-associated antigens (RSAT) as a novel feature of pathogenic peptide immunogenicity</title>
      <p id="Par98">We and others [<xref ref-type="bibr" rid="CR23">23</xref>, <xref ref-type="bibr" rid="CR77">77</xref>] have shown that some of the highly predictive metrics found from cancer neoepitope studies, such as ‘dissimilarity to self’, may not be applicable to pathogenic peptides. To address this, we present an alternative solution, termed a relative similarity to autoantigens or tumour-associated antigens (RSAT), to estimate the immunogenicity potential of pathogenic peptides. For pathogenic peptides that suffer from low-confidence prediction, RSAT can provide an additional estimate of immunogenicity potential.</p>
      <p id="Par99">The ‘dissimilarity to self’ stems from the paradigm of negative selection where T-cells that bind strongly to self-peptides should have been negatively selected and thus no T-cell repertoire should be present to bind peptides homologous to self-proteome [<xref ref-type="bibr" rid="CR21">21</xref>, <xref ref-type="bibr" rid="CR22">22</xref>] (Fig. <xref rid="Fig5" ref-type="fig">5</xref>A). However, there is another side of the story where T-cells that have low or moderate binding to self-peptides should have been positively selected. In fact, recent studies attributed the inability of the immune system to recognise a large number of pathogenic peptides—most of which are highly dissimilar to human proteome—to the mechanism of positive selection where only T-cells bound by low or moderately binding self-peptides survive to trigger an immune response [<xref ref-type="bibr" rid="CR77">77</xref>]. Therefore, we hypothesised that pathogenic peptides homologous to immunogenic self-peptides, such as autoantigens or tumour-associated antigens, may be more likely to trigger an immune response, and assessed whether relative similarity to autoantigens or tumour-associated antigens compared to reference human proteome can be a predictor of immunogenicity for pathogenic peptides.<fig id="Fig5"><label>Fig. 5</label><caption><p>Relative similarity to autoantigens and tumour-associated antigens (RSAT). <bold>A</bold> Schematic of positive and negative selection of T-cells in thymus. <bold>B</bold> Number of self-peptides, such as cancer neoepitopes, autoantigens and tumour-associated antigens, retrieved from different databases. <bold>C</bold> Distribution of Match score between pathogenic peptides and best self-peptide counterparts. Contains the Cohen’s <italic>d</italic> value showing the effect sizes differentiating positives versus negatives as well as the number of positive and negative peptides in each species. Cohen’s <italic>d</italic> values describe effective sizes, which are small (<italic>d</italic> = 0.2), medium (<italic>d</italic> = 0.5) and large (0.8). <bold>D</bold> RSAT of pathogenic peptides that have comparable self-antigen counterparts (by match score ≥ 0.6). <bold>E</bold>, <bold>F</bold> RSAT can effectively discriminate pathogenic epitopes from non-epitopes of varying lengths and species. <bold>E</bold> Distribution of RSAT for pathogenic peptides having 9aa (left) and 10aa (right) in length. <bold>F</bold> RSAT of peptides derived from different pathogens</p></caption><graphic xlink:href="13073_2023_1225_Fig5_HTML" id="MO5"/></fig></p>
      <p id="Par100">To test our hypothesis, 5023 unique Autoimmunity, Allergy or Tumour-associated antigens (AATs) were retrieved from NEPdb [<xref ref-type="bibr" rid="CR52">52</xref>], dbPepNeo [<xref ref-type="bibr" rid="CR50">50</xref>], McPAS-TCR [<xref ref-type="bibr" rid="CR51">51</xref>], IEDB [<xref ref-type="bibr" rid="CR49">49</xref>] and cancer antigenic peptide database (<ext-link ext-link-type="uri" xlink:href="https://caped.icp.ucl.ac.be">https://caped.icp.ucl.ac.be</ext-link>) (Fig. <xref rid="Fig5" ref-type="fig">5</xref>B). We then computed the similarity between pathogenic peptides and AATs, and only retained pathogenic peptides having comparable AAT counterparts (‘<xref rid="Sec4" ref-type="sec">Methods</xref>’). On these pathogenic peptides, we then computed the similarity between pathogenic peptide and AAT’s closest human proteome counterparts, and the ratio between the two, i.e. <italic>r</italic>elative <italic>s</italic>imilarity of the pathogenic peptide to <italic>a</italic>utoantigens or <italic>t</italic>umour-associated antigens (named RSAT).</p>
      <p id="Par101">From pathogenic data, 346/3793 pathogenic epitopes and 295/6080 non-epitopes had comparable AAT counterparts by a threshold match score of 0.6 (Method, Fig. <xref rid="Fig5" ref-type="fig">5</xref>C). The RSAT was computed on these peptides and found a significant difference between epitopes vs. non-epitopes (Fig. <xref rid="Fig5" ref-type="fig">5</xref>D) across peptide lengths 9 and 10aa (Fig. <xref rid="Fig5" ref-type="fig">5</xref>E), and across different pathogenic species (Fig. <xref rid="Fig5" ref-type="fig">5</xref>F), indicating that RSAT could effectively classify peptides of varying lengths and pathogen species. Despite the fact that each species had a limited number of peptides, epitopes had higher RSAT values with low (SARS-CoV-2 and <italic>M. tuberculosis</italic>), medium (EBV) or high (HCV and vaccinia virus) effect sizes.</p>
      <p id="Par102">Here, we developed a novel metric, RSAT, to estimate the immune potential of pathogenic peptides based on relative similarity to known auto- or tumour-associated epitopes. We demonstrated that RSAT can effectively discriminate epitopes of different lengths and pathogens. The RSAT is available as a separate module in the TRAP GitHub repository and is recommended to be used in conjunction with TRAP when the pathogenic peptides have low prediction confidence. We appreciate that the low number of Autoimmunity, Allergy or Tumour-associated antigens (AATs) limits the use of RSAT on a broader range of peptides. However, we envision that as data becomes more abundant, RSAT can become more popular.</p>
    </sec>
    <sec id="Sec25">
      <title>Benchmark TRAP performance to state-of-the-art algorithms</title>
      <p id="Par103">The performance of TRAP was benchmarked against existing immunogenicity models, namely NetTepi, IEDB, PRIME, DeepImmuno and TESLA by 10-fold cross-validation on the same datasets (‘<xref rid="Sec4" ref-type="sec">Methods</xref>’). Due to the nature of the existing models, HLA-agnostic predictions were performed for IEDB, iPred, NetTepi PRIME and Repitope, and HLA-restrictive prediction for DeepImmuno. TRAP was able to make both HLA-agnostic and restrictive predictions by incorporating the peptide sequence at contact positions and MHC as a rank score. The HLA-restrictive prediction was made using HLA-balanced data where the number of epitopes and non-epitopes were balanced per HLA to validate their prediction irrespective of HLA-associated bias.</p>
      <p id="Par104">TRAP was the best self-antigen model, achieving ROC-AUC of 0.931 for HLA-agnostic and 0.703 for HLA-restrictive predictions (Fig. <xref rid="Fig6" ref-type="fig">6</xref>A, Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S8A). It was also one of the best pathogenic models, with ROC-AUC of 0.751 for HLA-agnostic and 0.709 for HLA-restrictive predictions (Fig. <xref rid="Fig6" ref-type="fig">6</xref>B, Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S8B).<fig id="Fig6"><label>Fig. 6</label><caption><p>Benchmark TRAP performance and use it to identify tumour antigens in glioblastoma. <bold>A</bold>, <bold>B</bold> ROC curve comparing the performance of TRAP with existing models, such as IEDB, iPred, NetTepi, PRIME, Repitope and DeepImmuno for self- (<bold>A</bold>) and pathogenic peptides (<bold>B</bold>). Due to the nature of these models, IEDB, iPred, NetTepi PRIME and Repitope were predicted in an HLA-agnostic manner (i.e. by peptide sequence only) (i), and DeepImmuno predicted in an HLA-restrictive manner (i.e. by peptide-HLA) using HLA-balanced data (ii). <bold>C</bold> ROC curve comparing the performance of TRAP and Repitope that have been trained using 1511 Non-Wuhan SARS-CoV-2 peptides by 10-fold cross-validations. <bold>D</bold> ROC curve comparing the performance of Non-Wuhan SARS-CoV-2 trained TRAP and Repitope models in predicting 66 Wuhan SARS-CoV-2 peptides. <bold>E</bold>–<bold>J</bold> Application of TRAP in identifying glioblastoma neoepitopes. <bold>E</bold> Confusion matrix of GBM cancer neoepitope prediction using self-antigen TRAP model in reference to T-cell assay readout. <bold>F</bold> ROC curve of TRAP performance on GBM dataset. <bold>G</bold> Distribution of MCDropout values for GBM peptides predicted to be non-immunogenic. <bold>H</bold> The proportion of GBM epitopes (Positive) and non-epitopes (Negatives) predicted Positive or Negative with high or low confidence based on MCDropout. The confidence has been determined by the self-antigen out-of-distribution linear regression classifier at threshold 0.76. I. ROC curve of TRAP performance taking confidence into account, in which peptides that were predicted Negative with low confidence were removed to be considered as the potential epitope candidates. <bold>J</bold> Confusion matrix of TRAP prediction after taking the confidence into account, in which peptides that were predicted Negative with low confidence were included as Positive</p></caption><graphic xlink:href="13073_2023_1225_Fig6_HTML" id="MO6"/></fig></p>
      <p id="Par105">While Repitope slightly outperformed TRAP in pathogenic datasets, the robustness of TRAP predictions was assessed on emerging pathogens. The coronavirus TRAP and Repitope models were trained using 1511 coronavirus peptides except Wuhan SARS-CoV-2 peptides (Fig. <xref rid="Fig6" ref-type="fig">6</xref>C), and then used to predict the immunogenicity of 66 Wuhan SARS-CoV-2 peptides (Fig. <xref rid="Fig6" ref-type="fig">6</xref>D). Given that they are derived from the same family, the coronavirus peptides in the training dataset would share high homology with those in the test dataset, and we aimed to demonstrate the model’s ability to make accurate predictions on homologous peptides in comparison to other models. We found that TRAP was better at extracting immunogenicity-related features from limited data of emerging pathogens, and translating them onto related species (Fig. <xref rid="Fig6" ref-type="fig">6</xref>D).</p>
      <p id="Par106">Therefore, TRAP can predict CD8 + T-cell epitopes in both HLA-agnostic and restrictive contexts, and performed better in both. The TRAP can also make accurate predictions about emerging pathogens and is suitable for shortlisting therapeutic candidates when data is limited.</p>
    </sec>
    <sec id="Sec26">
      <title>Application of TRAP to identify glioblastoma neoantigens</title>
      <p id="Par107">Here, we demonstrate how the TRAP can be used for identifying cancer neoepitopes from glioblastoma patients. We previously sequenced the tumours of four HLA-A2 glioblastoma patients and shortlisted the cancer neoepitopes by using an in-house version of MuPeXI [<xref ref-type="bibr" rid="CR65">65</xref>] codenamed TUNAPASTA v0.5. This method ranked peptides by the immunogenicity potential, taking into account NetMHCpan affinity, gene expression level, and mutant allele frequency. We then selected 153 predicted epitopes for functional validation, of which 33 were characterised positive by T-cell assay [<xref ref-type="bibr" rid="CR64">64</xref>]. With only a small proportion of the shortlisted candidates found to be positive, the other existing models showed comparable levels of performance, PR-AUC ranging from 0.201 to 0.437 in our benchmarking study [<xref ref-type="bibr" rid="CR7">7</xref>].</p>
      <p id="Par108">Of the 153 tested peptides, we filtered out predicted HLA-A*02:01 non-binders and retained 9–10 amino acids peptides that were applicable to TRAP. This left 124 GBM peptides, of which 25 were characterised to be immunogenic and 99 non-immunogenic by T-cell assays. Of these, TRAP predicted 9/25 epitopes to be Positives and 84/99 non-epitopes to be Negatives (Fig. <xref rid="Fig6" ref-type="fig">6</xref>E), yielding 0.75 accuracy with ROC-AUC of 0.684 (Fig. <xref rid="Fig6" ref-type="fig">6</xref>F).</p>
      <p id="Par109">Identifying cancer neoepitopes is typically regarded as a ‘needle in a haystack’ problem in which an extremely small number of positives are sought from vastly imbalanced data. In this scenario, minimising the loss of true Positives from the candidate list was regarded to be more important than maximising accuracy. Therefore, we examined the confidence of predictions using the out-of-distribution detection module (Fig. <xref rid="Fig6" ref-type="fig">6</xref>G) and found that many incorrectly predicted Negatives had low-confidence predictions (Fig. <xref rid="Fig6" ref-type="fig">6</xref>H). By adding them to the candidate list, 28 more glioblastoma antigens were predicted positive, yielding 16/25 epitopes (Fig. <xref rid="Fig6" ref-type="fig">6</xref>I) and ROC-AUC of 0.734 (Fig. <xref rid="Fig6" ref-type="fig">6</xref>J).</p>
      <p id="Par110">Here, we applied TRAP for shortlisting glioblastoma cancer neoepitopes and showed that TRAP not only outperforms existing algorithms but also allow optimising candidates to minimise loss of likely epitopes.</p>
    </sec>
  </sec>
  <sec id="Sec27">
    <title>Discussion</title>
    <p id="Par111">In this study, we present TRAP, a robust deep learning workflow for predicting CD8 + T-cell epitopes from MHC-I presented pathogenic and self-peptides. To address the current limitations, we used peptide sequences only at contact positions to avoid HLA bias caused by capturing dominant HLA binding features at anchor positions. Second, we built separate models for pathogenic and self-peptides to address the out-of-distribution generalisation problem. Third, to overcome data limitations, we encoded peptide sequences using amino acid properties derived from protein transformer-based pre-trained language models (PLMs). This enabled more information about the physicochemical, electrostatic or biophysical properties of amino acids to be fed into the system. Fourth, we captured T-cell recognition motifs using a one-dimensional convolutional neural network (1D CNN) architecture. Fifth, we added the MHC binding rank score predicted by the most accurate algorithm (NetMHCpan) to provide the information about MHC binding. Lastly, we devised an out-of-distribution detection module to abstain from low-confidence predictions for peptides that are very different from those in the training dataset. By taking these novel approaches, TRAP offers a more robust prediction compared to other machine learning algorithms.</p>
    <p id="Par112">Another metric proposed to estimate immunogenicity from cancer neoepitope studies was dissimilarity to self. However, the dissimilarity to self could not be applied to pathogenic peptides because pathogens have highly heterologous sequences compared to the human proteome. Therefore, a novel metric termed RSAT (relative similarity to autoantigens or tumour-associated antigens) was developed to estimate the immunogenicity of peptides from emerging pathogens. To compensate for the high dissimilarity between pathogenic and human proteomes, this metric compares the similarity of pathogenic peptides to the reference human proteome (‘healthy’) with respect to ‘immunogenic’ self-peptides such as autoantigens or tumour-associated antigens. This allowed the identification of pathogenic epitopes despite their sequence dissimilarity to the human proteome.</p>
    <p id="Par113">The application of TRAP was demonstrated by using it to identify cancer neoepitopes from glioblastoma patients. We showed that the out-of-distribution detection module is well-suited for the ‘needle in a haystack’ problem by identifying those predicted negative with low confidence. In another study, we used TRAP to investigate the immune escape potential of SARS-CoV-2 variants [<xref ref-type="bibr" rid="CR78">78</xref>]. By combining TRAP with in silico mutagenesis, we evaluated the extent to which all possible theoretical single point mutations can give rise to variants of concern and be detrimental to T-cell immunity. Based on the groundwork of this work, using models like TRAP to systematically evaluate the impact of mutations on the emergence of deleterious pathogens will be of great interest. Emerging pathogens have posed a significant threat in recent years, and new variants and pathogens are expected to rise in the coming years [<xref ref-type="bibr" rid="CR79">79</xref>]. It is therefore critical to surveil variants of concern and assess the immune escape potential of these variants. Furthermore, in order to accurately determine deleterious variants, it is essential to assess the extent to which models trained by other pathogens can be generalised and thus used for emerging pathogens. Thus, an iterative process of refining the training data, model architecture and validating predictions should be followed to mitigate the impact of another pandemic.</p>
    <p id="Par114">For the self-antigen model, the autoantigens, tumour-associated antigens and cancer neoepitopes were collected as epitopes, and benign HLA-I ligands expressed in thymus as non-epitopes. We assumed that HLA-I ligands expressed in the thymus are involved in the selection of T-cells, and thus there is either no repertoire recognising these peptides or have weak interaction with the peptides. Notably, our novel approach of incorporating the HLA-I ligands allowed for a clearer separation of self-epitopes versus non-epitopes. When the data is limited, biological knowledge, such as thymic selection, can serve as a useful resource to bridge the data gap, and aid in the development of a more accurate classifier.</p>
    <p id="Par115">In benchmarking TRAP performance, we found that although Repitope performed well on pathogenic data, it was limited in extracting immunogenicity-related features from limited data and transferring them onto related species, resulting in poor performance on emerging pathogens. Our previous analysis revealed that Repitope was one of the models with skewed prediction for prevalent HLAs, with HLA-A*02:01-bound peptides having a higher immunogenicity score than non-HLA-A*02:01 bound peptides [<xref ref-type="bibr" rid="CR7">7</xref>]. This suggested that the model considered A02:01 binding as a superior feature to the T-cell recognition potential, skewing the prediction. While TRAP performed slightly lower on the pathogenic dataset, the HLA-generalised approach of TRAP mitigates the possibility of HLA bias. Therefore, end users should choose which model to pursue based on the peptides and HLA alleles of interest.</p>
    <p id="Par116">While these approaches improved the accuracy and robustness of the prediction, there still remains limitations. First, while the calibration methods could effectively detect incorrect prediction in a 10-fold cross-validation, they failed on the cross-species dataset (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S7G-H). We surmised this is because of ‘spurious semantic features’ (i.e. features that have discriminative power in training data but not in test data) that were driving overly confident incorrect predictions. In a recent case study, Arora et al. benchmarked calibration methods on real-world challenge data and reported that models were over-confident on the OOD examples because of spurious semantic features and often produced accuracies close to random [<xref ref-type="bibr" rid="CR45">45</xref>]. With spurious semantic shift being one of the remaining challenges in NLP, further advances in deep learning and NLP will also facilitate improving the robustness of predictions on complex biological data.</p>
    <p id="Par117">Second, following our workflow, peptides may be abstained due to low-confidence predictions. For cancer peptides, TESLA [<xref ref-type="bibr" rid="CR8">8</xref>] that incorporates generic features for neoepitope prediction could be an alternative solution. Pathogenic peptides having low-confidence predictions can be directed to RSAT to estimate the immunogenicity potential with respect to self-epitopes. However, because RSAT is only applicable to peptides with self-epitope counterparts, it has limited coverage with 346/3792 (9.1%) pathogenic epitopes currently having counterparts. Further characterisation of self-epitopes will expand RSAT coverage to embrace a broader range of pathogenic peptides.</p>
    <p id="Par118">Third, TRAP takes an HLA-generalised approach to avoid HLA bias, as the current dataset contains little intra-HLA variation in peptide immunogenicity. However, characterising peptide immunogenicity on a broader range of HLAs may provide insight into the effect of HLA on overall immunogenicity. Moreover, because the specific interaction between peptide and T-cell receptor is MHC-restricted [<xref ref-type="bibr" rid="CR80">80</xref>, <xref ref-type="bibr" rid="CR81">81</xref>], MHC-focused studies would be required to model specific TCR:pMHC recognition.</p>
    <p id="Par119">Fourth, T-cell recognition depends not only on peptide-MHC complex, but also on multiple other factors, such as cytokine microenvironment, co-stimulatory molecules in vivo and availability of TCR repertoires that are often highly stochastic and individualised [<xref ref-type="bibr" rid="CR82">82</xref>], adding complexity to T-cell activation and function [<xref ref-type="bibr" rid="CR83">83</xref>]. While there are almost no record of these determinants [<xref ref-type="bibr" rid="CR84">84</xref>], studies highlighting the influence of microenvironment on T-cell response will be pivotal to recapitulating T-cell function for therapeutic applications.</p>
    <p id="Par120">In TRAP, we incorporated peptide sequence at the contact position to gauge on T-cell recognition motifs. However, some studies showed that position 1 (P1) of 9-mer peptide may play an important role in T-cell binding, as demonstrated by P1, 3, 4, 5, 9 being critical for MAGE A3 binding by a3a-engineered T-cells [<xref ref-type="bibr" rid="CR85">85</xref>]. Although it is difficult to deconvolute the roles of different positions in MHC and T-cell binding, more studies may shed light on the role of P1.</p>
    <p id="Par121">Fifth, due to the lack of true Negative self-antigens, we retrieved benign HLA-I ligands expressed in thymus for their relevance to central tolerance. While there have been studies describing Tregs reacting to self-peptides present in the thymus [<xref ref-type="bibr" rid="CR86">86</xref>, <xref ref-type="bibr" rid="CR87">87</xref>], given that the models are targeted for CD8 + T-cells, we reasoned that majority of peptides presented by HLA class I in the thymus will be non-immunogenic. However, we acknowledge that concept of thymic selection is still evolving and that not all peptides expressed in the thymus may be involved in selection [<xref ref-type="bibr" rid="CR88">88</xref>]. On that note, some studies have shown that cTECs may generate and display distinct private self-peptides that may support the selection of T-cells with low self-reactivity in the periphery [<xref ref-type="bibr" rid="CR89">89</xref>, <xref ref-type="bibr" rid="CR90">90</xref>]. While experimental data linking the selection of ‘low self-affinity’ TCR with cTEC-displayed private peptides is still lacking, future studies characterising HLA-I ligand expressed in medulla thymic epithelial cells (mTEC) will improve confidence as ‘non-immunogenic self-antigens’.</p>
    <p id="Par122">Sixth, it will be valuable to extend the work of peptide immunogenicity to investigate the ability of peptides to be recognised by specific T-cells. Here, the peptide immunogenicity was investigated at the organismal level, i.e. whether the peptide can elicit a response from <italic>any</italic> T-cell. The limitation was largely due to the limited pool of available peptides characterised for their cognate TCRs; however, advances in screening methods will lead to availability of more comprehensive datasets in the future, thus enabling the development of more tailored immunogenicity models. It is becoming apparent that predicting specific interactions between TCR and cognate pMHCs is crucial for developing personalised therapies and tailoring vaccines or treatments to individuals’ TCR repertoire. Therefore, screening antigen-specific TCR against a larger pool of epitopes from various origins and pathologies will greatly aid in learning peptide features that allow interaction with specific TCRs.</p>
    <p id="Par123">In addition, the immunogenicity of an epitope can be altered by the presence of other epitopes, as demonstrated by immunodominance effects, in which a hierarchy exists in the magnitude of the immune response that epitopes can elicit [<xref ref-type="bibr" rid="CR91">91</xref>–<xref ref-type="bibr" rid="CR94">94</xref>]. Several factors may influence immunodominance, including competition for MHC, presentation levels, TCR affinity, timing of CTL clonal expansions, individual’s TCR diversity and/or strength of T-cell response [<xref ref-type="bibr" rid="CR95">95</xref>–<xref ref-type="bibr" rid="CR97">97</xref>]. The immunogenicity algorithms are designed to predict the peptide immunogenicity once the peptides are bound on HLA molecules. We used MHC rank as one of the parameter to describe binding affinity and relative MHC presentation levels. But, even if the peptides are stably presented, immunodominance may vary depending on an individual’s TCR diversity, T-cell affinity and/or strength of T-cell response. Therefore, while the model may serve as a useful tool to shortlist peptides for testing, additional experiments will be required to characterise their immunogenicity in presence of other epitopes. Future studies into the impact of other epitopes will aid in understanding the dynamics of immune response in the presence of multiple epitopes and foster the development of more accurate models.</p>
    <p id="Par124">Lastly, the current breadth of peptides characterised by T-cell assays is far from filling the full combinatorial peptide space, especially for CD4 + T-cell targets. Also, while this model is limited to peptide-specific binding of CD8 + T-cells, other T-cells are specific for lipid or small molecules like metabolites. As such, high-throughput screening of immune targets and antigen-specific TCRs by the help of recent technological advancement will greatly foster the process of model development.</p>
    <p id="Par125">Despite current data and model constraints, the novel computational strategies allowed TRAP to outperform existing models in predicting CD8 + T-cell epitopes and provide more robust, accurate and biologically meaningful candidates for functional validations. We believe that this workflow will foster a better understanding of TCR:pMHC interaction and aid in basic, clinical and translational research for a wide range of therapeutic applications.</p>
  </sec>
  <sec id="Sec28">
    <title>Conclusions</title>
    <p id="Par126">In summary, our study introduces TRAP, a robust deep learning framework designed to predict CD8 + T-cell epitopes from MHC-I presented pathogenic and self-peptides. Overcoming existing limitation, TRAP incorporates novel strategies to enhance predictive accuracy and confidence. Moreover, the novel metric, RSAT, addresses the challenge of immunogenicity estimation for emerging pathogens by comparing pathogenic peptides to immunogenic self-peptides. The demonstrated applications of TRAP in identifying cancer neoepitopes and assessing immune escape potential of SARS-CoV-2 variants underscored its practicality. In the face of ongoing threat posed by emerging pathogens and variants, TRAP’s ability to systematically assess the impact of mutations would be invaluable. Our study showcases the TRAP’s capacity to contribute to immunogenicity prediction, variant surveillance and neoepitope identification guided by both computational methodologies and biological understanding. Altogether, we envision models like TRAP, designed for the accurate identification of T-cell targets, will be instrumental in decoding the fundamental principles of T-cell recognition of antigens in time and space.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <sec id="Sec29">
      <title>Supplementary Information</title>
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="13073_2023_1225_MOESM1_ESM.pdf">
            <caption>
              <p><bold>Additional file 1: Fig. S1.</bold> Screnshot of TRAP web application. <bold>Fig. S2.</bold> Cross-species variation and HLA-bias. <bold>Fig. S3.</bold> Effect of anchor and contact positions on peptide immunogenicity. <bold>Fig. S4.</bold> Intra vs. Inter-HLA variability. <bold>Fig. S5.</bold> Pathogenic and self-antigen datasets. <bold>Fig. S6.</bold> Sequence patterns discriminating epitopes versus non-epitopes. <bold>Fig. S7.</bold> Out-of-distribution detection. <bold>Fig. S8.</bold> Benchmark TRAP performance.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM2">
          <media xlink:href="13073_2023_1225_MOESM2_ESM.pdf">
            <caption>
              <p><bold>Additional file 2.</bold> Includes step-by-step tutorial to TRAP web application.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM3">
          <media xlink:href="13073_2023_1225_MOESM3_ESM.xlsx">
            <caption>
              <p><bold>Additional file 3: Table S1.</bold> Pathogenic dataset. <bold>Table S2.</bold> Self-antigen dataset. <bold>Table S3.</bold> Pathogenic TRAP model hyperparameter optimisation. <bold>Table S4.</bold> Self-antigen TRAP model hyperparameter optimisation. <bold>Table S5.</bold> Pathogenic out-of-distribution model calibration metrics. <bold>Table S6.</bold> Self-antigen out-of-distribution model calibration metrics. <bold>Table S7.</bold> GBM predictions on self-antigen model.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM4">
          <media xlink:href="13073_2023_1225_MOESM4_ESM.xlsx">
            <caption>
              <p><bold>Additional file 4.</bold> Differential sequence patterns between pathogenic epitopes and non-epitopes.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM5">
          <media xlink:href="13073_2023_1225_MOESM5_ESM.xlsx">
            <caption>
              <p><bold>Additional file 5.</bold> Differential sequence patterns between self-epitopes and non-epitopes</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <glossary>
    <title>Abbreviations</title>
    <def-list>
      <def-item>
        <term>AAT</term>
        <def>
          <p id="Par5">Autoimmunity, allergy or tumour-associated antigens</p>
        </def>
      </def-item>
      <def-item>
        <term>ANOVA</term>
        <def>
          <p id="Par6">Analysis of variance</p>
        </def>
      </def-item>
      <def-item>
        <term>AUC</term>
        <def>
          <p id="Par7">Area under the ROC curve</p>
        </def>
      </def-item>
      <def-item>
        <term>BERT</term>
        <def>
          <p id="Par8">Bidirectional encoder representations from transformers</p>
        </def>
      </def-item>
      <def-item>
        <term>BL</term>
        <def>
          <p id="Par9">BLOSUM</p>
        </def>
      </def-item>
      <def-item>
        <term>BLOSUM</term>
        <def>
          <p id="Par10">Blocks of amino acid substitution matrix</p>
        </def>
      </def-item>
      <def-item>
        <term>CNN</term>
        <def>
          <p id="Par11">Convolutional neural network</p>
        </def>
      </def-item>
      <def-item>
        <term>CTL</term>
        <def>
          <p id="Par12">Cytotoxic T lymphocyte</p>
        </def>
      </def-item>
      <def-item>
        <term>DNN</term>
        <def>
          <p id="Par13">Deep neural network</p>
        </def>
      </def-item>
      <def-item>
        <term>EBV</term>
        <def>
          <p id="Par14">Epstein–Barr virus</p>
        </def>
      </def-item>
      <def-item>
        <term>GBM</term>
        <def>
          <p id="Par15">Glioblastoma</p>
        </def>
      </def-item>
      <def-item>
        <term>HCV</term>
        <def>
          <p id="Par16">Hepatitis C virus</p>
        </def>
      </def-item>
      <def-item>
        <term>HLA</term>
        <def>
          <p id="Par17">Human leukocyte antigens</p>
        </def>
      </def-item>
      <def-item>
        <term>IEDB</term>
        <def>
          <p id="Par18">Immune Epitope Database</p>
        </def>
      </def-item>
      <def-item>
        <term>LSTM</term>
        <def>
          <p id="Par19">Long short-term memory</p>
        </def>
      </def-item>
      <def-item>
        <term>MAGE</term>
        <def>
          <p id="Par20">Melanoma-associated antigen family</p>
        </def>
      </def-item>
      <def-item>
        <term>MHC</term>
        <def>
          <p id="Par21">Major histocompatibility complex</p>
        </def>
      </def-item>
      <def-item>
        <term>MLP</term>
        <def>
          <p id="Par22">Multilayer perceptron</p>
        </def>
      </def-item>
      <def-item>
        <term>NLI</term>
        <def>
          <p id="Par23">Natural Language Inference</p>
        </def>
      </def-item>
      <def-item>
        <term>NLP</term>
        <def>
          <p id="Par24">Natural Language Processing</p>
        </def>
      </def-item>
      <def-item>
        <term>OHE</term>
        <def>
          <p id="Par25">One-hot encoding</p>
        </def>
      </def-item>
      <def-item>
        <term>OOD</term>
        <def>
          <p id="Par26">Out-of-distribution</p>
        </def>
      </def-item>
      <def-item>
        <term>PLM</term>
        <def>
          <p id="Par27">Protein language model</p>
        </def>
      </def-item>
      <def-item>
        <term>PR</term>
        <def>
          <p id="Par28">Precision-recall</p>
        </def>
      </def-item>
      <def-item>
        <term>RMSE</term>
        <def>
          <p id="Par29">Root-mean-square deviation</p>
        </def>
      </def-item>
      <def-item>
        <term>RNN</term>
        <def>
          <p id="Par30">Recurrent neural network</p>
        </def>
      </def-item>
      <def-item>
        <term>ROC</term>
        <def>
          <p id="Par31">Receiver operating characteristic</p>
        </def>
      </def-item>
      <def-item>
        <term>RSAT</term>
        <def>
          <p id="Par32">Relative similarity to autoantigens and tumour-associated antigens</p>
        </def>
      </def-item>
      <def-item>
        <term>SARS-CoV</term>
        <def>
          <p id="Par33">Severe acute respiratory syndrome coronavirus</p>
        </def>
      </def-item>
      <def-item>
        <term>TCR</term>
        <def>
          <p id="Par34">T-cell receptor</p>
        </def>
      </def-item>
      <def-item>
        <term>TRAP</term>
        <def>
          <p id="Par35">T-cell recognition potential of HLA-I presented peptides</p>
        </def>
      </def-item>
      <def-item>
        <term>VACV</term>
        <def>
          <p id="Par36">Vaccinia virus</p>
        </def>
      </def-item>
      <def-item>
        <term>XGBOOST</term>
        <def>
          <p id="Par37">Extreme gradient boosting</p>
        </def>
      </def-item>
    </def-list>
  </glossary>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher’s Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <ack>
    <title>Acknowledgements</title>
    <p>HK was funded for this project by the MRC Human Immunology core funding MC_UU_00008. CL was funded by the UK National Institute of Health (NIHR).</p>
    <p>AS is funded by the Wellcome Investigating Award (219523/Z/19/Z), the UK MRC, NIHR and awards from Bristol-Myers Squibb and UCB.</p>
    <p>We thank all members of Koohy and Simmons Lab for insightful discussions. We thank MRC WIMM Centre for Computational Biology for the technical support.</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Authors’ contributions</title>
    <p>CL and HK conceived the study. CL designed and conducted all computational analysis with inputs from AA, JH, MJ, PB, MP, RF, AS and HK. CL developed deep learning model with inputs from JH and MJ. PB and CL conducted benchmarking. CL and MJ developed and deployed the web application. CL wrote the manuscript. JH, PB, MJ, MP, RF, AA, AS and HK commented and edited the manuscript. AS and HK supervised the study. All authors read and approved the final manuscript.</p>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>This work has been supported by Medical Research Council. HK is funded by MRC Human Immunology Unit core funding. CL is funded by UK National Institute for Health and Care Research (NIHR). AS is funded by a Wellcome Investigator Award (219523/Z/19/Z), the UK Medical Research Council, an NIHR Senior Investigator Award, awards from Bristol-Myers Squibb and UCB. The views expressed are those of the author(s) and not necessarily those of the NHS, the NIHR, or the Department of Health, UK.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and materials</title>
    <p>The web application is available at <ext-link ext-link-type="uri" xlink:href="https://github.com/ChloeHJ/TRAP">https://github.com/ChloeHJ/TRAP</ext-link> [<xref ref-type="bibr" rid="CR66">66</xref>]. The data, pre-trained models and notebooks are deposited in Google Drive repository [<xref ref-type="bibr" rid="CR98">98</xref>]. The ‘Tutorial for TRAP web application’ document in GitHub [<xref ref-type="bibr" rid="CR66">66</xref>] contains a detailed tutorial on how to use the web application and ‘Workflow: GBM on self-antigen model’ notebook in Google drive [<xref ref-type="bibr" rid="CR98">98</xref>] contains step-by-step workflow for using TRAP model on an example GBM dataset in python interface. The scripts for differential sequence analysis is deposited in GitHub repository [<xref ref-type="bibr" rid="CR60">60</xref>].</p>
  </notes>
  <notes>
    <title>Declarations</title>
    <notes id="FPar1">
      <title>Ethics approval and consent to participate</title>
      <p id="Par127">Not applicable.</p>
    </notes>
    <notes id="FPar2">
      <title>Consent for publication</title>
      <p id="Par128">Not applicable.</p>
    </notes>
    <notes id="FPar3" notes-type="COI-statement">
      <title>Competing interests</title>
      <p id="Par129">The authors declare that they have no competing interests.</p>
    </notes>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Krammer</surname>
            <given-names>F</given-names>
          </name>
        </person-group>
        <article-title>SARS-CoV-2 vaccines in development</article-title>
        <source>Nature</source>
        <year>2020</year>
        <volume>586</volume>
        <fpage>516</fpage>
        <lpage>527</lpage>
        <?supplied-pmid 32967006?>
        <pub-id pub-id-type="pmid">32967006</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ott</surname>
            <given-names>PA</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>An immunogenic personal neoantigen vaccine for patients with melanoma</article-title>
        <source>Nature</source>
        <year>2017</year>
        <volume>547</volume>
        <fpage>217</fpage>
        <lpage>221</lpage>
        <?supplied-pmid 28678778?>
        <pub-id pub-id-type="pmid">28678778</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zacharakis</surname>
            <given-names>N</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Immune recognition of somatic mutations leading to complete durable regression in metastatic breast cancer</article-title>
        <source>Nat Med</source>
        <year>2018</year>
        <volume>24</volume>
        <fpage>724</fpage>
        <lpage>730</lpage>
        <?supplied-pmid 29867227?>
        <pub-id pub-id-type="pmid">29867227</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <mixed-citation publication-type="other">Joglekar AV &amp; Li G. T cell antigen discovery. Nat Methods. 2020:1–8. 10.1038/s41592-020-0867-z.</mixed-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rubelt</surname>
            <given-names>F</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Adaptive immune receptor repertoire community recommendations for sharing immune-repertoire sequencing data</article-title>
        <source>Nat Immunol</source>
        <year>2017</year>
        <volume>18</volume>
        <fpage>1274</fpage>
        <lpage>1278</lpage>
        <?supplied-pmid 29144493?>
        <pub-id pub-id-type="pmid">29144493</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Birnbaum</surname>
            <given-names>ME</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Deconstructing the peptide-MHC specificity of T cell recognition</article-title>
        <source>Cell</source>
        <year>2014</year>
        <volume>157</volume>
        <fpage>1073</fpage>
        <lpage>1087</lpage>
        <?supplied-pmid 24855945?>
        <pub-id pub-id-type="pmid">24855945</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Buckley</surname>
            <given-names>PR</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Evaluating performance of existing computational models in predicting CD8+ T cell pathogenic epitopes and cancer neoantigens</article-title>
        <source>Brief Bioinform.</source>
        <year>2022</year>
        <volume>23</volume>
        <fpage>bbac141</fpage>
        <?supplied-pmid 35471658?>
        <pub-id pub-id-type="pmid">35471658</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wells</surname>
            <given-names>DK</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Key Parameters of tumor epitope immunogenicity revealed through a consortium approach improve neoantigen prediction</article-title>
        <source>Cell</source>
        <year>2020</year>
        <volume>183</volume>
        <fpage>818</fpage>
        <lpage>834.e13</lpage>
        <?supplied-pmid 33038342?>
        <pub-id pub-id-type="pmid">33038342</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <mixed-citation publication-type="other">Karnaukhov V, et al. HLA binding of self-peptides is biased towards proteins with specific molecular functions. bioRxiv. 2021:2021.02.16.431395. 10.1101/2021.02.16.431395.</mixed-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bassani-Sternberg</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Gfeller</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>Unsupervised HLA peptidome deconvolution improves ligand prediction accuracy and predicts cooperative effects in peptide–HLA interactions</article-title>
        <source>J Immunol</source>
        <year>2016</year>
        <volume>197</volume>
        <fpage>2492</fpage>
        <lpage>2499</lpage>
        <?supplied-pmid 27511729?>
        <pub-id pub-id-type="pmid">27511729</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bassani-Sternberg</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Deciphering HLA-I motifs across HLA peptidomes improves neo-antigen predictions and identifies allostery regulating HLA specificity</article-title>
        <source>PLoS Comput Biol</source>
        <year>2017</year>
        <volume>13</volume>
        <fpage>e1005725</fpage>
        <?supplied-pmid 28832583?>
        <pub-id pub-id-type="pmid">28832583</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jurtz</surname>
            <given-names>V</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>NetMHCpan-4.0: improved peptide–MHC Class I interaction predictions integrating eluted ligand and peptide binding affinity data</article-title>
        <source>J Immunol</source>
        <year>2017</year>
        <volume>199</volume>
        <fpage>3360</fpage>
        <lpage>3368</lpage>
        <?supplied-pmid 28978689?>
        <pub-id pub-id-type="pmid">28978689</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Calis</surname>
            <given-names>JJA</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Properties of MHC class I presented peptides that enhance immunogenicity</article-title>
        <source>PLoS Comput Biol</source>
        <year>2013</year>
        <volume>9</volume>
        <fpage>e1003266</fpage>
        <?supplied-pmid 24204222?>
        <pub-id pub-id-type="pmid">24204222</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ogishi</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Yotsuyanagi</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>Quantitative prediction of the landscape of T cell epitope immunogenicity in sequence space</article-title>
        <source>Front Immunol</source>
        <year>2019</year>
        <volume>10</volume>
        <fpage>827</fpage>
        <?supplied-pmid 31057550?>
        <pub-id pub-id-type="pmid">31057550</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Iyer</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Prasath</surname>
            <given-names>VBS</given-names>
          </name>
          <name>
            <surname>Ni</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Salomonis</surname>
            <given-names>N</given-names>
          </name>
        </person-group>
        <article-title>DeepImmuno: deep learning-empowered prediction and generation of immunogenic peptides for T-cell immunity</article-title>
        <source>Brief Bioinform</source>
        <year>2021</year>
        <pub-id pub-id-type="doi">10.1093/bib/bbab160</pub-id>
        <?supplied-pmid 34463709?>
        <pub-id pub-id-type="pmid">34463709</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Trolle</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Nielsen</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>NetTepi: an integrated method for the prediction of T cell epitopes</article-title>
        <source>Immunogenetics</source>
        <year>2014</year>
        <volume>66</volume>
        <fpage>449</fpage>
        <lpage>456</lpage>
        <?supplied-pmid 24863339?>
        <pub-id pub-id-type="pmid">24863339</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pogorelyy</surname>
            <given-names>MV</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Exploring the pre-immune landscape of antigen-specific T cells</article-title>
        <source>Genome Medicine</source>
        <year>2018</year>
        <volume>10</volume>
        <fpage>68</fpage>
        <?supplied-pmid 30144804?>
        <pub-id pub-id-type="pmid">30144804</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tung</surname>
            <given-names>C-W</given-names>
          </name>
          <name>
            <surname>Ziehm</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Kämper</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Kohlbacher</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Ho</surname>
            <given-names>S-Y</given-names>
          </name>
        </person-group>
        <article-title>POPISK: T-cell reactivity prediction using support vector machines and string kernels</article-title>
        <source>BMC Bioinformatics</source>
        <year>2011</year>
        <volume>12</volume>
        <fpage>446</fpage>
        <?supplied-pmid 22085524?>
        <pub-id pub-id-type="pmid">22085524</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chowell</surname>
            <given-names>D</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>TCR contact residue hydrophobicity is a hallmark of immunogenic CD8+ T cell epitopes</article-title>
        <source>PNAS</source>
        <year>2015</year>
        <volume>112</volume>
        <fpage>E1754</fpage>
        <lpage>E1762</lpage>
        <?supplied-pmid 25831525?>
        <pub-id pub-id-type="pmid">25831525</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chowell</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Krishna</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Blattman</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Anderson</surname>
            <given-names>K</given-names>
          </name>
        </person-group>
        <article-title>Hydrophobicity is a hallmark of immunogenic MHC class I T cell epitopes (APP2P.111)</article-title>
        <source>J Immunol</source>
        <year>2014</year>
        <volume>192</volume>
        <fpage>43.12</fpage>
        <lpage>43.12</lpage>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Richman</surname>
            <given-names>LP</given-names>
          </name>
          <name>
            <surname>Vonderheide</surname>
            <given-names>RH</given-names>
          </name>
          <name>
            <surname>Rech</surname>
            <given-names>AJ</given-names>
          </name>
        </person-group>
        <article-title>Neoantigen dissimilarity to the self-proteome predicts immunogenicity and response to immune checkpoint blockade</article-title>
        <source>Cell Syst</source>
        <year>2019</year>
        <volume>9</volume>
        <fpage>375</fpage>
        <lpage>382.e4</lpage>
        <?supplied-pmid 31606370?>
        <pub-id pub-id-type="pmid">31606370</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Devlin</surname>
            <given-names>JR</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Structural dissimilarity from self drives neoepitope escape from immune tolerance</article-title>
        <source>Nat Chem Biol</source>
        <year>2020</year>
        <volume>16</volume>
        <fpage>1269</fpage>
        <lpage>1276</lpage>
        <?supplied-pmid 32807968?>
        <pub-id pub-id-type="pmid">32807968</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lee</surname>
            <given-names>CH</given-names>
          </name>
          <name>
            <surname>Antanaviciute</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Buckley</surname>
            <given-names>PR</given-names>
          </name>
          <name>
            <surname>Simmons</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Koohy</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>To what extent does MHC binding translate to immunogenicity in humans?</article-title>
        <source>ImmunoInformatics</source>
        <year>2021</year>
        <volume>3–4</volume>
        <fpage>100006</fpage>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jumper</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Highly accurate protein structure prediction with AlphaFold</article-title>
        <source>Nature</source>
        <year>2021</year>
        <volume>596</volume>
        <fpage>583</fpage>
        <lpage>589</lpage>
        <?supplied-pmid 34265844?>
        <pub-id pub-id-type="pmid">34265844</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jensen</surname>
            <given-names>KK</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Improved methods for predicting peptide binding affinity to MHC class II molecules</article-title>
        <source>Immunology</source>
        <year>2018</year>
        <volume>154</volume>
        <fpage>394</fpage>
        <lpage>406</lpage>
        <?supplied-pmid 29315598?>
        <pub-id pub-id-type="pmid">29315598</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Racle</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Robust prediction of HLA class II epitopes by deep motif deconvolution of immunopeptidomes</article-title>
        <source>Nat Biotechnol</source>
        <year>2019</year>
        <volume>37</volume>
        <fpage>1283</fpage>
        <lpage>1286</lpage>
        <?supplied-pmid 31611696?>
        <pub-id pub-id-type="pmid">31611696</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <mixed-citation publication-type="other">Lu T, et al. Deep learning-based prediction of the T cell receptor–antigen binding specificity. Nat Mach Intell. 2021:1–12. 10.1038/s42256-021-00383-2.</mixed-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sidhom</surname>
            <given-names>J-W</given-names>
          </name>
          <name>
            <surname>Larman</surname>
            <given-names>HB</given-names>
          </name>
          <name>
            <surname>Pardoll</surname>
            <given-names>DM</given-names>
          </name>
          <name>
            <surname>Baras</surname>
            <given-names>AS</given-names>
          </name>
        </person-group>
        <article-title>DeepTCR is a deep learning framework for revealing sequence concepts within T-cell repertoires</article-title>
        <source>Nat Commun</source>
        <year>2021</year>
        <volume>12</volume>
        <fpage>1605</fpage>
        <?supplied-pmid 33707415?>
        <pub-id pub-id-type="pmid">33707415</pub-id>
      </element-citation>
    </ref>
    <ref id="CR29">
      <label>29.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Weber</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Born</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Rodriguez Martínez</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>TITAN: T-cell receptor specificity prediction with bimodal attention networks</article-title>
        <source>Bioinformatics</source>
        <year>2021</year>
        <volume>37</volume>
        <fpage>i237</fpage>
        <lpage>i244</lpage>
        <?supplied-pmid 34252922?>
        <pub-id pub-id-type="pmid">34252922</pub-id>
      </element-citation>
    </ref>
    <ref id="CR30">
      <label>30.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rives</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Biological structure and function emerge from scaling unsupervised learning to 250 million protein sequences</article-title>
        <source>Proc Natl Acad Sci U S A</source>
        <year>2021</year>
        <volume>118</volume>
        <fpage>e2016239118</fpage>
        <?supplied-pmid 33876751?>
        <pub-id pub-id-type="pmid">33876751</pub-id>
      </element-citation>
    </ref>
    <ref id="CR31">
      <label>31.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rao</surname>
            <given-names>R</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Evaluating protein transfer learning with TAPE</article-title>
        <source>Adv Neural Inf Process Syst</source>
        <year>2019</year>
        <volume>32</volume>
        <fpage>9689</fpage>
        <lpage>9701</lpage>
        <?supplied-pmid 33390682?>
        <pub-id pub-id-type="pmid">33390682</pub-id>
      </element-citation>
    </ref>
    <ref id="CR32">
      <label>32.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Alley</surname>
            <given-names>EC</given-names>
          </name>
          <name>
            <surname>Khimulya</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Biswas</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>AlQuraishi</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Church</surname>
            <given-names>GM</given-names>
          </name>
        </person-group>
        <article-title>Unified rational protein engineering with sequence-based deep representation learning</article-title>
        <source>Nat Methods</source>
        <year>2019</year>
        <volume>16</volume>
        <fpage>1315</fpage>
        <lpage>1322</lpage>
        <?supplied-pmid 31636460?>
        <pub-id pub-id-type="pmid">31636460</pub-id>
      </element-citation>
    </ref>
    <ref id="CR33">
      <label>33.</label>
      <mixed-citation publication-type="other">Elnaggar A, et al. ProtTrans: towards cracking the language of life’s code through self-supervised learning. 2020. 10.1101/2020.07.12.199554. <ext-link ext-link-type="uri" xlink:href="http://biorxiv.org/lookup/doi/10.1101/2020.07.12.199554">http://biorxiv.org/lookup/doi/10.1101/2020.07.12.199554</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR34">
      <label>34.</label>
      <mixed-citation publication-type="other">Kalyan KS, Rajasekharan A &amp; Sangeetha S. AMMUS : a survey of transformer-based pretrained models in natural language processing. 2021. Preprint at 10.48550/arXiv.2108.05542.</mixed-citation>
    </ref>
    <ref id="CR35">
      <label>35.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Roshanzamir</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Aghajan</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Soleymani Baghshah</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Transformer-based deep neural network language models for Alzheimer’s disease risk assessment from targeted speech</article-title>
        <source>BMC Med Inform Decis Mak</source>
        <year>2021</year>
        <volume>21</volume>
        <fpage>92</fpage>
        <?supplied-pmid 33750385?>
        <pub-id pub-id-type="pmid">33750385</pub-id>
      </element-citation>
    </ref>
    <ref id="CR36">
      <label>36.</label>
      <mixed-citation publication-type="other">Devlin J, Chang MW, Lee K, Toutanova K. BERT: Pre-training of Deep Bidirectional Transformers for Language Understanding. In: Proceedings of the 2019 Conference of the North American Chapter of the Association for Computational Linguistics: Human Language Technologies, Volume 1 (Long and Short Papers). Minneapolis: Association for Computational Linguistics; 2019. p. 4171–4186. 10.18653/v1/N19-1423.</mixed-citation>
    </ref>
    <ref id="CR37">
      <label>37.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Torralba</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Efros</surname>
            <given-names>AA</given-names>
          </name>
        </person-group>
        <article-title>Unbiased look at dataset bias</article-title>
        <source>CVPR</source>
        <year>2011</year>
        <volume>2011</volume>
        <fpage>1521</fpage>
        <lpage>1528</lpage>
        <pub-id pub-id-type="doi">10.1109/CVPR.2011.5995347</pub-id>
      </element-citation>
    </ref>
    <ref id="CR38">
      <label>38.</label>
      <mixed-citation publication-type="other">Quiñonero-Candela J, Lawrence ND, Schwaighofer A, Sugiyama M. Dataset shift in machine learning. MIT Press; 2022.</mixed-citation>
    </ref>
    <ref id="CR39">
      <label>39.</label>
      <mixed-citation publication-type="other">Eykholt K, et al. Robust Physical-World Attacks on Deep Learning Visual Classification. In: 2018 IEEE/CVF Conference on Computer Vision and Pattern Recognition; 2018:1625–1634. 10.1109/CVPR.2018.00175.</mixed-citation>
    </ref>
    <ref id="CR40">
      <label>40.</label>
      <mixed-citation publication-type="other">Ribeiro MT, Wu T, Guestrin C &amp; Singh S. Beyond Accuracy: Behavioral Testing of NLP Models with CheckList. In: Proceedings of the 58th Annual Meeting of the Association for Computational Linguistics. Association for Computational Linguistics; 2020:4902–4912. 10.18653/v1/2020.acl-main.442.</mixed-citation>
    </ref>
    <ref id="CR41">
      <label>41.</label>
      <mixed-citation publication-type="other">Jia R, Liang P. Adversarial Examples for Evaluating Reading Comprehension Systems. In: Proceedings of the 2017 Conference on Empirical Methods in Natural Language Processing. Copenhagen: Association for Computational Linguistics; 2017. p. 2021–2031. 10.18653/v1/D17-1215.</mixed-citation>
    </ref>
    <ref id="CR42">
      <label>42.</label>
      <mixed-citation publication-type="other">Amodei D et al. Concrete problems in AI Safety; 2016. Preprint at 10.48550/arXiv.1606.06565.</mixed-citation>
    </ref>
    <ref id="CR43">
      <label>43.</label>
      <mixed-citation publication-type="other">Hendrycks D &amp; Gimpel K. A baseline for detecting misclassified and out-of-distribution examples in neural networks; 2018. Preprint at 10.48550/arXiv.1610.02136.</mixed-citation>
    </ref>
    <ref id="CR44">
      <label>44.</label>
      <mixed-citation publication-type="other">Varshney N, Mishra S, Baral C. Towards Improving Selective Prediction Ability of NLP Systems. In: Proceedings of the 7th Workshop on Representation Learning for NLP. Dublin: Association for Computational Linguistics; 2022. p. 221–226. 10.18653/v1/2022.repl4nlp-1.23.</mixed-citation>
    </ref>
    <ref id="CR45">
      <label>45.</label>
      <mixed-citation publication-type="other">Arora U, Huang W, He H. Types of out-of-distribution texts and how to detect them. In: Proceedings of the 2021 Conference on Empirical Methods in Natural Language Processing. Punta Cana: Association for Computational Linguistics; 2021. p. 10687–10701. 10.18653/v1/2021.emnlp-main.835.</mixed-citation>
    </ref>
    <ref id="CR46">
      <label>46.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kim</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Jang</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Seo</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Park</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Kang</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>Intrusion detection based on sequential information preserving log embedding methods and anomaly detection algorithms</article-title>
        <source>IEEE Access</source>
        <year>2021</year>
        <volume>9</volume>
        <fpage>58088</fpage>
        <lpage>58101</lpage>
      </element-citation>
    </ref>
    <ref id="CR47">
      <label>47.</label>
      <mixed-citation publication-type="other">Schlegl T, Seeböck P, Waldstein SM, Schmidt-Erfurth U, Langs G. Unsupervised Anomaly Detection with Generative Adversarial Networks to Guide Marker Discovery. In: Niethammer M, et al, editors. Information Processing in Medical Imaging. Boone: Springer International Publishing; 2017. p. 146–157. 10.1007/978-3-319-59050-9_12.</mixed-citation>
    </ref>
    <ref id="CR48">
      <label>48.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jang</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Lukasiewicz</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>NoiER: an approach for training more reliable fine-tuned downstream task models</article-title>
        <source>EEE/ACM Trans Audio Speech Lang Process</source>
        <year>2022</year>
        <volume>30</volume>
        <fpage>2514</fpage>
        <lpage>2525</lpage>
      </element-citation>
    </ref>
    <ref id="CR49">
      <label>49.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Fleri</surname>
            <given-names>W</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The immune epitope database and analysis resource in epitope discovery and synthetic vaccine design</article-title>
        <source>Front Immunol</source>
        <year>2017</year>
        <volume>8</volume>
        <fpage>278</fpage>
        <?supplied-pmid 28352270?>
        <pub-id pub-id-type="pmid">28352270</pub-id>
      </element-citation>
    </ref>
    <ref id="CR50">
      <label>50.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tan</surname>
            <given-names>X</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>dbPepNeo: a manually curated database for human tumor neoantigen peptides</article-title>
        <source>Database</source>
        <year>2020</year>
        <volume>2020</volume>
        <fpage>baaa004</fpage>
        <?supplied-pmid 32090262?>
        <pub-id pub-id-type="pmid">32090262</pub-id>
      </element-citation>
    </ref>
    <ref id="CR51">
      <label>51.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tickotsky</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Sagiv</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Prilusky</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Shifrut</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Friedman</surname>
            <given-names>N</given-names>
          </name>
        </person-group>
        <article-title>McPAS-TCR: a manually curated catalogue of pathology-associated T cell receptor sequences</article-title>
        <source>Bioinformatics</source>
        <year>2017</year>
        <volume>33</volume>
        <fpage>2924</fpage>
        <lpage>2929</lpage>
        <?supplied-pmid 28481982?>
        <pub-id pub-id-type="pmid">28481982</pub-id>
      </element-citation>
    </ref>
    <ref id="CR52">
      <label>52.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Xia</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>NEPdb: a database of T-cell experimentally-validated neoantigens and pan-cancer predicted neoepitopes for cancer immunotherapy</article-title>
        <source>Front Immunol</source>
        <year>2021</year>
        <volume>12</volume>
        <fpage>644637</fpage>
        <?supplied-pmid 33927717?>
        <pub-id pub-id-type="pmid">33927717</pub-id>
      </element-citation>
    </ref>
    <ref id="CR53">
      <label>53.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Adamopoulou</surname>
            <given-names>E</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Exploring the MHC-peptide matrix of central tolerance in the human thymus</article-title>
        <source>Nat Commun</source>
        <year>2013</year>
        <volume>4</volume>
        <fpage>2039</fpage>
        <?supplied-pmid 23783831?>
        <pub-id pub-id-type="pmid">23783831</pub-id>
      </element-citation>
    </ref>
    <ref id="CR54">
      <label>54.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Espinosa</surname>
            <given-names>G</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Peptides presented by HLA class I molecules in the human thymus</article-title>
        <source>J Proteomics</source>
        <year>2013</year>
        <volume>94</volume>
        <fpage>23</fpage>
        <lpage>36</lpage>
        <?supplied-pmid 24029068?>
        <pub-id pub-id-type="pmid">24029068</pub-id>
      </element-citation>
    </ref>
    <ref id="CR55">
      <label>55.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Marcu</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>HLA Ligand Atlas: a benign reference of HLA-presented peptides to improve T-cell-based cancer immunotherapy</article-title>
        <source>J Immunother Cancer</source>
        <year>2021</year>
        <volume>9</volume>
        <fpage>e002071</fpage>
        <?supplied-pmid 33858848?>
        <pub-id pub-id-type="pmid">33858848</pub-id>
      </element-citation>
    </ref>
    <ref id="CR56">
      <label>56.</label>
      <mixed-citation publication-type="other">Schmidt J, et al. Prediction of neo-epitope immunogenicity reveals TCR recognition determinants and provides insight into immunoediting. Cell Rep Med. 2021;2:100194.</mixed-citation>
    </ref>
    <ref id="CR57">
      <label>57.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Iyer</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Prasath</surname>
            <given-names>VBS</given-names>
          </name>
          <name>
            <surname>Ni</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Salomonis</surname>
            <given-names>N</given-names>
          </name>
        </person-group>
        <article-title>DeepImmuno: deep learning-empowered prediction and generation of immunogenic peptides for T-cell immunity</article-title>
        <source>Brief Bioinform</source>
        <year>2021</year>
        <volume>22</volume>
        <fpage>bbab160</fpage>
        <?supplied-pmid 34009266?>
        <pub-id pub-id-type="pmid">34009266</pub-id>
      </element-citation>
    </ref>
    <ref id="CR58">
      <label>58.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Osorio</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Rondón-Villarreal</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Torres</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Peptides: a package for data mining of antimicrobial peptides</article-title>
        <source>R J</source>
        <year>2015</year>
        <volume>7</volume>
        <fpage>4</fpage>
      </element-citation>
    </ref>
    <ref id="CR59">
      <label>59.</label>
      <mixed-citation publication-type="other">Pagès H, Aboyoun P, Gentleman R &amp; DebRoy S. Biostrings: efficient manipulation of biological strings; 2022. 10.18129/B9.bioc.Biostrings.</mixed-citation>
    </ref>
    <ref id="CR60">
      <label>60.</label>
      <mixed-citation publication-type="other">Lee CH. diffSeqPatterns: R package for differential sequence pattern analysis. GitHub; 2023. <ext-link ext-link-type="uri" xlink:href="https://github.com/ChloeHJ/diffSeqPatterns">https://github.com/ChloeHJ/diffSeqPatterns</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR61">
      <label>61.</label>
      <mixed-citation publication-type="other">Zhou C, Paffenroth RC. Anomaly Detection with Robust Deep Autoencoders. In: Proceedings of the 23rd ACM SIGKDD International Conference on Knowledge Discovery and Data Mining. Halifax: Association for Computing Machinery; 2017. p. 665–674. 10.1145/3097983.3098052.</mixed-citation>
    </ref>
    <ref id="CR62">
      <label>62.</label>
      <mixed-citation publication-type="other">Guo C, Pleiss G, Sun Y, Weinberger KQ. On Calibration of Modern Neural Networks. In: Proceedings of the 34th International Conference on Machine Learning. Sydney: PMLR; 2017. p. 1321–1330.</mixed-citation>
    </ref>
    <ref id="CR63">
      <label>63.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bresciani</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>T-cell recognition is shaped by epitope sequence conservation in the host proteome and microbiome</article-title>
        <source>Immunology</source>
        <year>2016</year>
        <volume>148</volume>
        <fpage>34</fpage>
        <lpage>39</lpage>
        <?supplied-pmid 26789414?>
        <pub-id pub-id-type="pmid">26789414</pub-id>
      </element-citation>
    </ref>
    <ref id="CR64">
      <label>64.</label>
      <mixed-citation publication-type="other">Ma R, et al. Decitabine increases neoantigen and cancer testis antigen expression to enhance T-cell–mediated toxicity against glioblastoma. Neuro Oncol. 2022:noac107. 10.1093/neuonc/noac107.</mixed-citation>
    </ref>
    <ref id="CR65">
      <label>65.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bjerregaard</surname>
            <given-names>A-M</given-names>
          </name>
          <name>
            <surname>Nielsen</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Hadrup</surname>
            <given-names>SR</given-names>
          </name>
          <name>
            <surname>Szallasi</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Eklund</surname>
            <given-names>AC</given-names>
          </name>
        </person-group>
        <article-title>MuPeXI: prediction of neo-epitopes from tumor sequencing data</article-title>
        <source>Cancer Immunol Immunother</source>
        <year>2017</year>
        <volume>66</volume>
        <fpage>1123</fpage>
        <lpage>1130</lpage>
        <?supplied-pmid 28429069?>
        <pub-id pub-id-type="pmid">28429069</pub-id>
      </element-citation>
    </ref>
    <ref id="CR66">
      <label>66.</label>
      <mixed-citation publication-type="other">Lee CH. TRAP: a robust deep learning workflow to predict CD8+ T-cell epitopes. GitHub; 2023. <ext-link ext-link-type="uri" xlink:href="https://github.com/ChloeHJ/TRAP">https://github.com/ChloeHJ/TRAP</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR67">
      <label>67.</label>
      <mixed-citation publication-type="other">Gao A et al. Predicting the Immunogenicity of T cell epitopes: from HIV to SARS-CoV-2. bioRxiv. 2020:2020.05.14.095885. 10.1101/2020.05.14.095885.</mixed-citation>
    </ref>
    <ref id="CR68">
      <label>68.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ruppert</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Prominent role of secondary anchor residues in peptide binding to HLA-A2.1 molecules</article-title>
        <source>Cell</source>
        <year>1993</year>
        <volume>74</volume>
        <fpage>929</fpage>
        <lpage>937</lpage>
        <?supplied-pmid 8104103?>
        <pub-id pub-id-type="pmid">8104103</pub-id>
      </element-citation>
    </ref>
    <ref id="CR69">
      <label>69.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Liston</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Lesage</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Wilson</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Peltonen</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Goodnow</surname>
            <given-names>CC</given-names>
          </name>
        </person-group>
        <article-title>Aire regulates negative selection of organ-specific T cells</article-title>
        <source>Nat Immunol</source>
        <year>2003</year>
        <volume>4</volume>
        <fpage>350</fpage>
        <lpage>354</lpage>
        <?supplied-pmid 12612579?>
        <pub-id pub-id-type="pmid">12612579</pub-id>
      </element-citation>
    </ref>
    <ref id="CR70">
      <label>70.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Starr</surname>
            <given-names>TK</given-names>
          </name>
          <name>
            <surname>Jameson</surname>
            <given-names>SC</given-names>
          </name>
          <name>
            <surname>Hogquist</surname>
            <given-names>KA</given-names>
          </name>
        </person-group>
        <article-title>Positive and negative selection of T cells</article-title>
        <source>Annu Rev Immunol</source>
        <year>2003</year>
        <volume>21</volume>
        <fpage>139</fpage>
        <lpage>176</lpage>
        <?supplied-pmid 12414722?>
        <pub-id pub-id-type="pmid">12414722</pub-id>
      </element-citation>
    </ref>
    <ref id="CR71">
      <label>71.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jameson</surname>
            <given-names>SC</given-names>
          </name>
          <name>
            <surname>Hogquist</surname>
            <given-names>KA</given-names>
          </name>
          <name>
            <surname>Bevan</surname>
            <given-names>MJ</given-names>
          </name>
        </person-group>
        <article-title>Specificity and flexibility in thymic selection</article-title>
        <source>Nature</source>
        <year>1994</year>
        <volume>369</volume>
        <fpage>750</fpage>
        <lpage>752</lpage>
        <?supplied-pmid 8008067?>
        <pub-id pub-id-type="pmid">8008067</pub-id>
      </element-citation>
    </ref>
    <ref id="CR72">
      <label>72.</label>
      <mixed-citation publication-type="other">Cho K, et al. Learning phrase representations using rnn encoder–decoder for statistical machine translation. In: Proceedings of the 2014 Conference on Empirical Methods in Natural Language Processing (EMNLP). Doha: Association for Computational Linguistics; 2014. p. 1724–1734. 10.3115/v1/D14-1179.</mixed-citation>
    </ref>
    <ref id="CR73">
      <label>73.</label>
      <mixed-citation publication-type="other">Kim Y. Convolutional Neural Networks for Sentence Classification. In: Proceedings of the 2014 Conference on Empirical Methods in Natural Language Processing (EMNLP). Doha: Association for Computational Linguistics; 2014. p. 1746–1751. 10.3115/v1/D14-1181.</mixed-citation>
    </ref>
    <ref id="CR74">
      <label>74.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wooldridge</surname>
            <given-names>L</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>CD8 controls T cell cross-reactivity</article-title>
        <source>J Immunol</source>
        <year>2010</year>
        <volume>185</volume>
        <fpage>4625</fpage>
        <lpage>4632</lpage>
        <?supplied-pmid 20844204?>
        <pub-id pub-id-type="pmid">20844204</pub-id>
      </element-citation>
    </ref>
    <ref id="CR75">
      <label>75.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bentzen</surname>
            <given-names>AK</given-names>
          </name>
          <name>
            <surname>Hadrup</surname>
            <given-names>SR</given-names>
          </name>
        </person-group>
        <article-title>T-cell-receptor cross-recognition and strategies to select safe T-cell receptors for clinical translation</article-title>
        <source>Immunooncol Technol</source>
        <year>2019</year>
        <volume>2</volume>
        <fpage>1</fpage>
        <lpage>10</lpage>
        <?supplied-pmid 35036898?>
        <pub-id pub-id-type="pmid">35036898</pub-id>
      </element-citation>
    </ref>
    <ref id="CR76">
      <label>76.</label>
      <mixed-citation publication-type="other">Schmidt D &amp; Heckendorf C. ngram: Fast n-Gram ‘Tokenization’; 2021.</mixed-citation>
    </ref>
    <ref id="CR77">
      <label>77.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Koncz</surname>
            <given-names>B</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Self-mediated positive selection of T cells sets an obstacle to the recognition of nonself</article-title>
        <source>PNAS</source>
        <year>2021</year>
        <volume>118</volume>
        <fpage>e2100542118</fpage>
        <?supplied-pmid 34507984?>
        <pub-id pub-id-type="pmid">34507984</pub-id>
      </element-citation>
    </ref>
    <ref id="CR78">
      <label>78.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Buckley</surname>
            <given-names>PR</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>CH</given-names>
          </name>
          <name>
            <surname>Antanaviciute</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Simmons</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Koohy</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>A systems approach evaluating the impact of SARS-CoV-2 variant of concern mutations on CD8+ T cell responses</article-title>
        <source>Immunother Adv</source>
        <year>2021</year>
        <volume>3</volume>
        <fpage>ltad005</fpage>
      </element-citation>
    </ref>
    <ref id="CR79">
      <label>79.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Baker</surname>
            <given-names>RE</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Infectious disease in an era of global change</article-title>
        <source>Nat Rev Microbiol</source>
        <year>2022</year>
        <volume>20</volume>
        <fpage>193</fpage>
        <lpage>205</lpage>
        <?supplied-pmid 34646006?>
        <pub-id pub-id-type="pmid">34646006</pub-id>
      </element-citation>
    </ref>
    <ref id="CR80">
      <label>80.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zinkernagel</surname>
            <given-names>RM</given-names>
          </name>
          <name>
            <surname>Doherty</surname>
            <given-names>PC</given-names>
          </name>
        </person-group>
        <article-title>Restriction of in vitro T cell-mediated cytotoxicity in lymphocytic choriomeningitis within a syngeneic or semiallogeneic system</article-title>
        <source>Nature</source>
        <year>1974</year>
        <volume>248</volume>
        <fpage>701</fpage>
        <lpage>702</lpage>
        <?supplied-pmid 4133807?>
        <pub-id pub-id-type="pmid">4133807</pub-id>
      </element-citation>
    </ref>
    <ref id="CR81">
      <label>81.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>La Gruta</surname>
            <given-names>NL</given-names>
          </name>
          <name>
            <surname>Gras</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Daley</surname>
            <given-names>SR</given-names>
          </name>
          <name>
            <surname>Thomas</surname>
            <given-names>PG</given-names>
          </name>
          <name>
            <surname>Rossjohn</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Understanding the drivers of MHC restriction of T cell receptors</article-title>
        <source>Nat Rev Immunol</source>
        <year>2018</year>
        <volume>18</volume>
        <fpage>467</fpage>
        <lpage>478</lpage>
        <?supplied-pmid 29636542?>
        <pub-id pub-id-type="pmid">29636542</pub-id>
      </element-citation>
    </ref>
    <ref id="CR82">
      <label>82.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Duan</surname>
            <given-names>F</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Genomic and bioinformatic profiling of mutational neoepitopes reveals new rules to predict anticancer immunogenicity</article-title>
        <source>J Exp Med</source>
        <year>2014</year>
        <volume>211</volume>
        <fpage>2231</fpage>
        <lpage>2248</lpage>
        <?supplied-pmid 25245761?>
        <pub-id pub-id-type="pmid">25245761</pub-id>
      </element-citation>
    </ref>
    <ref id="CR83">
      <label>83.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chen</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Flies</surname>
            <given-names>DB</given-names>
          </name>
        </person-group>
        <article-title>Molecular mechanisms of T cell co-stimulation and co-inhibition</article-title>
        <source>Nat Rev Immunol</source>
        <year>2013</year>
        <volume>13</volume>
        <fpage>227</fpage>
        <lpage>242</lpage>
        <?supplied-pmid 23470321?>
        <pub-id pub-id-type="pmid">23470321</pub-id>
      </element-citation>
    </ref>
    <ref id="CR84">
      <label>84.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Achar</surname>
            <given-names>SR</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Universal antigen encoding of T cell activation from high-dimensional cytokine dynamics</article-title>
        <source>Science</source>
        <year>2022</year>
        <volume>376</volume>
        <fpage>880</fpage>
        <lpage>884</lpage>
        <?supplied-pmid 35587980?>
        <pub-id pub-id-type="pmid">35587980</pub-id>
      </element-citation>
    </ref>
    <ref id="CR85">
      <label>85.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cameron</surname>
            <given-names>BJ</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Identification of a titin-derived HLA-A1–presented peptide as a cross-reactive target for engineered MAGE A3–directed T cells</article-title>
        <source>Sci Transl Med</source>
        <year>2013</year>
        <volume>5</volume>
        <fpage>197ra103</fpage>
        <?supplied-pmid 23926201?>
        <pub-id pub-id-type="pmid">23926201</pub-id>
      </element-citation>
    </ref>
    <ref id="CR86">
      <label>86.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Leonard</surname>
            <given-names>JD</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Identification of natural regulatory T Cell epitopes reveals convergence on a dominant autoantigen</article-title>
        <source>Immunity</source>
        <year>2017</year>
        <volume>47</volume>
        <fpage>107</fpage>
        <lpage>117.e8</lpage>
        <?supplied-pmid 28709804?>
        <pub-id pub-id-type="pmid">28709804</pub-id>
      </element-citation>
    </ref>
    <ref id="CR87">
      <label>87.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Davis</surname>
            <given-names>MM</given-names>
          </name>
        </person-group>
        <article-title>Not-so-negative selection</article-title>
        <source>Immunity</source>
        <year>2015</year>
        <volume>43</volume>
        <fpage>833</fpage>
        <lpage>835</lpage>
        <?supplied-pmid 26588773?>
        <pub-id pub-id-type="pmid">26588773</pub-id>
      </element-citation>
    </ref>
    <ref id="CR88">
      <label>88.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Takada</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Takahama</surname>
            <given-names>Y</given-names>
          </name>
        </person-group>
        <article-title>Positive-selection-inducing self-peptides displayed by cortical thymic epithelial cells</article-title>
        <source>Adv Immunol</source>
        <year>2015</year>
        <volume>125</volume>
        <fpage>87</fpage>
        <lpage>110</lpage>
        <?supplied-pmid 25591465?>
        <pub-id pub-id-type="pmid">25591465</pub-id>
      </element-citation>
    </ref>
    <ref id="CR89">
      <label>89.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Klein</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Kyewski</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Allen</surname>
            <given-names>PM</given-names>
          </name>
          <name>
            <surname>Hogquist</surname>
            <given-names>KA</given-names>
          </name>
        </person-group>
        <article-title>Positive and negative selection of the T cell repertoire: what thymocytes see (and don’t see)</article-title>
        <source>Nat Rev Immunol</source>
        <year>2014</year>
        <volume>14</volume>
        <fpage>377</fpage>
        <lpage>391</lpage>
        <?supplied-pmid 24830344?>
        <pub-id pub-id-type="pmid">24830344</pub-id>
      </element-citation>
    </ref>
    <ref id="CR90">
      <label>90.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ebert</surname>
            <given-names>PJR</given-names>
          </name>
          <name>
            <surname>Jiang</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Xie</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>Q-J</given-names>
          </name>
          <name>
            <surname>Davis</surname>
            <given-names>MM</given-names>
          </name>
        </person-group>
        <article-title>An endogenous positively selecting peptide enhances mature T cell responses and becomes an autoantigen in the absence of microRNA miR-181a</article-title>
        <source>Nat Immunol</source>
        <year>2009</year>
        <volume>10</volume>
        <fpage>1162</fpage>
        <lpage>1169</lpage>
        <?supplied-pmid 19801983?>
        <pub-id pub-id-type="pmid">19801983</pub-id>
      </element-citation>
    </ref>
    <ref id="CR91">
      <label>91.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Freitag</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Hamdan</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Reddehase</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>Holtappels</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Immunodominant cytomegalovirus epitopes suppress subdominant epitopes in the generation of high-avidity CD8 T Cells</article-title>
        <source>Pathogens</source>
        <year>2021</year>
        <volume>10</volume>
        <fpage>956</fpage>
        <?supplied-pmid 34451420?>
        <pub-id pub-id-type="pmid">34451420</pub-id>
      </element-citation>
    </ref>
    <ref id="CR92">
      <label>92.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Peng</surname>
            <given-names>Y</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Broad and strong memory CD4+ and CD8+ T cells induced by SARS-CoV-2 in UK convalescent individuals following COVID-19</article-title>
        <source>Nat Immunol</source>
        <year>2020</year>
        <volume>21</volume>
        <fpage>1336</fpage>
        <lpage>1345</lpage>
        <?supplied-pmid 32887977?>
        <pub-id pub-id-type="pmid">32887977</pub-id>
      </element-citation>
    </ref>
    <ref id="CR93">
      <label>93.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ferretti</surname>
            <given-names>AP</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Unbiased screens show CD8+ T cells of COVID-19 patients recognize shared epitopes in SARS-CoV-2 that largely reside outside the spike protein</article-title>
        <source>Immunity</source>
        <year>2020</year>
        <volume>53</volume>
        <fpage>1095</fpage>
        <lpage>1107.e3</lpage>
        <?supplied-pmid 33128877?>
        <pub-id pub-id-type="pmid">33128877</pub-id>
      </element-citation>
    </ref>
    <ref id="CR94">
      <label>94.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mazor</surname>
            <given-names>R</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Identification and elimination of an immunodominant T-cell epitope in recombinant immunotoxins based on Pseudomonas exotoxin A</article-title>
        <source>Proc Natl Acad Sci</source>
        <year>2012</year>
        <volume>109</volume>
        <fpage>E3597</fpage>
        <lpage>E3603</lpage>
        <?supplied-pmid 23213206?>
        <pub-id pub-id-type="pmid">23213206</pub-id>
      </element-citation>
    </ref>
    <ref id="CR95">
      <label>95.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Irvine</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Bennink</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Factors influencing immunodominance hierarchies in TCD8+-mediated antiviral responses</article-title>
        <source>Expert Rev Clin Immunol</source>
        <year>2006</year>
        <volume>2</volume>
        <fpage>135</fpage>
        <lpage>147</lpage>
        <?supplied-pmid 20477094?>
        <pub-id pub-id-type="pmid">20477094</pub-id>
      </element-citation>
    </ref>
    <ref id="CR96">
      <label>96.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wellington</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Yin</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Kessler</surname>
            <given-names>BM</given-names>
          </name>
          <name>
            <surname>Dong</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>Immunodominance complexity: lessons yet to be learned from dominant T cell responses to SARS-COV-2</article-title>
        <source>Curr Opin Virol</source>
        <year>2021</year>
        <volume>50</volume>
        <fpage>183</fpage>
        <lpage>191</lpage>
        <?supplied-pmid 34534732?>
        <pub-id pub-id-type="pmid">34534732</pub-id>
      </element-citation>
    </ref>
    <ref id="CR97">
      <label>97.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kastenmuller</surname>
            <given-names>W</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Cross-competition of CD8+ T cells shapes the immunodominance hierarchy during boost vaccination</article-title>
        <source>J Exp Med</source>
        <year>2007</year>
        <volume>204</volume>
        <fpage>2187</fpage>
        <lpage>2198</lpage>
        <?supplied-pmid 17709425?>
        <pub-id pub-id-type="pmid">17709425</pub-id>
      </element-citation>
    </ref>
    <ref id="CR98">
      <label>98.</label>
      <mixed-citation publication-type="other">Lee CH. Repository for TRAP models and datasets. Google Drive; 2023. <ext-link ext-link-type="uri" xlink:href="https://drive.google.com/drive/folders/15A2P5xP2c-q48vVGPRB7h7uHEMycPYoX?usp=drive_link">https://drive.google.com/drive/folders/15A2P5xP2c-q48vVGPRB7h7uHEMycPYoX?usp=drive_link</ext-link>.</mixed-citation>
    </ref>
  </ref-list>
</back>
<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Genome Med</journal-id>
    <journal-id journal-id-type="iso-abbrev">Genome Med</journal-id>
    <journal-title-group>
      <journal-title>Genome Medicine</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1756-994X</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10498576</article-id>
    <article-id pub-id-type="pmid">37705109</article-id>
    <article-id pub-id-type="publisher-id">1225</article-id>
    <article-id pub-id-type="doi">10.1186/s13073-023-01225-z</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>A robust deep learning workflow to predict CD8 + T-cell epitopes</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-6232-7119</contrib-id>
        <name>
          <surname>Lee</surname>
          <given-names>Chloe H.</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Huh</surname>
          <given-names>Jaesung</given-names>
        </name>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Buckley</surname>
          <given-names>Paul R.</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Jang</surname>
          <given-names>Myeongjun</given-names>
        </name>
        <xref ref-type="aff" rid="Aff4">4</xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-5759-2436</contrib-id>
        <name>
          <surname>Pinho</surname>
          <given-names>Mariana Pereira</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0001-5343-3334</contrib-id>
        <name>
          <surname>Fernandes</surname>
          <given-names>Ricardo A.</given-names>
        </name>
        <xref ref-type="aff" rid="Aff5">5</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Antanaviciute</surname>
          <given-names>Agne</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0003-3454-0710</contrib-id>
        <name>
          <surname>Simmons</surname>
          <given-names>Alison</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff6">6</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-3640-7043</contrib-id>
        <name>
          <surname>Koohy</surname>
          <given-names>Hashem</given-names>
        </name>
        <address>
          <email>hashem.koohy@rdm.ox.ac.uk</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
        <xref ref-type="aff" rid="Aff7">7</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="GRID">grid.4991.5</institution-id><institution-id institution-id-type="ISNI">0000 0004 1936 8948</institution-id><institution>MRC Human Immunology Unit, Medical Research Council (MRC) Weatherall Institute of Molecular Medicine (WIMM), John Radcliffe Hospital, </institution><institution>University of Oxford, </institution></institution-wrap>Oxford, OX3 9DS UK </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="GRID">grid.4991.5</institution-id><institution-id institution-id-type="ISNI">0000 0004 1936 8948</institution-id><institution>MRC WIMM Centre for Computational Biology, MRC Weatherall Institute of Molecular Medicine, John Radcliffe Hospital, </institution><institution>University of Oxford, </institution></institution-wrap>Oxford, OX3 9DS UK </aff>
      <aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/052gg0110</institution-id><institution-id institution-id-type="GRID">grid.4991.5</institution-id><institution-id institution-id-type="ISNI">0000 0004 1936 8948</institution-id><institution>Visual Geometry Group, Department of Engineering Science, </institution><institution>University of Oxford, </institution></institution-wrap>Oxford, OX2 6NN UK </aff>
      <aff id="Aff4"><label>4</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/052gg0110</institution-id><institution-id institution-id-type="GRID">grid.4991.5</institution-id><institution-id institution-id-type="ISNI">0000 0004 1936 8948</institution-id><institution>Intelligent Systems Lab, Department of Computer Science, </institution><institution>University of Oxford, </institution></institution-wrap>Oxford, OX1 3QG UK </aff>
      <aff id="Aff5"><label>5</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/052gg0110</institution-id><institution-id institution-id-type="GRID">grid.4991.5</institution-id><institution-id institution-id-type="ISNI">0000 0004 1936 8948</institution-id><institution>Chinese Academy of Medical Sciences (CAMS) Oxford Institute (COI), </institution><institution>University of Oxford, </institution></institution-wrap>Oxford, OX3 7BN UK </aff>
      <aff id="Aff6"><label>6</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/0080acb59</institution-id><institution-id institution-id-type="GRID">grid.8348.7</institution-id><institution-id institution-id-type="ISNI">0000 0001 2306 7492</institution-id><institution>Translational Gastroenterology Unit, </institution><institution>John Radcliffe Hospital, </institution></institution-wrap>Oxford, OX3 9DS UK </aff>
      <aff id="Aff7"><label>7</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/035dkdb55</institution-id><institution-id institution-id-type="GRID">grid.499548.d</institution-id><institution-id institution-id-type="ISNI">0000 0004 5903 3632</institution-id><institution>Alan Turning Fellow in Health and Medicine, The Alan Turing Institute, </institution></institution-wrap>London, UK </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>13</day>
      <month>9</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>13</day>
      <month>9</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2023</year>
    </pub-date>
    <volume>15</volume>
    <elocation-id>70</elocation-id>
    <history>
      <date date-type="received">
        <day>30</day>
        <month>1</month>
        <year>2023</year>
      </date>
      <date date-type="accepted">
        <day>30</day>
        <month>8</month>
        <year>2023</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© Crown 2023</copyright-statement>
      <license>
        <ali:license_ref specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p><bold>Open Access</bold> This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article's Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article's Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated in a credit line to the data.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p id="Par1">T-cells play a crucial role in the adaptive immune system by triggering responses against cancer cells and pathogens, while maintaining tolerance against self-antigens, which has sparked interest in the development of various T-cell-focused immunotherapies. However, the identification of antigens recognised by T-cells is low-throughput and laborious. To overcome some of these limitations, computational methods for predicting CD8 + T-cell epitopes have emerged. Despite recent developments, most immunogenicity algorithms struggle to learn features of peptide immunogenicity from small datasets, suffer from HLA bias and are unable to reliably predict pathology-specific CD8 + T-cell epitopes.</p>
      </sec>
      <sec>
        <title>Methods</title>
        <p id="Par2">We developed TRAP (T-cell recognition potential of HLA-I presented peptides), a robust deep learning workflow for predicting CD8 + T-cell epitopes from MHC-I presented pathogenic and self-peptides. TRAP uses transfer learning, deep learning architecture and MHC binding information to make context-specific predictions of CD8 + T-cell epitopes. TRAP also detects low-confidence predictions for peptides that differ significantly from those in the training datasets to abstain from making incorrect predictions. To estimate the immunogenicity of pathogenic peptides with low-confidence predictions, we further developed a novel metric, RSAT (relative similarity to autoantigens and tumour-associated antigens), as a complementary to ‘dissimilarity to self’ from cancer studies.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p id="Par3">TRAP was used to identify epitopes from glioblastoma patients as well as SARS-CoV-2 peptides, and it outperformed other algorithms in both cancer and pathogenic settings. TRAP was especially effective at extracting immunogenicity-associated properties from restricted data of emerging pathogens and translating them onto related species, as well as minimising the loss of likely epitopes in imbalanced datasets. We also demonstrated that the novel metric termed RSAT was able to estimate immunogenic of pathogenic peptides of various lengths and species. TRAP implementation is available at: <ext-link ext-link-type="uri" xlink:href="https://github.com/ChloeHJ/TRAP">https://github.com/ChloeHJ/TRAP</ext-link>.</p>
      </sec>
      <sec>
        <title>Conclusions</title>
        <p id="Par4">This study presents a novel computational workflow for accurately predicting CD8 + T-cell epitopes to foster a better understanding of antigen-specific T-cell response and the development of effective clinical therapeutics.</p>
      </sec>
      <sec>
        <title>Supplementary Information</title>
        <p>The online version contains supplementary material available at 10.1186/s13073-023-01225-z.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Immunogenicity</kwd>
      <kwd>CD8 + T-cell epitopes</kwd>
      <kwd>Deep learning</kwd>
      <kwd>Transfer learning</kwd>
      <kwd>Computational immunology</kwd>
      <kwd>Epitope prediction</kwd>
      <kwd>Self-antigen tolerance</kwd>
      <kwd>MHC binding</kwd>
      <kwd>Thymic selection</kwd>
      <kwd>Neoepitope identification</kwd>
      <kwd>Vaccine candidates</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100000265</institution-id>
            <institution>Medical Research Council</institution>
          </institution-wrap>
        </funding-source>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100015250</institution-id>
            <institution>NIHR Bristol Biomedical Research Centre</institution>
          </institution-wrap>
        </funding-source>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© BioMed Central Ltd., part of Springer Nature 2023</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p id="Par38">T-cells are essential for eliminating intracellular infections, triggering anti-tumour response as well as developing an immunological memory. Their ability to induce antigen-directed cytotoxicity has proven instrumental in fighting diseases, as evidenced by checkpoint blockade immunotherapy, adoptive cellular therapy, and cancer vaccinology [<xref ref-type="bibr" rid="CR1">1</xref>–<xref ref-type="bibr" rid="CR3">3</xref>]. With the growing interest in identifying the cognate antigens of antigen-specific T-cells, many efforts have been made to improve experimental and computational methods for screening, predicting or characterising T-cell epitopes. However, current experimental approaches for identifying T-cell targets are labour-intensive, low-throughput and expensive [<xref ref-type="bibr" rid="CR4">4</xref>–<xref ref-type="bibr" rid="CR6">6</xref>], and computational methods are still in their infancy [<xref ref-type="bibr" rid="CR7">7</xref>].</p>
    <p id="Par39">An effective antigen-specific CD8 + T-cell response to exogenous pathogens or endogenous threats relies on tightly regulated processing and presentation of antigenic peptides by class I MHCs, followed by recognition of the peptide-MHC (pMHC) by cognate CD8 + T-cells. Therefore, immunogenic peptides encompass features associated with MHC presentation <italic>and</italic> T-cell recognition [<xref ref-type="bibr" rid="CR8">8</xref>]. Among these, it has been demonstrated that features attributed to MHC presentation are more prominent than those attributed to TCR recognition, with strongly conserved motifs at anchor positions being one such feature [<xref ref-type="bibr" rid="CR9">9</xref>, <xref ref-type="bibr" rid="CR10">10</xref>]. Indeed, recent cutting-edge models [<xref ref-type="bibr" rid="CR11">11</xref>, <xref ref-type="bibr" rid="CR12">12</xref>], such as the widely used NetMHCpan [<xref ref-type="bibr" rid="CR12">12</xref>], have demonstrated impressive performance in predicting MHC presentation on certain alleles. On the other hand, the dual nature of the peptide-specific TCR recognition interface, comprised of both peptide and MHC, makes predicting the interaction between TCR and pMHC uniquely challenging. In addition, the scarcity of peptides tested by T-cell assays, as well as the lack of true negative datasets (i.e. presented but not recognised by T-cells), hampers our understanding of the properties underlying T-cell recognition.</p>
    <p id="Par40">Despite these challenges, a plethora of computational models have been developed to aid in the prediction of T-cell targets and to foster a better understanding of the characteristics underpinning peptide immunogenicity [<xref ref-type="bibr" rid="CR8">8</xref>, <xref ref-type="bibr" rid="CR13">13</xref>–<xref ref-type="bibr" rid="CR17">17</xref>]. These models utilise features such as amino acids at contact position, large and aromatic side chains [<xref ref-type="bibr" rid="CR13">13</xref>], hydrophobicity [<xref ref-type="bibr" rid="CR17">17</xref>–<xref ref-type="bibr" rid="CR20">20</xref>], peptide-MHC binding affinity and stability [<xref ref-type="bibr" rid="CR16">16</xref>] as correlates to T-cell recognition. Specifically for cancer neoepitopes, agretopicity (i.e. the ratio of binding affinity between neoepitope and wild-type counterpart), foreignness score (i.e. similarity of neoepitope to previously characterised epitopes) [<xref ref-type="bibr" rid="CR8">8</xref>] and dissimilarity to human proteome [<xref ref-type="bibr" rid="CR21">21</xref>, <xref ref-type="bibr" rid="CR22">22</xref>] were found to indicate T-cell recognition.</p>
    <p id="Par41">However, we previously found that cancer and pathogenic epitopes often do not share the same immunogenicity features, which may differ in directionality or magnitude [<xref ref-type="bibr" rid="CR23">23</xref>]. In addition to the context-specific differences, other factors, such as limited training data and a highly diverse T-cell receptor (TCR) repertoire contributed to the difficulty of predicting T-cell recognition potential. As a result, many existing models perform poorly against both cancer and emerging viral pathogens [<xref ref-type="bibr" rid="CR7">7</xref>], and progress in improving performance appears to be incremental, suggesting that there are still remaining challenges in predicting T-cell epitopes.</p>
    <p id="Par42">Over the last decade, deep learning and natural language processing (NLP) have transformed biomedical research and offered breakthrough discoveries [<xref ref-type="bibr" rid="CR24">24</xref>]. Because of their ability to extract complex patterns from large amounts of data, deep neural network (DNN) models have been used for predicting peptide-HLA binding [<xref ref-type="bibr" rid="CR12">12</xref>, <xref ref-type="bibr" rid="CR25">25</xref>, <xref ref-type="bibr" rid="CR26">26</xref>] as well as TCR specificity [<xref ref-type="bibr" rid="CR27">27</xref>–<xref ref-type="bibr" rid="CR29">29</xref>]. Furthermore, transformer-based pre-trained language models (PLMs) have advanced the prediction of protein structure and function [<xref ref-type="bibr" rid="CR30">30</xref>–<xref ref-type="bibr" rid="CR33">33</xref>] by combining the power of transformers, self-supervised learning and transfer learning [<xref ref-type="bibr" rid="CR34">34</xref>–<xref ref-type="bibr" rid="CR36">36</xref>]. Indeed, as a solution to data constraints, these protein PLMs, which contain knowledge learned from a large volume of protein sequences, could serve as an additional source of information for related downstream tasks.</p>
    <p id="Par43">In addition, more research has recently been conducted on providing reliable predictions for safety–critical applications. Most of DNN models are trained under the assumption that test data distribution will be similar to the training data distribution. However, when used in real-world tasks, out-of-distribution (OOD) examples that deviate from the training data are common [<xref ref-type="bibr" rid="CR37">37</xref>, <xref ref-type="bibr" rid="CR38">38</xref>], resulting in a significant drop in model performance [<xref ref-type="bibr" rid="CR39">39</xref>–<xref ref-type="bibr" rid="CR41">41</xref>]. While this may be acceptable for some applications such as movie recommendations, it can be disastrous in safety–critical applications, such as medical diagnosis [<xref ref-type="bibr" rid="CR42">42</xref>, <xref ref-type="bibr" rid="CR43">43</xref>]. Therefore, the ability to identify OOD inputs and respond appropriately, whether by abstaining, requesting human intervention or gathering additional information, has become critical [<xref ref-type="bibr" rid="CR42">42</xref>]. Recently, several methods for estimating the degree of correctness have been proposed and have been successfully applied in the Natural language Inference (NLI) and/or OOD datasets [<xref ref-type="bibr" rid="CR44">44</xref>–<xref ref-type="bibr" rid="CR48">48</xref>]. One of the major challenges in immunogenicity prediction has been the limited data and OOD generalisation problem for peptides derived from different hosts, organisms and diseases. As such, the OOD detection module would facilitate making reliable predictions on a real-world set of peptides that are often highly diverse and heterogeneous.</p>
    <p id="Par44">Here, we present TRAP (<underline>T</underline>-cell <underline>r</underline>ecognition potential of HL<underline>A</underline>-I presented <underline>p</underline>eptides), a deep learning-based workflow that addresses the current limitations and effectively captures T-cell recognition motifs from HLA-I presented pathogenic or self-peptides. Novel strategies were implemented, such as (a) building separate models for pathogenic and self-peptides to account for divergent immunogenicity-related features, (b) using transfer learning to deliver amino acid embeddings from pre-trained large-scale protein language models, (c) capturing T-cell recognition motifs with a deep learning architecture, and (d) detecting low-confidence predictions to abstain from making incorrect predictions. We further developed RSAT (relative similarity to autoantigens and tumour-associated antigens) to estimate the immunogenicity of pathogenic peptides when they are abstained due to low-confidence predictions. The TRAP was then used to identify cancer neoepitopes from glioblastoma patients and showed superior performance to other methods. While many immunogenicity algorithms are based on MHC binding, TRAP goes one step further by predicting T-cell targets from MHC-I ligands. This novel workflow will enable more accurate identification of CD8 + T-cell epitopes, facilitating the development of effective vaccines and therapeutics.</p>
  </sec>
  <sec id="Sec2">
    <title>Methods</title>
    <sec id="Sec3">
      <title>Data preparation</title>
      <sec id="Sec4">
        <title>PeptideTcell data</title>
        <p id="Par45">Peptides that bind MHC-I molecules are typically restricted to 8–10 amino acids (aa) in lengths due to closed structure of peptide-binding groove. Given the limited number of 8aa peptides in databases, peptides of lengths 9–10aa characterised by T-cells were retrieved from IEDB [<xref ref-type="bibr" rid="CR49">49</xref>]. These included cancer neoepitopes, autoantigens or pathogenic peptides. The peptides without HLA allele or serotype annotations were removed. To ensure MHC binding, peptides were subjected to NetMHCpan 4.0 prediction and only those with rank ≤ 2.0 (i.e. predicted MHC binder) were retained. Peptides having contradictory immunogenicity annotations were categorised as ‘Positive’ and we only included Negatives that were characterised negative in ≥ 3 tests. This resulted 5093 immunogenic (‘Positive’) and 6628 non-immunogenic (‘Negative’) peptides in PeptideTcell data. The dataset includes information about peptide sequence, binary immunogenicity, HLA allele, source antigen and organism. This data is the foundation for sequence pattern analysis, model development and RSAT validation.</p>
      </sec>
      <sec id="Sec5">
        <title>Pathogenic data</title>
        <p id="Par46">For the analysis of sequence patterns and the development of deep learning-based models, datasets for pathogenic and self-antigens were prepared separately. For pathogenic datasets, we subset peptides originating from non-human species, resulting 4000 Positive and 6097 Negative pathogenic peptides (Additional file <xref rid="MOESM3" ref-type="media">3</xref>: Table S1).</p>
      </sec>
      <sec id="Sec6">
        <title>Self-antigen data</title>
        <p id="Par47">For immunogenic self-peptides, autoantigens, tumour-associated antigens and cancer neoepitopes having 9–10 amino acids were collected from different databases. We gathered 162 epitopes from cancer peptide database (<ext-link ext-link-type="uri" xlink:href="https://caped.icp.ucl.ac.be">https://caped.icp.ucl.ac.be</ext-link>), 228 from dbPepNeo [<xref ref-type="bibr" rid="CR50">50</xref>], 1506 from IEDB [<xref ref-type="bibr" rid="CR49">49</xref>], 256 from McPAS-TCR [<xref ref-type="bibr" rid="CR51">51</xref>] and 256 from NEPdb [<xref ref-type="bibr" rid="CR52">52</xref>]. For Negative self-antigens, we gathered HLA-I ligands expressed in thymus suggested to be involved in the negative selection of T-cells. Two hundred forty HLA-I ligands were collected from Adamopoulou et al. [<xref ref-type="bibr" rid="CR53">53</xref>], which were expressed in negatively selecting dendritic cells, 187 HLA-I ligands from Espinosa et al. [<xref ref-type="bibr" rid="CR54">54</xref>], which were expressed in thymus, and 10,840 benign HLA-I presented peptides from HLA Ligand Atlas [<xref ref-type="bibr" rid="CR55">55</xref>] expressed in thymus. Of note, we did not include ‘Negatives’ from IEDB for self-antigen data because many were tested due to their association with tumour-associated antigens, e.g. cancer/testis antigen 1, melanoma-associated antigen 9; yet, there was little evidence that these peptides were immunogenic. Therefore, only MHC-I peptides expressed in thymus were included. After pre-processing, removing duplicates and filtering for peptides with NetMHCpan rank ≤ 2, 1260 Positive and 2868 Negative peptides were retained for the self-antigen model. Since MHC binding filter removed many peptides, we prepared another self-antigen dataset with relaxed threshold (NetMHCpan rank ≤ 10) to include as many self-epitopes as possible for model training and validation, resulting 1606 Positive and 10,915 Negative peptides (Additional file <xref rid="MOESM3" ref-type="media">3</xref>: Table S2). For all analysis, the self-antigen dataset with relaxed threshold was used, unless otherwise specified.</p>
      </sec>
      <sec id="Sec7">
        <title>Benchmarking data</title>
        <p id="Par48">The benchmarking analysis has been done in HLA-agnostic (i.e. peptide-based) or HLA-restrictive (i.e. peptide-HLA based) manner depending on the nature of different models. The TRAP makes prediction based on the peptide sequence and HLA binding rank score, which allows it to predict in both HLA-agnostic and restrictive manner. The HLA-agnostic approach was applied on all peptides in the aforementioned pathogenic and self-antigen datasets. The HLA-restricted prediction was made against epitopes that were bound to 13 HLAs for which NetTepi could be performed, which are HLA-A*02:01, HLA-B*58:01, HLA-B*15:01, HLA-B*35:01, HLA-B*07:02, HLA-A*01:01, HLA-A*03:01, HLA-A*11:01, HLA-A*24:02, HLA-A*26:01, HLA-B*27:05, HLA-B*39:01, HLA-B*40:01. The list of models conducted in HLA-restricted manner are iPred [<xref ref-type="bibr" rid="CR17">17</xref>], PRIME [<xref ref-type="bibr" rid="CR56">56</xref>], NetTepi [<xref ref-type="bibr" rid="CR16">16</xref>], IEDB [<xref ref-type="bibr" rid="CR13">13</xref>] and DeepImmuno [<xref ref-type="bibr" rid="CR57">57</xref>]. Specifically for DeepImmuno, an additional filter was applied to exclude peptides that were bound to HLAs that DeepImmuno could not process.</p>
      </sec>
      <sec id="Sec8">
        <title>DeepImmuno data</title>
        <p id="Par49">DeepImmuno training data was retrieved from GitHub repository and used for evaluating the DeepImmuno performance (<ext-link ext-link-type="uri" xlink:href="https://github.com/frankligy/DeepImmuno">https://github.com/frankligy/DeepImmuno</ext-link>).</p>
      </sec>
    </sec>
    <sec id="Sec9">
      <title>10-fold CV and cross-species comparison</title>
      <p id="Par50">The peptideTcell data was divided randomly or in cross-species manner: (i) 90% train vs. 10% test random split (i.e. representation of 10-fold cross-validation), (ii) Non-SARS-CoV-2 (Non-SARS-2) train vs. SARS-2 test, and (iii) Non-vaccinia virus (Non-VACV) train vs. VACV test.</p>
      <p id="Par51">To compare the performance of the XGBOOST classifier on random vs. cross-species datasets, amino acids at contact positions were first represented by their physicochemical properties using ‘aaDescriptors’ function in R Peptides v2.4.4 package. The amino acid descriptors included kideraFactor, zScales, tScales, vhseScales, protFP, stScales, blosumIndices, mswhimScores, crucianiProperties and fasgaiVectors, which described properties such as polarity, electronic properties, hydrophobicity, α-helix/bend preference, β-sheet, bulkiness/size of side-chains, hydrogen-bonding, isoelectric point and structural topology [<xref ref-type="bibr" rid="CR58">58</xref>]. In addition to amino acid-level embedding, the peptide-wide property was added by averaging these aaDescriptors across all positions for each peptide. The embeddings from random split and cross-species datasets were used to generate the XGBOOST classifier using ‘XGBClassifier’ function in python xgboost v0.90 package. The set of hyperparameters, such as alpha, gamma, max_depth and colsample_bytree, were optimised by grid search for each dataset. The models were trained using training datasets: 90% train, Non-SARS-2 and Non-VACV peptides by 10-fold cross-validations. The trained models were tested on 10% test, SARS-2 and VACV peptides, respectively as representatives of 10-fold CV and cross-species comparisons.</p>
      <p id="Par52">To analyse sequence homology between training vs. test datasets, differential position-specific scoring matrices (dPSSMs) were generated for each training and test datasets. The probability frequency of each amino acid in each position was represented by position-specific scoring matrices using ‘consensusMatrix’ function from R Biostrings v2.56.0 package. The PSSMs from Positive and Negative peptides were standardised by centre and scaling, and differential PSSMs were generated by subtracting the two. To estimate the discriminative power of the dPSSM scores, we generated dPSSMs using training data and used the matrices to score respective test peptides for their immunogenicity potential.</p>
    </sec>
    <sec id="Sec10">
      <title>Immunogenicity positivity score</title>
      <p id="Par53">The positivity score was computed by taking three factors into account: (1) the number of experiments conducted, (2) the percentage tested positive and (3) the number of cognate TCRs if available, using the following equations.<disp-formula id="Equ1"><label>1</label><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm{PS}=\mathrm{pr}+\left(1-{\mathrm{e}}^{-\frac{\mathrm{T}N}{\mathrm{Qp}}}\right)$$\end{document}</tex-math><mml:math id="M2" display="block"><mml:mrow><mml:mi mathvariant="normal">PS</mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="normal">pr</mml:mi><mml:mo>+</mml:mo><mml:mfenced close=")" open="("><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="normal">e</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">T</mml:mi><mml:mi>N</mml:mi></mml:mrow><mml:mi mathvariant="normal">Qp</mml:mi></mml:mfrac></mml:mrow></mml:msup></mml:mfenced></mml:mrow></mml:math><graphic xlink:href="13073_2023_1225_Article_Equ1.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ2"><label>2</label><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm{PS}=1-\left[\mathrm{pr}+\left(1-\mathrm e^{-\frac{\mathrm TN}{\mathrm{Qn}}}\right)\right]$$\end{document}</tex-math><mml:math id="M4" display="block"><mml:mrow><mml:mi mathvariant="normal">PS</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mfenced close="]" open="["><mml:mi mathvariant="normal">pr</mml:mi><mml:mo>+</mml:mo><mml:mfenced close=")" open="("><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msup><mml:mi mathvariant="normal">e</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">T</mml:mi><mml:mi>N</mml:mi></mml:mrow><mml:mi mathvariant="normal">Qn</mml:mi></mml:mfrac></mml:mrow></mml:msup></mml:mfenced></mml:mfenced></mml:mrow></mml:math><graphic xlink:href="13073_2023_1225_Article_Equ2.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ3"><label>3</label><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm{x}=\frac{1}{1+{\mathrm{e}}^{-\mathrm{nTCR}}}$$\end{document}</tex-math><mml:math id="M6" display="block"><mml:mrow><mml:mi mathvariant="normal">x</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="normal">e</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mi mathvariant="normal">nTCR</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mfrac></mml:mrow></mml:math><graphic xlink:href="13073_2023_1225_Article_Equ3.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ4"><label>4</label><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm{PS}=\mathrm{min^{\prime}}+\frac{\mathrm{max^{\prime}}-\mathrm{min^{\prime}}}{\mathrm{max}(\mathrm{x})-\mathrm{min}(\mathrm{x})}*(\mathrm{x}-\mathrm{min}\left(\mathrm{x}\right))$$\end{document}</tex-math><mml:math id="M8" display="block"><mml:mrow><mml:mi mathvariant="normal">PS</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mi mathvariant="normal">min</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mi mathvariant="normal">max</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>-</mml:mo><mml:msup><mml:mi mathvariant="normal">min</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mrow><mml:mrow><mml:mi mathvariant="normal">max</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="normal">x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>-</mml:mo><mml:mi mathvariant="normal">min</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="normal">x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac><mml:mrow/><mml:mo>∗</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="normal">x</mml:mi><mml:mo>-</mml:mo><mml:mi mathvariant="normal">min</mml:mi><mml:mfenced close=")" open="("><mml:mi mathvariant="normal">x</mml:mi></mml:mfenced><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><graphic xlink:href="13073_2023_1225_Article_Equ4.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par54">(1) computes positivity score (PS) for Positives peptides that do not have TCR information available, where pr = % responded positive, TN = total number of tests conducted and Qp = the number of tests designated as a minimum number of tests required to support positivity (Qp = 3). (2) computes PS for Negative peptides, where Qn = number of tests designated as a minimum number of tests required to support negativity (Qn = 5). (3) and (4) compute for Positives with cognate TCR information. (3) is a sigmoid function that translates the number of cognate TCR (nTCR) to values in a logistic growth curve and (4) scales the distribution to align with scores from (1), where min’ equals mean of the distribution (~ 1.28 equivalent to 1 test and 1 responded positive) and max’ = 2.0. Due to limited pool of peptides with cognate TCRs, the majority of peptides’ positivity score was computed by translating the number of experiments conducted and % tested positive, and the number of cognate TCRs was incorporated to add greater weights to positivity (all positivity scores with cognate TCR had values &gt; 1). The positivity scores were computed for each entry for each peptide-HLA pair, and ranged from 0 to 2.3, with Negatives ranging from 0 to 1 and Positives ranging from 1 to 2.3.</p>
    </sec>
    <sec id="Sec11">
      <title>Intra- and inter-HLA variability</title>
      <p id="Par55">The HLA effect was computed on 2349 peptides having entries from multiple HLA alleles. One-way ANOVA was conducted for the effect of HLA on the positivity score for each peptide-HLA pair using ‘aov’ function from R stats v4.0.5 package. The distributions show mean squared from summary output.</p>
    </sec>
    <sec id="Sec12">
      <title>Differential sequence patterns</title>
      <p id="Par56">The n-grams (i.e. contiguous sequence of n-amino acids) were generated using ‘ngram’ function from R ngram v3.1.0 package. The number of peptides containing the n-grams was counted for Positive and Negative respectively and normalised for the total number of Positive and Negative peptides, respectively. Then, we computed ratio<sub>n-gram</sub> = normalised # of Positive peptides containing the n-gram / normalised # of Negative peptides containing the n-gram, and shortlist top differential n-grams by the ratio score. Similarly, we generated all possible combinations of position-specific k-mer motifs (i.e. contiguous or non-contiguous sequence of k amino acids restricted to peptides of same lengths), where e.g..M.W. denotes MW pattern at P2 and P4 of 5 amino acid peptide. We computed ratio <sub>positional k-mer</sub> = normalised # of Positive peptides containing the positional k-mer / normalised # of Negative peptides containing the positional k-mer to shortlisted top differential position-specific k-mer motifs. For visualisation, patterns were categorised by their normalised ratios, where ‘lows’ have ¼ &lt; ratio &lt; 4, ‘high in pos’ have ratio ≥ 4, ‘high in neg’ have ratio ≤ ¼, and ‘onlys’ have motifs in either positive or negative sets, and top differential patterns from ‘high’ or ‘only’ categories were visualised by barplot. To identify shared enriched patterns between pathogenic and self-antigens, only n-grams or positional k-mer motifs having ratio ≥ 3 or ≥ 3 positive peptides (for onlys) were pre-selected for comparison. The pairwise sequence similarity between peptides was computed using ‘pairwiseAlignment’ function in Biostrings v2.56.0 package [<xref ref-type="bibr" rid="CR59">59</xref>], using BLOSUM62 substitution matrix and default parameters. For clusters of highly similar peptides, the peptides having alignment scores ≥ 22 with ≥ 3 other peptides were visualised into network graph using R ggnetwork v0.5.10 package. The toolkits for generating the sequence patterns are deposited in: <ext-link ext-link-type="uri" xlink:href="https://github.com/ChloeHJ/diffSeqPatterns">https://github.com/ChloeHJ/diffSeqPatterns</ext-link> [<xref ref-type="bibr" rid="CR60">60</xref>].</p>
    </sec>
    <sec id="Sec13">
      <title>Deep learning models for pathogenic and self-epitope prediction</title>
      <p id="Par57">The peptide sequences at contact positions, i.e. P3-P8 of 9aa and P3-P9 of 10aa peptides, were encoded either by one-hot-encoding having dimension [m, 7, 21], amino acid descriptors [m, 7, 49] or amino acid embeddings from protein transformer-based pre-trained language models (PLMs) [m, 7, 1024], where m represents the number of peptides. The amino acid descriptors included kideraFactors, tScales, protFP, BLOSUM, stScales and MSWHIM captured by ‘aaDescriptors’ function from R Peptides v2.4.4 package, and Atchley factors from ‘AAMetric.Atchley’ function in R HDMD v1.2 package. In addition, amino acids were embedded using five protein transformer-based PLMs, including prot_t5_xl_uniref50, prot_bert, prot_bert_bfd and prot_t5_xl_bfd, prot_xlnet from Rostlab using Tokenizer and EncoderModel functions from python transformers v4.19.0 package. These models are based on T5 or BERT and were pre-trained on a large corpus of protein sentences, e.g. UniRef50, a dataset consisting of 45 million protein sequences, in a semi-supervised fashion. Further details about transformer-based PLMs can be found in <ext-link ext-link-type="uri" xlink:href="https://huggingface.com/Rostlab">https://huggingface.com/Rostlab</ext-link>.</p>
      <p id="Par58">To account for peptides of varying lengths, the peptides coming from 9aa peptides were padded (i.e. adding non-relevant number to the borders of the matrix) either in the front (i.e. pre-padding) or at the back (i.e. post-padding). First, we computed all possible n-grams from 6- and 7-mer peptides and analysed if the same n-grams were present in both 6- and 7-mers. We found that many n-grams were present in both 6- and 7-mers. We then aligned by their respective positions and observed that many 3-g located in P3-P5 of 9aa peptides were positioned at P4-P6 of 10aa peptides, indicating padding in front of 6-mer peptide (i.e. pre-padding) would align with hotspots in 7-mers.</p>
      <p id="Par59">The classification accuracies of different deep learning architectures were compared between simple dense layer (i.e. classification), biRNN, biLSTM, 1D CNN, 2D CNN and transformer models. The biRNN model contained two biRNN layers each having 512 units, followed by a dense layer of 256 units and a classification layer with dropouts in-between. The biLSTM model had the same structure as the biRNN model, but LSTM cell is used instead of the RNN cell. 2D CNN model had two Conv2D layers, with filters = 16 and 32 respectively, followed by MaxPool2D, Flatten, a dense layer of 256 units and a classification layer with dropouts in-between. The transformer model for pathogenic and self-antigen data had 10 and 2 attention heads respectively and 32 hidden layers in a feed forward network, followed by GlobalAveragePooling1D, dense layer with 128 units and classification, with dropouts in-between. The 1D CNN had kernel sizes 1, 3, 5 and 7, each max pooled and concatenated to a layer. In parallel, − log transformed NetMHCpan rank and hydrophobicity (i.e. the proportion of A, V, L, M, W) have been added as a MLP layer. 1D CNN and MLP layers were concatenated and put into a dense layer of 256 units followed by classification. The hyperparameters of the final 1D CNN models were optimised by grid search. The final hyperparameters for pathogenic model are as follows: learning rate = 1e − 05, weight decay = 1e − 06, dropout rate = 0.1, batch size = 50, dense layer node = 2000 and dense layer node = 256, giving ROC-AUC of 0.764 by 10-fold cross-validation. The final hyperparameters for self-antigen model are as follows: learning rate = 0.001, weight decay = 0.01, dropout rate = 0.2, batch size = 100, MLP dense = 1500 and dense layer node = 512, giving ROC-AUC of 0.943 by 10-fold cross-validation. All deep learning architectures are implemented using python TensorFlow v2.8.0 package.</p>
    </sec>
    <sec id="Sec14">
      <title>Out of distribution (OOD) detection</title>
      <p id="Par60">The out-of-distribution was defined as test samples having different properties from the training data, and thus cannot be predicted with high accuracy. We found that one of the significant sources of out-of-distribution is the origin of the peptides, i.e. pathogenic vs. self-antigen or different pathogenic organisms, and that peptides originating from species not well represented in the training data have lower predictive accuracy. Given the limited number of biologically homogeneous (i.e. in-domain) peptide as well as technical variation coming from different T-cell assays, experimental setups and laboratories, it was difficult to collect enough peptides for in-domain analysis, so we used predictive accuracy as the proxy to build OOD classifier, trained to classify correctly vs. incorrectly predicted peptides.</p>
      <p id="Par61">Autoencoder is a type of unsupervised neural network that have a smaller number of neurons in the hidden layers than the input layer. This allows the architecture to extract essential information from the input layer, preserve in lower-dimension and employ to reconstruct output. We used the difference between the input and reconstructed output (i.e. reconstruction loss) as a metric for anomaly detection, as autoencoders cannot effectively reconstruct patterns not learnt from training data [<xref ref-type="bibr" rid="CR61">61</xref>].</p>
      <p id="Par62">For anomaly detection, peptides encoded by prot_t5_xl_uniref50 transformer-based PLM were applied onto 2D and 3D autoencoders, variational autoencoder and denoising autoencoder models, using ‘AutoEncoder’ function from python pyod v1.0.1 package. The autoencoder models were trained using 90% random train and non-SARS-CoV-2 data and were used to predict 10% test and SARS-CoV-2 data respectively. Then, we computed reconstruction loss between original and predicted test values.</p>
      <p id="Par63">For calibration methods, the 1D CNN model was trained using softmax activation function. We then computed maximum softmax probability (MaxProb) and temperature-scaled softmax probability (T = 2) for each test peptide. The MaxProb is the maximum softmax probability between class 0 (Negative) and 1 (Positive) classes. The temperature scaling softens the softmax probability with T &gt; 1, making the network slightly less confident, reflecting the true probabilities [<xref ref-type="bibr" rid="CR62">62</xref>]. For Ensemble, we used 10-folds of the training dataset to generate 10 different models. These models were then used to predict test data points, producing prediction scores for each. We averaged softmax probabilities across 10 different models and computed MaxProb of the average. For Monte Carlo dropout (MCDropout), Monte Carlo models were reiterated 100 times with stochastic dropout of 0.6. The softmax probabilities were averaged across 100 scores, and MaxProb was generated from them.</p>
      <p id="Par64">The final OOD classifier predicts correct vs. incorrect predictions by using MCDropout, which have been shown to be more robust than maximum softmax probabilities (MSP). The MSP is often not suitable when overfitting is likely, as the values will either be 0 or 1, whereas MCDropout provides a better estimate of uncertainty by combining multiple confidence scores generated by many models and providing informative statistics (e.g. mean and variation of the confidence scores) as opposed to a single scalar value. We built linear regression model with MCDropout, using the ‘LinearRegression’ function from python sklearn v1.0.2 package.</p>
    </sec>
    <sec id="Sec15">
      <title>Relative Similarity to Autoantigens or Tumour-associated antigens (RSAT)</title>
      <p id="Par65">To compute RSAT, a total of 5023 unique cancer neoepitopes, autoantigens, tumour-associated antigens and other self-epitopes were retrieved from IEDB, dbPepNeo, NEPdb, McPAS-TCR and tumour antigenic peptide database. First, only pathogenic peptides having comparable self-epitope counterparts are retrained by computing Match score [<xref ref-type="bibr" rid="CR63">63</xref>] (5) between pathogenic peptides and self-epitopes, where BL represents the global–local alignment score using BLOSUM62 matrix, p represents pathogenic peptide and se self-epitopes. Only pathogenic peptides having a match score ≥ 0.6 are retained to compute RSAT.<disp-formula id="Equ5"><label>5</label><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Match\ score=\frac{BL\left(p, se\right)}{\sqrt{BL\left(p, se\right)\ *\ BL(p, se)}}$$\end{document}</tex-math><mml:math id="M10" display="block"><mml:mrow><mml:mi>M</mml:mi><mml:mi>a</mml:mi><mml:mi>t</mml:mi><mml:mi>c</mml:mi><mml:mi>h</mml:mi><mml:mspace width="4pt"/><mml:mi>s</mml:mi><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>B</mml:mi><mml:mi>L</mml:mi><mml:mfenced close=")" open="("><mml:mi>p</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi><mml:mi>e</mml:mi></mml:mfenced></mml:mrow><mml:msqrt><mml:mrow><mml:mi>B</mml:mi><mml:mi>L</mml:mi><mml:mfenced close=")" open="("><mml:mi>p</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi><mml:mi>e</mml:mi></mml:mfenced><mml:mspace width="4pt"/><mml:mrow/><mml:mo>∗</mml:mo><mml:mspace width="4pt"/><mml:mi>B</mml:mi><mml:mi>L</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>p</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi><mml:mi>e</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:msqrt></mml:mfrac></mml:mrow></mml:math><graphic xlink:href="13073_2023_1225_Article_Equ5.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par66">For pathogenic peptides having comparable self-epitope counterparts, RSAT was computed (6). First, we computed the maximum global–local alignment score between pathogenic peptides and AATs (a set of autoimmunity, allergy tor tumour-associated antigens) using the BLOSUM62 substitution matrix. Second, we computed the maximum global alignment score between pathogenic peptide and AAT’s best counterpart in human proteome. Third, we computed the ratio between alignment scores from self-epitope and human proteome counterpart. In the Eq. (<xref rid="Equ6" ref-type="disp-formula">6</xref>) below, p = pathogenic peptide, AAT = autoimmunity, allergy tor tumour-associated antigens, hp = human proteome.<disp-formula id="Equ6"><label>6</label><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$RSAT=\frac{BL\left(p, AATs\right)}{BL\left(p,hp\right)}$$\end{document}</tex-math><mml:math id="M12" display="block"><mml:mrow><mml:mi>R</mml:mi><mml:mi>S</mml:mi><mml:mi>A</mml:mi><mml:mi>T</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>B</mml:mi><mml:mi>L</mml:mi><mml:mfenced close=")" open="("><mml:mi>p</mml:mi><mml:mo>,</mml:mo><mml:mi>A</mml:mi><mml:mi>A</mml:mi><mml:mi>T</mml:mi><mml:mi>s</mml:mi></mml:mfenced></mml:mrow><mml:mrow><mml:mi>B</mml:mi><mml:mi>L</mml:mi><mml:mfenced close=")" open="("><mml:mi>p</mml:mi><mml:mo>,</mml:mo><mml:mi>h</mml:mi><mml:mi>p</mml:mi></mml:mfenced></mml:mrow></mml:mfrac></mml:mrow></mml:math><graphic xlink:href="13073_2023_1225_Article_Equ6.gif" position="anchor"/></alternatives></disp-formula></p>
    </sec>
    <sec id="Sec16">
      <title>Application of TRAP to shortlisting glioblastoma neoantigens</title>
      <p id="Par67">In previous in-house study [<xref ref-type="bibr" rid="CR64">64</xref>], tumours of four HLA-A2 glioblastoma patients were sequenced and cancer neoepitopes were shortlisted using an in-house version of MuPeXI [<xref ref-type="bibr" rid="CR65">65</xref>] named TUNAPASTA v0.5. We then selected 153 predicted neoepitopes for functional T-cell assays, 33 of which were characterised Positive. From these 153 tested peptides, we filtered out predicted HLA*02:01 non-binders and retained 9–10 amino acid peptides that were applicable to TRAP. This left 124 GBM peptides, 25 of which were Positives and 99 Negatives. We used a pre-trained self-antigen TRAP model on this dataset to predict the immunogenicity of GBM peptides as well as the confidence of prediction by the OOD detection module. Because identifying cancer neoepitopes is thought to be a ‘needle in a haystack’ problem, we identified predicted Negatives with low-confidence prediction, and added 24 more candidates for validation, resulting in a ROC-AUC of 0.705.</p>
    </sec>
  </sec>
  <sec id="Sec17">
    <title>Results</title>
    <sec id="Sec18">
      <title>TRAP: a robust deep learning workflow to predict CD8 + T-cell recognition of MHC-I presented pathogenic and self-peptides</title>
      <p id="Par68">We present TRAP as a comprehensive workflow for predicting CD8 + T-cell immunogenicity of HLA-I presented pathogenic and self-peptides (Fig. <xref rid="Fig1" ref-type="fig">1</xref>A).<fig id="Fig1"><label>Fig. 1</label><caption><p>Schematic of TRAP workflow and cross-species variation in T-cell recognition features. <bold>A</bold> Schematic diagram of TRAP (T-cell recognition potential of HLA-I presented peptides), a robust deep learning-based workflow to predict CD8 + T-cell epitopes from MHC-I presented pathogenic or self-peptides. Once peptides have been predicted by NetMHCpan to bind HLA alleles, the TRAP uses the peptide sequence and NetMHCpan rank scores as inputs to predict the immunogenicity of the peptide with the respective HLA binding affinity. The TRAP workflow will output TRAP prediction score along with confidence in its prediction. If the prediction is detected to have a low confidence, we recommend predicting cancer neoepitopes using TESLA [<xref ref-type="bibr" rid="CR52">52</xref>], which is known to use more general features such as agretopicity and dissimilarity to self-proteome, and pathogenic peptides with RSAT (relative similarity to autoantigens or tumour-associated antigens). <bold>B</bold>, <bold>C</bold> Distribution of MHC binding rank scores predicted by NetMHCpan (<bold>B</bold>) and hydrophobicity (<bold>C</bold>) for peptides derived from different pathogenic species. CMV: cytomegalovirus; EBV: Epstein-Barr virus; HCV: hepatitis C virus; HBV: hepatitis B virus; SARS-2: SARS-CoV-2; VACV: vaccinia virus; YFV: yellow fever virus. <bold>D</bold> Statistics of peptides in cross-species dataset (i.e. non-vaccinia virus (non-VACV) peptides for training and VACV peptides for testing, non-SARS-CoV-2 (non-SARS2) peptides for training and SARS-2 peptides for testing), and data randomly divided into 90% train and 10% test, as a resemblance of 10-fold cross-validation. <bold>E</bold>, <bold>F</bold> Models trained using cross-species datasets could not effectively predict the immunogenicity of peptides derived from unseen pathogens. ROC-AUC curves of XGBOOST classifiers on training data by 10-fold cross-validations—on 90% data, non-SARS-2 and non-VACV peptides (<bold>E</bold>). ROC-AUC curves of XGBOOST classifiers on test datasets—10% data, SARS2 and VACV peptides (<bold>F</bold>). <bold>G</bold> Sequence logo of amino acids enriched in epitopes (Positive) compared to non-epitopes (Negative) in contact positions for randomly split data (i), SARS-2 data (ii) and vaccinia virus data (iii). <bold>H</bold>, <bold>I</bold> High performance may be a reflection of HLA bias. ROC curve of DeepImmuno algorithm on single HLA allele, for peptides bound on HLA-A*02:01 (<bold>H</bold>) or HLA-A*24:02 (<bold>I</bold>). <bold>J</bold> Performance of DeepImmuno algorithm on per-HLA down-sampled dataset, i.e. the number of peptides has been down</p></caption><graphic xlink:href="13073_2023_1225_Fig1_HTML" id="MO1"/></fig></p>
      <p id="Par69">In this workflow, peptide sequences of 9–10 amino acids in length are predicted to bind HLAs. The predicted HLA-I ligands are encoded using amino acid embeddings derived from protein transformer-based pre-trained language models (PLMs). TRAP then employs a 1D convolutional neural network to extract T-cell recognition motifs, which are then combined with MHC binding rank score and hydrophobicity to predict peptide immunogenicity. Following that, TRAP includes a linear regression classifier to detect low-confidence predictions to improve accuracy. The immunogenicity of pathogenic peptides with low-confidence predictions can be predicted using a novel metric called relative similarity to autoantigens or tumour-associated antigens (RSAT), which is developed as a complement to ‘dissimilarity to self’ from cancer studies.</p>
      <p id="Par70">TRAP has been developed as a user-friendly web application and is accessible from <ext-link ext-link-type="uri" xlink:href="https://github.com/ChloeHJ/TRAP">https://github.com/ChloeHJ/TRAP</ext-link> [<xref ref-type="bibr" rid="CR66">66</xref>]. Here, users can input their peptide list and select the model of interest (pathogenic or self-antigen), and the application will compute the prediction scores along with its confidence (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S1, Additional file <xref rid="MOESM2" ref-type="media">2</xref>). In the following sections, we will describe the rationales behind the model architecture and strategies for overcoming the current constraints and improving model performance.</p>
    </sec>
    <sec id="Sec19">
      <title>Out-of-distribution uncertainty and HLA bias result in poor performance</title>
      <p id="Par71">We previously reported that the existing immunogenicity algorithms showed suboptimal performance in predicting epitopes from both cancer and an emerging viral pathogen [<xref ref-type="bibr" rid="CR7">7</xref>]. We then attributed the poor performance to divergent discriminative features between cancer neoepitopes and pathogenic epitopes in directionality or magnitudes [<xref ref-type="bibr" rid="CR7">7</xref>, <xref ref-type="bibr" rid="CR23">23</xref>].</p>
      <p id="Par72">Here, we investigated additional sources of suboptimal performance to aid in the development of accurate, robust and biologically meaningful classifiers. We retrieved peptides of lengths 9–10aa, characterised by T-cell assays from IEDB and retained predicted MHC binder from NetMHCpan 4.0, resulting in 5093 immunogenic (‘Positive’) and 6628 non-immunogenic (‘Negative’) peptides (named PeptideTcell data, ‘<xref rid="Sec4" ref-type="sec">Methods</xref>’) (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S2A). Notably, no peptides may be considered truly non-immunogenic as they may be recognised by at least one TCR in the repertoire under the right physiological conditions. However, there is a continuum of immunogenicity potential where some peptides are likely to trigger greater T-cell response and/or are able to bind numerous TCRs. Therefore, we designated the ‘Negatives’ as peptides with very low putative immunogenicity potential, defined as peptides characterised negative in more than three T-cell assays.</p>
      <p id="Par73">First, we evaluated the extent to which known hallmarks of immunogenicity, such as MHC binding affinity [<xref ref-type="bibr" rid="CR12">12</xref>, <xref ref-type="bibr" rid="CR16">16</xref>] and percentage of hydrophobic amino acids in peptide sequence [<xref ref-type="bibr" rid="CR20">20</xref>], can be used to identify immunogenic peptides from different species. Notably, these features have been used as predictors in models such as TESLA [<xref ref-type="bibr" rid="CR8">8</xref>], iPred [<xref ref-type="bibr" rid="CR17">17</xref>], NetTepi [<xref ref-type="bibr" rid="CR16">16</xref>] and GAO [<xref ref-type="bibr" rid="CR67">67</xref>]. Although two features could effectively distinguish epitopes from non-epitopes at a macroscopic level, where epitopes had higher MHC binding rank (− log transformed) and hydrophobicity with medium effect sizes (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S2B-C), they no longer showed statistical significance at the species level (Fig. <xref rid="Fig1" ref-type="fig">1</xref>B,C), which was caused in part by the small sample size. For example, hydrophobicity alone could not discriminate SARS-CoV-2 epitopes from non-epitopes.</p>
      <p id="Par74">Second, we assessed the extent to which cross-species peptides (i.e. peptides derived from other species) can predict epitopes of unseen pathogens. We divided PeptideTcell data randomly or in a cross-species manner: (i) random split to 90% train vs. 10% test (i.e. representation of 10-fold cross-validation), or (ii) cross-species split to Non-SARS-CoV-2 (Non-SARS-2) train vs. SARS-2 test, and Non-vaccinia virus (Non-VACV) train vs. VACV test (Fig. <xref rid="Fig1" ref-type="fig">1</xref>D). We then compared the performance of XGBOOST classifiers on these datasets (‘<xref rid="Sec4" ref-type="sec">Methods</xref>’). While no substantial difference was observed during training (Fig. <xref rid="Fig1" ref-type="fig">1</xref>E), the cross-species model showed lower accuracy and higher root mean squared error (RMSE) on test datasets (Fig. <xref rid="Fig1" ref-type="fig">1</xref>F). This implied that cross-species peptides may not share common features in predicting immunogenicity (i.e. predictive features in training and test data are likely to be different which is known as an out-of-distribution generalisation problem), resulting in limited accuracy on unseen pathogens.</p>
      <p id="Par75">To support this, we generated differential position-specific scoring matrices (dPSSMs) to compare immunogenicity-related sequence patterns between train and test datasets (‘<xref rid="Sec4" ref-type="sec">Methods</xref>’). While random split data shared similar patterns between train and test datasets, such as enrichment of L, G/E, G, hydrophobic resides and T on P3-P8 (Fig. <xref rid="Fig1" ref-type="fig">1</xref>Gi), cross-species data showed low homology (Fig. <xref rid="Fig1" ref-type="fig">1</xref>Gii-iii), and dPSSM scores failed to predict immunogenicity on cross-species test datasets (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S2D, ‘<xref rid="Sec4" ref-type="sec">Methods</xref>’).</p>
      <p id="Par76">Third, we observed that high reported performance from the latest models incorporating peptide-HLA pairs might be driven by HLA bias from an imbalanced dataset. Recently, deep learning models incorporating peptide-HLA pairs reported ROC-AUC of ~ 0.85 by 10-fold cross-validation [<xref ref-type="bibr" rid="CR15">15</xref>] (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S2E-F). While they reported the highest accuracy to date, we observed poor performance on SARS-CoV-2 peptides in our benchmarking study [<xref ref-type="bibr" rid="CR7">7</xref>]. Here, we hypothesised that this poor agreement may be due to differences in datasets and investigated the cause of disagreement.</p>
      <p id="Par77">First, we evaluated the ability of the model to discriminate Positive vs. Negative bound on the same HLA allele. We trained and tested models in single HLA level on HLA-A*02:01 and HLA-A*24:02, which had the highest numbers of characterised peptides per HLA. We then compared them to the model trained using the same number of randomly sampled pMHCs (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S2G). Here, the model showed marginally better than random performance on the balanced HLA-A*02:01 dataset (Fig. <xref rid="Fig1" ref-type="fig">1</xref>H), and high variation on the relatively imbalanced and smaller HLA-A*24:02 dataset (Fig. <xref rid="Fig1" ref-type="fig">1</xref>I). We further found that HLA-balanced data substantially reduces classifier performance (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S2H, Fig. <xref rid="Fig1" ref-type="fig">1</xref>J), suggesting that current models are skewed towards classifying for certain over- or under-represented HLA alleles and their reported performance does not reflect their real-world accuracy.</p>
    </sec>
    <sec id="Sec20">
      <title>Mitigate HLA bias by employing peptide sequences at TCR contact positions</title>
      <p id="Par78">Previous studies reported the contribution of anchor positions (i.e. position 2 (P2) and P9 of 9aa peptide) for MHC binding [<xref ref-type="bibr" rid="CR68">68</xref>] and contact positions (i.e. P3-P8) in T-cell recognition [<xref ref-type="bibr" rid="CR13">13</xref>]. Correspondingly, HLA supertypes drove the clustering of peptides at anchor positions (Fig. <xref rid="Fig2" ref-type="fig">2</xref>A) and TCR specificities at contact positions (Fig. <xref rid="Fig2" ref-type="fig">2</xref>B,C, Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S3A-B) on our data, with peptides bound by the same TCR showing conserved motifs (Fig. <xref rid="Fig2" ref-type="fig">2</xref>D). However, because of the strong conserved pattern in anchor positions, the HLA supertype not only drove the clustering of peptides at anchor positions but also acted as the strongest covariate driving the clustering of peptides in full sequence (Fig. <xref rid="Fig2" ref-type="fig">2</xref>E, Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S3C). With such a strong conserved pattern, MHC binding features may dominate immunogenicity predictions when the full peptide sequence is used for model training. In fact, we observed that some of the existing immunogenicity classifiers were more capable of predicting dominant HLA type (i.e. whether peptides were bound to HLA-A*02:01 or not) than peptide immunogenicity [<xref ref-type="bibr" rid="CR7">7</xref>]. As we aimed to predict T-cell recognition potential once peptides are bound to HLA alleles, we incorporated contact positions only, i.e. positions 3–8 (P3-P8) of 9aa peptide and P3-P9 of 10aa peptides, not only to focus on T-cell recognition patterns, but also to rule out the need to balance the number of epitopes vs. non-epitopes by the HLA supertypes for model development.<fig id="Fig2"><label>Fig. 2</label><caption><p>Effect of anchor and contact positions on peptide immunogenicity. <bold>A</bold> t-SNE embedding of peptides, coloured by HLA supertypes. Peptides at anchor positions (i.e. P2 and P9 of 9aa peptides) were represented by amino acid descriptors (aaDescriptors) and all amino acids across the peptide sequence were averaged to compute peptide-wide aaDescriptors. Each peptide was represented by positional (only at anchor positions) and peptide-wide aaDescriptors. <bold>B</bold>, <bold>C</bold> t-SNE embedding of peptide-wide descriptors and amino acids at contact positions, coloured by cognate TCRs for 9aa peptides (<bold>B</bold>) and 10aa peptides (<bold>C</bold>). <bold>D</bold> Sequence logos of peptides recognised by the same TCR, coloured by the physicochemical properties. Notably, these are examples of TCRs having the most cognate peptides in the database. However, except for the first TCR, the low number of peptides may limit statistical confidence in representing sequence conservation. <bold>E</bold> t-SNE embeddings of peptide-wide descriptors and amino acids at all positions, coloured by HLA supertype (left), immunogenicity (middle) and species of origin (right). <bold>F</bold> Distribution of intra-HLA and inter-HLA variation for peptides having different peptide-HLA entries. The variation described by ANOVA means squared</p></caption><graphic xlink:href="13073_2023_1225_Fig2_HTML" id="MO2"/></fig></p>
      <p id="Par79">To take such an approach, we first investigated whether neglecting HLA information would not result in a significant loss of information when predicting T-cell recognition potential of MHC-presented peptides from the current dataset. First, a novel metric was developed for converting qualitative measurements (i.e. Positive or Negative) to a quantitative ‘positivity score’ that reflects confidence in the immunogenicity (‘<xref rid="Sec4" ref-type="sec">Methods</xref>’). Briefly, the metric took into account (a) the number of experiments conducted (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S4A), (b) the percentage tested positive (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S4B) and (c) the number of cognate TCRs where available (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S4C) to compute the positivity score (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S4D).</p>
      <p id="Par80">Using the positivity scores of each peptide-HLA entry, the extent of inter-HLA variation (i.e. variation across different HLA alleles) was compared to intra-HLA variation (i.e. variation within the same HLA allele) for peptides bound on multiple HLA alleles. The intra-HLA variation accounted for the majority of data variability, while inter-HLA variation contributed less (Fig. <xref rid="Fig2" ref-type="fig">2</xref>F). This is because other biological (e.g. different effector cell, antigen presenting cells etc.) or technical (e.g. assay type, culture conditions, research groups etc.) factors were causing greater discrepancies in positivity score than HLA alleles (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S4E-F). This implied that when it came to each peptide, there was not much difference in the immunogenicity based on the HLAs to which it was bound, but when it came to HLAs, each HLA had a different pool of peptides, resulting in a different distribution of positive and negative peptides, resulting in HLA bias. As a result, an HLA-generalised approach was adopted in which peptide-HLA binding information was used instead of the HLA allele itself.</p>
    </sec>
    <sec id="Sec21">
      <title>Deep learning architecture captures T-cell recognition motifs</title>
      <p id="Par81">As the potential causes of poor performance, previous sections discussed limited training dataset, HLA bias and out-of-distribution (OOD) generalisation problem. These issues were addressed in TRAP by (a) using peptide sequence at contact positions, (b) building separate models for pathogenic and self-peptides, (c) encoding peptide sequences using amino acid properties derived from protein transformer-based pre-trained language models (PLMs), (d) devising one-dimensional convolutional neural network (1D CNN) architecture designed to capture T-cell recognition motifs and (e) employing OOD detection module. These novel strategies enabled TRAP to offer more accurate and reliable predictions of CD8 + T-cell targets against cancer and viral diseases.</p>
      <p id="Par82">First, pathogenic and self-antigen datasets were prepared to build context-specific models (‘<xref rid="Sec4" ref-type="sec">Methods</xref>’). Briefly, the pathogenic dataset is a subset of the PeptideTcell data, comprising only pathogen-derived peptides (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S5A). For the self-antigen dataset, autoantigens, tumour-associated antigens and cancer neoepitopes were retrieved from Cancer peptide database, dbPepNeo, IEDB, McPAS-TCR and NEPdb databases as epitopes, and benign HLA-I ligands expressed in thymus as non-epitopes (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S5B-C).</p>
      <p id="Par83">Given the lack of non-immunogenic self-peptides, we used HLA-I ligands expressed in the thymus as ‘non-immunogenic’ peptides in the self-antigen model. T-cells are selected within the thymus to establish a repertoire that is pathogen-protective but not self-reactive. While self-peptides are used in both positive and negative selections, we reasoned that self-peptides expressed in the thymus are unlikely to be immunogenic in the periphery for the following reasons. First, self-peptides will eliminate high-affinity or strong-response T-cells, leaving no repertoire to recognise these peptides [<xref ref-type="bibr" rid="CR69">69</xref>]. Second, while T-cells may recognise self-peptides through positive selection, it is theorised that the interactions are very weak and that once T-cells leave the thymus, they will not be able to induce an immune response to that same antigen due to the low affinity, but will instead react to another peptide that was not present in the thymus and has a higher affinity [<xref ref-type="bibr" rid="CR70">70</xref>, <xref ref-type="bibr" rid="CR71">71</xref>]. Hence, we reasoned that thymus-expressing peptides would not be immunogenic, either because they cause the elimination of strong-response T-cells or because they promote the retention of low-affinity T-cells, allowing the formation of a T-cell repertoire that avoids self-reactivity in general. To our knowledge, this is the first study to use the concept of thymic selection in classifying self-epitopes from non-epitopes.</p>
      <p id="Par84">Second, because peptides vary in lengths, we investigated the optimal padding strategy for aligning 6-mer with 7-mer contact position peptides. The predictive accuracies of simple dense layer classification, 1D CNN, 2D CNN and bidirectional recurrent neural network (biRNN) models were evaluated using pre- and post-padding strategies. No significant difference was observed across pathogenic and self-antigen data, with pre-padding achieving slightly better performance in self-antigen data on the BiRNN model (Fig. <xref rid="Fig3" ref-type="fig">3</xref>A). Furthermore, the relative location of k-gram motifs was compared on 6-mer and 7-mer peptides, and many 3-g motifs found at P3 of the 9aa peptide were found at P4 of the 10aa peptide (Fig. <xref rid="Fig3" ref-type="fig">3</xref>B). Therefore, to align T-cell recognition hotspots with biological context, peptides of shorter length were pre-padded to align with longer peptides.<fig id="Fig3"><label>Fig. 3</label><caption><p>Optimise TRAP architecture. <bold>A</bold> Performance of pre- and post-padding strategies. ROC-AUC values of respective deep learning models with pre- vs. post-padding strategies for pathogenic (i) and self-antigens (ii). Each point represents the ROC-AUC value from one round of 10-fold cross-validations. <bold>B</bold> Example of n-grams found in both 9aa and 10aa peptides, coloured by the start position of the respective n-gram in the peptides. <bold>C</bold> Comparing amino acid embedding strategies. ROC-AUC values of a single dense classification prediction using different encoding strategies, including one-hot encoding (OHE), amino acid descriptors (aaDescriptors) and embeddings from protein transformer-based PLMs on pathogenic peptides (i) and self-antigens (ii). Each point represents the ROC-AUC value from one round of 10-fold cross-validations. <bold>D</bold> Comparing the performance of different deep learning architectures. ROC-AUC values comparing the performance of different machine learning and deep learning architectures using embeddings from 5 protein transformer-based PLMs for pathogenic (i) and self-peptides (ii). XGBOOST: an extreme gradient boosting. BiRNN: bidirectional recurrent neural network. BiLSTM: bidirectional Long short-term memory. 1DCNN: 1-dimensional convolutional neural network. 2DCNN: 2-dimensional CNN. Each point represents ROC-AUC value from one round of 10-fold cross-validations. <bold>E</bold> Schematic diagram of the model incorporating MHC binding and hydrophobicity. <bold>F</bold> Adding hallmarks of the immunogenicity. ROC curve comparing the performance of models after adding MHC binding rank score and/or hydrophobicity to peptide sequence-based 1D CNN model for pathogenic (i) and self-peptides (ii)</p></caption><graphic xlink:href="13073_2023_1225_Fig3_HTML" id="MO3"/></fig></p>
      <p id="Par85">Third, to address data limitation, we adopted transfer learning to encode peptides using amino acid properties derived from protein transformer-based pre-trained language models (PLMs). The protein transformer-based PLMs were trained using millions to billions of protein sequences and carry the most representative 1024 embeddings, which describe the physicochemical, structural or electrostatic properties of amino acids in protein space [<xref ref-type="bibr" rid="CR33">33</xref>]. The performance of classification models were compared when peptides were encoded by one-hot-encoding (OHE), amino acid descriptors and embeddings from five protein transformer-based PLMs (‘<xref rid="Sec4" ref-type="sec">Methods</xref>’). ProtT5-XL-UniRef showed the highest performance, with an average ROC-AUC of 0.72 for pathogenic (Fig. <xref rid="Fig3" ref-type="fig">3</xref>Ci) and 0.724 for self-antigen datasets (Fig. <xref rid="Fig3" ref-type="fig">3</xref>Cii).</p>
      <p id="Par86">Fourth, the capability of different machine learning and deep learning architectures to classify immunogenicity potential was assessed. The performances of XGBOOST, BiRNN, bidirectional long short-term memory (BiLSTM), 1D CNN, 2D CNN and transformer models were compared. Briefly, RNNs or LSTMs are popular sequential models efficient in addressing sequential text data [<xref ref-type="bibr" rid="CR72">72</xref>], whereas CNNs are suitable for scanning across text or images and detecting local patterns by using ‘kernels’. 1D CNNs have widely been used for text and 2Ds for image classifications [<xref ref-type="bibr" rid="CR73">73</xref>]. The 1D CNN model using ProtT5-XL-UniRef embeddings achieved the highest average ROC-AUC of 0.74 for pathogenic (Fig. <xref rid="Fig3" ref-type="fig">3</xref>Di) and 0.75 for self-antigens (Fig. <xref rid="Fig3" ref-type="fig">3</xref>Dii). We surmised that T-cell recognition motifs captured by the 1D CNN model have more predictive power than sequential relationship captured by the RNN-based models.</p>
      <p id="Par87">In addition to peptide sequences, we examined whether incorporating other hallmarks of immunogenicity, such as predicted MHC binding rank score [<xref ref-type="bibr" rid="CR12">12</xref>, <xref ref-type="bibr" rid="CR16">16</xref>] and hydrophobicity [<xref ref-type="bibr" rid="CR20">20</xref>], can further improve the performance. Particularly, given that the current model only takes contact positions into account, adding MHC binding rank would allow the model to accommodate peptide-MHC binding information. This strategy has several advantages. First, it feeds the binding information with a minimal HLA-associated bias, circumventing the need to balance the training data by HLAs. Second, the most accurate binding information from NetMHCpan prediction can be incorporated without having to re-train the model using a massive peptide-HLA binding data. By integrating MHC binding rank and hydrophobicity as fully connected layers (i.e. Multilayer perceptrons, MLPs) and optimising hyperparameters (Fig. <xref rid="Fig3" ref-type="fig">3</xref>E, ‘<xref rid="Sec4" ref-type="sec">Methods</xref>’), performance was improved to an average ROC-AUC of 0.76 for pathogenic (Fig. <xref rid="Fig3" ref-type="fig">3</xref>Fi) and 0.87 for self-antigens (Fig. <xref rid="Fig3" ref-type="fig">3</xref>Fii). It is worth noting that, in comparison to the pathogenic model, the number of self-epitopes is limited, and the additional MHC rank filter significantly reduced the training dataset. Therefore, we trained another self-antigen model with a relaxed threshold (MHC rank = 10 instead of 2) to account for as many self-epitopes as possible, resulting a training dataset of 12,521 peptides for accurate extraction of differential sequence patterns (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S5D).</p>
      <p id="Par88">Therefore, representing peptide sequences at contact positions by ProtT5-XL-UniRef amino acid embeddings, extracting T-cell recognition motifs by 1D CNN kernels, and adding MHC binding rank and hydrophobicity as MLPs could effectively achieve superior performance in classifying immunogenicity.</p>
    </sec>
    <sec id="Sec22">
      <title>Sequence patterns discriminating immunogenicity</title>
      <p id="Par89">Among different architectures, the 1D CNN model that captures local motifs achieved the best performance. Moreover, extensive screening of pMHC library against a single TCR revealed dominant hotspots or motifs in the cognate peptides [<xref ref-type="bibr" rid="CR74">74</xref>, <xref ref-type="bibr" rid="CR75">75</xref>]. We therefore set out to expand this observation and explore the enrichment of n-grams (i.e. contiguous sequence of n-amino acids) [<xref ref-type="bibr" rid="CR76">76</xref>] and position-specific k-mer motifs (i.e. contiguous or non-contiguous sequence of k amino acids at specific positions) in contact residues of pathogenic and self-peptides.</p>
      <p id="Par90">We first computed the ratio (in normalised frequency) of n-gram or positions-specific k-mer motifs between epitopes and non-epitopes (‘<xref rid="Sec4" ref-type="sec">Methods</xref>’). The top-ranking n-grams were GIG, GINA, GIF, LGIN, VEG and SGSP for pathogenic epitopes and SC, GIGI, IC, QC and CA for self-epitopes (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S6C). In addition, top position-specific k-mer motifs were.EG.L.,.E.IL. and.GIG… for pathogenic epitopes and GIG..,..M.P.,.G.GI.., and AGI…. for self-epitopes (Additional files <xref rid="MOESM4" ref-type="media">4</xref> and <xref rid="MOESM5" ref-type="media">5</xref>). Notably, GIG, which was previously associated with DMF5 TCR, was one of the top n-grams and position-specific k-mer motifs.</p>
      <p id="Par91">To identify sequence patterns enriched in both pathogenic and self-epitopes, we compared n-grams and position-specific k-mer motifs from each analysis. The 48 n-grams and total 298 position-specific k-mer motifs from 9 and 10aa peptides (Fig. <xref rid="Fig4" ref-type="fig">4</xref>A) were shared between pathogenic and self-epitopes. These include GIG, GINA, GMP, ALGI and APTG n-grams (Fig. <xref rid="Fig4" ref-type="fig">4</xref>B, Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S6D), and ….VP, W..P..,.G.GI.., and.GIG… position-specific k-mer motifs (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S6E-G).<fig id="Fig4"><label>Fig. 4</label><caption><p>Out-of-distribution detection using calibration methods. <bold>A</bold> Identifying motifs that are enriched in both pathogenic and self-epitopes. Venn diagram comparing the enriched n-grams (left) or position-specific k-mer motifs from 9aa (middle) or 10aa peptides (right) between pathogenic and self-peptides. <bold>B</bold> Normalised enrichment ratio of shared n-grams enriched in both pathogenic and self-epitopes. <bold>C</bold> Clusters of peptides with high sequence similarity in contact positions, demonstrated by pairwise global alignment scores. Network graph illustrating the pairwise global alignment score between 9aa pathogenic peptides. Shown are peptides having ≥ 22 alignment scores with ≥ 3 other peptides. <bold>D</bold>–<bold>G</bold> Distribution of different calibration-based metrics on pathogenic (i) and self-(ii) peptides, discriminating correctly vs. incorrectly predicted peptides. The calibration-based metrics include maximum softmax probability (MaxProb) (<bold>D</bold>), temperature scaling using different levels of temperatures that scale the logit values (<bold>E</bold>), the maximum on average softmax probability over 10 ensembled models (MaxProb on Avg) (<bold>F</bold>) and maximum on average softmax probability from Monte Carlo dropout iterations (<bold>G</bold>). The Monte Carlo models were reiterated 100 times with stochastic dropouts of 0.6. T: temperature. Statistical significance by <italic>p</italic>-values from Student’s <italic>t</italic> test. ns: non-significant. <bold>H</bold> Venn diagram comparing the pathogenic peptide predictions using different calibration metrics. MCDropout: Monte Carlo Dropout. I. ROC curve illustrating the performance of the out-of-distribution (OOD) linear regression classifiers using MCDropout on pathogenic (i) and self-peptides (ii)</p></caption><graphic xlink:href="13073_2023_1225_Fig4_HTML" id="MO4"/></fig></p>
      <p id="Par92">Furthermore, we computed pairwise global alignment scores across pathogenic peptides to identify clusters of epitopes sharing high sequence homology (‘<xref rid="Sec4" ref-type="sec">Methods</xref>’). Plotting highly similar peptides revealed clusters dominated by Positive peptides (Fig. <xref rid="Fig4" ref-type="fig">4</xref>C). These clusters contained peptides having patterns, such as YNTI… FG(Y/F)PV(F/Y). F(E/D)(K/R)S.., G.GW...DR.WC, GPG.R.P, P.DFFP.,.GIGI..,.DRGM., VALG.NA. and.LGLNA (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S5H-I).</p>
      <p id="Par93">Our analyses therefore suggest that TCR contact positions of immunogenic peptides exhibit preferences towards presenting certain motifs while disfavouring others. We also observed similarities and differences between pathogenic and self-peptides. The toolkits for analysing differential sequence patterns between peptides of the same length are developed as a R diffSeqPatterns package. We believe these shortlisted sequence patterns can be target for functional validations in identifying immune hotspots.</p>
    </sec>
    <sec id="Sec23">
      <title>Detect low-confidence predictions to improve robustness</title>
      <p id="Par94">While the DNN models could achieve higher accuracies than existing models, they are nonetheless far from making a perfect prediction. Partially due to the limited number of peptides characterised to fill the full combinatorial peptide space, the performance of sequence-based model drops substantially in predicting peptides non-homologous to those of training data, called the out-of-distribution (OOD) generalisation problem [<xref ref-type="bibr" rid="CR43">43</xref>]. In contexts where incorrect predictions can have severe consequences such as in healthcare or security, using model uncertainty to decide when to trust or abstain the prediction can facilitate rejecting false predictions and improving model accuracy.</p>
      <p id="Par95">There are generally two types of OODs: background shift (i.e. a shift in population-level features that do not depend on classification labels) and semantic shift (i.e. a shift in features that are correlated with the context and label) [<xref ref-type="bibr" rid="CR45">45</xref>]. In previous NLP studies, density or proximity-based models were found to be better at detecting background shifts, while calibration methods (i.e. using model’s prediction confidence) performed better at semantic shifts. In our study, the greatest OOD came from peptides originating from different species that have moderately different features associated with immunogenicity (i.e. semantic features). This aligns with previous findings that the majority of OOD stems from the semantic shift and thus calibration methods generally outperform proximity-based methods (i.e. autoencoder reconstruction) [<xref ref-type="bibr" rid="CR45">45</xref>].</p>
      <p id="Par96">Here, several OOD detection methods were tested to detect low-confidence predictions. Different autoencoder architectures, which are often used for anomaly detection, were first investigated [<xref ref-type="bibr" rid="CR61">61</xref>] (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S7A-F, ‘<xref rid="Sec4" ref-type="sec">Methods</xref>’). However, we observed no significant difference in reconstruction loss between correctly and incorrectly predicted peptides, implying that the autoencoder-based methods cannot effectively identify OOD inputs.</p>
      <p id="Par97">Therefore, calibration methods such as maximum softmax probability (MaxProb), temperature scaling, MaxProb from averaged softmax probability from ensemble of 10 models (called Ensemble) and MaxProb from averaged softmax probability from 100 Monte Carlo dropouts (called MCDropout) were tested, because they were reported to effectively detect semantic shifts (‘<xref rid="Sec4" ref-type="sec">Methods</xref>’). We observed that all four methods could significantly differentiate correct vs. incorrect predictions for both pathogenic and self-antigens (Fig. <xref rid="Fig4" ref-type="fig">4</xref>D–G). We also observed that these metrics produce similar profile of correctly and incorrectly predicted peptides (Fig. <xref rid="Fig4" ref-type="fig">4</xref>H, Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S7H). Therefore, we trained a linear regression model on MCDropout, which proved to be the most robust on cross-species dataset (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S7G, Method). The linear regression models could achieve average ROC-AUC of 0.65 for pathogenic and 0.82 for self-antigens (F <xref rid="Fig4" ref-type="fig">i</xref>g. <xref rid="Fig4" ref-type="fig">4</xref>I). With these, a MCDropout-based OOD detection module was introduced downstream of 1D CNN model prediction to report peptides that are likely to have a correct prediction.</p>
    </sec>
    <sec id="Sec24">
      <title>Relative Similarity to Autoantigens or Tumour-associated antigens (RSAT) as a novel feature of pathogenic peptide immunogenicity</title>
      <p id="Par98">We and others [<xref ref-type="bibr" rid="CR23">23</xref>, <xref ref-type="bibr" rid="CR77">77</xref>] have shown that some of the highly predictive metrics found from cancer neoepitope studies, such as ‘dissimilarity to self’, may not be applicable to pathogenic peptides. To address this, we present an alternative solution, termed a relative similarity to autoantigens or tumour-associated antigens (RSAT), to estimate the immunogenicity potential of pathogenic peptides. For pathogenic peptides that suffer from low-confidence prediction, RSAT can provide an additional estimate of immunogenicity potential.</p>
      <p id="Par99">The ‘dissimilarity to self’ stems from the paradigm of negative selection where T-cells that bind strongly to self-peptides should have been negatively selected and thus no T-cell repertoire should be present to bind peptides homologous to self-proteome [<xref ref-type="bibr" rid="CR21">21</xref>, <xref ref-type="bibr" rid="CR22">22</xref>] (Fig. <xref rid="Fig5" ref-type="fig">5</xref>A). However, there is another side of the story where T-cells that have low or moderate binding to self-peptides should have been positively selected. In fact, recent studies attributed the inability of the immune system to recognise a large number of pathogenic peptides—most of which are highly dissimilar to human proteome—to the mechanism of positive selection where only T-cells bound by low or moderately binding self-peptides survive to trigger an immune response [<xref ref-type="bibr" rid="CR77">77</xref>]. Therefore, we hypothesised that pathogenic peptides homologous to immunogenic self-peptides, such as autoantigens or tumour-associated antigens, may be more likely to trigger an immune response, and assessed whether relative similarity to autoantigens or tumour-associated antigens compared to reference human proteome can be a predictor of immunogenicity for pathogenic peptides.<fig id="Fig5"><label>Fig. 5</label><caption><p>Relative similarity to autoantigens and tumour-associated antigens (RSAT). <bold>A</bold> Schematic of positive and negative selection of T-cells in thymus. <bold>B</bold> Number of self-peptides, such as cancer neoepitopes, autoantigens and tumour-associated antigens, retrieved from different databases. <bold>C</bold> Distribution of Match score between pathogenic peptides and best self-peptide counterparts. Contains the Cohen’s <italic>d</italic> value showing the effect sizes differentiating positives versus negatives as well as the number of positive and negative peptides in each species. Cohen’s <italic>d</italic> values describe effective sizes, which are small (<italic>d</italic> = 0.2), medium (<italic>d</italic> = 0.5) and large (0.8). <bold>D</bold> RSAT of pathogenic peptides that have comparable self-antigen counterparts (by match score ≥ 0.6). <bold>E</bold>, <bold>F</bold> RSAT can effectively discriminate pathogenic epitopes from non-epitopes of varying lengths and species. <bold>E</bold> Distribution of RSAT for pathogenic peptides having 9aa (left) and 10aa (right) in length. <bold>F</bold> RSAT of peptides derived from different pathogens</p></caption><graphic xlink:href="13073_2023_1225_Fig5_HTML" id="MO5"/></fig></p>
      <p id="Par100">To test our hypothesis, 5023 unique Autoimmunity, Allergy or Tumour-associated antigens (AATs) were retrieved from NEPdb [<xref ref-type="bibr" rid="CR52">52</xref>], dbPepNeo [<xref ref-type="bibr" rid="CR50">50</xref>], McPAS-TCR [<xref ref-type="bibr" rid="CR51">51</xref>], IEDB [<xref ref-type="bibr" rid="CR49">49</xref>] and cancer antigenic peptide database (<ext-link ext-link-type="uri" xlink:href="https://caped.icp.ucl.ac.be">https://caped.icp.ucl.ac.be</ext-link>) (Fig. <xref rid="Fig5" ref-type="fig">5</xref>B). We then computed the similarity between pathogenic peptides and AATs, and only retained pathogenic peptides having comparable AAT counterparts (‘<xref rid="Sec4" ref-type="sec">Methods</xref>’). On these pathogenic peptides, we then computed the similarity between pathogenic peptide and AAT’s closest human proteome counterparts, and the ratio between the two, i.e. <italic>r</italic>elative <italic>s</italic>imilarity of the pathogenic peptide to <italic>a</italic>utoantigens or <italic>t</italic>umour-associated antigens (named RSAT).</p>
      <p id="Par101">From pathogenic data, 346/3793 pathogenic epitopes and 295/6080 non-epitopes had comparable AAT counterparts by a threshold match score of 0.6 (Method, Fig. <xref rid="Fig5" ref-type="fig">5</xref>C). The RSAT was computed on these peptides and found a significant difference between epitopes vs. non-epitopes (Fig. <xref rid="Fig5" ref-type="fig">5</xref>D) across peptide lengths 9 and 10aa (Fig. <xref rid="Fig5" ref-type="fig">5</xref>E), and across different pathogenic species (Fig. <xref rid="Fig5" ref-type="fig">5</xref>F), indicating that RSAT could effectively classify peptides of varying lengths and pathogen species. Despite the fact that each species had a limited number of peptides, epitopes had higher RSAT values with low (SARS-CoV-2 and <italic>M. tuberculosis</italic>), medium (EBV) or high (HCV and vaccinia virus) effect sizes.</p>
      <p id="Par102">Here, we developed a novel metric, RSAT, to estimate the immune potential of pathogenic peptides based on relative similarity to known auto- or tumour-associated epitopes. We demonstrated that RSAT can effectively discriminate epitopes of different lengths and pathogens. The RSAT is available as a separate module in the TRAP GitHub repository and is recommended to be used in conjunction with TRAP when the pathogenic peptides have low prediction confidence. We appreciate that the low number of Autoimmunity, Allergy or Tumour-associated antigens (AATs) limits the use of RSAT on a broader range of peptides. However, we envision that as data becomes more abundant, RSAT can become more popular.</p>
    </sec>
    <sec id="Sec25">
      <title>Benchmark TRAP performance to state-of-the-art algorithms</title>
      <p id="Par103">The performance of TRAP was benchmarked against existing immunogenicity models, namely NetTepi, IEDB, PRIME, DeepImmuno and TESLA by 10-fold cross-validation on the same datasets (‘<xref rid="Sec4" ref-type="sec">Methods</xref>’). Due to the nature of the existing models, HLA-agnostic predictions were performed for IEDB, iPred, NetTepi PRIME and Repitope, and HLA-restrictive prediction for DeepImmuno. TRAP was able to make both HLA-agnostic and restrictive predictions by incorporating the peptide sequence at contact positions and MHC as a rank score. The HLA-restrictive prediction was made using HLA-balanced data where the number of epitopes and non-epitopes were balanced per HLA to validate their prediction irrespective of HLA-associated bias.</p>
      <p id="Par104">TRAP was the best self-antigen model, achieving ROC-AUC of 0.931 for HLA-agnostic and 0.703 for HLA-restrictive predictions (Fig. <xref rid="Fig6" ref-type="fig">6</xref>A, Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S8A). It was also one of the best pathogenic models, with ROC-AUC of 0.751 for HLA-agnostic and 0.709 for HLA-restrictive predictions (Fig. <xref rid="Fig6" ref-type="fig">6</xref>B, Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S8B).<fig id="Fig6"><label>Fig. 6</label><caption><p>Benchmark TRAP performance and use it to identify tumour antigens in glioblastoma. <bold>A</bold>, <bold>B</bold> ROC curve comparing the performance of TRAP with existing models, such as IEDB, iPred, NetTepi, PRIME, Repitope and DeepImmuno for self- (<bold>A</bold>) and pathogenic peptides (<bold>B</bold>). Due to the nature of these models, IEDB, iPred, NetTepi PRIME and Repitope were predicted in an HLA-agnostic manner (i.e. by peptide sequence only) (i), and DeepImmuno predicted in an HLA-restrictive manner (i.e. by peptide-HLA) using HLA-balanced data (ii). <bold>C</bold> ROC curve comparing the performance of TRAP and Repitope that have been trained using 1511 Non-Wuhan SARS-CoV-2 peptides by 10-fold cross-validations. <bold>D</bold> ROC curve comparing the performance of Non-Wuhan SARS-CoV-2 trained TRAP and Repitope models in predicting 66 Wuhan SARS-CoV-2 peptides. <bold>E</bold>–<bold>J</bold> Application of TRAP in identifying glioblastoma neoepitopes. <bold>E</bold> Confusion matrix of GBM cancer neoepitope prediction using self-antigen TRAP model in reference to T-cell assay readout. <bold>F</bold> ROC curve of TRAP performance on GBM dataset. <bold>G</bold> Distribution of MCDropout values for GBM peptides predicted to be non-immunogenic. <bold>H</bold> The proportion of GBM epitopes (Positive) and non-epitopes (Negatives) predicted Positive or Negative with high or low confidence based on MCDropout. The confidence has been determined by the self-antigen out-of-distribution linear regression classifier at threshold 0.76. I. ROC curve of TRAP performance taking confidence into account, in which peptides that were predicted Negative with low confidence were removed to be considered as the potential epitope candidates. <bold>J</bold> Confusion matrix of TRAP prediction after taking the confidence into account, in which peptides that were predicted Negative with low confidence were included as Positive</p></caption><graphic xlink:href="13073_2023_1225_Fig6_HTML" id="MO6"/></fig></p>
      <p id="Par105">While Repitope slightly outperformed TRAP in pathogenic datasets, the robustness of TRAP predictions was assessed on emerging pathogens. The coronavirus TRAP and Repitope models were trained using 1511 coronavirus peptides except Wuhan SARS-CoV-2 peptides (Fig. <xref rid="Fig6" ref-type="fig">6</xref>C), and then used to predict the immunogenicity of 66 Wuhan SARS-CoV-2 peptides (Fig. <xref rid="Fig6" ref-type="fig">6</xref>D). Given that they are derived from the same family, the coronavirus peptides in the training dataset would share high homology with those in the test dataset, and we aimed to demonstrate the model’s ability to make accurate predictions on homologous peptides in comparison to other models. We found that TRAP was better at extracting immunogenicity-related features from limited data of emerging pathogens, and translating them onto related species (Fig. <xref rid="Fig6" ref-type="fig">6</xref>D).</p>
      <p id="Par106">Therefore, TRAP can predict CD8 + T-cell epitopes in both HLA-agnostic and restrictive contexts, and performed better in both. The TRAP can also make accurate predictions about emerging pathogens and is suitable for shortlisting therapeutic candidates when data is limited.</p>
    </sec>
    <sec id="Sec26">
      <title>Application of TRAP to identify glioblastoma neoantigens</title>
      <p id="Par107">Here, we demonstrate how the TRAP can be used for identifying cancer neoepitopes from glioblastoma patients. We previously sequenced the tumours of four HLA-A2 glioblastoma patients and shortlisted the cancer neoepitopes by using an in-house version of MuPeXI [<xref ref-type="bibr" rid="CR65">65</xref>] codenamed TUNAPASTA v0.5. This method ranked peptides by the immunogenicity potential, taking into account NetMHCpan affinity, gene expression level, and mutant allele frequency. We then selected 153 predicted epitopes for functional validation, of which 33 were characterised positive by T-cell assay [<xref ref-type="bibr" rid="CR64">64</xref>]. With only a small proportion of the shortlisted candidates found to be positive, the other existing models showed comparable levels of performance, PR-AUC ranging from 0.201 to 0.437 in our benchmarking study [<xref ref-type="bibr" rid="CR7">7</xref>].</p>
      <p id="Par108">Of the 153 tested peptides, we filtered out predicted HLA-A*02:01 non-binders and retained 9–10 amino acids peptides that were applicable to TRAP. This left 124 GBM peptides, of which 25 were characterised to be immunogenic and 99 non-immunogenic by T-cell assays. Of these, TRAP predicted 9/25 epitopes to be Positives and 84/99 non-epitopes to be Negatives (Fig. <xref rid="Fig6" ref-type="fig">6</xref>E), yielding 0.75 accuracy with ROC-AUC of 0.684 (Fig. <xref rid="Fig6" ref-type="fig">6</xref>F).</p>
      <p id="Par109">Identifying cancer neoepitopes is typically regarded as a ‘needle in a haystack’ problem in which an extremely small number of positives are sought from vastly imbalanced data. In this scenario, minimising the loss of true Positives from the candidate list was regarded to be more important than maximising accuracy. Therefore, we examined the confidence of predictions using the out-of-distribution detection module (Fig. <xref rid="Fig6" ref-type="fig">6</xref>G) and found that many incorrectly predicted Negatives had low-confidence predictions (Fig. <xref rid="Fig6" ref-type="fig">6</xref>H). By adding them to the candidate list, 28 more glioblastoma antigens were predicted positive, yielding 16/25 epitopes (Fig. <xref rid="Fig6" ref-type="fig">6</xref>I) and ROC-AUC of 0.734 (Fig. <xref rid="Fig6" ref-type="fig">6</xref>J).</p>
      <p id="Par110">Here, we applied TRAP for shortlisting glioblastoma cancer neoepitopes and showed that TRAP not only outperforms existing algorithms but also allow optimising candidates to minimise loss of likely epitopes.</p>
    </sec>
  </sec>
  <sec id="Sec27">
    <title>Discussion</title>
    <p id="Par111">In this study, we present TRAP, a robust deep learning workflow for predicting CD8 + T-cell epitopes from MHC-I presented pathogenic and self-peptides. To address the current limitations, we used peptide sequences only at contact positions to avoid HLA bias caused by capturing dominant HLA binding features at anchor positions. Second, we built separate models for pathogenic and self-peptides to address the out-of-distribution generalisation problem. Third, to overcome data limitations, we encoded peptide sequences using amino acid properties derived from protein transformer-based pre-trained language models (PLMs). This enabled more information about the physicochemical, electrostatic or biophysical properties of amino acids to be fed into the system. Fourth, we captured T-cell recognition motifs using a one-dimensional convolutional neural network (1D CNN) architecture. Fifth, we added the MHC binding rank score predicted by the most accurate algorithm (NetMHCpan) to provide the information about MHC binding. Lastly, we devised an out-of-distribution detection module to abstain from low-confidence predictions for peptides that are very different from those in the training dataset. By taking these novel approaches, TRAP offers a more robust prediction compared to other machine learning algorithms.</p>
    <p id="Par112">Another metric proposed to estimate immunogenicity from cancer neoepitope studies was dissimilarity to self. However, the dissimilarity to self could not be applied to pathogenic peptides because pathogens have highly heterologous sequences compared to the human proteome. Therefore, a novel metric termed RSAT (relative similarity to autoantigens or tumour-associated antigens) was developed to estimate the immunogenicity of peptides from emerging pathogens. To compensate for the high dissimilarity between pathogenic and human proteomes, this metric compares the similarity of pathogenic peptides to the reference human proteome (‘healthy’) with respect to ‘immunogenic’ self-peptides such as autoantigens or tumour-associated antigens. This allowed the identification of pathogenic epitopes despite their sequence dissimilarity to the human proteome.</p>
    <p id="Par113">The application of TRAP was demonstrated by using it to identify cancer neoepitopes from glioblastoma patients. We showed that the out-of-distribution detection module is well-suited for the ‘needle in a haystack’ problem by identifying those predicted negative with low confidence. In another study, we used TRAP to investigate the immune escape potential of SARS-CoV-2 variants [<xref ref-type="bibr" rid="CR78">78</xref>]. By combining TRAP with in silico mutagenesis, we evaluated the extent to which all possible theoretical single point mutations can give rise to variants of concern and be detrimental to T-cell immunity. Based on the groundwork of this work, using models like TRAP to systematically evaluate the impact of mutations on the emergence of deleterious pathogens will be of great interest. Emerging pathogens have posed a significant threat in recent years, and new variants and pathogens are expected to rise in the coming years [<xref ref-type="bibr" rid="CR79">79</xref>]. It is therefore critical to surveil variants of concern and assess the immune escape potential of these variants. Furthermore, in order to accurately determine deleterious variants, it is essential to assess the extent to which models trained by other pathogens can be generalised and thus used for emerging pathogens. Thus, an iterative process of refining the training data, model architecture and validating predictions should be followed to mitigate the impact of another pandemic.</p>
    <p id="Par114">For the self-antigen model, the autoantigens, tumour-associated antigens and cancer neoepitopes were collected as epitopes, and benign HLA-I ligands expressed in thymus as non-epitopes. We assumed that HLA-I ligands expressed in the thymus are involved in the selection of T-cells, and thus there is either no repertoire recognising these peptides or have weak interaction with the peptides. Notably, our novel approach of incorporating the HLA-I ligands allowed for a clearer separation of self-epitopes versus non-epitopes. When the data is limited, biological knowledge, such as thymic selection, can serve as a useful resource to bridge the data gap, and aid in the development of a more accurate classifier.</p>
    <p id="Par115">In benchmarking TRAP performance, we found that although Repitope performed well on pathogenic data, it was limited in extracting immunogenicity-related features from limited data and transferring them onto related species, resulting in poor performance on emerging pathogens. Our previous analysis revealed that Repitope was one of the models with skewed prediction for prevalent HLAs, with HLA-A*02:01-bound peptides having a higher immunogenicity score than non-HLA-A*02:01 bound peptides [<xref ref-type="bibr" rid="CR7">7</xref>]. This suggested that the model considered A02:01 binding as a superior feature to the T-cell recognition potential, skewing the prediction. While TRAP performed slightly lower on the pathogenic dataset, the HLA-generalised approach of TRAP mitigates the possibility of HLA bias. Therefore, end users should choose which model to pursue based on the peptides and HLA alleles of interest.</p>
    <p id="Par116">While these approaches improved the accuracy and robustness of the prediction, there still remains limitations. First, while the calibration methods could effectively detect incorrect prediction in a 10-fold cross-validation, they failed on the cross-species dataset (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S7G-H). We surmised this is because of ‘spurious semantic features’ (i.e. features that have discriminative power in training data but not in test data) that were driving overly confident incorrect predictions. In a recent case study, Arora et al. benchmarked calibration methods on real-world challenge data and reported that models were over-confident on the OOD examples because of spurious semantic features and often produced accuracies close to random [<xref ref-type="bibr" rid="CR45">45</xref>]. With spurious semantic shift being one of the remaining challenges in NLP, further advances in deep learning and NLP will also facilitate improving the robustness of predictions on complex biological data.</p>
    <p id="Par117">Second, following our workflow, peptides may be abstained due to low-confidence predictions. For cancer peptides, TESLA [<xref ref-type="bibr" rid="CR8">8</xref>] that incorporates generic features for neoepitope prediction could be an alternative solution. Pathogenic peptides having low-confidence predictions can be directed to RSAT to estimate the immunogenicity potential with respect to self-epitopes. However, because RSAT is only applicable to peptides with self-epitope counterparts, it has limited coverage with 346/3792 (9.1%) pathogenic epitopes currently having counterparts. Further characterisation of self-epitopes will expand RSAT coverage to embrace a broader range of pathogenic peptides.</p>
    <p id="Par118">Third, TRAP takes an HLA-generalised approach to avoid HLA bias, as the current dataset contains little intra-HLA variation in peptide immunogenicity. However, characterising peptide immunogenicity on a broader range of HLAs may provide insight into the effect of HLA on overall immunogenicity. Moreover, because the specific interaction between peptide and T-cell receptor is MHC-restricted [<xref ref-type="bibr" rid="CR80">80</xref>, <xref ref-type="bibr" rid="CR81">81</xref>], MHC-focused studies would be required to model specific TCR:pMHC recognition.</p>
    <p id="Par119">Fourth, T-cell recognition depends not only on peptide-MHC complex, but also on multiple other factors, such as cytokine microenvironment, co-stimulatory molecules in vivo and availability of TCR repertoires that are often highly stochastic and individualised [<xref ref-type="bibr" rid="CR82">82</xref>], adding complexity to T-cell activation and function [<xref ref-type="bibr" rid="CR83">83</xref>]. While there are almost no record of these determinants [<xref ref-type="bibr" rid="CR84">84</xref>], studies highlighting the influence of microenvironment on T-cell response will be pivotal to recapitulating T-cell function for therapeutic applications.</p>
    <p id="Par120">In TRAP, we incorporated peptide sequence at the contact position to gauge on T-cell recognition motifs. However, some studies showed that position 1 (P1) of 9-mer peptide may play an important role in T-cell binding, as demonstrated by P1, 3, 4, 5, 9 being critical for MAGE A3 binding by a3a-engineered T-cells [<xref ref-type="bibr" rid="CR85">85</xref>]. Although it is difficult to deconvolute the roles of different positions in MHC and T-cell binding, more studies may shed light on the role of P1.</p>
    <p id="Par121">Fifth, due to the lack of true Negative self-antigens, we retrieved benign HLA-I ligands expressed in thymus for their relevance to central tolerance. While there have been studies describing Tregs reacting to self-peptides present in the thymus [<xref ref-type="bibr" rid="CR86">86</xref>, <xref ref-type="bibr" rid="CR87">87</xref>], given that the models are targeted for CD8 + T-cells, we reasoned that majority of peptides presented by HLA class I in the thymus will be non-immunogenic. However, we acknowledge that concept of thymic selection is still evolving and that not all peptides expressed in the thymus may be involved in selection [<xref ref-type="bibr" rid="CR88">88</xref>]. On that note, some studies have shown that cTECs may generate and display distinct private self-peptides that may support the selection of T-cells with low self-reactivity in the periphery [<xref ref-type="bibr" rid="CR89">89</xref>, <xref ref-type="bibr" rid="CR90">90</xref>]. While experimental data linking the selection of ‘low self-affinity’ TCR with cTEC-displayed private peptides is still lacking, future studies characterising HLA-I ligand expressed in medulla thymic epithelial cells (mTEC) will improve confidence as ‘non-immunogenic self-antigens’.</p>
    <p id="Par122">Sixth, it will be valuable to extend the work of peptide immunogenicity to investigate the ability of peptides to be recognised by specific T-cells. Here, the peptide immunogenicity was investigated at the organismal level, i.e. whether the peptide can elicit a response from <italic>any</italic> T-cell. The limitation was largely due to the limited pool of available peptides characterised for their cognate TCRs; however, advances in screening methods will lead to availability of more comprehensive datasets in the future, thus enabling the development of more tailored immunogenicity models. It is becoming apparent that predicting specific interactions between TCR and cognate pMHCs is crucial for developing personalised therapies and tailoring vaccines or treatments to individuals’ TCR repertoire. Therefore, screening antigen-specific TCR against a larger pool of epitopes from various origins and pathologies will greatly aid in learning peptide features that allow interaction with specific TCRs.</p>
    <p id="Par123">In addition, the immunogenicity of an epitope can be altered by the presence of other epitopes, as demonstrated by immunodominance effects, in which a hierarchy exists in the magnitude of the immune response that epitopes can elicit [<xref ref-type="bibr" rid="CR91">91</xref>–<xref ref-type="bibr" rid="CR94">94</xref>]. Several factors may influence immunodominance, including competition for MHC, presentation levels, TCR affinity, timing of CTL clonal expansions, individual’s TCR diversity and/or strength of T-cell response [<xref ref-type="bibr" rid="CR95">95</xref>–<xref ref-type="bibr" rid="CR97">97</xref>]. The immunogenicity algorithms are designed to predict the peptide immunogenicity once the peptides are bound on HLA molecules. We used MHC rank as one of the parameter to describe binding affinity and relative MHC presentation levels. But, even if the peptides are stably presented, immunodominance may vary depending on an individual’s TCR diversity, T-cell affinity and/or strength of T-cell response. Therefore, while the model may serve as a useful tool to shortlist peptides for testing, additional experiments will be required to characterise their immunogenicity in presence of other epitopes. Future studies into the impact of other epitopes will aid in understanding the dynamics of immune response in the presence of multiple epitopes and foster the development of more accurate models.</p>
    <p id="Par124">Lastly, the current breadth of peptides characterised by T-cell assays is far from filling the full combinatorial peptide space, especially for CD4 + T-cell targets. Also, while this model is limited to peptide-specific binding of CD8 + T-cells, other T-cells are specific for lipid or small molecules like metabolites. As such, high-throughput screening of immune targets and antigen-specific TCRs by the help of recent technological advancement will greatly foster the process of model development.</p>
    <p id="Par125">Despite current data and model constraints, the novel computational strategies allowed TRAP to outperform existing models in predicting CD8 + T-cell epitopes and provide more robust, accurate and biologically meaningful candidates for functional validations. We believe that this workflow will foster a better understanding of TCR:pMHC interaction and aid in basic, clinical and translational research for a wide range of therapeutic applications.</p>
  </sec>
  <sec id="Sec28">
    <title>Conclusions</title>
    <p id="Par126">In summary, our study introduces TRAP, a robust deep learning framework designed to predict CD8 + T-cell epitopes from MHC-I presented pathogenic and self-peptides. Overcoming existing limitation, TRAP incorporates novel strategies to enhance predictive accuracy and confidence. Moreover, the novel metric, RSAT, addresses the challenge of immunogenicity estimation for emerging pathogens by comparing pathogenic peptides to immunogenic self-peptides. The demonstrated applications of TRAP in identifying cancer neoepitopes and assessing immune escape potential of SARS-CoV-2 variants underscored its practicality. In the face of ongoing threat posed by emerging pathogens and variants, TRAP’s ability to systematically assess the impact of mutations would be invaluable. Our study showcases the TRAP’s capacity to contribute to immunogenicity prediction, variant surveillance and neoepitope identification guided by both computational methodologies and biological understanding. Altogether, we envision models like TRAP, designed for the accurate identification of T-cell targets, will be instrumental in decoding the fundamental principles of T-cell recognition of antigens in time and space.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <sec id="Sec29">
      <title>Supplementary Information</title>
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="13073_2023_1225_MOESM1_ESM.pdf">
            <caption>
              <p><bold>Additional file 1: Fig. S1.</bold> Screnshot of TRAP web application. <bold>Fig. S2.</bold> Cross-species variation and HLA-bias. <bold>Fig. S3.</bold> Effect of anchor and contact positions on peptide immunogenicity. <bold>Fig. S4.</bold> Intra vs. Inter-HLA variability. <bold>Fig. S5.</bold> Pathogenic and self-antigen datasets. <bold>Fig. S6.</bold> Sequence patterns discriminating epitopes versus non-epitopes. <bold>Fig. S7.</bold> Out-of-distribution detection. <bold>Fig. S8.</bold> Benchmark TRAP performance.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM2">
          <media xlink:href="13073_2023_1225_MOESM2_ESM.pdf">
            <caption>
              <p><bold>Additional file 2.</bold> Includes step-by-step tutorial to TRAP web application.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM3">
          <media xlink:href="13073_2023_1225_MOESM3_ESM.xlsx">
            <caption>
              <p><bold>Additional file 3: Table S1.</bold> Pathogenic dataset. <bold>Table S2.</bold> Self-antigen dataset. <bold>Table S3.</bold> Pathogenic TRAP model hyperparameter optimisation. <bold>Table S4.</bold> Self-antigen TRAP model hyperparameter optimisation. <bold>Table S5.</bold> Pathogenic out-of-distribution model calibration metrics. <bold>Table S6.</bold> Self-antigen out-of-distribution model calibration metrics. <bold>Table S7.</bold> GBM predictions on self-antigen model.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM4">
          <media xlink:href="13073_2023_1225_MOESM4_ESM.xlsx">
            <caption>
              <p><bold>Additional file 4.</bold> Differential sequence patterns between pathogenic epitopes and non-epitopes.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM5">
          <media xlink:href="13073_2023_1225_MOESM5_ESM.xlsx">
            <caption>
              <p><bold>Additional file 5.</bold> Differential sequence patterns between self-epitopes and non-epitopes</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <glossary>
    <title>Abbreviations</title>
    <def-list>
      <def-item>
        <term>AAT</term>
        <def>
          <p id="Par5">Autoimmunity, allergy or tumour-associated antigens</p>
        </def>
      </def-item>
      <def-item>
        <term>ANOVA</term>
        <def>
          <p id="Par6">Analysis of variance</p>
        </def>
      </def-item>
      <def-item>
        <term>AUC</term>
        <def>
          <p id="Par7">Area under the ROC curve</p>
        </def>
      </def-item>
      <def-item>
        <term>BERT</term>
        <def>
          <p id="Par8">Bidirectional encoder representations from transformers</p>
        </def>
      </def-item>
      <def-item>
        <term>BL</term>
        <def>
          <p id="Par9">BLOSUM</p>
        </def>
      </def-item>
      <def-item>
        <term>BLOSUM</term>
        <def>
          <p id="Par10">Blocks of amino acid substitution matrix</p>
        </def>
      </def-item>
      <def-item>
        <term>CNN</term>
        <def>
          <p id="Par11">Convolutional neural network</p>
        </def>
      </def-item>
      <def-item>
        <term>CTL</term>
        <def>
          <p id="Par12">Cytotoxic T lymphocyte</p>
        </def>
      </def-item>
      <def-item>
        <term>DNN</term>
        <def>
          <p id="Par13">Deep neural network</p>
        </def>
      </def-item>
      <def-item>
        <term>EBV</term>
        <def>
          <p id="Par14">Epstein–Barr virus</p>
        </def>
      </def-item>
      <def-item>
        <term>GBM</term>
        <def>
          <p id="Par15">Glioblastoma</p>
        </def>
      </def-item>
      <def-item>
        <term>HCV</term>
        <def>
          <p id="Par16">Hepatitis C virus</p>
        </def>
      </def-item>
      <def-item>
        <term>HLA</term>
        <def>
          <p id="Par17">Human leukocyte antigens</p>
        </def>
      </def-item>
      <def-item>
        <term>IEDB</term>
        <def>
          <p id="Par18">Immune Epitope Database</p>
        </def>
      </def-item>
      <def-item>
        <term>LSTM</term>
        <def>
          <p id="Par19">Long short-term memory</p>
        </def>
      </def-item>
      <def-item>
        <term>MAGE</term>
        <def>
          <p id="Par20">Melanoma-associated antigen family</p>
        </def>
      </def-item>
      <def-item>
        <term>MHC</term>
        <def>
          <p id="Par21">Major histocompatibility complex</p>
        </def>
      </def-item>
      <def-item>
        <term>MLP</term>
        <def>
          <p id="Par22">Multilayer perceptron</p>
        </def>
      </def-item>
      <def-item>
        <term>NLI</term>
        <def>
          <p id="Par23">Natural Language Inference</p>
        </def>
      </def-item>
      <def-item>
        <term>NLP</term>
        <def>
          <p id="Par24">Natural Language Processing</p>
        </def>
      </def-item>
      <def-item>
        <term>OHE</term>
        <def>
          <p id="Par25">One-hot encoding</p>
        </def>
      </def-item>
      <def-item>
        <term>OOD</term>
        <def>
          <p id="Par26">Out-of-distribution</p>
        </def>
      </def-item>
      <def-item>
        <term>PLM</term>
        <def>
          <p id="Par27">Protein language model</p>
        </def>
      </def-item>
      <def-item>
        <term>PR</term>
        <def>
          <p id="Par28">Precision-recall</p>
        </def>
      </def-item>
      <def-item>
        <term>RMSE</term>
        <def>
          <p id="Par29">Root-mean-square deviation</p>
        </def>
      </def-item>
      <def-item>
        <term>RNN</term>
        <def>
          <p id="Par30">Recurrent neural network</p>
        </def>
      </def-item>
      <def-item>
        <term>ROC</term>
        <def>
          <p id="Par31">Receiver operating characteristic</p>
        </def>
      </def-item>
      <def-item>
        <term>RSAT</term>
        <def>
          <p id="Par32">Relative similarity to autoantigens and tumour-associated antigens</p>
        </def>
      </def-item>
      <def-item>
        <term>SARS-CoV</term>
        <def>
          <p id="Par33">Severe acute respiratory syndrome coronavirus</p>
        </def>
      </def-item>
      <def-item>
        <term>TCR</term>
        <def>
          <p id="Par34">T-cell receptor</p>
        </def>
      </def-item>
      <def-item>
        <term>TRAP</term>
        <def>
          <p id="Par35">T-cell recognition potential of HLA-I presented peptides</p>
        </def>
      </def-item>
      <def-item>
        <term>VACV</term>
        <def>
          <p id="Par36">Vaccinia virus</p>
        </def>
      </def-item>
      <def-item>
        <term>XGBOOST</term>
        <def>
          <p id="Par37">Extreme gradient boosting</p>
        </def>
      </def-item>
    </def-list>
  </glossary>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher’s Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <ack>
    <title>Acknowledgements</title>
    <p>HK was funded for this project by the MRC Human Immunology core funding MC_UU_00008. CL was funded by the UK National Institute of Health (NIHR).</p>
    <p>AS is funded by the Wellcome Investigating Award (219523/Z/19/Z), the UK MRC, NIHR and awards from Bristol-Myers Squibb and UCB.</p>
    <p>We thank all members of Koohy and Simmons Lab for insightful discussions. We thank MRC WIMM Centre for Computational Biology for the technical support.</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Authors’ contributions</title>
    <p>CL and HK conceived the study. CL designed and conducted all computational analysis with inputs from AA, JH, MJ, PB, MP, RF, AS and HK. CL developed deep learning model with inputs from JH and MJ. PB and CL conducted benchmarking. CL and MJ developed and deployed the web application. CL wrote the manuscript. JH, PB, MJ, MP, RF, AA, AS and HK commented and edited the manuscript. AS and HK supervised the study. All authors read and approved the final manuscript.</p>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>This work has been supported by Medical Research Council. HK is funded by MRC Human Immunology Unit core funding. CL is funded by UK National Institute for Health and Care Research (NIHR). AS is funded by a Wellcome Investigator Award (219523/Z/19/Z), the UK Medical Research Council, an NIHR Senior Investigator Award, awards from Bristol-Myers Squibb and UCB. The views expressed are those of the author(s) and not necessarily those of the NHS, the NIHR, or the Department of Health, UK.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and materials</title>
    <p>The web application is available at <ext-link ext-link-type="uri" xlink:href="https://github.com/ChloeHJ/TRAP">https://github.com/ChloeHJ/TRAP</ext-link> [<xref ref-type="bibr" rid="CR66">66</xref>]. The data, pre-trained models and notebooks are deposited in Google Drive repository [<xref ref-type="bibr" rid="CR98">98</xref>]. The ‘Tutorial for TRAP web application’ document in GitHub [<xref ref-type="bibr" rid="CR66">66</xref>] contains a detailed tutorial on how to use the web application and ‘Workflow: GBM on self-antigen model’ notebook in Google drive [<xref ref-type="bibr" rid="CR98">98</xref>] contains step-by-step workflow for using TRAP model on an example GBM dataset in python interface. The scripts for differential sequence analysis is deposited in GitHub repository [<xref ref-type="bibr" rid="CR60">60</xref>].</p>
  </notes>
  <notes>
    <title>Declarations</title>
    <notes id="FPar1">
      <title>Ethics approval and consent to participate</title>
      <p id="Par127">Not applicable.</p>
    </notes>
    <notes id="FPar2">
      <title>Consent for publication</title>
      <p id="Par128">Not applicable.</p>
    </notes>
    <notes id="FPar3" notes-type="COI-statement">
      <title>Competing interests</title>
      <p id="Par129">The authors declare that they have no competing interests.</p>
    </notes>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Krammer</surname>
            <given-names>F</given-names>
          </name>
        </person-group>
        <article-title>SARS-CoV-2 vaccines in development</article-title>
        <source>Nature</source>
        <year>2020</year>
        <volume>586</volume>
        <fpage>516</fpage>
        <lpage>527</lpage>
        <?supplied-pmid 32967006?>
        <pub-id pub-id-type="pmid">32967006</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ott</surname>
            <given-names>PA</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>An immunogenic personal neoantigen vaccine for patients with melanoma</article-title>
        <source>Nature</source>
        <year>2017</year>
        <volume>547</volume>
        <fpage>217</fpage>
        <lpage>221</lpage>
        <?supplied-pmid 28678778?>
        <pub-id pub-id-type="pmid">28678778</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zacharakis</surname>
            <given-names>N</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Immune recognition of somatic mutations leading to complete durable regression in metastatic breast cancer</article-title>
        <source>Nat Med</source>
        <year>2018</year>
        <volume>24</volume>
        <fpage>724</fpage>
        <lpage>730</lpage>
        <?supplied-pmid 29867227?>
        <pub-id pub-id-type="pmid">29867227</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <mixed-citation publication-type="other">Joglekar AV &amp; Li G. T cell antigen discovery. Nat Methods. 2020:1–8. 10.1038/s41592-020-0867-z.</mixed-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rubelt</surname>
            <given-names>F</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Adaptive immune receptor repertoire community recommendations for sharing immune-repertoire sequencing data</article-title>
        <source>Nat Immunol</source>
        <year>2017</year>
        <volume>18</volume>
        <fpage>1274</fpage>
        <lpage>1278</lpage>
        <?supplied-pmid 29144493?>
        <pub-id pub-id-type="pmid">29144493</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Birnbaum</surname>
            <given-names>ME</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Deconstructing the peptide-MHC specificity of T cell recognition</article-title>
        <source>Cell</source>
        <year>2014</year>
        <volume>157</volume>
        <fpage>1073</fpage>
        <lpage>1087</lpage>
        <?supplied-pmid 24855945?>
        <pub-id pub-id-type="pmid">24855945</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Buckley</surname>
            <given-names>PR</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Evaluating performance of existing computational models in predicting CD8+ T cell pathogenic epitopes and cancer neoantigens</article-title>
        <source>Brief Bioinform.</source>
        <year>2022</year>
        <volume>23</volume>
        <fpage>bbac141</fpage>
        <?supplied-pmid 35471658?>
        <pub-id pub-id-type="pmid">35471658</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wells</surname>
            <given-names>DK</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Key Parameters of tumor epitope immunogenicity revealed through a consortium approach improve neoantigen prediction</article-title>
        <source>Cell</source>
        <year>2020</year>
        <volume>183</volume>
        <fpage>818</fpage>
        <lpage>834.e13</lpage>
        <?supplied-pmid 33038342?>
        <pub-id pub-id-type="pmid">33038342</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <mixed-citation publication-type="other">Karnaukhov V, et al. HLA binding of self-peptides is biased towards proteins with specific molecular functions. bioRxiv. 2021:2021.02.16.431395. 10.1101/2021.02.16.431395.</mixed-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bassani-Sternberg</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Gfeller</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>Unsupervised HLA peptidome deconvolution improves ligand prediction accuracy and predicts cooperative effects in peptide–HLA interactions</article-title>
        <source>J Immunol</source>
        <year>2016</year>
        <volume>197</volume>
        <fpage>2492</fpage>
        <lpage>2499</lpage>
        <?supplied-pmid 27511729?>
        <pub-id pub-id-type="pmid">27511729</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bassani-Sternberg</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Deciphering HLA-I motifs across HLA peptidomes improves neo-antigen predictions and identifies allostery regulating HLA specificity</article-title>
        <source>PLoS Comput Biol</source>
        <year>2017</year>
        <volume>13</volume>
        <fpage>e1005725</fpage>
        <?supplied-pmid 28832583?>
        <pub-id pub-id-type="pmid">28832583</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jurtz</surname>
            <given-names>V</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>NetMHCpan-4.0: improved peptide–MHC Class I interaction predictions integrating eluted ligand and peptide binding affinity data</article-title>
        <source>J Immunol</source>
        <year>2017</year>
        <volume>199</volume>
        <fpage>3360</fpage>
        <lpage>3368</lpage>
        <?supplied-pmid 28978689?>
        <pub-id pub-id-type="pmid">28978689</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Calis</surname>
            <given-names>JJA</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Properties of MHC class I presented peptides that enhance immunogenicity</article-title>
        <source>PLoS Comput Biol</source>
        <year>2013</year>
        <volume>9</volume>
        <fpage>e1003266</fpage>
        <?supplied-pmid 24204222?>
        <pub-id pub-id-type="pmid">24204222</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ogishi</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Yotsuyanagi</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>Quantitative prediction of the landscape of T cell epitope immunogenicity in sequence space</article-title>
        <source>Front Immunol</source>
        <year>2019</year>
        <volume>10</volume>
        <fpage>827</fpage>
        <?supplied-pmid 31057550?>
        <pub-id pub-id-type="pmid">31057550</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Iyer</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Prasath</surname>
            <given-names>VBS</given-names>
          </name>
          <name>
            <surname>Ni</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Salomonis</surname>
            <given-names>N</given-names>
          </name>
        </person-group>
        <article-title>DeepImmuno: deep learning-empowered prediction and generation of immunogenic peptides for T-cell immunity</article-title>
        <source>Brief Bioinform</source>
        <year>2021</year>
        <pub-id pub-id-type="doi">10.1093/bib/bbab160</pub-id>
        <?supplied-pmid 34463709?>
        <pub-id pub-id-type="pmid">34463709</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Trolle</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Nielsen</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>NetTepi: an integrated method for the prediction of T cell epitopes</article-title>
        <source>Immunogenetics</source>
        <year>2014</year>
        <volume>66</volume>
        <fpage>449</fpage>
        <lpage>456</lpage>
        <?supplied-pmid 24863339?>
        <pub-id pub-id-type="pmid">24863339</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pogorelyy</surname>
            <given-names>MV</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Exploring the pre-immune landscape of antigen-specific T cells</article-title>
        <source>Genome Medicine</source>
        <year>2018</year>
        <volume>10</volume>
        <fpage>68</fpage>
        <?supplied-pmid 30144804?>
        <pub-id pub-id-type="pmid">30144804</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tung</surname>
            <given-names>C-W</given-names>
          </name>
          <name>
            <surname>Ziehm</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Kämper</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Kohlbacher</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Ho</surname>
            <given-names>S-Y</given-names>
          </name>
        </person-group>
        <article-title>POPISK: T-cell reactivity prediction using support vector machines and string kernels</article-title>
        <source>BMC Bioinformatics</source>
        <year>2011</year>
        <volume>12</volume>
        <fpage>446</fpage>
        <?supplied-pmid 22085524?>
        <pub-id pub-id-type="pmid">22085524</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chowell</surname>
            <given-names>D</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>TCR contact residue hydrophobicity is a hallmark of immunogenic CD8+ T cell epitopes</article-title>
        <source>PNAS</source>
        <year>2015</year>
        <volume>112</volume>
        <fpage>E1754</fpage>
        <lpage>E1762</lpage>
        <?supplied-pmid 25831525?>
        <pub-id pub-id-type="pmid">25831525</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chowell</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Krishna</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Blattman</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Anderson</surname>
            <given-names>K</given-names>
          </name>
        </person-group>
        <article-title>Hydrophobicity is a hallmark of immunogenic MHC class I T cell epitopes (APP2P.111)</article-title>
        <source>J Immunol</source>
        <year>2014</year>
        <volume>192</volume>
        <fpage>43.12</fpage>
        <lpage>43.12</lpage>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Richman</surname>
            <given-names>LP</given-names>
          </name>
          <name>
            <surname>Vonderheide</surname>
            <given-names>RH</given-names>
          </name>
          <name>
            <surname>Rech</surname>
            <given-names>AJ</given-names>
          </name>
        </person-group>
        <article-title>Neoantigen dissimilarity to the self-proteome predicts immunogenicity and response to immune checkpoint blockade</article-title>
        <source>Cell Syst</source>
        <year>2019</year>
        <volume>9</volume>
        <fpage>375</fpage>
        <lpage>382.e4</lpage>
        <?supplied-pmid 31606370?>
        <pub-id pub-id-type="pmid">31606370</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Devlin</surname>
            <given-names>JR</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Structural dissimilarity from self drives neoepitope escape from immune tolerance</article-title>
        <source>Nat Chem Biol</source>
        <year>2020</year>
        <volume>16</volume>
        <fpage>1269</fpage>
        <lpage>1276</lpage>
        <?supplied-pmid 32807968?>
        <pub-id pub-id-type="pmid">32807968</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lee</surname>
            <given-names>CH</given-names>
          </name>
          <name>
            <surname>Antanaviciute</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Buckley</surname>
            <given-names>PR</given-names>
          </name>
          <name>
            <surname>Simmons</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Koohy</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>To what extent does MHC binding translate to immunogenicity in humans?</article-title>
        <source>ImmunoInformatics</source>
        <year>2021</year>
        <volume>3–4</volume>
        <fpage>100006</fpage>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jumper</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Highly accurate protein structure prediction with AlphaFold</article-title>
        <source>Nature</source>
        <year>2021</year>
        <volume>596</volume>
        <fpage>583</fpage>
        <lpage>589</lpage>
        <?supplied-pmid 34265844?>
        <pub-id pub-id-type="pmid">34265844</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jensen</surname>
            <given-names>KK</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Improved methods for predicting peptide binding affinity to MHC class II molecules</article-title>
        <source>Immunology</source>
        <year>2018</year>
        <volume>154</volume>
        <fpage>394</fpage>
        <lpage>406</lpage>
        <?supplied-pmid 29315598?>
        <pub-id pub-id-type="pmid">29315598</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Racle</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Robust prediction of HLA class II epitopes by deep motif deconvolution of immunopeptidomes</article-title>
        <source>Nat Biotechnol</source>
        <year>2019</year>
        <volume>37</volume>
        <fpage>1283</fpage>
        <lpage>1286</lpage>
        <?supplied-pmid 31611696?>
        <pub-id pub-id-type="pmid">31611696</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <mixed-citation publication-type="other">Lu T, et al. Deep learning-based prediction of the T cell receptor–antigen binding specificity. Nat Mach Intell. 2021:1–12. 10.1038/s42256-021-00383-2.</mixed-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sidhom</surname>
            <given-names>J-W</given-names>
          </name>
          <name>
            <surname>Larman</surname>
            <given-names>HB</given-names>
          </name>
          <name>
            <surname>Pardoll</surname>
            <given-names>DM</given-names>
          </name>
          <name>
            <surname>Baras</surname>
            <given-names>AS</given-names>
          </name>
        </person-group>
        <article-title>DeepTCR is a deep learning framework for revealing sequence concepts within T-cell repertoires</article-title>
        <source>Nat Commun</source>
        <year>2021</year>
        <volume>12</volume>
        <fpage>1605</fpage>
        <?supplied-pmid 33707415?>
        <pub-id pub-id-type="pmid">33707415</pub-id>
      </element-citation>
    </ref>
    <ref id="CR29">
      <label>29.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Weber</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Born</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Rodriguez Martínez</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>TITAN: T-cell receptor specificity prediction with bimodal attention networks</article-title>
        <source>Bioinformatics</source>
        <year>2021</year>
        <volume>37</volume>
        <fpage>i237</fpage>
        <lpage>i244</lpage>
        <?supplied-pmid 34252922?>
        <pub-id pub-id-type="pmid">34252922</pub-id>
      </element-citation>
    </ref>
    <ref id="CR30">
      <label>30.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rives</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Biological structure and function emerge from scaling unsupervised learning to 250 million protein sequences</article-title>
        <source>Proc Natl Acad Sci U S A</source>
        <year>2021</year>
        <volume>118</volume>
        <fpage>e2016239118</fpage>
        <?supplied-pmid 33876751?>
        <pub-id pub-id-type="pmid">33876751</pub-id>
      </element-citation>
    </ref>
    <ref id="CR31">
      <label>31.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rao</surname>
            <given-names>R</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Evaluating protein transfer learning with TAPE</article-title>
        <source>Adv Neural Inf Process Syst</source>
        <year>2019</year>
        <volume>32</volume>
        <fpage>9689</fpage>
        <lpage>9701</lpage>
        <?supplied-pmid 33390682?>
        <pub-id pub-id-type="pmid">33390682</pub-id>
      </element-citation>
    </ref>
    <ref id="CR32">
      <label>32.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Alley</surname>
            <given-names>EC</given-names>
          </name>
          <name>
            <surname>Khimulya</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Biswas</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>AlQuraishi</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Church</surname>
            <given-names>GM</given-names>
          </name>
        </person-group>
        <article-title>Unified rational protein engineering with sequence-based deep representation learning</article-title>
        <source>Nat Methods</source>
        <year>2019</year>
        <volume>16</volume>
        <fpage>1315</fpage>
        <lpage>1322</lpage>
        <?supplied-pmid 31636460?>
        <pub-id pub-id-type="pmid">31636460</pub-id>
      </element-citation>
    </ref>
    <ref id="CR33">
      <label>33.</label>
      <mixed-citation publication-type="other">Elnaggar A, et al. ProtTrans: towards cracking the language of life’s code through self-supervised learning. 2020. 10.1101/2020.07.12.199554. <ext-link ext-link-type="uri" xlink:href="http://biorxiv.org/lookup/doi/10.1101/2020.07.12.199554">http://biorxiv.org/lookup/doi/10.1101/2020.07.12.199554</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR34">
      <label>34.</label>
      <mixed-citation publication-type="other">Kalyan KS, Rajasekharan A &amp; Sangeetha S. AMMUS : a survey of transformer-based pretrained models in natural language processing. 2021. Preprint at 10.48550/arXiv.2108.05542.</mixed-citation>
    </ref>
    <ref id="CR35">
      <label>35.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Roshanzamir</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Aghajan</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Soleymani Baghshah</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Transformer-based deep neural network language models for Alzheimer’s disease risk assessment from targeted speech</article-title>
        <source>BMC Med Inform Decis Mak</source>
        <year>2021</year>
        <volume>21</volume>
        <fpage>92</fpage>
        <?supplied-pmid 33750385?>
        <pub-id pub-id-type="pmid">33750385</pub-id>
      </element-citation>
    </ref>
    <ref id="CR36">
      <label>36.</label>
      <mixed-citation publication-type="other">Devlin J, Chang MW, Lee K, Toutanova K. BERT: Pre-training of Deep Bidirectional Transformers for Language Understanding. In: Proceedings of the 2019 Conference of the North American Chapter of the Association for Computational Linguistics: Human Language Technologies, Volume 1 (Long and Short Papers). Minneapolis: Association for Computational Linguistics; 2019. p. 4171–4186. 10.18653/v1/N19-1423.</mixed-citation>
    </ref>
    <ref id="CR37">
      <label>37.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Torralba</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Efros</surname>
            <given-names>AA</given-names>
          </name>
        </person-group>
        <article-title>Unbiased look at dataset bias</article-title>
        <source>CVPR</source>
        <year>2011</year>
        <volume>2011</volume>
        <fpage>1521</fpage>
        <lpage>1528</lpage>
        <pub-id pub-id-type="doi">10.1109/CVPR.2011.5995347</pub-id>
      </element-citation>
    </ref>
    <ref id="CR38">
      <label>38.</label>
      <mixed-citation publication-type="other">Quiñonero-Candela J, Lawrence ND, Schwaighofer A, Sugiyama M. Dataset shift in machine learning. MIT Press; 2022.</mixed-citation>
    </ref>
    <ref id="CR39">
      <label>39.</label>
      <mixed-citation publication-type="other">Eykholt K, et al. Robust Physical-World Attacks on Deep Learning Visual Classification. In: 2018 IEEE/CVF Conference on Computer Vision and Pattern Recognition; 2018:1625–1634. 10.1109/CVPR.2018.00175.</mixed-citation>
    </ref>
    <ref id="CR40">
      <label>40.</label>
      <mixed-citation publication-type="other">Ribeiro MT, Wu T, Guestrin C &amp; Singh S. Beyond Accuracy: Behavioral Testing of NLP Models with CheckList. In: Proceedings of the 58th Annual Meeting of the Association for Computational Linguistics. Association for Computational Linguistics; 2020:4902–4912. 10.18653/v1/2020.acl-main.442.</mixed-citation>
    </ref>
    <ref id="CR41">
      <label>41.</label>
      <mixed-citation publication-type="other">Jia R, Liang P. Adversarial Examples for Evaluating Reading Comprehension Systems. In: Proceedings of the 2017 Conference on Empirical Methods in Natural Language Processing. Copenhagen: Association for Computational Linguistics; 2017. p. 2021–2031. 10.18653/v1/D17-1215.</mixed-citation>
    </ref>
    <ref id="CR42">
      <label>42.</label>
      <mixed-citation publication-type="other">Amodei D et al. Concrete problems in AI Safety; 2016. Preprint at 10.48550/arXiv.1606.06565.</mixed-citation>
    </ref>
    <ref id="CR43">
      <label>43.</label>
      <mixed-citation publication-type="other">Hendrycks D &amp; Gimpel K. A baseline for detecting misclassified and out-of-distribution examples in neural networks; 2018. Preprint at 10.48550/arXiv.1610.02136.</mixed-citation>
    </ref>
    <ref id="CR44">
      <label>44.</label>
      <mixed-citation publication-type="other">Varshney N, Mishra S, Baral C. Towards Improving Selective Prediction Ability of NLP Systems. In: Proceedings of the 7th Workshop on Representation Learning for NLP. Dublin: Association for Computational Linguistics; 2022. p. 221–226. 10.18653/v1/2022.repl4nlp-1.23.</mixed-citation>
    </ref>
    <ref id="CR45">
      <label>45.</label>
      <mixed-citation publication-type="other">Arora U, Huang W, He H. Types of out-of-distribution texts and how to detect them. In: Proceedings of the 2021 Conference on Empirical Methods in Natural Language Processing. Punta Cana: Association for Computational Linguistics; 2021. p. 10687–10701. 10.18653/v1/2021.emnlp-main.835.</mixed-citation>
    </ref>
    <ref id="CR46">
      <label>46.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kim</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Jang</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Seo</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Park</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Kang</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>Intrusion detection based on sequential information preserving log embedding methods and anomaly detection algorithms</article-title>
        <source>IEEE Access</source>
        <year>2021</year>
        <volume>9</volume>
        <fpage>58088</fpage>
        <lpage>58101</lpage>
      </element-citation>
    </ref>
    <ref id="CR47">
      <label>47.</label>
      <mixed-citation publication-type="other">Schlegl T, Seeböck P, Waldstein SM, Schmidt-Erfurth U, Langs G. Unsupervised Anomaly Detection with Generative Adversarial Networks to Guide Marker Discovery. In: Niethammer M, et al, editors. Information Processing in Medical Imaging. Boone: Springer International Publishing; 2017. p. 146–157. 10.1007/978-3-319-59050-9_12.</mixed-citation>
    </ref>
    <ref id="CR48">
      <label>48.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jang</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Lukasiewicz</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>NoiER: an approach for training more reliable fine-tuned downstream task models</article-title>
        <source>EEE/ACM Trans Audio Speech Lang Process</source>
        <year>2022</year>
        <volume>30</volume>
        <fpage>2514</fpage>
        <lpage>2525</lpage>
      </element-citation>
    </ref>
    <ref id="CR49">
      <label>49.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Fleri</surname>
            <given-names>W</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The immune epitope database and analysis resource in epitope discovery and synthetic vaccine design</article-title>
        <source>Front Immunol</source>
        <year>2017</year>
        <volume>8</volume>
        <fpage>278</fpage>
        <?supplied-pmid 28352270?>
        <pub-id pub-id-type="pmid">28352270</pub-id>
      </element-citation>
    </ref>
    <ref id="CR50">
      <label>50.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tan</surname>
            <given-names>X</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>dbPepNeo: a manually curated database for human tumor neoantigen peptides</article-title>
        <source>Database</source>
        <year>2020</year>
        <volume>2020</volume>
        <fpage>baaa004</fpage>
        <?supplied-pmid 32090262?>
        <pub-id pub-id-type="pmid">32090262</pub-id>
      </element-citation>
    </ref>
    <ref id="CR51">
      <label>51.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tickotsky</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Sagiv</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Prilusky</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Shifrut</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Friedman</surname>
            <given-names>N</given-names>
          </name>
        </person-group>
        <article-title>McPAS-TCR: a manually curated catalogue of pathology-associated T cell receptor sequences</article-title>
        <source>Bioinformatics</source>
        <year>2017</year>
        <volume>33</volume>
        <fpage>2924</fpage>
        <lpage>2929</lpage>
        <?supplied-pmid 28481982?>
        <pub-id pub-id-type="pmid">28481982</pub-id>
      </element-citation>
    </ref>
    <ref id="CR52">
      <label>52.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Xia</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>NEPdb: a database of T-cell experimentally-validated neoantigens and pan-cancer predicted neoepitopes for cancer immunotherapy</article-title>
        <source>Front Immunol</source>
        <year>2021</year>
        <volume>12</volume>
        <fpage>644637</fpage>
        <?supplied-pmid 33927717?>
        <pub-id pub-id-type="pmid">33927717</pub-id>
      </element-citation>
    </ref>
    <ref id="CR53">
      <label>53.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Adamopoulou</surname>
            <given-names>E</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Exploring the MHC-peptide matrix of central tolerance in the human thymus</article-title>
        <source>Nat Commun</source>
        <year>2013</year>
        <volume>4</volume>
        <fpage>2039</fpage>
        <?supplied-pmid 23783831?>
        <pub-id pub-id-type="pmid">23783831</pub-id>
      </element-citation>
    </ref>
    <ref id="CR54">
      <label>54.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Espinosa</surname>
            <given-names>G</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Peptides presented by HLA class I molecules in the human thymus</article-title>
        <source>J Proteomics</source>
        <year>2013</year>
        <volume>94</volume>
        <fpage>23</fpage>
        <lpage>36</lpage>
        <?supplied-pmid 24029068?>
        <pub-id pub-id-type="pmid">24029068</pub-id>
      </element-citation>
    </ref>
    <ref id="CR55">
      <label>55.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Marcu</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>HLA Ligand Atlas: a benign reference of HLA-presented peptides to improve T-cell-based cancer immunotherapy</article-title>
        <source>J Immunother Cancer</source>
        <year>2021</year>
        <volume>9</volume>
        <fpage>e002071</fpage>
        <?supplied-pmid 33858848?>
        <pub-id pub-id-type="pmid">33858848</pub-id>
      </element-citation>
    </ref>
    <ref id="CR56">
      <label>56.</label>
      <mixed-citation publication-type="other">Schmidt J, et al. Prediction of neo-epitope immunogenicity reveals TCR recognition determinants and provides insight into immunoediting. Cell Rep Med. 2021;2:100194.</mixed-citation>
    </ref>
    <ref id="CR57">
      <label>57.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Iyer</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Prasath</surname>
            <given-names>VBS</given-names>
          </name>
          <name>
            <surname>Ni</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Salomonis</surname>
            <given-names>N</given-names>
          </name>
        </person-group>
        <article-title>DeepImmuno: deep learning-empowered prediction and generation of immunogenic peptides for T-cell immunity</article-title>
        <source>Brief Bioinform</source>
        <year>2021</year>
        <volume>22</volume>
        <fpage>bbab160</fpage>
        <?supplied-pmid 34009266?>
        <pub-id pub-id-type="pmid">34009266</pub-id>
      </element-citation>
    </ref>
    <ref id="CR58">
      <label>58.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Osorio</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Rondón-Villarreal</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Torres</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Peptides: a package for data mining of antimicrobial peptides</article-title>
        <source>R J</source>
        <year>2015</year>
        <volume>7</volume>
        <fpage>4</fpage>
      </element-citation>
    </ref>
    <ref id="CR59">
      <label>59.</label>
      <mixed-citation publication-type="other">Pagès H, Aboyoun P, Gentleman R &amp; DebRoy S. Biostrings: efficient manipulation of biological strings; 2022. 10.18129/B9.bioc.Biostrings.</mixed-citation>
    </ref>
    <ref id="CR60">
      <label>60.</label>
      <mixed-citation publication-type="other">Lee CH. diffSeqPatterns: R package for differential sequence pattern analysis. GitHub; 2023. <ext-link ext-link-type="uri" xlink:href="https://github.com/ChloeHJ/diffSeqPatterns">https://github.com/ChloeHJ/diffSeqPatterns</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR61">
      <label>61.</label>
      <mixed-citation publication-type="other">Zhou C, Paffenroth RC. Anomaly Detection with Robust Deep Autoencoders. In: Proceedings of the 23rd ACM SIGKDD International Conference on Knowledge Discovery and Data Mining. Halifax: Association for Computing Machinery; 2017. p. 665–674. 10.1145/3097983.3098052.</mixed-citation>
    </ref>
    <ref id="CR62">
      <label>62.</label>
      <mixed-citation publication-type="other">Guo C, Pleiss G, Sun Y, Weinberger KQ. On Calibration of Modern Neural Networks. In: Proceedings of the 34th International Conference on Machine Learning. Sydney: PMLR; 2017. p. 1321–1330.</mixed-citation>
    </ref>
    <ref id="CR63">
      <label>63.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bresciani</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>T-cell recognition is shaped by epitope sequence conservation in the host proteome and microbiome</article-title>
        <source>Immunology</source>
        <year>2016</year>
        <volume>148</volume>
        <fpage>34</fpage>
        <lpage>39</lpage>
        <?supplied-pmid 26789414?>
        <pub-id pub-id-type="pmid">26789414</pub-id>
      </element-citation>
    </ref>
    <ref id="CR64">
      <label>64.</label>
      <mixed-citation publication-type="other">Ma R, et al. Decitabine increases neoantigen and cancer testis antigen expression to enhance T-cell–mediated toxicity against glioblastoma. Neuro Oncol. 2022:noac107. 10.1093/neuonc/noac107.</mixed-citation>
    </ref>
    <ref id="CR65">
      <label>65.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bjerregaard</surname>
            <given-names>A-M</given-names>
          </name>
          <name>
            <surname>Nielsen</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Hadrup</surname>
            <given-names>SR</given-names>
          </name>
          <name>
            <surname>Szallasi</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Eklund</surname>
            <given-names>AC</given-names>
          </name>
        </person-group>
        <article-title>MuPeXI: prediction of neo-epitopes from tumor sequencing data</article-title>
        <source>Cancer Immunol Immunother</source>
        <year>2017</year>
        <volume>66</volume>
        <fpage>1123</fpage>
        <lpage>1130</lpage>
        <?supplied-pmid 28429069?>
        <pub-id pub-id-type="pmid">28429069</pub-id>
      </element-citation>
    </ref>
    <ref id="CR66">
      <label>66.</label>
      <mixed-citation publication-type="other">Lee CH. TRAP: a robust deep learning workflow to predict CD8+ T-cell epitopes. GitHub; 2023. <ext-link ext-link-type="uri" xlink:href="https://github.com/ChloeHJ/TRAP">https://github.com/ChloeHJ/TRAP</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR67">
      <label>67.</label>
      <mixed-citation publication-type="other">Gao A et al. Predicting the Immunogenicity of T cell epitopes: from HIV to SARS-CoV-2. bioRxiv. 2020:2020.05.14.095885. 10.1101/2020.05.14.095885.</mixed-citation>
    </ref>
    <ref id="CR68">
      <label>68.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ruppert</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Prominent role of secondary anchor residues in peptide binding to HLA-A2.1 molecules</article-title>
        <source>Cell</source>
        <year>1993</year>
        <volume>74</volume>
        <fpage>929</fpage>
        <lpage>937</lpage>
        <?supplied-pmid 8104103?>
        <pub-id pub-id-type="pmid">8104103</pub-id>
      </element-citation>
    </ref>
    <ref id="CR69">
      <label>69.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Liston</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Lesage</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Wilson</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Peltonen</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Goodnow</surname>
            <given-names>CC</given-names>
          </name>
        </person-group>
        <article-title>Aire regulates negative selection of organ-specific T cells</article-title>
        <source>Nat Immunol</source>
        <year>2003</year>
        <volume>4</volume>
        <fpage>350</fpage>
        <lpage>354</lpage>
        <?supplied-pmid 12612579?>
        <pub-id pub-id-type="pmid">12612579</pub-id>
      </element-citation>
    </ref>
    <ref id="CR70">
      <label>70.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Starr</surname>
            <given-names>TK</given-names>
          </name>
          <name>
            <surname>Jameson</surname>
            <given-names>SC</given-names>
          </name>
          <name>
            <surname>Hogquist</surname>
            <given-names>KA</given-names>
          </name>
        </person-group>
        <article-title>Positive and negative selection of T cells</article-title>
        <source>Annu Rev Immunol</source>
        <year>2003</year>
        <volume>21</volume>
        <fpage>139</fpage>
        <lpage>176</lpage>
        <?supplied-pmid 12414722?>
        <pub-id pub-id-type="pmid">12414722</pub-id>
      </element-citation>
    </ref>
    <ref id="CR71">
      <label>71.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jameson</surname>
            <given-names>SC</given-names>
          </name>
          <name>
            <surname>Hogquist</surname>
            <given-names>KA</given-names>
          </name>
          <name>
            <surname>Bevan</surname>
            <given-names>MJ</given-names>
          </name>
        </person-group>
        <article-title>Specificity and flexibility in thymic selection</article-title>
        <source>Nature</source>
        <year>1994</year>
        <volume>369</volume>
        <fpage>750</fpage>
        <lpage>752</lpage>
        <?supplied-pmid 8008067?>
        <pub-id pub-id-type="pmid">8008067</pub-id>
      </element-citation>
    </ref>
    <ref id="CR72">
      <label>72.</label>
      <mixed-citation publication-type="other">Cho K, et al. Learning phrase representations using rnn encoder–decoder for statistical machine translation. In: Proceedings of the 2014 Conference on Empirical Methods in Natural Language Processing (EMNLP). Doha: Association for Computational Linguistics; 2014. p. 1724–1734. 10.3115/v1/D14-1179.</mixed-citation>
    </ref>
    <ref id="CR73">
      <label>73.</label>
      <mixed-citation publication-type="other">Kim Y. Convolutional Neural Networks for Sentence Classification. In: Proceedings of the 2014 Conference on Empirical Methods in Natural Language Processing (EMNLP). Doha: Association for Computational Linguistics; 2014. p. 1746–1751. 10.3115/v1/D14-1181.</mixed-citation>
    </ref>
    <ref id="CR74">
      <label>74.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wooldridge</surname>
            <given-names>L</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>CD8 controls T cell cross-reactivity</article-title>
        <source>J Immunol</source>
        <year>2010</year>
        <volume>185</volume>
        <fpage>4625</fpage>
        <lpage>4632</lpage>
        <?supplied-pmid 20844204?>
        <pub-id pub-id-type="pmid">20844204</pub-id>
      </element-citation>
    </ref>
    <ref id="CR75">
      <label>75.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bentzen</surname>
            <given-names>AK</given-names>
          </name>
          <name>
            <surname>Hadrup</surname>
            <given-names>SR</given-names>
          </name>
        </person-group>
        <article-title>T-cell-receptor cross-recognition and strategies to select safe T-cell receptors for clinical translation</article-title>
        <source>Immunooncol Technol</source>
        <year>2019</year>
        <volume>2</volume>
        <fpage>1</fpage>
        <lpage>10</lpage>
        <?supplied-pmid 35036898?>
        <pub-id pub-id-type="pmid">35036898</pub-id>
      </element-citation>
    </ref>
    <ref id="CR76">
      <label>76.</label>
      <mixed-citation publication-type="other">Schmidt D &amp; Heckendorf C. ngram: Fast n-Gram ‘Tokenization’; 2021.</mixed-citation>
    </ref>
    <ref id="CR77">
      <label>77.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Koncz</surname>
            <given-names>B</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Self-mediated positive selection of T cells sets an obstacle to the recognition of nonself</article-title>
        <source>PNAS</source>
        <year>2021</year>
        <volume>118</volume>
        <fpage>e2100542118</fpage>
        <?supplied-pmid 34507984?>
        <pub-id pub-id-type="pmid">34507984</pub-id>
      </element-citation>
    </ref>
    <ref id="CR78">
      <label>78.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Buckley</surname>
            <given-names>PR</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>CH</given-names>
          </name>
          <name>
            <surname>Antanaviciute</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Simmons</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Koohy</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>A systems approach evaluating the impact of SARS-CoV-2 variant of concern mutations on CD8+ T cell responses</article-title>
        <source>Immunother Adv</source>
        <year>2021</year>
        <volume>3</volume>
        <fpage>ltad005</fpage>
      </element-citation>
    </ref>
    <ref id="CR79">
      <label>79.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Baker</surname>
            <given-names>RE</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Infectious disease in an era of global change</article-title>
        <source>Nat Rev Microbiol</source>
        <year>2022</year>
        <volume>20</volume>
        <fpage>193</fpage>
        <lpage>205</lpage>
        <?supplied-pmid 34646006?>
        <pub-id pub-id-type="pmid">34646006</pub-id>
      </element-citation>
    </ref>
    <ref id="CR80">
      <label>80.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zinkernagel</surname>
            <given-names>RM</given-names>
          </name>
          <name>
            <surname>Doherty</surname>
            <given-names>PC</given-names>
          </name>
        </person-group>
        <article-title>Restriction of in vitro T cell-mediated cytotoxicity in lymphocytic choriomeningitis within a syngeneic or semiallogeneic system</article-title>
        <source>Nature</source>
        <year>1974</year>
        <volume>248</volume>
        <fpage>701</fpage>
        <lpage>702</lpage>
        <?supplied-pmid 4133807?>
        <pub-id pub-id-type="pmid">4133807</pub-id>
      </element-citation>
    </ref>
    <ref id="CR81">
      <label>81.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>La Gruta</surname>
            <given-names>NL</given-names>
          </name>
          <name>
            <surname>Gras</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Daley</surname>
            <given-names>SR</given-names>
          </name>
          <name>
            <surname>Thomas</surname>
            <given-names>PG</given-names>
          </name>
          <name>
            <surname>Rossjohn</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Understanding the drivers of MHC restriction of T cell receptors</article-title>
        <source>Nat Rev Immunol</source>
        <year>2018</year>
        <volume>18</volume>
        <fpage>467</fpage>
        <lpage>478</lpage>
        <?supplied-pmid 29636542?>
        <pub-id pub-id-type="pmid">29636542</pub-id>
      </element-citation>
    </ref>
    <ref id="CR82">
      <label>82.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Duan</surname>
            <given-names>F</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Genomic and bioinformatic profiling of mutational neoepitopes reveals new rules to predict anticancer immunogenicity</article-title>
        <source>J Exp Med</source>
        <year>2014</year>
        <volume>211</volume>
        <fpage>2231</fpage>
        <lpage>2248</lpage>
        <?supplied-pmid 25245761?>
        <pub-id pub-id-type="pmid">25245761</pub-id>
      </element-citation>
    </ref>
    <ref id="CR83">
      <label>83.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chen</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Flies</surname>
            <given-names>DB</given-names>
          </name>
        </person-group>
        <article-title>Molecular mechanisms of T cell co-stimulation and co-inhibition</article-title>
        <source>Nat Rev Immunol</source>
        <year>2013</year>
        <volume>13</volume>
        <fpage>227</fpage>
        <lpage>242</lpage>
        <?supplied-pmid 23470321?>
        <pub-id pub-id-type="pmid">23470321</pub-id>
      </element-citation>
    </ref>
    <ref id="CR84">
      <label>84.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Achar</surname>
            <given-names>SR</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Universal antigen encoding of T cell activation from high-dimensional cytokine dynamics</article-title>
        <source>Science</source>
        <year>2022</year>
        <volume>376</volume>
        <fpage>880</fpage>
        <lpage>884</lpage>
        <?supplied-pmid 35587980?>
        <pub-id pub-id-type="pmid">35587980</pub-id>
      </element-citation>
    </ref>
    <ref id="CR85">
      <label>85.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cameron</surname>
            <given-names>BJ</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Identification of a titin-derived HLA-A1–presented peptide as a cross-reactive target for engineered MAGE A3–directed T cells</article-title>
        <source>Sci Transl Med</source>
        <year>2013</year>
        <volume>5</volume>
        <fpage>197ra103</fpage>
        <?supplied-pmid 23926201?>
        <pub-id pub-id-type="pmid">23926201</pub-id>
      </element-citation>
    </ref>
    <ref id="CR86">
      <label>86.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Leonard</surname>
            <given-names>JD</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Identification of natural regulatory T Cell epitopes reveals convergence on a dominant autoantigen</article-title>
        <source>Immunity</source>
        <year>2017</year>
        <volume>47</volume>
        <fpage>107</fpage>
        <lpage>117.e8</lpage>
        <?supplied-pmid 28709804?>
        <pub-id pub-id-type="pmid">28709804</pub-id>
      </element-citation>
    </ref>
    <ref id="CR87">
      <label>87.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Davis</surname>
            <given-names>MM</given-names>
          </name>
        </person-group>
        <article-title>Not-so-negative selection</article-title>
        <source>Immunity</source>
        <year>2015</year>
        <volume>43</volume>
        <fpage>833</fpage>
        <lpage>835</lpage>
        <?supplied-pmid 26588773?>
        <pub-id pub-id-type="pmid">26588773</pub-id>
      </element-citation>
    </ref>
    <ref id="CR88">
      <label>88.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Takada</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Takahama</surname>
            <given-names>Y</given-names>
          </name>
        </person-group>
        <article-title>Positive-selection-inducing self-peptides displayed by cortical thymic epithelial cells</article-title>
        <source>Adv Immunol</source>
        <year>2015</year>
        <volume>125</volume>
        <fpage>87</fpage>
        <lpage>110</lpage>
        <?supplied-pmid 25591465?>
        <pub-id pub-id-type="pmid">25591465</pub-id>
      </element-citation>
    </ref>
    <ref id="CR89">
      <label>89.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Klein</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Kyewski</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Allen</surname>
            <given-names>PM</given-names>
          </name>
          <name>
            <surname>Hogquist</surname>
            <given-names>KA</given-names>
          </name>
        </person-group>
        <article-title>Positive and negative selection of the T cell repertoire: what thymocytes see (and don’t see)</article-title>
        <source>Nat Rev Immunol</source>
        <year>2014</year>
        <volume>14</volume>
        <fpage>377</fpage>
        <lpage>391</lpage>
        <?supplied-pmid 24830344?>
        <pub-id pub-id-type="pmid">24830344</pub-id>
      </element-citation>
    </ref>
    <ref id="CR90">
      <label>90.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ebert</surname>
            <given-names>PJR</given-names>
          </name>
          <name>
            <surname>Jiang</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Xie</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>Q-J</given-names>
          </name>
          <name>
            <surname>Davis</surname>
            <given-names>MM</given-names>
          </name>
        </person-group>
        <article-title>An endogenous positively selecting peptide enhances mature T cell responses and becomes an autoantigen in the absence of microRNA miR-181a</article-title>
        <source>Nat Immunol</source>
        <year>2009</year>
        <volume>10</volume>
        <fpage>1162</fpage>
        <lpage>1169</lpage>
        <?supplied-pmid 19801983?>
        <pub-id pub-id-type="pmid">19801983</pub-id>
      </element-citation>
    </ref>
    <ref id="CR91">
      <label>91.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Freitag</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Hamdan</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Reddehase</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>Holtappels</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Immunodominant cytomegalovirus epitopes suppress subdominant epitopes in the generation of high-avidity CD8 T Cells</article-title>
        <source>Pathogens</source>
        <year>2021</year>
        <volume>10</volume>
        <fpage>956</fpage>
        <?supplied-pmid 34451420?>
        <pub-id pub-id-type="pmid">34451420</pub-id>
      </element-citation>
    </ref>
    <ref id="CR92">
      <label>92.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Peng</surname>
            <given-names>Y</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Broad and strong memory CD4+ and CD8+ T cells induced by SARS-CoV-2 in UK convalescent individuals following COVID-19</article-title>
        <source>Nat Immunol</source>
        <year>2020</year>
        <volume>21</volume>
        <fpage>1336</fpage>
        <lpage>1345</lpage>
        <?supplied-pmid 32887977?>
        <pub-id pub-id-type="pmid">32887977</pub-id>
      </element-citation>
    </ref>
    <ref id="CR93">
      <label>93.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ferretti</surname>
            <given-names>AP</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Unbiased screens show CD8+ T cells of COVID-19 patients recognize shared epitopes in SARS-CoV-2 that largely reside outside the spike protein</article-title>
        <source>Immunity</source>
        <year>2020</year>
        <volume>53</volume>
        <fpage>1095</fpage>
        <lpage>1107.e3</lpage>
        <?supplied-pmid 33128877?>
        <pub-id pub-id-type="pmid">33128877</pub-id>
      </element-citation>
    </ref>
    <ref id="CR94">
      <label>94.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mazor</surname>
            <given-names>R</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Identification and elimination of an immunodominant T-cell epitope in recombinant immunotoxins based on Pseudomonas exotoxin A</article-title>
        <source>Proc Natl Acad Sci</source>
        <year>2012</year>
        <volume>109</volume>
        <fpage>E3597</fpage>
        <lpage>E3603</lpage>
        <?supplied-pmid 23213206?>
        <pub-id pub-id-type="pmid">23213206</pub-id>
      </element-citation>
    </ref>
    <ref id="CR95">
      <label>95.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Irvine</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Bennink</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Factors influencing immunodominance hierarchies in TCD8+-mediated antiviral responses</article-title>
        <source>Expert Rev Clin Immunol</source>
        <year>2006</year>
        <volume>2</volume>
        <fpage>135</fpage>
        <lpage>147</lpage>
        <?supplied-pmid 20477094?>
        <pub-id pub-id-type="pmid">20477094</pub-id>
      </element-citation>
    </ref>
    <ref id="CR96">
      <label>96.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wellington</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Yin</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Kessler</surname>
            <given-names>BM</given-names>
          </name>
          <name>
            <surname>Dong</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>Immunodominance complexity: lessons yet to be learned from dominant T cell responses to SARS-COV-2</article-title>
        <source>Curr Opin Virol</source>
        <year>2021</year>
        <volume>50</volume>
        <fpage>183</fpage>
        <lpage>191</lpage>
        <?supplied-pmid 34534732?>
        <pub-id pub-id-type="pmid">34534732</pub-id>
      </element-citation>
    </ref>
    <ref id="CR97">
      <label>97.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kastenmuller</surname>
            <given-names>W</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Cross-competition of CD8+ T cells shapes the immunodominance hierarchy during boost vaccination</article-title>
        <source>J Exp Med</source>
        <year>2007</year>
        <volume>204</volume>
        <fpage>2187</fpage>
        <lpage>2198</lpage>
        <?supplied-pmid 17709425?>
        <pub-id pub-id-type="pmid">17709425</pub-id>
      </element-citation>
    </ref>
    <ref id="CR98">
      <label>98.</label>
      <mixed-citation publication-type="other">Lee CH. Repository for TRAP models and datasets. Google Drive; 2023. <ext-link ext-link-type="uri" xlink:href="https://drive.google.com/drive/folders/15A2P5xP2c-q48vVGPRB7h7uHEMycPYoX?usp=drive_link">https://drive.google.com/drive/folders/15A2P5xP2c-q48vVGPRB7h7uHEMycPYoX?usp=drive_link</ext-link>.</mixed-citation>
    </ref>
  </ref-list>
</back>
