<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Genome Biol</journal-id>
    <journal-id journal-id-type="iso-abbrev">Genome Biol</journal-id>
    <journal-title-group>
      <journal-title>Genome Biology</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1474-7596</issn>
    <issn pub-type="epub">1474-760X</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">6721208</article-id>
    <article-id pub-id-type="publisher-id">1788</article-id>
    <article-id pub-id-type="doi">10.1186/s13059-019-1788-y</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Method</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>MITRE: inferring features from microbiota time-series data linked to host status</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Bogart</surname>
          <given-names>Elijah</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Creswell</surname>
          <given-names>Richard</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-9149-5509</contrib-id>
        <name>
          <surname>Gerber</surname>
          <given-names>Georg K.</given-names>
        </name>
        <address>
          <email>ggerber@bwh.harvard.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ISNI">000000041936754X</institution-id><institution-id institution-id-type="GRID">grid.38142.3c</institution-id><institution>Massachusetts Host-Microbiome Center, Department of Pathology, Brigham and Women’s Hospital, </institution><institution>Harvard Medical School, </institution></institution-wrap>60 Fenwood Road, Boston, MA USA </aff>
      <aff id="Aff2"><label>2</label>Present address: Kintai Therapeutics, Inc., 26 Landsdowne Street Suite 450, Cambridge, MA 02139 USA </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>2</day>
      <month>9</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>2</day>
      <month>9</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2019</year>
    </pub-date>
    <volume>20</volume>
    <elocation-id>186</elocation-id>
    <history>
      <date date-type="received">
        <day>21</day>
        <month>11</month>
        <year>2018</year>
      </date>
      <date date-type="accepted">
        <day>9</day>
        <month>8</month>
        <year>2019</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s). 2019</copyright-statement>
      <license license-type="OpenAccess">
        <license-p><bold>Open Access</bold>This article is distributed under the terms of the Creative Commons Attribution 4.0 International License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <p id="Par1">Longitudinal studies are crucial for discovering causal relationships between the microbiome and human disease. We present MITRE, the Microbiome Interpretable Temporal Rule Engine, a supervised machine learning method for microbiome time-series analysis that infers human-interpretable rules linking changes in abundance of clades of microbes over time windows to binary descriptions of host status, such as the presence/absence of disease. We validate MITRE’s performance on semi-synthetic data and five real datasets. MITRE performs on par or outperforms conventional difficult-to-interpret machine learning approaches, providing a powerful new tool enabling the discovery of biologically interpretable relationships between microbiome and human host (<ext-link ext-link-type="uri" xlink:href="https://github.com/gerberlab/mitre/">https://github.com/gerberlab/mitre/</ext-link>).</p>
      <sec>
        <title>Electronic supplementary material</title>
        <p>The online version of this article (10.1186/s13059-019-1788-y) contains supplementary material, which is available to authorized users.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Microbiome</kwd>
      <kwd>Time series</kwd>
      <kwd>Longitudinal</kwd>
      <kwd>Machine learning</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000057</institution-id>
            <institution>National Institute of General Medical Sciences</institution>
          </institution-wrap>
        </funding-source>
        <award-id>R01GM130777-01</award-id>
        <principal-award-recipient>
          <name>
            <surname>Gerber</surname>
            <given-names>Georg K.</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000050</institution-id>
            <institution>National Heart, Lung, and Blood Institute</institution>
          </institution-wrap>
        </funding-source>
        <award-id>HL007627-33</award-id>
        <principal-award-recipient>
          <name>
            <surname>Bogart</surname>
            <given-names>Elijah</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100005292</institution-id>
            <institution>Brigham and Women's Hospital</institution>
          </institution-wrap>
        </funding-source>
        <award-id>Precision Medicine</award-id>
        <principal-award-recipient>
          <name>
            <surname>Gerber</surname>
            <given-names>Georg K.</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2019</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Introduction</title>
    <p id="Par2">The human microbiome is highly dynamic on multiple timescales, changing dramatically during the development of the gut in childhood, with diet, or due to medical interventions [<xref ref-type="bibr" rid="CR1">1</xref>]. Recently, a number of longitudinal studies have been undertaken, seeking to link the changes in the microbiota over time with medical interventions such as delivery by Cesarean section [<xref ref-type="bibr" rid="CR2">2</xref>], dietary changes [<xref ref-type="bibr" rid="CR3">3</xref>], or antibiotic treatment [<xref ref-type="bibr" rid="CR4">4</xref>], or with disease outcomes in the host such as type 1 diabetes [<xref ref-type="bibr" rid="CR5">5</xref>], dietary allergies [<xref ref-type="bibr" rid="CR6">6</xref>], premature delivery [<xref ref-type="bibr" rid="CR7">7</xref>, <xref ref-type="bibr" rid="CR8">8</xref>], necrotizing enterocolitis [<xref ref-type="bibr" rid="CR9">9</xref>, <xref ref-type="bibr" rid="CR10">10</xref>], and infection [<xref ref-type="bibr" rid="CR11">11</xref>, <xref ref-type="bibr" rid="CR12">12</xref>].</p>
    <p id="Par3">Deriving maximally useful information from these studies requires computational methods that can simultaneously identify patterns of change in the microbiome and link these patterns to the host’s status (e.g., disease outcome, presence or absence of an intervention). Moreover, such computational methods must contend with numerous challenges inherent to microbiome time-series data, including measurement noise, sparse and irregular temporal sampling, and inter-subject variability.</p>
    <p id="Par4">To overcome the challenges inherent in linking longitudinal microbiome data to host status, we developed MITRE, a computational model that infers human-interpretable predictive rules from high-throughput microbiome time-series data, implemented in an open-source software package (<ext-link ext-link-type="uri" xlink:href="https://github.com/gerberlab/mitre/)">https://github.com/gerberlab/mitre/</ext-link>) [<xref ref-type="bibr" rid="CR13">13</xref>]. MITRE falls into the general category of Bayesian supervised machine learning classifiers and predictive modeling: the algorithm uses a training dataset of microbiota time series and binary descriptions of host statuses (supervised learning) to learn a probability distribution (Bayesian inference) over a set of alternative models that predict the status of a host given only input microbiome data and optional covariates (classification). Bayesian approaches are powerful, because they provide principled estimates of uncertainty throughout the model, which is an especially important feature in biomedical applications where noisy inputs are the norm. We note that another rule-based method, association rule mining (ARM), has recently been applied to analyzing microbiome data in a different context (finding interaction patterns among OTUs) [<xref ref-type="bibr" rid="CR14">14</xref>]. Although ARM has some commonalities with Bayesian rule learning approaches, ARM methods tend to employ user-based cutoffs and heuristics, rather than principled probabilistic methods, as their primary function is to mine large databases for putative interactions, rather than build predictive models. Further, unlike Bayesian models, ARM methods do not incorporate prior knowledge, as their focus is mining from large databases.</p>
    <p id="Par5">In previous work, we presented the MDSINE [<xref ref-type="bibr" rid="CR15">15</xref>] algorithm, which infers dynamical systems models from microbiome time-series data in order to forecast the population dynamics of the microbiome over time. Our present work, MITRE, addresses a different question: can we predict or infer the status of the host <italic>given</italic> microbiome time-series data. From the machine learning perspective, MDSINE is an unsupervised model, whereas MITRE is a supervised model. The key distinction is that MDSINE models microbiome data, whereas MITRE instead models host outcomes. Like other supervised models, MITRE focuses on finding only the essential features (in this case, microbial clades and relevant time windows) to explain the outcome, rather than attempting to explain the microbiome data itself. This architecture is ideal for highly heterogeneous datasets with many “distractors,” which are the reality for longitudinal studies of the human microbiome. Supervised machine learning classifiers are employed in many biomedical predictive modeling applications, including forecasting (predicting a future outcome, such as the onset of disease, based on past data) and diagnosis or subtyping (predicting which category a subject belongs to based on all available data).</p>
    <p id="Par6">MITRE’s unique contributions are its modeling of the special properties of microbiome time-series data (phylogenetic and temporal relationships) and its emphasis on producing human-interpretable predictors. This latter capability is in contrast to various generic “black box” machine learning methods that have been applied to analyzing static microbiome data, such as random forests [<xref ref-type="bibr" rid="CR6">6</xref>, <xref ref-type="bibr" rid="CR16">16</xref>–<xref ref-type="bibr" rid="CR18">18</xref>], which may achieve high predictive accuracy but do not yield easily human-interpretable models; interpretability is especially challenging for such models in the context of time-series analyses, given repeated measurements and the fact that relevant dynamics may occur at multiple timescales. In the following sections, we introduce the MITRE framework, then provide benchmarking results of MITRE versus comparator methods on semi-synthetic data and five real microbiome time-series datasets, and finally illustrate examples of MITRE’s exploratory data analysis capabilities and how these can help extract biological insights.</p>
  </sec>
  <sec id="Sec2">
    <title>Results</title>
    <sec id="Sec3">
      <title>Conceptual overview of the MITRE model and software</title>
      <p id="Par7">Figure <xref rid="Fig1" ref-type="fig">1</xref> provides an overview of the MITRE framework. MITRE takes as input the following: (1) tables of microbial abundances, typically operational taxonomic units (OTUs) from 16S rRNA amplicon sequencing or species mappings from metagenomic data, measured over time for each host; (2) a binary (two-valued) description of the status of each host (e.g., phenotype A or phenotype B); (3) an optional set of static covariates for each host (e.g., gender); and (4) placements of the microbes on a reference phylogenic tree [<xref ref-type="bibr" rid="CR19">19</xref>].
<fig id="Fig1"><label>Fig. 1</label><caption><p>MITRE learns human-interpretable rule-based models linking features of microbiota time-series data to host status. Rules operate on automatically learned time periods and groups of phylogenetically related microbes. <bold>a</bold> Schematic of the MITRE analysis pipeline, resulting in a single best predictive model as well as a distribution over alternative models that can be interactively explored. <bold>b</bold> Schematic of example rule in <bold>a</bold> applied to hypothetical data. Here, two subjects satisfy both the condition on the average abundance of microbe group A and the rate of change of abundance of group B</p></caption><graphic xlink:href="13059_2019_1788_Fig1_HTML" id="MO1"/></fig></p>
      <p id="Par8">Because MITRE seeks to learn patterns of change over time in the microbiome that link to host status, it is necessary to provide MITRE with data with sufficient temporal sampling. At a minimum, MITRE requires 3 time points, although we recommend at least 6 time points and preferably at least 12 time points based on experiments with semi-synthetic data detailed in the subsequent section; the subsequent analysis also provides information about the performance of MITRE with differing numbers of subjects in a study. Although highly irregularly sampled time series (i.e., regions of dense sampling followed by widely separated time points) can in principle be used as input to MITRE, such data cannot be fully exploited by MITRE because the algorithm seeks to find contiguous stretches of time (windows) to assess the temporal changes. Thus, if using non-uniformly sampled data, we recommend at least 3 consecutive proximate time points in each non-uniformly sampled region. Beyond these basic guidelines, multiple factors must be considered for appropriate experimental design of longitudinal studies, including the timescale of the relevant biological processes under study (e.g., rapid changes in the microbiome due to diet versus prolonged recovery from antibiotic exposure), see for instance [<xref ref-type="bibr" rid="CR20">20</xref>, <xref ref-type="bibr" rid="CR21">21</xref>] for further discussion on this important topic.</p>
      <p id="Par9">MITRE automatically learns from the provided data predictive models that can be expressed as a set of conditional statements, or human-readable rules, about time-localized patterns of change in the abundances of groups of phylogenetically related organisms. Weighted sums of the truth values of the rules are used to predict the status of each host. The MITRE software package also provides a graphical user interface (GUI) for interactive visualization of the output, which summarizes the predictive models learned from the data.</p>
      <p id="Par10">To be more precise, a MITRE model consists of a baseline probability of a default host status plus a set of zero or more rules. Each rule is a conjunction of one or more <italic>detectors</italic>—conditional statements about bacterial abundances in the form “between times <italic>t</italic><sub><italic>0</italic></sub> and <italic>t</italic><sub><italic>1</italic></sub>, the average abundance of bacterial group <italic>j</italic> is [above/below] threshold <italic>θ</italic><sub><italic>l</italic></sub>” or “between times <italic>t</italic><sub><italic>0</italic></sub> and <italic>t</italic><sub><italic>1</italic></sub>, the slope of the abundance of bacterial group <italic>j</italic> is [above/below] threshold <italic>θ</italic><sub><italic>l</italic></sub>”—together with a multiplicative effect on the odds of the outcome of interest if all the detectors are satisfied.</p>
      <p id="Par11">As a simple example, a MITRE model predicting the odds of an infant developing a disease in the first year of life might be:
<list list-type="bullet"><list-item><p id="Par12">If, from month 2 to month 5, the average relative abundance of bacterial clade A is above 4.0%, and from month 5 to month 8, the relative abundance of bacterial clade B increases by at least 1.0% per month, the odds of disease increase by a factor of 10.</p></list-item><list-item><p id="Par13">If, from month 3 to month 10, the average relative abundance of OTU C is less than 9.5%, the odds of disease decrease by a factor of 2.</p></list-item><list-item><p id="Par14">The baseline probability of disease is 22.0%.</p></list-item></list></p>
      <p id="Par15">Figure <xref rid="Fig1" ref-type="fig">1</xref>b schematically illustrates the application of a rule set to hypothetical data. To predict the probability that an individual will develop the disease, the effects of each rule satisfied by that individual’s microbiome data are combined with the baseline disease probability.</p>
      <p id="Par16">A comprehensive pool of possible detectors is generated automatically at the beginning of a MITRE analysis, including the detectors that apply to average values and rates of change of clades at all levels on the phylogenetic tree of observed bacteria at as many time windows as the temporal resolution of the data will allow (see the “<xref rid="Sec9" ref-type="sec">Methods</xref>” section.) By combining the detectors from this pool, rules in a MITRE model can capture rich temporal patterns, but still remain human-interpretable because each component rule is easy to understand.</p>
      <p id="Par17">MITRE is a nonlinear model, which has a number of advantages over a linear model. Most obviously, nonlinear models can capture effects such as thresholds/saturation or interactions between variables. A more subtle issue, particularly relevant to microbiome ratio-based data, is that linear models introduce mathematical/statistical difficulties when analyzing compositional or proportional data. While special constraints are needed for linear models to overcome these difficulties [<xref ref-type="bibr" rid="CR22">22</xref>], nonlinear models do not suffer from the same limitations because they can inherently learn nonlinear transformations of the data. It is particularly straightforward to understand the transformations produced by the MITRE detectors described above: the learned thresholds effectively discretize ratio data into distinct levels, a transformation that renders the data mathematically non-compositional.</p>
      <p id="Par18">The MITRE framework is fully Bayesian, meaning it learns a distribution over models, called the posterior probability distribution, which takes into account both the input data and prior information provided. In the case of MITRE, this prior information favors by default parsimonious explanations, i.e., short sets of simple rules. Importantly, the default prior is designed to favor the empty rule set, or the case in which the baseline odds only are used to predict host status, and the microbiome data plays no role. This feature of the default prior is designed to guard against over-fitting. Moreover, through the formalism of Bayes factors (see the “<xref rid="Sec9" ref-type="sec">Methods</xref>” section), MITRE provides a quantitative measure for the evidence favoring no association between the microbiome data and host status or the alternative of any rule sets that predict such a relationship; this feature allows the user to rigorously evaluate whether sufficient signal is present in the microbiome data to predict host status. Of note, this measure in effect incorporates multiple “hypotheses” simultaneously (as the inference procedure explores the entire space of possible rule sets at once.) Additional Bayes factors allow the user to assess the evidence that each particular bacterial clade or OTU is associated with the host status, by comparing the evidence for a model in which no detector in the rule set applies to the clade of interest to a model in which at least one detector does apply to the clade.</p>
      <p id="Par19">The MITRE software approximately infers the posterior probability distribution using a custom Markov chain Monte Carlo algorithm and reports a <italic>point estimate</italic> of the single best rule set as well as a summary of the distribution, which the user may investigate interactively with the provided GUI. To make predictions for new data, either the point estimate or an <italic>ensemble</italic> of multiple rule sets, weighted according to their posterior probabilities, may be used.</p>
    </sec>
    <sec id="Sec4">
      <title>Benchmarking against standard machine learning methods: semi-synthetic data</title>
      <p id="Par20">We used semi-synthetic data to compare the cross-validated predictive performance of MITRE to two popular standard machine learning methods, random forests, and L1-regularized logistic regression, which have been widely used to analyze data from static microbiome studies. We tested the performance of MITRE and the comparator methods using cross-fold validation. In brief, a subset of the data, including both microbiome time-series measurements and host status labels, was used to train the models, and then model performance was tested by predicting the host status labels on the unseen data using only the microbiome time-series measurements as inputs; this process was repeated to cycle through the complete dataset. For each method, the performance was evaluated using the F1-score under cross-validation, converting modeled probabilities of outcomes to binary predictions by applying a threshold at probability 0.5. The F1-score is a widely used metric to assess the performance of machine learning binary classifier algorithms, which averages positive predictive value and sensitivity metrics, thus providing a useful summary that balances the assessment of the classifier algorithm’s rate of accurate positive prediction relative to all positive predictions made or relative to all positives in the dataset.</p>
      <p id="Par21">We simulated data from a real dataset using a parametric bootstrapping-type procedure, in which models of microbiome dynamics were employed to interpolate the real data and inject temporal perturbations into microbial clades to simulate a “disease” host phenotype (see the “<xref rid="Sec9" ref-type="sec">Methods</xref>” section for details). The real dataset [<xref ref-type="bibr" rid="CR2">2</xref>] we bootstrapped from tracked the gut microbiome composition from birth to 2 years of age in a cohort of US infants; we chose this dataset because it was among the densest and most regularly sampled of available time-series datasets, and also studied a relatively large number of subjects. To gain insight into the predictive performance of the different methods, we simulated data with varying numbers of subjects or time points, and one or two temporal perturbations to microbial clades to simulate subjects with a “disease.” In other words, for a single-clade perturbation, we assumed for subjects with a “disease” a systematic change over time in abundances of a single clade of microbes, and for a two-clade perturbation, we assumed systematic changes over time in abundances of two separate clades of microbes; these scenarios correspond to the results observed in real datasets as described below. We assumed the perturbations occur over a limited but unknown time period during the study (~ 20% of the study duration), which represents a challenging but biologically relevant scenario for analysis. The ranges of subjects and time points simulated correspond approximately to those in real studies and thus provide insight into the performance of the algorithms on realistically sized studies. Note that MITRE is a supervised machine learning method, which does not directly model the covariates (microbiome data.) Thus, our data simulation procedure is unrelated to the underlying MITRE model and not expected to introduce bias in favor of our method.</p>
      <p id="Par22">To provide as reasonable a comparison as possible, we used the average abundance of each OTU in a series of time windows as input to the comparator algorithms. It is important to note that there are no prior methods available that were specifically designed for supervised learning from microbiome time-series data. In fact, the comparator algorithms we implemented themselves represent an advance over the state of the art for many studies. To date, most studies have employed an ad hoc strategy of manually identifying time windows of interest within the experiment and then testing for a differential abundance of pre-specified groups of taxa in each time window separately. Such an approach has significant limitations. For example, effects occurring outside the defined windows or across their boundaries may not be detected, and analyzing each time window/taxon pair independently significantly reduces statistical power and precludes the discovery of interactions across taxa or sequences of events across multiple time windows.</p>
      <p id="Par23">Our results on semi-synthetic data over a range of scenarios (Fig. <xref rid="Fig2" ref-type="fig">2</xref>a–d) demonstrate superior cross-validated predictive performance of MITRE compared to the other methods. Several interesting trends are also evident from these results. First, the MITRE ensemble (use of multiple rule sets weighted according to their posterior probabilities) and point (estimate of single best rule set) methods have similar performance, except for in the setting of low numbers of subjects, which is likely simply a stochastic effect since all the methods in that setting have poor performance. The similar performance of the MITRE point and ensemble methods is very encouraging from the interpretability perspective, since the point method yields a single, human-interpretable rule set. Second, as expected, all of the methods improve in performance with increasing numbers of subjects, with eventual plateauing of gains in performance at a level ultimately limited by noise in the data. Third, there is also an improvement in performance with increasing numbers of time points, but this improvement is less impressive. This phenomenon can be partially explained by our assumption in generating the semi-synthetic data that perturbations corresponding to the “disease” phenotype occur over a limited time period during the study. Thus, sampling of more time points outside the perturbation period provides only limited additional information useful for prediction. Fourth and finally, we also see generally worse performance of all methods in the more complex setting of two perturbations in the “disease” cases, particularly with limited numbers of subjects or time points. Interestingly, random forests outperform L1-regularized logistic regression in the two-perturbation case in the setting of low numbers of subjects or time points, while the opposite is true in the one-perturbation case, which may be due to random forest’s capacity to handle nonlinearities. In any event, MITRE, which models nonlinearities through conjunctions in rules, consistently outperforms the other two methods in this setting as well. Overall, our results demonstrate that MITRE, a method specifically tailored for analyzing microbiome time-series data, outperforms generic machine learning methods. Moreover, we provide a simulation and testing platform for users to investigate the questions relevant to particular microbiome time-series datasets in the future.
<fig id="Fig2"><label>Fig. 2</label><caption><p>Cross-validated predictive performance of MITRE and comparator methods on semi-synthetic and real data. <bold>a</bold>–<bold>d</bold> Results on semi-synthetic data. A parametric bootstrapping-type method was used to generate simulated data from an underlying real dataset. Simulated cases were generated by randomly selecting and perturbing bacterial clades over a randomly selected limited time window (~ 20% of the duration of the study); an equal number of control subjects were simulated. For the one-clade perturbation scenarios, the clade remained unperturbed for the simulated cases; for the two-clade perturbation scenarios, one clade was perturbed in the simulated control subjects, and both were perturbed in the simulated cases. <bold>a</bold>, <bold>b</bold> One or two clades randomly perturbed in simulated subjects, 18 time points, varying numbers of subjects. <bold>c</bold>, <bold>d</bold> One or two clades randomly perturbed in simulated subjects, 32 subjects, varying numbers of time points. <bold>e</bold> Results on real data. The different methods were used to predict the indicated categories in the datasets shown. F1-score is the harmonic mean of precision and recall; higher scores indicate superior results</p></caption><graphic xlink:href="13059_2019_1788_Fig2_HTML" id="MO2"/></fig></p>
    </sec>
    <sec id="Sec5">
      <title>Benchmarking against standard machine learning methods: real data</title>
      <p id="Par24">We next evaluated the performance of MITRE on real experimental datasets with 16S rRNA amplicon and whole-genome shotgun metagenomic sequencing data, from five representative published studies with relatively dense temporal sampling and numbers of subjects. Vatanen et al. [<xref ref-type="bibr" rid="CR6">6</xref>] tracked the gut microbiome composition and life history data, including allergy diagnoses and serum IgE levels, from birth to 3 years of age in cohorts of infants at high risk for autoimmune disease in Finland, Estonia, and Russia. David et al. [<xref ref-type="bibr" rid="CR3">3</xref>] tracked the gut microbiome composition of healthy adults before, during, and after a 5-day period of consuming exclusively plant-based or exclusively animal-based diets. Bokulich et al. [<xref ref-type="bibr" rid="CR2">2</xref>] tracked the gut microbiome composition from birth to 2 years of age in a cohort of US infants and examined the effects of mode of delivery, diet, and antibiotic exposure. Kostic et al. [<xref ref-type="bibr" rid="CR5">5</xref>] tracked the gut microbiome of Finnish and Estonian infants at high risk for type 1 diabetes throughout the first years of life, examining the microbiome correlates of disease development. Finally, DiGiulio et al. [<xref ref-type="bibr" rid="CR7">7</xref>] tracked the composition of the vaginal microbiome in a cohort of pregnant women, investigating an association with premature delivery.</p>
      <p id="Par25">Using the microbiome and outcome/class data from these five studies, we defined a total of 11 representative microbiome-based prediction or classification tasks (e.g., given the vaginal microbiome data of DiGiulio et al., predict which women in the cohort experienced premature delivery; given the gut microbiome data of David et al., determine which time series correspond to exclusively animal-based diets versus exclusively plant-based diets). A full list of the tasks analyzed is given in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S1. In 5 out of the 11 tasks, we found that at least 1 of the methods performed well (F1-score &gt; 0.7, indicating reasonably high precision and recall). These tasks represent scenarios in which true biological signal may be present in the data and thus serve as the most meaningful basis for comparing the performance of the different methods. Detailed results for all methods on all tasks are given in Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Table S2.</p>
      <p id="Par26">Both the MITRE point estimate and ensemble methods achieved high accuracy on all five of the relevant prediction or classification tasks (Fig. <xref rid="Fig2" ref-type="fig">2</xref>e). In the case of distinguishing infants fed formula-based diets from those predominantly breast-fed (Bokulich et al.), predicting seroconversion to serum autoantibody positivity in infants at high risk of T1D (Kostic et al.), and predicting premature delivery (DiGiulio et al.), MITRE significantly outperformed the random forest and L1-regularized logistic regression approaches; for Russian cohort membership (Vatanen et al.) or plant-based diet (David et al.) prediction, MITRE performed on par with the best comparator method (random forest). These results are consistent with our semi-synthetic data simulations as well. Collectively, our results suggest that MITRE’s phylogenetic aggregation approach and robust use of the temporal structure of the data provide significant advantages for classification, and the increased interpretability of the MITRE point estimate comes at little if any cost in predictive accuracy.</p>
    </sec>
    <sec id="Sec6">
      <title>Model interpretability and exploratory analysis capabilities</title>
      <p id="Par27">We illustrate here an example demonstrating MITRE’s ability to achieve high accuracy while maintaining interpretability. The best (point estimate) rule set learned by MITRE to distinguish between predominantly formula-fed and predominantly breast-fed infants in the study of Bokulich et al. [<xref ref-type="bibr" rid="CR2">2</xref>] is “If, between the 1st day of life and the 156th day of life, the average abundance of clade 13241 increases faster than 0.03% per day, the probability that the subject was predominantly formula-fed is 79%; otherwise, that probability is 5.4%.” Though this MITRE rule set is simple enough to express in a single sentence, it outperforms the random forest models that aggregate the predictions of over a thousand decision trees (Fig. <xref rid="Fig2" ref-type="fig">2</xref>e). Moreover, this MITRE rule set lends itself readily to biological interpretation. Clade 13241 is a broad group of Firmicutes, including OTUs in the dataset mapping to <italic>Ruminococcus gnavus</italic>, <italic>Roseburia hominis</italic>, and several <italic>Clostridium</italic> and <italic>Blautia</italic> species. These species are generally viewed as more representative of adult or at least more mature microbiomes, being strict anaerobes with specialized carbon source utilization requirements and capabilities (e.g., [<xref ref-type="bibr" rid="CR23">23</xref>]), suggesting that the formula diet may shift infants toward more adult-like gut microbiota. Of note, the expressiveness and interpretability of the MITRE rule set format is retained even in cases of nonlinear interactions across multiple clades and time windows, see Additional file <xref rid="MOESM3" ref-type="media">3</xref>: Supplementary Note for an example.</p>
      <p id="Par28">In addition to providing the point estimate, which can serve as a powerful predictive model as described, MITRE also allows the user to explore the distribution of probable rules learned by the framework. Such explorations can be useful for further interpreting rule sets and generating biological hypotheses. Figure <xref rid="Fig3" ref-type="fig">3</xref> illustrates MITRE’s capabilities for interactive visualization of the distribution of learned rules. Heat maps as shown in Fig. <xref rid="Fig3" ref-type="fig">3</xref>a and d allow the user to examine the time windows and regions of the phylogenetic tree where the temporal changes in the microbiota are most strongly associated with the outcome of interest. In Fig. <xref rid="Fig3" ref-type="fig">3</xref>a–c, MITRE has been used to learn the rules that distinguish the microbial dynamics observed when the subjects in the study of David et al. [<xref ref-type="bibr" rid="CR3">3</xref>] were fed an exclusively plant-based diet for 5 days versus the dynamics observed when subjects were fed an exclusively animal-derived diet. The user has clicked on two areas on the heat map, revealing rules that apply to different time windows and different groups of OTUs in the order <italic>Clostridiales</italic>. The first rule set pertains to a clade containing <italic>Roseburia</italic> species, which are butyrate producers, whereas the second rule set pertains to a clade containing <italic>Dorea</italic> species, which produce other short-chain fatty acids including acetate and formate, but not butyrate. Thus, this capability to explore the distribution of rule sets allows the user to find evidence that the animal-based diet promotes two groups of phylogenetically distinct, and likely functionally distinct, groups of microbes.
<fig id="Fig3"><label>Fig. 3</label><caption><p>MITRE supports exploratory analyses through an interactive visualization interface. The interface allows the user to explore the distribution of learned rules. MITRE was applied to predict diet type from data from David et al. [<xref ref-type="bibr" rid="CR3">3</xref>] (<bold>a</bold>–<bold>c</bold>) or Bokulich et al. [<xref ref-type="bibr" rid="CR2">2</xref>] (<bold>d</bold>, <bold>e</bold>). In <bold>a</bold> and <bold>d</bold>, cell colors indicate the strength of evidence that the dynamics of an OTU, or one of its ancestors, during a time window is associated with diet. <bold>b</bold>, <bold>c</bold>, <bold>e</bold> High-probability detectors and phylogenetic subtrees to which they apply. <bold>b</bold>, <bold>c</bold> Analyses reveals dynamic behaviors of two different clades, one with butyrate producers and the other without, which distinguish subjects on plant- or animal-based diets. The animal-based diet thus promotes two groups of phylogenetically distinct microbes which are also likely functionally distinct. <bold>e</bold> Analyses reveal dynamic behavior of a clade of bacteria, associated with a more mature microbiome, which is increased in the predominantly formula-fed infants, suggesting the formula diet may shift infants toward more adult-like gut microbiota. Red lines, threshold slopes/abundances; black lines, median slopes/abundances. Median effect = median over all rules containing the detector</p></caption><graphic xlink:href="13059_2019_1788_Fig3_HTML" id="MO3"/></fig></p>
      <p id="Par29">As another example, Fig. <xref rid="Fig3" ref-type="fig">3</xref>d and e demonstrate the exploration of the posterior distribution of rule sets identifying the temporal patterns that distinguish the microbiota of predominantly formula-fed and predominantly breast-fed infants in the study of Bokulich et al. [<xref ref-type="bibr" rid="CR2">2</xref>], for which the point estimate described above performed well. The heat map of Fig. <xref rid="Fig3" ref-type="fig">3</xref>d shows that the high-posterior-probability rule sets are strongly focused on a single group of OTUs in the first 156 days of life. Figure <xref rid="Fig3" ref-type="fig">3</xref>e presents a particular detector, included in many such rule sets, that discriminates effectively between diet types in the training data (which is the detector used by MITRE to form the point estimate rule discussed above). Thus, in this case, the user finds evidence that the posterior distribution is essentially unimodal, with the point estimate alone characterizing the temporal differences between the formula and breast milk-fed infants well.</p>
    </sec>
  </sec>
  <sec id="Sec7">
    <title>Discussion</title>
    <p id="Par30">MITRE offers a number of advantages over generic statistical or machine learning methods. Incorporation of phylogenetic information readily allows for biological interpretation of results, as discussed, whereas standard classification methods that evaluate each taxon independently clearly do not have this advantage. MITRE automatically learns time windows that are relevant to predicting host status, as opposed to generic approaches that require the user to manually specify the periods of interest, which are generally unknown a priori. We have also highlighted the utility of MITRE’s human-readable rules. These rules can capture rich temporal patterns and nonlinear relationships among microbes, but remain interpretable, as they are composed of simple and understandable detectors. Indeed, as we have shown, MITRE rule sets are not only easy to understand, but a single MITRE rule can outperform black box machine learning methods that make predictions based on collections of hundreds to thousands of components, which are difficult to understand even individually.</p>
    <p id="Par31">Another important feature of the MITRE framework is that it is fully Bayesian. Bayesian models are increasingly being adopted in a variety of fields, in particular, for biomedical applications (e.g., [<xref ref-type="bibr" rid="CR24">24</xref>]), because they provide a unified framework that handles a number of key modeling and inferential issues, including incorporation of prior knowledge, accurate estimation of confidence in predictions, and principled comparisons of multiple models. Bayesian methods for model comparison have recently been highlighted as powerful alternatives [<xref ref-type="bibr" rid="CR25">25</xref>] to traditional <italic>p</italic> value-based hypothesis testing [<xref ref-type="bibr" rid="CR26">26</xref>], because Bayesian approaches allow direct comparison of multiple relevant alternative models, rather than just the ability to reject a null model that is often of little interest in itself. In particular, MITRE facilitates principled model comparisons by calculating Bayes factors [<xref ref-type="bibr" rid="CR27">27</xref>], which quantify the strength of the evidence provided by the data for each of a set of competing models. We have also described how the exploration of the posterior distribution of rule sets using the provided GUI in the MITRE software package allows the user to evaluate the possibility of multiple informative rule sets and formulate biological hypotheses about the dataset.</p>
    <p id="Par32">Although MITRE as currently implemented is primarily designed to use taxonomic abundance profiles derived from 16S rRNA amplicon sequencing or WGS metagenomics data as input—currently the most common data types in longitudinal microbiome studies—the model and software can readily incorporate other time series of additional data types, e.g., host physiological measurements, metabolomics, or metagenomics-derived functional profiles, as such data become more widely available. Other model features that could be readily added in the future include time-varying, continuous (e.g., quantitative host traits), and multiple host outcomes, e.g., multivariate host readouts such as blood pressure, blood glucose, and body weight.</p>
  </sec>
  <sec id="Sec8">
    <title>Conclusion</title>
    <p id="Par33">We have demonstrated that our software package MITRE overcomes unique challenges of linking microbiome time-series information to host outcomes, while drawing on a well-established tradition of rule-based techniques in machine learning and artificial intelligence [<xref ref-type="bibr" rid="CR28">28</xref>–<xref ref-type="bibr" rid="CR30">30</xref>], and can perform as well as or better than “black box” machine learning methods while maintaining interpretability. This latter feature is critical as microbiome analyses move into clinical applications, in which patients and physicians necessarily place a premium on transparency and interpretability of results. We have provided an open-source and user-friendly implementation of our method, which we expect will greatly aid investigators analyzing longitudinal host-microbiome studies and ultimately provide novel insights into the complex interplay between microbiome dynamics and host health and disease.</p>
  </sec>
  <sec id="Sec9">
    <title>Methods</title>
    <sec id="Sec10">
      <title>Operation of the software and input data requirements</title>
      <p id="Par34">The MITRE software is implemented in Python 2.7.3. MITRE and its dependencies are available through the Python Package Index, <ext-link ext-link-type="uri" xlink:href="http://pypi.python.org">pypi.python.org</ext-link>, facilitating installation across multiple platforms. The software is run from the command line, with parameters and other inputs specified using a straightforward configuration file format.</p>
      <p id="Par35">Each MITRE run requires four input files (for the standard case of 16S rRNA amplicon data): a table of OTU abundances in each sample, a table specifying the subject and time point associated with each sample, a table specifying the outcome (and optionally other data) associated with each subject, and phylogenetic placements of the OTUs on a reference tree. The user provides the three tables in comma-separated value format and phylogenetic placements in the .jplace format produced by pplacer. Alternative input data types, including taxonomic abundance profiles generated from WGS metagenomic data with Metaphlan, are described in the MITRE manual online.</p>
      <p id="Par36">The output of the software, described in detail below, includes textual summaries of a single best set of rules (the point estimate) and the distribution of probable alternative rule sets, as well as an HTML file providing a graphical interface for interactive visualization of the results.</p>
      <p id="Par37">Additional details of the method are found in Additional file <xref rid="MOESM4" ref-type="media">4</xref>.</p>
    </sec>
    <sec id="Sec11">
      <title>MITRE model details</title>
      <sec id="Sec12">
        <title>Mathematical basis of the MITRE model</title>
        <p id="Par38">MITRE can be expressed as a hierarchical generative model that generates sets of rules of the form described above. The generative process, starting at the top of the hierarchy, is as follows:
<list list-type="bullet"><list-item><p id="Par39">Sample a length <italic>K</italic> for the rule set</p></list-item><list-item><p id="Par40">For each rule <italic>k</italic> ∈ {1,…,<italic>K</italic>}, sample:
<list list-type="bullet"><list-item><p id="Par41">A weight <italic>β</italic><sub><italic>k</italic></sub></p></list-item><list-item><p id="Par42">A rule length <italic>L</italic><sub><italic>k</italic></sub> (number of detectors in the rule)</p></list-item><list-item><p id="Par43">The detectors <italic>d</italic> ∈ {1,…,<italic>L</italic><sub><italic>k</italic></sub>}, drawing from a pre-defined pool of detectors (see below) according to a probability distribution which is parameterized by the time window and bacterial group (phylogenetic subtrees) to which each detector applies</p></list-item></list></p></list-item></list></p>
        <p id="Par44">The rules are then weighted in a Bayesian logistic regression model to predict host status. To be precise, assume we have observations <italic>x</italic><sub><italic>ijt</italic></sub> for <italic>i</italic> = 1,2,…,<italic>N</italic><sub>subjects</sub> of relative abundances of bacterial OTUs <italic>j</italic> = 1,2,…,<italic>N</italic><sub>OTUs</sub> sampled at time points <italic>t</italic> = 1,2,…,<italic>N</italic><sub>samples,<italic>i</italic></sub>, as well as a binary status variable <italic>y</italic><sub><italic>i</italic></sub> for each host. The MITRE probability model can then be expressed as:
<disp-formula id="Equa"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\displaystyle \begin{array}{c}\kern0.75em {y}_i\sim \mathrm{Bernoulli}\left({p}_i\right)\\ {}\kern0.75em {p}_i=\frac{1}{1+{e}^{-{\psi}_i}}\\ {}\psi ={\beta}_0+A\left(R,x\right)\overrightarrow{\beta}\\ {}\beta \mid R\sim \mathrm{Normal}\left(0,{\sigma}_b^2I\right)\\ {}\kern0.75em {\beta}_0\sim \mathrm{Normal}\left(0,{\sigma}_b^2\right)\\ {}R\sim \pi \left(R,x.\right)\end{array}} $$\end{document}</tex-math><mml:math id="M2" display="block"><mml:mtable columnalign="center" displaystyle="true"><mml:mtr><mml:mtd><mml:mspace width="0.75em"/><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>~</mml:mo><mml:mtext>Bernoulli</mml:mtext><mml:mfenced close=")" open="("><mml:msub><mml:mi>p</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mfenced></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mspace width="0.75em"/><mml:msub><mml:mi>p</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:msub><mml:mi>ψ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:msup></mml:mrow></mml:mfrac></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi>ψ</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mi>A</mml:mi><mml:mfenced close=")" open="(" separators=","><mml:mi>R</mml:mi><mml:mi>x</mml:mi></mml:mfenced><mml:mover accent="true"><mml:mi>β</mml:mi><mml:mo stretchy="true">→</mml:mo></mml:mover></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi>β</mml:mi><mml:mo>∣</mml:mo><mml:mi>R</mml:mi><mml:mo>~</mml:mo><mml:mtext>Normal</mml:mtext><mml:mfenced close=")" open="(" separators=","><mml:mn>0</mml:mn><mml:mrow><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>b</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mi>I</mml:mi></mml:mrow></mml:mfenced></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mspace width="0.75em"/><mml:msub><mml:mi>β</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>~</mml:mo><mml:mtext>Normal</mml:mtext><mml:mfenced close=")" open="(" separators=","><mml:mn>0</mml:mn><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>b</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mfenced></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi>R</mml:mi><mml:mo>~</mml:mo><mml:mi>π</mml:mi><mml:mfenced close=")" open="(" separators=","><mml:mi>R</mml:mi><mml:mrow><mml:mi>x</mml:mi><mml:mo>.</mml:mo></mml:mrow></mml:mfenced></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="13059_2019_1788_Article_Equa.gif" position="anchor"/></alternatives></disp-formula></p>
        <p id="Par45">Here, <italic>R</italic> is a set of rules, and <italic>A</italic>(<italic>R</italic>,<italic>x</italic>) is the matrix whose entry <italic>A</italic><sub><italic>ik</italic></sub> is 1 if the data from subject <italic>i</italic> satisfies the conditions of all detectors in the <italic>k</italic>th rule in the set, and zero otherwise. Conditional on <italic>R</italic>, this is a standard Bayesian logistic regression model, whose covariates are the truth values of the rules in <italic>R</italic> (along with an offset term modeling baseline odds). MITRE also allows the optional inclusion of static non-microbiome covariates, see Additional file <xref rid="MOESM3" ref-type="media">3</xref>: Supplementary Note for complete details.</p>
        <p id="Par46">The prior probability distribution over rule sets, <italic>π</italic>(<italic>R</italic>,<italic>x</italic>), is a mixture over the probability <italic>Θ</italic><sub>empty</sub> for an empty rule set <italic>R</italic><sub><italic>0</italic></sub> versus a truncated negative binomial distribution for the length of a non-empty rule set. For a non-empty rule set, the prior further models the distribution over detectors that comprise each rule, taking into account the length of the time window for the detector and an associated position on the phylogenetic tree. Hyperparameters for these priors, as well as priors on other variables, complete the model. A full specification of priors in MITRE and a discussion of sensitivity to the choice of hyperparameters are given in Additional file <xref rid="MOESM3" ref-type="media">3</xref>: Supplementary Note.</p>
      </sec>
      <sec id="Sec13">
        <title>Generation of pools of detectors from data</title>
        <p id="Par47">MITRE generates a comprehensive pool of detectors from the supplied data and user-specified parameters <italic>t</italic><sub>min</sub>, <italic>t</italic><sub>max</sub>, <italic>N</italic><sub><italic>w</italic></sub>, and <italic>N</italic><sub><italic>θ</italic></sub>, as follows:
<list list-type="order"><list-item><p id="Par48">Divide the duration of the experiment/observations into <italic>N</italic><sub><italic>w</italic></sub> equal basic time windows and enumerate all combinations of 1 or more consecutive basic time windows that are longer than <italic>t</italic><sub>min</sub> and shorter than <italic>t</italic><sub>max</sub> and during which at least one sample was collected for every subject.</p></list-item><list-item><p id="Par49">Within each such time window (<italic>t</italic><sub><italic>0</italic></sub>, <italic>t</italic><sub><italic>1</italic></sub>), for each bacterial group (phylogenetic subtree) <italic>j</italic>, calculate the average abundance of the group in each subject <italic>i</italic> and sort those values, obtaining <italic>v</italic><sub><italic>1</italic></sub> ≤ <italic>v</italic><sub><italic>2</italic></sub> ≤ … ≤ <italic>v</italic><sub><italic>N</italic>subjects</sub>. If <italic>N</italic><sub>subjects</sub> &lt; <italic>N</italic><sub><italic>θ</italic></sub> + 1, for <italic>l</italic> = 1,2,…,<italic>N</italic><sub>subjects</sub>-1, let <italic>θ</italic><sub><italic>l</italic></sub> = (<italic>v</italic><sub><italic>l</italic></sub> + <italic>v</italic><sub><italic>l + 1</italic></sub>)/2 and add the detectors “between <italic>t</italic><sub><italic>0</italic></sub> and <italic>t</italic><sub><italic>1</italic></sub>, the average abundance of group <italic>j</italic> is above <italic>θ</italic><sub><italic>l</italic></sub>” and “between <italic>t</italic><sub><italic>0</italic></sub> and <italic>t</italic><sub><italic>1</italic></sub>, the average abundance of group <italic>j</italic> is below <italic>θ</italic><sub><italic>l</italic></sub>” to the population. If instead <italic>N</italic><sub>subjects</sub> &gt; <italic>N</italic><sub><italic>θ</italic></sub>, hierarchically cluster the values <italic>v</italic><sub><italic>0</italic></sub>, …, <italic>v</italic><sub><italic>N</italic>subjects</sub> into the <italic>N</italic><sub><italic>θ</italic></sub> groups, let <italic>θ</italic><sub><italic>l</italic></sub> be the midpoint between cluster <italic>l</italic> and cluster <italic>l + 1</italic>, for <italic>l</italic> = 1,2,…, <italic>N</italic><sub><italic>θ</italic></sub> − 1, and add the detectors corresponding to those thresholds instead.</p></list-item><list-item><p id="Par50">Then, repeat the process for all combinations of one or more consecutive basic time windows longer than <italic>t</italic><sub>min</sub> and shorter than <italic>t</italic><sub>max</sub> during which at least two samples were collected for every subject, calculating the slope of the abundance of each group <italic>j</italic> in each subject <italic>i</italic> during each such window, and adding the detectors “If, between <italic>t</italic><sub>0</sub> and <italic>t</italic><sub>1</sub>, the slope of the abundance of group <italic>j</italic> is [above/below] <italic>θ</italic><sub><italic>l</italic></sub>” to the population (again carrying out a clustering process to reduce the number of threshold values to <italic>N</italic><sub><italic>θ</italic></sub>, if needed.)</p></list-item></list></p>
        <p id="Par51">The runtime of the inference algorithm (described below) depends approximately linearly on the size of the detector pool; thus, the choice of parameters <italic>t</italic><sub>min</sub>, <italic>t</italic><sub>max</sub>, <italic>N</italic><sub><italic>w</italic></sub>, and <italic>N</italic><sub><italic>θ</italic></sub> controls a tradeoff between high resolution (temporally, and in the space of threshold values for OTU abundance/slope) and performance. It is recommended to choose <italic>N</italic><sub><italic>w</italic></sub> as large as possible while ensuring that most basic time windows include at least one observation from every subject, and to set <italic>N</italic><sub><italic>θ</italic></sub> = 40; <italic>t</italic><sub>min</sub> should generally be set to 0 and <italic>t</italic><sub>max</sub> to either the duration of the study or (to enforce temporal localization of the rules in cases where, e.g., dramatic increases in abundance at a well-defined time also lead to notable increases in average abundance over the period of the entire study) half that duration, but may be adjusted if dynamics on a particular timescale are of a priori interest.</p>
      </sec>
      <sec id="Sec14">
        <title>Model inference</title>
        <p id="Par52">We perform approximate Bayesian inference, to learn the posterior distribution over the model parameters including rule sets <italic>R</italic> and regression coefficients <italic>β.</italic> MITRE employs a custom Markov chain Monte Carlo (MCMC) algorithm, which alternates efficient updates of the regression coefficients using a Polya-Gamma auxiliary variable scheme [<xref ref-type="bibr" rid="CR31">31</xref>], Metropolis-Hastings update steps that propose changes to the rule set <italic>R</italic> and updates to the hyperparameters governing the prior distribution over rule sets. The MCMC algorithm is described in detail in Additional file <xref rid="MOESM3" ref-type="media">3</xref>: Supplementary Note. Briefly, four types of updates to <italic>R</italic> are considered:
<list list-type="order"><list-item><p id="Par53">A randomly chosen detector in <italic>R</italic> may be replaced by another detector from the pool.</p></list-item><list-item><p id="Par54">A randomly chosen detector in <italic>R</italic> may be removed from <italic>R</italic> (if it is the only detector in a rule, the rule is removed as well).</p></list-item><list-item><p id="Par55">A detector from the pool may be added to <italic>R</italic>, either to an existing rule chosen at random, or to form a new rule of length 1.</p></list-item><list-item><p id="Par56">A detector may be moved from one rule in <italic>R</italic> to another.</p></list-item></list></p>
        <p id="Par57">For the analyses presented here, 50,000 samples were drawn from the posterior distribution (except for analyses of data from Vatanen et al. [<xref ref-type="bibr" rid="CR6">6</xref>], where 25,000 samples were used, and Kostic et al. [<xref ref-type="bibr" rid="CR5">5</xref>], where 100,000 samples were used.) Mixing of the MCMC sampler was assessed using the diagnostics described in Additional file <xref rid="MOESM3" ref-type="media">3</xref>: Supplementary Note; we recommend users employ these diagnostics to determine the appropriate number of samples needed for their particular studies.</p>
        <p id="Par58">Run time depends on the size and complexity of the dataset; using a single Intel Xeon CPU (E5-2697 v3 2.60GHz), sampling took 45 min for the data of DiGiulio et al. [<xref ref-type="bibr" rid="CR7">7</xref>], 23 h for the data of David et al. [<xref ref-type="bibr" rid="CR3">3</xref>], 30 h for the data of Bokulich et al. [<xref ref-type="bibr" rid="CR2">2</xref>], and 64.5 h for the data of Vatanen et al. [<xref ref-type="bibr" rid="CR6">6</xref>]. Cross-validation was performed in parallel (onefold/core) requiring similar total elapsed time for each study.</p>
      </sec>
      <sec id="Sec15">
        <title>Data simulation</title>
        <p id="Par59">We simulated from the Bokulich et al. [<xref ref-type="bibr" rid="CR2">2</xref>] dataset using a parametric bootstrapping-style procedure. Simulated subjects were sampled with replacement from the set of control subjects in the real data. Equal numbers of simulated cases and control subjects were generated for each scenario. In order to have sufficient real data to bootstrap to evaluate the range of scenarios of interest, we excluded subjects with fewer than 13 time points sampled, who had no samples before 10 days, and who were studied for less than 600 days; this yielded 20 subjects for bootstrapping. We then truncated the data to an interval between 10 and 600 days, since this contained the densest sampling across subjects.</p>
        <p id="Par60">Perturbations of duration 120 days, in time windows randomly occurring throughout the experiment, were introduced into randomly selected clade(s) to simulate cases, with the magnitude of the perturbation distributed among clade members according to the relative abundance of members in the original data. The duration of the perturbation(s) was chosen to be approximately of the order of that seen with the MITRE point rule on the real dataset. Perturbations were introduced randomly into the clades with the following characteristics: minimum average relative abundance of 0.1%, maximum average relative abundance of 20%, and a maximum of 30 OTUs in the clade. These parameters were chosen so as to provide a meaningful relative disturbance to other clades, but not to drastically disrupt the entire microbiome (which would present less of a challenge to the prediction algorithms.) The magnitude of perturbation(s) was sampled for each subject from log-normal distributions, with mean and variance of the order of that seen with the MITRE point rule on the real dataset (control log mean = − 6, control std. = 1.5, case log mean = − 3, case log std. = 1.5). When two perturbations were applied, each control subject received only one perturbation, whereas case subjects received both perturbations.</p>
        <p id="Par61">Note that MITRE is a supervised learning (conditional) method, meaning that the microbiome data itself is not modeled; to simulate the time points not present in the original dataset, we therefore must introduce a model of microbiome dynamics. We model the underlying microbiome data as arising from latent time-dependent stochastic processes (Gaussian random walks):
<disp-formula id="Equb"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {x}_{os}(t)\sim {\mathrm{Normal}}_{+}\left({x}_{os}\left(t-1\right),\Delta  t{\tau}^2\right) $$\end{document}</tex-math><mml:math id="M4" display="block"><mml:msub><mml:mi>x</mml:mi><mml:mi mathvariant="italic">os</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:mi>t</mml:mi></mml:mfenced><mml:mo>~</mml:mo><mml:msub><mml:mtext>Normal</mml:mtext><mml:mo>+</mml:mo></mml:msub><mml:mfenced close=")" open="(" separators=","><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi mathvariant="italic">os</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mi>∆</mml:mi><mml:mi>t</mml:mi><mml:msup><mml:mi>τ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfenced></mml:math><graphic xlink:href="13059_2019_1788_Article_Equb.gif" position="anchor"/></alternatives></disp-formula></p>
        <p id="Par62">Here, <italic>x</italic><sub><italic>os</italic></sub>(<italic>t</italic>) is the latent trajectory for OTU <italic>o</italic> in subject <italic>s</italic> at time <italic>t</italic>, and <italic>τ</italic><sup><italic>2</italic></sup> is the process variance parameter, which is empirically estimated from the real data as approximately the 75-percentile variance. We assume a Bayesian model and infer the posterior latent trajectories using a 1-step ahead MCMC algorithm similar to our previously described method [<xref ref-type="bibr" rid="CR32">32</xref>], except in this case, trajectories are assumed to be independent of one another.</p>
        <p id="Par63">The observed data <italic>c</italic><sub><italic>s</italic></sub>(<italic>t</italic>), consisting of sequencing counts, is assumed to arise through a two-stage error model:
<disp-formula id="Equc"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\displaystyle \begin{array}{c}{y}_{os}(t)\sim {\mathrm{Normal}}_{+}\left({x}_{os}(t),\theta {x}_{os}(t)\right)\\ {}{m}_s(t)=\sum \limits_o{y}_{os}(t)\\ {}{C}_s(t)\sim \mathrm{DMD}\left({y}_s(t)/{m}_s(t),\alpha, N\right)\end{array}} $$\end{document}</tex-math><mml:math id="M6" display="block"><mml:mtable columnalign="center" displaystyle="true"><mml:mtr><mml:mtd><mml:msub><mml:mi>y</mml:mi><mml:mi mathvariant="italic">os</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:mi>t</mml:mi></mml:mfenced><mml:mo>~</mml:mo><mml:msub><mml:mtext>Normal</mml:mtext><mml:mo>+</mml:mo></mml:msub><mml:mfenced close=")" open="(" separators=","><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi mathvariant="italic">os</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:mi>t</mml:mi></mml:mfenced></mml:mrow><mml:mrow><mml:mi>θ</mml:mi><mml:msub><mml:mi>x</mml:mi><mml:mi mathvariant="italic">os</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:mi>t</mml:mi></mml:mfenced></mml:mrow></mml:mfenced></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mi>m</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:mi>t</mml:mi></mml:mfenced><mml:mo>=</mml:mo><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mi>o</mml:mi></mml:munder><mml:msub><mml:mi>y</mml:mi><mml:mi mathvariant="italic">os</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:mi>t</mml:mi></mml:mfenced></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mi>C</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:mi>t</mml:mi></mml:mfenced><mml:mo>~</mml:mo><mml:mi>DMD</mml:mi><mml:mfenced close=")" open="(" separators=",,"><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:mi>t</mml:mi></mml:mfenced><mml:mo>/</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:mi>t</mml:mi></mml:mfenced></mml:mrow><mml:mi>α</mml:mi><mml:mi>N</mml:mi></mml:mfenced></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="13059_2019_1788_Article_Equc.gif" position="anchor"/></alternatives></disp-formula></p>
        <p id="Par64">Here, DMD denotes the Dirichlet-Multinomial distribution with concentration parameter <italic>α</italic> and number of simulated sequencing reads per sample <italic>N</italic>; we use parameters estimated from data (<italic>α</italic> = 286; <italic>N</italic> = 50,000) as previously described [<xref ref-type="bibr" rid="CR15">15</xref>].</p>
        <p id="Par65">The model thus provides temporal coherence through the Gaussian random walk latent trajectory, while modeling compositionality and over-inflation through the two-stage error model. Posterior samples from the model capture temporal trends seen in the real data (e.g., periods of time in which a particular OTU are increasing), but with randomness introduced so that subjects sampled with replacement look sufficiently different.</p>
        <p id="Par66">For each scenario simulated (e.g., a particular number of time points or subjects), 10 independent simulations were performed. To investigate the effects of varying the number of subjects, we fixed the simulation at an intermediate number of time points (18) and simulated different numbers of subjects. Similarly, to investigate the effects of varying the number of time points, we fixed the simulation at an intermediate number of subjects (32) and simulated different numbers of time points. To facilitate comparisons, we sampled evenly spaced time points in all cases. The simulated data were then provided to the MITRE and the other methods in the same input format as for real data, as described below. Complete Python code to reproduce the simulations is available in the MITRE online repository.</p>
      </sec>
      <sec id="Sec16">
        <title>Output</title>
        <p id="Par67">MITRE generates several summaries from the posterior samples obtained from the MCMC inference procedure described above. The <italic>point estimate</italic> is a single rule set <italic>R*</italic> (with coefficients <italic>β*</italic>) that summarizes the mode of the posterior distribution. If the posterior probability that <italic>R</italic> is empty is greater than 0.5, the point estimate is the empty rule set. Otherwise, to obtain a representative non-empty summary list, we determine the posterior mode <italic>d*</italic> of the total number of detectors in <italic>R</italic> and take <italic>R*</italic> to be the rule set with the highest posterior probability among all sampled rule sets that contain <italic>d*</italic> total detectors. The point estimate coefficients <italic>β*</italic> are the highest posterior probability sampled coefficients associated with <italic>R*.</italic></p>
        <p id="Par68">To provide an overview of the possible alternative rule sets learned by the model, rule sets in the posterior samples are clustered and a summary of the highest probability clusters is produced. The clustering process first forms clusters of detectors that apply to the average value or slope of the same variable in highly overlapping time windows (ignoring threshold values), then clusters together rules whose component detectors belong to the same clusters, and finally groups rule sets whose rules belong to the same clusters (see Additional file <xref rid="MOESM3" ref-type="media">3</xref>: Supplementary Note for a full description.) For each cluster, a representative rule set and the estimated posterior probability that <italic>R*</italic> belongs to the cluster are reported.</p>
        <p id="Par69">Calculation of the Bayes factor for the empty rule set <italic>R</italic><sub>0</sub> (versus any non-empty <italic>R</italic>) and two additional types of Bayes factors, indicating the relevance of phylogenetic subtrees or time windows, is described in Additional file <xref rid="MOESM3" ref-type="media">3</xref>: Supplementary Note.</p>
        <p id="Par70">Finally, MITRE generates an interactive graphical visualization of the posterior distribution of rule sets. A heatmap of the Bayes factors for leaf variable/basic time window combinations is rendered alongside the bacterial phylogeny (as in Fig. <xref rid="Fig3" ref-type="fig">3</xref>a, d); clicking on any cell allows the visualization of the detectors associated with the cell with the largest Bayes factors (as in Fig. <xref rid="Fig3" ref-type="fig">3</xref>b–c, e.)</p>
      </sec>
      <sec id="Sec17">
        <title>Data preprocessing and filtering</title>
        <p id="Par71">MITRE offers a number of user-configurable options for preprocessing and filtering microbiome time-series data. The following procedure is recommended and was used for the results presented here (except as noted below):
<list list-type="order"><list-item><p id="Par72">To remove potentially spurious rare OTUs, discard all OTUs with less than <italic>N</italic><sub>counts,OTU</sub> observed across all samples (typically <italic>N</italic><sub>counts,OTU</sub> = 10).</p></list-item><list-item><p id="Par73">To exclude samples where coverage is so low that abundance estimates for uncommon OTUs may be unreliable, discard all samples with less than <italic>N</italic><sub>counts,sample</sub> total counts observed across all remaining OTUs (typically <italic>N</italic><sub>counts,sample</sub> = 5000 for HiSeq/MiSeq data).</p></list-item><list-item><p id="Par74">If desired, to analyze only a particular time period (because, e.g., samples are not available outside that period for the majority of subjects) discard all samples before time <italic>t</italic><sub><italic>i</italic></sub> and after time <italic>t</italic><sub><italic>f</italic></sub> (by default, <italic>t</italic><sub><italic>i</italic></sub> is the time of the earliest available sample, and <italic>t</italic><sub><italic>f</italic></sub> the time of the latest sample).</p></list-item><list-item><p id="Par75">To exclude subjects for whom microbiome dynamics cannot be resolved at the desired temporal resolution throughout the entire study, discard the subjects with too few, or too sparse, observation points, by dividing the duration of the study into <italic>N</italic><sub><italic>w</italic>,filter</sub> equal pieces and keeping only subjects with at least <italic>N</italic><sub><italic>s</italic></sub> samples in any <italic>N</italic><sub><italic>c</italic></sub> consecutive such pieces. Default values are <italic>N</italic><sub><italic>w</italic>,filter</sub> = 10, <italic>N</italic><sub><italic>s</italic></sub> <italic>=</italic> 2, and <italic>N</italic><sub><italic>c</italic></sub> = 1; note that for data with very inconsistent sampling, these parameters must be chosen judiciously to maximize the number of subjects included while allowing an acceptable level of temporal resolution.</p></list-item></list></p>
        <p id="Par76">After these steps, counts data are converted to relative abundance data for each sample, and, for each node in the phylogenetic tree, a relative abundance estimate is obtained by summing the relative abundances of its children. The following filtering steps are then applied to all taxa (both OTUs and higher nodes in the tree):
<list list-type="simple"><list-item><label>5.</label><p id="Par77">To exclude low abundance taxa (for which abundance estimates may be inaccurate) or infrequently observed taxa (which we expect are unlikely to be explanatory, though higher taxa including them may be), discard all taxa except those that exceed a threshold abundance <italic>a</italic> in at least <italic>N</italic><sub><italic>a</italic></sub> consecutive samples in at least <italic>N</italic><sub><italic>i</italic></sub> subjects. Typically, <italic>N</italic><sub><italic>a</italic></sub> <italic>=</italic> 2. Appropriate values for <italic>a</italic> and <italic>N</italic><sub><italic>i</italic></sub> depend on the number of subjects and typical reads per sample; for studies with 10–150 subjects and average reads per sample on the order of 10<sup>4</sup>, we recommend <italic>a =</italic> 10<sup>−4</sup> and <italic>N</italic><sub><italic>i</italic></sub> = 4 or 10% of the number of subjects, whichever is larger.</p></list-item><list-item><label>6.</label><p id="Par78">To minimize redundancy, discard all taxa corresponding to the nodes in the phylogenetic tree with exactly one remaining child taxon, as their temporal patterns are often very similar to those of their children.</p></list-item></list></p>
        <p id="Par79">Note that when a large number of taxa are considered, the detector pool becomes large and the computational cost of the inference algorithm grows; if necessary, it is recommended to increase the stringency of steps 5 and 6 to keep the total number of taxa below 500.</p>
      </sec>
      <sec id="Sec18">
        <title>Bioinformatics and preprocessing for analyzed datasets</title>
        <p id="Par80">For each 16S-based dataset to which MITRE was applied, the original 16S rRNA amplicon sequencing data was reprocessed to obtain tables of OTU abundances and phylogenetic placements for each OTU on a reference tree, using as consistent an analysis process as possible given the differences in sequencing methodology and the nature of the available data. Where possible, DADA2 1.1.5 [<xref ref-type="bibr" rid="CR33">33</xref>] was used to trim, quality filter, merge, and remove chimeras from the reads, assign them to inferred true sequences, and classify the inferred sequences taxonomically (such classification is not necessary for MITRE application but is helpful for interpretation of the results.) Inferred sequences were then placed on a reference tree generated from full-length or near full-length (&gt; 1200 nt) 16S rDNA sequences of type strains from the Ribosomal Database Project [<xref ref-type="bibr" rid="CR34">34</xref>] using pplacer [<xref ref-type="bibr" rid="CR19">19</xref>]. When quality scores for sequences were not available and DADA2 could not be used, sequences were instead processed using mothur 1.35.1 [<xref ref-type="bibr" rid="CR35">35</xref>, <xref ref-type="bibr" rid="CR36">36</xref>] for denoising, quality filtering, alignment against the ARB Silva 16S gene sequence reference database, clustering into OTUs at 97% identity, and taxonomic classification. For the WGS metagenomics data of Kostic et al. [<xref ref-type="bibr" rid="CR5">5</xref>], published taxonomic abundance tables were used directly as input data to MITRE, exploiting MITRE’s built-in support for parsing Metaphlan result tables, described in the MITRE manual. Full details regarding the preprocessing of all datasets are described in Additional file <xref rid="MOESM3" ref-type="media">3</xref>: Supplementary Note.</p>
        <p id="Par81">After reanalyzing the sequencing data for each study and excluding subjects with infrequent sampling (see description of filtering methods above), we applied MITRE and the comparator methods to classify the subjects according to relevant categories: membership in the Russian cohort (<italic>n</italic> = 30), elevated IgE levels (<italic>n</italic> = 28), diagnosis with any allergy (<italic>n</italic> = 49), any dietary allergy (<italic>n</italic> = 42), with dairy allergy (<italic>n</italic> = 32), or with egg allergy (<italic>n</italic> = 25) in the data of Vatanen et al. (<italic>n</italic> = 113 total for nationality; <italic>n</italic> = 109 total for all other outcomes); formula-dominant diet (<italic>n</italic> = 11) or Cesarean delivery (<italic>n</italic> = 13) in the data of Bokulich et al. (<italic>n</italic> = 35 total); seroconversion (<italic>n</italic> = 11) in the data of Kostic et al. (<italic>n</italic> = 19 total); premature delivery (<italic>n</italic> = 6) in the data of DiGiulio et al. (<italic>n</italic> = 37 total); and plant-based diet (<italic>n</italic> = 10) in the data of David et al. (<italic>n</italic> = 20 total.)</p>
      </sec>
      <sec id="Sec19">
        <title>Comparison methods</title>
        <p id="Par82">To compare MITRE’s predictive performance to alternative methods, each OTU’s abundance data for each subject was averaged across all observations within each set of time windows, defined by dividing the experiment into <italic>N</italic><sub><italic>w</italic>,comparison</sub> equal intervals and taking any consecutive <italic>N</italic><sub><italic>c</italic>,comparison</sub> such intervals as a valid time window. Parameters were chosen to maximize temporal resolution while ensuring that each time window still contained at least one observation for each subject. Note that the same subjects were used (i.e., those not excluded by the preprocessing settings described above) for both MITRE and the comparison methods. For David et al. [<xref ref-type="bibr" rid="CR3">3</xref>], <italic>N</italic><sub><italic>w</italic>,comparison</sub> = 10 and <italic>N</italic><sub><italic>c</italic>,comparison</sub> = 3; for Vatanen et al. [<xref ref-type="bibr" rid="CR6">6</xref>], <italic>N</italic><sub><italic>w</italic>,comparison</sub> = 9 and <italic>N</italic><sub><italic>c</italic>,comparison</sub> = 4; for DiGiulio et al. [<xref ref-type="bibr" rid="CR7">7</xref>], <italic>N</italic><sub><italic>w</italic>,comparison</sub> = <italic>N</italic><sub><italic>c</italic>,comparison</sub> = 1; for Bokulich et al. [<xref ref-type="bibr" rid="CR2">2</xref>], <italic>N</italic><sub><italic>w</italic>,comparison</sub> = 12 and <italic>N</italic><sub><italic>c</italic>,comparison</sub> = 2; for Kostic et al. [<xref ref-type="bibr" rid="CR5">5</xref>], <italic>N</italic><sub><italic>w</italic>,comparison</sub> = 5 and <italic>N</italic><sub><italic>c</italic>,comparison</sub> = 2.</p>
        <p id="Par83">These averaged abundances were then used to train random forest or logistic regression classifiers using the Python package scikit-learn [<xref ref-type="bibr" rid="CR37">37</xref>]. Random forest classifiers included 1024 trees (as larger numbers of trees were not found to improve classifier performance.) For logistic regression with L1 regularization, the regularization strength parameter was chosen using tenfold cross-validation from among a grid of logarithmically spaced options spanning the range 10<sup>−4</sup> to 10<sup>4</sup>.</p>
      </sec>
    </sec>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Additional files</title>
    <sec id="Sec20">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="13059_2019_1788_MOESM1_ESM.pdf">
            <label>Additional file 1:</label>
            <caption>
              <p><bold>Table S1.</bold> Classification problems to which MITRE and comparator methods were applied, and performance of the methods applied to each. (PDF 100 kb)</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM2">
          <media xlink:href="13059_2019_1788_MOESM2_ESM.pdf">
            <label>Additional file 2:</label>
            <caption>
              <p><bold>Table S2.</bold> Technical details of the application of MITRE and comparator methods to each classification problem. (PDF 111 kb)</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM3">
          <media xlink:href="13059_2019_1788_MOESM3_ESM.pdf">
            <label>Additional file 3:</label>
            <caption>
              <p> Supplementary Note: additional technical details of the MITRE method and analyses run. (PDF 324 kb)</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM4">
          <media xlink:href="13059_2019_1788_MOESM4_ESM.pdf">
            <label>Additional file 4:</label>
            <caption>
              <p> Mathematical Appendix: mathematical details of the MITRE model and inference method. (PDF 255 kb)</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher’s Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <ack>
    <title>Acknowledgements</title>
    <p>We thank Daniel DiGiulio for assistance with the data from reference [<xref ref-type="bibr" rid="CR7">7</xref>] and Travis Gibson for helpful comments on the manuscript.</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Authors’ contributions</title>
    <p>EB and GKG conceived the method, developed the theory, and wrote the manuscript. EB wrote the software, curated the relevant data, and formally analyzed and validated the method and software. RC contributed to the software and analysis and validation of the method. All authors read and approved the final manuscript.</p>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>This work was supported by the Brigham and Women’s Hospital Precision Medicine Initiative and NIH 1R01GM130777. EB received support from NIH T32HL007627.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and materials</title>
    <p>The MITRE software package is available at <ext-link ext-link-type="uri" xlink:href="https://github.com/gerberlab/mitre/">https://github.com/gerberlab/mitre/</ext-link> [<xref ref-type="bibr" rid="CR13">13</xref>] under a GNU GPL open-source license. All additional input files needed to reproduce the results presented here, and detailed output from all MITRE simulations discussed, are available at <ext-link ext-link-type="uri" xlink:href="https://github.com/gerberlab/mitre_paper_results">https://github.com/gerberlab/mitre_paper_results</ext-link> [<xref ref-type="bibr" rid="CR38">38</xref>].</p>
    <p>Datasets analyzed during the current study are available: data from Bokulich et al. [<xref ref-type="bibr" rid="CR2">2</xref>], from ENA (<ext-link ext-link-type="uri" xlink:href="https://www.ebi.ac.uk/ena/data/view/PRJEB14529">https://www.ebi.ac.uk/ena/data/view/PRJEB14529</ext-link>) [<xref ref-type="bibr" rid="CR39">39</xref>] and QIITA (<ext-link ext-link-type="uri" xlink:href="https://qiita.ucsd.edu">https://qiita.ucsd.edu</ext-link>, study 10249) [<xref ref-type="bibr" rid="CR40">40</xref>]; data from David et al. [<xref ref-type="bibr" rid="CR3">3</xref>], from MG-RAST (<ext-link ext-link-type="uri" xlink:href="http://metagenomics.anl.gov/linkin.cgi?project=mgp6248)">http://metagenomics.anl.gov/linkin.cgi?project=mgp6248</ext-link>) [<xref ref-type="bibr" rid="CR41">41</xref>]; data from Kostic et al. [<xref ref-type="bibr" rid="CR5">5</xref>], via the DIABIMMUNE project website (<ext-link ext-link-type="uri" xlink:href="https://pubs.broadinstitute.org/diabimmune/t1d-cohort">https://pubs.broadinstitute.org/diabimmune/t1d-cohort</ext-link>) [<xref ref-type="bibr" rid="CR42">42</xref>]; data from Vatanen et al. [<xref ref-type="bibr" rid="CR6">6</xref>], via the DIABIMMUNE project website (<ext-link ext-link-type="uri" xlink:href="https://pubs.broadinstitute.org/diabimmune/three-country-cohort)">https://pubs.broadinstitute.org/diabimmune/three-country-cohort</ext-link>) [<xref ref-type="bibr" rid="CR43">43</xref>]; data from DiGiulio et al. [<xref ref-type="bibr" rid="CR7">7</xref>] are expected to be available through the NCBI Sequence Read Archive (<ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/sra">https://www.ncbi.nlm.nih.gov/sra</ext-link>) under BioProject PRJNA288562 [<xref ref-type="bibr" rid="CR44">44</xref>] but were not available at the time of submission of this manuscript; these data are also available from the present authors upon reasonable request and with the permission of the authors of [<xref ref-type="bibr" rid="CR7">7</xref>].</p>
  </notes>
  <notes>
    <title>Ethics approval and consent to participate</title>
    <p id="Par84">Not applicable</p>
  </notes>
  <notes>
    <title>Consent for publication</title>
    <p id="Par85">Not applicable</p>
  </notes>
  <notes notes-type="COI-statement">
    <title>Competing interests</title>
    <p id="Par86">GKG is a Strategic Advisory Board Member of Kaleido Biosciences and had a sponsored research agreement with the company, and is a Scientific Advisory Board Member, co-founder, and shareholder of ConsortiaTX. No funding for the present work was provided by either company. EB is an employee and shareholder of Kintai Therapeutics, which provided no funding for the present work. RC declares that he has no competing interests.</p>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gerber</surname>
            <given-names>GK</given-names>
          </name>
        </person-group>
        <article-title>The dynamic microbiome</article-title>
        <source>FEBS Lett</source>
        <year>2014</year>
        <volume>588</volume>
        <fpage>4131</fpage>
        <lpage>4139</lpage>
        <pub-id pub-id-type="doi">10.1016/j.febslet.2014.02.037</pub-id>
        <pub-id pub-id-type="pmid">24583074</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bokulich</surname>
            <given-names>NA</given-names>
          </name>
          <name>
            <surname>Chung</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Battaglia</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Henderson</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Jay</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>DL</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Perez-Perez</surname>
            <given-names>GI</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>Y</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Antibiotics, birth mode, and diet shape microbiome maturation during early life</article-title>
        <source>Sci Transl Med</source>
        <year>2016</year>
        <volume>8</volume>
        <fpage>343ra382</fpage>
        <pub-id pub-id-type="doi">10.1126/scitranslmed.aad7121</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>David</surname>
            <given-names>LA</given-names>
          </name>
          <name>
            <surname>Maurice</surname>
            <given-names>CF</given-names>
          </name>
          <name>
            <surname>Carmody</surname>
            <given-names>RN</given-names>
          </name>
          <name>
            <surname>Gootenberg</surname>
            <given-names>DB</given-names>
          </name>
          <name>
            <surname>Button</surname>
            <given-names>JE</given-names>
          </name>
          <name>
            <surname>Wolfe</surname>
            <given-names>BE</given-names>
          </name>
          <name>
            <surname>Ling</surname>
            <given-names>AV</given-names>
          </name>
          <name>
            <surname>Devlin</surname>
            <given-names>AS</given-names>
          </name>
          <name>
            <surname>Varma</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Fischbach</surname>
            <given-names>MA</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Diet rapidly and reproducibly alters the human gut microbiome</article-title>
        <source>Nature</source>
        <year>2014</year>
        <volume>505</volume>
        <fpage>559</fpage>
        <lpage>563</lpage>
        <pub-id pub-id-type="doi">10.1038/nature12820</pub-id>
        <pub-id pub-id-type="pmid">24336217</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yassour</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Vatanen</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Siljander</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Hamalainen</surname>
            <given-names>AM</given-names>
          </name>
          <name>
            <surname>Harkonen</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Ryhanen</surname>
            <given-names>SJ</given-names>
          </name>
          <name>
            <surname>Franzosa</surname>
            <given-names>EA</given-names>
          </name>
          <name>
            <surname>Vlamakis</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Huttenhower</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Gevers</surname>
            <given-names>D</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Natural history of the infant gut microbiome and impact of antibiotic treatment on bacterial strain diversity and stability</article-title>
        <source>Sci Transl Med</source>
        <year>2016</year>
        <volume>8</volume>
        <fpage>343ra381</fpage>
        <pub-id pub-id-type="doi">10.1126/scitranslmed.aad0917</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kostic</surname>
            <given-names>AD</given-names>
          </name>
          <name>
            <surname>Gevers</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Siljander</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Vatanen</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Hyotylainen</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Hamalainen</surname>
            <given-names>AM</given-names>
          </name>
          <name>
            <surname>Peet</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Tillmann</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Poho</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Mattila</surname>
            <given-names>I</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The dynamics of the human infant gut microbiome in development and in progression toward type 1 diabetes</article-title>
        <source>Cell Host Microbe</source>
        <year>2015</year>
        <volume>17</volume>
        <fpage>260</fpage>
        <lpage>273</lpage>
        <pub-id pub-id-type="doi">10.1016/j.chom.2015.01.001</pub-id>
        <pub-id pub-id-type="pmid">25662751</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Vatanen</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Kostic</surname>
            <given-names>AD</given-names>
          </name>
          <name>
            <surname>d’Hennezel</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Siljander</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Franzosa</surname>
            <given-names>EA</given-names>
          </name>
          <name>
            <surname>Yassour</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Kolde</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Vlamakis</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Arthur</surname>
            <given-names>TD</given-names>
          </name>
          <name>
            <surname>Hamalainen</surname>
            <given-names>AM</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Variation in microbiome LPS immunogenicity contributes to autoimmunity in humans</article-title>
        <source>Cell</source>
        <year>2016</year>
        <volume>165</volume>
        <fpage>842</fpage>
        <lpage>853</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2016.04.007</pub-id>
        <pub-id pub-id-type="pmid">27133167</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>DiGiulio</surname>
            <given-names>DB</given-names>
          </name>
          <name>
            <surname>Callahan</surname>
            <given-names>BJ</given-names>
          </name>
          <name>
            <surname>McMurdie</surname>
            <given-names>PJ</given-names>
          </name>
          <name>
            <surname>Costello</surname>
            <given-names>EK</given-names>
          </name>
          <name>
            <surname>Lyell</surname>
            <given-names>DJ</given-names>
          </name>
          <name>
            <surname>Robaczewska</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Sun</surname>
            <given-names>CL</given-names>
          </name>
          <name>
            <surname>Goltsman</surname>
            <given-names>DS</given-names>
          </name>
          <name>
            <surname>Wong</surname>
            <given-names>RJ</given-names>
          </name>
          <name>
            <surname>Shaw</surname>
            <given-names>G</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Temporal and spatial variation of the human microbiota during pregnancy</article-title>
        <source>Proc Natl Acad Sci U S A</source>
        <year>2015</year>
        <volume>112</volume>
        <fpage>11060</fpage>
        <lpage>11065</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.1502875112</pub-id>
        <pub-id pub-id-type="pmid">26283357</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Romero</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Hassan</surname>
            <given-names>SS</given-names>
          </name>
          <name>
            <surname>Gajer</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Tarca</surname>
            <given-names>AL</given-names>
          </name>
          <name>
            <surname>Fadrosh</surname>
            <given-names>DW</given-names>
          </name>
          <name>
            <surname>Bieda</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Chaemsaithong</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Miranda</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Chaiworapongsa</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Ravel</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>The vaginal microbiota of pregnant women who subsequently have spontaneous preterm labor and delivery and those with a normal delivery at term</article-title>
        <source>Microbiome</source>
        <year>2014</year>
        <volume>2</volume>
        <fpage>18</fpage>
        <pub-id pub-id-type="doi">10.1186/2049-2618-2-18</pub-id>
        <pub-id pub-id-type="pmid">24987521</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <mixed-citation publication-type="other">Raveh-Sadka T, Thomas BC, Singh A, Firek B, Brooks B, Castelle CJ, Sharon I, Baker R, Good M, Morowitz MJ, Banfield JF. Gut bacteria are rarely shared by co-hospitalized premature infants, regardless of necrotizing enterocolitis development. Elife. 2015;4:e05477.</mixed-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhou</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Shan</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Sodergren</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Weinstock</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Walker</surname>
            <given-names>WA</given-names>
          </name>
          <name>
            <surname>Gregory</surname>
            <given-names>KE</given-names>
          </name>
        </person-group>
        <article-title>Longitudinal analysis of the premature infant intestinal microbiome prior to necrotizing enterocolitis: a case-control study</article-title>
        <source>PLoS One</source>
        <year>2015</year>
        <volume>10</volume>
        <fpage>e0118632</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0118632</pub-id>
        <pub-id pub-id-type="pmid">25741698</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pop</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Paulson</surname>
            <given-names>JN</given-names>
          </name>
          <name>
            <surname>Chakraborty</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Astrovskaya</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Lindsay</surname>
            <given-names>BR</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Bravo</surname>
            <given-names>HC</given-names>
          </name>
          <name>
            <surname>Harro</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Parkhill</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Walker</surname>
            <given-names>AW</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Individual-specific changes in the human gut microbiota after challenge with enterotoxigenic Escherichia coli and subsequent ciprofloxacin treatment</article-title>
        <source>BMC Genomics</source>
        <year>2016</year>
        <volume>17</volume>
        <fpage>440</fpage>
        <pub-id pub-id-type="doi">10.1186/s12864-016-2777-0</pub-id>
        <pub-id pub-id-type="pmid">27277524</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>van Rensburg</surname>
            <given-names>JJ</given-names>
          </name>
          <name>
            <surname>Lin</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Gao</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Toh</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Fortney</surname>
            <given-names>KR</given-names>
          </name>
          <name>
            <surname>Ellinger</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Zwickl</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Janowicz</surname>
            <given-names>DM</given-names>
          </name>
          <name>
            <surname>Katz</surname>
            <given-names>BP</given-names>
          </name>
          <name>
            <surname>Nelson</surname>
            <given-names>DE</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The human skin microbiome associates with the outcome of and is influenced by bacterial infection</article-title>
        <source>MBio</source>
        <year>2015</year>
        <volume>6</volume>
        <fpage>e01315</fpage>
        <?supplied-pmid 26374122?>
        <pub-id pub-id-type="pmid">26374122</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <mixed-citation publication-type="other">Bogart E, Creswell R, Gerber G. The microbiome interpretable temporal rule engine. Github. 2019. 10.5281/zenodo.2634301.</mixed-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tandon</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Haque</surname>
            <given-names>MM</given-names>
          </name>
          <name>
            <surname>Mande</surname>
            <given-names>SS</given-names>
          </name>
        </person-group>
        <article-title>Inferring intra-community microbial interaction patterns from metagenomic datasets using associative rule mining techniques</article-title>
        <source>PLoS One</source>
        <year>2016</year>
        <volume>11</volume>
        <fpage>e0154493</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0154493</pub-id>
        <pub-id pub-id-type="pmid">27124399</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bucci</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Tzen</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Simmons</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Tanoue</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Bogart</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Deng</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Yeliseyev</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Delaney</surname>
            <given-names>ML</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>Q</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>MDSINE: Microbial Dynamical Systems INference Engine for microbiome time-series analyses</article-title>
        <source>Genome Biol</source>
        <year>2016</year>
        <volume>17</volume>
        <fpage>121</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-016-0980-6</pub-id>
        <pub-id pub-id-type="pmid">27259475</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Subramanian</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Huq</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Yatsunenko</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Haque</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Mahfuz</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Alam</surname>
            <given-names>MA</given-names>
          </name>
          <name>
            <surname>Benezra</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>DeStefano</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Meier</surname>
            <given-names>MF</given-names>
          </name>
          <name>
            <surname>Muegge</surname>
            <given-names>BD</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Persistent gut microbiota immaturity in malnourished Bangladeshi children</article-title>
        <source>Nature</source>
        <year>2014</year>
        <volume>510</volume>
        <fpage>417</fpage>
        <lpage>421</lpage>
        <pub-id pub-id-type="doi">10.1038/nature13421</pub-id>
        <pub-id pub-id-type="pmid">24896187</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <mixed-citation publication-type="other">Sze MA, Schloss PD. Looking for a signal in the noise: revisiting obesity and the microbiome. MBio. 2016;7(4):e01018–16.</mixed-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Teng</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Yang</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Huang</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Bo</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Xu</surname>
            <given-names>ZZ</given-names>
          </name>
          <name>
            <surname>Amir</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Knight</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Ling</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Xu</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Prediction of early childhood caries via spatial-temporal variations of oral microbiota</article-title>
        <source>Cell Host Microbe</source>
        <year>2015</year>
        <volume>18</volume>
        <fpage>296</fpage>
        <lpage>306</lpage>
        <pub-id pub-id-type="doi">10.1016/j.chom.2015.08.005</pub-id>
        <pub-id pub-id-type="pmid">26355216</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Matsen</surname>
            <given-names>FA</given-names>
          </name>
          <name>
            <surname>Kodner</surname>
            <given-names>RB</given-names>
          </name>
          <name>
            <surname>Armbrust</surname>
            <given-names>EV</given-names>
          </name>
        </person-group>
        <article-title>pplacer: linear time maximum-likelihood and Bayesian phylogenetic placement of sequences onto a fixed reference tree</article-title>
        <source>BMC Bioinformatics</source>
        <year>2010</year>
        <volume>11</volume>
        <fpage>538</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-11-538</pub-id>
        <pub-id pub-id-type="pmid">21034504</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Carmody</surname>
            <given-names>RN</given-names>
          </name>
          <name>
            <surname>Gerber</surname>
            <given-names>GK</given-names>
          </name>
          <name>
            <surname>Luevano</surname>
            <given-names>JM</given-names>
            <suffix>Jr</suffix>
          </name>
          <name>
            <surname>Gatti</surname>
            <given-names>DM</given-names>
          </name>
          <name>
            <surname>Somes</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Svenson</surname>
            <given-names>KL</given-names>
          </name>
          <name>
            <surname>Turnbaugh</surname>
            <given-names>PJ</given-names>
          </name>
        </person-group>
        <article-title>Diet dominates host genotype in shaping the murine gut microbiota</article-title>
        <source>Cell Host Microbe</source>
        <year>2015</year>
        <volume>17</volume>
        <fpage>72</fpage>
        <lpage>84</lpage>
        <pub-id pub-id-type="doi">10.1016/j.chom.2014.11.010</pub-id>
        <pub-id pub-id-type="pmid">25532804</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gerber</surname>
            <given-names>GK</given-names>
          </name>
          <name>
            <surname>Onderdonk</surname>
            <given-names>AB</given-names>
          </name>
          <name>
            <surname>Bry</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <article-title>Inferring dynamic signatures of microbes in complex host ecosystems</article-title>
        <source>PLoS Comput Biol</source>
        <year>2012</year>
        <volume>8</volume>
        <fpage>e1002624</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pcbi.1002624</pub-id>
        <pub-id pub-id-type="pmid">22876171</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Lu</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Shi</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>Generalized linear models with linear constraints for microbiome compositional data</article-title>
        <source>ArXiv e-prints</source>
        <year>2018</year>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Crost</surname>
            <given-names>EH</given-names>
          </name>
          <name>
            <surname>Tailford</surname>
            <given-names>LE</given-names>
          </name>
          <name>
            <surname>Monestier</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Swarbreck</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Henrissat</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Crossman</surname>
            <given-names>LC</given-names>
          </name>
          <name>
            <surname>Juge</surname>
            <given-names>N</given-names>
          </name>
        </person-group>
        <article-title>The mucin-degradation strategy of Ruminococcus gnavus: the importance of intramolecular trans-sialidases</article-title>
        <source>Gut Microbes</source>
        <year>2016</year>
        <volume>7</volume>
        <fpage>302</fpage>
        <lpage>312</lpage>
        <pub-id pub-id-type="doi">10.1080/19490976.2016.1186334</pub-id>
        <pub-id pub-id-type="pmid">27223845</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Berry</surname>
            <given-names>DA</given-names>
          </name>
        </person-group>
        <article-title>Bayesian clinical trials</article-title>
        <source>Nat Rev Drug Discov</source>
        <year>2006</year>
        <volume>5</volume>
        <fpage>27</fpage>
        <lpage>36</lpage>
        <pub-id pub-id-type="doi">10.1038/nrd1927</pub-id>
        <pub-id pub-id-type="pmid">16485344</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Donald</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Rubin</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>Fisher, Neyman, and Bayes at FDA</article-title>
        <source>J Biopharm Stat</source>
        <year>2016</year>
        <volume>26</volume>
        <fpage>1020</fpage>
        <lpage>1024</lpage>
        <pub-id pub-id-type="doi">10.1080/10543406.2016.1226333</pub-id>
        <pub-id pub-id-type="pmid">27611988</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wasserstein</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Lazar</surname>
            <given-names>N</given-names>
          </name>
        </person-group>
        <article-title>The ASA’s statement on p-values: context, process, and purpose</article-title>
        <source>Am Stat</source>
        <year>2016</year>
        <volume>70</volume>
        <fpage>129</fpage>
        <lpage>133</lpage>
        <pub-id pub-id-type="doi">10.1080/00031305.2016.1154108</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kass</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Raftery</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Bayes factors</article-title>
        <source>J Am Stat Assoc</source>
        <year>1995</year>
        <volume>90</volume>
        <fpage>773</fpage>
        <lpage>795</lpage>
        <pub-id pub-id-type="doi">10.1080/01621459.1995.10476572</pub-id>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Friedman</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Popescu</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <article-title>Predictive learning via rule ensembles</article-title>
        <source>Ann Appl Stat</source>
        <year>2008</year>
        <volume>2</volume>
        <fpage>916</fpage>
        <lpage>954</lpage>
        <pub-id pub-id-type="doi">10.1214/07-AOAS148</pub-id>
      </element-citation>
    </ref>
    <ref id="CR29">
      <label>29.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Letham</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Rudin</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>McCormick</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Madigan</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>Interpretable classifiers using rules and Bayesian analysis: building a better stroke prediction model</article-title>
        <source>Ann Appl Stat</source>
        <year>2015</year>
        <volume>9</volume>
        <fpage>1350</fpage>
        <lpage>1371</lpage>
        <pub-id pub-id-type="doi">10.1214/15-AOAS848</pub-id>
      </element-citation>
    </ref>
    <ref id="CR30">
      <label>30.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Urbanowicz</surname>
            <given-names>Ryan J.</given-names>
          </name>
          <name>
            <surname>Moore</surname>
            <given-names>Jason H.</given-names>
          </name>
        </person-group>
        <article-title>Learning Classifier Systems: A Complete Introduction, Review, and Roadmap</article-title>
        <source>Journal of Artificial Evolution and Applications</source>
        <year>2009</year>
        <volume>2009</volume>
        <fpage>1</fpage>
        <lpage>25</lpage>
        <pub-id pub-id-type="doi">10.1155/2009/736398</pub-id>
      </element-citation>
    </ref>
    <ref id="CR31">
      <label>31.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Polson</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Scott</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Windle</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Bayesian inference for logistic models using Pólya–Gamma latent variables</article-title>
        <source>J Am Stat Assoc</source>
        <year>2013</year>
        <volume>108</volume>
        <fpage>1339</fpage>
        <lpage>1349</lpage>
        <pub-id pub-id-type="doi">10.1080/01621459.2013.829001</pub-id>
      </element-citation>
    </ref>
    <ref id="CR32">
      <label>32.</label>
      <mixed-citation publication-type="other">Gibson T, Gerber G. Robust and scalable models of microbiome dynamics. In: Jennifer D, Andreas K, editors. Proceedings of the 35th International Conference on Machine Learning. Stockholm: Proceedings of Machine Learning Research; 2018.</mixed-citation>
    </ref>
    <ref id="CR33">
      <label>33.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Callahan</surname>
            <given-names>BJ</given-names>
          </name>
          <name>
            <surname>McMurdie</surname>
            <given-names>PJ</given-names>
          </name>
          <name>
            <surname>Rosen</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>Han</surname>
            <given-names>AW</given-names>
          </name>
          <name>
            <surname>Johnson</surname>
            <given-names>AJ</given-names>
          </name>
          <name>
            <surname>Holmes</surname>
            <given-names>SP</given-names>
          </name>
        </person-group>
        <article-title>DADA2: high-resolution sample inference from Illumina amplicon data</article-title>
        <source>Nat Methods</source>
        <year>2016</year>
        <volume>13</volume>
        <fpage>581</fpage>
        <lpage>583</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.3869</pub-id>
        <pub-id pub-id-type="pmid">27214047</pub-id>
      </element-citation>
    </ref>
    <ref id="CR34">
      <label>34.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cole</surname>
            <given-names>JR</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>Q</given-names>
          </name>
          <name>
            <surname>Fish</surname>
            <given-names>JA</given-names>
          </name>
          <name>
            <surname>Chai</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>McGarrell</surname>
            <given-names>DM</given-names>
          </name>
          <name>
            <surname>Sun</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Brown</surname>
            <given-names>CT</given-names>
          </name>
          <name>
            <surname>Porras-Alfaro</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Kuske</surname>
            <given-names>CR</given-names>
          </name>
          <name>
            <surname>Tiedje</surname>
            <given-names>JM</given-names>
          </name>
        </person-group>
        <article-title>Ribosomal Database Project: data and tools for high throughput rRNA analysis</article-title>
        <source>Nucleic Acids Res</source>
        <year>2014</year>
        <volume>42</volume>
        <fpage>D633</fpage>
        <lpage>D642</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkt1244</pub-id>
        <pub-id pub-id-type="pmid">24288368</pub-id>
      </element-citation>
    </ref>
    <ref id="CR35">
      <label>35.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schloss</surname>
            <given-names>PD</given-names>
          </name>
          <name>
            <surname>Westcott</surname>
            <given-names>SL</given-names>
          </name>
          <name>
            <surname>Ryabin</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Hall</surname>
            <given-names>JR</given-names>
          </name>
          <name>
            <surname>Hartmann</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Hollister</surname>
            <given-names>EB</given-names>
          </name>
          <name>
            <surname>Lesniewski</surname>
            <given-names>RA</given-names>
          </name>
          <name>
            <surname>Oakley</surname>
            <given-names>BB</given-names>
          </name>
          <name>
            <surname>Parks</surname>
            <given-names>DH</given-names>
          </name>
          <name>
            <surname>Robinson</surname>
            <given-names>CJ</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Introducing mothur: open-source, platform-independent, community-supported software for describing and comparing microbial communities</article-title>
        <source>Appl Environ Microbiol</source>
        <year>2009</year>
        <volume>75</volume>
        <fpage>7537</fpage>
        <lpage>7541</lpage>
        <pub-id pub-id-type="doi">10.1128/AEM.01541-09</pub-id>
        <pub-id pub-id-type="pmid">19801464</pub-id>
      </element-citation>
    </ref>
    <ref id="CR36">
      <label>36.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kozich</surname>
            <given-names>JJ</given-names>
          </name>
          <name>
            <surname>Westcott</surname>
            <given-names>SL</given-names>
          </name>
          <name>
            <surname>Baxter</surname>
            <given-names>NT</given-names>
          </name>
          <name>
            <surname>Highlander</surname>
            <given-names>SK</given-names>
          </name>
          <name>
            <surname>Schloss</surname>
            <given-names>PD</given-names>
          </name>
        </person-group>
        <article-title>Development of a dual-index sequencing strategy and curation pipeline for analyzing amplicon sequence data on the MiSeq Illumina sequencing platform</article-title>
        <source>Appl Environ Microbiol</source>
        <year>2013</year>
        <volume>79</volume>
        <fpage>5112</fpage>
        <lpage>5120</lpage>
        <pub-id pub-id-type="doi">10.1128/AEM.01043-13</pub-id>
        <pub-id pub-id-type="pmid">23793624</pub-id>
      </element-citation>
    </ref>
    <ref id="CR37">
      <label>37.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pedregosa</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Varoquax</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Gramfort</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Michel</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Thirion</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Grisel</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Blondel</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Prettenhofer</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Weiss</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Dubourg</surname>
            <given-names>V</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Scikit-learn: machine learning in Python</article-title>
        <source>J Mach Learn Res</source>
        <year>2012</year>
        <volume>12</volume>
        <issue>2011</issue>
        <fpage>2825</fpage>
        <lpage>2830</lpage>
      </element-citation>
    </ref>
    <ref id="CR38">
      <label>38.</label>
      <mixed-citation publication-type="other">Bogart E, Creswell R, Gerber G. Supporting files for the microbiome interpretable temporal rule engine manuscript. Github. 2019. 10.5281/zenodo.3345235.</mixed-citation>
    </ref>
    <ref id="CR39">
      <label>39.</label>
      <mixed-citation publication-type="other">Bokulich NA, Chung J, Battaglia T, Henderson N, Jay M, Li H, DL A, Wu F, Perez-Perez GI, Chen Y, et al. Antibiotics, birth mode, and diet shape microbiome maturation during early life. Datasets. Eur Nucleotide Arch. 2016. <ext-link ext-link-type="uri" xlink:href="https://www.ebi.ac.uk/ena/data/view/PRJEB14529">https://www.ebi.ac.uk/ena/data/view/PRJEB14529</ext-link>. Accessed 21 July 2019.</mixed-citation>
    </ref>
    <ref id="CR40">
      <label>40.</label>
      <mixed-citation publication-type="other">Bokulich NA, Chung J, Battaglia T, Henderson N, Jay M, Li H, A DL, Wu F, Perez-Perez GI, Chen Y, et al: Antibiotics, birth mode, and diet shape microbiome maturation during early life. Datasets. QIITA. 2016. <ext-link ext-link-type="uri" xlink:href="https://qiita.ucsd.edu/study/description/10249;">https://qiita.ucsd.edu/study/description/10249;</ext-link>. Accessed 21 July 2019.</mixed-citation>
    </ref>
    <ref id="CR41">
      <label>41.</label>
      <mixed-citation publication-type="other">David LA, Maurice CF, Carmody RN, Gootenberg DB, Button JE, Wolfe BE, Ling AV, Devlin AS, Varma Y, Fischbach MA, et al: DietTimeSeries. Datasets. MG-RAST. 2013. <ext-link ext-link-type="uri" xlink:href="https://www.mg-rast.org/linkin.cgi?project=mgp6248;">https://www.mg-rast.org/linkin.cgi?project=mgp6248;</ext-link>. Accessed 21 July 2019.</mixed-citation>
    </ref>
    <ref id="CR42">
      <label>42.</label>
      <mixed-citation publication-type="other">Kostic AD, Gevers D, Siljander H, Vatanen T, Hyotylainen T, Hamalainen AM, Peet A, Tillmann V, Poho P, Mattila I, et al: T1D cohort. Datasets. DIABIMMUNE. 2015. <ext-link ext-link-type="uri" xlink:href="https://pubs.broadinstitute.org/diabimmune/t1d-cohort;">https://pubs.broadinstitute.org/diabimmune/t1d-cohort;</ext-link>. Accessed 21 July 2019.</mixed-citation>
    </ref>
    <ref id="CR43">
      <label>43.</label>
      <mixed-citation publication-type="other">Vatanen T, Kostic AD, d’Hennezel E, Siljander H, Franzosa EA, Yassour M, Kolde R, Vlamakis H, Arthur TD, Hamalainen AM, et al: Three country cohort. Datasets. DIABIMMUNE. 2016. <ext-link ext-link-type="uri" xlink:href="https://pubs.broadinstitute.org/diabimmune/three-country-cohort">https://pubs.broadinstitute.org/diabimmune/three-country-cohort</ext-link>. Accessed 21 July 2019.</mixed-citation>
    </ref>
    <ref id="CR44">
      <label>44.</label>
      <mixed-citation publication-type="other">DiGiulio DB, Callahan BJ, McMurdie PJ, Costello EK, Lyell DJ, Robaczewska A, Sun CL, Goltsman DS, Wong RJ, Shaw G, et al: Temporal and spatial variation of the human microbiota during pregnancy. Datasets. NCBI. 2018. <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/bioproject/PRJNA288562;">https://www.ncbi.nlm.nih.gov/bioproject/PRJNA288562;</ext-link>. Accessed 21 July 2019</mixed-citation>
    </ref>
  </ref-list>
</back>
