<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">9825295</article-id>
    <article-id pub-id-type="pmid">36562559</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btac830</article-id>
    <article-id pub-id-type="publisher-id">btac830</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Applications Note</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Genome Analysis</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01060</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>igv.js: an embeddable JavaScript implementation of the Integrative Genomics Viewer (IGV)</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Robinson</surname>
          <given-names>James T</given-names>
        </name>
        <aff><institution>Department of Medicine, University of California San Diego</institution>, La Jolla, CA 92093, <country country="US">USA</country></aff>
        <xref rid="btac830-cor1" ref-type="corresp"/>
        <!--jrobinso@ucsd.edu-->
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Thorvaldsdottir</surname>
          <given-names>Helga</given-names>
        </name>
        <aff><institution>Broad Institute of MIT and Harvard</institution>, Cambridge, MA 02142, <country country="US">USA</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Turner</surname>
          <given-names>Douglass</given-names>
        </name>
        <aff><institution>Department of Medicine, University of California San Diego</institution>, La Jolla, CA 92093, <country country="US">USA</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Mesirov</surname>
          <given-names>Jill P</given-names>
        </name>
        <aff><institution>Department of Medicine, University of California San Diego</institution>, La Jolla, CA 92093, <country country="US">USA</country></aff>
        <aff><institution>Moores Cancer Center, University of California San Diego</institution> La Jolla, CA 92037, <country country="US">USA</country></aff>
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Alkan</surname>
          <given-names>Can</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="btac830-cor1">To whom correspondence should be addressed. <email>jrobinso@ucsd.edu</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <month>1</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2022-12-23">
      <day>23</day>
      <month>12</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>23</day>
      <month>12</month>
      <year>2022</year>
    </pub-date>
    <volume>39</volume>
    <issue>1</issue>
    <elocation-id>btac830</elocation-id>
    <history>
      <date date-type="received">
        <day>19</day>
        <month>7</month>
        <year>2022</year>
      </date>
      <date date-type="rev-recd">
        <day>29</day>
        <month>11</month>
        <year>2022</year>
      </date>
      <date date-type="editorial-decision">
        <day>05</day>
        <month>12</month>
        <year>2022</year>
      </date>
      <date date-type="accepted">
        <day>22</day>
        <month>12</month>
        <year>2022</year>
      </date>
      <date date-type="corrected-typeset">
        <day>05</day>
        <month>1</month>
        <year>2023</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2022. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2022</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btac830.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Summary</title>
        <p>igv.js is an embeddable JavaScript implementation of the Integrative Genomics Viewer (IGV). It can be easily dropped into any web page with a single line of code and has no external dependencies. The viewer runs completely in the web browser, with no backend server and no data pre-processing required.</p>
      </sec>
      <sec id="s2">
        <title>Availability and implementation</title>
        <p>The igv.js JavaScript component can be installed from NPM at <ext-link xlink:href="https://www.npmjs.com/package/igv" ext-link-type="uri">https://www.npmjs.com/package/igv</ext-link>. The source code is available at <ext-link xlink:href="https://github.com/igvteam/igv.js" ext-link-type="uri">https://github.com/igvteam/igv.js</ext-link> under the MIT open-source license. IGV-Web, the end-user application built around igv.js, is available at <ext-link xlink:href="https://igv.org/app" ext-link-type="uri">https://igv.org/app</ext-link>. The source code is available at <ext-link xlink:href="https://github.com/igvteam/igv-webapp" ext-link-type="uri">https://github.com/igvteam/igv-webapp</ext-link> under the MIT open-source license.</p>
      </sec>
      <sec id="s4">
        <title>Supplementary information</title>
        <p><xref rid="sup1" ref-type="supplementary-material">Supplementary information</xref> is available at <italic toggle="yes">Bioinformatics</italic> online.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>National Institutes of Health</institution>
            <institution-id institution-id-type="DOI">10.13039/100000002</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>U24CA210004</award-id>
        <award-id>U24CA258406</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="2"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>The rapid pace of genomic dataset generation has led to a proliferation of public and private web portals and cloud resources for sharing, analyzing and visualizing the data. An important component of many such resources is the ability to visually inspect the data in track-based views aligned to a reference genome. Traditionally, such views have been provided in genome browsers, including large client–server systems such as the UCSC Genome Browser (<xref rid="btac830-B4" ref-type="bibr">Kent <italic toggle="yes">et al.</italic>, 2002</xref>) and the Ensembl Genome Browser (<xref rid="btac830-B3" ref-type="bibr">Hubbard <italic toggle="yes">et al.</italic>, 2002</xref>), rich client web applications such as JBrowse (<xref rid="btac830-B1" ref-type="bibr">Buels <italic toggle="yes">et al.</italic>, 2016</xref>) and desktop applications such as the Integrative Genomics Viewer (IGV) (<xref rid="btac830-B6" ref-type="bibr">Robinson <italic toggle="yes">et al.</italic>, 2011</xref>; <xref rid="btac830-B7" ref-type="bibr">Thorvaldsdottir <italic toggle="yes">et al.</italic>, 2013</xref>). Although it is possible to create links from web portals to visualize data in these and similar browsers, in many cases it is desirable to embed genomic visualizations directly in portal pages, enabling data visualization in place without the context switch to another web page or application. Here, we describe igv.js, an embeddable JavaScript implementation of the IGV genome viewer.</p>
  </sec>
  <sec>
    <title>2 Features</title>
    <p>Unlike stand-alone genome browsers such as JBrowse, the igv.js viewer is a component designed explicitly to be embedded in and controlled by enclosing web applications. It builds on previous work, importantly Dalliance (<xref rid="btac830-B2" ref-type="bibr">Down <italic toggle="yes">et al.</italic>, 2011</xref>), the first pure JavaScript component to natively support next-generation sequencing (NGS) data in binary BAM files in a web browser. Embedding an igv.js visualization is as simple as creating a container ‘div’ element in the HTML document and calling a JavaScript function to insert the genome browser (see Quick Start in <xref rid="sup1" ref-type="supplementary-material">Supplementary Material</xref>). The enclosing application interacts with igv.js by means of an API, which includes functions to configure the initial view, load and remove reference genomes and tracks, navigate to specific loci and listen for events initiated by user interaction with igv.js. Tracks are initialized with configuration objects that define the track type, data source and format and initial visual properties such as color, height and feature layout within the track. Multiple instances of igv.js can exist on a page, and instances can be added and removed dynamically.</p>
    <p>The look and feel of igv.js are modeled closely after the IGV desktop application. Like the desktop IGV application, igv.js supports a wide range of genomic track types and file formats, including aligned reads, variants, coverage, signal peaks, annotations, eQTLs, GWAS and copy number variation (see <xref rid="sup1" ref-type="supplementary-material">Supplementary Material</xref> and examples in <xref rid="btac830-F1" ref-type="fig">Fig. 1</xref>). A particular strength of IGV is manual review of genome variants, both single-nucleotide and structural variants (<xref rid="btac830-B5" ref-type="bibr">Robinson <italic toggle="yes">et al.</italic>, 2017</xref>). To support this use case in igv.js, we have implemented the suite of IGV read alignment display options. These include coloring and sorting reads by strand and other attributes, displaying and coloring bases that mismatch the reference, coloring alignments to flag ambiguous mappings and anomalous pair distance and orientations, and multi-locus views for side-by-side views of the multiple components of a structural variant.</p>
    <fig position="float" id="btac830-F1">
      <label>Fig. 1.</label>
      <caption>
        <p>Example igv.js screenshots. (<bold>A</bold>) NGS sequence alignment pileup in the region of a putative SNP indicates strand bias (<ext-link xlink:href="https://tinyurl.com/y9n6dyw9" ext-link-type="uri">https://tinyurl.com/y9n6dyw9</ext-link>). (<bold>B</bold>) RNA-Seq pileups from two tissues illustrate alternative splicing (<ext-link xlink:href="https://tinyurl.com/ybo547uf" ext-link-type="uri">https://tinyurl.com/ybo547uf</ext-link>). (<bold>C</bold>) Epigenetic marks and transcription factors correlate with loop calls from HiC data (<ext-link xlink:href="https://tinyurl.com/y75465od" ext-link-type="uri">https://tinyurl.com/y75465od</ext-link>). (<bold>D</bold>) Manhattan plot from whole-genome association studies (<ext-link xlink:href="https://tinyurl.com/ydhakvy4" ext-link-type="uri">https://tinyurl.com/ydhakvy4</ext-link>)</p>
      </caption>
      <graphic xlink:href="btac830f1" position="float"/>
    </fig>
    <p>It is important to emphasize that igv.js by design supports industry-standard file formats such as BAM, CRAM, bigWig, bigBed, VCF and others, without modification. No pre-processing is required. In fact, files in standard repositories, such as those hosted by the UCSC Genome Browser, ENCODE (<ext-link xlink:href="https://www.encodeproject.org" ext-link-type="uri">https://www.encodeproject.org</ext-link>) and GEO (<ext-link xlink:href="https://www.ncbi.nlm.nih.gov/geo" ext-link-type="uri">https://www.ncbi.nlm.nih.gov/geo</ext-link>), can be referenced directly by URL. Furthermore, there is no backend IGV server; data are loaded directly from the source into the user’s web browser. Supported data sources include (i) files hosted on web servers and accessed via URL; the servers may be on the user’s local intranet or on the internet, including on servers hosted by cloud providers such as Google Drive, Google Cloud Storage, Dropbox and Amazon S3; (ii) htsget (<ext-link xlink:href="https://samtools.github.io/hts-specs/htsget.html" ext-link-type="uri">https://samtools.github.io/hts-specs/htsget.html</ext-link>) servers; (iii) custom web services; (iv) inline data URIs; and (v) files on the local file system. To support viewing large files, such as reference sequence FASTA, BAM alignment and VCF variant files, indices are used to fetch only the data required to render the current view utilizing standard HTTP Range requests.</p>
    <p>Authenticated access to restricted datasets is supported with explicit support for oAuth (<ext-link xlink:href="https://oauth.net" ext-link-type="uri">https://oauth.net</ext-link>) tokens, which can be supplied by the enclosing application as a static string, a callback function or a JavaScript promise. The support for functions and promises enables the enclosing application to update or revoke tokens as needed. Additionally, arbitrary HTTP request headers can be specified during track initialization to support other token-based authentication schemes. Finally, the URLs to track resources can be specified as a callback function or promise, allowing the enclosing application to intercept and modify the URL at runtime based on user credentials or other criteria. For example, a signed URL might be generated and supplied via a promise after user authentication. Finally, explicit support is provided for Google resources by specifying a Google client id on igv.js initialization. If specified, oAuth authentication will be initiated by igv.js as required.</p>
    <p>A unique feature of igv.js is an API function to return a compressed URL-safe string that encodes the complete state of the browser session, including pointers to the reference genome and the loaded data, as well as details on the current view and track and browser settings. This capability can be used by applications to support bookmarks and sharable links. We take advantage of this feature in IGV-Web (<ext-link xlink:href="https://igv.org/app" ext-link-type="uri">https://igv.org/app</ext-link>), an end-user application built around the igv.js component. IGV-Web provides a user interface for specifying the reference genome, loading data into the viewer from remote and local files, and saving and loading sessions. A <italic toggle="yes">Share</italic> menu allows the user to easily retrieve a URL that represents the current session state and to share it with others. The links provided in the legend for <xref rid="btac830-F1" ref-type="fig">Figure 1</xref> were created this way. Entering them into a web browser will open the IGV-Web app and recreate the interactive sessions used to generate the images in the figure.</p>
  </sec>
  <sec>
    <title>3 Availability and documentation</title>
    <p>The igv.js component can be installed from NPM at <ext-link xlink:href="https://www.npmjs.com/package/igv" ext-link-type="uri">https://www.npmjs.com/package/igv</ext-link>. The distribution consists of a single JavaScript file with no external dependencies. The source code is available at <ext-link xlink:href="https://github.com/igvteam/igv.js" ext-link-type="uri">https://github.com/igvteam/igv.js</ext-link> under a permissive open-source license (MIT) and includes numerous examples for embedding igv.js in web pages. The NPM site includes a quick-start guide, and more extensive documentation is available at <ext-link xlink:href="https://github.com/igvteam/igv.js/wiki" ext-link-type="uri">https://github.com/igvteam/igv.js/wiki</ext-link>.</p>
    <p>The IGV-Web application is available at <ext-link xlink:href="https://igv.org/app" ext-link-type="uri">https://igv.org/app</ext-link>, and the Help menu links out to documentation at <ext-link xlink:href="https://igvteam.github.io/igv-webapp" ext-link-type="uri">https://igvteam.github.io/igv-webapp</ext-link>. The source code is available under the MIT open-source license at <ext-link xlink:href="https://github.com/igvteam/igv-webapp" ext-link-type="uri">https://github.com/igvteam/igv-webapp</ext-link>.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="sup1" position="float" content-type="local-data">
      <label>btac830_Supplementary_Data</label>
      <media xlink:href="btac830_supplementary_data.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <sec>
    <title>Funding</title>
    <p>This work was supported by the National Institutes of Health [U24CA210004 to J.P.M. and J.T.R., U24CA258406 to J.P.M. and J.T.R.].</p>
    <p><italic toggle="yes">Conflict of Interest</italic>: none declared.</p>
  </sec>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="btac830-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Buels</surname><given-names>R.</given-names></string-name></person-group><etal>et al</etal> (<year>2016</year>) <article-title>JBrowse: a dynamic web platform for genome visualization and analysis</article-title>. <source>Genome Biol</source>., <volume>17</volume>, <fpage>66</fpage>.<pub-id pub-id-type="pmid">27072794</pub-id></mixed-citation>
    </ref>
    <ref id="btac830-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Down</surname><given-names>T.A.</given-names></string-name></person-group><etal>et al</etal> (<year>2011</year>) <article-title>Dalliance: interactive genome viewing on the web</article-title>. <source>Bioinformatics</source>, <volume>27</volume>, <fpage>889</fpage>–<lpage>890</lpage>.<pub-id pub-id-type="pmid">21252075</pub-id></mixed-citation>
    </ref>
    <ref id="btac830-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hubbard</surname><given-names>T.</given-names></string-name></person-group><etal>et al</etal> (<year>2002</year>) <article-title>The Ensembl genome database project</article-title>. <source>Nucleic Acids Res</source>., <volume>30</volume>, <fpage>38</fpage>–<lpage>41</lpage>.<pub-id pub-id-type="pmid">11752248</pub-id></mixed-citation>
    </ref>
    <ref id="btac830-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kent</surname><given-names>W.J.</given-names></string-name></person-group><etal>et al</etal> (<year>2002</year>) <article-title>The human genome browser at UCSC</article-title>. <source>Genome Res</source>., <volume>12</volume>, <fpage>996</fpage>–<lpage>1006</lpage>.<pub-id pub-id-type="pmid">12045153</pub-id></mixed-citation>
    </ref>
    <ref id="btac830-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Robinson</surname><given-names>J.T.</given-names></string-name></person-group><etal>et al</etal> (<year>2017</year>) <article-title>Variant review with the integrative genomics viewer</article-title>. <source>Cancer Res</source>., <volume>77</volume>, <fpage>e31</fpage>–<lpage>e34</lpage>.<pub-id pub-id-type="pmid">29092934</pub-id></mixed-citation>
    </ref>
    <ref id="btac830-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Robinson</surname><given-names>J.T.</given-names></string-name></person-group><etal>et al</etal> (<year>2011</year>) <article-title>Integrative genomics viewer</article-title>. <source>Nat. Biotechnol</source>., <volume>29</volume>, <fpage>24</fpage>–<lpage>26</lpage>.<pub-id pub-id-type="pmid">21221095</pub-id></mixed-citation>
    </ref>
    <ref id="btac830-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Thorvaldsdottir</surname><given-names>H.</given-names></string-name></person-group><etal>et al</etal> (<year>2013</year>) <article-title>Integrative genomics viewer (IGV): high-performance genomics data visualization and exploration</article-title>. <source>Brief. Bioinform</source>., <volume>14</volume>, <fpage>178</fpage>–<lpage>192</lpage>.<pub-id pub-id-type="pmid">22517427</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
