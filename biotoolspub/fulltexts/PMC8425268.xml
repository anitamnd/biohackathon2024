<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1 20151215//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.1?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Brief Bioinform</journal-id>
    <journal-id journal-id-type="iso-abbrev">Brief Bioinform</journal-id>
    <journal-id journal-id-type="publisher-id">bib</journal-id>
    <journal-title-group>
      <journal-title>Briefings in Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1467-5463</issn>
    <issn pub-type="epub">1477-4054</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">8425268</article-id>
    <article-id pub-id-type="pmid">33480403</article-id>
    <article-id pub-id-type="doi">10.1093/bib/bbaa414</article-id>
    <article-id pub-id-type="publisher-id">bbaa414</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Method Review</subject>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01060</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>DSTG: deconvoluting spatial transcriptomics data through graph-based artificial intelligence</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">http://orcid.org/0000-0002-4455-5302</contrib-id>
        <name>
          <surname>Song</surname>
          <given-names>Qianqian</given-names>
        </name>
        <!--qsong@wakehealth.edu-->
        <aff><institution>Center for Cancer Genomics and Precision Oncology</institution>, <institution>Wake Forest Baptist Comprehensive Cancer Center</institution>, Wake Forest Baptist Medical Center, Winston Salem, NC 27157, <country country="US">USA</country></aff>
        <aff><institution>Department of Cancer Biology</institution>, <institution>Wake Forest School of Medicine</institution>, Winston Salem, NC 27157, <country country="US">USA</country></aff>
        <xref rid="cor1" ref-type="corresp"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Su</surname>
          <given-names>Jing</given-names>
        </name>
        <!--su1@iu.edu-->
        <aff><institution>Department of Biostatistics</institution>, <institution>Indiana University School of Medicine</institution>, Indianapolis, IN 46202, <country country="US">USA</country></aff>
        <aff><institution>Section on Gerontology and Geriatric Medicine</institution>, <institution>Wake Forest School of Medicine</institution>, Winston-Salem, NC 27157, <country country="US">USA</country></aff>
        <xref rid="cor1" ref-type="corresp"/>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="cor1">Corresponding authors: Jing Su, Department of Biostatistics, Indiana University School of Medicine, Indianapolis, IN 46202, USA. Tel.: <phone>+1-678-642-7428</phone>. E-mail: <email>su1@iu.edu</email>; Qianqian Song, Department of Cancer Biology, Wake Forest School of Medicine, Winston Salem, NC 27157, USA. Tel.: <phone>+1-336-926-4972</phone>. E-mail: <email>qsong@wakehealth.edu</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <month>9</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2021-01-22">
      <day>22</day>
      <month>1</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>22</day>
      <month>1</month>
      <year>2021</year>
    </pub-date>
    <volume>22</volume>
    <issue>5</issue>
    <elocation-id>bbaa414</elocation-id>
    <history>
      <date date-type="received">
        <day>26</day>
        <month>10</month>
        <year>2020</year>
      </date>
      <date date-type="rev-recd">
        <day>8</day>
        <month>12</month>
        <year>2020</year>
      </date>
      <date date-type="accepted">
        <day>15</day>
        <month>12</month>
        <year>2020</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2021. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2021</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbynclicense">https://creativecommons.org/licenses/by-nc/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (<ext-link xmlns:xlink="http://www.w3.org/1999/xlink" ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by-nc/4.0/">http://creativecommons.org/licenses/by-nc/4.0/</ext-link>), which permits non-commercial re-use, distribution, and reproduction in any medium, provided the original work is properly cited. For commercial re-use, please contact journals.permissions@oup.com</license-p>
      </license>
    </permissions>
    <self-uri xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="bbaa414.pdf"/>
    <abstract>
      <title>Abstract</title>
      <p>Recent development of spatial transcriptomics (ST) is capable of associating spatial information at different spots in the tissue section with RNA abundance of cells within each spot, which is particularly important to understand tissue cytoarchitectures and functions. However, for such ST data, since a spot is usually larger than an individual cell, gene expressions measured at each spot are from a mixture of cells with heterogenous cell types. Therefore, ST data at each spot needs to be disentangled so as to reveal the cell compositions at that spatial spot. In this study, we propose a novel method, named deconvoluting spatial transcriptomics data through graph-based convolutional networks (DSTG), to accurately deconvolute the observed gene expressions at each spot and recover its cell constitutions, thus achieving high-level segmentation and revealing spatial architecture of cellular heterogeneity within tissues. DSTG not only demonstrates superior performance on synthetic spatial data generated from different protocols, but also effectively identifies spatial compositions of cells in mouse cortex layer, hippocampus slice and pancreatic tumor tissues. In conclusion, DSTG accurately uncovers the cell states and subpopulations based on spatial localization. DSTG is available as a ready-to-use open source software (<ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://github.com/Su-informatics-lab/DSTG" ext-link-type="uri">https://github.com/Su-informatics-lab/DSTG</ext-link>) for precise interrogation of spatial organizations and functions in tissues.</p>
    </abstract>
    <kwd-group>
      <kwd>spatial transcriptomics</kwd>
      <kwd>deconvolution</kwd>
      <kwd>graph-based artificial intelligence</kwd>
      <kwd>single-cell RNA-seq</kwd>
    </kwd-group>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Indiana University Precision Health Initiative</institution>
          </institution-wrap>
        </funding-source>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="13"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec id="sec1">
    <title>Introduction</title>
    <p>Cells of different types are spatially and structurally organized within tissues to perform their functions. Uncovering the complex spatial architecture of heterogenous tissue is significant for understanding the cellular mechanisms and functions in diseases. The fast advance of single-cell RNA sequencing technologies (scRNA-seq) attracts the attention to elucidate the heterogenous cell formation [<xref rid="ref1" ref-type="bibr">1–4</xref>] and trace the lineage relationship within tissue [<xref rid="ref5" ref-type="bibr">5–7</xref>]. Unfortunately, due to the lack of spatial information, scRNA-seq is incapable of identifying the structural organization of heterogeneous cells within a complex tissue. Therefore, as the complementary to scRNA-seq, spatially resolved transcriptomic profiling methods [<xref rid="ref8" ref-type="bibr">8–10</xref>] have been introduced. To reveal the spatial cytoarchitectures within tissues, sequencing-based high-throughput spatial transcriptomics (ST) technologies [<xref rid="ref11" ref-type="bibr">11–14</xref>], such as 10X Genomics Visium [<xref rid="ref8" ref-type="bibr">8</xref>] and Slide-seq [<xref rid="ref15" ref-type="bibr">15</xref>, <xref rid="ref16" ref-type="bibr">16</xref>], use spatially indexed barcodes with RNA sequencing that allows quantitative analysis of the transcriptome with spatial resolution in individual tissue sections.</p>
    <p>Emerging ST technologies are able to spatially index transcripts and measure expression profiles, advancing our understanding of precise tissue architectures. However, the resolution of ST data is far lower than single-cell level. Transcripts captured at a specific location by a ‘spot’ [<xref rid="ref8" ref-type="bibr">8</xref>] or a ‘bead’ [<xref rid="ref15" ref-type="bibr">15</xref>, <xref rid="ref16" ref-type="bibr">16</xref>] is usually composed of a mixture of heterogenous cells. For example, Visium, one of the microarray-based ST techniques developed by 10X Genomics, uses spots of 50 μm diameter, with each spot covering 10–20 cells in average, which varies depending on the tissue histology [<xref rid="ref17" ref-type="bibr">17</xref>]. Even for the Slide-seq [<xref rid="ref15" ref-type="bibr">15</xref>, <xref rid="ref16" ref-type="bibr">16</xref>] that quantifies gene expression with high resolution (10 microns), one pixel may still be overlapped with multiple cells. As a result, the measured gene expressions at a ‘spot’ reflect a mixture of cells. Therefore, uncovering the cell compositions within each spot of the ST data is critical for investigating tissue’s molecular and cellular architecture at high resolution.</p>
    <p>To address this problem, very few tailored approaches have been developed yet. SPOTlight [<xref rid="ref18" ref-type="bibr">18</xref>] is a deconvolution algorithm using nonnegative matrix factorization regression and nonnegative least squares, which has been applied to ST data [<xref rid="ref16" ref-type="bibr">16</xref>] successfully. Specifically, SPOTlight incorporates the reference scRNA-seq data to identify cell type-specific topic profiles, which is further used to deconvolute spatial spots. This method leverages scRNA-seq data for the identification of cell states and subpopulations to deconvolute the ST data, showing that leveraging well-characterized scRNA-seq data will aid and facilitate the exploration of spatial datasets. A major limit of this ST deconvolution method is that the intrinsic topological information of cell type constitutions within spots, which provides crucial information about the relations between the observed gene expression patterns and associated cell types at spots, cannot be effectively learned and utilized.</p>
    <p>In recent years, graph convolutional networks (GCN) [<xref rid="ref19" ref-type="bibr">19</xref>] have demonstrated promising capability in utilizing such intrinsic topological information of data to improve model performance. The topological relations inside the data, such as similarity between samples, can be represented as graphs. Through learning the shared kernel used in spectral graph convolution across all nodes in a graph, a semi-supervised GCN model captures local graph structures as well as node features and incorporates both information as latent space representation. GCN [<xref rid="ref19" ref-type="bibr">19</xref>] and its variants [<xref rid="ref20" ref-type="bibr">20</xref>, <xref rid="ref21" ref-type="bibr">21</xref>] have been applied to different scenarios successfully, including cancer patient subtyping using real-world evidence [<xref rid="ref22" ref-type="bibr">22</xref>], protein prediction [<xref rid="ref23" ref-type="bibr">23</xref>] and drug design [<xref rid="ref24" ref-type="bibr">24</xref>], as well as single cells and diseases [<xref rid="ref25" ref-type="bibr">25–29</xref>]. These works shows that, through effectively learning and leveraging the latent representation and topological relations among data, GCN models are able to significantly improve learning performance.</p>
    <p>In this work, we have developed a novel graph-based artificial intelligence (AI) model, deconvoluting spatial transcriptomics data through graph-based convolutional networks (DSTG), for reliable and accurate decomposition of cell mixtures in the spatially resolved transcriptomics data. Based on the well-characterized scRNA-seq dataset, DSTG is able to learn the precise composition of ST data using semi-supervised GCN. The performance of DSTG has been validated on synthetic ST data, as well as on different experimental ST datasets with well-defined structures including mouse cortex layer, hippocampus tissue and pancreatic tumor tissues. In addition, we provided the implementation software of DSTG as a ready-to-use Python package, which is compatible with current ST profiling datasets for accurate cell type deconvolution.</p>
  </sec>
  <sec id="sec2">
    <title>Materials and methods</title>
    <sec id="sec3">
      <title>Variable gene selection</title>
      <p>For the scRNA-seq data, we first identified genes that exhibited the most variability across different cell types using the analysis of variance. The top 2000 most variable gene features in the scRNA-seq data are selected according to adjusted <italic toggle="yes">P</italic>-values with Bonferroni correction. Then, we used the scRNA-seq data with the top variable genes to generate the pseudo-ST data with synthetic mixtures of cells with known cell compositions. For simplicity and illustration, we consistently used the term ‘spot’ to represent the synthetic cell mixture of the pseudo-ST data as well as a spot or a bead of real-ST data.</p>
    </sec>
    <sec id="sec4">
      <title>Pseudo-ST data</title>
      <p>Real-ST generated by ST assay captures the gene expression at each spot that covers a heterogeneous cell mixture. These cell mixtures can be mimicked by and constructed from scRNA-seq data from the same tissue. Specifically, to mimic the cell mixture at a spot, we selected two to eight cells from the scRNA-seq datasets and combined their transcriptomic profiles as the pseudo-ST data. The number of selected cells is similar to the spatial resolution of real-ST data. Herein, the exact proportions of cell types at each pseudo-ST spot are available since the identities of the selected cells are known. In order to better mimic the real-ST spot data, if the total Unique Molecular Identifier (UMI) counts of the resulting pseudo-ST data exceed that of the real-ST data, we downsampled it accordingly. Therefore, this pseudo-ST data resembles the real-ST data that is obtained from the same tissue. To further ensure that DSTG leverages the similarity between pseudo- and real-ST data, we learned a link graph to connect similar spots between pseudo-ST and real-ST, which is used as the input graph of DSTG.</p>
    </sec>
    <sec id="sec5">
      <title>Link graph</title>
      <p>For both pseudo-ST data and real-ST data, we first performed the data normalization: the raw UMI counts of a gene in a cell are first divided by the total counts for that cell (library size normalization), then multiplied by a size factor of 10 000, and finally log transformed with one added. The normalized data are then subjected to standardized transformation, i.e.<disp-formula id="deqn01"><tex-math id="M1">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$$ {x}_{g,i}=\frac{x_{g,i}^0-\overline{x_g^0}}{\rho_g}, $$\end{document}</tex-math></disp-formula>where <inline-formula><tex-math id="M2">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${x}_{g,i}^0$\end{document}</tex-math></inline-formula> is the normalized counts of gene <inline-formula><tex-math id="M3">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$g$\end{document}</tex-math></inline-formula> and spot <inline-formula><tex-math id="M4">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$i$\end{document}</tex-math></inline-formula>, <inline-formula><tex-math id="M5">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\overline{x_g^0}$\end{document}</tex-math></inline-formula> is the mean of <inline-formula><tex-math id="M6">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${x}_{g,i}^0$\end{document}</tex-math></inline-formula> over all spots and <inline-formula><tex-math id="M7">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${\rho}_g$\end{document}</tex-math></inline-formula> is the SD of <inline-formula><tex-math id="M8">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${x}_{g,i}^0$\end{document}</tex-math></inline-formula>. Thus, <inline-formula><tex-math id="M9">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${x}_{g,i}$\end{document}</tex-math></inline-formula> is the standardized gene expression.</p>
      <p>After the data standardization, we then built a link graph incorporating pseudo-ST and real-ST data for the DSTG method. The built graph is <inline-formula><tex-math id="M10">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$G=(V,E)$\end{document}</tex-math></inline-formula>, with <inline-formula><tex-math id="M11">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$N=\mid V\mid$\end{document}</tex-math></inline-formula> nodes denoting the spatial spots and <inline-formula><tex-math id="M12">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$E$\end{document}</tex-math></inline-formula> representing the edges. <inline-formula><tex-math id="M13">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$A$\end{document}</tex-math></inline-formula> is the adjacent matrix in terms of this graph. Here, we applied the dimension reduction of the pseudo-ST and real-ST data by canonical correlation analysis [<xref rid="ref30" ref-type="bibr">30–33</xref>], and then identified the mutual near neighbors [<xref rid="ref23" ref-type="bibr">23</xref>] in the space of reduced dimension.</p>
      <p>First, with the pseudo-ST data and the real-ST data represented as <inline-formula><tex-math id="M14">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${X_{\mathrm{pseudo}}}^{m\times{n}_p}$\end{document}</tex-math></inline-formula> and <inline-formula><tex-math id="M15">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${X_{\mathrm{real}}}^{m\times{n}_r}$\end{document}</tex-math></inline-formula>, where <inline-formula><tex-math id="M16">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$m$\end{document}</tex-math></inline-formula> is the number of variable genes, and <inline-formula><tex-math id="M17">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${n}_p$\end{document}</tex-math></inline-formula> and <inline-formula><tex-math id="M18">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${n}_r$\end{document}</tex-math></inline-formula> are the respective number of spots, we projected these two data into a lower <inline-formula><tex-math id="M19">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$S$\end{document}</tex-math></inline-formula> dimension space by canonical correlation vectors <inline-formula><tex-math id="M20">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${\mu}_s$\end{document}</tex-math></inline-formula> of <inline-formula><tex-math id="M21">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${n}_p$\end{document}</tex-math></inline-formula> dimension and <inline-formula><tex-math id="M22">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${\nu}_S$\end{document}</tex-math></inline-formula> of <inline-formula><tex-math id="M23">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${n}_r$\end{document}</tex-math></inline-formula> dimension, where <inline-formula><tex-math id="M24">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$s=1,\cdots, S$\end{document}</tex-math></inline-formula>, to maximize<disp-formula id="deqn02"><tex-math id="M25">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$$ {\mu_s}^T{\left({X_{\mathrm{pseudo}}}^{m\times{n}_p}\right)}^T{X_{\mathrm{real}}}^{m\times{n}_r}{\nu}_{s,} $$\end{document}</tex-math></disp-formula>subjecting to the constraints <inline-formula><tex-math id="M26">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${\Vert{\mu}_s\Vert}_2^2\le 1$\end{document}</tex-math></inline-formula> and <inline-formula><tex-math id="M27">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${\Vert{\nu}_s\Vert}_2^2\le 1$\end{document}</tex-math></inline-formula>. To identify the canonical correlation vector pairs, we used singular value decomposition and got the <inline-formula><tex-math id="M28">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$S$\end{document}</tex-math></inline-formula> canonical correlation vector pairs with the <inline-formula><tex-math id="M29">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$S$\end{document}</tex-math></inline-formula> largest eigenvalues. Each pair of <inline-formula><tex-math id="M30">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${\mu}_s$\end{document}</tex-math></inline-formula> and <inline-formula><tex-math id="M31">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${\nu}_s$\end{document}</tex-math></inline-formula> projects the original data <inline-formula><tex-math id="M32">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${X_{\mathrm{pseudo}}}^{m\times{n}_p}$\end{document}</tex-math></inline-formula> and <inline-formula><tex-math id="M33">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${X_{\mathrm{real}}}^{m\times{n}_r}$\end{document}</tex-math></inline-formula> to the <inline-formula><tex-math id="M34">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$s$\end{document}</tex-math></inline-formula>th dimension of the low-dimension space. For DSTG, we took <inline-formula><tex-math id="M35">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$S$\end{document}</tex-math></inline-formula> as 20 for the reduced dimension space.</p>
      <p>Second, in the low-dimension space, we identified the mutual nearest neighbors among spots from pseudo-ST and real-ST data. Specifically, if spot <inline-formula><tex-math id="M36">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$i$\end{document}</tex-math></inline-formula> is in one of nearest neighbor of spot <inline-formula><tex-math id="M37">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$j$\end{document}</tex-math></inline-formula> by <inline-formula><tex-math id="M38">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$k$\end{document}</tex-math></inline-formula>-nearest neighbor (KNN, default <inline-formula><tex-math id="M39">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$k$\end{document}</tex-math></inline-formula> is 200), meanwhile spot <inline-formula><tex-math id="M40">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$j$\end{document}</tex-math></inline-formula> is in one of nearest neighbor of spot <inline-formula><tex-math id="M41">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$i$\end{document}</tex-math></inline-formula> by KNN, then spot <inline-formula><tex-math id="M42">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$i$\end{document}</tex-math></inline-formula> and spot <inline-formula><tex-math id="M43">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$j$\end{document}</tex-math></inline-formula> are mutual nearest neighbors. In this way, we built the link graph between the pseudo-ST data and the real-ST data. To further utilize the information of real-ST data in the DSTG model, we also identified the mutual nearest neighbors within the real-ST data itself. To this end, the final link graph is built and represented by the adjacent matrix <inline-formula><tex-math id="M44">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$A$\end{document}</tex-math></inline-formula>. That is, if spot <inline-formula><tex-math id="M45">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$i$\end{document}</tex-math></inline-formula> and the other spot <inline-formula><tex-math id="M46">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$j$\end{document}</tex-math></inline-formula> are mutual nearest neighbors, <inline-formula><tex-math id="M47">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${A}_{ij}=1$\end{document}</tex-math></inline-formula>, otherwise <inline-formula><tex-math id="M48">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${A}_{ij}=0$\end{document}</tex-math></inline-formula>. This graph captures the intrinsic topological structure of spot similarity between all spots.</p>
    </sec>
    <sec id="sec6">
      <title>DSTG method</title>
      <p>We utilized the GCN on the link graph <inline-formula><tex-math id="M49">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$G=(V,E)$\end{document}</tex-math></inline-formula> for the identification and prediction of the compositions of different cell types in the ST data. Each spot is viewed as a node. The cell mixtures in the pseudo-ST data are generated with known compositions. The goal of DSTG is to predict the cell type compositions of the real-ST data by using not only the features of each spot, but also the graph information leveraging the pseudo-ST data and real-ST data, which is characterized as the above adjacent matrix <inline-formula><tex-math id="M50">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$A$\end{document}</tex-math></inline-formula>. Explicitly, the DSTG method takes two inputs. One input is the spot similarity graph structure learned above (see the section Link graph). The other is the data matrix of combined pseudo-ST and real-ST data. As denoted above, with the pseudo-ST data and the real-ST data represented as <inline-formula><tex-math id="M51">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${X_{\mathrm{pseudo}}}^{m\times{n}_p}$\end{document}</tex-math></inline-formula> and <inline-formula><tex-math id="M52">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${X_{\mathrm{real}}}^{m\times{n}_r}$\end{document}</tex-math></inline-formula>, where <inline-formula><tex-math id="M53">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$m$\end{document}</tex-math></inline-formula> is the number of variable genes, whereas <inline-formula><tex-math id="M54">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${n}_p$\end{document}</tex-math></inline-formula> and <inline-formula><tex-math id="M55">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${n}_r$\end{document}</tex-math></inline-formula> are the corresponding number of spots, the input data matrix is shown as<disp-formula id="deqn03"><tex-math id="M56">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$$ X=\left[{X}_{\mathrm{pseudo}}\kern0.5em {X}_{\mathrm{real}}\right]\in{R}^{m\times N}, $$\end{document}</tex-math></disp-formula>where <inline-formula><tex-math id="M57">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$N={n}_p+{n}_r$\end{document}</tex-math></inline-formula>.</p>
      <p>Herein, with these two inputs, i.e. <inline-formula><tex-math id="M58">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$X$\end{document}</tex-math></inline-formula> and <inline-formula><tex-math id="M59">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$A$\end{document}</tex-math></inline-formula>, the DSTG is constructed with multiple convolutional layers. For efficient training of DSTG, the adjacent matrix <inline-formula><tex-math id="M60">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$A$\end{document}</tex-math></inline-formula> is modified and normalized as<disp-formula id="deqn04"><tex-math id="M61">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$$ \overset{\sim }{A}=\check{{D}}^{-1/2}\hat{A}{\check{D}}^{-1/2}, $$\end{document}</tex-math></disp-formula>where <inline-formula><tex-math id="M62">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\hat{A}=A+I$\end{document}</tex-math></inline-formula>, <inline-formula><tex-math id="M63">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$I$\end{document}</tex-math></inline-formula> is the identity matrix and <inline-formula><tex-math id="M64">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\overset{\check{} }{D}$\end{document}</tex-math></inline-formula> is the diagonal degree matrix of <inline-formula><tex-math id="M65">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\hat{A}$\end{document}</tex-math></inline-formula>.</p>
      <p>Specifically, each graph convolutional layer is defined as<disp-formula id="deqn05"><tex-math id="M66">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$$ {H}^{\left(l+1\right)}=f\left({H}^{(l)},\overset{\sim }{A}\right)=\sigma \left(\overset{\sim }{A}{H}^{(l)}{W}^{(l)}\right)=\mathrm{ReLU}\left(\overset{\sim }{A}{H}^{(l)}{W}^{(l)}\right), $$\end{document}</tex-math></disp-formula>where <inline-formula><tex-math id="M67">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${H}^{(l)}$\end{document}</tex-math></inline-formula> is the input from the previous layer, <inline-formula><tex-math id="M68">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${W}^{(l)}$\end{document}</tex-math></inline-formula> is the weight matrix of the <inline-formula><tex-math id="M69">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$l$\end{document}</tex-math></inline-formula>th layer, <inline-formula><tex-math id="M70">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\sigma (\cdot)=\mathrm{ReLU}(\cdot)$\end{document}</tex-math></inline-formula> is the nonlinear activation function and the input layer <inline-formula><tex-math id="M71">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${H}^{(0)}=X$\end{document}</tex-math></inline-formula>. The composition of a specific cell type <inline-formula><tex-math id="M72">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$f$\end{document}</tex-math></inline-formula> at a pseudo-spot <inline-formula><tex-math id="M73">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$i$\end{document}</tex-math></inline-formula> is represented as <inline-formula><tex-math id="M74">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${y}_{i,f}\in{Y}_p$\end{document}</tex-math></inline-formula>, where <inline-formula><tex-math id="M75">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$i\in \{1,\cdots, {n}_p \}$\end{document}</tex-math></inline-formula> and cell type <inline-formula><tex-math id="M76">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$f\in \{1,\cdots, F \}$\end{document}</tex-math></inline-formula>, <inline-formula><tex-math id="M77">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$F$\end{document}</tex-math></inline-formula> represents the total number of different cell types and <inline-formula><tex-math id="M78">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${Y}_p\in{R}^{n_p\times F}$\end{document}</tex-math></inline-formula> represents the known cell compositions at all spots from the pseudo-ST data.</p>
      <p>Specifically, for a three-layer DSTG with <inline-formula><tex-math id="M79">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$F$\end{document}</tex-math></inline-formula> distinct cell types, the forward propagation is realized as<disp-formula id="deqn06"><tex-math id="M80">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$$ \hat{Y}=f\left(X,{A}^H\right)=\mathrm{softmax}\big(\overset{\sim }{A}\ \mathrm{ReLU}\big(\overset{\sim }{A}{X}^T{W}^{(0)}\big){W}^{(1)}\big), $$\end{document}</tex-math></disp-formula>where <inline-formula><tex-math id="M81">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${W}^{(0)}\in{R}^{m\times h}$\end{document}</tex-math></inline-formula> is the input-to-hidden weight matrix projecting the input data with <inline-formula><tex-math id="M82">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$m$\end{document}</tex-math></inline-formula> variable genes into an <inline-formula><tex-math id="M83">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$h$\end{document}</tex-math></inline-formula> dimension hidden layer, <inline-formula><tex-math id="M84">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\mathrm{ReLU}$\end{document}</tex-math></inline-formula> stands for the rectified linear unit activation function, <inline-formula><tex-math id="M85">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${W}^{(1)}\in{R}^{h\times F}$\end{document}</tex-math></inline-formula> is a hidden-to-output weight matrix and <inline-formula><tex-math id="M86">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$$\hat{Y}= \big[\kern-4pt\begin{array}{c}{\hat{Y}}_p\\{}{\hat{Y}}_r\end{array}\kern-4pt\big]\in{R}^{N\times F}$$\end{document}</tex-math></inline-formula> is composed of two components: <inline-formula><tex-math id="M87">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${\hat{Y}}_p\in{R}^{n_p\times F}$\end{document}</tex-math></inline-formula> represents the predicted proportions of different cell types at pseudo-ST spots and <inline-formula><tex-math id="M88">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${\hat{Y}}_r\in{R}^{n_r\times F}$\end{document}</tex-math></inline-formula> represents the prediction of cell compositions at real-ST spots. The <inline-formula><tex-math id="M89">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\mathrm{softmax}$\end{document}</tex-math></inline-formula> activation function below is used as the activation function in the output layer that learns the cell type proportions,<disp-formula id="deqn07"><tex-math id="M90">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$$ \mathrm{softmax}\left(\cdot \right)=\frac{\exp \left(\cdot \right)}{\sum \exp \left(\cdot \right)}. $$\end{document}</tex-math></disp-formula></p>
      <p>The evaluation function is defined as the cross-entropy at pseudo-ST spots, i.e.<disp-formula id="deqn08"><tex-math id="M91">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$$ \mathcal{L}=-{\sum}_{i=1}^{n_p}{\sum}_{f=1}^F{y}_{i,f}\mathit{\ln}\left({\hat{y}}_{i,f}\right), $$\end{document}</tex-math></disp-formula>where <inline-formula><tex-math id="M92">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${y}_{i,f}\in{Y}_p$\end{document}</tex-math></inline-formula> and <inline-formula><tex-math id="M93">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${\hat{y}}_{i,f}\in{\hat{Y}}_p$\end{document}</tex-math></inline-formula>. The goal of this semi-supervised learning is to minimize the cross-entropy <inline-formula><tex-math id="M94">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\mathcal{L}$\end{document}</tex-math></inline-formula> between the known cell compositions <inline-formula><tex-math id="M95">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${Y}_p$\end{document}</tex-math></inline-formula> and the predicted cell proportions <inline-formula><tex-math id="M96">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${\hat{Y}}_p$\end{document}</tex-math></inline-formula>. During the propagation of each layer, the model will reduce the cross-entropy error on the training data. After training, we had<disp-formula id="deqn09"><tex-math id="M97">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$$ \hat{Y}=\mathrm{GCN}\left(X,A\right)\in{R}^{N\times F}. $$\end{document}</tex-math></disp-formula></p>
      <p>Note that <inline-formula><tex-math id="M98">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$$\hat{Y}=\big[\begin{array}{@{}c@{}}{\hat{Y}}_p\\{}{\hat{Y}}_r\end{array}\big]$$\end{document}</tex-math></inline-formula>. Thus, cell compositions of real-ST spots are predicted as <inline-formula><tex-math id="M99">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${\hat{Y}}_r$\end{document}</tex-math></inline-formula>.</p>
      <p>When applying the DSTG model, we randomly split the pseudo-ST data as training (80%), test (10%) and validation set (10%), whereas the real-ST data is unlabeled and will be predicted. For the ST data in this study, we trained three-layer DSTG models for a maximum of 200 epochs using the Adaptive Moment Estimation (Adam) algorithm [<xref rid="ref34" ref-type="bibr">34</xref>] with a learning rate of 0.01 and early stopping with a window size of 10. For the dimension of the latent layer, we screened options of 32, 64, 128, 256, 528 and 1024 dimensions and selected the optimal one.</p>
      <p>For the evaluation metrics, we used the Jensen–Shannon divergence (JSD) score, which is a symmetrized and smoothed version of the Kullback–Leibler divergence. At a spot <inline-formula><tex-math id="M100">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$i$\end{document}</tex-math></inline-formula>, there are discrete probability distribution of composition <inline-formula><tex-math id="M101">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${P}^i=({p}_1^i,{p}_2^i,\cdots, {p}_C^i)$\end{document}</tex-math></inline-formula> as ground truth as well as predicted distribution of composition <inline-formula><tex-math id="M102">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${Q}^i=({q}_1^i,{q}_2^i,\cdots, {q}_C^i)$\end{document}</tex-math></inline-formula>, where <inline-formula><tex-math id="M103">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$C$\end{document}</tex-math></inline-formula> indicates the number of cell types. Here, <inline-formula><tex-math id="M104">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\sum_{k=1}^C{p}_k^i=1$\end{document}</tex-math></inline-formula> and <inline-formula><tex-math id="M105">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\sum_{k=1}^C{q}_k^j=1$\end{document}</tex-math></inline-formula>. The JSD score at spot <inline-formula><tex-math id="M106">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$i$\end{document}</tex-math></inline-formula> is defined as<disp-formula id="deqn10"><tex-math id="M107">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$$\begin{eqnarray*} \mathrm{JSD}\left({P}^i\Vert{Q}^i\right)\!\!\!\! &amp;=&amp;\!\!\!\! \frac{1}{2}\sum_{k\in \left\{1,\cdots, C\right\}}{p}_k^i\ \log \left(\frac{p_k^i}{\left({p}_k^i+{q}_k^i\right)/2}\right) \\ &amp;&amp;\!\!\!\!+\frac{1}{2}\sum_{k\in \left\{1,\cdots, C\right\}}{q}_k^i\ \log \left(\frac{q_k^i}{\left({p}_k^i+{q}_k^i\right)/2}\right). \end{eqnarray*}$$\end{document}</tex-math></disp-formula></p>
      <p>In this way, the JSD values can be calculated for all spots. Then, the quantiles of JSD values across all spots are used as our evaluation metrics.</p>
    </sec>
  </sec>
  <sec id="sec7">
    <title>Results</title>
    <sec id="sec8">
      <title>Overview of DSTG</title>
      <p>Herein, we propose a novel, graph-based AI approach, namely DSTG, to deconvolute ST data through graph-based convolutional networks. The DSTG approach leverages scRNA-seq data to unveil the cell mixtures in the ST data (<xref rid="f1" ref-type="fig">Figure 1</xref>). Our hypothesis is that the captured gene expression on a spot is contributed by a mixture of cells located on that spot. Our strategy is to use the scRNA-seq-derived synthetic ST data, called ‘pseudo-ST’, to predict cell compositions in real-ST data through semi-supervised learning. First, DSTG constructs the synthetic pseudo-ST data from scRNA-seq data as the learning basis of our method. Then, DSTG learns a link graph of spot mapping across the pseudo-ST data and real-ST data using shared nearest neighbors. The link graph captures the intrinsic topological similarity between spots and incorporates the pseudo-ST and real-ST data into the same graph for learning. Then, based on the link graph, semi-supervised GCN is used to learn a latent representation of both local graph structure and gene expression patterns that can explain the various cell compositions at spots. The major advantages of such similarity-based semi-supervised GCN model are as follows: (1) sensitive and efficient, since for each spot, only the features of similar spots (i.e. neighbor nodes) are used and (2) acquiring generalizable knowledge about the association between gene expression patterns and cell compositions across spots in both pseudo- and real-ST, since the weight parameters in the convolution kernel are shared by all spots. To test the performance of DSTG, we used synthetic pseudo-ST data generated with cell mixtures of known cell type compositions from peripheral blood mononuclear cell (PBMC) scRNA-seq datasets [<xref rid="ref35" ref-type="bibr">35</xref>], in which DSTG presents superior performance than the SPOTlight method. Furthermore, DSTG is validated and applied to real tissue context from mouse cortex, hippocampus and pancreatic tissues with well-defined structures.</p>
      <fig position="float" id="f1">
        <label>
Figure 1
</label>
        <caption>
          <p>Schematic overview of DSTG for deconvoluting spatial transcriptomics data. Schematic representation of how DSTG deconvolutes spatial transcriptomics (ST) data using scRNA-seq profiles. DSTG first generated the pseudo-ST data with cell mixtures from scRNA-seq data. Between this pseudo- and real-ST data, DSTG identifies a link graph of spot mapping through the canonical correlation analysis. Based on the link graph, graph convolutional network is used to propagate both pseudo-ST and real-ST data into the latent layer and identify the compositions of different cell types for each spot. In this way, cell compositions of real-ST data can be predicted and learned by using pseudo-ST data.</p>
        </caption>
        <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="bbaa414f1" position="float"/>
      </fig>
    </sec>
    <sec id="sec9">
      <title>Performance of DSTG on benchmarking data</title>
      <p>To evaluate the performance of DSTG, we used the synthetic ST data generated by scRNA-seq cell mixtures as ground truth. Briefly, each spot of this synthetic ST data is constructed by combining the randomly selected two to eight cells from scRNA-seq data. Such synthetic ST data not only mimics real ST data, but also provides ground truth that can be used to evaluate the DSTG’s performance in identifying the proportions of different cell types within each synthetic spot. As for the evaluation metrics, we used the JSD, which is a distance metric that measures the similarity between two probability distributions. A smaller value of JSD represents a higher similarity between two distributions, thus signifies a higher accuracy of estimated cell type compositions across spots.</p>
      <p>Specifically, we used 13 PBMC scRNA-seq datasets [<xref rid="ref35" ref-type="bibr">35</xref>] profiled by different protocols, with well-characterized cell populations and discrete cell numbers, to generate benchmarking synthetic spatial data. For each PBMC data, we generated 10 synthetic data and applied both DSTG and SPOTlight to those 10 synthetic data for comparison. Our results show that DSTG achieves lower JSD values (mean JSD = 0.12, <xref rid="f2" ref-type="fig">Figure 2A</xref>), which is significantly lower (<italic toggle="yes">P</italic>-value &lt;2.2e−16) than SPOTlight (mean JSD = 0.24), indicating the higher accuracy of DSTG than SPOTlight across datasets generated from different experiment protocols. Notably, DSTG shows the most accuracy than SPOTlight in the CEL-Seq2 synthetic datasets. Though SPOTlight performs the best on Quartz-Seq2 datasets, DSTG still outperforms SPOTlight with lower JSD value. In addition to PBMC, to examine the performance of DSTG on other different tissues, we included eight other scRNA-seq data from different tissues and protocols to generate the benchmarking synthetic data (<xref rid="f2" ref-type="fig">Figure 2B</xref>). Then, we compared DSTG with SPOTlight based on the synthetic data from these eight additional scRNA-seq data. As shown in <xref rid="f2" ref-type="fig">Figure 2B</xref>, the predicted results of DSTG still outperform SPOTlight using the JSD evaluation metric. Notably, DSTG achieves the mean JSD values of 0.016 and 0.087 for the Smart-Seq2 and single nucleus RNA sequencing (snRNA-Seq) datasets, respectively, which are better than the ones achieved by SPOTlight (0.19 and 0.24). These consistently superior performances of DSTG demonstrate the accuracy and robustness of our method.</p>
      <fig position="float" id="f2">
        <label>
Figure 2
</label>
        <caption>
          <p>Performance of DSTG on benchmarking datasets. (<bold>A</bold>) Performance of DSTG is assessed and compared with SPOTlight by synthetic spatial data generated from 13 PBMC datasets of different scRNA-seq protocols. (<bold>B</bold>) Performance of DSTG is further benchmarked with SPOTlight by synthetic spatial transcriptomics data generated from the other scRNA-seq datasets from different tissues and protocols. (<bold>C</bold>) DSTG’s performance on synthetic data with different number of spots. (<bold>D</bold>) DSTG’s performance on synthetic data with different library depths. (<bold>E</bold>) DSTG’s performance on synthetic data with different number of variable genes. In (<bold>A–E</bold>), the <italic toggle="yes">y</italic>-axis represents the JSD value.</p>
        </caption>
        <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="bbaa414f2" position="float"/>
      </fig>
      <p>To investigate whether DSTG is sensitive to the design of synthetic ST data, we generated discrete synthetic data with different number of spots, library sizes and variable genes, which covers the characteristics of the current and emerging ST data. For the synthetic data with different spot numbers (500–4000) (<xref rid="f2" ref-type="fig">Figure 2C</xref>), we found that DSTG tends to perform better with more spots in the synthetic data, suggesting that the more the spots used, the better the model is trained. Meanwhile, the result suggests that using 1500 spots is sufficient to reach high performance in practice, as the marginal gain of performance is neglectable when using more spots. For the synthetic data with different downsampled library sizes (5000–50 000 reads per cell) (<xref rid="f2" ref-type="fig">Figure 2D</xref>), DSTG shows stable accuracy at lower or higher library sizes. For the synthetic data with different number of variable genes (500–5000) (<xref rid="f2" ref-type="fig">Figure 2E</xref>), DSTG demonstrates stable performance, with optimal performance reaches at 2000 variable genes.</p>
    </sec>
    <sec id="sec10">
      <title>Evaluation of different parameters of DSTG</title>
      <p>Regarding the DSTG method, we tested hyperparameters and examined the model performance in ST data deconvolution. First, we tested different number of hidden units and evaluated their impact on DSTG’s results. With the synthetic ST data generated from four single-cell protocols (Smart-Seq2, Quartz-Seq2, Chromium and inDrop), we applied DSTG with hidden units ranging from 16 to 2048 and assessed their respective accuracy (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S1</xref>). The results across all cases show that DSTG consistently performs better with 32 units in hidden layer. Interestingly, too, more or too less units show less accuracy of composition prediction.</p>
      <p>Second, we tested the impact of different number of layers on the deconvolution performance of DSTG. Here, we still used the synthetic ST data generated from the above four protocols for evaluation. We applied DSTG with 2–10 layers and assessed their respective accuracy. <xref rid="sup2" ref-type="supplementary-material">Supplementary Figure S2</xref> shows the performance of DSTG with different number of layers based on the synthetic ST data. For all cases considered here, the best results are obtained with a three-layer model. Interestingly, DSTG shows less accuracy with two, four and five layers. We also found that for models deeper than six layers, the performance remains at the same level, which is often observed for GCN-based models [<xref rid="ref36" ref-type="bibr">36</xref>, <xref rid="ref37" ref-type="bibr">37</xref>]. The reason is that a deep GCN model causes excessive Laplacian smoothing [<xref rid="ref38" ref-type="bibr">38</xref>] and a large number of parameters, which lead to less distinguishable representations [<xref rid="ref39" ref-type="bibr">39</xref>] and overfitting [<xref rid="ref37" ref-type="bibr">37</xref>].</p>
      <p>In addition, we also tested the impact of data preprocessing and normalization on DSTG’s performance. Here, we compared ours with other normalization methods including sctransform [<xref rid="ref40" ref-type="bibr">40</xref>] using regularized negative binomial regression, scran [<xref rid="ref41" ref-type="bibr">41</xref>] using pooling-based normalization as well as Linnorm [<xref rid="ref42" ref-type="bibr">42</xref>] using linear model and normality-based normalization. Specifically, synthetic ST data are preprocessed and normalized by different normalization methods. The processed data are then used as input of DSTG for comparison. In all cases (<xref rid="sup3" ref-type="supplementary-material">Supplementary Figure S3</xref>), DSTG shows robust performance regarding different normalization methods, with no detectible difference in accuracy (JSD value). The comparison results suggest that our preprocessing step is able to reach good performance in practice.</p>
      <p>Finally, we investigated the impact of different graph construction approaches on the deconvolution performance of DSTG. Here, we applied four kinds of graphs including DSTG’s link graph, KNN-based graph, identity graph and random graph to compare their respective accuracy on synthetic ST data. With the results (<xref rid="sup4" ref-type="supplementary-material">Supplementary Figure S4</xref>), we found that DSTG shows consistently higher accuracy across all synthetic ST data when using the link graph. In contrast, DSTG shows much lower accuracy as indicated by higher JSD values, when using the other three kinds of graphs, especially the identity and random graphs. These results suggest that the graph construction is critical for DSTG’s performance, which also demonstrate that the DSTG’s link graph is essential for accurate deconvolution.</p>
    </sec>
    <sec id="sec11">
      <title>Spatial decomposition of mouse cortex layer</title>
      <p>To examine whether DSTG can reveal microanatomical structures in complex tissue, we used the 10X Visium ST data of cerebral cortex layer in mouse brain. This cortex layer has well-defined cytoarchitecture and thus is suitable to evaluate DSTG’s performance. To deconvolute this ST data by DSTG, we used the scRNA-seq dataset profiled by the Smart-Seq2 protocol from the Allen Institute, which consists of ~14 000 adult mouse cortical cell taxonomy and 22 cell types (<xref rid="f3" ref-type="fig">Figure 3A</xref>). With this scRNA-seq data, the spatial deconvolution of the ST data by DSTG accurately reconstructs the architecture of brain cortex layer (<xref rid="f3" ref-type="fig">Figure 3B</xref>). The identified heterogenous cell proportions of each localized spot are shown by the pie chart at the respective spot, which are confirmed by their existence in cortical areas, suggesting the high accuracy and sensitivity of the DSTG’s predictions. In the spots visualized in <xref rid="f3" ref-type="fig">Figure 3B</xref>, about 46% are with mixed cell types. To clearly illustrate the cell mixtures within each spot, we present two separated figures of the same data in <xref rid="sup5" ref-type="supplementary-material">Supplementary Figure S5</xref>. Specifically, <xref rid="sup5" ref-type="supplementary-material">Supplementary Figure S5A</xref> shows the identified spots with unique cell types, whereas <xref rid="sup5" ref-type="supplementary-material">Supplementary Figure S5B</xref> shows the identified spots with mixed cell types.</p>
      <fig position="float" id="f3">
        <label>
Figure 3
</label>
        <caption>
          <p>Spot deconvolution of mouse cortex layer. (<bold>A</bold>) UMAP projections of single-cell RNA-seq data from mouse cortex tissue. Different cell types are labeled and colored according to known cell annotations. (<bold>B</bold>) Spatial plot with pie chart shows the predicted cell compositions of each spot within the cortex layer. (<bold>C</bold>) Spatial plot shows the proportions of specific neuron subtypes in the spots within the captured region. Red spot indicates high proportion of the respective cell type. (<bold>D</bold>) Visualization of the spatial expressions of cell type specific markers in ST data. Red color indicates the high gene expression in that spot.</p>
        </caption>
        <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="bbaa414f3" position="float"/>
      </fig>
      <p>Moreover, our predicted compositions provide more detailed information about the heterogeneity of this area. Specific investigation shows the regional enrichment of each cell type based on their identified proportions. Illustrative examples are the differentially enriched neuronal subtypes including cortical layer 2/3 (L2/3), cortical layer 6 (L6b) and oligodendrocytes (oligo) (<xref rid="f3" ref-type="fig">Figure 3C</xref>). The subpopulation of L2/3 is shown with high compositions in the outside liner of spots within the cortex. Spots with most L6b cells are shown with high proportions in the inner liner of the cortex. Towards the innermost layer, oligodendrocytes cells are mainly abundant in these spots. These data are consistent with the layered cytoarchitecture of the cortex tissue. The ability to identify the distinct spatial cellular compositions of each spot in the cortical neuronal layers indicates the accuracy and sensitivity of DSTG.</p>
      <p>To examine whether the cell type specific genes are enriched in their corresponding spatial locations, we investigated the distribution of marker genes known to be specific to the respective cell types (<xref rid="f3" ref-type="fig">Figure 3D</xref>). For example, the top expressed gene marker of L2/3 cells, Myh7, is detected with high expression in the ST data of L2/3 dominated spots, which is in line with the predicted proportions of this cell type. The top markers of L6b and Oligo, Nxph4 and Gjc3, also show high expression in their corresponding spots, respectively. Meanwhile, these genes are undetectable or detected at very low levels at other spatial spots. It is worth noting that the partial expression of cell type markers in a specific ST spot may reflect the heterogeneous composition of cell types in that spot. Interrogation of these differential genes further confirms the accurate predicted cell proportions within spots in the tissue section.</p>
      <p>To investigate whether the pseudo-ST generated from scRNA-seq data presents similar spatial patterns with the real-ST data, we looked into the pseudo-spots from pseudo-ST data that are linked with real-spots from real-ST data in our link graph. After mapping these pseudo spots onto the spatial contexture, we found that the compositions within these pseudo-spots show similar patterns (<xref rid="sup5" ref-type="supplementary-material">Supplementary Figure S5C</xref>) with the real-ST structures (<xref rid="sup5" ref-type="supplementary-material">Supplementary Figure S5D</xref>). That is, these pseudo-spots from pseudo-ST data recapitulate the architecture of mouse brain cortex layer. The heterogenous cell compositions within each pseudo-spot are shown as pie chart at their respective spot. Specific investigation shows that the Astro subtype mainly locates at the outside liner of the cortex structure, whereas the L2/3 cells are enriched next to the Astro cells, which is consistent with the spatial patterns of real-ST data. Pseudo-spots containing L6b cells are shown with high proportions in the inner liner of the cortex tissue. Oligodendrocyte cells within pseudo-spots remain abundant at the innermost layer. These data show that the pseudo-ST data presents coherent spatial patterns with real-ST data as illustrated in <xref rid="f3" ref-type="fig">Figure 3B</xref>, which is consistent with the layered cytoarchitecture of the cortex tissue. These results also verify the accuracy and reliability of using pseudo-ST data in DSTG.</p>
    </sec>
    <sec id="sec12">
      <title>Mapping distinct cell populations of mouse hippocampus</title>
      <p>The fast advance of ST technologies raises new challenges in deconvoluting the transcriptomics data at each spot: spots become smaller; meanwhile the total number of spots grows exponentially, but the sequencing depth at each spot becomes much lower. We demonstrated the performance of DSTG on such emerging ST data, using the recently available Slide-seq v2 [<xref rid="ref15" ref-type="bibr">15</xref>] of mouse hippocampus tissues as an example. Comparing with the 10X Genomics’ Visium platform, the bead size of the Slide-seq v2 platform is 5.5-fold smaller, thus the spatial resolution is 25–100-fold higher. Consequently, the typical median library size per bead is 550 UMIs, 100-fold lower than 10X Genomics Visium.</p>
      <p>To deconvolute this ST data, we used the existing scRNA-seq dataset from mouse hippocampus [<xref rid="ref43" ref-type="bibr">43</xref>], which consists of 52 846 cells with 19 cell types that are profiled by the Drop-seq protocol (<xref rid="f4" ref-type="fig">Figure 4A</xref>). Based on this scRNA-seq data, DSTG’s spatial decomposition of the ST data accurately identifies different cell types within the hippocampus slice (<xref rid="f4" ref-type="fig">Figure 4B</xref>). The spatially localized pie charts represent the identified different cell proportions in the slice. Moreover, our predicted compositions provide more detailed information about the heterogeneity of this area. Closer investigation confirms the regional enrichment of specific cell types with their identified composition (<xref rid="f4" ref-type="fig">Figure 4C</xref>). For example, oligodendrocyte cells are identified with high compositions in the middle wide strips within the hippocampus slice. In the Cornu Ammonis (CA) subfield, CA3 principal cells scatter within the slice with low proportions, but are majorly abundant in the half strip at the right of the slice. Ependymal cells present mainly at an irregular circle and the other band at the top right of the slice, of which data are consistent with the spatial structures within the mouse hippocampus.</p>
      <fig position="float" id="f4">
        <label>
Figure 4
</label>
        <caption>
          <p>Spatial chart of mouse hippocampus tissue using DSTG. (<bold>A</bold>) Uniform manifold approximation and projection (UMAP) projections of single-cell RNA-seq data from mouse hippocampus tissue. Different cell types are labeled and colored based on known cell annotations. (<bold>B</bold>) Spatial plot with pie chart shows the predicted cell compositions within the captured locations in the mouse hippocampus. (<bold>C</bold>) Spatial plot presents the proportions of specific neuron subtypes within the captured location. Red color indicates high abundance of certain cell type in this region. (<bold>D</bold>) Spatial expression of cell type specific markers of the respective neuron subtypes in the ST data.</p>
        </caption>
        <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="bbaa414f4" position="float"/>
      </fig>
      <p>To further evaluate our method, we selected the cell type-specific genes from scRNA-seq data and assessed their expression in the ST data. As expected, the top differentially expressed gene marker in oligodendrocyte (<xref rid="f4" ref-type="fig">Figure 4D</xref>), Proteolipid Protein 1 (PLP1), expresses strictly in line with the oligodendrocyte region based on the ST data. Coiled-Coil Domain Containing 153 (CCDC153) is the top expressed gene marker in CA3 principal cells that is also detected with high expression in the ST data of CA3 principal cells. Another example is neuronal pentraxin receptor (NPTXR), the marker of ependymal, is enriched at regions with a high abundance of ependymal cells. These cell-specific genes detected in their corresponding locations further underlines the accuracy of DSTG. In summary, DSTG demonstrates accurate and reliable deconvolution capabilities on ST data generated from the latest ST platform such as the Slide-seqV2, which has much smaller spot size, much larger number of spots and much lower sequencing depth.</p>
    </sec>
    <sec id="sec13">
      <title>Deconvolution of pancreatic cancer tissue sections</title>
      <p>Tissues in diseases such as tumors exhibit unique pathological cytoarchitectures. To further demonstrate and test the DSTG’s performance in such conditions, we applied it to two ST data obtained from two tumor sections of pancreatic ductal adenocarcinoma (PDAC), i.e. PDAC-A and PDAC-B. Sample-matched scRNA-seq data (<xref rid="sup6" ref-type="supplementary-material">Supplementary Figure S6</xref>) generated by inDrop protocol is used to generate the pseudo-ST data, which shares similar characteristics with real-ST data (<xref rid="sup7" ref-type="supplementary-material">Supplementary Figure S7</xref>).</p>
      <p>For the PDAC-A sample (<xref rid="f5" ref-type="fig">Figure 5A</xref>), after DSTG’s deconvolution, we observed discrete regional enrichment of cancer clones and noncancer cells. Specifically, cells of cancer clone S100 Calcium Binding Protein A4 (S100A4) and Transmembrane 4 L Six Family Member 1 (TM4SF1) are mainly identified mixed in the spots of cancerous region, which are excluded from the spots of ductal cells including the centroacinar ductal cells and the co-localized antigen-presenting ductal cells. Stroma cells are involved between the ductal cells and cancer cells, which are consistent with previous results annotated by hematoxylin and eosin (H&amp;E) staining and brightfield imaging [<xref rid="ref13" ref-type="bibr">13</xref>]. We also found a few proportions of hypoxic ductal cells in the spots close to the cancerous region, indicating the low oxygen environment in tumor. Further inspections of specific cell types (<xref rid="f5" ref-type="fig">Figure 5B</xref>), including cancer clone cells and ductal cells, confirm their regional proportions on their identified structures. The point size and related color indicate different compositions in the spatial spots.</p>
      <fig position="float" id="f5">
        <label>
Figure 5
</label>
        <caption>
          <p>Mapping spatial spots across pancreatic cancer tissue. (<bold>A</bold>) Spatial plot shows the predicted compositions of different cell types within the captured spots of PDAC-A tissue slice. (<bold>B</bold>) Predicted proportions of different cell types including antigen-presenting ductal cells, centroacinar ductal cells, cancer clone TMSF1 and S100A4. (<bold>C</bold>) Spatial plot presents the predicted compositions of different cell types within captured spots of PDAC-B tissue slice. (<bold>D</bold>) Predicted proportions of different cell types including ductal cells, cancer clone TMSF1 and interstitium. Red color indicates high proportion of certain cell type.</p>
        </caption>
        <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="bbaa414f5" position="float"/>
      </fig>
      <p>In the other PDAC-B sample, as shown in <xref rid="f5" ref-type="fig">Figure 5C</xref>, cells of cancer clone TM4SF1 rather than cancer clone S100A4 are identified. These cancer clone TM4SF1 cells are localized preferentially in the spots of the bottom right region, distinguished from the interstitium and ductal cells. We noticed that most interstitium cells are adjacent to the cancer clone TM4SF1 cells, and some interstitium cells co-localize with the cancer cells. Ductal cells are mainly abundant in the spatial spots of the top region. These findings highlight the precise consistency with previous H&amp;E staining results [<xref rid="ref13" ref-type="bibr">13</xref>]. Further inspections of cancer clones and ductal cells (<xref rid="f5" ref-type="fig">Figure 5D</xref>) confirm their regional compositions on their known locations. These results of DSTG are consistent with independent histological annotations, supporting its ability to identify accurate cellular compositions from the ST data of tumor tissues.</p>
      <p>In addition, we applied SPOTlight to the real-ST data of PDAC-A and compared its results with DSTG. After deconvolution, we observed similar spatial contexture as well as different cell compositions between SPOTlight’s and DSTG’s results (<xref rid="sup8" ref-type="supplementary-material">Supplementary Figure S8A</xref>). Specifically, SPOTlight and DSTG identify different proportions of centroacinar ductal cells (<xref rid="sup8" ref-type="supplementary-material">Supplementary Figure S8B</xref>). Both methods discern abundant centroacinar ductal cells in the left region, which are distinguished from stroma and cancer cells. However, centroacinar ductal cells identified by DSTG are more consistent with the expression of its marker Claudin 2 (CLDN2), with higher Pearson correlation (cor = 0.739) than DSTG (cor = 0.524). We also looked into the proportions of stroma cells identified by SPOTlight and DSTG, respectively (<xref rid="sup8" ref-type="supplementary-material">Supplementary Figure S8C</xref>). The stroma cells revealed by SPOTlight localize more prevalently within the tissue with less proportions. Moreover, the stroma compositions identified by SPOTlight are less associated with its maker Collagen alpha 1 chain type I (COL1A1) expression (cor = 0.457), whereas DSTG identified stroma proportions are far more correlated with COL1A1 expression (cor = 0.644). In addition to the ductal and stroma cells, we also compared the compositions of cancer clone S100A4 cells identified by two methods (<xref rid="sup8" ref-type="supplementary-material">Supplementary Figure S8D</xref>), of which the expression of Glyceraldehyde-3-Phosphate Dehydrogenase (GAPDH) maker exhibits stronger association with DSTG’s prediction (cor = 0.783) than that of SPOTlight (cor = 0.511). Thus, DSTG shows superior performance than SPOTlight in accurately decomposing tissue architectures.</p>
      <p>In conclusion, DSTG is able to detect the unique cytoarchitectures in disease tissues, distinguish the spatial distribution of tumor cells evolved from different clones and characterize cancer-specific cellular phenomena such as local hypoxia as well as antigen presenting in the tumor cell dominating regions.</p>
    </sec>
  </sec>
  <sec id="sec14">
    <title>Discussion</title>
    <p>ST provides unprecedented opportunities to study tissue heterogeneity and cell spatial organization [<xref rid="ref44" ref-type="bibr">44–46</xref>]. However, the resolution of ST is less than the single-cell level. As single spot in ST data may cover heterogenous cell types, our DSTG method aims to determine the proportions of different cell types and states across spots where genes are reliably identified. In this study, we present the DSTG method for performing cell type deconvolution in ST data using the GCN. DSTG is evaluated by benchmarking synthetic data generated from PBMC and other tissues, in which DSTG demonstrates excellent accuracy between the predicted cell mixtures and the actual cell composition. DSTG is also shown to achieve high consistency with H&amp;E staining observations on ST data from complex tissues including mouse cortex, hippocampus and human pancreatic tumor slices.</p>
    <p>For the pseudo-ST data used in DSTG, we tested that pseudo-ST shares similar characteristics with real-ST data through investigating their respective distributions of gene expression using the PDAC tissue sample (<xref rid="sup7" ref-type="supplementary-material">Supplementary Figure S7A</xref>). Through Kolmogorov–Smirnov test, we found that the distribution of DSTG’s pseudo-ST data is not significantly differed from the distribution of real-ST data (<italic toggle="yes">P</italic>-value = 0.419). In contrast, the distribution of sample-matched scRNA-seq data is significantly differed from that of real-ST data (<italic toggle="yes">P</italic>-value = 4.89e−14, <xref rid="sup7" ref-type="supplementary-material">Supplementary Figure S7B</xref>). This observation suggests that pseudo-ST data shares similar characteristics with real-ST data, even more than its matched scRNA-seq data. Moreover, we looked into the Euclidian distance between the pseudo-ST and real-ST data (<xref rid="sup7" ref-type="supplementary-material">Supplementary Figure S7C</xref>). Comparing with the distances between scRNA-seq data and real-ST data (red histogram), the distances between pseudo-ST and real-ST data (blue histogram) are significantly closer with <italic toggle="yes">P</italic>-value &lt;2.2e-16, again showing that pseudo-ST is more similar with the real-ST data than its matched scRNA-seq data. These results confirm that the pseudo-ST data used in DSTG shares similar characteristics with the real-ST data.</p>
    <p>As SPOTlight is also used to deconvolute the ST data, we compared DSTG with SPOTlight and found DSTG consistently outperforms SPOTlight on benchmarking synthetic data. From a technical perspective, DSTG provides some major advantages. First, DSTG simultaneously utilizes variable genes and graphical structures through a nonlinear propagation in each layer, which is appropriate for learning the cellular composition due to the heteroskedastic and discrete nature of ST data. Second, DSTG identifies the respective weights of different cell types in the pseudo-ST data generated from scRNA-seq data, which can be effectively leveraged to learn the cell compositions in the real-ST data. Third, as the sequencing depth of spatial data is expected to increase, DSTG has been shown to perform better to interrogate the cell distribution quantitatively in such ST data.</p>
    <p>In addition to the successful results, there are several aspects that DSTG can be improved. First, as an AI model, DSTG shows not only the merits of its kind, but also some limitations including the black-box nature of AI models [<xref rid="ref47" ref-type="bibr">47–49</xref>], which can be addressed through downstream analysis that can ameliorate some of the problems and bring insights into the learned cellular compositions. Second, as a graph model, improving the built graph can further boost the model performance. Our link graph based on mutual nearest neighbors best captures the spots’ similarity in spatial data, reflecting the effective graph representation. As a fast-growing research field, new approaches of building graph are emerging, of which we will test and adapt in future versions of DSTG.</p>
    <p>Our DSTG method paves the way for inferring functional relationships between heterogenous cell subpopulations based on their composition and co-localization in the tissue spots. This includes intercellular communication across neighboring spots, which opens up future possibilities of studying the complete interactome in a spatially resolved manner. Moreover, as the precise composition of tissue may vary from one individual patient to the other, the spatial composition of cellular subpopulations can be of prognostic value for patients in the future. We anticipate that the spatial deconvolution using DSTG will contribute to future patient prognosis and pathological assessments. Overall, DSTG demonstrates as a robust and accurate tool to determine cell type locations and precise compositions of spatial spots, which provides an unbiased perspective and investigation into the spatial organization of distinct cellular populations in tissue.</p>
    <sec sec-type="data-availability" id="sec15">
      <title>Data availability</title>
      <p>All scRNA-seq datasets are downloaded from their public accessions. The first benchmarking PBMC scRNA-seq datasets [<xref rid="ref35" ref-type="bibr">35</xref>] in <xref rid="f2" ref-type="fig">Figure 2A</xref> are generated by 13 different protocols, including C1HT-medium, ICELL8, MARS-Seq, Chromium (sn), CEL-Seq2, gmcSCRB-Seq, C1HT-small, inDrop, Drop-Seq, ddSEQ, Smart-Seq2, Chromium and Quartz-Seq2. These 13 PBMC datasets are publicly available through the Gene Expression Omnibus (GEO) (GSE133549). Cell types with too small sizes are ignored to avoid misleading information. To evaluate the impact of synthetic data (<xref rid="f2" ref-type="fig">Figure 2C–E</xref>), we used the Smart-Seq2 PBMC dataset to generate discrete synthetic data with different number of spots and variable genes, as well as different sequencing depths.</p>
      <p>For the second benchmarking in <xref rid="f2" ref-type="fig">Figure 2B</xref>, the Drop-Seq data is downloaded from the Short Read Archive under accession number SRP073767 [<xref rid="ref2" ref-type="bibr">2</xref>]. The Microwell-Seq data is profiled using the Microwell-Seq protocol [<xref rid="ref50" ref-type="bibr">50</xref>] that can be downloaded from the Mouse Cell Atlas. The snRNA-Seq data is profiled from the entorhinal cortex from human brains of Alzheimer’s disease, yielding a total of 13 214 high-quality nuclei [<xref rid="ref51" ref-type="bibr">51</xref>] using the single-nucleus RNA-seq protocol, which can be downloaded from GEO (accession number: GSE138852). The Smart-Seq2 data is profiled using the Smart-Seq2 platform [<xref rid="ref52" ref-type="bibr">52</xref>], which is profiled from melanoma tumor and downloaded from GEO (accession number: GSE72056). The CEL-Seq2 data is obtained from human cadaveric pancreata using the CEL-Seq2 protocol (accession number: GSE85241) that consists of 2122 cells and 18 915 genes [<xref rid="ref53" ref-type="bibr">53</xref>]. The SMART-Seq v4 data is downloaded from the database of Genotypes and Phenotypes (dbGAP) (accession number: phs001790) [<xref rid="ref54" ref-type="bibr">54</xref>], which is generated using SMART-Seq v4 platform. This dataset contains 16 024 genes and 14 055 cells, from 34 cell types in the middle temporal gyrus of human cerebral cortex. The CEL-Seq data is obtained from three human lung adenocarcinoma cell lines using the CEL-Seq platform that consists of 570 cells and 12 627 genes [<xref rid="ref55" ref-type="bibr">55</xref>], which can be downloaded from GEO (accession number: GSE117617). The Fluidigm data is profiled using Fluidigm C1 platform with 11 778 cells and 3803 genes [<xref rid="ref56" ref-type="bibr">56</xref>]. We downloaded this data from GEO (accession number: GSE81608).</p>
      <p>For the applications of DSTG in real-ST data, we selected the well-annotated scRNA-seq data of the same tissue type as ground truth and generate synthetic pseudo-ST data to train the model. We listed the cell types with sufficient cell numbers of each scRNA-seq data in <xref rid="sup9" ref-type="supplementary-material">Supplementary tables</xref>. Specifically, to deconvolute the mouse cortex ST, we used the scRNA-seq dataset profiled by the Smart-Seq2 protocol from the Allen Institute, which consists of ~14 000 adult mouse cortical cell taxonomy and 22 cell types to generate the pseudo-ST data as training data (<xref rid="sup9" ref-type="supplementary-material">Supplementary Table S1</xref>). To deconvolute the ST data of mouse hippocampus tissue, we used the existing scRNA-seq dataset from mouse hippocampus [<xref rid="ref43" ref-type="bibr">43</xref>], which consists of 52 846 cells with 19 cell types that are profiled by the Drop-seq protocol (<xref rid="sup9" ref-type="supplementary-material">Supplementary Table S2</xref>). Regarding the deconvolution of ST data in pancreatic tissues, we used their matched scRNA-seq data with adequate cells profiled by inDrop protocol (<xref rid="sup9" ref-type="supplementary-material">Supplementary Tables S3</xref> and <xref rid="sup9" ref-type="supplementary-material">S4</xref>).</p>
      <sec id="sec16">
        <title>Code availability</title>
        <p>All the functions mentioned above were implemented as a Python software, which can be downloaded at <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://github.com/Su-informatics-lab/DSTG" ext-link-type="uri">https://github.com/Su-informatics-lab/DSTG</ext-link>.</p>
        <boxed-text id="box01" position="float">
          <sec id="sec20">
            <title>Key Points</title>
            <list list-type="bullet">
              <list-item>
                <p>We have developed a novel semi-supervised GCN model, named DSTG, to accurately deconvolute the observed gene expressions at each spot of ST data and recover its cell constitutions.</p>
              </list-item>
              <list-item>
                <p>DSTG demonstrates high accuracy and robust performance across experimental protocols, ST platforms and tissues from different organs.</p>
              </list-item>
              <list-item>
                <p>DSTG is available as a ready-to-use open source software for precise interrogation of spatial organizations and functions in tissues.</p>
              </list-item>
            </list>
          </sec>
        </boxed-text>
      </sec>
    </sec>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="sup1" position="float" content-type="local-data">
      <label>Figure_S1_bbaa414</label>
      <media xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="figure_s1_bbaa414.jpeg">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="sup2" position="float" content-type="local-data">
      <label>Figure_S2_bbaa414</label>
      <media xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="figure_s2_bbaa414.jpeg">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="sup3" position="float" content-type="local-data">
      <label>Figure_S3_bbaa414</label>
      <media xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="figure_s3_bbaa414.jpeg">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="sup4" position="float" content-type="local-data">
      <label>Figure_S4_bbaa414</label>
      <media xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="figure_s4_bbaa414.jpeg">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="sup5" position="float" content-type="local-data">
      <label>Figure_S5_bbaa414</label>
      <media xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="figure_s5_bbaa414.jpeg">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="sup6" position="float" content-type="local-data">
      <label>Figure_S6_bbaa414</label>
      <media xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="figure_s6_bbaa414.jpeg">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="sup7" position="float" content-type="local-data">
      <label>Figure_S7_bbaa414</label>
      <media xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="figure_s7_bbaa414.jpeg">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="sup8" position="float" content-type="local-data">
      <label>Figure_S8_bbaa414</label>
      <media xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="figure_s8_bbaa414.jpeg">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="sup9" position="float" content-type="local-data">
      <label>Supplementary_table_bbaa414</label>
      <media xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="supplementary_table_bbaa414.xlsx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack id="bbaa414-ack">
    <title>Acknowledgments</title>
    <p>The authors acknowledge the DEMON high-performance computing (HPC) cluster, the Texas Advanced Computing Center at The University of Texas at Austin (<ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://www.tacc.utexas.edu" ext-link-type="uri">http://www.tacc.utexas.edu</ext-link>), and the Extreme Science and Engineering Discovery Environment (which is supported by National Science Foundation grant number ACI-1548562) for providing HPC resources that have contributed to the research results reported within this paper.</p>
  </ack>
  <sec id="sec22">
    <title>Funding</title>
    <p>This work was supported by the Indiana University Precision Health Initiative to J.S.</p>
  </sec>
  <sec id="sec18">
    <title>Authors’ Contributions</title>
    <p>Q.S. and J.S. developed the structure and arguments for the paper and wrote the manuscript. All the authors reviewed and approved the final manuscript.</p>
  </sec>
  <notes id="bio3">
    <p><bold>Qianqian Song</bold> is a postdoctoral research fellow in the Department of Cancer Biology, Wake Forest School of Medicine, NC, USA. Her major is bioinformatics and her recent work focuses on developing graph-based tools for single-cell genomics and spatial transcriptomics data.</p>
    <p><bold>Jing Su</bold> is an assistant professor in the Department of Biostatistics, Indiana University School of Medicine, IN, USA. His research focuses on graph artificial intelligence and machine learning in biomedical informatics and precision health.</p>
  </notes>
  <ref-list id="bib1">
    <title>References</title>
    <ref id="ref1">
      <label>1.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Song</surname><given-names>Q</given-names></string-name>, <string-name><surname>Su</surname><given-names>J</given-names></string-name>, <string-name><surname>Miller</surname><given-names>LD</given-names></string-name>, <etal>et al.</etal></person-group><article-title>scLM: automatic detection of consensus gene clusters across multiple single-cell datasets</article-title>. <source>bioRxiv</source><year>2020</year>. doi: <pub-id pub-id-type="doi">10.1101/055822</pub-id>.</mixed-citation>
    </ref>
    <ref id="ref2">
      <label>2.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zheng</surname><given-names>GXY</given-names></string-name>, <string-name><surname>Terry</surname><given-names>JM</given-names></string-name>, <string-name><surname>Belgrader</surname><given-names>P</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Massively parallel digital transcriptional profiling of single cells</article-title>. <source>Nat Commun</source><year>2017</year>;<volume>8</volume>(<issue>1</issue>):<elocation-id>14049</elocation-id>.<pub-id pub-id-type="pmid">28091601</pub-id></mixed-citation>
    </ref>
    <ref id="ref3">
      <label>3.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Schaum</surname><given-names>N</given-names></string-name>, <string-name><surname>Karkanias</surname><given-names>J</given-names></string-name>, <string-name><surname>Neff</surname><given-names>NF</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Single-cell transcriptomics of 20 mouse organs creates a Tabula Muris</article-title>. <source>Nature</source><year>2018</year>;<volume>562</volume>(<issue>7727</issue>):<fpage>367</fpage>–<lpage>72</lpage>.<pub-id pub-id-type="pmid">30283141</pub-id></mixed-citation>
    </ref>
    <ref id="ref4">
      <label>4.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Papalexi</surname><given-names>E</given-names></string-name>, <string-name><surname>Satija</surname><given-names>R</given-names></string-name></person-group>. <article-title>Single-cell RNA sequencing to explore immune cell heterogeneity</article-title>. <source>Nat Rev Immunol</source><year>2018</year>;<volume>18</volume>(<issue>1</issue>):<fpage>35</fpage>–<lpage>45</lpage>.<pub-id pub-id-type="pmid">28787399</pub-id></mixed-citation>
    </ref>
    <ref id="ref5">
      <label>5.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Song</surname><given-names>Q</given-names></string-name>, <string-name><surname>Hawkins</surname><given-names>GA</given-names></string-name>, <string-name><surname>Wudel</surname><given-names>L</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Dissecting intratumoral myeloid cell plasticity by single cell RNA-seq</article-title>. <source>Cancer Med</source><year>2019</year>;<volume>8</volume>(<issue>6</issue>):<fpage>3072</fpage>–<lpage>85</lpage>.<pub-id pub-id-type="pmid">31033233</pub-id></mixed-citation>
    </ref>
    <ref id="ref6">
      <label>6.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Bendall</surname><given-names>SC</given-names></string-name>, <string-name><surname>Davis</surname><given-names>KL</given-names></string-name>, <string-name><surname>Amir el</surname><given-names>AD</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Single-cell trajectory detection uncovers progression and regulatory coordination in human B cell development</article-title>. <source>Cell</source><year>2014</year>;<volume>157</volume>(<issue>3</issue>):<fpage>714</fpage>–<lpage>25</lpage>.<pub-id pub-id-type="pmid">24766814</pub-id></mixed-citation>
    </ref>
    <ref id="ref7">
      <label>7.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Trapnell</surname><given-names>C</given-names></string-name>, <string-name><surname>Cacchiarelli</surname><given-names>D</given-names></string-name>, <string-name><surname>Grimsby</surname><given-names>J</given-names></string-name>, <etal>et al.</etal></person-group><article-title>The dynamics and regulators of cell fate decisions are revealed by pseudotemporal ordering of single cells</article-title>. <source>Nat Biotechnol</source><year>2014</year>;<volume>32</volume>(<issue>4</issue>):<fpage>381</fpage>–<lpage>6</lpage>.<pub-id pub-id-type="pmid">24658644</pub-id></mixed-citation>
    </ref>
    <ref id="ref8">
      <label>8.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ståhl</surname><given-names>PL</given-names></string-name>, <string-name><surname>Salmén</surname><given-names>F</given-names></string-name>, <string-name><surname>Vickovic</surname><given-names>S</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Visualization and analysis of gene expression in tissue sections by spatial transcriptomics</article-title>. <source>Science</source><year>2016</year>;<volume>353</volume>(<issue>6294</issue>):<fpage>78</fpage>–<lpage>82</lpage>.<pub-id pub-id-type="pmid">27365449</pub-id></mixed-citation>
    </ref>
    <ref id="ref9">
      <label>9.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lee</surname><given-names>JH</given-names></string-name>, <string-name><surname>Daugharthy</surname><given-names>ER</given-names></string-name>, <string-name><surname>Scheiman</surname><given-names>J</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Highly multiplexed subcellular RNA sequencing in situ</article-title>. <source>Science</source><year>2014</year>;<volume>343</volume>(<issue>6177</issue>):<fpage>1360</fpage>–<lpage>3</lpage>.<pub-id pub-id-type="pmid">24578530</pub-id></mixed-citation>
    </ref>
    <ref id="ref10">
      <label>10.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Chen</surname><given-names>KH</given-names></string-name>, <string-name><surname>Boettiger</surname><given-names>AN</given-names></string-name>, <string-name><surname>Moffitt</surname><given-names>JR</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Spatially resolved, highly multiplexed RNA profiling in single cells</article-title>. <source>Science</source><year>2015</year>;<volume>348</volume>(<issue>6233</issue>):aaa6090.</mixed-citation>
    </ref>
    <ref id="ref11">
      <label>11.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Asp</surname><given-names>M</given-names></string-name>, <string-name><surname>Giacomello</surname><given-names>S</given-names></string-name>, <string-name><surname>Larsson</surname><given-names>L</given-names></string-name>, <etal>et al.</etal></person-group><article-title>A spatiotemporal organ-wide gene expression and cell atlas of the developing human heart</article-title>. <source>Cell</source><year>2019</year>;<volume>179</volume>(<issue>7</issue>):<fpage>1647</fpage>–<lpage>60.e19</lpage>.<pub-id pub-id-type="pmid">31835037</pub-id></mixed-citation>
    </ref>
    <ref id="ref12">
      <label>12.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Maynard</surname><given-names>KR</given-names></string-name>, <string-name><surname>Collado-Torres</surname><given-names>L</given-names></string-name>, <string-name><surname>Weber</surname><given-names>LM</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Transcriptome-scale spatial gene expression in the human dorsolateral prefrontal cortex</article-title>. <source>bioRxiv</source><year>2020</year>. doi: <pub-id pub-id-type="doi">10.1101/969931</pub-id>.</mixed-citation>
    </ref>
    <ref id="ref13">
      <label>13.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Moncada</surname><given-names>R</given-names></string-name>, <string-name><surname>Barkley</surname><given-names>D</given-names></string-name>, <string-name><surname>Wagner</surname><given-names>F</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Integrating microarray-based spatial transcriptomics and single-cell RNA-seq reveals tissue architecture in pancreatic ductal adenocarcinomas</article-title>. <source>Nat Biotechnol</source><year>2020</year>;<volume>38</volume>(<issue>3</issue>):<fpage>333</fpage>–<lpage>42</lpage>.<pub-id pub-id-type="pmid">31932730</pub-id></mixed-citation>
    </ref>
    <ref id="ref14">
      <label>14.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Maniatis</surname><given-names>S</given-names></string-name>, <string-name><surname>Äijö</surname><given-names>T</given-names></string-name>, <string-name><surname>Vickovic</surname><given-names>S</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Spatiotemporal dynamics of molecular pathology in amyotrophic lateral sclerosis</article-title>. <source>Science</source><year>2019</year>;<volume>364</volume>(<issue>6435</issue>):<fpage>89</fpage>–<lpage>93</lpage>.<pub-id pub-id-type="pmid">30948552</pub-id></mixed-citation>
    </ref>
    <ref id="ref15">
      <label>15.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Stickels</surname><given-names>RR</given-names></string-name>, <string-name><surname>Murray</surname><given-names>E</given-names></string-name>, <string-name><surname>Kumar</surname><given-names>P</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Sensitive spatial genome wide expression profiling at cellular resolution</article-title>. <source>bioRxiv</source><year>2020</year>. doi: <pub-id pub-id-type="doi">10.1101/989806</pub-id>.</mixed-citation>
    </ref>
    <ref id="ref16">
      <label>16.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Rodriques</surname><given-names>SG</given-names></string-name>, <string-name><surname>Stickels</surname><given-names>RR</given-names></string-name>, <string-name><surname>Goeva</surname><given-names>A</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Slide-seq: a scalable technology for measuring genome-wide expression at high spatial resolution</article-title>. <source>Science</source><year>2019</year>;<volume>363</volume>(<issue>6434</issue>):<fpage>1463</fpage>–<lpage>7</lpage>.<pub-id pub-id-type="pmid">30923225</pub-id></mixed-citation>
    </ref>
    <ref id="ref17">
      <label>17.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Saiselet</surname><given-names>M</given-names></string-name>, <string-name><surname>Rodrigues-Vitória</surname><given-names>J</given-names></string-name>, <string-name><surname>Craciun</surname><given-names>L</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Transcriptional output, cell types densities and normalization in spatial transcriptomics</article-title>. <source>bioRxiv</source><year>2018</year>;<elocation-id>503870</elocation-id>. doi: <pub-id pub-id-type="doi">10.1101/503870</pub-id>.</mixed-citation>
    </ref>
    <ref id="ref18">
      <label>18.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Elosua</surname><given-names>M</given-names></string-name>, <string-name><surname>Nieto</surname><given-names>P</given-names></string-name>, <string-name><surname>Mereu</surname><given-names>E</given-names></string-name>, <etal>et al.</etal></person-group><article-title>SPOTlight: seeded NMF regression to deconvolute spatial transcriptomics spots with single-cell transcriptomes</article-title>. <source>bioRxiv</source><year>2020</year>. doi: <pub-id pub-id-type="doi">10.1101/131334</pub-id>.</mixed-citation>
    </ref>
    <ref id="ref19">
      <label>19.</label>
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Kipf</surname><given-names>T</given-names></string-name>, <string-name><surname>Welling</surname><given-names>M</given-names></string-name></person-group>. <article-title>Semi-supervised classification with graph convolutional networks</article-title>. In: <source>ICLR</source>. Toulon, France: International Conference on Learning Representations (ICLR), <year>2017</year>.</mixed-citation>
    </ref>
    <ref id="ref20">
      <label>20.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Veličković</surname><given-names>P</given-names></string-name>, <string-name><surname>Cucurull</surname><given-names>G</given-names></string-name>, <string-name><surname>Casanova</surname><given-names>A</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Graph attention networks</article-title>. <source>arXiv</source><year>2017</year>; <comment>preprint arXiv:1710.10903</comment>.</mixed-citation>
    </ref>
    <ref id="ref21">
      <label>21.</label>
      <mixed-citation publication-type="other"><person-group person-group-type="editor"><string-name><surname>Defferrard</surname><given-names>M</given-names></string-name>, <string-name><surname>Bresson</surname><given-names>X</given-names></string-name>, <string-name><surname>Vandergheynst</surname><given-names>P</given-names></string-name></person-group> (eds). <article-title>Convolutional neural networks on graphs with fast localized spectral filtering</article-title>. In: <source>Advances in Neural Information Processing Systems</source>. Barcelona, Spain, <year>2016</year>.</mixed-citation>
    </ref>
    <ref id="ref22">
      <label>22.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Fang</surname><given-names>C</given-names></string-name>, <string-name><surname>Xu</surname><given-names>D</given-names></string-name>, <string-name><surname>Su</surname><given-names>J</given-names></string-name>, <etal>et al.</etal></person-group><article-title>DeePaN: a deep patient graph convolutional network integrating clinico-genomic evidence to stratify lung cancers benefiting from immunotherapy</article-title>. <source>medRxiv</source><year>2020</year>;<elocation-id>19011437</elocation-id>. doi: <pub-id pub-id-type="doi">10.1101/19011437</pub-id>.</mixed-citation>
    </ref>
    <ref id="ref23">
      <label>23.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Haghverdi</surname><given-names>L</given-names></string-name>, <string-name><surname>Lun</surname><given-names>ATL</given-names></string-name>, <string-name><surname>Morgan</surname><given-names>MD</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Batch effects in single-cell RNA-sequencing data are corrected by matching mutual nearest neighbors</article-title>. <source>Nat Biotechnol</source><year>2018</year>;<volume>36</volume>(<issue>5</issue>):<fpage>421</fpage>–<lpage>7</lpage>.<pub-id pub-id-type="pmid">29608177</pub-id></mixed-citation>
    </ref>
    <ref id="ref24">
      <label>24.</label>
      <mixed-citation publication-type="other"><person-group person-group-type="editor"><string-name><surname>Song</surname><given-names>Y</given-names></string-name>, <string-name><surname>Zheng</surname><given-names>S</given-names></string-name>, <string-name><surname>Niu</surname><given-names>Z</given-names></string-name>, <etal>et al.</etal></person-group> (eds). <article-title>Communicative representation learning on attributed molecular graphs</article-title>. In: <source>IJCAI</source>, <year>2020</year>; pp. 2831–38.</mixed-citation>
    </ref>
    <ref id="ref25">
      <label>25.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zhao</surname><given-names>T</given-names></string-name>, <string-name><surname>Hu</surname><given-names>Y</given-names></string-name>, <string-name><surname>Valsdottir</surname><given-names>LR</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Identifying drug–target interactions based on graph convolutional network and deep neural network</article-title>. <source>Brief Bioinform</source><year>2020</year>;bbaa044.</mixed-citation>
    </ref>
    <ref id="ref26">
      <label>26.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zeng</surname><given-names>Y</given-names></string-name>, <string-name><surname>Zhou</surname><given-names>X</given-names></string-name>, <string-name><surname>Rao</surname><given-names>J</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Accurately clustering single-cell RNA-seq data by capturing structural relations between cells through graph convolutional network</article-title>. <source>bioRxiv</source><year>2020</year>. doi: <pub-id pub-id-type="doi">10.1101/278804</pub-id>.</mixed-citation>
    </ref>
    <ref id="ref27">
      <label>27.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Yuan</surname><given-names>Y</given-names></string-name>, <string-name><surname>Bar-Joseph</surname><given-names>Z</given-names></string-name></person-group>. <article-title>GCNG: graph convolutional networks for inferring cell-cell interactions</article-title>. <source>bioRxiv</source><year>2019</year>. doi: <pub-id pub-id-type="doi">10.1101/887133</pub-id>.</mixed-citation>
    </ref>
    <ref id="ref28">
      <label>28.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Li</surname><given-names>J</given-names></string-name>, <string-name><surname>Zhang</surname><given-names>S</given-names></string-name>, <string-name><surname>Liu</surname><given-names>T</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Neural inductive matrix completion with graph convolutional networks for miRNA-disease association prediction</article-title>. <source>Bioinformatics</source><year>2020</year>;<volume>36</volume>(<issue>8</issue>):<fpage>2538</fpage>–<lpage>46</lpage>.<pub-id pub-id-type="pmid">31904845</pub-id></mixed-citation>
    </ref>
    <ref id="ref29">
      <label>29.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Song</surname><given-names>Q</given-names></string-name>, <string-name><surname>Su</surname><given-names>J</given-names></string-name>, <string-name><surname>Zhang</surname><given-names>W</given-names></string-name></person-group>. <article-title>scGCN: a graph convolutional networks algorithm for knowledge transfer in single cell omics</article-title>. <source>bioRxiv</source><year>2020</year>. doi: <pub-id pub-id-type="doi">10.1101/295535</pub-id>.</mixed-citation>
    </ref>
    <ref id="ref30">
      <label>30.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kettenring</surname><given-names>JR</given-names></string-name></person-group>. <article-title>Canonical analysis of several sets of variables</article-title>. <source>Biometrika</source><year>1971</year>;<volume>58</volume>(<issue>3</issue>):<fpage>433</fpage>–<lpage>51</lpage>.</mixed-citation>
    </ref>
    <ref id="ref31">
      <label>31.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Nielsen</surname><given-names>AA</given-names></string-name></person-group>. <article-title>Multiset canonical correlations analysis and multispectral, truly multitemporal remote sensing data</article-title>. <source>IEEE Trans Image Process</source><year>2002</year>;<volume>11</volume>(<issue>3</issue>):<fpage>293</fpage>–<lpage>305</lpage>.<pub-id pub-id-type="pmid">18244632</pub-id></mixed-citation>
    </ref>
    <ref id="ref32">
      <label>32.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hardoon</surname><given-names>DR</given-names></string-name>, <string-name><surname>Szedmak</surname><given-names>S</given-names></string-name>, <string-name><surname>Shawe-Taylor</surname><given-names>J</given-names></string-name></person-group>. <article-title>Canonical correlation analysis: an overview with application to learning methods</article-title>. <source>Neural Comput</source><year>2004</year>;<volume>16</volume>(<issue>12</issue>):<fpage>2639</fpage>–<lpage>64</lpage>.<pub-id pub-id-type="pmid">15516276</pub-id></mixed-citation>
    </ref>
    <ref id="ref33">
      <label>33.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Witten</surname><given-names>DM</given-names></string-name>, <string-name><surname>Tibshirani</surname><given-names>R</given-names></string-name>, <string-name><surname>Hastie</surname><given-names>T</given-names></string-name></person-group>. <article-title>A penalized matrix decomposition, with applications to sparse principal components and canonical correlation analysis</article-title>. <source>Biostatistics</source><year>2009</year>;<volume>10</volume>(<issue>3</issue>):<fpage>515</fpage>–<lpage>34</lpage>.<pub-id pub-id-type="pmid">19377034</pub-id></mixed-citation>
    </ref>
    <ref id="ref34">
      <label>34.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kingma</surname><given-names>DP</given-names></string-name>, <string-name><surname>Ba</surname><given-names>JA</given-names></string-name></person-group>. <article-title>A method for stochastic optimization</article-title>. <source>arXiv 2014</source><year>2019</year>;<volume>434</volume>: <comment>preprint arXiv:1412.6980</comment>.</mixed-citation>
    </ref>
    <ref id="ref35">
      <label>35.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Mereu</surname><given-names>E</given-names></string-name>, <string-name><surname>Lafzi</surname><given-names>A</given-names></string-name>, <string-name><surname>Moutinho</surname><given-names>C</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Benchmarking single-cell RNA-sequencing protocols for cell atlas projects</article-title>. <source>Nat Biotechnol</source><year>2020</year>;<volume>38</volume>(<issue>6</issue>):<fpage>747</fpage>–<lpage>55</lpage>.<pub-id pub-id-type="pmid">32518403</pub-id></mixed-citation>
    </ref>
    <ref id="ref36">
      <label>36.</label>
      <mixed-citation publication-type="other"><person-group person-group-type="editor"><string-name><surname>Hamilton</surname><given-names>W</given-names></string-name>, <string-name><surname>Ying</surname><given-names>Z</given-names></string-name>, <string-name><surname>Leskovec</surname><given-names>J</given-names></string-name></person-group> (eds). <article-title>Inductive representation learning on large graphs</article-title>. In: <source>Advances in Neural Information Processing Systems</source>. Long Beach, CA, USA, <year>2017</year>.</mixed-citation>
    </ref>
    <ref id="ref37">
      <label>37.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kipf</surname><given-names>TN</given-names></string-name>, <string-name><surname>Welling</surname><given-names>M</given-names></string-name></person-group>. <article-title>Semi-supervised classification with graph convolutional networks</article-title>. <source>arXiv</source><year>2016</year>; <comment>preprint arXiv:1609.02907</comment>.</mixed-citation>
    </ref>
    <ref id="ref38">
      <label>38.</label>
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Taubin</surname><given-names>G</given-names></string-name></person-group>. <part-title>A signal processing approach to fair surface design</part-title>. In: <source>Proceedings of the 22nd Annual Conference on Computer Graphics and Interactive Techniques: Association for Computing Machinery</source>. Los Angeles, CA, USA, <year>1995</year>. p. <fpage>351</fpage>–<lpage>8</lpage>.</mixed-citation>
    </ref>
    <ref id="ref39">
      <label>39.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Li</surname><given-names>Q</given-names></string-name>, <string-name><surname>Han</surname><given-names>Z</given-names></string-name>, <string-name><surname>Wu</surname><given-names>X-M</given-names></string-name></person-group>. <article-title>Deeper insights into graph convolutional networks for semi-supervised</article-title>. <source>Learning</source><year>2018</year>. arXiv:1801.07606.</mixed-citation>
    </ref>
    <ref id="ref40">
      <label>40.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hafemeister</surname><given-names>C</given-names></string-name>, <string-name><surname>Satija</surname><given-names>R</given-names></string-name></person-group>. <article-title>Normalization and variance stabilization of single-cell RNA-seq data using regularized negative binomial regression</article-title>. <source>Genome Biol</source><year>2019</year>;<volume>20</volume>(<issue>1</issue>):<fpage>296</fpage>.<pub-id pub-id-type="pmid">31870423</pub-id></mixed-citation>
    </ref>
    <ref id="ref41">
      <label>41.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lun</surname><given-names>ATL</given-names></string-name>, <string-name><surname>Bach</surname><given-names>K</given-names></string-name>, <string-name><surname>Marioni</surname><given-names>JC</given-names></string-name></person-group>. <article-title>Pooling across cells to normalize single-cell RNA sequencing data with many zero counts</article-title>. <source>Genome Biol</source><year>2016</year>;<volume>17</volume>(<issue>1</issue>):<fpage>75</fpage>.<pub-id pub-id-type="pmid">27122128</pub-id></mixed-citation>
    </ref>
    <ref id="ref42">
      <label>42.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Yip</surname><given-names>SH</given-names></string-name>, <string-name><surname>Wang</surname><given-names>P</given-names></string-name>, <string-name><surname>Kocher</surname><given-names>JA</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Linnorm: improved statistical analysis for single cell RNA-seq expression data</article-title>. <source>Nucleic Acids Res</source><year>2017</year>;<volume>45</volume>(<issue>22</issue>):<fpage>e179</fpage>.<pub-id pub-id-type="pmid">28981748</pub-id></mixed-citation>
    </ref>
    <ref id="ref43">
      <label>43.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Saunders</surname><given-names>A</given-names></string-name>, <string-name><surname>Macosko</surname><given-names>EZ</given-names></string-name>, <string-name><surname>Wysoker</surname><given-names>A</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Molecular diversity and specializations among the cells of the adult mouse brain</article-title>. <source>Cell</source><year>2018</year>;<volume>174</volume>(<issue>4</issue>):<fpage>1015</fpage>–<lpage>30.e16</lpage>.<pub-id pub-id-type="pmid">30096299</pub-id></mixed-citation>
    </ref>
    <ref id="ref44">
      <label>44.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Giacomello</surname><given-names>S</given-names></string-name>, <string-name><surname>Salmén</surname><given-names>F</given-names></string-name>, <string-name><surname>Terebieniec</surname><given-names>BK</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Spatially resolved transcriptome profiling in model plant species</article-title>. <source>Nature Plants</source><year>2017</year>;<volume>3</volume>(<issue>6</issue>):<elocation-id>17061</elocation-id>.<pub-id pub-id-type="pmid">28481330</pub-id></mixed-citation>
    </ref>
    <ref id="ref45">
      <label>45.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Berglund</surname><given-names>E</given-names></string-name>, <string-name><surname>Maaskola</surname><given-names>J</given-names></string-name>, <string-name><surname>Schultz</surname><given-names>N</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Spatial maps of prostate cancer transcriptomes reveal an unexplored landscape of heterogeneity</article-title>. <source>Nat Commun</source><year>2018</year>;<volume>9</volume>(<issue>1</issue>):<fpage>1</fpage>–<lpage>13</lpage>.<pub-id pub-id-type="pmid">29317637</pub-id></mixed-citation>
    </ref>
    <ref id="ref46">
      <label>46.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Thrane</surname><given-names>K</given-names></string-name>, <string-name><surname>Eriksson</surname><given-names>H</given-names></string-name>, <string-name><surname>Maaskola</surname><given-names>J</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Spatially resolved transcriptomics enables dissection of genetic heterogeneity in stage III cutaneous malignant melanoma</article-title>. <source>Cancer Res</source><year>2018</year>;<volume>78</volume>(<issue>20</issue>):<fpage>5970</fpage>–<lpage>9</lpage>.<pub-id pub-id-type="pmid">30154148</pub-id></mixed-citation>
    </ref>
    <ref id="ref47">
      <label>47.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ghosh</surname><given-names>A</given-names></string-name>, <string-name><surname>Kandasamy</surname><given-names>D</given-names></string-name></person-group>. <article-title>Interpretable artificial intelligence: why and when</article-title>. <source>AJR Am J Roentgenol</source><year>2020</year>;<volume>214</volume>(<issue>5</issue>):<fpage>1137</fpage>–<lpage>8</lpage>.<pub-id pub-id-type="pmid">32130042</pub-id></mixed-citation>
    </ref>
    <ref id="ref48">
      <label>48.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Moore</surname><given-names>JH</given-names></string-name>, <string-name><surname>Boland</surname><given-names>MR</given-names></string-name>, <string-name><surname>Camara</surname><given-names>PG</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Preparing next-generation scientists for biomedical big data: artificial intelligence approaches</article-title>. <source>Per Med</source><year>2019</year>;<volume>16</volume>(<issue>3</issue>):<fpage>247</fpage>–<lpage>57</lpage>.<pub-id pub-id-type="pmid">30760118</pub-id></mixed-citation>
    </ref>
    <ref id="ref49">
      <label>49.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Filipp</surname><given-names>FV</given-names></string-name></person-group>. <article-title>Opportunities for artificial intelligence in advancing precision medicine</article-title>. <source>Curr Genet Med Rep</source><year>2019</year>;<volume>7</volume>(<issue>4</issue>):<fpage>208</fpage>–<lpage>13</lpage>.<pub-id pub-id-type="pmid">31871830</pub-id></mixed-citation>
    </ref>
    <ref id="ref50">
      <label>50.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Han</surname><given-names>X</given-names></string-name>, <string-name><surname>Wang</surname><given-names>R</given-names></string-name>, <string-name><surname>Zhou</surname><given-names>Y</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Mapping the mouse cell atlas by Microwell-seq</article-title>. <source>Cell</source><year>2018</year>;<volume>172</volume>(<issue>5</issue>):<fpage>1091</fpage>–<lpage>107.e17</lpage>.<pub-id pub-id-type="pmid">29474909</pub-id></mixed-citation>
    </ref>
    <ref id="ref51">
      <label>51.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Grubman</surname><given-names>A</given-names></string-name>, <string-name><surname>Chew</surname><given-names>G</given-names></string-name>, <string-name><surname>Ouyang</surname><given-names>JF</given-names></string-name>, <etal>et al.</etal></person-group><article-title>A single-cell atlas of entorhinal cortex from individuals with Alzheimer’s disease reveals cell-type-specific gene expression regulation</article-title>. <source>Nat Neurosci</source><year>2019</year>;<volume>22</volume>(<issue>12</issue>):<fpage>2087</fpage>–<lpage>97</lpage>.<pub-id pub-id-type="pmid">31768052</pub-id></mixed-citation>
    </ref>
    <ref id="ref52">
      <label>52.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Tirosh</surname><given-names>I</given-names></string-name>, <string-name><surname>Izar</surname><given-names>B</given-names></string-name>, <string-name><surname>Prakadan</surname><given-names>SM</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Dissecting the multicellular ecosystem of metastatic melanoma by single-cell RNA-seq</article-title>. <source>Science</source><year>2016</year>;<volume>352</volume>(<issue>6282</issue>):<fpage>189</fpage>–<lpage>96</lpage>.<pub-id pub-id-type="pmid">27124452</pub-id></mixed-citation>
    </ref>
    <ref id="ref53">
      <label>53.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Muraro</surname><given-names>MJ</given-names></string-name>, <string-name><surname>Dharmadhikari</surname><given-names>G</given-names></string-name>, <string-name><surname>Grun</surname><given-names>D</given-names></string-name>, <etal>et al.</etal></person-group><article-title>A single-cell transcriptome atlas of the human pancreas</article-title>. <source>Cell Syst</source><year>2016</year>;<volume>3</volume>(<issue>4</issue>):<fpage>385</fpage>–<lpage>94.e3</lpage>.<pub-id pub-id-type="pmid">27693023</pub-id></mixed-citation>
    </ref>
    <ref id="ref54">
      <label>54.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hodge</surname><given-names>RD</given-names></string-name>, <string-name><surname>Bakken</surname><given-names>TE</given-names></string-name>, <string-name><surname>Miller</surname><given-names>JA</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Conserved cell types with divergent features in human versus mouse cortex</article-title>. <source>Nature</source><year>2019</year>;<volume>573</volume>(<issue>7772</issue>):<fpage>61</fpage>–<lpage>8</lpage>.<pub-id pub-id-type="pmid">31435019</pub-id></mixed-citation>
    </ref>
    <ref id="ref55">
      <label>55.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Tian</surname><given-names>L</given-names></string-name>, <string-name><surname>Su</surname><given-names>S</given-names></string-name>, <string-name><surname>Dong</surname><given-names>X</given-names></string-name>, <etal>et al.</etal></person-group><article-title>scPipe: a flexible R/Bioconductor preprocessing pipeline for single-cell RNA-sequencing data</article-title>. <source>PLoS Comput Biol</source><year>2018</year>;<volume>14</volume>(<issue>8</issue>):<elocation-id>e1006361</elocation-id>.<pub-id pub-id-type="pmid">30096152</pub-id></mixed-citation>
    </ref>
    <ref id="ref56">
      <label>56.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Xin</surname><given-names>Y</given-names></string-name>, <string-name><surname>Kim</surname><given-names>J</given-names></string-name>, <string-name><surname>Okamoto</surname><given-names>H</given-names></string-name>, <etal>et al.</etal></person-group><article-title>RNA sequencing of single human islet cells reveals type 2 diabetes genes</article-title>. <source>Cell Metab</source><year>2016</year>;<volume>24</volume>(<issue>4</issue>):<fpage>608</fpage>–<lpage>15</lpage>.<pub-id pub-id-type="pmid">27667665</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
