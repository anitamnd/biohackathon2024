<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 2?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>BMC Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">4287502</article-id>
    <article-id pub-id-type="pmid">25326660</article-id>
    <article-id pub-id-type="publisher-id">6665</article-id>
    <article-id pub-id-type="doi">10.1186/1471-2105-15-337</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Software</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Bison: bisulfite alignment on nodes of a cluster</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Ryan</surname>
          <given-names>Devon Patrick</given-names>
        </name>
        <address>
          <email>devon.ryan@dzne.de</email>
        </address>
        <xref ref-type="aff" rid="Aff28"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Ehninger</surname>
          <given-names>Dan</given-names>
        </name>
        <address>
          <email>dan.ehninger@dzne.de</email>
        </address>
        <xref ref-type="aff" rid="Aff28"/>
      </contrib>
      <aff id="Aff28">German Center for Neurodegenerative Diseases (DZNE), Ludwig-Erhard-Allee 2, Bonn, 53175 Germany </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>18</day>
      <month>10</month>
      <year>2014</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2014</year>
    </pub-date>
    <volume>15</volume>
    <issue>1</issue>
    <elocation-id>337</elocation-id>
    <history>
      <date date-type="received">
        <day>18</day>
        <month>3</month>
        <year>2014</year>
      </date>
      <date date-type="accepted">
        <day>25</day>
        <month>9</month>
        <year>2014</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© Ryan and Ehninger; licensee BioMed Central Ltd. 2014</copyright-statement>
      <license license-type="open-access">
        <license-p>This article is published under license to BioMed Central Ltd. This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0">http://creativecommons.org/licenses/by/4.0</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly credited. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p>DNA methylation changes are associated with a wide array of biological processes. Bisulfite conversion of DNA followed by high-throughput sequencing is increasingly being used to assess genome-wide methylation at single-base resolution. The relative slowness of most commonly used aligners for processing such data introduces an unnecessarily long delay between receipt of raw data and statistical analysis. While this process can be sped-up by using computer clusters, current tools are not designed with them in mind and end-users must create such implementations themselves.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p>Here, we present a novel BS-seq aligner, Bison, which exploits multiple nodes of a computer cluster to speed up this process and also has increased accuracy. Bison is accompanied by a variety of helper programs and scripts to ease, as much as possible, the process of quality control and preparing results for statistical analysis by a variety of popular R packages. Bison is also accompanied by bison_herd, a variant of Bison with the same output but that can scale to a semi-arbitrary number of nodes, with concomitant increased demands on the underlying message passing interface implementation.</p>
      </sec>
      <sec>
        <title>Conclusions</title>
        <p>Bison is a new bisulfite-converted short-read aligner providing end users easier scalability for performance gains, more accurate alignments, and a convenient pathway for quality controlling alignments and converting methylation calls into a form appropriate for statistical analysis. Bison and the more scalable bison_herd are natively able to utilize multiple nodes of a computer cluster simultaneously and serve to simplify to the process of creating analysis pipelines.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>DNA Methylation</kwd>
      <kwd>Alignment</kwd>
      <kwd>Bisulfite sequencing</kwd>
      <kwd>Computer cluster</kwd>
    </kwd-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2014</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p>DNA methylation involves the covalent modification of cytosine bases and serves to epigenetically regulate a large variety of biological properties, from imprinting to development and its dysregulation is associated with diseases such as cancer
[<xref ref-type="bibr" rid="CR1">1</xref>]. While there are a number of methods currently available to probe DNA methylation (e.g. MeDIP-seq and MRE-seq), the gold-standard for single-base resolution is bisulfite sequencing, sometimes referred to as BS-seq. Here, DNA is treated with bisulfite, which results in the conversion of unmethylated Cytosine (C) to Uracil (read by the sequencer as Thymine (T)), leaving methylated Cs unconverted.</p>
    <p>Mapping of bisulfite-converted short reads, such as those commonly produced by the Illumina HiSeq, creates a number of difficulties. Firstly, if both Cs and Ts in reads can map to Cs in the genome, then methylation metrics will be systematically skewed, as methylated reads will map preferentially, given that they contain more information. The alternative is to <italic>in silico</italic> convert both the reads and the genome prior to alignment, thereby producing unbiased, but less efficiently mapped, alignments. This creates a second difficulty in that the two DNA strands are no longer complementary, requiring them to be treated separately. Finally, PCR amplification during library preparation results in the creation of an additional two DNA strands, complementary to the original bisulfite converted strands. The presence of multiple non-complementary strands is a situation for which standard short-read aligners are generally unequipped.</p>
    <p>For these reasons, a number of bisulfite aligners have recently been created, the most popular of which is Bismark
[<xref ref-type="bibr" rid="CR2">2</xref>, <xref ref-type="bibr" rid="CR3">3</xref>] (see
[<xref ref-type="bibr" rid="CR4">4</xref>] for a general comparison of BS-seq aligners). Bismark, like BSmooth
[<xref ref-type="bibr" rid="CR5">5</xref>] and BS-Seeker2
[<xref ref-type="bibr" rid="CR6">6</xref>], exploits the short-read aligners bowtie or bowtie2
[<xref ref-type="bibr" rid="CR7">7</xref>] to perform alignments. While these aligners generally produce good results, they are quite slow, due to running up to 4 instances of bowtie simultaneously on the same computer as well as other implementation issues. Bismark and BS-Seeker2, in particular, have a higher than necessary false-positive rate due to not producing alignments with associated mapping qualities (MAPQ scores), which could otherwise be used to filter out methylation calls from alignments with too high a probability of being wrong, and how they decide which alignment to report. Similarly, while BSmooth produces alignments with MAPQ scores, they are based only on alignment to a single strand, so a read aligning equally well to multiple strands will have an aberrantly high MAPQ score. As an example, given a read that aligns with a MAPQ score of 42 to one strand and 40 to another, BSmooth will output the alignment with a MAPQ score of 42 and leave that MAPQ score unchanged. Had this MAPQ score instead been calculated in a context within which the alternative (MAPQ score of 40) alignment was known, the resulting MAPQ score would have appropriately been much lower. BSMAP
[<xref ref-type="bibr" rid="CR8">8</xref>], an older aligner, has previously been reported to require a similar amount of time as bismark to run but, because it uses its own aligner, produces somewhat better coverage
[<xref ref-type="bibr" rid="CR4">4</xref>]. Other recent bisulfite aligners, e.g. GNUMAP-bs
[<xref ref-type="bibr" rid="CR9">9</xref>], purport to have higher speed and accuracy at the expense of significantly increased memory requirements. In practice, though, the speed increase is marginal and accuracy increases are non-existent. As the alignment step is simply an intermediate between receiving raw data and actual statistical analysis, this creates an unnecessary experimental impediment.</p>
    <p>To combat these issues, we have developed a novel bisulfite aligner, Bison (BISulfite alignment On Nodes of a cluster), written in C that exploits the increasing prevalence of computer-clusters to rapidly align BS-seq reads. Bison can utilize either 3 or 5 nodes, a master node to process alignments and one worker node per DNA strand for aligning reads. We also provide a second version, bison_herd, which scales to run on a semi-arbitrary number of cluster nodes, rather than being limited to 3–5 nodes, depending on library type. Like Bismark, BSmooth and BS-Seeker2, Bison utilizes bowtie2 to perform actual alignments, but produces alignments with recalculated MAPQ scores (a more general feature comparison is shown in Table 
<xref rid="Tab1" ref-type="table">1</xref>). Because Bison can simultaneously use multiple nodes it requires less memory per-node. Furthermore, as the algorithm used by Bison to judge the best alignment is different from that used by the other aligners, its false-positive rate is decreased to that of bowtie2. Even when using identical resources, Bison performs its alignments in a fraction of the time required by all of the other compared aligners, except BSMAP. Bison produces more accurate results than all of the other compared aligners on simulated datasets. Unlike most other BS-seq aligners, bison_herd does not create temporary files, decreasing both I/O and space requirements. To easily facilitate statistical analysis, Bison comes with methylation extraction and conversion programs. Bison also provides the facility for easy quality control of aligned data and it can compute methylation metrics dependent upon these quality control results. Finally, bison is accompanied by a helper program that, unlike similar programs, uses both alignment position and methylation calls to mark likely PCR duplicates, which are then ignored during the methylation extraction and quality control process.<table-wrap id="Tab1"><label>Table 1</label><caption><p><bold>Feature comparison of the various compared aligners</bold></p></caption><table frame="hsides" rules="groups"><thead><tr><th/><th>Bismark</th><th>Bison/bison_herd</th><th>BSMAP</th><th>BSmooth</th><th>BS-Seeker2</th><th>GNUMAP-bs</th></tr></thead><tbody><tr><td>Intermediate files</td><td>Yes</td><td>Yes/No</td><td>No</td><td>Yes</td><td>Yes</td><td>Yes</td></tr><tr><td>Compressed input</td><td>Yes</td><td>Yes</td><td>Yes</td><td>Yes</td><td>Yes</td><td>No</td></tr><tr><td>MPI</td><td>No</td><td>Yes</td><td>No</td><td>No</td><td>No</td><td>Yes</td></tr><tr><td>MAPQ scores</td><td>No</td><td>Yes</td><td>No</td><td>Yes</td><td>No</td><td>Yes</td></tr><tr><td>Creates M-bias plots</td><td>Yes</td><td>Yes</td><td>No</td><td>Yes</td><td>No</td><td>No</td></tr><tr><td>Per-read M-bias</td><td>Yes</td><td>Yes</td><td>No</td><td>No</td><td>No</td><td>No</td></tr><tr><td>Per-strand M-bias</td><td>No</td><td>Yes</td><td>No</td><td>No</td><td>No</td><td>No</td></tr><tr><td>Filter by MAPQ</td><td>No</td><td>Yes</td><td>No</td><td>Yes</td><td>No</td><td>No</td></tr><tr><td>Filter by Phred</td><td>No</td><td>Yes</td><td>No</td><td>Yes</td><td>No</td><td>No</td></tr><tr><td>Filter by M-bias</td><td>Yes</td><td>Yes</td><td>No</td><td>Yes</td><td>No</td><td>No</td></tr><tr><td>Mark duplicates</td><td>Yes</td><td>Yes</td><td>No</td><td>No</td><td>No</td><td>No</td></tr><tr><td>Methylation file format</td><td>bedGraph</td><td>bedGraph</td><td>custom TSV</td><td>custom TSV</td><td>Wig, custom TSV</td><td>custom TSV</td></tr></tbody></table></table-wrap></p>
  </sec>
  <sec id="Sec2">
    <title>Implementation</title>
    <p>The general workflow is depicted in Figure 
<xref rid="Fig1" ref-type="fig">1</xref>, with recommended steps external to Bison/bison_herd noted. As with other aligners, an index of the genome is created to facilitate faster mapping. This step needs to be performed only once. Two temporary copies of the genome are created, one C- &gt; T and the other G- &gt; A <italic>in silico</italic> converted. Prior to alignment, low quality bases and incorporated adapter sequences should be removed, as previously recommended
[<xref ref-type="bibr" rid="CR3">3</xref>]. We recommend Trim Galore! (
<ext-link ext-link-type="uri" xlink:href="http://www.bioinformatics.babraham.ac.uk/projects/trim_galore/">http://www.bioinformatics.babraham.ac.uk/projects/trim_galore/</ext-link>), as it is tailored toward bisulfite-converted reads and supports paired-end reads. An alternative to trimming is using local alignment. While Bison is capable of producing local alignments, the likelihood of incorrect methylation calls due to partial adapter alignment has caused us to default to producing end-to-end alignments. For the same reason, the comparisons included below contain only trimmed datasets.<fig id="Fig1"><label>Figure 1</label><caption><p><bold>Standard bisulfite-seq processing workflow.</bold> Programs and steps for which Bison provides solutions are on a blue background.</p></caption><graphic xlink:href="12859_2014_6665_Fig1_HTML" id="d30e585"/></fig></p>
    <p>Both Bison and bison_herd accept the resulting trimmed fastq files, which may also be compressed to save space. Bison_herd can also process a list of single or paired-end files, writing results to individual files. This is particularly convenient when processing multiple samples, as the genome and its indices only need to be read from disk and loaded into memory once. Bison <italic>in silico</italic> converts these reads on the master node as appropriate and writes the results to a file or files. The number and nature of the conversion is dependent upon whether the libraries were directional or non-directional and run single or paired-end. These converted reads are then aligned as appropriate by bowtie2 on the worker nodes. In bison_herd, the process is similar, except reads are sent unconverted via MPI from the master node to the worker nodes, where they are converted prior to being given via named-pipes to bowtie2.</p>
    <p>As each worker node creates alignments, they are sent via MPI to the master node. There, the alignments are collated and a best alignment is selected (process described below). Subsequently, the methylation state of each base in each read is determined. If a read contains a mismatch, the methylation state of that base is set to ‘.’, to denote "not applicable". The results are then written to a BAM file using the samtools C API
[<xref ref-type="bibr" rid="CR10">10</xref>]. Unmapped reads may optionally be written to fastq files.</p>
    <p>After performing quality control (see below), methylation metrics are normally extracted and written in bedGraph format. For paired-end reads, overlapping portions of each pair are processed as a unit so to not double-count methylation calls. It sometimes occurs that reads in a pair disagree on a methylation call, either because one read contains an N at a given position, or because both reads simply contain different high quality base calls. In the former case, Bison will always use the methylation call of the read not containing an N at the position in question. In the latter case, neither methylation call is used. The resulting methylation metrics are written for every C in a CpG, CHG, or CHH context to separate bedGraph files. A helper program is also included to merge metrics from both C’s in a CpG context. Other auxiliary scripts are provided to produce various metrics (e.g. per-CpG coverage), merge bedGraph files from technical replicates, and convert files for easy input into R for processing by methylKit
[<xref ref-type="bibr" rid="CR11">11</xref>], BSseq
[<xref ref-type="bibr" rid="CR5">5</xref>], BiSeq
[<xref ref-type="bibr" rid="CR12">12</xref>], BEAT
[<xref ref-type="bibr" rid="CR13">13</xref>] and MethylSeekR
[<xref ref-type="bibr" rid="CR14">14</xref>].</p>
    <sec id="Sec3">
      <title>Determining the best alignment and MAPQ recalculation</title>
      <p>Like Bismark, Bison uses the alignment score (the auxiliary AS tag) of each alignment from each strand to determine the correct alignment to output. As mentioned above, if multiple strands produce equally good alignments for a read then that read is marked as being unmapped. This is in contrast to Bismark, which will declare the first alignment in its list as being best in these cases. For paired-end reads, the alignment scores are summed. When multiple valid alignments are found with one of them having a single highest score, the XS tag for that alignment is set to the highest alignment score of the other alignments. In cases where the best alignment already has a secondary alignment and that score is higher than those produced by alignment to other strands then the XS tag is unmodified. This modification of the XS tag allows for recalculation of the alignment mapping quality (MAPQ), which greatly increases the reliability of the resulting alignments (see below).</p>
      <p>As in bowtie2, Bison calculates MAPQ scores using the aforementioned AS and XS values. As these values are set using alignments from all strands, the resulting MAPQ score will be more accurate than simply passing through the value calculated by bowtie2 (as is done by BSmooth). The actual algorithm used is a heuristic based on the percentile score of an alignment’s AS score after normalizing for the minimum valid and maximum possible such score. The higher this percentile, the higher the resulting MAPQ score. The difference between the AS and XS values further alters this score, where a smaller difference results in a lower MAPQ score.</p>
    </sec>
    <sec id="Sec4">
      <title>Marking duplicates</title>
      <p>As is also the case in SNP calling, the presence of PCR duplicates can vastly inflate the coverage of a given region, resulting in false-positive findings in downstream analyses. Because of this, Bison also comes with a helper program, bison_markduplicates, to mark likely PCR duplicates. Bison will consider two alignments to be PCR duplicates if they align to the same strand of the same chromosome/contig and have identical 5’ coordinates. Furthermore, the methylation calls of the reads or read pairs are also compared and must match. For this, only methylation calls resulting from bases with Phred scores of at least 5 are included, to decrease errors due to a low quality base in one read/pair. In cases where a methylation call is made in one read/pair and not the other (e.g., due to a low Phred score or presence of a base other than C or T), the reads are declared to not differ at that position. This method, then, is somewhat conservative, though less so than if methylation calls were not included in determining duplicates. As paired-end reads are considered as a unit, rather than each read being considered separately, a duplicate can only occur if another pair of reads has these identical properties. The read or pair with the highest sum of base-call Phred scores is kept unmarked (this is also the case for samtools rmdup and picard markduplicates (
<ext-link ext-link-type="uri" xlink:href="http://picard.sourceforge.net">http://picard.sourceforge.net</ext-link>)). Like picard markduplicates, bison_markduplicates also incorporates soft-clipped bases when determining the 5’ coordinate.</p>
    </sec>
    <sec id="Sec5">
      <title>Quality control</title>
      <p>Aside from adapter and quality trimming, the most important quality control step in BS-seq involves the creation of an M-bias plot (Figure 
<xref rid="Fig2" ref-type="fig">2</xref>), first introduced in
[<xref ref-type="bibr" rid="CR5">5</xref>]. While the reliability of the methylation calls should be constant across the length of the reads, there are often biases at both the 5’ and 3’ ends. This can be due to end-repair and decreasing read quality, among other reasons. For this reason, the methylated-C percentage of CpGs is calculated per read position and then plotted. As different strands may produce different biases, these metrics are calculated per strand. Likewise, the first and second read in each pair of paired-end reads often have different biases, so they are handled separately. The program used to compute M-bias metrics in Bison also performs filtering according to MAPQ and base Phred score in a manner identical to that in the methylation extractor.When bias, such as that seen in Figure 
<xref rid="Fig2" ref-type="fig">2</xref>, is found in a dataset, the methylation extractor that accompanies Bison can be instructed to ignore the affected portions of reads. As above, this ignored portion can depend on the strand to which a read aligns and, in the case of paired-end reads, on whether the read was the first or second in the pair. The program that produces the M-bias graphs prints suggested regions to ignore to the command line and labels the regions on the resulting graphs.<fig id="Fig2"><label>Figure 2</label><caption><p><bold>M-Bias plots are useful for quality control.</bold> The methylation level averaged per position in the reads should be nearly constant, but often shows bias at the 5′ and/or 3′ end of reads. The first (red) and second (blue) read in each pair is plotted separately. Likewise, results of reads mapping to the original top (OT, left) strand and original bottom (OB, right) are kept separate. When a non-directional library is used, graphs for the complementary to original top (CTOT) and complementary to original bottom (CTOB) are also produced. Vertical lines indicate the suggested bounds of the region for inclusion during methylation extraction.</p></caption><graphic xlink:href="12859_2014_6665_Fig2_HTML" id="d30e655"/></fig></p>
    </sec>
  </sec>
  <sec id="Sec6">
    <title>Results and discussion</title>
    <p>To compare the performance of Bison/bison_herd against Bismark (version 0.10.0), BSmooth (version 0.8.1), BSMAP (version 2.74), BS-Seeker2 (version 2.0.3) and GNUMAP-bs (GNUMAP version 3.0.2), we simulated 20 million 50 bp paired-end reads from a directional library with typical error profiles using Sherman (
<ext-link ext-link-type="uri" xlink:href="http://www.bioinformatics.bbsrc.ac.uk/projects/sherman/">http://www.bioinformatics.bbsrc.ac.uk/projects/sherman/</ext-link>). As these reads originated from known locations, we were able to assess not just the speed and resource requirements of each of the aligners, but also their accuracy. The results are presented in Tables 
<xref rid="Tab2" ref-type="table">2</xref> and
<xref rid="Tab3" ref-type="table">3</xref> and Figure 
<xref rid="Fig3" ref-type="fig">3</xref>. As the output of bison_herd is identical to that of Bison, only Bison is included in Table 
<xref rid="Tab2" ref-type="table">2</xref>. Using only reads that aligned with MAPQ scores of at least 10, as only these would be used for methylation calculations by default, Bison produced more correct and fewer incorrect alignments than Bismark. While BSmooth produced more correct alignments than Bison, it produced an equivalent increase in incorrect mappings, due to not recalculating MAPQ scores after determining to which strand each read (or pair, as is the case here) aligns. Other differences to BSmooth are due to Bison excluding from output reads that map equally well to multiple strands, as such alignments are highly inaccurate. Differences between the alignment accuracy of Bison and Bismark are due not only to recalculation of MAPQ scores by Bison, but also to incorporation of base quality scores in the calculation of alignment scores and Bismark’s more conservative threshold for calling an alignment valid. BSMAP produced a similar percentage of correct alignments to Bison, but had higher numbers of incorrect alignments even after filtering non-uniquely aligned reads. BS-Seeker2 performed similarly to BSMAP when only uniquely aligned reads were output. While GNUMAP-bs purports to have higher accuracy than Bismark or BSmooth, this is an artifact of it producing multiple alignments for each read. If a read produces multiple equally good alignments, only the first of these is counted here, since including all of them, as was presumably done by the GNUMAP-bs authors, would produce meaningless metrics (e.g., an aligner could always produce perfectly correct alignments by simply outputting all conceivable alignments). A violin plot of the correct and incorrect mappings produced by each program as a function of MAPQ is show in Figure 
<xref rid="Fig3" ref-type="fig">3</xref>, with the correct and incorrect metrics scaled independently. Table 
<xref rid="Tab3" ref-type="table">3</xref> illustrates how both Bison and bison_herd have much higher performance than any of the other tested aligners, except for BSMAP, even when limited to the same hardware and using the same version of bowtie2 with similar settings and identical numbers of threads. While earlier versions of BSMAP had a similar alignment rate to Bismark, more recent versions seem vastly faster than any of the aligners when using the same hardware, though there is a notable commensurate decrease in accuracy.<table-wrap id="Tab2"><label>Table 2</label><caption><p><bold>Alignment comparison of Bison with a variety of other aligners on the simulated dataset</bold></p></caption><table frame="hsides" rules="groups"><thead><tr><th>Program</th><th>Correct</th><th>Incorrect</th><th>Discarded</th></tr></thead><tbody><tr><td>Bismark</td><td>82.41%</td><td>0.44%</td><td>17.15%</td></tr><tr><td>Bison</td><td>90.73% (87.09%)</td><td>2.01% (0.02%)</td><td>7.25% (12.89%)</td></tr><tr><td>BSMAP</td><td>89.20% (88.05%)</td><td>10.59% (2.53%)</td><td>0.21% (9.43%)</td></tr><tr><td>BSmooth</td><td>90.73% (88.17%)</td><td>9.19% (1.12%)</td><td>0.07% (10.71%)</td></tr><tr><td>BS-Seeker2</td><td>88.55%</td><td>2.06%</td><td>9.39%</td></tr><tr><td>GNUMAP-bs</td><td>84.64% (79.43%)</td><td>3.78% (0.27%)</td><td>11.57% (20.29%)</td></tr></tbody></table><table-wrap-foot><p>Numbers in parentheses are metrics when only alignments with MAPQ &gt; =10 are included, expect for BSMAP, where they indicate metrics using only uniquely aligned reads (using the "-r 0" option).</p></table-wrap-foot></table-wrap><table-wrap id="Tab3"><label>Table 3</label><caption><p><bold>Time requirement for each program with a variable number of available nodes to align the simulated dataset</bold></p></caption><table frame="hsides" rules="groups"><thead><tr><th>Program</th><th>Nodes (cores)</th><th>Time required (hh:mm:ss)</th><th>Read pairs/core/sec.</th><th>Options</th></tr></thead><tbody><tr><td>Bismark</td><td>1 (12)</td><td>05:05:32</td><td>90.91</td><td>-p 5 –bam</td></tr><tr><td>Bison</td><td>1 (12)</td><td>01:29:25</td><td>310.66</td><td>-p 5</td></tr><tr><td>Bison</td><td>3 (36)</td><td>00:40:21</td><td>229.47*</td><td>-p 11</td></tr><tr><td>bison_herd</td><td>1 (12)</td><td>01:35:43</td><td>290.21</td><td>-p 5</td></tr><tr><td>bison_herd</td><td>3 (36)</td><td>00:39:21</td><td>235.30*</td><td>-@ 4 –p 11</td></tr><tr><td>bison_herd</td><td>5 (60)</td><td>00:21:24</td><td>259.61*</td><td>-mp 2 -@ 4 -p 11</td></tr><tr><td>bison_herd</td><td>9 (108)</td><td>00:13:55</td><td>221.78*</td><td>-mp 2 -@ 4 -p 11</td></tr><tr><td>BSmooth</td><td>1 (12)</td><td>07:44:02</td><td>59.86</td><td>-p 5 –no-mixed –no-discordant –no-unpaired</td></tr><tr><td>BSMAP</td><td>1 (12)</td><td>00:15:24</td><td>1803.75</td><td>-p 12</td></tr><tr><td>BSMAP</td><td>1 (12)</td><td>00:14:40</td><td>1898.94</td><td>-p 12 –r 0</td></tr><tr><td>BS-Seeker2</td><td>1 (12)</td><td>04:38:07</td><td>99.88</td><td>–aligner = bowtie2 –bt2-p 6 –bt2–end-to-end</td></tr><tr><td>GNUMAP-bs</td><td>1 (12)</td><td>04:26:53</td><td>104.08</td><td>–lib_type wt1 –read_type dna –nt_conv bs –-num_threads 12 –skip_blat 1 –pileup 1 –m 22 –a 0.90</td></tr></tbody></table><table-wrap-foot><p>*All cores in the master node are used for the calculation, even though they will not all be in use. Values are generally ~290 read pairs per core per second if this is not done.</p></table-wrap-foot></table-wrap><fig id="Fig3"><label>Figure 3</label><caption><p><bold>Bison produces more accurate results than BSmooth or GNUMAP-bs.</bold> The MAPQ density of correctly (red) and incorrectly (blue) aligned reads from the test dataset for alignments performed by Bison, BSmooth, and GNUMAP-bs. Bismark, BSMAP and BS-Seeker2 are not shown as they do not produce alignments with MAPQ scores. Scaling of the correct and incorrect metrics is performed separately, as the incorrect density would otherwise not be visible.</p></caption><graphic xlink:href="12859_2014_6665_Fig3_HTML" id="d30e1037"/></fig></p>
    <p>The accuracy of alignments produced by Bison and bison_herd are consistent with varying read lengths, Figure 
<xref rid="Fig4" ref-type="fig">4</xref>A and Table 
<xref rid="Tab4" ref-type="table">4</xref>. It should be noted that the number of errors per read in these simulated datasets increases with read length, explaining the increase in discarded reads in the 100 and 150 bp datasets. The time required for alignments scales linearly with read length and is fairly stable with increasing numbers of available nodes, though this can become limited by the underlying MPI implementation and network architecture of the cluster, Figure 
<xref rid="Fig4" ref-type="fig">4</xref>B.<fig id="Fig4"><label>Figure 4</label><caption><p><bold>Bison’s accuracy is consistent across read-length and its speed is generally consistent with increasing nodes.</bold> Sherman was used to generate simulated directional datasets of variable length, as described above. The accuracy of the resulting alignments is consistent regardless of read-length, <bold>A</bold>. The percentages in parentheses under each read-length label are the total percentage of aligned reads (from 20 million original reads). The speed with which bison_herd produces alignments decreases with increasing read-length, <bold>B</bold>. This rate, however, is generally consistent when increasing numbers of cluster nodes are used. Note that in the test dataset, the MPI overhead required to use 11 nodes with shorter reads was sufficient to over-tax the MPI implementation and network. When this will occur will vary by cluster.</p></caption><graphic xlink:href="12859_2014_6665_Fig4_HTML" id="d30e1066"/></fig></p>
    <table-wrap id="Tab4">
      <label>Table 4</label>
      <caption>
        <p>
          <bold>Bison produces consistently accurate alignments across read lengths</bold>
        </p>
      </caption>
      <table frame="hsides" rules="groups">
        <thead>
          <tr>
            <th>Read length</th>
            <th>Correct</th>
            <th>Incorrect</th>
            <th>Discarded</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>36 base pairs</td>
            <td>88.41% (85.97%)</td>
            <td>2.76% (0.01%)</td>
            <td>8.83% (13.94%)</td>
          </tr>
          <tr>
            <td>50 base pairs</td>
            <td>90.73% (87.09%)</td>
            <td>2.01% (0.02%)</td>
            <td>7.25% (12.89%)</td>
          </tr>
          <tr>
            <td>75 base pairs</td>
            <td>90.58% (87.24%)</td>
            <td>1.80% (0.01%)</td>
            <td>7.76% (12.75%)</td>
          </tr>
          <tr>
            <td>100 base pairs</td>
            <td>84.52% (81.33%)</td>
            <td>1.56% (0.01%)</td>
            <td>13.91% (18.66%)</td>
          </tr>
          <tr>
            <td>150 base pairs</td>
            <td>71.13% (68.41%)</td>
            <td>1.26% (0.01%)</td>
            <td>27.61% (31.58%)</td>
          </tr>
        </tbody>
      </table>
      <table-wrap-foot>
        <p>Numbers in parentheses are metrics when only alignments with MAPQ &gt; =10 are included.</p>
      </table-wrap-foot>
    </table-wrap>
    <p>We compared the various aligners on three publicly available datasets. ERR192350 is a whole-genome bisulfite sequencing (WGBS) dataset using DNA from E6.5 mouse epiblasts and has 100 bp paired-end reads from a directional library
[<xref ref-type="bibr" rid="CR15">15</xref>]. SRR306438 is a human WGBS dataset using DNA from human sperm and has 100 bp paired-end reads from a directional library
[<xref ref-type="bibr" rid="CR16">16</xref>]. ERR034786 is a reduced-representation bisulfite sequencing (RRBS) dataset, using DNA from mouse sperm and has 40 bp paired-end reads from a non-directional library
[<xref ref-type="bibr" rid="CR17">17</xref>]. Each of these datasets was quality and adapter trimmed prior to alignment. For the whole-genome datasets, Bison had a higher alignment speed (measured in read pairs per CPU core per second) than the other aligners except for BSMAP, Tables 
<xref rid="Tab5" ref-type="table">5</xref> and
<xref rid="Tab6" ref-type="table">6</xref>. Further, Bison aligned a higher percentage of reads than all but BSmooth, however, the latter output inaccurate alignments that can originate from either strand. We looked at how concordant the alignments produced by Bison are to those produced by the other aligners. Here, a pair of alignments is termed concordant if both have the same start coordinate. As can be seen in Figures 
<xref rid="Fig5" ref-type="fig">5</xref> and
<xref rid="Fig6" ref-type="fig">6</xref>, the overwhelming majority of alignments are concordant between Bison and the other aligners. Discordant alignments are typically those Bison gives a low MAPQ, indicating that they would normally be ignored by it during methylation level calculation. As many of the other aligners do not produce alignments with MAPQ scores, they would include these likely incorrect alignments in this process. Alignments produced only by the other aligners would generally have very low MAPQ scores if they had been output by Bison, again due to mapping equally well to multiple strands.<table-wrap id="Tab5"><label>Table 5</label><caption><p><bold>Alignment comparison for the ERR192350 dataset</bold></p></caption><table frame="hsides" rules="groups"><thead><tr><th>Program</th><th>Nodes (Cores)</th><th>Time required (days + hh:mm:ss)</th><th>Read pairs/core/sec.</th><th>Percent aligned*</th></tr></thead><tbody><tr><td>Bismark</td><td>1 (12)</td><td>2 + 14:12:56</td><td>90.95</td><td>76.42%</td></tr><tr><td>Bison</td><td>9 (108)</td><td>03:41:07</td><td>170.61</td><td>92.41% (72.46%)</td></tr><tr><td>BSMAP</td><td>1 (12)</td><td>04:13:04</td><td>1341.64</td><td>83.33%</td></tr><tr><td>BSmooth</td><td>1 (12)</td><td>6 + 06:10:42</td><td>37.68</td><td>97.79% (75.28%)</td></tr><tr><td>BS-Seeker2</td><td>1 (12)</td><td>2 + 21:10:15</td><td>81.81</td><td>80.03%</td></tr><tr><td>GNUMAP-bs</td><td>1 (12)</td><td>3 + 04:02:56</td><td>74.25</td><td>82.19% (74.66%)</td></tr></tbody></table><table-wrap-foot><p>*Numbers in parentheses are metrics when only reads with MAPQ &gt; =10 are included.</p></table-wrap-foot></table-wrap><table-wrap id="Tab6"><label>Table 6</label><caption><p><bold>Alignment comparison for the SRR306438 dataset</bold></p></caption><table frame="hsides" rules="groups"><thead><tr><th>Program</th><th>Nodes (Cores)</th><th>Time required (hh:mm:ss)</th><th>Read pairs/core/sec.</th><th>Percent aligned*</th></tr></thead><tbody><tr><td>Bismark</td><td>1 (12)</td><td>03:17:30</td><td>129.94</td><td>50.72%</td></tr><tr><td>Bison</td><td>9 (108)</td><td>00:15:50</td><td>180.09</td><td>69.32% (57.11%)</td></tr><tr><td>BSMAP</td><td>1 (12)</td><td>00:55:52</td><td>459.36</td><td>62.33%</td></tr><tr><td>BSmooth</td><td>1 (12)</td><td>07:23:43</td><td>57.84</td><td>75.64% (59.71%)</td></tr><tr><td>BS-Seeker2</td><td>1 (12)</td><td>06:16:20</td><td>68.19</td><td>54.42%</td></tr><tr><td>GNUMAP-bs</td><td>1 (12)</td><td>13:43:30</td><td>31.16</td><td>58.54% (53.43%)</td></tr></tbody></table><table-wrap-foot><p>*Numbers in parentheses are metrics when only reads with MAPQ &gt; =10 are included.</p></table-wrap-foot></table-wrap><fig id="Fig5"><label>Figure 5</label><caption><p><bold>MAPQ distribution of concordant, discordant, and unique alignments produced by Bison and the other compared aligners on the mouse WGBS dataset.</bold> Reads from ERR192350 were aligned by both Bison and the other compared aligners (<bold>A</bold>, Bismark; <bold>B</bold>, BSMAP; <bold>C</bold>, BSmooth; <bold>D</bold>, BS-Seeker2; and <bold>E</bold>, GNUMAP-bs) and the resulting alignments compared according to the MAPQ score given to them by Bison. For alignments not reported by Bison, the MAPQ scores are what they would have been had Bison reported them. Alignments are considered concordant if both programs aligned them to the same position. Otherwise, they are considered discordant. Percentages below the labels are the percent of total mapped reads falling into each category.</p></caption><graphic xlink:href="12859_2014_6665_Fig5_HTML" id="d30e1482"/></fig><fig id="Fig6"><label>Figure 6</label><caption><p><bold>MAPQ distribution on the human WGBS dataset.</bold> Reads from SRR306438 were aligned by Bison and the other compared aligners (<bold>A</bold>, Bismark; <bold>B</bold>, BSMAP; <bold>C</bold>, BSmooth; <bold>D</bold>, BS-Seeker2; and <bold>E</bold>, GNUMAP-bs) and the resulting alignments compared as in Figure 
<xref rid="Fig5" ref-type="fig">5</xref>.</p></caption><graphic xlink:href="12859_2014_6665_Fig6_HTML" id="d30e1513"/></fig></p>
    <p>For the mouse WGBS dataset, we marked duplicates using bison_markduplicates and removed duplicates using Bismark’s deduplicate_bismark program to compare how Bison’s duplicate finding method compares to that of Bismark. Bismark found 55,860,458 pairs of duplicate alignments from the ERR192350 alignment produced by Bismark. Bison’s method marked 35,127,808 pairs of duplicate alignments from the same original file. The approximately 20 million fewer alignments marked as duplicates by Bison’s method are due to differences in methylation state within the reads.</p>
    <p>For RRBS datasets, Bison, BSMAP and BS-Seeker2 offer the possibility to map to an <italic>in silico</italic> generated reduced representation genome. The time requirements, mapping rate and percentage alignment of the various aligners is presented in Table 
<xref rid="Tab7" ref-type="table">7</xref>. For RRBS, a typical question is not just what the alignment rate is, but also how CpG coverage varies by aligner. As indicated in Table 
<xref rid="Tab1" ref-type="table">1</xref>, Bison, Bismark and BSmooth can produce methylation-bias graphs and information from these was incorporated when calculating methylation levels from alignments produced by these aligners. Similarly, both Bison and BSmooth allow filtering methylation calls by both base Phred score and alignment MAPQ and both of those were utilized (the default for Bison is a minimum MAPQ score of 10 and a minimum Phred score of 5, so that was used for BSmooth as well). CpG coverage metrics are plotted in Figure 
<xref rid="Fig7" ref-type="fig">7</xref> and shown in Table 
<xref rid="Tab8" ref-type="table">8</xref>. For reference, there are 1,471,973 CpGs in the mm9 mouse reference genome sequence. Bison generally produces higher CpG coverage than the other aligners. BS-Seeker2 produces higher coverage than Bison, though this is likely due to it not filtering methylation calls by MAPQ and Phred score. It should be noted that GNUMAP-bs spreads fractional methylation calls arising from a single read across multiple positions, inflating its coverage metrics. The Pearson’s correlation of the methylation percentage and coverage produced by each aligner is shown in Figure 
<xref rid="Fig7" ref-type="fig">7</xref>. Only CpGs covered by both aligners are included in each comparison. The bowtie2-based aligners produce the most similar results, unsurprisingly. BS-Seeker2 and GNUMAP-bs are notable outliers, likely due to their low percentage alignment.<table-wrap id="Tab7"><label>Table 7</label><caption><p><bold>Alignment comparison with RRBS dataset ERR034786</bold></p></caption><table frame="hsides" rules="groups"><thead><tr><th>Program</th><th>Nodes (Cores)</th><th>Time required (hh:mm:ss)</th><th>Read pairs/core/sec.</th><th>Percent aligned*</th></tr></thead><tbody><tr><td>Bismark</td><td>1 (12)</td><td>03:25:07</td><td>104.32</td><td>58.26%</td></tr><tr><td>Bison</td><td>9 (108)</td><td>00:14:32</td><td>163.60</td><td>71.59% (65.94%)</td></tr><tr><td>BSMAP</td><td>1 (12)</td><td>00:22:30</td><td>951.05</td><td>65.12%</td></tr><tr><td>BSmooth</td><td>1 (12)</td><td>07:12:01</td><td>49.53</td><td>97.40% (68.89%)</td></tr><tr><td>BS-Seeker2</td><td>1 (12)</td><td>02:50:40</td><td>125.38</td><td>32.21%</td></tr><tr><td>GNUMAP-bs</td><td>1 (12)</td><td>05:06:10</td><td>69.89</td><td>36.01% (27.74%)</td></tr></tbody></table><table-wrap-foot><p>*Numbers in parentheses are metrics when only reads with MAPQ &gt; =10 are included.</p></table-wrap-foot></table-wrap><fig id="Fig7"><label>Figure 7</label><caption><p><bold>Methylation percentage and coverage comparison using the RRBS dataset.</bold> The Pearson’s correlation coefficients of the per-CpG estimated methylation percentages produced by each aligner are generally high, <bold>A</bold>, upper triangle. The correspondence between GNUMAP-bs and BS-Seeker2 and the other aligners, however, is notably lower, possibly due to their lower alignment rate. The Pearson’s correlation coefficients of the per-CpG coverage, <bold>A</bold>, lower triangle, is also generally high. The number of CpGs with a given coverage decreases rapidly as a function of coverage regardless of aligner, <bold>B</bold>. Note that CpGs with 251 or greater methylation calls are binned together. This binning produces the large spike at 251x coverage, which is likely due to PCR duplication.</p></caption><graphic xlink:href="12859_2014_6665_Fig7_HTML" id="d30e1690"/></fig></p>
    <table-wrap id="Tab8">
      <label>Table 8</label>
      <caption>
        <p>
          <bold>Number of CpGs with a given coverage from the RRBS dataset</bold>
        </p>
      </caption>
      <table frame="hsides" rules="groups">
        <thead>
          <tr>
            <th>Coverage</th>
            <th>Bismark</th>
            <th>Bison</th>
            <th>BSMAP</th>
            <th>BSmooth</th>
            <th>BS-Seeker2</th>
            <th>GNUMAP-bs</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>&gt; = 1x</td>
            <td>42,390</td>
            <td>63,524</td>
            <td>38,430</td>
            <td>32,371</td>
            <td>81,743</td>
            <td>56,750</td>
          </tr>
          <tr>
            <td>&gt; = 3x</td>
            <td>34,684</td>
            <td>53,757</td>
            <td>32,638</td>
            <td>27,609</td>
            <td>67,352</td>
            <td>45,272</td>
          </tr>
          <tr>
            <td>&gt; = 5x</td>
            <td>31,212</td>
            <td>48,548</td>
            <td>29,828</td>
            <td>25,418</td>
            <td>60,822</td>
            <td>38,863</td>
          </tr>
          <tr>
            <td>&gt; = 10x</td>
            <td>25,819</td>
            <td>39,945</td>
            <td>25,596</td>
            <td>21,576</td>
            <td>50,937</td>
            <td>28,428</td>
          </tr>
          <tr>
            <td>&gt; = 30x</td>
            <td>13,768</td>
            <td>21,768</td>
            <td>16,568</td>
            <td>12,987</td>
            <td>31,612</td>
            <td>11,382</td>
          </tr>
          <tr>
            <td>&gt; = 50x</td>
            <td>8,078</td>
            <td>12,942</td>
            <td>11,310</td>
            <td>8,271</td>
            <td>21,484</td>
            <td>5,449</td>
          </tr>
          <tr>
            <td>&gt; = 100x</td>
            <td>2,530</td>
            <td>4,009</td>
            <td>4,373</td>
            <td>3,033</td>
            <td>9,104</td>
            <td>1,464</td>
          </tr>
        </tbody>
      </table>
    </table-wrap>
    <p>While Bison produces alignments more quickly than the other tested aligners, except for BSMAP, and had higher accuracy in the simulated dataset, there are still cases for which its use is less ideal. Bison does not handle color-space reads, which Bismark, for example, can handle easily. As Bison uses bowtie2 for alignment, its accuracy and speed are limited to that afforded by bowtie2. Furthermore, as Bison utilizes MPI and requires compilation, its setup is more complicated than aligners like Bismark or BSmooth, making it a less attractive option for small-scale or one-off experiments. Finally, while Bison can process targeted bisulfite sequencing datasets (e.g., those produced with Agilent’s SureSelect MethylSeq kits), the alignment process is not optimized to exploit the expected strand-bias of these datasets.</p>
  </sec>
  <sec id="Sec7" sec-type="conclusions">
    <title>Conclusions</title>
    <p>Bison and bison_herd enable rapid and accurate alignment of BS-seq reads, such as those produced by the Illumina HiSeq. Both have equivalent to superior accuracy when compared to many previously published aligners. These programs also make performing quality control of the resulting mapped reads simple. As computer clusters are becoming increasingly prevalent in research settings, the speed of these tools removes the time-burden of alignment and simplifies the process of creating alignment pipelines, allowing the researcher to begin statistically analyzing experiments in a fraction of the time previously required. The open source nature of these programs and their usage of standard formats enable further adaptation and extension by end-users.</p>
  </sec>
  <sec id="Sec8">
    <title>Availability and requirements</title>
    <p><bold>Project name:</bold> Bison</p>
    <p>
      <bold>Project home page:</bold>
      <ext-link ext-link-type="uri" xlink:href="http://sourceforge.net/projects/dna-bison/">http://sourceforge.net/projects/dna-bison/</ext-link>
    </p>
    <p><bold>Operating systems:</bold> Linux, Mac OS</p>
    <p><bold>Programming Languages:</bold> C, python, R</p>
    <p><bold>Other requirements:</bold> GCC, bowtie2, MPI, Pthreads, Samtools</p>
    <p><bold>License:</bold> Modified MIT-style license, see LICENSE file for details</p>
    <p><bold>Any restrictions to use by non-academics:</bold> License required</p>
  </sec>
</body>
<back>
  <fn-group>
    <fn>
      <p>
        <bold>Competing interests</bold>
      </p>
      <p>The authors declare that they have no competing interests.</p>
    </fn>
    <fn>
      <p>
        <bold>Authors’ contributions</bold>
      </p>
      <p>DPR conceived and implemented the program. DE provided oversight and resources. Both authors read and approved the final manuscript.</p>
    </fn>
  </fn-group>
  <ack>
    <title>Acknowledgements</title>
    <p>The authors would like to thank Meeshanthini Dogan from the University of Iowa for contributing one of the example datasets included in the Bison tutorial. We would also like to thank Daniel Bayer for assistance in coming up with the Bison name.</p>
  </ack>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jones</surname>
            <given-names>PA</given-names>
          </name>
        </person-group>
        <article-title>Functions of DNA methylation: islands, start sites, gene bodies and beyond</article-title>
        <source>Nat Rev Genet</source>
        <year>2012</year>
        <volume>13</volume>
        <fpage>484</fpage>
        <lpage>492</lpage>
        <pub-id pub-id-type="doi">10.1038/nrg3230</pub-id>
        <?supplied-pmid 22641018?>
        <pub-id pub-id-type="pmid">22641018</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Krueger</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Andrews</surname>
            <given-names>SR</given-names>
          </name>
        </person-group>
        <article-title>Bismark: a flexible aligner and methylation caller for bisulfite-Seq applications</article-title>
        <source>Bioinformatics</source>
        <year>2011</year>
        <volume>27</volume>
        <fpage>1571</fpage>
        <lpage>1572</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btr167</pub-id>
        <?supplied-pmid 21493656?>
        <pub-id pub-id-type="pmid">21493656</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Krueger</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Kreck</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Franke</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Andrews</surname>
            <given-names>SR</given-names>
          </name>
        </person-group>
        <article-title>DNA methylome analysis using short bisulfite sequencing data</article-title>
        <source>Nat Methods</source>
        <year>2012</year>
        <volume>9</volume>
        <fpage>145</fpage>
        <lpage>151</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.1828</pub-id>
        <?supplied-pmid 22290186?>
        <pub-id pub-id-type="pmid">22290186</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kunde-Ramamoorthy</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Coarfa</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Laritsky</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Kessler</surname>
            <given-names>NJ</given-names>
          </name>
          <name>
            <surname>Harris</surname>
            <given-names>RA</given-names>
          </name>
          <name>
            <surname>Xu</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Shen</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Milosavljevic</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Waterland</surname>
            <given-names>RA</given-names>
          </name>
        </person-group>
        <article-title>Comparison and quantitative verification of mapping algorithms for whole-genome bisulfite sequencing</article-title>
        <source>Nucleic Acids Res</source>
        <year>2014</year>
        <volume>42</volume>
        <fpage>e43</fpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkt1325</pub-id>
        <?supplied-pmid 24391148?>
        <pub-id pub-id-type="pmid">24391148</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hansen</surname>
            <given-names>KD</given-names>
          </name>
          <name>
            <surname>Langmead</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Irizarry</surname>
            <given-names>RA</given-names>
          </name>
        </person-group>
        <article-title>BSmooth: from whole genome bisulfite sequencing reads to differentially methylated regions</article-title>
        <source>Genome Biol</source>
        <year>2012</year>
        <volume>13</volume>
        <fpage>R83</fpage>
        <pub-id pub-id-type="doi">10.1186/gb-2012-13-10-r83</pub-id>
        <?supplied-pmid 23034175?>
        <pub-id pub-id-type="pmid">23034175</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Guo</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Fiziev</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Yan</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Cokus</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Sun</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>MQ</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>PY</given-names>
          </name>
          <name>
            <surname>Pellegrini</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>BS-Seeker2: a versatile aligning pipeline for bisulfite sequencing data</article-title>
        <source>BMC Genomics</source>
        <year>2013</year>
        <volume>14</volume>
        <fpage>774</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2164-14-774</pub-id>
        <?supplied-pmid 24206606?>
        <pub-id pub-id-type="pmid">24206606</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Langmead</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Salzberg</surname>
            <given-names>SL</given-names>
          </name>
        </person-group>
        <article-title>Fast gapped-read alignment with Bowtie 2</article-title>
        <source>Nat Methods</source>
        <year>2012</year>
        <volume>9</volume>
        <fpage>357</fpage>
        <lpage>359</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.1923</pub-id>
        <?supplied-pmid 22388286?>
        <pub-id pub-id-type="pmid">22388286</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Xi</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>W</given-names>
          </name>
        </person-group>
        <article-title>BSMAP: whole genome bisulfite sequence MAPping program</article-title>
        <source>BMC Bioinformatics</source>
        <year>2009</year>
        <volume>10</volume>
        <fpage>232</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-10-232</pub-id>
        <?supplied-pmid 19635165?>
        <pub-id pub-id-type="pmid">19635165</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hong</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Clement</surname>
            <given-names>NL</given-names>
          </name>
          <name>
            <surname>Clement</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Hammoud</surname>
            <given-names>SS</given-names>
          </name>
          <name>
            <surname>Carrell</surname>
            <given-names>DT</given-names>
          </name>
          <name>
            <surname>Cairns</surname>
            <given-names>BR</given-names>
          </name>
          <name>
            <surname>Snell</surname>
            <given-names>Q</given-names>
          </name>
          <name>
            <surname>Clement</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>Johnson</surname>
            <given-names>WE</given-names>
          </name>
        </person-group>
        <article-title>Probabilistic alignment leads to improved accuracy and read coverage for bisulfite sequencing data</article-title>
        <source>BMC Bioinformatics</source>
        <year>2013</year>
        <volume>14</volume>
        <fpage>337</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-14-337</pub-id>
        <?supplied-pmid 24261665?>
        <pub-id pub-id-type="pmid">24261665</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Handsaker</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Wysoker</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Fennell</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Ruan</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Homer</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Marth</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Abecasis</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Durbin</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>The sequence alignment/Map format and SAMtools</article-title>
        <source>Bioinformatics</source>
        <year>2009</year>
        <volume>25</volume>
        <fpage>2078</fpage>
        <lpage>2079</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btp352</pub-id>
        <?supplied-pmid 19505943?>
        <pub-id pub-id-type="pmid">19505943</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Akalin</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Kormaksson</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Garrett-Bakelman</surname>
            <given-names>FE</given-names>
          </name>
          <name>
            <surname>Figueroa</surname>
            <given-names>ME</given-names>
          </name>
          <name>
            <surname>Melnick</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Mason</surname>
            <given-names>CE</given-names>
          </name>
        </person-group>
        <article-title>methylKit: a comprehensive R package for the analysis of genome-wide DNA methylation profiles</article-title>
        <source>Genome Biol</source>
        <year>2012</year>
        <volume>13</volume>
        <fpage>R87</fpage>
        <pub-id pub-id-type="doi">10.1186/gb-2012-13-10-r87</pub-id>
        <?supplied-pmid 23034086?>
        <pub-id pub-id-type="pmid">23034086</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hebestreit</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Dugas</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Klein</surname>
            <given-names>HU</given-names>
          </name>
        </person-group>
        <article-title>Detection of significantly differentially methylated regions in targeted bisulfite sequencing data</article-title>
        <source>Bioinformatics</source>
        <year>2013</year>
        <volume>29</volume>
        <fpage>1647</fpage>
        <lpage>1653</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btt263</pub-id>
        <?supplied-pmid 23658421?>
        <pub-id pub-id-type="pmid">23658421</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Akman</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Haaf</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Gravina</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Vijg</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Tresch</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Genomewide, quantitative analysis of DNA methylation from bisulfite sequencing data</article-title>
        <source>Bioinformatics</source>
        <year>2014</year>
        <volume>30</volume>
        <fpage>1933</fpage>
        <lpage>1934</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btu142</pub-id>
        <?supplied-pmid 24618468?>
        <pub-id pub-id-type="pmid">24618468</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Burger</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Gaidatzis</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Schubeler</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Stadler</surname>
            <given-names>MB</given-names>
          </name>
        </person-group>
        <article-title>Identification of active regulatory regions from DNA methylation data</article-title>
        <source>Nucleic Acids Res</source>
        <year>2013</year>
        <volume>41</volume>
        <fpage>e155</fpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkt599</pub-id>
        <?supplied-pmid 23828043?>
        <pub-id pub-id-type="pmid">23828043</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Seisenberger</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Andrews</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Krueger</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Arand</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Walter</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Santos</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Popp</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Thienpont</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Dean</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Reik</surname>
            <given-names>W</given-names>
          </name>
        </person-group>
        <article-title>The dynamics of genome-wide DNA methylation reprogramming in mouse primordial germ cells</article-title>
        <source>Mol Cell</source>
        <year>2012</year>
        <volume>48</volume>
        <fpage>849</fpage>
        <lpage>862</lpage>
        <pub-id pub-id-type="doi">10.1016/j.molcel.2012.11.001</pub-id>
        <?supplied-pmid 23219530?>
        <pub-id pub-id-type="pmid">23219530</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Molaro</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Hodges</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Fang</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Song</surname>
            <given-names>Q</given-names>
          </name>
          <name>
            <surname>McCombie</surname>
            <given-names>WR</given-names>
          </name>
          <name>
            <surname>Hannon</surname>
            <given-names>GJ</given-names>
          </name>
          <name>
            <surname>Smith</surname>
            <given-names>AD</given-names>
          </name>
        </person-group>
        <article-title>Sperm methylation profiles reveal features of epigenetic inheritance and evolution in primates</article-title>
        <source>Cell</source>
        <year>2011</year>
        <volume>146</volume>
        <fpage>1029</fpage>
        <lpage>1041</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2011.08.016</pub-id>
        <?supplied-pmid 21925323?>
        <pub-id pub-id-type="pmid">21925323</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Smallwood</surname>
            <given-names>SA</given-names>
          </name>
          <name>
            <surname>Tomizawa</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Krueger</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Ruf</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Carli</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Segonds-Pichon</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Sato</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Hata</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Andrews</surname>
            <given-names>SR</given-names>
          </name>
          <name>
            <surname>Kelsey</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>Dynamic CpG island methylation landscape in oocytes and preimplantation embryos</article-title>
        <source>Nat Genet</source>
        <year>2011</year>
        <volume>43</volume>
        <fpage>811</fpage>
        <lpage>814</lpage>
        <pub-id pub-id-type="doi">10.1038/ng.864</pub-id>
        <?supplied-pmid 21706000?>
        <pub-id pub-id-type="pmid">21706000</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
