<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.1 20151215//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-archivearticle1.dtd?>
<?SourceDTD.Version 1.1?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">PLoS One</journal-id>
    <journal-id journal-id-type="iso-abbrev">PLoS ONE</journal-id>
    <journal-id journal-id-type="publisher-id">plos</journal-id>
    <journal-id journal-id-type="pmc">plosone</journal-id>
    <journal-title-group>
      <journal-title>PLoS ONE</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1932-6203</issn>
    <publisher>
      <publisher-name>Public Library of Science</publisher-name>
      <publisher-loc>San Francisco, USA</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">3852983</article-id>
    <article-id pub-id-type="pmid">24324759</article-id>
    <article-id pub-id-type="publisher-id">PONE-D-13-30210</article-id>
    <article-id pub-id-type="doi">10.1371/journal.pone.0082138</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>SSW Library: An SIMD Smith-Waterman C/C++ Library for Use in Genomic Applications</article-title>
      <alt-title alt-title-type="running-head">SSW Library: An SIMD Smith-Waterman C/C++ Library</alt-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Zhao</surname>
          <given-names>Mengyao</given-names>
        </name>
        <xref ref-type="corresp" rid="cor1">
          <sup>*</sup>
        </xref>
        <xref ref-type="aff" rid="aff1"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Lee</surname>
          <given-names>Wan-Ping</given-names>
        </name>
        <xref ref-type="aff" rid="aff1"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Garrison</surname>
          <given-names>Erik P.</given-names>
        </name>
        <xref ref-type="aff" rid="aff1"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Marth</surname>
          <given-names>Gabor T.</given-names>
        </name>
        <xref ref-type="corresp" rid="cor1">
          <sup>*</sup>
        </xref>
        <xref ref-type="aff" rid="aff1"/>
      </contrib>
    </contrib-group>
    <aff id="aff1">
      <addr-line>Department of Biology, Boston College, Chestnut Hill, Massachusetts, United States of America</addr-line>
    </aff>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Mariño-Ramírez</surname>
          <given-names>Leonardo</given-names>
        </name>
        <role>Editor</role>
        <xref ref-type="aff" rid="edit1"/>
      </contrib>
    </contrib-group>
    <aff id="edit1">
      <addr-line>National Institutes of Health, United States of America</addr-line>
    </aff>
    <author-notes>
      <corresp id="cor1">* E-mail: <email>marth@bc.edu</email> (GTM); <email>zhaomengyao@gmail.com</email> (MZ)</corresp>
      <fn fn-type="COI-statement">
        <p><bold>Competing Interests: </bold>The authors have declared that no competing interests exist.</p>
      </fn>
      <fn fn-type="con">
        <p>Conceived and designed the experiments: MZ WL EG GM. Performed the experiments: MZ WL EG. Analyzed the data: MZ WL EG GM. Contributed reagents/materials/analysis tools: MZ WL. Wrote the manuscript: MZ WL EG GM. </p>
      </fn>
    </author-notes>
    <pub-date pub-type="collection">
      <year>2013</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>4</day>
      <month>12</month>
      <year>2013</year>
    </pub-date>
    <volume>8</volume>
    <issue>12</issue>
    <elocation-id>e82138</elocation-id>
    <history>
      <date date-type="received">
        <day>22</day>
        <month>7</month>
        <year>2013</year>
      </date>
      <date date-type="accepted">
        <day>21</day>
        <month>10</month>
        <year>2013</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© 2013 Zhao et al</copyright-statement>
      <copyright-year>2013</copyright-year>
      <copyright-holder>Zhao et al</copyright-holder>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open-access article distributed under the terms of the Creative Commons Attribution License, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are properly credited.</license-p>
      </license>
    </permissions>
    <abstract>
      <sec sec-type="headed">
        <title>Background</title>
        <p>The Smith-Waterman algorithm, which produces the optimal pairwise alignment between two sequences, is frequently used as a key component of fast heuristic read mapping and variation detection tools for next-generation sequencing data. Though various fast Smith-Waterman implementations are developed, they are either designed as monolithic protein database searching tools, which do not return detailed alignment, or are embedded into other tools. These issues make reusing these efficient Smith-Waterman implementations impractical.</p>
      </sec>
      <sec sec-type="headed">
        <title>Results</title>
        <p>To facilitate easy integration of the fast Single-Instruction-Multiple-Data Smith-Waterman algorithm into third-party software, we wrote a C/C++ library, which extends Farrar’s Striped Smith-Waterman (SSW) to return alignment information in addition to the optimal Smith-Waterman score. In this library we developed a new method to generate the full optimal alignment results and a suboptimal score in linear space at little cost of efficiency. This improvement makes the fast Single-Instruction-Multiple-Data Smith-Waterman become really useful in genomic applications. SSW is available both as a C/C++ software library, as well as a stand-alone alignment tool at: <ext-link ext-link-type="uri" xlink:href="https://github.com/mengyao/complete-striped-smith-waterman-library">https://github.com/mengyao/Complete-Striped-Smith-Waterman-Library</ext-link>.</p>
      </sec>
      <sec sec-type="headed">
        <title>Conclusions</title>
        <p>The SSW library has been used in the primary read mapping tool MOSAIK, the split-read mapping program SCISSORS, the MEI detector <named-content content-type="gene">TANGRAM</named-content>, and the read-overlap graph generation program RZMBLR. The speeds of the mentioned software are improved significantly by replacing their ordinary Smith-Waterman or banded Smith-Waterman module with the SSW Library.</p>
      </sec>
    </abstract>
    <funding-group>
      <funding-statement>This work has been funded by grant R01 HG4719 from the National Human Genome Research Institute to GTM. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
    </funding-group>
  </article-meta>
</front>
<body>
  <sec sec-type="introduction" id="s1">
    <title>Introduction</title>
    <p>The Smith-Waterman-Gotoh algorithm (SW) [<xref rid="B1" ref-type="bibr">1</xref>,<xref rid="B2" ref-type="bibr">2</xref>] is the most influential algorithm for aligning a pair of sequences. It is an essential component of the majority of aligners from the classical BLAST [<xref rid="B3" ref-type="bibr">3</xref>] to the more recent mappers. Although most of these aligners do not use SW directly to align a sequence to the whole genome sequence due to the quadratic time complexity of SW, they extensively use it for seed extension and for constructing the final alignment, and spend significant amount of CPU time on this algorithm. Due to the critical role of SW, many efforts have been made to accelerate SW, taking the advantages of special hardware such as single instruction multiple data (SIMD), field-programmable gate array (FPGA) and graphics processing unit (GPU) [<xref rid="B4" ref-type="bibr">4</xref>–<xref rid="B6" ref-type="bibr">6</xref>]. Among the three, SIMD based algorithms are most frequently used because they are compatible with most modern x86 CPUs. SIMD acceleration methods can be further divided into intra-sequence parallelization [<xref rid="B7" ref-type="bibr">7</xref>] and inter-sequence parallelization [<xref rid="B8" ref-type="bibr">8</xref>]. Inter-sequence parallelization is only useful when many pairs of sequencing reads are aligned simultaneously; intra-sequence parallelization however parallelizes for each single pairwise alignment, so it can be used more flexibly in various applications such as that needs aligning a single read against a potentially large genome reference sequence. Farrar’s Striped SW [<xref rid="B9" ref-type="bibr">9</xref>] with SWPS3’s [<xref rid="B10" ref-type="bibr">10</xref>] improvement is the fastest intra-sequence parallelized SIMD implementation running on x86 processors with the Streaming SIMD Extensions 2 (SSE2) instruction set. Indeed, Farrar’s algorithm has been embedded in several popular genomic sequence mapping tools, such as BWA-SW [<xref rid="B11" ref-type="bibr">11</xref>], Bowtie2 [<xref rid="B12" ref-type="bibr">12</xref>], Novoalign (<ext-link ext-link-type="uri" xlink:href="http://www.novocraft.com/">http://www.novocraft.com/</ext-link>) and Stampy [<xref rid="B13" ref-type="bibr">13</xref>].</p>
    <p>Though striped SW is tens of times faster than a standard SW implementation, only a few aligners have used this more advanced algorithm. There are several practical obstacles. Firstly, implementing a striped SW requires good understanding of SSE2 instructions and the more complex algorithm, which may take significant development time. Secondly, the original striped SW only gives the optimal alignment score but does not report the position or the detailed alignment, the information necessary for using SW as a component to construct the final alignment. How to report the position and alignment without affecting speed is non-trivial. Thirdly, while a few implementations report position and alignment, they are tightly integrated in a larger project and cannot be easily reused in other programs. Fourthly, when aligning a short read against a long sequence, we would like to know suboptimal alignments such that we can tell if the optimal position is trustworthy. Most existing libraries have not addressed this issue.</p>
    <p>Although striped SW has been published for six years, we are still in lack of a fast, versatile and standalone library. This leads us to develop the SSW library, a light weighted but comprehensive C/C++ library for pairwise sequence alignment with the striped SW algorithm.</p>
  </sec>
  <sec id="s2">
    <title>Results and Discussion</title>
    <sec id="s2.1">
      <title>Implementation</title>
      <p>To build a light-weight and easily reusable SIMD SW library for the genomic application development community, we made the SSW Library. It extends the Striped SW and SWPS3’s SIMD implementations to provide the mapping location and detailed alignment information (traceback), without performance penalty. Though these features are crucial when integrating SW into other genomic analysis systems, among the existing SIMD SW implementations only SSEARCH provides them, and as discussed in the Performance: Short-Read Genomic Alignment section its performance in typical genomic alignment contexts is poor. The SSW library can also return the heuristic suboptimal (second-best) alignment score and location without additional computational cost, which enables the use of the method in contexts that exploit this information in mapping-quality estimation. We describe our efficient implementation of these features in the Methods section.</p>
    </sec>
    <sec id="s2.2">
      <title>Usage</title>
      <p>The SSW library is an application program interface (API) that can be used as a component of C/C++ software to perform optimal protein or genome sequence alignment. The library returns the SW score, alignment location and traceback of the optimal alignment, and the alignment score and location of the suboptimal alignment. We provide the library with an executable alignment tool that can be used directly to perform protein or DNA alignments. It is a demonstration of the API usage and a practical tool for accurate whole viral or bacterial genome alignment. Moreover, since this tool is sufficiently fast and memory-efficient for alignment to very large reference genome sequences, e.g. the human genome, it can also be used to validate alignments produced by heuristic read mappers. The instructions of how to install and run the library is described in the README file at the software website (<ext-link ext-link-type="uri" xlink:href="https://github.com/mengyao/complete-striped-smith-waterman-library"><underline>https://github.com/mengyao/Complete-Striped-Smith-Waterman-Library</underline></ext-link>). A test data set is also provided there. </p>
    </sec>
    <sec id="s2.3">
      <title>Performance</title>
      <sec id="s2.3.1">
        <title>Protein Database Search</title>
        <p>We compared SSW’s performance (with and without returning the detailed alignment, SSW-C and SSW, respectively) to Farrar’s accelerated SW and SSEARCH (version 36.3.5c) on a Linux machine with 2GHz x86 64 AMD processors. We ran each program on a single thread. Since the optimal alignment scores for long DNA sequences given by SWPS3 are not consistent with others’, we did not benchmark its running time here.</p>
        <p>To measure the speed of protein database searching, we aligned five protein sequences (Q6GZW9 (75 aa), P14942 (192 aa), P42357 (551 aa), P07756 (1283 aa), and P19096 (2154 aa)) against the Uni-Prot Knowledgebase release 2013_09 (including Swiss-Prot and TrEMBL, a total of 13,823,121,038 aa residues in 43,362,837 sequences), by all four algorithms (see <xref ref-type="fig" rid="pone-0082138-g001">Figure 1</xref>). Since SSEARCH did not return alignment results against the entire Uni-Prot database, we were only able to test it against one quarter of the TrEMBL sequences (3,872,274,471 aa in 10,705,468 sequences). The command lines used for the database search are given in Table S1 in File S1. Our SSW algorithm is the fastest or equally fast to SSEARCH across the entire protein sequence length range we tested.</p>
        <fig id="pone-0082138-g001" orientation="portrait" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pone.0082138.g001</object-id>
          <label>Figure 1</label>
          <caption>
            <title>Running time of different SW implementations for protein database search.</title>
            <p>5 query proteins were searched against the whole Uni-Prot database (left) and one quarter of the TrEMBL database (right). Running time is shown on the y-axis for SSW without (blue) and with (red) detailed alignment, Farrar’s implementation (green) and SSEARCH (pink). All SW implementations used the BLOSUM50 scoring matrix with gap open penalty -12 and extension penalty -2.</p>
          </caption>
          <graphic xlink:href="pone.0082138.g001"/>
        </fig>
        <p>We also compared the CPU SW implementations with one of the most popular GPU implementations, CUDASW++ [<xref rid="B4" ref-type="bibr">4</xref>,<xref rid="B5" ref-type="bibr">5</xref>]. We were unable to obtain access to a system with a GPU card supporting CUDASW++ 3.0, so we ran CUDASW++ 2.0 (on a GeForce GTX 480 graphics card with 1.5G memory) for the comparison. Since our GPU host machine does not have sufficient storage for a larger protein database, such as TrEMBL, we aligned the five query proteins against the Swiss-Prot database (release 2013_09). The total running times in seconds of SSW, SSW-C, Farrar’s, SSEARCH, and CUDASW++ 2.0 are 310.10, 597.35, 424.27, 270.94 and 66.75 respectively. This GPU SW is about four fold faster than the fasted CPU SW. However, we did see the difficulty of using GPU SW, e.g. hardware is not easy found and installation is not ordinary.</p>
      </sec>
      <sec id="s2.3.2">
        <title>Short-Read Genomic Alignment</title>
        <p>To benchmark genome sequence alignment, we tested the programs with both simulated data and real sequencing reads. We selected 1Kb - 10Mb regions from human genome chromosome 8, and using an Illumina read simulator (<ext-link ext-link-type="uri" xlink:href="http://www.seqan.de/projects/mason/">http://www.seqan.de/projects/mason/</ext-link>) we generated a thousand 100 bp-long sequences from these regions. We then aligned these reads back to their corresponding reference sequences with each of the five algorithms (including our naïve Smith-Waterman, <ext-link ext-link-type="uri" xlink:href="https://github.com/wanpinglee/SmithWaterman">https://github.com/wanpinglee/SmithWaterman</ext-link>) and compared their running times (see <xref ref-type="fig" rid="pone-0082138-g002">Figure 2</xref>). Each program was run on a single thread on a Linux machine with 2G MHz x86_64 AMD processors. Two SW parameter settings are employed in the experiments: setting 1 (scores of match, mismatch, gap open and extension are 2, -1, -2, and -1 respectively) and setting 2 (scores of match, mismatch, gap open and extension are 1, -3, -5, and -2 respectively). The command lines used for read alignments are shown in Table S2 in File S1. Our SSW algorithm and Farrar’s accelerated version are equally fast for the whole reference length spectrum.</p>
        <fig id="pone-0082138-g002" orientation="portrait" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pone.0082138.g002</object-id>
          <label>Figure 2</label>
          <caption>
            <title>Running time of different SW implementations for simulated genomic read alignment.</title>
            <p>Running time of aligning 1,000 simulated Illumina reads to human reference sequences of various lengths. The log-scaled running time is shown on the y-axis for SSW without (blue) and with (red) detailed alignment, Farrar’s implementation (green), SSEARCH (pink) and an ordinary SW implementation (black). All SW implementations were tested under two sets of SW parameters: scores of match, mismatch, gap open and extension are 2, -1, -2, and -1 respectively (left), and scores of match, mismatch, gap open and extension are 1, -3, -5, and -2 respectively (right).</p>
          </caption>
          <graphic xlink:href="pone.0082138.g002"/>
        </fig>
        <p>For the comparisons on real sequencing datasets, we aligned four sets of a thousand reads representing three different sequencing technologies against four different reference genomes: (1) Applied Biosystems (ABI) capillary reads (1,388 bp average length) against the severe acute respiratory syndrome (SARS) virus (29,751 bp); (2) Ion Torrent reads (236 bp) against <italic>E. coli</italic> (4.94 × 10<sup>3</sup> bp); (3) Illumina reads (100 bp) against <italic>T. gondii</italic> (6.08 × 10<sup>7</sup> bp); and (4) Illumina reads against human genome chromosome 1 (2.49 × 10<sup>8</sup> bp) as shown in <xref ref-type="fig" rid="pone-0082138-g003">Figure 3</xref>. The same SW parameter settings as the tests on the simulated data sets are used in the experiment. The detailed genome and read information is described in Appendix S1 in File S1. The command lines used for read alignments are shown in Table S2 in File S1. These results indicate that even while returning a full optimal alignment and one suboptimal score, our SSW algorithm is just as fast as Farrar’s accelerated version. </p>
        <fig id="pone-0082138-g003" orientation="portrait" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pone.0082138.g003</object-id>
          <label>Figure 3</label>
          <caption>
            <title>Running time of different SW implementations for real genomic read alignment.</title>
            <p>Running time of aligning 1,000 real sequencing reads to various microorganism genomes and the human chromosome 1 are shown. Farrar’s implementation cannot handle long sequences as human chromosome 1, so its corresponding running time is not shown here. The log-scaled running time is shown on the y-axis for SSW without (blue) and with (red) detailed alignment, Farrar’s implementation (green), SSEARCH (pink) and an ordinary SW implementation (black). All SW implementations were tested under two sets of SW parameters: scores of match, mismatch, gap open and extension are 2, -1, -2, and -1 respectively (left), and scores of match, mismatch, gap open and extension are 1, -3, -5, and -2 respectively (right).</p>
          </caption>
          <graphic xlink:href="pone.0082138.g003"/>
        </fig>
        <p>We note that the relative performance of SSEARCH against our method is worst when working with short target DNA sequences, which is exactly the context in which pairwise alignment is most likely to be used.</p>
      </sec>
    </sec>
    <sec id="s2.4">
      <title>Applications</title>
      <p>Here we demonstrate the utility of our SSW library as a component of four different biologically meaningful applications.</p>
      <sec id="s2.4.1">
        <title>Primary short-read mapper</title>
        <p>To provide highly accurate alignments, most short-read mappers integrate an SW algorithm for a final “polishing” step. This step is especially important for aligning reads containing short insertions and deletions. Even though each SW run is short, it may be applied hundreds of millions of times within a single run of a mapper, and therefore even small inefficiencies result in wasteful resource usage. To quantify time savings with SSW, we compared the performance of our new method with the existing SW implementation within the MOSAIK mapping program [<xref rid="B14" ref-type="bibr">14</xref>], which uses SW for the final read alignments. We found that the SSW library achieves a two-fold speedup of the entire MOSAIK compared with the current banded SW implementation within it (see <xref rid="pone-0082138-t001" ref-type="table">Table 1</xref>). Notably, MOSAIK is a multi-threaded program and thus the SSW component in MOSAIK is running in parallel.</p>
        <table-wrap id="pone-0082138-t001" orientation="portrait" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pone.0082138.t001</object-id>
          <label>Table 1</label>
          <caption>
            <title>Comparison of the running time (seconds) between the banded SW engined MOSAIK and the SSW engined MOSAIK.</title>
          </caption>
          <table frame="hsides" rules="groups">
            <colgroup span="1">
              <col span="1"/>
              <col span="1"/>
              <col span="1"/>
            </colgroup>
            <thead>
              <tr>
                <th rowspan="1" colspan="1"/>
                <th rowspan="1" colspan="1">Illumina 100 bp</th>
                <th rowspan="1" colspan="1">454</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td rowspan="1" colspan="1">Banded SW</td>
                <td rowspan="1" colspan="1">70145.760</td>
                <td rowspan="1" colspan="1">240535.730</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">SSW</td>
                <td rowspan="1" colspan="1">38927.380</td>
                <td rowspan="1" colspan="1">98198.990</td>
              </tr>
            </tbody>
          </table>
          <table-wrap-foot>
            <fn>
              <p>We aligned three million Illumina 100 bp reads and one million 454 reads against the human genome.</p>
            </fn>
          </table-wrap-foot>
        </table-wrap>
      </sec>
      <sec id="s2.4.2">
        <title>Secondary short-read mapper</title>
        <p>Primary read mappers are often unable to map or properly align reads in structural variant (SV) regions, e.g. in regions of deletions, insertions, inversions, or translocations. Therefore, we developed a split-read aligner program, SCISSORS (<ext-link ext-link-type="uri" xlink:href="https://github.com/wanpinglee/scissors">https://github.com/wanpinglee/scissors</ext-link>) to map reads across structural variation event boundaries (breakpoints), rescuing reads not mapped, or inaccurately mapped by primary mapping approaches. We used our SSW library to align “orphaned” or severely “clipped” fragment-end read mates (in the case of read pairs where one end-mate is aligned with high mapping quality, but the other mate is either unmapped or mapped with many unaligned or “clipped-off” bases) to the genomic regions indicated by the well-mapped mates’ coordinates. Inclusion of the SW mapping routines of our SSW library makes accurate and fast split-read alignment for SV detection possible. The split-read mapping functionality, using our SSW library, has also been implemented in the TANGRAM SV detection tool (<ext-link ext-link-type="uri" xlink:href="https://github.com/jiantao/tangram"><underline>https://github.com/jiantao/Tangram</underline></ext-link>). <named-content content-type="gene">TANGRAM</named-content> is used intensively in the 1000 Genomes Project [<xref rid="B15" ref-type="bibr">15</xref>,<xref rid="B16" ref-type="bibr">16</xref>] to accurately detect MEIs (mobile element insertions) (<ext-link ext-link-type="uri" xlink:href="http://ftp.1000genomes.ebi.ac.uk/vol1/ftp/technical/working/20120815meicalls/BC/">http://ftp.1000genomes.ebi.ac.uk/vol1/ftp/technical/working/20120815meicalls/BC/</ext-link>). In SCISSORS and <named-content content-type="gene">TANGRAM</named-content>, SSW is also called in multi-threaded way.</p>
      </sec>
      <sec id="s2.4.3">
        <title>Read-overlap graph generation</title>
        <p>To evaluate evidence for putative SV and large INDEL calls generated by assembly methods, we can employ a read-overlap graph generated by exhaustive pairwise alignment of a set of reads which co-localize in a specific genomic region. We tested the effect of the SSW library in this application against a standard SW implementation (<ext-link ext-link-type="uri" xlink:href="https://github/ekg/smithwaterman">https://github/ekg/smithwaterman</ext-link>). To do the speed comparison test, we generated read-overlap graphs for the genomic region 20:21026000-21027500 using 22,543 reads (70 bp long) from 191 African samples in the 1000 Genomes Project dataset. The sample identifiers are listed in Appendix S2 in File S1. The running time of the read-overlap graph generation program RZMBLR (<ext-link ext-link-type="uri" xlink:href="https://github.com/ekg/rzmblr">https://github.com/ekg/rzmblr"</ext-link>) embedded with an ordinary SW (1795.66 seconds) is about twice of that embedded with our SSW library (973.02 seconds).</p>
      </sec>
    </sec>
  </sec>
  <sec sec-type="conclusions" id="s3">
    <title>Conclusions</title>
    <p>We developed and made available a fast SW library using SIMD acceleration. By returning not only the optimal alignment score but also the actual alignment, as well as a secondary optimal or suboptimal alignment score, the SSW library is suitable for inclusion into other heuristic genomic sequence analysis programs requiring local SW alignment. The most significant utility of our development, however, is that our algorithms can be readily integrated into C/C++ software without modification of the source code, accelerating development for larger software tools. SSW has already been adopted in four programs developed by our group: the primary read mapping tool MOSAIK, the split-read mapping program SCISSORS, the MEI detector <named-content content-type="gene">TANGRAM</named-content>, and the read-overlap graph generation program RZMBLR.</p>
  </sec>
  <sec sec-type="methods" id="s4">
    <title>Methods</title>
    <p>Our algorithmic improvements focused on speeding up the Farrar’s implementation and gaining access to the optimal alignment (in addition to the optimal achievable score), as well as the score of the best secondary alignment. For speedup, we adopted the “lazy F loop” improvement proposed by SWPS3 [<xref rid="B7" ref-type="bibr">7</xref>]. Furthermore we obtained additional alignment information compared to SWPS3 without slowing down the original algorithm: (1) we record the optimal alignment ending positions during the SIMD SW calculation and generate the detailed alignment by a reversed SIMD SW and a banded SW. When the score matrix is filled by the SIMD SW calculation, we store the maximal score of each column in a “max” array and record the complete column that has the maximal score of the whole matrix. Next, we locate the optimal alignment ending position on the reference and the query by seeking the maximal score in the array and the recorded column respectively. The reversed SIMD SW locates the best alignment beginning position from the ending position by calculating a much smaller scoring matrix. Then, the banded SW (whose band is defined by the beginning and ending positions) generates the detailed alignment. Since the alignment generation using the reversed SIMD SW and the banded SW only calculates a very small portion of the whole SW scoring matrix when the query sequence is much shorter than the target, in most cases of genome sequence alignment the corresponding time cost is trivial (2). We determine the secondary alignment score by seeking the second largest score in the “max” array. To avoid a similar sub-alignment of the primary alignment returned, we mask the elements in the region of the primary alignment of the “max” array and locate the second largest score from the unmasked elements (<xref ref-type="fig" rid="pone-0082138-g004">Figure 4</xref>). As a crucial step for locating the alignment position and estimating the suboptimal score, the “max” array generation is completed by adding an SSE2 command in the inner loop of Farrar’s implementation and another command in the outer loop, so that this additional time consumption is limited.</p>
    <fig id="pone-0082138-g004" orientation="portrait" position="float">
      <object-id pub-id-type="doi">10.1371/journal.pone.0082138.g004</object-id>
      <label>Figure 4</label>
      <caption>
        <title>Illustration of alignment traceback and suboptimal alignment score determination.</title>
        <p>An example SW score matrix is shown (penalties for match, mismatch, gap open and extension are 2, -1, -2, and -1 respectively). The bottom row indicates the maximum score for each column. The algorithm locates the optimal alignment ending position (the black cell with score 9) using the array of maximum scores, and then traces back to the alignment start position (the black cell with score 2) by searching a much smaller, locally computed score matrix (circled by the black rectangle). Finally, a banded SW calculates the detailed alignment by searching the shaded sub-region. The scores connected by solid arrows belong to the optimal alignment. The max array records the largest score of each column. After the optimal alignment score (marked by “best”) is found, its neighborhood is masked, and the second largest score is reported outside the masked region (marked by 2nd best). The scores connected by dashed-line arrows trace the suboptimal alignment.</p>
      </caption>
      <graphic xlink:href="pone.0082138.g004"/>
    </fig>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supporting Information</title>
    <supplementary-material content-type="local-data" id="pone.0082138.s001">
      <label>File S1</label>
      <caption>
        <p>(DOCX)</p>
      </caption>
      <media xlink:href="pone.0082138.s001.docx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ref-list>
    <title>References</title>
    <ref id="B1">
      <label>1</label>
      <mixed-citation publication-type="journal"><name><surname>Smith</surname><given-names>TF</given-names></name>, <name><surname>Waterman</surname><given-names>MS</given-names></name> (<year>1981</year>) <article-title>Identification of common molecular subsequences</article-title>. <source>J Mol Biol</source>
<volume>147</volume>: <fpage>195</fpage>–<lpage>197</lpage>. doi:<pub-id pub-id-type="doi">10.1016/0022-2836(81)90087-5</pub-id>. PubMed: <ext-link ext-link-type="uri" xlink:href="http://www.ncbi.nlm.nih.gov/pubmed/7265238">7265238</ext-link>. <pub-id pub-id-type="pmid">7265238</pub-id></mixed-citation>
    </ref>
    <ref id="B2">
      <label>2</label>
      <mixed-citation publication-type="journal"><name><surname>Gotoh</surname><given-names>O</given-names></name> (<year>1982</year>) <article-title>An improved algorithm for matching biological sequences</article-title>. <source>J Mol Biol</source>
<volume>162</volume>(<issue-id>3</issue-id>): <fpage>705</fpage>–<lpage>708</lpage>. doi:<pub-id pub-id-type="doi">10.1016/0022-2836(82)90398-9</pub-id>. PubMed: <ext-link ext-link-type="uri" xlink:href="http://www.ncbi.nlm.nih.gov/pubmed/7166760">7166760</ext-link>. <pub-id pub-id-type="pmid">7166760</pub-id></mixed-citation>
    </ref>
    <ref id="B3">
      <label>3</label>
      <mixed-citation publication-type="journal"><name><surname>Altschul</surname><given-names>FS</given-names></name>, <name><surname>Gish</surname><given-names>W</given-names></name>, <name><surname>Miller</surname><given-names>W</given-names></name>, <name><surname>Myers</surname><given-names>WE</given-names></name>, <name><surname>Lipman</surname><given-names>JD</given-names></name> (<year>1990</year>) <article-title>Basic Local Alignment Search Tool</article-title>. <source>J Mol Biol</source>
<volume>215</volume>(<issue-id>5</issue-id>): <fpage>403</fpage>–<lpage>410</lpage>. PubMed: <ext-link ext-link-type="uri" xlink:href="http://www.ncbi.nlm.nih.gov/pubmed/2231712">2231712</ext-link>.<pub-id pub-id-type="pmid">2231712</pub-id></mixed-citation>
    </ref>
    <ref id="B4">
      <label>4</label>
      <mixed-citation publication-type="journal"><name><surname>Liu</surname><given-names>Y</given-names></name>, <name><surname>Schmidt</surname><given-names>B</given-names></name>, <name><surname>Maskell</surname><given-names>DL</given-names></name> (<year>2010</year>) <article-title>CUDASW++2.0: enhanced Smith-Waterman protein database search on CUDA-enabled GPUs based on SIMT and virtualized SIMD abstractions</article-title>. <source>BMC Res Notes</source>
<volume>3</volume>: <fpage>93</fpage>. doi:<pub-id pub-id-type="doi">10.1186/1756-0500-3-93</pub-id>. PubMed: <ext-link ext-link-type="uri" xlink:href="http://www.ncbi.nlm.nih.gov/pubmed/20370891">20370891</ext-link>.<pub-id pub-id-type="pmid">20370891</pub-id></mixed-citation>
    </ref>
    <ref id="B5">
      <label>5</label>
      <mixed-citation publication-type="journal"><name><surname>Liu</surname><given-names>Y</given-names></name>, <name><surname>Wirawan</surname><given-names>A</given-names></name>, <name><surname>Schmidt</surname><given-names>B</given-names></name> (<year>2013</year>) <article-title>CUDASW++ 3.0: accelerating Smith-Waterman protein database search by coupling CPU and GPU SIMD instructions</article-title>. <source>BMC Bioinformatics</source>
<volume>14</volume>: <fpage>117</fpage>. doi:<pub-id pub-id-type="doi">10.1186/1471-2105-14-117</pub-id>. PubMed: <ext-link ext-link-type="uri" xlink:href="http://www.ncbi.nlm.nih.gov/pubmed/23557111">23557111</ext-link>.<pub-id pub-id-type="pmid">23557111</pub-id></mixed-citation>
    </ref>
    <ref id="B6">
      <label>6</label>
      <mixed-citation publication-type="journal"><name><surname>Korpar</surname><given-names>M</given-names></name>, <name><surname>Šikic</surname><given-names>M</given-names></name> (<year>2013</year>) <article-title>SW#-GPU-enabled exact alignments on genome scale</article-title>. <source>Bioinformatics</source>
<volume>29</volume>: <fpage>2494</fpage>-<lpage>2495</lpage>. doi:<pub-id pub-id-type="doi">10.1093/bioinformatics/btt410</pub-id>. PubMed: <ext-link ext-link-type="uri" xlink:href="http://www.ncbi.nlm.nih.gov/pubmed/23864730">23864730</ext-link>. <pub-id pub-id-type="pmid">23864730</pub-id></mixed-citation>
    </ref>
    <ref id="B7">
      <label>7</label>
      <mixed-citation publication-type="journal"><name><surname>Wozniak</surname><given-names>A</given-names></name> (<year>1997</year>) <article-title>Using video-oriented instructions to speed up sequence comparison</article-title>. <source>Comput Appl Biosci</source>
<volume>13</volume>(<issue-id>2</issue-id>): <fpage>145</fpage>–<lpage>150</lpage>. PubMed: <ext-link ext-link-type="uri" xlink:href="http://www.ncbi.nlm.nih.gov/pubmed/9146961">9146961</ext-link>. <pub-id pub-id-type="pmid">9146961</pub-id></mixed-citation>
    </ref>
    <ref id="B8">
      <label>8</label>
      <mixed-citation publication-type="journal"><name><surname>Rognes</surname><given-names>T</given-names></name> (<year>2011</year>) <article-title>Faster Smith-Waterman database searches with inter-sequence SIMD parallelisation</article-title>. <source>BMC Bioinformatics</source>
<volume>12</volume>: <fpage>221</fpage>. doi:<pub-id pub-id-type="doi">10.1186/1471-2105-12-221</pub-id>. PubMed: <ext-link ext-link-type="uri" xlink:href="http://www.ncbi.nlm.nih.gov/pubmed/21631914">21631914</ext-link>. <pub-id pub-id-type="pmid">21631914</pub-id></mixed-citation>
    </ref>
    <ref id="B9">
      <label>9</label>
      <mixed-citation publication-type="journal"><name><surname>Farrar</surname><given-names>M</given-names></name> (<year>2007</year>) <article-title>Striped Smith-Waterman speeds database searches six times over other SIMD implementations</article-title>. <source>Bioinformatics</source>
<volume>23</volume>(<issue-id>2</issue-id>): <fpage>156</fpage>–<lpage>161</lpage>. doi:<pub-id pub-id-type="doi">10.1093/bioinformatics/btl319</pub-id>. PubMed: <ext-link ext-link-type="uri" xlink:href="http://www.ncbi.nlm.nih.gov/pubmed/17110365">17110365</ext-link>. <pub-id pub-id-type="pmid">17110365</pub-id></mixed-citation>
    </ref>
    <ref id="B10">
      <label>10</label>
      <mixed-citation publication-type="journal"><name><surname>Szalkowski</surname><given-names>A</given-names></name>, <name><surname>Ledergerber</surname><given-names>C</given-names></name>, <name><surname>Krähenbühl</surname><given-names>P</given-names></name>, <name><surname>Dessimoz</surname><given-names>C</given-names></name> (<year>2008</year>) <article-title>SWPS3 - fast multi-threaded vectorized Smith-Waterman for IBM Cell/B.E. and x86/SSE2</article-title>. <source>BMC Res Notes</source>
<volume>1</volume>: <fpage>107</fpage>. doi:<pub-id pub-id-type="doi">10.1186/1756-0500-1-107</pub-id>. PubMed: <ext-link ext-link-type="uri" xlink:href="http://www.ncbi.nlm.nih.gov/pubmed/18959793">18959793</ext-link>. <pub-id pub-id-type="pmid">18959793</pub-id></mixed-citation>
    </ref>
    <ref id="B11">
      <label>11</label>
      <mixed-citation publication-type="journal"><name><surname>Li</surname><given-names>H</given-names></name>, <name><surname>Durbin</surname><given-names>R</given-names></name> (<year>2010</year>) <article-title>Fast and accurate long-read alignment with Burrows-Wheeler transform</article-title>. <source>Bioinformatics</source>
<volume>26</volume>(<issue-id>5</issue-id>): <fpage>589</fpage>–<lpage>595</lpage>. doi:<pub-id pub-id-type="doi">10.1093/bioinformatics/btp698</pub-id>. PubMed: <ext-link ext-link-type="uri" xlink:href="http://www.ncbi.nlm.nih.gov/pubmed/20080505">20080505</ext-link>. <pub-id pub-id-type="pmid">20080505</pub-id></mixed-citation>
    </ref>
    <ref id="B12">
      <label>12</label>
      <mixed-citation publication-type="journal"><name><surname>Langmead</surname><given-names>B</given-names></name>, <name><surname>Salzberg</surname><given-names>SL</given-names></name> (<year>2012</year>) <article-title>Fast gapped-read alignment with Bowtie 2</article-title>. <source>Nat Methods</source>
<volume>9</volume>(<issue-id>4</issue-id>): <fpage>357</fpage>–<lpage>359</lpage>. doi:<pub-id pub-id-type="doi">10.1038/nmeth.1923</pub-id>. PubMed: <ext-link ext-link-type="uri" xlink:href="http://www.ncbi.nlm.nih.gov/pubmed/22388286">22388286</ext-link>. <pub-id pub-id-type="pmid">22388286</pub-id></mixed-citation>
    </ref>
    <ref id="B13">
      <label>13</label>
      <mixed-citation publication-type="journal"><name><surname>Lunter</surname><given-names>G</given-names></name>, <name><surname>Goodson</surname><given-names>M</given-names></name> (<year>2011</year>) <article-title>Stampy: a statistical algorithm for sensitive and fast mapping of Illumina sequence reads</article-title>. <source>Genome Res</source>
<volume>21</volume>(<issue-id>6</issue-id>): <fpage>936</fpage>–<lpage>939</lpage>. doi:<pub-id pub-id-type="doi">10.1101/gr.111120.110</pub-id>. PubMed: <ext-link ext-link-type="uri" xlink:href="http://www.ncbi.nlm.nih.gov/pubmed/20980556">20980556</ext-link>.<pub-id pub-id-type="pmid">20980556</pub-id></mixed-citation>
    </ref>
    <ref id="B14">
      <label>14</label>
      <mixed-citation publication-type="other"><name><surname>Lee</surname><given-names>W-P</given-names></name>, <name><surname>Stromberg</surname><given-names>M</given-names></name>, <name><surname>Ward</surname><given-names>A</given-names></name>, <name><surname>Stewart</surname><given-names>C</given-names></name>, <name><surname>Garrison</surname><given-names>E</given-names></name>, <etal>et al.</etal> (<year>2013</year>) <article-title>MOSAIK: A hash-based algorithm for accurate next-generation sequencing read mapping</article-title>. <comment>arXiv:1309.1149</comment>
</mixed-citation>
    </ref>
    <ref id="B15">
      <label>15</label>
      <mixed-citation publication-type="other"><comment>1000</comment><collab>Genomes Project</collab><article-title>Consortium</article-title>, <comment>Abecasis GR, Altshuler D, Auton A, Brooks LD, et al. (2010) A map of human genome variation from population-scale sequencing. Nature 467(7319):1061–73</comment></mixed-citation>
    </ref>
    <ref id="B16">
      <label>16</label>
      <mixed-citation publication-type="book"><comment>1000 Genomes</comment><collab>Project Consortium</collab>, <name><surname>Abecasis</surname><given-names>GR</given-names></name>, <name><surname>Auton</surname><given-names>A</given-names></name>, <name><surname>Brooks</surname><given-names>LD</given-names></name>, <name><surname>DePristo</surname><given-names>MA</given-names></name>, <etal>et al.</etal> (<year>2012</year>). <source>An integrated map of genetic variation</source>
<comment>from 1,092 human genomes. Nature 491(7422):56–65</comment>
</mixed-citation>
    </ref>
  </ref-list>
</back>
