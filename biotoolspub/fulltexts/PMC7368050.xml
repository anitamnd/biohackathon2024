<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Nat Commun</journal-id>
    <journal-id journal-id-type="iso-abbrev">Nat Commun</journal-id>
    <journal-title-group>
      <journal-title>Nature Communications</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2041-1723</issn>
    <publisher>
      <publisher-name>Nature Publishing Group UK</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">7368050</article-id>
    <article-id pub-id-type="publisher-id">17388</article-id>
    <article-id pub-id-type="doi">10.1038/s41467-020-17388-x</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Using sigLASSO to optimize cancer mutation signatures jointly with sampling likelihood</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-5440-2780</contrib-id>
        <name>
          <surname>Li</surname>
          <given-names>Shantao</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Crawford</surname>
          <given-names>Forrest W.</given-names>
        </name>
        <xref ref-type="aff" rid="Aff3">3</xref>
        <xref ref-type="aff" rid="Aff4">4</xref>
        <xref ref-type="aff" rid="Aff5">5</xref>
        <xref ref-type="aff" rid="Aff6">6</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-9746-3719</contrib-id>
        <name>
          <surname>Gerstein</surname>
          <given-names>Mark B.</given-names>
        </name>
        <address>
          <email>mark@gersteinlab.org</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
        <xref ref-type="aff" rid="Aff6">6</xref>
        <xref ref-type="aff" rid="Aff7">7</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ISNI">0000000419368710</institution-id><institution-id institution-id-type="GRID">grid.47100.32</institution-id><institution>Program in Computational Biology and Bioinformatics, </institution><institution>Yale University, </institution></institution-wrap>New Haven, CT USA </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="ISNI">0000000419368710</institution-id><institution-id institution-id-type="GRID">grid.47100.32</institution-id><institution>Department of Molecular Biophysics and Biochemistry, </institution><institution>Yale University, </institution></institution-wrap>New Haven, CT USA </aff>
      <aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="ISNI">0000000419368710</institution-id><institution-id institution-id-type="GRID">grid.47100.32</institution-id><institution>Department of Biostatistics, </institution><institution>Yale School of Public Health, </institution></institution-wrap>New Haven, CT USA </aff>
      <aff id="Aff4"><label>4</label><institution-wrap><institution-id institution-id-type="ISNI">0000000419368710</institution-id><institution-id institution-id-type="GRID">grid.47100.32</institution-id><institution>Department of Ecology and Evolutionary Biology, </institution><institution>Yale University, </institution></institution-wrap>New Haven, CT USA </aff>
      <aff id="Aff5"><label>5</label><institution-wrap><institution-id institution-id-type="ISNI">0000000419368710</institution-id><institution-id institution-id-type="GRID">grid.47100.32</institution-id><institution>Yale School of Management, </institution></institution-wrap>New Haven, CT USA </aff>
      <aff id="Aff6"><label>6</label><institution-wrap><institution-id institution-id-type="ISNI">0000000419368710</institution-id><institution-id institution-id-type="GRID">grid.47100.32</institution-id><institution>Department of Statistics and Data Science, </institution><institution>Yale University, </institution></institution-wrap>New Haven, CT USA </aff>
      <aff id="Aff7"><label>7</label><institution-wrap><institution-id institution-id-type="ISNI">0000000419368710</institution-id><institution-id institution-id-type="GRID">grid.47100.32</institution-id><institution>Department of Computer Science, </institution><institution>Yale University, </institution></institution-wrap>New Haven, CT USA </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>17</day>
      <month>7</month>
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>17</day>
      <month>7</month>
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2020</year>
    </pub-date>
    <volume>11</volume>
    <elocation-id>3575</elocation-id>
    <history>
      <date date-type="received">
        <day>7</day>
        <month>1</month>
        <year>2020</year>
      </date>
      <date date-type="accepted">
        <day>22</day>
        <month>6</month>
        <year>2020</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2020</copyright-statement>
      <license license-type="OpenAccess">
        <license-p><bold>Open Access</bold> This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The images or other third party material in this article are included in the article’s Creative Commons license, unless indicated otherwise in a credit line to the material. If material is not included in the article’s Creative Commons license and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this license, visit <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <p id="Par1">Multiple mutational processes drive carcinogenesis, leaving characteristic signatures in tumor genomes. Determining the active signatures from a full repertoire of potential ones helps elucidate mechanisms of cancer development. This involves optimally decomposing the counts of cancer mutations, tabulated according to their trinucleotide context, into a linear combination of known signatures. Here, we develop sigLASSO (a software tool at <ext-link ext-link-type="uri" xlink:href="http://github.com/gersteinlab/siglasso">github.com/gersteinlab/siglasso</ext-link>) to carry out this optimization efficiently. sigLASSO has four key aspects: (1) It jointly optimizes the likelihood of sampling and signature fitting, by explicitly factoring multinomial sampling into the objective function. This is particularly important when mutation counts are low and sampling variance is high (e.g., in exome sequencing). (2) sigLASSO uses L1 regularization to parsimoniously assign signatures, leading to sparse and interpretable solutions. (3) It fine-tunes model complexity, informed by data scale and biological priors. (4) Consequently, sigLASSO can assess model uncertainty and abstain from making assignments in low-confidence contexts.</p>
    </abstract>
    <abstract id="Abs2" abstract-type="web-summary">
      <p id="Par2">The next generation sequencing has provided the opportunity to look for signatures of carcinogenesis on a genome wide scale. Here, the authors develop the algorithm, sigLASSO, that provides confidence in assigning mutational signatures when the mutation count is low and the samples used are variable.</p>
    </abstract>
    <kwd-group kwd-group-type="npg-subject">
      <title>Subject terms</title>
      <kwd>Machine learning</kwd>
      <kwd>Software</kwd>
      <kwd>Statistical methods</kwd>
      <kwd>Cancer genomics</kwd>
    </kwd-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2020</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1" sec-type="introduction">
    <title>Introduction</title>
    <p id="Par3">Mutagenesis is a fundamental process underlying cancer development. Examples of mutational mechanisms include spontaneous deamination of cytosines, the formation of pyrimidine dimers by ultraviolet (UV) light, and the crosslinking of guanines by alkylating agents. Multiple endogenous and exogenous mutational processes drive cancer mutagenesis and leave distinct fingerprints<sup><xref ref-type="bibr" rid="CR1">1</xref></sup>. Notably, these processes have characteristic mutational nucleotide context biases<sup><xref ref-type="bibr" rid="CR2">2</xref>–<xref ref-type="bibr" rid="CR6">6</xref></sup>. Sequencing cancer samples at presentation revealed all mutations accumulated over lifetime; these include somatic alterations generated by multiple mutational processes both before cancer initiation and during cancer development. In a generative model, multiple latent mutational processes generate mutations over time, drawing from their corresponding nucleotide context distributions (mutation signature)<sup><xref ref-type="bibr" rid="CR4">4</xref>,<xref ref-type="bibr" rid="CR5">5</xref></sup>. Here, a mutation signature is a multinomial probability distribution of mutations of a set of nucleotide contexts. In cancer samples, mutations from various mutational processes are mixed and observable by sequencing.</p>
    <p id="Par4">By applying unsupervised methods such as non-negative matrix factorization (NMF) and clustering to large-scale cancer studies, researchers have decomposed the mutation mixture and identified at least 30 distinct mutational signatures<sup><xref ref-type="bibr" rid="CR2">2</xref>,<xref ref-type="bibr" rid="CR7">7</xref></sup>. Many signatures have been linked with mutational processes with known etiologies, such as aging, smoking, or ApoBEC activity. Investigating the fundamental processes underlying mutagenesis could help elucidate the initiation and development of cancer.</p>
    <p id="Par5">A major task in cancer research is to leverage signature studies on large-scale cancer cohorts and efficiently select and attribute active signatures to new cancer samples. A popular previously published method, deconstructSigs,<sup><xref ref-type="bibr" rid="CR8">8</xref></sup> decomposes the mutation profile into a signature mixture using binary search to iteratively test coefficients one-by-one and then hard pruning signatures with low estimated contribution to achieve sparsity. Other approaches use linear programming<sup><xref ref-type="bibr" rid="CR9">9</xref></sup> or iterate all combinations by brute force<sup><xref ref-type="bibr" rid="CR10">10</xref></sup>. None of these approaches explicitly formulates sampling uncertainty into the model or uses efficient regression techniques. Moreover, no off-the-shelf implementation of these methods, besides deconstructSigs, is available.</p>
    <p id="Par6">Although we do not fully know the latent mutational processes in cancer samples, we can make reasonable and logical assumptions that facilitate our method design. Here, we aimed to design a computational framework, sigLASSO, which could meet these criteria. First, we assumed that the set of estimated mutational mechanisms should be small, as de novo studies indicate that not all signatures can be active in a single sample or even a given cancer type. In most cancer samples, only a few signatures are identified in the original de novo discovery studies. An ideal tool should generate solutions that follow this sparse distribution. Moreover, the number of detectable mutation signatures is limited by the amount of data support. Too many signatures lead to overfitting and unstable solutions. We aimed for a sparser solution as it explains observations in a simpler fashion. Second, the estimated mutational mechanisms should be biologically interpretable and reflect some cancer type specificity. For example, we should not observe UV-associated signatures in tissues that are not exposed to UV. Likewise, we only expect to observe activation-induced cytidine deaminase mutational processes, which are biologically involved in antibody diversification, in B-cell lymphomas. Finally, we felt the solution should be robust and the data should control the model complexity.</p>
    <p id="Par7">In particular, reliably recovering the signature composition is challenging when the mutation number is low<sup><xref ref-type="bibr" rid="CR8">8</xref></sup>. Low mutation count results in high sampling variance, leading to an unreliable estimation of the mutation context probability distribution, which is the target for signature fitting. A desirable signature identification tool should model the sampling process and take sampling variance into consideration.</p>
    <p id="Par8">In this work, we formulated the task as a joint optimization problem with L1 regularization. First, by jointly fitting signatures and the parameters of a multinomial sampling process, sigLASSO takes into account the sampling uncertainty. Cooperatively fitting a linear mixture and maximizing the sampling likelihood enables knowledge transfer and improves performance. Specifically, signature fitting imposes constraints on the previously unconstrained multinomial sampling probability distribution. Conversely, a better estimation of the multinomial sampling probability improves signature fitting. This property is especially critical in high sampling variance settings, for example, when we only observe low mutation counts in whole-exome sequencing (WES). Existing methods use continuous relaxation, which makes the model invariant to different mutation counts. Second, sigLASSO penalizes the model complexity and achieves variable selection by regularization. Regularization is essential for this fitting problem with a large amount of signatures to achieve proper variable selection and avoid overfitting. Using regularization to promote sparsity and prevent overfitting is also a standard practice in de novo signature discovery. A few recent examples are rule-based constraints (SigProfiler), a Bayesian variant of NMF that penalizes on model complexity (SignatureAnalyzer<sup><xref ref-type="bibr" rid="CR11">11</xref></sup>) and L1-based regularization (SparseSignatures<sup><xref ref-type="bibr" rid="CR12">12</xref></sup>). The most straightforward way to do this would be to use the L0 norm (cardinality of active signatures), but this approach cannot be effectively optimized. Conversely, using the L2 norm flattened out at small values leads to many tiny, non-zero coefficients, which do not resemble the sparse signature distribution in the original de novo studies and are hard to interpret biologically. sigLASSO uses the L1 norm, which promotes sparsity. The L1 norm is convex, and thus allows efficient optimization<sup><xref ref-type="bibr" rid="CR13">13</xref>,<xref ref-type="bibr" rid="CR14">14</xref></sup>. In addition, this approach is able to harmoniously integrate prior biological knowledge into the solution by fine-tuning penalties on the coefficients. Compared with the approach of subsetting signatures before fitting, our soft thresholding method is more flexible to noise and unidentified signatures. Finally, sigLASSO is aware of data complexity such as mutational number and patterns in the observation. It is able to abstain (decline to assign mutational processes under high uncertainty) and defer to the human researcher to decide. Our method is automatically parameterized empirically on performance, allowing data complexity to inform model complexity. In this way, our approach also promotes result reproducibility and fair comparison of data sets.</p>
    <p id="Par9">In sum, sigLASSO exploits constraints in signature identification and provides a robust framework for scientists to achieve biologically sound solutions. sigLASSO also can empower researchers to use and integrate their biological knowledge and expertise into the model. Unveiling the underlying mutational processes in cancer samples will enable us to recognize and quantify new mutagens, understand mutagenesis and DNA repair processes, and develop new therapeutic strategies for cancer<sup><xref ref-type="bibr" rid="CR9">9</xref>,<xref ref-type="bibr" rid="CR15">15</xref>–<xref ref-type="bibr" rid="CR18">18</xref></sup>.</p>
  </sec>
  <sec id="Sec2" sec-type="results">
    <title>Results</title>
    <sec id="Sec3">
      <title>The signature identification problem</title>
      <p id="Par10">Mutational processes leave mutations in the genome within distinct nucleotide contexts. We denoted the total number of contexts as <italic>n</italic>. Typically, we considered the mutant nucleotide context and looked one nucleotide ahead and behind each mutation, dividing the mutations into <italic>n</italic> = 96 trinucleotide contexts. Each mutational process carries a unique signature, which is represented by a multinomial probability distribution over mutations of trinucleotide context (Fig 1a).</p>
      <p id="Par11">Then there are <italic>K</italic> latent mutational processes. Large-scale pan-cancer analyses identified <italic>K</italic> = 30 COSMIC signatures by NMF (with Frobenius norm penalty) and clustering<sup><xref ref-type="bibr" rid="CR2">2</xref>,<xref ref-type="bibr" rid="CR3">3</xref></sup>. Here, our objective was to leverage the pan-cancer analysis and decompose mutations from new samples into a linear combination of signatures. Mathematically, we formulated the following non-negative regression problem, maintaining the original Frobenius norm:<disp-formula id="Equ1"><label>1</label><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathcal{W}}=\arg \,\mathop{\min }\limits_{{\mathcal{W}}\in {R}^{+}}{\left\Vert {\mathcal{M}}-{\mathcal{S}}{\mathcal{W}}\right\Vert }_{2}^{2}$$\end{document}</tex-math><mml:math id="M2"><mml:mi class="MJX-tex-caligraphic" mathvariant="script">W</mml:mi><mml:mo>=</mml:mo><mml:mi>arg</mml:mi><mml:mspace width="0.25em"/><mml:munder><mml:mrow><mml:mi>min</mml:mi></mml:mrow><mml:mrow><mml:mi class="MJX-tex-caligraphic" mathvariant="script">W</mml:mi><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:munder><mml:msubsup><mml:mrow><mml:mfenced close="∥" open="∥" separators=""><mml:mrow><mml:mi class="MJX-tex-caligraphic" mathvariant="script">M</mml:mi><mml:mo>−</mml:mo><mml:mi class="MJX-tex-caligraphic" mathvariant="script">S</mml:mi><mml:mi class="MJX-tex-caligraphic" mathvariant="script">W</mml:mi></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:math><graphic xlink:href="41467_2020_17388_Article_Equ1.gif" position="anchor"/></alternatives></disp-formula>The mutation matrix, <inline-formula id="IEq1"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathcal{M}}$$\end{document}</tex-math><mml:math id="M4"><mml:mi class="MJX-tex-caligraphic" mathvariant="script">M</mml:mi></mml:math><inline-graphic xlink:href="41467_2020_17388_Article_IEq1.gif"/></alternatives></inline-formula> contains mutations of each sample cataloged into <italic>n</italic> trinucleotide contexts. <inline-formula id="IEq2"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${m}_{i(i = 1...n)}\in {\mathcal{M}}$$\end{document}</tex-math><mml:math id="M6"><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mi>n</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:mi class="MJX-tex-caligraphic" mathvariant="script">M</mml:mi></mml:math><inline-graphic xlink:href="41467_2020_17388_Article_IEq2.gif"/></alternatives></inline-formula> denotes the mutation count of the <italic>i</italic>th category. <inline-formula id="IEq3"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathcal{S}}$$\end{document}</tex-math><mml:math id="M8"><mml:mi class="MJX-tex-caligraphic" mathvariant="script">S</mml:mi></mml:math><inline-graphic xlink:href="41467_2020_17388_Article_IEq3.gif"/></alternatives></inline-formula> is a <italic>n</italic> × <italic>K</italic> signature matrix, containing the mutation probability in 96 trinucleotide contexts of the 30 signatures. <inline-formula id="IEq4"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathcal{W}}$$\end{document}</tex-math><mml:math id="M10"><mml:mi class="MJX-tex-caligraphic" mathvariant="script">W</mml:mi></mml:math><inline-graphic xlink:href="41467_2020_17388_Article_IEq4.gif"/></alternatives></inline-formula> is the weights matrix, representing the contributions of 30 signatures in each sample.</p>
    </sec>
    <sec id="Sec4">
      <title>Sampling variance</title>
      <p id="Par12">In practice, this problem is optimized using continuous relaxation for efficiency and simplicity,<sup><xref ref-type="bibr" rid="CR8">8</xref></sup> neglecting the discrete nature of mutation counts. This approach essentially transforms observed mutations into a multinomial probability distribution, making model estimation insensitive to the total mutation count. However, the total mutation count has a critical role in inference. Assuming mutations are drawn from a latent probability distribution, which is the mixture of several mutational signatures, the mutations follow a multinomial distribution. The total mutation count is the sample size of the distribution, thus greatly affecting the variance of the inferred distribution.</p>
      <p id="Par13">For instance, 20 mutations within the 96 categories give us very little confidence in inferring the underlying mutation distribution. By contrast, if we observed 2000 mutations, we would have much higher confidence. Methods using continuous relaxation treat these two conditions indifferently. Here, we aimed to use a likelihood-based approach to acknowledge the sampling variance and design a tool sensitive to the total mutation count.</p>
    </sec>
    <sec id="Sec5">
      <title>sigLASSO model</title>
      <p id="Par14">We divided the data generation process into two parts. First, multiple mutational signatures mix together to form an underlying latent mutation distribution. Second, we observed a set of categorical data (mutations), which is a realization of the underlying mutation distribution. We used <italic>m</italic><sub><italic>i</italic></sub>(<italic>i</italic> = 1…<italic>n</italic>) to denote the mutation count of the <italic>i</italic>th category. The vector <inline-formula id="IEq5"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\vec{p}$$\end{document}</tex-math><mml:math id="M12"><mml:mover accent="true"><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mo>→</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="41467_2020_17388_Article_IEq5.gif"/></alternatives></inline-formula> is the underlying latent mutation probability distribution with <italic>p</italic><sub><italic>j</italic></sub>, denoting the probability of the <italic>j</italic>th category. The total number of mutations is <italic>N</italic>.</p>
      <p id="Par15">To achieve variable selection and promote sparsity and interpretability of the solution, sigLASSO adds an L1 norm regularizer on the weights <inline-formula id="IEq6"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\vec{w}$$\end{document}</tex-math><mml:math id="M14"><mml:mover accent="true"><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mo>→</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="41467_2020_17388_Article_IEq6.gif"/></alternatives></inline-formula> (i.e., coefficients) of the signatures with a hyperparameter <italic>λ</italic>. LASSO is mathematically justified and can be computationally solved efficiently<sup><xref ref-type="bibr" rid="CR14">14</xref></sup>. Adding an L1 norm regularizer is equivalent to placing a Laplacian prior on <inline-formula id="IEq7"><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\vec{w}$$\end{document}</tex-math><mml:math id="M16"><mml:mover accent="true"><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mo>→</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="41467_2020_17388_Article_IEq7.gif"/></alternatives></inline-formula><sup><xref ref-type="bibr" rid="CR19">19</xref></sup>. <inline-formula id="IEq8"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\vec{c}$$\end{document}</tex-math><mml:math id="M18"><mml:mover accent="true"><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mo>→</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="41467_2020_17388_Article_IEq8.gif"/></alternatives></inline-formula> is a vector of <italic>K</italic> penalty weights (<italic>c</italic><sub>1</sub>, <italic>c</italic><sub>2</sub>, … <italic>c</italic><sub><italic>K</italic></sub>), each indicating the strength to penalize the coefficient of a certain signature. This vector should be tuned to reflect the level of confidence in the prior knowledge. For example, a smaller penalty weight represents a stronger prior, reflecting higher confidence and vice versa.</p>
      <p id="Par16">Overall, from the generative model, we can determine the likelihood function for a single sample.<disp-formula id="Equ2"><label>2</label><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathcal{L}} =	 \, {\mathcal{P}}(\vec{m}| {\mathcal{S}}\vec{w})\underbrace{{\mathcal{P}}(\vec{w})}_{{\rm{prior}}}\\ = 	\, {\mathcal{P}}(\vec{m}| \vec{p}){\mathcal{P}}(\vec{p}| {\mathcal{S}}\vec{w}){\mathcal{P}}(\vec{w})\\ = 	\, \underbrace{\frac{N!}{\mathop{\prod }\limits_{i = 1}^{n}{m}_{i}!}\mathop{\prod }\limits_{i = 1}^{n}{p}_{i}^{{m}_{i}}}_{{\mathrm{multinomial}} \,\, {\mathrm{sampling}}}\underbrace{\frac{1}{\sqrt{2\pi {\sigma }^{2}}}{e}^{-}\frac{\mathop{\sum }\limits_{i = 1}^{n}\Bigg({p}_{i}-\mathop{\sum }\limits_{k = 1}^{K}{s}_{ik}{w}_{k}\Bigg)^{2}}{2{\sigma}^{2}}}_{{\mathrm{linear}} \,\, {\mathrm{fitting}}}\quad \underbrace{\mathop{\prod}\limits_{k = 1}^{K}{e}^{-\lambda {c}_{k}{w}_{k}}}_{{\mathrm{Laplacian}} \,\, {\mathrm{prior}}}$$\end{document}</tex-math><mml:math id="M20"><mml:mi class="MJX-tex-caligraphic" mathvariant="script">L</mml:mi><mml:mo>=</mml:mo><mml:mspace width="0.25em"/><mml:mi class="MJX-tex-caligraphic" mathvariant="script">P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mo>→</mml:mo></mml:mover><mml:mo>∣</mml:mo><mml:mi class="MJX-tex-caligraphic" mathvariant="script">S</mml:mi><mml:mover accent="true"><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mo>→</mml:mo></mml:mover></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:msub><mml:mrow><mml:munder accentunder="true"><mml:mrow><mml:mi class="MJX-tex-caligraphic" mathvariant="script">P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mo>→</mml:mo></mml:mover></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mo stretchy="true">⏟</mml:mo></mml:mrow></mml:munder></mml:mrow><mml:mrow><mml:mi mathvariant="normal">prior</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mspace width="0.25em"/><mml:mi class="MJX-tex-caligraphic" mathvariant="script">P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mo>→</mml:mo></mml:mover><mml:mo>∣</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mo>→</mml:mo></mml:mover></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi class="MJX-tex-caligraphic" mathvariant="script">P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mo>→</mml:mo></mml:mover><mml:mo>∣</mml:mo><mml:mi class="MJX-tex-caligraphic" mathvariant="script">S</mml:mi><mml:mover accent="true"><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mo>→</mml:mo></mml:mover></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi class="MJX-tex-caligraphic" mathvariant="script">P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mo>→</mml:mo></mml:mover></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mrow><mml:munder accentunder="true"><mml:mrow><mml:mfrac><mml:mrow><mml:mi>N</mml:mi><mml:mo>!</mml:mo></mml:mrow><mml:mrow><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo>∏</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>!</mml:mo></mml:mrow></mml:mfrac><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo>∏</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:munderover><mml:msubsup><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:mo stretchy="true">⏟</mml:mo></mml:mrow></mml:munder></mml:mrow><mml:mrow><mml:mi mathvariant="normal">multinomial</mml:mi><mml:mspace width="0.25em"/><mml:mspace width="0.25em"/><mml:mi mathvariant="normal">sampling</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:munder accentunder="true"><mml:mrow><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msqrt><mml:mrow><mml:mn>2</mml:mn><mml:mi>π</mml:mi><mml:msup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:msqrt></mml:mrow></mml:mfrac><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msup><mml:mfrac><mml:mrow><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:munderover><mml:mstyle mathsize="2.45em"><mml:mfenced close="" open="(" separators=""><mml:mrow/></mml:mfenced></mml:mstyle><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>K</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mrow><mml:mstyle mathsize="2.45em"><mml:mfenced close="" open=")" separators=""><mml:mrow/></mml:mfenced></mml:mstyle></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:msup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfrac></mml:mrow><mml:mrow><mml:mo stretchy="true">⏟</mml:mo></mml:mrow></mml:munder></mml:mrow><mml:mrow><mml:mi mathvariant="normal">linear</mml:mi><mml:mspace width="0.25em"/><mml:mspace width="0.25em"/><mml:mi mathvariant="normal">fitting</mml:mi></mml:mrow></mml:msub><mml:mspace width="1.0em"/><mml:msub><mml:mrow><mml:munder accentunder="true"><mml:mrow><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo>∏</mml:mo></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>K</mml:mi></mml:mrow></mml:munderover><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mi>λ</mml:mi><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mo stretchy="true">⏟</mml:mo></mml:mrow></mml:munder></mml:mrow><mml:mrow><mml:mi mathvariant="normal">Laplacian</mml:mi><mml:mspace width="0.25em"/><mml:mspace width="0.25em"/><mml:mi mathvariant="normal">prior</mml:mi></mml:mrow></mml:msub></mml:math><graphic xlink:href="41467_2020_17388_Article_Equ2.gif" position="anchor"/></alternatives></disp-formula>Our objective function is to maximize the log-likelihood function, which is given as:<disp-formula id="Equ3"><label>3</label><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{array}{l}\ell \propto \mathop{\sum }\limits_{i = 1}^{n}\{{m}_{i}\mathrm{log}\,{p}_{i}-\frac{\alpha }{2}{\left({p}_{i}-\mathop{\sum }\limits_{k = 1}^{K}{s}_{ik}{w}_{k}\right)}^{2}\}-\lambda \mathop{\sum }\limits_{k = 1}^{K}{c}_{k}{w}_{k}\\ s.t.\forall {w}_{k}\ge 0,\forall {p}_{i}\ge 0,\mathop{\sum }\limits_{i = 1}^{n}{p}_{i}=1\end{array}$$\end{document}</tex-math><mml:math id="M22"><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mi>ℓ</mml:mi><mml:mo>∝</mml:mo><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:munderover><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mi mathvariant="normal">log</mml:mi><mml:mspace width="0.25em"/><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac><mml:msup><mml:mrow><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>K</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mo>}</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mi>λ</mml:mi><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>K</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mi>s</mml:mi><mml:mo>.</mml:mo><mml:mi>t</mml:mi><mml:mo>.</mml:mo><mml:mo>∀</mml:mo><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>≥</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mo>∀</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>≥</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="41467_2020_17388_Article_Equ3.gif" position="anchor"/></alternatives></disp-formula>Here, <italic>α</italic> = 1/<italic>σ</italic><sup>2</sup>. We can infer <italic>α</italic> from the residual errors from linear regression (see parameter tuning). Meanwhile, because of its continuous nature, <inline-formula id="IEq9"><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\vec{c}$$\end{document}</tex-math><mml:math id="M24"><mml:mover accent="true"><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mo>→</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="41467_2020_17388_Article_IEq9.gif"/></alternatives></inline-formula> can also be effectively learned using patient information (e.g., smoking status, tumor size, or methylation status). We also used <inline-formula id="IEq10"><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\vec{c}$$\end{document}</tex-math><mml:math id="M26"><mml:mover accent="true"><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mo>→</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="41467_2020_17388_Article_IEq10.gif"/></alternatives></inline-formula> to perform adaptive LASSO<sup><xref ref-type="bibr" rid="CR20">20</xref></sup> by initializing <inline-formula id="IEq11"><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\vec{c}$$\end{document}</tex-math><mml:math id="M28"><mml:mover accent="true"><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mo>→</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="41467_2020_17388_Article_IEq11.gif"/></alternatives></inline-formula> to 1/<italic>β</italic><sub><italic>O</italic><italic>L</italic><italic>S</italic></sub>, where <italic>β</italic><sub><italic>O</italic><italic>L</italic><italic>S</italic></sub> are the coefficients from non-negative ordinary least square. Our aim was to obtain a less-biased estimator by applying smaller penalties on variables with larger coefficients.</p>
    </sec>
    <sec id="Sec6">
      <title>sigLASSO is aware of the sampling variance</title>
      <p id="Par17">By jointly optimizing both the sampling process and signature fitting, sigLASSO is aware of the sampling variance and infers an underlying mutational context distribution <inline-formula id="IEq12"><alternatives><tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\vec{p}$$\end{document}</tex-math><mml:math id="M30"><mml:mover accent="true"><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mo>→</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="41467_2020_17388_Article_IEq12.gif"/></alternatives></inline-formula>. The underlying latent distribution is optimized with respect to both sampling likelihood and the linear fitting of signatures (Fig. <xref rid="Fig1" ref-type="fig">1</xref>b). In low mutation counts, the uncertainty in sampling increases and thus the estimated underlying distribution moves closer to the least square estimate (Fig. <xref rid="Fig1" ref-type="fig">1</xref>c). In contrast, when the total mutation count is high, the estimate of the distribution is closer to the MLE of the multinomial sampling process.<fig id="Fig1"><label>Fig. 1</label><caption><title>SigLASSO takes sampling variance into account.</title><p><bold>a</bold> A schematic graph showing the mixture model of mutational processes and signatures. <bold>b</bold> A contour plot of the penalty function of multinomial sampling function (optimum at <italic>p</italic><sub>1</sub>) and the least square of signature fitting (optimum at <italic>p</italic><sub>2</sub>). sigLASSO tries to jointly optimize both penalties (red contour lines, optimum at <italic>p</italic>). <bold>c</bold> As mutation number increases, the inferred <inline-formula id="IEq13"><alternatives><tex-math id="M31">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\overrightarrow{p}$$\end{document}</tex-math><mml:math id="M32"><mml:mover accent="true"><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mo>→</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="41467_2020_17388_Article_IEq13.gif"/></alternatives></inline-formula> gets closer to the sampling MLE rather than the linear fitting as the sampling variance decreases. Box edges are the 25th and 75th percentiles and whiskers indicate the 1.5× interquartile range (IQR) or max/min, which ones are smaller. <bold>d</bold> The MSE of the estimation of <inline-formula id="IEq14"><alternatives><tex-math id="M33">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\overrightarrow{p}$$\end{document}</tex-math><mml:math id="M34"><mml:mover accent="true"><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mo>→</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="41467_2020_17388_Article_IEq14.gif"/></alternatives></inline-formula> and the underlying noiseless signature mixture by sigLASSO and using the point MLE. Low mutation counts profiles benefit from sigLASSO the most. Priors were sampled uniformly from the ground true positives and negatives.</p></caption><graphic xlink:href="41467_2020_17388_Fig1_HTML" id="d30e1422"/></fig></p>
      <p id="Par18">We illustrated how the mutation count affects the estimation of <inline-formula id="IEq15"><alternatives><tex-math id="M35">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\vec{p}$$\end{document}</tex-math><mml:math id="M36"><mml:mover accent="true"><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mo>→</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="41467_2020_17388_Article_IEq15.gif"/></alternatives></inline-formula> using a simulated data set (five signatures, noise level: 0.1, see “Methods”). When the sample size was small (≤100), high uncertainty in sampling pushed the inferred underlying mutational distribution <inline-formula id="IEq16"><alternatives><tex-math id="M37">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\vec{p}$$\end{document}</tex-math><mml:math id="M38"><mml:mover accent="true"><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mo>→</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="41467_2020_17388_Article_IEq16.gif"/></alternatives></inline-formula> far from the MLE in exchange for better signature fitting. When the sample size increased, lower variance in sampling dragged <inline-formula id="IEq17"><alternatives><tex-math id="M39">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\vec{p}$$\end{document}</tex-math><mml:math id="M40"><mml:mover accent="true"><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mo>→</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="41467_2020_17388_Article_IEq17.gif"/></alternatives></inline-formula> close to the sampling MLE and forced the signatures to fit even with larger errors.</p>
      <p id="Par19">Because linear fitting and sampling likelihood optimization mutually inform each other, concurrently learning an auxiliary sampling likelihood improves performance. We compared the accuracy of the estimation of <inline-formula id="IEq18"><alternatives><tex-math id="M41">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\vec{p}$$\end{document}</tex-math><mml:math id="M42"><mml:mover accent="true"><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mo>→</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="41467_2020_17388_Article_IEq18.gif"/></alternatives></inline-formula> with and without this joint optimization (Fig. <xref rid="Fig1" ref-type="fig">1</xref>d). As expected, <inline-formula id="IEq19"><alternatives><tex-math id="M43">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\vec{p}$$\end{document}</tex-math><mml:math id="M44"><mml:mover accent="true"><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mo>→</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="41467_2020_17388_Article_IEq19.gif"/></alternatives></inline-formula> estimation in low mutation count performed worse. sigLASSO was able to achieve a lower MSE in estimating both <inline-formula id="IEq20"><alternatives><tex-math id="M45">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\vec{p}$$\end{document}</tex-math><mml:math id="M46"><mml:mover accent="true"><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mo>→</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="41467_2020_17388_Article_IEq20.gif"/></alternatives></inline-formula> (with noise) and the underlying true signature mixture (noiseless).</p>
    </sec>
    <sec id="Sec7">
      <title>Performance on simulated data sets</title>
      <p id="Par20">We first evaluated sigLASSO on simulated data sets. Both sigLASSO (with and without priors) and deconstructSigs performed better with higher mutation number and lower noise (Fig. <xref rid="Fig2" ref-type="fig">2</xref>a, Supplementary Figure <xref rid="MOESM1" ref-type="media">1</xref>). A decrease in mutation number leads to an increase of uncertainty in sampling, which is mostly negligible in the high mutation scenarios. As expected, the MSE jumped to the 0.05–0.3 range regardless of the noise level when the mutation number was low. We observed a similar pattern in support recovery (i.e., precision/recall/accuracy). Thus, the error is dominated by undersampling rather than embedded noise. Despite giving a simpler, sparse solution, sigLASSO with priors outperformed sigLASSO with no priors and deconstructSigs in both MSE and support recovery. In support recovery, sigLASSO with priors showed a 5–10% gain in accuracy compared with deconstructSigs. sigLASSO with no priors also had better support recovery performance, measured by accuracy, than deconstructSigs. Overall, sigLASSO maintained a higher precision level when the mutation number decreased and/or the noise increased, which shows its ability to abstain (decline to assign signatures) and provide some control on the false positive rate. Notably, sigLASSO with priors maintained an accuracy above 0.8 in all simulation settings. Moreover, the precision of sigLASSO was minimally affected by the number of signatures.<fig id="Fig2"><label>Fig. 2</label><caption><title>Performance on simulated data sets.</title><p><bold>a</bold> Support recovery on simulated data sets. Each setting is simulated 100 times. Penalty coefficients for priors: 0.1. <bold>b</bold> Support recovery on simulated data sets. Tuning the penalty weights using prior knowledge improves performance; <italic>x</italic> axis: the fraction of true signatures given as prior (larger than 1 indicates false signatures giving as priors). Penalty coefficients for priors: red, 0.5; yellow, 0.1; green, 0.01.</p></caption><graphic xlink:href="41467_2020_17388_Fig2_HTML" id="d30e1543"/></fig></p>
      <p id="Par21">Although the recall was slightly lower with sigLASSO than deconstructSigs in noisy settings, in very low and no noise situations sigLASSO achieved, a higher recall owing to its ability to adapt to different noise levels. By contrast, deconstructSigs, which assumes a fixed noise level, overly pruned the signatures in the post-fitting step when the noise was low. At last, adding correct priors helped boost both precision and recall significantly.</p>
      <p id="Par22">We next explored how different priors affect sigLASSO’s performance. Our experiments showed that using known signatures as priors to tune the weights boosts performance. Priors improved performance even when we included only a small fraction of true signatures or blended in a large number of wrong signatures (Fig. <xref rid="Fig2" ref-type="fig">2</xref>b, Supplementary Figure <xref rid="MOESM1" ref-type="media">2</xref>). As the fraction of true signatures given as prior knowledge increased from zero, the performance immediately started improving and continued to do so. When more false signatures were mixed with true signatures given as prior knowledge, the performance slowly deteriorated. However, even with 1.5 times false signatures mixed in with true ones, the performance was slightly better (~2% in accuracy) than the baseline that used no priors. Stronger priors had larger boosting effects on the solution, as expected.</p>
    </sec>
    <sec id="Sec8">
      <title>WGS scenario using renal cancer data sets</title>
      <p id="Par23">We next moved from synthetic data sets to real cancer mutational profiles, which are likely noisier than simulations and exhibit a highly non-random distribution of signatures.</p>
      <p id="Par24">We benchmarked the two methods using 35 WGS papillary kidney cancer samples<sup><xref ref-type="bibr" rid="CR21">21</xref></sup>. The median mutation count was 4528 (range: 912–9257). We found that without prior knowledge, both sigLASSO and deconstructSigs showed high contributions from signatures 3 and 5 (Fig. <xref rid="Fig3" ref-type="fig">3</xref>a, b). deconstructSigs also assigned a high proportion to signatures 8(9.9%), 9(6.9%), and 16(4.7%). Signatures 3, 8, 9, and 16 were not found to be active in pRCC in previous studies and currently no biological support connects them to pRCC<sup><xref ref-type="bibr" rid="CR2">2</xref></sup>. As expected, sigLASSO resulted in sparser solutions than deconstructSigs (mean signatures assigned: 3.40 and 4.43, respectively). Adding prior from COSMIC (kidney cancer combined) helps sigLASSO to put more weight on Signature 5, and increase the number of signatures assigned to 4.06.<fig id="Fig3"><label>Fig. 3</label><caption><title>Performance on pRCC and ESCA samples.</title><p><bold>a</bold> Signature assignment for 35 WGS pRCC samples. Bar plots show the fractions of mutation signature assignment for each sample using sigLASSO, sigLASSO without prior knowledge and deconstructSigs, and simple non-negative regression. <bold>b</bold> A dot chart showing the mean fraction of mutation signatures in each sample. Signatures that contributed &lt;0.05 are grouped into others. <bold>c</bold> Subsampling (10 times each size, with no replacement) of 30 WGS pRCC samples that have more than 3000 mutations. The left panel shows the fraction of signature-fitted mutations. Results using all mutations are shown in box. The right panel shows the agreement (mean fraction of the consensus after binarizing whether a signature exists or not) among the methods. All <italic>p</italic> ≤ 2 × 10<sup>−6</sup> (paired two-sided Wilcox test between sigLASSO (and sigLASSO, no prior) and deconstructSigs). Box edges are the 25th and 75th percentiles and whiskers indicate the 1.5× IQR or max/min, which ones are smaller. <bold>d</bold> A dot chart showing the mean fraction of mutation signatures in each sample, grouped by two tools and histological subtypes (adenocarcinoma/squamous). Signatures that contributed individually &lt;0.05 in all four cases are grouped into "others''.</p></caption><graphic xlink:href="41467_2020_17388_Fig3_HTML" id="d30e1599"/></fig></p>
      <p id="Par25">However, if we naively subset the signatures and took the ones that were found to be active in previous studies, the signature profile was completely dominated by signature 5, to which only ~10% mutations on average were assigned with other signatures. Moreover, the model assigned highly similar signature profiles to all samples. This finding suggests an overly simple, underfitted model.</p>
      <p id="Par26">To show that sigLASSO is sensitive to fitting uncertainty, able to abstain, and is robust, we performed subsampling on 30 pRCC samples (mutation counts ≥3000, Fig. <xref rid="Fig3" ref-type="fig">3</xref>c). As the sample size decreased, sigLASSO assigned fewer mutations with signatures (mean fraction dropped from 0.93 (all mutations) to 0.55 (20 mutations)), reflecting the greater uncertainty in fitting. This quality allows the user to be aware of the uncertainty in the solutions.</p>
      <p id="Par27">Moreover, the model complexity also declined accordingly (Supplementary Figure <xref rid="MOESM1" ref-type="media">3</xref>). The mean number of signatures assigned by sigLASSO decreased from 4.06 to 1.67, representing simpler models. Last, the performance of sigLASSO was robust and stable, as evidenced by stable outputs even in low sampling counts. Multiple subsampling runs showed high agreement in active and inactive signatures (~0.95 across all subsample sizes).</p>
      <p id="Par28">In contrast, deconstructSigs was unable to reflect model uncertainty. Surprisingly, as the mutation number decreased, the fraction of fitted mutations in deconstructSigs unexpectedly increased from 0.83 (all) to 0.97 (20 mutations). The model complexity, as reflected by the mean number of signatures assigned also increased from 4.43 to 4.70. The agreement between subsamples dropped significantly as the subsampling size decreased, indicating the solution is unstable and potentially overfitted.</p>
    </sec>
    <sec id="Sec9">
      <title>WES scenario using esophageal carcinoma data sets</title>
      <p id="Par29">We next aimed to evaluate the two methods on 182 WES esophageal carcinoma (ESCA) samples with &gt;20 mutations. The median mutation count was 175.5 (range: 28–2146), which is considerably lower than WGS but typical for WES.</p>
      <p id="Par30">In sigLASSO, the L1 penalty strength was tuned based on model performance. In a low mutation count setting, ESCA WES data set, the model variance was high, which pushed up the penalty. As expected by its ability to abstain, sigLASSO assigned a lower fraction of mutations with signatures than deconstructSigs (median: 0.68 and 0.90; interquartile range (IQR): 0.56–0.75 and 0.86–0.94, respectively, Supplementary Figure <xref rid="MOESM1" ref-type="media">4</xref>). deconstructSigs did not achieve 100% assignment because it performed a hard normalization of the coefficients after an unconstrained binary search and then discarded signatures that had ≤6% contribution. The leading signatures were 1, 16, 17, 3, and 13 in sigLASSO and 1, 17, 16, 6, 13, 3, and 2 in deconstructSigs.</p>
      <p id="Par31">deconstructSigs has been applied to distinguish between two different histological types of esophageal cancer<sup><xref ref-type="bibr" rid="CR8">8</xref></sup>. We demonstrated that sigLASSO generates a sparser but comparable result with wider signature 1, and 16 gaps between the subtypes (Fig. <xref rid="Fig3" ref-type="fig">3</xref>d, Supplementary Figure <xref rid="MOESM1" ref-type="media">5</xref>). The adenocarcinoma subtypes had higher fractions of signature 1 and 17, and lower fractions of signature 3, 13, and 16.</p>
    </sec>
    <sec id="Sec10">
      <title>Performance on 8893 TCGA samples</title>
      <p id="Par32">We ran sigLASSO and deconstructSigs with step-by-step set-ups on 8893 The Cancer Genome Atlas (TCGA) tumors (33 cancer types, Supplementary Table <xref rid="MOESM1" ref-type="media">11</xref>) with more than 20 mutations (Fig. <xref rid="Fig4" ref-type="fig">4</xref>, Supplementary Figure <xref rid="MOESM1" ref-type="media">6</xref>). The median mutation number is 100, IQR is 52–200.<fig id="Fig4"><label>Fig. 4</label><caption><title>Performance on 33 TCGA cancers.</title><p>Active signatures (total contribution  &gt;0.1%) in 33 cancer types using different methods. Only 27 cancer types have previously known signature distributions (others are shaded). Penalty coefficients of priors used for sigLASSO: 0.01. Weak priors: 0.5. Priors were taken from COSMIC, and provided with our "sigLASSO'' R package.</p></caption><graphic xlink:href="41467_2020_17388_Fig4_HTML" id="d30e1660"/></fig></p>
      <p id="Par33">Simple non-negative regression resulted in an overly dense matrix. Applying an L1 penalty made the solution remarkably sparse. Then, by incorporating the prior knowledge, the signature landscape further changed without significantly affecting the assignment sparsity. The change was inconsistent with the priors given. With low-count WES data (upper quartile: 200 and 96 mutational contexts), we expect the signature assignment to be very sparse as the uncertainty is high, the model should from making assignments. sigLASSO indeed assigned low number of signatures to the samples (median number of signatures assigned per sample: 1, IQR: 1–2). In comparison, the solutions of deconstructSigs were less sparse (median number of signatures assigned per sample: 4, IQR: 3–5). In all, 18.5% samples were fitted by deconstuctSigs with six signatures or more, compared with 0.4% by sigLASSO. We provide a kidney cancer example and detailed paired analysis in the Supplement (Supplementary Figure <xref rid="MOESM1" ref-type="media">7</xref>, <xref rid="MOESM1" ref-type="media">8</xref>).</p>
      <p id="Par34">When the mutation number cutoff increases to 50, the above results of the two methods still stand (Supplementary Figure <xref rid="MOESM1" ref-type="media">9</xref>). We also released all of the signature results of 8893 TCGA samples on the sigLASSO GitHub site.</p>
      <p id="Par35">Using the large-scale tumor signature profiles, we further explored the correlation of smoking signature and smoking status using annotations from a previous study<sup><xref ref-type="bibr" rid="CR15">15</xref></sup>. In lung adenocarcinoma (LUAD) samples, smoking samples carry significantly higher signature 4 (“smoking signatures”) fractions than non-smoking ones (median: 0 and 0.68, respectively, <italic>p</italic> ≤ 1 × 10<sup>−15</sup>, Wilcoxon rank test, Supplementary Figure <xref rid="MOESM1" ref-type="media">10</xref>). Similarly, in lung squamous cell carcinoma (LUSC) samples, we observed high fractions of signature 4 in smokers, but because only 3.5% of the LUSC cohort are nonsmokers (6/171), we were underpowered to draw a statistical significance. In non-lung cancer samples (<italic>N</italic> = 1500), we also found a weaker but statistically significant trend of higher signature 4 in smokers (mean: 0.008 and 0.038, respectively, <italic>p</italic> = 3.3 × 10<sup>−8</sup>, Wilcoxon rank test, Supplementary Figure <xref rid="MOESM1" ref-type="media">10</xref>). This result is in agreement with previous studies on smoking signatures<sup><xref ref-type="bibr" rid="CR15">15</xref></sup>.</p>
    </sec>
    <sec id="Sec11">
      <title>sigLASSO is computationally efficient</title>
      <p id="Par36">sigLASSO iteratively solves two convex problems. The <inline-formula id="IEq21"><alternatives><tex-math id="M47">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\vec{w}-$$\end{document}</tex-math><mml:math id="M48"><mml:mover accent="true"><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mo>→</mml:mo></mml:mover><mml:mo>−</mml:mo></mml:math><inline-graphic xlink:href="41467_2020_17388_Article_IEq21.gif"/></alternatives></inline-formula>step can be solved using a very efficient coordinate descent algorithm (glmnet)<sup><xref ref-type="bibr" rid="CR14">14</xref></sup>. The <inline-formula id="IEq22"><alternatives><tex-math id="M49">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\vec{p}-$$\end{document}</tex-math><mml:math id="M50"><mml:mover accent="true"><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mo>→</mml:mo></mml:mover><mml:mo>−</mml:mo></mml:math><inline-graphic xlink:href="41467_2020_17388_Article_IEq22.gif"/></alternatives></inline-formula>step is solved by a set of quadric equations. We observed empirically that the solution quickly converges in a few iterations even with low mutation numbers. Meanwhile, deconstructSigs uses binary search instead of regression to try every coefficient by looping through all signatures at each iteration.</p>
      <p id="Par37">By profiling sigLASSO and deconstructSigs (Fig. <xref rid="Fig5" ref-type="fig">5</xref>), we noticed that neither total mutation numbers nor signature numbers remarkably affected the running time of sigLASSO. With a high mutation number, sigLASSO was 3–4 times faster than deconstructSigs; with a low mutation number (50 mutations), these two tools showed a comparable computation time. Noticeably, despite using less time sigLASSO employs empirical parameterization and alternative optimization, which regresses the signature-fitting problems hundreds of thousands of times with different parameters in a typical run. Therefore, by carefully designing an effective algorithm, the core fitting step of sigLASSO is orders of magnitudes faster than deconstructSigs. This enables sigLASSO to probe the data complexity and accordingly tune the model complexity.<fig id="Fig5"><label>Fig. 5</label><caption><title>sigLASSO is computationally efficient.</title><p><bold>a</bold> Running time of sigLASSO and deconstructSigs at different total mutations numbers. Box edges are the 25th and 75th percentiles and whiskers indicate the 1.5× IQR or max/min, which ones are smaller. <bold>b</bold> Running time of sigLASSO at different numbers of signatures (downsampled from 30 COSMIC signatures) simulated with three different mutations numbers (in parenthesis). Noise level: 0.1 sL: sigLASSO, dS: deconstructSigs.</p></caption><graphic xlink:href="41467_2020_17388_Fig5_HTML" id="d30e1767"/></fig></p>
    </sec>
  </sec>
  <sec id="Sec12" sec-type="discussion">
    <title>Discussion</title>
    <p id="Par38">Studies decomposing cancer mutations into a linear combination of signatures have provided invaluable insights into cancer biology<sup><xref ref-type="bibr" rid="CR4">4</xref>–<xref ref-type="bibr" rid="CR6">6</xref>,<xref ref-type="bibr" rid="CR22">22</xref></sup>. Indeed, researchers have gained a better understanding of one of the fundamental driving forces of cancer initiation and development, mutagenesis, by inferring mutational signatures and latent mutational processes.</p>
    <p id="Par39">A practical problem for many researchers is how to leverage results from large-scale signature studies and apply them to a small set of incoming samples. Although this might seem to be a simple linear system problem, core challenges include (1) preventing over- and underfitting on only one sample, often with very few mutations (especially in WES), (2) achieving proper variable selection from a large amount of recognized signatures, and (3) promoting interpretability.</p>
    <p id="Par40">First, with less than a few hundred mutations, sampling variance becomes a significant factor in reliably identifying signatures. Therefore, the fitting scheme should be aware of the sampling variance, which is especially pronounced in low mutation count scenarios (WES or cancer types with low mutation burden). Ideally, the tool should be able to attribute the signatures by flexibly inferring the underlying true mutation distribution given the sampling variance and the signature-fitting performance. Second, the large number of available signatures necessitates a proper variable selection, especially with a limited amount of observed data. Signature studies on large-scale cancer data sets have revealed that mutational signatures are not all active in one sample or cancer type; in most tumor cases, only a few signatures prevail. A recent signature summary suggested that 2–13 known signatures are observed in a given cancer type (based on 30 COSMIC signatures), which might include hundreds and even thousands of samples. Therefore, sparse solutions are in line with previous de novo studies, and are biologically sound and interpretable. In addition, sparse solutions can give better predictions owing to lower estimator variance. Third, a desirable method should be parameterized according to the data complexity to achieve optimum fitting. Finally, mutational signatures are not orthogonal owing to their biological nature. Collinearity of the signatures will lead to unstable fittings that change erratically with even a slight perturbation of the observation.</p>
    <p id="Par41">deconstructSigs was the first tool that could identify signatures even in a single tumor. Instead of regression, this tool uses binary search to iteratively tune coefficients. To achieve sparsity, deconstructSigs performs post hoc pruning with a preset 6% cutoff value. The mutation spectrum is normalized before fitting, thus making mutation counts invariant to the model. Moreover, the binary search operates on unbounded coefficients and uses a hardcoded upper and lower bounds, which provides no guarantee of finding the optimal solution. Finally, the greedy nature of stepwise coefficient tuning is prone to eliminating valuable predictors in later steps that are correlated with previously selected ones<sup><xref ref-type="bibr" rid="CR23">23</xref></sup>.</p>
    <p id="Par42">Here, we describe sigLASSO, which simultaneously optimizes both the sampling process and an L1 regularized signature fitting. By explicitly formulating a multinomial sampling likelihood into the optimization, we designed sigLASSO to take into account the sampling variance. Meanwhile, sigLASSO uses the L1 norm to penalize the coefficients, thus achieving effective variable selection and promoting sparsity. By fine-tuning the penalizing terms using prior biological knowledge, sigLASSO is able to further exploit previous signature studies from large cohorts and promote signatures that are believed to be active in a soft thresholding manner.</p>
    <p id="Par43">Jointly optimizing a mutation sampling process enables sigLASSO to be aware of the sampling variance. By additionally modeling an auxiliary multinomial sampling process and corresponding distribution, we demonstrated that sigLASSO achieves better and more stable signature attribution, especially in cases with low mutation counts. In cancer research, WES data are abundant, but it also suffers from undersampling in signature attribution. In these cases, sigLASSO generates more reliable and robust solutions. We showcase the successful application of sigLASSO on 8893 TCGA WES samples. Overall, sigLASSO achieves better sparsity than deconstructSigs and promote structures in the previous signature studies by injecting priors into the optimization process. The final signature distribution of neither sigLASSO nor deconstructSigs is identical to the original signature studies, which is probably owing to biases in the original signature discovery, sequencing/variants calling, and unknown hypermutational processes. We noticed deconstructSigs assigned signatures to 100% of the mutations in most samples, while in sigLASSO assignment fraction correlated with cancer types. This abstain pattern indicates the presence of potentially unknown signatures and cancer subtypes.</p>
    <p id="Par44">As the cost of WGS drops rapidly, we expect an even greater number of cancer samples to be sequenced<sup><xref ref-type="bibr" rid="CR24">24</xref></sup>. The vast amount of cancer genomics data will give scientists larger power to discern unknown or rare signatures. The growing number of signatures will eventually make the signature matrix underdetermined (when <italic>k</italic> &gt; 96, i.e., the number of possible mutational trinucleotide contexts). A traditional simple solver method would give infinitude (noiseless) or unstable (noisy) solutions in this underdetermined linear system. However, by assuming the solution is sparse, we were able to apply regularization to achieve a simpler, sparser, and more stable solution. Furthermore, sigLASSO is very efficient and thus able to handle a larger number of samples and signatures, as well as hyperparameter optimization.</p>
    <p id="Par45">Moreover, sigLASSO does not specify a noise level explicitly beforehand, but instead empirically tunes parameters based on model performance. By contrast, deconstructSigs specifies a noise level of 0.05 to derive a cutoff of 0.06 to achieve sparsity. In general, sigLASSO lets the data itself control the model complexity and leave any post hoc filtering to users. Abstention is a desired trait in machine learning models. In addition to the objectives, the model learns what it knows and what it does not (KWIK: Knows What It Knows),<sup><xref ref-type="bibr" rid="CR25">25</xref></sup> In both subsampling and simulation experiments, sigLASSO is able to abstain under high uncertainty, providing solutions with consistently high precision and robustness under various scenarios.</p>
    <p id="Par46">Next, owing to the collinearity nature of signatures, pure mathematical optimization might lead algorithms to select wrong signatures that are highly correlated with truly active ones. To overcome this problem, sigLASSO allows researchers to incorporate domain knowledge to guide signature identification. This input could be cancer type-specific signatures or patient clinical information (e.g., smoking history or chemotherapy). Furthermore, we transformed the binary classification (active or inactive) to a continuous space, with weights indicating the strength of the prior. These weights could be effectively learned using patient information or other assays (e.g., RNA sequencing or methylation arrays). Moreover, sigLASSO can adapt to sparsity promoting schemes in de novo discovery tools through priors. For example, SparseSignatures<sup><xref ref-type="bibr" rid="CR12">12</xref></sup> also uses L1 regularization but does not penalize on background signatures. sigLASSO could use this piece of information in its priors to better assign signatures when working together with SparseSignatures. We showcased the performance of sigLASSO on real cancer data sets. Although we lack the ground truth of the operative mutational signatures in tumors, we have several reasonable beliefs about the signature solution. sigLASSO produced signature solutions that are biologically interpretable, properly align with our current knowledge about mutational signatures, and well distinguish cancer types and histological subtypes.</p>
    <p id="Par47">We also implemented elastic net with hyperparameter optimization in sigLASSO. Elastic net blends L2 with L1 regularization and in principle demonstrates better performance and stability than LASSO on strongly correlated features<sup><xref ref-type="bibr" rid="CR26">26</xref></sup>. We found that elastic net did not improve the performance (measured as meaningful reduction in MSE in cross-validation) in our simulations using the current 30 COSMIC signatures, likely because the correlations between them are not too high. However, with more cancer samples sequenced every day, researchers will gain power to discern highly correlated mutational processes and grow the size of the signature set significantly. Therefore, elastic net might be beneficial in the near future.</p>
    <p id="Par48">Finally, sigLASSO uses quadratic loss, which follows the previous de novo studies<sup><xref ref-type="bibr" rid="CR2">2</xref>,<xref ref-type="bibr" rid="CR3">3</xref>,<xref ref-type="bibr" rid="CR5">5</xref></sup>. By doing so, sigLASSO is unbiased in detecting signatures in cancer samples. Nonetheless, the initial discovery suffers from several limitations. First, the actual number of mutational processes is likely higher than 30, the current number of COSMIC signatures. This is because the power of the de novo discovery is bounded by the amount of available data. Second, the nature of mutagenesis leads to some mutational processes being more prevalent than others. Some of the signatures are cancer type specific. The original signature discovery did not use a balanced data set with equal numbers of cancer types. Third, the original NMF objective function employs quadratic loss, which might lead to bias towards flat signatures over spiky ones. In addition to the original NMF approach, researchers have proposed other decomposition methods for signature discovery. For example, SomaticSignatures<sup><xref ref-type="bibr" rid="CR27">27</xref></sup> uses PCA. Because the loss function is also quadratic, we expect sigLASSO to work seamlessly with SomaticSignatures.</p>
    <p id="Par49">Our simulation reveals that sigLASSO does not have a discernable preference to assign to either spiky or smooth signatures (Supplementary Figure <xref rid="MOESM1" ref-type="media">12</xref>). However, we found that the signature distribution from sigLASSO and deconstructSigs cannot be fully explained by the current signature knowledge. Further research probing the biological foundation of the signatures and quantifying biological priors will help advance our understanding and improve the interpretability of signature assignments. Meanwhile, as there are still many unsolved issues in signature discovery, we advocate that sigLASSO should also be used with discretion and its results interpreted cautiously.</p>
    <p id="Par50">sigLASSO exploits the previously overlooked mutation sampling uncertainty and formulates a framework that jointly optimizes the objective (i.e., signature fitting with L1 regularization) and the sampling likelihood. In biological experiments, low-count observations on discrete variables are common. For example, in single cell RNA sequencing (scRNAseq), the measured discrete mRNA counts are often very low or even zero (owing to undersampling). Our joint optimization approach could have further implications in these scenarios. We, indeed, find some similar work in scRNAseq<sup><xref ref-type="bibr" rid="CR28">28</xref>,<xref ref-type="bibr" rid="CR29">29</xref></sup>. Another method for de novo signature discover, EMu, formulates the discreet mutational process as a Poisson generative model<sup><xref ref-type="bibr" rid="CR30">30</xref></sup>. When the total mutational count is fixed, such a Poisson generative model is equivalent to our multinomial sampling process. Our work also could be extended to mutagenesis modeling and parameter estimation—for example, in estimating the nucleotide-specific background mutation rate in cancer.</p>
  </sec>
  <sec id="Sec13">
    <title>Methods</title>
    <sec id="Sec14">
      <title>Optimizing sigLASSO</title>
      <p id="Par51">The negative log-likelihood is convex in respect to both <inline-formula id="IEq23"><alternatives><tex-math id="M51">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\vec{p}$$\end{document}</tex-math><mml:math id="M52"><mml:mover accent="true"><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mo>→</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="41467_2020_17388_Article_IEq23.gif"/></alternatives></inline-formula> and <inline-formula id="IEq24"><alternatives><tex-math id="M53">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\vec{w}$$\end{document}</tex-math><mml:math id="M54"><mml:mover accent="true"><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mo>→</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="41467_2020_17388_Article_IEq24.gif"/></alternatives></inline-formula> when evaluated individually. Hence, the loss function is biconvex. Instead of using a generic optimizer, we exploited the biconvex nature of this problem and effectively optimized the function by using alternative convex search, which iteratively updates these two variables<sup><xref ref-type="bibr" rid="CR31">31</xref></sup>.</p>
      <sec id="FPar1">
        <title>Algorithm 1.</title>
        <p id="Par52">sigLASSO algorithm<table-wrap id="Taba"><table frame="hsides" rules="groups"><tbody><tr><td>1: initialization: <inline-formula id="IEq25"><alternatives><tex-math id="M55">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${p}_{i}^{0}\leftarrow {p}_{i}^{mle}=\frac{{m}_{i}}{\sum\nolimits_{i = 1}^{n}{m}_{i}}$$\end{document}</tex-math><mml:math id="M56"><mml:msubsup><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msubsup><mml:mo>←</mml:mo><mml:msubsup><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mi>l</mml:mi><mml:mi>e</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msubsup><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:math><inline-graphic xlink:href="41467_2020_17388_Article_IEq25.gif"/></alternatives></inline-formula>; <italic>t</italic> ← 0</td></tr><tr><td>2: <bold>while</bold>
<italic>t</italic> &lt; <italic>t</italic><sub><italic>m</italic><italic>a</italic><italic>x</italic></sub>
<bold>do</bold></td></tr><tr><td>3:  <inline-formula id="IEq26"><alternatives><tex-math id="M57">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\vec{w}}^{t+1}\leftarrow \mathop{{\rm{argmax}}}\limits_{}\frac{\alpha }{2}\sum\limits_{i=1}^{n}{\left({p}_{i}^{t}-\sum\limits_{k = 1}^{K}{s}_{ik}{w}_{k}\right)^{2}}-\lambda \sum\limits_{k=1}^{K}{c}_{k}{w}_{k}$$\end{document}</tex-math><mml:math id="M58"><mml:msup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mo>→</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>←</mml:mo><mml:munder><mml:mrow><mml:mi mathvariant="normal">argmax</mml:mi></mml:mrow><mml:mrow/></mml:munder><mml:mfrac><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:munderover><mml:msup><mml:mrow><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msubsup><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>K</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>−</mml:mo><mml:mi>λ</mml:mi><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>K</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2020_17388_Article_IEq26.gif"/></alternatives></inline-formula></td></tr><tr><td>                        (<inline-formula id="IEq27"><alternatives><tex-math id="M59">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\vec{w}$$\end{document}</tex-math><mml:math id="M60"><mml:mover accent="true"><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mo>→</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="41467_2020_17388_Article_IEq27.gif"/></alternatives></inline-formula>-step)</td></tr><tr><td>4:  <inline-formula id="IEq28"><alternatives><tex-math id="M61">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\vec{p}}^{t+1}\leftarrow {{\rm{argmax}}}\sum\limits_{i=1}^{n}\left\{{m}_{i}{\mathrm{log}}\,{p}_{i}-\frac{\alpha }{2}{\left({p}_{i}-\sum\limits_{k = 1}^{K}{s}_{ik}{w}_{k}^{t+1}\right)^{2}}\right\}$$\end{document}</tex-math><mml:math id="M62"><mml:msup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mo>→</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>←</mml:mo><mml:mi mathvariant="normal">argmax</mml:mi><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:munderover><mml:mfenced close="}" open="{" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mi mathvariant="normal">log</mml:mi><mml:mspace width="0.25em"/><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac><mml:msup><mml:mrow><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>K</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="41467_2020_17388_Article_IEq28.gif"/></alternatives></inline-formula></td></tr><tr><td>                        (<inline-formula id="IEq29"><alternatives><tex-math id="M63">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\vec{p}$$\end{document}</tex-math><mml:math id="M64"><mml:mover accent="true"><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mo>→</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="41467_2020_17388_Article_IEq29.gif"/></alternatives></inline-formula>-step)</td></tr><tr><td>5:  if<inline-formula id="IEq30"><alternatives><tex-math id="M65">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\parallel {\vec{p}}^{t+1}-{\vec{p}}^{t}{\parallel }_{2}^{2}&lt;\epsilon$$\end{document}</tex-math><mml:math id="M66"><mml:mo>∥</mml:mo><mml:msup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mo>→</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>−</mml:mo><mml:msup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mo>→</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msup><mml:msubsup><mml:mrow><mml:mo>∥</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>&lt;</mml:mo><mml:mi>ϵ</mml:mi></mml:math><inline-graphic xlink:href="41467_2020_17388_Article_IEq30.gif"/></alternatives></inline-formula>
<bold>then</bold></td></tr><tr><td>6:   <bold>break</bold></td></tr><tr><td>7:   <italic>t</italic> ← <italic>t</italic> + 1</td></tr><tr><td>8: <bold>return</bold>
<inline-formula id="IEq31"><alternatives><tex-math id="M67">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\vec{w}}^{t+1}$$\end{document}</tex-math><mml:math id="M68"><mml:msup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mo>→</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="41467_2020_17388_Article_IEq31.gif"/></alternatives></inline-formula></td></tr></tbody></table></table-wrap></p>
        <p>Specifically, to begin the iteration, we initialized <inline-formula id="IEq32"><alternatives><tex-math id="M69">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\vec{p}$$\end{document}</tex-math><mml:math id="M70"><mml:mover accent="true"><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mo>→</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="41467_2020_17388_Article_IEq32.gif"/></alternatives></inline-formula> using MLE. We started with the <inline-formula id="IEq33"><alternatives><tex-math id="M71">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\vec{w}-$$\end{document}</tex-math><mml:math id="M72"><mml:mover accent="true"><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mo>→</mml:mo></mml:mover><mml:mo>−</mml:mo></mml:math><inline-graphic xlink:href="41467_2020_17388_Article_IEq33.gif"/></alternatives></inline-formula>step, which is a non-negative linear LASSO regression that can be efficiently solved by glmnet.<sup><xref ref-type="bibr" rid="CR14">14</xref> </sup><italic>λ</italic> is parameterized empirically.</p>
        <p>Next, we solved the <inline-formula id="IEq34"><alternatives><tex-math id="M73">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\vec{p}$$\end{document}</tex-math><mml:math id="M74"><mml:mover accent="true"><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mo>→</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="41467_2020_17388_Article_IEq34.gif"/></alternatives></inline-formula> with a Lagrange multiplier to maintain the linear summation constraint <inline-formula id="IEq35"><alternatives><tex-math id="M75">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathop{\sum }\nolimits_{i = 1}^{n}{p}_{i}=1$$\end{document}</tex-math><mml:math id="M76"><mml:msubsup><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msubsup><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:math><inline-graphic xlink:href="41467_2020_17388_Article_IEq35.gif"/></alternatives></inline-formula>. The non-negative constraint of <sub><italic>pi</italic></sub> is satisfied by only retaining the non-negative root of the solution.</p>
        <p>Intuitively, in the <inline-formula id="IEq36"><alternatives><tex-math id="M77">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\vec{p}-$$\end{document}</tex-math><mml:math id="M78"><mml:mover accent="true"><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mo>→</mml:mo></mml:mover><mml:mo>−</mml:mo></mml:math><inline-graphic xlink:href="41467_2020_17388_Article_IEq36.gif"/></alternatives></inline-formula>step, we tried to estimate <inline-formula id="IEq37"><alternatives><tex-math id="M79">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\vec{p}$$\end{document}</tex-math><mml:math id="M80"><mml:mover accent="true"><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mo>→</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="41467_2020_17388_Article_IEq37.gif"/></alternatives></inline-formula> by optimizing the multinomial likelihood while constraining it to be not too far away from the fitted <inline-formula id="IEq38"><alternatives><tex-math id="M81">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\vec{p}$$\end{document}</tex-math><mml:math id="M82"><mml:mover accent="true"><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mo>→</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="41467_2020_17388_Article_IEq38.gif"/></alternatives></inline-formula>. If we only used the point MLE of <inline-formula id="IEq39"><alternatives><tex-math id="M83">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\vec{p}$$\end{document}</tex-math><mml:math id="M84"><mml:mover accent="true"><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mo>→</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="41467_2020_17388_Article_IEq39.gif"/></alternatives></inline-formula> based on sampling and did not perform the <inline-formula id="IEq40"><alternatives><tex-math id="M85">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\vec{p}-$$\end{document}</tex-math><mml:math id="M86"><mml:mover accent="true"><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mo>→</mml:mo></mml:mover><mml:mo>−</mml:mo></mml:math><inline-graphic xlink:href="41467_2020_17388_Article_IEq40.gif"/></alternatives></inline-formula>step, the model would assume the sampling is perfect and become insensitive to the total mutation counts. The trade-off in the <inline-formula id="IEq41"><alternatives><tex-math id="M87">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\vec{p}-$$\end{document}</tex-math><mml:math id="M88"><mml:mover accent="true"><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mo>→</mml:mo></mml:mover><mml:mo>−</mml:mo></mml:math><inline-graphic xlink:href="41467_2020_17388_Article_IEq41.gif"/></alternatives></inline-formula>step between the multinomial likelihood and the square loss reflects the sampling error. The sampling size (sum of <italic>m</italic><sub><italic>i</italic></sub>), the goodness of the signature fit (as reflected in <italic>α</italic>), and the overall shapes of <inline-formula id="IEq42"><alternatives><tex-math id="M89">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\vec{p}$$\end{document}</tex-math><mml:math id="M90"><mml:mover accent="true"><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mo>→</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="41467_2020_17388_Article_IEq42.gif"/></alternatives></inline-formula> all affect the tension between sampling and linear fitting.</p>
      </sec>
    </sec>
    <sec id="Sec15">
      <title>Optimizing the <inline-formula id="IEq43"><alternatives><tex-math id="M91">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\overrightarrow{p}$$\end{document}</tex-math><mml:math id="M92"><mml:mover accent="true"><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mo>→</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="41467_2020_17388_Article_IEq43.gif"/></alternatives></inline-formula>-step</title>
      <p id="Par56">In the <inline-formula id="IEq44"><alternatives><tex-math id="M93">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\vec{p}$$\end{document}</tex-math><mml:math id="M94"><mml:mover accent="true"><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mo>→</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="41467_2020_17388_Article_IEq44.gif"/></alternatives></inline-formula>-step, we tried to solve the following problem with <inline-formula id="IEq45"><alternatives><tex-math id="M95">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\tilde{{p}_{i}}$$\end{document}</tex-math><mml:math id="M96"><mml:mover accent="true"><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mo>~</mml:mo></mml:mrow></mml:mover></mml:math><inline-graphic xlink:href="41467_2020_17388_Article_IEq45.gif"/></alternatives></inline-formula> from the <inline-formula id="IEq46"><alternatives><tex-math id="M97">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\vec{w}-$$\end{document}</tex-math><mml:math id="M98"><mml:mover accent="true"><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mo>→</mml:mo></mml:mover><mml:mo>−</mml:mo></mml:math><inline-graphic xlink:href="41467_2020_17388_Article_IEq46.gif"/></alternatives></inline-formula>step.<disp-formula id="Equ4"><label>4</label><alternatives><tex-math id="M99">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{array}{l}\vec{p}=\mathop{{\rm{argmax}}}\limits_{}\mathop{\sum }\limits_{i = 1}^{n}\{{m}_{i}\mathrm{log}\,{p}_{i}-\frac{\alpha }{2}{({p}_{i}-\tilde{{p}_{i}})}^{2}\}\\ \,{\rm{s}}.{\rm{t}}.\forall {p}_{i}\ge 0,\mathop{\sum }\limits_{i = 1}^{n}{p}_{i}=1,\tilde{{p}_{i}}=\mathop{\sum }\limits_{k = 1}^{K}{s}_{ik}{w}_{k}\end{array}$$\end{document}</tex-math><mml:math id="M100"><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mover accent="true"><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mo>→</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mi mathvariant="normal">argmax</mml:mi></mml:mrow><mml:mrow/></mml:munder><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:munderover><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mi mathvariant="normal">log</mml:mi><mml:mspace width="0.25em"/><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mover accent="true"><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mo>~</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mspace width="0.25em"/><mml:mi mathvariant="normal">s</mml:mi><mml:mo>.</mml:mo><mml:mi mathvariant="normal">t</mml:mi><mml:mo>.</mml:mo><mml:mo>∀</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>≥</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mover accent="true"><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mo>~</mml:mo></mml:mrow></mml:mover><mml:mo>=</mml:mo><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>K</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="41467_2020_17388_Article_Equ4.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par57">We added the Lagrangian multiplier <italic>Λ</italic> to satisfy the linear constraint of <inline-formula id="IEq47"><alternatives><tex-math id="M101">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathop{\sum }\nolimits_{i = 1}^{n}{p}_{i}=1$$\end{document}</tex-math><mml:math id="M102"><mml:msubsup><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msubsup><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:math><inline-graphic xlink:href="41467_2020_17388_Article_IEq47.gif"/></alternatives></inline-formula> and took the derivatives with respect to <inline-formula id="IEq002"><alternatives><tex-math id="M103">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p_i$$\end{document}</tex-math><mml:math id="M104"><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2020_17388_Article_IEq002.gif"/></alternatives></inline-formula> (<italic>i</italic> = 1, 2. . . <italic>n</italic>) and <italic>Λ</italic>. This resulted in <italic>n</italic> + 1 equations.<disp-formula id="Equ5"><label>5</label><alternatives><tex-math id="M105">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{array}{l}{p}_{1}^{2}-\left(\frac{\Lambda }{\alpha }+\tilde{{p}_{1}}\right){p}_{1}-\frac{{m}_{1}}{\alpha }=0\\ \ldots \\ {p}_{i}^{2}-\left(\frac{\Lambda }{\alpha }+\tilde{{p}_{i}}\right){p}_{i}-\frac{{m}_{i}}{\alpha }=0\\ \ldots \\ {p}_{n}^{2}-\left(\frac{\Lambda }{\alpha }+\tilde{{p}_{n}}\right){p}_{n}-\frac{{m}_{n}}{\alpha }=0\\ \mathop{\sum }\limits_{i = 1}^{n}{p}_{i}=1\end{array}$$\end{document}</tex-math><mml:math id="M106"><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:msubsup><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">Λ</mml:mi></mml:mrow><mml:mrow><mml:mi>α</mml:mi></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mover accent="true"><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mo>~</mml:mo></mml:mrow></mml:mover></mml:mrow></mml:mfenced><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>α</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mo>…</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:msubsup><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">Λ</mml:mi></mml:mrow><mml:mrow><mml:mi>α</mml:mi></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mover accent="true"><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mo>~</mml:mo></mml:mrow></mml:mover></mml:mrow></mml:mfenced><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>α</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mo>…</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:msubsup><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">Λ</mml:mi></mml:mrow><mml:mrow><mml:mi>α</mml:mi></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mover accent="true"><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mo>~</mml:mo></mml:mrow></mml:mover></mml:mrow></mml:mfenced><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>α</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="41467_2020_17388_Article_Equ5.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par58">The roots of the first <italic>n</italic> quadratic equations are given by<disp-formula id="Equ6"><label>6</label><alternatives><tex-math id="M107">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${p}_{i}=\frac{(\tilde{{p}_{i}}+\frac{\Lambda }{\alpha })\pm \sqrt{{(\tilde{{p}_{i}}+\frac{\Lambda }{\alpha })}^{2}+4\frac{{m}_{i}}{\alpha }}}{2}$$\end{document}</tex-math><mml:math id="M108"><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mover accent="true"><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mo>~</mml:mo></mml:mrow></mml:mover><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">Λ</mml:mi></mml:mrow><mml:mrow><mml:mi>α</mml:mi></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>±</mml:mo><mml:msqrt><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mover accent="true"><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mo>~</mml:mo></mml:mrow></mml:mover><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">Λ</mml:mi></mml:mrow><mml:mrow><mml:mi>α</mml:mi></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:mn>4</mml:mn><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>α</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:msqrt></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac></mml:math><graphic xlink:href="41467_2020_17388_Article_Equ6.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par59"><italic>α</italic> = 1/<italic>σ</italic><sup>2</sup> is strictly positive and <italic>m</italic><sub><italic>i</italic></sub> is non-negative. Therefore, if <italic>m</italic><sub><italic>i</italic></sub> = 0, there exists only one zero root and <inline-formula id="IEq003"><alternatives><tex-math id="M109">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p_i$$\end{document}</tex-math><mml:math id="M110"><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2020_17388_Article_IEq003.gif"/></alternatives></inline-formula>  = 0 iff. <italic>m</italic><sub><italic>i</italic></sub> = 0. If <italic>m</italic><sub><italic>i</italic></sub> &gt; 0, there is exactly one negative and one positive root. Because we required  ∀<inline-formula id="IEq004"><alternatives><tex-math id="M111">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p_i$$\end{document}</tex-math><mml:math id="M112"><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2020_17388_Article_IEq004.gif"/></alternatives></inline-formula> ≥ 0, we only kept the positive root. The second derivative of the log-likelihood is <inline-formula id="IEq48"><alternatives><tex-math id="M113">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$-\frac{{m}_{i}}{{p}_{i}}-\alpha$$\end{document}</tex-math><mml:math id="M114"><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>−</mml:mo><mml:mi>α</mml:mi></mml:math><inline-graphic xlink:href="41467_2020_17388_Article_IEq48.gif"/></alternatives></inline-formula>, which is strictly negative. Therefore, the root we found is a non-negative maximum.</p>
      <p id="Par60">We plugged all the roots into the last equation (i.e., the linear constraint) and used the R function uniroot() to solve <italic>Λ</italic>.</p>
    </sec>
    <sec id="Sec16">
      <title>Parameter tuning</title>
      <p id="Par61">We tuned <italic>λ</italic> by repeatedly splitting the nucleotide contexts into training and testing sets and testing the performance. Because mutations of the same single-nucleotide substitution context are often correlated, we split the data set into eight subsets. Each subset contained two of each single-nucleotide substitution. We then held one subset as the testing data set and only fit the signatures on the remaining ones. After circling all eight subsets and repeating the process 20 times, we used the largest <italic>λ</italic> (which leads to a sparser solution) that gave an MSE 0.5 or 1 SD from the minimum MSE. <italic>λ</italic> was tuned whenever <inline-formula id="IEq49"><alternatives><tex-math id="M115">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\vec{p}$$\end{document}</tex-math><mml:math id="M116"><mml:mover accent="true"><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mo>→</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="41467_2020_17388_Article_IEq49.gif"/></alternatives></inline-formula> deviated far from the estimation from the previous round. By adaptively learning <inline-formula id="IEq50"><alternatives><tex-math id="M117">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\vec{p}$$\end{document}</tex-math><mml:math id="M118"><mml:mover accent="true"><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mo>→</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="41467_2020_17388_Article_IEq50.gif"/></alternatives></inline-formula>, sigLASSO avoids overestimating the errors in the signature fitting and thus allows a higher fraction of mutations to be assigned with signatures. We fixed <italic>λ</italic> when the deviation was small to avoid the inherited randomness in subsetting affecting convergence.</p>
      <p id="Par62"><italic>α</italic> = 1/<italic>σ</italic><sup>2</sup>, <italic>σ</italic><sup>2</sup> is estimated using <inline-formula id="IEq51"><alternatives><tex-math id="M119">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\sigma }^{2}=\frac{SSE}{(n-k)}$$\end{document}</tex-math><mml:math id="M120"><mml:msup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>S</mml:mi><mml:mi>S</mml:mi><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>n</mml:mi><mml:mo>−</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:math><inline-graphic xlink:href="41467_2020_17388_Article_IEq51.gif"/></alternatives></inline-formula>, where <italic>k</italic> is the number of non-zero coefficients in the LASSO estimator and SSE is the sum of squared errors<sup><xref ref-type="bibr" rid="CR32">32</xref></sup>. sigLASSO updates <italic>α</italic> after every LASSO linear fitting step. To avoid grossly overestimating <italic>σ</italic><sup>2</sup> (thus underestimating <italic>α</italic>) in the initial steps when <inline-formula id="IEq52"><alternatives><tex-math id="M121">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\vec{p}$$\end{document}</tex-math><mml:math id="M122"><mml:mover accent="true"><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mo>→</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="41467_2020_17388_Article_IEq52.gif"/></alternatives></inline-formula> is far from the optimum, we set a minimum <italic>α</italic> value. In addition, because in practice factors such as unknown signatures violate the assumptions of linear signature regression, <italic>α</italic> tends to get overestimated. So we multiplied it by a confidence factor that represents how confident we are about the goodness of the signature fit. By default, we set min <italic>α</italic> = 400 and the confidence factor to 0.1. Users can further tune these values based on the strength of prior belief of noise level and confidence level of the signature model.</p>
    </sec>
    <sec id="Sec17">
      <title>Option for elastic net</title>
      <p id="Par63">Adding an L2 regularizer (i.e., elastic net) might improve and stabilize the performance when variables are highly correlated<sup><xref ref-type="bibr" rid="CR26">26</xref></sup>. Therefore, we also implemented elastic net in sigLASSO. The objective function then became:<disp-formula id="Equ7"><label>7</label><alternatives><tex-math id="M123">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\ell =\mathop{\sum }\limits_{i = 1}^{n}\left\{{m}_{i}\mathrm{log}\,{p}_{i}-\frac{\alpha }{2}{\left({p}_{i}-\mathop{\sum }\limits_{k = 1}^{K}{s}_{ik}{w}_{k}\right)}^{2}\right\}-\lambda \mathop{\sum }\limits_{k = 1}^{K}{c}_{k}(\gamma {w}_{k}+(1-\gamma ){w}_{k}^{2})$$\end{document}</tex-math><mml:math id="M124"><mml:mi>ℓ</mml:mi><mml:mo>=</mml:mo><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:munderover><mml:mfenced close="}" open="{" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mi mathvariant="normal">log</mml:mi><mml:mspace width="0.25em"/><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac><mml:msup><mml:mrow><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>K</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfenced><mml:mo>−</mml:mo><mml:mi>λ</mml:mi><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>K</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>γ</mml:mi><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>γ</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:msubsup><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math><graphic xlink:href="41467_2020_17388_Article_Equ7.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par64">We tuned the hyperparameter <italic>γ</italic> by grid search together with <italic>λ</italic>. We always picked the largest <italic>γ</italic> and the largest <italic>λ</italic> (for better sparsity) that gave an MSE that was 0.5 SD from the minimal MSE. In simulations, we did not find that introducing L2 regularization added additional benefits. The model gave almost identical solutions to using L1 only. Nonetheless, we kept elastic net as an option in highly correlated signature scenarios to the user in our implementation.</p>
    </sec>
    <sec id="Sec18">
      <title>Data simulation and model evaluation</title>
      <p id="Par65">We downloaded 30 previously identified COSMIC signatures v2 (<ext-link ext-link-type="uri" xlink:href="http://cancer.sanger.ac.uk/cosmic/signatures">http://cancer.sanger.ac.uk/cosmic/signatures</ext-link>). We created a simulated data set by randomly and uniformly drawing two to eight signatures and corresponding weights (minimum: 0.02). The reason for picking up to eight signatures is because (1) empirically, in cancer signature studies, most samples have only a few signatures. (2) We further confirmed the sparsity of signatures by running deconstructSigs on large-scale TCGA data and found 99.96% samples got assigned with eight or less signatures. (3) Moreover, biologically, we believe that it is unreasonable for more than eight of the processes to act simultaneously in one sample. Many of these processes describe biological disjoint conditions, e.g., smoke, UV radiation and tissue-specific cellular processes. We simulated additive Gaussian noise at various levels with a positive normal distribution of up to 25 (1–25, uniformly drawn) randomly selected trinucleotide contexts. Then, we summed all the signatures and noise to form a mutation distribution. We sample mutations from this distribution with different mutation counts.</p>
      <p id="Par66">We ran deconstructSigs according to the original publication<sup><xref ref-type="bibr" rid="CR8">8</xref></sup> and sigLASSO, both with and without prior knowledge of the underlying signature. To evaluate their performance, we compared the inferred signature distribution with the simulated distribution and calculated MSE. We also measured the number of false positive and false negative signatures in the solution (support recovery).</p>
    </sec>
    <sec id="Sec19">
      <title>Illustrating sigLASSO on 8893 TCGA samples</title>
      <p id="Par67">To assess the performance of our method on real-world cancer data sets, we used somatic mutations from 33 cancer types from TCGA. We downloaded MAF files from the Genomic Data Commons Data Portal (<ext-link ext-link-type="uri" xlink:href="https://portal.gdc.cancer.gov/">https://portal.gdc.cancer.gov/</ext-link>). A detailed list of files used in this study can be found in Supplementary Table <xref rid="MOESM1" ref-type="media">1</xref>.</p>
      <p id="Par68">We extracted prior knowledge on active signatures in various cancer types from a previous pan-cancer signature analysis (<ext-link ext-link-type="uri" xlink:href="http://cancer.sanger.ac.uk/cosmic/signatures">http://cancer.sanger.ac.uk/cosmic/signatures</ext-link>).</p>
    </sec>
    <sec id="Sec20">
      <title>sigLASSO software suite</title>
      <p id="Par69">sigLASSO is implemented as an R package “siglasso”. It accepts processed mutational spectrums and VCF files. We provided functions to parse mutational spectrums from VCF files as well as some visualization methods in the package. “siglasso” allows users to specify biological priors (i.e., signatures that should be active or inactive) and their weights. “siglasso” uses 30 COSMIC signatures by default. Users are also given the option to supply customized signature files. It is computationally efficient; using default settings, the program can successfully decompose a whole genome sequencing (WGS) cancer sample in less than a few seconds on a regular laptop. For time profiling purposes, we ran siglasso and deconstructSigs on an Intel Xeon E5-2660 (2.60 GHz) CPU. We employed the R package “microbenchmark” to profile the function call siglasso() and whichSignatures(). For each setup, we generated 100 noiseless simulated data sets and repeated the process 100 times for each evaluation.</p>
      <p id="Par70">We made siglasso source code available at <ext-link ext-link-type="uri" xlink:href="http://github.com/gersteinlab/siglasso">http://github.com/gersteinlab/siglasso</ext-link>.</p>
    </sec>
    <sec id="Sec21">
      <title>Evaluation criteria for signature assignment</title>
      <p id="Par71">One of the limitations of cancer signature research is that the ground truth of real samples typically cannot be obtained. Previous large-scale signature studies have relied largely on mutagen exposure association from patient records and biochemical knowledge on mutagenesis. Here, besides using simulation, we illustrated the outputs of different models and compared the results on real data set with existing signature knowledge and distributions. Although no gold standard exists to evaluate the performance, we do have a few reasonable expectations about the solution:</p>
      <p id="Par72"><italic>Sparsity</italic>: one or more signature should be active in a given cancer sample and type. However, not all signatures should be active. A sparse distributed signature set among cancer samples and types is defined in previous de novo discovery studies. Any signature-fitting tool should follow and produce a similar signature distribution. Moreover, mutational processes are discrete in nature and tied with certain endogenous and environmental factors. An obvious example is that the UV signature should not exist in unexposed tissues. Existing signature-identifying methods aim to implicitly achieve sparse solutions by dropping signatures with small coefficients or pre-selecting a small signature subset for fitting.</p>
      <p id="Par73"><italic>The ability to abstain (decline to assign signatures to all mutations)</italic>: signature assignment issues are often undefined owing to collinearity of the signatures and a larger number of possible signatures. Overfitting is a serious concern, especially when the mutation counts are low (e.g., WXS or cancer genomes with fewer mutations) or the fitting is poor (e.g., unknown mutational process or sample contamination causing high noise). A good solution should refuse to fully assign signatures to every mutation when it does not have enough confidence to do so and, instead, defer to the human researchers to decide.</p>
      <p id="Par74"><italic>Robustness</italic>: solutions should be robust and reproducible. Signatures are not orthogonal, thus simple regression might lead to solutions that change erratically when a small perturbation is made in the observation. Moreover, the solution should reflect the level of ascertainment. Especially in WES, low mutation count is often a severe obstacle for assigning signatures owing to undersampling. In particular, under low mutation count, not all of the operative signatures would be reliably discovered. It is better to abstain under high uncertainty.</p>
      <p id="Par75"><italic>Biological interpretability</italic>: the solution should be biological interpretable. Because of the biological nature of collinearity in the signatures, simple mathematical optimization might pick the wrong signature. Researchers now tackle this problem by simply removing the majority of predictors they believe to be inactive. sigLASSO allows users to supply domain knowledge to guide the variable selection in a soft thresholding manner, leaving space for noise and rare or unknown signatures. For instance, we expected to find divergent signature distributions in different cancer types, which is reported in previous de novo discovery studies. Various tissues have divergent endogenous biological features, are exposed to diverse mutagens, and undergo mutagenesis in dissimilar fashions. Signature patterns should be able to distinguish between cancer types. This can be achieved by using different cancer type-specific priors.</p>
      <p id="Par76">These expectations are not quantitative, but they help direct us to recognize the most plausible solution as well as the less-favorable ones.</p>
    </sec>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary information</title>
    <sec id="Sec22">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="41467_2020_17388_MOESM1_ESM.pdf">
            <caption>
              <p>Supplementary Information</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM2">
          <media xlink:href="41467_2020_17388_MOESM2_ESM.pdf">
            <caption>
              <p>Peer Review File</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <fn-group>
    <fn>
      <p><bold>Peer review information</bold><italic>Nature Communications</italic> thanks Javier Herrero and the other, anonymous, reviewer(s) for their contribution to the peer review of this work. Peer reviewer reports are available.</p>
    </fn>
    <fn>
      <p><bold>Publisher’s note</bold> Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <sec>
    <title>Supplementary information</title>
    <p><bold>Supplementary information</bold> is available for this paper at 10.1038/s41467-020-17388-x.</p>
  </sec>
  <ack>
    <title>Acknowledgements</title>
    <p>This work was supported in part by NIH/NHGRI (1R01HG008126), NIH/NICHD (1DP2HD091799-01), A.L. Williams Professorship and the facilities and staffs of the Yale University Faculty of Arts and Sciences High Performance Computing Center. We thank Harrison Zhou, Cong Liang, Jinrui Xu, Diego Galeano, and Mengting Gu for helpful discussion.</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Author contributions</title>
    <p>S.L. and M.G. conceived and designed research. S.L. designed the algorithm, developed the software, and carried out experiments. S.L. and F.W.C. performed the theoretical analysis of the algorithm. S.L., F.W.C., and M.G. analyzed the results. S.L. and M.G. wrote the manuscript. M.G. supervised the study.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Data availability</title>
    <p>The data that support the findings of this study are avaiable from Genomic Data Commons Data Portal (<ext-link ext-link-type="uri" xlink:href="https://portal.gdc.cancer.gov/">https://portal.gdc.cancer.gov/</ext-link>). A detailed list of files used in this study can be found in Supplementary Table <xref rid="MOESM1" ref-type="media">1</xref>.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Code availability</title>
    <p>We make the code publicly available at <ext-link ext-link-type="uri" xlink:href="http://github.com/gersteinlab/siglasso">github.com/gersteinlab/siglasso</ext-link>.</p>
  </notes>
  <notes id="FPar2" notes-type="COI-statement">
    <title>Competing Interests</title>
    <p id="Par77">The authors declare no competing interests.</p>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nik-Zainal</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Mutational processes molding the genomes of 21 breast cancers</article-title>
        <source>Cell</source>
        <year>2012</year>
        <volume>149</volume>
        <fpage>979</fpage>
        <lpage>993</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2012.04.024</pub-id>
        <pub-id pub-id-type="pmid">22608084</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Alexandrov</surname>
            <given-names>LB</given-names>
          </name>
          <name>
            <surname>Nik-Zainal</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Wedge</surname>
            <given-names>DC</given-names>
          </name>
          <name>
            <surname>Campbell</surname>
            <given-names>PJ</given-names>
          </name>
          <name>
            <surname>Stratton</surname>
            <given-names>MR</given-names>
          </name>
        </person-group>
        <article-title>Deciphering signatures of mutational processes operative in human cancer</article-title>
        <source>Cell Rep.</source>
        <year>2013</year>
        <volume>3</volume>
        <fpage>246</fpage>
        <lpage>259</lpage>
        <pub-id pub-id-type="doi">10.1016/j.celrep.2012.12.008</pub-id>
        <pub-id pub-id-type="pmid">23318258</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Alexandrov</surname>
            <given-names>LB</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Signatures of mutational processes in human cancer</article-title>
        <source>Nature</source>
        <year>2013</year>
        <volume>500</volume>
        <fpage>415</fpage>
        <pub-id pub-id-type="doi">10.1038/nature12477</pub-id>
        <pub-id pub-id-type="pmid">23945592</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Helleday</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Eshtad</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Nik-Zainal</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Mechanisms underlying mutational signatures in human cancers</article-title>
        <source>Nat. Rev. Genet.</source>
        <year>2014</year>
        <volume>15</volume>
        <fpage>585</fpage>
        <pub-id pub-id-type="doi">10.1038/nrg3729</pub-id>
        <pub-id pub-id-type="pmid">24981601</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Alexandrov</surname>
            <given-names>LB</given-names>
          </name>
          <name>
            <surname>Stratton</surname>
            <given-names>MR</given-names>
          </name>
        </person-group>
        <article-title>Mutational signatures: the patterns of somatic mutations hidden in cancer genomes</article-title>
        <source>Curr. Opin. Genet. Dev.</source>
        <year>2014</year>
        <volume>24</volume>
        <fpage>52</fpage>
        <lpage>60</lpage>
        <pub-id pub-id-type="doi">10.1016/j.gde.2013.11.014</pub-id>
        <pub-id pub-id-type="pmid">24657537</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Petljak</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Alexandrov</surname>
            <given-names>LB</given-names>
          </name>
        </person-group>
        <article-title>Understanding mutagenesis through delineation of mutational signatures in human cancer</article-title>
        <source>Carcinogenesis</source>
        <year>2016</year>
        <volume>37</volume>
        <fpage>531</fpage>
        <lpage>540</lpage>
        <pub-id pub-id-type="doi">10.1093/carcin/bgw055</pub-id>
        <pub-id pub-id-type="pmid">27207657</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <mixed-citation publication-type="other">Covington, K., Shinbrot, E. &amp; Wheeler, D. A. Mutation signatures reveal biological processes in human cancer. <italic>bioRxiv036541</italic> (2016).</mixed-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rosenthal</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>McGranahan</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Herrero</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Taylor</surname>
            <given-names>BS</given-names>
          </name>
          <name>
            <surname>Swanton</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>Deconstructsigs: delineating mutational processes in single tumors distinguishes dna repair deficiencies and patterns of carcinoma evolution</article-title>
        <source>Genome Biol.</source>
        <year>2016</year>
        <volume>17</volume>
        <fpage>31</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-016-0893-4</pub-id>
        <pub-id pub-id-type="pmid">26899170</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Alexandrov</surname>
            <given-names>LB</given-names>
          </name>
          <name>
            <surname>Nik-Zainal</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Siu</surname>
            <given-names>HC</given-names>
          </name>
          <name>
            <surname>Leung</surname>
            <given-names>SY</given-names>
          </name>
          <name>
            <surname>Stratton</surname>
            <given-names>MR</given-names>
          </name>
        </person-group>
        <article-title>A mutational signature in gastric cancer suggests therapeutic strategies</article-title>
        <source>Nat. Commun.</source>
        <year>2015</year>
        <volume>6</volume>
        <fpage>8683</fpage>
        <pub-id pub-id-type="doi">10.1038/ncomms9683</pub-id>
        <pub-id pub-id-type="pmid">26511885</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rahbari</surname>
            <given-names>R</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Timing, rates and spectra of human germline mutation</article-title>
        <source>Nat. Genet.</source>
        <year>2016</year>
        <volume>48</volume>
        <fpage>126</fpage>
        <pub-id pub-id-type="doi">10.1038/ng.3469</pub-id>
        <pub-id pub-id-type="pmid">26656846</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Alexandrov</surname>
            <given-names>LB</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The repertoire of mutational signatures in human cancer</article-title>
        <source>Nature</source>
        <year>2020</year>
        <volume>578</volume>
        <fpage>94</fpage>
        <lpage>101</lpage>
        <pub-id pub-id-type="doi">10.1038/s41586-020-1943-3</pub-id>
        <pub-id pub-id-type="pmid">32025018</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <mixed-citation publication-type="other">Ramazzotti, D., Lal, A., Liu, K., Tibshirani, R. &amp; Sidow, A. De novo mutational signature discovery in tumor genomes using sparsesignatures. <italic>bioRxiv384834</italic> (2018).</mixed-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <mixed-citation publication-type="other">Tibshirani, R. Regression shrinkage and selection via the lasso. <italic>J. R. Statist. Soc. B</italic><bold>58</bold>, 267–288 (1996).</mixed-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <mixed-citation publication-type="other">Friedman, J., Hastie, T. &amp; Tibshirani, R. <italic>glmnet: Lasso and elastic-net regularized generalized linear models.</italic> R package version1 (2009).</mixed-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Alexandrov</surname>
            <given-names>LB</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Mutational signatures associated with tobacco smoking in human cancer</article-title>
        <source>Science</source>
        <year>2016</year>
        <volume>354</volume>
        <fpage>618</fpage>
        <lpage>622</lpage>
        <pub-id pub-id-type="doi">10.1126/science.aag0299</pub-id>
        <pub-id pub-id-type="pmid">27811275</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Viel</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A specific mutational signature associated with dna 8-oxoguanine persistence in mutyh-defective colorectal cancer</article-title>
        <source>EBioMedicine</source>
        <year>2017</year>
        <volume>20</volume>
        <fpage>39</fpage>
        <lpage>49</lpage>
        <pub-id pub-id-type="doi">10.1016/j.ebiom.2017.04.022</pub-id>
        <pub-id pub-id-type="pmid">28551381</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schulze</surname>
            <given-names>K</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Exome sequencing of hepatocellular carcinomas identifies new mutational signatures and potential therapeutic targets</article-title>
        <source>Nat. Genet.</source>
        <year>2015</year>
        <volume>47</volume>
        <fpage>505</fpage>
        <pub-id pub-id-type="doi">10.1038/ng.3252</pub-id>
        <pub-id pub-id-type="pmid">25822088</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Davies</surname>
            <given-names>H</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Hrdetect is a predictor of brca1 and brca2 deficiency based on mutational signatures</article-title>
        <source>Nat. Med.</source>
        <year>2017</year>
        <volume>23</volume>
        <fpage>517</fpage>
        <pub-id pub-id-type="doi">10.1038/nm.4292</pub-id>
        <pub-id pub-id-type="pmid">28288110</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Park</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Casella</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>The bayesian lasso</article-title>
        <source>J. Am. Stat. Assoc.</source>
        <year>2008</year>
        <volume>103</volume>
        <fpage>681</fpage>
        <lpage>686</lpage>
        <pub-id pub-id-type="doi">10.1198/016214508000000337</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zou</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>The adaptive lasso and its oracle properties</article-title>
        <source>J. Am. Stat. Assoc.</source>
        <year>2006</year>
        <volume>101</volume>
        <fpage>1418</fpage>
        <lpage>1429</lpage>
        <pub-id pub-id-type="doi">10.1198/016214506000000735</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Shuch</surname>
            <given-names>BM</given-names>
          </name>
          <name>
            <surname>Gerstein</surname>
            <given-names>MB</given-names>
          </name>
        </person-group>
        <article-title>Whole-genome analysis of papillary kidney cancer finds significant noncoding alterations</article-title>
        <source>PLoS Genet.</source>
        <year>2017</year>
        <volume>13</volume>
        <fpage>e1006685</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pgen.1006685</pub-id>
        <pub-id pub-id-type="pmid">28358873</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bailey</surname>
            <given-names>MH</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Comprehensive characterization of cancer driver genes and mutations</article-title>
        <source>Cell</source>
        <year>2018</year>
        <volume>173</volume>
        <fpage>371</fpage>
        <lpage>385</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2018.02.060</pub-id>
        <pub-id pub-id-type="pmid">29625053</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Efron</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Hastie</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Johnstone</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Tibshirani</surname>
            <given-names>R</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Least angle regression</article-title>
        <source>Ann. Stat.</source>
        <year>2004</year>
        <volume>32</volume>
        <fpage>407</fpage>
        <lpage>499</lpage>
        <pub-id pub-id-type="doi">10.1214/009053604000000067</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Muir</surname>
            <given-names>P</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The real cost of sequencing: scaling computation to keep pace with data generation</article-title>
        <source>Genome Biol.</source>
        <year>2016</year>
        <volume>17</volume>
        <fpage>53</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-016-0917-0</pub-id>
        <pub-id pub-id-type="pmid">27009100</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Littman</surname>
            <given-names>ML</given-names>
          </name>
          <name>
            <surname>Walsh</surname>
            <given-names>TJ</given-names>
          </name>
          <name>
            <surname>Strehl</surname>
            <given-names>AL</given-names>
          </name>
        </person-group>
        <article-title>Knows what it knows: a framework for self-aware learning</article-title>
        <source>Mach. Learn.</source>
        <year>2011</year>
        <volume>82</volume>
        <fpage>399</fpage>
        <lpage>443</lpage>
        <pub-id pub-id-type="doi">10.1007/s10994-010-5225-4</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zou</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Hastie</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>Regularization and variable selection via the elastic net</article-title>
        <source>J. R. Stat. Soc.: Ser. B (Stat. Methodol.)</source>
        <year>2005</year>
        <volume>67</volume>
        <fpage>301</fpage>
        <lpage>320</lpage>
        <pub-id pub-id-type="doi">10.1111/j.1467-9868.2005.00503.x</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gehring</surname>
            <given-names>JS</given-names>
          </name>
          <name>
            <surname>Fischer</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Lawrence</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Huber</surname>
            <given-names>W</given-names>
          </name>
        </person-group>
        <article-title>Somaticsignatures: inferring mutational signatures from single-nucleotide variants</article-title>
        <source>Bioinformatics</source>
        <year>2015</year>
        <volume>31</volume>
        <fpage>3673</fpage>
        <lpage>3675</lpage>
        <?supplied-pmid 26163694?>
        <pub-id pub-id-type="pmid">26163694</pub-id>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Qiu</surname>
            <given-names>X</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Single-cell mrna quantification and differential analysis with census</article-title>
        <source>Nat. Methods</source>
        <year>2017</year>
        <volume>14</volume>
        <fpage>309</fpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.4150</pub-id>
        <pub-id pub-id-type="pmid">28114287</pub-id>
      </element-citation>
    </ref>
    <ref id="CR29">
      <label>29.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhu</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Lei</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Devlin</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Roeder</surname>
            <given-names>K</given-names>
          </name>
        </person-group>
        <article-title>A unified statistical framework for single cell and bulk rna sequencing data</article-title>
        <source>Ann. Appl. Stat.</source>
        <year>2018</year>
        <volume>12</volume>
        <fpage>609</fpage>
        <pub-id pub-id-type="doi">10.1214/17-AOAS1110</pub-id>
        <pub-id pub-id-type="pmid">30174778</pub-id>
      </element-citation>
    </ref>
    <ref id="CR30">
      <label>30.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Fischer</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Illingworth</surname>
            <given-names>CJ</given-names>
          </name>
          <name>
            <surname>Campbell</surname>
            <given-names>PJ</given-names>
          </name>
          <name>
            <surname>Mustonen</surname>
            <given-names>V</given-names>
          </name>
        </person-group>
        <article-title>Emu: probabilistic inference of mutational processes and their localization in the cancer genome</article-title>
        <source>Genome Biol.</source>
        <year>2013</year>
        <volume>14</volume>
        <fpage>R39</fpage>
        <pub-id pub-id-type="doi">10.1186/gb-2013-14-4-r39</pub-id>
        <pub-id pub-id-type="pmid">23628380</pub-id>
      </element-citation>
    </ref>
    <ref id="CR31">
      <label>31.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gorski</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Pfeuffer</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Klamroth</surname>
            <given-names>K</given-names>
          </name>
        </person-group>
        <article-title>Biconvex sets and optimization with biconvex functions: a survey and extensions</article-title>
        <source>Math. Methods Oper. Res.</source>
        <year>2007</year>
        <volume>66</volume>
        <fpage>373</fpage>
        <lpage>407</lpage>
        <pub-id pub-id-type="doi">10.1007/s00186-007-0161-1</pub-id>
      </element-citation>
    </ref>
    <ref id="CR32">
      <label>32.</label>
      <mixed-citation publication-type="other">Reid, S., Tibshirani, R. &amp; Friedman, J. A study of error variance estimation in lasso regression. <italic>Stat. Sin.</italic><bold>26</bold>, 35–67 (2016).</mixed-citation>
    </ref>
  </ref-list>
</back>
