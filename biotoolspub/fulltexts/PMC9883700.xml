<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">9883700</article-id>
    <article-id pub-id-type="pmid">31373609</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btz605</article-id>
    <article-id pub-id-type="publisher-id">btz605</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Applications Notes</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Data and Text Mining</subject>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>gwasrapidd: an R package to query, download and wrangle GWAS catalog data</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">http://orcid.org/0000-0001-5226-3441</contrib-id>
        <name>
          <surname>Magno</surname>
          <given-names>Ramiro</given-names>
        </name>
        <aff>
          <institution>Centre for Biomedical Research (CBMR)</institution>
        </aff>
        <aff>
          <institution>Algarve Biomedical Center (ABC)</institution>
        </aff>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">http://orcid.org/0000-0002-0454-9207</contrib-id>
        <name>
          <surname>Maia</surname>
          <given-names>Ana-Teresa</given-names>
        </name>
        <xref rid="btz605-cor1" ref-type="corresp"/>
        <aff>
          <institution>Centre for Biomedical Research (CBMR)</institution>
        </aff>
        <aff>
          <institution>Algarve Biomedical Center (ABC)</institution>
        </aff>
        <aff><institution>Department of Biomedical Sciences and Medicine (DCBM)</institution>, Universidade do Algarve, Faro 8005-139, <country country="PT">Portugal</country></aff>
        <!--atmaia@ualg.pt-->
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Wren</surname>
          <given-names>Jonathan</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="btz605-cor1">To whom correspondence should be addressed. Email: <email>atmaia@ualg.pt</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <day>15</day>
      <month>1</month>
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2019-08-02">
      <day>02</day>
      <month>8</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>02</day>
      <month>8</month>
      <year>2019</year>
    </pub-date>
    <volume>36</volume>
    <issue>2</issue>
    <fpage>649</fpage>
    <lpage>650</lpage>
    <history>
      <date date-type="received">
        <day>21</day>
        <month>5</month>
        <year>2019</year>
      </date>
      <date date-type="rev-recd">
        <day>09</day>
        <month>7</month>
        <year>2019</year>
      </date>
      <date date-type="accepted">
        <day>01</day>
        <month>8</month>
        <year>2019</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2019. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2019</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btz605.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Motivation</title>
        <p>The National Human Genome Research Institute Catalog of Published Genome-Wide Association Studies (GWAS) Catalog has collected, curated and made available data from over 7100 studies. The recently developed GWAS Catalog representational state transfer (REST) application programming interface (API) is the only method allowing programmatic access to this resource.</p>
      </sec>
      <sec id="s2">
        <title>Results</title>
        <p>Here, we describe <italic toggle="yes">gwasrapidd</italic>, an R package that provides the first client interface to the GWAS Catalog REST API, representing an important software counterpart to the server-side component. <italic toggle="yes">gwasrapidd</italic> enables users to quickly retrieve, filter and integrate data with comprehensive bioinformatics analysis tools, which is particularly critical for those looking into functional characterization of risk loci.</p>
      </sec>
      <sec id="s3">
        <title>Availability and implementation</title>
        <p><italic toggle="yes">gwasrapidd</italic> is freely available under an MIT License, and can be accessed from <ext-link xlink:href="https://github.com/ramiromagno/gwasrapidd" ext-link-type="uri">https://github.com/ramiromagno/gwasrapidd</ext-link>.</p>
      </sec>
      <sec id="s4">
        <title>Supplementary information</title>
        <p><xref rid="sup1" ref-type="supplementary-material">Supplementary data</xref> are available at <italic toggle="yes">Bioinformatics</italic> online.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution>FCT—Fundação para a Ciência e a Tecnologia</institution>
        </funding-source>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution>CRESC ALGARVE 2020</institution>
        </funding-source>
        <award-id>UID/BIM/04773/2013</award-id>
        <award-id>POCI-01-0145-FEDER-022184</award-id>
        <award-id>ALG-01-0145-FEDER-31477</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="2"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>The National Human Genome Research Institute (NHGRI) Catalog of published GWAS Catalog, created in 2014, is a publicly available, manually curated, database of all published genome-wide association studies (GWAS) (<xref rid="btz605-B4" ref-type="bibr">Welter <italic toggle="yes">et al.</italic>, 2014</xref>). Its latest data release [date July 12, 2019] includes data from 4054 publications and 143 963 unique SNP-trait associations for human diseases. Currently, these data can be accessed by three methods: (i) via the web graphical user interface (GUI), (ii) by downloading database dumps, or, more recently, (iii) via the GWAS catalog representational state transfer (REST) application programming interface (API), which provides direct programmatic access and hence is the preferred method for bioinformatics analyses.</p>
    <p>We developed the first R package (<xref rid="btz605-B3" ref-type="bibr">R Core Team, 2017</xref>) allowing programmatic access to the GWAS catalog REST API: <italic toggle="yes">gwasrapidd</italic>. This package provides a simple interface for querying catalog data, abstracting away the informatic details of the REST API. In addition, retrieved data are mapped to in-memory relational databases of tidy data tables, allowing prompt integration with tidy-verse packages for subsequent transformation, visualization and modelling of data (<xref rid="btz605-B5" ref-type="bibr">Wickham <italic toggle="yes">et al.</italic>, 2014</xref>; <xref rid="btz605-B6" ref-type="bibr">Wickham and Grolemund, 2017</xref>).</p>
  </sec>
  <sec>
    <title>2 Results</title>
    <sec>
      <title>2.1 Retrieving data from the GWAS Catalog REST API</title>
      <p>The GWAS Catalog REST API is an EBI service hosted at <ext-link xlink:href="https://www.ebi.ac.uk/gwas/rest/api/" ext-link-type="uri">https://www.ebi.ac.uk/gwas/rest/api/</ext-link>. The REST API uses hypermedia with resource responses following the JSON hypertext application language (HAL) format (<xref rid="btz605-B1" ref-type="bibr">Kelly, 2016</xref>). Response data are, therefore, provided as hierarchical data in JSON format, can be paginated (i.e. split into multiple responses) and can also be embedded (i.e. have other resources contained within them), adding extra complexity to the returned JSON format [Additional File 1: <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S1</xref>, and (<xref rid="btz605-B2" ref-type="bibr">NHGRI-EBI GWAS Catalog Team, 2019</xref>)].</p>
      <p>To ease the conversion from the hierarchical to the relational tabular format—the preferred format for data analysis in R (<xref rid="btz605-B6" ref-type="bibr">Wickham and Grolemund, 2017</xref>), and to abstract away the informatic details associated with the HAL format, we developed a set of retrieval functions (<xref rid="btz605-F1" ref-type="fig">Fig. 1A</xref>). Since the REST API data are organized around four core data entities —<italic toggle="yes">studies</italic>, <italic toggle="yes">associations</italic>, <italic toggle="yes">variants</italic> and <italic toggle="yes">traits</italic> (<xref rid="btz605-B2" ref-type="bibr">NHGRI-EBI GWAS Catalog Team, 2019</xref>)— we implemented four corresponding retrieval functions that encapsulate the technical aspects of resource querying and format conversion: <monospace>get_studies()</monospace>, <monospace>get_associations()</monospace>, <monospace>get_variants()</monospace> and <monospace>get_traits()</monospace> (<xref rid="btz605-F1" ref-type="fig">Fig. 1A</xref>). These functions simplify the querying of GWAS entities, by providing a complete and consistent interface to the Catalog. For example, to query for <italic toggle="yes">studies</italic>, the user needs only to know the function <monospace>get_studies()</monospace>, whereas the REST API itself exposes a set of disparate resource URL endpoints for <italic toggle="yes">studies</italic> following the available search criteria [Additional file 1: <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S1</xref>, and (<xref rid="btz605-B2" ref-type="bibr">NHGRI-EBI GWAS Catalog Team, 2019</xref>)]. Moreover, the user can choose from any number of available search criteria exposed by the REST API directly as arguments to the retrieval functions (<xref rid="btz605-F1" ref-type="fig">Fig. 1B</xref>). All arguments are vectorized, meaning that multiple queries are promptly available from a single function call. Results obtained from multiple queries can be combined in an <monospace>OR</monospace> or <monospace>AND</monospace> fashion with the <monospace>set_operation</monospace> parameter. If <monospace>set_operation</monospace> is set to <monospace>OR</monospace> (default behavior), results are collated while removing duplicates, if any. If <monospace>set_operation</monospace> is set to <monospace>AND</monospace>, only entities that concomitantly match all criteria are returned. If finer control is needed on combining results, the following functions can be used: <monospace>bind()</monospace>, <monospace>union()</monospace>, <monospace>intersect()</monospace>, <monospace>setdiff()</monospace> and <monospace>setequal()</monospace>. These are S4 methods that work with the S4 classes created in <italic toggle="yes">gwasrapidd</italic> (Additional File 2: <xref rid="sup1" ref-type="supplementary-material">Figure S1</xref>). An example of a case study can be found in Additional File 3.
</p>
      <fig position="float" id="btz605-F1">
        <label>Fig. 1.</label>
        <caption>
          <p><italic toggle="yes">gwasrapidd</italic> retrieval functions. <bold>(A)</bold> Functions for retrieving data from the GWAS Catalog: <monospace>get_studies()</monospace>, <monospace>get_associations()</monospace>, <monospace>get_variants()</monospace> and <monospace>get_traits()</monospace>. <bold>(B)</bold> <italic toggle="yes">gwasrapidd</italic> search criteria (function parameters) to be used with retrieval functions. Colored circles indicate which entities can be retrieved by which criteria</p>
        </caption>
        <graphic xlink:href="btz605f1" position="float"/>
      </fig>
    </sec>
    <sec>
      <title>2.2 Representation of GWAS Catalog entities</title>
      <p>All S4 classes share the same design principles that makes them relational databases: (i) each slot corresponds to a table (data frame in R), (ii) the first slot corresponds to the main table that lists observations of the respective GWAS Catalog entity, e.g. <italic toggle="yes">studies</italic> and, (iii) all tables have a primary key, the identifier of the respective GWAS Catalog entity: <monospace>study_id</monospace>, <monospace>association_id</monospace>, <monospace>variant_id</monospace> or <monospace>efo_id</monospace> (Additional File 2: <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S1</xref>). For easy consultation of the variables in the tables, we provide a cheat-sheet (Additional File 4: <italic toggle="yes">gwasrapidd</italic> cheat-sheet); for the detailed description the user can issue the following commands to open the help page about each class: <monospace>class?studies, class?associations, class?variants or class?traits</monospace>.</p>
    </sec>
    <sec>
      <title>2.3 Improvements and limitations</title>
      <p>Compared to the exposed REST API, we have augmented the search possibilities in <italic toggle="yes">gwasrapidd</italic> in two ways: (i) by allowing searches for <italic toggle="yes">variants</italic> by cytogenetic region (as is possible with the web GUI) and (ii) by allowing searching <italic toggle="yes">variants</italic> by EFO identifier (<monospace>efo_id</monospace>), indirectly via EFO traits <monospace>get_traits()</monospace>. The first was implemented by embedding a dataset of genomic ranges of the human cytogenetic bands in <italic toggle="yes">gwasrapidd</italic>, so that queries made by cytogenetic band can be translated into searches by genomic range <monospace>(genomic_range)</monospace>. Additionally, <italic toggle="yes">gwasrapidd</italic> also provides a set of helper functions to easily browse linked web resources, such as PubMed [<monospace>open_in_pubmed()</monospace>], dbSNP [<monospace>open_in_dbsnp()</monospace>] and GTEx project [<monospace>open_in_gtex()</monospace>].</p>
      <p>Currently, the limitations of the REST API when compared to the web GUI are: (i) it is not possible to perform free text searches, and (ii) it is not possible to search traits using child trait terms automatically, they need to be included explicitly. To find the trait child terms, we provide the function <monospace>get_child_efo()</monospace>.</p>
    </sec>
  </sec>
  <sec>
    <title>3 Conclusion</title>
    <p>We have developed the first R client to the GWAS Catalog REST API, thus greatly facilitating programmatic access to the database. The main features of <italic toggle="yes">gwasrapidd</italic> are: (i) abstracting away the REST API informatic details by providing a simple and consistent interface, and (ii) a tidy data representation of the GWAS entities, i.e. of <italic toggle="yes">studies</italic>, <italic toggle="yes">associations</italic>, <italic toggle="yes">variants</italic> and <italic toggle="yes">traits</italic> in the form of in-memory relational databases. This improves data mining from within R, accelerating the integration of GWAS data into further genomic and biomedical/clinical studies.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="sup1" position="float" content-type="local-data">
      <label>btz605_Supplementary_Data</label>
      <media xlink:href="btz605_supplementary_data.zip">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack id="ack1">
    <title>Acknowledgements</title>
    <p>The authors would like to thank the GWAS Catalog team, particularly Daniel Suveges, for all the help and support with the REST API throughout the entire development of <italic toggle="yes">gwasrapidd</italic>. They also thank also the remaining of the Cancer Functional Genomics lab members for feedback on the user experience of <italic toggle="yes">gwasrapidd</italic>.</p>
    <sec>
      <title>Funding</title>
      <p>This work was supported by national Portuguese funding through FCT—Fundação para a Ciência e a Tecnologia and CRESC ALGARVE 2020: UID/BIM/04773/2013 ‘CBMR’, POCI-01-0145-FEDER-022184 ‘GenomePT’ and ALG-01-0145-FEDER-31477 ‘DEvoCancer’. Publication costs were kindly supported by Município de Loulé via de Algarve Biomedical Center (ABC). </p>
      <p><italic toggle="yes">Conflict of Interest</italic>: none declared.</p>
    </sec>
  </ack>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="btz605-B1">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Kelly</surname>
 <given-names>M</given-names></string-name></person-group>. (<year>2016</year>) <italic toggle="yes">JSON Hypertext Application Language</italic> (4 May 2019, date last accessed).</mixed-citation>
    </ref>
    <ref id="btz605-B2">
      <mixed-citation publication-type="other">NHGRI-EBI GWAS Catalog Team. (<year>2019</year>) <italic toggle="yes">GWAS Catalog API Guide</italic> (4 May 2019, date last accessed).</mixed-citation>
    </ref>
    <ref id="btz605-B3">
      <mixed-citation publication-type="book">R Core Team. (<year>2017</year>) <source>R: A Language and Environment for Statistical Computing</source>. 
<publisher-name>R Foundation for Statistical Computing</publisher-name>, 
<publisher-loc>Vienna, Austria</publisher-loc>.</mixed-citation>
    </ref>
    <ref id="btz605-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Welter</surname>
 <given-names>D.</given-names></string-name></person-group>
 <etal>et al</etal> (<year>2014</year>) 
<article-title>The NHGRI GWAS Catalog, a curated resource of SNP-trait associations</article-title>. <source>Nucleic Acids Res</source>., <volume>42</volume>, <fpage>D1001</fpage>–<lpage>D1006</lpage>.<pub-id pub-id-type="pmid">24316577</pub-id></mixed-citation>
    </ref>
    <ref id="btz605-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wickham</surname>
 <given-names>H.</given-names></string-name></person-group>
 <etal>et al</etal> (<year>2014</year>) 
<article-title>Tidy data</article-title>. <source>J. Stat. Software</source>, <volume>59</volume>, <fpage>1</fpage>–<lpage>23</lpage>.</mixed-citation>
    </ref>
    <ref id="btz605-B6">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Wickham</surname>
 <given-names>H.</given-names></string-name>, <string-name><surname>Grolemund</surname><given-names>G.</given-names></string-name></person-group> (<year>2017</year>) <source>R for Data Science: Import, Tidy, Transform, Visualize, and Model Data</source>, <edition>1</edition>st edn. 
<publisher-name>O’Reilly Media</publisher-name>.</mixed-citation>
    </ref>
  </ref-list>
</back>
