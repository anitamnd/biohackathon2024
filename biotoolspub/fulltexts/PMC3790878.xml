<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.1 20151215//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-archivearticle1.dtd?>
<?SourceDTD.Version 1.1?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">PLoS One</journal-id>
    <journal-id journal-id-type="iso-abbrev">PLoS ONE</journal-id>
    <journal-id journal-id-type="publisher-id">plos</journal-id>
    <journal-id journal-id-type="pmc">plosone</journal-id>
    <journal-title-group>
      <journal-title>PLoS ONE</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1932-6203</issn>
    <publisher>
      <publisher-name>Public Library of Science</publisher-name>
      <publisher-loc>San Francisco, USA</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">3790878</article-id>
    <article-id pub-id-type="pmid">24124490</article-id>
    <article-id pub-id-type="publisher-id">PONE-D-13-01045</article-id>
    <article-id pub-id-type="doi">10.1371/journal.pone.0075448</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>NeSSM: A Next-Generation Sequencing Simulator for Metagenomics</article-title>
      <alt-title alt-title-type="running-head">NeSSM:NGS Simulator for Metagenomics</alt-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" equal-contrib="yes">
        <name>
          <surname>Jia</surname>
          <given-names>Ben</given-names>
        </name>
        <xref ref-type="aff" rid="aff1">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author" equal-contrib="yes">
        <name>
          <surname>Xuan</surname>
          <given-names>Liming</given-names>
        </name>
        <xref ref-type="aff" rid="aff3">
          <sup>3</sup>
        </xref>
        <xref ref-type="aff" rid="aff4">
          <sup>4</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author" equal-contrib="yes">
        <name>
          <surname>Cai</surname>
          <given-names>Kaiye</given-names>
        </name>
        <xref ref-type="aff" rid="aff4">
          <sup>4</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Hu</surname>
          <given-names>Zhiqiang</given-names>
        </name>
        <xref ref-type="aff" rid="aff2">
          <sup>2</sup>
        </xref>
        <xref ref-type="aff" rid="aff4">
          <sup>4</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Ma</surname>
          <given-names>Liangxiao</given-names>
        </name>
        <xref ref-type="aff" rid="aff4">
          <sup>4</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Wei</surname>
          <given-names>Chaochun</given-names>
        </name>
        <xref ref-type="aff" rid="aff2">
          <sup>2</sup>
        </xref>
        <xref ref-type="aff" rid="aff4">
          <sup>4</sup>
        </xref>
        <xref ref-type="corresp" rid="cor1">
          <sup>*</sup>
        </xref>
      </contrib>
    </contrib-group>
    <aff id="aff1">
      <label>1</label>
      <addr-line>School of Biomedical Engineering, Shanghai Jiao Tong University, Shanghai, China</addr-line>
    </aff>
    <aff id="aff2">
      <label>2</label>
      <addr-line>Department of Bioinformatics and Biostatistics, School of Life Sciences and Biotechnology, Shanghai Jiao Tong University, Shanghai, China</addr-line>
    </aff>
    <aff id="aff3">
      <label>3</label>
      <addr-line>School of Bioengineering, East China University of Science and Technology, Shanghai, China</addr-line>
    </aff>
    <aff id="aff4">
      <label>4</label>
      <addr-line>Shanghai Center for Bioinformation Technology, Shanghai, China</addr-line>
    </aff>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Janssen</surname>
          <given-names>Paul Jaak</given-names>
        </name>
        <role>Editor</role>
        <xref ref-type="aff" rid="edit1"/>
      </contrib>
    </contrib-group>
    <aff id="edit1">
      <addr-line>Belgian Nuclear Research Centre SCK/CEN, Belgium</addr-line>
    </aff>
    <author-notes>
      <corresp id="cor1">* E-mail: <email>ccwei@sjtu.edu.cn</email></corresp>
      <fn fn-type="COI-statement">
        <p><bold>Competing Interests: </bold>The authors have declared that no competing interests exist.</p>
      </fn>
      <fn fn-type="con">
        <p>Conceived and designed the experiments: CCW. Performed the experiments: BJ KYC LMX CCW. Analyzed the data: BJ KYC LMX CCW. Wrote the paper: BJ LMX KYC CCW ZQH. System impleentation and tests: LXM ZQH.</p>
      </fn>
    </author-notes>
    <pub-date pub-type="collection">
      <year>2013</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>4</day>
      <month>10</month>
      <year>2013</year>
    </pub-date>
    <volume>8</volume>
    <issue>10</issue>
    <elocation-id>e75448</elocation-id>
    <history>
      <date date-type="received">
        <day>29</day>
        <month>12</month>
        <year>2012</year>
      </date>
      <date date-type="accepted">
        <day>19</day>
        <month>8</month>
        <year>2013</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© 2013 Jia et al</copyright-statement>
      <copyright-year>2013</copyright-year>
      <copyright-holder>Jia et al</copyright-holder>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open-access article distributed under the terms of the Creative Commons Attribution License, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are properly credited.</license-p>
      </license>
    </permissions>
    <abstract>
      <sec>
        <title>Background</title>
        <p>Metagenomics can reveal the vast majority of microbes that have been missed by traditional cultivation-based methods. Due to its extremely wide range of application areas, fast metagenome sequencing simulation systems with high fidelity are in great demand to facilitate the development and comparison of metagenomics analysis tools.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p>We present here a customizable metagenome simulation system: NeSSM (<underline>Ne</underline>xt-generation <underline>S</underline>equencing <underline>S</underline>imulator for <underline>M</underline>etagenomics). Combining complete genomes currently available, a community composition table, and sequencing parameters, it can simulate metagenome sequencing better than existing systems. Sequencing error models based on the explicit distribution of errors at each base and sequencing coverage bias are incorporated in the simulation. In order to improve the fidelity of simulation, tools are provided by NeSSM to estimate the sequencing error models, sequencing coverage bias and the community composition directly from existing metagenome sequencing data. Currently, NeSSM supports single-end and pair-end sequencing for both 454 and Illumina platforms. In addition, a GPU (graphics processing units) version of NeSSM is also developed to accelerate the simulation. By comparing the simulated sequencing data from NeSSM with experimental metagenome sequencing data, we have demonstrated that NeSSM performs better in many aspects than existing popular metagenome simulators, such as MetaSim, GemSIM and Grinder. The GPU version of NeSSM is more than one-order of magnitude faster than MetaSim.</p>
      </sec>
      <sec>
        <title>Conclusions</title>
        <p>NeSSM is a fast simulation system for high-throughput metagenome sequencing. It can be helpful to develop tools and evaluate strategies for metagenomics analysis and it’s freely available for academic users at <ext-link ext-link-type="uri" xlink:href="http://cbb.sjtu.edu.cn/~ccwei/pub/software/NeSSM.php">http://cbb.sjtu.edu.cn/~ccwei/pub/software/NeSSM.php</ext-link>.</p>
      </sec>
    </abstract>
    <funding-group>
      <funding-statement>This work was supported by grants from the National Natural Science Foundation of China (61272250), the National Basic Research Program of China (2012AA101601, 2012CB316501), and the National High-Tech R&amp;D Program (863) (2012AA101601). The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
    </funding-group>
    <counts>
      <page-count count="10"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec id="s1">
    <title>Introduction</title>
    <p>Metagenomics studies all genetic materials recovered directly from environmental samples. It is a new research area full of promising since it can provide insight to a large unexplored field of uncultured microbes, while traditional isolate-and-culture methods can only analyze a tiny fraction of total microbes <xref rid="pone.0075448-Suau1" ref-type="bibr">[1]</xref>, <xref rid="pone.0075448-Furrie1" ref-type="bibr">[2]</xref>. For example, metagenomics methods have been applied to analyze numerous microbial communities <xref rid="pone.0075448-Kowalchuk1" ref-type="bibr">[3]</xref> and new organisms or enzymes have been found by using metagenomics methods <xref rid="pone.0075448-Yun1" ref-type="bibr">[4]</xref>, <xref rid="pone.0075448-Ferrer1" ref-type="bibr">[5]</xref>. High-throughput sequencing technologies play a key role here, especially for shotgun sequencing-based metagenomics analysis <xref rid="pone.0075448-Venter1" ref-type="bibr">[6]</xref>, <xref rid="pone.0075448-Tyson1" ref-type="bibr">[7]</xref>. Over all, these new sequencing platforms, which are called Next-Generation Sequencing (NGS) technologies in general, have revolutionized the sequencing landscape in the past a few years <xref rid="pone.0075448-Margulies1" ref-type="bibr">[8]</xref>, <xref rid="pone.0075448-Mardis1" ref-type="bibr">[9]</xref>. Due to their high throughput and cost-performance efficiency, NGS platforms have made it possible to apply metagenomics methods to a wide range of research areas.</p>
    <p>In order to reduce the resources, cost and time for a metagenomics project, it’s better to evaluate and compare the sequencing strategies in advance <xref rid="pone.0075448-Angiuoli1" ref-type="bibr">[10]</xref>. This is particularly important when applying a metagenomics method to a new research area. A metagenome sequencing simulation system can be helpful for this purpose <xref rid="pone.0075448-Nossa1" ref-type="bibr">[11]</xref>. Besides, it can help develop subsequent analysis tools, such as assembly and classification <xref rid="pone.0075448-Mundry1" ref-type="bibr">[12]</xref>, <xref rid="pone.0075448-Mende1" ref-type="bibr">[13]</xref>. In addition, since no gold standard is available for metagenomic data analysis, performance evaluation based on simulated metagenome sequencing is still the most effective way <xref rid="pone.0075448-Patil1" ref-type="bibr">[14]</xref>.</p>
    <p>In NGS sequencing simulation, several important technical specifications of the NGS sequencing platforms need to be considered. First, the sequencing errors should be simulated since it can be critical to the subsequent analysis. For example, a better microbial diversity is extracted when the sequencing errors in 454 sequencing platforms are considered <xref rid="pone.0075448-Quince1" ref-type="bibr">[15]</xref>. The sequencing errors vary a lot for different NGS platforms. For example, in Illumina platform, mismatches happen more frequently than indels, while it is opposite in 454 platform <xref rid="pone.0075448-McElroy1" ref-type="bibr">[16]</xref>. Second, sequencing coverage bias should be considered as well. In both Illumina and 454 platforms, the bases in a genome are not sequenced equally <xref rid="pone.0075448-Harismendy1" ref-type="bibr">[17]</xref>, which is defined as sequencing coverage bias. Sequencing coverage bias can also affect subsequent analysis, such as community diversity estimation <xref rid="pone.0075448-Willerth1" ref-type="bibr">[18]</xref>. Therefore, it is necessary to simulate both the sequencing errors and sequencing coverage bias for metagenome sequencing simulations. At the mean time, the simulation of metagenome data is becoming more time consuming since the throughput of the NGS sequencing platforms is huge. For instance, the latest version of Illumina HiSeq 2000 can produce more than 600 G bps in a single run. Therefore, the simulation speed should be considered as well.</p>
    <p>Sequenced genomes are required for metagenome sequencing simulation. During the past a few years, the number of sequenced microbial genomes has increased quickly. Particularly, the human microbiome project (HMP) planed to complete and deposit more than 1,000 bacterial genomes and 375 had been completed and deposited in 2009 <xref rid="pone.0075448-Peterson1" ref-type="bibr">[19]</xref>. There are 1,080 bacterial genomes deposited up to Dec 2, 2012 (<ext-link ext-link-type="uri" xlink:href="http://www.hmpdacc.org/HMRGD/">http://www.hmpdacc.org/HMRGD/</ext-link>). In addition, phylogenetic tree driven sequencing projects have created genomes distributed more evenly across the polygenetic tree, which makes the microbial genome database much more representative <xref rid="pone.0075448-Wu1" ref-type="bibr">[20]</xref>. Overall, there are 2,358 of bacterial and archaeal species with complete genomes available in NCBI genome database on Apr. 8, 2013 (<ext-link ext-link-type="ftp" xlink:href="ftp://ftp.ncbi.nih.gov/genomes/">ftp://ftp.ncbi.nih.gov/genomes/</ext-link>).</p>
    <p>Currently, there exist some simulation systems for NGS sequencing. Some systems, like ART <xref rid="pone.0075448-Huang1" ref-type="bibr">[21]</xref> and pIRS <xref rid="pone.0075448-Hu1" ref-type="bibr">[22]</xref>, are designed for single genome sequencing or re-sequencing simulation. In recent years, MetaSim, GemSIM and Grinder <xref rid="pone.0075448-McElroy1" ref-type="bibr">[16]</xref>, <xref rid="pone.0075448-Richter1" ref-type="bibr">[23]</xref>, <xref rid="pone.0075448-Angly1" ref-type="bibr">[24]</xref> are developed to facilitate the development of metagenomics analysis systems. MetaSim is a popular simulator for metagenome sequencing and in a single run it uses fixed probabilities of sequencing errors (insertions, deletions and substitutions) for the same base in different reads. GemSIM can estimate the error model from the sequenced datasets. Grinder can simulate PCR amplification and shotgun sequencing with a specific community structure, but its error models are similar to MetaSim’s. However, neither MetaSim nor Grinder takes sequencing coverage bias into consideration, and their sequencing quality values are fixed at the same positions of all reads.</p>
    <p>In this paper, we first introduce the Next-generation Sequencing Simulator for Metagenomics (NeSSM). In its error model, each position contains an explicit distribution of sequencing quality values. Sequencing coverage bias can be considered in NeSSM. In addition, it can obtain metagenomic community compositions from existing sequencing data, which can be helpful to improve the fidelity of metagenome simulation. Subsequently, the performance of NeSSM is evaluated. Finally, NeSSM and several existing simulation systems such as MetaSim, GemSIM and Grinder are compared.</p>
  </sec>
  <sec sec-type="materials|methods" id="s2">
    <title>Materials and Methods</title>
    <sec id="s2a">
      <title>Database of Complete Microbial Genomes</title>
      <p>NeSSM contains a database of complete microbe genomes currently available. Bacterial genome sequences (together with archaeal genome sequences) were downloaded from NCBI genome database (<ext-link ext-link-type="ftp" xlink:href="ftp://ftp.ncbi.nih.gov/genomes/">ftp://ftp.ncbi.nih.gov/genomes/</ext-link>). Up to the date Apr. 8, 2013, this dataset contained genomes from 2,358 species with a size of 7.8 GB.</p>
    </sec>
    <sec id="s2b">
      <title>The System Diagram of NeSSM</title>
      <p>As shown in <xref ref-type="fig" rid="pone-0075448-g001">Figure 1</xref>, NeSSM system can be divided into three steps: I, community composition extraction; II, error models and sequencing coverage bias estimation; and III, sequencing simulation. Step III is the main part of the system. Step I and II can be skipped if the corresponding information is available.</p>
      <fig id="pone-0075448-g001" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0075448.g001</object-id>
        <label>Figure 1</label>
        <caption>
          <title>The pipeline of NeSSM system.</title>
          <p>Step I: extraction of community composition from metagenome sequencing data. This step can be skipped if users have the community composition table already. Step II: estimation of sequence error model and sequencing coverage bias information. Step III: sequencing simulation.</p>
        </caption>
        <graphic xlink:href="pone.0075448.g001"/>
      </fig>
      <sec id="s2b1">
        <title>Step I: community composition extraction</title>
        <p>NeSSM takes input files in one of the two types: 1, a table of community composition, which contains a list of microbes and their corresponding proportions; 2, metagenomic sequence data in FASTA or FASTQ format. Step I is required only for the latter input type. The quality control (QC) processes such as removing adaptors, contaminations and low-quality reads are also required in step I in order to get better performance. Details for step I are described below.</p>
        <p>First, the metagenome sequencing reads are mapped back to the database of complete microbial genomes with BWA, a popular sequence mapping tool <xref rid="pone.0075448-Li1" ref-type="bibr">[25]</xref>. Different algorithms of BWA are adopted according to the read lengths. For reads shorter than 200 bps, the BWA options are “-I -N” in “aln” step and “-n 100” in “samse/sampe” step; and for reads longer than 200 bps, the option “bwtsw” is used.</p>
        <p>Second, the mapping results are analyzed to generate the number of reads for each genome, from which an initial community composition of the metagenome will be calculated. Pseudo-counts (0.001 by default) can be used for genomes. If a read can be mapped to one genome only, the read number for this genome will be added by one. However, if a read can be mapped to multiple genomes, the read counts for those mapped genomes will be increased with weights according to the following equation.<disp-formula id="pone.0075448.e001"><graphic xlink:href="pone.0075448.e001.jpg" position="anchor" orientation="portrait"/></disp-formula>where <inline-formula><inline-graphic xlink:href="pone.0075448.e002.jpg"/></inline-formula> is the weight for genome <italic>i</italic>; <inline-formula><inline-graphic xlink:href="pone.0075448.e003.jpg"/></inline-formula> is the number of reads assigned to genome <italic>i</italic>; <inline-formula><inline-graphic xlink:href="pone.0075448.e004.jpg"/></inline-formula> is the size of genome <italic>i</italic>; <inline-formula><inline-graphic xlink:href="pone.0075448.e005.jpg"/></inline-formula> is the number of reads assigned to genome <italic>j</italic>; <inline-formula><inline-graphic xlink:href="pone.0075448.e006.jpg"/></inline-formula> is the size of genome <italic>j</italic>; and <italic>n</italic> is the total number of mapped genomes for this read.</p>
        <p>After all reads are assigned, the total number of reads assigned to each genome is obtained. Genomes with read numbers greater than a certain threshold (10 by default) will be added into the candidate list. Then the proportions of all genomes in the candidate list will be calculated according to their read counts.</p>
        <p>In the end of step I, the resulted community composition is saved in a table containing the genome names and their abundances.</p>
      </sec>
      <sec id="s2b2">
        <title>Step II: error models and sequencing coverage bias estimation</title>
        <p>Users can set their own error models, which can come from specific publications or be estimated from an existing sequencing dataset. The existing sequencing dataset can be either an initial sequencing dataset or a publicly available sequencing dataset, from the same platform as the user plans to use. Perl scripts for estimating error models from existing sequencing data are provided. The pipeline is described as follows.</p>
        <p>First, the sequencing error probability at each base is estimated from the sequencing data according to the quality values. For each base in the FASTQ file, the error probability <italic>p</italic> is calculated from the quality value <italic>Q</italic> through the PHRED score <xref rid="pone.0075448-Cock1" ref-type="bibr">[26]</xref>, <xref rid="pone.0075448-Ewing1" ref-type="bibr">[27]</xref>:</p>
        <p>PHRED = −10*log(<italic>p</italic>);</p>
        <p><italic>Q</italic> = PHRED+64 (for Illumina platforms);</p>
        <p><italic>Q</italic> = PHRED+33 (for 454 platforms).</p>
        <p>It is shown that sequencing quality values at each base follow non-standard distributions (<xref ref-type="fig" rid="pone-0075448-g002">Figure 2</xref> and <xref ref-type="supplementary-material" rid="pone.0075448.s001">Figure S1</xref>) and the distributions vary for different bases as well. Therefore, explicit distribution, rather than an average value, is utilized to represent the errors at each base in NeSSM simulation.</p>
        <fig id="pone-0075448-g002" orientation="portrait" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pone.0075448.g002</object-id>
          <label>Figure 2</label>
          <caption>
            <title>The distribution of quality values at each base.</title>
            <p>X axis: the coordinates of reads (0-based); Y axis: the PHRED scores. The blue dots represent the average quality values and the red dots represent the median. In each picture, distributions of quality values at five different bases are shown as examples: (A) the distributions of quality values from an Illumina sequencing dataset; and (B) the distributions of quality values from a 454 sequencing dataset. Both datasets contain experimental sequencing data from the sequence read archives of NCBI. See <xref ref-type="supplementary-material" rid="pone.0075448.s002">Table S1</xref> for details of the datasets. This figure is plotted by vioplot <xref rid="pone.0075448-Hintze1" ref-type="bibr">[42]</xref>.</p>
          </caption>
          <graphic xlink:href="pone.0075448.g002"/>
        </fig>
        <p>Subsequently, the proportions of different error types (substitutions, insertions, and deletions) are estimated. This part can be further divided into two parts (<xref ref-type="fig" rid="pone-0075448-g003">Figure 3</xref>): first, proportions of substitutions, insertions, and deletions are estimated; second, proportions of different substitutions are calculated.</p>
        <fig id="pone-0075448-g003" orientation="portrait" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pone.0075448.g003</object-id>
          <label>Figure 3</label>
          <caption>
            <title>The pipeline of error model estimation.</title>
            <p>Estimation of the error model can be divided into two parts: 1. Estimation of the proportions of substitutions, insertions and deletions; 2. Estimation of proportions of different type of substitutions.</p>
          </caption>
          <graphic xlink:href="pone.0075448.g003"/>
        </fig>
        <p>In order to count the numbers of different error types, mapping results from step I will be adjusted using Samtools <xref rid="pone.0075448-Li2" ref-type="bibr">[28]</xref> if reads (used in the mapping) are greater than 200 bps. Next, information of MD (Mismatching positions/bases), NM (Editing distance) and CIGAR (alignment information) are extracted from the mapping results.</p>
        <p>Then, the proportions of insertions, deletions and sum of different kinds of substitutions are calculated from the counts of NM and CIGAR. For Illumina sequencing, the default error proportions are set to 0.01, 0.005 and 0.985 for insertion, deletion and substitution, respectively; for 454 sequencing, the default error proportions are set to 0.2, 0.15 and 0.65 for insertion, deletion and substitution, respectively. All the default parameters are estimated from sequencing data listed in <xref ref-type="supplementary-material" rid="pone.0075448.s002">Table S1</xref>.</p>
        <p>At the end, the proportions of different kinds of substitutions can be calculated from MD and CIGAR values. <xref ref-type="table" rid="pone-0075448-t001">Table 1</xref> shows the substitution errors for 454 sequencing. The substitution errors for Illumina sequencing are listed in <xref ref-type="supplementary-material" rid="pone.0075448.s003">Table S2</xref>.</p>
        <table-wrap id="pone-0075448-t001" orientation="portrait" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pone.0075448.t001</object-id>
          <label>Table 1</label>
          <caption>
            <title>The proportions of substitution errors used in 454 sequencing simulation.</title>
          </caption>
          <alternatives>
            <graphic id="pone-0075448-t001-1" xlink:href="pone.0075448.t001"/>
            <table frame="hsides" rules="groups">
              <colgroup span="1">
                <col align="left" span="1"/>
                <col align="center" span="1"/>
                <col align="center" span="1"/>
                <col align="center" span="1"/>
                <col align="center" span="1"/>
              </colgroup>
              <thead>
                <tr>
                  <td align="left" rowspan="1" colspan="1">Substitute Real</td>
                  <td align="left" rowspan="1" colspan="1">A</td>
                  <td align="left" rowspan="1" colspan="1">T</td>
                  <td align="left" rowspan="1" colspan="1">C</td>
                  <td align="left" rowspan="1" colspan="1">G</td>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td align="left" rowspan="1" colspan="1">A</td>
                  <td align="left" rowspan="1" colspan="1"/>
                  <td align="left" rowspan="1" colspan="1">0.06474</td>
                  <td align="left" rowspan="1" colspan="1">0.05735</td>
                  <td align="left" rowspan="1" colspan="1">0.12439</td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">T</td>
                  <td align="left" rowspan="1" colspan="1">0.05378</td>
                  <td align="left" rowspan="1" colspan="1"/>
                  <td align="left" rowspan="1" colspan="1">0.13480</td>
                  <td align="left" rowspan="1" colspan="1">0.06577</td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">C</td>
                  <td align="left" rowspan="1" colspan="1">0.05298</td>
                  <td align="left" rowspan="1" colspan="1">0.11709</td>
                  <td align="left" rowspan="1" colspan="1"/>
                  <td align="left" rowspan="1" colspan="1">0.06752</td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">G</td>
                  <td align="left" rowspan="1" colspan="1">0.12384</td>
                  <td align="left" rowspan="1" colspan="1">0.06784</td>
                  <td align="left" rowspan="1" colspan="1">0.06990</td>
                  <td align="left" rowspan="1" colspan="1"/>
                </tr>
              </tbody>
            </table>
          </alternatives>
        </table-wrap>
        <p>The sequencing coverage bias information can be extracted from an existing metagenome sequencing dataset. First, each metagenome read is mapped back to its genome using BWA with parameters described in the above section. Next, all genomes are divided into intervals of 100 bps. One mapped read adds 1 count to the corresponding interval. In addition, an initial pseudo-count (0.1) is given to each interval. Finally, the sequencing coverage of the genome is calculated based on the read counts for the intervals (more details in <xref ref-type="fig" rid="pone-0075448-g004">Figure 4</xref>).</p>
        <fig id="pone-0075448-g004" orientation="portrait" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pone.0075448.g004</object-id>
          <label>Figure 4</label>
          <caption>
            <title>The comparison of sequencing coverage before and after simulation.</title>
            <p>X axis: the coordinate of the genome of Acinetobacter baumannii ATCC 17978. Each interval contains 100 bases and only the first 3,000 intervals are shown; Y axis: the read numbers mapped in each interval. A: the sequencing coverage in the Dataset F; B: the sequencing coverage in NeSSM’s simulation; C: the sequencing coverage in MetaSim’s simulation; D: the sequencing coverage in GemSIM’s simulation; E: the sequencing coverage in Grinder’s simulation; and F: the sequencing coverage in pIRS’s simulation.</p>
          </caption>
          <graphic xlink:href="pone.0075448.g004"/>
        </fig>
      </sec>
      <sec id="s2b3">
        <title>Step III: sequencing simulation</title>
        <p>In the sequencing simulation step, the number of reads for each genome is first determined. Then reads are generated for each genome. Simulation details are described below.</p>
        <p>The expected read number for each genome is determined according to its abundance and genome size. For example, if the composition structure table contains two genomes: A and B, with abundances of 0.4 and 0.6 respectively, and their genome sizes of 15 M bps and 10 M bps respectively, then the expected read numbers for these two genomes are the same. If the total number of simulated reads is 2 million, the expected read number will be 1 million for each genome. In practice, the read number of each genome is simulated according to a multinomial distribution with the probability of every genome set as the ratio of the expected number of reads and the total number of reads.</p>
        <p>After the number of reads for each genome is determined, reads are generated from the selected microbial genome. First, according to the sequencing parameters provided by the user, the exact read is simulated as follows. For each read, a coordinate in the corresponding genome is generated randomly with even distribution or according to the sequencing coverage bias if it is provided; then the read length is determined according to the read length distribution; at last a piece of sequence exact to its origin genome is generated. The read length distribution can be of fixed length, normal distribution or explicit length distribution. Second, errors, including substitution and indel errors, are added to the sequence to generate the final read. In order to add errors, first, it should be decided whether an error or errors will be added. If an error or errors will be added, it should be decided what kind(s) of error(s) should be added according to the error models.</p>
      </sec>
    </sec>
    <sec id="s2c">
      <title>GPU Version of NeSSM</title>
      <p>Graphics processing units (GPUs) are originally designed to accelerate graphic display only. In the past few years, GPUs have evolved to GPGPUs (general purpose GPUs) and provide a massive parallel platform for scientific and engineering computing. Next-generation sequencing data analysis is a good application field for GPUs since millions of reads need to be processed in the same way, which can be parallelized easily. GPUs have been used in the bioinformatics area, including a popular sequence mapping program, SOAP3 <xref rid="pone.0075448-Liu1" ref-type="bibr">[29]</xref>, a metagenomics analysis program, Parallel-META <xref rid="pone.0075448-Su1" ref-type="bibr">[30]</xref>, and MetaBinG <xref rid="pone.0075448-Jia1" ref-type="bibr">[31]</xref>, a fast metagenomic classification program. A GPU version of NeSSM based on CUDA (Compute Unified Device Architecture) is also developed to accelerate the simulation. It works as follows.</p>
      <p>First, the number of reads to be simulated for each genome is decided on CPUs. Then the corresponding genome sequence and its read number are loaded to GPUs. The sequencing simulation process is similar as in CPUs except that every 20,000 reads (by default) are generated and output from GPUs in a batch. If the number of reads to be generated is smaller than 20,000, only the required number of reads are output from GPUs.</p>
    </sec>
    <sec id="s2d">
      <title>Datasets</title>
      <p>In order to assess the performance of NeSSM, six datasets (Dataset A to F) with different complexity are obtained. Three of the six datasets are simulated metagenomes: Dataset A, low complexity dataset (LC); Dataset B, median complexity dataset (MC); and Dataset C, high complexity dataset (HC). A single genome sequencing dataset from Illumina platform (Dataset D) is used to evaluate error models and distributions of quality values in NeSSM’s simulation. A 454 sequencing dataset from an artificial metagenome (Dataset E) and an Illumina sequencing dataset from a mock metagenome in the HMP project (Dataset F) are used to compare the performance of NeSSM and existing simulators such as MetaSim, GemSIM, and Grinder. Details for these datasets are shown below.</p>
      <sec id="s2d1">
        <title>Dataset A: LC dataset</title>
        <p>The Dataset A contains two microbial species with one dominant species. It is also called the dataset with low complexity (LC dataset). Details are listed in <xref ref-type="supplementary-material" rid="pone.0075448.s004">Table S3</xref>.</p>
      </sec>
      <sec id="s2d2">
        <title>Dataset B: MC dataset</title>
        <p>The Dataset B contains nine microbial species divided into five abundance levels, with two dominant genomes. It is also called the dataset with medium complexity (MC dataset). Details are listed in <xref ref-type="supplementary-material" rid="pone.0075448.s004">Table S3</xref>.</p>
      </sec>
      <sec id="s2d3">
        <title>Dataset C: HC dataset</title>
        <p>The Dataset C contains eleven microbial species with the same relative abundance for all species. It is also called the dataset with high complexity (HC dataset). Details are listed in <xref ref-type="supplementary-material" rid="pone.0075448.s004">Table S3</xref>.</p>
      </sec>
      <sec id="s2d4">
        <title>Dataset D: A single genome illumina sequencing dataset</title>
        <p>Dataset D contains Illumina sequencing reads for a single genome downloaded from SRA (run number SRR524810) in NCBI. It contains 4,353,518 reads. After QC (see more details bellow), 1,890,277 reads with lengths of 120 bps are obtained.</p>
      </sec>
      <sec id="s2d5">
        <title>Dataset E: An artificial metagenome by 454 sequencing platform</title>
        <p>Dataset E is an <italic>in vitro</italic> simulated metagenome <xref rid="pone.0075448-Morgan1" ref-type="bibr">[32]</xref> (SRR033549 from SRA in NCBI). In this artificial metagenome, Morgan <italic>et al</italic>. mixed 10 microbial species with equal numbers of cells. Subsequently, the DNA of the metagenome was extracted and sequenced by 454 platform. At last, 505,962 reads with an average read length of 243 bps were obtained. After QC (see more details bellow), 475,694 reads with an average length of 193 bps are remained.</p>
      </sec>
      <sec id="s2d6">
        <title>Dataset F: An artificial metagenome dataset by illumina sequencing platform</title>
        <p>At the start of HMP project, a synthetic mock community of 21 known organisms was used to evaluate different protocols (<ext-link ext-link-type="uri" xlink:href="http://www.hmpdacc.org/HMMC/">http://www.hmpdacc.org/HMMC/</ext-link>). This dataset (SRR172902 from SRA in NCBI) contained 6,562,065 reads with lengths of 75 bps (Illumina platforms). Three organisms in the community have no complete genomes available in NCBI, but only contigs (more details in <xref ref-type="supplementary-material" rid="pone.0075448.s005">Table S4</xref>). After QC (see more details bellow), reads from these organisms are removed according to the BWA result and 2,975,345 reads are remained.</p>
      </sec>
    </sec>
    <sec id="s2e">
      <title>QC for Sequencing Datasets D, E and F</title>
      <p>The program IlluQC.pl in NGSQCToolkit <xref rid="pone.0075448-Patel1" ref-type="bibr">[33]</xref> has been adopted to do the quality control. For Dataset D and F, the parameters are “-se 6 4–l 90”. In order to reduce the effect of “N”, only the first 120 bps of each read are retained for Dataset D. For Dataset E<bold>,</bold> the first 4 bps bases are deleted and the “Ns” in the ends are also deleted. After that, the last 50 bps of each read are removed because of primers. Finally, only the reads with length more than 60 bps are retained in Dataset E.</p>
    </sec>
    <sec id="s2f">
      <title>Measuring the Difference between Two Datasets</title>
      <p>BC-distance <xref rid="pone.0075448-Legendre1" ref-type="bibr">[34]</xref> is adopted to measure the difference between two vectors. Let <italic>X</italic> and <italic>Y</italic> be two vectors with <italic>n</italic> dimensions, the BC-distance between <italic>X</italic> and <italic>Y</italic> can be calculated as below.<disp-formula id="pone.0075448.e007"><graphic xlink:href="pone.0075448.e007.jpg" position="anchor" orientation="portrait"/></disp-formula>where <inline-formula><inline-graphic xlink:href="pone.0075448.e008.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="pone.0075448.e009.jpg"/></inline-formula> are the k<sup>th</sup> dimension values of X and Y respectively, <inline-formula><inline-graphic xlink:href="pone.0075448.e010.jpg"/></inline-formula>, <inline-formula><inline-graphic xlink:href="pone.0075448.e011.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="pone.0075448.e012.jpg"/></inline-formula>.</p>
      <p>In this paper, the BC-distance has been applied to measure the degree of similarity of community composition, error rates and sequencing coverage between a simulated data and an experimental data. For metagenome community composition comparison, X represents the composition table from the simulated data and Y represents the composition table from the other data. For sequencing errors between the simulated sequences and experimental sequences, X represents the error ratios of insertion, deletion and substitution from simulated data and Y represents those from existing data. The BC-distance has also been applied to measure the difference between sequencing coverage of each genome in a simulated metagenome sequencing data and an experimental data. In this case, each genome is divided into an array of windows with a certain size. The average number of reads per window is counted and normalized as the element of X and Y.</p>
    </sec>
    <sec id="s2g">
      <title>Machine Configurations</title>
      <p>All simulations listed in this paper are carried out on a CentOS 5.8 Linux machine with Xeon e7-4807 CPU, 64 GB memory and an NVIDIA Tesla C2050 GPU.</p>
    </sec>
  </sec>
  <sec id="s3">
    <title>Results</title>
    <sec id="s3a">
      <title>The Performance of NeSSM</title>
      <p>In order to evaluate the accuracy of NeSSM’s simulation, simulated reads were mapped to the genomes from which they were generated. For Dataset A, B, and C, two types of 454 sequencing reads were simulated with different parameter settings: 150,000 reads with an average read length of 100 bps, and 60,000 reads with an average read length of 250 bps. In total, 6 datasets were simulated. After simulating, Blast <xref rid="pone.0075448-Altschul1" ref-type="bibr">[35]</xref> was utilized to map those reads back to genomes with default parameters. Next, MEGAN <xref rid="pone.0075448-Huson1" ref-type="bibr">[36]</xref> was applied to check how many reads can be mapped back correctly to the genomes where they were generated. The rates of successfully mapped reads were calculated. As a result, most simulated reads could be mapped to their reference genomes, and a small proportion of simulated reads couldn’t be mapped back due to the sequencing errors (<xref ref-type="table" rid="pone-0075448-t002">Table 2</xref>). It demonstrated preliminarily that NeSSM could simulate metagenomic data with necessary sequencing errors and with fidelity as well. Results of simulation with Illumina platform was similar (data not shown).</p>
      <table-wrap id="pone-0075448-t002" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0075448.t002</object-id>
        <label>Table 2</label>
        <caption>
          <title>The proportions of unique, not unique and not hit reads for 454 simulation datasets from NeSSM.</title>
        </caption>
        <alternatives>
          <graphic id="pone-0075448-t002-2" xlink:href="pone.0075448.t002"/>
          <table frame="hsides" rules="groups">
            <colgroup span="1">
              <col align="left" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">read number</td>
                <td align="left" rowspan="1" colspan="1">% unique</td>
                <td align="left" rowspan="1" colspan="1">% not unique</td>
                <td align="left" rowspan="1" colspan="1">% not hit</td>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="left" rowspan="1" colspan="1">LC-100</td>
                <td align="left" rowspan="1" colspan="1">150,000</td>
                <td align="left" rowspan="1" colspan="1">99.936</td>
                <td align="left" rowspan="1" colspan="1">0</td>
                <td align="left" rowspan="1" colspan="1">0.064</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">LC-250</td>
                <td align="left" rowspan="1" colspan="1">60,000</td>
                <td align="left" rowspan="1" colspan="1">100</td>
                <td align="left" rowspan="1" colspan="1">0</td>
                <td align="left" rowspan="1" colspan="1">0</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">MC-100</td>
                <td align="left" rowspan="1" colspan="1">150,000</td>
                <td align="left" rowspan="1" colspan="1">78.116</td>
                <td align="left" rowspan="1" colspan="1">21.597</td>
                <td align="left" rowspan="1" colspan="1">0.287<xref ref-type="table-fn" rid="nt102">*</xref>
</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">MC-250</td>
                <td align="left" rowspan="1" colspan="1">60,000</td>
                <td align="left" rowspan="1" colspan="1">79.158</td>
                <td align="left" rowspan="1" colspan="1">20.83</td>
                <td align="left" rowspan="1" colspan="1">0.012</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">HC-100</td>
                <td align="left" rowspan="1" colspan="1">150,000</td>
                <td align="left" rowspan="1" colspan="1">99.299</td>
                <td align="left" rowspan="1" colspan="1">0.008</td>
                <td align="left" rowspan="1" colspan="1">0.693<xref ref-type="table-fn" rid="nt102">*</xref>
</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">HC-250</td>
                <td align="left" rowspan="1" colspan="1">60,000</td>
                <td align="left" rowspan="1" colspan="1">99.977</td>
                <td align="left" rowspan="1" colspan="1">0</td>
                <td align="left" rowspan="1" colspan="1">0.023</td>
              </tr>
            </tbody>
          </table>
        </alternatives>
        <table-wrap-foot>
          <fn id="nt101">
            <label/>
            <p>Unique: the read is mapped back only to its original genome; Not unique: the read is mapped back to more than one reference genomes; Not hit: the read can’t be mapped back to any reference genome. LC-100 is the simulated data from the low complexity metagenome (Dataset A) with read length 100 bps and other datasets are named similarly for simulated data derived from Dataset B and C.</p>
          </fn>
          <fn id="nt102">
            <label>*</label>
            <p>most reads of not hit are because of the repeats in the reads so that they can’t be mapped back uniquely by Blast.</p>
          </fn>
        </table-wrap-foot>
      </table-wrap>
      <p>Next, NeSSM’s ability to estimate and enforce the error models was evaluated using Dataset D. Error models were derived from Dataset D. These error models were then used by NeSSM to generate simulated reads. First we checked the total number of sequencing errors from the simulated data. The number of sequencing errors per read was 0.1461, which was consistent with the value derived from Dataset D directly (0.1452 errors per read). Next, the proportions of different type of errors (insertions, deletions and substitutions) were further investigated. As a result, the ratios of insertions, deletions and substitutions were 0.00498, 0.00985 and 0.98518 respectively in the simulation, and the ratios were 0.00489, 0.00997 and 0.98514 respectively in dataset D and their BC distance (see Methods part for more details) was 0.00012. In addition, substitution rates were also consistent with those estimated from Dataset D directly (<xref ref-type="table" rid="pone-0075448-t003">Table 3</xref>). Subsequently, the distributions of quality values were also evaluated based on the same simulated data and Dataset D. We showed that the distribution of quality values at each base didn’t follow a normal distribution (<xref ref-type="fig" rid="pone-0075448-g005">Figure 5A</xref>), nor was it fixed. In order to conquer this issue, an explicit distribution at each base was utilized in NeSSM and the simulation was consistent well with Dataset D (<xref ref-type="fig" rid="pone-0075448-g005">Figure 5A and 5B</xref>). It demonstrated NeSSM could simulate NGS sequencing reasonably.</p>
      <fig id="pone-0075448-g005" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0075448.g005</object-id>
        <label>Figure 5</label>
        <caption>
          <title>The comparison of distributions of quality values before and after simulation.</title>
          <p>A: the distributions of PHRED score from the dataset D at five different coordinates; B: the distributions of PHRED score in NeSSM’s simulation. The meaning of blue and red dots is the same as in <xref ref-type="fig" rid="pone-0075448-g002">Figure 2</xref>.</p>
        </caption>
        <graphic xlink:href="pone.0075448.g005"/>
      </fig>
      <table-wrap id="pone-0075448-t003" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0075448.t003</object-id>
        <label>Table 3</label>
        <caption>
          <title>The comparison of the proportions of different kinds of substitutions before and after simulation.</title>
        </caption>
        <alternatives>
          <graphic id="pone-0075448-t003-3" xlink:href="pone.0075448.t003"/>
          <table frame="hsides" rules="groups">
            <colgroup span="1">
              <col align="left" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">A</td>
                <td align="left" rowspan="1" colspan="1">T</td>
                <td align="left" rowspan="1" colspan="1">C</td>
                <td align="left" rowspan="1" colspan="1">G</td>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="left" rowspan="1" colspan="1">A</td>
                <td align="left" rowspan="1" colspan="1">
                  <inline-formula>
                    <inline-graphic xlink:href="pone.0075448.e013.jpg"/>
                  </inline-formula>
                </td>
                <td align="left" rowspan="1" colspan="1">
                  <inline-formula>
                    <inline-graphic xlink:href="pone.0075448.e014.jpg"/>
                  </inline-formula>
                </td>
                <td align="left" rowspan="1" colspan="1">
                  <inline-formula>
                    <inline-graphic xlink:href="pone.0075448.e015.jpg"/>
                  </inline-formula>
                </td>
                <td align="left" rowspan="1" colspan="1">
                  <inline-formula>
                    <inline-graphic xlink:href="pone.0075448.e016.jpg"/>
                  </inline-formula>
                </td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">T</td>
                <td align="left" rowspan="1" colspan="1">
                  <inline-formula>
                    <inline-graphic xlink:href="pone.0075448.e017.jpg"/>
                  </inline-formula>
                </td>
                <td align="left" rowspan="1" colspan="1">
                  <inline-formula>
                    <inline-graphic xlink:href="pone.0075448.e018.jpg"/>
                  </inline-formula>
                </td>
                <td align="left" rowspan="1" colspan="1">
                  <inline-formula>
                    <inline-graphic xlink:href="pone.0075448.e019.jpg"/>
                  </inline-formula>
                </td>
                <td align="left" rowspan="1" colspan="1">
                  <inline-formula>
                    <inline-graphic xlink:href="pone.0075448.e020.jpg"/>
                  </inline-formula>
                </td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">C</td>
                <td align="left" rowspan="1" colspan="1">
                  <inline-formula>
                    <inline-graphic xlink:href="pone.0075448.e021.jpg"/>
                  </inline-formula>
                </td>
                <td align="left" rowspan="1" colspan="1">
                  <inline-formula>
                    <inline-graphic xlink:href="pone.0075448.e022.jpg"/>
                  </inline-formula>
                </td>
                <td align="left" rowspan="1" colspan="1">
                  <inline-formula>
                    <inline-graphic xlink:href="pone.0075448.e023.jpg"/>
                  </inline-formula>
                </td>
                <td align="left" rowspan="1" colspan="1">
                  <inline-formula>
                    <inline-graphic xlink:href="pone.0075448.e024.jpg"/>
                  </inline-formula>
                </td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">G</td>
                <td align="left" rowspan="1" colspan="1">
                  <inline-formula>
                    <inline-graphic xlink:href="pone.0075448.e025.jpg"/>
                  </inline-formula>
                </td>
                <td align="left" rowspan="1" colspan="1">
                  <inline-formula>
                    <inline-graphic xlink:href="pone.0075448.e026.jpg"/>
                  </inline-formula>
                </td>
                <td align="left" rowspan="1" colspan="1">
                  <inline-formula>
                    <inline-graphic xlink:href="pone.0075448.e027.jpg"/>
                  </inline-formula>
                </td>
                <td align="left" rowspan="1" colspan="1">
                  <inline-formula>
                    <inline-graphic xlink:href="pone.0075448.e028.jpg"/>
                  </inline-formula>
                </td>
              </tr>
            </tbody>
          </table>
        </alternatives>
        <table-wrap-foot>
          <fn id="nt103">
            <label/>
            <p>The values above the black lines are estimated from Dataset D and the values below are calculated from NeSSM’s simulation. For example, the row of base “A” shows probabilities of substitutions errors from A to other bases.</p>
          </fn>
        </table-wrap-foot>
      </table-wrap>
      <p>Thirdly, we showed why explicit distribution was required for read length simulation, especially for 454 sequencing platform. <xref ref-type="fig" rid="pone-0075448-g006">Figure 6</xref> showed the distribution of reads length in the Dataset E (for 454 platform). The read length distribution in Dataset E was not a fixed length distribution, not a uniform distribution and not a normal distribution as well. Therefore, explicit length distribution was required for Dataset E and NeSSM was able to simulate reads with an arbitrary length distribution.</p>
      <fig id="pone-0075448-g006" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0075448.g006</object-id>
        <label>Figure 6</label>
        <caption>
          <title>The distributions of read lengths.</title>
          <p>X axis: the lengths of reads. Each interval is 10 bps. For example, every read with length from 100 bps to 109 bps is counted to the bin of 100 bps; Y axis: the number of reads with lengths in a certain interval. The distributions in NeSSM and GemSIM are close to the actual distribution in Dataset E.</p>
        </caption>
        <graphic xlink:href="pone.0075448.g006"/>
      </fig>
      <p>Finally, NeSSM’s ability to simulate sequencing coverage bias was evaluated. The composition structure table, error models and information of sequencing coverage bias were estimated from a mock data with 21 known organisms (Dataset F). Then, NeSSM simulated a metagenome. (Like in Dataset D, the ratios of insertions, deletions and substitutions were 0.0359, 0.0171 and 0.9470 respectively in the simulation, and the ratios were 0.0361, 0.0171 and 0.9468 respectively in dataset F. The BC distance of sequencing errors was 0.0002. In addition, substitutions rates were also consistent with those estimated from Dataset F directly (<xref ref-type="supplementary-material" rid="pone.0075448.s006">Table S5</xref>).) By mapping reads of Dataset F back to their reference genomes, we found that Acinetobacter baumannii (ATCC 17978) held the largest number of reads (<xref ref-type="supplementary-material" rid="pone.0075448.s005">Table S4</xref>). The sequencing coverage of the Acinetobacter baumannii in the simulation was compared with that in Dataset F. As shown in <xref ref-type="fig" rid="pone-0075448-g004">Figure 4A</xref>, the bias of sequencing coverage was significant in Dataset F. The sequencing coverage of the simulated reads was shown in <xref ref-type="fig" rid="pone-0075448-g004">Figure 4B</xref>. The BC distance and the correlation coefficient between the sequencing coverage of Acinetobacter baumannii in simulated data and Dataset F were 0.093 and 0.950 (calculated from the first 3,000 intervals), respectively. (The BC distances and the correlation coefficients between the sequencing coverage of other genomes in the simulated data and Dataset F were listed in <xref ref-type="supplementary-material" rid="pone.0075448.s007">Table S6</xref>.) Therefore, we demonstrated that NeSSM could simulate sequencing coverage bias. If there is no existing sequencing dataset available to estimate the sequencing coverage bias of related genomes, users can remove the NeSSM option “-b” to switch off the “sequencing coverage bias” correction feature. Some existing systems, such as pIRS <xref rid="pone.0075448-Hu1" ref-type="bibr">[22]</xref>, could simulate the sequencing coverage bias. However, pIRS only simulated pair-end reads and it was not designed for metagenome simulation. In order to test its performance in sequencing coverage bias, Acinetobacter baumannii (ATCC 17978) was simulated using pIRS with 606,771 reads (according to <xref ref-type="supplementary-material" rid="pone.0075448.s005">Table S4</xref> and the total reads in Dataset F). The error model was evaluated from Dataset F with scripts supplied by pIRS and only the forward reads in pair-end reads were considered. The result was in <xref ref-type="fig" rid="pone-0075448-g004">Figure 4F</xref>. NeSSM had a better performance than pIRS.</p>
    </sec>
    <sec id="s3b">
      <title>Comparison of NeSSM and Existing Simulation Systems</title>
      <p>NeSSM, MetaSim, GemSIM and Grinder were compared in terms of accuracy and speed. The accuracy evaluation was based on the fidelity of the simulation as well as the assembly results of simulations. The comparisons of the assembly of the simulations, the length distribution of reads and sequencing coverage bias are described below.</p>
      <p>First, MetaSim and Grinder utilized fixed probabilities to describe the errors at each base in different reads, while NeSSM and GemSIM utilized explicit distributions, which was more consistent with real sequencing data. Second, MetaSim, GemSIM and Grinder simulated all bases from a genome equally (<xref ref-type="fig" rid="pone-0075448-g004">Figure 4</xref>), while NeSSM could incorporate the sequencing coverage bias. Besides, NeSSM and GemSIM could simulate reads based on parameters estimated from an existing sequencing dataset. Moreover, NeSSM can extract the community composition from the sequencing dataset, which was quite useful. More comparison was in <xref ref-type="table" rid="pone-0075448-t004">Table 4</xref>.</p>
      <table-wrap id="pone-0075448-t004" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0075448.t004</object-id>
        <label>Table 4</label>
        <caption>
          <title>The comparison with existing simulation systems.</title>
        </caption>
        <alternatives>
          <graphic id="pone-0075448-t004-4" xlink:href="pone.0075448.t004"/>
          <table frame="hsides" rules="groups">
            <colgroup span="1">
              <col align="left" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <td align="left" rowspan="1" colspan="1">Systems</td>
                <td align="left" rowspan="1" colspan="1">NeSSM</td>
                <td align="left" rowspan="1" colspan="1">MetaSim</td>
                <td align="left" rowspan="1" colspan="1">GemSIM</td>
                <td align="left" rowspan="1" colspan="1">Grinder</td>
                <td align="left" rowspan="1" colspan="1">pIRS</td>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="left" rowspan="1" colspan="1">
                  <bold>Sequencing</bold>
                  <bold>platform</bold>
                </td>
                <td align="left" rowspan="1" colspan="1">454Illumina</td>
                <td align="left" rowspan="1" colspan="1">Sanger454Illumina</td>
                <td align="left" rowspan="1" colspan="1">454Illumina</td>
                <td align="left" rowspan="1" colspan="1">Sanger454Illumina</td>
                <td align="left" rowspan="1" colspan="1">Illumina</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">
                  <bold>Language</bold>
                </td>
                <td align="left" rowspan="1" colspan="1">C, PerlCUDA C</td>
                <td align="left" rowspan="1" colspan="1">Java</td>
                <td align="left" rowspan="1" colspan="1">Python</td>
                <td align="left" rowspan="1" colspan="1">Perl</td>
                <td align="left" rowspan="1" colspan="1">C++Perl</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">
                  <bold>Single or</bold>
                  <bold>pair-end</bold>
                </td>
                <td align="left" rowspan="1" colspan="1">Both</td>
                <td align="left" rowspan="1" colspan="1">Both</td>
                <td align="left" rowspan="1" colspan="1">Both</td>
                <td align="left" rowspan="1" colspan="1">Both</td>
                <td align="left" rowspan="1" colspan="1">Pair-end</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">
                  <bold>Error</bold>
                  <bold>Types</bold>
                </td>
                <td align="left" rowspan="1" colspan="1">IndelSubstitutionCoverage bias</td>
                <td align="left" rowspan="1" colspan="1">IndelSubstitutionHomopolymer</td>
                <td align="left" rowspan="1" colspan="1">IndelSubstitutionSNP</td>
                <td align="left" rowspan="1" colspan="1">IndelSubstitutionHomopolymer</td>
                <td align="left" rowspan="1" colspan="1">IndelSubstitutionCoverage bias</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">
                  <bold>Length</bold>
                  <bold>Distribution</bold>
                </td>
                <td align="left" rowspan="1" colspan="1">FixedNormalExplicit</td>
                <td align="left" rowspan="1" colspan="1">FixedNormal</td>
                <td align="left" rowspan="1" colspan="1">FixedExplicit</td>
                <td align="left" rowspan="1" colspan="1">FixedNormalUniform</td>
                <td align="left" rowspan="1" colspan="1">Fixed</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">
                  <bold>Output file</bold>
                </td>
                <td align="left" rowspan="1" colspan="1">FASTQ</td>
                <td align="left" rowspan="1" colspan="1">FASTA</td>
                <td align="left" rowspan="1" colspan="1">FASTQ</td>
                <td align="left" rowspan="1" colspan="1">FASTAFASTQ</td>
                <td align="left" rowspan="1" colspan="1">FASTQ</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">
                  <bold>Quality value</bold>
                  <bold>fixed</bold>
                  <xref ref-type="table-fn" rid="nt104">*</xref>
                </td>
                <td align="left" rowspan="1" colspan="1">No</td>
                <td align="left" rowspan="1" colspan="1">Yes</td>
                <td align="left" rowspan="1" colspan="1">No</td>
                <td align="left" rowspan="1" colspan="1">Yes</td>
                <td align="left" rowspan="1" colspan="1">No</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">
                  <bold>Application</bold>
                  <bold>Field</bold>
                </td>
                <td align="left" rowspan="1" colspan="1">Metagenome</td>
                <td align="left" rowspan="1" colspan="1">Metagenome</td>
                <td align="left" rowspan="1" colspan="1">Metagenome</td>
                <td align="left" rowspan="1" colspan="1">MetagenomeAmplicon</td>
                <td align="left" rowspan="1" colspan="1">Single genome</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">
                  <bold>Estimating error models</bold>
                  <xref ref-type="table-fn" rid="nt105">#</xref>
                </td>
                <td align="left" rowspan="1" colspan="1">Yes</td>
                <td align="left" rowspan="1" colspan="1">No</td>
                <td align="left" rowspan="1" colspan="1">Yes</td>
                <td align="left" rowspan="1" colspan="1">No</td>
                <td align="left" rowspan="1" colspan="1">Yes</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">
                  <bold>Operating system</bold>
                </td>
                <td align="left" rowspan="1" colspan="1">Linux</td>
                <td align="left" rowspan="1" colspan="1">LinuxWindowsMac</td>
                <td align="left" rowspan="1" colspan="1">Linux</td>
                <td align="left" rowspan="1" colspan="1">Linux</td>
                <td align="left" rowspan="1" colspan="1">Linux</td>
              </tr>
            </tbody>
          </table>
        </alternatives>
        <table-wrap-foot>
          <fn id="nt104">
            <label>*</label>
            <p>In a sequencing run, whether the quality value is fixed or not for the same positions in different reads;</p>
          </fn>
          <fn id="nt105">
            <label>#</label>
            <p>Whether the system supplies tools or not to estimate error models from an existing sequencing data.</p>
          </fn>
        </table-wrap-foot>
      </table-wrap>
      <p>The speed of NeSSM, MetaSim, GemSIM and Grinder was compared by simulating 90,000,000 reads on both Illumina platform (with read lengths of 36 bps) and 454 platform (with an average read length of 250 bps). NeSSM’s CPU version was more than 2.5 times faster than MetaSim and NeSSM’s GPU version was more than 18 times faster than MetaSim (<xref ref-type="table" rid="pone-0075448-t005">Table 5</xref>). The speed of GemSIM and Grinder was very slow even compared to that of MetaSim. Therefore, NeSSM could be very efficient to simulate large size datasets, especially when GPU card was available.</p>
      <table-wrap id="pone-0075448-t005" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0075448.t005</object-id>
        <label>Table 5</label>
        <caption>
          <title>Comparison of the speed of NeSSM (CPU and GPU versions) and existing tools on HC metagenome simulation.</title>
        </caption>
        <alternatives>
          <graphic id="pone-0075448-t005-5" xlink:href="pone.0075448.t005"/>
          <table frame="hsides" rules="groups">
            <colgroup span="1">
              <col align="left" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <td align="left" rowspan="1" colspan="1">Software</td>
                <td align="left" rowspan="1" colspan="1">Platform</td>
                <td align="left" rowspan="1" colspan="1">Read number</td>
                <td align="left" rowspan="1" colspan="1">Read length</td>
                <td align="left" rowspan="1" colspan="1">Time(s)</td>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="left" rowspan="1" colspan="1">
                  <bold>NeSSM_CPU</bold>
                </td>
                <td align="left" rowspan="1" colspan="1">Illumina</td>
                <td align="left" rowspan="1" colspan="1">90 million</td>
                <td align="left" rowspan="1" colspan="1">36</td>
                <td align="left" rowspan="1" colspan="1">763</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">
                  <bold>NeSSM_GPU</bold>
                </td>
                <td align="left" rowspan="1" colspan="1">Illumina</td>
                <td align="left" rowspan="1" colspan="1">90 million</td>
                <td align="left" rowspan="1" colspan="1">36</td>
                <td align="left" rowspan="1" colspan="1">200</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">
                  <bold>MetaSim</bold>
                </td>
                <td align="left" rowspan="1" colspan="1">Illumina</td>
                <td align="left" rowspan="1" colspan="1">90 million</td>
                <td align="left" rowspan="1" colspan="1">36</td>
                <td align="left" rowspan="1" colspan="1">3,821</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">
                  <bold>GemSIM</bold>
                  <xref ref-type="table-fn" rid="nt106">*</xref>
                </td>
                <td align="left" rowspan="1" colspan="1">Illumina</td>
                <td align="left" rowspan="1" colspan="1">90 million</td>
                <td align="left" rowspan="1" colspan="1">36</td>
                <td align="left" rowspan="1" colspan="1">90,600<xref ref-type="table-fn" rid="nt106">*</xref>
</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">
                  <bold>Grinder</bold>
                  <xref ref-type="table-fn" rid="nt106">*</xref>
                </td>
                <td align="left" rowspan="1" colspan="1">Illumina</td>
                <td align="left" rowspan="1" colspan="1">90 million</td>
                <td align="left" rowspan="1" colspan="1">36</td>
                <td align="left" rowspan="1" colspan="1">2,143,078<xref ref-type="table-fn" rid="nt106">*</xref>
</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">
                  <bold>NeSSM_CPU</bold>
                </td>
                <td align="left" rowspan="1" colspan="1">454</td>
                <td align="left" rowspan="1" colspan="1">90 million</td>
                <td align="left" rowspan="1" colspan="1">250</td>
                <td align="left" rowspan="1" colspan="1">5,560</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">
                  <bold>NeSSM_GPU</bold>
                </td>
                <td align="left" rowspan="1" colspan="1">454</td>
                <td align="left" rowspan="1" colspan="1">90 million</td>
                <td align="left" rowspan="1" colspan="1">250</td>
                <td align="left" rowspan="1" colspan="1">773</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">
                  <bold>MetaSim</bold>
                </td>
                <td align="left" rowspan="1" colspan="1">454</td>
                <td align="left" rowspan="1" colspan="1">90 million</td>
                <td align="left" rowspan="1" colspan="1">250</td>
                <td align="left" rowspan="1" colspan="1">13,968</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">
                  <bold>GemSIM</bold>
                  <xref ref-type="table-fn" rid="nt106">*</xref>
                </td>
                <td align="left" rowspan="1" colspan="1">454</td>
                <td align="left" rowspan="1" colspan="1">90 million</td>
                <td align="left" rowspan="1" colspan="1">250</td>
                <td align="left" rowspan="1" colspan="1">631,359<xref ref-type="table-fn" rid="nt106">*</xref>
</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">
                  <bold>Grinder</bold>
                  <xref ref-type="table-fn" rid="nt106">*</xref>
                </td>
                <td align="left" rowspan="1" colspan="1">454</td>
                <td align="left" rowspan="1" colspan="1">90 million</td>
                <td align="left" rowspan="1" colspan="1">250</td>
                <td align="left" rowspan="1" colspan="1">2,236,412<xref ref-type="table-fn" rid="nt106">*</xref>
</td>
              </tr>
            </tbody>
          </table>
        </alternatives>
        <table-wrap-foot>
          <fn id="nt106">
            <label>*</label>
            <p>predicted by a linear extension of the times for a series of small datasets.</p>
          </fn>
        </table-wrap-foot>
      </table-wrap>
      <p>The assembly results of NeSSM, MetaSim, GemSIM and Grinder simulation were also compared for both 454 platforms and Illumina platforms.</p>
      <p>For 454 platforms, Dataset E was used as a standard. First, with the community composition provided by <italic>Morgan et al.</italic>, 4 metagenomes were simulated by NeSSM, MetaSim, GemSIM and Grinder. Second, a re-estimated community composition table was generated from Dataset E using NeSSM. In order to investigate the impact of the re-estimation of community composition and compare different systems, other 4 metagenomes were simulated by NeSSM, MetaSim, GemSIM and Grinder with the re-estimated community composition table. In all simulations, MetaSim and Grinder used their own error models. NeSSM and GemSIM used the error models estimated from Dataset E. In order to be comparable, 475,694 reads (with average read lengths of 193 bps) were simulated for each dataset. Subsequently, these datasets were assembled by SOAPdenovo <xref rid="pone.0075448-Li3" ref-type="bibr">[37]</xref> with default parameters and statistics based on contigs with lengths greater than 300 bps were compared. The statistics of the contigs included 1, numbers of contigs; 2, average lengths of contigs; 3, N50s and 4, maximum lengths of contigs. The distributions of read length were also compared for those datasets generated by simulation systems (<xref ref-type="fig" rid="pone-0075448-g006">Figure 6</xref>).</p>
      <p>The re-estimated community composition was similar to the original one supplied by Morgan <italic>et al</italic>. (<xref ref-type="supplementary-material" rid="pone.0075448.s008">Table S7</xref>). The BC distance between the two community compositions was 0.02593. It demonstrated that community composition estimation system of NeSSM was reasonably effective. Subsequently, 8 simulated metagenomes were assembled by SOAPdenovo. Results of the assembly showed that metagenomic data simulated by NeSSM were much closer to Dataset E than those simulated by MetaSim, GemSIM and Grinder (<xref ref-type="table" rid="pone-0075448-t006">Table 6</xref> and <xref ref-type="supplementary-material" rid="pone.0075448.s009">S8</xref>). In addition, the performance of MetaSim, GemSIM, Grinder and NeSSM using the re-estimated community composition was comparable to those using the original community composition. It provided further evidence that community composition estimation system of NeSSM was effective.</p>
      <table-wrap id="pone-0075448-t006" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0075448.t006</object-id>
        <label>Table 6</label>
        <caption>
          <title>Comparison of NeSSM and existing tools (MetaSim, GemSIM and Grinders).</title>
        </caption>
        <alternatives>
          <graphic id="pone-0075448-t006-6" xlink:href="pone.0075448.t006"/>
          <table frame="hsides" rules="groups">
            <colgroup span="1">
              <col align="left" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">Number(contig length&gt; = 300 bps)</td>
                <td align="left" rowspan="1" colspan="1">Max contig length(bps)</td>
                <td align="left" rowspan="1" colspan="1">Average contig length(bps)</td>
                <td align="left" rowspan="1" colspan="1">N50(bps)</td>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="left" rowspan="1" colspan="1">
                  <bold>Dataset E</bold>
                </td>
                <td align="left" rowspan="1" colspan="1">24,999</td>
                <td align="left" rowspan="1" colspan="1">6,358</td>
                <td align="left" rowspan="1" colspan="1">709</td>
                <td align="left" rowspan="1" colspan="1">810</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">
                  <bold>NeSSM</bold>
                  <xref ref-type="table-fn" rid="nt108">#</xref>
                </td>
                <td align="left" rowspan="1" colspan="1">23,541</td>
                <td align="left" rowspan="1" colspan="1">5,712</td>
                <td align="left" rowspan="1" colspan="1">756</td>
                <td align="left" rowspan="1" colspan="1">881</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">
                  <bold>NeSSM*</bold>
                </td>
                <td align="left" rowspan="1" colspan="1">23,660</td>
                <td align="left" rowspan="1" colspan="1">5,905</td>
                <td align="left" rowspan="1" colspan="1">764</td>
                <td align="left" rowspan="1" colspan="1">894</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">
                  <bold>MetaSim</bold>
                  <xref ref-type="table-fn" rid="nt108">#</xref>
                </td>
                <td align="left" rowspan="1" colspan="1">10,578</td>
                <td align="left" rowspan="1" colspan="1">1,124</td>
                <td align="left" rowspan="1" colspan="1">391</td>
                <td align="left" rowspan="1" colspan="1">378</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">
                  <bold>MetaSim*</bold>
                </td>
                <td align="left" rowspan="1" colspan="1">10,792</td>
                <td align="left" rowspan="1" colspan="1">1,204</td>
                <td align="left" rowspan="1" colspan="1">390</td>
                <td align="left" rowspan="1" colspan="1">379</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">
                  <bold>GemSIM</bold>
                  <xref ref-type="table-fn" rid="nt108">#</xref>
                </td>
                <td align="left" rowspan="1" colspan="1">23,665</td>
                <td align="left" rowspan="1" colspan="1">2,680</td>
                <td align="left" rowspan="1" colspan="1">498</td>
                <td align="left" rowspan="1" colspan="1">504</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">
                  <bold>GemSIM*</bold>
                </td>
                <td align="left" rowspan="1" colspan="1">23,932</td>
                <td align="left" rowspan="1" colspan="1">3,111</td>
                <td align="left" rowspan="1" colspan="1">501</td>
                <td align="left" rowspan="1" colspan="1">507</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">
                  <bold>Grinder</bold>
                  <xref ref-type="table-fn" rid="nt108">#</xref>
                </td>
                <td align="left" rowspan="1" colspan="1">21,648</td>
                <td align="left" rowspan="1" colspan="1">2,247</td>
                <td align="left" rowspan="1" colspan="1">459</td>
                <td align="left" rowspan="1" colspan="1">457</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">
                  <bold>Grinder*</bold>
                </td>
                <td align="left" rowspan="1" colspan="1">21,876</td>
                <td align="left" rowspan="1" colspan="1">2,425</td>
                <td align="left" rowspan="1" colspan="1">463</td>
                <td align="left" rowspan="1" colspan="1">462</td>
              </tr>
            </tbody>
          </table>
        </alternatives>
        <table-wrap-foot>
          <fn id="nt107">
            <label/>
            <p><bold>Simulations are based on Dataset E, an artificial 454 metagenome.</bold> The number, average length and N50 of contigs are all calculated based on contigs longer than 300 bps.</p>
          </fn>
          <fn id="nt108">
            <label>#</label>
            <p>The community composition was supplied by Morgan et al; and * the community composition was re-estimated by NeSSM.</p>
          </fn>
        </table-wrap-foot>
      </table-wrap>
      <p>For Illumina platforms, NeSSM, MetaSim, GemSIM and Grinder were compared based on Dataset F (see Methods for details). First, a community composition was estimated with NeSSM. MetaSim and Grinder used their own error models. NeSSM and GemSIM used the estimated error models from Dataset F. In order to be comparable, 2,975,345 reads with length 75 bps were simulated by the four systems. SOAPdenovo with the default parameters was used to assemble the simulated datasets and Dataset F to evaluate the fidelity of simulation. The results showed that NeSSM simulated metagenomes better than MetaSim, GemSIM and Grinder (<xref ref-type="table" rid="pone-0075448-t007">Table 7</xref> and <xref ref-type="supplementary-material" rid="pone.0075448.s010">Table S9</xref>).</p>
      <table-wrap id="pone-0075448-t007" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0075448.t007</object-id>
        <label>Table 7</label>
        <caption>
          <title>Comparison of NeSSM and existing tools (MetaSim, GemSIM and Grinder) on Dataset F.</title>
        </caption>
        <alternatives>
          <graphic id="pone-0075448-t007-7" xlink:href="pone.0075448.t007"/>
          <table frame="hsides" rules="groups">
            <colgroup span="1">
              <col align="left" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">Number(contig length&gt; = 200 bps)</td>
                <td align="left" rowspan="1" colspan="1">Max contig length(bps)</td>
                <td align="left" rowspan="1" colspan="1">Average contig length(bps)</td>
                <td align="left" rowspan="1" colspan="1">N50(bps)</td>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="left" rowspan="1" colspan="1">
                  <bold>Dataset F</bold>
                </td>
                <td align="left" rowspan="1" colspan="1">37,011</td>
                <td align="left" rowspan="1" colspan="1">26,131</td>
                <td align="left" rowspan="1" colspan="1">554</td>
                <td align="left" rowspan="1" colspan="1">707</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">
                  <bold>NeSSM</bold>
                </td>
                <td align="left" rowspan="1" colspan="1">36,686</td>
                <td align="left" rowspan="1" colspan="1">53,469</td>
                <td align="left" rowspan="1" colspan="1">551</td>
                <td align="left" rowspan="1" colspan="1">685</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">
                  <bold>MetaSim</bold>
                </td>
                <td align="left" rowspan="1" colspan="1">33,720</td>
                <td align="left" rowspan="1" colspan="1">12,184</td>
                <td align="left" rowspan="1" colspan="1">627</td>
                <td align="left" rowspan="1" colspan="1">921</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">
                  <bold>GemSIM</bold>
                </td>
                <td align="left" rowspan="1" colspan="1">32,119</td>
                <td align="left" rowspan="1" colspan="1">46,796</td>
                <td align="left" rowspan="1" colspan="1">728</td>
                <td align="left" rowspan="1" colspan="1">1,350</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">
                  <bold>Grinder</bold>
                </td>
                <td align="left" rowspan="1" colspan="1">32,321</td>
                <td align="left" rowspan="1" colspan="1">58,173</td>
                <td align="left" rowspan="1" colspan="1">733</td>
                <td align="left" rowspan="1" colspan="1">1,391</td>
              </tr>
            </tbody>
          </table>
        </alternatives>
        <table-wrap-foot>
          <fn id="nt109">
            <label/>
            <p>The number, average and N50 are all based on those contigs of more than 200 bps.</p>
          </fn>
        </table-wrap-foot>
      </table-wrap>
    </sec>
    <sec id="s3c">
      <title>Using NeSSM to Evaluate Different Metagenome Assembly Methods</title>
      <p>NeSSM could be used to evaluate metagenome sequencing data analysis tools. Two assembly systems, SOAPdenovo and MetaVelvet <xref rid="pone.0075448-Namiki1" ref-type="bibr">[38]</xref> (based on Velvet <xref rid="pone.0075448-Zerbino1" ref-type="bibr">[39]</xref>), were evaluated. MetaVelvet was developed to assemble metagenomic data. However, SOAPdenovo was originally developed to assemble single genome.</p>
      <p>Several simulated datasets were created by NeSSM to evaluate two assembly systems. 3 million, 24 million and 30 million reads from Illumina sequencing platform with read length of 36 bps were simulated for Dataset A, B and C, respectively.</p>
      <p>The results of assembly were shown in <xref ref-type="table" rid="pone-0075448-t008">Table 8</xref>. Although MetaVelvet was created originally to assemble metagenomes and SOAPdenovo for single genomes, in most cases, the metagenome assembly results from SOAPdenovo were similar with MetaVelvet. Both SOAPdenovo and MetaVelvet got some contigs longer than 10,000 bps.</p>
      <table-wrap id="pone-0075448-t008" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0075448.t008</object-id>
        <label>Table 8</label>
        <caption>
          <title>Evaluation of assembly tools SOAPdenovo and MetaVelvet using simulation datasets.</title>
        </caption>
        <alternatives>
          <graphic id="pone-0075448-t008-8" xlink:href="pone.0075448.t008"/>
          <table frame="hsides" rules="groups">
            <colgroup span="1">
              <col align="left" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">LC</td>
                <td align="left" rowspan="1" colspan="1">MC</td>
                <td align="left" rowspan="1" colspan="1">HC</td>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="left" rowspan="1" colspan="1"><bold>Number</bold> (contig&gt; = 100 bps)</td>
                <td align="left" rowspan="1" colspan="1">SOAPdenovo</td>
                <td align="left" rowspan="1" colspan="1">1,324</td>
                <td align="left" rowspan="1" colspan="1">51,387</td>
                <td align="left" rowspan="1" colspan="1">52,710</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">MetaVelvet</td>
                <td align="left" rowspan="1" colspan="1">1,042</td>
                <td align="left" rowspan="1" colspan="1">55,497</td>
                <td align="left" rowspan="1" colspan="1">55,369</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1"><bold>Max contig length</bold>(bps)</td>
                <td align="left" rowspan="1" colspan="1">SOAPdenovo</td>
                <td align="left" rowspan="1" colspan="1">25,860</td>
                <td align="left" rowspan="1" colspan="1">51,815</td>
                <td align="left" rowspan="1" colspan="1">17,004</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">MetaVelvet</td>
                <td align="left" rowspan="1" colspan="1">25,859</td>
                <td align="left" rowspan="1" colspan="1">46,391</td>
                <td align="left" rowspan="1" colspan="1">18,570</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1"><bold>Average contig length</bold>(bps)</td>
                <td align="left" rowspan="1" colspan="1">SOAPdenovo</td>
                <td align="left" rowspan="1" colspan="1">1,875</td>
                <td align="left" rowspan="1" colspan="1">427</td>
                <td align="left" rowspan="1" colspan="1">824</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">MetaVelvet</td>
                <td align="left" rowspan="1" colspan="1">2,343</td>
                <td align="left" rowspan="1" colspan="1">400</td>
                <td align="left" rowspan="1" colspan="1">787</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1"><bold>N50</bold>(bps)</td>
                <td align="left" rowspan="1" colspan="1">SOAPdenovo</td>
                <td align="left" rowspan="1" colspan="1">6,361</td>
                <td align="left" rowspan="1" colspan="1">1,366</td>
                <td align="left" rowspan="1" colspan="1">1,279</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">MetaVelvet</td>
                <td align="left" rowspan="1" colspan="1">6,170</td>
                <td align="left" rowspan="1" colspan="1">1,051</td>
                <td align="left" rowspan="1" colspan="1">1,223</td>
              </tr>
            </tbody>
          </table>
        </alternatives>
        <table-wrap-foot>
          <fn id="nt110">
            <label/>
            <p>The number, average and N50 are all based on those contigs of more than 100 bps.</p>
          </fn>
        </table-wrap-foot>
      </table-wrap>
    </sec>
  </sec>
  <sec id="s4">
    <title>Discussion</title>
    <p>Evaluating the performance of methods for metagenome sequence analysis is an interesting problem with a large number of audiences. Simulation is still the most effective way to do it. However, simulating metagenome sequencing is not a straightforward task. Here we present a simulation system for next-generation sequencing of metagenomes. It has four highlights:</p>
    <list list-type="order">
      <list-item>
        <p>The community composition of a metagenome can be estimated from existing metagenomic data, which will make the simulated metagenome sequencing data more similar to the experimental metagenome sequencing data.</p>
      </list-item>
      <list-item>
        <p>Sequencing errors with an explicit distribution at each base are incorporated in the simulation, and they can be estimated from some initial sequencing results.</p>
      </list-item>
      <list-item>
        <p>Sequencing coverage bias may be also incorporated in the simulation.</p>
      </list-item>
      <list-item>
        <p>NeSSM is a fast tool for metagenome sequencing simulation. GPU version of NeSSM is more than one-order of magnitude faster than MetaSim.</p>
      </list-item>
    </list>
    <p>One of the systems similar to NeSSM is MetaSim. It provides a graphic interface for users. However, it does not provide a tool to simulate reads from existing metagenomic data and its error models are not flexible enough to represent the distribution of errors at each base, no sequencing quality value is simulated and the sequencing coverage bias is not fully covered in MetaSim. Other systems similar to NeSSM are GemSIM and Grinder. Their features were listed and compared in <xref ref-type="table" rid="pone-0075448-t004">Table 4</xref>.</p>
    <p>NeSSM is useful for development of tools in metagenomics and has been successfully used in the development of an ultra-fast metagenomic sequence classification system, MetaBinG <xref rid="pone.0075448-Jia1" ref-type="bibr">[31]</xref>.</p>
    <p>There are numerous metagenomics projects on going now. However, many questions exist. How deep should a metagenome be sequenced? What sequencing technologies (platforms) should be used? Which data analysis tool(s) should be used? And for selected tools, what values should be set for the parameters? It is difficult to answer any of these questions without simulations. Currently, people’s answers to these questions depend on their experiences rather than on calculation. It is time-consuming and cost-intensive to try and go experimentally. Our system adds one better option to test strategies of complicated metagenomics analysis based on simulations. Combining with other metagenomic analysis tools, NeSSM can be applied to determine some critical parameters for these projects. For example, if metagenome sequencing methods is applied to get the full genome sequence of an uncultured microbe, the minimum coverage of this genome or the number of reads for this genome is a critical parameter <xref rid="pone.0075448-Iverson1" ref-type="bibr">[40]</xref>, and it may be decided by simulations followed by subsequent analysis.</p>
    <p>However, NeSSM has limits, especially, for some samples where the number of complete genomes currently available is not enough to simulate a reasonable metagenome. For example, there are very few complete genomes that can be mapped with the shotgun sequencing data from some environments such as the rumen. Consequently, it’s hard to simulate a reasonable metagenome for those environments. In addition, only the organisms with complete genomes can be put in the reference database for the current version of NeSSM. In the near future, NeSSM should be extended to include organisms with contigs only in the reference database. Besides, the information of sequencing coverage bias can only be estimated from existing sequencing data using script provided by NeSSM. There are evidences that the sequence biases are affected by G+C content. The simulator pIRS uses the G+C content to simulate sequencing coverage <xref rid="pone.0075448-Benjamini1" ref-type="bibr">[41]</xref>, but the correlation is not very strong. Therefore, NeSSM still uses an explicit distribution for sequencing coverage bias.</p>
  </sec>
  <sec id="s5">
    <title>Conclusions</title>
    <p>In this paper, we present NeSSM, a fast Next-generation Sequencing Simulator for Metagenome sequencing with customizable community composition and estimated sequencing error models. Overall, NeSSM can be helpful to develop tools and to determine some critical parameters for projects based on metagenome sequencing.</p>
    <sec id="s5a">
      <title>Availability and Requirements</title>
      <p>The NeSSM system is available freely for academic users at <ext-link ext-link-type="uri" xlink:href="http://cbb.sjtu.edu.cn/~ccwei/pub/software/NeSSM.php">http://cbb.sjtu.edu.cn/~ccwei/pub/software/NeSSM.php</ext-link>. The simulated datasets and parameters used in this paper are also provided in this website. It was implemented with C programming language, CUDA (GPU version 4.0 or up) and Perl (5.8 or higher) in a Linux operating system.</p>
    </sec>
  </sec>
  <sec sec-type="supplementary-material" id="s6">
    <title>Supporting Information</title>
    <supplementary-material content-type="local-data" id="pone.0075448.s001">
      <label>Figure S1</label>
      <caption>
        <p>The distributions of quality values at each base plotted by vioplot.</p>
        <p>(TIF)</p>
      </caption>
      <media xlink:href="pone.0075448.s001.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0075448.s002">
      <label>Table S1</label>
      <caption>
        <p>A complete list of public datasets used in this paper.</p>
        <p>(XLSX)</p>
      </caption>
      <media xlink:href="pone.0075448.s002.xlsx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0075448.s003">
      <label>Table S2</label>
      <caption>
        <p>The proportions of substitution errors used in Illumina sequencing simulation.</p>
        <p>(DOCX)</p>
      </caption>
      <media xlink:href="pone.0075448.s003.docx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0075448.s004">
      <label>Table S3</label>
      <caption>
        <p>A complete list of genomes in LC, MC and HC datasets.</p>
        <p>(XLSX)</p>
      </caption>
      <media xlink:href="pone.0075448.s004.xlsx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0075448.s005">
      <label>Table S4</label>
      <caption>
        <p>Details of the mock Dataset F: species and their abundance estimated by NeSSM.</p>
        <p>(XLSX)</p>
      </caption>
      <media xlink:href="pone.0075448.s005.xlsx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0075448.s006">
      <label>Table S5</label>
      <caption>
        <p>The comparison of the proportions of different kinds of substitutions before and after simulation in Dataset F. The layout of this table is similar to that of <xref ref-type="table" rid="pone-0075448-t003">Table 3</xref>.</p>
        <p>(DOCX)</p>
      </caption>
      <media xlink:href="pone.0075448.s006.docx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0075448.s007">
      <label>Table S6</label>
      <caption>
        <p>The correlation coefficient and BC distance between the sequencing coverage bias of each genome in Dataset F and that in the simulated data.</p>
        <p>(XLSX)</p>
      </caption>
      <media xlink:href="pone.0075448.s007.xlsx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0075448.s008">
      <label>Table S7</label>
      <caption>
        <p>The community composition together with the abundance supplied by Morgan <italic>et al.</italic> and NeSSM.</p>
        <p>(XLSX)</p>
      </caption>
      <media xlink:href="pone.0075448.s008.xlsx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0075448.s009">
      <label>Table S8</label>
      <caption>
        <p>Comparison of assembly of NeSSM’s and existing tools’ (MetaSim, GemSIM and Grinder’s) simulation based on Dataset E.</p>
        <p>(XLSX)</p>
      </caption>
      <media xlink:href="pone.0075448.s009.xlsx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0075448.s010">
      <label>Table S9</label>
      <caption>
        <p>Comparison of assembly of NeSSM’s and existing tools’ (MetaSim, GemSIM and Grinder’s) simulation based on Dataset F.</p>
        <p>(XLSX)</p>
      </caption>
      <media xlink:href="pone.0075448.s010.xlsx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ref-list>
    <title>References</title>
    <ref id="pone.0075448-Suau1">
      <label>1</label>
      <mixed-citation publication-type="journal"><name><surname>Suau</surname><given-names>A</given-names></name>, <name><surname>Bonnet</surname><given-names>R</given-names></name>, <name><surname>Sutren</surname><given-names>M</given-names></name>, <name><surname>Godon</surname><given-names>JJ</given-names></name>, <name><surname>Gibson</surname><given-names>GR</given-names></name>, <etal>et al</etal> (<year>1999</year>) <article-title>Direct analysis of genes encoding 16S rRNA from complex communities reveals many novel molecular species within the human gut</article-title>. <source>Appl Environ Microbiol</source>
<volume>65</volume>: <fpage>4799</fpage>–<lpage>4807</lpage>.<pub-id pub-id-type="pmid">10543789</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0075448-Furrie1">
      <label>2</label>
      <mixed-citation publication-type="journal"><name><surname>Furrie</surname><given-names>E</given-names></name> (<year>2006</year>) <article-title>A molecular revolution in the study of intestinal microflora</article-title>. <source>Gut</source>
<volume>55</volume>: <fpage>141</fpage>–<lpage>143</lpage>.<pub-id pub-id-type="pmid">16407377</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0075448-Kowalchuk1">
      <label>3</label>
      <mixed-citation publication-type="journal"><name><surname>Kowalchuk</surname><given-names>GA</given-names></name>, <name><surname>Speksnijder</surname><given-names>AG</given-names></name>, <name><surname>Zhang</surname><given-names>K</given-names></name>, <name><surname>Goodman</surname><given-names>RM</given-names></name>, <name><surname>van Veen</surname><given-names>JA</given-names></name> (<year>2007</year>) <article-title>Finding the needles in the metagenome haystack</article-title>. <source>Microb Ecol</source>
<volume>53</volume>: <fpage>475</fpage>–<lpage>485</lpage>.<pub-id pub-id-type="pmid">17345132</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0075448-Yun1">
      <label>4</label>
      <mixed-citation publication-type="journal"><name><surname>Yun</surname><given-names>J</given-names></name>, <name><surname>Kang</surname><given-names>S</given-names></name>, <name><surname>Park</surname><given-names>S</given-names></name>, <name><surname>Yoon</surname><given-names>H</given-names></name>, <name><surname>Kim</surname><given-names>MJ</given-names></name>, <etal>et al</etal> (<year>2004</year>) <article-title>Characterization of a novel amylolytic enzyme encoded by a gene from a soil-derived metagenomic library</article-title>. <source>Appl Environ Microbiol</source>
<volume>70</volume>: <fpage>7229</fpage>–<lpage>7235</lpage>.<pub-id pub-id-type="pmid">15574921</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0075448-Ferrer1">
      <label>5</label>
      <mixed-citation publication-type="journal"><name><surname>Ferrer</surname><given-names>M</given-names></name>, <name><surname>Beloqui</surname><given-names>A</given-names></name>, <name><surname>Golyshina</surname><given-names>OV</given-names></name>, <name><surname>Plou</surname><given-names>FJ</given-names></name>, <name><surname>Neef</surname><given-names>A</given-names></name>, <etal>et al</etal> (<year>2007</year>) <article-title>Biochemical and structural features of a novel cyclodextrinase from cow rumen metagenome</article-title>. <source>Biotechnol J</source>
<volume>2</volume>: <fpage>207</fpage>–<lpage>213</lpage>.<pub-id pub-id-type="pmid">17238236</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0075448-Venter1">
      <label>6</label>
      <mixed-citation publication-type="journal"><name><surname>Venter</surname><given-names>JC</given-names></name>, <name><surname>Remington</surname><given-names>K</given-names></name>, <name><surname>Heidelberg</surname><given-names>JF</given-names></name>, <name><surname>Halpern</surname><given-names>AL</given-names></name>, <name><surname>Rusch</surname><given-names>D</given-names></name>, <etal>et al</etal> (<year>2004</year>) <article-title>Environmental genome shotgun sequencing of the Sargasso Sea</article-title>. <source>Science</source>
<volume>304</volume>: <fpage>66</fpage>–<lpage>74</lpage>.<pub-id pub-id-type="pmid">15001713</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0075448-Tyson1">
      <label>7</label>
      <mixed-citation publication-type="journal"><name><surname>Tyson</surname><given-names>GW</given-names></name>, <name><surname>Chapman</surname><given-names>J</given-names></name>, <name><surname>Hugenholtz</surname><given-names>P</given-names></name>, <name><surname>Allen</surname><given-names>EE</given-names></name>, <name><surname>Ram</surname><given-names>RJ</given-names></name>, <etal>et al</etal> (<year>2004</year>) <article-title>Community structure and metabolism through reconstruction of microbial genomes from the environment</article-title>. <source>Nature</source>
<volume>428</volume>: <fpage>37</fpage>–<lpage>43</lpage>.<pub-id pub-id-type="pmid">14961025</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0075448-Margulies1">
      <label>8</label>
      <mixed-citation publication-type="journal"><name><surname>Margulies</surname><given-names>M</given-names></name>, <name><surname>Egholm</surname><given-names>M</given-names></name>, <name><surname>Altman</surname><given-names>WE</given-names></name>, <name><surname>Attiya</surname><given-names>S</given-names></name>, <name><surname>Bader</surname><given-names>JS</given-names></name>, <etal>et al</etal> (<year>2005</year>) <article-title>Genome sequencing in microfabricated high-density picolitre reactors</article-title>. <source>Nature</source>
<volume>437</volume>: <fpage>376</fpage>–<lpage>380</lpage>.<pub-id pub-id-type="pmid">16056220</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0075448-Mardis1">
      <label>9</label>
      <mixed-citation publication-type="journal"><name><surname>Mardis</surname><given-names>ER</given-names></name> (<year>2008</year>) <article-title>The impact of next-generation sequencing technology on genetics</article-title>. <source>Trends Genet</source>
<volume>24</volume>: <fpage>133</fpage>–<lpage>141</lpage>.<pub-id pub-id-type="pmid">18262675</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0075448-Angiuoli1">
      <label>10</label>
      <mixed-citation publication-type="journal"><name><surname>Angiuoli</surname><given-names>SV</given-names></name>, <name><surname>White</surname><given-names>JR</given-names></name>, <name><surname>Matalka</surname><given-names>M</given-names></name>, <name><surname>White</surname><given-names>O</given-names></name>, <name><surname>Fricke</surname><given-names>WF</given-names></name> (<year>2011</year>) <article-title>Resources and costs for microbial sequence analysis evaluated using virtual machines and cloud computing</article-title>. <source>PLoS One</source>
<volume>6</volume>: <fpage>e26624</fpage>.<pub-id pub-id-type="pmid">22028928</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0075448-Nossa1">
      <label>11</label>
      <mixed-citation publication-type="journal"><name><surname>Nossa</surname><given-names>CW</given-names></name>, <name><surname>Oberdorf</surname><given-names>WE</given-names></name>, <name><surname>Yang</surname><given-names>L</given-names></name>, <name><surname>Aas</surname><given-names>JA</given-names></name>, <name><surname>Paster</surname><given-names>BJ</given-names></name>, <etal>et al</etal> (<year>2010</year>) <article-title>Design of 16S rRNA gene primers for 454 pyrosequencing of the human foregut microbiome</article-title>. <source>World J Gastroenterol</source>
<volume>16</volume>: <fpage>4135</fpage>–<lpage>4144</lpage>.<pub-id pub-id-type="pmid">20806429</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0075448-Mundry1">
      <label>12</label>
      <mixed-citation publication-type="journal"><name><surname>Mundry</surname><given-names>M</given-names></name>, <name><surname>Bornberg-Bauer</surname><given-names>E</given-names></name>, <name><surname>Sammeth</surname><given-names>M</given-names></name>, <name><surname>Feulner</surname><given-names>PG</given-names></name> (<year>2012</year>) <article-title>Evaluating characteristics of de novo assembly software on 454 transcriptome data: a simulation approach</article-title>. <source>PLoS One</source>
<volume>7</volume>: <fpage>e31410</fpage>.<pub-id pub-id-type="pmid">22384018</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0075448-Mende1">
      <label>13</label>
      <mixed-citation publication-type="journal"><name><surname>Mende</surname><given-names>DR</given-names></name>, <name><surname>Waller</surname><given-names>AS</given-names></name>, <name><surname>Sunagawa</surname><given-names>S</given-names></name>, <name><surname>Jarvelin</surname><given-names>AI</given-names></name>, <name><surname>Chan</surname><given-names>MM</given-names></name>, <etal>et al</etal> (<year>2012</year>) <article-title>Assessment of metagenomic assembly using simulated next generation sequencing data</article-title>. <source>PLoS One</source>
<volume>7</volume>: <fpage>e31386</fpage>.<pub-id pub-id-type="pmid">22384016</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0075448-Patil1">
      <label>14</label>
      <mixed-citation publication-type="journal"><name><surname>Patil</surname><given-names>KR</given-names></name>, <name><surname>Haider</surname><given-names>P</given-names></name>, <name><surname>Pope</surname><given-names>PB</given-names></name>, <name><surname>Turnbaugh</surname><given-names>PJ</given-names></name>, <name><surname>Morrison</surname><given-names>M</given-names></name>, <etal>et al</etal> (<year>2011</year>) <article-title>Taxonomic metagenome sequence assignment with structured output models</article-title>. <source>Nat Methods</source>
<volume>8</volume>: <fpage>191</fpage>–<lpage>192</lpage>.<pub-id pub-id-type="pmid">21358620</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0075448-Quince1">
      <label>15</label>
      <mixed-citation publication-type="journal"><name><surname>Quince</surname><given-names>C</given-names></name>, <name><surname>Lanzen</surname><given-names>A</given-names></name>, <name><surname>Curtis</surname><given-names>TP</given-names></name>, <name><surname>Davenport</surname><given-names>RJ</given-names></name>, <name><surname>Hall</surname><given-names>N</given-names></name>, <etal>et al</etal> (<year>2009</year>) <article-title>Accurate determination of microbial diversity from 454 pyrosequencing data</article-title>. <source>Nat Methods</source>
<volume>6</volume>: <fpage>639</fpage>–<lpage>641</lpage>.<pub-id pub-id-type="pmid">19668203</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0075448-McElroy1">
      <label>16</label>
      <mixed-citation publication-type="journal"><name><surname>McElroy</surname><given-names>KE</given-names></name>, <name><surname>Luciani</surname><given-names>F</given-names></name>, <name><surname>Thomas</surname><given-names>T</given-names></name> (<year>2012</year>) <article-title>GemSIM: general, error-model based simulator of next-generation sequencing data</article-title>. <source>BMC Genomics</source>
<volume>13</volume>: <fpage>74</fpage>.<pub-id pub-id-type="pmid">22336055</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0075448-Harismendy1">
      <label>17</label>
      <mixed-citation publication-type="journal"><name><surname>Harismendy</surname><given-names>O</given-names></name>, <name><surname>Ng</surname><given-names>PC</given-names></name>, <name><surname>Strausberg</surname><given-names>RL</given-names></name>, <name><surname>Wang</surname><given-names>X</given-names></name>, <name><surname>Stockwell</surname><given-names>TB</given-names></name>, <etal>et al</etal> (<year>2009</year>) <article-title>Evaluation of next generation sequencing platforms for population targeted sequencing studies</article-title>. <source>Genome Biol</source>
<volume>10</volume>: <fpage>R32</fpage>.<pub-id pub-id-type="pmid">19327155</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0075448-Willerth1">
      <label>18</label>
      <mixed-citation publication-type="journal"><name><surname>Willerth</surname><given-names>SM</given-names></name>, <name><surname>Pedro</surname><given-names>HA</given-names></name>, <name><surname>Pachter</surname><given-names>L</given-names></name>, <name><surname>Humeau</surname><given-names>LM</given-names></name>, <name><surname>Arkin</surname><given-names>AP</given-names></name>, <etal>et al</etal> (<year>2010</year>) <article-title>Development of a low bias method for characterizing viral populations using next generation sequencing technology</article-title>. <source>PLoS One</source>
<volume>5</volume>: <fpage>e13564</fpage>.<pub-id pub-id-type="pmid">21042592</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0075448-Peterson1">
      <label>19</label>
      <mixed-citation publication-type="journal"><name><surname>Peterson</surname><given-names>J</given-names></name>, <name><surname>Garges</surname><given-names>S</given-names></name>, <name><surname>Giovanni</surname><given-names>M</given-names></name>, <name><surname>McInnes</surname><given-names>P</given-names></name>, <name><surname>Wang</surname><given-names>L</given-names></name>, <etal>et al</etal> (<year>2009</year>) <article-title>The NIH Human Microbiome Project</article-title>. <source>Genome Res</source>
<volume>19</volume>: <fpage>2317</fpage>–<lpage>2323</lpage>.<pub-id pub-id-type="pmid">19819907</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0075448-Wu1">
      <label>20</label>
      <mixed-citation publication-type="journal"><name><surname>Wu</surname><given-names>D</given-names></name>, <name><surname>Hugenholtz</surname><given-names>P</given-names></name>, <name><surname>Mavromatis</surname><given-names>K</given-names></name>, <name><surname>Pukall</surname><given-names>R</given-names></name>, <name><surname>Dalin</surname><given-names>E</given-names></name>, <etal>et al</etal> (<year>2009</year>) <article-title>A phylogeny-driven genomic encyclopaedia of Bacteria and Archaea</article-title>. <source>Nature</source>
<volume>462</volume>: <fpage>1056</fpage>–<lpage>1060</lpage>.<pub-id pub-id-type="pmid">20033048</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0075448-Huang1">
      <label>21</label>
      <mixed-citation publication-type="journal"><name><surname>Huang</surname><given-names>W</given-names></name>, <name><surname>Li</surname><given-names>L</given-names></name>, <name><surname>Myers</surname><given-names>JR</given-names></name>, <name><surname>Marth</surname><given-names>GT</given-names></name> (<year>2012</year>) <article-title>ART: a next-generation sequencing read simulator</article-title>. <source>Bioinformatics</source>
<volume>28</volume>: <fpage>593</fpage>–<lpage>594</lpage>.<pub-id pub-id-type="pmid">22199392</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0075448-Hu1">
      <label>22</label>
      <mixed-citation publication-type="journal"><name><surname>Hu</surname><given-names>X</given-names></name>, <name><surname>Yuan</surname><given-names>J</given-names></name>, <name><surname>Shi</surname><given-names>Y</given-names></name>, <name><surname>Lu</surname><given-names>J</given-names></name>, <name><surname>Liu</surname><given-names>B</given-names></name>, <etal>et al</etal> (<year>2012</year>) <article-title>pIRS: Profile-based Illumina pair-end reads simulator</article-title>. <source>Bioinformatics</source>
<volume>28</volume>: <fpage>1533</fpage>–<lpage>1535</lpage>.<pub-id pub-id-type="pmid">22508794</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0075448-Richter1">
      <label>23</label>
      <mixed-citation publication-type="journal"><name><surname>Richter</surname><given-names>DC</given-names></name>, <name><surname>Ott</surname><given-names>F</given-names></name>, <name><surname>Auch</surname><given-names>AF</given-names></name>, <name><surname>Schmid</surname><given-names>R</given-names></name>, <name><surname>Huson</surname><given-names>DH</given-names></name> (<year>2008</year>) <article-title>MetaSim: a sequencing simulator for genomics and metagenomics</article-title>. <source>PLoS One</source>
<volume>3</volume>: <fpage>e3373</fpage>.<pub-id pub-id-type="pmid">18841204</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0075448-Angly1">
      <label>24</label>
      <mixed-citation publication-type="journal"><name><surname>Angly</surname><given-names>FE</given-names></name>, <name><surname>Willner</surname><given-names>D</given-names></name>, <name><surname>Rohwer</surname><given-names>F</given-names></name>, <name><surname>Hugenholtz</surname><given-names>P</given-names></name>, <name><surname>Tyson</surname><given-names>GW</given-names></name> (<year>2012</year>) <article-title>Grinder: a versatile amplicon and shotgun sequence simulator</article-title>. <source>Nucleic Acids Res</source>
<volume>40</volume>: <fpage>e94</fpage>.<pub-id pub-id-type="pmid">22434876</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0075448-Li1">
      <label>25</label>
      <mixed-citation publication-type="journal"><name><surname>Li</surname><given-names>H</given-names></name>, <name><surname>Durbin</surname><given-names>R</given-names></name> (<year>2009</year>) <article-title>Fast and accurate short read alignment with Burrows-Wheeler transform</article-title>. <source>Bioinformatics</source>
<volume>25</volume>: <fpage>1754</fpage>–<lpage>1760</lpage>.<pub-id pub-id-type="pmid">19451168</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0075448-Cock1">
      <label>26</label>
      <mixed-citation publication-type="journal"><name><surname>Cock</surname><given-names>PJ</given-names></name>, <name><surname>Fields</surname><given-names>CJ</given-names></name>, <name><surname>Goto</surname><given-names>N</given-names></name>, <name><surname>Heuer</surname><given-names>ML</given-names></name>, <name><surname>Rice</surname><given-names>PM</given-names></name> (<year>2010</year>) <article-title>The Sanger FASTQ file format for sequences with quality scores, and the Solexa/Illumina FASTQ variants</article-title>. <source>Nucleic Acids Res</source>
<volume>38</volume>: <fpage>1767</fpage>–<lpage>1771</lpage>.<pub-id pub-id-type="pmid">20015970</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0075448-Ewing1">
      <label>27</label>
      <mixed-citation publication-type="journal"><name><surname>Ewing</surname><given-names>B</given-names></name>, <name><surname>Green</surname><given-names>P</given-names></name> (<year>1998</year>) <article-title>Base-calling of automated sequencer traces using phred. II. Error probabilities</article-title>. <source>Genome Res</source>
<volume>8</volume>: <fpage>186</fpage>–<lpage>194</lpage>.<pub-id pub-id-type="pmid">9521922</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0075448-Li2">
      <label>28</label>
      <mixed-citation publication-type="journal"><name><surname>Li</surname><given-names>H</given-names></name>, <name><surname>Handsaker</surname><given-names>B</given-names></name>, <name><surname>Wysoker</surname><given-names>A</given-names></name>, <name><surname>Fennell</surname><given-names>T</given-names></name>, <name><surname>Ruan</surname><given-names>J</given-names></name>, <etal>et al</etal> (<year>2009</year>) <article-title>The Sequence Alignment/Map format and SAMtools</article-title>. <source>Bioinformatics</source>
<volume>25</volume>: <fpage>2078</fpage>–<lpage>2079</lpage>.<pub-id pub-id-type="pmid">19505943</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0075448-Liu1">
      <label>29</label>
      <mixed-citation publication-type="journal"><name><surname>Liu</surname><given-names>CM</given-names></name>, <name><surname>Wong</surname><given-names>T</given-names></name>, <name><surname>Wu</surname><given-names>E</given-names></name>, <name><surname>Luo</surname><given-names>R</given-names></name>, <name><surname>Yiu</surname><given-names>SM</given-names></name>, <etal>et al</etal> (<year>2012</year>) <article-title>SOAP3: ultra-fast GPU-based parallel alignment tool for short reads</article-title>. <source>Bioinformatics</source>
<volume>28</volume>: <fpage>878</fpage>–<lpage>879</lpage>.<pub-id pub-id-type="pmid">22285832</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0075448-Su1">
      <label>30</label>
      <mixed-citation publication-type="journal"><name><surname>Su</surname><given-names>X</given-names></name>, <name><surname>Xu</surname><given-names>J</given-names></name>, <name><surname>Ning</surname><given-names>K</given-names></name> (<year>2012</year>) <article-title>Parallel-META: efficient metagenomic data analysis based on high-performance computation</article-title>. <source>BMC Syst Biol</source>
<volume>6</volume> Suppl 1<fpage>S16</fpage>.</mixed-citation>
    </ref>
    <ref id="pone.0075448-Jia1">
      <label>31</label>
      <mixed-citation publication-type="journal"><name><surname>Jia</surname><given-names>P</given-names></name>, <name><surname>Xuan</surname><given-names>L</given-names></name>, <name><surname>Liu</surname><given-names>L</given-names></name>, <name><surname>Wei</surname><given-names>C</given-names></name> (<year>2011</year>) <article-title>MetaBinG: using GPUs to accelerate metagenomic sequence classification</article-title>. <source>PLoS One</source>
<volume>6</volume>: <fpage>e25353</fpage>.<pub-id pub-id-type="pmid">22132069</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0075448-Morgan1">
      <label>32</label>
      <mixed-citation publication-type="journal"><name><surname>Morgan</surname><given-names>JL</given-names></name>, <name><surname>Darling</surname><given-names>AE</given-names></name>, <name><surname>Eisen</surname><given-names>JA</given-names></name> (<year>2010</year>) <article-title>Metagenomic sequencing of an in vitro-simulated microbial community</article-title>. <source>PLoS One</source>
<volume>5</volume>: <fpage>e10209</fpage>.<pub-id pub-id-type="pmid">20419134</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0075448-Patel1">
      <label>33</label>
      <mixed-citation publication-type="journal"><name><surname>Patel</surname><given-names>RK</given-names></name>, <name><surname>Jain</surname><given-names>M</given-names></name> (<year>2012</year>) <article-title>NGS QC Toolkit: a toolkit for quality control of next generation sequencing data</article-title>. <source>PLoS One</source>
<volume>7</volume>: <fpage>e30619</fpage>.<pub-id pub-id-type="pmid">22312429</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0075448-Legendre1">
      <label>34</label>
      <mixed-citation publication-type="book">Legendre P, Legendre L (1998) Numerical ecology. Amsterdam; New York: Elsevier. xv, 853 p.</mixed-citation>
    </ref>
    <ref id="pone.0075448-Altschul1">
      <label>35</label>
      <mixed-citation publication-type="journal"><name><surname>Altschul</surname><given-names>SF</given-names></name>, <name><surname>Gish</surname><given-names>W</given-names></name>, <name><surname>Miller</surname><given-names>W</given-names></name>, <name><surname>Myers</surname><given-names>EW</given-names></name>, <name><surname>Lipman</surname><given-names>DJ</given-names></name> (<year>1990</year>) <article-title>Basic local alignment search tool</article-title>. <source>J Mol Biol</source>
<volume>215</volume>: <fpage>403</fpage>–<lpage>410</lpage>.<pub-id pub-id-type="pmid">2231712</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0075448-Huson1">
      <label>36</label>
      <mixed-citation publication-type="journal"><name><surname>Huson</surname><given-names>DH</given-names></name>, <name><surname>Auch</surname><given-names>AF</given-names></name>, <name><surname>Qi</surname><given-names>J</given-names></name>, <name><surname>Schuster</surname><given-names>SC</given-names></name> (<year>2007</year>) <article-title>MEGAN analysis of metagenomic data</article-title>. <source>Genome Res</source>
<volume>17</volume>: <fpage>377</fpage>–<lpage>386</lpage>.<pub-id pub-id-type="pmid">17255551</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0075448-Li3">
      <label>37</label>
      <mixed-citation publication-type="journal"><name><surname>Li</surname><given-names>R</given-names></name>, <name><surname>Zhu</surname><given-names>H</given-names></name>, <name><surname>Ruan</surname><given-names>J</given-names></name>, <name><surname>Qian</surname><given-names>W</given-names></name>, <name><surname>Fang</surname><given-names>X</given-names></name>, <etal>et al</etal> (<year>2010</year>) <article-title>De novo assembly of human genomes with massively parallel short read sequencing</article-title>. <source>Genome Res</source>
<volume>20</volume>: <fpage>265</fpage>–<lpage>272</lpage>.<pub-id pub-id-type="pmid">20019144</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0075448-Namiki1">
      <label>38</label>
      <mixed-citation publication-type="journal"><name><surname>Namiki</surname><given-names>T</given-names></name>, <name><surname>Hachiya</surname><given-names>T</given-names></name>, <name><surname>Tanaka</surname><given-names>H</given-names></name>, <name><surname>Sakakibara</surname><given-names>Y</given-names></name> (<year>2012</year>) <article-title>MetaVelvet: an extension of Velvet assembler to de novo metagenome assembly from short sequence reads</article-title>. <source>Nucleic Acids Res</source>
<volume>40</volume>: <fpage>e155</fpage>.<pub-id pub-id-type="pmid">22821567</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0075448-Zerbino1">
      <label>39</label>
      <mixed-citation publication-type="journal"><name><surname>Zerbino</surname><given-names>DR</given-names></name>, <name><surname>Birney</surname><given-names>E</given-names></name> (<year>2008</year>) <article-title>Velvet: algorithms for de novo short read assembly using de Bruijn graphs</article-title>. <source>Genome Res</source>
<volume>18</volume>: <fpage>821</fpage>–<lpage>829</lpage>.<pub-id pub-id-type="pmid">18349386</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0075448-Iverson1">
      <label>40</label>
      <mixed-citation publication-type="journal"><name><surname>Iverson</surname><given-names>V</given-names></name>, <name><surname>Morris</surname><given-names>RM</given-names></name>, <name><surname>Frazar</surname><given-names>CD</given-names></name>, <name><surname>Berthiaume</surname><given-names>CT</given-names></name>, <name><surname>Morales</surname><given-names>RL</given-names></name>, <etal>et al</etal> (<year>2012</year>) <article-title>Untangling genomes from metagenomes: revealing an uncultured class of marine Euryarchaeota</article-title>. <source>Science</source>
<volume>335</volume>: <fpage>587</fpage>–<lpage>590</lpage>.<pub-id pub-id-type="pmid">22301318</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0075448-Benjamini1">
      <label>41</label>
      <mixed-citation publication-type="journal"><name><surname>Benjamini</surname><given-names>Y</given-names></name>, <name><surname>Speed</surname><given-names>TP</given-names></name> (<year>2012</year>) <article-title>Summarizing and correcting the GC content bias in high-throughput sequencing</article-title>. <source>Nucleic Acids Res</source>
<volume>40</volume>: <fpage>e72</fpage>.<pub-id pub-id-type="pmid">22323520</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0075448-Hintze1">
      <label>42</label>
      <mixed-citation publication-type="journal"><name><surname>Hintze</surname><given-names>JL</given-names></name>, <name><surname>Nelson</surname><given-names>RD</given-names></name> (<year>1998</year>) <article-title>Violin plots: A box plot-density trace synergism</article-title>. <source>American Statistician</source>
<volume>52</volume>: <fpage>181</fpage>–<lpage>184</lpage>.</mixed-citation>
    </ref>
  </ref-list>
</back>
