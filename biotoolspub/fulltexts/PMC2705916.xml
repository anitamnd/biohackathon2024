<?properties open_access?>
<?properties manuscript?>
<?iso-abbr Heredity (Edinb)?>
<?submitter-system ukmss?>
<?submitter-canonical-name Nature Publishing Group?>
<?submitter-canonical-id NATURE-STRUCTUR?>
<?submitter-userid 1005?>
<?submitter-authority publisher?>
<?submitter-login NPG?>
<?submitter-name Nature Publishing Group?>
<?origin ukpmcpa?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-journal-id">0373007</journal-id>
    <journal-id journal-id-type="pubmed-jr-id">4023</journal-id>
    <journal-id journal-id-type="nlm-ta">Heredity (Edinb)</journal-id>
    <journal-id journal-id-type="iso-abbrev">Heredity (Edinb)</journal-id>
    <journal-title-group>
      <journal-title>Heredity</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">0018-067X</issn>
    <issn pub-type="epub">1365-2540</issn>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">2705916</article-id>
    <article-id pub-id-type="pmid">19337306</article-id>
    <article-id pub-id-type="doi">10.1038/hdy.2009.29</article-id>
    <article-id pub-id-type="manuscript">wtpa3290</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>An agglomerative hierarchical clustering approach to visualisation in Bayesian clustering problems</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Dawson</surname>
          <given-names>Kevin J.</given-names>
        </name>
        <xref ref-type="aff" rid="A2">†</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Belkhir</surname>
          <given-names>Khalid</given-names>
        </name>
        <xref ref-type="aff" rid="A1">*</xref>
      </contrib>
    </contrib-group>
    <aff id="A1"><label>*</label>Institut des Sciences de l’Evolution, UM2-CNRS UMR 5554, Université de Montpellier II, Montpellier, France
</aff>
    <aff id="A2"><label>†</label>Centre for Mathematical and Computational Biology, Rothamsted Research, Harpenden, Hertfordshire AL5 2JQ, UK
</aff>
    <author-notes>
      <corresp id="CR1">Corresponding author: Kevin J. Dawson, Centre for Mathematical and Computational Biology, Rothamsted Research, West Common, Harpenden, Hertfordshire, AL5 2JQ, United Kingdom, Phone: +44 1582 763133 (Ex. 2281), Fax: +44 1582 760981, Email: <email>kevin.dawson@bbsrc.ac.uk</email></corresp>
    </author-notes>
    <pub-date pub-type="nihms-submitted">
      <day>21</day>
      <month>4</month>
      <year>2009</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>01</day>
      <month>4</month>
      <year>2009</year>
    </pub-date>
    <pub-date pub-type="ppub">
      <month>7</month>
      <year>2009</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>01</day>
      <month>1</month>
      <year>2010</year>
    </pub-date>
    <volume>103</volume>
    <issue>1</issue>
    <fpage>32</fpage>
    <lpage>45</lpage>
    <abstract>
      <p id="P1">Clustering problems (including the clustering of individuals into outcrossing populations, hybrid generations, full-sib families and selfing lines) have recently received much attention in population genetics. In these clustering problems, the parameter of interest is a partition of the set of sampled individuals, - the <italic>sample partition</italic>. In a fully Bayesian approach to clustering problems of this type, our knowledge about the sample partition is represented by a probability distribution on the space of possible sample partitions. Since the number of possible partitions grows very rapidly with the sample size, we can not visualise this probability distribution in its entirety, unless the sample is very small. As a solution to this visualisation problem, we recommend using an agglomerative hierarchical clustering algorithm, which we call the <italic>exact linkage algorithm</italic>. This algorithm is a special case of the maximin clustering algorithm that we introduced previously. The exact linkage algorithm is now implemented in our software package <italic>Partition View</italic>.</p>
      <p id="P2">The exact linkage algorithm takes the posterior co-assignment probabilities as input, and yields as output a rooted binary tree, - or more generally, a forest of such trees. Each node of this forest defines a set of individuals, and the node height is the posterior co-assignment probability of this set. This provides a useful visual representation of the uncertainty associated with the assignment of individuals to categories. It is also a useful starting point for a more detailed exploration of the posterior distribution in terms of the co-assignment probabilities.</p>
    </abstract>
    <kwd-group>
      <kwd>Bayesian clustering</kwd>
      <kwd>hierarchical clustering</kwd>
      <kwd>label switching</kwd>
      <kwd>MCMC</kwd>
      <kwd>population genetics</kwd>
      <kwd>visualisation</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source country="United Kingdom">Biotechnology and Biological Sciences Research Council : </funding-source>
        <award-id>D16977 || BB_</award-id>
      </award-group>
    </funding-group>
  </article-meta>
</front>
<body>
  <sec sec-type="intro" id="S1">
    <title>1 Introduction</title>
    <p id="P3">In a clustering problem we have a collection of individuals (the sample) which must be classified into mutually exclusive categories. In general the number of categories represented in the sample, and the characteristics of these categories, are uncertain. Problems of this type have recently received much attention in population genetics, where the data available from the sampled individuals include their genotypes at a number of marker loci. (Other types of data which may be available include the spatial positions of individuals, and observations of their behaviour.) Examples include the following. (i) Clustering individuals from an outcrossing species into putative populations (represented approximately as panmictic populations). These putative populations may correspond to subspecies, or even individual spawning grounds or breeding sites (for example, in phylopatric species of fish, amphibians or marine turtles). For Bayesian approaches to these problems, see <xref ref-type="bibr" rid="R32">Pritchard et al. (2000)</xref>; <xref ref-type="bibr" rid="R12">Dawson and Belkhir (2001)</xref>; <xref ref-type="bibr" rid="R17">Falush et al. (2003)</xref>; Corander et al. (<xref ref-type="bibr" rid="R10">2003</xref>, <xref ref-type="bibr" rid="R9">2004</xref>, <xref ref-type="bibr" rid="R8">2006</xref>); <xref ref-type="bibr" rid="R7">Corander and Marttinen (2006)</xref>; <xref ref-type="bibr" rid="R31">Pella and Masuda (2006)</xref>; <xref ref-type="bibr" rid="R24">Huelsenbeck et al. (2007)</xref>. Methods are also available which make use of spatial position data in addition to genotype data from the sampled individuals (<xref ref-type="bibr" rid="R22">Guillot et al., 2005</xref>; <xref ref-type="bibr" rid="R20">François et al., 2006</xref>; <xref ref-type="bibr" rid="R6">Chen et al., 2007</xref>). (In the earlier work of <xref ref-type="bibr" rid="R45">Wasser et al. (2004)</xref>, individuals were not classified into discrete populations.) (ii) The more general problem of clustering individuals from an outcrossing species into hybrid generations, including F1, F2, and B1 crosses, as well as parental populations has been addressed by <xref ref-type="bibr" rid="R3">Anderson and Thompson (2002)</xref>. <xref ref-type="bibr" rid="R17">Falush et al. (2003)</xref> also allow for the possibility that the sample contains individuals of hybrid origin. (iii) Clustering individuals into (full-sib) families (<xref ref-type="bibr" rid="R30">Painter, 1997</xref>; <xref ref-type="bibr" rid="R2">Almudevar and Field, 1999</xref>; <xref ref-type="bibr" rid="R42">Thomas and Hill, 2000</xref>, <xref ref-type="bibr" rid="R43">2002</xref>; <xref ref-type="bibr" rid="R16">Emery et al., 2001</xref>; <xref ref-type="bibr" rid="R44">Wang, 2004</xref>; <xref ref-type="bibr" rid="R23">Hadfield et al., 2006</xref>). <xref ref-type="bibr" rid="R30">Painter (1997)</xref>; <xref ref-type="bibr" rid="R42">Thomas and Hill (2000)</xref>; <xref ref-type="bibr" rid="R36">Smith et al. (2001)</xref> assumed that the separate full-sib families do not share any parents in common. <xref ref-type="bibr" rid="R43">Thomas and Hill (2002)</xref> and <xref ref-type="bibr" rid="R44">Wang (2004)</xref> imposed the weaker constraint that parents of only one sex are permitted to have multiple mates. <xref ref-type="bibr" rid="R16">Emery et al. (2001)</xref> imposed no constraints on the matings among parents. <xref ref-type="bibr" rid="R23">Hadfield et al. (2006)</xref> incorporated spatial information on the territories occupied by individuals. (iv) Clustering individuals from a partially selfing population into selfing lines (<xref ref-type="bibr" rid="R46">Wilson and Dawson, 2007</xref>), or individuals from a partially asexual population into clonal lineages.</p>
    <p id="P4">In a clustering problem, the parameter of interest is a partition of the label set <italic>S</italic> of the sample. We refer to this parameter as the <italic>sample partition</italic>. A <italic>partition</italic> of a set <italic>S</italic> is a set of non-empty disjoint subsets of <italic>S</italic>, the union of which is the set <italic>S</italic> itself.</p>
    <p id="P5">From a Bayesian point of view, inferences about the sample partition should be based on the (marginal) posterior distribution of the sample partition. An MCMC sampler can be used to generate a large sample of observations from the posterior distribution of the sample partition, - or at least a distribution which is an adequate approximation to this posterior distribution. This is the approach taken in many of the papers cited above. Here we are concerned with the treatment of the output form the Markov chain sampler.</p>
  </sec>
  <sec id="S2">
    <title>2 The visualisation problem</title>
    <p id="P6">Bayesian clustering problems of this type have certain features which have proved to be challenging. The number of ways of partitioning a set of <italic>n</italic> distinct elements into <italic>k</italic> non-empty disjoint (and unlabelled) subsets is equal to the Stirling number of the second kind, denoted by <inline-formula><mml:math display="inline" id="M1" overflow="scroll"><mml:mrow><mml:mo stretchy="true">{</mml:mo><mml:mtable><mml:mtr><mml:mtd columnalign="center"><mml:mi>n</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center"><mml:mi>k</mml:mi></mml:mtd></mml:mtr></mml:mtable><mml:mo stretchy="true">}</mml:mo></mml:mrow></mml:math></inline-formula>. These numbers grow very rapidly with <italic>n</italic>. The total number of ways of partitioning a set of <italic>n</italic> distinct elements into non-empty disjoint (and unlabelled) subsets, is given by the sum
<disp-formula id="FD1"><mml:math display="block" id="M2" overflow="scroll"><mml:mrow><mml:mi>B</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>n</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:munderover><mml:mrow><mml:mo stretchy="true">{</mml:mo><mml:mtable><mml:mtr><mml:mtd columnalign="center"><mml:mi>n</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center"><mml:mi>k</mml:mi></mml:mtd></mml:mtr></mml:mtable><mml:mo stretchy="true">}</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula>
This is the <italic>n</italic>th Bell number. (For further information see for example, <xref ref-type="bibr" rid="R1">Aigner (1979)</xref>.) Since these numbers grow very rapidly with <italic>n</italic>, it is only in cases where <italic>n</italic> is small, that a probability distribution over the space of partitions of the set can be visualised in its entirety. This is what we mean by a visualisation problem. There need not be a problem if there are only a small number of partitions which have an appreciable share of the posterior probability, - as these partitions can easily be identified and listed along with their individual posterior probabilities. However, if many of the individuals in the sample are difficult to classify, then there will be many plausible partitions, each one having an individually low posterior probability. Under these circumstance those regions where the probability is elevated will be difficult to identify.</p>
    <p id="P7">In addition to this visualisation problem, there is also a computational problem. The Monte Carlo method will not provide accurate estimate of very low probabilities (because these will necessarily be based on a small number of observations). Therefore, in situations where there are a large number of plausible partitions, there is a need to collapse this marginal posterior distribution further, in order to obtain marginal posterior probabilities of more probable <italic>events</italic>.</p>
    <p id="P8">Some authors, using Bayesian methodology, have avoided the visualisation problem by considering only point estimation of the sample partition (<xref ref-type="bibr" rid="R10">Corander et al., 2003</xref>; <xref ref-type="bibr" rid="R24">Huelsenbeck et al., 2007</xref>; <xref ref-type="bibr" rid="R11">Coulon et al., 2008</xref>). <xref ref-type="bibr" rid="R10">Corander et al. (2003)</xref> used a MAP (maximum <italic>a posteriori</italic> probability) estimate. However, MAP estimates are vulnerable to the computational problem which arises when there are many plausible partitions, each one having an individually low posterior probability.</p>
    <p id="P9">The Bayesian framework provides us with a general strategy for overcoming visualisation problems. We compute marginal distributions (possibly many different marginals) which can be visualised individually, each of which provides some information about the parameter of interest. We can also estimate the posterior probability that the sample partition satisfies a chosen condition. This is equivalent to the (marginal) posterior distribution of an indicator function corresponding to the chosen condition. We can compute these posterior probabilities for as many different conditions as we find helpful.</p>
    <p id="P10"><xref ref-type="bibr" rid="R12">Dawson and Belkhir (2001)</xref> made use of the posterior co-assignment probabilities of sets of individuals. Let <italic>S</italic> denote the label set of the sample. The <italic>co-assignment probability</italic> of a set <italic>U</italic>​ <inline-graphic xlink:href="ukmss-3290-ig0008.jpg"/>​ <italic>S</italic> is the probability that the set of individuals, <italic>U</italic>, all belong to the same <italic>category</italic> (or <italic>element</italic> of the partition). A co-assignment probability can also be interpreted as the probability that the sample partition satisfies a condition. In this case, the condition is that the chosen set <italic>U</italic> is a subset of (or is equal to) an element of the sample partition. Here we denote the posterior co-assignment probability of the set <italic>U</italic> by II (<italic>U</italic>).</p>
  </sec>
  <sec id="S3">
    <title>3 The label switching problem</title>
    <p id="P11">In the past, Bayesian clustering methods have been beset by the so-called <italic>label switching</italic> problem described by <xref ref-type="bibr" rid="R33">Richardson and Green (1997)</xref>. These are problems which can arise in Bayesian inference about any model having a set partition (such as a sample partition) as a parameter, when we try to compute marginal distributions for parameters which depend upon an <italic>arbitrary labelling</italic> of the elements of the partition. The labelling of the elements is arbitrary whenever the prior and the likelihood function are both invariant under permutation of the component labels, - in which case the posterior distribution is also invariant under permutation of the component labels. For example, one might be tempted to compute what we refer to here as the posterior <italic>assignment probability</italic> of individual <italic>i</italic> to a particular category <italic>α</italic> (conditional on there being <italic>K</italic> categories, say). This is the posterior probability that individual <italic>i</italic> belongs to category <italic>α</italic>, conditional on there being <italic>K</italic> categories. However, <italic>α</italic> is an arbitrary label, which does not refer to any fixed entity. A category is characterised by the individuals assigned to it, and by the value of some category-specific parameter, all of which are uncertain. In fact, <xref ref-type="bibr" rid="R32">Pritchard et al. (2000)</xref> recommended assigning individuals to discrete clusters using these posterior assignment probabilities, which they refer to as <italic>membership coefficients</italic>, and which are an output of their widely-used software package (STRUCTURE).</p>
    <p id="P12">In the case of STRUCTURE, this label switching problem is obscured by the poor mixing of the Markov chain sampler. (According to <xref ref-type="bibr" rid="R32">Pritchard et al. (2000)</xref>, their Markov chain samples in the vicinity of a single mode of the posterior distribution.) It is only as a consequence of poor mixing that a set of individuals which have a high posterior co-assignment probability, also tend to remain associated with the same label over many iterations of the Markov chain sampler. In the model which underlies STRUCTURE, the parameter <italic>K</italic> is the number of potential populations. For each run of the Markov chain sampler, <italic>K</italic> is held fixed. The potential populations are labelled <italic>α</italic> = 1, . . . , <italic>K</italic>. One of the outputs from a run of the Markov chain sampler is an <italic>n</italic> × <italic>K</italic> matrix of posterior assignment probabilities. This output is referred to as a <italic>Q</italic>-matrix. If the Markov chain sampler mixed well, then each of these assignment probabilities would be equal to 1/<italic>K</italic>, and so would be completely uninformative.</p>
    <p id="P13">Recently (<xref ref-type="bibr" rid="R26">Jakobsson and Rosenberg, 2007</xref>) the software package CLUMPP has been developed to process the output from STRUCTURE. This program takes as its input the <italic>Q</italic>-matrices computed from <italic>r</italic> runs of the Markov chain sampler. It then searches for the sequence of <italic>r</italic> - 1 permutations of the set {1, . . . , <italic>K</italic>} (and hence permutations of the columns of the <italic>Q</italic>-matrix) which maximises a measure of similarity for the sequence of <italic>r Q</italic>-matrices. Once the required sequences of permutations has been found, it is applied to the sequence of <italic>Q</italic>-matrices. The resulting sequence of (column permuted) <italic>Q</italic>-matrices can then be passed as input to the visualisation software package DESTRUCT (<xref ref-type="bibr" rid="R34">Rosenberg, 2004</xref>). It seems to us that CLUMPP does not address the label switching problem. If the Markov chain sampler mixed well, then each of the <italic>Q</italic>-matrices (which CLUMPP takes as its input), would have every entry equal to 1/<italic>K</italic>, in which case the output from CLUMPP would be as uninformative as the input. If on the other hand the Markov chain sampler mixes poorly, then we can not rely on it to make accurate estimates of posterior probabilities.</p>
    <p id="P14">Label switching problems can also arise in Bayesian inference about mixture models, whenever we try to compute marginal distributions for parameters which depend upon an arbitrary labelling of the component populations of the mixture. <xref ref-type="bibr" rid="R33">Richardson and Green (1997)</xref> drew attention to the label switching problem in the context of their attempt to compute the marginal posterior distribution of component-specific parameters. For example, in the case of a population genetic model, where the components correspond to distinct panmictic populations, we might want to compute the marginal posterior distribution of the frequency of a particular allele type in each population. The solution to the label switching problem offered by <xref ref-type="bibr" rid="R33">Richardson and Green (1997)</xref> was to rank the components of the partition with respect to the value of one of the component-specific parameters. It is then possible to compute the marginal posterior distribution for any component-specific parameter in the first component, the second component, and so on. Such an ordering of the components has been referred to as an <italic>identifiability constraint</italic> (<xref ref-type="bibr" rid="R5">Celeux et al., 2000</xref>; <xref ref-type="bibr" rid="R25">Hurn et al., 2003</xref>; <xref ref-type="bibr" rid="R27">Jasra et al., 2005</xref>). These are certainly well defined marginals of the posterior distribution. However, there is no guarantee that any of these marginals will correspond to a unique component of the <italic>true</italic> mixture. We may also have to choose from a bewildering array of possible identifiability constraints. For example, in the case of a population genetic model, where the components correspond to distinct panmictic populations, we could choose to order the components with respect to the frequency of any allele type, at any locus, which is represented in the genotype data. An identifiability constraint of this type was used by <xref ref-type="bibr" rid="R22">Guillot et al. (2005)</xref>.</p>
    <p id="P15">When the number of potential components in the mixture is a constant <italic>K</italic>, the posterior distribution can be represented as a symmetric mixture of <italic>K</italic>! copies of a single joint distribution, each with a different permutation of the component labels. This observation is the starting point for an alternative approach proposed by Stephens (<xref ref-type="bibr" rid="R40">1997</xref>, <xref ref-type="bibr" rid="R41">2000</xref>), where the aim is to assign each observation from the posterior distribution to one of the <italic>K</italic>! permutation. This is achieved by applying a <italic>k</italic> means type clustering algorithm to the sample of observation from the posterior distribution, to assign each observation to one of <italic>K</italic>! clusters. <xref ref-type="bibr" rid="R27">Jasra et al. (2005)</xref> referred to this method as a <italic>relabelling algorithm</italic>. This may prove to be a very difficult clustering problem when the <italic>K</italic>! components in the symmetric mixture overlap too much.</p>
    <p id="P16"><xref ref-type="bibr" rid="R27">Jasra et al. (2005)</xref> favoured a third approach to the label-switching problem, originally proposed by <xref ref-type="bibr" rid="R5">Celeux et al. (2000)</xref> and <xref ref-type="bibr" rid="R25">Hurn et al. (2003)</xref>. The authors advocated solving the label-switching problem within the framework of decision theory, by introducing a <italic>label invariant loss function</italic>. The loss function is a function of parameter values of the model (the sample partition, and the component-specific parameters), and an <italic>action</italic>. (For an introduction to decision theory, see <xref ref-type="bibr" rid="R4">Berger (1985)</xref>.) In <xref ref-type="bibr" rid="R5">Celeux et al. (2000)</xref> and <xref ref-type="bibr" rid="R25">Hurn et al. (2003)</xref>, the action is simply a point estimate, of either the sample partition, or a sequence of component-specific parameters. (In principle, the action could also be the choice of a credible set, rather than the choice of a point estimate. However, in the case of the sample partition, this would take us back to the visualisation problem.) Having introduced a loss function, we are in a position to compute the posterior expected loss for each possible action. In principle, we can search for the action that minimises the posterior expected loss. However, this minimisation procedure is computationally costly. Note that the choice of a loss function introduces further subjectivity, in addition to the choice of prior.</p>
  </sec>
  <sec id="S4">
    <title>4 A solution</title>
    <p id="P17">In contrast to <xref ref-type="bibr" rid="R41">Stephens (2000)</xref> and <xref ref-type="bibr" rid="R27">Jasra et al. (2005)</xref>, we strongly recommend avoiding the label-switching problem by restricting attention to marginal distributions of only those parameters which are invariant under permutations of the labels of the categories. This point of view was expressed by <xref ref-type="bibr" rid="R21">Gilks (1997)</xref> in a contribution to the discussion of <xref ref-type="bibr" rid="R33">Richardson and Green (1997)</xref>, from which we now quote.</p>
    <p id="P18">“I am not convinced by the authors’ desire to produce a unique labelling of the groups. It is unnecessary for valid Bayesian inference concerning identifiable quantities; . . . it is only the group members which lend meaning to the individual clusters.”</p>
    <p id="P19">Unlike assignment probabilities, co-assignment probabilities are invariant under permutations of the labels of the categories. This was one reason why Dawson and Belkhir (<xref ref-type="bibr" rid="R12">2001</xref>, <xref ref-type="bibr" rid="R13">2002</xref>) proposed using the posterior co-assignment probabilities as a basis for inferences about the sample partition. Furthermore, in situations where the posterior probabilities of individual partitions are too small (relative to Monte Carlo error) to be estimated reliably, the posterior co-assignment probabilities of many subsets of the label set can be estimated accurately, using a large sample of observations from the posterior distribution.</p>
    <p id="P20">The availability of posterior co-assignment probabilities for sets of individuals suggests a solution to the visualisation problem. If we have a <italic>rooted binary tree</italic> with <italic>n terminal nodes</italic> (<italic>external nodes, tips</italic> or <italic>leaves</italic>), each of which is labelled with a distinct element of the label set <italic>S</italic> of the sample, then each of the <italic>n</italic> - 1 <italic>internal nodes</italic> of this tree specifies a subset (containing 2 or more elements) of the label set <italic>S</italic>. Included among these subsets is the set <italic>S</italic> itself, which is the set specified by the <italic>root node</italic>. By making the height of each node equal to the posterior co-assignment probability of the set of individuals defined by that node (the individuals whose labels occupy the terminal nodes that can be reached by ascending the tree from that node), we can present the posterior co-assignment probabilities of <italic>n</italic> - 1 sets in a format which is easy to view and interpret.</p>
    <p id="P21">Before proceeding, we need to clarify what is meant by a rooted binary tree, a terminal node, and an internal node. A tree consists of <italic>nodes</italic> and <italic>edges</italic> (<italic>branches</italic>). (A tree is a graph.) It is possible to walk on a tree (stepping from one node to the next only when they are joined by an edge) from any node to every other node. (A tree is a <italic>connected</italic> graph.) When walking on a tree, it is impossible to return to the original node without travelling back along at least one of the same edges. (A tree is an <italic>acyclic</italic> connected graph. This can be taken as the definition of a tree.) Every node of a tree is connected to at least one edge. A node which is connected to only one edge is called a <italic>terminal node</italic> (external node, tip or leaf). A node which is connected to more than one edge is called an <italic>internal node</italic>. In a <italic>rooted</italic> tree, one of the internal nodes is designated the <italic>root</italic> node. A rooted <italic>binary</italic> (<italic>bifurcating</italic> or <italic>fully resolved</italic>) tree is one in which the root node is connected to exactly 2 edges, and every other internal node is connected to exactly 3 edges.</p>
    <p id="P22">We are now faced with the problem of choosing a rooted binary tree, and hence choosing which subsets of <italic>S</italic> are to be specified, together with their posterior co-assignment probabilities. Any hierarchical clustering algorithm will automatically pick out one particular hierarchy of sets, which can be represented in the form of a (rooted) binary tree. The computational time required for a divisive hierarchical clustering algorithm (where we begin by assigning all individuals to a single category) grows exponentially with the sample size <italic>n</italic>, because there are 2<sup><italic>n</italic>-1</sup> - 1 distinct bipartitions of a set of <italic>n</italic> elements (<xref ref-type="bibr" rid="R15">Edwards and Cavalli-Sforza, 1965</xref>). In contrast, the computational time required for an agglomerative hierarchical clustering algorithm (where we begin by assigning each individual to a separate category) is only of order <italic>n</italic><sup>2</sup>. For these computational reasons an agglomerative hierarchical clustering algorithm is preferable. But which agglomerative hierarchical clustering algorithm should we use? <xref ref-type="bibr" rid="R12">Dawson and Belkhir (2001)</xref> introduced the <italic>maximin agglomerative algorithm</italic> for this purpose. More recently, <xref ref-type="bibr" rid="R9">Corander et al. (2004)</xref> applied the complete linkage algorithm to the output form their MCMC sampler (the software package BAPS). The complete linkage algorithm is a special case of the maximin agglomerative algorithm.</p>
    <p id="P23">Here we recommend an agglomerative hierarchical clustering algorithm (described below) which we refer to as the <italic>exact linkage algorithm</italic>. The exact linkage algorithm is also a special case of the maximin agglomerative algorithm of <xref ref-type="bibr" rid="R12">Dawson and Belkhir (2001)</xref>. In the next section, we describe the exact linkage algorithm.</p>
    <p id="P24">We end this section by noting that, in general, the output from the exact linkage algorithm may be a <italic>rooted binary tree</italic> in which some internal nodes have height zero, - represented co-assignment probabilities of zero. It is more natural to interpret a rooted binary tree having <italic>k</italic> nodes at height zero (1 ≤ <italic>k</italic> &lt; <italic>n</italic>) as a rooted binary <italic>forest</italic> made up of <italic>k</italic> + 1 separate trees. A forest is a graph in which every connected subgraph is a tree. In other words, a forest is composed of one or more trees.</p>
  </sec>
  <sec id="S5">
    <title>5 The exact linkage algorithm</title>
    <p id="P25">As with any agglomerative hierarchical clustering algorithm, the exact linkage algorithm begins with <italic>n</italic> terminal nodes, each of which is labelled with a distinct element of the label set <italic>S</italic> of the sample. (So the set of terminal nodes can be equated with the label set <italic>S</italic>.) At each subsequent iteration (<italic>t</italic> = 1, 2, ...), a new internal node is created, having two existing nodes (terminal or internal) as descendants. In this way we build up a <italic>forest</italic> of rooted binary trees. (This rooted binary forest may include trivial trees consisting of a single terminal node.) This process of adding internal nodes can continue for a maximum of <italic>n</italic> - 1 iterations (in which case we have, at the end of iteration <italic>n</italic> - 1, a single rooted binary tree having <italic>n</italic> terminal nodes and <italic>n</italic> - 1 internal nodes). See <xref ref-type="fig" rid="F1">Figure 1</xref>, where we illustrate the exact linkage algorithm with an example for a sample of 5 individuals.</p>
    <p id="P26">Each internal node is labelled with an integer <italic>t</italic> (= 1, 2, ..., <italic>n</italic> - 1), according to the iteration <italic>t</italic> at which it was created. Each node of this forest defines a set of individuals from the sample. A terminal node defines a set containing only one individual. Every internal node <italic>t</italic>, defines a set <italic>S</italic> (<italic>t</italic>) <inline-graphic xlink:href="ukmss-3290-ig0008.jpg"/>​ <italic>S</italic>. This is the set of terminal nodes that can be reached by ascending the tree, starting from node <italic>t</italic>.</p>
    <p id="P27">At any iteration <italic>t</italic>, a node is said to be a root node if it has not yet become the descendent of another node. Let <italic>R</italic> (<italic>t</italic>) denote the set of root nodes at the end of iteration <italic>t</italic>. At the end of iteration <italic>t</italic>, every root node in <italic>R</italic> (<italic>t</italic>) belongs to a distinct tree in the associated forest, and every tree in the forest has a unique root node which belongs to <italic>R</italic> (<italic>t</italic>). In the case of a trivial tree, consisting of a single terminal node, this terminal node is also the unique root node of the tree.</p>
    <p id="P28">We now state the exact linkage algorithm.</p>
    <sec id="S6">
      <title>5.1 The exact linkage algorithm</title>
      <p id="P29">We begin with an initialisation step.</p>
      <p id="P30">(0) Set the iteration number to be <italic>t</italic> = 0. Set the height of each terminal node to 1. Set <italic>R</italic> (0) = <italic>S</italic> (the set of terminal nodes).</p>
      <p id="P31">To construct the internal nodes, at each subsequent iteration we repeat the following three steps.</p>
      <p id="P32">(1) Increase the iteration number by one (from <italic>t</italic> - 1 to <italic>t</italic>), then construct a set <italic>Q</italic> (<italic>t</italic>) of <italic>proposed nodes</italic>. This is the set of the nodes which can be constructed by taking a pair (<italic>i, j</italic>) of (distinct) existing root nodes (<italic>i, j</italic>​ <inline-graphic xlink:href="ukmss-3290-ig0009.jpg"/>​ <italic>R</italic> (<italic>t</italic> - 1), <italic>i</italic> ≠ <italic>j</italic>), and joining them together to create a new root node having these two nodes as its descendants.</p>
      <p id="P33">(2) Calculate the node height <italic>p</italic> (<italic>i, j</italic>) associated with each proposed node (<italic>i, j</italic>) <inline-graphic xlink:href="ukmss-3290-ig0009.jpg"/>​ <italic>Q</italic> (<italic>t</italic>).</p>
      <p id="P34">(3) Find the proposed node which is highest, and add this node to the forest. Label this new node <italic>t</italic>. So we have
<disp-formula id="FD2"><label>(1)</label><mml:math display="block" id="M3" overflow="scroll"><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:munder><mml:mtext>max</mml:mtext><mml:mrow><mml:munder><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>:</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>∈</mml:mo><mml:mi>R</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>≠</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:munder></mml:mrow></mml:munder><mml:mrow><mml:mo>{</mml:mo><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>}</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p>
      <p id="P35">Repeat steps 1-3 until either <italic>p</italic> (<italic>t</italic>) = 0, or (at the end of iteration <italic>t</italic> = <italic>n</italic> - 1) only one root node remains.</p>
      <p id="P36">In the event of <italic>ties</italic> (multiple proposed nodes having the same height) occurring at step 3, we simply choose one of these highest nodes at random and accept it.</p>
      <p id="P37">Notice that at each iteration the number of root nodes (and hence trees in the forest) is reduced by one. So, at the end of iteration <italic>t</italic> we have |<italic>R</italic> (<italic>t</italic>)| = <italic>n</italic> - <italic>t</italic> root nodes. At the start of iteration <italic>t</italic>, the number of proposed nodes is
<disp-formula id="FD3"><mml:math display="block" id="M4" overflow="scroll"><mml:mrow><mml:mo>∣</mml:mo><mml:mi>Q</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>∣</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mtable><mml:mtr><mml:mtd columnalign="center"><mml:mrow><mml:mi>n</mml:mi><mml:mo>−</mml:mo><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center"><mml:mn>2</mml:mn></mml:mtd></mml:mtr></mml:mtable><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p>
      <p id="P38">The node height <italic>p</italic> (<italic>i, j</italic>) of a proposed node (<italic>i, j</italic>) is a Monte Carlo estimate of the co-assignment probability II (<italic>S</italic> (<italic>i, j</italic>)) of the set <italic>S</italic> (<italic>i, j</italic>) = <italic>S</italic> (<italic>i</italic>) <inline-graphic xlink:href="ukmss-3290-ig0011.jpg"/>​ <italic>S</italic> (<italic>j</italic>) defined by this proposed node. The Monte Carlo estimate is obtained from the sample of <italic>N</italic> observations of the sample partition. The sample is stored as an <italic>n</italic> × <italic>N</italic> array, where each line is an observation of the sample partition, represented as a vector of <italic>n</italic> integer values. Each position <italic>i</italic> in the vector of <italic>n</italic> integer values represents an individual (<italic>i</italic>​ <inline-graphic xlink:href="ukmss-3290-ig0009.jpg"/>​ <italic>S</italic>), and the integer value at position <italic>i</italic> is an arbitrary label <italic>α</italic>, indicating the element of the partition (a subset of <italic>S</italic>) to which that individual is assigned. To estimate the co-assignment probability II (<italic>S</italic> (<italic>i, j</italic>)), we count the number of observations where the set <italic>S</italic> (<italic>i, j</italic>) is a subset of an element of the sample partition, and divide this count by the total number of observations <italic>N</italic>. We indicate this approximate relationship by writing
<disp-formula id="FD4"><label>(2)</label><mml:math display="block" id="M5" overflow="scroll"><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>≈</mml:mo><mml:mi>II</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>S</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mtext>for</mml:mtext><mml:mspace width="thickmathspace"/><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>∈</mml:mo><mml:mi>R</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mo>≠</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>
and
<disp-formula id="FD5"><label>(3)</label><mml:math display="block" id="M6" overflow="scroll"><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>≈</mml:mo><mml:mi>II</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>S</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mtext>for</mml:mtext><mml:mspace width="thickmathspace"/><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mi>…</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>
where <italic>S</italic> (<italic>t</italic>) is the set defined by the accepted node <italic>t</italic>. These posterior co-assignment probabilities are estimated from the output of the Monte Carlo sampler.</p>
      <p id="P39">Notice that we can construct the set of proposed nodes <italic>Q</italic> (<italic>t</italic>) at step 1 of iteration <italic>t</italic> (≥ 2), by updating the set of proposed nodes <italic>Q</italic> (<italic>t</italic> - 1) from the previous iteration (<italic>t</italic> - 1), as follows. Suppose that the most recent accepted node (labelled <italic>t</italic> - 1) has descendants <italic>d</italic><sub>1</sub> and <italic>d</italic><sub>2</sub>. First, delete the proposed node (<italic>d</italic><sub>1</sub>, <italic>d</italic><sub>2</sub>), along with all proposed nodes (<italic>d</italic><sub>1</sub>, <italic>j</italic>), (<italic>j, d</italic><sub>2</sub>), where
<italic>j</italic>​ <inline-graphic xlink:href="ukmss-3290-ig0009.jpg"/>​ <italic>R</italic> (<italic>t</italic> - 2), and <italic>j</italic> ≠ <italic>d</italic><sub>1</sub>, <italic>d</italic><sub>2</sub>. (The total number of nodes to be deleted is 2 (<italic>n</italic> - <italic>t</italic>) + 1). Second, insert the nodes (<italic>t</italic> - 1, <italic>j</italic>), where <italic>j</italic>​ <inline-graphic xlink:href="ukmss-3290-ig0009.jpg"/>​ <italic>R</italic> (<italic>t</italic> - 2), and <italic>j</italic> ≠ <italic>t</italic> - 1. (The total number of nodes to be inserted is <italic>n</italic> - <italic>t</italic>). As a consequence, at step 2 of interaction <italic>t</italic>, we only need to compute the node heights of the <italic>n</italic> - <italic>t</italic> new proposed nodes created at step 1.</p>
      <p id="P40">In <xref ref-type="fig" rid="F1">Figure 1</xref>, steps 1 and 2 taken together, are referred to as the <italic>update</italic> step, because the proposed nodes are updated as described above. Step 3 is referred to as the <italic>acceptance</italic> step in <xref ref-type="fig" rid="F1">Figure 1</xref>, because a proposed node is accepted and added to the forest.</p>
      <p id="P41">It is possible to improve on this version of the exact linkage algorithm by ruling out certain proposed nodes right from the start. The version of the exact linkage algorithm which has now been implemented in the PartitionView software package, has been optimised along these lines.</p>
    </sec>
    <sec id="S7">
      <title>5.2 The maximin agglomerative algorithm</title>
      <p id="P42">As already mentioned, the exact linkage algorithm is a special case of the maximin agglomerative algorithm (<xref ref-type="bibr" rid="R12">Dawson and Belkhir, 2001</xref>). The maximin agglomerative algorithm is also described in <xref ref-type="supplementary-material" rid="SD1">Appendix A</xref> (see Supplementary Material).</p>
      <p id="P43">In the maximin agglomerative algorithm, clusters are constructed so as to maximise the minimum co-assignment probability of subsets of size <italic>d</italic> within clusters. This is why we have called this algorithm the <italic>maximin</italic> agglomerative algorithm. In fact, it is a generalisation of the classical <italic>complete linkage</italic> (or <italic>furthest neighbour</italic>) algorithm (<xref ref-type="bibr" rid="R39">Sørensen, 1948</xref>; <xref ref-type="bibr" rid="R28">McQuitty, 1960</xref>; <xref ref-type="bibr" rid="R14">Defays, 1977</xref>), - to which it reduces in the case <italic>d</italic> = 2.</p>
      <p id="P44">The exact linkage algorithm includes a maximisation step, but no minimisation. So, the name maximin agglomerative algorithm is no longer appropriate. In the complete linkage algorithm the heights of nodes are upper bounds on the co-assignment probabilities for the sets they define, when these contain more than 2 individuals. This is in contrast to the exact linkage algorithm where the heights of nodes are <italic>exact</italic> (up to Monte Carlo sampling error) co-assignment probabilities for the sets they define (regardless of how many individuals they contain), - hence its name. An alternative more descriptive name for this algorithm is the <italic>most probable cluster agglomerative algorithm</italic>. This name reflects the fact that at each iteration of the algorithm, we accept that proposed node which defines the cluster having the highest co-assignment probability, out of all the proposed nodes at the iteration in question.</p>
      <p id="P45">As recognised in <xref ref-type="bibr" rid="R12">Dawson and Belkhir (2001)</xref>, the tree or forest generated by the exact linkage algorithm captures more of the information from the posterior distribution than any other version of the maximin agglomerative algorithm. However, in our earlier work we implemented the maximin agglomerative algorithm, with dimension <italic>d</italic> = 2, 3 or 4, for computational reasons. See <xref ref-type="supplementary-material" rid="SD1">Appendix B</xref> (Supplementary Material) for details.</p>
      <p id="P46">The exact linkage algorithm is implemented in PartitionView. The maximin agglomerative algorithm (with dimension <italic>d</italic> = 2, 3 or 4) was implemented in the earlier companion program, called Analyse.exe, which PartitionView.exe replaces.<xref ref-type="fn" rid="FN1">1</xref></p>
    </sec>
  </sec>
  <sec sec-type="discussion" id="S8">
    <title>6 Interpretation of the forests generated by the exact linkage algorithm</title>
    <p id="P47">As we descend the forest (from the terminal nodes towards the root node), passing successively through the nodes <italic>t</italic> = 1, 2, ..., <italic>n</italic> - 1, the set <italic>S</italic> (<italic>t</italic>) defined by each node has a lower posterior co-assignment probability than the set defined by the preceding nodes. This brings us to the question of how to decide when a node <italic>t</italic> is sufficiently low that we can confidently reject the claim that all individuals in the set <italic>S</italic> (<italic>t</italic>) defined by this node belong to the same category. Perhaps the most obvious method is for the user to choose a threshold value <italic>p</italic> for the probability of co-assignment. So, for every node <italic>t</italic> defining a set of individuals <italic>S</italic> (<italic>t</italic>) with co-assignment probability <italic>p</italic> (<italic>t</italic>) ≥ <italic>p</italic> , we accept the co-assignment of all the individuals in the set <italic>S</italic> (<italic>t</italic>) defined by that node; while for nodes <italic>t</italic> having <italic>p</italic>(<italic>t</italic>) &lt; <italic>p</italic>, we do not accept the corresponding co-assignments. Ideally, each user would choose a value for the threshold which corresponds to how averse they are to the risk of making false co-assignments. For example, a particularly cautious user might want to choose a threshold of <italic>p</italic> = 0·9, or <italic>p</italic> = 0·95, while a less cautious user might be content with a threshold of <italic>p</italic> = 0·5. If we apply a rule of the above type, with any threshold <italic>p</italic>, to the sets defined by the nodes of a forest (with terminal nodes corresponding to the elements of the set <italic>S</italic>), then we can only accept the assignment of an individual <italic>i</italic> to a sequence of sets <italic>A, B, C</italic>, ... (|<italic>A</italic>| &lt; |<italic>B</italic>| &lt; |<italic>C</italic>| &lt; . . . &lt; <italic>n</italic>) if these sets form a nested sequence (<italic>i</italic>​ <inline-graphic xlink:href="ukmss-3290-ig0009.jpg"/>​ <italic>A</italic>​ <inline-graphic xlink:href="ukmss-3290-ig0010.jpg"/>​ <italic>B</italic>​ <inline-graphic xlink:href="ukmss-3290-ig0010.jpg"/>​ <italic>C</italic>​ <inline-graphic xlink:href="ukmss-3290-ig0010.jpg"/> . . . <inline-graphic xlink:href="ukmss-3290-ig0010.jpg"/>​ <italic>S</italic>).</p>
  </sec>
  <sec id="S9">
    <title>7 Examples</title>
    <p id="P48">In this section we illustrate the performance of the exact linkage algorithm for classifying individuals into categories, by applying it to the output from Markov chain samplers applied to simulated data sets - where the correct classification is known to us. The software package PartitionView (version 0 and now version 1.0) was originally developed as a companion program to the MCMC sampler program Partition (<xref ref-type="bibr" rid="R12">Dawson and Belkhir, 2001</xref>). However, PartitionView can be used to process the output from a Monte Carlo sampler for any probability distribution which has, as a marginal, a probability distribution on the space of partitions of a set (with the obvious proviso that observations of the set partition can be recovered from the output of the Monte carlo sampler). To emphasise this fact, our first example is the classification of 100 individuals into selfing lines, on the basis of output from the Markov chain sampler program IMPPS (<xref ref-type="bibr" rid="R46">Wilson and Dawson, 2007</xref>). In this example, the true sample partition has a large number of small elements (many sets of size 1 or 2).</p>
    <p id="P49">In our second example the simulated data set is a sample of 80 individuals drawn from two source populations (40 individuals from each population). The Markov chain sampler program HWLER <xref ref-type="bibr" rid="R31">Pella and Masuda (2006)</xref> was applied to this data set. We use this relatively simple example to illustrate how the rooted binary forests generated by the exact linkage algorithm may differ from those generated by the maximin agglomerative algorithm (with <italic>d</italic> = 2, 3, and 4).</p>
    <p id="P50">The rooted binary forest, or tree, generated by PartitionView is encoded in the “Newick 8:45” format adopted by PHYLIP <xref ref-type="bibr" rid="R18">Felsenstein (2004)</xref>. In the current version of PartitionView, a rooted binary forest consisting of multiple separate trees, is represented as a single rooted tree, where the separate root nodes of the forest are joined together by a sequence of internal nodes which all have hight zero. The root node of the resulting tree is also at hight zero.</p>
    <sec id="S10">
      <title>7.1 Example 1</title>
      <p id="P51">Recently, <xref ref-type="bibr" rid="R46">Wilson and Dawson (2007)</xref> used the exact linkage algorithm (as implemented in PartitionView version 1.0) to process the output from the Markov chain sampler program IMPPS (Inference of Matrilineal Pedigrees under Partial Selfing). This is a Markov chain sampler for the joint posterior distribution of the pedigree of a sample from a partially selfing population, and the parameters of the population genetic model (including the selfing rate), given the genotypes of the sampled individuals at unlinked marker loci. The population genetic model is appropriate for a hermaphrodite annual species, allowing both selfing and outcrossing. Generations are discrete and non-overlapping, as is appropriate for an annual species. The local population or deme was founded in the recent past (<italic>T</italic> generations in the past), and the founders were drawn from an infinitely large unstructured <italic>source population</italic>. Throughout its existence, this deme has remained at a constant size of <italic>N</italic> diploid individuals. The <italic>N</italic> founders (the seed immigrants) are sampled independently from the source population. In the current version of IMPPS it is assumed that no seed immigration into the local deme has occurred since the founder generation. The efficient Markov chain Monte carlo strategy employed in the IMPPS program relies on the rather artificial assumption that, for every outcrossing event which occurs within the local deme, the pollen grain is drawn directly from the large source population.</p>
      <p id="P52">The aspect of the pedigree that we are interested in here is the classification of individuals into selfing lines. Each selfing line is founded by an outcrossed ancestor: the <italic>most recent outcrossed ancestor</italic> (MROA) of the individuals belonging to that selfing line. The MROAs of a sample are the ancestors of the sample that we encounter if we trace the line of descent of each individual from the sample back up the pedigree until we encounter the first ancestor which is a product of outcrossing. If an individual in the sample is itself a product of outcrossing then that individual is an MROA, and we have no need to trace its ancestry back any further. The classification of individuals into selfing lines induces a partition of the label set of the sample. We refer to this sample partition as the <italic>selfing line partition</italic>. It is this partition which we want to infer from the genotype data.</p>
      <p id="P53">The output from the IMPPS Markov chain sampler includes observations of the selfing line partition. From a large sample of such observations we can estimate the co-assignment probability of any set of individuals. Here, the relevant co-assignment probability is the posterior probability that all individuals in the set belong to the same selfing line (in other words, they share the same MROA).</p>
      <p id="P54">A simulated data set was generated by a genealogical (reverse time) simulation of the model outlined above. The selfing rate was <italic>s</italic> = 0·8, the local population was of size <italic>N</italic> = 100, and age <italic>T</italic> = 5 generations. The local population was exhaustively sampled (sample size <italic>n</italic> = 100), and the individuals were genotyped at 6 polymorphic marker loci. This simulated data set was one of those analysed in <xref ref-type="bibr" rid="R46">Wilson and Dawson (2007)</xref>, using the IMPPS Markov chain sampler. The true matrilineal pedigree of this exhaustively sampled of <italic>n</italic> = 100 individuals is represented in <xref ref-type="fig" rid="F2">Figure 2</xref>. Outcrossing events are indicated by diamonds.</p>
      <p id="P55">Every partition of a set <italic>S</italic> induces an integer partition of |<italic>S</italic>|. The true selfing line partition in our example induces an integer partition of the sample size 100. This integer partition can be written as 1<sup>40</sup>2<sup>14</sup>3<sup>2</sup>4<sup>1</sup>5<sup>2</sup>6<sup>2</sup>, - meaning that there are 40 sets of size 1, 134 sets of size 2, and so on, in the original set partition. This notation for an integer partition is referred to as the <italic>frequency representation</italic> of the integer partition.</p>
      <p id="P56">We have colour-coded those true selfing lines which are of size greater than 2, and coloured each node of the forest according to the true selfing line of the set of individuals defined by the node. (All the branches in the clade defined by a node are similarly coloured according to the true selfing line of this set of individuals.) The true selfing lines are colour-coded as follows. The two distinct selfing lines of size 6 are designated respectively the Red line and the Orange line; the two distinct lines of size 5 are designated respectively the Green and Blue lines; the selfing line of size 4 is the Violet line; and the two distinct lines of size 3 are the Purple line and the Sienna line respectively. The 14 selfing lines of size 2, and the 40 selfing lines of size 1, are assigned the colour black. Black is also used as the default colour for any internal nodes that define sets of individuals from multiple selfing lines.</p>
      <p id="P57">A sample of 60 000 observations of the selfing line partition was generated by pooling three independent runs of the Markov chain sampler. Each run provided 20 000 observations, from the 20 000 iterations (without thinning) following a burn-in of 1000 iterations.</p>
      <p id="P58"><xref ref-type="fig" rid="F3">Figure 3</xref> shows the rooted binary forest generated by applying the exact linkage algorithm to the pooled sample of 60 000 observations. In order to illustrate how successfully the true selfing lines have been identified, we have applied the same colour coding to this rooted binary forest as we applied to the true pedigree (in <xref ref-type="fig" rid="F2">Figure 2</xref>).</p>
      <p id="P59">If we choose a threshold of <italic>p</italic> = 0·75 (so that we accept the co-assignment of all the individuals in the set defined by any node <italic>t</italic> having <italic>p</italic>(<italic>t</italic>) ≥ 0·75), then we obtain a selfing line partition which induces an integer partition (of the sample size 100) having the frequency representation 1<sup>38</sup>2<sup>14</sup>3<sup>2</sup>4<sup>1</sup>5<sup>1</sup>6<sup>2</sup>7<sup>1</sup>.</p>
      <p id="P60">The small number of errors in the inferred partition can be summarised as follows. The Blue line (of size 5) is erroneously fused with a set of size 2. In addition, one individual from a set of size 2 has been removed and placed erroneously with an individual form a set of size 1, and two sets of size 1 have been erroneously fused to form a set of size 2. The Red line (of size 6), the Orange line (of size 6), the Green line (of size 5), the Violet line (of size 4), the Purple line (of size 3), and the Sienna line (of size 3), are all present in the inferred partition, as are 12 out of the 14 selfing lines of size 2, and 37 out of the 40 selfing lines of size 1. Note that if we choose a lower threshold, of <italic>p</italic> = 0·5 for example, only a few additional erroneous agglomerations of selfing lines are accepted.</p>
    </sec>
    <sec id="S11">
      <title>7.2 Example 2</title>
      <p id="P61">Our second example illustrates how the rooted binary forests generated by the exact linkage algorithm may differ from those generated by the maximin agglomerative algorithm (with <italic>d</italic> = 2, 3, and 4). For this purpose we have chosen a simpler example. We reanalyse one data set (data set 4) out of the five simulated data sets reported in <xref ref-type="bibr" rid="R12">Dawson and Belkhir (2001)</xref>. In our earlier publication, these five data sets where analysed by first using a Markov chain sampler (Partition) to generate a sample of observations from the posterior distribution of the sample partition, and then applying the maximin agglomerative algorithm (with <italic>d</italic> = 2 and 3) to the output form this Markov chain sampler. These five data sets were reanalysed recently by <xref ref-type="bibr" rid="R31">Pella and Masuda (2006)</xref>, who applied their Markov chain sampler (HWLER), followed by our maximin agglomerative algorithm (with <italic>d</italic> = 2), and obtained rooted binary forests having more clearly defined clusters. Recall that the maximin agglomerative algorithm with <italic>d</italic> = 2 is identical to the complete linkage algorithm (a classical distance-based method).</p>
      <p id="P62">Data set 4 consists of the genotypes (at 10 unlinked marker loci) of 80 diploid individuals, sampled form a pair of populations (40 individuals from each population) which have diverged under random drift during a period of isolation following the fission of a common ancestral population. (For the details of the <italic>weak divergence</italic> scenario, see <xref ref-type="bibr" rid="R12">Dawson and Belkhir (2001)</xref>.) Here we designate the two populations Red and Blue respectively. <xref ref-type="bibr" rid="R31">Pella and Masuda (2006)</xref> applied their HWLER program to data set 4, and generated a sample of 20160 observations (with a period of 5 iterations) from the the posterior distribution of the sample partition. They discarded the first 10080 observations (half of the original sample) as burn in. Here we have discarded the first 10000 observations as burn in, leaving a sample of 10160 observations.</p>
      <p id="P63">We applied the maximin agglomerative algorithm, with <italic>d</italic> = 2, 3, and 4 (Figures <xref ref-type="fig" rid="F4">4</xref>, <xref ref-type="fig" rid="F5">5</xref> and <xref ref-type="fig" rid="F6">6</xref>, respectively) to this sample, and used it to generate rooted binary forests. Using the PartitionView software, we also applied the exact linkage algorithm to this same sample, to generate another rooted binary forest (<xref ref-type="fig" rid="F7">Figure 7</xref>).</p>
      <p id="P64">In the analysis reported by <xref ref-type="bibr" rid="R31">Pella and Masuda (2006)</xref>, using the maximin agglomerative algorithm with <italic>d</italic> = 2, the rooted binary forest consisted of two separate trees, defining two well supported clusters, corresponding to the two populations (Red and Blue respectively), with only one individual (a Red individual, labelled 27 in the original analysis of <xref ref-type="bibr" rid="R12">Dawson and Belkhir (2001)</xref>) belonging to the wrong cluster. We obtained similar results using the maximin agglomerative algorithm, with <italic>d</italic> = 2, 3, and 4, and with the exact linkage algorithm (and burn in = 10000).</p>
      <p id="P65">The forests represented in Figures <xref ref-type="fig" rid="F5">5</xref>, <xref ref-type="fig" rid="F6">6</xref>, and <xref ref-type="fig" rid="F7">7</xref>, each consist of two separate trees, while the forest represented by <xref ref-type="fig" rid="F4">Figure 4</xref> consists of a single tree, but one whose root node is very close to zero. All these trees contain a node which pairs the same Red individual (labelled 27) with the same Blue individual (labelled and 74 in the original analysis). As <italic>d</italic> is increased from 2 to 3, and then to 4, the height of the node which defines the cluster corresponding to the Red population (excluding individual 23) falls, as does the height of the node which defines the cluster corresponding to the Blue population (but also including individual 23). In the case of the forests generated by the maximin agglomerative algorithm, with <italic>d</italic> = 4, and by the exact linkage algorithm, these two nodes are lower still, and there is a particularly sharp drop in node height when we reach the node where the pair of individuals 23 (Red) and 74 (Blue) are joined with the rest of the individuals from the second population. At least in the case of individual 23, the increased skepticism represented by this fall in node height, is a more accurate representation of the true situation. At the same time this forest indicates a greater reluctance to assign two Red individuals (labelled 11 and 24) with the rest of the Red population, and this is not so easily justified.</p>
      <p id="P66">When we apply the maximin agglomerative algorithm, with different values for the dimension <italic>d</italic>, to the same sample of observations from a posterior distribution of partitions, we often obtain rooted binary forests having similar topologies (sharing many of the same internal nodes) as here. In such cases we expect the heights of the internal nodes tend to fall as the dimension <italic>d</italic> is increased, as we can observe in Figures <xref ref-type="fig" rid="F4">4</xref>, <xref ref-type="fig" rid="F5">5</xref>, <xref ref-type="fig" rid="F6">6</xref> and <xref ref-type="fig" rid="F7">7</xref>. In particular, the forests generated by the exact linkage algorithm (<xref ref-type="fig" rid="F7">Figure 7</xref>) tend to have the lowest nodes, - thus favouring more cautious co-assignment.</p>
    </sec>
  </sec>
  <sec sec-type="discussion" id="S12">
    <title>8 Discussion</title>
    <p id="P67">We were not the first to use (posterior) co-assignment probabilities in the context of Bayesian clustering (<xref ref-type="bibr" rid="R12">Dawson and Belkhir, 2001</xref>). In a contribution to the discussion of <xref ref-type="bibr" rid="R33">Richardson and Green (1997)</xref>​ <xref ref-type="bibr" rid="R29">O’Hagan (1997)</xref> suggested computing pairwise posterior co-assignment probabilities. <xref ref-type="bibr" rid="R30">Painter (1997)</xref> recommended using posterior co-assignment probabilities in an early paper on Bayesian discovery of full-sib families. <xref ref-type="bibr" rid="R16">Emery et al. (2001)</xref> also used posterior co-assignment probabilities in Bayesian discovery of full-sib and half-sib families. However, <xref ref-type="bibr" rid="R30">Painter (1997)</xref> and <xref ref-type="bibr" rid="R16">Emery et al. (2001)</xref> only made use of pairwise co-assignment probabilities, and the visualisation problem which can arise with large samples of individuals was not addressed. In <xref ref-type="bibr" rid="R12">Dawson and Belkhir (2001)</xref> we offered a solution to the visualisation problem. We also indicated how to make use of the co-assignment probabilities for sets of any size. However, in practice we only made use of co-assignment probabilities for sets of sizes 2, 3 and 4.</p>
    <p id="P68">The exact linkage algorithm recommended here, has two obvious advantages over classical hierarchical clustering algorithms. Firstly the node heights in the resulting rooted binary forests have a direct Bayesian interpretation. This is not the case for the node heights which would result from applying various classical hierarchical clustering algorithms, for example, the average linkage algorithm (<xref ref-type="bibr" rid="R37">Sokal and Michener (1958)</xref> and <xref ref-type="bibr" rid="R38">Sokal and Sneath (1963)</xref>, pages 182-185) to the (symmetric) matrix of pairwise co-assignment probabilities (as the similarity matrix). Secondly, the exact linkage algorithm can make use of the additional information which the posterior distribution (of the sample partition) provides about the support for the co-assignment of sets of more than two individuals.</p>
    <p id="P69">The PartitionView software package can now compute the posterior co-assignment probability of any set of individuals, regardless of weather or not it corresponds to a node of the rooted binary forest, so that the rooted binary forest can be used as a starting point for a more detailed exploration of the posterior distribution of the sample partition. We have also provided an R script for viewing, labelling and colouring the rooted binary forests in the output files (in “Newick 8:45” format) generated by PartionView.</p>
    <p id="P70">The pairwise posterior co-assignment probabilities, for all pairs of individuals, are also provided in an output file. So any user who wants to use these probabilities as measures of similarity, and apply a classical hierarchical clustering algorithm (such as single linkage <xref ref-type="bibr" rid="R19">Florek et al. (1951)</xref>; <xref ref-type="bibr" rid="R35">Sibson (1973)</xref>, complete linkage <xref ref-type="bibr" rid="R39">Sørensen (1948)</xref>; <xref ref-type="bibr" rid="R28">McQuitty (1960)</xref>; <xref ref-type="bibr" rid="R14">Defays (1977)</xref>, or average linkage <xref ref-type="bibr" rid="R37">Sokal and Michener (1958)</xref> and <xref ref-type="bibr" rid="R38">Sokal and Sneath (1963)</xref>, pages 182-185) is free to do so.</p>
    <p id="P71">Partition View was originally designed to be a companion program to the Markov chain sampler program - Partition. (For more information about the Markov chain sampler implemented in the Partition software, see <xref ref-type="bibr" rid="R12">Dawson and Belkhir (2001)</xref>.) Since the output file from Partition contains observations of the sample partition, users are free to design their own software for the visual representation of any chosen marginals of the posterior distribution of the sample partition. We would also like to make a plea to others who have developed (or may be planning to develop) their own software for sampling form the posterior distribution of the sample partition, to generate output files which contain complete observations of this type. This would mean that our visualisation software (PartitionView) could be modified to process the output file. More generally, we recommend, as a general design principal for Bayesian inference software, that Monte Carlo samplers should provide output files which contain complete observations from the posterior distribution, and that the visualisation software should be a separate module which can take such a file as input.</p>
    <p id="P72">Partition View 1.0 is freely available from the the Partition web page: <ext-link ext-link-type="uri" xlink:href="http://www.genetix.univ-montp2.fr/partition/partition.htm">http://www.genetix.univ-montp2.fr/partition/partition.htm</ext-link>.</p>
  </sec>
  <sec sec-type="supplementary-material" id="SM">
    <title>Supplementary Material</title>
    <supplementary-material content-type="local-data" id="SD1">
      <label>Supplementary Material</label>
      <media xlink:href="NIHMS3290-supplement-1.pdf" xlink:type="simple" id="d35e2057" position="anchor" mimetype="application" mime-subtype="pdf"/>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack id="S13">
    <title>Acknowledgements</title>
    <p>This work was supported by a BBSRC grant (reference: 206/D16977) to Kevin Dawson, and by the CNRS BIOINFO initiative. Rothamsted Research receives grant-aided support form the BBSRC (the Biotechnology and Biological Sciences Research Council of the United Kingdom). We are grateful to Ian Wilson for help with the IMPPS software package. We are also grateful to Jerry Pella and Michele Masuda for providing us with a number of output files from their program HWLER, one of which was reanalysed here. Kevin Dawson thanks Toby Johnson for useful discussion of some computational issues. We also thank two anonymous referees for their comments on an earlier version of the manuscript.</p>
  </ack>
  <fn-group>
    <fn id="FN1">
      <label>1</label>
      <p id="P73">Analyse.exe was an unfortunate choice of name (as it has already been used in population genetics, and no doubt elsewhere). It might be best to rename this program posthumously as PartitionView0.exe.</p>
    </fn>
  </fn-group>
  <ref-list>
    <title>References</title>
    <ref id="R1">
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Aigner</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <source>Combinatorial theory</source>
        <year>1979</year>
        <publisher-name>Springer-Verlag</publisher-name>
        <publisher-loc>New York</publisher-loc>
      </element-citation>
    </ref>
    <ref id="R2">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Almudevar</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Field</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>Inference of single generation sibling relationships based on DNA markers</article-title>
        <source>Journal of Agricultural Biology and Environmental statistics</source>
        <year>1999</year>
        <volume>4</volume>
        <fpage>136</fpage>
        <lpage>165</lpage>
      </element-citation>
    </ref>
    <ref id="R3">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Anderson</surname>
            <given-names>EC</given-names>
          </name>
          <name>
            <surname>Thompson</surname>
            <given-names>EA</given-names>
          </name>
        </person-group>
        <article-title>A model-based method for identifying species hybrids using multilocus genetic data</article-title>
        <source>Genetics</source>
        <year>2002</year>
        <volume>106</volume>
        <fpage>1217</fpage>
        <lpage>1229</lpage>
        <pub-id pub-id-type="pmid">11901135</pub-id>
      </element-citation>
    </ref>
    <ref id="R4">
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Berger</surname>
            <given-names>JO</given-names>
          </name>
        </person-group>
        <source>Statistical Decision Theory and Bayesian Analysis</source>
        <year>1985</year>
        <publisher-name>Springer-Verlag</publisher-name>
        <publisher-loc>New York</publisher-loc>
        <edition>2nd edition</edition>
      </element-citation>
    </ref>
    <ref id="R5">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Celeux</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Hurn</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Robert</surname>
            <given-names>CP</given-names>
          </name>
        </person-group>
        <article-title>Computational and inferential difficulties with mixture posterior distributions</article-title>
        <source>Journal of the American Statistical Association</source>
        <year>2000</year>
        <volume>95</volume>
        <fpage>957</fpage>
        <lpage>970</lpage>
      </element-citation>
    </ref>
    <ref id="R6">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chen</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Durand</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Forbes</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>François</surname>
            <given-names>O</given-names>
          </name>
        </person-group>
        <article-title>Bayesian clustering algorithms ascertaining spatial population structure: a new computer program and a comparison study</article-title>
        <source>Molecular Ecology Notes</source>
        <year>2007</year>
        <volume>7</volume>
        <fpage>747</fpage>
        <lpage>756</lpage>
      </element-citation>
    </ref>
    <ref id="R7">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Corander</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Marttinen</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>Bayesian identification of admixture events using multilocus molecular markers</article-title>
        <source>Molecular Ecology</source>
        <year>2006</year>
      </element-citation>
    </ref>
    <ref id="R8">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Corander</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Marttinen</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Mäntyniemi</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>A Bayesian method for identification of stock mixtures from molecular marker data</article-title>
        <source>Fishery Bulletin</source>
        <year>2006</year>
        <volume>104</volume>
        <fpage>550</fpage>
        <lpage>558</lpage>
      </element-citation>
    </ref>
    <ref id="R9">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Corander</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Waldmann</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Marttinen</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Sillanpää</surname>
            <given-names>MJ</given-names>
          </name>
        </person-group>
        <article-title>BAPS2: Enhanced possibilities for the analysis of genetic population structure</article-title>
        <source>Bioinformatics</source>
        <year>2004</year>
        <volume>20</volume>
        <issue>15</issue>
        <fpage>2363</fpage>
        <lpage>2369</lpage>
        <pub-id pub-id-type="pmid">15073024</pub-id>
      </element-citation>
    </ref>
    <ref id="R10">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Corander</surname>
            <given-names>JC</given-names>
          </name>
          <name>
            <surname>Waldmann</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Sillanpää</surname>
            <given-names>MJ</given-names>
          </name>
        </person-group>
        <article-title>Bayesian anlysis of genetic differentiation between populations</article-title>
        <source>Genetics</source>
        <year>2003</year>
        <volume>163</volume>
        <fpage>367</fpage>
        <lpage>374</lpage>
        <pub-id pub-id-type="pmid">12586722</pub-id>
      </element-citation>
    </ref>
    <ref id="R11">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Coulon</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Fitzpatrick</surname>
            <given-names>JW</given-names>
          </name>
          <name>
            <surname>Bowman</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Stith</surname>
            <given-names>BM</given-names>
          </name>
          <name>
            <surname>Makarewich</surname>
            <given-names>CA</given-names>
          </name>
          <name>
            <surname>Stenzler</surname>
            <given-names>LM</given-names>
          </name>
          <name>
            <surname>Lovette</surname>
            <given-names>IJ</given-names>
          </name>
        </person-group>
        <article-title>Congruent population structure inferred from dispersal behaviour and intensive genetic surveys of the threatened Florida scrub-jay (<italic>Aphelocoma coerulescens</italic>)</article-title>
        <source>Molecular Ecology</source>
        <year>2008</year>
        <volume>17</volume>
        <fpage>1685</fpage>
        <lpage>1701</lpage>
        <pub-id pub-id-type="pmid">18371014</pub-id>
      </element-citation>
    </ref>
    <ref id="R12">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dawson</surname>
            <given-names>KJ</given-names>
          </name>
          <name>
            <surname>Belkhir</surname>
            <given-names>K</given-names>
          </name>
        </person-group>
        <article-title>A Bayesian approach to the identification of panmictic populations and the assignment of individuals</article-title>
        <source>Genetical Research</source>
        <year>2001</year>
        <volume>78</volume>
        <fpage>59</fpage>
        <lpage>77</lpage>
        <pub-id pub-id-type="pmid">11556138</pub-id>
      </element-citation>
    </ref>
    <ref id="R13">
      <element-citation publication-type="confproc">
        <person-group person-group-type="author">
          <name>
            <surname>Dawson</surname>
            <given-names>KJ</given-names>
          </name>
          <name>
            <surname>Belkhir</surname>
            <given-names>K</given-names>
          </name>
        </person-group>
        <source>A Bayesian approach to assignment problems in population genetics: Partition and related software packages</source>
        <volume>33</volume>
        <fpage>745</fpage>
        <lpage>746</lpage>
        <conf-name>Proceedings of the Seventh World Congress of Genetics Applied to Livestock Production</conf-name>
        <conf-date>2002</conf-date>
      </element-citation>
    </ref>
    <ref id="R14">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Defays</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>An efficient algorithm for a complete link method</article-title>
        <source>Computer Journal</source>
        <year>1977</year>
        <volume>20</volume>
        <fpage>364</fpage>
        <lpage>366</lpage>
      </element-citation>
    </ref>
    <ref id="R15">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Edwards</surname>
            <given-names>AWF</given-names>
          </name>
          <name>
            <surname>Cavalli-Sforza</surname>
            <given-names>LL</given-names>
          </name>
        </person-group>
        <article-title>A method for cluster analysis</article-title>
        <source>Biometrics</source>
        <year>1965</year>
        <volume>21</volume>
        <fpage>362</fpage>
        <lpage>375</lpage>
        <pub-id pub-id-type="pmid">14338671</pub-id>
      </element-citation>
    </ref>
    <ref id="R16">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Emery</surname>
            <given-names>AM</given-names>
          </name>
          <name>
            <surname>Wilson</surname>
            <given-names>IJ</given-names>
          </name>
          <name>
            <surname>Craig</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Boyle</surname>
            <given-names>PR</given-names>
          </name>
          <name>
            <surname>Noble</surname>
            <given-names>LR</given-names>
          </name>
        </person-group>
        <article-title>Assignment of paternity groups without access to parental genotypes: Multiple mating and developmental plasticity in squid</article-title>
        <source>Molecular Ecology</source>
        <year>2001</year>
        <volume>10</volume>
        <fpage>1265</fpage>
        <lpage>1278</lpage>
        <pub-id pub-id-type="pmid">11380883</pub-id>
      </element-citation>
    </ref>
    <ref id="R17">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Falush</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Stephens</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Pritchard</surname>
            <given-names>JK</given-names>
          </name>
        </person-group>
        <article-title>Inference of population structure using multilocus genotype data: linked loci and correlated allele frequencies</article-title>
        <source>Genetics</source>
        <year>2003</year>
        <volume>164</volume>
        <fpage>1567</fpage>
        <lpage>1587</lpage>
        <pub-id pub-id-type="pmid">12930761</pub-id>
      </element-citation>
    </ref>
    <ref id="R18">
      <element-citation publication-type="webpage">
        <person-group person-group-type="author">
          <name>
            <surname>Felsenstein</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <source>PHYLIP (Phylogeny Inference Package) version 3.6</source>
        <year>2004</year>
        <comment>Distributed by the author via <ext-link ext-link-type="uri" xlink:href="http://evolution.gs.washington.edu/phylip.html">http://evolution.gs.washington.edu/phylip.html</ext-link></comment>
      </element-citation>
    </ref>
    <ref id="R19">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Florek</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Lukaszewics</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Perkal</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Steinhaus</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Zubrzycki</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Sur la liaison et la division des points d’un ensemble fini</article-title>
        <source>Colloquium Mathematicum</source>
        <year>1951</year>
        <volume>2</volume>
        <fpage>282</fpage>
        <lpage>285</lpage>
      </element-citation>
    </ref>
    <ref id="R20">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>François</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Ancelet</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Guillot</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>Bayesian clustering using hidden markov random fields in spatial population genetics</article-title>
        <source>Genetics</source>
        <year>2006</year>
        <volume>174</volume>
        <fpage>805</fpage>
        <lpage>816</lpage>
        <pub-id pub-id-type="pmid">16888334</pub-id>
      </element-citation>
    </ref>
    <ref id="R21">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gilks</surname>
            <given-names>WR</given-names>
          </name>
        </person-group>
        <article-title>Contribution to discussion of “on Bayesian analysis of mixtures with an unknown number of components”, by: Richardson, s., and green, p. j</article-title>
        <source>Journal of the Royal Statistical Society, Series B (Statistical Methodology)</source>
        <year>1997</year>
        <volume>59</volume>
        <fpage>770</fpage>
        <lpage>771</lpage>
      </element-citation>
    </ref>
    <ref id="R22">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Guillot</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Estoup</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Morter</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Cosson</surname>
            <given-names>J-F</given-names>
          </name>
        </person-group>
        <article-title>A spatial-statistical model for landscape genetics</article-title>
        <source>Genetics</source>
        <year>2005</year>
        <volume>170</volume>
        <fpage>1261</fpage>
        <lpage>1280</lpage>
        <pub-id pub-id-type="pmid">15520263</pub-id>
      </element-citation>
    </ref>
    <ref id="R23">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hadfield</surname>
            <given-names>JD</given-names>
          </name>
          <name>
            <surname>Richardson</surname>
            <given-names>DS</given-names>
          </name>
          <name>
            <surname>Burke</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>Towards unbiased parentage assignment: combining genetic, behavioural and spatial data in Bayesian framework</article-title>
        <source>Molecular Ecology</source>
        <year>2006</year>
        <volume>15</volume>
        <fpage>3715</fpage>
        <lpage>3730</lpage>
        <pub-id pub-id-type="pmid">17032269</pub-id>
      </element-citation>
    </ref>
    <ref id="R24">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Huelsenbeck</surname>
            <given-names>JP</given-names>
          </name>
          <name>
            <surname>Andolfatto</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>Inference of population structure under a Dirichlet process model genetics</article-title>
        <source>Genetics</source>
        <year>2007</year>
        <volume>175</volume>
        <fpage>1787</fpage>
        <lpage>1802</lpage>
        <pub-id pub-id-type="pmid">17237522</pub-id>
      </element-citation>
    </ref>
    <ref id="R25">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hurn</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Justel</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Robert</surname>
            <given-names>CP</given-names>
          </name>
        </person-group>
        <article-title>Estimating mixtures of regressions</article-title>
        <source>Journal of Computational and Graphical Statistics</source>
        <year>2003</year>
        <volume>12</volume>
        <fpage>55</fpage>
        <lpage>79</lpage>
      </element-citation>
    </ref>
    <ref id="R26">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jakobsson</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Rosenberg</surname>
            <given-names>NA</given-names>
          </name>
        </person-group>
        <article-title>CLUMPP: a cluster matching and permutation program for dealing with label switching and multimodality in analysis population structure</article-title>
        <source>Bioinformatics</source>
        <year>2007</year>
        <volume>23</volume>
        <issue>14</issue>
        <fpage>1801</fpage>
        <lpage>1806</lpage>
        <pub-id pub-id-type="pmid">17485429</pub-id>
      </element-citation>
    </ref>
    <ref id="R27">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jasra</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Holmes</surname>
            <given-names>CC</given-names>
          </name>
          <name>
            <surname>Stephens</surname>
            <given-names>DA</given-names>
          </name>
        </person-group>
        <article-title>Markov chain Monte Carlo methods and the label switching problem in Bayesian mixture modelling</article-title>
        <source>Statistical Science</source>
        <year>2005</year>
        <volume>20</volume>
        <fpage>50</fpage>
        <lpage>67</lpage>
      </element-citation>
    </ref>
    <ref id="R28">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>McQuitty</surname>
            <given-names>LL</given-names>
          </name>
        </person-group>
        <article-title>Hierarchical linkage analysis for the isolation of types</article-title>
        <source>Educational and Psychological Measurement</source>
        <year>1960</year>
        <volume>20</volume>
        <fpage>55</fpage>
        <lpage>67</lpage>
      </element-citation>
    </ref>
    <ref id="R29">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>O’Hagan</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Contribution to discussion of “on Bayesian analysis of mixtures with an unknown number of components”, by: Richardson, s., and green, p. j</article-title>
        <source>Journal of the Royal Statistical Society, Series B (Statistical Methodology)</source>
        <year>1997</year>
        <volume>59</volume>
        <fpage>772</fpage>
      </element-citation>
    </ref>
    <ref id="R30">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Painter</surname>
            <given-names>I</given-names>
          </name>
        </person-group>
        <article-title>Sibship reconstruction without parental information</article-title>
        <source>Journal of Agricultural Biology and Environmental statistics</source>
        <year>1997</year>
        <volume>2</volume>
        <fpage>212</fpage>
        <lpage>229</lpage>
      </element-citation>
    </ref>
    <ref id="R31">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pella</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Masuda</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>The gibbs and split-merge sampler for population mixture analysis from genetic data with incomplete baselines</article-title>
        <source>Canadian Journal of Fisheries and Aquatic Sciences</source>
        <year>2006</year>
        <volume>63</volume>
        <fpage>576</fpage>
        <lpage>596</lpage>
      </element-citation>
    </ref>
    <ref id="R32">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pritchard</surname>
            <given-names>JK</given-names>
          </name>
          <name>
            <surname>Stephens</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Donnelly</surname>
            <given-names>PJ</given-names>
          </name>
        </person-group>
        <article-title>Inference of population structure using multilocus genotype data</article-title>
        <source>Genetics</source>
        <year>2000</year>
        <volume>155</volume>
        <fpage>945</fpage>
        <lpage>959</lpage>
        <pub-id pub-id-type="pmid">10835412</pub-id>
      </element-citation>
    </ref>
    <ref id="R33">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Richardson</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Green</surname>
            <given-names>PJ</given-names>
          </name>
        </person-group>
        <article-title>On Bayesian analysis of mixtures with an unknown number of components</article-title>
        <source>Journal of the Royal Statistical Society, Series B (Statistical Methodology)</source>
        <year>1997</year>
        <volume>59</volume>
        <fpage>731</fpage>
        <lpage>758</lpage>
      </element-citation>
    </ref>
    <ref id="R34">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rosenberg</surname>
            <given-names>NA</given-names>
          </name>
        </person-group>
        <article-title>DESTRUCT: a program for the graphical display of population structure</article-title>
        <source>Molecular Ecology Notes</source>
        <year>2004</year>
        <volume>4</volume>
        <fpage>137</fpage>
        <lpage>138</lpage>
      </element-citation>
    </ref>
    <ref id="R35">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sibson</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>SLINK: An optimally efficient algorithm for the single-link cluster method</article-title>
        <source>Computer Journal</source>
        <year>1973</year>
        <volume>16</volume>
        <fpage>30</fpage>
        <lpage>34</lpage>
      </element-citation>
    </ref>
    <ref id="R36">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Smith</surname>
            <given-names>BR</given-names>
          </name>
          <name>
            <surname>Herbinger</surname>
            <given-names>CM</given-names>
          </name>
          <name>
            <surname>Merry</surname>
            <given-names>HR</given-names>
          </name>
        </person-group>
        <article-title>Accurate partition of individuals into full-sib families from genetic data without parental information</article-title>
        <source>Genetics</source>
        <year>2001</year>
        <volume>158</volume>
        <fpage>1329</fpage>
        <lpage>1338</lpage>
        <pub-id pub-id-type="pmid">11454779</pub-id>
      </element-citation>
    </ref>
    <ref id="R37">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sokal</surname>
            <given-names>RR</given-names>
          </name>
          <name>
            <surname>Michener</surname>
            <given-names>CD</given-names>
          </name>
        </person-group>
        <article-title>A statistical method for evaluating systematic relationships</article-title>
        <source>University of Kansas Science Bulletin</source>
        <year>1958</year>
        <volume>38</volume>
        <fpage>1409</fpage>
        <lpage>1438</lpage>
      </element-citation>
    </ref>
    <ref id="R38">
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Sokal</surname>
            <given-names>RR</given-names>
          </name>
          <name>
            <surname>Sneath</surname>
            <given-names>PHA</given-names>
          </name>
        </person-group>
        <source>Principles of Numerical Taxonomy</source>
        <year>1963</year>
        <publisher-name>W. H. Freeman and Company</publisher-name>
        <publisher-loc>San Francisco</publisher-loc>
      </element-citation>
    </ref>
    <ref id="R39">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sørensen</surname>
            <given-names>TJ</given-names>
          </name>
        </person-group>
        <article-title>A method of establishing groups of equal amplitude in plant sociology based on similarity of species and its application to analyses of the vegetation on Danish commons</article-title>
        <source>Biologiske Skrifter / Kongelige Danske Videnskabernes Selskab</source>
        <year>1948</year>
        <volume>5</volume>
        <issue>4</issue>
        <fpage>1</fpage>
        <lpage>34</lpage>
      </element-citation>
    </ref>
    <ref id="R40">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Stephens</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Contribution to discussion of “on Bayesian analysis of mixtures with an unknown number of components”, by: Richardson, s., and green, p. j</article-title>
        <source>Journal of the Royal Statistical Society, Series B (Statistical Methodology)</source>
        <year>1997</year>
        <volume>59</volume>
        <fpage>768</fpage>
        <lpage>769</lpage>
      </element-citation>
    </ref>
    <ref id="R41">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Stephens</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Dealing with label-switching in mixture models</article-title>
        <source>Journal of the Royal Statistical Society, Series B (Statistical Methodology)</source>
        <year>2000</year>
        <volume>62</volume>
        <fpage>795</fpage>
        <lpage>809</lpage>
      </element-citation>
    </ref>
    <ref id="R42">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Thomas</surname>
            <given-names>SC</given-names>
          </name>
          <name>
            <surname>Hill</surname>
            <given-names>WG</given-names>
          </name>
        </person-group>
        <article-title>Estimating quantitative genetic parameters using sibships reconstructed from marker data</article-title>
        <source>Genetics</source>
        <year>2000</year>
        <volume>155</volume>
        <fpage>1961</fpage>
        <lpage>1972</lpage>
        <pub-id pub-id-type="pmid">10924488</pub-id>
      </element-citation>
    </ref>
    <ref id="R43">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Thomas</surname>
            <given-names>SC</given-names>
          </name>
          <name>
            <surname>Hill</surname>
            <given-names>WG</given-names>
          </name>
        </person-group>
        <article-title>Sibships reconstruction in hierarchical population structures using markov chain monte carlo techniques</article-title>
        <source>Genetical Research</source>
        <year>2002</year>
        <volume>79</volume>
        <fpage>227</fpage>
        <lpage>234</lpage>
        <pub-id pub-id-type="pmid">12220130</pub-id>
      </element-citation>
    </ref>
    <ref id="R44">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <source>Sibships reconstruction from genetic data with typing errors</source>
        <year>2004</year>
        <volume>166</volume>
        <fpage>1963</fpage>
        <lpage>1979</lpage>
      </element-citation>
    </ref>
    <ref id="R45">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wasser</surname>
            <given-names>SK</given-names>
          </name>
          <name>
            <surname>Shedlock</surname>
            <given-names>AM</given-names>
          </name>
          <name>
            <surname>Comstock</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Ostrander</surname>
            <given-names>EA</given-names>
          </name>
          <name>
            <surname>Mutayoba</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Stephens</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Assigning african elephant DNA to geographic region of origin: Applications to the ivory trade</article-title>
        <source>Proceedings of the National Academy of Sciences, USA</source>
        <year>2004</year>
        <volume>101</volume>
        <issue>41</issue>
        <fpage>14847</fpage>
        <lpage>14852</lpage>
      </element-citation>
    </ref>
    <ref id="R46">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wilson</surname>
            <given-names>IJ</given-names>
          </name>
          <name>
            <surname>Dawson</surname>
            <given-names>KJ</given-names>
          </name>
        </person-group>
        <article-title>A Markov chain Monte Carlo strategy for sampling from the joint posterior distribution of pedigrees and population parameters under a Fisher-Wright model with partial selfing</article-title>
        <source>Theoretical Population Biology</source>
        <year>2007</year>
        <volume>72</volume>
        <fpage>436</fpage>
        <lpage>458</lpage>
        <pub-id pub-id-type="pmid">17448511</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
<floats-group>
  <fig id="F1" position="float">
    <label>figure 1</label>
    <caption>
      <title>The exact linkage algorithm</title>
      <p>Here we illustrate the exact linkage algorithm with an example for a sample of 5 individuals. At the initialisation step (iteration <italic>t</italic> = 0) we create 5 terminal nodes, labelled respectively 1, 2, 3, 4 and 5. This is followed by iterations <italic>t</italic> = 1, 2, 3, 4. At each iteration <italic>t</italic> (≥ 1) we begin with an <italic>update</italic> step. This is followed by an <italic>acceptance</italic> step at which we create a new internal node, labelled -<italic>t</italic> (where <italic>t</italic> is the iteration at which it is created). At the update step we update the set of proposed nodes. This updated set of proposed nodes is formed from all possible pairs of the root nodes available at the start of the present iteration. In Figure 1, every node (The height of a node is equal to the co-assignment probability of the set of individuals defined by the node) is positioned at a height equal to the co-assignment probability of the set defined by that node. The proposed nodes are arranged on the vertical axis to the right of the forest. (The height of a node is equal to the co-assignment probability of the set of individuals defined by the node.) Notice that it is always the highest proposed node which is accepted. At iteration <italic>t</italic> = 1 the proposed node (4, 5) is accepted and added to the tree, where it is labelled -1. At iteration <italic>t</italic> = 2 the proposed node (1, 2) is accepted and added to the tree, where it is labelled -2. At iteration <italic>t</italic> = 3 the proposed node (-1, 3) is accepted and added to the tree, where it is labelled -3. At iteration <italic>t</italic> = 4 the proposed node (-3, -2) is accepted and added to the tree, where it is labelled -4.</p>
    </caption>
    <graphic xlink:href="ukmss-3290-f0001"/>
  </fig>
  <fig id="F2" position="float">
    <label>figure 2</label>
    <caption>
      <title>Example 1. The true matrilineal pedigree of the simulated data set</title>
      <p>The true matrilineal pedigree of the exhaustive sample of all <italic>n</italic> = <italic>N</italic> = 100 individuals from a single local population. Outcrossing events are indicated by diamonds. Those selfing lines which are represented in the sample by more than 2 individuals are colour-coded.</p>
    </caption>
    <graphic xlink:href="ukmss-3290-f0002"/>
  </fig>
  <fig id="F3" position="float">
    <label>figure 3</label>
    <caption>
      <title>Example 1. Output from the exact linkage algorithm</title>
      <p>The rooted binary forest generated by applying the exact linkage algorithm to the output from the IMPPS Markov chain sampler (a pooled sample of 60 000 observations).</p>
    </caption>
    <graphic xlink:href="ukmss-3290-f0003"/>
  </fig>
  <fig id="F4" position="float">
    <label>figure 4</label>
    <caption>
      <title>Example 2. Output from the maximin agglomerative algorithm with <italic>d</italic> = 2</title>
      <p>The rooted binary forest generated by applying the maximin agglomerative algorithm, with <italic>d</italic> = 2, to the output from the HWLER Markov chain sampler.</p>
    </caption>
    <graphic xlink:href="ukmss-3290-f0004"/>
  </fig>
  <fig id="F5" position="float">
    <label>figure 5</label>
    <caption>
      <title>Example 2. Output from the maximin agglomerative algorithm with <italic>d</italic> = 3</title>
      <p>The rooted binary forest generated by applying the maximin agglomerative algorithm, with <italic>d</italic> = 3, to the output from the HWLER Markov chain sampler.</p>
    </caption>
    <graphic xlink:href="ukmss-3290-f0005"/>
  </fig>
  <fig id="F6" position="float">
    <label>figure 6</label>
    <caption>
      <title>Example 2. Output from the maximin agglomerative algorithm with <italic>d</italic> = 4</title>
      <p>The rooted binary forest generated by applying the maximin agglomerative algorithm, with <italic>d</italic> = 4, to the output from the HWLER Markov chain sampler.</p>
    </caption>
    <graphic xlink:href="ukmss-3290-f0006"/>
  </fig>
  <fig id="F7" position="float">
    <label>figure 7</label>
    <caption>
      <title>Example 2. Output from the exact linkage algorithm</title>
      <p>The rooted binary forest generated by applying the exact linkage algorithm to the output from the HWLER Markov chain sampler.</p>
    </caption>
    <graphic xlink:href="ukmss-3290-f0007"/>
  </fig>
</floats-group>
