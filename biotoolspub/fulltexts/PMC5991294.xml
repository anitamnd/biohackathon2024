<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1 20151215//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.1?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">PeerJ</journal-id>
    <journal-id journal-id-type="iso-abbrev">PeerJ</journal-id>
    <journal-id journal-id-type="pmc">PeerJ</journal-id>
    <journal-id journal-id-type="publisher-id">PeerJ</journal-id>
    <journal-title-group>
      <journal-title>PeerJ</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2167-8359</issn>
    <publisher>
      <publisher-name>PeerJ Inc.</publisher-name>
      <publisher-loc>San Francisco, USA</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">5991294</article-id>
    <article-id pub-id-type="publisher-id">4958</article-id>
    <article-id pub-id-type="doi">10.7717/peerj.4958</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Bioinformatics</subject>
      </subj-group>
      <subj-group subj-group-type="heading">
        <subject>Genomics</subject>
      </subj-group>
      <subj-group subj-group-type="heading">
        <subject>Computational Science</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>D-GENIES: dot plot large genomes in an interactive, efficient and simple way</article-title>
    </title-group>
    <contrib-group>
      <contrib id="author-1" contrib-type="author">
        <name>
          <surname>Cabanettes</surname>
          <given-names>Floréal</given-names>
        </name>
      </contrib>
      <contrib id="author-2" contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">http://orcid.org/0000-0001-7126-5477</contrib-id>
        <name>
          <surname>Klopp</surname>
          <given-names>Christophe</given-names>
        </name>
        <email>christophe.klopp@toulouse.inra.fr</email>
      </contrib>
      <aff><institution>Plate-forme bio-informatique Genotoul, Mathématiques et Informatique Appliquées de Toulouse, INRA</institution>, <addr-line>Castanet Tolosan</addr-line>, <country>France</country></aff>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Tullius</surname>
          <given-names>Thomas</given-names>
        </name>
      </contrib>
    </contrib-group>
    <pub-date pub-type="epub" date-type="pub" iso-8601-date="2018-06-04">
      <day>4</day>
      <month>6</month>
      <year iso-8601-date="2018">2018</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2018</year>
    </pub-date>
    <volume>6</volume>
    <elocation-id>e4958</elocation-id>
    <history>
      <date date-type="received" iso-8601-date="2018-03-12">
        <day>12</day>
        <month>3</month>
        <year iso-8601-date="2018">2018</year>
      </date>
      <date date-type="accepted" iso-8601-date="2018-05-22">
        <day>22</day>
        <month>5</month>
        <year iso-8601-date="2018">2018</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© 2018 Cabanettes and Klopp</copyright-statement>
      <copyright-year>2018</copyright-year>
      <copyright-holder>Cabanettes and Klopp</copyright-holder>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, reproduction and adaptation in any medium and for any purpose provided that it is properly attributed. For attribution, the original author(s), title, publication source (PeerJ) and either DOI or URL of the article must be cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="https://peerj.com/articles/4958"/>
    <abstract>
      <p>Dot plots are widely used to quickly compare sequence sets. They provide a synthetic similarity overview, highlighting repetitions, breaks and inversions. Different tools have been developed to easily generated genomic alignment dot plots, but they are often limited in the input sequence size. D-GENIES is a standalone and web application performing large genome alignments using minimap2 software package and generating interactive dot plots. It enables users to sort query sequences along the reference, zoom in the plot and download several image, alignment or sequence files. D-GENIES is an easy-to-install, open-source software package (GPL) developed in Python and JavaScript. The source code is available at <uri xlink:href="https://github.com/genotoul-bioinfo/dgenies">https://github.com/genotoul-bioinfo/dgenies</uri> and it can be tested at <uri xlink:href="http://dgenies.toulouse.inra.fr/">http://dgenies.toulouse.inra.fr/</uri>.</p>
    </abstract>
    <kwd-group kwd-group-type="author">
      <kwd>Dot plot</kwd>
      <kwd>Genome assessment</kwd>
      <kwd>Interactive user interface</kwd>
      <kwd>Large genomes</kwd>
    </kwd-group>
    <funding-group>
      <award-group id="fund-1">
        <funding-source>France Génomique National infrastructure (funded as part of Investissement d’Avenir Program managed by Agence Nationale pour la Recherche, contract ANR-10-INBS-0009)</funding-source>
      </award-group>
      <funding-statement>This work was supported by the France Génomique National infrastructure (funded as part of Investissement d’Avenir Program managed by Agence Nationale pour la Recherche, contract ANR-10-INBS-0009). The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
    </funding-group>
  </article-meta>
</front>
<body>
  <sec sec-type="intro">
    <title>Introduction</title>
    <p>Dot plots are commonly used to visually compare two sets of sequences. They present insertions, deletions, inversions or repeats in an easily understandable manner. They can represent similarity differences using variable line thickness, line forms or colors. With the increasing numbers of genome assemblies produced there is a need for simple-to-use and efficient tools to produce dot plots of large genomes.</p>
    <p>Existing dot plot tools can be classified in two generations. The first, and oldest, comprises command line tools producing static graphics and includes among others tupple_plot (<xref rid="ref-7" ref-type="bibr">Szafranski, Jahn &amp; Platzer, 2006</xref>) and dot-matrix (<xref rid="ref-6" ref-type="bibr">Sonnhammer &amp; Durbin, 1995</xref>). They usually chain two processing steps, the first of which produces a match files used in the second step which renders the graphical output. They are often limited to single sequence FASTA files and do not enable any interaction with the produced graphic. Both mentioned tools are only running on Unix computers. The software packages of the second generation have been developed in java in order to be platform independent and user friendlier. They include tools such as JDotter (<xref rid="ref-1" ref-type="bibr">Brodie, Roper &amp; Upton, 2004</xref>), Gepard (<xref rid="ref-4" ref-type="bibr">Krumsiek, Arnold &amp; Rattei, 2007</xref>) and r2cat (<xref rid="ref-3" ref-type="bibr">Husemann &amp; Stoye, 2009</xref>). User interaction permitted to add new dynamic features such as sequence orientation and ordering to maximize the diagonal alignment matches in order to ease visual comparison. These tools have also input sequence size limitations. For example, Gepard takes over an hour to align human chromosomes 1 vs. itself and plot the result.</p>
    <p>A new generation of JavaScript based dot plot visualization tools emerges. One of its early members is <uri xlink:href="https://dnanexus.github.io/dot/">https://dnanexus.github.io/dot/</uri>. Users have first to produce coordinates and index files before uploading them in order to render the dot plot. They can add annotations which will be displayed in the graph margins.</p>
    <p>We present hereafter D-GENIES, an interactive, rapid and easy-to-use standalone and web application permitting to produce a complete human vs chimpanzee genome dot plot in one hour and 10 min.</p>
  </sec>
  <sec>
    <title>Implementation</title>
    <sec>
      <title>Fast dot plot computation</title>
      <p>D-GENIES takes advantage of minimap2 (<xref rid="ref-5" ref-type="bibr">Li, 2017</xref>), one of the latest nucleic sequence alignment program which is able to map very large lowly similar multi-FASTA files. D-GENIES can only produce dot plots for nucleic sequences. In order to limit memory consumption and lower processing time, the program splits large sequence queries, such as chromosomes, in ten mega-base chunks. Processing time and memory consumption are presented in the results and discussion section hereafter.</p>
    </sec>
    <sec>
      <title>Simple interactive user friendly interface</title>
      <p>The Pairwise mApping Format (PAF) file is rendered in the dot plot by a JavaScript client developed with d3.js (<xref rid="ref-2" ref-type="bibr">Bostock, Ogievetsky &amp; Heer, 2011</xref>; <uri xlink:href="https://d3js.org/">https://d3js.org/</uri>). To limit drawing time, only the hundred thousand largest alignments are plotted.</p>
      <p>Both the standalone and web application are accessed through a web browser. The page top menu (<xref ref-type="fig" rid="fig-1">Fig. 1</xref>) permits to launch a new alignment, visualize plots, browse the example gallery or documentation and contact support. To produce a dot plot, a user clicks on the <bold>Run</bold> menu item and fills three or four input boxes. A modifiable job name is automatically attributed to the dot plot. The user email address is mandatory. The application will send a message once the dot plot is rendered. The application has two modes called <bold>New alignment</bold> and <bold>Plot alignment</bold>. In <bold>New alignment</bold> mode, both, query and target FASTA files can be uploaded from the local machine or given URLs. Reference and query files can be compressed in gzip format. If no query file is provided, the reference will be aligned on itself and all trivial matches corresponding to same sequence and same positions will be removed. After hitting the submit button, the user can follow the upload and processing progression presented with different texts and progress bars. Once the job is ended, an email containing the result page link is sent to the user. The same link appears in the monitoring page. If a user has several stored results, they can be accessed using the drop down menu of the <bold>Results</bold> menu item. In <bold>Plot alignment</bold> mode, three files or links have to be provided to D-GENIES, two FASTA or FASTA index files and one alignment file in PAF or MAF format. FASTA files can be gzip compressed. In this mode, the application only renders the graphic. Once the dot plot is generated, one can download an archive containing the three files and re-upload it anytime, using the <bold>Backup file</bold> input box located on the same page, to redraw the graphic.</p>
      <fig id="fig-1" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.7717/peerj.4958/fig-1</object-id>
        <label>Figure 1</label>
        <caption>
          <title>Results page view.</title>
          <p>(A) Main menu to navigate D-GENIES pages. (B) Reference and query sequence drop down selection boxes and button to zoom in the alignment. (C) Export menu to download image files (PNG and SVG), alignment, ordered query and unaligned query or reference FASTA files. (D) Identity color panel. (E) Match size filtering slider. (F) Identity filtering entry and check boxes. (G) Strong precision check-box. (H) Line width slider. (I) Reference and query border horizontal and vertical border line slider. (J) Query sort and unsort button. (K) Noise filtering button. (L) Similarity summary button. (M) Delete job button.</p>
        </caption>
        <graphic xlink:href="peerj-06-4958-g001"/>
      </fig>
      <p>The <bold>Results</bold> page (<xref ref-type="fig" rid="fig-1">Fig. 1</xref>), when first accessed, presents the dot plot following the FASTA files sequence order. The alignment matches are presented as colored lines. Colors correspond to similarity values binned in four groups (less than 25%, between 25% and 50%, between 50% and 75% and over 75% similarity). For colorblind users, clicking on the color scale modifies the schema. A total of six color schema are already available and others can be easily added. The graphical panel top and right margins display sequence names. Depending on the sequence and name lengths, the names will be fully or partially presented. In order to ease visualization, all successive sequences smaller than 0.2% of the total length are merged in a unique super-sequence for which the margin is grayed. The left and bottom margins show the sequence size scales.</p>
      <p>At the top of the graphical panel, you will find, on the left, two drop down text areas and a button enabling to select query and target sequences to zoom to, and on the right the <bold>Export</bold> menu. The other way of zooming in the graphical panel is to click on a given square or to push the CRTL key while turning the mouse wheel forward to zoom in and backward to zoom out. To come back to the initial view you will click on the icon in the top right angle of the graphical panel, or press the escape key. The <bold>Export</bold> menu enables to retrieve the graphic as a PNG or SVG file, suited for publication, the PAF match file and the association table which links each query with the corresponding reference sequence, as well as the ordered query FASTA file. The unaligned query and reference sequences as well as the query sequences reorganized along the reference can also be retrieved using this menu.</p>
      <p>On the graphic right (<xref ref-type="fig" rid="fig-1">Fig. 1</xref>), you will have access to several buttons, sliders and input boxes enabling to change color schema, filter matches on their similarity and size or because they are seen as noise. They also enable to modify match or border sizes as well as to sort query sequences relatively to the reference. A match is considered noise if its size is small and its size frequency is quite high. Therefore, we group matches by size bins, the number of bins corresponds to one tenth of the number of alignments, the bins are scanned in increasing size order to find the most represented one and from this one the one corresponding to 1% of its count is searched. All the alignments in bins smaller in size than this one are considered noise. When checked, the strong precision check-box reduces match borders removing small matches from the graphical panel, often showing gaps between non contiguous matches. The delete job button located at the bottom right of the diagram can be used to discard obsolete results.</p>
      <p>If after sorting, the query sequence orientation does not not correspond to your expectation, it can be changed by right clicking in the graphic and selecting <bold>Reverse query</bold>. Right clicking enables also to export the complete graphic in PNG or SVG format.</p>
      <p>To ease dot plot comparison, clicking the <bold>Summary</bold> button generates a bar graph presenting the reference similarity profile (<xref ref-type="fig" rid="fig-2">Fig. 2</xref>), meaning the sums of match projections on the reference per similarity category divided by the total reference length. This graph is produced after sorting the query along the reference, removing included matches and noise filtering; result not shown on the graphical panel. It gives a realistic view of the overall reference and query similarity which is often not very precisely measured through visual inspection.</p>
      <fig id="fig-2" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.7717/peerj.4958/fig-2</object-id>
        <label>Figure 2</label>
        <caption>
          <title>Example of identity summary.</title>
        </caption>
        <graphic xlink:href="peerj-06-4958-g002"/>
      </fig>
      <p>All these features are documented in the <bold>Documentation</bold> menu item of the main menu. The <bold>Gallery</bold> menu item give access to several examples also presented in the “processing time” section of this article.</p>
    </sec>
    <sec>
      <title>Tools and alignment file formats extensions</title>
      <p>Adding a new aligner to D-GENIES is easy. Edit the tools.yaml file, located in the /<italic>etc/dgenies</italic> folder on unix systems, and add tool definition lines including: executable, command line skeleton, max memory usage and number of threads. If the tool does not produce a PAF formatted file, you must add the corresponding parse function in <italic>src/dgenies/lib/parsers.py</italic> and reference it in tools.yaml. Also, set split_before to True to enable query splitting ahead of mapping. If more than one aligner is available, radio buttons will appear in the <bold>Run</bold> form to select one. Their order is defined in tools.yaml, along with a help message briefly describing each tool in the interface.</p>
      <p>New alignment formats can also be added to the <bold>Plot alignment</bold> mode of the <bold>Run</bold> form. Just define a function in /<italic>dgenies/lib/validators.py</italic> having the same name as the input file extension. This function returns True if the format is valid, False if not. Then, add a function, with the same name, in the <italic>src/dgenies/lib/parsers.py</italic> Python file, coded to transform the input file in PAF format.</p>
    </sec>
    <sec>
      <title>Easy standalone or web server installation</title>
      <p>D-GENIES can be installed and run as a standalone application on Unix or MS-Windows or as a web server on Unix only. It uses the Flask framework <uri xlink:href="http://flask.pocoo.org/">http://flask.pocoo.org/</uri> back-end to serve web pages and submit jobs. In standalone mode only one process should be run in a given instance. In web server mode, several processes will be run simultaneously. Three steps are time and disk space consuming when working with large genomes: file upload, data preparation and alignment. D-GENIES uses three mechanisms to ensure robustness.</p>
      <p>When installed as a web server, it can use a computer cluster to run memory and disk intensive processes through the DRMAA layer. It also uses a local scheduler storing jobs in a MySQL database which defines process order and manages concurrency on the available cores. Because files can be large and may saturate the server, their size is tested before upload. DRMAA, MySQL parameters and maximum file size are set in the configuration file.</p>
      <p>The file folder storing the input and output files can be cleaned using the delete job button in standalone or web server mode. A cron job deleting files having more than a given number of days can also be launched periodically in web server instances.</p>
      <p>D-GENIES can be installed using the—pip install dgenies—command and and run with the—dgenies run—command. By default, on Unix, all data is stored in the user.<italic>dgenies</italic> folder. This can be modified in the application.properties configuration file located in the /<italic>etc/dgenies</italic> folder.</p>
      <p>The source code can be downloaded from <uri xlink:href="https://github.com/genotoul-bioinfo/dgenies">https://github.com/genotoul-bioinfo/dgenies</uri>.</p>
    </sec>
    <sec>
      <title>Web portal</title>
      <p>D-GENIES can be tested using the <uri xlink:href="http://dgenies.toulouse.inra.fr/">http://dgenies.toulouse.inra.fr/</uri> portal which permits to process up to 3 Gb reference and query sequence FASTA files.</p>
    </sec>
  </sec>
  <sec sec-type="results">
    <title>Results</title>
    <p>We compared D-Genies processing time with those of Gepard and r2cat for small to medium size genomes from Ensembl (<uri xlink:href="https://www.ensembl.org/">https://www.ensembl.org/</uri>), this because only minimap2 can align large ones. <xref ref-type="table" rid="table-1">Table 1</xref> presents results from tests performed with standard parameters on an eight cores Intel(R) Xeon(R) CPU E5-1630 v3 @ 3.70GHz with 32 GB RAM, using one core for the alignment, this because only minimap2 runs in multiple core mode.</p>
    <table-wrap id="table-1" orientation="portrait" position="float">
      <object-id pub-id-type="doi">10.7717/peerj.4958/table-1</object-id>
      <label>Table 1</label>
      <caption>
        <title>Processing times for Gepard, r2cat and D-GENIES.</title>
      </caption>
      <alternatives>
        <graphic xlink:href="peerj-06-4958-g003"/>
        <table frame="hsides" rules="groups" content-type="text">
          <colgroup span="1">
            <col span="1"/>
            <col span="1"/>
            <col span="1"/>
            <col span="1"/>
            <col span="1"/>
          </colgroup>
          <thead>
            <tr>
              <th rowspan="1" colspan="1">Reference genome</th>
              <th rowspan="1" colspan="1">Query sequence</th>
              <th rowspan="1" colspan="1">Gepard</th>
              <th rowspan="1" colspan="1">r2cat</th>
              <th rowspan="1" colspan="1">D-Genies</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td rowspan="1" colspan="1">E. coli K12<xref ref-type="fn" rid="table-1fn1"><sup>1</sup></xref> (5 Mb)</td>
              <td rowspan="1" colspan="1">E. coli O157:H7<xref ref-type="fn" rid="table-1fn4"><sup>4</sup></xref> (5.5 Mb)</td>
              <td rowspan="1" colspan="1">18 s</td>
              <td rowspan="1" colspan="1">5 s</td>
              <td rowspan="1" colspan="1">0.7 s</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"><italic>Asp. niger</italic><xref ref-type="fn" rid="table-1fn1"><sup>1</sup></xref> (35 Mb)</td>
              <td rowspan="1" colspan="1"><italic>Asp. terreus</italic><xref ref-type="fn" rid="table-1fn1"><sup>1</sup></xref> (30 Mb)</td>
              <td rowspan="1" colspan="1">3 min 25 s</td>
              <td rowspan="1" colspan="1">45 s</td>
              <td rowspan="1" colspan="1">5 s</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"><italic>Sol. lyco.</italic><xref ref-type="fn" rid="table-1fn2"><sup>2</sup></xref> (100 Mb)</td>
              <td rowspan="1" colspan="1"><italic>Sol. tub.</italic><xref ref-type="fn" rid="table-1fn2"><sup>2</sup></xref> (90 mb)</td>
              <td rowspan="1" colspan="1">31 min 29 s</td>
              <td rowspan="1" colspan="1">13 min<xref ref-type="fn" rid="table-1fn5"><sup>5</sup></xref></td>
              <td rowspan="1" colspan="1">4 min</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Drosophila<xref ref-type="fn" rid="table-1fn3"><sup>3</sup></xref> (146 Mb)</td>
              <td rowspan="1" colspan="1">Drosophila<xref ref-type="fn" rid="table-1fn3"><sup>3</sup></xref> (146 Mb)</td>
              <td rowspan="1" colspan="1">53 min 21 s</td>
              <td rowspan="1" colspan="1">32 min<xref ref-type="fn" rid="table-1fn5"><sup>5</sup></xref></td>
              <td rowspan="1" colspan="1">3 min</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"><italic>A. thaliana</italic><xref ref-type="fn" rid="table-1fn1"><sup>1</sup></xref> (122 Mb)</td>
              <td rowspan="1" colspan="1"><italic>A. lyrata</italic><xref ref-type="fn" rid="table-1fn1"><sup>1</sup></xref> (210 Mb)</td>
              <td rowspan="1" colspan="1">1 h 23 min</td>
              <td rowspan="1" colspan="1">55 min<xref ref-type="fn" rid="table-1fn5"><sup>5</sup></xref></td>
              <td rowspan="1" colspan="1">1 min</td>
            </tr>
          </tbody>
        </table>
      </alternatives>
      <table-wrap-foot>
        <fn id="table-1fn">
          <p>
            <bold>Notes:</bold>
          </p>
        </fn>
        <fn id="table-1fn1" fn-type="other">
          <label>1</label>
          <p>Ensembl 38 datasets.</p>
        </fn>
        <fn id="table-1fn2" fn-type="other">
          <label>2</label>
          <p>Ensembl 38 datasets, Chromosome 1.</p>
        </fn>
        <fn id="table-1fn3" fn-type="other">
          <label>3</label>
          <p>Ensembl 91 datasets.</p>
        </fn>
        <fn id="table-1fn4" fn-type="other">
          <label>4</label>
          <p>Ensemble 38 datasets, str sakai.</p>
        </fn>
        <fn id="table-1fn5" fn-type="other">
          <label>5</label>
          <p>Time without display generation: display time is high and the interface becomes buggy (memory limit is reached).</p>
        </fn>
      </table-wrap-foot>
    </table-wrap>
    <p>We also tested D-GENIES on a wider set of genomes coming from the same source including this time large genomes. <xref ref-type="table" rid="table-2">Table 2</xref> presents results from tests performed on a 32 cores Intel(R) Xeon(R) CPU E5-2670 v2 @ 2.50GHz with 256GB RAM server, using four cores for the minimap2 alignments.</p>
    <table-wrap id="table-2" orientation="portrait" position="float">
      <object-id pub-id-type="doi">10.7717/peerj.4958/table-2</object-id>
      <label>Table 2</label>
      <caption>
        <title>D-GENIES processing time and memory consumption for Ensembl datasets.</title>
      </caption>
      <alternatives>
        <graphic xlink:href="peerj-06-4958-g004"/>
        <table frame="hsides" rules="groups" content-type="text">
          <colgroup span="1">
            <col span="1"/>
            <col span="1"/>
            <col span="1"/>
            <col span="1"/>
          </colgroup>
          <thead>
            <tr>
              <th rowspan="1" colspan="1">Reference genome</th>
              <th rowspan="1" colspan="1">Query genome</th>
              <th rowspan="1" colspan="1">Elapsed time</th>
              <th rowspan="1" colspan="1">Maximum RAM usage</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td rowspan="1" colspan="1">Human<xref ref-type="fn" rid="table-2fn1"><sup>1</sup></xref> (3.5 Gb)</td>
              <td rowspan="1" colspan="1">Chimpanzee<xref ref-type="fn" rid="table-2fn1"><sup>1</sup></xref> (3.4 Gb)</td>
              <td rowspan="1" colspan="1">67 min 14 s</td>
              <td rowspan="1" colspan="1">36 GB</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Mouse<xref ref-type="fn" rid="table-2fn1"><sup>1</sup></xref> (3.4 Gb)</td>
              <td rowspan="1" colspan="1">Rat<xref ref-type="fn" rid="table-2fn1"><sup>1</sup></xref> (3.0 Gb)</td>
              <td rowspan="1" colspan="1">39 min 54 s</td>
              <td rowspan="1" colspan="1">24 GB</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Cow<xref ref-type="fn" rid="table-2fn1"><sup>1</sup></xref> (2.6 Gb)</td>
              <td rowspan="1" colspan="1">Sheep<xref ref-type="fn" rid="table-2fn1"><sup>1</sup></xref> (2.5 Gb)</td>
              <td rowspan="1" colspan="1">43 min 3 s</td>
              <td rowspan="1" colspan="1">27 GB</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"><italic>A. thaliana</italic><xref ref-type="fn" rid="table-2fn2"><sup>2</sup></xref> (135 Mb)</td>
              <td rowspan="1" colspan="1"><italic>A. lyrata</italic><xref ref-type="fn" rid="table-2fn2"><sup>2</sup></xref> (206 Mb)</td>
              <td rowspan="1" colspan="1">1 min 4 s</td>
              <td rowspan="1" colspan="1">2 GB</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Poplar<xref ref-type="fn" rid="table-2fn2"><sup>2</sup></xref> (417 Mb)</td>
              <td rowspan="1" colspan="1">Vine<xref ref-type="fn" rid="table-2fn2"><sup>2</sup></xref> (486 Mb)</td>
              <td rowspan="1" colspan="1">3 min 21 s</td>
              <td rowspan="1" colspan="1">8 GB</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"><italic>Brassica rapa</italic><xref ref-type="fn" rid="table-2fn2"><sup>2</sup></xref> (284 Mb)</td>
              <td rowspan="1" colspan="1"><italic>Brassica rapa</italic><xref ref-type="fn" rid="table-2fn2"><sup>2</sup></xref> (284 Mb)</td>
              <td rowspan="1" colspan="1">2 min 52 s</td>
              <td rowspan="1" colspan="1">8.3 Gb</td>
            </tr>
          </tbody>
        </table>
      </alternatives>
      <table-wrap-foot>
        <fn id="table-2fn">
          <p>
            <bold>Notes:</bold>
          </p>
        </fn>
        <fn id="table-2fn1" fn-type="other">
          <label>1</label>
          <p>Ensembl 91 datasets.</p>
        </fn>
        <fn id="table-2fn2" fn-type="other">
          <label>2</label>
          <p>Ensembl 38 datasets.</p>
        </fn>
      </table-wrap-foot>
    </table-wrap>
  </sec>
  <sec sec-type="discussion">
    <title>Discussion</title>
    <p>The comparison with Gepard and r2cat shows that D-GENIES processing times are respectively from eight to 83 and 3 to 55 times shorter. More often than not the difference between D-GENIES and the two other software packages increases with genome size.</p>
    <p>Using minimap2 enables to very quickly compare large sets of lowly similar sequences. The compared sequence sets correspond to full size large genomes which can not be processed by second generation dot plot software packages. D-GENIES uses the default minimap2 parameters.</p>
    <p>To limit minimap2 time and memory consumption, D-GENIES implements a chunking strategy. Large sequences are split in ten mega-base chunks which are aligned individually. When chunk alignments are contiguous they are visually joined in the graphical panel. With chunking, alignment duration dropped from 9 h and 45 min to 1 h and 7 min and memory consumption from 81 to 36 Gb for human vs chimpanzee comparison.</p>
    <p>Several examples presented in the demonstration website gallery show that minimap2 is able to align quite distant genomes: Homo and Pan, Mus and Rattus, Vitis and Populus diverged, respectively, six, 16 and 114 million years ago (<uri xlink:href="http://www.timetree.org/">http://www.timetree.org/</uri>; <xref rid="ref-8" ref-type="bibr">Kumar et al., 2017</xref>). The correspondence signal decreases when the divergence time increases. For highly divergent short sequences minimap2 will hardly output any alignment. It is possible to improve the sequence correspondence by loosening minimap2 alignment parameters in the tools.yaml file or by using another aligner able to produce paf or maf file format or by adding a new aligner to D-GENIES following the procedure presented in the &lt;&lt; tools and alignment format extension &gt;&gt; section.</p>
  </sec>
  <sec sec-type="conclusion">
    <title>Conclusion</title>
    <p>New alignment algorithms and JavaScript visualization libraries enable the development of a third generation of dot plot applications. This generation is able to process large genomes in reasonable time and provides user-friendly graphical interfaces. D-GENIES can easily be extended with new aligners and new alignment file formats. Even if it has been developed to process large genomes, it is also suited for small or medium size genomes.</p>
  </sec>
</body>
<back>
  <ack>
    <p>We thank Céline Noirot, Léo Lamy and the Bioinfo Genotoul platform system engineers and users for there feedback and help during installation and tests as well as Damien Leroux for his precious advice concerning JavaScript and Flask.</p>
  </ack>
  <sec sec-type="additional-information">
    <title>Additional Information and Declarations</title>
    <fn-group content-type="competing-interests">
      <title>Competing Interests</title>
      <fn fn-type="COI-statement" id="conflict-1">
        <p>The authors declare that they have no competing interests.</p>
      </fn>
    </fn-group>
    <fn-group content-type="author-contributions">
      <title>Author Contributions</title>
      <fn fn-type="con" id="contribution-1">
        <p><xref ref-type="contrib" rid="author-1">Floréal Cabanettes</xref> conceived and designed the experiments, performed the experiments, analyzed the data, contributed reagents/materials/analysis tools, authored or reviewed drafts of the paper, approved the final draft.</p>
      </fn>
      <fn fn-type="con" id="contribution-2">
        <p><xref ref-type="contrib" rid="author-2">Christophe Klopp</xref> conceived and designed the experiments, analyzed the data, contributed reagents/materials/analysis tools, prepared figures and/or tables, authored or reviewed drafts of the paper, approved the final draft.</p>
      </fn>
    </fn-group>
    <fn-group content-type="other">
      <title>Data Availability</title>
      <fn id="addinfo-1">
        <p>The following information was supplied regarding data availability:</p>
        <p>GitHub: <uri xlink:href="https://github.com/genotoul-bioinfo/dgenies">https://github.com/genotoul-bioinfo/dgenies</uri>.</p>
      </fn>
    </fn-group>
  </sec>
  <ref-list content-type="authoryear">
    <title>References</title>
    <ref id="ref-1">
      <label>Brodie, Roper &amp; Upton (2004)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Brodie</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Roper</surname>
            <given-names>RL</given-names>
          </name>
          <name>
            <surname>Upton</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>Jdotter: a Java interface to multiple dotplots generated by dotter</article-title>
        <source>Bioinformatics</source>
        <year>2004</year>
        <volume>20</volume>
        <issue>2</issue>
        <fpage>279</fpage>
        <lpage>281</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btg406</pub-id>
        <pub-id pub-id-type="pmid">14734323</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-2">
      <label>Bostock, Ogievetsky &amp; Heer (2011)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bostock</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Ogievetsky</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Heer</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>D<sup>3</sup> Data-Driven Documents</article-title>
        <source>IEEE Transactions on Visualization and Computer Graphics</source>
        <year>2011</year>
        <volume>17</volume>
        <issue>12</issue>
        <fpage>2301</fpage>
        <lpage>2309</lpage>
        <pub-id pub-id-type="doi">10.1109/TVCG.2011.185</pub-id>
        <pub-id pub-id-type="pmid">22034350</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-3">
      <label>Husemann &amp; Stoye (2009)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Husemann</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Stoye</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>r2cat: synteny plots and comparative assembly</article-title>
        <source>Bioinformatics</source>
        <year>2009</year>
        <volume>26</volume>
        <issue>4</issue>
        <fpage>570</fpage>
        <lpage>571</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btp690</pub-id>
        <pub-id pub-id-type="pmid">20015948</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-4">
      <label>Krumsiek, Arnold &amp; Rattei (2007)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Krumsiek</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Arnold</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Rattei</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>Gepard: a rapid and sensitive tool for creating dotplots on genome scale</article-title>
        <source>Bioinformatics</source>
        <year>2007</year>
        <volume>23</volume>
        <issue>8</issue>
        <fpage>1026</fpage>
        <lpage>1028</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btm039</pub-id>
        <pub-id pub-id-type="pmid">17309896</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-8">
      <label>Kumar et al. (2017)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kumar</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Stecher</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Suleski</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Hedges</surname>
            <given-names>SB</given-names>
          </name>
        </person-group>
        <article-title>TimeTree: a resource for timelines, timetrees, and divergence times</article-title>
        <source>Molecular Biology and Evolution</source>
        <year>2017</year>
        <volume>34</volume>
        <issue>7</issue>
        <fpage>1812</fpage>
        <lpage>1819</lpage>
        <pub-id pub-id-type="doi">10.1093/molbev/msx116</pub-id>
        <pub-id pub-id-type="pmid">28387841</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-5">
      <label>Li (2017)</label>
      <element-citation publication-type="other">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <year>2017</year>
        <source>Minimap2: fast pairwise alignment for long dna sequences</source>
        <pub-id pub-id-type="arxiv">1708.01492</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-6">
      <label>Sonnhammer &amp; Durbin (1995)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sonnhammer</surname>
            <given-names>ELL</given-names>
          </name>
          <name>
            <surname>Durbin</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>A dot-matrix program with dynamic threshold control suited for genomic dna and protein sequence analysis</article-title>
        <source>Gene</source>
        <year>1995</year>
        <volume>167</volume>
        <issue>1–2</issue>
        <fpage>GC1</fpage>
        <lpage>GC10</lpage>
        <pub-id pub-id-type="doi">10.1016/0378-1119(95)00714-8</pub-id>
        <pub-id pub-id-type="pmid">8566757</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-7">
      <label>Szafranski, Jahn &amp; Platzer (2006)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Szafranski</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Jahn</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Platzer</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>tuple_plot: fast pairwise nucleotide sequence comparison with noise suppression</article-title>
        <source>Bioinformatics</source>
        <year>2006</year>
        <volume>22</volume>
        <fpage>1917</fpage>
        <lpage>1918</lpage>
        <pub-id pub-id-type="pmid">16766553</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
