<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10471895</article-id>
    <article-id pub-id-type="pmid">37632789</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btad513</article-id>
    <article-id pub-id-type="publisher-id">btad513</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Applications Note</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Genome Analysis</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01060</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>dRFEtools: dynamic recursive feature elimination for omics</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0003-2016-4646</contrib-id>
        <name>
          <surname>Benjamin</surname>
          <given-names>Kynon J M</given-names>
        </name>
        <aff><institution>Lieber Institute for Brain Development</institution>, Baltimore, MD 21205, <country country="US">United States</country></aff>
        <aff><institution>Department of Neurology, Johns Hopkins University School of Medicine</institution>, Baltimore, MD 21205, <country country="US">United States</country></aff>
        <xref rid="btad513-cor1" ref-type="corresp"/>
        <!--kynonjade.benjamin@libd.org-->
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Katipalli</surname>
          <given-names>Tarun</given-names>
        </name>
        <aff><institution>Lieber Institute for Brain Development</institution>, Baltimore, MD 21205, <country country="US">United States</country></aff>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Paquola</surname>
          <given-names>Apuã C M</given-names>
        </name>
        <aff><institution>Lieber Institute for Brain Development</institution>, Baltimore, MD 21205, <country country="US">United States</country></aff>
        <aff><institution>Department of Neurology, Johns Hopkins University School of Medicine</institution>, Baltimore, MD 21205, <country country="US">United States</country></aff>
        <xref rid="btad513-cor1" ref-type="corresp"/>
        <!--apua.paquola@libd.org-->
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Robinson</surname>
          <given-names>Peter</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="btad513-cor1">Corresponding authors. Lieber Institute for Brain Development, 855 N Wolfe St, #300, Baltimore, MD 21205, United States. E-mails: <email>kynonjade.benjamin@libd.org</email> (K.J.M.B.) and <email>apua.paquola@libd.org</email> (A.C.M.P.)</corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <month>8</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2023-08-26">
      <day>26</day>
      <month>8</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>26</day>
      <month>8</month>
      <year>2023</year>
    </pub-date>
    <volume>39</volume>
    <issue>8</issue>
    <elocation-id>btad513</elocation-id>
    <history>
      <date date-type="received">
        <day>17</day>
        <month>11</month>
        <year>2022</year>
      </date>
      <date date-type="rev-recd">
        <day>09</day>
        <month>7</month>
        <year>2023</year>
      </date>
      <date date-type="editorial-decision">
        <day>16</day>
        <month>8</month>
        <year>2023</year>
      </date>
      <date date-type="corrected-typeset">
        <day>31</day>
        <month>8</month>
        <year>2023</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2023. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2023</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btad513.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Motivation</title>
        <p>Advances in technology have generated larger omics datasets with potential applications for machine learning. In many datasets, however, cost and limited sample availability result in an excessively higher number of features as compared to observations. Moreover, biological processes are associated with networks of core and peripheral genes, while traditional feature selection approaches capture only core genes.</p>
      </sec>
      <sec id="s2">
        <title>Results</title>
        <p>To overcome these limitations, we present dRFEtools that implements dynamic recursive feature elimination (RFE), reducing computational time with high accuracy compared to standard RFE, expanding dynamic RFE to regression algorithms, and outputting the subsets of features that hold predictive power with and without peripheral features. dRFEtools integrates with scikit-learn (the popular Python machine learning platform) and thus provides new opportunities for dynamic RFE in large-scale omics data while enhancing its interpretability.</p>
      </sec>
      <sec id="s3">
        <title>Availability and implementation</title>
        <p>dRFEtools is freely available on PyPI at <ext-link xlink:href="https://pypi.org/project/drfetools/" ext-link-type="uri">https://pypi.org/project/drfetools/</ext-link> or on GitHub <ext-link xlink:href="https://github.com/LieberInstitute/dRFEtools" ext-link-type="uri">https://github.com/LieberInstitute/dRFEtools</ext-link>, implemented in Python 3, and supported on Linux, Windows, and Mac OS.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>National Institute on Minority Health</institution>
          </institution-wrap>
        </funding-source>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Health Disparities of the National Institutes of Health</institution>
          </institution-wrap>
        </funding-source>
        <award-id>K99MD016964</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="3"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>The creation of increasingly larger epigenetics, genetics, and transcriptomic datasets from high-throughput sequencing has generated more comprehensive insights into human biology [e.g. identification of biomarkers and novel therapeutics for various diseases (<xref rid="btad513-B5707130" ref-type="bibr">Matthews et al., 2016</xref>, <xref rid="btad513-B5" ref-type="bibr">Perakakis <italic toggle="yes">et al.</italic> 2018</xref>)]. However, costs and limited sample availability result in an excessively higher number of features compared to observations. This can result in overfitting, which feature selection approaches can solve. Moreover, biological processes are associated with networks (<xref rid="btad513-B05860538" ref-type="bibr">Boyle et al., 2017</xref>) including core (direct, large effects) and peripheral (many small, indirect effects) genes (<xref rid="btad513-F1" ref-type="fig">Fig. 1A</xref>). As such, it is often biologically relevant to select a subset of features that include core and peripheral genes. However, traditional feature selection approaches are optimized to select only core features, limiting biological interpretability.</p>
    <fig position="float" id="btad513-F1">
      <label>Figure 1.</label>
      <caption>
        <p>Schematic of dynamic recursive feature elimination for dRFEtools. (A) Graphical representation of core and peripheral features (<xref rid="btad513-B05860538" ref-type="bibr">Boyle et al., 2017</xref>). (B) Flowchart showing recursive elimination process, where scikit-learn model can be either classification or regression. We ranked the dropped features and saved them for downstream analysis. (C) Feature iterator code used to generate dynamic elimination. (D) Flowchart showing the elimination steps using the developmental or out-of-bag (OOB) set. (E) Example of LOWESS fitting on dRFEtools model performance multiple classification using simulated data using area under the receiver operating characteristic curve (ROC AUC).</p>
      </caption>
      <graphic xlink:href="btad513f1" position="float"/>
    </fig>
    <p>Recursive feature elimination (RFE) is an iterative process that optimally removes one feature at a time. For computational considerations, we can eliminate a substantial number of features (feature subset ranking); however, it can be difficult to balance computational time (small number of features dropped) and model performance degradation (substantial number of features dropped). To overcome this issue, RFE can be done dynamically, which provides a more flexible feature elimination operation by removing a substantial number of features at the beginning and becoming a single feature elimination when there are a small number of features. Here, we present dRFEtools—a Python package that integrates with scikit-learn and implements dynamic RFE (<xref rid="btad513-B4" ref-type="bibr">Nguyen and Ohn 2006</xref>). In addition to reducing computational time with high prediction accuracy, dRFEtools expands dynamic RFE to regression problems and outputs subsets of features that hold predictive power with and without peripheral genes.</p>
  </sec>
  <sec>
    <title>2 Implementation</title>
    <p>The purpose of dRFEtools is to implement dynamic RFE for classification and regression using the available supervised learning models on scikit-learn with <monospace>coef_</monospace> or <monospace>feature_importances_</monospace> attribute (e.g. decision trees and linear models). dRFEtools provides fast and accurate feature selection as compared to standard RFE, which is either fast (large step size) or accurate (small step size) for big omics datasets (i.e. features <inline-formula id="IE1"><mml:math id="IM1" display="inline" overflow="scroll"><mml:mo>&gt;</mml:mo></mml:math></inline-formula> 20 000). The development of dynamic RFE (<xref rid="btad513-F1" ref-type="fig">Fig. 1B</xref>) for scikit-learn models can be separated into two main parts: (i) feature iterator (<xref rid="btad513-F1" ref-type="fig">Fig. 1C</xref>) and (ii) model evaluation for <italic toggle="yes">N</italic> features (<xref rid="btad513-F1" ref-type="fig">Fig. 1D</xref>). We use the feature iterator to control the dynamic selection of features to eliminate as opposed to removing a static step size, as is done in traditional RFE. For interpretability, we rank all features.</p>
    <p>For each iteration, we evaluate feature importance (i.e. absolute weights or unsigned Gini) using a random validation set to reduce the chance of overfitting. To evaluate model performance during dynamic RFE, we assess classification accuracy (i.e. accuracy, AUC ROC, and normalized mutual information) or regression correlation (i.e. <inline-formula id="IE2"><mml:math id="IM2" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula>, mean square error, and explained variance). We recommend using <italic toggle="yes">n</italic>-fold cross-validation with this method to further reduce the overall chance of overfitting.</p>
    <p>From the locally weighted scatterplot smoothing (LOWESS) curve, we extract the local maximum as the core feature set (<xref rid="btad513-F1" ref-type="fig">Fig. 1E</xref>). To extract core and peripheral features, we examine the rate of change of the LOWESS curve and select the point at which the slope changes steeply because we, at this point, assume additional features offer no contribution and reduce prediction accuracy. We provide two functions to extract the core (<monospace>extract_max_lowess</monospace>) and core+peripheral (<monospace>extract_peripheral_lowess</monospace>) features to be used with main dynamic RFE functions (<monospace>rf_rfe</monospace> or <monospace>dev_rfe</monospace>). The main functions return a dictionary with all dynamic RFE results that we use to extract predictive features for downstream test set evaluation. An example of optimization and classification codes are available at <ext-link xlink:href="https://pypi.org/project/drfetools/" ext-link-type="uri">https://pypi.org/project/drfetools/</ext-link>.</p>
  </sec>
  <sec>
    <title>3 Application and validation</title>
    <p>To assess the ability of dRFEtools to accurately identify informative features in classification and regression problems, we performed two different simulation analyses (scikit learn- and omics-based) to compare dRFEtools with the current RFE scikit-learn function. We used eight popular algorithms: four for classification (logistic regression, random forest classifier, stochastic gradient descent, and support vector classification) and four for regression (ridge, elastic net, random forest regressor, and support vector regression). We applied these algorithms on the test set to measure: (i) feature selection accuracy, (ii) feature selection false discovery rate (FDR), and (iii) computational time. For our biological simulation, we simulated bulk RNA-sequencing and quantitative trait loci (QTL). We found that computational time and FDR of informative features were significantly reduced (dRFEtools versus RFE) in both classification and regression models (one-way ANOVA, <italic toggle="yes">P</italic>-value <inline-formula id="IE3"><mml:math id="IM3" display="inline" overflow="scroll"><mml:mo>&lt;</mml:mo></mml:math></inline-formula> 0.01; <xref rid="sup1" ref-type="supplementary-material">Supplementary Figs S1–S4</xref>).</p>
    <p>To illustrate dRFEtools application to biological data, we considered a subset of data from the BrainSeq Consortium Phase 1 DLPFC adult (age <inline-formula id="IE4"><mml:math id="IM4" display="inline" overflow="scroll"><mml:mo>&gt;</mml:mo></mml:math></inline-formula> 17) postmortem brain collection (<italic toggle="yes">n</italic> = 521) (<xref rid="btad513-B2" ref-type="bibr">Jaffe <italic toggle="yes">et al.</italic> 2018</xref>). With this dataset, we considered three scenarios: (i) binary classification for schizophrenia (<italic toggle="yes">n</italic> = 172) and major depression disorder (MDD; <italic toggle="yes">n</italic> = 142) using gene expression from poly-adenylated RNA-sequencing as features, (ii) multi-class classification of neuropsychiatric disorders (neurotypical control, <italic toggle="yes">n</italic> = 207) using gene expression as features, and (iii) regression modeling to impute gene expression using SNP genotypes as features. We found dRFEtools provided biological relevant core and peripheral features applicable for pathway enrichment analysis and expression QTL (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figs S5–S8</xref>).</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="sup1" position="float" content-type="local-data">
      <label>btad513_Supplementary_Data</label>
      <media xlink:href="btad513_supplementary_data.zip">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack id="ack1">
    <title>Acknowledgements</title>
    <p>The authors like to extend our deepest appreciation to our colleagues in the Erwin-Paquola laboratory group for their comments and suggestions.</p>
  </ack>
  <sec>
    <title>Supplementary data</title>
    <p><xref rid="sup1" ref-type="supplementary-material">Supplementary data</xref> are available at <italic toggle="yes">Bioinformatics</italic> online.</p>
  </sec>
  <sec sec-type="COI-statement">
    <title>Conflict of interest</title>
    <p>The authors declare no conflicts of interest.</p>
  </sec>
  <sec>
    <title>Funding</title>
    <p>This work was supported by the Lieber Institute for Brain Development and the National Institute on Minority Health and Health Disparities of the National Institutes of Health [K99MD016964 to K.J.M.B.].</p>
  </sec>
  <sec sec-type="data-availability">
    <title>Data availability</title>
    <p>The hg38-aligned gene expression datasets analyzed in the current study are available upon request. The original hg19-aligned R variables are available at <ext-link xlink:href="http://eqtl.brainseq.org/phase1/" ext-link-type="uri">http://eqtl.brainseq.org/phase1/</ext-link>. The FASTQ files for all BrainSeq Phase 1 subjects (<italic toggle="yes">n</italic> = 738) are available on Synapse (<xref rid="btad513-B1" ref-type="bibr">Collado-Torres <italic toggle="yes">et al.</italic> 2019</xref>). Genotypes are available from Globus with restricted access (<xref rid="btad513-B1" ref-type="bibr">Collado-Torres <italic toggle="yes">et al.</italic> 2019</xref>). More information on the BrainSeq publicly available data can be found at <ext-link xlink:href="http://eqtl.brainseq.org/" ext-link-type="uri">http://eqtl.brainseq.org/</ext-link>. dRFEtools is available on Python Package Index (PyPI) at <ext-link xlink:href="https://pypi.org/project/drfetools/" ext-link-type="uri">https://pypi.org/project/drfetools/</ext-link> and on GitHub at <ext-link xlink:href="https://github.com/LieberInstitute/dRFEtools" ext-link-type="uri">https://github.com/LieberInstitute/dRFEtools</ext-link>. The code and Jupyter notebooks that produced the results for this manuscript are available through GitHub at <ext-link xlink:href="https://github.com/LieberInstitute/dRFEtools_manuscript" ext-link-type="uri">https://github.com/LieberInstitute/dRFEtools_manuscript</ext-link>.</p>
  </sec>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="btad513-B05860538">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Boyle</surname><given-names>EA</given-names>, </string-name>, <string-name><surname>Li</surname><given-names>YI</given-names>, </string-name>, <string-name><surname>Pritchard</surname><given-names>JK.</given-names></string-name></person-group><article-title>An expanded view of complex traits: From polygenic to omnigenic</article-title>. <source><italic toggle="yes">Cell</italic></source><year>2017</year>;<volume>169</volume>:<fpage>1177</fpage>–<lpage>86</lpage>.<pub-id pub-id-type="pmid">28622505</pub-id></mixed-citation>
    </ref>
    <ref id="btad513-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Collado-Torres</surname><given-names>L</given-names></string-name>, <string-name><surname>Burke</surname><given-names>EE</given-names></string-name>, <string-name><surname>Peterson</surname><given-names>A</given-names></string-name></person-group><etal>et al</etal>; <collab>BrainSeq Consortium</collab>. <article-title>Regional heterogeneity in gene expression, regulation, and coherence in the frontal cortex and hippocampus across development and schizophrenia</article-title>. <source>Neuron</source><year>2019</year>;<volume>103</volume>:<fpage>203</fpage>–<lpage>16.e8</lpage>.<pub-id pub-id-type="pmid">31174959</pub-id></mixed-citation>
    </ref>
    <ref id="btad513-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Jaffe</surname><given-names>AE</given-names></string-name>, <string-name><surname>Straub</surname><given-names>RE</given-names></string-name>, <string-name><surname>Shin</surname><given-names>JH</given-names></string-name></person-group><etal>et al</etal>; <collab>BrainSeq Consortium</collab>. <article-title>Developmental and genetic regulation of the human cortex transcriptome illuminate schizophrenia pathogenesis</article-title>. <source>Nat. Neurosci</source>. <year>2018</year>;<volume>21</volume>:<fpage>1117</fpage>–<lpage>25</lpage>.<pub-id pub-id-type="pmid">30050107</pub-id></mixed-citation>
    </ref>
    <ref id="btad513-B5707130">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Matthews</surname><given-names>H</given-names>, </string-name>, <string-name><surname>Hanison</surname><given-names>J</given-names>, </string-name>, <string-name><surname>Nirmalan</surname><given-names>N.</given-names></string-name></person-group><article-title>Omics"-informed drug and biomarker discovery: Opportunities, challenges and future perspectives</article-title>. <source>Proteomes</source><year>2016</year>;<volume>4</volume>.</mixed-citation>
    </ref>
    <ref id="btad513-B4">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Nguyen</surname><given-names>H-N</given-names></string-name>, <string-name><surname>Ohn</surname><given-names>S-Y.</given-names></string-name></person-group> dRFE: dynamic recursive feature elimination for gene identification based on random forest. In: <italic toggle="yes">International conference on neural information processing</italic>. <year>2006</year>; 4234.</mixed-citation>
    </ref>
    <ref id="btad513-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Perakakis</surname><given-names>N</given-names></string-name>, <string-name><surname>Yazdani</surname><given-names>A</given-names></string-name>, <string-name><surname>Karniadakis</surname><given-names>GE</given-names></string-name></person-group><etal>et al</etal><article-title>Omics, big data and machine learning as tools to propel understanding of biological mechanisms and to discover novel diagnostics and therapeutics</article-title>. <source>Metabolism</source><year>2018</year>;<volume>87</volume>:<fpage>A1</fpage>–<lpage>9</lpage>.<pub-id pub-id-type="pmid">30098323</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10471895</article-id>
    <article-id pub-id-type="pmid">37632789</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btad513</article-id>
    <article-id pub-id-type="publisher-id">btad513</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Applications Note</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Genome Analysis</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01060</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>dRFEtools: dynamic recursive feature elimination for omics</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0003-2016-4646</contrib-id>
        <name>
          <surname>Benjamin</surname>
          <given-names>Kynon J M</given-names>
        </name>
        <aff><institution>Lieber Institute for Brain Development</institution>, Baltimore, MD 21205, <country country="US">United States</country></aff>
        <aff><institution>Department of Neurology, Johns Hopkins University School of Medicine</institution>, Baltimore, MD 21205, <country country="US">United States</country></aff>
        <xref rid="btad513-cor1" ref-type="corresp"/>
        <!--kynonjade.benjamin@libd.org-->
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Katipalli</surname>
          <given-names>Tarun</given-names>
        </name>
        <aff><institution>Lieber Institute for Brain Development</institution>, Baltimore, MD 21205, <country country="US">United States</country></aff>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Paquola</surname>
          <given-names>Apuã C M</given-names>
        </name>
        <aff><institution>Lieber Institute for Brain Development</institution>, Baltimore, MD 21205, <country country="US">United States</country></aff>
        <aff><institution>Department of Neurology, Johns Hopkins University School of Medicine</institution>, Baltimore, MD 21205, <country country="US">United States</country></aff>
        <xref rid="btad513-cor1" ref-type="corresp"/>
        <!--apua.paquola@libd.org-->
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Robinson</surname>
          <given-names>Peter</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="btad513-cor1">Corresponding authors. Lieber Institute for Brain Development, 855 N Wolfe St, #300, Baltimore, MD 21205, United States. E-mails: <email>kynonjade.benjamin@libd.org</email> (K.J.M.B.) and <email>apua.paquola@libd.org</email> (A.C.M.P.)</corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <month>8</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2023-08-26">
      <day>26</day>
      <month>8</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>26</day>
      <month>8</month>
      <year>2023</year>
    </pub-date>
    <volume>39</volume>
    <issue>8</issue>
    <elocation-id>btad513</elocation-id>
    <history>
      <date date-type="received">
        <day>17</day>
        <month>11</month>
        <year>2022</year>
      </date>
      <date date-type="rev-recd">
        <day>09</day>
        <month>7</month>
        <year>2023</year>
      </date>
      <date date-type="editorial-decision">
        <day>16</day>
        <month>8</month>
        <year>2023</year>
      </date>
      <date date-type="corrected-typeset">
        <day>31</day>
        <month>8</month>
        <year>2023</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2023. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2023</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btad513.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Motivation</title>
        <p>Advances in technology have generated larger omics datasets with potential applications for machine learning. In many datasets, however, cost and limited sample availability result in an excessively higher number of features as compared to observations. Moreover, biological processes are associated with networks of core and peripheral genes, while traditional feature selection approaches capture only core genes.</p>
      </sec>
      <sec id="s2">
        <title>Results</title>
        <p>To overcome these limitations, we present dRFEtools that implements dynamic recursive feature elimination (RFE), reducing computational time with high accuracy compared to standard RFE, expanding dynamic RFE to regression algorithms, and outputting the subsets of features that hold predictive power with and without peripheral features. dRFEtools integrates with scikit-learn (the popular Python machine learning platform) and thus provides new opportunities for dynamic RFE in large-scale omics data while enhancing its interpretability.</p>
      </sec>
      <sec id="s3">
        <title>Availability and implementation</title>
        <p>dRFEtools is freely available on PyPI at <ext-link xlink:href="https://pypi.org/project/drfetools/" ext-link-type="uri">https://pypi.org/project/drfetools/</ext-link> or on GitHub <ext-link xlink:href="https://github.com/LieberInstitute/dRFEtools" ext-link-type="uri">https://github.com/LieberInstitute/dRFEtools</ext-link>, implemented in Python 3, and supported on Linux, Windows, and Mac OS.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>National Institute on Minority Health</institution>
          </institution-wrap>
        </funding-source>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Health Disparities of the National Institutes of Health</institution>
          </institution-wrap>
        </funding-source>
        <award-id>K99MD016964</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="3"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>The creation of increasingly larger epigenetics, genetics, and transcriptomic datasets from high-throughput sequencing has generated more comprehensive insights into human biology [e.g. identification of biomarkers and novel therapeutics for various diseases (<xref rid="btad513-B5707130" ref-type="bibr">Matthews et al., 2016</xref>, <xref rid="btad513-B5" ref-type="bibr">Perakakis <italic toggle="yes">et al.</italic> 2018</xref>)]. However, costs and limited sample availability result in an excessively higher number of features compared to observations. This can result in overfitting, which feature selection approaches can solve. Moreover, biological processes are associated with networks (<xref rid="btad513-B05860538" ref-type="bibr">Boyle et al., 2017</xref>) including core (direct, large effects) and peripheral (many small, indirect effects) genes (<xref rid="btad513-F1" ref-type="fig">Fig. 1A</xref>). As such, it is often biologically relevant to select a subset of features that include core and peripheral genes. However, traditional feature selection approaches are optimized to select only core features, limiting biological interpretability.</p>
    <fig position="float" id="btad513-F1">
      <label>Figure 1.</label>
      <caption>
        <p>Schematic of dynamic recursive feature elimination for dRFEtools. (A) Graphical representation of core and peripheral features (<xref rid="btad513-B05860538" ref-type="bibr">Boyle et al., 2017</xref>). (B) Flowchart showing recursive elimination process, where scikit-learn model can be either classification or regression. We ranked the dropped features and saved them for downstream analysis. (C) Feature iterator code used to generate dynamic elimination. (D) Flowchart showing the elimination steps using the developmental or out-of-bag (OOB) set. (E) Example of LOWESS fitting on dRFEtools model performance multiple classification using simulated data using area under the receiver operating characteristic curve (ROC AUC).</p>
      </caption>
      <graphic xlink:href="btad513f1" position="float"/>
    </fig>
    <p>Recursive feature elimination (RFE) is an iterative process that optimally removes one feature at a time. For computational considerations, we can eliminate a substantial number of features (feature subset ranking); however, it can be difficult to balance computational time (small number of features dropped) and model performance degradation (substantial number of features dropped). To overcome this issue, RFE can be done dynamically, which provides a more flexible feature elimination operation by removing a substantial number of features at the beginning and becoming a single feature elimination when there are a small number of features. Here, we present dRFEtools—a Python package that integrates with scikit-learn and implements dynamic RFE (<xref rid="btad513-B4" ref-type="bibr">Nguyen and Ohn 2006</xref>). In addition to reducing computational time with high prediction accuracy, dRFEtools expands dynamic RFE to regression problems and outputs subsets of features that hold predictive power with and without peripheral genes.</p>
  </sec>
  <sec>
    <title>2 Implementation</title>
    <p>The purpose of dRFEtools is to implement dynamic RFE for classification and regression using the available supervised learning models on scikit-learn with <monospace>coef_</monospace> or <monospace>feature_importances_</monospace> attribute (e.g. decision trees and linear models). dRFEtools provides fast and accurate feature selection as compared to standard RFE, which is either fast (large step size) or accurate (small step size) for big omics datasets (i.e. features <inline-formula id="IE1"><mml:math id="IM1" display="inline" overflow="scroll"><mml:mo>&gt;</mml:mo></mml:math></inline-formula> 20 000). The development of dynamic RFE (<xref rid="btad513-F1" ref-type="fig">Fig. 1B</xref>) for scikit-learn models can be separated into two main parts: (i) feature iterator (<xref rid="btad513-F1" ref-type="fig">Fig. 1C</xref>) and (ii) model evaluation for <italic toggle="yes">N</italic> features (<xref rid="btad513-F1" ref-type="fig">Fig. 1D</xref>). We use the feature iterator to control the dynamic selection of features to eliminate as opposed to removing a static step size, as is done in traditional RFE. For interpretability, we rank all features.</p>
    <p>For each iteration, we evaluate feature importance (i.e. absolute weights or unsigned Gini) using a random validation set to reduce the chance of overfitting. To evaluate model performance during dynamic RFE, we assess classification accuracy (i.e. accuracy, AUC ROC, and normalized mutual information) or regression correlation (i.e. <inline-formula id="IE2"><mml:math id="IM2" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula>, mean square error, and explained variance). We recommend using <italic toggle="yes">n</italic>-fold cross-validation with this method to further reduce the overall chance of overfitting.</p>
    <p>From the locally weighted scatterplot smoothing (LOWESS) curve, we extract the local maximum as the core feature set (<xref rid="btad513-F1" ref-type="fig">Fig. 1E</xref>). To extract core and peripheral features, we examine the rate of change of the LOWESS curve and select the point at which the slope changes steeply because we, at this point, assume additional features offer no contribution and reduce prediction accuracy. We provide two functions to extract the core (<monospace>extract_max_lowess</monospace>) and core+peripheral (<monospace>extract_peripheral_lowess</monospace>) features to be used with main dynamic RFE functions (<monospace>rf_rfe</monospace> or <monospace>dev_rfe</monospace>). The main functions return a dictionary with all dynamic RFE results that we use to extract predictive features for downstream test set evaluation. An example of optimization and classification codes are available at <ext-link xlink:href="https://pypi.org/project/drfetools/" ext-link-type="uri">https://pypi.org/project/drfetools/</ext-link>.</p>
  </sec>
  <sec>
    <title>3 Application and validation</title>
    <p>To assess the ability of dRFEtools to accurately identify informative features in classification and regression problems, we performed two different simulation analyses (scikit learn- and omics-based) to compare dRFEtools with the current RFE scikit-learn function. We used eight popular algorithms: four for classification (logistic regression, random forest classifier, stochastic gradient descent, and support vector classification) and four for regression (ridge, elastic net, random forest regressor, and support vector regression). We applied these algorithms on the test set to measure: (i) feature selection accuracy, (ii) feature selection false discovery rate (FDR), and (iii) computational time. For our biological simulation, we simulated bulk RNA-sequencing and quantitative trait loci (QTL). We found that computational time and FDR of informative features were significantly reduced (dRFEtools versus RFE) in both classification and regression models (one-way ANOVA, <italic toggle="yes">P</italic>-value <inline-formula id="IE3"><mml:math id="IM3" display="inline" overflow="scroll"><mml:mo>&lt;</mml:mo></mml:math></inline-formula> 0.01; <xref rid="sup1" ref-type="supplementary-material">Supplementary Figs S1–S4</xref>).</p>
    <p>To illustrate dRFEtools application to biological data, we considered a subset of data from the BrainSeq Consortium Phase 1 DLPFC adult (age <inline-formula id="IE4"><mml:math id="IM4" display="inline" overflow="scroll"><mml:mo>&gt;</mml:mo></mml:math></inline-formula> 17) postmortem brain collection (<italic toggle="yes">n</italic> = 521) (<xref rid="btad513-B2" ref-type="bibr">Jaffe <italic toggle="yes">et al.</italic> 2018</xref>). With this dataset, we considered three scenarios: (i) binary classification for schizophrenia (<italic toggle="yes">n</italic> = 172) and major depression disorder (MDD; <italic toggle="yes">n</italic> = 142) using gene expression from poly-adenylated RNA-sequencing as features, (ii) multi-class classification of neuropsychiatric disorders (neurotypical control, <italic toggle="yes">n</italic> = 207) using gene expression as features, and (iii) regression modeling to impute gene expression using SNP genotypes as features. We found dRFEtools provided biological relevant core and peripheral features applicable for pathway enrichment analysis and expression QTL (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figs S5–S8</xref>).</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="sup1" position="float" content-type="local-data">
      <label>btad513_Supplementary_Data</label>
      <media xlink:href="btad513_supplementary_data.zip">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack id="ack1">
    <title>Acknowledgements</title>
    <p>The authors like to extend our deepest appreciation to our colleagues in the Erwin-Paquola laboratory group for their comments and suggestions.</p>
  </ack>
  <sec>
    <title>Supplementary data</title>
    <p><xref rid="sup1" ref-type="supplementary-material">Supplementary data</xref> are available at <italic toggle="yes">Bioinformatics</italic> online.</p>
  </sec>
  <sec sec-type="COI-statement">
    <title>Conflict of interest</title>
    <p>The authors declare no conflicts of interest.</p>
  </sec>
  <sec>
    <title>Funding</title>
    <p>This work was supported by the Lieber Institute for Brain Development and the National Institute on Minority Health and Health Disparities of the National Institutes of Health [K99MD016964 to K.J.M.B.].</p>
  </sec>
  <sec sec-type="data-availability">
    <title>Data availability</title>
    <p>The hg38-aligned gene expression datasets analyzed in the current study are available upon request. The original hg19-aligned R variables are available at <ext-link xlink:href="http://eqtl.brainseq.org/phase1/" ext-link-type="uri">http://eqtl.brainseq.org/phase1/</ext-link>. The FASTQ files for all BrainSeq Phase 1 subjects (<italic toggle="yes">n</italic> = 738) are available on Synapse (<xref rid="btad513-B1" ref-type="bibr">Collado-Torres <italic toggle="yes">et al.</italic> 2019</xref>). Genotypes are available from Globus with restricted access (<xref rid="btad513-B1" ref-type="bibr">Collado-Torres <italic toggle="yes">et al.</italic> 2019</xref>). More information on the BrainSeq publicly available data can be found at <ext-link xlink:href="http://eqtl.brainseq.org/" ext-link-type="uri">http://eqtl.brainseq.org/</ext-link>. dRFEtools is available on Python Package Index (PyPI) at <ext-link xlink:href="https://pypi.org/project/drfetools/" ext-link-type="uri">https://pypi.org/project/drfetools/</ext-link> and on GitHub at <ext-link xlink:href="https://github.com/LieberInstitute/dRFEtools" ext-link-type="uri">https://github.com/LieberInstitute/dRFEtools</ext-link>. The code and Jupyter notebooks that produced the results for this manuscript are available through GitHub at <ext-link xlink:href="https://github.com/LieberInstitute/dRFEtools_manuscript" ext-link-type="uri">https://github.com/LieberInstitute/dRFEtools_manuscript</ext-link>.</p>
  </sec>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="btad513-B05860538">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Boyle</surname><given-names>EA</given-names>, </string-name>, <string-name><surname>Li</surname><given-names>YI</given-names>, </string-name>, <string-name><surname>Pritchard</surname><given-names>JK.</given-names></string-name></person-group><article-title>An expanded view of complex traits: From polygenic to omnigenic</article-title>. <source><italic toggle="yes">Cell</italic></source><year>2017</year>;<volume>169</volume>:<fpage>1177</fpage>–<lpage>86</lpage>.<pub-id pub-id-type="pmid">28622505</pub-id></mixed-citation>
    </ref>
    <ref id="btad513-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Collado-Torres</surname><given-names>L</given-names></string-name>, <string-name><surname>Burke</surname><given-names>EE</given-names></string-name>, <string-name><surname>Peterson</surname><given-names>A</given-names></string-name></person-group><etal>et al</etal>; <collab>BrainSeq Consortium</collab>. <article-title>Regional heterogeneity in gene expression, regulation, and coherence in the frontal cortex and hippocampus across development and schizophrenia</article-title>. <source>Neuron</source><year>2019</year>;<volume>103</volume>:<fpage>203</fpage>–<lpage>16.e8</lpage>.<pub-id pub-id-type="pmid">31174959</pub-id></mixed-citation>
    </ref>
    <ref id="btad513-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Jaffe</surname><given-names>AE</given-names></string-name>, <string-name><surname>Straub</surname><given-names>RE</given-names></string-name>, <string-name><surname>Shin</surname><given-names>JH</given-names></string-name></person-group><etal>et al</etal>; <collab>BrainSeq Consortium</collab>. <article-title>Developmental and genetic regulation of the human cortex transcriptome illuminate schizophrenia pathogenesis</article-title>. <source>Nat. Neurosci</source>. <year>2018</year>;<volume>21</volume>:<fpage>1117</fpage>–<lpage>25</lpage>.<pub-id pub-id-type="pmid">30050107</pub-id></mixed-citation>
    </ref>
    <ref id="btad513-B5707130">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Matthews</surname><given-names>H</given-names>, </string-name>, <string-name><surname>Hanison</surname><given-names>J</given-names>, </string-name>, <string-name><surname>Nirmalan</surname><given-names>N.</given-names></string-name></person-group><article-title>Omics"-informed drug and biomarker discovery: Opportunities, challenges and future perspectives</article-title>. <source>Proteomes</source><year>2016</year>;<volume>4</volume>.</mixed-citation>
    </ref>
    <ref id="btad513-B4">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Nguyen</surname><given-names>H-N</given-names></string-name>, <string-name><surname>Ohn</surname><given-names>S-Y.</given-names></string-name></person-group> dRFE: dynamic recursive feature elimination for gene identification based on random forest. In: <italic toggle="yes">International conference on neural information processing</italic>. <year>2006</year>; 4234.</mixed-citation>
    </ref>
    <ref id="btad513-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Perakakis</surname><given-names>N</given-names></string-name>, <string-name><surname>Yazdani</surname><given-names>A</given-names></string-name>, <string-name><surname>Karniadakis</surname><given-names>GE</given-names></string-name></person-group><etal>et al</etal><article-title>Omics, big data and machine learning as tools to propel understanding of biological mechanisms and to discover novel diagnostics and therapeutics</article-title>. <source>Metabolism</source><year>2018</year>;<volume>87</volume>:<fpage>A1</fpage>–<lpage>9</lpage>.<pub-id pub-id-type="pmid">30098323</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
