<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD Journal Publishing DTD v2.3 20070202//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName journalpublishing.dtd?>
<?SourceDTD.Version 2.3?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 2?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-id journal-id-type="hwp">bioinfo</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">3018814</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btq649</article-id>
    <article-id pub-id-type="publisher-id">btq649</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Original Papers</subject>
        <subj-group>
          <subject>Sequence Analysis</subject>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>MTR: taxonomic annotation of short metagenomic reads using clustering at multiple taxonomic ranks</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Gori</surname>
          <given-names>Fabio</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">
          <sup>1</sup>
        </xref>
        <xref ref-type="corresp" rid="COR1">*</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Folino</surname>
          <given-names>Gianluigi</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Jetten</surname>
          <given-names>Mike S. M.</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">
          <sup>3</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Marchiori</surname>
          <given-names>Elena</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">
          <sup>1</sup>
        </xref>
        <xref ref-type="corresp" rid="COR1">*</xref>
      </contrib>
    </contrib-group>
    <aff id="AFF1"><sup>1</sup>Radboud University Nijmegen, Institute for Computing and Information Sciences, Nijmegen, The Netherlands, <sup>2</sup>ICAR-CNR, Institute of High Performance Computing and Networking, Rende, Italy and <sup>3</sup>Radboud University Nijmegen, IWWR, Department of Microbiology, Nijmegen, The Netherlands</aff>
    <author-notes>
      <corresp id="COR1">* To whom correspondence should be addressed.</corresp>
      <fn>
        <p>Associate Editor: Dmitrij Frishman</p>
      </fn>
    </author-notes>
    <pub-date pub-type="ppub">
      <day>15</day>
      <month>1</month>
      <year>2011</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>1</day>
      <month>12</month>
      <year>2010</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>1</day>
      <month>12</month>
      <year>2010</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the
							<pub-date pub-type="epub"/>. -->
    <volume>27</volume>
    <issue>2</issue>
    <fpage>196</fpage>
    <lpage>203</lpage>
    <history>
      <date date-type="received">
        <day>1</day>
        <month>8</month>
        <year>2010</year>
      </date>
      <date date-type="rev-recd">
        <day>10</day>
        <month>11</month>
        <year>2010</year>
      </date>
      <date date-type="accepted">
        <day>16</day>
        <month>11</month>
        <year>2010</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2010. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2010</copyright-year>
      <license license-type="creative-commons" xlink:href="http://creativecommons.org/licenses/by-nc/2.0/uk/">
        <license-p><!--CREATIVE COMMONS-->This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by-nc/2.5">http://creativecommons.org/licenses/by-nc/2.5</ext-link>), which permits unrestricted non-commercial use, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <abstract>
      <p><bold>Motivation:</bold> Metagenomics is a recent field of biology that studies microbial communities by analyzing their genomic content directly sequenced from the environment. A metagenomic dataset consists of many short DNA or RNA fragments called reads. One interesting problem in metagenomic data analysis is the discovery of the taxonomic composition of a given dataset. A simple method for this task, called the Lowest Common Ancestor (LCA), is employed in state-of-the-art computational tools for metagenomic data analysis of very short reads (about 100 bp). However LCA has two main drawbacks: it possibly assigns many reads to high taxonomic ranks and it discards a high number of reads.</p>
      <p><bold>Results:</bold> We present MTR, a new method for tackling these drawbacks using clustering at Multiple Taxonomic Ranks. Unlike LCA, which processes the reads one-by-one, MTR exploits information shared by reads. Specifically, MTR consists of two main phases. First, for each taxonomic rank, a collection of potential clusters of reads is generated, and each potential cluster is associated to a taxon at that rank. Next, a small number of clusters is selected at each rank using a combinatorial optimization algorithm. The effectiveness of the resulting method is tested on a large number of simulated and real-life metagenomes. Results of experiments show that MTR improves on LCA by discarding a significantly smaller number of reads and by assigning much more reads at lower taxonomic ranks. Moreover, MTR provides a more faithful taxonomic characterization of the metagenome population distribution.</p>
      <p><bold>Availability:</bold> Matlab and C++ source codes of the method available at <ext-link ext-link-type="uri" xlink:href="http://cs.ru.nl/˜gori/software/MTR.tar.gz">http://cs.ru.nl/˜gori/software/MTR.tar.gz</ext-link>.</p>
      <p><bold>Contact:</bold><email>gori@cs.ru.nl</email>; <email>elenam@cs.ru.nl</email></p>
      <p><bold>Supplementary information:</bold><ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/cgi/content/full/btq649/DC1">Supplementary data</ext-link> are available at <italic>Bioinformatics</italic> online.</p>
    </abstract>
  </article-meta>
</front>
<body>
  <sec sec-type="intro" id="SEC1">
    <title>1 INTRODUCTION</title>
    <p>New-sequencing technologies and the dramatic reduction in the cost of sequencing have boosted the development of metagenomics, a new discipline that studies DNA and RNA sequences sampled from genomic material present in a microbial community (<xref ref-type="bibr" rid="B33">Yooseph <italic>et al.</italic>, 2007</xref>). Metagenomics has gained popularity because it allows researchers to study (the large amount of) microbes that cannot be cultured (<xref ref-type="bibr" rid="B2">Amann <italic>et al.</italic>, 1995</xref>) and their role in the environment, for instance in term of interaction with other organisms. Sequencing a sample produces a collection of DNA or RNA fragments, called <italic>reads</italic>, belonging to the different genomes present in the sample. A <italic>metagenomic dataset</italic> is a collection of these sampled reads.</p>
    <p>Until recently shotgun Sanger sequencing was the main technology used in metagenomics (<xref ref-type="bibr" rid="B28">Sanger and Coulson, 1975</xref>; <xref ref-type="bibr" rid="B29">Sanger <italic>et al.</italic>, 1977</xref>), producing reads of length ranging between 800 and 1000 bp). Nowadays, other less expensive technologies like Roche 454 (<xref ref-type="bibr" rid="B21">Margulies <italic>et al.</italic>, 2005</xref>) and Illumina platforms<xref ref-type="fn" rid="FN1"><sup>1</sup></xref> generate reads of 100–400 bp and 75–100 bp, respectively. Such new-sequencing technologies produce very large datasets containing short reads. Computational analysis techniques are indispensable to extract knowledge from these datasets (<xref ref-type="bibr" rid="B18">Kunin <italic>et al.</italic>, 2008</xref>; <xref ref-type="bibr" rid="B22">McHardy and Rigoutsos, 2007</xref>; <xref ref-type="bibr" rid="B25">Qin <italic>et al.</italic>, 2010</xref>; <xref ref-type="bibr" rid="B26">Raes <italic>et al.</italic>, 2007</xref>).</p>
    <p>In this article, we focus on the <italic>taxonomic assignment</italic> of very short reads (about 100 bp) to putative taxa. Taxonomic assignment is a way to assess species diversity and to understand what the different populations are doing. It is also used for improving reads assembly (<xref ref-type="bibr" rid="B11">Delcher <italic>et al.</italic>, 2007</xref>).</p>
    <p>Computational approaches for taxonomic assignment can be divided into two main groups: <italic>composition based</italic> and <italic>similarity based</italic>. Composition-based annotation methods cluster the reads according to their GC content, codon usage and other oligonucleotide frequencies. These methods cannot be directly applied to short reads because of the local variation of nucleotides distribution across a genome (<xref ref-type="bibr" rid="B4">Bentley and Parkhill, 2004</xref>). Moreover, external environmental factors seem to influence the GC nucleotide composition of a community, suggesting that it may be even harder to distinguish the reads of different organisms relying on GC content (<xref ref-type="bibr" rid="B13">Foerstner <italic>et al.</italic>, 2005</xref>). Similarity-based taxonomic annotation methods assign reads to organisms or taxa using similarities of reads to reference sequences of a given database. Similarity is usually measured by means of sequence alignment tools, like BLAST (<xref ref-type="bibr" rid="B1">Altschul <italic>et al.</italic>, 1997</xref>). This approach is useful when most reads in the sample have significant similarities to reference sequences from known operational taxonomic units (<xref ref-type="bibr" rid="B32">Wooley <italic>et al.</italic>, 2010</xref>). The incompleteness of the information contained in reference databases and the bias toward cultivable species constitute inherent limitations of the similarity-based approach. Nevertheless, similarity-based techniques have been shown to be effective for the taxonomic analysis of metagenomes (<xref ref-type="bibr" rid="B10">Dalevi <italic>et al.</italic>, 2008</xref>; <xref ref-type="bibr" rid="B15">Huson <italic>et al.</italic>, 2007</xref>). Furthermore, results of ongoing projects on sequencing reference genomes will likely produce many more reference data available in the near future (<xref ref-type="bibr" rid="B30">Turnbaugh <italic>et al.</italic>, 2007</xref>).</p>
    <p>A simple similarity-based algorithm for taxonomic assignment is the Lowest Common Ancestor (LCA; <xref ref-type="bibr" rid="B20">Liu <italic>et al.</italic>, 2008</xref>; <xref ref-type="bibr" rid="B31">Wang <italic>et al.</italic>, 2007</xref>). LCA is the core algorithm of MEGAN (<xref ref-type="bibr" rid="B15">Huson <italic>et al.</italic>, 2007</xref>) and of the Galaxy (<xref ref-type="bibr" rid="B5">Blankenberg <italic>et al.</italic>, 2007</xref>, <xref ref-type="bibr" rid="B6">2010</xref>) web-based annotation tool<xref ref-type="fn" rid="FN2"><sup>2</sup></xref>; also CARMA (<xref ref-type="bibr" rid="B17">Krause <italic>et al.</italic>, 2008</xref>) is based on an algorithm somewhat similar to LCA. CARMA identifies protein family fragments among the reads and it assigns each fragment to the ancestor taxon shared by the phylogenetic subtree of reference proteins where the fragment is located. LCA assigns to each read one taxon computed by means of the least common taxonomic ancestor of a suitable set of sequences (hits). These hits are obtained by matching the read against a database of reference sequences, like the NCBI-NR protein database. In this way, LCA assigns reads to taxa at possibly different taxonomic ranks.</p>
    <p>Two limitations of LCA rise from the way in which taxonomic information from matching reference sequences is combined. (i) LCA annotates a relatively small percentage of reads because a read is discarded if the least common taxon of its hits cannot be computed; (ii) LCA assigns many reads to taxa at high ranks, because it computes the lowest common ancestor of (possibly many) matching sequences (<xref ref-type="bibr" rid="B18">Kunin <italic>et al.</italic>, 2008</xref>). The first limitation is addressed by methods that assign all reads. The simplest and most used of such methods assigns each read to its best matching reference sequence, called best hit (BH); as recently shown for instance in <xref ref-type="bibr" rid="B7">Brady and Salzberg (2009</xref>), this is still the best stand-alone assignment method for long reads (of length &gt;800 bp). A more involved method assigning all reads is Phymm (<xref ref-type="bibr" rid="B7">Brady and Salzberg, 2009</xref>). In Phymm, a classifier is trained based on interpolated Markov models on a large amount of curated genomes. This classifier constructs probability distributions representing observed patterns of nucleotides that characterize each chromosome or plasmid. On metagenomic datasets with long reads (800 bp and 1000 bp), Phymm was shown to outperform BH at ranks Class and Phylum. The authors also showed that a suitable combination of BH and Phymm (called PhymmBL) significantly improved accuracy of both BH and Phymm. However, its accuracy for short reads (100 bp) remains rather low, ranging from 58.5% at rank Genus to 77.5% at rank Phylum. The second drawback of LCA, that is, the fact that it assigns many reads to taxa at high ranks, has been recently tackled in <xref ref-type="bibr" rid="B9">Clemente <italic>et al.</italic> (2010</xref>), where a method was proposed for assigning each read to a taxon at a rank lower (or equal) than the one selected by LCA. The choice of such taxon is based on the number of mismatches between the read and the organisms in that taxon.</p>
    <p>To overcome both drawbacks of LCA , we introduce an algorithm for the taxonomic assignment of reads. Our approach is motivated by the following observations. LCA uses taxonomic information of matching reference sequences locally, that is, the taxonomic assignment of each read is performed independently of the other ones. However, reads of a metagenome are related among each other. In particular, groups of reads have common matching reference sequences. We propose to use this global type of information to design a new taxonomic assignment algorithm, called multiple taxonomic ranks (MTR-based clustering). MTR performs the following two steps at each taxonomic rank. First, taxonomic information shared by reads at that rank is used for characterizing clusters of reads having the same taxon. Next, a ‘best’ subset of the resulting clusters is selected. Such selection task is casted into a combinatorial optimization problem and solved using an existing efficient approximation algorithm. This global optimization method for grouping reads into clusters having a common taxa produces multiple taxonomic assignments, one for each rank. However, the taxons assigned to a read at different ranks may be inconsistent with each others. We solve such inconsistencies by assigning each read to a taxon at lowest rank such that the multiple taxonomic assignments of that read from the highest to the selected rank form a consistent taxonomic lineage.</p>
    <p>We demonstrate the effectiveness of this approach on several metagenomic datasets, both simulated and real life. On all the considered datasets, MTR discards a significantly smaller number of reads than LCA and it assigns much more reads at lower taxonomic ranks. Furthermore, on simulated metagenomes M1, M2 and M3, MTR is shown to provide a more faithful taxonomic characterization of the population distribution than LCA. With respect to the correctness of the assignments, both LCA and MTR's accuracy appears to reflect the difference in taxonomic composition of the simulated datasets, with M1 composed of representatives of the less well-sampled phyla than M2 and M3 (<xref ref-type="bibr" rid="B10">Dalevi <italic>et al.</italic>, 2008</xref>). Nevertheless, results indicate that MTR is capable to assign a read to a taxon close to the true one, when the true taxon does not occur among (the taxa of) its hits. In general, our experimental investigation indicates that MTR provides an effective method for performing taxonomic analysis of a metagenomic dataset with short reads.</p>
  </sec>
  <sec sec-type="methods" id="SEC2">
    <title>2 METHODS</title>
    <p>We propose a method for taxonomic assignment of short reads motivated and inspired by LCA (<xref ref-type="bibr" rid="B15">Huson <italic>et al.</italic>, 2007</xref>). In LCA, a read is compared against a database of reference sequences, such as the NCBI-NR protein database, and the taxonomic information of significant matches, called <italic>hits</italic>, is extracted and mapped onto the leaves of the NCBI taxonomy. The leaves of the NCBI taxonomy represent different species and strains. LCA computes the lowest common ancestor of all these hits, which corresponds to some higher rank taxon, and will then assign the read to that taxon. In this way, species-specific sequences are assigned to the leaves, whereas sequences that are conserved among different species, or that are susceptible to horizontal gene transfer, are assigned to taxa of less-specific rank.</p>
    <p>Observe that LCA processes each read independently: hence, it does not use taxonomic information <italic>shared</italic> by alignments of different reads. However, reads are related among each others since sets of reads are part of the same organism. Therefore, we propose to use information shared among reads for developing the following global taxonomic assignment method, called MTR.</p>
    <sec id="SEC2.1">
      <title>2.1 Read assignment at MTR</title>
      <p>Like in LCA, all reads are submitted as BLASTx queries against a protein sequence database and proteins of high-quality alignments are selected. This process generates one set of protein hits for each read. The taxonomic information of these proteins is used by MTR for clustering reads at each taxonomic rank, such that reads in the same group are assigned to the same taxon at that rank.</p>
      <p>Specifically, let <italic>R</italic> be the set of reads having at least one high-quality alignment, and let <italic>r</italic> denote a read. For each taxonomic rank, from the highest to the lowest, each read <italic>r</italic> is either assigned to a taxon at that rank or is considered not assigned at that and lower taxonomic ranks. The latter case happens if the taxonomic assignment of <italic>r</italic> at that rank is not consistent with its assignments computed at higher ranks. In that case, <italic>r</italic> is removed from <italic>R</italic>. This <italic>consistency test</italic> is performed at each rank (see step 3 below).</p>
      <p>Taxonomic assignment at a given taxonomic rank is performed using a clustering approach. Here, we view clustering as the problem of searching for a minimum family of possibly overlapping clusters of reads that together cover the considered set of reads. To this aim, we define an <italic>ad hoc</italic> search space and search strategy. The search space consists of clusters of reads directly characterized using the taxa of proteins of those high-quality alignments, which are obtained by submitting the reads as BLASTx queries. The search strategy is based on combinatorial optimization. The <italic>search space construction</italic> procedure, <italic>search strategy</italic> and <italic>consistency test</italic> are described in detail below.
<list list-type="order"><list-item><p><italic>Search space construction</italic>: generate clusters of reads using the taxa of their hits. MTR generates a collection of clusters of reads, where each cluster is associated to a taxon at the considered rank. A cluster <italic>C</italic><sub><italic>j</italic></sub> consists of those reads in <italic>R</italic> having a high-quality alignment with at least one protein having taxon <italic>j</italic>.</p></list-item><list-item><p><italic>Search strategy</italic>: select an optimal family of clusters. The algorithm selects a minimum family of clusters that together contain all the considered reads. This selection task is casted into a combinatorial optimization problem, the set covering problem (SCP):
<disp-formula id="M1"><label>(SCP)</label><graphic xlink:href="btq649m1"/></disp-formula>
Here <italic>n</italic> is the total number of clusters generated at step 1. This approach is inspired by previous works for clustering reads using proxygenes (<xref ref-type="bibr" rid="B10">Dalevi <italic>et al.</italic>, 2008</xref>; <xref ref-type="bibr" rid="B14">Folino <italic>et al.</italic>, 2009</xref>). The program used by MTR for solving (heuristically) the SCP is an implementation of the greedy set covering algorithm (<xref ref-type="bibr" rid="B8">Chvatal, 1979</xref>). This is a very simple greedy algorithm that, at each stage, chooses the set that contains the largest number of uncovered elements (Algorithm 1). The greedy algorithm can be efficiently implemented in time that is linear in the size of the input (<xref ref-type="bibr" rid="B3">Bar-Yehuda and Even, 1981</xref>).</p><p><inline-graphic xlink:href="btq649i1.jpg"/></p><p>The selection process is illustrated by means of the following toy example. Suppose we have 10 reads, <italic>R</italic> = {<italic>r</italic><sub>1</sub>,…, <italic>r</italic><sub>10</sub>}. For each read, the taxa of its hits at a given rank are shown in <xref ref-type="table" rid="T1">Table 1</xref>, left matrix. A bullet in entry (<italic>i</italic>, <italic>j</italic>) indicates that read <italic>r</italic><sub><italic>i</italic></sub> belongs to cluster <italic>C</italic><sub><italic>j</italic></sub>; this means that if <italic>C</italic><sub><italic>j</italic></sub> is selected, <italic>r</italic><sub><italic>i</italic></sub> will be assigned to taxon <italic>j</italic>. The problem is to select a minimum number of clusters (columns of that matrix) that together ‘cover’ all the 10 reads. A solution is shown in the figure on the right-hand side of <xref ref-type="table" rid="T1">Table 1</xref>, where the selected clusters are <italic>C</italic><sub>1</sub>, <italic>C</italic><sub>2</sub> and <italic>C</italic><sub>5</sub>. Therefore, the reads are assigned to taxa 1, 2 and 5.</p></list-item><list-item><p><italic>Consistency test</italic>: for each read in <italic>R</italic>, MTR now checks that its taxonomic assignment at this rank is consistent with its taxonomic assignments computed at higher ranks. That is, if read <italic>r</italic> has been assigned to taxon <italic>j</italic> at the considered rank, we check that at higher ranks <italic>r</italic> was assigned to ancestors of taxon <italic>j</italic>. If this does not happen, then <italic>r</italic> is not assigned from that rank onwards and is removed from <italic>R</italic>.</p></list-item></list>
<table-wrap id="T1" position="float"><label>Table 1.</label><caption><p>Input covering matrix (left) and a solution of the SCP (Right)</p></caption><table frame="hsides" rules="groups"><tbody align="left"><tr><td rowspan="1" colspan="1"><inline-graphic xlink:href="btq649i2.jpg"/></td></tr></tbody></table></table-wrap></p>
      <p>Observe that at a given rank, MTR can assign a read to more than one cluster. This is illustrated in our toy example where for instance read <italic>r</italic><sub>2</sub> is assigned to clusters <italic>C</italic><sub>2</sub> and <italic>C</italic><sub>5</sub>. However, we want to assign a unique taxon to each read. Therefore, MTR assigns each read <italic>r</italic> to the largest cluster among those containing <italic>r</italic> (ties are broken randomly), while keeping the taxonomical consistency of the assignments of <italic>r</italic> at different ranks. For instance, read <italic>r</italic><sub>2</sub> will be assigned to <italic>C</italic><sub>5</sub>. The final assignment computed by MTR associates of each read <italic>r</italic> in <italic>R</italic> to the taxon (cluster) containing <italic>r</italic> and having the lowest rank.</p>
      <p>Both LCA and MTR process a set of hits computed using BLAST and output a read-taxon assignment, where reads are possibly assigned to taxa at different taxonomic ranks. MTR and LCA are also similar in that they output the same taxon for each read that is assigned by both methods at the same taxonomic rank. In fact, if a read <italic>r</italic> is assigned by both methods at the same rank it means that that rank contains the lowest common ancestor taxon of the hits of <italic>r</italic>. At that rank, <italic>r</italic> is covered by only one taxon, therefore MTR will be forced to assign <italic>r</italic> to that taxon.</p>
      <p>The running time of both MTR and LCA is dominated by the alignment of reads with the reference protein sequences database using BLASTx. This is a computational bottleneck common to similarity-based methods for metagenomic analysis based on the alignment of reads with sequences of a large database of reference.</p>
    </sec>
  </sec>
  <sec id="SEC3">
    <title>3 EXPERIMENTS</title>
    <sec id="SEC3.1">
      <title>3.1 Data</title>
      <p>We analyzed nine simulated and three real-life metagenomic datasets. The nine simulated datasets had been derived from three sets of organisms, here denoted by M1, M2 and M3; these datasets had been introduced in <xref ref-type="bibr" rid="B10">Dalevi <italic>et al.</italic> (2008</xref>). M1, M2 and M3 are composed by 9, 5 and 8 distinct genomes, respectively. These genomes had been sequenced at the Joint Genome Institute (JGI) using the 454 GS20 pyrosequencing platform that produces ∼100 bp reads. From each set of organisms, reads had been randomly sampled at three different levels of coverage (0.1×, 1× and 4×) resulting in a total of nine datasets. The coverage is the mean number of times a nucleotide is being sequenced (<xref ref-type="bibr" rid="B32">Wooley <italic>et al.</italic>, 2010</xref>). <xref ref-type="table" rid="T1">Table 1</xref> of Supplementary Material shows the names of the organisms and the number of reads generated for the datasets for coverage 0.1×. A detailed description of the simulated datasets can be found in <xref ref-type="bibr" rid="B10">Dalevi <italic>et al.</italic> (2008</xref>).</p>
      <p>We retrieved from the metagenomics RAST server (<xref ref-type="bibr" rid="B23">Meyer <italic>et al.</italic>, 2008</xref>) three real-life datasets (4440426.3, 4440319.3 and 4440283.3) containing short reads (average length of about 100 bp) and sampled using pyrosequencing on Roche 454 CS20. These datasets had been derived from a Saltern sample (<xref ref-type="bibr" rid="B12">Edwards <italic>et al.</italic>, 2006</xref>), a Coral Holobiont sample (<xref ref-type="bibr" rid="B27">Rodriguez-Brito <italic>et al.</italic>, 2007</xref>) and a Chicken Cecum sample, respectively. The Saltern metagenome dataset contains 34 296 fragments with an average fragment length of 100.69 bp; the Coral Holobiont metagenome dataset contains 316 279 fragments with an average fragment length of 102.07 bp; the Chicken Cecum metagenome dataset contains 294 682 fragments with an average length of 104.4 bp.</p>
    </sec>
    <sec id="SEC3.2">
      <title>3.2 Aligning reads with protein sequences</title>
      <p>All the reads were submitted as NCBI-BLASTx queries against the NCBI-NR<xref ref-type="fn" rid="FN3"><sup>3</sup></xref> (non-redundant) protein sequence database (downloaded on March 3, 2009). The default BLASTx parameters were used, adding a neighborhood word score threshold of 14 and an <italic>E</italic>-value cutoff of 10<sup>−6</sup>. We set the word score threshold to 14, higher than the default value 12, in order to increase the speed more than 2-fold while maintaining a high sensitiveness [see (<xref ref-type="bibr" rid="B16">Korf <italic>et al.</italic>, 2003</xref>), Paragraph 9.3.1.1]. Low-quality alignments were removed from the BLASTx outputs, by discarding alignments with bit-score less than 30. For each query read (at most), the top 50 hits were selected. Before performing the alignment of reads in a simulated metagenome, we removed from NCBI-NR all the sequences belonging to the species present in that metagenome. This masking process is commonly applied in order to assess the performance of taxonomic annotation algorithms on datasets containing species that have never been observed before, because a real-life metagenome is likely to contain undiscovered organisms (<xref ref-type="bibr" rid="B7">Brady and Salzberg, 2009</xref>).</p>
    </sec>
  </sec>
  <sec sec-type="results" id="SEC4">
    <title>4 RESULTS</title>
    <p>For all datasets, a small percentage of reads had at least one high-quality hit (Supplementary Table S3), an expected phenomenon related to the incompleteness of the information contained in the database of reference (<xref ref-type="bibr" rid="B15">Huson <italic>et al.</italic>, 2007</xref>). These reads were selected for taxonomic assignment.</p>
    <p>We assessed comparatively the performance of LCA and MTR with respect to the <italic>number of reads assigned</italic> and the <italic>taxa detected</italic>. Moreover, we compared MTR and LCA in term of their characterization of the taxonomic <italic>population distribution</italic> at ranks Order and Genus. For real-life datasets, the characterizations were performed also at ranks Phylum and Class. Finally, on simulated datasets, where the true taxonomic assignment is known by construction, we compared the quality of the assignments given by MTR and LCA using <italic>taxon accuracy</italic> (i.e. the percentage of taxa correctly detected), <italic>taxon sensitivity</italic> (i.e. the number of taxa correctly detected by the algorithm divided by the total number of true taxa) and <italic>accuracy</italic> (i.e. the percentage of reads correctly assigned).</p>
    <sec id="SEC4.1">
      <title>4.1 Results on simulated datasets</title>
      <p>Results on a total of 54 cases (three metagenomes, for each metagenome three datasets produced using different coverages, for each resulting dataset six ranks) are reported in <xref ref-type="table" rid="T2">Tables 2</xref>–<xref ref-type="table" rid="T4">4</xref>. They show the accuracy and number of reads assigned up to a given rank for datasets M1, M2 and M3, respectively.
<table-wrap id="T2" position="float"><label>Table 2.</label><caption><p>Accuracy and number of assigned reads on M1 datasets</p></caption><table frame="hsides" rules="groups"><thead align="left"><tr><th rowspan="1" colspan="1">M1</th><th rowspan="1" colspan="1">0.1×</th><th rowspan="1" colspan="1">1×</th><th rowspan="1" colspan="1">4×</th></tr></thead><tbody align="left"><tr><td rowspan="1" colspan="1">MTR</td><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/></tr><tr><td rowspan="1" colspan="1"> Kingdom</td><td rowspan="1" colspan="1">100.00 (5669)</td><td rowspan="1" colspan="1">99.93 (56 348)</td><td rowspan="1" colspan="1">99.93 (173 541)</td></tr><tr><td rowspan="1" colspan="1"> Phylum</td><td rowspan="1" colspan="1">92.50 (5669)</td><td rowspan="1" colspan="1">92.59 (56 325)</td><td rowspan="1" colspan="1">93.39 (173 521)</td></tr><tr><td rowspan="1" colspan="1"> Class</td><td rowspan="1" colspan="1">84.04 (5556)</td><td rowspan="1" colspan="1">85.44 (54 341)</td><td rowspan="1" colspan="1">87.15 (167 546)</td></tr><tr><td rowspan="1" colspan="1"> Order</td><td rowspan="1" colspan="1">64.93 (5366)</td><td rowspan="1" colspan="1">66.23 (53 395)</td><td rowspan="1" colspan="1">66.69 (163 840)</td></tr><tr><td rowspan="1" colspan="1"> Family</td><td rowspan="1" colspan="1">64.87 (4904)</td><td rowspan="1" colspan="1">63.67 (50 587)</td><td rowspan="1" colspan="1">63.22 (154 134)</td></tr><tr><td rowspan="1" colspan="1"> Genus</td><td rowspan="1" colspan="1">63.66 (4628)</td><td rowspan="1" colspan="1">62.58 (48 244)</td><td rowspan="1" colspan="1">60.50 (144 475)</td></tr><tr><td rowspan="1" colspan="1">LCA</td><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/></tr><tr><td rowspan="1" colspan="1"> Kingdom</td><td rowspan="1" colspan="1">100.00 (4145)</td><td rowspan="1" colspan="1">99.92 (42 620)</td><td rowspan="1" colspan="1">99.91 (132 130)</td></tr><tr><td rowspan="1" colspan="1"> Phylum</td><td rowspan="1" colspan="1">95.08 (4145)</td><td rowspan="1" colspan="1">94.81 (42 593)</td><td rowspan="1" colspan="1">95.02 (132 099)</td></tr><tr><td rowspan="1" colspan="1"> Class</td><td rowspan="1" colspan="1">94.46 (3739)</td><td rowspan="1" colspan="1">93.24 (38 970)</td><td rowspan="1" colspan="1">93.60 (121 980)</td></tr><tr><td rowspan="1" colspan="1"> Order</td><td rowspan="1" colspan="1">75.29 (3497)</td><td rowspan="1" colspan="1">74.18 (36 857)</td><td rowspan="1" colspan="1">72.43 (116 632)</td></tr><tr><td rowspan="1" colspan="1"> Family</td><td rowspan="1" colspan="1">71.94 (2961)</td><td rowspan="1" colspan="1">69.94 (31 913)</td><td rowspan="1" colspan="1">69.07 (102 239)</td></tr><tr><td rowspan="1" colspan="1"> Genus</td><td rowspan="1" colspan="1">71.03 (2686)</td><td rowspan="1" colspan="1">68.39 (29 360)</td><td rowspan="1" colspan="1">66.63 (94 346)</td></tr></tbody></table></table-wrap>
<table-wrap id="T3" position="float"><label>Table 3.</label><caption><p>Accuracy and number of assigned reads on M2 datasets</p></caption><table frame="hsides" rules="groups"><thead align="left"><tr><th rowspan="1" colspan="1">M2</th><th rowspan="1" colspan="1">0.1×</th><th rowspan="1" colspan="1">1×</th><th rowspan="1" colspan="1">4×</th></tr></thead><tbody align="left"><tr><td rowspan="1" colspan="1">MTR</td><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/></tr><tr><td rowspan="1" colspan="1"> Kingdom</td><td rowspan="1" colspan="1">95.27 (9030)</td><td rowspan="1" colspan="1">95.07 (88 537)</td><td rowspan="1" colspan="1">91.41 (174 583)</td></tr><tr><td rowspan="1" colspan="1"> Phylum</td><td rowspan="1" colspan="1">93.83 (9030)</td><td rowspan="1" colspan="1">93.21 (88 537)</td><td rowspan="1" colspan="1">88.75 (174 583)</td></tr><tr><td rowspan="1" colspan="1"> Class</td><td rowspan="1" colspan="1">89.98 (9012)</td><td rowspan="1" colspan="1">89.25 (87 635)</td><td rowspan="1" colspan="1">86.32 (168 854)</td></tr><tr><td rowspan="1" colspan="1"> Order</td><td rowspan="1" colspan="1">90.44 (8822)</td><td rowspan="1" colspan="1">89.24 (85 657)</td><td rowspan="1" colspan="1">86.14 (167 222)</td></tr><tr><td rowspan="1" colspan="1"> Family</td><td rowspan="1" colspan="1">80.56 (7264)</td><td rowspan="1" colspan="1">77.35 (81 366)</td><td rowspan="1" colspan="1">73.01 (159 591)</td></tr><tr><td rowspan="1" colspan="1"> Genus</td><td rowspan="1" colspan="1">64.41 (6480)</td><td rowspan="1" colspan="1">61.36 (77 307)</td><td rowspan="1" colspan="1">55.91 (147 139)</td></tr><tr><td rowspan="1" colspan="1">LCA</td><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/></tr><tr><td rowspan="1" colspan="1"> Kingdom</td><td rowspan="1" colspan="1">94.82 (7205)</td><td rowspan="1" colspan="1">94.66 (73 176)</td><td rowspan="1" colspan="1">90.76 (143 226)</td></tr><tr><td rowspan="1" colspan="1"> Phylum</td><td rowspan="1" colspan="1">93.21 (7205)</td><td rowspan="1" colspan="1">92.57 (73 169)</td><td rowspan="1" colspan="1">87.80 (143 206)</td></tr><tr><td rowspan="1" colspan="1"> Class</td><td rowspan="1" colspan="1">89.82 (5941)</td><td rowspan="1" colspan="1">88.98 (60 294)</td><td rowspan="1" colspan="1">83.59 (117 881)</td></tr><tr><td rowspan="1" colspan="1"> Order</td><td rowspan="1" colspan="1">89.90 (5615)</td><td rowspan="1" colspan="1">88.44 (57 373)</td><td rowspan="1" colspan="1">83.01 (113 168)</td></tr><tr><td rowspan="1" colspan="1"> Family</td><td rowspan="1" colspan="1">83.77 (4757)</td><td rowspan="1" colspan="1">81.84 (48 760)</td><td rowspan="1" colspan="1">77.61 (100 925)</td></tr><tr><td rowspan="1" colspan="1"> Genus</td><td rowspan="1" colspan="1">76.91 (3907)</td><td rowspan="1" colspan="1">74.60 (40 823)</td><td rowspan="1" colspan="1">69.68 (82 805)</td></tr></tbody></table></table-wrap>
<table-wrap id="T4" position="float"><label>Table 4.</label><caption><p>Accuracy and number of assigned reads on M3 datasets</p></caption><table frame="hsides" rules="groups"><thead align="left"><tr><th rowspan="1" colspan="1">M3</th><th rowspan="1" colspan="1">0.1×</th><th rowspan="1" colspan="1">1×</th><th rowspan="1" colspan="1">4×</th></tr></thead><tbody align="left"><tr><td rowspan="1" colspan="1">MTR</td><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/></tr><tr><td rowspan="1" colspan="1"> Kingdom</td><td rowspan="1" colspan="1">100.00 (11 792)</td><td rowspan="1" colspan="1">99.97 (116 869)</td><td rowspan="1" colspan="1">100.00 (166 948)</td></tr><tr><td rowspan="1" colspan="1"> Phylum</td><td rowspan="1" colspan="1">99.58 (11 792)</td><td rowspan="1" colspan="1">99.47 (116 869)</td><td rowspan="1" colspan="1">99.86 (166 948)</td></tr><tr><td rowspan="1" colspan="1"> Class</td><td rowspan="1" colspan="1">96.97 (11 763)</td><td rowspan="1" colspan="1">97.07 (116 134)</td><td rowspan="1" colspan="1">99.73 (166 936)</td></tr><tr><td rowspan="1" colspan="1"> Order</td><td rowspan="1" colspan="1">91.79 (11 606)</td><td rowspan="1" colspan="1">91.70 (115 034)</td><td rowspan="1" colspan="1">97.67 (166 148)</td></tr><tr><td rowspan="1" colspan="1"> Family</td><td rowspan="1" colspan="1">92.27 (11 117)</td><td rowspan="1" colspan="1">91.25 (111 560)</td><td rowspan="1" colspan="1">97.62 (165 231)</td></tr><tr><td rowspan="1" colspan="1"> Genus</td><td rowspan="1" colspan="1">94.06 (10 419)</td><td rowspan="1" colspan="1">92.19 (101 533)</td><td rowspan="1" colspan="1">97.42 (140 476)</td></tr><tr><td rowspan="1" colspan="1">LCA</td><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/></tr><tr><td rowspan="1" colspan="1"> Kingdom</td><td rowspan="1" colspan="1">100.00 (10 333)</td><td rowspan="1" colspan="1">99.96 (102 824)</td><td rowspan="1" colspan="1">99.99 (155 263)</td></tr><tr><td rowspan="1" colspan="1"> Phylum</td><td rowspan="1" colspan="1">99.72 (10 333)</td><td rowspan="1" colspan="1">99.69 (102 813)</td><td rowspan="1" colspan="1">99.93 (155 258)</td></tr><tr><td rowspan="1" colspan="1"> Class</td><td rowspan="1" colspan="1">98.86 (9162)</td><td rowspan="1" colspan="1">98.82 (91 445)</td><td rowspan="1" colspan="1">99.81 (141 829)</td></tr><tr><td rowspan="1" colspan="1"> Order</td><td rowspan="1" colspan="1">96.74 (7788)</td><td rowspan="1" colspan="1">96.62 (77 822)</td><td rowspan="1" colspan="1">98.14 (115 732)</td></tr><tr><td rowspan="1" colspan="1"> Family</td><td rowspan="1" colspan="1">96.87 (7545)</td><td rowspan="1" colspan="1">96.42 (75 616)</td><td rowspan="1" colspan="1">98.04 (110 488)</td></tr><tr><td rowspan="1" colspan="1"> Genus</td><td rowspan="1" colspan="1">97.61 (6748)</td><td rowspan="1" colspan="1">96.01 (68 573)</td><td rowspan="1" colspan="1">98.35 (110 139)</td></tr></tbody></table></table-wrap></p>
      <sec id="SEC4.1.1">
        <title>4.1.1 Number of reads assigned</title>
        <p>on the average, MTR assigned 22.66% more reads than LCA, varying from a minimum of 7.53% for M3 with coverage 4× to a maximum of 36.77% for M1 with coverage 1×. Moreover, on each simulated dataset, MTR assigned much more reads than LCA up to each given rank, especially at low taxonomic ranks. For instance, at rank Genus differences between MTR and LCA range from 27.54% for dataset M3 coverage 4× to 89.37% for dataset M2, coverage 1×.</p>
      </sec>
      <sec id="SEC4.1.2">
        <title>4.1.2 Taxa detected</title>
        <p>MTR detected slightly more taxa than LCA. For instance, on dataset M1, coverage 1×, the number of taxa detected by MTR and LCA ranged from 20 and 19 at rank Phylum to 127 and 117 at rank Species, respectively. The two algorithms showed similar taxa sensitivity and accuracy (Supplementary Tables S4–S6). The differences in taxa detection accuracy seems mainly due to the fact that MTR detected more taxa than LCA, therefore affecting taxa specificity. Nevertheless, the erroneous detected taxa are taxonomically close to true taxa, as described in the below analysis of the population distribution.</p>
      </sec>
      <sec id="SEC4.1.3">
        <title>4.1.3 Population distribution</title>
        <p>we analyzed the population distributions generated by the methods in two ways. First, we compared the percentages of reads assigned by the methods to true taxa. Next, we measured quantitatively the similarity between the population distributions generated by a method and the true ones.</p>
        <p>The percentages of reads assigned by the methods to taxa are shown in Supplementary Figures S1–S18. On the M1 metagenome, MTR gave a more faithful population characterization of the true detected taxa than LCA at rank Genus, in particular for coverages 0.1× (Supplementary Fig. S2). Specifically, the percentage of reads assigned by MTR to <italic>Clostridium</italic> (14.61%) was close to the true percentage (19.07%), while LCA assigned only 8.08% reads to that taxon. Moreover, LCA assigned more reads to <italic>Lactobacillus</italic> than <italic>Clostridium</italic>, in contrast with the trend in the real population distribution. Both methods did not detect four of the true taxa present in M1 (<italic>Herpetosiphon</italic>, <italic>Halothermothrix</italic>, <italic>Prochlorococcus</italic>, <italic>Caldicellulosiruptor</italic>) because these taxa did not occur in (the taxa of) the processed BLASTx hits. For instance, at coverage 0.1×, there were no hits from <italic>Halothermothrix</italic> and <italic>Herpetosiphon</italic>. Moreover, only 2 and 10 hits were from the geni <italic>Prochlorococcus</italic> and <italic>Caldicellulosiruptor</italic>, respectively. The absence of <italic>Halothermothrix</italic> was expected because this genus contains only the species present in M1, which were removed from the database of reference, as explained in <xref ref-type="sec" rid="SEC3.2">Subsection 3.2</xref>. Geni <italic>Herpetosiphon</italic> and <italic>Caldicellulosiruptor</italic> were not detected probably because they had few sequences in the reference protein dataset used by BLASTx: these geni contain only 4 and 12 species, respectively. Among the predicted geni with more than 5% of the reads, only <italic>Anaerocellum</italic> was not present in M1. Reads assigned to <italic>Anaerocellum</italic> were mostly reads of <italic>Caldicellulosiruptor</italic>; these two geni belong to the same taxon at rank Class (<italic>Clostridia</italic>). For coverage 0.1×, 92.99 and 97.66% of the reads assigned to <italic>Anaerocellum</italic> by LCA and MTR, respectively, were <italic>Caldicellulosiruptor</italic> reads.</p>
        <p>On the M2 metagenome, the population characterizations of true detected taxa generated by MTR were better than those of LCA for all the three datasets. In particular, LCA underestimated the presence of <italic>Burkholderiales</italic> at rank Order, and for coverage 0.1× and 1× it also overestimated the percentage of reads from <italic>Burkholderia</italic> at rank Genus. For coverage 0.1×, the true population distribution and the characterizations given by MTR and LCA at rank Order contained 78.13, 72.56 and 68.01% of reads of <italic>Burkholderiales</italic>, respectively (Supplementary Fig. S7). At rank Genus, the percentages of reads of <italic>Burkholderia</italic> were 40.57% in the true population, and 49.23 and 57.46% for MTR and LCA, respectively (<xref ref-type="fig" rid="F1">Fig. 1</xref>). These results were in line with those obtained for coverage 1×. For all the coverages, both methods assigned a small number of reads to the true geni <italic>Delftia</italic> and <italic>Comamonas</italic>, due to the very few BLASTx hits having these taxa (for instance, at coverage 0.1×, only 27 and 57 hits, respectively). Nevertheless, both methods detected the related taxa <italic>Acidovorax</italic> at rank Genus, that together with the geni <italic>Delftia</italic> and <italic>Comamonas</italic> belongs to the taxon <italic>Comamonadaceae</italic> at rank Family. Specifically, for coverage 0.1×, MTR and LCA assigned 15.57 and 3.46% of reads to <italic>Acidovorax</italic>, respectively, so the result of MTR was closer to the true percentage of the union of the two true geni present in M2 (37.55%). Furthermore, MTR assigned a much greater percentage of <italic>Delftia</italic>'s reads to <italic>Acidovorax</italic> than LCA for all the coverages: at rank Genus an average of 36.78% and 11.96%, respectively. MTR also assigned a higher percentage of <italic>Comamonas</italic> reads to <italic>Acidovorax</italic> for coverage 0.1× and 1× (53.24% for MTR and 27.37% for LCA, respectively).
<fig id="F1" position="float"><label>Fig. 1.</label><caption><p>Population distributions (rank Genus) of M2, coverage 0.1×, by MTR and LCA, and the true population distribution. Label ‘Others’ means taxa with less than 5% of the reads and not occurring in the true distribution.</p></caption><graphic xlink:href="btq649f1"/></fig></p>
        <p>The two algorithms gave population distributions of true detected taxa close to the true ones on the M3 metagenome, where MTR was slightly better than LCA. In particular, for coverage 0.1× and 1× at rank Order, LCA assigned more reads to <italic>Xanthomonadales</italic> than <italic>Pseudomonadales</italic>, in contrast with the trend in the real population distribution (Supplementary Fig. S13, S15 and S17). At rank Genus, the percentage of reads assigned to <italic>Bifidobacteria</italic> by MTR was closer to the real one. For instance, at coverage 0.1×, the true population distribution and the characterizations given by MTR and LCA contained 8.52, 8.86 and 11.75% of reads of <italic>Bifidobacteria</italic> (Supplementary Fig. S14).</p>
        <p>In order to quantitatively measure how close a population distribution produced by a method was to the true one, we used a divergence measure based on Shannon entropy, called L-divergence (<xref ref-type="bibr" rid="B19">Lin , 1991</xref>). Let <italic>p</italic><sub><italic>A</italic></sub> and <italic>p</italic><sub><italic>B</italic></sub> be two probability distributions on <italic>X</italic> and let <italic>K</italic> be defined as follows:
<disp-formula><graphic xlink:href="btq649um1"/></disp-formula>
The L-divergence of <italic>p</italic><sub><italic>A</italic></sub> and <italic>p</italic><sub><italic>B</italic></sub> is defined as
<disp-formula><graphic xlink:href="btq649um2"/></disp-formula>
The L-divergence assumes values between 0 and 2.</p>
        <p>In our setting, for a given method <italic>M</italic> and a selected taxonomic rank, a probability distribution <italic>p</italic><sub><italic>M</italic></sub> of <italic>X</italic> is considered, where <italic>X</italic> is the set of all taxa of that rank. For a given taxon <italic>x</italic> ∈ <italic>X</italic>, we estimated <italic>p</italic><sub><italic>M</italic></sub>(<italic>x</italic>) as the number of reads assigned by <italic>M</italic> to <italic>x</italic> divided by the total number of reads assigned by <italic>M</italic> to taxa at that rank. Furthermore, the probability distribution <italic>p</italic> of the true population is considered, where <italic>p</italic>(<italic>x</italic>) is estimated as the fraction of reads belonging to <italic>x</italic>. For instance, suppose that at a given rank <italic>X</italic> consists of taxa <italic>a</italic>, <italic>b</italic>, <italic>c</italic>, <italic>d</italic>, <italic>e</italic> and <italic>M</italic> assigned 30, 50 and 20% of the reads to taxon <italic>a</italic>, <italic>b</italic> and <italic>c</italic>, respectively. Suppose that the true population consists of 30, 40 and 30% of taxon <italic>a</italic>, <italic>d</italic> and <italic>e</italic>, respectively. Then <italic>p</italic><sub><italic>M</italic></sub> = (0.3, 0.5, 0.2, 0, 0) and <italic>p</italic> = (0.3, 0, 0, 0.4, 0.3).</p>
        <p>Results at ranks Family and Genus show that both MTR and LCA produced population distributions close to the true ones (<xref ref-type="table" rid="T5">Table 5</xref>). At rank Genus, MTR generated distributions closer to the true one on M1 datasets, while on the M2 datasets LCA's population distributions were closer to the true ones. On datasets M3, both algorithms generated distributions very close to the true ones. At rank Family, distributions generated by MTR were better than those of LCA on M1 and M2 datasets, while LCA's distributions were slightly closer to the true one on datasets M3. Since M1 is composed of representatives of less well-sampled phyla than M2 and M3 (<xref ref-type="bibr" rid="B10">Dalevi <italic>et al.</italic>, 2008</xref>), results indicate that MTR is more effective than LCA on metagenomes containing less well-sampled phyla.
<table-wrap id="T5" position="float"><label>Table 5.</label><caption><p>Divergence between true population distribution and the population distributions obtained by MTR and LCA at ranks Family and Genus</p></caption><table frame="hsides" rules="groups"><thead align="left"><tr><th rowspan="1" colspan="1">Dataset</th><th align="left" colspan="2" rowspan="1">Family<hr/></th><th align="left" colspan="2" rowspan="1">Genus<hr/></th></tr><tr><th rowspan="1" colspan="1"/><th rowspan="1" colspan="1">MTR</th><th rowspan="1" colspan="1">LCA</th><th rowspan="1" colspan="1">MTR</th><th rowspan="1" colspan="1">LCA</th></tr></thead><tbody align="left"><tr><td rowspan="1" colspan="1">M1 0.1×</td><td rowspan="1" colspan="1">0.539</td><td rowspan="1" colspan="1">0.608</td><td rowspan="1" colspan="1">0.544</td><td rowspan="1" colspan="1">0.601</td></tr><tr><td rowspan="1" colspan="1">M1 1×</td><td rowspan="1" colspan="1">0.565</td><td rowspan="1" colspan="1">0.604</td><td rowspan="1" colspan="1">0.570</td><td rowspan="1" colspan="1">0.607</td></tr><tr><td rowspan="1" colspan="1">M1 4×</td><td rowspan="1" colspan="1">0.628</td><td rowspan="1" colspan="1">0.642</td><td rowspan="1" colspan="1">0.643</td><td rowspan="1" colspan="1">0.654</td></tr><tr><td rowspan="1" colspan="1">M2 0.1×</td><td rowspan="1" colspan="1">0.172</td><td rowspan="1" colspan="1">0.232</td><td rowspan="1" colspan="1">0.696</td><td rowspan="1" colspan="1">0.611</td></tr><tr><td rowspan="1" colspan="1">M2 1×</td><td rowspan="1" colspan="1">0.191</td><td rowspan="1" colspan="1">0.256</td><td rowspan="1" colspan="1">0.690</td><td rowspan="1" colspan="1">0.623</td></tr><tr><td rowspan="1" colspan="1">M2 4×</td><td rowspan="1" colspan="1">0.261</td><td rowspan="1" colspan="1">0.334</td><td rowspan="1" colspan="1">0.825</td><td rowspan="1" colspan="1">0.747</td></tr><tr><td rowspan="1" colspan="1">M3 0.1×</td><td rowspan="1" colspan="1">0.099</td><td rowspan="1" colspan="1">0.091</td><td rowspan="1" colspan="1">0.103</td><td rowspan="1" colspan="1">0.095</td></tr><tr><td rowspan="1" colspan="1">M3 1×</td><td rowspan="1" colspan="1">0.102</td><td rowspan="1" colspan="1">0.091</td><td rowspan="1" colspan="1">0.115</td><td rowspan="1" colspan="1">0.104</td></tr><tr><td rowspan="1" colspan="1">M3 4×</td><td rowspan="1" colspan="1">0.024</td><td rowspan="1" colspan="1">0.020</td><td rowspan="1" colspan="1">0.026</td><td rowspan="1" colspan="1">0.017</td></tr></tbody></table></table-wrap></p>
      </sec>
      <sec id="SEC4.1.4">
        <title>4.1.4 Accuracy</title>
        <p>results are in accordance with the analysis conducted in <xref ref-type="bibr" rid="B10">Dalevi <italic>et al.</italic> (2008</xref>), and show that differences in accuracy for the three simulated metagenomes appear to reflect the difference in their taxonomic composition, with M1 composed of representatives of less well-sampled phyla than M2 and M3.</p>
        <p>Comparison of accuracy results between the two algorithms should be interpreted with care, since they are computed on sets of reads of different sizes: the sets used to compute accuracy of MTR are much bigger than those of LCA. LCA achieved in general higher accuracy results. In particular, on M1 LCA was more accurate than MTR for all the coverages. For coverages 0.1× and 4×, the difference in accuracy peaked at rank Order. For instance, LCA and MTR accuracies were 75.29 and 64.93% for coverage 0.1×, respectively. The accuracy of both algorithms dropped dramatically from rank Class to Order, with the biggest gaps for the two lowest coverages. For coverage 1×, for instance, the accuracy decreased from 85.44% to 66.23% for MTR and from 93.24% to 74.18% for LCA. On M2, LCA was more accurate at rank Family and Genus. MTR outperformed slightly LCA until rank Order; from rank Order to Family, the accuracy of both algorithms decreased and LCA became more accurate than MTR. The difference in accuracy peaked at rank Genus for coverage 4×, where LCA and MTR accuracies were 69.68 and 55.91%, respectively. LCA was slightly more accurate on M3. The biggest difference was reached at rank Family for coverage 1×, where LCA and MTR accuracies were 96.42 and 91.25%, respectively.</p>
      </sec>
    </sec>
    <sec id="SEC4.2">
      <title>4.2 Results on real-life datasets</title>
      <sec id="SEC4.2.1">
        <title>4.2.1 Number of reads assigned</title>
        <p>results on real-life datasets are shown in <xref ref-type="table" rid="T6">Table 6</xref>, and are in line with those obtained on the simulated datasets. Specifically, MTR assigned more reads than LCA (29.91, 15.20 and 19.52% for the dataset Saltern, Coral and Chicken, respectively), also up to each taxonomic rank. The difference peaked at rank Species for the datasets Saltern and Chicken (201.29 and 208.02% more, respectively). On the Coral dataset, the highest difference was 208.88% at rank Family, but also at rank Species the difference was neat (120.28%). On this dataset, MTR assigned at rank Order three times the number of reads assigned by LCA, whereas the difference dropped to 143.80% at rank Genus. Similarly, on dataset Saltern, the differences were 63.20 and 49.78% at rank Order and Family, respectively.
<table-wrap id="T6" position="float"><label>Table 6.</label><caption><p>Real-life datasets: number of reads assigned up to a rank</p></caption><table frame="hsides" rules="groups"><thead align="left"><tr><th rowspan="1" colspan="1"/><th rowspan="1" colspan="1">Saltern</th><th rowspan="1" colspan="1">Coral</th><th rowspan="1" colspan="1">Chicken</th></tr></thead><tbody align="left"><tr><td rowspan="1" colspan="1">MTR</td><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/></tr><tr><td rowspan="1" colspan="1"> Kingdom</td><td rowspan="1" colspan="1">1581</td><td rowspan="1" colspan="1">24 522</td><td rowspan="1" colspan="1">111 655</td></tr><tr><td rowspan="1" colspan="1"> Phylum</td><td rowspan="1" colspan="1">1576</td><td rowspan="1" colspan="1">23 027</td><td rowspan="1" colspan="1">111 650</td></tr><tr><td rowspan="1" colspan="1"> Class</td><td rowspan="1" colspan="1">1530</td><td rowspan="1" colspan="1">21 920</td><td rowspan="1" colspan="1">109 986</td></tr><tr><td rowspan="1" colspan="1"> Order</td><td rowspan="1" colspan="1">1317</td><td rowspan="1" colspan="1">21 019</td><td rowspan="1" colspan="1">108 100</td></tr><tr><td rowspan="1" colspan="1"> Family</td><td rowspan="1" colspan="1">1035</td><td rowspan="1" colspan="1">15 583</td><td rowspan="1" colspan="1">100 676</td></tr><tr><td rowspan="1" colspan="1"> Genus</td><td rowspan="1" colspan="1">979</td><td rowspan="1" colspan="1">11 422</td><td rowspan="1" colspan="1">94 507</td></tr><tr><td rowspan="1" colspan="1"> Species</td><td rowspan="1" colspan="1">937</td><td rowspan="1" colspan="1">9560</td><td rowspan="1" colspan="1">89 818</td></tr><tr><td rowspan="1" colspan="1">LCA</td><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/></tr><tr><td rowspan="1" colspan="1"> Kingdom</td><td rowspan="1" colspan="1">1217</td><td rowspan="1" colspan="1">21 287</td><td rowspan="1" colspan="1">93 416</td></tr><tr><td rowspan="1" colspan="1"> Phylum</td><td rowspan="1" colspan="1">1208</td><td rowspan="1" colspan="1">16 526</td><td rowspan="1" colspan="1">93 399</td></tr><tr><td rowspan="1" colspan="1"> Class</td><td rowspan="1" colspan="1">1051</td><td rowspan="1" colspan="1">12 301</td><td rowspan="1" colspan="1">87 917</td></tr><tr><td rowspan="1" colspan="1"> Order</td><td rowspan="1" colspan="1">807</td><td rowspan="1" colspan="1">6841</td><td rowspan="1" colspan="1">87 146</td></tr><tr><td rowspan="1" colspan="1"> Family</td><td rowspan="1" colspan="1">691</td><td rowspan="1" colspan="1">5045</td><td rowspan="1" colspan="1">70 376</td></tr><tr><td rowspan="1" colspan="1"> Genus</td><td rowspan="1" colspan="1">635</td><td rowspan="1" colspan="1">4685</td><td rowspan="1" colspan="1">69 636</td></tr><tr><td rowspan="1" colspan="1"> Species</td><td rowspan="1" colspan="1">311</td><td rowspan="1" colspan="1">4340</td><td rowspan="1" colspan="1">29 160</td></tr></tbody></table></table-wrap></p>
        <p>MTR assigned more reads than LCA for each taxon detected by both the methods, at every rank (Supplementary Figs S19–S30). For instance, on the Saltern dataset, at rank Order, MTR assigned about 50% more reads than LCA to <italic>Rickettsiales</italic>. The reads assigned by MTR to <italic>Rhizobiales</italic> and <italic>Rhodobacterales</italic> were two times as many as those assigned by LCA to that taxa.</p>
        <p>On the Coral dataset, at rank Genus, MTR assigned 4540 reads to <italic>Porites</italic>, seven times more that LCA (643); the number of reads assigned to <italic>Gibberella</italic> by MTR was 3492, whereas LCA assigned 1804 reads to that taxon.</p>
        <p>On the Chicken dataset, at rank Genus, MTR assigned 6743 reads to <italic>Clostridium</italic>, three times as many as LCA did (2055); furthermore, 25.5% more reads of <italic>Bacteroides</italic> were detected by MTR, 15 603 reads more than LCA.</p>
      </sec>
      <sec id="SEC4.2.2">
        <title>4.2.2 Taxa detected</title>
        <p>MTR detected slightly more taxa than LCA (Supplementary Table S7). For instance, on the Coral dataset the number of taxa detected by MTR and LCA were 17 and 16 at rank Phylum, and 70 and 58 at rank Genus, respectively. On the Chicken dataset, at rank Species, the number of taxa detected by MTR and LCA were almost the same (133 and 135, respectively), whereas on the Coral dataset MTR detected 15 taxa and LCA only 8. Also on the Saltern dataset, MTR detected more taxa than LCA: the number of taxa detected by MTR and LCA were 6 and 4 at rank Phylum, and 15 and 8 at rank Genus, respectively.</p>
      </sec>
      <sec id="SEC4.2.3">
        <title>4.2.3 Population distribution</title>
        <p>results of the two algorithms show interesting differences, especially on the Coral dataset, where MTR assigned a higher percentage of reads to <italic>Porites</italic> and its ancestor taxa at all the ranks (Supplementary Figs S19–S30). Both algorithms identified <italic>Cnidaria</italic> and <italic>Ascomycota</italic> as the two largest Phylum populations. However, MTR and LCA considered <italic>Cnidaria</italic> and <italic>Ascomycota</italic> as the dominant phyla (47.67 and 50.02%, respectively). Results at rank Phylum show that MTR provided a population characterization of the Coral dataset very similar to the one given in <xref ref-type="bibr" rid="B27">Rodriguez-Brito <italic>et al.</italic> (2007</xref>), which was obtained by comparing the reads with the SEED non-redundant database (<xref ref-type="bibr" rid="B24">Overbeek <italic>et al.</italic>, 2004</xref>) using BLASTx. The population characterization of the Coral dataset at rank Genus is shown in the pie charts of <xref ref-type="fig" rid="F2">Figure 2</xref>. MTR labeled 39.75% of the reads as <italic>Porites</italic>, making it the biggest group, while LCA assigned just 13.72% of the reads to that taxon. Both algorithms generated also different taxonomic distributions of other groups of organisms. For instance, at rank Genus, MTR assigned only 9.03% of the reads to <italic>Acinectobacter</italic>, while LCA considered this taxon as the second biggest group (20.15%).
<fig id="F2" position="float"><label>Fig. 2.</label><caption><p>Population distributions (rank Genus) of Coral dataset by MTR (<italic>top</italic>) and LCA (<italic>bottom</italic>).</p></caption><graphic xlink:href="btq649f2"/></fig></p>
        <p>On the Saltern dataset, MTR and LCA produced similar population distributions, except at rank Genus. At that level, MTR assigned 1.23% of the reads to <italic>Clavibacter</italic>, a taxon not detected by LCA. Both methods identified <italic>Candidatus pelagibacter</italic> as the dominant taxon. However, MTR assigned 8.38% of the reads to <italic>Roseobacter</italic>, almost 10 times as many as LCA.</p>
        <p>On the Chicken dataset, the population distributions given by the two algorithms presented many similarities, with MTR showing a slightly higher proportion of <italic>Clostridia</italic> and of its ancestor taxa. This difference was more apparent at rank Genus, where MTR and LCA assigned 7.13 and 2.95% of the reads to <italic>Clostridium</italic>, respectively. A predominant occurrence of <italic>Bacteroides</italic> was detected by both algorithms: 81.18 and 76.33% of the reads were assigned to this taxon by LCA and MTR, respectively.</p>
      </sec>
    </sec>
  </sec>
  <sec sec-type="discussion" id="SEC5">
    <title>5 DISCUSSION</title>
    <p>Results of our study on simulated and real-life datasets indicate that MTR is better than LCA with respect to the number of assigned reads. The total number of reads assigned increases, as well as the number of reads assigned at lower ranks.</p>
    <p>With respect to correctness of the assignment, results indicate higher accuracy of LCA. However, these results are computed on sets of different size, where much greater sets of reads are used for computing accuracy of MTR. Therefore, accuracy results should be interpreted with care. For instance, on the simulated metagenome M3, MTR assigns on the average 43.36% more reads than LCA at rank Genus, with a small loss of accuracy (2.77% on the average). Accuracy reduction of MTR on M1 at rank Genus is 6.44% but the method assigns 63.25% more reads than LCA. On M2 at rank Genus, MTR assigns 77.64% more reads than LCA with an accuracy reduction of 13.17%; nevertheless, at rank Order MTR is 1.76% more accurate than LCA.</p>
    <p>Interestingly, these differences in accuracy are not reflected in differences in the quality of population characterization. On the contrary, on the simulated datasets the population characterizations of MTR are better than those of LCA, with neat differences at rank Genus. On the real-life datasets, MTR and LCA give rather different population characterizations at rank Phylum and lower. The difference is neat on the Coral dataset, where MTR assigns a much higher percentage of reads to <italic>Porites</italic> than LCA, especially at ranks Order and Genus and also at higher ranks (for instance, Phylum).</p>
    <p>In conclusion, results indicate effectiveness of the proposed method for performing global taxonomic analysis of very short metagenomic reads using a protein database of reference.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="PMC_1" content-type="local-data">
      <caption>
        <title>Supplementary Data</title>
      </caption>
      <media mimetype="text" mime-subtype="html" xlink:href="supp_27_2_196__index.html"/>
      <media xlink:role="associated-file" mimetype="application" mime-subtype="pdf" xlink:href="supp_btq649_supplementary_mtr.pdf"/>
    </supplementary-material>
  </sec>
</body>
<back>
  <fn-group>
    <fn id="FN1">
      <p><sup>1</sup>See <ext-link ext-link-type="uri" xlink:href="http://www.illumina.com/">http://www.illumina.com/</ext-link>.</p>
    </fn>
    <fn id="FN2">
      <p><sup>2</sup>LCA is present in Galaxy Metagenomic Analyses tools by the name ‘lowest diagnostic rank’.</p>
    </fn>
    <fn id="FN3">
      <p><sup>3</sup>Publicly available at <ext-link ext-link-type="ftp" xlink:href="ftp://ftp.ncbi.nlm.nih.gov/blast/db">ftp://ftp.ncbi.nlm.nih.gov/blast/db</ext-link>.</p>
    </fn>
  </fn-group>
  <ack>
    <title>ACKNOWLEDGEMENTS</title>
    <p>We would like to thank Mavrommatis Konstantinos for providing the metagenomes M1, M2 and M3.</p>
    <p><italic>Funding</italic>: This work was partially supported by Netherlands Organization for Scientific Research (NWO) within NWO project 600.065.120.09N213.</p>
    <p><italic>Conflict of Interest</italic>: none declared.</p>
  </ack>
  <ref-list>
    <title>REFERENCES</title>
    <ref id="B1">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Altschul</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Gapped BLAST and PSI-BLAST: a new generation of protein database search programs</article-title>
        <source>Nucleic Acids Res.</source>
        <year>1997</year>
        <volume>25</volume>
        <fpage>3389</fpage>
        <lpage>3402</lpage>
        <pub-id pub-id-type="pmid">9254694</pub-id>
      </element-citation>
    </ref>
    <ref id="B2">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Amann</surname>
            <given-names>R</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Phylogenetic identification and in situ detection of individual microbial cells without cultivation</article-title>
        <source>Microbiol. Rev.</source>
        <year>1995</year>
        <volume>59</volume>
        <fpage>143</fpage>
        <lpage>169</lpage>
        <pub-id pub-id-type="pmid">7535888</pub-id>
      </element-citation>
    </ref>
    <ref id="B3">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bar-Yehuda</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Even</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>A linear-time approximation algorithm for the weighted vertex cover problem</article-title>
        <source>J. Algorithms</source>
        <year>1981</year>
        <volume>2</volume>
        <fpage>198</fpage>
        <lpage>203</lpage>
      </element-citation>
    </ref>
    <ref id="B4">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bentley</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Parkhill</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Comparative genomic structure of prokaryotes</article-title>
        <source>Ann. Rev. Genet.</source>
        <year>2004</year>
        <volume>38</volume>
        <fpage>771</fpage>
        <lpage>791</lpage>
        <pub-id pub-id-type="pmid">15568993</pub-id>
      </element-citation>
    </ref>
    <ref id="B5">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Blankenberg</surname>
            <given-names>D</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A framework for collaborative analysis of ENCODE data: making large-scale analyses biologist-friendly</article-title>
        <source>Genome Res.</source>
        <year>2007</year>
        <volume>17</volume>
        <fpage>960</fpage>
        <lpage>964</lpage>
        <pub-id pub-id-type="pmid">17568012</pub-id>
      </element-citation>
    </ref>
    <ref id="B6">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Blankenberg</surname>
            <given-names>D</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Galaxy: a web-based genome analysis tool for experimentalists</article-title>
        <source>Curr. Protoc. Mol. Biol.</source>
        <year>2010</year>
        <comment><bold>Chapter 19</bold>Unit 19.10.1–21</comment>
      </element-citation>
    </ref>
    <ref id="B7">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Brady</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Salzberg</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Phymm and phymmbl: metagenomic phylogenetic classification with interpolated markov models</article-title>
        <source>Nat. Methods</source>
        <year>2009</year>
        <volume>6</volume>
        <fpage>673</fpage>
        <lpage>676</lpage>
        <pub-id pub-id-type="pmid">19648916</pub-id>
      </element-citation>
    </ref>
    <ref id="B8">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chvatal</surname>
            <given-names>V</given-names>
          </name>
        </person-group>
        <article-title>A greedy heuristic for the set-covering problem</article-title>
        <source>Math. Operat. Res.</source>
        <year>1979</year>
        <volume>4</volume>
        <fpage>233</fpage>
        <lpage>235</lpage>
      </element-citation>
    </ref>
    <ref id="B9">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Clemente</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Accurate taxonomic assignment of short pyrosequencing reads</article-title>
        <source>Pac. Symp. Biocomput.</source>
        <year>2010</year>
        <volume>15</volume>
        <fpage>3</fpage>
        <lpage>9</lpage>
        <pub-id pub-id-type="pmid">19908352</pub-id>
      </element-citation>
    </ref>
    <ref id="B10">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dalevi</surname>
            <given-names>D</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Annotation of metagenome short reads using proxygenes</article-title>
        <source>Bioinformatics</source>
        <year>2008</year>
        <volume>24</volume>
        <fpage>i7</fpage>
        <lpage>i13</lpage>
        <pub-id pub-id-type="pmid">18689842</pub-id>
      </element-citation>
    </ref>
    <ref id="B11">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Delcher</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Identifying bacterial genes and endosymbiont DNA with Glimmer</article-title>
        <source>Bioinformatics</source>
        <year>2007</year>
        <volume>23</volume>
        <fpage>673</fpage>
        <lpage>679</lpage>
        <pub-id pub-id-type="pmid">17237039</pub-id>
      </element-citation>
    </ref>
    <ref id="B12">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Edwards</surname>
            <given-names>R</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Using pyrosequencing to shed light on deep mine microbial ecology</article-title>
        <source>BMC Genomics</source>
        <year>2006</year>
        <volume>7</volume>
        <fpage>57</fpage>
        <pub-id pub-id-type="pmid">16549033</pub-id>
      </element-citation>
    </ref>
    <ref id="B13">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Foerstner</surname>
            <given-names>K</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Environments shape the nucleotide composition of genomes</article-title>
        <source>EMBO Rep.</source>
        <year>2005</year>
        <volume>6</volume>
      </element-citation>
    </ref>
    <ref id="B14">
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Folino</surname>
            <given-names>G</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Clustering metagenome short reads using weighted proteins</article-title>
        <source>EvoBIO</source>
        <year>2009</year>
        <volume>5483</volume>
        <publisher-name>Springer</publisher-name>
        <fpage>152</fpage>
        <lpage>163</lpage>
        <comment>of <italic>LNCS</italic></comment>
      </element-citation>
    </ref>
    <ref id="B15">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Huson</surname>
            <given-names>D</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Megan analysis of metagenomic data</article-title>
        <source>Genome Res.</source>
        <year>2007</year>
        <volume>17</volume>
        <fpage>377</fpage>
        <lpage>386</lpage>
        <pub-id pub-id-type="pmid">17255551</pub-id>
      </element-citation>
    </ref>
    <ref id="B16">
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Korf</surname>
            <given-names>I</given-names>
          </name>
          <etal/>
        </person-group>
        <source>BLAST.</source>
        <year>2003</year>
        <publisher-loc>Sebastopol, CA, USA</publisher-loc>
        <publisher-name>O'Reilly &amp; Associates, Inc.</publisher-name>
      </element-citation>
    </ref>
    <ref id="B17">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Krause</surname>
            <given-names>L</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Phylogenetic classification of short environmental DNA fragments</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2008</year>
        <volume>36</volume>
        <fpage>2230</fpage>
        <lpage>2239</lpage>
        <pub-id pub-id-type="pmid">18285365</pub-id>
      </element-citation>
    </ref>
    <ref id="B18">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kunin</surname>
            <given-names>V</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A bioinformatician's guide to metagenomics</article-title>
        <source>Microbiol. Mol. Biol. Rev.</source>
        <year>2008</year>
        <volume>72</volume>
        <fpage>557</fpage>
        <lpage>578</lpage>
        <pub-id pub-id-type="pmid">19052320</pub-id>
      </element-citation>
    </ref>
    <ref id="B19">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lin</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Divergence measures based on the Shannon Entropy</article-title>
        <source>IEEE Trans. Inf. Theory</source>
        <year>1991</year>
        <volume>37</volume>
        <fpage>145</fpage>
        <lpage>151</lpage>
      </element-citation>
    </ref>
    <ref id="B20">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Liu</surname>
            <given-names>Z</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Accurate taxonomy assignments from 16S rRNA sequences produced by highly parallel pyrosequencers</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2008</year>
        <volume>36</volume>
        <fpage>e120</fpage>
        <pub-id pub-id-type="pmid">18723574</pub-id>
      </element-citation>
    </ref>
    <ref id="B21">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Margulies</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Genome sequencing in microfabricated high-density picolitre reactors</article-title>
        <source>Nature</source>
        <year>2005</year>
        <volume>437</volume>
        <fpage>376</fpage>
        <lpage>380</lpage>
        <pub-id pub-id-type="pmid">16056220</pub-id>
      </element-citation>
    </ref>
    <ref id="B22">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>McHardy</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Rigoutsos</surname>
            <given-names>I</given-names>
          </name>
        </person-group>
        <article-title>What's in the mix: phylogenetic classification of metagenome sequence samples</article-title>
        <source>Curr. Opin. Microbiol.</source>
        <year>2007</year>
        <volume>10</volume>
        <fpage>499</fpage>
        <lpage>503</lpage>
        <pub-id pub-id-type="pmid">17933580</pub-id>
      </element-citation>
    </ref>
    <ref id="B23">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Meyer</surname>
            <given-names>F</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The metagenomics rast server - a public resource for the automatic phylogenetic and functional analysis of metagenomes</article-title>
        <source>BMC Bioinformatics</source>
        <year>2008</year>
        <volume>9</volume>
        <fpage>386</fpage>
        <pub-id pub-id-type="pmid">18803844</pub-id>
      </element-citation>
    </ref>
    <ref id="B24">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Overbeek</surname>
            <given-names>R</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The SEED: a peer-to-peer environment for genome annotation</article-title>
        <source>Comm. ACM</source>
        <year>2004</year>
        <volume>47</volume>
        <fpage>46</fpage>
        <lpage>51</lpage>
      </element-citation>
    </ref>
    <ref id="B25">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Qin</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A human gut microbial gene catalogue established by metagenomic sequencing</article-title>
        <source>Nature</source>
        <year>2010</year>
        <volume>464</volume>
        <fpage>59</fpage>
        <lpage>65</lpage>
        <pub-id pub-id-type="pmid">20203603</pub-id>
      </element-citation>
    </ref>
    <ref id="B26">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Raes</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Get the most out of your metagenome: computational analysis of environmental sequence data</article-title>
        <source>Curr. Opin. Microbiol.</source>
        <year>2007</year>
        <volume>10</volume>
        <fpage>490</fpage>
        <lpage>498</lpage>
        <pub-id pub-id-type="pmid">17936679</pub-id>
      </element-citation>
    </ref>
    <ref id="B27">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rodriguez-Brito</surname>
            <given-names>B</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Metagenomic analysis of the microbial community associated with the coral</article-title>
        <source>Porites astreoides. Environ. Microbiol.</source>
        <year>2007</year>
        <volume>9</volume>
        <fpage>2707</fpage>
        <lpage>2719</lpage>
      </element-citation>
    </ref>
    <ref id="B28">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sanger</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Coulson</surname>
            <given-names>AR</given-names>
          </name>
        </person-group>
        <article-title>A rapid method for determining sequences in dna by primed synthesis with DNA polymerase</article-title>
        <source>J. Mol. Biol.</source>
        <year>1975</year>
        <volume>94</volume>
        <fpage>441</fpage>
        <lpage>446</lpage>
        <pub-id pub-id-type="pmid">1100841</pub-id>
      </element-citation>
    </ref>
    <ref id="B29">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sanger</surname>
            <given-names>F</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>DNA sequencing with chain-terminating inhibitors</article-title>
        <source>Proc. Natl Acad. Sci. USA</source>
        <year>1977</year>
        <volume>74</volume>
        <fpage>5463</fpage>
        <lpage>5467</lpage>
        <pub-id pub-id-type="pmid">271968</pub-id>
      </element-citation>
    </ref>
    <ref id="B30">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Turnbaugh</surname>
            <given-names>PJ</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The Human Microbiome Project</article-title>
        <source>Nature</source>
        <year>2007</year>
        <volume>449</volume>
        <fpage>804</fpage>
        <lpage>810</lpage>
        <pub-id pub-id-type="pmid">17943116</pub-id>
      </element-citation>
    </ref>
    <ref id="B31">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>Q</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Naive Bayesian classifier for rapid assignment of rRNA sequences into the New Bacterial Taxonomy</article-title>
        <source>Appl. Environ. Microbiol.</source>
        <year>2007</year>
        <volume>73</volume>
        <fpage>5261</fpage>
        <lpage>5267</lpage>
        <pub-id pub-id-type="pmid">17586664</pub-id>
      </element-citation>
    </ref>
    <ref id="B32">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wooley</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A primer on metagenomics</article-title>
        <source>PLoS Comput. Biol.</source>
        <year>2010</year>
        <volume>6</volume>
        <fpage>e1000667</fpage>
        <pub-id pub-id-type="pmid">20195499</pub-id>
      </element-citation>
    </ref>
    <ref id="B33">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yooseph</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The <italic>Sorcerer II</italic> global ocean sampling expedition: expanding the universe of protein families</article-title>
        <source>PLoS Biol.</source>
        <year>2007</year>
        <volume>5</volume>
        <fpage>e16</fpage>
        <pub-id pub-id-type="pmid">17355171</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
